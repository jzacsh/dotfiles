cscope 15 $HOME/back/dotfiles/.vim               0002926018
	@/srv/http/subs/notes/www/includes/actions.inc

1 <?
php


80 
funùiÚ
 
	$aùiÚs_do
(
$aùiÚ_ids
, &
$objeù
, 
$cÚ‹xt
 = 
NULL
, 
$a1
 = NULL, 
$a2
 = NULL) {

82 
$¡ack
;

83 
$¡ack
++;

84 ià(
$¡ack
 > 
	`v¬ŸbË_g‘
('actions_max_stack', 35)) {

85 
	`w©chdog
('aùiÚs', 'Sck ov”æow:oØmªy c®l tØaùiÚs_do(). AbÜtšgØ´ev’ˆšfš™»cursiÚ.', 
	`¬¿y
(), 
WATCHDOG_ERROR
);

88 
$aùiÚs
 = 
	`¬¿y
();

89 
$avaabË_aùiÚs
 = 
	`aùiÚs_li¡
();

90 
$»suÉ
 = 
	`¬¿y
();

91 ià(
	`is_¬¿y
(
$aùiÚ_ids
)) {

92 
$wh”e
 = 
	`¬¿y
();

93 
$wh”e_v®ues
 = 
	`¬¿y
();

94 
	`fÜ—ch
 (
$aùiÚ_ids
 
as
 
$aùiÚ_id
) {

95 ià(
	`is_num”ic
(
$aùiÚ_id
)) {

96 
$wh”e
[] = "OR‡id = '%s'";

97 
$wh”e_v®ues
[] = 
$aùiÚ_id
;

99 
	`–£if
 (
	`is£t
(
$avaabË_aùiÚs
[
$aùiÚ_id
])) {

100 
$aùiÚs
[
$aùiÚ_id
] = 
$avaabË_aùiÚs
[$action_id];

106 ià(
$wh”e
) {

107 
$wh”e_şau£
 = 
	`im¶ode
(' ', 
$wh”e
);

109 
$wh”e_şau£
 = '('. 
	`¡r¡r
($where_clause, " ") .')';

110 
$»suÉ_db
 = 
	`db_qu”y
('SELECT * FROM {aùiÚs} WHERE '. 
$wh”e_şau£
, 
$wh”e_v®ues
);

111 
$aùiÚ
 = 
	`db_ãtch_objeù
(
$»suÉ_db
)) {

112 
$aùiÚs
[
$aùiÚ
->
aid
] = $aùiÚ->
·¿m‘”s
 ? 
	`un£rŸlize
($aùiÚ->·¿m‘”sè: 
	`¬¿y
();

113 
$aùiÚs
[
$aùiÚ
->
aid
]['ÿÎback'] = $aùiÚ->
ÿÎback
;

114 
$aùiÚs
[
$aùiÚ
->
aid
]['ty³'] = $aùiÚ->
ty³
;

119 
	`fÜ—ch
 (
$aùiÚs
 
as
 
$aùiÚ_id
 => 
$·¿ms
) {

120 ià(
	`is_num”ic
(
$aùiÚ_id
)) {

121 
$funùiÚ
 = 
$·¿ms
['callback'];

122 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

123 
$cÚ‹xt
 = 
	`¬¿y_m”ge
($cÚ‹xt, 
$·¿ms
);

124 
$aùiÚs_»suÉ
[
$aùiÚ_id
] = 
	`$funùiÚ
(
$objeù
, 
$cÚ‹xt
, 
$a1
, 
$a2
);

127 
$aùiÚs_»suÉ
[
$aùiÚ_id
] = 
FALSE
;

132 
$»suÉ
[
$aùiÚ_id
] = 
	`$aùiÚ_id
(
$objeù
, 
$cÚ‹xt
, 
$a1
, 
$a2
);

139 ià(
	`is_num”ic
(
$aùiÚ_ids
)) {

140 
$aùiÚ
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT * FROM {aùiÚs} WHERE‡id = '%s'", 
$aùiÚ_ids
));

141 
$funùiÚ
 = 
$aùiÚ
->
ÿÎback
;

142 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

143 
$cÚ‹xt
 = 
	`¬¿y_m”ge
($cÚ‹xt, 
	`un£rŸlize
(
$aùiÚ
->
·¿m‘”s
));

144 
$aùiÚs_»suÉ
[
$aùiÚ_ids
] = 
	`$funùiÚ
(
$objeù
, 
$cÚ‹xt
, 
$a1
, 
$a2
);

147 
$aùiÚs_»suÉ
[
$aùiÚ_ids
] = 
FALSE
;

152 
$»suÉ
[
$aùiÚ_ids
] = 
	`$aùiÚ_ids
(
$objeù
, 
$cÚ‹xt
, 
$a1
, 
$a2
);

155 
$¡ack
--;

156  
$»suÉ
;

157 
	}
}

206 
funùiÚ
 
	$aùiÚs_li¡
(
$»£t
 = 
FALSE
) {

207 
$aùiÚs
;

208 ià(!
	`is£t
(
$aùiÚs
è|| 
$»£t
) {

209 
$aùiÚs
 = 
	`moduË_švoke_®l
('action_info');

210 
	`dru·l_®‹r
('aùiÚ_šfo', 
$aùiÚs
);

214  (
¬¿y
)
$aùiÚs
;

215 
	}
}

234 
funùiÚ
 
	$aùiÚs_g‘_®l_aùiÚs
() {

235 
$aùiÚs
 = 
	`¬¿y
();

236 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {actions}");

237 
$aùiÚ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

238 
$aùiÚs
[
$aùiÚ
->
aid
] = 
	`¬¿y
(

239 'ÿÎback' => 
$aùiÚ
->
ÿÎback
,

240 'desütiÚ' => 
$aùiÚ
->
desütiÚ
,

241 'ty³' => 
$aùiÚ
->
ty³
,

242 'cÚfigu¿bË' => (
boŞ
è
$aùiÚ
->
·¿m‘”s
,

245  
$aùiÚs
;

246 
	}
}

265 
funùiÚ
 
	$aùiÚs_aùiÚs_m­
(
$aùiÚs
) {

266 
$aùiÚs_m­
 = 
	`¬¿y
();

267 
	`fÜ—ch
 (
$aùiÚs
 
as
 
$ÿÎback
 => 
$¬¿y
) {

268 
$key
 = 
	`md5
(
$ÿÎback
);

269 
$aùiÚs_m­
[
$key
]['ÿÎback'] = 
	`is£t
(
$¬¿y
['ÿÎback']è? $¬¿y['ÿÎback'] : 
$ÿÎback
;

270 
$aùiÚs_m­
[
$key
]['desütiÚ'] = 
$¬¿y
['description'];

271 
$aùiÚs_m­
[
$key
]['ty³'] = 
$¬¿y
['type'];

272 
$aùiÚs_m­
[
$key
]['cÚfigu¿bË'] = 
$¬¿y
['configurable'];

274  
$aùiÚs_m­
;

275 
	}
}

288 
funùiÚ
 
	$aùiÚs_funùiÚ_lookup
(
$hash
) {

289 
$aùiÚs_li¡
 = 
	`aùiÚs_li¡
();

290 
	`fÜ—ch
 (
$aùiÚs_li¡
 
as
 
$funùiÚ
 => 
$¬¿y
) {

291 ià(
	`md5
(
$funùiÚ
è=ğ
$hash
) {

292  
$funùiÚ
;

297 
$aid
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT‡id FROM {aùiÚs} WHERE MD5×idèğ'%s' AND…¬am‘” <> ''", 
$hash
));

298  
$aid
;

299 
	}
}

309 
funùiÚ
 
aùiÚs_synchrÚize
(
$aùiÚs_š_code
 = 
¬¿y
(), 
$d–‘e_Üphªs
 = 
FALSE
) {

310 ià(!
$aùiÚs_š_code
) {

311 
$aùiÚs_š_code
 = 
aùiÚs_li¡
(
TRUE
);

313 
	g$aùiÚs_š_db
 = 
¬¿y
();

314 
	g$»suÉ
 = 
db_qu”y
("SELECT * FROM {actions} WHERE…arameters = ''");

315 
	g$aùiÚ
 = 
db_ãtch_objeù
(
$»suÉ
)) {

316 
$aùiÚs_š_db
[
$aùiÚ
->
ÿÎback
] = 
¬¿y
('aid' => $aùiÚ->
aid
, 'desütiÚ' => $aùiÚ->
desütiÚ
);

320 
fÜ—ch
 (
$aùiÚs_š_code
 
as
 
$ÿÎback
 => 
$¬¿y
) {

323 ià(!
$¬¿y
['configurable']) {

325 ià(
¬¿y_key_exi¡s
(
$ÿÎback
, 
$aùiÚs_š_db
)) {

326 
un£t
(
$aùiÚs_š_db
[
$ÿÎback
]);

330 
db_qu”y
("INSERT INTO {aùiÚs} (aid,y³, c®lback,…¬am‘”s, desütiÚèVALUES ('%s', '%s', '%s', '%s', '%s')", 
$ÿÎback
, 
$¬¿y
['type'], $callback, '', $array['description']);

331 
w©chdog
('aùiÚs', "AùiÚ '%aùiÚ'‡dded.", 
¬¿y
('%aùiÚ' => 
$¬¿y
['description']));

337 ià(
	g$aùiÚs_š_db
) {

338 
	g$Üphªed
 = 
¬¿y
();

339 
	g$¶aûhŞd”
 = 
¬¿y
();

341 
fÜ—ch
 (
$aùiÚs_š_db
 
as
 
$ÿÎback
 => 
$¬¿y
) {

342 
$Üphªed
[] = 
$ÿÎback
;

343 
	g$¶aûhŞd”
[] = "'%s'";

346 
	g$Üphªs
 = 
im¶ode
(', ', 
$Üphªed
);

348 ià(
	g$d–‘e_Üphªs
) {

349 
	g$¶aûhŞd”s
 = 
im¶ode
(', ', 
$¶aûhŞd”
);

350 
	g$»suÉs
 = 
db_qu”y
("SELECT‡.aid,‡.desütiÚ FROM {aùiÚs}‡ WHERE c®lback IN ($¶aûhŞd”s)", 
$Üphªed
);

351 
	g$aùiÚ
 = 
db_ãtch_objeù
(
$»suÉs
)) {

352 
aùiÚs_d–‘e
(
$aùiÚ
->
aid
);

353 
w©chdog
('aùiÚs', "Removed o½hªed‡ùiÚ '%aùiÚ' from d©aba£.", 
¬¿y
('%aùiÚ' => 
$aùiÚ
->
desütiÚ
));

357 
	g$lšk
 = 
l
(
t
('Remove orphaned‡ctions'), 'admin/settings/actions/orphan');

358 
	g$couÁ
 = 
couÁ
(
$aùiÚs_š_db
);

359 
w©chdog
('aùiÚs', 
fÜm©_¶u¿l
(
$couÁ
, 'OÃ o½hªed‡ùiÚ (%Üphªsèexi¡ šhaùiÚ bË. !lšk', '@couÁ o½hªed‡ùiÚ (%Üphªsèexi¡ iÀthaùiÚ bË. !lšk'), 
¬¿y
('@couÁ' => $couÁ, '%Üphªs' => 
$Üphªs
, '!lšk' => 
$lšk
), 
WATCHDOG_WARNING
);

384 
funùiÚ
 
	$aùiÚs_§ve
(
$funùiÚ
, 
$ty³
, 
$·¿ms
, 
$desc
, 
$aid
 = 
NULL
) {

385 
$£rŸlized
 = 
	`£rŸlize
(
$·¿ms
);

386 ià(
$aid
) {

387 
	`db_qu”y
("UPDATE {aùiÚs} SET c®lback = '%s',y³ = '%s',…¬am‘” ğ'%s', desütiÚ = '%s' WHERE‡id = '%s'", 
$funùiÚ
, 
$ty³
, 
$£rŸlized
, 
$desc
, 
$aid
);

388 
	`w©chdog
('aùiÚs', 'AùiÚ %aùiÚ saved.', 
	`¬¿y
('%aùiÚ' => 
$desc
));

393 
	`db_qu”y
('INSERT INTO {actions_aid} VALUES (default)');

394 
$aid
 = 
	`db_Ï¡_š£¹_id
('actions_aid', 'aid');

395 
	`db_qu”y
("INSERT INTO {aùiÚs} (aid, c®lback,y³,…¬am‘”s, desütiÚèVALUES ('%s', '%s', '%s', '%s', '%s')", 
$aid
, 
$funùiÚ
, 
$ty³
, 
$£rŸlized
, 
$desc
);

396 
	`w©chdog
('aùiÚs', 'AùiÚ %aùiÚ c»©ed.', 
	`¬¿y
('%aùiÚ' => 
$desc
));

399  
$aid
;

400 
	}
}

411 
funùiÚ
 
	$aùiÚs_lßd
(
$aid
) {

412  
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT * FROM {aùiÚs} WHERE‡id = '%s'", 
$aid
));

413 
	}
}

421 
funùiÚ
 
	$aùiÚs_d–‘e
(
$aid
) {

422 
	`db_qu”y
("DELETE FROM {aùiÚs} WHERE‡id = '%s'", 
$aid
);

423 
	`moduË_švoke_®l
('aùiÚs_d–‘e', 
$aid
);

424 
	}
}

	@/srv/http/subs/notes/www/includes/batch.inc

1 <?
php


11 
funùiÚ
 
	$_b©ch_·ge
() {

12 
$b©ch
 =& 
	`b©ch_g‘
();

15 ià(
	`is£t
(
$_REQUEST
['id']è&& 
$d©a
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT b©ch FROM {b©ch} WHERE bid = %d ANDok’ = '%s'", $_REQUEST['id'], 
	`dru·l_g‘_tok’
($_REQUEST['id'])))) {

16 
$b©ch
 = 
	`un£rŸlize
(
$d©a
);

19  
FALSE
;

23 
	`»gi¡”_shutdown_funùiÚ
('_batch_shutdown');

25 
$İ
 = 
	`is£t
(
$_REQUEST
['op']) ? $_REQUEST['op'] : '';

26 
$ouut
 = 
NULL
;

27 
$İ
) {

29 
$ouut
 = 
	`_b©ch_¡¬t
();

34 
	`_b©ch_do
();

39 
$ouut
 = 
	`_b©ch_´og»ss_·ge_nojs
();

43 
$ouut
 = 
	`_b©ch_fšished
();

47  
$ouut
;

48 
	}
}

53 
funùiÚ
 
	$_b©ch_¡¬t
() {

58 ià(
	`is£t
(
$_COOKIE
['has_js']) && $_COOKIE['has_js']) {

59  
	`_b©ch_´og»ss_·ge_js
();

62  
	`_b©ch_´og»ss_·ge_nojs
();

64 
	}
}

69 
funùiÚ
 
	$_b©ch_´og»ss_·ge_js
() {

70 
$b©ch
 = 
	`b©ch_g‘
();

74 
$cu¼’t_£t
 = 
	`_b©ch_cu¼’t_£t
();

75 
	`dru·l_£t_t™Ë
(
$cu¼’t_£t
['title']);

76 
	`dru·l_add_js
('misc/´og»ss.js', 'cÜe', 'h—d”', 
FALSE
, FALSE);

78 
$u¾
 = 
	`u¾
(
$b©ch
['u¾'], 
	`¬¿y
('query' =>‡rray('id' => $batch['id'])));

79 
$js_£‰šg
 = 
	`¬¿y
(

80 'b©ch' => 
	`¬¿y
(

81 '”rÜMes§ge' => 
$cu¼’t_£t
['”rÜ_mes§ge'] .'<br/>'. 
$b©ch
['error_message'],

82 'š™Mes§ge' => 
$cu¼’t_£t
['init_message'],

83 'uri' => 
$u¾
,

86 
	`dru·l_add_js
(
$js_£‰šg
, 'setting');

87 
	`dru·l_add_js
('misc/b©ch.js', 'cÜe', 'h—d”', 
FALSE
, FALSE);

89 
$ouut
 = '<div id="progress"></div>';

90  
$ouut
;

91 
	}
}

97 
funùiÚ
 
	$_b©ch_do
() {

99 ià(
$_SERVER
['REQUEST_METHOD'] != 'POST') {

100 
	`dru·l_£t_mes§ge
(
	`t
('HTTP POST is„equired.'), 'error');

101 
	`dru·l_£t_t™Ë
(
	`t
('Error'));

106 
	`li¡
(
$³rûÁage
, 
$mes§ge
èğ
	`_b©ch_´oûss
();

108 
	`dru·l_jsÚ
(
	`¬¿y
('¡©us' => 
TRUE
, '³rûÁage' => 
$³rûÁage
, 'mes§ge' => 
$mes§ge
));

109 
	}
}

114 
funùiÚ
 
	$_b©ch_´og»ss_·ge_nojs
() {

115 
$b©ch
 =& 
	`b©ch_g‘
();

116 
$cu¼’t_£t
 = 
	`_b©ch_cu¼’t_£t
();

118 
	`dru·l_£t_t™Ë
(
$cu¼’t_£t
['title']);

120 
$Ãw_İ
 = 'do_nojs';

122 ià(!
	`is£t
(
$b©ch
['running'])) {

124 
$³rûÁage
 = 0;

125 
$mes§ge
 = 
$cu¼’t_£t
['init_message'];

126 
$b©ch
['ruÂšg'] = 
TRUE
;

134 
	`ob_¡¬t
();

135 
$çÎback
 = 
$cu¼’t_£t
['”rÜ_mes§ge'] .'<br/>'. 
$b©ch
['error_message'];

136 
	`dru·l_maš‹Çnû_theme
();

137 
$çÎback
 = 
	`theme
('maš‹Çnû_·ge', $çÎback, 
FALSE
, FALSE);

143 
	`li¡
(
$çÎback
èğ
	`ex¶ode
('<!--partial-->', $fallback);

144 
´št
 
$çÎback
;

147 
	`li¡
(
$³rûÁage
, 
$mes§ge
èğ
	`_b©ch_´oûss
(
$b©ch
);

148 ià(
$³rûÁage
 == 100) {

149 
$Ãw_İ
 = 'finished';

153 
	`ob_’d_ş—n
();

156 
$u¾
 = 
	`u¾
(
$b©ch
['u¾'], 
	`¬¿y
('qu”y' =>‡¼ay('id' => $b©ch['id'], 'İ' => 
$Ãw_İ
)));

157 
	`dru·l_£t_html_h—d
('<m‘¨h‰p-equiv="Reäesh" cÚ‹Á="0; URL='. 
$u¾
 .'">');

158 
$ouut
 = 
	`theme
('´og»ss_b¬', 
$³rûÁage
, 
$mes§ge
);

159  
$ouut
;

160 
	}
}

166 
funùiÚ
 
	$_b©ch_´oûss
() {

167 
$b©ch
 =& 
	`b©ch_g‘
();

168 
$cu¼’t_£t
 =& 
	`_b©ch_cu¼’t_£t
();

169 
$£t_chªged
 = 
TRUE
;

171 ià(
$b©ch
['progressive']) {

172 
	`tim”_¡¬t
('batch_processing');

175 !
$cu¼’t_£t
['success']) {

179 ià(
$£t_chªged
 && 
	`is£t
(
$cu¼’t_£t
['fe']è&& 
	`is_fe
($current_set['file'])) {

180 
	`šşude_Úû
(
$cu¼’t_£t
['file']);

183 
$fšished
 = 1;

184 
$sk_mes§ge
 = '';

185 ià((
	`li¡
(
$funùiÚ
, 
$¬gs
èğ
	`»£t
(
$cu¼’t_£t
['İ”©iÚs'])è&& 
	`funùiÚ_exi¡s
($function)) {

188 
$b©ch_cÚ‹xt
 = 
	`¬¿y
('§ndbox' => &
$cu¼’t_£t
['§ndbox'], '»suÉs' => &$cu¼’t_£t['»suÉs'], 'fšished' => &
$fšished
, 'mes§ge' => &
$sk_mes§ge
);

190 
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
	`¬¿y_m”ge
(
$¬gs
, 
	`¬¿y
(&
$b©ch_cÚ‹xt
)));

193 ià(
$fšished
 == 1) {

195 
$fšished
 = 0;

197 
	`¬¿y_shiá
(
$cu¼’t_£t
['operations']);

198 
$cu¼’t_£t
['§ndbox'] = 
	`¬¿y
();

205 
$£t_chªged
 = 
FALSE
;

206 
$Şd_£t
 = 
$cu¼’t_£t
;

207 
	`em±y
(
$cu¼’t_£t
['İ”©iÚs']è&& ($cu¼’t_£t['sucûss'] = 
TRUE
è&& 
	`_b©ch_Ãxt_£t
()) {

208 
$cu¼’t_£t
 =& 
	`_b©ch_cu¼’t_£t
();

209 
$£t_chªged
 = 
TRUE
;

215 ià(
$b©ch
['´og»ssive'] && 
	`tim”_»ad
('batch_processing') > 1000) {

220 ià(
$b©ch
['progressive']) {

226 ià(
$£t_chªged
 && 
	`is£t
(
$cu¼’t_£t
['operations'])) {

228 
$»maššg
 = 
	`couÁ
(
$cu¼’t_£t
['operations']);

229 
$tÙ®
 = 
$cu¼’t_£t
['total'];

230 
$´og»ss_mes§ge
 = 
$cu¼’t_£t
['init_message'];

231 
$sk_mes§ge
 = '';

234 
$»maššg
 = 
	`couÁ
(
$Şd_£t
['operations']);

235 
$tÙ®
 = 
$Şd_£t
['total'];

236 
$´og»ss_mes§ge
 = 
$Şd_£t
['progress_message'];

239 
$cu¼’t
 = 
$tÙ®
 - 
$»maššg
 + 
$fšished
;

240 
$³rûÁage
 = 
$tÙ®
 ? 
	`æoÜ
(
$cu¼’t
 / $total * 100) : 100;

241 
$v®ues
 = 
	`¬¿y
(

242 '@»maššg' => 
$»maššg
,

243 '@tÙ®' => 
$tÙ®
,

244 '@cu¼’t' => 
	`æoÜ
(
$cu¼’t
),

245 '@³rûÁage' => 
$³rûÁage
,

247 
$mes§ge
 = 
	`¡¹r
(
$´og»ss_mes§ge
, 
$v®ues
) .'<br/>';

248 
$mes§ge
 .ğ
$sk_mes§ge
 ? $task_message : '&nbsp';

250  
	`¬¿y
(
$³rûÁage
, 
$mes§ge
);

254  
	`_b©ch_fšished
();

257 
	}
}

262 
	gfunùiÚ
 &
	$_b©ch_cu¼’t_£t
() {

263 
$b©ch
 =& 
	`b©ch_g‘
();

264  
$b©ch
['sets'][$batch['current_set']];

265 
	}
}

272 
funùiÚ
 
	$_b©ch_Ãxt_£t
() {

273 
$b©ch
 =& 
	`b©ch_g‘
();

274 ià(
	`is£t
(
$b©ch
['sets'][$batch['current_set'] + 1])) {

275 
$b©ch
['current_set']++;

276 
$cu¼’t_£t
 =& 
	`_b©ch_cu¼’t_£t
();

277 ià(
	`is£t
(
$cu¼’t_£t
['fÜm_subm™']è&& (
$funùiÚ
 = $cu¼’t_£t['fÜm_subm™']è&& 
	`funùiÚ_exi¡s
($function)) {

280 
	`$funùiÚ
(
$b©ch
['form'], $batch['form_state']);

282  
TRUE
;

284 
	}
}

291 
funùiÚ
 
	$_b©ch_fšished
() {

292 
$b©ch
 =& 
	`b©ch_g‘
();

295 
	`fÜ—ch
 (
$b©ch
['£ts'] 
as
 
$key
 => 
$b©ch_£t
) {

296 ià(
	`is£t
(
$b©ch_£t
['finished'])) {

298 ià(
	`is£t
(
$b©ch_£t
['fe']è&& 
	`is_fe
($batch_set['file'])) {

299 
	`šşude_Úû
(
$b©ch_£t
['file']);

301 ià(
	`funùiÚ_exi¡s
(
$b©ch_£t
['finished'])) {

302 
$b©ch_£t
['finished']($batch_set['success'], $batch_set['results'], $batch_set['operations']);

308 ià(
$b©ch
['progressive']) {

309 
	`db_qu”y
("DELETE FROM {b©ch} WHERE bid = %d", 
$b©ch
['id']);

311 
$_b©ch
 = 
$b©ch
;

312 
$b©ch
 = 
NULL
;

315 ià(
$_b©ch
['progressive']) {

317 ià(
	`is£t
(
$_b©ch
['destination'])) {

318 
$_REQUEST
['de¡š©iÚ'] = 
$_b©ch
['destination'];

323 ià(
	`is£t
(
$_b©ch
['form_state']['redirect'])) {

324 
$»dœeù
 = 
$_b©ch
['form_state']['redirect'];

326 
	`–£if
 (
	`is£t
(
$_b©ch
['redirect'])) {

327 
$»dœeù
 = 
$_b©ch
['redirect'];

330 
$»dœeù
 = 
$_b©ch
['source_page'];

334 
$fÜm
 = 
	`is£t
(
$b©ch
['fÜm']è? $b©ch['fÜm'] : 
	`¬¿y
();

335 ià(
	`em±y
(
$_b©ch
['form_state']['rebuild']) &&ƒmpty($_batch['form_state']['storage'])) {

336 
	`dru·l_»dœeù_fÜm
(
$fÜm
, 
$»dœeù
);

342 
$_SESSION
['b©ch_fÜm_¡©e'] = 
$_b©ch
['form_state'];

343 
	`dru·l_gÙo
(
$_b©ch
['source_page']);

345 
	}
}

351 
funùiÚ
 
	$_b©ch_shutdown
() {

352 ià(
$b©ch
 = 
	`b©ch_g‘
()) {

353 
	`db_qu”y
("UPDATE {b©ch} SET b©ch = '%s' WHERE bid = %d", 
	`£rŸlize
(
$b©ch
), $batch['id']);

355 
	}
}

	@/srv/http/subs/notes/www/includes/bootstrap.inc

1 <?
php


13 
defše
('CACHE_PERMANENT', 0);

18 
defše
('CACHE_TEMPORARY', -1);

23 
defše
('CACHE_DISABLED', 0);

28 
defše
('CACHE_NORMAL', 1);

35 
defše
('CACHE_AGGRESSIVE', 2);

46 
defše
('WATCHDOG_EMERG', 0);

57 
defše
('WATCHDOG_ALERT', 1);

68 
defše
('WATCHDOG_CRITICAL', 2);

79 
defše
('WATCHDOG_ERROR', 3);

90 
defše
('WATCHDOG_WARNING', 4);

101 
defše
('WATCHDOG_NOTICE', 5);

112 
defše
('WATCHDOG_INFO', 6);

123 
defše
('WATCHDOG_DEBUG', 7);

128 
defše
('DRUPAL_BOOTSTRAP_CONFIGURATION', 0);

134 
defše
('DRUPAL_BOOTSTRAP_EARLY_PAGE_CACHE', 1);

139 
defše
('DRUPAL_BOOTSTRAP_DATABASE', 2);

144 
defše
('DRUPAL_BOOTSTRAP_ACCESS', 3);

149 
defše
('DRUPAL_BOOTSTRAP_SESSION', 4);

155 
defše
('DRUPAL_BOOTSTRAP_LATE_PAGE_CACHE', 5);

160 
defše
('DRUPAL_BOOTSTRAP_LANGUAGE', 6);

165 
defše
('DRUPAL_BOOTSTRAP_PATH', 7);

171 
defše
('DRUPAL_BOOTSTRAP_FULL', 8);

176 
defše
('DRUPAL_ANONYMOUS_RID', 1);

181 
defše
('DRUPAL_AUTHENTICATED_RID', 2);

186 
defše
('LANGUAGE_NEGOTIATION_NONE', 0);

192 
defše
('LANGUAGE_NEGOTIATION_PATH_DEFAULT', 1);

199 
defše
('LANGUAGE_NEGOTIATION_PATH', 2);

205 
defše
('LANGUAGE_NEGOTIATION_DOMAIN', 3);

210 
defše
('LANGUAGE_LTR', 0);

215 
defše
('LANGUAGE_RTL', 1);

218 ià(
defšed
('E_DEPRECATED')) {

219 
”rÜ_»pÜtšg
Ó¼Ü_»pÜtšg(è& ~
E_DEPRECATED
);

230 
funùiÚ
 
	$tim”_¡¬t
(
$Çme
) {

231 
glob®
 
$tim”s
;

233 
	`li¡
(
$u£c
, 
$£c
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

234 
$tim”s
[
$Çme
]['¡¬t'] = ()
$u£c
 + ()
$£c
;

235 
$tim”s
[
$Çme
]['couÁ'] = 
	`is£t
($timers[$name]['count']) ? ++$timers[$name]['count'] : 1;

236 
	}
}

246 
funùiÚ
 
	$tim”_»ad
(
$Çme
) {

247 
glob®
 
$tim”s
;

249 ià(
	`is£t
(
$tim”s
[
$Çme
]['start'])) {

250 
	`li¡
(
$u£c
, 
$£c
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

251 
$¡İ
 = ()
$u£c
 + ()
$£c
;

252 
$diff
 = 
	`round
((
$¡İ
 - 
$tim”s
[
$Çme
]['start']) * 1000, 2);

254 ià(
	`is£t
(
$tim”s
[
$Çme
]['time'])) {

255 
$diff
 +ğ
$tim”s
[
$Çme
]['time'];

257  
$diff
;

259 
	}
}

271 
funùiÚ
 
	$tim”_¡İ
(
$Çme
) {

272 
glob®
 
$tim”s
;

274 
$tim”s
[
$Çme
]['time'] = 
	`tim”_»ad
($name);

275 
	`un£t
(
$tim”s
[
$Çme
]['start']);

277  
$tim”s
[
$Çme
];

278 
	}
}

320 
funùiÚ
 
	$cÚf_·th
(
$»quœe_£‰šgs
 = 
TRUE
, 
$»£t
 = 
FALSE
) {

321 
$cÚf
 = '';

323 ià(
$cÚf
 && !
$»£t
) {

324  
$cÚf
;

327 
$cÚfdœ
 = 'sites';

328 
$uri
 = 
	`ex¶ode
('/', 
$_SERVER
['SCRIPT_NAME'] ? $_SERVER['SCRIPT_NAME'] : $_SERVER['SCRIPT_FILENAME']);

329 
$£rv”
 = 
	`ex¶ode
('.', 
	`im¶ode
('.', 
	`¬¿y_»v”£
Óx¶ode(':', 
	`¹rim
(
$_SERVER
['HTTP_HOST'], '.')))));

330 
$i
 = 
	`couÁ
(
$uri
) - 1; $i > 0; $i--) {

331 
$j
 = 
	`couÁ
(
$£rv”
); $j > 0; $j--) {

332 
$dœ
 = 
	`im¶ode
('.', 
	`¬¿y_¦iû
(
$£rv”
, -
$j
)è. im¶ode('.',‡¼ay_¦iû(
$uri
, 0, 
$i
));

333 ià(
	`fe_exi¡s
("$cÚfdœ/$dœ/£‰šgs.php"è|| (!
$»quœe_£‰šgs
 && file_exists("$confdir/$dir"))) {

334 
$cÚf
 = "$confdir/$dir";

335  
$cÚf
;

339 
$cÚf
 = "$confdir/default";

340  
$cÚf
;

341 
	}
}

346 
funùiÚ
 
	$dru·l_un£t_glob®s
() {

347 ià(
	`ši_g‘
('register_globals')) {

348 
$®lowed
 = 
	`¬¿y
('_ENV' => 1, '_GET' => 1, '_POST' => 1, '_COOKIE' => 1, '_FILES' => 1, '_SERVER' => 1, '_REQUEST' => 1, 'GLOBALS' => 1);

349 
	`fÜ—ch
 (
$GLOBALS
 
as
 
$key
 => 
$v®ue
) {

350 ià(!
	`is£t
(
$®lowed
[
$key
])) {

351 
	`un£t
(
$GLOBALS
[
$key
]);

355 
	}
}

367 
funùiÚ
 
	$dru·l_v®id_h‰p_ho¡
(
$ho¡
) {

368  
	`´eg_m©ch
('/^\[?(?:[a-z0-9-:\]_]+\.?)+$/', 
$ho¡
);

369 
	}
}

375 
funùiÚ
 
	$cÚf_š™
() {

376 
glob®
 
$ba£_u¾
, 
$ba£_·th
, 
$ba£_roÙ
;

379 
glob®
 
$db_u¾
, 
$db_´efix
, 
$cook›_domaš
, 
$cÚf
, 
$š¡®Ëd_´ofe
, 
$upd©e_ä“_acûss
;

380 
$cÚf
 = 
	`¬¿y
();

382 ià(
	`is£t
(
$_SERVER
['HTTP_HOST'])) {

386 
$_SERVER
['HTTP_HOST'] = 
	`¡¹Şow”
($_SERVER['HTTP_HOST']);

387 ià(!
	`dru·l_v®id_h‰p_ho¡
(
$_SERVER
['HTTP_HOST'])) {

389 
	`h—d”
('HTTP/1.1 400 Bad Request');

390 
ex™
;

396 
$_SERVER
['HTTP_HOST'] = '';

399 ià(
	`fe_exi¡s
('./'. 
	`cÚf_·th
() .'/settings.php')) {

400 
šşude_Úû
 './'. 
	`cÚf_·th
() .'/settings.php';

404 ià(
	`is£t
(
$db_u¾
) && $db_url == 'mysql://username:password@localhost/databasename') {

405 
$db_u¾
 = '';

408 ià(
	`is£t
(
$ba£_u¾
)) {

410 
$·¹s
 = 
	`·r£_u¾
(
$ba£_u¾
);

411 ià(!
	`is£t
(
$·¹s
['path'])) {

412 
$·¹s
['path'] = '';

414 
$ba£_·th
 = 
$·¹s
['path'] .'/';

416 
$ba£_roÙ
 = 
	`sub¡r
(
$ba£_u¾
, 0, 
	`¡¾’
($ba£_u¾è- sŒËn(
$·¹s
['path']));

420 
$ba£_roÙ
 = (
	`is£t
(
$_SERVER
['HTTPS']) && $_SERVER['HTTPS'] == 'on') ? 'https' : 'http';

422 
$ba£_u¾
 = 
$ba£_roÙ
 .ğ'://'. 
$_SERVER
['HTTP_HOST'];

426 ià(
$dœ
 = 
	`Œim
(
	`dœÇme
(
$_SERVER
['SCRIPT_NAME']), '\,/')) {

427 
$ba£_·th
 = "/$dir";

428 
$ba£_u¾
 .ğ
$ba£_·th
;

429 
$ba£_·th
 .= '/';

432 
$ba£_·th
 = '/';

436 ià(
$cook›_domaš
) {

438 
$£ssiÚ_Çme
 = 
$cook›_domaš
;

443 
	`li¡
Ğ, 
$£ssiÚ_Çme
èğ
	`ex¶ode
('://', 
$ba£_u¾
, 2);

445 ià(!
	`em±y
(
$_SERVER
['HTTP_HOST'])) {

446 
$cook›_domaš
 = 
	`check_¶aš
(
$_SERVER
['HTTP_HOST']);

448 
$cook›_domaš
 = 
	`Érim
($cookie_domain, '.');

449 ià(
	`¡½os
(
$cook›_domaš
, 'www.') === 0) {

450 
$cook›_domaš
 = 
	`sub¡r
($cookie_domain, 4);

452 
$cook›_domaš
 = 
	`ex¶ode
(':', $cookie_domain);

453 
$cook›_domaš
 = '.'. $cookie_domain[0];

462 ià(
	`ši_g‘
('session.cookie_secure')) {

463 
$£ssiÚ_Çme
 .= 'SSL';

467 ià(
	`couÁ
(
	`ex¶ode
('.', 
$cook›_domaš
)è> 2 && !
	`is_num”ic
(
	`¡r_»¶aû
('.', '', $cookie_domain))) {

468 
	`ši_£t
('£ssiÚ.cook›_domaš', 
$cook›_domaš
);

470 
	`£ssiÚ_Çme
('SESS'. 
	`md5
(
$£ssiÚ_Çme
));

471 
	}
}

501 
funùiÚ
 
	$dru·l_g‘_f’ame
(
$ty³
, 
$Çme
, 
$f’ame
 = 
NULL
) {

502 
$fes
 = 
	`¬¿y
();

504 ià(!
	`is£t
(
$fes
[
$ty³
])) {

505 
$fes
[
$ty³
] = 
	`¬¿y
();

508 ià(!
	`em±y
(
$f’ame
è&& 
	`fe_exi¡s
($filename)) {

509 
$fes
[
$ty³
][
$Çme
] = 
$f’ame
;

511 
	`–£if
 (
	`is£t
(
$fes
[
$ty³
][
$Çme
])) {

518 
	`–£if
 (
	`db_is_aùive
(è&& ((
$fe
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT f’amFROM {sy¡em} WHERE‚amğ'%s' ANDy³ = '%s'", 
$Çme
, 
$ty³
))è&& 
	`fe_exi¡s
($file))) {

519 
$fes
[
$ty³
][
$Çme
] = 
$fe
;

524 
$cÚfig
 = 
	`cÚf_·th
();

525 
$dœ
 = ((
$ty³
 == 'theme_engine') ? 'themes/engines' : "${type}s");

526 
$fe
 = ((
$ty³
 == 'theme_engine') ? "$name.engine" : "$name.$type");

528 
	`fÜ—ch
 (
	`¬¿y
("$cÚfig/$dœ/$fe", "$cÚfig/$dœ/$Çme/$fe", "$dœ/$fe", "$dœ/$Çme/$fe"è
as
 
$fe
) {

529 ià(
	`fe_exi¡s
(
$fe
)) {

530 
$fes
[
$ty³
][
$Çme
] = 
$fe
;

536 ià(
	`is£t
(
$fes
[
$ty³
][
$Çme
])) {

537  
$fes
[
$ty³
][
$Çme
];

539 
	}
}

548 
funùiÚ
 
v¬ŸbË_š™
(
$cÚf
 = 
	$¬¿y
()) {

550 ià(
$ÿched
 = 
	`ÿche_g‘
('variables', 'cache')) {

551 
$v¬ŸbËs
 = 
$ÿched
->
d©a
;

554 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {variable}');

555 
$v¬ŸbË
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

556 
$v¬ŸbËs
[
$v¬ŸbË
->
Çme
] = 
	`un£rŸlize
($v¬ŸbË->
v®ue
);

558 
	`ÿche_£t
('v¬ŸbËs', 
$v¬ŸbËs
);

561 
	`fÜ—ch
 (
$cÚf
 
as
 
$Çme
 => 
$v®ue
) {

562 
$v¬ŸbËs
[
$Çme
] = 
$v®ue
;

565  
$v¬ŸbËs
;

566 
	}
}

584 
funùiÚ
 
	$v¬ŸbË_g‘
(
$Çme
, 
$deçuÉ
) {

585 
glob®
 
$cÚf
;

587  
	`is£t
(
$cÚf
[
$Çme
]è? $cÚf[$Çme] : 
$deçuÉ
;

588 
	}
}

605 
funùiÚ
 
	$v¬ŸbË_£t
(
$Çme
, 
$v®ue
) {

606 
glob®
 
$cÚf
;

608 
$£rŸlized_v®ue
 = 
	`£rŸlize
(
$v®ue
);

609 
	`db_qu”y
("UPDATE {v¬ŸbË} SET v®uğ'%s' WHERE‚amğ'%s'", 
$£rŸlized_v®ue
, 
$Çme
);

610 ià(!
	`db_afãùed_rows
()) {

611 @
	`db_qu”y
("INSERT INTO {v¬ŸbË} (Çme, v®ueèVALUES ('%s', '%s')", 
$Çme
, 
$£rŸlized_v®ue
);

614 
	`ÿche_ş—r_®l
('variables', 'cache');

616 
$cÚf
[
$Çme
] = 
$v®ue
;

617 
	}
}

631 
funùiÚ
 
	$v¬ŸbË_d–
(
$Çme
) {

632 
glob®
 
$cÚf
;

634 
	`db_qu”y
("DELETE FROM {v¬ŸbË} WHERE‚amğ'%s'", 
$Çme
);

635 
	`ÿche_ş—r_®l
('variables', 'cache');

637 
	`un£t
(
$cÚf
[
$Çme
]);

638 
	}
}

651 
funùiÚ
 
	$·ge_g‘_ÿche
(
$¡©us_Úly
 = 
FALSE
) {

652 
$¡©us
 = 
FALSE
;

653 
glob®
 
$u£r
, 
$ba£_roÙ
;

655 ià(
$¡©us_Úly
) {

656  
$¡©us
;

658 
$ÿche
 = 
NULL
;

660 ià(!
$u£r
->
uid
 && 
$_SERVER
['REQUEST_METHOD'] =ğ'GET' && 
	`couÁ
(
	`dru·l_£t_mes§ge
()) == 0 && $_SERVER['SERVER_SOFTWARE'] !== 'PHP CLI') {

661 
$ÿche
 = 
	`ÿche_g‘
(
$ba£_roÙ
 . 
	`»que¡_uri
(), 'cache_page');

663 ià(
	`em±y
(
$ÿche
)) {

664 
	`ob_¡¬t
();

665 
$¡©us
 = 
TRUE
;

669  
$ÿche
;

670 
	}
}

678 
funùiÚ
 
	$boÙ¡¿p_švoke_®l
(
$hook
) {

679 
	`fÜ—ch
 (
	`moduË_li¡
(
TRUE
, TRUEè
as
 
$moduË
) {

680 
	`dru·l_lßd
('moduË', 
$moduË
);

681 
	`moduË_švoke
(
$moduË
, 
$hook
);

683 
	}
}

697 
funùiÚ
 
	$dru·l_lßd
(
$ty³
, 
$Çme
) {

698 
$fes
 = 
	`¬¿y
();

700 ià(
	`is£t
(
$fes
[
$ty³
][
$Çme
])) {

701  
TRUE
;

704 
$f’ame
 = 
	`dru·l_g‘_f’ame
(
$ty³
, 
$Çme
);

706 ià(
$f’ame
) {

707 
šşude_Úû
 "./$filename";

708 
$fes
[
$ty³
][
$Çme
] = 
TRUE
;

710  
TRUE
;

713  
FALSE
;

714 
	}
}

725 
funùiÚ
 
	$dru·l_·ge_h—d”
() {

726 
	`h—d”
("Expires: Sun, 19 Nov 1978 05:00:00 GMT");

727 
	`h—d”
("La¡-Modif›d: ". 
	`gmd©e
("D, d M Y H:i:s") ." GMT");

728 
	`h—d”
("Cache-Control: store,‚o-cache, must-revalidate");

729 
	`h—d”
("Cache-CÚŒŞ:…o¡-check=0,…»-check=0", 
FALSE
);

730 
	}
}

741 
funùiÚ
 
	$dru·l_·ge_ÿche_h—d”
(
$ÿche
) {

743 
$Ï¡_modif›d
 = 
	`gmd©e
('D, d M Y H:i:s', 
$ÿche
->
ü—‹d
) .' GMT';

744 
$‘ag
 = '"'. 
	`md5
(
$Ï¡_modif›d
) .'"';

747 
$if_modif›d_sšû
 = 
	`is£t
(
$_SERVER
['HTTP_IF_MODIFIED_SINCE']è? 
	`¡r¦ashes
($_SERVER['HTTP_IF_MODIFIED_SINCE']è: 
FALSE
;

748 
$if_nÚe_m©ch
 = 
	`is£t
(
$_SERVER
['HTTP_IF_NONE_MATCH']è? 
	`¡r¦ashes
($_SERVER['HTTP_IF_NONE_MATCH']è: 
FALSE
;

750 ià(
$if_modif›d_sšû
 && 
$if_nÚe_m©ch


751 && 
$if_nÚe_m©ch
 =ğ
$‘ag


752 && 
$if_modif›d_sšû
 =ğ
$Ï¡_modif›d
) {

753 
	`h—d”
('HTTP/1.1 304 Not Modified');

755 
	`h—d”
("Etag: $etag");

760 
	`h—d”
("Last-Modified: $last_modified");

761 
	`h—d”
("ETag: $etag");

764 
	`h—d”
("Expires: Sun, 19 Nov 1978 05:00:00 GMT");

765 
	`h—d”
("Cache-Control: must-revalidate");

767 ià(
	`v¬ŸbË_g‘
('·ge_com´essiÚ', 
TRUE
è&& 
	`ex‹nsiÚ_lßded
('zlib')) {

769 ià(
	`is£t
(
$_SERVER
['HTTP_ACCEPT_ENCODING']è&& 
	`¡½os
($_SERVER['HTTP_ACCEPT_ENCODING'], 'gz'è!=ğ
FALSE
) {

772 
	`ši_£t
('zlib.output_compression', '0');

773 
	`h—d”
('Content-Encoding: gzip');

778 
$ÿche
->
d©a
 = 
	`gzšæ©e
(
	`sub¡r
(substr($cache->data, 10), 0, -8));

785 
$h—d”s
 = 
	`ex¶ode
("\n", 
$ÿche
->
h—d”s
);

786 
	`fÜ—ch
 (
$h—d”s
 
as
 
$h—d”
) {

787 
	`h—d”
(
$h—d”
);

790 
´št
 
$ÿche
->
d©a
;

791 
	}
}

796 
funùiÚ
 
	$boÙ¡¿p_hooks
() {

797  
	`¬¿y
('boot', 'exit');

798 
	}
}

808 
funùiÚ
 
dru·l_uÅack
(
$obj
, 
$f›ld
 = 'data') {

809 ià(
$obj
->
$f›ld
 && 
$d©a
 = 
un£rŸlize
($obj->$field)) {

810 
fÜ—ch
 (
$d©a
 
as
 
$key
 => 
$v®ue
) {

811 ià(!
em±y
(
$key
è&& !
is£t
(
$obj
->$key)) {

812 
$obj
->
$key
 = 
$v®ue
;

816  
	g$obj
;

822 
funùiÚ
 
	$»ã»r_uri
() {

823 ià(
	`is£t
(
$_SERVER
['HTTP_REFERER'])) {

824  
$_SERVER
['HTTP_REFERER'];

826 
	}
}

842 
funùiÚ
 
	$check_¶aš
(
$‹xt
) {

843 
$php525
;

845 ià(!
	`is£t
(
$php525
)) {

846 
$php525
 = 
	`v”siÚ_com·»
(
PHP_VERSION
, '5.2.5', '>=');

856 ià(
$php525
) {

857  
	`html¥ecŸlch¬s
(
$‹xt
, 
ENT_QUOTES
, 'UTF-8');

859  (
	`´eg_m©ch
('/^./us', 
$‹xt
è=ğ1è? 
	`html¥ecŸlch¬s
($‹xt, 
ENT_QUOTES
, 'UTF-8') : '';

860 
	}
}

891 
funùiÚ
 
	$dru·l_v®id©e_utf8
(
$‹xt
) {

892 ià(
	`¡¾’
(
$‹xt
) == 0) {

893  
TRUE
;

896  (
	`´eg_m©ch
('/^./us', 
$‹xt
) == 1);

897 
	}
}

903 
funùiÚ
 
	$»que¡_uri
() {

905 ià(
	`is£t
(
$_SERVER
['REQUEST_URI'])) {

906 
$uri
 = 
$_SERVER
['REQUEST_URI'];

909 ià(
	`is£t
(
$_SERVER
['argv'])) {

910 
$uri
 = 
$_SERVER
['SCRIPT_NAME'] .'?'. $_SERVER['argv'][0];

912 
	`–£if
 (
	`is£t
(
$_SERVER
['QUERY_STRING'])) {

913 
$uri
 = 
$_SERVER
['SCRIPT_NAME'] .'?'. $_SERVER['QUERY_STRING'];

916 
$uri
 = 
$_SERVER
['SCRIPT_NAME'];

920 
$uri
 = '/'. 
	`Érim
($uri, '/');

922  
$uri
;

923 
	}
}

947 
funùiÚ
 
w©chdog
(
$ty³
, 
$mes§ge
, 
$v¬ŸbËs
 = 
¬¿y
(), 
$£v”™y
 = 
WATCHDOG_NOTICE
, 
$lšk
 = 
NULL
) {

948 
glob®
 
$u£r
, 
$ba£_roÙ
;

951 
	g$log_mes§ge
 = 
¬¿y
(

952 'ty³' => 
$ty³
,

953 'mes§ge' => 
$mes§ge
,

954 'v¬ŸbËs' => 
$v¬ŸbËs
,

955 '£v”™y' => 
$£v”™y
,

956 'lšk' => 
$lšk
,

957 'u£r' => 
$u£r
,

958 '»que¡_uri' => 
$ba£_roÙ
 . 
»que¡_uri
(),

959 '»ã»r' => 
»ã»r_uri
(),

960 '' => 
_add»ss
(),

961 'time¡amp' => 
time
(),

965 
fÜ—ch
 (
moduË_im¶em’ts
('w©chdog'è
as
 
$moduË
) {

966 
moduË_švoke
(
$moduË
, 'w©chdog', 
$log_mes§ge
);

988 
funùiÚ
 
dru·l_£t_mes§ge
(
$mes§ge
 = 
NULL
, 
$ty³
 = '¡©us', 
$»³©
 = 
TRUE
) {

989 ià(
$mes§ge
) {

990 ià(!
is£t
(
$_SESSION
['messages'])) {

991 
$_SESSION
['mes§ges'] = 
¬¿y
();

994 ià(!
is£t
(
$_SESSION
['mes§ges'][
$ty³
])) {

995 
	g$_SESSION
['mes§ges'][
$ty³
] = 
¬¿y
();

998 ià(
	g$»³©
 || !
š_¬¿y
(
$mes§ge
, 
$_SESSION
['mes§ges'][
$ty³
])) {

999 
	g$_SESSION
['mes§ges'][
$ty³
][] = 
$mes§ge
;

1004  
is£t
(
$_SESSION
['mes§ges']è? 
	g$_SESSION
['mes§ges'] : 
NULL
;

1020 
funùiÚ
 
	$dru·l_g‘_mes§ges
(
$ty³
 = 
NULL
, 
$ş—r_queue
 = 
TRUE
) {

1021 ià(
$mes§ges
 = 
	`dru·l_£t_mes§ge
()) {

1022 ià(
$ty³
) {

1023 ià(
$ş—r_queue
) {

1024 
	`un£t
(
$_SESSION
['mes§ges'][
$ty³
]);

1026 ià(
	`is£t
(
$mes§ges
[
$ty³
])) {

1027  
	`¬¿y
(
$ty³
 => 
$mes§ges
[$type]);

1031 ià(
$ş—r_queue
) {

1032 
	`un£t
(
$_SESSION
['messages']);

1034  
$mes§ges
;

1037  
	`¬¿y
();

1038 
	}
}

1058 
funùiÚ
 
	$dru·l_is_d’›d
(
$ty³
, 
$mask
) {

1064 
$sql
 = "SELECT 1 FROM {access} WHEREype = '%s' AND LOWER('%s') LIKE LOWER(mask) AND status = %d";

1065  
	`db_»suÉ
(
	`db_qu”y_¿nge
(
$sql
, 
$ty³
, 
$mask
, 0, 0, 1)) && !db_result(db_query_range($sql, $type, $mask, 1, 0, 1));

1066 
	}
}

1073 
funùiÚ
 
dru·l_ªÚymous_u£r
(
$£ssiÚ
 = '') {

1074 
$u£r
 = 
Ãw
 
¡dCÏss
();

1075 
	g$u£r
->
	guid
 = 0;

1076 
	g$u£r
->
	gho¡Çme
 = 
_add»ss
();

1077 
	g$u£r
->
	grŞes
 = 
¬¿y
();

1078 
	g$u£r
->
	grŞes
[
DRUPAL_ANONYMOUS_RID
] = 'anonymous user';

1079 
	g$u£r
->
	g£ssiÚ
 = 
$£ssiÚ
;

1080 
	g$u£r
->
	gÿche
 = 0;

1081  
	g$u£r
;

1104 
funùiÚ
 
	$dru·l_boÙ¡¿p
(
$pha£
) {

1105 
$pha£s
 = 
	`¬¿y
(
DRUPAL_BOOTSTRAP_CONFIGURATION
, 
DRUPAL_BOOTSTRAP_EARLY_PAGE_CACHE
, 
DRUPAL_BOOTSTRAP_DATABASE
, 
DRUPAL_BOOTSTRAP_ACCESS
, 
DRUPAL_BOOTSTRAP_SESSION
, 
DRUPAL_BOOTSTRAP_LATE_PAGE_CACHE
, 
DRUPAL_BOOTSTRAP_LANGUAGE
, 
DRUPAL_BOOTSTRAP_PATH
, 
DRUPAL_BOOTSTRAP_FULL
), 
$pha£_šdex
 = 0;

1107 
$pha£
 >ğ
$pha£_šdex
 && 
	`is£t
(
$pha£s
[$phase_index])) {

1108 
$cu¼’t_pha£
 = 
$pha£s
[
$pha£_šdex
];

1109 
	`un£t
(
$pha£s
[
$pha£_šdex
++]);

1110 
	`_dru·l_boÙ¡¿p
(
$cu¼’t_pha£
);

1112 
	}
}

1114 
funùiÚ
 
	$_dru·l_boÙ¡¿p
(
$pha£
) {

1115 
glob®
 
$cÚf
;

1117 
$pha£
) {

1119 
DRUPAL_BOOTSTRAP_CONFIGURATION
:

1120 
	`dru·l_un£t_glob®s
();

1122 
	`tim”_¡¬t
('page');

1124 
	`cÚf_š™
();

1127 
DRUPAL_BOOTSTRAP_EARLY_PAGE_CACHE
:

1130 
»quœe_Úû
 
	`v¬ŸbË_g‘
('cache_inc', './includes/cache.inc');

1135 ià(
	`v¬ŸbË_g‘
('·ge_ÿche_ç¡·th', 
FALSE
è&& 
	`·ge_ÿche_ç¡·th
()) {

1136 
ex™
;

1140 
DRUPAL_BOOTSTRAP_DATABASE
:

1142 
»quœe_Úû
 './includes/database.inc';

1143 
	`db_£t_aùive
();

1146 
»quœe_Úû
 
	`v¬ŸbË_g‘
('lock_inc', './includes/lock.inc');

1147 
	`lock_š™
();

1150 
DRUPAL_BOOTSTRAP_ACCESS
:

1152 ià(
	`dru·l_is_d’›d
('ho¡', 
	`_add»ss
())) {

1153 
	`h—d”
('HTTP/1.1 403 Forbidden');

1154 
´št
 'SÜry, '. 
	`check_¶aš
(
	`_add»ss
()) .' has been banned.';

1155 
	`ex™
();

1159 
DRUPAL_BOOTSTRAP_SESSION
:

1160 
»quœe_Úû
 
	`v¬ŸbË_g‘
('session_inc', './includes/session.inc');

1161 
	`£ssiÚ_£t_§ve_hªdËr
('sess_open', 'sess_close', 'sess_read', 'sess_write', 'sess_destroy_sid', 'sess_gc');

1162 
	`£ssiÚ_¡¬t
();

1165 
DRUPAL_BOOTSTRAP_LATE_PAGE_CACHE
:

1167 
$cÚf
 = 
	`v¬ŸbË_š™
(
	`is£t
($cÚfè? $cÚà: 
	`¬¿y
());

1168 
$ÿche_mode
 = 
	`v¬ŸbË_g‘
('ÿche', 
CACHE_DISABLED
);

1170 
$ÿche
 = 
$ÿche_mode
 =ğ
CACHE_DISABLED
 ? '' : 
	`·ge_g‘_ÿche
();

1172 ià(!
$ÿche
 || 
$ÿche_mode
 !ğ
CACHE_AGGRESSIVE
) {

1174 
»quœe_Úû
 './includes/module.inc';

1175 
	`boÙ¡¿p_švoke_®l
('boot');

1178 ià(
$ÿche
) {

1179 
	`dru·l_·ge_ÿche_h—d”
(
$ÿche
);

1181 ià(
$ÿche_mode
 !ğ
CACHE_AGGRESSIVE
) {

1182 
	`boÙ¡¿p_švoke_®l
('exit');

1185 
ex™
;

1188 
	`dru·l_·ge_h—d”
();

1191 
DRUPAL_BOOTSTRAP_LANGUAGE
:

1192 
	`dru·l_š™_Ïnguage
();

1195 
DRUPAL_BOOTSTRAP_PATH
:

1196 
»quœe_Úû
 './includes/path.inc';

1198 
	`dru·l_š™_·th
();

1201 
DRUPAL_BOOTSTRAP_FULL
:

1202 
»quœe_Úû
 './includes/common.inc';

1203 
	`_dru·l_boÙ¡¿p_fuÎ
();

1206 
	}
}

1216 
funùiÚ
 
	$dru·l_maš‹Çnû_theme
() {

1217 
»quœe_Úû
 './includes/theme.maintenance.inc';

1218 
	`_dru·l_maš‹Çnû_theme
();

1219 
	}
}

1225 
funùiÚ
 
	$g‘_t
() {

1226 
$t
;

1227 ià(
	`is_nuÎ
(
$t
)) {

1228 
$t
 = 
	`funùiÚ_exi¡s
('install_main') ? 'st' : 't';

1230  
$t
;

1231 
	}
}

1236 
funùiÚ
 
	$dru·l_š™_Ïnguage
() {

1237 
glob®
 
$Ïnguage
, 
$u£r
;

1241 ià(
	`v¬ŸbË_g‘
('language_count', 1) == 1) {

1242 
$Ïnguage
 = 
	`Ïnguage_deçuÉ
();

1245 
šşude_Úû
 './includes/language.inc';

1246 
$Ïnguage
 = 
	`Ïnguage_š™Ÿlize
();

1248 
	}
}

1256 
funùiÚ
 
Ïnguage_li¡
(
$f›ld
 = 'Ïnguage', 
$»£t
 = 
FALSE
) {

1257 
$Ïnguages
 = 
NULL
;

1260 ià(
	g$»£t
) {

1261 
	g$Ïnguages
 = 
NULL
;

1265 ià(!
is£t
(
$Ïnguages
)) {

1266 ià(
v¬ŸbË_g‘
('Ïnguage_couÁ', 1è> 1 || 
moduË_exi¡s
('locale')) {

1267 
	g$»suÉ
 = 
db_qu”y
('SELECT * FROM {languages} ORDER BY weight ASC,‚ame ASC');

1268 
	g$row
 = 
db_ãtch_objeù
(
$»suÉ
)) {

1269 
$Ïnguages
['Ïnguage'][
$row
->
Ïnguage
] = $row;

1274 
	g$deçuÉ
 = 
Ïnguage_deçuÉ
();

1275 
	g$Ïnguages
['Ïnguage'][
$deçuÉ
->
Ïnguage
] = $default;

1280 ià(!
is£t
(
$Ïnguages
[
$f›ld
])) {

1281 
	g$Ïnguages
[
$f›ld
] = 
¬¿y
();

1282 
fÜ—ch
 (
$Ïnguages
['Ïnguage'] 
as
 
$Ïng
) {

1284 ià(
š_¬¿y
(
$f›ld
, 
¬¿y
('enabled', 'weight'))) {

1285 
	g$Ïnguages
[
$f›ld
][
$Ïng
->$f›ld][$Ïng->
Ïnguage
] = $lang;

1288 
	g$Ïnguages
[
$f›ld
][
$Ïng
->$field] = $lang;

1292  
	g$Ïnguages
[
$f›ld
];

1301 
funùiÚ
 
	$Ïnguage_deçuÉ
(
$´İ”ty
 = 
NULL
) {

1302 
$Ïnguage
 = 
	`v¬ŸbË_g‘
('Ïnguage_deçuÉ', (
objeù
è
	`¬¿y
('language' => 'en', 'name' => 'English', 'native' => 'English', 'direction' => 0, 'enabled' => 1, 'plurals' => 0, 'formula' => '', 'domain' => '', 'prefix' => '', 'weight' => 0, 'javascript' => ''));

1303  
$´İ”ty
 ? 
$Ïnguage
->$property : $language;

1304 
	}
}

1314 
funùiÚ
 
	$_add»ss
() {

1315 
$_add»ss
 = 
NULL
;

1317 ià(!
	`is£t
(
$_add»ss
)) {

1318 
$_add»ss
 = 
$_SERVER
['REMOTE_ADDR'];

1319 ià(
	`v¬ŸbË_g‘
('»v”£_´oxy', 0è&& 
	`¬¿y_key_exi¡s
('HTTP_X_FORWARDED_FOR', 
$_SERVER
)) {

1322 
$»v”£_´oxy_add»s£s
 = 
	`v¬ŸbË_g‘
('»v”£_´oxy_add»s£s', 
	`¬¿y
());

1323 ià(!
	`em±y
(
$»v”£_´oxy_add»s£s
è&& 
	`š_¬¿y
(
$_add»ss
, $»v”£_´oxy_add»s£s, 
TRUE
)) {

1326 
$_add»ss_·¹s
 = 
	`ex¶ode
(',', 
$_SERVER
['HTTP_X_FORWARDED_FOR']);

1327 
$_add»ss
 = 
	`¬¿y_pİ
(
$_add»ss_·¹s
);

1332  
$_add»ss
;

1333 
	}
}

	@/srv/http/subs/notes/www/includes/cache-install.inc

1 <?
php


14 
funùiÚ
 
ÿche_g‘
(
$key
, 
$bË
 = 'cache') {

15  
FALSE
;

18 
funùiÚ
 
ÿche_£t
(
$cid
, 
$d©a
, 
$bË
 = 'ÿche', 
$expœe
 = 
CACHE_PERMANENT
, 
$h—d”s
 = 
NULL
) {

22 
funùiÚ
 
	$ÿche_ş—r_®l
(
$cid
 = 
NULL
, 
$bË
 = NULL, 
$wdÿrd
 = 
FALSE
) {

24 
	}
}

	@/srv/http/subs/notes/www/includes/cache.inc

1 <?
php


14 
funùiÚ
 
ÿche_g‘
(
$cid
, 
$bË
 = 'cache') {

15 
glob®
 
$u£r
;

18 
	g$ÿche_æush
 = 
v¬ŸbË_g‘
('ÿche_æush_'. 
$bË
, 0);

19 ià(
	g$ÿche_æush
 && ($ÿche_æush + 
v¬ŸbË_g‘
('ÿche_liãtime', 0è<ğ
time
())) {

21 
v¬ŸbË_£t
('ÿche_æush_'. 
$bË
, 0);

23 
db_qu”y
("DELETE FROM {". 
$bË
 ."} WHEREƒxpœ!ğ%d ANDƒxpœ<ğ%d", 
CACHE_PERMANENT
, 
$ÿche_æush
);

26 
	g$ÿche
 = 
db_ãtch_objeù
(
db_qu”y
("SELECT d©a, c»©ed, h—d”s,ƒxpœe, s”Ÿlized FROM {". 
$bË
 ."} WHERE cid = '%s'", 
$cid
));

27 ià(
is£t
(
$ÿche
->
d©a
)) {

30 ià(
	g$ÿche
->
	gexpœe
 =ğ
CACHE_PERMANENT
 || !
v¬ŸbË_g‘
('cache_lifetime', 0)) {

31 
	g$ÿche
->
	gd©a
 = 
db_decode_blob
(
$ÿche
->
d©a
);

32 ià(
	g$ÿche
->
	g£rŸlized
) {

33 
	g$ÿche
->
	gd©a
 = 
un£rŸlize
(
$ÿche
->
d©a
);

42 ià(
	g$u£r
->
	gÿche
 > 
	g$ÿche
->
	gü—‹d
) {

47 
	g$ÿche
->
	gd©a
 = 
db_decode_blob
(
$ÿche
->
d©a
);

48 ià(
	g$ÿche
->
	g£rŸlized
) {

49 
	g$ÿche
->
	gd©a
 = 
un£rŸlize
(
$ÿche
->
d©a
);

53  
	g$ÿche
;

102 
funùiÚ
 
ÿche_£t
(
$cid
, 
$d©a
, 
$bË
 = 'ÿche', 
$expœe
 = 
CACHE_PERMANENT
, 
$h—d”s
 = 
NULL
) {

103 
$£rŸlized
 = 0;

104 ià(
is_objeù
(
$d©a
è|| 
is_¬¿y
($data)) {

105 
	g$d©a
 = 
£rŸlize
(
$d©a
);

106 
	g$£rŸlized
 = 1;

108 
	g$ü—‹d
 = 
time
();

109 
db_qu”y
("UPDATE {". 
$bË
 ."} SET d©¨ğ%b, c»©ed = %d,ƒxpœğ%d, h—d” ğ'%s', s”Ÿlized = %d WHERE cid = '%s'", 
$d©a
, 
$ü—‹d
, 
$expœe
, 
$h—d”s
, 
$£rŸlized
, 
$cid
);

110 ià(!
db_afãùed_rows
()) {

111 @
db_qu”y
("INSERT INTO {". 
$bË
 ."} (cid, d©a, c»©ed,ƒxpœe, h—d”s, s”ŸlizedèVALUES ('%s', %b, %d, %d, '%s', %d)", 
$cid
, 
$d©a
, 
$ü—‹d
, 
$expœe
, 
$h—d”s
, 
$£rŸlized
);

133 
funùiÚ
 
	$ÿche_ş—r_®l
(
$cid
 = 
NULL
, 
$bË
 = NULL, 
$wdÿrd
 = 
FALSE
) {

134 
glob®
 
$u£r
;

136 ià(!
	`is£t
(
$cid
è&& !is£t(
$bË
)) {

139 
	`ÿche_ş—r_®l
(
NULL
, 'cache_block');

140 
	`ÿche_ş—r_®l
(
NULL
, 'cache_page');

144 ià(
	`em±y
(
$cid
)) {

145 ià(
	`v¬ŸbË_g‘
('cache_lifetime', 0)) {

150 
$u£r
->
ÿche
 = 
	`time
();

152 
$ÿche_æush
 = 
	`v¬ŸbË_g‘
('ÿche_æush_'. 
$bË
, 0);

153 ià(
$ÿche_æush
 == 0) {

155 
	`v¬ŸbË_£t
('ÿche_æush_'. 
$bË
, 
	`time
());

157 ià(
	`time
(è> (
$ÿche_æush
 + 
	`v¬ŸbË_g‘
('cache_lifetime', 0))) {

160 
	`db_qu”y
("DELETE FROM {". 
$bË
 ."} WHEREƒxpœ!ğ%d ANDƒxpœ< %d", 
CACHE_PERMANENT
, 
	`time
());

161 
	`v¬ŸbË_£t
('ÿche_æush_'. 
$bË
, 0);

166 
	`db_qu”y
("DELETE FROM {". 
$bË
 ."} WHEREƒxpœ!ğ%d ANDƒxpœ< %d", 
CACHE_PERMANENT
, 
	`time
());

170 ià(
$wdÿrd
) {

171 ià(
$cid
 == '*') {

172 
	`db_qu”y
("TRUNCATE TABLE {". 
$bË
 ."}");

175 
	`db_qu”y
("DELETE FROM {". 
$bË
 ."} WHERE cid LIKE '%s%%'", 
$cid
);

179 
	`db_qu”y
("DELETE FROM {". 
$bË
 ."} WHERE cid = '%s'", 
$cid
);

182 
	}
}

	@/srv/http/subs/notes/www/includes/common.inc

1 <?
php


15 
defše
('SAVED_NEW', 1);

20 
defše
('SAVED_UPDATED', 2);

25 
defše
('SAVED_DELETED', 3);

30 ià(!
defšed
('E_DEPRECATED')) {

31 
defše
('E_DEPRECATED', 8192);

42 
funùiÚ
 
	$dru·l_£t_cÚ‹Á
(
$»giÚ
 = 
NULL
, 
$d©a
 = NULL) {

43 
$cÚ‹Á
 = 
	`¬¿y
();

45 ià(!
	`is_nuÎ
(
$»giÚ
è&& !is_nuÎ(
$d©a
)) {

46 
$cÚ‹Á
[
$»giÚ
][] = 
$d©a
;

48  
$cÚ‹Á
;

49 
	}
}

60 
funùiÚ
 
dru·l_g‘_cÚ‹Á
(
$»giÚ
 = 
NULL
, 
$d–im™”
 = ' ') {

61 
$cÚ‹Á
 = 
dru·l_£t_cÚ‹Á
();

62 ià(
is£t
(
$»giÚ
)) {

63 ià(
is£t
(
$cÚ‹Á
[
$»giÚ
]è&& 
is_¬¿y
($content[$region])) {

64  
im¶ode
(
$d–im™”
, 
$cÚ‹Á
[
$»giÚ
]);

68 
fÜ—ch
 (
¬¿y_keys
(
$cÚ‹Á
è
as
 
$»giÚ
) {

69 ià(
is_¬¿y
(
$cÚ‹Á
[
$»giÚ
])) {

70 
	g$cÚ‹Á
[
$»giÚ
] = 
im¶ode
(
$d–im™”
, 
$cÚ‹Á
[$region]);

73  
	g$cÚ‹Á
;

84 
funùiÚ
 
	$dru·l_£t_b»adüumb
(
$b»adüumb
 = 
NULL
) {

85 
$¡Üed_b»adüumb
;

87 ià(!
	`is_nuÎ
(
$b»adüumb
)) {

88 
$¡Üed_b»adüumb
 = 
$b»adüumb
;

90  
$¡Üed_b»adüumb
;

91 
	}
}

96 
funùiÚ
 
	$dru·l_g‘_b»adüumb
() {

97 
$b»adüumb
 = 
	`dru·l_£t_b»adüumb
();

99 ià(
	`is_nuÎ
(
$b»adüumb
)) {

100 
$b»adüumb
 = 
	`m’u_g‘_aùive_b»adüumb
();

103  
$b»adüumb
;

104 
	}
}

111 
funùiÚ
 
	$dru·l_£t_html_h—d
(
$d©a
 = 
NULL
) {

112 
$¡Üed_h—d
 = '';

114 ià(!
	`is_nuÎ
(
$d©a
)) {

115 
$¡Üed_h—d
 .ğ
$d©a
 ."\n";

117  
$¡Üed_h—d
;

118 
	}
}

123 
funùiÚ
 
	$dru·l_g‘_html_h—d
() {

124 
$ouut
 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n";

125  
$ouut
 . 
	`dru·l_£t_html_h—d
();

126 
	}
}

131 
funùiÚ
 
	$dru·l_ş—r_·th_ÿche
() {

132 
	`dru·l_lookup_·th
('wipe');

133 
	}
}

141 
funùiÚ
 
	$dru·l_£t_h—d”
(
$h—d”
 = 
NULL
) {

145 
$¡Üed_h—d”s
 = 
	`¬¿y
();

147 ià(
	`¡¾’
(
$h—d”
)) {

148 
	`h—d”
(
$h—d”
);

149 
$¡Üed_h—d”s
[] = 
$h—d”
;

151  
	`im¶ode
("\n", 
$¡Üed_h—d”s
);

152 
	}
}

157 
funùiÚ
 
	$dru·l_g‘_h—d”s
() {

158  
	`dru·l_£t_h—d”
();

159 
	}
}

164 
funùiÚ
 
	$dru·l_fš®_m¬kup
(
$cÚ‹Á
) {

167  
	`´eg_»¶aû
('/<h—d[^>]*>/i', "\$0\n<m‘¨h‰p-equiv=\"CÚ‹Á-Ty³\" cÚ‹Á=\"‹xt/html; ch¬£t=utf-8\" />", 
$cÚ‹Á
, 1);

168 
	}
}

178 
funùiÚ
 
dru·l_add_ãed
(
$u¾
 = 
NULL
, 
$t™Ë
 = '') {

179 
$¡Üed_ãed_lšks
 = 
¬¿y
();

181 ià(!
is_nuÎ
(
$u¾
è&& !
is£t
(
$¡Üed_ãed_lšks
[$url])) {

182 
	g$¡Üed_ãed_lšks
[
$u¾
] = 
theme
('ãed_icÚ', $u¾, 
$t™Ë
);

184 
dru·l_add_lšk
(
¬¿y
('rel' => 'alternate',

186 't™Ë' => 
$t™Ë
,

187 'h»f' => 
$u¾
));

189  
	g$¡Üed_ãed_lšks
;

198 
funùiÚ
 
dru·l_g‘_ãeds
(
$d–im™”
 = "\n") {

199 
$ãeds
 = 
dru·l_add_ãed
();

200  
im¶ode
(
$ãeds
, 
$d–im™”
);

222 
funùiÚ
 
dru·l_qu”y_¡ršg_’code
(
$qu”y
, 
$exşude
 = 
¬¿y
(), 
$·»Á
 = '') {

223 
$·¿ms
 = 
¬¿y
();

225 
fÜ—ch
 (
$qu”y
 
as
 
$key
 => 
$v®ue
) {

226 
$key
 = 
¿wu¾’code
($key);

227 ià(
	g$·»Á
) {

228 
	g$key
 = 
$·»Á
 .'['. 
$key
 .']';

231 ià(
š_¬¿y
(
$key
, 
$exşude
)) {

235 ià(
is_¬¿y
(
$v®ue
)) {

236 
	g$·¿ms
[] = 
dru·l_qu”y_¡ršg_’code
(
$v®ue
, 
$exşude
, 
$key
);

239 
	g$·¿ms
[] = 
$key
 .'='. 
¿wu¾’code
(
$v®ue
);

243  
im¶ode
('&', 
$·¿ms
);

256 
funùiÚ
 
	$dru·l_g‘_de¡š©iÚ
() {

257 ià(
	`is£t
(
$_REQUEST
['destination'])) {

258  'de¡š©iÚ='. 
	`u¾’code
(
$_REQUEST
['destination']);

262 
$·th
 = 
	`is£t
(
$_GET
['q']) ? $_GET['q'] : '';

263 
$qu”y
 = 
	`dru·l_qu”y_¡ršg_’code
(
$_GET
, 
	`¬¿y
('q'));

264 ià(
$qu”y
 != '') {

265 
$·th
 .ğ'?'. 
$qu”y
;

267  'de¡š©iÚ='. 
	`u¾’code
(
$·th
);

269 
	}
}

312 
funùiÚ
 
dru·l_gÙo
(
$·th
 = '', 
$qu”y
 = 
NULL
, 
$äagm’t
 = NULL, 
$h‰p_»¥Ú£_code
 = 302) {

314 
$de¡š©iÚ
 = 
FALSE
;

315 ià(
is£t
(
$_REQUEST
['destination'])) {

316 
	g$de¡š©iÚ
 = 
$_REQUEST
['destination'];

318 ià(
is£t
(
$_REQUEST
['edit']['destination'])) {

319 
	g$de¡š©iÚ
 = 
$_REQUEST
['edit']['destination'];

322 ià(
	g$de¡š©iÚ
) {

324 
	g$cŞÚpos
 = 
¡½os
(
$de¡š©iÚ
, ':');

325 
	g$absŞu‹
 = (
$cŞÚpos
 !=ğ
FALSE
 && !
´eg_m©ch
('![/?#]!', 
sub¡r
(
$de¡š©iÚ
, 0, $colonpos)));

326 ià(!
	g$absŞu‹
) {

327 
exŒaù
(
·r£_u¾
(
u¾decode
(
$de¡š©iÚ
)));

331 
	g$u¾
 = 
u¾
(
$·th
, 
¬¿y
('qu”y' => 
$qu”y
, 'äagm’t' => 
$äagm’t
, 'absŞu‹' => 
TRUE
));

333 
	g$u¾
 = 
¡r_»¶aû
(
¬¿y
("\n", "\r"), '', 
$u¾
);

337 ià(!
defšed
('MAINTENANCE_MODE'è|| 
	gMAINTENANCE_MODE
 != 'update') {

338 
moduË_švoke_®l
('ex™', 
$u¾
);

343 
£ssiÚ_wr™e_şo£
();

345 
h—d”
('LoÿtiÚ: '. 
$u¾
, 
TRUE
, 
$h‰p_»¥Ú£_code
);

350 
ex™
();

356 
funùiÚ
 
	$dru·l_s™e_ofæše
() {

357 
	`dru·l_maš‹Çnû_theme
();

358 
	`dru·l_£t_h—d”
('HTTP/1.1 503 Service unavailable');

359 
	`dru·l_£t_t™Ë
(
	`t
('Site off-line'));

360 
´št
 
	`theme
('maš‹Çnû_·ge', 
	`f‹r_xss_admš
(
	`v¬ŸbË_g‘
('site_offline_message',

361 
	`t
('@s™i cu¼’y und” maš‹Çnû. Wshould bback shÜy. Thªk you fÜ you¸·t›nû.', 
	`¬¿y
('@s™e' => 
	`v¬ŸbË_g‘
('site_name', 'Drupal'))))));

362 
	}
}

367 
funùiÚ
 
	$dru·l_nÙ_found
() {

368 
	`dru·l_£t_h—d”
('HTTP/1.1 404 Not Found');

370 
	`w©chdog
('·gnÙ found', 
	`check_¶aš
(
$_GET
['q']), 
NULL
, 
WATCHDOG_WARNING
);

373 ià(!
	`is£t
(
$_REQUEST
['destination'])) {

374 
$_REQUEST
['de¡š©iÚ'] = 
$_GET
['q'];

377 
$·th
 = 
	`dru·l_g‘_nÜm®_·th
(
	`v¬ŸbË_g‘
('site_404', ''));

378 ià(
$·th
 && $·th !ğ
$_GET
['q']) {

381 
	`m’u_£t_aùive_™em
(
$·th
);

382 
$»tuº
 = 
	`m’u_execu‹_aùive_hªdËr
(
$·th
);

385 ià(
	`em±y
(
$»tuº
è|| $»tuº =ğ
MENU_NOT_FOUND
 || $»tuº =ğ
MENU_ACCESS_DENIED
) {

386 
	`dru·l_£t_t™Ë
(
	`t
('Page‚ot found'));

387 
$»tuº
 = 
	`t
('The„equested…age could‚ot be found.');

391 
´št
 
	`theme
('·ge', 
$»tuº
, 
FALSE
);

392 
	}
}

397 
funùiÚ
 
	$dru·l_acûss_d’›d
() {

398 
	`dru·l_£t_h—d”
('HTTP/1.1 403 Forbidden');

400 
	`w©chdog
('acûs d’›d', 
	`check_¶aš
(
$_GET
['q']), 
NULL
, 
WATCHDOG_WARNING
);

403 ià(!
	`is£t
(
$_REQUEST
['destination'])) {

404 
$_REQUEST
['de¡š©iÚ'] = 
$_GET
['q'];

407 
$·th
 = 
	`dru·l_g‘_nÜm®_·th
(
	`v¬ŸbË_g‘
('site_403', ''));

408 ià(
$·th
 && $·th !ğ
$_GET
['q']) {

411 
	`m’u_£t_aùive_™em
(
$·th
);

412 
$»tuº
 = 
	`m’u_execu‹_aùive_hªdËr
(
$·th
);

415 ià(
	`em±y
(
$»tuº
è|| $»tuº =ğ
MENU_NOT_FOUND
 || $»tuº =ğ
MENU_ACCESS_DENIED
) {

416 
	`dru·l_£t_t™Ë
(
	`t
('Access denied'));

417 
$»tuº
 = 
	`t
('You‡re‚ot‡uthorizedo‡ccesshis…age.');

419 
´št
 
	`theme
('·ge', 
$»tuº
);

420 
	}
}

443 
funùiÚ
 
dru·l_h‰p_»que¡
(
$u¾
, 
$h—d”s
 = 
¬¿y
(), 
$m‘hod
 = 'GET', 
$d©a
 = 
NULL
, 
$»Œy
 = 3) {

444 
glob®
 
$db_´efix
;

446 
	g$»suÉ
 = 
Ãw
 
¡dCÏss
();

449 
	g$uri
 = 
·r£_u¾
(
$u¾
);

451 ià(
	g$uri
 =ğ
FALSE
) {

452 
$»suÉ
->
”rÜ
 = 'unableo…arse URL';

453 
	g$»suÉ
->
	gcode
 = -1001;

454  
	g$»suÉ
;

457 ià(!
is£t
(
$uri
['scheme'])) {

458 
	g$»suÉ
->
	g”rÜ
 = 'missing schema';

459 
	g$»suÉ
->
	gcode
 = -1002;

460  
	g$»suÉ
;

463 
	g$uri
['scheme']) {

466 
$pÜt
 = 
is£t
(
$uri
['port']) ? $uri['port'] : 80;

467 
	g$ho¡
 = 
$uri
['ho¡'] . (
$pÜt
 != 80 ? ':'. $port : '');

468 
	g$å
 = @
fsockİ’
(
$uri
['ho¡'], 
$pÜt
, 
$”ºo
, 
$”r¡r
, 15);

472 
$pÜt
 = 
is£t
(
$uri
['port']) ? $uri['port'] : 443;

473 
	g$ho¡
 = 
$uri
['ho¡'] . (
$pÜt
 != 443 ? ':'. $port : '');

474 
	g$å
 = @
fsockİ’
('s¦://'. 
$uri
['ho¡'], 
$pÜt
, 
$”ºo
, 
$”r¡r
, 20);

477 
$»suÉ
->
”rÜ
 = 'šv®id schem¨'. 
$uri
['scheme'];

478 
	g$»suÉ
->
	gcode
 = -1003;

479  
	g$»suÉ
;

483 ià(!
	g$å
) {

486 
	g$»suÉ
->
	gcode
 = -
$”ºo
;

487 
	g$»suÉ
->
	g”rÜ
 = 
Œim
(
$”r¡r
);

493 
v¬ŸbË_£t
('dru·l_h‰p_»que¡_çs', 
TRUE
);

495  
	g$»suÉ
;

499 
	g$·th
 = 
is£t
(
$uri
['path']) ? $uri['path'] : '/';

500 ià(
is£t
(
$uri
['query'])) {

501 
	g$·th
 .ğ'?'. 
$uri
['query'];

505 
	g$deçuÉs
 = 
¬¿y
(

517 
	g$cÚ‹Á_Ëngth
 = 
¡¾’
(
$d©a
);

518 ià(
	g$cÚ‹Á_Ëngth
 > 0 || 
	g$m‘hod
 =ğ'POST' || 
$m‘hod
 == 'PUT') {

519 
$deçuÉs
['CÚ‹Á-L’gth'] = 'CÚ‹Á-L’gth: '. 
$cÚ‹Á_Ëngth
;

523 ià(
is£t
(
$uri
['user'])) {

524 
	g$deçuÉs
['AuthÜiz©iÚ'] = 'AuthÜiz©iÚ: Basiø'. 
ba£64_’code
(
$uri
['u£r'] . (!
em±y
($uri['pass']) ? ":". $uri['pass'] : ''));

533 ià(
is_¡ršg
(
$db_´efix
è&& 
´eg_m©ch
("/^sim¶‘e¡\d+$/", $db_´efix, 
$m©ches
)) {

534 
	g$deçuÉs
['U£r-Ag’t'] = 'U£r-Ag’t: ' . 
$m©ches
[0];

537 
fÜ—ch
 (
$h—d”s
 
as
 
$h—d”
 => 
$v®ue
) {

538 
$deçuÉs
[
$h—d”
] = $h—d” .': '. 
$v®ue
;

541 
	g$»que¡
 = 
$m‘hod
 .' '. 
$·th
 ." HTTP/1.0\r\n";

542 
	g$»que¡
 .ğ
im¶ode
("\r\n", 
$deçuÉs
);

543 
	g$»que¡
 .= "\r\n\r\n";

544 
	g$»que¡
 .ğ
$d©a
;

546 
	g$»suÉ
->
	g»que¡
 = 
$»que¡
;

548 
fwr™e
(
$å
, 
$»que¡
);

551 
	g$»¥Ú£
 = '';

552 !
ãof
(
$å
è&& 
	g$chunk
 = 
ä—d
($fp, 1024)) {

553 
	g$»¥Ú£
 .ğ
$chunk
;

555 
fşo£
(
$å
);

558 
li¡
(
$¥l™
, 
$»suÉ
->
d©a
èğ
ex¶ode
("\r\n\r\n", 
$»¥Ú£
, 2);

559 
	g$¥l™
 = 
´eg_¥l™
("/\r\n|\n|\r/", 
$¥l™
);

561 
li¡
(
$´ÙocŞ
, 
$code
, 
$¡©us_mes§ge
èğ
ex¶ode
(' ', 
Œim
(
¬¿y_shiá
(
$¥l™
)), 3);

562 
	g$»suÉ
->
	g´ÙocŞ
 = 
$´ÙocŞ
;

563 
	g$»suÉ
->
	g¡©us_mes§ge
 = 
$¡©us_mes§ge
;

565 
	g$»suÉ
->
	gh—d”s
 = 
¬¿y
();

568 
	g$lše
 = 
Œim
(
¬¿y_shiá
(
$¥l™
))) {

569 
li¡
(
$h—d”
, 
$v®ue
èğ
ex¶ode
(':', 
$lše
, 2);

570 ià(
is£t
(
$»suÉ
->
h—d”s
[
$h—d”
]è&& 
	g$h—d”
 == 'Set-Cookie') {

573 
$»suÉ
->
h—d”s
[
$h—d”
] .ğ','. 
Œim
(
$v®ue
);

576 
	g$»suÉ
->
	gh—d”s
[
$h—d”
] = 
Œim
(
$v®ue
);

580 
	g$»¥Ú£s
 = 
¬¿y
(

589 ià(!
is£t
(
$»¥Ú£s
[
$code
])) {

590 
	g$code
 = 
æoÜ
(
$code
 / 100) * 100;

593 
	g$code
) {

600 
$loÿtiÚ
 = 
$»suÉ
->
h—d”s
['Location'];

602 ià(
	g$»Œy
) {

603 
	g$»suÉ
 = 
dru·l_h‰p_»que¡
(
$»suÉ
->
h—d”s
['LoÿtiÚ'], 
$h—d”s
, 
$m‘hod
, 
$d©a
, --
$»Œy
);

604 
	g$»suÉ
->
	g»dœeù_code
 = 
$»suÉ
->
code
;

606 
	g$»suÉ
->
	g»dœeù_u¾
 = 
$loÿtiÚ
;

610 
$»suÉ
->
”rÜ
 = 
$¡©us_mes§ge
;

613 
	g$»suÉ
->
	gcode
 = 
$code
;

614  
	g$»suÉ
;

627 
funùiÚ
 
	$dru·l_”rÜ_hªdËr
(
$”ºo
, 
$mes§ge
, 
$f’ame
, 
$lše
, 
$cÚ‹xt
) {

630 ià(
	`”rÜ_»pÜtšg
() == 0) {

634 ià(
$”ºo
 & (
E_ALL
 ^ 
E_DEPRECATED
 ^ 
E_NOTICE
)) {

635 
$ty³s
 = 
	`¬¿y
(1 => 'error', 2 => 'warning', 4 => 'parseƒrror', 8 => 'notice', 16 => 'coreƒrror', 32 => 'core warning', 64 => 'compileƒrror', 128 => 'compile warning', 256 => 'userƒrror', 512 => 'user warning', 1024 => 'user‚otice', 2048 => 'strict warning', 4096 => 'recoverable fatalƒrror');

639 ià(
	`is£t
(
$cÚ‹xt
[
DB_ERROR
])) {

640 
$backŒaû
 = 
	`¬¿y_»v”£
(
	`debug_backŒaû
());

643 
$qu”y_funùiÚs
 = 
	`¬¿y
('db_query', 'pager_query', 'db_query_range', 'db_query_temporary', 'update_sql');

647 
	`fÜ—ch
 (
$backŒaû
 
as
 
$šdex
 => 
$funùiÚ
) {

648 ià(
	`š_¬¿y
(
$funùiÚ
['funùiÚ'], 
$qu”y_funùiÚs
)) {

649 
$lše
 = 
$backŒaû
[
$šdex
]['line'];

650 
$f’ame
 = 
$backŒaû
[
$šdex
]['file'];

656 
$’Œy
 = 
$ty³s
[
$”ºo
] .': '. 
$mes§ge
 .' iÀ'. 
$f’ame
 .' oÀlš'. 
$lše
 .'.';

659 ià(
	`v¬ŸbË_g‘
('”rÜ_Ëv–', 1è=ğ1 || 
	`¡r¡r
(
$_SERVER
['SCRIPT_NAME'], 'update.php')) {

660 
	`dru·l_£t_mes§ge
(
$’Œy
, 'error');

663 
	`w©chdog
('php', '%mes§gš %fÚ†š%lše.', 
	`¬¿y
('%”rÜ' => 
$ty³s
[
$”ºo
], '%mes§ge' => 
$mes§ge
, '%fe' => 
$f’ame
, '%lše' => 
$lše
), 
WATCHDOG_ERROR
);

665 
	}
}

667 
funùiÚ
 
	$_fix_gpc_magic
(&
$™em
) {

668 ià(
	`is_¬¿y
(
$™em
)) {

669 
	`¬¿y_w®k
(
$™em
, '_fix_gpc_magic');

672 
$™em
 = 
	`¡r¦ashes
($item);

674 
	}
}

683 
funùiÚ
 
	$_fix_gpc_magic_fes
(&
$™em
, 
$key
) {

684 ià(
$key
 != 'tmp_name') {

685 ià(
	`is_¬¿y
(
$™em
)) {

686 
	`¬¿y_w®k
(
$™em
, '_fix_gpc_magic_files');

689 
$™em
 = 
	`¡r¦ashes
($item);

692 
	}
}

697 
funùiÚ
 
	$fix_gpc_magic
() {

698 
$fixed
 = 
FALSE
;

699 ià(!
$fixed
 && 
	`ši_g‘
('magic_quotes_gpc')) {

700 
	`¬¿y_w®k
(
$_GET
, '_fix_gpc_magic');

701 
	`¬¿y_w®k
(
$_POST
, '_fix_gpc_magic');

702 
	`¬¿y_w®k
(
$_COOKIE
, '_fix_gpc_magic');

703 
	`¬¿y_w®k
(
$_REQUEST
, '_fix_gpc_magic');

704 
	`¬¿y_w®k
(
$_FILES
, '_fix_gpc_magic_files');

705 
$fixed
 = 
TRUE
;

707 
	}
}

902 
funùiÚ
 
t
(
$¡ršg
, 
$¬gs
 = 
¬¿y
(), 
$Ïngcode
 = 
NULL
) {

903 
glob®
 
$Ïnguage
;

904 
	g$cu¡om_¡ršgs
;

906 
	g$Ïngcode
 = 
is£t
(
$Ïngcode
è? $Ïngcod: 
$Ïnguage
->
Ïnguage
;

912 ià(!
is£t
(
$cu¡om_¡ršgs
[
$Ïngcode
])) {

913 
	g$cu¡om_¡ršgs
[
$Ïngcode
] = 
v¬ŸbË_g‘
('loÿË_cu¡om_¡ršgs_'. $Ïngcode, 
¬¿y
());

916 ià(
is£t
(
$cu¡om_¡ršgs
[
$Ïngcode
][
$¡ršg
])) {

917 
	g$¡ršg
 = 
$cu¡om_¡ršgs
[
$Ïngcode
][
$¡ršg
];

920 
–£if
 (
funùiÚ_exi¡s
('loÿË'è&& 
$Ïngcode
 != 'en') {

921 
$¡ršg
 = 
loÿË
($¡ršg, 
$Ïngcode
);

923 ià(
em±y
(
$¬gs
)) {

924  
	g$¡ršg
;

928 
fÜ—ch
 (
$¬gs
 
as
 
$key
 => 
$v®ue
) {

929 
$key
[0]) {

932 
$¬gs
[
$key
] = 
check_¶aš
(
$v®ue
);

938 
$¬gs
[
$key
] = 
theme
('¶aûhŞd”', 
$v®ue
);

945  
¡¹r
(
$¡ršg
, 
$¬gs
);

965 
funùiÚ
 
	$v®id_ema_add»ss
(
$ma
) {

966 
$u£r
 = '[a-zA-Z0-9_\-\.\+\^!#\$%&*+\/\=\?\`\|\{\}~\']+';

967 
$domaš
 = '(?:(?:[a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.?)+';

968 
$v4
 = '[0-9]{1,3}(\.[0-9]{1,3}){3}';

969 
$v6
 = '[0-9a-fA-F]{1,4}(\:[0-9a-fA-F]{1,4}){7}';

971  
	`´eg_m©ch
("/^$u£r@($domaš|(\[($v4|$v6)\]))$/", 
$ma
);

972 
	}
}

988 
funùiÚ
 
	$v®id_u¾
(
$u¾
, 
$absŞu‹
 = 
FALSE
) {

989 ià(
$absŞu‹
) {

990  (
boŞ
)
	`´eg_m©ch
("

991 /^ #S¹ 
©
 
the
 
begšnšg
 
of
h
‹xt


992 (?:
áp
|
h‰ps
?|
ãed
):\/\/ #Look áp, 
h‰p
, h‰p 
Ü
 f“d 
schemes


993 (?: #U£ršfØ(
İtiÚ®
è
which
 
is
 
typiÿÎy


994 (?:(?:[\
w
\.\-\+!
$
&'\(\)*\+,;=]|%[0-9a-f]{2})+:)* #‡ username or‡ username‡nd…assword

995 (?:[\
w
\.\-\+%!
$
&'\(\)*\+,;=]|%[0-9a-f]{2})+@ # combination

998 (?:[
a
-
z0
-9\-\.]|%[0-9a-
f
]{2})+ #A 
domaš
 
Çme
 
Ü
‡ 
IPv4
 
add»ss


999 |(?:\[(?:[0-9a-
f
]{0,4}:)*(?:[0-9a-f]{0,4})\]è#Ü 
a
 
w–l
 
fÜmed
 
IPv6
 
add»ss


1001 (?::[0-9]+)? #S”v” 
pÜt
 
	`numb”
 (
İtiÚ®
)

1003 (?:[\
w
#!:\.\?\+=&@
$
'~*,;\/\(\)\[\]\-]|%[0-9a-f]{2}) # The…ath‡nd query (optional)

1005 
$
/
xi
", $url);

1008  (
boŞ
)
	`´eg_m©ch
("/^(?:[\w#!:\.\?\+=&@$'~*,;\/\(\)\[\]\-]|%[0-9a-f]{2})+$/i", 
$u¾
);

1010 
	}
}

1023 
funùiÚ
 
	$æood_»gi¡”_ev’t
(
$Çme
) {

1024 
	`db_qu”y
("INSERT INTO {æood} (ev’t, ho¡Çme,ime¡ampèVALUES ('%s', '%s', %d)", 
$Çme
, 
	`_add»ss
(), 
	`time
());

1025 
	}
}

1040 
funùiÚ
 
	$æood_is_®lowed
(
$Çme
, 
$th»shŞd
) {

1041 
$numb”
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {æood} WHEREƒv’ˆğ'%s' AND ho¡Çmğ'%s' ANDime¡am°> %d", 
$Çme
, 
	`_add»ss
(), 
	`time
() - 3600));

1042  (
$numb”
 < 
$th»shŞd
 ? 
TRUE
 : 
FALSE
);

1043 
	}
}

1045 
funùiÚ
 
	$check_fe
(
$f’ame
) {

1046  
	`is_u¶ßded_fe
(
$f’ame
);

1047 
	}
}

1052 
funùiÚ
 
	$check_u¾
(
$uri
) {

1053  
	`f‹r_xss_bad_´ÙocŞ
(
$uri
, 
FALSE
);

1054 
	}
}

1067 
funùiÚ
 
fÜm©_rss_chªÃl
(
$t™Ë
, 
$lšk
, 
$desütiÚ
, 
$™ems
, 
$Ïngcode
 = 
NULL
, 
$¬gs
 = 
	$¬¿y
()) {

1068 
glob®
 
$Ïnguage
;

1069 
$Ïngcode
 = $Ïngcod? $Ïngcod: 
$Ïnguage
->
Ïnguage
;

1071 
$ouut
 = "<channel>\n";

1072 
$ouut
 .ğ' <t™Ë>'. 
	`check_¶aš
(
$t™Ë
) ."</title>\n";

1073 
$ouut
 .ğ' <lšk>'. 
	`check_u¾
(
$lšk
) ."</link>\n";

1078 
$ouut
 .ğ' <desütiÚ>'. 
	`check_¶aš
(
	`decode_’t™›s
(
	`¡r_gs
(
$desütiÚ
))) ."</description>\n";

1079 
$ouut
 .ğ' <Ïnguage>'. 
	`check_¶aš
(
$Ïngcode
) ."</language>\n";

1080 
$ouut
 .ğ
	`fÜm©_xml_–em’ts
(
$¬gs
);

1081 
$ouut
 .ğ
$™ems
;

1082 
$ouut
 .= "</channel>\n";

1084  
$ouut
;

1085 
	}
}

1092 
funùiÚ
 
fÜm©_rss_™em
(
$t™Ë
, 
$lšk
, 
$desütiÚ
, 
$¬gs
 = 
	$¬¿y
()) {

1093 
$ouut
 = "<item>\n";

1094 
$ouut
 .ğ' <t™Ë>'. 
	`check_¶aš
(
$t™Ë
) ."</title>\n";

1095 
$ouut
 .ğ' <lšk>'. 
	`check_u¾
(
$lšk
) ."</link>\n";

1096 
$ouut
 .ğ' <desütiÚ>'. 
	`check_¶aš
(
$desütiÚ
) ."</description>\n";

1097 
$ouut
 .ğ
	`fÜm©_xml_–em’ts
(
$¬gs
);

1098 
$ouut
 .= "</item>\n";

1100  
$ouut
;

1101 
	}
}

1117 
funùiÚ
 
	$fÜm©_xml_–em’ts
(
$¬¿y
) {

1118 
$ouut
 = '';

1119 
	`fÜ—ch
 (
$¬¿y
 
as
 
$key
 => 
$v®ue
) {

1120 ià(
	`is_num”ic
(
$key
)) {

1121 ià(
$v®ue
['key']) {

1122 
$ouut
 .ğ' <'. 
$v®ue
['key'];

1123 ià(
	`is£t
(
$v®ue
['©Œibu‹s']è&& 
	`is_¬¿y
($value['attributes'])) {

1124 
$ouut
 .ğ
	`dru·l_©Œibu‹s
(
$v®ue
['attributes']);

1127 ià(
	`is£t
(
$v®ue
['value']) && $value['value'] != '') {

1128 
$ouut
 .ğ'>'. (
	`is_¬¿y
(
$v®ue
['v®ue']è? 
	`fÜm©_xml_–em’ts
($v®ue['v®ue']è: 
	`check_¶aš
($value['value'])) .'</'. $value['key'] .">\n";

1131 
$ouut
 .= " />\n";

1136 
$ouut
 .ğ' <'. 
$key
 .'>'. (
	`is_¬¿y
(
$v®ue
è? 
	`fÜm©_xml_–em’ts
($v®ueè: 
	`check_¶aš
($value)) ."</$key>\n";

1139  
$ouut
;

1140 
	}
}

1188 
funùiÚ
 
fÜm©_¶u¿l
(
$couÁ
, 
$sšguÏr
, 
$¶u¿l
, 
$¬gs
 = 
¬¿y
(), 
$Ïngcode
 = 
NULL
) {

1189 
$¬gs
['@couÁ'] = 
$couÁ
;

1190 ià(
	g$couÁ
 == 1) {

1191  
t
(
$sšguÏr
, 
$¬gs
, 
$Ïngcode
);

1195 
	g$šdex
 = (
funùiÚ_exi¡s
('loÿË_g‘_¶u¿l')è? 
loÿË_g‘_¶u¿l
(
$couÁ
, 
$Ïngcode
) : -1;

1197 ià(
	g$šdex
 < 0) {

1198  
t
(
$¶u¿l
, 
$¬gs
, 
$Ïngcode
);

1201 
	g$šdex
) {

1203  
t
(
$sšguÏr
, 
$¬gs
, 
$Ïngcode
);

1205  
t
(
$¶u¿l
, 
$¬gs
, 
$Ïngcode
);

1207 
un£t
(
$¬gs
['@count']);

1208 
	g$¬gs
['@couÁ['. 
$šdex
 .']'] = 
$couÁ
;

1209  
t
(
¡¹r
(
$¶u¿l
, 
¬¿y
('@couÁ' => '@couÁ['. 
$šdex
 .']')), 
$¬gs
, 
$Ïngcode
);

1223 
funùiÚ
 
	$·r£_size
(
$size
) {

1224 
$suffixes
 = 
	`¬¿y
(

1230 ià(
	`´eg_m©ch
('/([0-9]+)\s*(k|m|g)?(b?(y‹s?)?)/i', 
$size
, 
$m©ch
)) {

1231  
$m©ch
[1] * 
$suffixes
[
	`dru·l_¡¹Şow”
($match[2])];

1233 
	}
}

1246 
funùiÚ
 
	$fÜm©_size
(
$size
, 
$Ïngcode
 = 
NULL
) {

1247 ià(
$size
 < 1024) {

1248  
	`fÜm©_¶u¿l
(
$size
, '1 by‹', '@couÁ by‹s', 
	`¬¿y
(), 
$Ïngcode
);

1251 
$size
 = 
	`round
($size / 1024, 2);

1252 
$suffix
 = 
	`t
('KB', 
	`¬¿y
(), 
$Ïngcode
);

1253 ià(
$size
 >= 1024) {

1254 
$size
 = 
	`round
($size / 1024, 2);

1255 
$suffix
 = 
	`t
('MB', 
	`¬¿y
(), 
$Ïngcode
);

1257  
	`t
('@siz@suffix', 
	`¬¿y
('@size' => 
$size
, '@suffix' => 
$suffix
), 
$Ïngcode
);

1259 
	}
}

1274 
funùiÚ
 
	$fÜm©_š‹rv®
(
$time¡amp
, 
$g¿nuÏr™y
 = 2, 
$Ïngcode
 = 
NULL
) {

1275 
$un™s
 = 
	`¬¿y
('1 year|@count years' => 31536000, '1 week|@count weeks' => 604800, '1 day|@count days' => 86400, '1 hour|@count hours' => 3600, '1 min|@count min' => 60, '1 sec|@count sec' => 1);

1276 
$ouut
 = '';

1277 
	`fÜ—ch
 (
$un™s
 
as
 
$key
 => 
$v®ue
) {

1278 
$key
 = 
	`ex¶ode
('|', $key);

1279 ià(
$time¡amp
 >ğ
$v®ue
) {

1280 
$ouut
 .ğ($ouuˆ? ' ' : ''è. 
	`fÜm©_¶u¿l
(
	`æoÜ
(
$time¡amp
 / 
$v®ue
), 
$key
[0], $key[1], 
	`¬¿y
(), 
$Ïngcode
);

1281 
$time¡amp
 %ğ
$v®ue
;

1282 
$g¿nuÏr™y
--;

1285 ià(
$g¿nuÏr™y
 == 0) {

1289  
$ouut
 ? $ouuˆ: 
	`t
('0 sec', 
	`¬¿y
(), 
$Ïngcode
);

1290 
	}
}

1316 
funùiÚ
 
fÜm©_d©e
(
$time¡amp
, 
$ty³
 = 'medium', 
$fÜm©
 = '', 
$timezÚe
 = 
NULL
, 
$Ïngcode
 = NULL) {

1317 ià(!
is£t
(
$timezÚe
)) {

1318 
glob®
 
$u£r
;

1319 ià(
v¬ŸbË_g‘
('cÚfigu¿bË_timezÚes', 1è&& 
	g$u£r
->
	guid
 && 
¡¾’
(
$u£r
->
timezÚe
)) {

1320 
	g$timezÚe
 = 
$u£r
->
timezÚe
;

1323 
	g$timezÚe
 = 
v¬ŸbË_g‘
('date_default_timezone', 0);

1327 
	g$time¡amp
 +ğ
$timezÚe
;

1329 
	g$ty³
) {

1331 
$fÜm©
 = 
v¬ŸbË_g‘
('date_format_short', 'm/d/Y - H:i');

1334 
$fÜm©
 = 
v¬ŸbË_g‘
('date_format_long', 'l, F j, Y - H:i');

1341 
$fÜm©
 = 
v¬ŸbË_g‘
('date_format_medium', 'D, m/d/Y - H:i');

1344 
	g$max
 = 
¡¾’
(
$fÜm©
);

1345 
	g$d©e
 = '';

1346 
	g$i
 = 0; $˜< 
	g$max
; $i++) {

1347 
	g$c
 = 
$fÜm©
[
$i
];

1348 ià(
¡½os
('AaDlM', 
$c
è!=ğ
FALSE
) {

1349 
$d©e
 .ğ
t
(
gmd©e
(
$c
, 
$time¡amp
), 
¬¿y
(), 
$Ïngcode
);

1351 ià(
	g$c
 == 'F') {

1355 
$d©e
 .ğ
Œim
(
t
('!lÚg-mÚth-Çm'. 
gmd©e
(
$c
, 
$time¡amp
), 
¬¿y
('!lÚg-mÚth-Çme' => ''), 
$Ïngcode
));

1357 ià(
¡½os
('BdgGhHiIjLmnsStTUwWYyz', 
$c
è!=ğ
FALSE
) {

1358 
$d©e
 .ğ
gmd©e
(
$c
, 
$time¡amp
);

1360 ià(
	g$c
 == 'r') {

1361 
$d©e
 .ğ
fÜm©_d©e
(
$time¡amp
 - 
$timezÚe
, 'cu¡om', 'D, d M Y H:i: O', $timezÚe, 
$Ïngcode
);

1363 ià(
	g$c
 == 'O') {

1364 
$d©e
 .ğ
¥rštf
('%s%02d%02d', (
$timezÚe
 < 0 ? '-' : '+'), 
abs
($timezone / 3600),‡bs($timezone % 3600) / 60);

1366 ià(
	g$c
 == 'Z') {

1367 
$d©e
 .ğ
$timezÚe
;

1369 ià(
	g$c
 == '\\') {

1370 
$d©e
 .ğ
$fÜm©
[++
$i
];

1373 
	g$d©e
 .ğ
$c
;

1377  
	g$d©e
;

1428 
funùiÚ
 
u¾
(
$·th
 = 
NULL
, 
$İtiÚs
 = 
	$¬¿y
()) {

1430 
$İtiÚs
 +ğ
	`¬¿y
(

1433 'absŞu‹' => 
FALSE
,

1434 '®Ÿs' => 
FALSE
,

1437 ià(!
	`is£t
(
$İtiÚs
['external'])) {

1441 
$cŞÚpos
 = 
	`¡½os
(
$·th
, ':');

1442 
$İtiÚs
['ex‹º®'] = (
$cŞÚpos
 !=ğ
FALSE
 && !
	`´eg_m©ch
('![/?#]!', 
	`sub¡r
(
$·th
, 0, $cŞÚpos)è&& 
	`f‹r_xss_bad_´ÙocŞ
($·th, FALSEè=ğ
	`check_¶aš
($path));

1446 ià(
	`funùiÚ_exi¡s
('language_url_rewrite')) {

1447 
	`Ïnguage_u¾_»wr™e
(
$·th
, 
$İtiÚs
);

1449 ià(
$İtiÚs
['fragment']) {

1450 
$İtiÚs
['fragment'] = '#'. $options['fragment'];

1452 ià(
	`is_¬¿y
(
$İtiÚs
['query'])) {

1453 
$İtiÚs
['qu”y'] = 
	`dru·l_qu”y_¡ršg_’code
($options['query']);

1456 ià(
$İtiÚs
['external']) {

1458 ià(
	`¡½os
(
$·th
, '#'è!=ğ
FALSE
) {

1459 
	`li¡
(
$·th
, 
$Şd_äagm’t
èğ
	`ex¶ode
('#', $path, 2);

1460 ià(
	`is£t
(
$Şd_äagm’t
è&& !
$İtiÚs
['fragment']) {

1461 
$İtiÚs
['äagm’t'] = '#'. 
$Şd_äagm’t
;

1465 ià(
$İtiÚs
['query']) {

1466 
$·th
 .ğ(
	`¡½os
($·th, '?'è!=ğ
FALSE
 ? '&' : '?'è. 
$İtiÚs
['query'];

1469  
$·th
 . 
$İtiÚs
['fragment'];

1472 
glob®
 
$ba£_u¾
;

1473 
$süt
;

1475 ià(!
	`is£t
(
$süt
)) {

1479 
$süt
 = (
	`¡½os
(
$_SERVER
['SERVER_SOFTWARE'], 'A·che'è==ğ
FALSE
) ? 'index.php' : '';

1482 ià(!
	`is£t
(
$İtiÚs
['base_url'])) {

1484 
$İtiÚs
['ba£_u¾'] = 
$ba£_u¾
;

1488 
$Üigš®_·th
 = 
$·th
;

1491 ià(
$·th
 == '<front>') {

1492 
$·th
 = '';

1494 
	`–£if
 (!
	`em±y
(
$·th
è&& !
$İtiÚs
['alias']) {

1495 
$·th
 = 
	`dru·l_g‘_·th_®Ÿs
($·th, 
	`is£t
(
$İtiÚs
['Ïnguage']è? $İtiÚs['Ïnguage']->
Ïnguage
 : '');

1498 ià(
	`funùiÚ_exi¡s
('custom_url_rewrite_outbound')) {

1500 
	`cu¡om_u¾_»wr™e_outbound
(
$·th
, 
$İtiÚs
, 
$Üigš®_·th
);

1503 
$ba£
 = 
$İtiÚs
['absŞu‹'] ? $İtiÚs['ba£_u¾'] .'/' : 
	`ba£_·th
();

1504 
$´efix
 = 
	`em±y
(
$·th
è? 
	`¹rim
(
$İtiÚs
['prefix'], '/') : $options['prefix'];

1505 
$·th
 = 
	`dru·l_u¾’code
(
$´efix
 . $path);

1507 ià(
	`v¬ŸbË_g‘
('clean_url', '0')) {

1509 ià(
$İtiÚs
['query']) {

1510  
$ba£
 . 
$·th
 .'?'. 
$İtiÚs
['query'] . $options['fragment'];

1513  
$ba£
 . 
$·th
 . 
$İtiÚs
['fragment'];

1518 
$v¬ŸbËs
 = 
	`¬¿y
();

1519 ià(!
	`em±y
(
$·th
)) {

1520 
$v¬ŸbËs
[] = 'q='. 
$·th
;

1522 ià(!
	`em±y
(
$İtiÚs
['query'])) {

1523 
$v¬ŸbËs
[] = 
$İtiÚs
['query'];

1525 ià(
$qu”y
 = 
	`još
('&', 
$v¬ŸbËs
)) {

1526  
$ba£
 . 
$süt
 .'?'. 
$qu”y
 . 
$İtiÚs
['fragment'];

1529  
$ba£
 . 
$İtiÚs
['fragment'];

1532 
	}
}

1542 
funùiÚ
 
dru·l_©Œibu‹s
(
$©Œibu‹s
 = 
	$¬¿y
()) {

1543 ià(
	`is_¬¿y
(
$©Œibu‹s
)) {

1544 
$t
 = '';

1545 
	`fÜ—ch
 (
$©Œibu‹s
 
as
 
$key
 => 
$v®ue
) {

1546 
$t
 .ğ" $key=".'"'. 
	`check_¶aš
(
$v®ue
) .'"';

1548  
$t
;

1550 
	}
}

1585 
funùiÚ
 
l
(
$‹xt
, 
$·th
, 
$İtiÚs
 = 
	$¬¿y
()) {

1586 
glob®
 
$Ïnguage
;

1589 
$İtiÚs
 +ğ
	`¬¿y
(

1590 '©Œibu‹s' => 
	`¬¿y
(),

1591 'html' => 
FALSE
,

1595 ià((
$·th
 =ğ
$_GET
['q'] || ($·th =ğ'<äÚt>' && 
	`dru·l_is_äÚt_·ge
())) &&

1596 (
	`em±y
(
$İtiÚs
['Ïnguage']è|| $İtiÚs['Ïnguage']->
Ïnguage
 =ğ
$Ïnguage
->language)) {

1597 ià(
	`is£t
(
$İtiÚs
['attributes']['class'])) {

1598 
$İtiÚs
['attributes']['class'] .= '‡ctive';

1601 
$İtiÚs
['attributes']['class'] = 'active';

1607 ià(
	`is£t
(
$İtiÚs
['©Œibu‹s']['t™Ë']è&& 
	`¡½os
($İtiÚs['©Œibu‹s']['t™Ë'], '<'è!=ğ
FALSE
) {

1608 
$İtiÚs
['©Œibu‹s']['t™Ë'] = 
	`¡r_gs
($options['attributes']['title']);

1611  '<¨h»f="'. 
	`check_u¾
(
	`u¾
(
$·th
, 
$İtiÚs
)è.'"'. 
	`dru·l_©Œibu‹s
($İtiÚs['©Œibu‹s']è.'>'. ($İtiÚs['html'] ? 
$‹xt
 : 
	`check_¶aš
($text)) .'</a>';

1612 
	}
}

1620 
funùiÚ
 
	$dru·l_·ge_foÙ”
() {

1621 ià(
	`v¬ŸbË_g‘
('ÿche', 
CACHE_DISABLED
) != CACHE_DISABLED) {

1622 
	`·ge_£t_ÿche
();

1625 
	`moduË_švoke_®l
('exit');

1626 
	}
}

1644 
funùiÚ
 
	$dru·l_m­_assoc
(
$¬¿y
, 
$funùiÚ
 = 
NULL
) {

1645 ià(!
	`is£t
(
$funùiÚ
)) {

1646 
$»suÉ
 = 
	`¬¿y
();

1647 
	`fÜ—ch
 (
$¬¿y
 
as
 
$v®ue
) {

1648 
$»suÉ
[
$v®ue
] = $value;

1650  
$»suÉ
;

1652 
	`–£if
 (
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

1653 
$»suÉ
 = 
	`¬¿y
();

1654 
	`fÜ—ch
 (
$¬¿y
 
as
 
$v®ue
) {

1655 
$»suÉ
[
$v®ue
] = 
	`$funùiÚ
($value);

1657  
$»suÉ
;

1659 
	}
}

1678 
funùiÚ
 
	$dru·l_ev®
(
$code
) {

1679 
glob®
 
$theme_·th
, 
$theme_šfo
, 
$cÚf
;

1682 
$Şd_theme_·th
 = 
$theme_·th
;

1687 ià(!
	`is£t
(
$theme_šfo
)) {

1688 
$theme_·th
 = 
	`dru·l_g‘_·th
('theme', 
$cÚf
['theme_default']);

1691 
$theme_·th
 = 
	`dœÇme
(
$theme_šfo
->
f’ame
);

1694 
	`ob_¡¬t
();

1695 
´št
 
	`ev®
('?>'. 
$code
);

1696 
$ouut
 = 
	`ob_g‘_cÚ‹Ás
();

1697 
	`ob_’d_ş—n
();

1700 
$theme_·th
 = 
$Şd_theme_·th
;

1702  
$ouut
;

1703 
	}
}

1716 
funùiÚ
 
	$dru·l_g‘_·th
(
$ty³
, 
$Çme
) {

1717  
	`dœÇme
(
	`dru·l_g‘_f’ame
(
$ty³
, 
$Çme
));

1718 
	}
}

1724 
funùiÚ
 
	$ba£_·th
() {

1725  
$GLOBALS
['base_path'];

1726 
	}
}

1731 
funùiÚ
 
	$dru·l_şÚe
(
$objeù
) {

1732  
	`v”siÚ_com·»
(
	`phpv”siÚ
(), '5.0'è< 0 ? 
$objeù
 : 
	`şÚe
($object);

1733 
	}
}

1738 
funùiÚ
 
	$dru·l_add_lšk
(
$©Œibu‹s
) {

1739 
	`dru·l_£t_html_h—d
('<lšk'. 
	`dru·l_©Œibu‹s
(
$©Œibu‹s
) .' />');

1740 
	}
}

1793 
funùiÚ
 
dru·l_add_css
(
$·th
 = 
NULL
, 
$ty³
 = 'moduË', 
$medŸ
 = '®l', 
$´•roûss
 = 
TRUE
) {

1794 
$css
 = 
¬¿y
();

1795 
glob®
 
	g$Ïnguage
;

1799 ià(
is£t
(
$·th
)) {

1801 ià(!
is£t
(
$css
[
$medŸ
])) {

1802 
	g$css
[
$medŸ
] = 
¬¿y
('module' =>‡rray(), 'theme' =>‡rray());

1804 
	g$css
[
$medŸ
][
$ty³
][
$·th
] = 
$´•roûss
;

1807 ià(
	g$Ïnguage
->
	gdœeùiÚ
 =ğ
LANGUAGE_RTL
) {

1808 
$¹l_·th
 = 
¡r_»¶aû
('.css', '-¹l.css', 
$·th
);

1809 ià(
fe_exi¡s
(
$¹l_·th
)) {

1810 
	g$css
[
$medŸ
][
$ty³
][
$¹l_·th
] = 
$´•roûss
;

1815  
	g$css
;

1840 
funùiÚ
 
	$dru·l_g‘_css
(
$css
 = 
NULL
) {

1841 
$ouut
 = '';

1842 ià(!
	`is£t
(
$css
)) {

1843 
$css
 = 
	`dru·l_add_css
();

1845 
$no_moduË_´•roûss
 = '';

1846 
$no_theme_´•roûss
 = '';

1848 
$´•roûss_css
 = (
	`v¬ŸbË_g‘
('´•roûss_css', 
FALSE
è&& (!
	`defšed
('MAINTENANCE_MODE'è|| 
MAINTENANCE_MODE
 != 'update'));

1849 
$dœeùÜy
 = 
	`fe_dœeùÜy_·th
();

1850 
$is_wr™abË
 = 
	`is_dœ
(
$dœeùÜy
è&& 
	`is_wr™abË
($dœeùÜyè&& (
	`v¬ŸbË_g‘
('fe_dowÆßds', 
FILE_DOWNLOADS_PUBLIC
) == FILE_DOWNLOADS_PUBLIC);

1856 
$qu”y_¡ršg
 = '?'. 
	`sub¡r
(
	`v¬ŸbË_g‘
('css_js_query_string', '0'), 0, 1);

1858 
	`fÜ—ch
 (
$css
 
as
 
$medŸ
 => 
$ty³s
) {

1861 
	`fÜ—ch
 (
$ty³s
 
as
 
$ty³
 => 
$fes
) {

1862 ià(
$ty³
 == 'module') {

1864 
$theme_¡yËs
 = 
	`¬¿y
();

1865 
	`fÜ—ch
 (
	`¬¿y_keys
(
$css
[
$medŸ
]['theme']è
as
 
$theme_¡yË
) {

1866 
$theme_¡yËs
[] = 
	`ba£Çme
(
$theme_¡yË
);

1869 
	`fÜ—ch
 (
$ty³s
[
$ty³
] 
as
 
$fe
 => 
$´•roûss
) {

1872 ià(
$ty³
 =ğ'moduË' && 
	`š_¬¿y
(
	`¡r_»¶aû
('-¹l.css', '.css', 
	`ba£Çme
(
$fe
)), 
$theme_¡yËs
)) {

1874 
	`un£t
(
$ty³s
[
$ty³
][
$fe
]);

1878 ià(
	`fe_exi¡s
(
$fe
)) {

1879 ià(!
$´•roûss
 || !(
$is_wr™abË
 && 
$´•roûss_css
)) {

1882 ià(!
$´•roûss
 && 
$ty³
 == 'module') {

1883 
$no_moduË_´•roûss
 .ğ'<lšky³="‹xt/css"„–="¡yËsh“t" medŸ="'. 
$medŸ
 .'" h»f="'. 
	`ba£_·th
(è. 
$fe
 . 
$qu”y_¡ršg
 .'" />'."\n";

1887 ià(!
$´•roûss
 && 
$ty³
 == 'theme') {

1888 
$no_theme_´•roûss
 .ğ'<lšky³="‹xt/css"„–="¡yËsh“t" medŸ="'. 
$medŸ
 .'" h»f="'. 
	`ba£_·th
(è. 
$fe
 . 
$qu”y_¡ršg
 .'" />'."\n";

1891 
$ouut
 .ğ'<lšky³="‹xt/css"„–="¡yËsh“t" medŸ="'. 
$medŸ
 .'" h»f="'. 
	`ba£_·th
(è. 
$fe
 . 
$qu”y_¡ršg
 .'" />'."\n";

1898 ià(
$is_wr™abË
 && 
$´•roûss_css
) {

1901 
$f’ame
 = 'css_'. 
	`md5
(
	`£rŸlize
(
$ty³s
è. 
$qu”y_¡ršg
) .'.css';

1902 
$´•roûss_fe
 = 
	`dru·l_bud_css_ÿche
(
$ty³s
, 
$f’ame
);

1903 
$ouut
 .ğ'<lšky³="‹xt/css"„–="¡yËsh“t" medŸ="'. 
$medŸ
 .'" h»f="'. 
	`ba£_·th
(è. 
$´•roûss_fe
 .'" />'."\n";

1907  
$no_moduË_´•roûss
 . 
$ouut
 . 
$no_theme_´•roûss
;

1908 
	}
}

1921 
funùiÚ
 
	$dru·l_bud_css_ÿche
(
$ty³s
, 
$f’ame
) {

1922 
$d©a
 = '';

1925 
$cs¥©h
 = 
	`fe_ü—‹_·th
('css');

1926 
	`fe_check_dœeùÜy
(
$cs¥©h
, 
FILE_CREATE_DIRECTORY
);

1928 ià(!
	`fe_exi¡s
(
$cs¥©h
 .'/'. 
$f’ame
)) {

1930 
	`fÜ—ch
 (
$ty³s
 
as
 
$ty³
) {

1931 
	`fÜ—ch
 (
$ty³
 
as
 
$fe
 => 
$ÿche
) {

1932 ià(
$ÿche
) {

1933 
$cÚ‹Ás
 = 
	`dru·l_lßd_¡yËsh“t
(
$fe
, 
TRUE
);

1935 
$ba£
 = 
	`ba£_·th
(è. 
	`dœÇme
(
$fe
) .'/';

1936 
	`_dru·l_bud_css_·th
(
NULL
, 
$ba£
);

1938 
$d©a
 .ğ
	`´eg_»¶aû_ÿÎback
('/u¾\([\'"]?(?![a-z]+:|\/+)([^\'")]+)[\'"]?\)/i', '_dru·l_bud_css_·th', 
$cÚ‹Ás
);

1945 
$»gexp
 = '/@import[^;]+;/i';

1946 
	`´eg_m©ch_®l
(
$»gexp
, 
$d©a
, 
$m©ches
);

1947 
$d©a
 = 
	`´eg_»¶aû
(
$»gexp
, '', $data);

1948 
$d©a
 = 
	`im¶ode
('', 
$m©ches
[0]) . $data;

1951 
	`fe_§ve_d©a
(
$d©a
, 
$cs¥©h
 .'/'. 
$f’ame
, 
FILE_EXISTS_REPLACE
);

1953  
$cs¥©h
 .'/'. 
$f’ame
;

1954 
	}
}

1961 
funùiÚ
 
	$_dru·l_bud_css_·th
(
$m©ches
, 
$ba£
 = 
NULL
) {

1962 
$_ba£
;

1964 ià(
	`is£t
(
$ba£
)) {

1965 
$_ba£
 = 
$ba£
;

1969 
$·th
 = 
$_ba£
 . 
$m©ches
[1];

1970 
$Ï¡
 = '';

1971 
$·th
 !ğ
$Ï¡
) {

1972 
$Ï¡
 = 
$·th
;

1973 
$·th
 = 
	`´eg_»¶aû
('`(^|/)(?!\.\./)([^/]+)/\.\./`', '$1', $path);

1975  'u¾('. 
$·th
 .')';

1976 
	}
}

1996 
funùiÚ
 
	$dru·l_lßd_¡yËsh“t
(
$fe
, 
$İtimize
 = 
NULL
) {

1997 
$_İtimize
;

1999 ià(
	`is£t
(
$İtimize
)) {

2000 
$_İtimize
 = 
$İtimize
;

2003 
$cÚ‹Ás
 = '';

2004 ià(
	`fe_exi¡s
(
$fe
)) {

2006 
$cÚ‹Ás
 = 
	`fe_g‘_cÚ‹Ás
(
$fe
);

2009 
$cwd
 = 
	`g‘cwd
();

2010 
	`chdœ
(
	`dœÇme
(
$fe
));

2014 
$cÚ‹Ás
 = 
	`´eg_»¶aû_ÿÎback
('/@import\s*(?:url\()?[\'"]?(?![a-z]+:)([^\'"\()]+)[\'"]?\)?;/', '_drupal_load_stylesheet', $contents);

2016 
$cÚ‹Ás
 = 
	`´eg_»¶aû
('/^@charset\s+[\'"](\S*)\b[\'"];/i', '', $contents);

2018 ià(
$_İtimize
) {

2021 
$comm’t
 = '/\*[^*]*\*+(?:[^/*][^*]*\*+)*/';

2023 
$doubË_quÙ
 = '"[^"\\\\]*(?:\\\\.[^"\\\\]*)*"';

2025 
$sšgË_quÙ
 = "'[^'\\\\]*(?:\\\\.[^'\\\\]*)*'";

2026 
$cÚ‹Ás
 = 
	`´eg_»¶aû_ÿÎback
(

2029 
$cÚ‹Ás
);

2030 
$cÚ‹Ás
 = 
	`´eg_»¶aû
(

2032 '\1', 
$cÚ‹Ás
);

2034 
$cÚ‹Ás
 .= "\n";

2038 
	`chdœ
(
$cwd
);

2041  
$cÚ‹Ás
;

2042 
	}
}

2051 
funùiÚ
 
	$_´oûss_comm’t
(
$m©ches
) {

2052 
$k“p_ÃxtÚe
 = 
FALSE
;

2055 ià(
$m©ches
[0][0] == "'" || $matches[0][0] == '"') {

2056  
$m©ches
[0];

2059 ià(
$k“p_ÃxtÚe
) {

2060 
$k“p_ÃxtÚe
 = 
FALSE
;

2061  
$m©ches
[0];

2063 
	`¡¼pos
(
$m©ches
[0], '\\')) {

2064 
FALSE
 :

2068 
	`dru·l_¡¾’
(
$m©ches
[0])-3 :

2070 
$k“p_ÃxtÚe
 = 
TRUE
;

2077 
	}
}

2085 
funùiÚ
 
	$_dru·l_lßd_¡yËsh“t
(
$m©ches
) {

2086 
$f’ame
 = 
$m©ches
[1];

2088 
$fe
 = 
	`dru·l_lßd_¡yËsh“t
(
$f’ame
);

2090 
$dœeùÜy
 = 
	`dœÇme
(
$f’ame
);

2093 
$dœeùÜy
 = $directory == '.' ? '' : $directory .'/';

2098  
	`´eg_»¶aû
('/u¾\s*\(([\'"]?)(?![a-z]+:|\/+)/i', 'u¾(\1'. 
$dœeùÜy
, 
$fe
);

2099 
	}
}

2104 
funùiÚ
 
	$dru·l_ş—r_css_ÿche
() {

2105 
	`fe_sÿn_dœeùÜy
(
	`fe_ü—‹_·th
('css'), '.*', 
	`¬¿y
('.', '..', 'CVS'), 'fe_d–‘e', 
TRUE
);

2106 
	}
}

2164 
funùiÚ
 
dru·l_add_js
(
$d©a
 = 
NULL
, 
$ty³
 = 'moduË', 
$scİe
 = 'h—d”', 
$deãr
 = 
FALSE
, 
$ÿche
 = 
TRUE
, 
$´•roûss
 = TRUE) {

2165 
$javasüt
 = 
¬¿y
();

2167 ià(
is£t
(
$d©a
)) {

2171 ià(
em±y
(
$javasüt
)) {

2172 
	g$javasüt
['h—d”'] = 
¬¿y
(

2173 'cÜe' => 
¬¿y
(

2174 'misc/jqu”y.js' => 
¬¿y
('ÿche' => 
TRUE
, 'deãr' => 
FALSE
, 'preprocess' => TRUE),

2175 'misc/dru·l.js' => 
¬¿y
('ÿche' => 
TRUE
, 'deãr' => 
FALSE
, 'preprocess' => TRUE),

2177 'moduË' => 
¬¿y
(),

2178 'theme' => 
¬¿y
(),

2179 '£‰šg' => 
¬¿y
(

2180 
¬¿y
('ba£P©h' => 
ba£_·th
()),

2182 'šlše' => 
¬¿y
(),

2186 ià(
is£t
(
$scİe
è&& !is£t(
$javasüt
[$scope])) {

2187 
	g$javasüt
[
$scİe
] = 
¬¿y
('core' =>‡rray(), 'module' =>‡rray(), 'theme' =>‡rray(), 'setting' =>‡rray(), 'inline' =>‡rray());

2190 ià(
is£t
(
$ty³
è&& is£t(
$scİe
è&& !is£t(
$javasüt
[$scope][$type])) {

2191 
	g$javasüt
[
$scİe
][
$ty³
] = 
¬¿y
();

2194 
	g$ty³
) {

2196 
$javasüt
[
$scİe
][
$ty³
][] = 
$d©a
;

2199 
$javasüt
[
$scİe
][
$ty³
][] = 
¬¿y
('code' => 
$d©a
, 'deãr' => 
$deãr
);

2203 
$javasüt
[
$scİe
][
$ty³
][
$d©a
] = 
¬¿y
('ÿche' => 
$ÿche
, 'deãr' => 
$deãr
, '´•roûss' => (!$ÿch? 
FALSE
 : 
$´•roûss
));

2207 ià(
is£t
(
$scİe
)) {

2209 ià(
is£t
(
$javasüt
[
$scİe
])) {

2210  
	g$javasüt
[
$scİe
];

2213  
¬¿y
();

2217  
	g$javasüt
;

2238 
funùiÚ
 
dru·l_g‘_js
(
$scİe
 = 'h—d”', 
$javasüt
 = 
NULL
) {

2239 ià((!
defšed
('MAINTENANCE_MODE'è|| 
MAINTENANCE_MODE
 !ğ'upd©e'è&& 
funùiÚ_exi¡s
('locale_update_js_files')) {

2240 
loÿË_upd©e_js_fes
();

2243 ià(!
is£t
(
$javasüt
)) {

2244 
	g$javasüt
 = 
dru·l_add_js
(
NULL
, NULL, 
$scİe
);

2247 ià(
em±y
(
$javasüt
)) {

2251 
	g$ouut
 = '';

2252 
	g$´•roûs£d
 = '';

2253 
	g$no_´•roûss
 = 
¬¿y
('core' => '', 'module' => '', 'theme' => '');

2254 
	g$fes
 = 
¬¿y
();

2255 
	g$´•roûss_js
 = (
v¬ŸbË_g‘
('´•roûss_js', 
FALSE
è&& (!
defšed
('MAINTENANCE_MODE'è|| 
	gMAINTENANCE_MODE
 != 'update'));

2256 
	g$dœeùÜy
 = 
fe_dœeùÜy_·th
();

2257 
	g$is_wr™abË
 = 
is_dœ
(
$dœeùÜy
è&& 
is_wr™abË
($dœeùÜyè&& (
v¬ŸbË_g‘
('fe_dowÆßds', 
FILE_DOWNLOADS_PUBLIC
) == FILE_DOWNLOADS_PUBLIC);

2265 
	g$qu”y_¡ršg
 = '?'. 
sub¡r
(
v¬ŸbË_g‘
('css_js_query_string', '0'), 0, 1);

2270 
	g$embed_´efix
 = "\n<!--//--><![CDATA[//><!--\n";

2271 
	g$embed_suffix
 = "\n//--><!]]>\n";

2273 
fÜ—ch
 (
$javasüt
 
as
 
$ty³
 => 
$d©a
) {

2275 ià(!
$d©a
) ;

2277 
	g$ty³
) {

2279 
$ouut
 .ğ'<süˆty³="‹xt/javasüt">' . 
$embed_´efix
 . 'jQu”y.ex‹nd(Dru·l.£‰šgs, ' . 
dru·l_to_js
(
ÿÎ_u£r_func_¬¿y
('¬¿y_m”ge_»cursive', 
$d©a
)è. ");" . 
	g$embed_suffix
 . "</script>\n";

2282 
fÜ—ch
 (
$d©a
 
as
 
$šfo
) {

2283 
$ouut
 .ğ'<süˆty³="‹xt/javasüt"' . (
$šfo
['deãr'] ? ' deãr="deãr"' : ''è. '>' . 
$embed_´efix
 . $šfo['code'] . 
$embed_suffix
 . "</script>\n";

2289 
fÜ—ch
 (
$d©a
 
as
 
$·th
 => 
$šfo
) {

2290 ià(!
$šfo
['´•roûss'] || !
$is_wr™abË
 || !
$´•roûss_js
) {

2291 
$no_´•roûss
[
$ty³
] .ğ'<süˆty³="‹xt/javasüt"'. (
$šfo
['deãr'] ? ' deãr="deãr"' : ''è.' src="'. 
ba£_·th
(è. 
$·th
 . ($šfo['ÿche'] ? 
$qu”y_¡ršg
 : '?'. 
time
()) ."\"></script>\n";

2294 
	g$fes
[
$·th
] = 
$šfo
;

2301 ià(
	g$is_wr™abË
 && 
	g$´•roûss_js
 && 
couÁ
(
$fes
) > 0) {

2304 
	g$f’ame
 = 'js_'. 
md5
(
£rŸlize
(
$fes
è. 
$qu”y_¡ršg
) .'.js';

2305 
	g$´•roûss_fe
 = 
dru·l_bud_js_ÿche
(
$fes
, 
$f’ame
);

2306 
	g$´•roûs£d
 .ğ'<süˆty³="‹xt/javasüt" src="'. 
ba£_·th
(è. 
$´•roûss_fe
 .'"></script>'."\n";

2311 
	g$ouut
 = 
$´•roûs£d
 . 
im¶ode
('', 
$no_´•roûss
) . $output;

2313  
	g$ouut
;

2423 
funùiÚ
 
	$dru·l_add_bËd¿g
(
$bË_id
, 
$aùiÚ
, 
$»ÏtiÚsh
, 
$group
, 
$subgroup
 = 
NULL
, 
$sourû
 = NULL, 
$hidd’
 = 
TRUE
, 
$lim™
 = 0) {

2424 
$js_added
 = 
FALSE
;

2425 ià(!
$js_added
) {

2426 
	`dru·l_add_js
('misc/tabledrag.js', 'core');

2427 
$js_added
 = 
TRUE
;

2431 
$rg‘
 = 
	`is£t
(
$subgroup
è? $subgrou°: 
$group
;

2432 
$sourû
 = 
	`is£t
($sourûè? $sourû : 
$rg‘
;

2433 
$£‰šgs
['bËD¿g'][
$bË_id
][
$group
][] = 
	`¬¿y
(

2434 'rg‘' => 
$rg‘
,

2435 'sourû' => 
$sourû
,

2436 '»ÏtiÚsh' => 
$»ÏtiÚsh
,

2437 'aùiÚ' => 
$aùiÚ
,

2438 'hidd’' => 
$hidd’
,

2439 'lim™' => 
$lim™
,

2441 
	`dru·l_add_js
(
$£‰šgs
, 'setting');

2442 
	}
}

2454 
funùiÚ
 
	$dru·l_bud_js_ÿche
(
$fes
, 
$f’ame
) {

2455 
$cÚ‹Ás
 = '';

2458 
$j¥©h
 = 
	`fe_ü—‹_·th
('js');

2459 
	`fe_check_dœeùÜy
(
$j¥©h
, 
FILE_CREATE_DIRECTORY
);

2461 ià(!
	`fe_exi¡s
(
$j¥©h
 .'/'. 
$f’ame
)) {

2463 
	`fÜ—ch
 (
$fes
 
as
 
$·th
 => 
$šfo
) {

2464 ià(
$šfo
['preprocess']) {

2466 
$cÚ‹Ás
 .ğ
	`fe_g‘_cÚ‹Ás
(
$·th
) .";\n";

2471 
	`fe_§ve_d©a
(
$cÚ‹Ás
, 
$j¥©h
 .'/'. 
$f’ame
, 
FILE_EXISTS_REPLACE
);

2474  
$j¥©h
 .'/'. 
$f’ame
;

2475 
	}
}

2480 
funùiÚ
 
	$dru·l_ş—r_js_ÿche
() {

2481 
	`fe_sÿn_dœeùÜy
(
	`fe_ü—‹_·th
('js'), '.*', 
	`¬¿y
('.', '..', 'CVS'), 'fe_d–‘e', 
TRUE
);

2482 
	`v¬ŸbË_£t
('javasüt_·r£d', 
	`¬¿y
());

2483 
	}
}

2490 
funùiÚ
 
	$dru·l_to_js
(
$v¬
) {

2491 
	`g‘ty³
(
$v¬
)) {

2493  
$v¬
 ? 'true' : 'false';

2496  
$v¬
;

2499  '"'. 
	`¡r_»¶aû
(
	`¬¿y
("\r", "\n", "<", ">", "&"),

2500 
	`¬¿y
('\r', '\n', '\x3c', '\x3e', '\x26'),

2501 
	`add¦ashes
(
$v¬
)) .'"';

2506 ià(
	`em±y
 (
$v¬
è|| 
	`¬¿y_keys
($v¬è==ğ
	`¿nge
(0, ($var) - 1)) {

2507 
$ouut
 = 
	`¬¿y
();

2508 
	`fÜ—ch
 (
$v¬
 
as
 
$v
) {

2509 
$ouut
[] = 
	`dru·l_to_js
(
$v
);

2511  '[ '. 
	`im¶ode
(', ', 
$ouut
) .' ]';

2515 
$ouut
 = 
	`¬¿y
();

2516 
	`fÜ—ch
 (
$v¬
 
as
 
$k
 => 
$v
) {

2517 
$ouut
[] = 
	`dru·l_to_js
(
	`¡rv®
(
$k
)è.': '. dru·l_to_js(
$v
);

2519  '{ '. 
	`im¶ode
(', ', 
$ouut
) .' }';

2523 
	}
}

2534 
funùiÚ
 
	$dru·l_jsÚ
(
$v¬
 = 
NULL
) {

2536 
	`dru·l_£t_h—d”
('Content-Type:ext/javascript; charset=utf-8');

2538 ià(
	`is£t
(
$v¬
)) {

2539 
echo
 
	`dru·l_to_js
(
$v¬
);

2541 
	}
}

2564 
funùiÚ
 
	$dru·l_u¾’code
(
$‹xt
) {

2565 ià(
	`v¬ŸbË_g‘
('clean_url', '0')) {

2566  
	`¡r_»¶aû
(
	`¬¿y
('%2F', '%26', '%23', '//'),

2567 
	`¬¿y
('/', '%2526', '%2523', '/%252F'),

2568 
	`¿wu¾’code
(
$‹xt
));

2571  
	`¡r_»¶aû
('%2F', '/', 
	`¿wu¾’code
(
$‹xt
));

2573 
	}
}

2581 
funùiÚ
 
	$dru·l_g‘_´iv©e_key
() {

2582 ià(!(
$key
 = 
	`v¬ŸbË_g‘
('drupal_private_key', 0))) {

2583 
$key
 = 
	`md5
(
	`uniqid
(
	`mt_¿nd
(), 
Œue
)) . md5(uniqid(mt_rand(),rue));

2584 
	`v¬ŸbË_£t
('dru·l_´iv©e_key', 
$key
);

2586  
$key
;

2587 
	}
}

2595 
funùiÚ
 
dru·l_g‘_tok’
(
$v®ue
 = '') {

2596 
$´iv©e_key
 = 
dru·l_g‘_´iv©e_key
();

2597  
md5
(
£ssiÚ_id
(è. 
$v®ue
 . 
$´iv©e_key
);

2613 
funùiÚ
 
dru·l_v®id_tok’
(
$tok’
, 
$v®ue
 = '', 
$sk_ªÚymous
 = 
FALSE
) {

2614 
glob®
 
$u£r
;

2615  ((
	g$sk_ªÚymous
 && 
	g$u£r
->
	guid
 =ğ0è|| (
$tok’
 =ğ
md5
(
£ssiÚ_id
(è. 
$v®ue
 . 
v¬ŸbË_g‘
('drupal_private_key', ''))));

2640 
funùiÚ
 
	$xmÌpc
(
$u¾
) {

2641 
»quœe_Úû
 './includes/xmlrpc.inc';

2642 
$¬gs
 = 
	`func_g‘_¬gs
();

2643  
	`ÿÎ_u£r_func_¬¿y
('_xmÌpc', 
$¬gs
);

2644 
	}
}

2646 
funùiÚ
 
	$_dru·l_boÙ¡¿p_fuÎ
() {

2647 
$ÿÎed
;

2649 ià(
$ÿÎed
) {

2652 
$ÿÎed
 = 1;

2653 
»quœe_Úû
 './includes/theme.inc';

2654 
»quœe_Úû
 './includes/pager.inc';

2655 
»quœe_Úû
 './includes/menu.inc';

2656 
»quœe_Úû
 './includes/tablesort.inc';

2657 
»quœe_Úû
 './includes/file.inc';

2658 
»quœe_Úû
 './includes/unicode.inc';

2659 
»quœe_Úû
 './includes/image.inc';

2660 
»quœe_Úû
 './includes/form.inc';

2661 
»quœe_Úû
 './includes/mail.inc';

2662 
»quœe_Úû
 './includes/actions.inc';

2664 
	`£t_”rÜ_hªdËr
('drupal_error_handler');

2666 
	`dru·l_£t_h—d”
('Content-Type:ext/html; charset=utf-8');

2668 
	`unicode_check
();

2670 
	`fix_gpc_magic
();

2672 
	`moduË_lßd_®l
();

2675 ià(!
	`defšed
('MAINTENANCE_MODE'è|| 
MAINTENANCE_MODE
 != 'update') {

2676 
	`moduË_švoke_®l
('init');

2678 
	}
}

2693 
funùiÚ
 
	$·ge_£t_ÿche
() {

2694 
glob®
 
$u£r
, 
$ba£_roÙ
;

2696 ià(!
$u£r
->
uid
 && 
$_SERVER
['REQUEST_METHOD'] =ğ'GET' && 
	`·ge_g‘_ÿche
(
TRUE
)) {

2698 ià(
$d©a
 = 
	`ob_g‘_cÚ‹Ás
()) {

2699 ià(
	`v¬ŸbË_g‘
('·ge_com´essiÚ', 
TRUE
è&& 
	`ex‹nsiÚ_lßded
('zlib')) {

2700 
$d©a
 = 
	`gz’code
($d©a, 9, 
FORCE_GZIP
);

2702 
	`ob_’d_æush
();

2703 
	`ÿche_£t
(
$ba£_roÙ
 . 
	`»que¡_uri
(), 
$d©a
, 'ÿche_·ge', 
CACHE_TEMPORARY
, 
	`dru·l_g‘_h—d”s
());

2706 
	}
}

2713 
funùiÚ
 
	$dru·l_üÚ_run
() {

2715 ià(
	`funùiÚ_exi¡s
('set_time_limit')) {

2716 @
	`£t_time_lim™
(240);

2720 
$£m­hÜe
 = 
	`v¬ŸbË_g‘
('üÚ_£m­hÜe', 
FALSE
);

2722 ià(
$£m­hÜe
) {

2723 ià(
	`time
(è- 
$£m­hÜe
 > 3600) {

2726 
	`w©chdog
('üÚ', 'CrÚ ha b“ÀruÂšg fÜ mÜthª‡Àhou¸ªd i mo¡†ik–y stuck.', 
	`¬¿y
(), 
WATCHDOG_ERROR
);

2729 
	`v¬ŸbË_d–
('cron_semaphore');

2733 
	`w©chdog
('üÚ', 'A‰em±šgØ»-ruÀüÚ wh™ i ®»ady„uÂšg.', 
	`¬¿y
(), 
WATCHDOG_WARNING
);

2738 
	`»gi¡”_shutdown_funùiÚ
('drupal_cron_cleanup');

2741 
	`v¬ŸbË_£t
('üÚ_£m­hÜe', 
	`time
());

2744 
	`moduË_švoke_®l
('cron');

2747 
	`v¬ŸbË_£t
('üÚ_Ï¡', 
	`time
());

2748 
	`w©chdog
('üÚ', 'CrÚ„uÀcom¶‘ed.', 
	`¬¿y
(), 
WATCHDOG_NOTICE
);

2751 
	`v¬ŸbË_d–
('cron_semaphore');

2754  
TRUE
;

2756 
	}
}

2761 
funùiÚ
 
	$dru·l_üÚ_ş—nup
() {

2763 ià(
	`v¬ŸbË_g‘
('üÚ_£m­hÜe', 
FALSE
)) {

2764 
	`w©chdog
('üÚ', 'CrÚ„uÀexûededhtimlim™‡nd wa abÜ‹d.', 
	`¬¿y
(), 
WATCHDOG_WARNING
);

2767 
	`v¬ŸbË_d–
('cron_semaphore');

2769 
	}
}

2798 
funùiÚ
 
dru·l_sy¡em_li¡šg
(
$mask
, 
$dœeùÜy
, 
$key
 = 'Çme', 
$mš_d•th
 = 1) {

2799 
glob®
 
$´ofe
;

2800 
	g$cÚfig
 = 
cÚf_·th
();

2807 ià(!
is£t
(
$´ofe
)) {

2808 
	g$´ofe
 = 
v¬ŸbË_g‘
('install_profile', 'default');

2810 
	g$£¬chdœ
 = 
¬¿y
(
$dœeùÜy
);

2811 
	g$fes
 = 
¬¿y
();

2817 ià(
fe_exi¡s
("profiles/$profile/$directory")) {

2818 
	g$£¬chdœ
[] = "profiles/$profile/$directory";

2822 
	g$£¬chdœ
[] = 's™es/®l/'. 
$dœeùÜy
;

2824 ià(
fe_exi¡s
("$config/$directory")) {

2825 
	g$£¬chdœ
[] = "$config/$directory";

2829 
fÜ—ch
 (
$£¬chdœ
 
as
 
$dœ
) {

2830 
	g$fes
 = 
¬¿y_m”ge
(
$fes
, 
fe_sÿn_dœeùÜy
(
$dœ
, 
$mask
, 
¬¿y
('.', '..', 'CVS'), 0, 
TRUE
, 
$key
, 
$mš_d•th
));

2833  
	g$fes
;

2853 
funùiÚ
 
	$dru·l_®‹r
(
$ty³
, &
$d©a
) {

2862 ià(
	`is_¬¿y
(
$d©a
è&& 
	`is£t
($data['__drupal_alter_by_ref'])) {

2863 
$by_»f_·¿m‘”s
 = 
$d©a
['__drupal_alter_by_ref'];

2864 
	`un£t
(
$d©a
['__drupal_alter_by_ref']);

2869 
$¬gs
 = 
	`¬¿y
(&
$d©a
);

2870 ià(
	`is£t
(
$by_»f_·¿m‘”s
)) {

2871 
$¬gs
 = 
	`¬¿y_m”ge
($¬gs, 
$by_»f_·¿m‘”s
);

2876 
$add™iÚ®_¬gs
 = 
	`func_g‘_¬gs
();

2877 
	`¬¿y_shiá
(
$add™iÚ®_¬gs
);

2878 
	`¬¿y_shiá
(
$add™iÚ®_¬gs
);

2879 
$¬gs
 = 
	`¬¿y_m”ge
($¬gs, 
$add™iÚ®_¬gs
);

2881 
	`fÜ—ch
 (
	`moduË_im¶em’ts
(
$ty³
 .'_®‹r'è
as
 
$moduË
) {

2882 
$funùiÚ
 = 
$moduË
 .'_'. 
$ty³
 .'_alter';

2883 
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
$¬gs
);

2885 
	}
}

2907 
funùiÚ
 
	$dru·l_»nd”
(&
$–em’ts
) {

2908 ià(!
	`is£t
(
$–em’ts
) || (isset($elements['#access']) && !$elements['#access'])) {

2909  
NULL
;

2914 ià(!
	`is£t
(
$–em’ts
['#defaults_loaded']) || !$elements['#defaults_loaded']) {

2915 ià((!
	`em±y
(
$–em’ts
['#ty³'])è&& (
$šfo
 = 
	`_–em’t_šfo
($elements['#type']))) {

2916 
$–em’ts
 +ğ
$šfo
;

2923 ià(
	`is£t
(
$–em’ts
['#pre_render'])) {

2924 
	`fÜ—ch
 (
$–em’ts
['#´e_»nd”'] 
as
 
$funùiÚ
) {

2925 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

2926 
$–em’ts
 = 
	`$funùiÚ
($elements);

2931 
$cÚ‹Á
 = '';

2934 ià(!
	`is£t
(
$–em’ts
['#sorted'])) {

2935 
	`uasÜt
(
$–em’ts
, "element_sort");

2937 
$–em’ts
 +ğ
	`¬¿y
('#t™Ë' => 
NULL
, '#description' => NULL);

2938 ià(!
	`is£t
(
$–em’ts
['#children'])) {

2939 
$chd»n
 = 
	`–em’t_chd»n
(
$–em’ts
);

2941 ià(
	`is£t
(
$–em’ts
['#theme']è&& 
	`em±y
($elements['#theme_used'])) {

2942 
$–em’ts
['#theme_u£d'] = 
TRUE
;

2944 
$´evious
 = 
	`¬¿y
();

2945 
	`fÜ—ch
 (
	`¬¿y
('#v®ue', '#ty³', '#´efix', '#suffix'è
as
 
$key
) {

2946 
$´evious
[
$key
] = 
	`is£t
(
$–em’ts
[$key]è? $–em’ts[$key] : 
NULL
;

2949 ià(
	`em±y
(
$chd»n
)) {

2950 
$–em’ts
['#´š‹d'] = 
TRUE
;

2953 
$–em’ts
['#value'] = '';

2955 
$–em’ts
['#type'] = 'markup';

2957 
	`un£t
(
$–em’ts
['#prefix'], $elements['#suffix']);

2958 
$cÚ‹Á
 = 
	`theme
(
$–em’ts
['#theme'], $elements);

2960 
	`fÜ—ch
 (
	`¬¿y
('#v®ue', '#ty³', '#´efix', '#suffix'è
as
 
$key
) {

2961 
$–em’ts
[
$key
] = 
	`is£t
(
$´evious
[$key]è? $´evious[$key] : 
NULL
;

2965 ià(!
	`is£t
(
$cÚ‹Á
) || $content === '') {

2966 
	`fÜ—ch
 (
$chd»n
 
as
 
$key
) {

2967 
$cÚ‹Á
 .ğ
	`dru·l_»nd”
(
$–em’ts
[
$key
]);

2971 ià(
	`is£t
(
$cÚ‹Á
) && $content !== '') {

2972 
$–em’ts
['#chd»n'] = 
$cÚ‹Á
;

2976 ià(!
	`is£t
(
$–em’ts
['#printed'])) {

2977 
$cÚ‹Á
 = 
	`theme
(!
	`em±y
(
$–em’ts
['#type']) ? $elements['#type'] : 'markup', $elements);

2978 
$–em’ts
['#´š‹d'] = 
TRUE
;

2981 ià(
	`is£t
(
$cÚ‹Á
) && $content !== '') {

2985 ià(
	`is£t
(
$–em’ts
['#post_render'])) {

2986 
	`fÜ—ch
 (
$–em’ts
['#po¡_»nd”'] 
as
 
$funùiÚ
) {

2987 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

2988 
$cÚ‹Á
 = 
	`$funùiÚ
($cÚ‹Á, 
$–em’ts
);

2992 
$´efix
 = 
	`is£t
(
$–em’ts
['#prefix']) ? $elements['#prefix'] : '';

2993 
$suffix
 = 
	`is£t
(
$–em’ts
['#suffix']) ? $elements['#suffix'] : '';

2994  
$´efix
 . 
$cÚ‹Á
 . 
$suffix
;

2996 
	}
}

3001 
funùiÚ
 
	$–em’t_sÜt
(
$a
, 
$b
) {

3002 
$a_weight
 = (
	`is_¬¿y
(
$a
è&& 
	`is£t
($a['#weight'])) ? $a['#weight'] : 0;

3003 
$b_weight
 = (
	`is_¬¿y
(
$b
è&& 
	`is£t
($b['#weight'])) ? $b['#weight'] : 0;

3004 ià(
$a_weight
 =ğ
$b_weight
) {

3007  (
$a_weight
 < 
$b_weight
) ? -1 : 1;

3008 
	}
}

3013 
funùiÚ
 
	$–em’t_´İ”ty
(
$key
) {

3014  
$key
[0] == '#';

3015 
	}
}

3020 
funùiÚ
 
	$–em’t_´İ”t›s
(
$–em’t
) {

3021  
	`¬¿y_f‹r
(
	`¬¿y_keys
((
¬¿y
è
$–em’t
), 'element_property');

3022 
	}
}

3027 
funùiÚ
 
	$–em’t_chd
(
$key
) {

3028  !
	`is£t
(
$key
[0]) || $key[0] != '#';

3029 
	}
}

3034 
funùiÚ
 
	$–em’t_chd»n
(
$–em’t
) {

3035  
	`¬¿y_f‹r
(
	`¬¿y_keys
((
¬¿y
è
$–em’t
), 'element_child');

3036 
	}
}

3041 
funùiÚ
 
	$dru·l_commÚ_theme
() {

3042  
	`¬¿y
(

3044 '¶aûhŞd”' => 
	`¬¿y
(

3045 '¬gum’ts' => 
	`¬¿y
('‹xt' => 
NULL
)

3047 '·ge' => 
	`¬¿y
(

3048 '¬gum’ts' => 
	`¬¿y
('cÚ‹Á' => 
NULL
, 'show_blocks' => 
TRUE
, 'show_messages' => TRUE),

3051 'maš‹Çnû_·ge' => 
	`¬¿y
(

3052 '¬gum’ts' => 
	`¬¿y
('cÚ‹Á' => 
NULL
, 'show_blocks' => 
TRUE
, 'show_messages' => TRUE),

3055 'upd©e_·ge' => 
	`¬¿y
(

3056 '¬gum’ts' => 
	`¬¿y
('cÚ‹Á' => 
NULL
, 'show_mes§ges' => 
TRUE
),

3058 'š¡®l_·ge' => 
	`¬¿y
(

3059 '¬gum’ts' => 
	`¬¿y
('cÚ‹Á' => 
NULL
),

3061 'sk_li¡' => 
	`¬¿y
(

3062 '¬gum’ts' => 
	`¬¿y
('™ems' => 
NULL
, 'active' => NULL),

3064 '¡©us_mes§ges' => 
	`¬¿y
(

3065 '¬gum’ts' => 
	`¬¿y
('di¥Ïy' => 
NULL
),

3067 'lšks' => 
	`¬¿y
(

3068 '¬gum’ts' => 
	`¬¿y
('lšks' => 
NULL
, 'attributes' =>‡rray('class' => 'links')),

3070 'image' => 
	`¬¿y
(

3071 '¬gum’ts' => 
	`¬¿y
('·th' => 
NULL
, '®t' => '', 't™Ë' => '', '©Œibu‹s' => NULL, 'g‘size' => 
TRUE
),

3073 'b»adüumb' => 
	`¬¿y
(

3074 '¬gum’ts' => 
	`¬¿y
('b»adüumb' => 
NULL
),

3076 'h–p' => 
	`¬¿y
(

3077 '¬gum’ts' => 
	`¬¿y
(),

3079 'subm’u' => 
	`¬¿y
(

3080 '¬gum’ts' => 
	`¬¿y
('lšks' => 
NULL
),

3082 'bË' => 
	`¬¿y
(

3083 '¬gum’ts' => 
	`¬¿y
('h—d”' => 
NULL
, 'rows' => NULL, 'attributes' =>‡rray(), 'caption' => NULL),

3085 'bË_£Ëù_h—d”_ûÎ' => 
	`¬¿y
(

3086 '¬gum’ts' => 
	`¬¿y
(),

3088 'bËsÜt_šdiÿtÜ' => 
	`¬¿y
(

3089 '¬gum’ts' => 
	`¬¿y
('¡yË' => 
NULL
),

3091 'box' => 
	`¬¿y
(

3092 '¬gum’ts' => 
	`¬¿y
('t™Ë' => 
NULL
, 'content' => NULL, 'region' => 'main'),

3095 'block' => 
	`¬¿y
(

3096 '¬gum’ts' => 
	`¬¿y
('block' => 
NULL
),

3099 'm¬k' => 
	`¬¿y
(

3100 '¬gum’ts' => 
	`¬¿y
('ty³' => 
MARK_NEW
),

3102 '™em_li¡' => 
	`¬¿y
(

3103 '¬gum’ts' => 
	`¬¿y
('™ems' =>‡¼ay(), 't™Ë' => 
NULL
, 'type' => 'ul', 'attributes' => NULL),

3105 'mÜe_h–p_lšk' => 
	`¬¿y
(

3106 '¬gum’ts' => 
	`¬¿y
('u¾' => 
NULL
),

3108 'xml_icÚ' => 
	`¬¿y
(

3109 '¬gum’ts' => 
	`¬¿y
('u¾' => 
NULL
),

3111 'ãed_icÚ' => 
	`¬¿y
(

3112 '¬gum’ts' => 
	`¬¿y
('u¾' => 
NULL
, 'title' => NULL),

3114 'mÜe_lšk' => 
	`¬¿y
(

3115 '¬gum’ts' => 
	`¬¿y
('u¾' => 
NULL
, 'title' => NULL)

3117 'şosu»' => 
	`¬¿y
(

3118 '¬gum’ts' => 
	`¬¿y
('main' => 0),

3120 'blocks' => 
	`¬¿y
(

3121 '¬gum’ts' => 
	`¬¿y
('»giÚ' => 
NULL
),

3123 'u£ºame' => 
	`¬¿y
(

3124 '¬gum’ts' => 
	`¬¿y
('objeù' => 
NULL
),

3126 '´og»ss_b¬' => 
	`¬¿y
(

3127 '¬gum’ts' => 
	`¬¿y
('³rûÁ' => 
NULL
, 'message' => NULL),

3129 'šd’tiÚ' => 
	`¬¿y
(

3130 '¬gum’ts' => 
	`¬¿y
('size' => 1),

3133 '·g”' => 
	`¬¿y
(

3134 '¬gum’ts' => 
	`¬¿y
('tags' =>‡rray(), 'limit' => 10, 'element' => 0, 'parameters' =>‡rray()),

3136 '·g”_fœ¡' => 
	`¬¿y
(

3137 '¬gum’ts' => 
	`¬¿y
('‹xt' => 
NULL
, 'limit' => NULL, 'element' => 0, 'parameters' =>‡rray()),

3139 '·g”_´evious' => 
	`¬¿y
(

3140 '¬gum’ts' => 
	`¬¿y
('‹xt' => 
NULL
, 'limit' => NULL, 'element' => 0, 'interval' => 1, 'parameters' =>‡rray()),

3142 '·g”_Ãxt' => 
	`¬¿y
(

3143 '¬gum’ts' => 
	`¬¿y
('‹xt' => 
NULL
, 'limit' => NULL, 'element' => 0, 'interval' => 1, 'parameters' =>‡rray()),

3145 '·g”_Ï¡' => 
	`¬¿y
(

3146 '¬gum’ts' => 
	`¬¿y
('‹xt' => 
NULL
, 'limit' => NULL, 'element' => 0, 'parameters' =>‡rray()),

3148 '·g”_lšk' => 
	`¬¿y
(

3149 '¬gum’ts' => 
	`¬¿y
('‹xt' => 
NULL
, 'page_new' => NULL, 'element' => NULL, 'parameters' =>‡rray(), 'attributes' =>‡rray()),

3152 'loÿË_admš_mªage_sü“n' => 
	`¬¿y
(

3153 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

3156 'm’u_™em_lšk' => 
	`¬¿y
(

3157 '¬gum’ts' => 
	`¬¿y
('™em' => 
NULL
),

3159 'm’u_Œ“' => 
	`¬¿y
(

3160 '¬gum’ts' => 
	`¬¿y
('Œ“' => 
NULL
),

3162 'm’u_™em' => 
	`¬¿y
(

3163 '¬gum’ts' => 
	`¬¿y
('lšk' => 
NULL
, 'has_children' => NULL, 'menu' => ''),

3165 'm’u_loÿl_sk' => 
	`¬¿y
(

3166 '¬gum’ts' => 
	`¬¿y
('lšk' => 
NULL
, 'aùive' => 
FALSE
),

3168 'm’u_loÿl_sks' => 
	`¬¿y
(

3169 '¬gum’ts' => 
	`¬¿y
(),

3172 '£Ëù' => 
	`¬¿y
(

3173 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3175 'f›ld£t' => 
	`¬¿y
(

3176 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3178 '¿dio' => 
	`¬¿y
(

3179 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3181 '¿dios' => 
	`¬¿y
(

3182 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3184 '·sswÜd_cÚfœm' => 
	`¬¿y
(

3185 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3187 'd©e' => 
	`¬¿y
(

3188 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3190 '™em' => 
	`¬¿y
(

3191 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3193 'checkbox' => 
	`¬¿y
(

3194 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3196 'checkboxes' => 
	`¬¿y
(

3197 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3199 'subm™' => 
	`¬¿y
(

3200 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3202 'bu‰Ú' => 
	`¬¿y
(

3203 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3205 'image_bu‰Ú' => 
	`¬¿y
(

3206 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3208 'hidd’' => 
	`¬¿y
(

3209 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3211 'tok’' => 
	`¬¿y
(

3212 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3214 '‹xtf›ld' => 
	`¬¿y
(

3215 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3217 'fÜm' => 
	`¬¿y
(

3218 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3220 '‹x»a' => 
	`¬¿y
(

3221 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3223 'm¬kup' => 
	`¬¿y
(

3224 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3226 '·sswÜd' => 
	`¬¿y
(

3227 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3229 'fe' => 
	`¬¿y
(

3230 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

3232 'fÜm_–em’t' => 
	`¬¿y
(

3233 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
, 'value' => NULL),

3236 
	}
}

3254 
funùiÚ
 
	$dru·l_g‘_schema
(
$bË
 = 
NULL
, 
$»bud
 = 
FALSE
) {

3255 
$schema
 = 
	`¬¿y
();

3257 ià(
	`em±y
(
$schema
è|| 
$»bud
) {

3259 ià(!
$»bud
 && 
$ÿched
 = 
	`ÿche_g‘
('schema')) {

3260 
$schema
 = 
$ÿched
->
d©a
;

3264 
$schema
 = 
	`¬¿y
();

3266 
	`moduË_lßd_®l_šşudes
('install');

3269 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('schema'è
as
 
$moduË
) {

3270 
$cu¼’t
 = 
	`moduË_švoke
(
$moduË
, 'schema');

3271 
	`_dru·l_š™Ÿlize_schema
(
$moduË
, 
$cu¼’t
);

3272 
$schema
 = 
	`¬¿y_m”ge
($schema, 
$cu¼’t
);

3275 
	`dru·l_®‹r
('schema', 
$schema
);

3276 
	`ÿche_£t
('schema', 
$schema
);

3280 ià(!
	`is£t
(
$bË
)) {

3281  
$schema
;

3283 
	`–£if
 (
	`is£t
(
$schema
[
$bË
])) {

3284  
$schema
[
$bË
];

3287  
FALSE
;

3289 
	}
}

3305 
funùiÚ
 
	$dru·l_š¡®l_schema
(
$moduË
) {

3306 
$schema
 = 
	`dru·l_g‘_schema_uÅroûs£d
(
$moduË
);

3307 
	`_dru·l_š™Ÿlize_schema
(
$moduË
, 
$schema
);

3309 
$»t
 = 
	`¬¿y
();

3310 
	`fÜ—ch
 (
$schema
 
as
 
$Çme
 => 
$bË
) {

3311 
	`db_ü—‹_bË
(
$»t
, 
$Çme
, 
$bË
);

3313  
$»t
;

3314 
	}
}

3330 
funùiÚ
 
	$dru·l_unš¡®l_schema
(
$moduË
) {

3331 
$schema
 = 
	`dru·l_g‘_schema_uÅroûs£d
(
$moduË
);

3332 
	`_dru·l_š™Ÿlize_schema
(
$moduË
, 
$schema
);

3334 
$»t
 = 
	`¬¿y
();

3335 
	`fÜ—ch
 (
$schema
 
as
 
$bË
) {

3336 
	`db_drİ_bË
(
$»t
, 
$bË
['name']);

3338  
$»t
;

3339 
	}
}

3365 
funùiÚ
 
	$dru·l_g‘_schema_uÅroûs£d
(
$moduË
, 
$bË
 = 
NULL
) {

3367 
	`moduË_lßd_š¡®l
(
$moduË
);

3368 
$schema
 = 
	`moduË_švoke
(
$moduË
, 'schema');

3370 ià(!
	`is_nuÎ
(
$bË
è&& 
	`is£t
(
$schema
[$table])) {

3371  
$schema
[
$bË
];

3374  
$schema
;

3376 
	}
}

3387 
funùiÚ
 
	$_dru·l_š™Ÿlize_schema
(
$moduË
, &
$schema
) {

3389 
	`fÜ—ch
 (
$schema
 
as
 
$Çme
 => 
$bË
) {

3390 ià(
	`em±y
(
$bË
['module'])) {

3391 
$schema
[
$Çme
]['moduË'] = 
$moduË
;

3393 ià(!
	`is£t
(
$bË
['name'])) {

3394 
$schema
[
$Çme
]['name'] = $name;

3397 
	}
}

3409 
funùiÚ
 
	$dru·l_schema_f›lds_sql
(
$bË
, 
$´efix
 = 
NULL
) {

3410 
$schema
 = 
	`dru·l_g‘_schema
(
$bË
);

3411 
$f›lds
 = 
	`¬¿y_keys
(
$schema
['fields']);

3412 ià(
$´efix
) {

3413 
$cŞumns
 = 
	`¬¿y
();

3414 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
) {

3415 
$cŞumns
[] = "$prefix.$field";

3417  
$cŞumns
;

3420  
$f›lds
;

3422 
	}
}

3447 
funùiÚ
 
dru·l_wr™e_»cÜd
(
$bË
, &
$objeù
, 
$upd©e
 = 
	$¬¿y
()) {

3449 ià(
	`is_¡ršg
(
$upd©e
)) {

3450 
$upd©e
 = 
	`¬¿y
($update);

3453 
$schema
 = 
	`dru·l_g‘_schema
(
$bË
);

3454 ià(
	`em±y
(
$schema
)) {

3455  
FALSE
;

3459 ià(
	`is_¬¿y
(
$objeù
)) {

3460 
$objeù
 = (
objeù
) $object;

3461 
$¬¿y
 = 
TRUE
;

3464 
$¬¿y
 = 
FALSE
;

3467 
$f›lds
 = 
$defs
 = 
$v®ues
 = 
$£rŸls
 = 
$¶aûhŞd”s
 = 
	`¬¿y
();

3471 
	`fÜ—ch
 (
$schema
['f›lds'] 
as
 
$f›ld
 => 
$šfo
) {

3473 ià(
$šfo
['ty³'] =ğ'£rŸl' && 
	`couÁ
(
$upd©e
)) {

3478 ià(!
	`is£t
(
$objeù
->
$f›ld
è&& !
	`couÁ
(
$upd©e
è&& is£t(
$šfo
['default'])) {

3479 
$objeù
->
$f›ld
 = 
$šfo
['default'];

3483 ià(
$šfo
['type'] == 'serial') {

3484 
$£rŸls
[] = 
$f›ld
;

3486 
	`un£t
(
$objeù
->
$f›ld
);

3490 ià(
	`is£t
(
$objeù
->
$f›ld
)) {

3491 
$f›lds
[] = 
$f›ld
;

3492 
$¶aûhŞd”s
[] = 
	`db_ty³_¶aûhŞd”
(
$šfo
['type']);

3494 ià(
	`em±y
(
$šfo
['serialize'])) {

3495 
$v®ues
[] = 
$objeù
->
$f›ld
;

3498 
$v®ues
[] = 
	`£rŸlize
(
$objeù
->
$f›ld
);

3504 
$qu”y
 = '';

3505 ià(!
	`couÁ
(
$upd©e
)) {

3506 
$qu”y
 = "INSERT INTO {". 
$bË
 ."} (". 
	`im¶ode
(', ', 
$f›lds
è.'èVALUES ('. im¶ode(', ', 
$¶aûhŞd”s
) .')';

3507 
$»tuº
 = 
SAVED_NEW
;

3510 
$qu”y
 = '';

3511 
	`fÜ—ch
 (
$f›lds
 
as
 
$id
 => 
$f›ld
) {

3512 ià(
$qu”y
) {

3513 
$qu”y
 .= ', ';

3515 
$qu”y
 .ğ
$f›ld
 .' = '. 
$¶aûhŞd”s
[
$id
];

3518 
	`fÜ—ch
 (
$upd©e
 
as
 
$key
){

3519 
$cÚd™iÚs
[] = "$key = ". 
	`db_ty³_¶aûhŞd”
(
$schema
['f›lds'][
$key
]['type']);

3520 
$v®ues
[] = 
$objeù
->
$key
;

3523 
$qu”y
 = "UPDATE {". 
$bË
 ."} SET $qu”y WHERE ". 
	`im¶ode
(' AND ', 
$cÚd™iÚs
);

3524 
$»tuº
 = 
SAVED_UPDATED
;

3528 ià(
	`db_qu”y
(
$qu”y
, 
$v®ues
)) {

3529 ià(
$£rŸls
) {

3531 
	`fÜ—ch
 (
$£rŸls
 
as
 
$f›ld
) {

3532 
$objeù
->
$f›ld
 = 
	`db_Ï¡_š£¹_id
(
$bË
, $field);

3537 
$»tuº
 = 
FALSE
;

3541 ià(
$¬¿y
) {

3542 
$objeù
 = (
¬¿y
) $object;

3545  
$»tuº
;

3546 
	}
}

3611 
funùiÚ
 
	$dru·l_·r£_šfo_fe
(
$f’ame
) {

3612 
$šfo
 = 
	`¬¿y
();

3613 
$cÚ¡ªts
 = 
	`g‘_defšed_cÚ¡ªts
();

3615 ià(!
	`fe_exi¡s
(
$f’ame
)) {

3616  
$šfo
;

3619 
$d©a
 = 
	`fe_g‘_cÚ‹Ás
(
$f’ame
);

3620 ià(
	`´eg_m©ch_®l
('

3621 @^\
s
* #S¹ 
©
 
the
 
begšnšg
 
of
 
a
 
lše
, 
ignÜšg
 
Ëadšg
 
wh™e¥aû


3623 [^=;\[\]]| #Key 
Çmes
 
ÿÂÙ
 
cÚš
 
equ®
 
signs
, 
£mi
-
cŞÚs
 
Ü
 
squ¬e
 
b¿ck‘s
,

3624 \[[^\[\]]*\] #uÆes 
they
 
¬e
 
b®ªûd
 
ªd
 
nÙ
 
Ã¡ed


3626 \
s
*=\s* #Key/
v®ue
 
·œs
 
¬e
 
£·¿‹d
 
by
 
equ®
 
	`signs
 (
ignÜšg
 
wh™e
-
¥aû
)

3628 ("(?:[^"]|(?<=\\\\)")*")| #DoubË-
quÙed
 
¡ršg
, 
which
 
may
 
cÚš
 
¦ash
-
esÿ³d
 
quÙes
/
¦ashes


3630 ([^\
r
\
n
]*?è#NÚ-
quÙed
 
¡ršg


3631 )\
s
*
$
 #Stİ 
©
 
the
 
Ãxt
 
’d
 
of
 
a
 
lše
, 
ignÜšg
 
Œašg
 
wh™e¥aû


3632 @
msx
', $data, $matches, PREG_SET_ORDER)) {

3633 
	`fÜ—ch
 (
$m©ches
 
as
 
$m©ch
) {

3635 
$i
 = 0;

3636 
	`fÜ—ch
 (
	`¬¿y
('key', 'v®ue1', 'v®ue2', 'v®ue3'è
as
 
$v¬
) {

3637 
$$v¬
 = 
	`is£t
(
$m©ch
[++
$i
]) ? $match[$i] : '';

3639 
$v®ue
 = 
	`¡r¦ashes
(
	`sub¡r
(
$v®ue1
, 1, -1)è. sŒ¦ashes(sub¡r(
$v®ue2
, 1, -1)è. 
$v®ue3
;

3642 
$keys
 = 
	`´eg_¥l™
('/\]?\[/', 
	`¹rim
(
$key
, ']'));

3643 
$Ï¡
 = 
	`¬¿y_pİ
(
$keys
);

3644 
$·»Á
 = &
$šfo
;

3647 
	`fÜ—ch
 (
$keys
 
as
 
$key
) {

3648 ià(
$key
 == '') {

3649 
$key
 = 
	`couÁ
(
$·»Á
);

3651 ià(!
	`is£t
(
$·»Á
[
$key
]è|| !
	`is_¬¿y
($parent[$key])) {

3652 
$·»Á
[
$key
] = 
	`¬¿y
();

3654 
$·»Á
 = &$·»Á[
$key
];

3658 ià(
	`is£t
(
$cÚ¡ªts
[
$v®ue
])) {

3659 
$v®ue
 = 
$cÚ¡ªts
[$value];

3663 ià(
$Ï¡
 == '') {

3664 
$Ï¡
 = 
	`couÁ
(
$·»Á
);

3666 
$·»Á
[
$Ï¡
] = 
$v®ue
;

3668 
	}
}

3670  
	g$šfo
;

3679 
funùiÚ
 
	$w©chdog_£v”™y_Ëv–s
() {

3680  
	`¬¿y
(

3681 
WATCHDOG_EMERG
 => 
	`t
('emergency'),

3682 
WATCHDOG_ALERT
 => 
	`t
('alert'),

3683 
WATCHDOG_CRITICAL
 => 
	`t
('critical'),

3684 
WATCHDOG_ERROR
 => 
	`t
('error'),

3685 
WATCHDOG_WARNING
 => 
	`t
('warning'),

3686 
WATCHDOG_NOTICE
 => 
	`t
('notice'),

3687 
WATCHDOG_INFO
 => 
	`t
('info'),

3688 
WATCHDOG_DEBUG
 => 
	`t
('debug'),

3690 
	}
}

3698 
funùiÚ
 
	$dru·l_ex¶ode_gs
(
$gs
) {

3701 
$»gexp
 = '%(?:^|,\ *)("(?>[^"]*)(?>""[^"]* )*"|(?: [^",]*))%x';

3702 
	`´eg_m©ch_®l
(
$»gexp
, 
$gs
, 
$m©ches
);

3703 
$ty³d_gs
 = 
	`¬¿y_unique
(
$m©ches
[1]);

3705 
$gs
 = 
	`¬¿y
();

3706 
	`fÜ—ch
 (
$ty³d_gs
 
as
 
$g
) {

3710 
$g
 = 
	`Œim
(
	`¡r_»¶aû
('""', '"', 
	`´eg_»¶aû
('/^"(.*)"$/', '\1', $tag)));

3711 ià(
$g
 != "") {

3712 
$gs
[] = 
$g
;

3716  
$gs
;

3717 
	}
}

3724 
funùiÚ
 
	$dru·l_im¶ode_gs
(
$gs
) {

3725 
$’coded_gs
 = 
	`¬¿y
();

3726 
	`fÜ—ch
 (
$gs
 
as
 
$g
) {

3728 ià(
	`¡½os
(
$g
, ','è!=ğ
FALSE
 || strpos($tag, '"') !== FALSE) {

3729 
$g
 = '"'. 
	`¡r_»¶aû
('"', '""', $tag) .'"';

3732 
$’coded_gs
[] = 
$g
;

3734  
	`im¶ode
(', ', 
$’coded_gs
);

3735 
	}
}

3743 
funùiÚ
 
	$dru·l_æush_®l_ÿches
() {

3745 
	`_dru·l_æush_css_js
();

3747 
	`dru·l_ş—r_css_ÿche
();

3748 
	`dru·l_ş—r_js_ÿche
();

3752 ià(
	`defšed
('MAINTENANCE_MODE'è&& 
MAINTENANCE_MODE
 == 'update') {

3753 
	`_sy¡em_theme_d©a
();

3756 
	`sy¡em_theme_d©a
();

3759 
	`dru·l_»bud_theme_»gi¡ry
();

3760 
	`m’u_»bud
();

3761 
	`node_ty³s_»bud
();

3764 
$cÜe
 = 
	`¬¿y
('cache', 'cache_block', 'cache_filter', 'cache_page');

3765 
$ÿche_bËs
 = 
	`¬¿y_m”ge
(
	`moduË_švoke_®l
('æush_ÿches'), 
$cÜe
);

3766 
	`fÜ—ch
 (
$ÿche_bËs
 
as
 
$bË
) {

3767 
	`ÿche_ş—r_®l
('*', 
$bË
, 
TRUE
);

3769 
	}
}

3780 
funùiÚ
 
	$_dru·l_æush_css_js
() {

3781 
$¡ršg_hi¡Üy
 = 
	`v¬ŸbË_g‘
('css_js_query_string', '00000000000000000000');

3782 
$Ãw_ch¬aù”
 = 
$¡ršg_hi¡Üy
[0];

3784 
$ch¬aù”s
 = 'abcdefghijklmnoprstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';

3785 
	`¡½os
(
$¡ršg_hi¡Üy
, 
$Ãw_ch¬aù”
è!=ğ
FALSE
) {

3786 
$Ãw_ch¬aù”
 = 
$ch¬aù”s
[
	`mt_¿nd
(0, 
	`¡¾’
($characters) - 1)];

3788 
	`v¬ŸbË_£t
('css_js_qu”y_¡ršg', 
$Ãw_ch¬aù”
 . 
	`sub¡r
(
$¡ršg_hi¡Üy
, 0, 19));

3789 
	}
}

	@/srv/http/subs/notes/www/includes/database.inc

1 <?
php


14 
defše
('DB_ERROR', 'a515ac9c2796ca0e23adbe92c68fc9fc');

64 
funùiÚ
 
	$upd©e_sql
(
$sql
) {

65 
$»suÉ
 = 
	`db_qu”y
(
$sql
, 
Œue
);

66  
	`¬¿y
('sucûss' => 
$»suÉ
 !=ğ
FALSE
, 'qu”y' => 
	`check_¶aš
(
$sql
));

67 
	}
}

82 
funùiÚ
 
	$db_´efix_bËs
(
$sql
) {

83 
glob®
 
$db_´efix
;

85 ià(
	`is_¬¿y
(
$db_´efix
)) {

86 ià(
	`¬¿y_key_exi¡s
('deçuÉ', 
$db_´efix
)) {

87 
$tmp
 = 
$db_´efix
;

88 
	`un£t
(
$tmp
['default']);

89 
	`fÜ—ch
 (
$tmp
 
as
 
$key
 => 
$v®
) {

90 
$sql
 = 
	`¡¹r
($sql, 
	`¬¿y
('{'. 
$key
 .'}' => 
$v®
 . $key));

92  
	`¡¹r
(
$sql
, 
	`¬¿y
('{' => 
$db_´efix
['default'], '}' => ''));

95 
	`fÜ—ch
 (
$db_´efix
 
as
 
$key
 => 
$v®
) {

96 
$sql
 = 
	`¡¹r
($sql, 
	`¬¿y
('{'. 
$key
 .'}' => 
$v®
 . $key));

98  
	`¡¹r
(
$sql
, 
	`¬¿y
('{' => '', '}' => ''));

102  
	`¡¹r
(
$sql
, 
	`¬¿y
('{' => 
$db_´efix
, '}' => ''));

104 
	}
}

124 
funùiÚ
 
db_£t_aùive
(
$Çme
 = 'default') {

125 
glob®
 
$db_u¾
, 
$db_ty³
, 
$aùive_db
;

126 
	g$db_cÚns
, 
	g$aùive_Çme
 = 
FALSE
;

128 ià(
em±y
(
$db_u¾
)) {

129 
	gšşude_Úû
 'includes/install.inc';

130 
š¡®l_gÙo
('install.php');

133 ià(!
is£t
(
$db_cÚns
[
$Çme
])) {

135 ià(
is_¬¿y
(
$db_u¾
)) {

136 
	g$cÚÃù_u¾
 = 
¬¿y_key_exi¡s
(
$Çme
, 
$db_u¾
è? 
	g$db_u¾
[$name] : $db_url['default'];

139 
	g$cÚÃù_u¾
 = 
$db_u¾
;

142 
	g$db_ty³
 = 
sub¡r
(
$cÚÃù_u¾
, 0, 
¡½os
($connect_url, '://'));

143 
	g$hªdËr
 = "./includes/database.$db_type.inc";

145 ià(
is_fe
(
$hªdËr
)) {

146 
šşude_Úû
 
	g$hªdËr
;

149 
_db_”rÜ_·ge
("Thd©aba£y³ '". 
$db_ty³
 ."' is unsupported. Please useƒither 'mysql' or 'mysqli' for MySQL, or 'pgsql' for PostgreSQL databases.");

152 
	g$db_cÚns
[
$Çme
] = 
db_cÚÃù
(
$cÚÃù_u¾
);

155 
	g$´evious_Çme
 = 
$aùive_Çme
;

157 
	g$aùive_Çme
 = 
$Çme
;

158 
	g$aùive_db
 = 
$db_cÚns
[
$Çme
];

160  
	g$´evious_Çme
;

173 
funùiÚ
 
_db_”rÜ_·ge
(
$”rÜ
 = '') {

174 
glob®
 
$db_ty³
;

175 
dru·l_š™_Ïnguage
();

176 
dru·l_maš‹Çnû_theme
();

177 
dru·l_£t_h—d”
('HTTP/1.1 503 Service Unavailable');

178 
dru·l_£t_t™Ë
('Site off-line');

180 
	g$mes§ge
 = '<p>The site is currently‚ot‡vailable dueoechnical…roblems. Pleasery‡gain†ater. Thank you for your understanding.</p>';

181 
	g$mes§ge
 .= '<hr /><p><small>If you‡rehe maintainer ofhis site,…lease check your database settings inhe <code>settings.php</code> file‡ndƒnsurehat your hosting…rovider\'s database server is„unning. For more help, seehe <a href="http://drupal.org/node/258">handbook</a>, or contact your hosting…rovider.</small></p>';

183 ià(
	g$”rÜ
 && 
ši_g‘
('display_errors')) {

184 
	g$mes§ge
 .ğ'<p><sm®l>Th'. 
theme
('¶aûhŞd”', 
$db_ty³
è.'ƒ¼Ü was: '.heme('¶aûhŞd”', 
$”rÜ
) .'.</small></p>';

187 
´št
 
theme
('maš‹Çnû_·ge', 
$mes§ge
);

188 
	gex™
;

194 
funùiÚ
 
	$db_is_aùive
() {

195 
glob®
 
$aùive_db
;

196  !
	`em±y
(
$aùive_db
);

197 
	}
}

202 
funùiÚ
 
	$_db_qu”y_ÿÎback
(
$m©ch
, 
$š™
 = 
FALSE
) {

203 
$¬gs
 = 
NULL
;

204 ià(
$š™
) {

205 
$¬gs
 = 
$m©ch
;

209 
$m©ch
[1]) {

211 
$v®ue
 = 
	`¬¿y_shiá
(
$¬gs
);

213 ià(
$v®ue
 > 
PHP_INT_MAX
) {

214 
$´ecisiÚ
 = 
	`ši_g‘
('precision');

215 @
	`ši_£t
('precision', 16);

216 
$v®ue
 = 
	`¥rštf
('%.0f', $value);

217 @
	`ši_£t
('´ecisiÚ', 
$´ecisiÚ
);

220 
$v®ue
 = () $value;

223  
$v®ue
;

225  
	`db_esÿ³_¡ršg
(
	`¬¿y_shiá
(
$¬gs
));

229 
$v®ue
 = 
	`Œim
(
	`¬¿y_shiá
(
$¬gs
));

230  
	`is_num”ic
(
$v®ue
è&& !
	`´eg_m©ch
('/x/i', $value) ? $value : '0';

234  (è
	`¬¿y_shiá
(
$¬gs
);

236  
	`db_’code_blob
(
	`¬¿y_shiá
(
$¬gs
));

238 
	}
}

251 
funùiÚ
 
db_¶aûhŞd”s
(
$¬gum’ts
, 
$ty³
 = 'int') {

252 
$¶aûhŞd”
 = 
db_ty³_¶aûhŞd”
(
$ty³
);

253  
im¶ode
(',', 
¬¿y_fl
(0, 
couÁ
(
$¬gum’ts
), 
$¶aûhŞd”
));

259 
defše
('DB_QUERY_REGEXP', '/(%d|%s|%%|%f|%b|%n)/');

281 
funùiÚ
 
_db_»wr™e_sql
(
$qu”y
 = '', 
$´im¬y_bË
 = 'n', 
$´im¬y_f›ld
 = 'nid', 
$¬gs
 = 
	$¬¿y
()) {

282 
$wh”e
 = 
	`¬¿y
();

283 
$još
 = 
	`¬¿y
();

284 
$di¡šù
 = 
FALSE
;

285 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('db_»wr™e_sql'è
as
 
$moduË
) {

286 
$»suÉ
 = 
	`moduË_švoke
(
$moduË
, 'db_»wr™e_sql', 
$qu”y
, 
$´im¬y_bË
, 
$´im¬y_f›ld
, 
$¬gs
);

287 ià(
	`is£t
(
$»suÉ
è&& 
	`is_¬¿y
($result)) {

288 ià(
	`is£t
(
$»suÉ
['where'])) {

289 
$wh”e
[] = 
$»suÉ
['where'];

291 ià(
	`is£t
(
$»suÉ
['join'])) {

292 
$još
[] = 
$»suÉ
['join'];

294 ià(
	`is£t
(
$»suÉ
['distinct']) && $result['distinct']) {

295 
$di¡šù
 = 
TRUE
;

298 
	`–£if
 (
	`is£t
(
$»suÉ
)) {

299 
$wh”e
[] = 
$»suÉ
;

303 
$wh”e
 = 
	`em±y
($wh”eè? '' : '('. 
	`im¶ode
(') AND (', $where) .')';

304 
$još
 = 
	`em±y
($jošè? '' : 
	`im¶ode
(' ', $join);

306  
	`¬¿y
(
$još
, 
$wh”e
, 
$di¡šù
);

307 
	}
}

328 
funùiÚ
 
db_»wr™e_sql
(
$qu”y
, 
$´im¬y_bË
 = 'n', 
$´im¬y_f›ld
 = 'nid', 
$¬gs
 = 
	$¬¿y
()) {

329 
	`li¡
(
$još
, 
$wh”e
, 
$di¡šù
èğ
	`_db_»wr™e_sql
(
$qu”y
, 
$´im¬y_bË
, 
$´im¬y_f›ld
, 
$¬gs
);

331 ià(
$di¡šù
) {

332 
$qu”y
 = 
	`db_di¡šù_f›ld
(
$´im¬y_bË
, 
$´im¬y_f›ld
, $query);

335 ià(!
	`em±y
(
$wh”e
è|| !em±y(
$još
)) {

336 
$·‰”n
 = '{

337 #Begšnšg 
of
 
the
 
¡ršg


339 ((?
P
<
ªÚymous_v›w
>

340 #Ev”ythšg 
w™hš
 
this
 
£t
 
of
 
·»Áhe£s
 
is
 
Çmed
 "anonymous view"

342 [^()]++ #ªythšg 
nÙ
 
·»Áhe£s


344 \Ğ(?
P
>
ªÚymous_v›w
è\è#ª 
İ’
 
·»Áhesis
, 
mÜe
 "ªÚymou v›w" 
ªd
 
fš®ly
 
a
 
şo£
…arenthesis.

346 )[^()]+
WHERE
)

347 }
x
';

348 
	`´eg_m©ch
(
$·‰”n
, 
$qu”y
, 
$m©ches
);

349 ià(!
$wh”e
) {

350 
$wh”e
 = '1 = 1';

352 ià(
$m©ches
) {

353 
$n
 = 
	`¡¾’
(
$m©ches
[1]);

354 
$£cÚd_·¹
 = 
	`sub¡r
(
$qu”y
, 
$n
);

355 
$fœ¡_·¹
 = 
	`sub¡r
(
$m©ches
[1], 0, 
$n
 - 5) ." $join WHERE $where AND ( ";

357 
$hay¡ack_»v”£
 = 
	`¡¼ev
(
$£cÚd_·¹
);

360 
$hay¡ack_»v”£
 = 
	`¡¼ev
(
$qu”y
);

364 
	`fÜ—ch
 (
	`¬¿y
('PUORG', 'REDRO', 'TIMIL'è
as
 
$ÃedË_»v”£
) {

365 
$pos
 = 
	`¡½os
(
$hay¡ack_»v”£
, 
$ÃedË_»v”£
);

366 ià(
$pos
 !=ğ
FALSE
) {

368 
$pos
 += 5;

372 ià(
$m©ches
) {

373 ià(
$pos
 ==ğ
FALSE
) {

374 
$qu”y
 = 
$fœ¡_·¹
 . 
$£cÚd_·¹
 .')';

377 
$qu”y
 = 
$fœ¡_·¹
 . 
	`sub¡r
(
$£cÚd_·¹
, 0, -
$pos
) .')'. substr($second_part, -$pos);

380 
	`–£if
 (
$pos
 ==ğ
FALSE
) {

381 
$qu”y
 .= " $join WHERE $where";

384 
$qu”y
 = 
	`sub¡r
($qu”y, 0, -
$pos
) . " $join WHERE $where " . substr($query, -$pos);

386 
	}
}

388  
	g$qu”y
;

407 
funùiÚ
 
	$db_di¡šù_f›ld
(
$bË
, 
$f›ld
, 
$qu”y
) {

408 
$m©ches
 = 
	`¬¿y
();

409 ià(!
	`´eg_m©ch
('/^SELECT\s*DISTINCT/i', 
$qu”y
, 
$m©ches
)) {

411 
$qu”y
 = 
	`´eg_»¶aû
('/^SELECT/i', 'SELECT DISTINCT', $query);

414  
$qu”y
;

415 
	}
}

422 
funùiÚ
 
	$db_esÿ³_bË
(
$¡ršg
) {

423  
	`´eg_»¶aû
('/[^A-Za-z0-9_]+/', '', 
$¡ršg
);

424 
	}
}

552 
funùiÚ
 
	$db_ü—‹_bË
(&
$»t
, 
$Çme
, 
$bË
) {

553 
$¡©em’ts
 = 
	`db_ü—‹_bË_sql
(
$Çme
, 
$bË
);

554 
	`fÜ—ch
 (
$¡©em’ts
 
as
 
$¡©em’t
) {

555 
$»t
[] = 
	`upd©e_sql
(
$¡©em’t
);

557 
	}
}

570 
funùiÚ
 
	$db_f›ld_Çmes
(
$f›lds
) {

571 
$»t
 = 
	`¬¿y
();

572 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
) {

573 ià(
	`is_¬¿y
(
$f›ld
)) {

574 
$»t
[] = 
$f›ld
[0];

577 
$»t
[] = 
$f›ld
;

580  
$»t
;

581 
	}
}

594 
funùiÚ
 
	$db_ty³_¶aûhŞd”
(
$ty³
) {

595 
$ty³
) {

622  'unsuµÜ‹dy³ '. 
$ty³
 .'for db_type_placeholder';

623 
	}
}

	@/srv/http/subs/notes/www/includes/database.mysql-common.inc

1 <?
php


33 
funùiÚ
 
	$db_qu”y
(
$qu”y
) {

34 
$¬gs
 = 
	`func_g‘_¬gs
();

35 
	`¬¿y_shiá
(
$¬gs
);

36 
$qu”y
 = 
	`db_´efix_bËs
($query);

37 ià(
	`is£t
(
$¬gs
[0]è
ªd
 
	`is_¬¿y
($args[0])) {

38 
$¬gs
 = $args[0];

40 
	`_db_qu”y_ÿÎback
(
$¬gs
, 
TRUE
);

41 
$qu”y
 = 
	`´eg_»¶aû_ÿÎback
(
DB_QUERY_REGEXP
, '_db_query_callback', $query);

42  
	`_db_qu”y
(
$qu”y
);

43 
	}
}

60 
funùiÚ
 
	$db_ü—‹_bË_sql
(
$Çme
, 
$bË
) {

62 ià(
	`em±y
(
$bË
['mysql_suffix'])) {

63 
$bË
['mysql_suffix'] = "/*!40100 DEFAULT CHARACTER SET UTF8 */";

66 
$sql
 = "CREATE TABLE {". 
$Çme
 ."} (\n";

69 
	`fÜ—ch
 (
$bË
['f›lds'] 
as
 
$f›ld_Çme
 => 
$f›ld
) {

70 
$sql
 .ğ
	`_db_ü—‹_f›ld_sql
(
$f›ld_Çme
, 
	`_db_´oûss_f›ld
(
$f›ld
)) .", \n";

74 
$keys
 = 
	`_db_ü—‹_keys_sql
(
$bË
);

75 ià(
	`couÁ
(
$keys
)) {

76 
$sql
 .ğ
	`im¶ode
(", \n", 
$keys
) .", \n";

80 
$sql
 = 
	`sub¡r
($sql, 0, -3) ."\n) ";

82 
$sql
 .ğ
$bË
['mysql_suffix'];

84  
	`¬¿y
(
$sql
);

85 
	}
}

87 
funùiÚ
 
	$_db_ü—‹_keys_sql
(
$¥ec
) {

88 
$keys
 = 
	`¬¿y
();

90 ià(!
	`em±y
(
$¥ec
['primary key'])) {

91 
$keys
[] = 'PRIMARY KEY ('. 
	`_db_ü—‹_key_sql
(
$¥ec
['primary key']) .')';

93 ià(!
	`em±y
(
$¥ec
['unique keys'])) {

94 
	`fÜ—ch
 (
$¥ec
['uniqukeys'] 
as
 
$key
 => 
$f›lds
) {

95 
$keys
[] = 'UNIQUE KEY '. 
$key
 .' ('. 
	`_db_ü—‹_key_sql
(
$f›lds
) .')';

98 ià(!
	`em±y
(
$¥ec
['indexes'])) {

99 
	`fÜ—ch
 (
$¥ec
['šdexes'] 
as
 
$šdex
 => 
$f›lds
) {

100 
$keys
[] = 'INDEX '. 
$šdex
 .' ('. 
	`_db_ü—‹_key_sql
(
$f›lds
) .')';

104  
$keys
;

105 
	}
}

107 
funùiÚ
 
	$_db_ü—‹_key_sql
(
$f›lds
) {

108 
$»t
 = 
	`¬¿y
();

109 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
) {

110 ià(
	`is_¬¿y
(
$f›ld
)) {

111 
$»t
[] = 
$f›ld
[0] .'('. $field[1] .')';

114 
$»t
[] = 
$f›ld
;

117  
	`im¶ode
(', ', 
$»t
);

118 
	}
}

126 
funùiÚ
 
	$_db_´oûss_f›ld
(
$f›ld
) {

128 ià(!
	`is£t
(
$f›ld
['size'])) {

129 
$f›ld
['size'] = 'normal';

133 ià(!
	`is£t
(
$f›ld
['mysql_type'])) {

134 
$m­
 = 
	`db_ty³_m­
();

135 
$f›ld
['mysql_ty³'] = 
$m­
[$field['type'] .':'. $field['size']];

138 ià(
$f›ld
['type'] == 'serial') {

139 
$f›ld
['auto_šüem’t'] = 
TRUE
;

142  
$f›ld
;

143 
	}
}

156 
funùiÚ
 
	$_db_ü—‹_f›ld_sql
(
$Çme
, 
$¥ec
) {

157 
$sql
 = "`". 
$Çme
 ."` ". 
$¥ec
['mysql_type'];

159 ià(
	`š_¬¿y
(
$¥ec
['ty³'], 
	`¬¿y
('v¬ch¬', 'ch¬', '‹xt')è&& 
	`is£t
($spec['length'])) {

160 
$sql
 .ğ'('. 
$¥ec
['length'] .')';

162 
	`–£if
 (
	`is£t
(
$¥ec
['precision']) && isset($spec['scale'])) {

163 
$sql
 .ğ'('. 
$¥ec
['precision'] .', '. $spec['scale'] .')';

166 ià(!
	`em±y
(
$¥ec
['unsigned'])) {

167 
$sql
 .= ' unsigned';

170 ià(!
	`em±y
(
$¥ec
['not‚ull'])) {

171 
$sql
 .= ' NOT NULL';

174 ià(!
	`em±y
(
$¥ec
['auto_increment'])) {

175 
$sql
 .= '‡uto_increment';

178 ià(
	`is£t
(
$¥ec
['default'])) {

179 ià(
	`is_¡ršg
(
$¥ec
['default'])) {

180 
$¥ec
['default'] = "'". $spec['default'] ."'";

182 
$sql
 .ğ' DEFAULT '. 
$¥ec
['default'];

185 ià(
	`em±y
(
$¥ec
['nÙ‚uÎ']è&& !
	`is£t
($spec['default'])) {

186 
$sql
 .= ' DEFAULT NULL';

189  
$sql
;

190 
	}
}

196 
funùiÚ
 
	$db_ty³_m­
() {

200 
$m­
 = 
	`¬¿y
(

235  
$m­
;

236 
	}
}

248 
funùiÚ
 
	$db_»Çme_bË
(&
$»t
, 
$bË
, 
$Ãw_Çme
) {

249 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} RENAME TO {'. 
$Ãw_Çme
 .'}');

250 
	}
}

260 
funùiÚ
 
	$db_drİ_bË
(&
$»t
, 
$bË
) {

261 
$»t
[] = 
	`upd©e_sql
('DROP TABLE {'. 
$bË
 .'}');

262 
	}
}

287 
funùiÚ
 
db_add_f›ld
(&
$»t
, 
$bË
, 
$f›ld
, 
$¥ec
, 
$keys_Ãw
 = 
	$¬¿y
()) {

288 
$fixnuÎ
 = 
FALSE
;

289 ià(!
	`em±y
(
$¥ec
['nÙ‚uÎ']è&& !
	`is£t
($spec['default'])) {

290 
$fixnuÎ
 = 
TRUE
;

291 
$¥ec
['nÙ‚uÎ'] = 
FALSE
;

293 
$qu”y
 = 'ALTER TABLE {'. 
$bË
 .'} ADD ';

294 
$qu”y
 .ğ
	`_db_ü—‹_f›ld_sql
(
$f›ld
, 
	`_db_´oûss_f›ld
(
$¥ec
));

295 ià(
	`couÁ
(
$keys_Ãw
)) {

296 
$qu”y
 .ğ', ADD '. 
	`im¶ode
(', ADD ', 
	`_db_ü—‹_keys_sql
(
$keys_Ãw
));

298 
$»t
[] = 
	`upd©e_sql
(
$qu”y
);

299 ià(
	`is£t
(
$¥ec
['initial'])) {

301 
$sql
 = 'UPDATE {'. 
$bË
 .'} SET '. 
$f›ld
 .' = '. 
	`db_ty³_¶aûhŞd”
(
$¥ec
['type']);

302 
$»suÉ
 = 
	`db_qu”y
(
$sql
, 
$¥ec
['initial']);

303 
$»t
[] = 
	`¬¿y
('sucûss' => 
$»suÉ
 !=ğ
FALSE
, 'qu”y' => 
	`check_¶aš
(
$sql
 .' ('. 
$¥ec
['initial'] .')'));

305 ià(
$fixnuÎ
) {

306 
$¥ec
['nÙ‚uÎ'] = 
TRUE
;

307 
	`db_chªge_f›ld
(
$»t
, 
$bË
, 
$f›ld
, $f›ld, 
$¥ec
);

309 
	}
}

321 
funùiÚ
 
	$db_drİ_f›ld
(&
$»t
, 
$bË
, 
$f›ld
) {

322 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} DROP '. 
$f›ld
);

323 
	}
}

337 
funùiÚ
 
	$db_f›ld_£t_deçuÉ
(&
$»t
, 
$bË
, 
$f›ld
, 
$deçuÉ
) {

338 ià(
$deçuÉ
 ==ğ
NULL
) {

339 
$deçuÉ
 = 'NULL';

342 
$deçuÉ
 = 
	`is_¡ršg
($default) ? "'$default'" : $default;

345 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} ALTER COLUMN '. 
$f›ld
 .' SET DEFAULT '. 
$deçuÉ
);

346 
	}
}

358 
funùiÚ
 
	$db_f›ld_£t_no_deçuÉ
(&
$»t
, 
$bË
, 
$f›ld
) {

359 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} ALTER COLUMN '. 
$f›ld
 .' DROP DEFAULT');

360 
	}
}

372 
funùiÚ
 
	$db_add_´im¬y_key
(&
$»t
, 
$bË
, 
$f›lds
) {

373 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} ADD PRIMARY KEY ('.

374 
	`_db_ü—‹_key_sql
(
$f›lds
) .')');

375 
	}
}

385 
funùiÚ
 
	$db_drİ_´im¬y_key
(&
$»t
, 
$bË
) {

386 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} DROP PRIMARY KEY');

387 
	}
}

401 
funùiÚ
 
	$db_add_unique_key
(&
$»t
, 
$bË
, 
$Çme
, 
$f›lds
) {

402 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} ADD UNIQUE KEY '.

403 
$Çme
 .' ('. 
	`_db_ü—‹_key_sql
(
$f›lds
) .')');

404 
	}
}

416 
funùiÚ
 
	$db_drİ_unique_key
(&
$»t
, 
$bË
, 
$Çme
) {

417 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} DROP KEY '. 
$Çme
);

418 
	}
}

432 
funùiÚ
 
	$db_add_šdex
(&
$»t
, 
$bË
, 
$Çme
, 
$f›lds
) {

433 
$qu”y
 = 'ALTER TABLE {'. 
$bË
 .'} ADD INDEX '. 
$Çme
 .' ('. 
	`_db_ü—‹_key_sql
(
$f›lds
) .')';

434 
$»t
[] = 
	`upd©e_sql
(
$qu”y
);

435 
	}
}

447 
funùiÚ
 
	$db_drİ_šdex
(&
$»t
, 
$bË
, 
$Çme
) {

448 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} DROP INDEX '. 
$Çme
);

449 
	}
}

514 
funùiÚ
 
db_chªge_f›ld
(&
$»t
, 
$bË
, 
$f›ld
, 
$f›ld_Ãw
, 
$¥ec
, 
$keys_Ãw
 = 
	$¬¿y
()) {

515 
$sql
 = 'ALTER TABLE {'. 
$bË
 .'} CHANGE `'. 
$f›ld
 .'` '.

516 
	`_db_ü—‹_f›ld_sql
(
$f›ld_Ãw
, 
	`_db_´oûss_f›ld
(
$¥ec
));

517 ià(
	`couÁ
(
$keys_Ãw
)) {

518 
$sql
 .ğ', ADD '. 
	`im¶ode
(', ADD ', 
	`_db_ü—‹_keys_sql
(
$keys_Ãw
));

520 
$»t
[] = 
	`upd©e_sql
(
$sql
);

521 
	}
}

531 
funùiÚ
 
	$db_Ï¡_š£¹_id
(
$bË
, 
$f›ld
) {

532  
	`db_»suÉ
(
	`db_qu”y
('SELECT LAST_INSERT_ID()'));

533 
	}
}

	@/srv/http/subs/notes/www/includes/database.mysql.inc

1 <?
php


15 
	g»quœe_Úû
 './includes/database.mysql-common.inc';

20 
funùiÚ
 
	$db_¡©us_»pÜt
(
$pha£
) {

21 
$t
 = 
	`g‘_t
();

23 
$v”siÚ
 = 
	`db_v”siÚ
();

25 
$fÜm
['mysql'] = 
	`¬¿y
(

26 't™Ë' => 
	`$t
('MySQL database'),

27 'v®ue' => (
$pha£
 =ğ'ruÁime'è? 
	`l
(
$v”siÚ
, 'admin/reports/status/sql') : $version,

30 ià(
	`v”siÚ_com·»
(
$v”siÚ
, 
DRUPAL_MINIMUM_MYSQL
) < 0) {

31 
$fÜm
['mysql']['£v”™y'] = 
REQUIREMENT_ERROR
;

32 
$fÜm
['mysql']['desütiÚ'] = 
	`$t
('You¸MySQL S”v” i toØŞd. Dru·È»quœe ©†—¡ MySQL %v”siÚ.', 
	`¬¿y
('%v”siÚ' => 
DRUPAL_MINIMUM_MYSQL
));

35  
$fÜm
;

36 
	}
}

43 
funùiÚ
 
	$db_v”siÚ
() {

44 
	`li¡
(
$v”siÚ
èğ
	`ex¶ode
('-', 
	`mysql_g‘_£rv”_šfo
());

45  
$v”siÚ
;

46 
	}
}

51 
funùiÚ
 
	$db_cÚÃù
(
$u¾
) {

52 
$u¾
 = 
	`·r£_u¾
($url);

55 ià(!
	`funùiÚ_exi¡s
('mysql_connect')) {

56 
	`_db_”rÜ_·ge
('Unableo usehe MySQL database becausehe MySQLƒxtension for PHP is‚ot installed. Check your <code>php.ini</code>o see how you canƒnable it.');

60 
$u¾
['u£r'] = 
	`u¾decode
($url['user']);

62 
$u¾
['·ss'] = 
	`is£t
($u¾['·ss']è? 
	`u¾decode
($url['pass']) : '';

63 
$u¾
['ho¡'] = 
	`u¾decode
($url['host']);

64 
$u¾
['·th'] = 
	`u¾decode
($url['path']);

67 ià(
	`is£t
(
$u¾
['port'])) {

68 
$u¾
['host'] = $url['host'] .':'. $url['port'];

77 
$cÚÃùiÚ
 = @
	`mysql_cÚÃù
(
$u¾
['ho¡'], $u¾['u£r'], $u¾['·ss'], 
TRUE
, 2);

78 ià(!
$cÚÃùiÚ
 || !
	`mysql_£Ëù_db
(
	`sub¡r
(
$u¾
['path'], 1))) {

80 
	`_db_”rÜ_·ge
(
	`mysql_”rÜ
());

84 
	`mysql_qu”y
('SET NAMES "utf8"', 
$cÚÃùiÚ
);

85  
$cÚÃùiÚ
;

86 
	}
}

91 
funùiÚ
 
	$_db_qu”y
(
$qu”y
, 
$debug
 = 0) {

92 
glob®
 
$aùive_db
, 
$qu”›s
, 
$u£r
;

94 ià(
	`v¬ŸbË_g‘
('dev_query', 0)) {

95 
	`li¡
(
$u£c
, 
$£c
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

96 
$tim”
 = ()
$u£c
 + ()
$£c
;

100 
$bt
 = 
	`debug_backŒaû
();

102 
$Çme
 = 
$u£r
->
uid
 ? $u£r->
Çme
 : 
	`v¬ŸbË_g‘
('anonymous', 'Anonymous');

104 
$Çme
 = 
	`¡r_»¶aû
(
	`¬¿y
('*', '/'), '', $name);

105 
$qu”y
 = '/* '. 
$Çme
 .' : '. 
$bt
[2]['function'] .' */ '. $query;

108 
$»suÉ
 = 
	`mysql_qu”y
(
$qu”y
, 
$aùive_db
);

110 ià(
	`v¬ŸbË_g‘
('dev_query', 0)) {

111 
$qu”y
 = 
$bt
[2]['function'] ."\n". $query;

112 
	`li¡
(
$u£c
, 
$£c
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

113 
$¡İ
 = ()
$u£c
 + ()
$£c
;

114 
$diff
 = 
$¡İ
 - 
$tim”
;

115 
$qu”›s
[] = 
	`¬¿y
(
$qu”y
, 
$diff
);

118 ià(
$debug
) {

119 
´št
 '<p>qu”y: '. 
$qu”y
 .'<b¸/>”rÜ:'. 
	`mysql_”rÜ
(
$aùive_db
) .'</p>';

122 ià(!
	`mysql_”ºo
(
$aùive_db
)) {

123  
$»suÉ
;

127 
$
{
DB_ERROR
} = 
TRUE
;

128 
	`Œigg”_”rÜ
(
	`check_¶aš
(
	`mysql_”rÜ
(
$aùive_db
è."\nqu”y: ". 
$qu”y
), 
E_USER_WARNING
);

129  
FALSE
;

131 
	}
}

142 
funùiÚ
 
	$db_ãtch_objeù
(
$»suÉ
) {

143 ià(
$»suÉ
) {

144  
	`mysql_ãtch_objeù
(
$»suÉ
);

146 
	}
}

158 
funùiÚ
 
	$db_ãtch_¬¿y
(
$»suÉ
) {

159 ià(
$»suÉ
) {

160  
	`mysql_ãtch_¬¿y
(
$»suÉ
, 
MYSQL_ASSOC
);

162 
	}
}

175 
funùiÚ
 
	$db_»suÉ
(
$»suÉ
) {

176 ià(
$»suÉ
 && 
	`mysql_num_rows
($result) > 0) {

179 
$¬¿y
 = 
	`mysql_ãtch_row
(
$»suÉ
);

180  
$¬¿y
[0];

182  
FALSE
;

183 
	}
}

188 
funùiÚ
 
	$db_”rÜ
() {

189 
glob®
 
$aùive_db
;

190  
	`mysql_”ºo
(
$aùive_db
);

191 
	}
}

196 
funùiÚ
 
	$db_afãùed_rows
() {

197 
glob®
 
$aùive_db
;

198  
	`mysql_afãùed_rows
(
$aùive_db
);

199 
	}
}

229 
funùiÚ
 
	$db_qu”y_¿nge
(
$qu”y
) {

230 
$¬gs
 = 
	`func_g‘_¬gs
();

231 
$couÁ
 = 
	`¬¿y_pİ
(
$¬gs
);

232 
$äom
 = 
	`¬¿y_pİ
(
$¬gs
);

233 
	`¬¿y_shiá
(
$¬gs
);

235 
$qu”y
 = 
	`db_´efix_bËs
($query);

236 ià(
	`is£t
(
$¬gs
[0]è
ªd
 
	`is_¬¿y
($args[0])) {

237 
$¬gs
 = $args[0];

239 
	`_db_qu”y_ÿÎback
(
$¬gs
, 
TRUE
);

240 
$qu”y
 = 
	`´eg_»¶aû_ÿÎback
(
DB_QUERY_REGEXP
, '_db_query_callback', $query);

241 
$qu”y
 .ğ' LIMIT '. ()
$äom
 .', '. ()
$couÁ
;

242  
	`_db_qu”y
(
$qu”y
);

243 
	}
}

277 
funùiÚ
 
	$db_qu”y_‹mpÜ¬y
(
$qu”y
) {

278 
$¬gs
 = 
	`func_g‘_¬gs
();

279 
$bËÇme
 = 
	`¬¿y_pİ
(
$¬gs
);

280 
	`¬¿y_shiá
(
$¬gs
);

282 
$qu”y
 = 
	`´eg_»¶aû
('/^SELECT/i', 'CREATE TEMPORARY TABLE '. 
$bËÇme
 .' Engše=HEAP SELECT', 
	`db_´efix_bËs
($query));

283 ià(
	`is£t
(
$¬gs
[0]è
ªd
 
	`is_¬¿y
($args[0])) {

284 
$¬gs
 = $args[0];

286 
	`_db_qu”y_ÿÎback
(
$¬gs
, 
TRUE
);

287 
$qu”y
 = 
	`´eg_»¶aû_ÿÎback
(
DB_QUERY_REGEXP
, '_db_query_callback', $query);

288  
	`_db_qu”y
(
$qu”y
);

289 
	}
}

299 
funùiÚ
 
	$db_’code_blob
(
$d©a
) {

300 
glob®
 
$aùive_db
;

301  "'". 
	`mysql_»®_esÿ³_¡ršg
(
$d©a
, 
$aùive_db
) ."'";

302 
	}
}

312 
funùiÚ
 
	$db_decode_blob
(
$d©a
) {

313  
$d©a
;

314 
	}
}

319 
funùiÚ
 
	$db_esÿ³_¡ršg
(
$‹xt
) {

320 
glob®
 
$aùive_db
;

321  
	`mysql_»®_esÿ³_¡ršg
(
$‹xt
, 
$aùive_db
);

322 
	}
}

327 
funùiÚ
 
	$db_lock_bË
(
$bË
) {

328 
	`db_qu”y
('LOCK TABLES {'. 
	`db_esÿ³_bË
(
$bË
) .'} WRITE');

329 
	}
}

334 
funùiÚ
 
	$db_uÆock_bËs
() {

335 
	`db_qu”y
('UNLOCK TABLES');

336 
	}
}

341 
funùiÚ
 
	$db_bË_exi¡s
(
$bË
) {

342  (
boŞ
è
	`db_ãtch_objeù
(
	`db_qu”y
("SHOW TABLES LIKE '{". 
	`db_esÿ³_bË
(
$bË
) ."}'"));

343 
	}
}

348 
funùiÚ
 
	$db_cŞumn_exi¡s
(
$bË
, 
$cŞumn
) {

349  (
boŞ
è
	`db_ãtch_objeù
(
	`db_qu”y
("SHOW COLUMNS FROM {". 
	`db_esÿ³_bË
(
$bË
è."} LIKE '". db_esÿ³_bË(
$cŞumn
) ."'"));

350 
	}
}

	@/srv/http/subs/notes/www/includes/database.mysqli.inc

1 <?
php


18 
	g»quœe_Úû
 './includes/database.mysql-common.inc';

23 
funùiÚ
 
	$db_¡©us_»pÜt
(
$pha£
) {

24 
$t
 = 
	`g‘_t
();

26 
$v”siÚ
 = 
	`db_v”siÚ
();

28 
$fÜm
['mysql'] = 
	`¬¿y
(

29 't™Ë' => 
	`$t
('MySQL database'),

30 'v®ue' => (
$pha£
 =ğ'ruÁime'è? 
	`l
(
$v”siÚ
, 'admin/reports/status/sql') : $version,

33 ià(
	`v”siÚ_com·»
(
$v”siÚ
, 
DRUPAL_MINIMUM_MYSQL
) < 0) {

34 
$fÜm
['mysql']['£v”™y'] = 
REQUIREMENT_ERROR
;

35 
$fÜm
['mysql']['desütiÚ'] = 
	`$t
('You¸MySQL S”v” i toØŞd. Dru·È»quœe ©†—¡ MySQL %v”siÚ.', 
	`¬¿y
('%v”siÚ' => 
DRUPAL_MINIMUM_MYSQL
));

38  
$fÜm
;

39 
	}
}

46 
funùiÚ
 
	$db_v”siÚ
() {

47 
glob®
 
$aùive_db
;

48 
	`li¡
(
$v”siÚ
èğ
	`ex¶ode
('-', 
	`mysqli_g‘_£rv”_šfo
(
$aùive_db
));

49  
$v”siÚ
;

50 
	}
}

57 
funùiÚ
 
	$db_cÚÃù
(
$u¾
) {

59 ià(!
	`funùiÚ_exi¡s
('mysqli_š™'è&& !
	`ex‹nsiÚ_lßded
('mysqli')) {

60 
	`_db_”rÜ_·ge
('Unableo usehe MySQLi database becausehe MySQLiƒxtension for PHP is‚ot installed. Check your <code>php.ini</code>o see how you canƒnable it.');

63 
$u¾
 = 
	`·r£_u¾
($url);

66 
$u¾
['u£r'] = 
	`u¾decode
($url['user']);

68 
$u¾
['·ss'] = 
	`is£t
($u¾['·ss']è? 
	`u¾decode
($url['pass']) : '';

69 
$u¾
['ho¡'] = 
	`u¾decode
($url['host']);

70 
$u¾
['·th'] = 
	`u¾decode
($url['path']);

71 ià(!
	`is£t
(
$u¾
['port'])) {

72 
$u¾
['pÜt'] = 
NULL
;

75 
$cÚÃùiÚ
 = 
	`mysqli_š™
();

76 @
	`mysqli_»®_cÚÃù
(
$cÚÃùiÚ
, 
$u¾
['ho¡'], $u¾['u£r'], $u¾['·ss'], 
	`sub¡r
($u¾['·th'], 1), $u¾['pÜt'], 
NULL
, 
MYSQLI_CLIENT_FOUND_ROWS
);

78 ià(
	`mysqli_cÚÃù_”ºo
() > 0) {

79 
	`_db_”rÜ_·ge
(
	`mysqli_cÚÃù_”rÜ
());

83 
	`mysqli_qu”y
(
$cÚÃùiÚ
, 'SET NAMES "utf8"');

85  
$cÚÃùiÚ
;

86 
	}
}

91 
funùiÚ
 
	$_db_qu”y
(
$qu”y
, 
$debug
 = 0) {

92 
glob®
 
$aùive_db
, 
$qu”›s
, 
$u£r
;

94 ià(
	`v¬ŸbË_g‘
('dev_query', 0)) {

95 
	`li¡
(
$u£c
, 
$£c
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

96 
$tim”
 = ()
$u£c
 + ()
$£c
;

100 
$bt
 = 
	`debug_backŒaû
();

102 
$Çme
 = 
$u£r
->
uid
 ? $u£r->
Çme
 : 
	`v¬ŸbË_g‘
('anonymous', 'Anonymous');

104 
$Çme
 = 
	`¡r_»¶aû
(
	`¬¿y
('*', '/'), '', $name);

105 
$qu”y
 = '/* '. 
$Çme
 .' : '. 
$bt
[2]['function'] .' */ '. $query;

108 
$»suÉ
 = 
	`mysqli_qu”y
(
$aùive_db
, 
$qu”y
);

110 ià(
	`v¬ŸbË_g‘
('dev_query', 0)) {

111 
$qu”y
 = 
$bt
[2]['function'] ."\n". $query;

112 
	`li¡
(
$u£c
, 
$£c
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

113 
$¡İ
 = ()
$u£c
 + ()
$£c
;

114 
$diff
 = 
$¡İ
 - 
$tim”
;

115 
$qu”›s
[] = 
	`¬¿y
(
$qu”y
, 
$diff
);

118 ià(
$debug
) {

119 
´št
 '<p>qu”y: '. 
$qu”y
 .'<b¸/>”rÜ:'. 
	`mysqli_”rÜ
(
$aùive_db
) .'</p>';

122 ià(!
	`mysqli_”ºo
(
$aùive_db
)) {

123  
$»suÉ
;

127 
$
{
DB_ERROR
} = 
TRUE
;

128 
	`Œigg”_”rÜ
(
	`check_¶aš
(
	`mysqli_”rÜ
(
$aùive_db
è."\nqu”y: ". 
$qu”y
), 
E_USER_WARNING
);

129  
FALSE
;

131 
	}
}

142 
funùiÚ
 
	$db_ãtch_objeù
(
$»suÉ
) {

143 ià(
$»suÉ
) {

144 
$objeù
 = 
	`mysqli_ãtch_objeù
(
$»suÉ
);

145  
	`is£t
(
$objeù
è? $objeù : 
FALSE
;

147 
	}
}

159 
funùiÚ
 
	$db_ãtch_¬¿y
(
$»suÉ
) {

160 ià(
$»suÉ
) {

161 
$¬¿y
 = 
	`mysqli_ãtch_¬¿y
(
$»suÉ
, 
MYSQLI_ASSOC
);

162  
	`is£t
(
$¬¿y
è? $¬¿y : 
FALSE
;

164 
	}
}

177 
funùiÚ
 
	$db_»suÉ
(
$»suÉ
) {

178 ià(
$»suÉ
 && 
	`mysqli_num_rows
($result) > 0) {

181 
$¬¿y
 = 
	`mysqli_ãtch_row
(
$»suÉ
);

182  
$¬¿y
[0];

184  
FALSE
;

185 
	}
}

190 
funùiÚ
 
	$db_”rÜ
() {

191 
glob®
 
$aùive_db
;

192  
	`mysqli_”ºo
(
$aùive_db
);

193 
	}
}

198 
funùiÚ
 
	$db_afãùed_rows
() {

199 
glob®
 
$aùive_db
;

200  
	`mysqli_afãùed_rows
(
$aùive_db
);

201 
	}
}

231 
funùiÚ
 
	$db_qu”y_¿nge
(
$qu”y
) {

232 
$¬gs
 = 
	`func_g‘_¬gs
();

233 
$couÁ
 = 
	`¬¿y_pİ
(
$¬gs
);

234 
$äom
 = 
	`¬¿y_pİ
(
$¬gs
);

235 
	`¬¿y_shiá
(
$¬gs
);

237 
$qu”y
 = 
	`db_´efix_bËs
($query);

238 ià(
	`is£t
(
$¬gs
[0]è
ªd
 
	`is_¬¿y
($args[0])) {

239 
$¬gs
 = $args[0];

241 
	`_db_qu”y_ÿÎback
(
$¬gs
, 
TRUE
);

242 
$qu”y
 = 
	`´eg_»¶aû_ÿÎback
(
DB_QUERY_REGEXP
, '_db_query_callback', $query);

243 
$qu”y
 .ğ' LIMIT '. ()
$äom
 .', '. ()
$couÁ
;

244  
	`_db_qu”y
(
$qu”y
);

245 
	}
}

279 
funùiÚ
 
	$db_qu”y_‹mpÜ¬y
(
$qu”y
) {

280 
$¬gs
 = 
	`func_g‘_¬gs
();

281 
$bËÇme
 = 
	`¬¿y_pİ
(
$¬gs
);

282 
	`¬¿y_shiá
(
$¬gs
);

284 
$qu”y
 = 
	`´eg_»¶aû
('/^SELECT/i', 'CREATE TEMPORARY TABLE '. 
$bËÇme
 .' Engše=HEAP SELECT', 
	`db_´efix_bËs
($query));

285 ià(
	`is£t
(
$¬gs
[0]è
ªd
 
	`is_¬¿y
($args[0])) {

286 
$¬gs
 = $args[0];

288 
	`_db_qu”y_ÿÎback
(
$¬gs
, 
TRUE
);

289 
$qu”y
 = 
	`´eg_»¶aû_ÿÎback
(
DB_QUERY_REGEXP
, '_db_query_callback', $query);

290  
	`_db_qu”y
(
$qu”y
);

291 
	}
}

301 
funùiÚ
 
	$db_’code_blob
(
$d©a
) {

302 
glob®
 
$aùive_db
;

303  "'". 
	`mysqli_»®_esÿ³_¡ršg
(
$aùive_db
, 
$d©a
) ."'";

304 
	}
}

314 
funùiÚ
 
	$db_decode_blob
(
$d©a
) {

315  
$d©a
;

316 
	}
}

321 
funùiÚ
 
	$db_esÿ³_¡ršg
(
$‹xt
) {

322 
glob®
 
$aùive_db
;

323  
	`mysqli_»®_esÿ³_¡ršg
(
$aùive_db
, 
$‹xt
);

324 
	}
}

329 
funùiÚ
 
	$db_lock_bË
(
$bË
) {

330 
	`db_qu”y
('LOCK TABLES {'. 
	`db_esÿ³_bË
(
$bË
) .'} WRITE');

331 
	}
}

336 
funùiÚ
 
	$db_uÆock_bËs
() {

337 
	`db_qu”y
('UNLOCK TABLES');

338 
	}
}

343 
funùiÚ
 
	$db_bË_exi¡s
(
$bË
) {

344  (
boŞ
è
	`db_ãtch_objeù
(
	`db_qu”y
("SHOW TABLES LIKE '{". 
	`db_esÿ³_bË
(
$bË
) ."}'"));

345 
	}
}

350 
funùiÚ
 
	$db_cŞumn_exi¡s
(
$bË
, 
$cŞumn
) {

351  (
boŞ
è
	`db_ãtch_objeù
(
	`db_qu”y
("SHOW COLUMNS FROM {". 
	`db_esÿ³_bË
(
$bË
è."} LIKE '". db_esÿ³_bË(
$cŞumn
) ."'"));

352 
	}
}

	@/srv/http/subs/notes/www/includes/database.pgsql.inc

1 <?
php


17 
funùiÚ
 
	$db_¡©us_»pÜt
() {

18 
$t
 = 
	`g‘_t
();

20 
$v”siÚ
 = 
	`db_v”siÚ
();

22 
$fÜm
['pgsql'] = 
	`¬¿y
(

23 't™Ë' => 
	`$t
('PostgreSQL database'),

24 'v®ue' => 
$v”siÚ
,

27 ià(
	`v”siÚ_com·»
(
$v”siÚ
, 
DRUPAL_MINIMUM_PGSQL
) < 0) {

28 
$fÜm
['pgsql']['£v”™y'] = 
REQUIREMENT_ERROR
;

29 
$fÜm
['pgsql']['desütiÚ'] = 
	`$t
('You¸Po¡g»SQL S”v” i toØŞd. Dru·È»quœe ©†—¡ Po¡g»SQL %v”siÚ.', 
	`¬¿y
('%v”siÚ' => 
DRUPAL_MINIMUM_PGSQL
));

32  
$fÜm
;

33 
	}
}

40 
funùiÚ
 
	$db_v”siÚ
() {

41  
	`db_»suÉ
(
	`db_qu”y
("SHOW SERVER_VERSION"));

42 
	}
}

47 
funùiÚ
 
	$db_cÚÃù
(
$u¾
) {

49 ià(!
	`funùiÚ_exi¡s
('pg_connect')) {

50 
	`_db_”rÜ_·ge
('Unableo usehe PostgreSQL database becausehe PostgreSQLƒxtension for PHP is‚ot installed. Check your <code>php.ini</code>o see how you canƒnable it.');

53 
$u¾
 = 
	`·r£_u¾
($url);

54 
$cÚn_¡ršg
 = '';

57 ià(
	`is£t
(
$u¾
['user'])) {

58 
$cÚn_¡ršg
 .ğ' u£r='. 
	`u¾decode
(
$u¾
['user']);

60 ià(
	`is£t
(
$u¾
['pass'])) {

61 
$cÚn_¡ršg
 .ğ'…asswÜd='. 
	`u¾decode
(
$u¾
['pass']);

63 ià(
	`is£t
(
$u¾
['host'])) {

64 
$cÚn_¡ršg
 .ğ' ho¡='. 
	`u¾decode
(
$u¾
['host']);

66 ià(
	`is£t
(
$u¾
['path'])) {

67 
$cÚn_¡ršg
 .ğ' dbÇme='. 
	`sub¡r
(
	`u¾decode
(
$u¾
['path']), 1);

69 ià(
	`is£t
(
$u¾
['port'])) {

70 
$cÚn_¡ršg
 .ğ'…Üt='. 
	`u¾decode
(
$u¾
['port']);

76 
$Œack_”rÜs_´evious
 = 
	`ši_g‘
('track_errors');

77 
	`ši_£t
('track_errors', 1);

79 
$cÚÃùiÚ
 = @
	`pg_cÚÃù
(
$cÚn_¡ršg
);

80 ià(!
$cÚÃùiÚ
) {

81 
»quœe_Úû
 './includes/unicode.inc';

82 
	`_db_”rÜ_·ge
(
	`decode_’t™›s
(
$php_”rÜmsg
));

86 
	`ši_£t
('Œack_”rÜs', 
$Œack_”rÜs_´evious
);

88 
	`pg_qu”y
(
$cÚÃùiÚ
, "set client_encoding=\"UTF8\"");

89  
$cÚÃùiÚ
;

90 
	}
}

116 
funùiÚ
 
	$db_qu”y
(
$qu”y
) {

117 
$¬gs
 = 
	`func_g‘_¬gs
();

118 
	`¬¿y_shiá
(
$¬gs
);

119 
$qu”y
 = 
	`db_´efix_bËs
($query);

120 ià(
	`is£t
(
$¬gs
[0]è
ªd
 
	`is_¬¿y
($args[0])) {

121 
$¬gs
 = $args[0];

123 
	`_db_qu”y_ÿÎback
(
$¬gs
, 
TRUE
);

124 
$qu”y
 = 
	`´eg_»¶aû_ÿÎback
(
DB_QUERY_REGEXP
, '_db_query_callback', $query);

125  
	`_db_qu”y
(
$qu”y
);

126 
	}
}

131 
funùiÚ
 
	$_db_qu”y
(
$qu”y
, 
$debug
 = 0) {

132 
glob®
 
$aùive_db
, 
$Ï¡_»suÉ
, 
$qu”›s
;

134 ià(
	`v¬ŸbË_g‘
('dev_query', 0)) {

135 
	`li¡
(
$u£c
, 
$£c
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

136 
$tim”
 = ()
$u£c
 + ()
$£c
;

139 
$Ï¡_»suÉ
 = 
	`pg_qu”y
(
$aùive_db
, 
$qu”y
);

141 ià(
	`v¬ŸbË_g‘
('dev_query', 0)) {

142 
$bt
 = 
	`debug_backŒaû
();

143 
$qu”y
 = 
$bt
[2]['function'] ."\n". $query;

144 
	`li¡
(
$u£c
, 
$£c
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

145 
$¡İ
 = ()
$u£c
 + ()
$£c
;

146 
$diff
 = 
$¡İ
 - 
$tim”
;

147 
$qu”›s
[] = 
	`¬¿y
(
$qu”y
, 
$diff
);

150 ià(
$debug
) {

151 
´št
 '<p>qu”y: '. 
$qu”y
 .'<b¸/>”rÜ:'. 
	`pg_Ï¡_”rÜ
(
$aùive_db
) .'</p>';

154 ià(
$Ï¡_»suÉ
 !=ğ
FALSE
) {

155  
$Ï¡_»suÉ
;

159 
$
{
DB_ERROR
} = 
TRUE
;

160 
	`Œigg”_”rÜ
(
	`check_¶aš
(
	`pg_Ï¡_”rÜ
(
$aùive_db
è."\nqu”y: ". 
$qu”y
), 
E_USER_WARNING
);

161  
FALSE
;

163 
	}
}

174 
funùiÚ
 
	$db_ãtch_objeù
(
$»suÉ
) {

175 ià(
$»suÉ
) {

176  
	`pg_ãtch_objeù
(
$»suÉ
);

178 
	}
}

190 
funùiÚ
 
	$db_ãtch_¬¿y
(
$»suÉ
) {

191 ià(
$»suÉ
) {

192  
	`pg_ãtch_assoc
(
$»suÉ
);

194 
	}
}

207 
funùiÚ
 
	$db_»suÉ
(
$»suÉ
) {

208 ià(
$»suÉ
 && 
	`pg_num_rows
($result) > 0) {

209 
$¬¿y
 = 
	`pg_ãtch_row
(
$»suÉ
);

210  
$¬¿y
[0];

212  
FALSE
;

213 
	}
}

218 
funùiÚ
 
	$db_”rÜ
() {

219 
glob®
 
$aùive_db
;

220  
	`pg_Ï¡_”rÜ
(
$aùive_db
);

221 
	}
}

231 
funùiÚ
 
	$db_Ï¡_š£¹_id
(
$bË
, 
$f›ld
) {

232  
	`db_»suÉ
(
	`db_qu”y
("SELECT CURRVAL('{". 
	`db_esÿ³_bË
(
$bË
è."}_". db_esÿ³_bË(
$f›ld
) ."_seq')"));

233 
	}
}

238 
funùiÚ
 
	$db_afãùed_rows
() {

239 
glob®
 
$Ï¡_»suÉ
;

240  
	`em±y
(
$Ï¡_»suÉ
è? 0 : 
	`pg_afãùed_rows
($last_result);

241 
	}
}

272 
funùiÚ
 
	$db_qu”y_¿nge
(
$qu”y
) {

273 
$¬gs
 = 
	`func_g‘_¬gs
();

274 
$couÁ
 = 
	`¬¿y_pİ
(
$¬gs
);

275 
$äom
 = 
	`¬¿y_pİ
(
$¬gs
);

276 
	`¬¿y_shiá
(
$¬gs
);

278 
$qu”y
 = 
	`db_´efix_bËs
($query);

279 ià(
	`is£t
(
$¬gs
[0]è
ªd
 
	`is_¬¿y
($args[0])) {

280 
$¬gs
 = $args[0];

282 
	`_db_qu”y_ÿÎback
(
$¬gs
, 
TRUE
);

283 
$qu”y
 = 
	`´eg_»¶aû_ÿÎback
(
DB_QUERY_REGEXP
, '_db_query_callback', $query);

284 
$qu”y
 .ğ' LIMIT '. ()
$couÁ
 .' OFFSET '. ()
$äom
;

285  
	`_db_qu”y
(
$qu”y
);

286 
	}
}

320 
funùiÚ
 
	$db_qu”y_‹mpÜ¬y
(
$qu”y
) {

321 
$¬gs
 = 
	`func_g‘_¬gs
();

322 
$bËÇme
 = 
	`¬¿y_pİ
(
$¬gs
);

323 
	`¬¿y_shiá
(
$¬gs
);

325 
$qu”y
 = 
	`´eg_»¶aû
('/^SELECT/i', 'CREATE TEMPORARY TABLE '. 
$bËÇme
 .' AS SELECT', 
	`db_´efix_bËs
($query));

326 ià(
	`is£t
(
$¬gs
[0]è
ªd
 
	`is_¬¿y
($args[0])) {

327 
$¬gs
 = $args[0];

329 
	`_db_qu”y_ÿÎback
(
$¬gs
, 
TRUE
);

330 
$qu”y
 = 
	`´eg_»¶aû_ÿÎback
(
DB_QUERY_REGEXP
, '_db_query_callback', $query);

331  
	`_db_qu”y
(
$qu”y
);

332 
	}
}

343 
funùiÚ
 
	$db_’code_blob
(
$d©a
) {

344  "'". 
	`pg_esÿ³_by‹a
(
$d©a
) ."'";

345 
	}
}

356 
funùiÚ
 
	$db_decode_blob
(
$d©a
) {

357  
	`pg_uÃsÿ³_by‹a
(
$d©a
);

358 
	}
}

364 
funùiÚ
 
	$db_esÿ³_¡ršg
(
$‹xt
) {

365  
	`pg_esÿ³_¡ršg
(
$‹xt
);

366 
	}
}

372 
funùiÚ
 
	$db_lock_bË
(
$bË
) {

373 
	`db_qu”y
('BEGIN; LOCK TABLE {'. 
	`db_esÿ³_bË
(
$bË
) .'} IN EXCLUSIVE MODE');

374 
	}
}

380 
funùiÚ
 
	$db_uÆock_bËs
() {

381 
	`db_qu”y
('COMMIT');

382 
	}
}

387 
funùiÚ
 
	$db_bË_exi¡s
(
$bË
) {

388  (
boŞ
è
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM…g_şas WHERE„–Çmğ'{". 
	`db_esÿ³_bË
(
$bË
) ."}'"));

389 
	}
}

394 
funùiÚ
 
	$db_cŞumn_exi¡s
(
$bË
, 
$cŞumn
) {

395  (
boŞ
è
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNTÕg_©Œibu‹.©ŠameèFROM…g_şass,…g_©Œibu‹ WHERE…g_©Œibu‹.©Œ–id =…g_şass.oid AND…g_şass.»Êamğ'{". 
	`db_esÿ³_bË
(
$bË
è."}' AND‡‰Çmğ'". db_esÿ³_bË(
$cŞumn
) ."'"));

396 
	}
}

401 
funùiÚ
 
	$db_check_£tup
() {

402 
$t
 = 
	`g‘_t
();

404 
$’codšg
 = 
	`db_»suÉ
(
	`db_qu”y
('SHOW server_encoding'));

405 ià(!
	`š_¬¿y
(
	`¡¹Şow”
(
$’codšg
), 
	`¬¿y
('unicode', 'utf8'))) {

406 
	`dru·l_£t_mes§ge
(
	`$t
('You¸Po¡g»SQL d©aba£ i £ˆu°w™hhwrÚg ch¬aù”ƒncodšg (%’codšg). Iˆi possibË iˆwÈnÙ wÜk‡ ex³ùed. Iˆi advi£dØ»ü—‹ iˆw™h UTF-8/Unicod’codšg. MÜšfÜm©iÚ cª bfound iÀth<¨h»f="@u¾">Po¡g»SQL docum’tiÚ</a>.', 
	`¬¿y
('%’codšg' => 
$’codšg
, '@url' => 'http://www.postgresql.org/docs/7.4/interactive/multibyte.html')), 'status');

408 
	}
}

423 
funùiÚ
 
	$db_ty³_m­
() {

427 
$m­
 = 
	`¬¿y
(

462  
$m­
;

463 
	}
}

475 
funùiÚ
 
	$db_ü—‹_bË_sql
(
$Çme
, 
$bË
) {

476 
$sql_f›lds
 = 
	`¬¿y
();

477 
	`fÜ—ch
 (
$bË
['f›lds'] 
as
 
$f›ld_Çme
 => 
$f›ld
) {

478 
$sql_f›lds
[] = 
	`_db_ü—‹_f›ld_sql
(
$f›ld_Çme
, 
	`_db_´oûss_f›ld
(
$f›ld
));

481 
$sql_keys
 = 
	`¬¿y
();

482 ià(
	`is£t
(
$bË
['´im¬y key']è&& 
	`is_¬¿y
($table['primary key'])) {

483 
$sql_keys
[] = 'PRIMARY KEY ('. 
	`im¶ode
(', ', 
$bË
['primary key']) .')';

485 ià(
	`is£t
(
$bË
['uniqukeys']è&& 
	`is_¬¿y
($table['unique keys'])) {

486 
	`fÜ—ch
 (
$bË
['uniqukeys'] 
as
 
$key_Çme
 => 
$key
) {

487 
$sql_keys
[] = 'CONSTRAINT {'. 
$Çme
 .'}_'. 
$key_Çme
 .'_key UNIQUE ('. 
	`im¶ode
(', ', 
$key
) .')';

491 
$sql
 = "CREATE TABLE {". 
$Çme
 ."} (\n\t";

492 
$sql
 .ğ
	`im¶ode
(",\n\t", 
$sql_f›lds
);

493 ià(
	`couÁ
(
$sql_keys
) > 0) {

494 
$sql
 .= ",\n\t";

496 
$sql
 .ğ
	`im¶ode
(",\n\t", 
$sql_keys
);

497 
$sql
 .= "\n)";

498 
$¡©em’ts
[] = 
$sql
;

500 ià(
	`is£t
(
$bË
['šdexes']è&& 
	`is_¬¿y
($table['indexes'])) {

501 
	`fÜ—ch
 (
$bË
['šdexes'] 
as
 
$key_Çme
 => 
$key
) {

502 
$¡©em’ts
[] = 
	`_db_ü—‹_šdex_sql
(
$Çme
, 
$key_Çme
, 
$key
);

506  
$¡©em’ts
;

507 
	}
}

509 
funùiÚ
 
	$_db_ü—‹_šdex_sql
(
$bË
, 
$Çme
, 
$f›lds
) {

510 
$qu”y
 = 'CREATE INDEX {'. 
$bË
 .'}_'. 
$Çme
 .'_idx ON {'. $table .'} (';

511 
$qu”y
 .ğ
	`_db_ü—‹_key_sql
(
$f›lds
) .')';

512  
$qu”y
;

513 
	}
}

515 
funùiÚ
 
	$_db_ü—‹_key_sql
(
$f›lds
) {

516 
$»t
 = 
	`¬¿y
();

517 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
) {

518 ià(
	`is_¬¿y
(
$f›ld
)) {

519 
$»t
[] = 'sub¡r('. 
$f›ld
[0] .', 1, '. $field[1] .')';

522 
$»t
[] = 
$f›ld
;

525  
	`im¶ode
(', ', 
$»t
);

526 
	}
}

528 
funùiÚ
 
	$_db_ü—‹_keys
(&
$»t
, 
$bË
, 
$Ãw_keys
) {

529 ià(
	`is£t
(
$Ãw_keys
['primary key'])) {

530 
	`db_add_´im¬y_key
(
$»t
, 
$bË
, 
$Ãw_keys
['primary key']);

532 ià(
	`is£t
(
$Ãw_keys
['unique keys'])) {

533 
	`fÜ—ch
 (
$Ãw_keys
['uniqukeys'] 
as
 
$Çme
 => 
$f›lds
) {

534 
	`db_add_unique_key
(
$»t
, 
$bË
, 
$Çme
, 
$f›lds
);

537 ià(
	`is£t
(
$Ãw_keys
['indexes'])) {

538 
	`fÜ—ch
 (
$Ãw_keys
['šdexes'] 
as
 
$Çme
 => 
$f›lds
) {

539 
	`db_add_šdex
(
$»t
, 
$bË
, 
$Çme
, 
$f›lds
);

542 
	}
}

550 
funùiÚ
 
	$_db_´oûss_f›ld
(
$f›ld
) {

551 ià(!
	`is£t
(
$f›ld
['size'])) {

552 
$f›ld
['size'] = 'normal';

555 ià(!
	`is£t
(
$f›ld
['pgsql_type'])) {

556 
$m­
 = 
	`db_ty³_m­
();

557 
$f›ld
['pgsql_ty³'] = 
$m­
[$field['type'] .':'. $field['size']];

559 ià(
$f›ld
['type'] == 'serial') {

560 
	`un£t
(
$f›ld
['not‚ull']);

562  
$f›ld
;

563 
	}
}

576 
funùiÚ
 
	$_db_ü—‹_f›ld_sql
(
$Çme
, 
$¥ec
) {

577 
$sql
 = 
$Çme
 .' '. 
$¥ec
['pgsql_type'];

579 ià(
$¥ec
['type'] == 'serial') {

580 
	`un£t
(
$¥ec
['not‚ull']);

583 ià(
	`š_¬¿y
(
$¥ec
['ty³'], 
	`¬¿y
('v¬ch¬', 'ch¬', '‹xt')è&& 
	`is£t
($spec['length'])) {

584 
$sql
 .ğ'('. 
$¥ec
['length'] .')';

586 
	`–£if
 (
	`is£t
(
$¥ec
['precision']) && isset($spec['scale'])) {

587 
$sql
 .ğ'('. 
$¥ec
['precision'] .', '. $spec['scale'] .')';

590 ià(!
	`em±y
(
$¥ec
['unsigned'])) {

591 
$sql
 .= " CHECK ($name >= 0)";

594 ià(
	`is£t
(
$¥ec
['not‚ull']) && $spec['not‚ull']) {

595 
$sql
 .= ' NOT NULL';

597 ià(
	`is£t
(
$¥ec
['default'])) {

598 
$deçuÉ
 = 
	`is_¡ršg
(
$¥ec
['default']) ? "'". $spec['default'] ."'" : $spec['default'];

599 
$sql
 .= " default $default";

602  
$sql
;

603 
	}
}

615 
funùiÚ
 
	$db_»Çme_bË
(&
$»t
, 
$bË
, 
$Ãw_Çme
) {

616 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} RENAME TO {'. 
$Ãw_Çme
 .'}');

617 
	}
}

627 
funùiÚ
 
	$db_drİ_bË
(&
$»t
, 
$bË
) {

628 
$»t
[] = 
	`upd©e_sql
('DROP TABLE {'. 
$bË
 .'}');

629 
	}
}

654 
funùiÚ
 
db_add_f›ld
(&
$»t
, 
$bË
, 
$f›ld
, 
$¥ec
, 
$Ãw_keys
 = 
	$¬¿y
()) {

655 
$fixnuÎ
 = 
FALSE
;

656 ià(!
	`em±y
(
$¥ec
['nÙ‚uÎ']è&& !
	`is£t
($spec['default'])) {

657 
$fixnuÎ
 = 
TRUE
;

658 
$¥ec
['nÙ‚uÎ'] = 
FALSE
;

660 
$qu”y
 = 'ALTER TABLE {'. 
$bË
 .'} ADD COLUMN ';

661 
$qu”y
 .ğ
	`_db_ü—‹_f›ld_sql
(
$f›ld
, 
	`_db_´oûss_f›ld
(
$¥ec
));

662 
$»t
[] = 
	`upd©e_sql
(
$qu”y
);

663 ià(
	`is£t
(
$¥ec
['initial'])) {

665 
$sql
 = 'UPDATE {'. 
$bË
 .'} SET '. 
$f›ld
 .' = '. 
	`db_ty³_¶aûhŞd”
(
$¥ec
['type']);

666 
$»suÉ
 = 
	`db_qu”y
(
$sql
, 
$¥ec
['initial']);

667 
$»t
[] = 
	`¬¿y
('sucûss' => 
$»suÉ
 !=ğ
FALSE
, 'qu”y' => 
	`check_¶aš
(
$sql
 .' ('. 
$¥ec
['initial'] .')'));

669 ià(
$fixnuÎ
) {

670 
$»t
[] = 
	`upd©e_sql
("ALTER TABLE {". 
$bË
 ."} ALTER $field SET NOT NULL");

672 ià(
	`is£t
(
$Ãw_keys
)) {

673 
	`_db_ü—‹_keys
(
$»t
, 
$bË
, 
$Ãw_keys
);

675 
	}
}

687 
funùiÚ
 
	$db_drİ_f›ld
(&
$»t
, 
$bË
, 
$f›ld
) {

688 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} DROP COLUMN '. 
$f›ld
);

689 
	}
}

703 
funùiÚ
 
	$db_f›ld_£t_deçuÉ
(&
$»t
, 
$bË
, 
$f›ld
, 
$deçuÉ
) {

704 ià(
$deçuÉ
 =ğ
NULL
) {

705 
$deçuÉ
 = 'NULL';

708 
$deçuÉ
 = 
	`is_¡ršg
($default) ? "'$default'" : $default;

711 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} ALTER COLUMN '. 
$f›ld
 .' SET DEFAULT '. 
$deçuÉ
);

712 
	}
}

724 
funùiÚ
 
	$db_f›ld_£t_no_deçuÉ
(&
$»t
, 
$bË
, 
$f›ld
) {

725 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} ALTER COLUMN '. 
$f›ld
 .' DROP DEFAULT');

726 
	}
}

738 
funùiÚ
 
	$db_add_´im¬y_key
(&
$»t
, 
$bË
, 
$f›lds
) {

739 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} ADD PRIMARY KEY ('.

740 
	`im¶ode
(',', 
$f›lds
) .')');

741 
	}
}

751 
funùiÚ
 
	$db_drİ_´im¬y_key
(&
$»t
, 
$bË
) {

752 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} DROP CONSTRAINT {'. $table .'}_pkey');

753 
	}
}

767 
funùiÚ
 
	$db_add_unique_key
(&
$»t
, 
$bË
, 
$Çme
, 
$f›lds
) {

768 
$Çme
 = '{'. 
$bË
 .'}_'. $name .'_key';

769 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} ADD CONSTRAINT '.

770 
$Çme
 .' UNIQUE ('. 
	`im¶ode
(',', 
$f›lds
) .')');

771 
	}
}

783 
funùiÚ
 
	$db_drİ_unique_key
(&
$»t
, 
$bË
, 
$Çme
) {

784 
$Çme
 = '{'. 
$bË
 .'}_'. $name .'_key';

785 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} DROP CONSTRAINT '. 
$Çme
);

786 
	}
}

800 
funùiÚ
 
	$db_add_šdex
(&
$»t
, 
$bË
, 
$Çme
, 
$f›lds
) {

801 
$»t
[] = 
	`upd©e_sql
(
	`_db_ü—‹_šdex_sql
(
$bË
, 
$Çme
, 
$f›lds
));

802 
	}
}

814 
funùiÚ
 
	$db_drİ_šdex
(&
$»t
, 
$bË
, 
$Çme
) {

815 
$Çme
 = '{'. 
$bË
 .'}_'. $name .'_idx';

816 
$»t
[] = 
	`upd©e_sql
('DROP INDEX '. 
$Çme
);

817 
	}
}

881 
funùiÚ
 
db_chªge_f›ld
(&
$»t
, 
$bË
, 
$f›ld
, 
$f›ld_Ãw
, 
$¥ec
, 
$Ãw_keys
 = 
	$¬¿y
()) {

882 
$»t
[] = 
	`upd©e_sql
('ALTER TABLE {'. 
$bË
 .'} RENAME "'. 
$f›ld
 .'" TO "'. $field .'_old"');

883 
$nÙ_nuÎ
 = 
	`is£t
(
$¥ec
['nÙ‚uÎ']è? $¥ec['nÙ‚uÎ'] : 
FALSE
;

884 
	`un£t
(
$¥ec
['not‚ull']);

886 ià(!
	`¬¿y_key_exi¡s
('size', 
$¥ec
)) {

887 
$¥ec
['size'] = 'normal';

889 
	`db_add_f›ld
(
$»t
, 
$bË
, "$f›ld_Ãw", 
$¥ec
);

894 
$m­
 = 
	`db_ty³_m­
();

895 
$ty³ÿ¡
 = 
$m­
[
$¥ec
['type'] .':'. $spec['size']];

896 ià(
	`š_¬¿y
(
$ty³ÿ¡
, 
	`¬¿y
('serial', 'bigserial', 'numeric'))) {

897 
$ty³ÿ¡
 = 'int';

899 
$»t
[] = 
	`upd©e_sql
('UPDATE {'. 
$bË
 .'} SET '. 
$f›ld_Ãw
 .' = CAST('. 
$f›ld
 .'_Şd AS '. 
$ty³ÿ¡
 .')');

901 ià(
$nÙ_nuÎ
) {

902 
$»t
[] = 
	`upd©e_sql
("ALTER TABLE {". 
$bË
 ."} ALTER $field_new SET NOT NULL");

905 
	`db_drİ_f›ld
(
$»t
, 
$bË
, 
$f›ld
 .'_old');

907 ià(
	`is£t
(
$Ãw_keys
)) {

908 
	`_db_ü—‹_keys
(
$»t
, 
$bË
, 
$Ãw_keys
);

910 
	}
}

	@/srv/http/subs/notes/www/includes/file.inc

1 <?
php


15 
defše
('FILE_DOWNLOADS_PUBLIC', 1);

16 
defše
('FILE_DOWNLOADS_PRIVATE', 2);

17 
defše
('FILE_CREATE_DIRECTORY', 1);

18 
defše
('FILE_MODIFY_PERMISSIONS', 2);

19 
defše
('FILE_EXISTS_RENAME', 0);

20 
defše
('FILE_EXISTS_REPLACE', 1);

21 
defše
('FILE_EXISTS_ERROR', 2);

32 
defše
('FILE_STATUS_TEMPORARY', 0);

33 
defše
('FILE_STATUS_PERMANENT', 1);

41 
funùiÚ
 
	$fe_ü—‹_u¾
(
$·th
) {

43 ià(
	`¡½os
(
$·th
, 
	`fe_dœeùÜy_·th
() .'/') === 0) {

44 
$·th
 = 
	`Œim
(
	`sub¡r
($·th, 
	`¡¾’
(
	`fe_dœeùÜy_·th
())), '\\/');

46 
	`v¬ŸbË_g‘
('fe_dowÆßds', 
FILE_DOWNLOADS_PUBLIC
)) {

47 
FILE_DOWNLOADS_PUBLIC
:

48  
$GLOBALS
['ba£_u¾'] .'/'. 
	`fe_dœeùÜy_·th
(è.'/'. 
	`¡r_»¶aû
('\\', '/', 
$·th
);

49 
FILE_DOWNLOADS_PRIVATE
:

50  
	`u¾
('sy¡em/fes/'. 
$·th
, 
	`¬¿y
('absŞu‹' => 
TRUE
));

52 
	}
}

64 
funùiÚ
 
	$fe_ü—‹_·th
(
$de¡
 = 0) {

65 
$fe_·th
 = 
	`fe_dœeùÜy_·th
();

66 ià(!
$de¡
) {

67  
$fe_·th
;

70 ià(
	`fe_check_loÿtiÚ
(
$de¡
, 
$fe_·th
)) {

71  
$de¡
;

74 ià(
	`fe_check_loÿtiÚ
(
$de¡
, 
	`fe_dœeùÜy_‹mp
())) {

75  
$de¡
;

78 ià(
	`fe_check_loÿtiÚ
(
$fe_·th
 .'/'. 
$de¡
, $file_path)) {

79  
$fe_·th
 .'/'. 
$de¡
;

82  
FALSE
;

83 
	}
}

98 
funùiÚ
 
	$fe_check_dœeùÜy
(&
$dœeùÜy
, 
$mode
 = 0, 
$fÜm_™em
 = 
NULL
) {

99 
$dœeùÜy
 = 
	`¹rim
($directory, '/\\');

102 ià(!
	`is_dœ
(
$dœeùÜy
)) {

103 ià((
$mode
 & 
FILE_CREATE_DIRECTORY
è&& @
	`mkdœ
(
$dœeùÜy
)) {

104 
	`dru·l_£t_mes§ge
(
	`t
('ThdœeùÜy %dœeùÜy ha b“Àü—‹d.', 
	`¬¿y
('%dœeùÜy' => 
$dœeùÜy
)));

105 @
	`chmod
(
$dœeùÜy
, 0775);

108 ià(
$fÜm_™em
) {

109 
	`fÜm_£t_”rÜ
(
$fÜm_™em
, 
	`t
('ThdœeùÜy %dœeùÜy dÛ nÙƒxi¡.', 
	`¬¿y
('%dœeùÜy' => 
$dœeùÜy
)));

111  
FALSE
;

116 ià(!
	`is_wr™abË
(
$dœeùÜy
)) {

117 ià((
$mode
 & 
FILE_MODIFY_PERMISSIONS
è&& @
	`chmod
(
$dœeùÜy
, 0775)) {

118 
	`dru·l_£t_mes§ge
(
	`t
('Th³rmissiÚ oàdœeùÜy %dœeùÜy havb“ÀchªgedØmak™ wr™abË.', 
	`¬¿y
('%dœeùÜy' => 
$dœeùÜy
)));

121 
	`fÜm_£t_”rÜ
(
$fÜm_™em
, 
	`t
('ThdœeùÜy %dœeùÜy i nÙ wr™abË', 
	`¬¿y
('%dœeùÜy' => 
$dœeùÜy
)));

122 
	`w©chdog
('fsy¡em', 'ThdœeùÜy %dœeùÜy i nÙ wr™abË, beÿu£ iˆdÛ nÙ havthcÜ»ù…”missiÚ £t.', 
	`¬¿y
('%dœeùÜy' => 
$dœeùÜy
), 
WATCHDOG_ERROR
);

123  
FALSE
;

127 ià((
	`fe_dœeùÜy_·th
(è=ğ
$dœeùÜy
 || 
	`fe_dœeùÜy_‹mp
(è=ğ$dœeùÜyè&& !
	`is_fe
("$directory/.htaccess")) {

128 
$hcûss_lšes
 = "SetHandler Drupal_Security_Do_Not_Remove_See_SA_2006_006\nOptions None\nOptions +FollowSymLinks";

129 ià((
$å
 = 
	`fİ’
("$dœeùÜy/.hcûss", 'w')è&& 
	`åuts
($å, 
$hcûss_lšes
)) {

130 
	`fşo£
(
$å
);

131 
	`chmod
(
$dœeùÜy
 .'/.htaccess', 0664);

134 
$v¬ŸbËs
 = 
	`¬¿y
('%dœeùÜy' => 
$dœeùÜy
, '!hcûss' => '<b¸/>'. 
	`Æ2br
(
	`check_¶aš
(
$hcûss_lšes
)));

135 
	`fÜm_£t_”rÜ
(
$fÜm_™em
, 
	`t
("Secur™y w¬nšg: Couldn'ˆwr™.hcûs fe. PËa£ c»©¨.hcûs fš you¸%dœeùÜy dœeùÜy which cÚš thfŞlowšg†šes: <code>!hcûss</code>", 
$v¬ŸbËs
));

136 
	`w©chdog
('£cur™y', "Secur™y w¬nšg: Couldn'ˆwr™.hcûs fe. PËa£ c»©¨.hcûs fš you¸%dœeùÜy dœeùÜy which cÚš thfŞlowšg†šes: <code>!hcûss</code>", 
$v¬ŸbËs
, 
WATCHDOG_ERROR
);

140  
TRUE
;

141 
	}
}

151 
funùiÚ
 
	$fe_check_·th
(&
$·th
) {

153 ià(
	`fe_check_dœeùÜy
(
$·th
)) {

158 
$f’ame
 = 
	`ba£Çme
(
$·th
);

159 
$·th
 = 
	`dœÇme
($path);

160 ià(
	`fe_check_dœeùÜy
(
$·th
)) {

161  
$f’ame
;

164  
FALSE
;

165 
	}
}

181 
funùiÚ
 
fe_check_loÿtiÚ
(
$sourû
, 
$dœeùÜy
 = '') {

182 
$check
 = 
»®·th
(
$sourû
);

183 ià(
	g$check
) {

184 
	g$sourû
 = 
$check
;

188 
	g$sourû
 = 
»®·th
(
dœÇme
(
$sourû
)è.'/'. 
ba£Çme
($source);

190 
	g$dœeùÜy
 = 
»®·th
(
$dœeùÜy
);

191 ià(
	g$dœeùÜy
 && 
¡½os
(
$sourû
, 
$dœeùÜy
) !== 0) {

194  
	g$sourû
;

224 
funùiÚ
 
	$fe_cİy
(&
$sourû
, 
$de¡
 = 0, 
$»¶aû
 = 
FILE_EXISTS_RENAME
) {

225 
$de¡
 = 
	`fe_ü—‹_·th
($dest);

227 
$dœeùÜy
 = 
$de¡
;

228 
$ba£Çme
 = 
	`fe_check_·th
(
$dœeùÜy
);

231 ià(
$ba£Çme
 ==ğ
FALSE
) {

232 
$sourû
 = 
	`is_objeù
($sourûè? $sourû->
f•©h
 : $source;

233 
	`dru·l_£t_mes§ge
(
	`t
('Th£Ëùed f%fcould‚Ù bu¶ßded, beÿu£hde¡š©iÚ %dœeùÜy i nÙ…rİ”ly cÚfigu»d.', 
	`¬¿y
('%fe' => 
$sourû
, '%dœeùÜy' => 
$de¡
)), 'error');

234 
	`w©chdog
('fsy¡em', 'Th£Ëùed f%fcould‚Ù bu¶ßded, beÿu£hde¡š©iÚ %dœeùÜy could‚Ù bfound, o¸beÿu£ it ³rmissiÚ dØnÙ‡ÎowhftØbwr™‹n.', 
	`¬¿y
('%fe' => 
$sourû
, '%dœeùÜy' => 
$de¡
), 
WATCHDOG_ERROR
);

239 ià(
	`is_objeù
(
$sourû
)) {

240 
$fe
 = 
$sourû
;

241 
$sourû
 = 
$fe
->
f•©h
;

242 ià(!
$ba£Çme
) {

243 
$ba£Çme
 = 
$fe
->
f’ame
;

247 
$sourû
 = 
	`»®·th
($source);

248 ià(!
	`fe_exi¡s
(
$sourû
)) {

249 
	`dru·l_£t_mes§ge
(
	`t
('Th£Ëùed f%fcould‚Ù bcİ›d, beÿu£‚Øfbyh©‚amexi¡s. PËa£ checkh© you suµl›dhcÜ»ù f’ame.', 
	`¬¿y
('%fe' => 
$sourû
)), 'error');

254 
$ba£Çme
 = $ba£Çm? $ba£Çm: 
	`ba£Çme
(
$sourû
);

255 
$de¡
 = 
$dœeùÜy
 .'/'. 
$ba£Çme
;

260 ià(
$sourû
 !ğ
	`»®·th
(
$de¡
)) {

261 ià(!
$de¡
 = 
	`fe_de¡š©iÚ
($de¡, 
$»¶aû
)) {

262 
	`dru·l_£t_mes§ge
(
	`t
('Th£Ëùed f%fcould‚Ù bcİ›d, beÿu£‡ fbyh©‚am®»adyƒxi¡ šhde¡š©iÚ.', 
	`¬¿y
('%fe' => 
$sourû
)), 'error');

263  
FALSE
;

266 ià(!@
	`cİy
(
$sourû
, 
$de¡
)) {

267 
	`dru·l_£t_mes§ge
(
	`t
('Th£Ëùed f%fcould‚Ù bcİ›d.', 
	`¬¿y
('%fe' => 
$sourû
)), 'error');

275 @
	`chmod
(
$de¡
, 0664);

278 ià(
	`is£t
(
$fe
è&& 
	`is_objeù
($file)) {

279 
$fe
->
f’ame
 = 
$ba£Çme
;

280 
$fe
->
f•©h
 = 
$de¡
;

281 
$sourû
 = 
$fe
;

284 
$sourû
 = 
$de¡
;

288 
	}
}

303 
funùiÚ
 
	$fe_de¡š©iÚ
(
$de¡š©iÚ
, 
$»¶aû
) {

304 ià(
	`fe_exi¡s
(
$de¡š©iÚ
)) {

305 
$»¶aû
) {

306 
FILE_EXISTS_RENAME
:

307 
$ba£Çme
 = 
	`ba£Çme
(
$de¡š©iÚ
);

308 
$dœeùÜy
 = 
	`dœÇme
(
$de¡š©iÚ
);

309 
$de¡š©iÚ
 = 
	`fe_ü—‹_f’ame
(
$ba£Çme
, 
$dœeùÜy
);

312 
FILE_EXISTS_ERROR
:

313 
	`dru·l_£t_mes§ge
(
	`t
('Th£Ëùed f%fcould‚Ù bcİ›d, beÿu£‡ fbyh©‚am®»adyƒxi¡ šhde¡š©iÚ.', 
	`¬¿y
('%fe' => 
$de¡š©iÚ
)), 'error');

314  
FALSE
;

317  
$de¡š©iÚ
;

318 
	}
}

345 
funùiÚ
 
	$fe_move
(&
$sourû
, 
$de¡
 = 0, 
$»¶aû
 = 
FILE_EXISTS_RENAME
) {

346 
$·th_Üigš®
 = 
	`is_objeù
(
$sourû
è? $sourû->
f•©h
 : $source;

348 ià(
	`fe_cİy
(
$sourû
, 
$de¡
, 
$»¶aû
)) {

349 
$·th_cu¼’t
 = 
	`is_objeù
(
$sourû
è? $sourû->
f•©h
 : $source;

351 ià(
$·th_Üigš®
 =ğ
$·th_cu¼’t
 || 
	`fe_d–‘e
($path_original)) {

354 
	`dru·l_£t_mes§ge
(
	`t
('Th»mov® oàthÜigš® f%fha çed.', 
	`¬¿y
('%fe' => 
$·th_Üigš®
)), 'error');

357 
	}
}

391 
funùiÚ
 
	$fe_munge_f’ame
(
$f’ame
, 
$ex‹nsiÚs
, 
$®”ts
 = 
TRUE
) {

392 
$Üigš®
 = 
$f’ame
;

395 ià(!
	`v¬ŸbË_g‘
('allow_insecure_uploads', 0)) {

396 
$wh™–i¡
 = 
	`¬¿y_unique
(
	`ex¶ode
(' ', 
	`Œim
(
$ex‹nsiÚs
)));

400 
$f’ame_·¹s
 = 
	`ex¶ode
('.', 
$f’ame
);

401 
$Ãw_f’ame
 = 
	`¬¿y_shiá
(
$f’ame_·¹s
);

402 
$fš®_ex‹nsiÚ
 = 
	`¬¿y_pİ
(
$f’ame_·¹s
);

407 
	`fÜ—ch
 (
$f’ame_·¹s
 
as
 
$f’ame_·¹
) {

408 
$Ãw_f’ame
 .ğ'.'. 
$f’ame_·¹
;

409 ià(!
	`š_¬¿y
(
$f’ame_·¹
, 
$wh™–i¡
è&& 
	`´eg_m©ch
("/^[a-zA-Z]{2,5}\d?$/", $filename_part)) {

410 
$Ãw_f’ame
 .= '_';

413 
$f’ame
 = 
$Ãw_f’ame
 .'.'. 
$fš®_ex‹nsiÚ
;

415 ià(
$®”ts
 && 
$Üigš®
 !ğ
$f’ame
) {

416 
	`dru·l_£t_mes§ge
(
	`t
('FÜ secur™y„—sÚs, you¸u¶ßd ha b“À»ÇmedØ%f’ame.', 
	`¬¿y
('%f’ame' => 
$f’ame
)));

420  
$f’ame
;

421 
	}
}

429 
funùiÚ
 
	$fe_unmunge_f’ame
(
$f’ame
) {

430  
	`¡r_»¶aû
('_.', '.', 
$f’ame
);

431 
	}
}

441 
funùiÚ
 
	$fe_ü—‹_f’ame
(
$ba£Çme
, 
$dœeùÜy
) {

442 
$de¡
 = 
$dœeùÜy
 .'/'. 
$ba£Çme
;

444 ià(
	`fe_exi¡s
(
$de¡
)) {

446 ià(
$pos
 = 
	`¡¼pos
(
$ba£Çme
, '.')) {

447 
$Çme
 = 
	`sub¡r
(
$ba£Çme
, 0, 
$pos
);

448 
$ext
 = 
	`sub¡r
(
$ba£Çme
, 
$pos
);

451 
$Çme
 = 
$ba£Çme
;

454 
$couÁ”
 = 0;

456 
$de¡
 = 
$dœeùÜy
 .'/'. 
$Çme
 .'_'. 
$couÁ”
++ . 
$ext
;

457 } 
	`fe_exi¡s
(
$de¡
));

460  
$de¡
;

461 
	}
}

469 
funùiÚ
 
	$fe_d–‘e
(
$·th
) {

470 ià(
	`is_fe
(
$·th
)) {

471  
	`uÆšk
(
$·th
);

473 
	}
}

482 
funùiÚ
 
	$fe_¥aû_u£d
(
$uid
 = 
NULL
) {

483 ià(
	`is£t
(
$uid
)) {

484  (è
	`db_»suÉ
(
	`db_qu”y
('SELECT SUM(fesizeèFROM {fes} WHERE uid = %d', 
$uid
));

486  (è
	`db_»suÉ
(
	`db_qu”y
('SELECT SUM(filesize) FROM {files}'));

487 
	}
}

516 
funùiÚ
 
fe_§ve_u¶ßd
(
$sourû
, 
$v®id©Üs
 = 
¬¿y
(), 
$de¡
 = 
FALSE
, 
$»¶aû
 = 
FILE_EXISTS_RENAME
) {

517 
glob®
 
$u£r
;

518 
	g$u¶ßd_ÿche
;

521 
	g$v®id©Üs
['fe_v®id©e_Çme_Ëngth'] = 
¬¿y
();

525 ià(
is£t
(
$u¶ßd_ÿche
[
$sourû
])) {

526  
	g$u¶ßd_ÿche
[
$sourû
];

530 ià(
is£t
(
$_FILES
['fes']è&& 
	g$_FILES
['fes']['Çme'][
$sourû
] && 
is_u¶ßded_fe
($_FILES['files']['tmp_name'][$source])) {

533 
	g$_FILES
['fes']['”rÜ'][
$sourû
]) {

535 
	gUPLOAD_ERR_OK
:

538 
	gUPLOAD_ERR_INI_SIZE
:

539 
UPLOAD_ERR_FORM_SIZE
:

540 
dru·l_£t_mes§ge
(
t
('Thf%fcould‚Ù b§ved, beÿu£ iˆexûed %maxsize,hmaximum‡Îowed sizfÜ u¶ßds.', 
¬¿y
('%fe' => 
$sourû
, '%maxsize' => 
fÜm©_size
(
fe_u¶ßd_max_size
()))), 'error');

543 
	gUPLOAD_ERR_PARTIAL
:

544 
UPLOAD_ERR_NO_FILE
:

545 
dru·l_£t_mes§ge
(
t
('Thf%fcould‚Ù b§ved, beÿu£hu¶ßd did‚Ù com¶‘e.', 
¬¿y
('%fe' => 
$sourû
)), 'error');

550 
dru·l_£t_mes§ge
(
t
('Thf%fcould‚Ù b§ved. AÀunknowÀ”rÜ ha occu¼ed.', 
¬¿y
('%fe' => 
$sourû
)), 'error');

556 
	g$ex‹nsiÚs
 = '';

557 
fÜ—ch
 (
$u£r
->
rŞes
 
as
 
$rid
 => 
$Çme
) {

558 
$ex‹nsiÚs
 .ğ' '. 
v¬ŸbË_g‘
("upload_extensions_$rid",

559 
v¬ŸbË_g‘
('upload_extensions_default', 'jpg jpeg gif…ngxt html doc xls…df…pt…ps odt ods odp'));

563 
	g$fe
 = 
Ãw
 
¡dCÏss
();

564 
	g$fe
->
	gf’ame
 = 
fe_munge_f’ame
(
Œim
(
ba£Çme
(
$_FILES
['fes']['Çme'][
$sourû
]), '.'), 
$ex‹nsiÚs
);

565 
	g$fe
->
	gf•©h
 = 
$_FILES
['fes']['tmp_Çme'][
$sourû
];

566 
	g$fe
->
	gfemime
 = 
fe_g‘_mim‘y³
(
$fe
->
f’ame
);

570 ià(
em±y
(
$de¡
è|| 
fe_check_·th
($de¡è==ğ
FALSE
) {

571 
$de¡
 = 
fe_dœeùÜy_‹mp
();

574 
	g$fe
->
	gsourû
 = 
$sourû
;

575 
	g$fe
->
	gde¡š©iÚ
 = 
fe_de¡š©iÚ
(
fe_ü—‹_·th
(
$de¡
 .'/'. 
$fe
->
f’ame
), 
$»¶aû
);

576 
	g$fe
->
	gfesize
 = 
$_FILES
['fes']['size'][
$sourû
];

579 
	g$”rÜs
 = 
¬¿y
();

580 
fÜ—ch
 (
$v®id©Üs
 
as
 
$funùiÚ
 => 
$¬gs
) {

581 
¬¿y_unshiá
(
$¬gs
, 
$fe
);

583 
	g$¬gs
[0] = &
$fe
;

584 
	g$”rÜs
 = 
¬¿y_m”ge
(
$”rÜs
, 
ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
$¬gs
));

588 ià(
´eg_m©ch
('/\.Õhp|¶|py|cgi|a¥|js)$/i', 
$fe
->
f’ame
è&& (
sub¡r
($file->filename, -4) != '.txt')) {

589 
$fe
->
femime
 = 'text/plain';

590 
	g$fe
->
	gf•©h
 .= '.txt';

591 
	g$fe
->
	gf’ame
 .= '.txt';

594 
	g$fe
->
	gf’ame
 = 
fe_munge_f’ame
(
$fe
->
f’ame
, 
$ex‹nsiÚs
);

595 
	g$fe
->
	gde¡š©iÚ
 = 
fe_de¡š©iÚ
(
fe_ü—‹_·th
(
$de¡
 .'/'. 
$fe
->
f’ame
), 
$»¶aû
);

600 ià(!
em±y
(
$”rÜs
)) {

601 
	g$mes§ge
 = 
t
('Th£Ëùed f%Çmcould‚Ù bu¶ßded.', 
¬¿y
('%Çme' => 
$fe
->
f’ame
));

602 ià(
couÁ
(
$”rÜs
) > 1) {

603 
	g$mes§ge
 .ğ'<ul><li>'. 
im¶ode
('</li><li>', 
$”rÜs
) .'</li></ul>';

606 
	g$mes§ge
 .ğ' '. 
¬¿y_pİ
(
$”rÜs
);

608 
fÜm_£t_”rÜ
(
$sourû
, 
$mes§ge
);

614 
	g$fe
->
	gf•©h
 = 
$fe
->
de¡š©iÚ
;

615 ià(!
move_u¶ßded_fe
(
$_FILES
['fes']['tmp_Çme'][
$sourû
], 
$fe
->
f•©h
)) {

616 
fÜm_£t_”rÜ
(
$sourû
, 
t
('File uploadƒrror. Could‚ot move uploaded file.'));

617 
w©chdog
('fe', 'U¶ßdƒ¼Ü. Could‚Ù movu¶ßded f%ftØde¡š©iÚ %de¡š©iÚ.', 
¬¿y
('%fe' => 
$fe
->
f’ame
, '%de¡š©iÚ' => $fe->
f•©h
));

622 
	g$fe
->
	guid
 = 
$u£r
->
uid
;

623 
	g$fe
->
	g¡©us
 = 
FILE_STATUS_TEMPORARY
;

624 
	g$fe
->
	gtime¡amp
 = 
time
();

625 
dru·l_wr™e_»cÜd
('fes', 
$fe
);

628 
	g$u¶ßd_ÿche
[
$sourû
] = 
$fe
;

629  
	g$fe
;

642 
funùiÚ
 
	$fe_v®id©e_Çme_Ëngth
(
$fe
) {

643 
$”rÜs
 = 
	`¬¿y
();

645 ià(
	`¡¾’
(
$fe
->
f’ame
) > 255) {

646 
$”rÜs
[] = 
	`t
('Its‚ameƒxceedshe 255 characters†imit. Please„enamehe file‡ndry‡gain.');

648  
$”rÜs
;

649 
	}
}

662 
funùiÚ
 
	$fe_v®id©e_ex‹nsiÚs
(
$fe
, 
$ex‹nsiÚs
) {

663 
glob®
 
$u£r
;

665 
$”rÜs
 = 
	`¬¿y
();

668 ià(
$u£r
->
uid
 != 1) {

669 
$»gex
 = '/\.('. 
	`”eg_»¶aû
(' +', '|', 
	`´eg_quÙe
(
$ex‹nsiÚs
)) .')$/i';

670 ià(!
	`´eg_m©ch
(
$»gex
, 
$fe
->
f’ame
)) {

671 
$”rÜs
[] = 
	`t
('OÆy fe w™hhfŞlowšgƒx‹nsiÚ ¬®lowed: %fes-®lowed.', 
	`¬¿y
('%fes-®lowed' => 
$ex‹nsiÚs
));

674  
$”rÜs
;

675 
	}
}

692 
funùiÚ
 
	$fe_v®id©e_size
(
$fe
, 
$fe_lim™
 = 0, 
$u£r_lim™
 = 0) {

693 
glob®
 
$u£r
;

695 
$”rÜs
 = 
	`¬¿y
();

698 ià(
$u£r
->
uid
 != 1) {

699 ià(
$fe_lim™
 && 
$fe
->
fesize
 > $file_limit) {

700 
$”rÜs
[] = 
	`t
('Thfi %fesizexûedšghmaximum fsizoà%maxsize.', 
	`¬¿y
('%fesize' => 
	`fÜm©_size
(
$fe
->
fesize
), '%maxsize' => fÜm©_size(
$fe_lim™
)));

704 ià(
$u£r_lim™
 && (
	`fe_¥aû_u£d
(
$u£r
->
uid
è+ 
$fe
->
fesize
) > $user_limit) {

705 
$”rÜs
[] = 
	`t
('Thfi %fesizwhich wouldƒxûed you¸disk quÙ¨oà%quÙa.', 
	`¬¿y
('%fesize' => 
	`fÜm©_size
(
$fe
->
fesize
), '%quÙa' => fÜm©_size(
$u£r_lim™
)));

708  
$”rÜs
;

709 
	}
}

719 
funùiÚ
 
	$fe_v®id©e_is_image
(&
$fe
) {

720 
$”rÜs
 = 
	`¬¿y
();

722 
$šfo
 = 
	`image_g‘_šfo
(
$fe
->
f•©h
);

723 ià(!
$šfo
 || 
	`em±y
($info['extension'])) {

724 
$”rÜs
[] = 
	`t
('Only JPEG, PNG‡nd GIF images‡re‡llowed.');

727  
$”rÜs
;

728 
	}
}

748 
funùiÚ
 
	$fe_v®id©e_image_»sŞutiÚ
(&
$fe
, 
$maximum_dim’siÚs
 = 0, 
$mšimum_dim’siÚs
 = 0) {

749 
$”rÜs
 = 
	`¬¿y
();

752 ià(
$šfo
 = 
	`image_g‘_šfo
(
$fe
->
f•©h
)) {

753 ià(
$maximum_dim’siÚs
) {

755 
	`li¡
(
$width
, 
$height
èğ
	`ex¶ode
('x', 
$maximum_dim’siÚs
);

756 ià(
$šfo
['width'] > 
$width
 || $šfo['height'] > 
$height
) {

758 ià(
	`image_g‘_toŞk™
(è&& 
	`image_sÿË
(
$fe
->
f•©h
, $fe->f•©h, 
$width
, 
$height
)) {

759 
	`dru·l_£t_mes§ge
(
	`t
('Thimagwa »sizedØf™ w™hšhmaximum‡Îowed dim’siÚ oà%dim’siÚ pix–s.', 
	`¬¿y
('%dim’siÚs' => 
$maximum_dim’siÚs
)));

762 
	`ş—r¡©ÿche
();

763 
$šfo
 = 
	`image_g‘_šfo
(
$fe
->
f•©h
);

764 
$fe
->
fesize
 = 
$šfo
['file_size'];

767 
$”rÜs
[] = 
	`t
('Thimagi toØÏrge;hmaximum dim’siÚ ¬%dim’siÚ pix–s.', 
	`¬¿y
('%dim’siÚs' => 
$maximum_dim’siÚs
));

772 ià(
$mšimum_dim’siÚs
) {

774 
	`li¡
(
$width
, 
$height
èğ
	`ex¶ode
('x', 
$mšimum_dim’siÚs
);

775 ià(
$šfo
['width'] < 
$width
 || $šfo['height'] < 
$height
) {

776 
$”rÜs
[] = 
	`t
('Thimagi toØsm®l;hmšimum dim’siÚ ¬%dim’siÚ pix–s.', 
	`¬¿y
('%dim’siÚs' => 
$mšimum_dim’siÚs
));

781  
$”rÜs
;

782 
	}
}

796 
funùiÚ
 
	$fe_§ve_d©a
(
$d©a
, 
$de¡
, 
$»¶aû
 = 
FILE_EXISTS_RENAME
) {

797 
$‹mp
 = 
	`fe_dœeùÜy_‹mp
();

799 
$fe
 = 
	`‹m²am
(
	`»®·th
(
$‹mp
), 'file');

800 ià(!
$å
 = 
	`fİ’
(
$fe
, 'wb')) {

801 
	`dru·l_£t_mes§ge
(
	`t
('The file could‚ot be created.'), 'error');

804 
	`fwr™e
(
$å
, 
$d©a
);

805 
	`fşo£
(
$å
);

807 ià(!
	`fe_move
(
$fe
, 
$de¡
, 
$»¶aû
)) {

811  
$fe
;

812 
	}
}

822 
funùiÚ
 
	$fe_£t_¡©us
(&
$fe
, 
$¡©us
) {

823 ià(
	`db_qu”y
('UPDATE {fes} SET stu ğ%d WHERE fid = %d', 
$¡©us
, 
$fe
->
fid
)) {

824 
$fe
->
¡©us
 = 
$¡©us
;

825  
TRUE
;

827  
FALSE
;

828 
	}
}

837 
funùiÚ
 
	$fe_Œªsãr
(
$sourû
, 
$h—d”s
) {

838 ià(
	`ob_g‘_Ëv–
()) {

839 
	`ob_’d_ş—n
();

842 
	`fÜ—ch
 (
$h—d”s
 
as
 
$h—d”
) {

846 
$h—d”
 = 
	`´eg_»¶aû
('/\r?\n(?!\t| )/', '', $header);

847 
	`dru·l_£t_h—d”
(
$h—d”
);

850 
$sourû
 = 
	`fe_ü—‹_·th
($source);

853 ià(
$fd
 = 
	`fİ’
(
$sourû
, 'rb')) {

854 !
	`ãof
(
$fd
)) {

855 
´št
 
	`ä—d
(
$fd
, 1024);

857 
	`fşo£
(
$fd
);

860 
	`dru·l_nÙ_found
();

862 
	`ex™
();

863 
	}
}

872 
funùiÚ
 
	$fe_dowÆßd
() {

874 
$¬gs
 = 
	`func_g‘_¬gs
();

875 
$f•©h
 = 
	`im¶ode
('/', 
$¬gs
);

878 ià(
	`is£t
(
$_GET
['file'])) {

879 
$f•©h
 = 
$_GET
['file'];

882 ià(
	`fe_exi¡s
(
	`fe_ü—‹_·th
(
$f•©h
))) {

883 
$h—d”s
 = 
	`moduË_švoke_®l
('fe_dowÆßd', 
$f•©h
);

884 ià(
	`š_¬¿y
(-1, 
$h—d”s
)) {

885  
	`dru·l_acûss_d’›d
();

887 ià(
	`couÁ
(
$h—d”s
)) {

888 
	`fe_Œªsãr
(
$f•©h
, 
$h—d”s
);

891  
	`dru·l_nÙ_found
();

892 
	}
}

927 
funùiÚ
 
fe_sÿn_dœeùÜy
(
$dœ
, 
$mask
, 
$nomask
 = 
¬¿y
('.', '..', 'CVS'), 
$ÿÎback
 = 0, 
$»cur£
 = 
TRUE
, 
$key
 = 'f’ame', 
$mš_d•th
 = 0, 
$d•th
 = 0) {

928 
$key
 = (
š_¬¿y
($key, 
¬¿y
('f’ame', 'ba£Çme', 'Çme')è? 
	g$key
 : 'filename');

929 
	g$fes
 = 
¬¿y
();

931 ià(
is_dœ
(
$dœ
è&& 
	g$hªdË
 = 
İ’dœ
($dir)) {

932 
FALSE
 !=ğ(
$fe
 = 
»addœ
(
$hªdË
))) {

933 ià(!
š_¬¿y
(
$fe
, 
$nomask
) && $file[0] != '.') {

934 ià(
is_dœ
("$dœ/$fe"è&& 
$»cur£
) {

936 
$fes
 = 
¬¿y_m”ge
(
fe_sÿn_dœeùÜy
("$dœ/$fe", 
$mask
, 
$nomask
, 
$ÿÎback
, 
$»cur£
, 
$key
, 
$mš_d•th
, 
$d•th
 + 1), $files);

938 
–£if
 (
$d•th
 >ğ
$mš_d•th
 && 
”eg
(
$mask
, 
$fe
)) {

940 
	g$f’ame
 = "$dir/$file";

941 
	g$ba£Çme
 = 
ba£Çme
(
$fe
);

942 
	g$Çme
 = 
sub¡r
(
$ba£Çme
, 0, 
¡¼pos
($basename, '.'));

943 
	g$fes
[
$$key
] = 
Ãw
 
¡dCÏss
();

944 
	g$fes
[
$$key
]->
	gf’ame
 = 
$f’ame
;

945 
	g$fes
[
$$key
]->
	gba£Çme
 = 
$ba£Çme
;

946 
	g$fes
[
$$key
]->
	gÇme
 = 
$Çme
;

947 ià(
	g$ÿÎback
) {

948 
$ÿÎback
(
$f’ame
);

954 
şo£dœ
(
$hªdË
);

957  
	g$fes
;

965 
funùiÚ
 
	$fe_dœeùÜy_‹mp
() {

966 
$‹mpÜ¬y_dœeùÜy
 = 
	`v¬ŸbË_g‘
('fe_dœeùÜy_‹mp', 
NULL
);

968 ià(
	`is_nuÎ
(
$‹mpÜ¬y_dœeùÜy
)) {

969 
$dœeùÜ›s
 = 
	`¬¿y
();

972 ià(
	`ši_g‘
('upload_tmp_dir')) {

973 
$dœeùÜ›s
[] = 
	`ši_g‘
('upload_tmp_dir');

977 ià(
	`sub¡r
(
PHP_OS
, 0, 3) == 'WIN') {

978 
$dœeùÜ›s
[] = 'c:\\windows\\temp';

979 
$dœeùÜ›s
[] = 'c:\\winnt\\temp';

980 
$·th_d–im™”
 = '\\';

983 
$dœeùÜ›s
[] = '/tmp';

984 
$·th_d–im™”
 = '/';

987 
	`fÜ—ch
 (
$dœeùÜ›s
 
as
 
$dœeùÜy
) {

988 ià(!
$‹mpÜ¬y_dœeùÜy
 && 
	`is_dœ
(
$dœeùÜy
)) {

989 
$‹mpÜ¬y_dœeùÜy
 = 
$dœeùÜy
;

994 
$‹mpÜ¬y_dœeùÜy
 = $‹mpÜ¬y_dœeùÜy ? $‹mpÜ¬y_dœeùÜy : 
	`fe_dœeùÜy_·th
(è. 
$·th_d–im™”
 .'tmp';

995 
	`v¬ŸbË_£t
('fe_dœeùÜy_‹mp', 
$‹mpÜ¬y_dœeùÜy
);

998  
$‹mpÜ¬y_dœeùÜy
;

999 
	}
}

1006 
funùiÚ
 
	$fe_dœeùÜy_·th
() {

1007  
	`v¬ŸbË_g‘
('fe_dœeùÜy_·th', 
	`cÚf_·th
() .'/files');

1008 
	}
}

1016 
funùiÚ
 
	$fe_u¶ßd_max_size
() {

1017 
$max_size
 = -1;

1019 ià(
$max_size
 < 0) {

1020 
$u¶ßd_max
 = 
	`·r£_size
(
	`ši_g‘
('upload_max_filesize'));

1021 
$po¡_max
 = 
	`·r£_size
(
	`ši_g‘
('post_max_size'));

1022 
$max_size
 = (
$u¶ßd_max
 < 
$po¡_max
) ? $upload_max : $post_max;

1024  
$max_size
;

1025 
	}
}

1039 
funùiÚ
 
	$fe_g‘_mim‘y³
(
$f’ame
, 
$m­pšg
 = 
NULL
) {

1040 ià(!
	`is_¬¿y
(
$m­pšg
)) {

1041 
$m­pšg
 = 
	`v¬ŸbË_g‘
('mime_ex‹nsiÚ_m­pšg', 
	`¬¿y
(

1392 
	`fÜ—ch
 (
$m­pšg
 
as
 
$ext_´eg
 => 
$mime_m©ch
) {

1393 ià(
	`´eg_m©ch
('!\.('. 
$ext_´eg
 .')$!i', 
$f’ame
)) {

1394  
$mime_m©ch
;

1399 
	}
}

	@/srv/http/subs/notes/www/includes/form.inc

1 <?
php


69 
funùiÚ
 
	$dru·l_g‘_fÜm
(
$fÜm_id
) {

70 
$fÜm_¡©e
 = 
	`¬¿y
('¡Üage' => 
NULL
, 'subm™‹d' => 
FALSE
);

72 
$¬gs
 = 
	`func_g‘_¬gs
();

73 
$ÿch—bË
 = 
FALSE
;

75 ià(
	`is£t
(
$_SESSION
['batch_form_state'])) {

79 
$fÜm_¡©e
 = 
$_SESSION
['batch_form_state'];

80 
	`un£t
(
$_SESSION
['batch_form_state']);

88 ià(
	`is£t
(
$_POST
['fÜm_id']è&& $_POST['fÜm_id'] =ğ
$fÜm_id
 && !
	`em±y
($_POST['form_build_id'])) {

89 
$fÜm
 = 
	`fÜm_g‘_ÿche
(
$_POST
['fÜm_bud_id'], 
$fÜm_¡©e
);

95 ià(!
	`is£t
(
$fÜm
)) {

96 
$fÜm_¡©e
['po¡'] = 
$_POST
;

98 
$¬gs_‹mp
 = 
$¬gs
;

99 
$¬gs_‹mp
[0] = &
$fÜm_¡©e
;

100 
	`¬¿y_unshiá
(
$¬gs_‹mp
, 
$fÜm_id
);

102 
$fÜm
 = 
	`ÿÎ_u£r_func_¬¿y
('dru·l_»Œ›ve_fÜm', 
$¬gs_‹mp
);

103 
$fÜm_bud_id
 = 'fÜm-'. 
	`md5
(
	`uniqid
(
	`mt_¿nd
(), 
TRUE
));

104 
$fÜm
['#bud_id'] = 
$fÜm_bud_id
;

105 
	`dru·l_´•¬e_fÜm
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
);

108 
$Üigš®_fÜm
 = 
$fÜm
;

109 
$ÿch—bË
 = 
TRUE
;

110 
	`un£t
(
$fÜm_¡©e
['post']);

112 
$fÜm
['#po¡'] = 
$_POST
;

119 
	`dru·l_´oûss_fÜm
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
);

120 ià(
$ÿch—bË
 && !
	`em±y
(
$fÜm
['#cache'])) {

123 
	`fÜm_£t_ÿche
(
$fÜm_bud_id
, 
$Üigš®_fÜm
, 
$fÜm_¡©e
);

141 ià((!
	`em±y
(
$fÜm_¡©e
['¡Üage']è|| !em±y($fÜm_¡©e['»bud'])è&& !em±y($fÜm_¡©e['´oûss_šput']è&& !
	`fÜm_g‘_”rÜs
()) {

142 
$fÜm
 = 
	`dru·l_»bud_fÜm
(
$fÜm_id
, 
$fÜm_¡©e
, 
$¬gs
);

147  
	`dru·l_»nd”_fÜm
(
$fÜm_id
, 
$fÜm
);

148 
	}
}

187 
funùiÚ
 
	$dru·l_»bud_fÜm
(
$fÜm_id
, &
$fÜm_¡©e
, 
$¬gs
, 
$fÜm_bud_id
 = 
NULL
) {

191 
$¬gs
[0] = &
$fÜm_¡©e
;

193 
	`¬¿y_unshiá
(
$¬gs
, 
$fÜm_id
);

194 
$fÜm
 = 
	`ÿÎ_u£r_func_¬¿y
('dru·l_»Œ›ve_fÜm', 
$¬gs
);

196 ià(!
	`is£t
(
$fÜm_bud_id
)) {

198 
$fÜm_bud_id
 = 'fÜm-'. 
	`md5
(
	`uniqid
(
	`mt_¿nd
(), 
TRUE
));

200 
$fÜm
['#bud_id'] = 
$fÜm_bud_id
;

201 
	`dru·l_´•¬e_fÜm
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
);

206 
	`fÜm_£t_ÿche
(
$fÜm_bud_id
, 
$fÜm
, 
$fÜm_¡©e
);

211 
$_POST
 = 
	`¬¿y
();

212 
$fÜm
['#po¡'] = 
	`¬¿y
();

213 
	`dru·l_´oûss_fÜm
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
);

214  
$fÜm
;

215 
	}
}

220 
funùiÚ
 
	$fÜm_£t_ÿche
(
$fÜm_bud_id
, 
$fÜm
, 
$fÜm_¡©e
) {

221 
glob®
 
$u£r
;

223 
$expœe
 = 21600;

225 ià(
$u£r
->
uid
) {

226 
$fÜm
['#ÿche_tok’'] = 
	`dru·l_g‘_tok’
();

228 
	`ÿche_£t
('fÜm_'. 
$fÜm_bud_id
, 
$fÜm
, 'ÿche_fÜm', 
	`time
(è+ 
$expœe
);

229 ià(!
	`em±y
(
$fÜm_¡©e
['storage'])) {

230 
	`ÿche_£t
('¡Üage_'. 
$fÜm_bud_id
, 
$fÜm_¡©e
['¡Üage'], 'ÿche_fÜm', 
	`time
(è+ 
$expœe
);

232 
	}
}

237 
funùiÚ
 
	$fÜm_g‘_ÿche
(
$fÜm_bud_id
, &
$fÜm_¡©e
) {

238 
glob®
 
$u£r
;

239 ià(
$ÿched
 = 
	`ÿche_g‘
('fÜm_'. 
$fÜm_bud_id
, 'cache_form')) {

240 
$fÜm
 = 
$ÿched
->
d©a
;

241 ià((
	`is£t
(
$fÜm
['#ÿche_tok’']è&& 
	`dru·l_v®id_tok’
($fÜm['#ÿche_tok’'])è|| (!is£t($fÜm['#ÿche_tok’']è&& !
$u£r
->
uid
)) {

242 ià(
$ÿched
 = 
	`ÿche_g‘
('¡Üage_'. 
$fÜm_bud_id
, 'cache_form')) {

243 
$fÜm_¡©e
['¡Üage'] = 
$ÿched
->
d©a
;

245  
$fÜm
;

248 
	}
}

299 
funùiÚ
 
	$dru·l_execu‹
(
$fÜm_id
, &
$fÜm_¡©e
) {

300 
$¬gs
 = 
	`func_g‘_¬gs
();

303 
$¬gs
[1] = &
$fÜm_¡©e
;

305 
$fÜm
 = 
	`ÿÎ_u£r_func_¬¿y
('dru·l_»Œ›ve_fÜm', 
$¬gs
);

306 
$fÜm
['#po¡'] = 
$fÜm_¡©e
['values'];

307 
	`dru·l_´•¬e_fÜm
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
);

308 
	`dru·l_´oûss_fÜm
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
);

309 
	}
}

330 
funùiÚ
 
	$dru·l_»Œ›ve_fÜm
(
$fÜm_id
, &
$fÜm_¡©e
) {

331 
$fÜms
;

338 
$¬gs
 = 
	`func_g‘_¬gs
();

339 
$§ved_¬gs
 = 
$¬gs
;

340 
	`¬¿y_shiá
(
$¬gs
);

341 ià(
	`is£t
(
$fÜm_¡©e
)) {

342 
	`¬¿y_shiá
(
$¬gs
);

347 ià(!
	`funùiÚ_exi¡s
(
$fÜm_id
)) {

359 ià(!
	`is£t
(
$fÜms
è|| !is£t($fÜms[
$fÜm_id
])) {

360 
$fÜms
 = 
	`moduË_švoke_®l
('fÜms', 
$fÜm_id
, 
$¬gs
);

362 
$fÜm_defš™iÚ
 = 
$fÜms
[
$fÜm_id
];

363 ià(
	`is£t
(
$fÜm_defš™iÚ
['callback‡rguments'])) {

364 
$¬gs
 = 
	`¬¿y_m”ge
(
$fÜm_defš™iÚ
['callback‡rguments'], $args);

366 ià(
	`is£t
(
$fÜm_defš™iÚ
['callback'])) {

367 
$ÿÎback
 = 
$fÜm_defš™iÚ
['callback'];

371 
	`¬¿y_unshiá
(
$¬gs
, 
NULL
);

372 
$¬gs
[0] = &
$fÜm_¡©e
;

376 
$fÜm
 = 
	`ÿÎ_u£r_func_¬¿y
(
	`is£t
(
$ÿÎback
è? $ÿÎback : 
$fÜm_id
, 
$¬gs
);

382 
$fÜm
['#·¿m‘”s'] = 
$§ved_¬gs
;

383  
$fÜm
;

384 
	}
}

401 
funùiÚ
 
	$dru·l_´oûss_fÜm
(
$fÜm_id
, &
$fÜm
, &
$fÜm_¡©e
) {

402 
$fÜm_¡©e
['v®ues'] = 
	`¬¿y
();

404 
$fÜm
 = 
	`fÜm_bud”
(
$fÜm_id
, $fÜm, 
$fÜm_¡©e
);

407 ià((!
	`em±y
(
$fÜm
['#´og¿mmed'])è|| (!em±y($fÜm['#po¡']è&& (
	`is£t
($fÜm['#po¡']['fÜm_id']è&& ($fÜm['#po¡']['fÜm_id'] =ğ
$fÜm_id
)))) {

408 
$fÜm_¡©e
['´oûss_šput'] = 
TRUE
;

409 
	`dru·l_v®id©e_fÜm
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
);

416 
	`fÜm_ş—n_id
(
NULL
, 
TRUE
);

418 ià((!
	`em±y
(
$fÜm_¡©e
['subm™‹d'])è&& !
	`fÜm_g‘_”rÜs
() &&ƒmpty($form_state['rebuild'])) {

419 
$fÜm_¡©e
['»dœeù'] = 
NULL
;

420 
	`fÜm_execu‹_hªdËrs
('subm™', 
$fÜm
, 
$fÜm_¡©e
);

425 ià(
	`v¬ŸbË_g‘
('ÿche', 
CACHE_DISABLED
è=ğCACHE_DISABLED && !
	`em±y
(
$fÜm_¡©e
['values']['form_build_id'])) {

426 
	`ÿche_ş—r_®l
('fÜm_'. 
$fÜm_¡©e
['values']['form_build_id'], 'cache_form');

427 
	`ÿche_ş—r_®l
('¡Üage_'. 
$fÜm_¡©e
['values']['form_build_id'], 'cache_form');

434 ià(
$b©ch
 =& 
	`b©ch_g‘
(è&& !
	`is£t
($batch['current_set'])) {

437 
$b©ch
['fÜm'] = 
$fÜm
;

438 
$b©ch
['fÜm_¡©e'] = 
$fÜm_¡©e
;

439 
$b©ch
['´og»ssive'] = !
$fÜm
['#programmed'];

440 
	`b©ch_´oûss
();

454 ià(!
$fÜm
['#´og¿mmed'] && 
	`em±y
(
$fÜm_¡©e
['rebuild']) &&ƒmpty($form_state['storage'])) {

455 
	`dru·l_»dœeù_fÜm
(
$fÜm
, 
$fÜm_¡©e
['redirect']);

459 
	}
}

475 
funùiÚ
 
	$dru·l_´•¬e_fÜm
(
$fÜm_id
, &
$fÜm
, &
$fÜm_¡©e
) {

476 
glob®
 
$u£r
;

478 
$fÜm
['#type'] = 'form';

479 
$fÜm
['#´og¿mmed'] = 
	`is£t
($form['#post']);

481 ià(
	`is£t
(
$fÜm
['#build_id'])) {

482 
$fÜm
['fÜm_bud_id'] = 
	`¬¿y
(

484 '#v®ue' => 
$fÜm
['#build_id'],

485 '#id' => 
$fÜm
['#build_id'],

494 ià(
	`is£t
(
$fÜm
['#token'])) {

495 ià(
$fÜm
['#tok’'] ==ğ
FALSE
 || 
$u£r
->
uid
 == 0 || $form['#programmed']) {

496 
	`un£t
(
$fÜm
['#token']);

499 
$fÜm
['fÜm_tok’'] = 
	`¬¿y
('#ty³' => 'tok’', '#deçuÉ_v®ue' => 
	`dru·l_g‘_tok’
($form['#token']));

502 ià(
	`is£t
(
$u£r
->
uid
è&& $u£r->uid && !
$fÜm
['#programmed']) {

503 
$fÜm
['#tok’'] = 
$fÜm_id
;

504 
$fÜm
['fÜm_tok’'] = 
	`¬¿y
(

505 '#id' => 
	`fÜm_ş—n_id
('ed™-'. 
$fÜm_id
 .'-form-token'),

507 '#deçuÉ_v®ue' => 
	`dru·l_g‘_tok’
(
$fÜm
['#token']),

511 ià(
	`is£t
(
$fÜm_id
)) {

512 
$fÜm
['fÜm_id'] = 
	`¬¿y
(

514 '#v®ue' => 
$fÜm_id
,

515 '#id' => 
	`fÜm_ş—n_id
("edit-$form_id"),

518 ià(!
	`is£t
(
$fÜm
['#id'])) {

519 
$fÜm
['#id'] = 
	`fÜm_ş—n_id
(
$fÜm_id
);

522 
$fÜm
 +ğ
	`_–em’t_šfo
('form');

524 ià(!
	`is£t
(
$fÜm
['#validate'])) {

525 ià(
	`funùiÚ_exi¡s
(
$fÜm_id
 .'_validate')) {

526 
$fÜm
['#v®id©e'] = 
	`¬¿y
(
$fÜm_id
 .'_validate');

530 ià(!
	`is£t
(
$fÜm
['#submit'])) {

531 ià(
	`funùiÚ_exi¡s
(
$fÜm_id
 .'_submit')) {

533 
$fÜm
['#subm™'] = 
	`¬¿y
(
$fÜm_id
 .'_submit');

543 
$d©a
 = &
$fÜm
;

544 
$d©a
['__dru·l_®‹r_by_»f'] = 
	`¬¿y
(&
$fÜm_¡©e
);

545 
	`dru·l_®‹r
('fÜm_'. 
$fÜm_id
, 
$d©a
);

549 
$d©a
['__dru·l_®‹r_by_»f'] = 
	`¬¿y
(&
$fÜm_¡©e
);

550 
	`dru·l_®‹r
('fÜm', 
$d©a
, 
$fÜm_id
);

551 
	}
}

574 
funùiÚ
 
	$dru·l_v®id©e_fÜm
(
$fÜm_id
, 
$fÜm
, &
$fÜm_¡©e
) {

575 
$v®id©ed_fÜms
 = 
	`¬¿y
();

577 ià(
	`is£t
(
$v®id©ed_fÜms
[
$fÜm_id
])) {

583 ià(
	`is£t
(
$fÜm
['#token'])) {

584 ià(!
	`dru·l_v®id_tok’
(
$fÜm_¡©e
['v®ues']['fÜm_tok’'], 
$fÜm
['#token'])) {

586 
	`fÜm_£t_”rÜ
('fÜm_tok’', 
	`t
('Validationƒrror,…leasery‡gain. Ifhisƒrror…ersists,…lease contacthe site‡dministrator.'));

590 
	`_fÜm_v®id©e
(
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
);

591 
$v®id©ed_fÜms
[
$fÜm_id
] = 
TRUE
;

592 
	}
}

605 
funùiÚ
 
	$dru·l_»nd”_fÜm
(
$fÜm_id
, &
$fÜm
) {

607 ià(!
	`is£t
(
$fÜm
['#theme'])) {

608 
	`š™_theme
();

609 
$»gi¡ry
 = 
	`theme_g‘_»gi¡ry
();

610 ià(
	`is£t
(
$»gi¡ry
[
$fÜm_id
])) {

611 
$fÜm
['#theme'] = 
$fÜm_id
;

615 
$ouut
 = 
	`dru·l_»nd”
(
$fÜm
);

616  
$ouut
;

617 
	}
}

628 
funùiÚ
 
	$dru·l_»dœeù_fÜm
(
$fÜm
, 
$»dœeù
 = 
NULL
) {

629 
$gÙo
 = 
NULL
;

630 ià(
	`is£t
(
$»dœeù
)) {

631 
$gÙo
 = 
$»dœeù
;

633 ià(
$gÙo
 !=ğ
FALSE
 && 
	`is£t
(
$fÜm
['#redirect'])) {

634 
$gÙo
 = 
$fÜm
['#redirect'];

636 ià(!
	`is£t
(
$gÙo
è|| ($gÙØ!=ğ
FALSE
)) {

637 ià(
	`is£t
(
$gÙo
)) {

638 ià(
	`is_¬¿y
(
$gÙo
)) {

639 
	`ÿÎ_u£r_func_¬¿y
('dru·l_gÙo', 
$gÙo
);

642 
	`dru·l_gÙo
(
$gÙo
);

645 
	`dru·l_gÙo
(
$_GET
['q']);

647 
	}
}

670 
funùiÚ
 
	$_fÜm_v®id©e
(
$–em’ts
, &
$fÜm_¡©e
, 
$fÜm_id
 = 
NULL
) {

671 
$com¶‘e_fÜm
;

674 
$t
 = 
	`g‘_t
();

677 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$–em’ts
è
as
 
$key
) {

678 ià(
	`is£t
(
$–em’ts
[
$key
]) && $elements[$key]) {

679 
	`_fÜm_v®id©e
(
$–em’ts
[
$key
], 
$fÜm_¡©e
);

683 ià(!
	`is£t
(
$–em’ts
['#validated']) || !$elements['#validated']) {

684 ià(
	`is£t
(
$–em’ts
['#needs_validation'])) {

689 ià(
$–em’ts
['#»quœed'] && (!
	`couÁ
($–em’ts['#v®ue']è|| (
	`is_¡ršg
($–em’ts['#v®ue']è&& 
	`¡¾’
(
	`Œim
($elements['#value'])) == 0))) {

690 
	`fÜm_”rÜ
(
$–em’ts
, 
	`$t
('!Çmf›ld i »quœed.', 
	`¬¿y
('!name' => $elements['#title'])));

694 ià(
	`is£t
(
$–em’ts
['#maxËngth']è&& 
	`dru·l_¡¾’
($elements['#value']) > $elements['#maxlength']) {

695 
	`fÜm_”rÜ
(
$–em’ts
, 
	`$t
('!ÇmÿÂÙ blÚg”hª %max ch¬aù” buˆi cu¼’y %Ëngth ch¬aù” lÚg.', 
	`¬¿y
('!Çme' => 
	`em±y
($–em’ts['#t™Ë']è? $–em’ts['#·»Ás'][0] : $–em’ts['#t™Ë'], '%max' => $–em’ts['#maxËngth'], '%Ëngth' => 
	`dru·l_¡¾’
($elements['#value']))));

698 ià(
	`is£t
(
$–em’ts
['#options']) && isset($elements['#value'])) {

699 ià(
$–em’ts
['#type'] == 'select') {

700 
$İtiÚs
 = 
	`fÜm_İtiÚs_æ©‹n
(
$–em’ts
['#options']);

703 
$İtiÚs
 = 
$–em’ts
['#options'];

705 ià(
	`is_¬¿y
(
$–em’ts
['#value'])) {

706 
$v®ue
 = 
$–em’ts
['#ty³'] =ğ'checkboxes' ? 
	`¬¿y_keys
(
	`¬¿y_f‹r
($elements['#value'])) : $elements['#value'];

707 
	`fÜ—ch
 (
$v®ue
 
as
 
$v
) {

708 ià(!
	`is£t
(
$İtiÚs
[
$v
])) {

709 
	`fÜm_”rÜ
(
$–em’ts
, 
	`$t
('An illegal choice has been detected. Please contacthe site‡dministrator.'));

710 
	`w©chdog
('fÜm', 'IÎeg® choiû %choiû iÀ!Çm–em’t.', 
	`¬¿y
('%choiû' => 
$v
, '!Çme' => 
	`em±y
(
$–em’ts
['#t™Ë']è? $–em’ts['#·»Ás'][0] : $–em’ts['#t™Ë']), 
WATCHDOG_ERROR
);

714 
	`–£if
 (!
	`is£t
(
$İtiÚs
[
$–em’ts
['#value']])) {

715 
	`fÜm_”rÜ
(
$–em’ts
, 
	`$t
('An illegal choice has been detected. Please contacthe site‡dministrator.'));

716 
	`w©chdog
('fÜm', 'IÎeg® choiû %choiû iÀ%Çm–em’t.', 
	`¬¿y
('%choiû' => 
$–em’ts
['#v®ue'], '%Çme' => 
	`em±y
($–em’ts['#t™Ë']è? $–em’ts['#·»Ás'][0] : $–em’ts['#t™Ë']), 
WATCHDOG_ERROR
);

724 ià(
	`is£t
(
$fÜm_id
)) {

725 
	`fÜm_execu‹_hªdËrs
('v®id©e', 
$–em’ts
, 
$fÜm_¡©e
);

726 
$com¶‘e_fÜm
 = 
$–em’ts
;

730 
	`–£if
 (
	`is£t
(
$–em’ts
['#element_validate'])) {

731 
	`fÜ—ch
 (
$–em’ts
['#–em’t_v®id©e'] 
as
 
$funùiÚ
) {

732 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

733 
	`$funùiÚ
(
$–em’ts
, 
$fÜm_¡©e
, 
$com¶‘e_fÜm
);

737 
$–em’ts
['#v®id©ed'] = 
TRUE
;

739 
	}
}

756 
funùiÚ
 
	$fÜm_execu‹_hªdËrs
(
$ty³
, &
$fÜm
, &
$fÜm_¡©e
) {

757 
$»tuº
 = 
FALSE
;

758 ià(
	`is£t
(
$fÜm_¡©e
[
$ty³
 .'_handlers'])) {

759 
$hªdËrs
 = 
$fÜm_¡©e
[
$ty³
 .'_handlers'];

761 
	`–£if
 (
	`is£t
(
$fÜm
['#'. 
$ty³
])) {

762 
$hªdËrs
 = 
$fÜm
['#'. 
$ty³
];

765 
$hªdËrs
 = 
	`¬¿y
();

768 
	`fÜ—ch
 (
$hªdËrs
 
as
 
$funùiÚ
) {

769 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

773 ià(
$ty³
 =ğ'subm™' && (
$b©ch
 =& 
	`b©ch_g‘
()è&& !
	`is£t
($batch['current_set'])) {

777 
$b©ch
['£ts'][] = 
	`¬¿y
('fÜm_subm™' => 
$funùiÚ
);

780 
	`$funùiÚ
(
$fÜm
, 
$fÜm_¡©e
);

782 
$»tuº
 = 
TRUE
;

785  
$»tuº
;

786 
	}
}

804 
funùiÚ
 
fÜm_£t_”rÜ
(
$Çme
 = 
NULL
, 
$mes§ge
 = '', 
$»£t
 = 
FALSE
) {

805 
$fÜm
 = 
¬¿y
();

806 ià(
	g$»£t
) {

807 
	g$fÜm
 = 
¬¿y
();

809 ià(
is£t
(
$Çme
è&& !is£t(
$fÜm
[$name])) {

810 
	g$fÜm
[
$Çme
] = 
$mes§ge
;

811 ià(
	g$mes§ge
) {

812 
dru·l_£t_mes§ge
(
$mes§ge
, 'error');

815  
	g$fÜm
;

821 
funùiÚ
 
	$fÜm_g‘_”rÜs
() {

822 
$fÜm
 = 
	`fÜm_£t_”rÜ
();

823 ià(!
	`em±y
(
$fÜm
)) {

824  
$fÜm
;

826 
	}
}

831 
funùiÚ
 
	$fÜm_g‘_”rÜ
(
$–em’t
) {

832 
$fÜm
 = 
	`fÜm_£t_”rÜ
();

833 
$key
 = 
$–em’t
['#parents'][0];

834 ià(
	`is£t
(
$fÜm
[
$key
])) {

835  
$fÜm
[
$key
];

837 
$key
 = 
	`im¶ode
('][', 
$–em’t
['#parents']);

838 ià(
	`is£t
(
$fÜm
[
$key
])) {

839  
$fÜm
[
$key
];

841 
	}
}

846 
funùiÚ
 
fÜm_”rÜ
(&
$–em’t
, 
$mes§ge
 = '') {

847 
fÜm_£t_”rÜ
(
im¶ode
('][', 
$–em’t
['#·»Ás']), 
$mes§ge
);

866 
funùiÚ
 
	$fÜm_bud”
(
$fÜm_id
, 
$fÜm
, &
$fÜm_¡©e
) {

867 
$com¶‘e_fÜm
, 
$ÿche
;

870 
$fÜm
['#´oûs£d'] = 
FALSE
;

873 ià((!
	`em±y
(
$fÜm
['#ty³'])è&& (
$šfo
 = 
	`_–em’t_šfo
($form['#type']))) {

875 
$fÜm
 +ğ
$šfo
;

878 ià(
	`is£t
(
$fÜm
['#type']) && $form['#type'] == 'form') {

879 
$ÿche
 = 
NULL
;

880 
$com¶‘e_fÜm
 = 
$fÜm
;

881 ià(!
	`em±y
(
$fÜm
['#programmed'])) {

882 
$fÜm_¡©e
['subm™‹d'] = 
TRUE
;

886 ià(
	`is£t
(
$fÜm
['#input']) && $form['#input']) {

887 
	`_fÜm_bud”_hªdË_šput_–em’t
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
, 
$com¶‘e_fÜm
);

889 
$fÜm
['#deçuÉs_lßded'] = 
TRUE
;

892 
$fÜm
['#sÜ‹d'] = 
TRUE
;

895 
$couÁ
 = 0;

896 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$key
) {

897 
$fÜm
[
$key
]['#post'] = $form['#post'];

898 
$fÜm
[
$key
]['#programmed'] = $form['#programmed'];

900 ià(!
	`is£t
(
$fÜm
[
$key
]['#tree'])) {

901 
$fÜm
[
$key
]['#tree'] = $form['#tree'];

905 ià(
	`is£t
(
$fÜm
['#access']) && !$form['#access']) {

906 
$fÜm
[
$key
]['#acûss'] = 
FALSE
;

910 ià(!
	`is£t
(
$fÜm
[
$key
]['#parents'])) {

913 
$fÜm
[
$key
]['#·»Ás'] = $fÜm[$key]['#Œ“'] && $fÜm['#Œ“'] ? 
	`¬¿y_m”ge
($fÜm['#·»Ás'], 
	`¬¿y
($key)) :‡rray($key);

914 
$¬¿y_·»Ás
 = 
	`is£t
(
$fÜm
['#¬¿y_·»Ás']è? $fÜm['#¬¿y_·»Ás'] : 
	`¬¿y
();

915 
$¬¿y_·»Ás
[] = 
$key
;

916 
$fÜm
[
$key
]['#¬¿y_·»Ás'] = 
$¬¿y_·»Ás
;

920 ià(!
	`is£t
(
$fÜm
[
$key
]['#weight'])) {

921 
$fÜm
[
$key
]['#weight'] = 
$couÁ
/1000;

926 
	`un£t
(
$fÜm
['#sorted']);

928 
$fÜm
[
$key
] = 
	`fÜm_bud”
(
$fÜm_id
, $fÜm[$key], 
$fÜm_¡©e
);

929 
$couÁ
++;

934 ià(
	`is£t
(
$fÜm
['#after_build']) && !isset($form['#after_build_done'])) {

935 
	`fÜ—ch
 (
$fÜm
['#aá”_bud'] 
as
 
$funùiÚ
) {

936 
$fÜm
 = 
	`$funùiÚ
($fÜm, 
$fÜm_¡©e
);

937 
$fÜm
['#aá”_bud_dÚe'] = 
TRUE
;

943 
	`_fÜm_bud”_›_ş—nup
(
$fÜm
, 
$fÜm_¡©e
);

949 ià(!
	`em±y
(
$fÜm_¡©e
['submitted'])) {

950 
	`un£t
(
$fÜm_¡©e
['buttons']);

955 ià(!
	`em±y
(
$fÜm
['#cache'])) {

956 
$ÿche
 = 
$fÜm
['#cache'];

959 ià(
	`is£t
(
$fÜm
['#ty³']è&& $fÜm['#ty³'] =ğ'fÜm' && is£t(
$ÿche
)) {

960 
$fÜm
['#ÿche'] = 
TRUE
;

962  
$fÜm
;

963 
	}
}

970 
funùiÚ
 
	$_fÜm_bud”_hªdË_šput_–em’t
(
$fÜm_id
, &
$fÜm
, &
$fÜm_¡©e
, 
$com¶‘e_fÜm
) {

971 ià(!
	`is£t
(
$fÜm
['#name'])) {

972 
$Çme
 = 
	`¬¿y_shiá
(
$fÜm
['#parents']);

973 
$fÜm
['#Çme'] = 
$Çme
;

974 ià(
$fÜm
['#type'] == 'file') {

978 
$fÜm
['#name'] = 'files['. $form['#name'] .']';

980 
	`–£if
 (
	`couÁ
(
$fÜm
['#parents'])) {

981 
$fÜm
['#Çme'] .ğ'['. 
	`im¶ode
('][', $form['#parents']) .']';

983 
	`¬¿y_unshiá
(
$fÜm
['#·»Ás'], 
$Çme
);

985 ià(!
	`is£t
(
$fÜm
['#id'])) {

986 
$fÜm
['#id'] = 
	`fÜm_ş—n_id
('ed™-'. 
	`im¶ode
('-', $form['#parents']));

989 ià(!
	`em±y
(
$fÜm
['#disabled'])) {

990 
$fÜm
['#attributes']['disabled'] = 'disabled';

993 ià(!
	`is£t
(
$fÜm
['#v®ue']è&& !
	`¬¿y_key_exi¡s
('#value', $form)) {

994 
$funùiÚ
 = !
	`em±y
(
$fÜm
['#value_callback']) ? $form['#value_callback'] : 'form_type_'. $form['#type'] .'_value';

995 ià((
$fÜm
['#´og¿mmed']è|| ((!
	`is£t
($fÜm['#acûss']è|| $fÜm['#acûss']è&& is£t($fÜm['#po¡']è&& (is£t($fÜm['#po¡']['fÜm_id']è&& $fÜm['#po¡']['fÜm_id'] =ğ
$fÜm_id
))) {

996 
$ed™
 = 
$fÜm
['#post'];

997 
	`fÜ—ch
 (
$fÜm
['#·»Ás'] 
as
 
$·»Á
) {

998 
$ed™
 = 
	`is£t
($ed™[
$·»Á
]è? $ed™[$·»Á] : 
NULL
;

1000 ià(!
$fÜm
['#´og¿mmed'] || 
	`is£t
(
$ed™
)) {

1002 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

1003 
$fÜm
['#v®ue'] = 
	`$funùiÚ
($fÜm, 
$ed™
);

1005 ià(!
	`is£t
(
$fÜm
['#v®ue']è&& is£t(
$ed™
)) {

1006 
$fÜm
['#v®ue'] = 
$ed™
;

1010 ià(
	`is£t
(
$fÜm
['#value']) || (isset($form['#required']) && $form['#required'])) {

1011 
$fÜm
['#Ãeds_v®id©iÚ'] = 
TRUE
;

1015 ià(!
	`is£t
(
$fÜm
['#value'])) {

1017 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

1018 
$fÜm
['#v®ue'] = 
	`$funùiÚ
($form);

1023 ià(!
	`is£t
(
$fÜm
['#v®ue']è&& 
	`em±y
($form['#has_garbage_value'])) {

1024 
$fÜm
['#v®ue'] = 
	`is£t
($form['#default_value']) ? $form['#default_value'] : '';

1033 ià(!
	`em±y
(
$fÜm
['#po¡']è&& 
	`is£t
($form['#executes_submit_callback'])) {

1036 
$bu‰Ú_ty³
 = 
$fÜm
['#executes_submit_callback'] ? 'submit' : 'button';

1037 
$fÜm_¡©e
['bu‰Ús'][
$bu‰Ú_ty³
][] = 
$fÜm
;

1039 ià(
	`_fÜm_bu‰Ú_was_şicked
(
$fÜm
)) {

1040 
$fÜm_¡©e
['subm™‹d'] = $fÜm_¡©e['subm™‹d'] || 
$fÜm
['#executes_submit_callback'];

1045 
$fÜm_¡©e
['v®ues'][
$fÜm
['#name']] = $form['#value'];

1046 
$fÜm_¡©e
['şicked_bu‰Ú'] = 
$fÜm
;

1048 ià(
	`is£t
(
$fÜm
['#validate'])) {

1049 
$fÜm_¡©e
['v®id©e_hªdËrs'] = 
$fÜm
['#validate'];

1051 ià(
	`is£t
(
$fÜm
['#submit'])) {

1052 
$fÜm_¡©e
['subm™_hªdËrs'] = 
$fÜm
['#submit'];

1058 ià(
	`is£t
(
$fÜm
['#process']) && !$form['#processed']) {

1059 
	`fÜ—ch
 (
$fÜm
['#´oûss'] 
as
 
$´oûss
) {

1060 ià(
	`funùiÚ_exi¡s
(
$´oûss
)) {

1061 
$fÜm
 = 
	`$´oûss
($fÜm, 
	`is£t
(
$ed™
è? $ed™ : 
NULL
, 
$fÜm_¡©e
, 
$com¶‘e_fÜm
);

1064 
$fÜm
['#´oûs£d'] = 
TRUE
;

1066 
	`fÜm_£t_v®ue
(
$fÜm
, $fÜm['#v®ue'], 
$fÜm_¡©e
);

1067 
	}
}

1078 
funùiÚ
 
	$_fÜm_bu‰Ú_was_şicked
(
$fÜm
) {

1084 ià(
	`is£t
(
$fÜm
['#post'][$form['#name']]) && $form['#post'][$form['#name']] == $form['#value']) {

1085  
TRUE
;

1092 
	`–£if
 (!
	`em±y
(
$fÜm
['#has_g¬bage_v®ue']è&& 
	`is£t
($form['#value']) && $form['#value'] !== '') {

1093  
TRUE
;

1095  
FALSE
;

1096 
	}
}

1106 
funùiÚ
 
	$_fÜm_bud”_›_ş—nup
(
$fÜm
, &
$fÜm_¡©e
) {

1109 ià(!
	`em±y
(
$fÜm
['#type']) && $form['#type'] == 'form') {

1113 ià(
	`em±y
(
$fÜm_¡©e
['submitted']) && !empty($form_state['buttons']['submit']) &&ƒmpty($form_state['buttons']['button'])) {

1114 
$bu‰Ú
 = 
$fÜm_¡©e
['buttons']['submit'][0];

1118 
$fÜm_¡©e
['subm™‹d'] = 
TRUE
;

1119 
$fÜm_¡©e
['subm™_hªdËrs'] = 
	`em±y
(
$bu‰Ú
['#subm™']è? 
NULL
 : $button['#submit'];

1120 
$fÜm_¡©e
['v®id©e_hªdËrs'] = 
	`em±y
(
$bu‰Ú
['#v®id©e']è? 
NULL
 : $button['#validate'];

1121 
$fÜm_¡©e
['v®ues'][
$bu‰Ú
['#name']] = $button['#value'];

1122 
$fÜm_¡©e
['şicked_bu‰Ú'] = 
$bu‰Ú
;

1125 
	}
}

1139 
funùiÚ
 
	$fÜm_ty³_image_bu‰Ú_v®ue
(
$fÜm
, 
$ed™
 = 
FALSE
) {

1140 ià(
$ed™
 !=ğ
FALSE
) {

1141 ià(!
	`em±y
(
$ed™
)) {

1144  
$fÜm
['#return_value'];

1152 
$po¡
 = 
$fÜm
['#post'];

1153 
	`fÜ—ch
 (
	`¥l™
('\[', 
$fÜm
['#Çme']è
as
 
$–em’t_Çme
) {

1155 ià(
	`sub¡r
(
$–em’t_Çme
, -1) == ']') {

1156 
$–em’t_Çme
 = 
	`sub¡r
($element_name, 0, -1);

1159 ià(!
	`is£t
(
$po¡
[
$–em’t_Çme
])) {

1160 ià(
	`is£t
(
$po¡
[
$–em’t_Çme
 .'_x'])) {

1161  
$fÜm
['#return_value'];

1163  
NULL
;

1165 
$po¡
 = $po¡[
$–em’t_Çme
];

1167  
$fÜm
['#return_value'];

1170 
	}
}

1184 
funùiÚ
 
	$fÜm_ty³_checkbox_v®ue
(
$fÜm
, 
$ed™
 = 
FALSE
) {

1185 ià(
$ed™
 !=ğ
FALSE
) {

1186 ià(
	`em±y
(
$fÜm
['#disabled'])) {

1187  !
	`em±y
(
$ed™
è? 
$fÜm
['#return_value'] : 0;

1190  
$fÜm
['#default_value'];

1193 
	}
}

1207 
funùiÚ
 
	$fÜm_ty³_checkboxes_v®ue
(
$fÜm
, 
$ed™
 = 
FALSE
) {

1208 ià(
$ed™
 ==ğ
FALSE
) {

1209 
$v®ue
 = 
	`¬¿y
();

1210 
$fÜm
 +ğ
	`¬¿y
('#default_value' =>‡rray());

1211 
	`fÜ—ch
 (
$fÜm
['#deçuÉ_v®ue'] 
as
 
$key
) {

1212 
$v®ue
[
$key
] = 1;

1214  
$v®ue
;

1216 
	`–£if
 (!
	`is£t
(
$ed™
)) {

1217  
	`¬¿y
();

1219 
	}
}

1234 
funùiÚ
 
	$fÜm_ty³_·sswÜd_cÚfœm_v®ue
(
$fÜm
, 
$ed™
 = 
FALSE
) {

1235 ià(
$ed™
 ==ğ
FALSE
) {

1236 
$fÜm
 +ğ
	`¬¿y
('#default_value' =>‡rray());

1237  
$fÜm
['#deçuÉ_v®ue'] + 
	`¬¿y
('pass1' => '', 'pass2' => '');

1239 
	}
}

1253 
funùiÚ
 
	$fÜm_ty³_£Ëù_v®ue
(
$fÜm
, 
$ed™
 = 
FALSE
) {

1254 ià(
$ed™
 !=ğ
FALSE
) {

1255 ià(
	`is£t
(
$fÜm
['#multiple']) && $form['#multiple']) {

1256  (
	`is_¬¿y
(
$ed™
)è? 
	`dru·l_m­_assoc
($ed™è: 
	`¬¿y
();

1259  
$ed™
;

1262 
	}
}

1276 
funùiÚ
 
	$fÜm_ty³_‹xtf›ld_v®ue
(
$fÜm
, 
$ed™
 = 
FALSE
) {

1277 ià(
$ed™
 !=ğ
FALSE
) {

1280  
	`¡r_»¶aû
(
	`¬¿y
("\r", "\n"), '', 
$ed™
);

1282 
	}
}

1296 
funùiÚ
 
	$fÜm_ty³_tok’_v®ue
(
$fÜm
, 
$ed™
 = 
FALSE
) {

1297 ià(
$ed™
 !=ğ
FALSE
) {

1298  (
¡ršg
)
$ed™
;

1300 
	}
}

1325 
funùiÚ
 
	$fÜm_£t_v®ue
(
$fÜm_™em
, 
$v®ue
, &
$fÜm_¡©e
) {

1326 
	`_fÜm_£t_v®ue
(
$fÜm_¡©e
['v®ues'], 
$fÜm_™em
, $fÜm_™em['#·»Ás'], 
$v®ue
);

1327 
	}
}

1336 
funùiÚ
 
	$_fÜm_£t_v®ue
(&
$fÜm_v®ues
, 
$fÜm_™em
, 
$·»Ás
, 
$v®ue
) {

1337 
$·»Á
 = 
	`¬¿y_shiá
(
$·»Ás
);

1338 ià(
	`em±y
(
$·»Ás
)) {

1339 
$fÜm_v®ues
[
$·»Á
] = 
$v®ue
;

1342 ià(!
	`is£t
(
$fÜm_v®ues
[
$·»Á
])) {

1343 
$fÜm_v®ues
[
$·»Á
] = 
	`¬¿y
();

1345 
	`_fÜm_£t_v®ue
(
$fÜm_v®ues
[
$·»Á
], 
$fÜm_™em
, 
$·»Ás
, 
$v®ue
);

1347 
	}
}

1352 
funùiÚ
 
	$_–em’t_šfo
(
$ty³
, 
$»äesh
 = 
NULL
) {

1353 
$ÿche
;

1355 
$basic_deçuÉs
 = 
	`¬¿y
(

1356 '#desütiÚ' => 
NULL
,

1357 '#©Œibu‹s' => 
	`¬¿y
(),

1358 '#»quœed' => 
FALSE
,

1359 '#Œ“' => 
FALSE
,

1360 '#·»Ás' => 
	`¬¿y
()

1362 ià(!
	`is£t
(
$ÿche
è|| 
$»äesh
) {

1363 
$ÿche
 = 
	`¬¿y
();

1364 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('–em’ts'è
as
 
$moduË
) {

1365 
$–em’ts
 = 
	`moduË_švoke
(
$moduË
, 'elements');

1366 ià(
	`is£t
(
$–em’ts
è&& 
	`is_¬¿y
($elements)) {

1367 
$ÿche
 = 
	`¬¿y_m”ge_»cursive
($ÿche, 
$–em’ts
);

1370 ià((
$ÿche
)) {

1371 
	`fÜ—ch
 (
$ÿche
 
as
 
$–em’t_ty³
 => 
$šfo
) {

1372 
$ÿche
[
$–em’t_ty³
] = 
	`¬¿y_m”ge_»cursive
(
$basic_deçuÉs
, 
$šfo
);

1377  
$ÿche
[
$ty³
];

1378 
	}
}

1380 
funùiÚ
 
	$fÜm_İtiÚs_æ©‹n
(
$¬¿y
, 
$»£t
 = 
TRUE
) {

1381 
$»tuº
;

1383 ià(
$»£t
) {

1384 
$»tuº
 = 
	`¬¿y
();

1387 
	`fÜ—ch
 (
$¬¿y
 
as
 
$key
 => 
$v®ue
) {

1388 ià(
	`is_objeù
(
$v®ue
)) {

1389 
	`fÜm_İtiÚs_æ©‹n
(
$v®ue
->
İtiÚ
, 
FALSE
);

1391 ià(
	`is_¬¿y
(
$v®ue
)) {

1392 
	`fÜm_İtiÚs_æ©‹n
(
$v®ue
, 
FALSE
);

1395 
$»tuº
[
$key
] = 1;

1399  
$»tuº
;

1400 
	}
}

1417 
funùiÚ
 
	$theme_£Ëù
(
$–em’t
) {

1418 
$£Ëù
 = '';

1419 
$size
 = 
$–em’t
['#size'] ? ' size="'. $element['#size'] .'"' : '';

1420 
	`_fÜm_£t_şass
(
$–em’t
, 
	`¬¿y
('form-select'));

1421 
$muÉË
 = 
$–em’t
['#multiple'];

1422  
	`theme
('fÜm_–em’t', 
$–em’t
, '<£Ëù‚ame="'. $–em’t['#Çme'] .''. (
$muÉË
 ? '[]' : ''è.'"'. ($muÉË ? ' muÉË="muÉË" ' : ''è. 
	`dru·l_©Œibu‹s
($–em’t['#©Œibu‹s']è.' id="'. $–em’t['#id'] .'" '. 
$size
 .'>'. 
	`fÜm_£Ëù_İtiÚs
($element) .'</select>');

1423 
	}
}

1425 
funùiÚ
 
	$fÜm_£Ëù_İtiÚs
(
$–em’t
, 
$choiûs
 = 
NULL
) {

1426 ià(!
	`is£t
(
$choiûs
)) {

1427 
$choiûs
 = 
$–em’t
['#options'];

1431 
$v®ue_v®id
 = 
	`is£t
(
$–em’t
['#v®ue']è|| 
	`¬¿y_key_exi¡s
('#value', $element);

1432 
$v®ue_is_¬¿y
 = 
	`is_¬¿y
(
$–em’t
['#value']);

1433 
$İtiÚs
 = '';

1434 
	`fÜ—ch
 (
$choiûs
 
as
 
$key
 => 
$choiû
) {

1435 ià(
	`is_¬¿y
(
$choiû
)) {

1436 
$İtiÚs
 .ğ'<İtgrou°Ïb–="'. 
$key
 .'">';

1437 
$İtiÚs
 .ğ
	`fÜm_£Ëù_İtiÚs
(
$–em’t
, 
$choiû
);

1438 
$İtiÚs
 .= '</optgroup>';

1440 
	`–£if
 (
	`is_objeù
(
$choiû
)) {

1441 
$İtiÚs
 .ğ
	`fÜm_£Ëù_İtiÚs
(
$–em’t
, 
$choiû
->
İtiÚ
);

1444 
$key
 = (
¡ršg
)$key;

1445 ià(
$v®ue_v®id
 && (!
$v®ue_is_¬¿y
 && (
¡ršg
)
$–em’t
['#v®ue'] ==ğ
$key
 || ($v®ue_is_¬¿y && 
	`š_¬¿y
($key, $element['#value'])))) {

1446 
$£Ëùed
 = ' selected="selected"';

1449 
$£Ëùed
 = '';

1451 
$İtiÚs
 .ğ'<İtiÚ v®ue="'. 
	`check_¶aš
(
$key
è.'"'. 
$£Ëùed
 .'>'. check_¶aš(
$choiû
) .'</option>';

1454  
$İtiÚs
;

1455 
	}
}

1489 
funùiÚ
 
	$fÜm_g‘_İtiÚs
(
$–em’t
, 
$key
) {

1490 
$keys
 = 
	`¬¿y
();

1491 
	`fÜ—ch
 (
$–em’t
['#İtiÚs'] 
as
 
$šdex
 => 
$choiû
) {

1492 ià(
	`is_¬¿y
(
$choiû
)) {

1493  
FALSE
;

1495 ià(
	`is_objeù
(
$choiû
)) {

1496 ià(
	`is£t
(
$choiû
->
İtiÚ
[
$key
])) {

1497 
$keys
[] = 
$šdex
;

1500 ià(
$šdex
 =ğ
$key
) {

1501 
$keys
[] = 
$šdex
;

1504  
$keys
;

1505 
	}
}

1518 
funùiÚ
 
	$theme_f›ld£t
(
$–em’t
) {

1519 ià(!
	`em±y
(
$–em’t
['#collapsible'])) {

1520 
	`dru·l_add_js
('misc/collapse.js');

1522 ià(!
	`is£t
(
$–em’t
['#attributes']['class'])) {

1523 
$–em’t
['#attributes']['class'] = '';

1526 
$–em’t
['#attributes']['class'] .= ' collapsible';

1527 ià(!
	`em±y
(
$–em’t
['#collapsed'])) {

1528 
$–em’t
['#attributes']['class'] .= ' collapsed';

1532  '<f›ld£t'. 
	`dru·l_©Œibu‹s
(
$–em’t
['#©Œibu‹s']è.'>'. ($–em’t['#t™Ë'] ? '<Ëg’d>'. $–em’t['#t™Ë'] .'</Ëg’d>' : ''è. (
	`is£t
($–em’t['#desütiÚ']è&& $–em’t['#desütiÚ'] ? '<div cÏss="desütiÚ">'. $–em’t['#desütiÚ'] .'</div>' : ''è. (!
	`em±y
($element['#children']) ? $element['#children'] : '') . (isset($element['#value']) ? $element['#value'] : '') ."</fieldset>\n";

1533 
	}
}

1546 
funùiÚ
 
	$theme_¿dio
(
$–em’t
) {

1547 
	`_fÜm_£t_şass
(
$–em’t
, 
	`¬¿y
('form-radio'));

1548 
$ouut
 = '<inputype="radio" ';

1549 
$ouut
 .ğ'id="'. 
$–em’t
['#id'] .'" ';

1550 
$ouut
 .ğ'Çme="'. 
$–em’t
['#name'] .'" ';

1551 
$ouut
 .ğ'v®ue="'. 
$–em’t
['#return_value'] .'" ';

1552 
$ouut
 .ğ(
	`check_¶aš
(
$–em’t
['#value']) == $element['#return_value']) ? ' checked="checked" ' : ' ';

1553 
$ouut
 .ğ
	`dru·l_©Œibu‹s
(
$–em’t
['#attributes']) .' />';

1554 ià(!
	`is_nuÎ
(
$–em’t
['#title'])) {

1555 
$ouut
 = '<Ïb– cÏss="İtiÚ" fÜ="'. 
$–em’t
['#id'] .'">'. $output .' '. $element['#title'] .'</label>';

1558 
	`un£t
(
$–em’t
['#title']);

1559  
	`theme
('fÜm_–em’t', 
$–em’t
, 
$ouut
);

1560 
	}
}

1573 
funùiÚ
 
	$theme_¿dios
(
$–em’t
) {

1574 
$şass
 = 'form-radios';

1575 ià(
	`is£t
(
$–em’t
['#attributes']['class'])) {

1576 
$şass
 .ğ' '. 
$–em’t
['#attributes']['class'];

1578 
$–em’t
['#chd»n'] = '<div cÏss="'. 
$şass
 .'">'. (!
	`em±y
($element['#children']) ? $element['#children'] : '') .'</div>';

1579 ià(
$–em’t
['#title'] || $element['#description']) {

1580 
	`un£t
(
$–em’t
['#id']);

1581  
	`theme
('fÜm_–em’t', 
$–em’t
, $element['#children']);

1584  
$–em’t
['#children'];

1586 
	}
}

1599 
funùiÚ
 
	$theme_·sswÜd_cÚfœm
(
$–em’t
) {

1600  
	`theme
('fÜm_–em’t', 
$–em’t
, $element['#children']);

1601 
	}
}

1606 
funùiÚ
 
	$ex·nd_·sswÜd_cÚfœm
(
$–em’t
) {

1607 
$–em’t
['·ss1'] = 
	`¬¿y
(

1609 '#t™Ë' => 
	`t
('Password'),

1610 '#v®ue' => 
	`em±y
(
$–em’t
['#v®ue']è? 
NULL
 : $element['#value']['pass1'],

1611 '#»quœed' => 
$–em’t
['#required'],

1612 '#©Œibu‹s' => 
	`¬¿y
('class' => 'password-field'),

1614 
$–em’t
['·ss2'] = 
	`¬¿y
(

1616 '#t™Ë' => 
	`t
('Confirm…assword'),

1617 '#v®ue' => 
	`em±y
(
$–em’t
['#v®ue']è? 
NULL
 : $element['#value']['pass2'],

1618 '#»quœed' => 
$–em’t
['#required'],

1619 '#©Œibu‹s' => 
	`¬¿y
('class' => 'password-confirm'),

1621 
$–em’t
['#–em’t_v®id©e'] = 
	`¬¿y
('password_confirm_validate');

1622 
$–em’t
['#Œ“'] = 
TRUE
;

1624 ià(
	`is£t
(
$–em’t
['#size'])) {

1625 
$–em’t
['pass1']['#size'] = $element['pass2']['#size'] = $element['#size'];

1628  
$–em’t
;

1629 
	}
}

1634 
funùiÚ
 
	$·sswÜd_cÚfœm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

1635 
$·ss1
 = 
	`Œim
(
$fÜm
['pass1']['#value']);

1636 ià(!
	`em±y
(
$·ss1
)) {

1637 
$·ss2
 = 
	`Œim
(
$fÜm
['pass2']['#value']);

1638 ià(
	`¡rcmp
(
$·ss1
, 
$·ss2
)) {

1639 
	`fÜm_”rÜ
(
$fÜm
, 
	`t
('The specified…asswords do‚ot match.'));

1642 
	`–£if
 (
$fÜm
['#»quœed'] && !
	`em±y
($form['#post'])) {

1643 
	`fÜm_”rÜ
(
$fÜm
, 
	`t
('Password field is„equired.'));

1648 
	`fÜm_£t_v®ue
(
$fÜm
['·ss1'], 
NULL
, 
$fÜm_¡©e
);

1649 
	`fÜm_£t_v®ue
(
$fÜm
['·ss2'], 
NULL
, 
$fÜm_¡©e
);

1650 
	`fÜm_£t_v®ue
(
$fÜm
, 
$·ss1
, 
$fÜm_¡©e
);

1652  
$fÜm
;

1654 
	}
}

1667 
funùiÚ
 
	$theme_d©e
(
$–em’t
) {

1668  
	`theme
('fÜm_–em’t', 
$–em’t
, '<div class="container-inline">'. $element['#children'] .'</div>');

1669 
	}
}

1674 
funùiÚ
 
	$ex·nd_d©e
(
$–em’t
) {

1676 ià(
	`em±y
(
$–em’t
['#value'])) {

1677 
$–em’t
['#v®ue'] = 
	`¬¿y
('day' => 
	`fÜm©_d©e
(
	`time
(), 'custom', 'j'),

1678 'mÚth' => 
	`fÜm©_d©e
(
	`time
(), 'custom', 'n'),

1679 'y—r' => 
	`fÜm©_d©e
(
	`time
(), 'custom', 'Y'));

1682 
$–em’t
['#Œ“'] = 
TRUE
;

1685 
$fÜm©
 = 
	`v¬ŸbË_g‘
('date_format_short', 'm/d/Y - H:i');

1686 
$sÜt
 = 
	`¬¿y
();

1687 
$sÜt
['day'] = 
	`max
(
	`¡½os
(
$fÜm©
, 'd'), strpos($format, 'j'));

1688 
$sÜt
['mÚth'] = 
	`max
(
	`¡½os
(
$fÜm©
, 'm'), strpos($format, 'M'));

1689 
$sÜt
['y—r'] = 
	`¡½os
(
$fÜm©
, 'Y');

1690 
	`asÜt
(
$sÜt
);

1691 
$Üd”
 = 
	`¬¿y_keys
(
$sÜt
);

1694 
	`fÜ—ch
 (
$Üd”
 
as
 
$ty³
) {

1695 
$ty³
) {

1697 
$İtiÚs
 = 
	`dru·l_m­_assoc
(
	`¿nge
(1, 31));

1700 
$İtiÚs
 = 
	`dru·l_m­_assoc
(
	`¿nge
(1, 12), 'map_month');

1703 
$İtiÚs
 = 
	`dru·l_m­_assoc
(
	`¿nge
(1900, 2050));

1706 
$·»Ás
 = 
$–em’t
['#parents'];

1707 
$·»Ás
[] = 
$ty³
;

1708 
$–em’t
[
$ty³
] = 
	`¬¿y
(

1710 '#v®ue' => 
$–em’t
['#v®ue'][
$ty³
],

1711 '#©Œibu‹s' => 
$–em’t
['#attributes'],

1712 '#İtiÚs' => 
$İtiÚs
,

1716  
$–em’t
;

1717 
	}
}

1722 
funùiÚ
 
	$d©e_v®id©e
(
$fÜm
) {

1723 ià(!
	`checkd©e
(
$fÜm
['#value']['month'], $form['#value']['day'], $form['#value']['year'])) {

1724 
	`fÜm_”rÜ
(
$fÜm
, 
	`t
('The specified date is invalid.'));

1726 
	}
}

1731 
funùiÚ
 
	$m­_mÚth
(
$mÚth
) {

1732  
	`fÜm©_d©e
(
	`gmmktime
(0, 0, 0, 
$mÚth
, 2, 1970), 'custom', 'M', 0);

1733 
	}
}

1738 
funùiÚ
 
	$weight_v®ue
(&
$fÜm
) {

1739 ià(
	`is£t
(
$fÜm
['#default_value'])) {

1740 
$fÜm
['#value'] = $form['#default_value'];

1743 
$fÜm
['#value'] = 0;

1745 
	}
}

1751 
funùiÚ
 
	$ex·nd_¿dios
(
$–em’t
) {

1752 ià(
	`couÁ
(
$–em’t
['#options']) > 0) {

1753 
	`fÜ—ch
 (
$–em’t
['#İtiÚs'] 
as
 
$key
 => 
$choiû
) {

1754 ià(!
	`is£t
(
$–em’t
[
$key
])) {

1757 
$·»Ás_fÜ_id
 = 
	`¬¿y_m”ge
(
$–em’t
['#·»Ás'], 
	`¬¿y
(
$key
));

1758 
$–em’t
[
$key
] = 
	`¬¿y
(

1760 '#t™Ë' => 
$choiû
,

1761 '#»tuº_v®ue' => 
	`check_¶aš
(
$key
),

1762 '#deçuÉ_v®ue' => 
	`is£t
(
$–em’t
['#deçuÉ_v®ue']è? $–em’t['#deçuÉ_v®ue'] : 
NULL
,

1763 '#©Œibu‹s' => 
$–em’t
['#attributes'],

1764 '#·»Ás' => 
$–em’t
['#parents'],

1765 '#id' => 
	`fÜm_ş—n_id
('ed™-'. 
	`im¶ode
('-', 
$·»Ás_fÜ_id
)),

1766 '#ahah' => 
	`is£t
(
$–em’t
['#ahah']è? $–em’t['#ahah'] : 
NULL
,

1771  
$–em’t
;

1772 
	}
}

1788 
funùiÚ
 
	$fÜm_ex·nd_ahah
(
$–em’t
) {

1789 
$js_added
 = 
	`¬¿y
();

1791 ià(
	`is£t
(
$–em’t
['#ahah']['path']) && !isset($element['#ahah']['event'])) {

1792 
$–em’t
['#type']) {

1799 
$–em’t
['#ahah']['event'] = 'mousedown';

1802 
$–em’t
['#ahah']['key´ess'] = 
TRUE
;

1807 
$–em’t
['#ahah']['event'] = 'blur';

1812 
$–em’t
['#ahah']['event'] = 'change';

1819 ià(
	`is£t
(
$–em’t
['#ahah']['·th']è&& is£t($–em’t['#ahah']['ev’t']è&& !is£t(
$js_added
[$element['#id']])) {

1820 
	`dru·l_add_js
('misc/jquery.form.js');

1821 
	`dru·l_add_js
('misc/ahah.js');

1823 
$ahah_bšdšg
 = 
	`¬¿y
(

1824 'u¾' => 
	`u¾
(
$–em’t
['#ahah']['path']),

1825 'ev’t' => 
$–em’t
['#ahah']['event'],

1826 'key´ess' => 
	`em±y
(
$–em’t
['#ahah']['key´ess']è? 
NULL
 : $element['#ahah']['keypress'],

1827 'w¿µ”' => 
	`em±y
(
$–em’t
['#ahah']['w¿µ”']è? 
NULL
 : $element['#ahah']['wrapper'],

1828 '£ËùÜ' => 
	`em±y
(
$–em’t
['#ahah']['selector']) ? '#'. $element['#id'] : $element['#ahah']['selector'],

1829 'efãù' => 
	`em±y
(
$–em’t
['#ahah']['effect']) ? 'none' : $element['#ahah']['effect'],

1830 'm‘hod' => 
	`em±y
(
$–em’t
['#ahah']['method']) ? 'replace' : $element['#ahah']['method'],

1831 '´og»ss' => 
	`em±y
(
$–em’t
['#ahah']['´og»ss']è? 
	`¬¿y
('type' => 'throbber') : $element['#ahah']['progress'],

1832 'bu‰Ú' => 
	`is£t
(
$–em’t
['#execu‹s_subm™_ÿÎback']è? 
	`¬¿y
($–em’t['#Çme'] => $–em’t['#v®ue']è: 
FALSE
,

1836 ià(
	`is_¡ršg
(
$ahah_bšdšg
['progress'])) {

1837 
$ahah_bšdšg
['´og»ss'] = 
	`¬¿y
('type' => $ahah_binding['progress']);

1840 ià(
	`is£t
(
$ahah_bšdšg
['progress']['path'])) {

1841 
$ahah_bšdšg
['´og»ss']['u¾'] = 
	`u¾
($ahah_binding['progress']['path']);

1845 ià(
$ahah_bšdšg
['progress']['type'] == 'bar') {

1846 
	`dru·l_add_js
('misc/progress.js');

1849 
	`dru·l_add_js
(
	`¬¿y
('ahah' =>‡¼ay(
$–em’t
['#id'] => 
$ahah_bšdšg
)), 'setting');

1851 
$js_added
[
$–em’t
['#id']] = 
TRUE
;

1852 
$–em’t
['#ÿche'] = 
TRUE
;

1854  
$–em’t
;

1855 
	}
}

1868 
funùiÚ
 
	$theme_™em
(
$–em’t
) {

1869  
	`theme
('fÜm_–em’t', 
$–em’t
, $–em’t['#v®ue'] . (!
	`em±y
($element['#children']) ? $element['#children'] : ''));

1870 
	}
}

1883 
funùiÚ
 
	$theme_checkbox
(
$–em’t
) {

1884 
	`_fÜm_£t_şass
(
$–em’t
, 
	`¬¿y
('form-checkbox'));

1885 
$checkbox
 = '<input ';

1886 
$checkbox
 .= 'type="checkbox" ';

1887 
$checkbox
 .ğ'Çme="'. 
$–em’t
['#name'] .'" ';

1888 
$checkbox
 .ğ'id="'. 
$–em’t
['#id'] .'" ' ;

1889 
$checkbox
 .ğ'v®ue="'. 
$–em’t
['#return_value'] .'" ';

1890 
$checkbox
 .ğ
$–em’t
['#value'] ? ' checked="checked" ' : ' ';

1891 
$checkbox
 .ğ
	`dru·l_©Œibu‹s
(
$–em’t
['#attributes']) .' />';

1893 ià(!
	`is_nuÎ
(
$–em’t
['#title'])) {

1894 
$checkbox
 = '<Ïb– cÏss="İtiÚ" fÜ="'. 
$–em’t
['#id'] .'">'. $checkbox .' '. $element['#title'] .'</label>';

1897 
	`un£t
(
$–em’t
['#title']);

1898  
	`theme
('fÜm_–em’t', 
$–em’t
, 
$checkbox
);

1899 
	}
}

1911 
funùiÚ
 
	$theme_checkboxes
(
$–em’t
) {

1912 
$şass
 = 'form-checkboxes';

1913 ià(
	`is£t
(
$–em’t
['#attributes']['class'])) {

1914 
$şass
 .ğ' '. 
$–em’t
['#attributes']['class'];

1916 
$–em’t
['#chd»n'] = '<div cÏss="'. 
$şass
 .'">'. (!
	`em±y
($element['#children']) ? $element['#children'] : '') .'</div>';

1917 ià(
$–em’t
['#title'] || $element['#description']) {

1918 
	`un£t
(
$–em’t
['#id']);

1919  
	`theme
('fÜm_–em’t', 
$–em’t
, $element['#children']);

1922  
$–em’t
['#children'];

1924 
	}
}

1926 
funùiÚ
 
	$ex·nd_checkboxes
(
$–em’t
) {

1927 
$v®ue
 = 
	`is_¬¿y
(
$–em’t
['#v®ue']è? $–em’t['#v®ue'] : 
	`¬¿y
();

1928 
$–em’t
['#Œ“'] = 
TRUE
;

1929 ià(
	`couÁ
(
$–em’t
['#options']) > 0) {

1930 ià(!
	`is£t
(
$–em’t
['#default_value']) || $element['#default_value'] == 0) {

1931 
$–em’t
['#deçuÉ_v®ue'] = 
	`¬¿y
();

1933 
	`fÜ—ch
 (
$–em’t
['#İtiÚs'] 
as
 
$key
 => 
$choiû
) {

1934 ià(!
	`is£t
(
$–em’t
[
$key
])) {

1935 
$–em’t
[
$key
] = 
	`¬¿y
(

1937 '#´oûs£d' => 
TRUE
,

1938 '#t™Ë' => 
$choiû
,

1939 '#»tuº_v®ue' => 
$key
,

1940 '#deçuÉ_v®ue' => 
	`is£t
(
$v®ue
[
$key
]),

1941 '#©Œibu‹s' => 
$–em’t
['#attributes'],

1942 '#ahah' => 
	`is£t
(
$–em’t
['#ahah']è? $–em’t['#ahah'] : 
NULL
,

1947  
$–em’t
;

1948 
	}
}

1955 
funùiÚ
 
	$theme_subm™
(
$–em’t
) {

1956  
	`theme
('bu‰Ú', 
$–em’t
);

1957 
	}
}

1964 
funùiÚ
 
	$theme_bu‰Ú
(
$–em’t
) {

1966 ià(
	`is£t
(
$–em’t
['#attributes']['class'])) {

1967 
$–em’t
['#attributes']['class'] = 'form-'. $element['#button_type'] .' '. $element['#attributes']['class'];

1970 
$–em’t
['#attributes']['class'] = 'form-'. $element['#button_type'];

1973  '<špuˆty³="subm™" '. (
	`em±y
(
$–em’t
['#Çme']è? '' : 'Çme="'. $–em’t['#Çme'] .'" 'è.'id="'. $–em’t['#id'] .'" v®ue="'. 
	`check_¶aš
($–em’t['#v®ue']è.'" '. 
	`dru·l_©Œibu‹s
($element['#attributes']) ." />\n";

1974 
	}
}

1981 
funùiÚ
 
	$theme_image_bu‰Ú
(
$–em’t
) {

1983 ià(
	`is£t
(
$–em’t
['#attributes']['class'])) {

1984 
$–em’t
['#attributes']['class'] = 'form-'. $element['#button_type'] .' '. $element['#attributes']['class'];

1987 
$–em’t
['#attributes']['class'] = 'form-'. $element['#button_type'];

1990  '<špuˆty³="image"‚ame="'. 
$–em’t
['#name'] .'" '.

1991 (!
	`em±y
(
$–em’t
['#v®ue']è? ('v®ue="'. 
	`check_¶aš
($element['#value']) .'" ') : '') .

1992 'id="'. 
$–em’t
['#id'] .'" '.

1993 
	`dru·l_©Œibu‹s
(
$–em’t
['#attributes']) .

1994 ' src="'. 
	`ba£_·th
(è. 
$–em’t
['#src'] .'" '.

1995 (!
	`em±y
(
$–em’t
['#t™Ë']è? '®t="'. 
	`check_¶aš
($element['#title']) .'"itle="'. check_plain($element['#title']) .'" ' : '' ) .

1997 
	}
}

2010 
funùiÚ
 
	$theme_hidd’
(
$–em’t
) {

2011  '<špuˆty³="hidd’"‚ame="'. 
$–em’t
['#Çme'] .'" id="'. $–em’t['#id'] .'" v®ue="'. 
	`check_¶aš
($–em’t['#v®ue']è."\" ". 
	`dru·l_©Œibu‹s
($element['#attributes']) ." />\n";

2012 
	}
}

2019 
funùiÚ
 
	$theme_tok’
(
$–em’t
) {

2020  
	`theme
('hidd’', 
$–em’t
);

2021 
	}
}

2034 
funùiÚ
 
	$theme_‹xtf›ld
(
$–em’t
) {

2035 
$size
 = 
	`em±y
(
$–em’t
['#size']) ? '' : ' size="'. $element['#size'] .'"';

2036 
$maxËngth
 = 
	`em±y
(
$–em’t
['#maxlength']) ? '' : ' maxlength="'. $element['#maxlength'] .'"';

2037 
$şass
 = 
	`¬¿y
('form-text');

2038 
$exŒa
 = '';

2039 
$ouut
 = '';

2041 ià(
$–em’t
['#autocom¶‘e_·th'] && 
	`m’u_v®id_·th
(
	`¬¿y
('link_path' => $element['#autocomplete_path']))) {

2042 
	`dru·l_add_js
('misc/autocomplete.js');

2043 
$şass
[] = 'form-autocomplete';

2044 
$exŒa
 = '<špuˆşass="autocom¶‘e"y³="hidd’" id="'. 
$–em’t
['#id'] .'-autocom¶‘e" v®ue="'. 
	`check_u¾
(
	`u¾
($–em’t['#autocom¶‘e_·th'], 
	`¬¿y
('absŞu‹' => 
TRUE
))) .'" disabled="disabled" />';

2046 
	`_fÜm_£t_şass
(
$–em’t
, 
$şass
);

2048 ià(
	`is£t
(
$–em’t
['#field_prefix'])) {

2049 
$ouut
 .ğ'<¥ª cÏss="f›ld-´efix">'. 
$–em’t
['#field_prefix'] .'</span> ';

2052 
$ouut
 .ğ'<špuˆty³="‹xt"'. 
$maxËngth
 .'‚ame="'. 
$–em’t
['#Çme'] .'" id="'. $–em’t['#id'] .'"'. 
$size
 .' v®ue="'. 
	`check_¶aš
($–em’t['#v®ue']è.'"'. 
	`dru·l_©Œibu‹s
($element['#attributes']) .' />';

2054 ià(
	`is£t
(
$–em’t
['#field_suffix'])) {

2055 
$ouut
 .ğ' <¥ª cÏss="f›ld-suffix">'. 
$–em’t
['#field_suffix'] .'</span>';

2058  
	`theme
('fÜm_–em’t', 
$–em’t
, 
$ouut
è. 
$exŒa
;

2059 
	}
}

2072 
funùiÚ
 
	$theme_fÜm
(
$–em’t
) {

2074 
$aùiÚ
 = 
$–em’t
['#aùiÚ'] ? 'aùiÚ="'. 
	`check_u¾
($element['#action']) .'" ' : '';

2075  '<fÜm '. 
$aùiÚ
 .'‡cû±-ch¬£t="UTF-8" m‘hod="'. 
$–em’t
['#m‘hod'] .'" id="'. $–em’t['#id'] .'"'. 
	`dru·l_©Œibu‹s
($element['#attributes']) .">\n<div>". $element['#children'] ."\n</div></form>\n";

2076 
	}
}

2089 
funùiÚ
 
	$theme_‹x»a
(
$–em’t
) {

2090 
$şass
 = 
	`¬¿y
('form-textarea');

2093 ià(!
	`em±y
(
$–em’t
['#teaser'])) {

2094 
	`dru·l_add_js
('misc/teaser.js');

2096 
	`dru·l_add_js
(
	`¬¿y
('‹a£rCheckbox' =>‡¼ay(
$–em’t
['#id'] => $element['#teaser_checkbox'])), 'setting');

2097 
	`dru·l_add_js
(
	`¬¿y
('‹a£r' =>‡¼ay(
$–em’t
['#id'] => $element['#teaser'])), 'setting');

2098 
$şass
[] = 'teaser';

2102 ià(
$–em’t
['#»sizabË'] !=ğ
FALSE
) {

2103 
	`dru·l_add_js
('misc/textarea.js');

2104 
$şass
[] = 'resizable';

2107 
	`_fÜm_£t_şass
(
$–em’t
, 
$şass
);

2108  
	`theme
('fÜm_–em’t', 
$–em’t
, '<‹x»¨cŞs="'. $–em’t['#cŞs'] .'"„ows="'. $–em’t['#rows'] .'"‚ame="'. $–em’t['#Çme'] .'" id="'. $–em’t['#id'] .'" '. 
	`dru·l_©Œibu‹s
($–em’t['#©Œibu‹s']è.'>'. 
	`check_¶aš
($element['#value']) .'</textarea>');

2109 
	}
}

2125 
funùiÚ
 
	$theme_m¬kup
(
$–em’t
) {

2126  (
	`is£t
(
$–em’t
['#value']) ? $element['#value'] : '') . (isset($element['#children']) ? $element['#children'] : '');

2127 
	}
}

2140 
funùiÚ
 
	$theme_·sswÜd
(
$–em’t
) {

2141 
$size
 = 
$–em’t
['#size'] ? ' size="'. $element['#size'] .'" ' : '';

2142 
$maxËngth
 = 
$–em’t
['#maxlength'] ? ' maxlength="'. $element['#maxlength'] .'" ' : '';

2144 
	`_fÜm_£t_şass
(
$–em’t
, 
	`¬¿y
('form-text'));

2145 
$ouut
 = '<špuˆty³="·sswÜd"‚ame="'. 
$–em’t
['#Çme'] .'" id="'. $–em’t['#id'] .'" '. 
$maxËngth
 . 
$size
 . 
	`dru·l_©Œibu‹s
($element['#attributes']) .' />';

2146  
	`theme
('fÜm_–em’t', 
$–em’t
, 
$ouut
);

2147 
	}
}

2152 
funùiÚ
 
	$´oûss_weight
(
$–em’t
) {

2153 
$n
 = (-1 * 
$–em’t
['#delta']); $n <= $element['#delta']; $n++) {

2154 
$weights
[
$n
] = $n;

2156 
$–em’t
['#İtiÚs'] = 
$weights
;

2157 
$–em’t
['#type'] = 'select';

2158 
$–em’t
['#is_weight'] = 
TRUE
;

2159 
$–em’t
 +ğ
	`_–em’t_šfo
('select');

2160  
$–em’t
;

2161 
	}
}

2184 
funùiÚ
 
	$theme_fe
(
$–em’t
) {

2185 
	`_fÜm_£t_şass
(
$–em’t
, 
	`¬¿y
('form-file'));

2186  
	`theme
('fÜm_–em’t', 
$–em’t
, '<špuˆty³="fe"‚ame="'. $–em’t['#Çme'] .'"'. ($–em’t['#©Œibu‹s'] ? ' '. 
	`dru·l_©Œibu‹s
($element['#attributes']) : '') .' id="'. $element['#id'] .'" size="'. $element['#size'] ."\" />\n");

2187 
	}
}

2202 
funùiÚ
 
	$theme_fÜm_–em’t
(
$–em’t
, 
$v®ue
) {

2204 
$t
 = 
	`g‘_t
();

2206 
$ouut
 = '<div class="form-item"';

2207 ià(!
	`em±y
(
$–em’t
['#id'])) {

2208 
$ouut
 .ğ' id="'. 
$–em’t
['#id'] .'-wrapper"';

2210 
$ouut
 .= ">\n";

2211 
$»quœed
 = !
	`em±y
(
$–em’t
['#»quœed']è? '<¥ª cÏss="fÜm-»quœed"™Ë="'. 
	`$t
('This field is„equired.') .'">*</span>' : '';

2213 ià(!
	`em±y
(
$–em’t
['#title'])) {

2214 
$t™Ë
 = 
$–em’t
['#title'];

2215 ià(!
	`em±y
(
$–em’t
['#id'])) {

2216 
$ouut
 .ğ' <Ïb– fÜ="'. 
$–em’t
['#id'] .'">'. 
	`$t
('!t™Ë: !»quœed', 
	`¬¿y
('!t™Ë' => 
	`f‹r_xss_admš
(
$t™Ë
), '!»quœed' => 
$»quœed
)) ."</label>\n";

2219 
$ouut
 .ğ' <Ïb–>'. 
	`$t
('!t™Ë: !»quœed', 
	`¬¿y
('!t™Ë' => 
	`f‹r_xss_admš
(
$t™Ë
), '!»quœed' => 
$»quœed
)) ."</label>\n";

2223 
$ouut
 .= " $value\n";

2225 ià(!
	`em±y
(
$–em’t
['#description'])) {

2226 
$ouut
 .ğ' <div cÏss="desütiÚ">'. 
$–em’t
['#description'] ."</div>\n";

2229 
$ouut
 .= "</div>\n";

2231  
$ouut
;

2232 
	}
}

2244 
funùiÚ
 
_fÜm_£t_şass
(&
$–em’t
, 
$şass
 = 
	$¬¿y
()) {

2245 ià(
$–em’t
['#required']) {

2246 
$şass
[] = 'required';

2248 ià(
	`fÜm_g‘_”rÜ
(
$–em’t
)) {

2249 
$şass
[] = 'error';

2251 ià(
	`is£t
(
$–em’t
['#attributes']['class'])) {

2252 
$şass
[] = 
$–em’t
['#attributes']['class'];

2254 
$–em’t
['#©Œibu‹s']['şass'] = 
	`im¶ode
(' ', 
$şass
);

2255 
	}
}

2273 
funùiÚ
 
	$fÜm_ş—n_id
(
$id
 = 
NULL
, 
$æush
 = 
FALSE
) {

2274 
$£’_ids
 = 
	`¬¿y
();

2276 ià(
$æush
) {

2277 
$£’_ids
 = 
	`¬¿y
();

2280 
$id
 = 
	`¡r_»¶aû
(
	`¬¿y
('][', '_', ' '), '-', $id);

2288 ià(
	`is£t
(
$£’_ids
[
$id
])) {

2289 
$id
 = $id .'-'. 
$£’_ids
[$id]++;

2292 
$£’_ids
[
$id
] = 1;

2295  
$id
;

2296 
	}
}

2443 
funùiÚ
 
	$b©ch_£t
(
$b©ch_defš™iÚ
) {

2444 ià(
$b©ch_defš™iÚ
) {

2445 
$b©ch
 =& 
	`b©ch_g‘
();

2447 ià(
	`em±y
(
$b©ch
)) {

2448 
$b©ch
 = 
	`¬¿y
(

2449 '£ts' => 
	`¬¿y
(),

2453 
$š™
 = 
	`¬¿y
(

2454 '§ndbox' => 
	`¬¿y
(),

2455 '»suÉs' => 
	`¬¿y
(),

2456 'sucûss' => 
FALSE
,

2459 
$t
 = 
	`g‘_t
();

2460 
$deçuÉs
 = 
	`¬¿y
(

2461 't™Ë' => 
	`$t
('Processing'),

2462 'š™_mes§ge' => 
	`$t
('Initializing.'),

2463 '´og»ss_mes§ge' => 
	`$t
('Remaining @remaining of @total.'),

2464 '”rÜ_mes§ge' => 
	`$t
('Anƒrror has occurred.'),

2466 
$b©ch_£t
 = 
$š™
 + 
$b©ch_defš™iÚ
 + 
$deçuÉs
;

2469 
$b©ch_£t
['init_message'] .= '<br/>&nbsp;';

2470 
$b©ch_£t
['tÙ®'] = 
	`couÁ
($batch_set['operations']);

2474 ià(
	`is£t
(
$b©ch
['current_set'])) {

2476 
$¦iû1
 = 
	`¬¿y_¦iû
(
$b©ch
['sets'], 0, $batch['current_set'] + 1);

2477 
$¦iû2
 = 
	`¬¿y_¦iû
(
$b©ch
['sets'], $batch['current_set'] + 1);

2478 
$b©ch
['£ts'] = 
	`¬¿y_m”ge
(
$¦iû1
, 
	`¬¿y
(
$b©ch_£t
), 
$¦iû2
);

2481 
$b©ch
['£ts'][] = 
$b©ch_£t
;

2484 
	}
}

2501 
funùiÚ
 
	$b©ch_´oûss
(
$»dœeù
 = 
NULL
, 
$u¾
 = NULL) {

2502 
$b©ch
 =& 
	`b©ch_g‘
();

2504 ià(
	`is£t
(
$b©ch
)) {

2506 
$u¾
 = 
	`is£t
($url) ? $url : 'batch';

2507 
$´oûss_šfo
 = 
	`¬¿y
(

2509 '´og»ssive' => 
TRUE
,

2510 'u¾' => 
	`is£t
(
$u¾
) ? $url : 'batch',

2511 'sourû_·ge' => 
$_GET
['q'],

2512 '»dœeù' => 
$»dœeù
,

2514 
$b©ch
 +ğ
$´oûss_šfo
;

2516 ià(
$b©ch
['progressive']) {

2520 ià(
	`is£t
(
$_REQUEST
['destination'])) {

2521 
$b©ch
['de¡š©iÚ'] = 
$_REQUEST
['destination'];

2522 
	`un£t
(
$_REQUEST
['destination']);

2524 
	`–£if
 (
	`is£t
(
$_REQUEST
['edit']['destination'])) {

2525 
$b©ch
['de¡š©iÚ'] = 
$_REQUEST
['edit']['destination'];

2526 
	`un£t
(
$_REQUEST
['edit']['destination']);

2531 
	`db_qu”y
("INSERT INTO {b©ch} (tok’,ime¡ampèVALUES ('', %d)", 
	`time
());

2532 
$b©ch
['id'] = 
	`db_Ï¡_š£¹_id
('batch', 'bid');

2536 
$t
 = 
	`g‘_t
();

2537 
$b©ch
['”rÜ_mes§ge'] = 
	`$t
('PËa£ cÚtšutØ<¨h»f="@”rÜ_u¾">th”rÜ…age</a>', 
	`¬¿y
('@”rÜ_u¾' => 
	`u¾
(
$u¾
,‡rray('query' =>‡rray('id' => $batch['id'], 'op' => 'finished')))));

2540 
	`db_qu”y
("UPDATE {b©ch} SETok’ = '%s', b©ch = '%s' WHERE bid = %d", 
	`dru·l_g‘_tok’
(
$b©ch
['id']), 
	`£rŸlize
($batch), $batch['id']);

2542 
	`dru·l_gÙo
(
$b©ch
['url'], 'op=start&id='. $batch['id']);

2547 
»quœe_Úû
 './includes/batch.inc';

2548 
	`_b©ch_´oûss
();

2551 
	}
}

2556 
	gfunùiÚ
 &
	$b©ch_g‘
() {

2557 
$b©ch
 = 
	`¬¿y
();

2558  
$b©ch
;

2559 
	}
}

	@/srv/http/subs/notes/www/includes/image.gd.inc

1 <?
php


17 
funùiÚ
 
	$image_gd_šfo
() {

18  
	`¬¿y
('Çme' => 'gd', 't™Ë' => 
	`t
('GD2 image manipulationoolkit'));

19 
	}
}

24 
funùiÚ
 
	$image_gd_£‰šgs
() {

25 ià(
	`image_gd_check_£‰šgs
()) {

26 
$fÜm
 = 
	`¬¿y
();

27 
$fÜm
['¡©us'] = 
	`¬¿y
(

28 '#v®ue' => 
	`t
('The GDoolkit is installed‡nd working…roperly.')

31 
$fÜm
['image_j³g_qu®™y'] = 
	`¬¿y
(

33 '#t™Ë' => 
	`t
('JPEG quality'),

34 '#desütiÚ' => 
	`t
('Definehe image quality for JPEG manipulations. Ranges from 0o 100. Higher values mean better image quality but bigger files.'),

37 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('image_jpeg_quality', 75),

38 '#f›ld_suffix' => 
	`t
('%'),

40 
$fÜm
['#–em’t_v®id©e'] = 
	`¬¿y
('image_gd_settings_validate');

42  
$fÜm
;

45 
	`fÜm_£t_”rÜ
('image_toŞk™', 
	`t
('ThGD imagtoŞk™„equœe th©hGD moduË fÜ PHP bš¡®Ëd‡nd cÚfigu»d…rİ”ly. FÜ mÜšfÜm©iÚ s“ <¨h»f="@u¾">PHP\' imagdocum’tiÚ</a>.', 
	`¬¿y
('@url' => 'http://php.net/image')));

46  
FALSE
;

48 
	}
}

53 
funùiÚ
 
	$image_gd_£‰šgs_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

55 
$v®ue
 = 
$fÜm_¡©e
['values']['image_jpeg_quality'];

56 ià(!
	`is_num”ic
(
$v®ue
) || $value < 0 || $value > 100) {

57 
	`fÜm_£t_”rÜ
('image_j³g_qu®™y', 
	`t
('JPEG quality must be‡‚umber between 0‡nd 100.'));

59 
	}
}

67 
funùiÚ
 
	$image_gd_check_£‰šgs
() {

68 ià(
$check
 = 
	`g‘_ex‹nsiÚ_funcs
('gd')) {

69 ià(
	`š_¬¿y
('imagegd2', 
$check
)) {

71  
TRUE
;

74  
FALSE
;

75 
	}
}

80 
funùiÚ
 
	$image_gd_»size
(
$sourû
, 
$de¡š©iÚ
, 
$width
, 
$height
) {

81 ià(!
	`fe_exi¡s
(
$sourû
)) {

82  
FALSE
;

85 
$šfo
 = 
	`image_g‘_šfo
(
$sourû
);

86 ià(!
$šfo
) {

87  
FALSE
;

90 
$im
 = 
	`image_gd_İ’
(
$sourû
, 
$šfo
['extension']);

91 ià(!
$im
) {

92  
FALSE
;

95 
$»s
 = 
	`imageü—‹ŒuecŞÜ
(
$width
, 
$height
);

96 ià(
$šfo
['extension'] == 'png') {

97 
$Œª¥¬’cy
 = 
	`imagecŞÜ®loÿ‹®pha
(
$»s
, 0, 0, 0, 127);

98 
	`imag—ÍhabËndšg
(
$»s
, 
FALSE
);

99 
	`imagefËd»ùªgË
(
$»s
, 0, 0, 
$width
, 
$height
, 
$Œª¥¬’cy
);

100 
	`imag—ÍhabËndšg
(
$»s
, 
TRUE
);

101 
	`image§v—Íha
(
$»s
, 
TRUE
);

103 
	`–£if
 (
$šfo
['extension'] == 'gif') {

105 
$Œª¥¬’cy_šdex
 = 
	`imagecŞÜŒª¥¬’t
(
$im
);

106 ià(
$Œª¥¬’cy_šdex
 >= 0) {

108 
$Œª¥¬’t_cŞÜ
 = 
	`imagecŞÜsfÜšdex
(
$im
, 
$Œª¥¬’cy_šdex
);

110 
$Œª¥¬’cy_šdex
 = 
	`imagecŞÜ®loÿ‹
(
$»s
, 
$Œª¥¬’t_cŞÜ
['red'], $transparent_color['green'], $transparent_color['blue']);

112 
	`imagefl
(
$»s
, 0, 0, 
$Œª¥¬’cy_šdex
);

114 
	`imagecŞÜŒª¥¬’t
(
$»s
, 
$Œª¥¬’cy_šdex
);

116 
$numb”_cŞÜs
 = 
	`imagecŞÜ¡Ù®
(
$im
);

118 
	`imag‘ruecŞÜtİ®‘‹
(
$»s
, 
TRUE
, 
$numb”_cŞÜs
);

121 
	`imagecİy»§m¶ed
(
$»s
, 
$im
, 0, 0, 0, 0, 
$width
, 
$height
, 
$šfo
['width'], $info['height']);

122 
$»suÉ
 = 
	`image_gd_şo£
(
$»s
, 
$de¡š©iÚ
, 
$šfo
['extension']);

124 
	`imagede¡roy
(
$»s
);

125 
	`imagede¡roy
(
$im
);

127  
$»suÉ
;

128 
	}
}

133 
funùiÚ
 
	$image_gd_rÙ©e
(
$sourû
, 
$de¡š©iÚ
, 
$deg»es
, 
$background
 = 0x000000) {

134 ià(!
	`funùiÚ_exi¡s
('imageRotate')) {

135  
FALSE
;

138 
$šfo
 = 
	`image_g‘_šfo
(
$sourû
);

139 ià(!
$šfo
) {

140  
FALSE
;

143 
$im
 = 
	`image_gd_İ’
(
$sourû
, 
$šfo
['extension']);

144 ià(!
$im
) {

145  
FALSE
;

148 
$»s
 = 
	`imageRÙ©e
(
$im
, 
$deg»es
, 
$background
);

149 
$»suÉ
 = 
	`image_gd_şo£
(
$»s
, 
$de¡š©iÚ
, 
$šfo
['extension']);

151  
$»suÉ
;

152 
	}
}

157 
funùiÚ
 
	$image_gd_üİ
(
$sourû
, 
$de¡š©iÚ
, 
$x
, 
$y
, 
$width
, 
$height
) {

158 
$šfo
 = 
	`image_g‘_šfo
(
$sourû
);

159 ià(!
$šfo
) {

160  
FALSE
;

163 
$im
 = 
	`image_gd_İ’
(
$sourû
, 
$šfo
['extension']);

164 
$»s
 = 
	`imageC»©eTrueCŞÜ
(
$width
, 
$height
);

165 
	`imageCİy
(
$»s
, 
$im
, 0, 0, 
$x
, 
$y
, 
$width
, 
$height
);

166 
$»suÉ
 = 
	`image_gd_şo£
(
$»s
, 
$de¡š©iÚ
, 
$šfo
['extension']);

168 
	`imageDe¡roy
(
$»s
);

169 
	`imageDe¡roy
(
$im
);

171  
$»suÉ
;

172 
	}
}

184 
funùiÚ
 
	$image_gd_İ’
(
$fe
, 
$ex‹nsiÚ
) {

185 
$ex‹nsiÚ
 = 
	`¡r_»¶aû
('jpg', 'jpeg', $extension);

186 
$İ’_func
 = 'imageC»©eFrom'. 
$ex‹nsiÚ
;

187 ià(!
	`funùiÚ_exi¡s
(
$İ’_func
)) {

188  
FALSE
;

190  
	`$İ’_func
(
$fe
);

191 
	}
}

205 
funùiÚ
 
	$image_gd_şo£
(
$»s
, 
$de¡š©iÚ
, 
$ex‹nsiÚ
) {

206 
$ex‹nsiÚ
 = 
	`¡r_»¶aû
('jpg', 'jpeg', $extension);

207 
$şo£_func
 = 'image'. 
$ex‹nsiÚ
;

208 ià(!
	`funùiÚ_exi¡s
(
$şo£_func
)) {

209  
FALSE
;

211 ià(
$ex‹nsiÚ
 == 'jpeg') {

212  
	`$şo£_func
(
$»s
, 
$de¡š©iÚ
, 
	`v¬ŸbË_g‘
('image_jpeg_quality', 75));

215  
	`$şo£_func
(
$»s
, 
$de¡š©iÚ
);

217 
	}
}

	@/srv/http/subs/notes/www/includes/image.inc

1 <?
php


39 
funùiÚ
 
	$image_g‘_avaabË_toŞk™s
() {

40 
$toŞk™s
 = 
	`fe_sÿn_dœeùÜy
('includes', 'image\..*\.inc$');

42 
$ouut
 = 
	`¬¿y
();

43 
	`fÜ—ch
 (
$toŞk™s
 
as
 
$fe
 => 
$toŞk™
) {

44 
šşude_Úû
 "./$file";

45 
$funùiÚ
 = 
	`¡r_»¶aû
('.', '_', 
$toŞk™
->
Çme
) .'_info';

46 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

47 
$šfo
 = 
	`$funùiÚ
();

48 
$ouut
[
$šfo
['name']] = $info['title'];

52  
$ouut
;

53 
	}
}

61 
funùiÚ
 
	$image_g‘_toŞk™
() {

62 
$toŞk™
;

64 ià(!
$toŞk™
) {

65 
$toŞk™
 = 
	`v¬ŸbË_g‘
('image_toolkit', 'gd');

66 
$toŞk™_fe
 = './šşudes/image.'. 
$toŞk™
 .'.inc';

67 ià(
	`is£t
(
$toŞk™
è&& 
	`fe_exi¡s
(
$toŞk™_fe
)) {

68 
šşude_Úû
 
$toŞk™_fe
;

70 
	`–£if
 (!
	`image_gd_check_£‰šgs
()) {

71 
$toŞk™
 = 
FALSE
;

75  
$toŞk™
;

76 
	}
}

88 
funùiÚ
 
image_toŞk™_švoke
(
$m‘hod
, 
$·¿ms
 = 
	$¬¿y
()) {

89 ià(
$toŞk™
 = 
	`image_g‘_toŞk™
()) {

90 
$funùiÚ
 = 'image_'. 
$toŞk™
 .'_'. 
$m‘hod
;

91 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

92  
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
$·¿ms
);

95 
	`w©chdog
('php', 'Th£Ëùed imaghªdlšgoŞk™ %toŞk™ cª‚Ù cÜ»ùly…roûs %funùiÚ.', 
	`¬¿y
('%toŞk™' => 
$toŞk™
, '%funùiÚ' => 
$funùiÚ
), 
WATCHDOG_ERROR
);

96  
FALSE
;

99 
	}
}

116 
funùiÚ
 
	$image_g‘_šfo
(
$fe
) {

117 ià(!
	`is_fe
(
$fe
)) {

118  
FALSE
;

121 
$d‘as
 = 
FALSE
;

122 
$d©a
 = @
	`g‘imagesize
(
$fe
);

123 
$fe_size
 = @
	`fesize
(
$fe
);

125 ià(
	`is£t
(
$d©a
è&& 
	`is_¬¿y
($data)) {

126 
$ex‹nsiÚs
 = 
	`¬¿y
('1' => 'gif', '2' => 'jpg', '3' => 'png');

127 
$ex‹nsiÚ
 = 
	`¬¿y_key_exi¡s
(
$d©a
[2], 
$ex‹nsiÚs
) ? $extensions[$data[2]] : '';

128 
$d‘as
 = 
	`¬¿y
('width' => 
$d©a
[0],

129 'height' => 
$d©a
[1],

130 'ex‹nsiÚ' => 
$ex‹nsiÚ
,

131 'fe_size' => 
$fe_size
,

132 'mime_ty³' => 
$d©a
['mime']);

135  
$d‘as
;

136 
	}
}

157 
funùiÚ
 
	$image_sÿË_ªd_üİ
(
$sourû
, 
$de¡š©iÚ
, 
$width
, 
$height
) {

158 
$šfo
 = 
	`image_g‘_šfo
(
$sourû
);

160 
$sÿË
 = 
	`max
(
$width
 / 
$šfo
['width'], 
$height
 / $info['height']);

161 
$x
 = 
	`round
((
$šfo
['width'] * 
$sÿË
 - 
$width
) / 2);

162 
$y
 = 
	`round
((
$šfo
['height'] * 
$sÿË
 - 
$height
) / 2);

164 ià(
	`image_toŞk™_švoke
('»size', 
	`¬¿y
(
$sourû
, 
$de¡š©iÚ
, 
$šfo
['width'] * 
$sÿË
, $info['height'] * $scale))) {

165  
	`image_toŞk™_švoke
('üİ', 
	`¬¿y
(
$de¡š©iÚ
, $de¡š©iÚ, 
$x
, 
$y
, 
$width
, 
$height
));

167  
FALSE
;

168 
	}
}

187 
funùiÚ
 
	$image_sÿË
(
$sourû
, 
$de¡š©iÚ
, 
$width
, 
$height
) {

188 
$šfo
 = 
	`image_g‘_šfo
(
$sourû
);

191 ià(
$width
 >ğ
$šfo
['width'] && 
$height
 >= $info['height']) {

192  
FALSE
;

195 
$a¥eù
 = 
$šfo
['height'] / $info['width'];

196 ià(
$a¥eù
 < 
$height
 / 
$width
) {

197 
$width
 = ()
	`mš
($width, 
$šfo
['width']);

198 
$height
 = ()
	`round
(
$width
 * 
$a¥eù
);

201 
$height
 = ()
	`mš
($height, 
$šfo
['height']);

202 
$width
 = ()
	`round
(
$height
 / 
$a¥eù
);

205  
	`image_toŞk™_švoke
('»size', 
	`¬¿y
(
$sourû
, 
$de¡š©iÚ
, 
$width
, 
$height
));

206 
	}
}

222 
funùiÚ
 
	$image_»size
(
$sourû
, 
$de¡š©iÚ
, 
$width
, 
$height
) {

223  
	`image_toŞk™_švoke
('»size', 
	`¬¿y
(
$sourû
, 
$de¡š©iÚ
, 
$width
, 
$height
));

224 
	}
}

242 
funùiÚ
 
	$image_rÙ©e
(
$sourû
, 
$de¡š©iÚ
, 
$deg»es
, 
$background
 = 0x000000) {

243  
	`image_toŞk™_švoke
('rÙ©e', 
	`¬¿y
(
$sourû
, 
$de¡š©iÚ
, 
$deg»es
, 
$background
));

244 
	}
}

264 
funùiÚ
 
	$image_üİ
(
$sourû
, 
$de¡š©iÚ
, 
$x
, 
$y
, 
$width
, 
$height
) {

265  
	`image_toŞk™_švoke
('üİ', 
	`¬¿y
(
$sourû
, 
$de¡š©iÚ
, 
$x
, 
$y
, 
$width
, 
$height
));

266 
	}
}

	@/srv/http/subs/notes/www/includes/install.inc

1 <?
php


4 
defše
('SCHEMA_UNINSTALLED', -1);

5 
defše
('SCHEMA_INSTALLED', 0);

7 
defše
('REQUIREMENT_INFO', -1);

8 
defše
('REQUIREMENT_OK', 0);

9 
defše
('REQUIREMENT_WARNING', 1);

10 
defše
('REQUIREMENT_ERROR', 2);

12 
defše
('FILE_EXIST', 1);

13 
defše
('FILE_READABLE', 2);

14 
defše
('FILE_WRITABLE', 4);

15 
defše
('FILE_EXECUTABLE', 8);

16 
defše
('FILE_NOT_EXIST', 16);

17 
defše
('FILE_NOT_READABLE', 32);

18 
defše
('FILE_NOT_WRITABLE', 64);

19 
defše
('FILE_NOT_EXECUTABLE', 128);

24 
funùiÚ
 
	$dru·l_lßd_upd©es
() {

25 
	`fÜ—ch
 (
	`dru·l_g‘_š¡®Ëd_schema_v”siÚ
(
NULL
, 
FALSE
, 
TRUE
è
as
 
$moduË
 => 
$schema_v”siÚ
) {

26 ià(
$schema_v”siÚ
 > -1) {

27 
	`moduË_lßd_š¡®l
(
$moduË
);

30 
	}
}

41 
funùiÚ
 
	$dru·l_g‘_schema_v”siÚs
(
$moduË
) {

42 
$upd©es
 = 
	`¬¿y
();

43 
$funùiÚs
 = 
	`g‘_defšed_funùiÚs
();

44 
	`fÜ—ch
 (
$funùiÚs
['u£r'] 
as
 
$funùiÚ
) {

45 ià(
	`¡½os
(
$funùiÚ
, 
$moduË
 .'_update_') === 0) {

46 
$v”siÚ
 = 
	`sub¡r
(
$funùiÚ
, 
	`¡¾’
(
$moduË
 .'_update_'));

47 ià(
	`is_num”ic
(
$v”siÚ
)) {

48 
$upd©es
[] = 
$v”siÚ
;

52 ià(
	`couÁ
(
$upd©es
) == 0) {

53  
FALSE
;

55 
	`sÜt
(
$upd©es
, 
SORT_NUMERIC
);

56  
$upd©es
;

57 
	}
}

72 
funùiÚ
 
	$dru·l_g‘_š¡®Ëd_schema_v”siÚ
(
$moduË
, 
$»£t
 = 
FALSE
, 
$¬¿y
 = FALSE) {

73 
$v”siÚs
 = 
	`¬¿y
();

75 ià(
$»£t
) {

76 
$v”siÚs
 = 
	`¬¿y
();

79 ià(!
$v”siÚs
) {

80 
$v”siÚs
 = 
	`¬¿y
();

81 
$»suÉ
 = 
	`db_qu”y
("SELECT‚ame, schema_version FROM {system} WHEREype = '%s'", 'module');

82 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

83 
$v”siÚs
[
$row
->
Çme
] = $row->
schema_v”siÚ
;

87  
$¬¿y
 ? 
$v”siÚs
 : $v”siÚs[
$moduË
];

88 
	}
}

98 
funùiÚ
 
	$dru·l_£t_š¡®Ëd_schema_v”siÚ
(
$moduË
, 
$v”siÚ
) {

99 
	`db_qu”y
("UPDATE {sy¡em} SET schema_v”siÚ = %d WHERE‚amğ'%s'", 
$v”siÚ
, 
$moduË
);

100 
	}
}

108 
funùiÚ
 
	$dru·l_š¡®l_´ofe_Çme
() {

109 
glob®
 
$´ofe
;

110 
$Çme
 = 
NULL
;

112 ià(!
	`is£t
(
$Çme
)) {

114 
$funùiÚ
 = 
$´ofe
 .'_profile_details';

115 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

116 
$d‘as
 = 
	`$funùiÚ
();

118 
$Çme
 = 
	`is£t
(
$d‘as
['name']) ? $details['name'] : 'Drupal';

121  
$Çme
;

122 
	}
}

134 
funùiÚ
 
dru·l_d‘eù_ba£u¾
(
$fe
 = 'install.php') {

135 
glob®
 
$´ofe
;

136 
	g$´Ùo
 = 
$_SERVER
['HTTPS'] ? 'https://' : 'http://';

137 
	g$ho¡
 = 
$_SERVER
['SERVER_NAME'];

138 
	g$pÜt
 = (
$_SERVER
['SERVER_PORT'] == 80 ? '' : ':'. $_SERVER['SERVER_PORT']);

139 
	g$uri
 = 
´eg_»¶aû
("/\?.*/", '', 
$_SERVER
['REQUEST_URI']);

140 
	g$dœ
 = 
¡r_»¶aû
("/$fe", '', 
$uri
);

152 
funùiÚ
 
	$dru·l_d‘eù_d©aba£_ty³s
() {

153 
$d©aba£s
 = 
	`¬¿y
();

155 
	`fÜ—ch
 (
	`¬¿y
('mysql', 'mysqli', 'pgsql'è
as
 
$ty³
) {

156 ià(
	`fe_exi¡s
('./šşudes/š¡®l.'. 
$ty³
 .'.inc')) {

157 
šşude_Úû
 './šşudes/š¡®l.'. 
$ty³
 .'.inc';

158 
$funùiÚ
 = 
$ty³
 .'_is_available';

159 ià(
	`$funùiÚ
()) {

160 
$d©aba£s
[
$ty³
] = $type;

165  
$d©aba£s
;

166 
	}
}

175 
funùiÚ
 
dru·l_»wr™e_£‰šgs
(
$£‰šgs
 = 
¬¿y
(), 
$´efix
 = '') {

176 
$deçuÉ_£‰šgs
 = './sites/default/default.settings.php';

177 
	g$£‰šgs_fe
 = './'. 
cÚf_·th
(
FALSE
, 
TRUE
è.'/'. 
	g$´efix
 .'settings.php';

180 
	g$keys
 = 
¬¿y
();

181 
fÜ—ch
 (
$£‰šgs
 
as
 
$£‰šg
 => 
$d©a
) {

182 
$GLOBALS
[
$£‰šg
] = 
$d©a
['value'];

183 
	g$keys
[] = 
$£‰šg
;

186 
	g$bufãr
 = 
NULL
;

187 
	g$fœ¡
 = 
TRUE
;

188 ià(
	g$å
 = 
fİ’
(
$deçuÉ_£‰šgs
, 'r')) {

190 !
ãof
(
$å
)) {

191 
	g$lše
 = 
fg‘s
(
$å
);

192 ià(
	g$fœ¡
 && 
sub¡r
(
$lše
, 0, 5) != '<?php') {

193 
$bufãr
 = "<?php\n\n";

195 
	g$fœ¡
 = 
FALSE
;

197 ià(
sub¡r
(
$lše
, 0, 7) == 'define(') {

198 
´eg_m©ch
('/defše\(\s*[\'"]([A-Z_-]+)[\'"]\s*,(.*?)\);/', 
$lše
, 
$v¬ŸbË
);

199 ià(
š_¬¿y
(
$v¬ŸbË
[1], 
$keys
)) {

200 
	g$£‰šg
 = 
$£‰šgs
[
$v¬ŸbË
[1]];

201 
	g$bufãr
 .ğ
¡r_»¶aû
(
$v¬ŸbË
[2], " '". 
$£‰šg
['v®ue'] ."'", 
$lše
);

202 
un£t
(
$£‰šgs
[
$v¬ŸbË
[1]]);

203 
un£t
(
$£‰šgs
[
$v¬ŸbË
[2]]);

206 
	g$bufãr
 .ğ
$lše
;

210 
–£if
 (
sub¡r
(
$lše
, 0, 1) == '$') {

211 
´eg_m©ch
('/\$([^ ]*è/', 
$lše
, 
$v¬ŸbË
);

212 ià(
š_¬¿y
(
$v¬ŸbË
[1], 
$keys
)) {

215 
	g$£‰šg
 = 
$£‰šgs
[
$v¬ŸbË
[1]];

216 
	g$bufãr
 .ğ'$'. 
$v¬ŸbË
[1] ." = '". 
$£‰šg
['v®ue'] ."';". (!
em±y
($setting['comment']) ? ' // '. $setting['comment'] ."\n" : "\n");

217 
un£t
(
$£‰šgs
[
$v¬ŸbË
[1]]);

220 
	g$bufãr
 .ğ
$lše
;

224 
	g$bufãr
 .ğ
$lše
;

227 
fşo£
(
$å
);

230 
fÜ—ch
 (
$£‰šgs
 
as
 
$£‰šg
 => 
$d©a
) {

231 ià(
$d©a
['required']) {

232 
$bufãr
 .ğ"\$$£‰šg = '". 
$d©a
['value'] ."';\n";

236 
	g$å
 = 
fİ’
(
$£‰šgs_fe
, 'w');

237 ià(
	g$å
 && 
fwr™e
(
$å
, 
$bufãr
è==ğ
FALSE
) {

238 
dru·l_£t_mes§ge
(
¡
('FaedØmodify %£‰šgs,…Ëa£ v”ifyhf³rmissiÚs.', 
¬¿y
('%£‰šgs' => 
$£‰šgs_fe
)), 'error');

242 
dru·l_£t_mes§ge
(
¡
('FaedØİ’ %£‰šgs,…Ëa£ v”ifyhf³rmissiÚs.', 
¬¿y
('%£‰šgs' => 
$deçuÉ_£‰šgs
)), 'error');

252 
funùiÚ
 
dru·l_g‘_š¡®l_fes
(
$moduË_li¡
 = 
	$¬¿y
()) {

253 
$š¡®ls
 = 
	`¬¿y
();

254 
	`fÜ—ch
 (
$moduË_li¡
 
as
 
$moduË
) {

255 
$š¡®ls
 = 
	`¬¿y_m”ge
($š¡®ls, 
	`dru·l_sy¡em_li¡šg
(
$moduË
 .'.install$', 'modules'));

257  
$š¡®ls
;

258 
	}
}

270 
funùiÚ
 
	$dru·l_v”ify_´ofe
(
$´ofe
, 
$loÿË
) {

271 
šşude_Úû
 './includes/file.inc';

272 
šşude_Úû
 './includes/common.inc';

274 
$´ofe_fe
 = "./profiles/$profile/$profile.profile";

276 ià(!
	`is£t
(
$´ofe
è|| !
	`fe_exi¡s
(
$´ofe_fe
)) {

277 
	`š¡®l_no_´ofe_”rÜ
();

280 
	`»quœe_Úû
(
$´ofe_fe
);

283 
$funùiÚ
 = 
$´ofe
 .'_profile_modules';

284 
$moduË_li¡
 = 
	`¬¿y_m”ge
(
	`dru·l_»quœed_moduËs
(), 
	`$funùiÚ
(), (
$loÿË
 !ğ'’' && !
	`em±y
($loÿËè? 
	`¬¿y
('locale') :‡rray()));

287 
$´e£Á_moduËs
 = 
	`¬¿y
();

288 
	`fÜ—ch
 (
	`dru·l_sy¡em_li¡šg
('\.moduË$', 'moduËs', 'Çme', 0è
as
 
$´e£Á_moduË
) {

289 
$´e£Á_moduËs
[] = 
$´e£Á_moduË
->
Çme
;

293 
$missšg_moduËs
 = 
	`¬¿y_diff
(
$moduË_li¡
, 
$´e£Á_moduËs
);

294 ià(
	`couÁ
(
$missšg_moduËs
)) {

295 
	`fÜ—ch
 (
$missšg_moduËs
 
as
 
$moduË
) {

296 
	`dru·l_£t_mes§ge
(
	`¡
('Th%moduË moduË i »quœed buˆwa nÙ found. PËa£ mov™ iÁØth<em>moduËs</em> subdœeùÜy.', 
	`¬¿y
('%moduË' => 
$moduË
)), 'error');

300  
$moduË_li¡
;

302 
	}
}

311 
funùiÚ
 
dru·l_š¡®l_moduËs
(
$moduË_li¡
 = 
	$¬¿y
()) {

312 
$fes
 = 
	`moduË_»bud_ÿche
();

313 
$moduË_li¡
 = 
	`¬¿y_æ
(
	`¬¿y_v®ues
($module_list));

315 
$moved
 = 
FALSE
;

316 
	`fÜ—ch
 (
$moduË_li¡
 
as
 
$moduË
 => 
$weight
) {

317 
$fe
 = 
$fes
[
$moduË
];

318 ià(
	`is£t
(
$fe
->
šfo
['d•’d’c›s']è&& 
	`is_¬¿y
($file->info['dependencies'])) {

319 
	`fÜ—ch
 (
$fe
->
šfo
['d•’d’c›s'] 
as
 
$d•’d’cy
) {

320 ià(
	`is£t
(
$moduË_li¡
[
$d•’d’cy
]è&& $moduË_li¡[
$moduË
] < $module_list[$dependency] +1) {

321 
$moduË_li¡
[
$moduË
] = $moduË_li¡[
$d•’d’cy
] +1;

322 
$moved
 = 
TRUE
;

327 } 
$moved
);

328 
	`asÜt
(
$moduË_li¡
);

329 
$moduË_li¡
 = 
	`¬¿y_keys
($module_list);

330 
	`¬¿y_f‹r
(
$moduË_li¡
, '_drupal_install_module');

331 
	`moduË_’abË
(
$moduË_li¡
);

332 
	}
}

341 
funùiÚ
 
	$_dru·l_š¡®l_moduË
(
$moduË
) {

342 ià(
	`dru·l_g‘_š¡®Ëd_schema_v”siÚ
(
$moduË
, 
TRUE
è=ğ
SCHEMA_UNINSTALLED
) {

343 
	`moduË_lßd_š¡®l
(
$moduË
);

344 
	`moduË_švoke
(
$moduË
, 'install');

345 
$v”siÚs
 = 
	`dru·l_g‘_schema_v”siÚs
(
$moduË
);

346 
	`dru·l_£t_š¡®Ëd_schema_v”siÚ
(
$moduË
, 
$v”siÚs
 ? 
	`max
($v”siÚsè: 
SCHEMA_INSTALLED
);

347  
TRUE
;

349 
	}
}

357 
funùiÚ
 
	$dru·l_š¡®l_sy¡em
() {

358 
$sy¡em_·th
 = 
	`dœÇme
(
	`dru·l_g‘_f’ame
('moduË', 'sy¡em', 
NULL
));

359 
»quœe_Úû
 './'. 
$sy¡em_·th
 .'/system.install';

360 
	`moduË_švoke
('system', 'install');

361 
$sy¡em_v”siÚs
 = 
	`dru·l_g‘_schema_v”siÚs
('system');

362 
$sy¡em_v”siÚ
 = 
$sy¡em_v”siÚs
 ? 
	`max
($sy¡em_v”siÚsè: 
SCHEMA_INSTALLED
;

363 
	`db_qu”y
("INSERT INTO {sy¡em} (f’ame,‚ame,y³, owÃr, stus,hrÙe, boÙ¡¿p, schema_v”siÚèVALUES('%s', '%s', '%s', '%s', %d, %d, %d, %d)", 
$sy¡em_·th
 .'/sy¡em.moduË', 'sy¡em', 'moduË', '', 1, 0, 0, 
$sy¡em_v”siÚ
);

365 
	`dru·l_boÙ¡¿p
(
DRUPAL_BOOTSTRAP_FULL
);

366 
	`moduË_»bud_ÿche
();

367 
	}
}

376 
funùiÚ
 
	$dru·l_unš¡®l_moduË
(
$moduË
) {

378 
	`dru·l_lßd
('moduË', 
$moduË
);

379 
$·ths
 = 
	`moduË_švoke
(
$moduË
, 'menu');

382 
	`moduË_lßd_š¡®l
(
$moduË
);

383 
	`moduË_švoke
(
$moduË
, 'uninstall');

386 ià(!
	`em±y
(
$·ths
)) {

387 
$·ths
 = 
	`¬¿y_keys
($paths);

389 
	`fÜ—ch
 (
$·ths
 
as
 
$šdex
 => 
$·th
) {

390 
$·¹s
 = 
	`ex¶ode
('/', 
$·th
, 
MENU_MAX_PARTS
);

391 
	`fÜ—ch
 (
$·¹s
 
as
 
$k
 => 
$·¹
) {

392 ià(
	`´eg_m©ch
('/^%[a-z_]*$/', 
$·¹
)) {

393 
$·¹s
[
$k
] = '%';

396 
$·ths
[
$šdex
] = 
	`im¶ode
('/', 
$·¹s
);

398 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, 
	`couÁ
(
$·ths
), "'%s'"));

400 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {m’u_lšks} WHERE„ou‹r_·th IN ('. 
$¶aûhŞd”s
 .'èANDƒx‹º® = 0 ORDER BY d•th DESC', 
$·ths
);

403 
$™em
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

404 
	`_m’u_d–‘e_™em
(
$™em
, 
TRUE
);

408 
	`dru·l_£t_š¡®Ëd_schema_v”siÚ
(
$moduË
, 
SCHEMA_UNINSTALLED
);

409 
	}
}

423 
funùiÚ
 
dru·l_v”ify_š¡®l_fe
(
$fe
, 
$mask
 = 
NULL
, 
$ty³
 = 'file') {

424 
$»tuº
 = 
TRUE
;

426 ià(
is£t
(
$mask
è&& (
	g$mask
 & 
	gFILE_NOT_EXIST
è&& 
fe_exi¡s
(
$fe
)) {

427  
	gFALSE
;

430 ià(
is£t
(
$ty³
è&& 
fe_exi¡s
(
$fe
)) {

431 
	g$check
 = 'is_'. 
$ty³
;

432 ià(!
funùiÚ_exi¡s
(
$check
è|| !$check(
$fe
)) {

433 
	g$»tuº
 = 
FALSE
;

438 ià(
is£t
(
$mask
)) {

439 
	g$masks
 = 
¬¿y
(
FILE_EXIST
, 
FILE_READABLE
, 
FILE_WRITABLE
, 
FILE_EXECUTABLE
, 
FILE_NOT_READABLE
, 
FILE_NOT_WRITABLE
, 
FILE_NOT_EXECUTABLE
);

440 
fÜ—ch
 (
$masks
 
as
 
$cu¼’t_mask
) {

441 ià(
	g$mask
 & 
	g$cu¼’t_mask
) {

442 
	g$cu¼’t_mask
) {

443 
	gFILE_EXIST
:

444 ià(!
fe_exi¡s
(
$fe
)) {

445 ià(
$ty³
 == 'dir') {

446 
dru·l_š¡®l_mkdœ
(
$fe
, 
$mask
);

448 ià(!
fe_exi¡s
(
$fe
)) {

449 
	g$»tuº
 = 
FALSE
;

453 
	gFILE_READABLE
:

454 ià(!
is_»adabË
(
$fe
è&& !
dru·l_š¡®l_fix_fe
($fe, 
$mask
)) {

455 
	g$»tuº
 = 
FALSE
;

458 
	gFILE_WRITABLE
:

459 ià(!
is_wr™abË
(
$fe
è&& !
dru·l_š¡®l_fix_fe
($fe, 
$mask
)) {

460 
	g$»tuº
 = 
FALSE
;

463 
	gFILE_EXECUTABLE
:

464 ià(!
is_execubË
(
$fe
è&& !
dru·l_š¡®l_fix_fe
($fe, 
$mask
)) {

465 
	g$»tuº
 = 
FALSE
;

468 
	gFILE_NOT_READABLE
:

469 ià(
is_»adabË
(
$fe
è&& !
dru·l_š¡®l_fix_fe
($fe, 
$mask
)) {

470 
	g$»tuº
 = 
FALSE
;

473 
	gFILE_NOT_WRITABLE
:

474 ià(
is_wr™abË
(
$fe
è&& !
dru·l_š¡®l_fix_fe
($fe, 
$mask
)) {

475 
	g$»tuº
 = 
FALSE
;

478 
	gFILE_NOT_EXECUTABLE
:

479 ià(
is_execubË
(
$fe
è&& !
dru·l_š¡®l_fix_fe
($fe, 
$mask
)) {

480 
	g$»tuº
 = 
FALSE
;

487  
	g$»tuº
;

503 
funùiÚ
 
	$dru·l_š¡®l_mkdœ
(
$fe
, 
$mask
, 
$mes§ge
 = 
TRUE
) {

504 
$mod
 = 0;

505 
$masks
 = 
	`¬¿y
(
FILE_READABLE
, 
FILE_WRITABLE
, 
FILE_EXECUTABLE
, 
FILE_NOT_READABLE
, 
FILE_NOT_WRITABLE
, 
FILE_NOT_EXECUTABLE
);

506 
	`fÜ—ch
 (
$masks
 
as
 
$m
) {

507 ià(
$mask
 & 
$m
) {

508 
$m
) {

509 
FILE_READABLE
:

510 
$mod
 += 444;

512 
FILE_WRITABLE
:

513 
$mod
 += 222;

515 
FILE_EXECUTABLE
:

516 
$mod
 += 111;

522 ià(@
	`mkdœ
(
$fe
, 
	`štv®
("0$mod", 8))) {

523  
TRUE
;

526  
FALSE
;

528 
	}
}

552 
funùiÚ
 
	$dru·l_š¡®l_fix_fe
(
$fe
, 
$mask
, 
$mes§ge
 = 
TRUE
) {

553 
$mod
 = 
	`f•”ms
(
$fe
) & 0777;

554 
$masks
 = 
	`¬¿y
(
FILE_READABLE
, 
FILE_WRITABLE
, 
FILE_EXECUTABLE
, 
FILE_NOT_READABLE
, 
FILE_NOT_WRITABLE
, 
FILE_NOT_EXECUTABLE
);

560 
	`fÜ—ch
 (
$masks
 
as
 
$m
) {

561 ià(
$mask
 & 
$m
) {

562 
$m
) {

563 
FILE_READABLE
:

564 ià(!
	`is_»adabË
(
$fe
)) {

565 
$mod
 |= 0444;

568 
FILE_WRITABLE
:

569 ià(!
	`is_wr™abË
(
$fe
)) {

570 
$mod
 |= 0222;

573 
FILE_EXECUTABLE
:

574 ià(!
	`is_execubË
(
$fe
)) {

575 
$mod
 |= 0111;

578 
FILE_NOT_READABLE
:

579 ià(
	`is_»adabË
(
$fe
)) {

580 
$mod
 &= ~0444;

583 
FILE_NOT_WRITABLE
:

584 ià(
	`is_wr™abË
(
$fe
)) {

585 
$mod
 &= ~0222;

588 
FILE_NOT_EXECUTABLE
:

589 ià(
	`is_execubË
(
$fe
)) {

590 
$mod
 &= ~0111;

600 ià(@
	`chmod
(
$fe
, 
$mod
)) {

601  
TRUE
;

604  
FALSE
;

606 
	}
}

616 
funùiÚ
 
	$š¡®l_gÙo
(
$·th
) {

617 
glob®
 
$ba£_u¾
;

618 
	`h—d”
('LoÿtiÚ: '. 
$ba£_u¾
 .'/'. 
$·th
);

619 
	`h—d”
('Cache-Control:‚o-cache');

620 
	`ex™
();

621 
	}
}

628 
funùiÚ
 
¡
(
$¡ršg
, 
$¬gs
 = 
	$¬¿y
()) {

629 
$loÿË_¡ršgs
 = 
NULL
;

630 
glob®
 
$´ofe
, 
$š¡®l_loÿË
;

632 ià(!
	`is£t
(
$loÿË_¡ršgs
)) {

633 
$loÿË_¡ršgs
 = 
	`¬¿y
();

634 
$f’ame
 = './´ofes/'. 
$´ofe
 .'/Œª¦©iÚs/'. 
$š¡®l_loÿË
 .'.po';

635 ià(
	`fe_exi¡s
(
$f’ame
)) {

636 
»quœe_Úû
 './includes/locale.inc';

637 
$fe
 = (
objeù
è
	`¬¿y
('f•©h' => 
$f’ame
);

638 
	`_loÿË_impÜt_»ad_po
('mem-¡Üe', 
$fe
);

639 
$loÿË_¡ršgs
 = 
	`_loÿË_impÜt_Úe_¡ršg
('mem-report');

643 
»quœe_Úû
 './includes/theme.inc';

645 
	`fÜ—ch
 (
$¬gs
 
as
 
$key
 => 
$v®ue
) {

646 
$key
[0]) {

649 
$¬gs
[
$key
] = 
	`check_¶aš
(
$v®ue
);

654 
$¬gs
[
$key
] = '<em>'. 
	`check_¶aš
(
$v®ue
) .'</em>';

660  
	`¡¹r
((!
	`em±y
(
$loÿË_¡ršgs
[
$¡ršg
]è? $loÿË_¡ršgs[$¡ršg] : $¡ršg), 
$¬gs
);

661 
	}
}

669 
funùiÚ
 
	$dru·l_check_´ofe
(
$´ofe
) {

670 
šşude_Úû
 './includes/file.inc';

672 
$´ofe_fe
 = "./profiles/$profile/$profile.profile";

674 ià(!
	`is£t
(
$´ofe
è|| !
	`fe_exi¡s
(
$´ofe_fe
)) {

675 
	`š¡®l_no_´ofe_”rÜ
();

678 
	`»quœe_Úû
(
$´ofe_fe
);

681 
$funùiÚ
 = 
$´ofe
 .'_profile_modules';

682 
$moduË_li¡
 = 
	`¬¿y_unique
(
	`¬¿y_m”ge
(
	`dru·l_»quœed_moduËs
(), 
	`$funùiÚ
()));

685 
$š¡®ls
 = 
	`dru·l_g‘_š¡®l_fes
(
$moduË_li¡
);

688 
$»quœem’ts
 = 
	`¬¿y
();

689 
	`fÜ—ch
 (
$š¡®ls
 
as
 
$š¡®l
) {

690 
»quœe_Úû
 
$š¡®l
->
f’ame
;

691 ià(
	`moduË_hook
(
$š¡®l
->
Çme
, 'requirements')) {

692 
$»quœem’ts
 = 
	`¬¿y_m”ge
($»quœem’ts, 
	`moduË_švoke
(
$š¡®l
->
Çme
, 'requirements', 'install'));

695  
$»quœem’ts
;

696 
	}
}

701 
funùiÚ
 
	$dru·l_»quœem’ts_£v”™y
(&
$»quœem’ts
) {

702 
$£v”™y
 = 
REQUIREMENT_OK
;

703 
	`fÜ—ch
 (
$»quœem’ts
 
as
 
$»quœem’t
) {

704 ià(
	`is£t
(
$»quœem’t
['severity'])) {

705 
$£v”™y
 = 
	`max
($£v”™y, 
$»quœem’t
['severity']);

708  
$£v”™y
;

709 
	}
}

714 
funùiÚ
 
	$dru·l_check_moduË
(
$moduË
) {

716 
$š¡®l
 = 
	`dru·l_g‘_š¡®l_fes
(
	`¬¿y
(
$moduË
));

717 ià(
	`is£t
(
$š¡®l
[
$moduË
])) {

718 
»quœe_Úû
 
$š¡®l
[
$moduË
]->
f’ame
;

721 
$»quœem’ts
 = 
	`moduË_švoke
(
$moduË
, 'requirements', 'install');

722 ià(
	`is_¬¿y
(
$»quœem’ts
è&& 
	`dru·l_»quœem’ts_£v”™y
($»quœem’tsè=ğ
REQUIREMENT_ERROR
) {

724 
	`fÜ—ch
 (
$»quœem’ts
 
as
 
$»quœem’t
) {

725 ià(
	`is£t
(
$»quœem’t
['£v”™y']è&& $»quœem’t['£v”™y'] =ğ
REQUIREMENT_ERROR
) {

726 
$mes§ge
 = 
$»quœem’t
['description'];

727 ià(
	`is£t
(
$»quœem’t
['value']) && $requirement['value']) {

728 
$mes§ge
 .ğ' ('. 
	`t
('Cu¼’y usšg !™em !v”siÚ', 
	`¬¿y
('!™em' => 
$»quœem’t
['title'], '!version' => $requirement['value'])) .')';

730 
	`dru·l_£t_mes§ge
(
$mes§ge
, 'error');

733  
FALSE
;

736  
TRUE
;

737 
	}
}

	@/srv/http/subs/notes/www/includes/install.mysql.inc

1 <?
php


12 
funùiÚ
 
	$mysql_is_avaabË
() {

13  
	`funùiÚ_exi¡s
('mysql_connect');

14 
	}
}

22 
funùiÚ
 
	$dru·l_‹¡_mysql
(
$u¾
, &
$sucûss
) {

23 ià(!
	`mysql_is_avaabË
()) {

24 
	`dru·l_£t_mes§ge
(
	`¡
('PHP MySQL support‚otƒnabled.'), 'error');

25  
FALSE
;

28 
$u¾
 = 
	`·r£_u¾
($url);

31 
$u¾
['u£r'] = 
	`u¾decode
($url['user']);

32 
$u¾
['·ss'] = 
	`is£t
($u¾['·ss']è? 
	`u¾decode
($url['pass']) : '';

33 
$u¾
['ho¡'] = 
	`u¾decode
($url['host']);

34 
$u¾
['·th'] = 
	`u¾decode
($url['path']);

37 ià(
	`is£t
(
$u¾
['port'])) {

38 
$u¾
['host'] = $url['host'] .':'. $url['port'];

42 
$cÚÃùiÚ
 = @
	`mysql_cÚÃù
(
$u¾
['ho¡'], $u¾['u£r'], $u¾['·ss'], 
TRUE
, 2);

43 ià(!
$cÚÃùiÚ
) {

44 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØcÚÃùØyou¸MySQL d©aba£ s”v”. MySQL„•Üt thfŞlowšg mes§ge: %”rÜ.<ul><li>A» you su» you havthcÜ»ù u£ºamªd…asswÜd?</li><li>A» you su»h© you havty³dhcÜ»ù d©aba£ ho¡Çme?</li><li>A» you su»h©hd©aba£ s”v” i ruÂšg?</li></ul>FÜ mÜh–p, s“h<¨h»f="h‰p://dru·l.Üg/node/258">In¡®ÏtiÚ‡nd upg¿dšg hªdbook</a>. Iàyou‡» unsu» wh©he£”m m—Àyou should…robably cÚù you¸ho¡šg…rovid”.', 
	`¬¿y
('%”rÜ' => 
	`mysql_”rÜ
())), 'error');

45  
FALSE
;

49 ià(!
	`mysql_£Ëù_db
(
	`sub¡r
(
$u¾
['path'], 1))) {

50 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØ£Ëù you¸d©aba£ oÀyou¸MySQL d©aba£ s”v”, which m—n thcÚÃùiÚ u£ºamªd…asswÜd‡» v®id, buˆth”i ¨´obËm‡cûssšg you¸d©a. MySQL„•Üt thfŞlowšg mes§ge: %”rÜ.<ul><li>A» you su» you havthcÜ»ù d©aba£‚ame?</li><li>A» you su»hd©aba£ƒxi¡s?</li><li>A» you su»hu£ºamha ³rmissiÚØacûs thd©aba£?</li></ul>FÜ mÜh–p, s“h<¨h»f="h‰p://dru·l.Üg/node/258">In¡®ÏtiÚ‡nd upg¿dšg hªdbook</a>. Iàyou‡» unsu» wh©he£”m m—Àyou should…robably cÚù you¸ho¡šg…rovid”.', 
	`¬¿y
('%”rÜ' => 
	`mysql_”rÜ
())), 'error');

51  
FALSE
;

54 
$sucûss
 = 
	`¬¿y
('CONNECT');

57 
$qu”y
 = 'CREATE TABLE drupal_install_test (id int NULL)';

58 
$»suÉ
 = 
	`mysql_qu”y
(
$qu”y
);

59 ià(
$”rÜ
 = 
	`mysql_”rÜ
()) {

60 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØü—‹‡e¡abË oÀyou¸MySQL d©aba£ s”v” w™hhcommªd %qu”y. MySQL„•Üt thfŞlowšg mes§ge: %”rÜ.<ul><li>A» you su»hcÚfigu»d u£ºamha thÃûs§ry MySQL…”missiÚ tØü—‹abË šhd©aba£?</li></ul>FÜ mÜh–p, s“h<¨h»f="h‰p://dru·l.Üg/node/258">In¡®ÏtiÚ‡nd upg¿dšg hªdbook</a>. Iàyou‡» unsu» wh©he£”m m—Àyou should…robably cÚù you¸ho¡šg…rovid”.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

61  
FALSE
;

63 
$”r
 = 
FALSE
;

64 
$sucûss
[] = 'SELECT';

65 
$sucûss
[] = 'CREATE';

68 
$qu”y
 = 'INSERT INTO drupal_install_test (id) VALUES (1)';

69 
$»suÉ
 = 
	`mysql_qu”y
(
$qu”y
);

70 ià(
$”rÜ
 = 
	`mysql_”rÜ
()) {

71 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØš£¹‡ v®uštØ¨‹¡abË oÀyou¸MySQL d©aba£ s”v”. WŒ›d in£¹šg‡ v®uw™hhcommªd %qu”y‡nd MySQL„•Ü‹dhfŞlowšgƒ¼Ü: %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

72 
$”r
 = 
TRUE
;

75 
$sucûss
[] = 'INSERT';

79 
$qu”y
 = 'UPDATE drupal_install_test SET id = 2';

80 
$»suÉ
 = 
	`mysql_qu”y
(
$qu”y
);

81 ià(
$”rÜ
 = 
	`mysql_”rÜ
()) {

82 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØupd©¨v®uš‡e¡abË oÀyou¸MySQL d©aba£ s”v”. WŒ›d upd©šg‡ v®uw™hhcommªd %qu”y‡nd MySQL„•Ü‹dhfŞlowšgƒ¼Ü: %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

83 
$”r
 = 
TRUE
;

86 
$sucûss
[] = 'UPDATE';

90 
$qu”y
 = 'DELETE FROM drupal_install_test';

91 
$»suÉ
 = 
	`mysql_qu”y
(
$qu”y
);

92 ià(
$”rÜ
 = 
	`mysql_”rÜ
()) {

93 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØd–‘¨v®uäom‡e¡abË oÀyou¸MySQL d©aba£ s”v”. WŒ›d d–‘šg‡ v®uw™hhcommªd %qu”y‡nd MySQL„•Ü‹dhfŞlowšgƒ¼Ü: %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

94 
$”r
 = 
TRUE
;

97 
$sucûss
[] = 'DELETE';

101 
$qu”y
 = 'DROP TABLE drupal_install_test';

102 
$»suÉ
 = 
	`mysql_qu”y
(
$qu”y
);

103 ià(
$”rÜ
 = 
	`mysql_”rÜ
()) {

104 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØdrİ‡e¡abË from you¸MySQL d©aba£ s”v”. WŒ›d drİpšg‡abË w™hhcommªd %qu”y‡nd MySQL„•Ü‹dhfŞlowšgƒ¼Ü %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

105 
$”r
 = 
TRUE
;

108 
$sucûss
[] = 'DROP';

111 ià(
$”r
) {

112  
FALSE
;

115 
	`mysql_şo£
(
$cÚÃùiÚ
);

116  
TRUE
;

117 
	}
}

	@/srv/http/subs/notes/www/includes/install.mysqli.inc

1 <?
php


12 
funùiÚ
 
	$mysqli_is_avaabË
() {

13  
	`funùiÚ_exi¡s
('mysqli_connect');

14 
	}
}

22 
funùiÚ
 
	$dru·l_‹¡_mysqli
(
$u¾
, &
$sucûss
) {

23 ià(!
	`mysqli_is_avaabË
()) {

24 
	`dru·l_£t_mes§ge
(
	`¡
('PHP MySQLi support‚otƒnabled.'), 'error');

25  
FALSE
;

28 
$u¾
 = 
	`·r£_u¾
($url);

31 
$u¾
['u£r'] = 
	`u¾decode
($url['user']);

32 
$u¾
['·ss'] = 
	`is£t
($u¾['·ss']è? 
	`u¾decode
($url['pass']) : '';

33 
$u¾
['ho¡'] = 
	`u¾decode
($url['host']);

34 
$u¾
['·th'] = 
	`u¾decode
($url['path']);

36 
$cÚÃùiÚ
 = 
	`mysqli_š™
();

37 @
	`mysqli_»®_cÚÃù
(
$cÚÃùiÚ
, 
$u¾
['ho¡'], $u¾['u£r'], $u¾['·ss'], 
	`sub¡r
($u¾['·th'], 1), $u¾['pÜt'], 
NULL
, 
MYSQLI_CLIENT_FOUND_ROWS
);

38 ià(
	`mysqli_cÚÃù_”ºo
() >= 2000 || mysqli_connect_errno() == 1045) {

39 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØcÚÃùØyou¸MySQL d©aba£ s”v”. MySQL„•Üt thfŞlowšg mes§ge: %”rÜ.<ul><li>A» you su» you havthcÜ»ù u£ºamªd…asswÜd?</li><li>A» you su»h© you havty³dhcÜ»ù d©aba£ ho¡Çme?</li><li>A» you su»h©hd©aba£ s”v” i ruÂšg?</li></ul>FÜ mÜh–p, s“h<¨h»f="h‰p://dru·l.Üg/node/258">In¡®ÏtiÚ‡nd upg¿dšg hªdbook</a>. Iàyou‡» unsu» wh©he£”m m—Àyou should…robably cÚù you¸ho¡šg…rovid”.', 
	`¬¿y
('%”rÜ' => 
	`mysqli_cÚÃù_”rÜ
())), 'error');

40  
FALSE
;

44 ià(
	`mysqli_cÚÃù_”ºo
() > 0) {

45 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØ£Ëù you¸d©aba£ oÀyou¸MySQL d©aba£ s”v”, which m—n thcÚÃùiÚ u£ºamªd…asswÜd‡» v®id, buˆth”i ¨´obËm‡cûssšg you¸d©a. MySQL„•Üt thfŞlowšg mes§ge: %”rÜ.<ul><li>A» you su» you havthcÜ»ù d©aba£‚ame?</li><li>A» you su»hd©aba£ƒxi¡s?</li><li>A» you su»hu£ºamha ³rmissiÚØacûs thd©aba£?</li></ul>FÜ mÜh–p, s“h<¨h»f="h‰p://dru·l.Üg/node/258">In¡®ÏtiÚ‡nd upg¿dšg hªdbook</a>. Iàyou‡» unsu» wh©he£”m m—Àyou should…robably cÚù you¸ho¡šg…rovid”.', 
	`¬¿y
('%”rÜ' => 
	`mysqli_cÚÃù_”rÜ
())), 'error');

46  
FALSE
;

49 
$sucûss
 = 
	`¬¿y
('CONNECT');

52 
$qu”y
 = 'CREATE TABLE drupal_install_test (id int NULL)';

53 
$»suÉ
 = 
	`mysqli_qu”y
(
$cÚÃùiÚ
, 
$qu”y
);

54 ià(
$”rÜ
 = 
	`mysqli_”rÜ
(
$cÚÃùiÚ
)) {

55 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØü—‹‡e¡abË oÀyou¸MySQL d©aba£ s”v” w™hhcommªd %qu”y. MySQL„•Üt thfŞlowšg mes§ge: %”rÜ.<ul><li>A» you su»hcÚfigu»d u£ºamha thÃûs§ry MySQL…”missiÚ tØü—‹abË šhd©aba£?</li></ul>FÜ mÜh–p, s“h<¨h»f="h‰p://dru·l.Üg/node/258">In¡®ÏtiÚ‡nd upg¿dšg hªdbook</a>. Iàyou‡» unsu» wh©he£”m m—Àyou should…robably cÚù you¸ho¡šg…rovid”.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

56  
FALSE
;

58 
$”r
 = 
FALSE
;

59 
$sucûss
[] = 'SELECT';

60 
$sucûss
[] = 'CREATE';

63 
$qu”y
 = 'INSERT INTO drupal_install_test (id) VALUES (1)';

64 
$»suÉ
 = 
	`mysqli_qu”y
(
$cÚÃùiÚ
, 
$qu”y
);

65 ià(
$”rÜ
 = 
	`mysqli_”rÜ
(
$cÚÃùiÚ
)) {

66 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØš£¹‡ v®uštØ¨‹¡abË oÀyou¸MySQL d©aba£ s”v”. WŒ›d in£¹šg‡ v®uw™hhcommªd %qu”y‡nd MySQL„•Ü‹dhfŞlowšgƒ¼Ü: %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

67 
$”r
 = 
TRUE
;

70 
$sucûss
[] = 'INSERT';

74 
$qu”y
 = 'UPDATE drupal_install_test SET id = 2';

75 
$»suÉ
 = 
	`mysqli_qu”y
(
$cÚÃùiÚ
, 
$qu”y
);

76 ià(
$”rÜ
 = 
	`mysqli_”rÜ
(
$cÚÃùiÚ
)) {

77 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØupd©¨v®uš‡e¡abË oÀyou¸MySQL d©aba£ s”v”. WŒ›d upd©šg‡ v®uw™hhcommªd %qu”y‡nd MySQL„•Ü‹dhfŞlowšgƒ¼Ü: %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

78 
$”r
 = 
TRUE
;

81 
$sucûss
[] = 'UPDATE';

85 
$qu”y
 = 'DELETE FROM drupal_install_test';

86 
$»suÉ
 = 
	`mysqli_qu”y
(
$cÚÃùiÚ
, 
$qu”y
);

87 ià(
$”rÜ
 = 
	`mysqli_”rÜ
(
$cÚÃùiÚ
)) {

88 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØd–‘¨v®uäom‡e¡abË oÀyou¸MySQL d©aba£ s”v”. WŒ›d d–‘šg‡ v®uw™hhcommªd %qu”y‡nd MySQL„•Ü‹dhfŞlowšgƒ¼Ü: %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

89 
$”r
 = 
TRUE
;

92 
$sucûss
[] = 'DELETE';

96 
$qu”y
 = 'DROP TABLE drupal_install_test';

97 
$»suÉ
 = 
	`mysqli_qu”y
(
$cÚÃùiÚ
, 
$qu”y
);

98 ià(
$”rÜ
 = 
	`mysqli_”rÜ
(
$cÚÃùiÚ
)) {

99 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØdrİ‡e¡abË from you¸MySQL d©aba£ s”v”. WŒ›d drİpšg‡abË w™hhcommªd %qu”y‡nd MySQL„•Ü‹dhfŞlowšgƒ¼Ü %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

100 
$”r
 = 
TRUE
;

103 
$sucûss
[] = 'DROP';

106 ià(
$”r
) {

107  
FALSE
;

110 
	`mysqli_şo£
(
$cÚÃùiÚ
);

111  
TRUE
;

112 
	}
}

	@/srv/http/subs/notes/www/includes/install.pgsql.inc

1 <?
php


12 
funùiÚ
 
	$pgsql_is_avaabË
() {

13  
	`funùiÚ_exi¡s
('pg_connect');

14 
	}
}

22 
funùiÚ
 
	$dru·l_‹¡_pgsql
(
$u¾
, &
$sucûss
) {

23 ià(!
	`pgsql_is_avaabË
()) {

24 
	`dru·l_£t_mes§ge
(
	`¡
('PHP PostgreSQL support‚otƒnabled.'), 'error');

25  
FALSE
;

28 
$u¾
 = 
	`·r£_u¾
($url);

29 
$cÚn_¡ršg
 = '';

32 ià(
	`is£t
(
$u¾
['user'])) {

33 
$cÚn_¡ršg
 .ğ' u£r='. 
	`u¾decode
(
$u¾
['user']);

35 ià(
	`is£t
(
$u¾
['pass'])) {

36 
$cÚn_¡ršg
 .ğ'…asswÜd='. 
	`u¾decode
(
$u¾
['pass']);

38 ià(
	`is£t
(
$u¾
['host'])) {

39 
$cÚn_¡ršg
 .ğ' ho¡='. 
	`u¾decode
(
$u¾
['host']);

41 ià(
	`is£t
(
$u¾
['path'])) {

42 
$cÚn_¡ršg
 .ğ' dbÇme='. 
	`sub¡r
(
	`u¾decode
(
$u¾
['path']), 1);

44 ià(
	`is£t
(
$u¾
['port'])) {

45 
$cÚn_¡ršg
 .ğ'…Üt='. 
	`u¾decode
(
$u¾
['port']);

49 
$cÚÃùiÚ
 = @
	`pg_cÚÃù
(
$cÚn_¡ršg
);

50 ià(!
$cÚÃùiÚ
) {

51 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØcÚÃùØyou¸Po¡g»SQL d©aba£ s”v”. Po¡g»SQL„•Üt thfŞlowšg mes§ge: %”rÜ.<ul><li>A» you su» you havthcÜ»ù u£ºamªd…asswÜd?</li><li>A» you su»h© you havty³dhcÜ»ù d©aba£ ho¡Çme?</li><li>A» you su»h©hd©aba£ s”v” i ruÂšg?</li><li>A» you su» youy³dhcÜ»ù d©aba£‚ame?</li></ul>FÜ mÜh–p, s“h<¨h»f="h‰p://dru·l.Üg/node/258">In¡®ÏtiÚ‡nd upg¿dšg hªdbook</a>. Iàyou‡» unsu» wh©he£”m m—Àyou should…robably cÚù you¸ho¡šg…rovid”.', 
	`¬¿y
('%error' => 'Connection failed. See†og file for failure„eason')), 'error');

52  
FALSE
;

55 
$sucûss
 = 
	`¬¿y
('CONNECT');

58 
$qu”y
 = 'CREATE TABLE drupal_install_test (id integer NOT NULL)';

59 
$»suÉ
 = 
	`pg_qu”y
(
$cÚÃùiÚ
, 
$qu”y
);

60 ià(
$”rÜ
 = 
	`pg_»suÉ_”rÜ
(
$»suÉ
)) {

61 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØü—‹‡e¡abË oÀyou¸Po¡g»SQL d©aba£ s”v” w™hhcommªd %qu”y. Po¡g»SQL„•Üt thfŞlowšg mes§ge: %”rÜ.<ul><li>A» you su»hcÚfigu»d u£ºamha thÃûs§ry Po¡g»SQL…”missiÚ tØü—‹abË šhd©aba£?</li></ul>FÜ mÜh–p, s“h<¨h»f="h‰p://dru·l.Üg/node/258">In¡®ÏtiÚ‡nd upg¿dšg hªdbook</a>. Iàyou‡» unsu» wh©he£”m m—Àyou should…robably cÚù you¸ho¡šg…rovid”.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

62  
FALSE
;

64 
$”r
 = 
FALSE
;

65 
$sucûss
[] = 'SELECT';

66 
$sucûss
[] = 'CREATE';

69 
$qu”y
 = 'INSERT INTO drupal_install_test (id) VALUES (1)';

70 
$»suÉ
 = 
	`pg_qu”y
(
$cÚÃùiÚ
, 
$qu”y
);

71 ià(
$”rÜ
 = 
	`pg_»suÉ_”rÜ
(
$»suÉ
)) {

72 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØš£¹‡ v®uštØ¨‹¡abË oÀyou¸Po¡g»SQL d©aba£ s”v”. WŒ›d in£¹šg‡ v®uw™hhcommªd %qu”y‡nd Po¡g»SQL„•Ü‹dhfŞlowšgƒ¼Ü: %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

73 
$”r
 = 
TRUE
;

76 
$sucûss
[] = 'INSERT';

80 
$qu”y
 = 'UPDATE drupal_install_test SET id = 2';

81 
$»suÉ
 = 
	`pg_qu”y
(
$cÚÃùiÚ
, 
$qu”y
);

82 ià(
$”rÜ
 = 
	`pg_»suÉ_”rÜ
(
$»suÉ
)) {

83 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØupd©¨v®uš‡e¡abË oÀyou¸Po¡g»SQL d©aba£ s”v”. WŒ›d upd©šg‡ v®uw™hhcommªd %qu”y‡nd Po¡g»SQL„•Ü‹dhfŞlowšgƒ¼Ü: %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

84 
$”r
 = 
TRUE
;

87 
$sucûss
[] = 'UPDATE';

91 
$qu”y
 = 'BEGIN; LOCK drupal_install_test IN SHARE ROW EXCLUSIVE MODE';

92 
$»suÉ
 = 
	`pg_qu”y
(
$cÚÃùiÚ
, 
$qu”y
);

93 ià(
$”rÜ
 = 
	`pg_»suÉ_”rÜ
(
$»suÉ
)) {

94 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØlock‡e¡abË oÀyou¸Po¡g»SQL d©aba£ s”v”. WŒ›d†ockšg‡abË w™hhcommªd %qu”y‡nd Po¡g»SQL„•Ü‹dhfŞlowšgƒ¼Ü: %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

95 
$”r
 = 
TRUE
;

98 
$sucûss
[] = 'LOCK';

102 
$qu”y
 = 'COMMIT';

103 
$»suÉ
 = 
	`pg_qu”y
(
$cÚÃùiÚ
, 
$qu”y
);

104 ià(
$”rÜ
 = 
	`pg_»suÉ_”rÜ
()) {

105 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØuÆock‡e¡abË oÀyou¸Po¡g»SQL d©aba£ s”v”. WŒ›d uÆockšg‡abË w™hhcommªd %qu”y‡nd Po¡g»SQL„•Ü‹dhfŞlowšgƒ¼Ü: %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

106 
$”r
 = 
TRUE
;

109 
$sucûss
[] = 'UNLOCK';

113 
$qu”y
 = 'DELETE FROM drupal_install_test';

114 
$»suÉ
 = 
	`pg_qu”y
(
$cÚÃùiÚ
, 
$qu”y
);

115 ià(
$”rÜ
 = 
	`pg_»suÉ_”rÜ
()) {

116 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØd–‘¨v®uäom‡e¡abË oÀyou¸Po¡g»SQL d©aba£ s”v”. WŒ›d d–‘šg‡ v®uw™hhcommªd %qu”y‡nd Po¡g»SQL„•Ü‹dhfŞlowšgƒ¼Ü: %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

117 
$”r
 = 
TRUE
;

120 
$sucûss
[] = 'DELETE';

124 
$qu”y
 = 'DROP TABLE drupal_install_test';

125 
$»suÉ
 = 
	`pg_qu”y
(
$cÚÃùiÚ
, 
$qu”y
);

126 ià(
$”rÜ
 = 
	`pg_»suÉ_”rÜ
()) {

127 
	`dru·l_£t_mes§ge
(
	`¡
('FaedØdrİ‡e¡abË from you¸Po¡g»SQL d©aba£ s”v”. WŒ›d drİpšg‡abË w™hhcommªd %qu”y‡nd Po¡g»SQL„•Ü‹dhfŞlowšgƒ¼Ü %”rÜ.', 
	`¬¿y
('%qu”y' => 
$qu”y
, '%”rÜ' => 
$”rÜ
)), 'error');

128 
$”r
 = 
TRUE
;

131 
$sucûss
[] = 'DROP';

134 ià(
$”r
) {

135  
FALSE
;

138 
	`pg_şo£
(
$cÚÃùiÚ
);

139  
TRUE
;

140 
	}
}

	@/srv/http/subs/notes/www/includes/language.inc

1 <?
php


12 
funùiÚ
 
	$Ïnguage_š™Ÿlize
() {

13 
glob®
 
$u£r
;

16 
$mode
 = 
	`v¬ŸbË_g‘
('Ïnguage_ÃgÙŸtiÚ', 
LANGUAGE_NEGOTIATION_NONE
);

18 
$Ïnguages
 = 
	`Ïnguage_li¡
('enabled');

19 
$Ïnguages
 = $languages[1];

21 
$mode
) {

22 
LANGUAGE_NEGOTIATION_NONE
:

23  
	`Ïnguage_deçuÉ
();

25 
LANGUAGE_NEGOTIATION_DOMAIN
:

26 
	`fÜ—ch
 (
$Ïnguages
 
as
 
$Ïnguage
) {

27 
$·¹s
 = 
	`·r£_u¾
(
$Ïnguage
->
domaš
);

28 ià(!
	`em±y
(
$·¹s
['ho¡']è&& (
$_SERVER
['HTTP_HOST'] == $parts['host'])) {

29  
$Ïnguage
;

32  
	`Ïnguage_deçuÉ
();

34 
LANGUAGE_NEGOTIATION_PATH_DEFAULT
:

35 
LANGUAGE_NEGOTIATION_PATH
:

38 
$¬gs
 = 
	`is£t
(
$_GET
['q']è? 
	`ex¶ode
('/', $_GET['q']è: 
	`¬¿y
();

39 
$´efix
 = 
	`¬¿y_shiá
(
$¬gs
);

41 
	`fÜ—ch
 (
$Ïnguages
 
as
 
$Ïnguage
) {

42 ià(!
	`em±y
(
$Ïnguage
->
´efix
è&& $Ïnguage->´efix =ğ
$´efix
) {

44 
$_GET
['q'] = 
	`im¶ode
('/', 
$¬gs
);

45  
$Ïnguage
;

48 ià(
$mode
 =ğ
LANGUAGE_NEGOTIATION_PATH_DEFAULT
) {

50  
	`Ïnguage_deçuÉ
();

56 ià(
$u£r
->
uid
 && 
	`is£t
(
$Ïnguages
[$u£r->
Ïnguage
])) {

57  
$Ïnguages
[
$u£r
->
Ïnguage
];

61 ià(
$Ïnguage
 = 
	`Ïnguage_äom_brow£r
()) {

62  
$Ïnguage
;

66  
	`Ïnguage_deçuÉ
();

67 
	}
}

72 
funùiÚ
 
	$Ïnguage_äom_brow£r
() {

75 
$brow£r_Ïngs
 = 
	`¬¿y
();

77 ià(
	`is£t
(
$_SERVER
['HTTP_ACCEPT_LANGUAGE'])) {

78 
$brow£r_acû±
 = 
	`ex¶ode
(",", 
$_SERVER
['HTTP_ACCEPT_LANGUAGE']);

79 
$i
 = 0; $˜< 
	`couÁ
(
$brow£r_acû±
); $i++) {

83 ià(
	`´eg_m©ch
("!([a-z-]+)(;q=([0-9\\.]+))?!", 
	`Œim
(
$brow£r_acû±
[
$i
]), 
$found
)) {

84 
$brow£r_Ïngs
[
$found
[1]] = (
	`is£t
($found[3]) ? () $found[3] : 1.0);

90 
	`¬sÜt
(
$brow£r_Ïngs
);

93 
$Ïnguages
 = 
	`Ïnguage_li¡
('enabled');

94 
	`fÜ—ch
 (
$brow£r_Ïngs
 
as
 
$Ïngcode
 => 
$q
) {

95 ià(
	`is£t
(
$Ïnguages
['1'][
$Ïngcode
])) {

96  
$Ïnguages
['1'][
$Ïngcode
];

99 
	}
}

105 
funùiÚ
 
	$Ïnguage_u¾_»wr™e
(&
$·th
, &
$İtiÚs
) {

106 
glob®
 
$Ïnguage
;

109 ià(
	`em±y
(
$İtiÚs
['external'])) {

112 ià(!
	`is£t
(
$İtiÚs
['language'])) {

113 
$İtiÚs
['Ïnguage'] = 
$Ïnguage
;

116 
	`v¬ŸbË_g‘
('Ïnguage_ÃgÙŸtiÚ', 
LANGUAGE_NEGOTIATION_NONE
)) {

117 
LANGUAGE_NEGOTIATION_NONE
:

119 
	`un£t
(
$İtiÚs
['language']);

122 
LANGUAGE_NEGOTIATION_DOMAIN
:

123 ià(
$İtiÚs
['Ïnguage']->
domaš
) {

125 
$İtiÚs
['absŞu‹'] = 
TRUE
;

126 
$İtiÚs
['ba£_u¾'] = $İtiÚs['Ïnguage']->
domaš
;

130 
LANGUAGE_NEGOTIATION_PATH_DEFAULT
:

131 
$deçuÉ
 = 
	`Ïnguage_deçuÉ
();

132 ià(
$İtiÚs
['Ïnguage']->
Ïnguage
 =ğ
$deçuÉ
->language) {

137 
LANGUAGE_NEGOTIATION_PATH
:

138 ià(!
	`em±y
(
$İtiÚs
['Ïnguage']->
´efix
)) {

139 
$İtiÚs
['´efix'] = $İtiÚs['Ïnguage']->
´efix
 .'/';

144 
	}
}

	@/srv/http/subs/notes/www/includes/locale.inc

1 <?
php


9 
defše
('LOCALE_JS_STRING', '(?:(?:\'(?:\\\\\'|[^\'])*\'|"(?:\\\\"|[^"])*")(?:\s*\+\s*)?)+');

15 
defše
('LOCALE_IMPORT_OVERWRITE', 0);

21 
defše
('LOCALE_IMPORT_KEEP', 1);

31 
funùiÚ
 
	$loÿË_Ïnguages_ov”v›w_fÜm
() {

32 
$Ïnguages
 = 
	`Ïnguage_li¡
('Ïnguage', 
TRUE
);

34 
$İtiÚs
 = 
	`¬¿y
();

35 
$fÜm
['weight'] = 
	`¬¿y
('#Œ“' => 
TRUE
);

36 
	`fÜ—ch
 (
$Ïnguages
 
as
 
$Ïngcode
 => 
$Ïnguage
) {

39 
$Ïngcode
 = 
	`check_¶aš
($langcode);

41 
$İtiÚs
[
$Ïngcode
] = '';

42 ià(
$Ïnguage
->
’abËd
) {

43 
$’abËd
[] = 
$Ïngcode
;

45 
$fÜm
['weight'][
$Ïngcode
] = 
	`¬¿y
(

47 '#deçuÉ_v®ue' => 
$Ïnguage
->
weight


49 
$fÜm
['Çme'][
$Ïngcode
] = 
	`¬¿y
('#v®ue' => 
	`check_¶aš
(
$Ïnguage
->
Çme
));

50 
$fÜm
['Çtive'][
$Ïngcode
] = 
	`¬¿y
('#v®ue' => 
	`check_¶aš
(
$Ïnguage
->
Çtive
));

51 
$fÜm
['dœeùiÚ'][
$Ïngcode
] = 
	`¬¿y
('#v®ue' => (
$Ïnguage
->
dœeùiÚ
 =ğ
LANGUAGE_RTL
 ? 
	`t
('Righto†eft') :('Lefto„ight')));

53 
$fÜm
['’abËd'] = 
	`¬¿y
('#type' => 'checkboxes',

54 '#İtiÚs' => 
$İtiÚs
,

55 '#deçuÉ_v®ue' => 
$’abËd
,

57 
$fÜm
['s™e_deçuÉ'] = 
	`¬¿y
('#type' => 'radios',

58 '#İtiÚs' => 
$İtiÚs
,

59 '#deçuÉ_v®ue' => 
	`Ïnguage_deçuÉ
('language'),

61 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save configuration'));

62 
$fÜm
['#theme'] = 'locale_languages_overview_form';

64  
$fÜm
;

65 
	}
}

72 
funùiÚ
 
	$theme_loÿË_Ïnguages_ov”v›w_fÜm
(
$fÜm
) {

73 
$deçuÉ
 = 
	`Ïnguage_deçuÉ
();

74 
	`fÜ—ch
 (
$fÜm
['Çme'] 
as
 
$key
 => 
$–em’t
) {

76 ià(
	`is_¬¿y
(
$–em’t
è&& 
	`–em’t_chd
(
$key
)) {

78 ià(
$key
 =ğ
$deçuÉ
->
Ïnguage
) {

79 
$fÜm
['’abËd'][
$key
]['#attributes']['disabled'] = 'disabled';

81 
$rows
[] = 
	`¬¿y
(

82 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
['’abËd'][
$key
]), 'align' => 'center'),

83 
	`check_¶aš
(
$key
),

84 '<¡rÚg>'. 
	`dru·l_»nd”
(
$fÜm
['Çme'][
$key
]) .'</strong>',

85 
	`dru·l_»nd”
(
$fÜm
['Çtive'][
$key
]),

86 
	`dru·l_»nd”
(
$fÜm
['dœeùiÚ'][
$key
]),

87 
	`dru·l_»nd”
(
$fÜm
['s™e_deçuÉ'][
$key
]),

88 
	`dru·l_»nd”
(
$fÜm
['weight'][
$key
]),

89 
	`l
(
	`t
('ed™'), 'admš/£‰šgs/Ïnguage/ed™/'. 
$key
è. (($key !ğ'’' && $key !ğ
$deçuÉ
->
Ïnguage
) ? ' '.†(t('delete'), 'admin/settings/language/delete/'. $key) : '')

93 
$h—d”
 = 
	`¬¿y
×¼ay('d©a' => 
	`t
('Enabled')),‡rray('data' =>('Code')),‡rray('data' =>('English‚ame')),‡rray('data' =>('Native‚ame')),‡rray('data' =>('Direction')),‡rray('data' =>('Default')),‡rray('data' =>('Weight')),‡rray('data' =>('Operations')));

94 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

95 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

97  
$ouut
;

98 
	}
}

103 
funùiÚ
 
	$loÿË_Ïnguages_ov”v›w_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

104 
$Ïnguages
 = 
	`Ïnguage_li¡
();

105 
$deçuÉ
 = 
	`Ïnguage_deçuÉ
();

106 
$’abËd_couÁ
 = 0;

107 
	`fÜ—ch
 (
$Ïnguages
 
as
 
$Ïngcode
 => 
$Ïnguage
) {

108 ià(
$fÜm_¡©e
['v®ues']['s™e_deçuÉ'] =ğ
$Ïngcode
 || 
$deçuÉ
->
Ïnguage
 == $langcode) {

112 
$fÜm_¡©e
['v®ues']['’abËd'][
$Ïngcode
] = 1;

114 ià(
$fÜm_¡©e
['v®ues']['’abËd'][
$Ïngcode
]) {

115 
$’abËd_couÁ
++;

116 
$Ïnguage
->
’abËd
 = 1;

119 
$Ïnguage
->
’abËd
 = 0;

121 
$Ïnguage
->
weight
 = 
$fÜm_¡©e
['v®ues']['weight'][
$Ïngcode
];

122 
	`db_qu”y
("UPDATE {Ïnguages} SETƒÇbËd = %d, weighˆğ%d WHERE†ªguagğ'%s'", 
$Ïnguage
->
’abËd
, $Ïnguage->
weight
, 
$Ïngcode
);

123 
$Ïnguages
[
$Ïngcode
] = 
$Ïnguage
;

125 
	`dru·l_£t_mes§ge
(
	`t
('Configuration saved.'));

126 
	`v¬ŸbË_£t
('Ïnguage_deçuÉ', 
$Ïnguages
[
$fÜm_¡©e
['values']['site_default']]);

127 
	`v¬ŸbË_£t
('Ïnguage_couÁ', 
$’abËd_couÁ
);

130 
	`ÿche_ş—r_®l
('*', 'ÿche_·ge', 
TRUE
);

132 
$fÜm_¡©e
['redirect'] = 'admin/settings/language';

134 
	}
}

147 
funùiÚ
 
	$loÿË_Ïnguages_add_sü“n
() {

148 
$ouut
 = 
	`dru·l_g‘_fÜm
('locale_languages_predefined_form');

149 
$ouut
 .ğ
	`dru·l_g‘_fÜm
('locale_languages_custom_form');

150  
$ouut
;

151 
	}
}

156 
funùiÚ
 
	$loÿË_Ïnguages_´edefšed_fÜm
() {

157 
$´edefšed
 = 
	`_loÿË_´•¬e_´edefšed_li¡
();

158 
$fÜm
 = 
	`¬¿y
();

159 
$fÜm
['Ïnguagli¡'] = 
	`¬¿y
('#type' => 'fieldset',

160 '#t™Ë' => 
	`t
('Predefined†anguage'),

161 '#cŞÏpsibË' => 
TRUE
,

163 
$fÜm
['Ïnguagli¡']['Ïngcode'] = 
	`¬¿y
('#type' => 'select',

164 '#t™Ë' => 
	`t
('Language‚ame'),

165 '#deçuÉ_v®ue' => 
	`key
(
$´edefšed
),

166 '#İtiÚs' => 
$´edefšed
,

167 '#desütiÚ' => 
	`t
('Selecthe desired†anguage‡nd clickhe <em>Add†anguage</em> button. (Usehe <em>Custom†anguage</em> options if your desired†anguage does‚ot‡ppear inhis†ist.)'),

169 
$fÜm
['Ïnguagli¡']['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Add†anguage'));

170  
$fÜm
;

171 
	}
}

176 
funùiÚ
 
	$loÿË_Ïnguages_cu¡om_fÜm
() {

177 
$fÜm
 = 
	`¬¿y
();

178 
$fÜm
['cu¡om†ªguage'] = 
	`¬¿y
('#type' => 'fieldset',

179 '#t™Ë' => 
	`t
('Custom†anguage'),

180 '#cŞÏpsibË' => 
TRUE
,

181 '#cŞÏp£d' => 
TRUE
,

183 
	`_loÿË_Ïnguages_commÚ_cÚŒŞs
(
$fÜm
['custom†anguage']);

184 
$fÜm
['cu¡om†ªguage']['subm™'] = 
	`¬¿y
(

186 '#v®ue' => 
	`t
('Add custom†anguage')

189 
$fÜm
['#submit'][] = 'locale_languages_predefined_form_submit';

190 
$fÜm
['#validate'][] = 'locale_languages_predefined_form_validate';

191  
$fÜm
;

192 
	}
}

200 
funùiÚ
 
	$loÿË_Ïnguages_ed™_fÜm
(&
$fÜm_¡©e
, 
$Ïngcode
) {

201 ià(
$Ïnguage
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT * FROM {Ïnguages} WHERE†ªguagğ'%s'", 
$Ïngcode
))) {

202 
$fÜm
 = 
	`¬¿y
();

203 
	`_loÿË_Ïnguages_commÚ_cÚŒŞs
(
$fÜm
, 
$Ïnguage
);

204 
$fÜm
['subm™'] = 
	`¬¿y
(

206 '#v®ue' => 
	`t
('Save†anguage')

208 
$fÜm
['#submit'][] = 'locale_languages_edit_form_submit';

209 
$fÜm
['#validate'][] = 'locale_languages_edit_form_validate';

210  
$fÜm
;

213 
	`dru·l_nÙ_found
();

215 
	}
}

225 
funùiÚ
 
	$_loÿË_Ïnguages_commÚ_cÚŒŞs
(&
$fÜm
, 
$Ïnguage
 = 
NULL
) {

226 ià(!
	`is_objeù
(
$Ïnguage
)) {

227 
$Ïnguage
 = 
Ãw
 
	`¡dCÏss
();

229 ià(
	`is£t
(
$Ïnguage
->
Ïnguage
)) {

230 
$fÜm
['Ïngcode_v›w'] = 
	`¬¿y
(

232 '#t™Ë' => 
	`t
('Language code'),

233 '#v®ue' => 
$Ïnguage
->
Ïnguage


235 
$fÜm
['Ïngcode'] = 
	`¬¿y
(

237 '#v®ue' => 
$Ïnguage
->
Ïnguage


241 
$fÜm
['Ïngcode'] = 
	`¬¿y
('#type' => 'textfield',

242 '#t™Ë' => 
	`t
('Language code'),

245 '#»quœed' => 
TRUE
,

246 '#deçuÉ_v®ue' => @
$Ïnguage
->
Ïnguage
,

247 '#di§bËd' => (
	`is£t
(
$Ïnguage
->
Ïnguage
)),

248 '#desütiÚ' => 
	`t
('<¨h»f="@rfc4646">RFC 4646</a> com¶ŸÁ†ªguagid’tif›r. Lªguagcode typiÿÎy u£‡ couÁry code,‡nd o±iÚ®ly,‡ süˆÜ„egiÚ® v¬ŸÁ‚ame. <em>Exam¶es: "’", "’-US"‡nd "zh-Hªt".</em>', 
	`¬¿y
('@rfc4646' => 'http://www.ietf.org/rfc/rfc4646.txt')),

251 
$fÜm
['Çme'] = 
	`¬¿y
('#type' => 'textfield',

252 '#t™Ë' => 
	`t
('Language‚ame in English'),

254 '#deçuÉ_v®ue' => @
$Ïnguage
->
Çme
,

255 '#»quœed' => 
TRUE
,

256 '#desütiÚ' => 
	`t
('Name ofhe†anguage in English. Will be‡vailable forranslation in‡ll†anguages.'),

258 
$fÜm
['Çtive'] = 
	`¬¿y
('#type' => 'textfield',

259 '#t™Ë' => 
	`t
('Native†anguage‚ame'),

261 '#deçuÉ_v®ue' => @
$Ïnguage
->
Çtive
,

262 '#»quœed' => 
TRUE
,

263 '#desütiÚ' => 
	`t
('Name ofhe†anguage inhe†anguage being‡dded.'),

265 
$fÜm
['´efix'] = 
	`¬¿y
('#type' => 'textfield',

266 '#t™Ë' => 
	`t
('Path…refix'),

268 '#deçuÉ_v®ue' => @
$Ïnguage
->
´efix
,

269 '#desütiÚ' => 
	`t
('Language code or other custom string for…attern matching withinhe…ath. With†anguage‚egotiation seto <em>Path…refix only</em> or <em>Path…refix with†anguage fallback</em>,his site is…resented inhis†anguage whenhe Path…refix value matches‡nƒlement inhe…ath. Forhe default†anguage,his value may be†eft blank. <strong>Modifyinghis value will breakƒxisting URLs‡nd should be used with caution in‡…roductionƒnvironment.</strong> <em>Example: Specifying "deutsch"‡she…ath…refix for German„esults in URLs inhe form "www.example.com/deutsch/node".</em>')

271 
$fÜm
['domaš'] = 
	`¬¿y
('#type' => 'textfield',

272 '#t™Ë' => 
	`t
('Language domain'),

274 '#deçuÉ_v®ue' => @
$Ïnguage
->
domaš
,

275 '#desütiÚ' => 
	`t
('Language-specific URL, with…rotocol. With†anguage‚egotiation seto <em>Domain‚ame only</em>,he site is…resented inhis†anguage whenhe URL‡ccessinghe site„eferenceshis domain. Forhe default†anguage,his value may be†eft blank. <strong>This value must include‡…rotocol‡s…art ofhe string.</strong> <em>Example: Specifying "http://example.de" or "http://de.example.com"‡s†anguage domains for German„esults in URLs inhe forms "http://example.de/node"‡nd "http://de.example.com/node",„espectively.</em>'),

277 
$fÜm
['dœeùiÚ'] = 
	`¬¿y
('#type' => 'radios',

278 '#t™Ë' => 
	`t
('Direction'),

279 '#»quœed' => 
TRUE
,

280 '#desütiÚ' => 
	`t
('Directionhatext inhis†anguage is…resented.'),

281 '#deçuÉ_v®ue' => @
$Ïnguage
->
dœeùiÚ
,

282 '#İtiÚs' => 
	`¬¿y
(
LANGUAGE_LTR
 => 
	`t
('LeáØright'), 
LANGUAGE_RTL
 =>('Righto†eft'))

284  
$fÜm
;

285 
	}
}

290 
funùiÚ
 
	$loÿË_Ïnguages_´edefšed_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

291 
$Ïngcode
 = 
$fÜm_¡©e
['values']['langcode'];

293 ià(
$du¶iÿ‹
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {Ïnguages} WHERE†ªguagğ'%s'", 
$Ïngcode
)) != 0) {

294 
	`fÜm_£t_”rÜ
('Ïngcode', 
	`t
('ThÏnguag%Ïnguag(%codeè®»adyƒxi¡s.', 
	`¬¿y
('%Ïnguage' => 
$fÜm_¡©e
['v®ues']['Çme'], '%code' => 
$Ïngcode
)));

297 ià(!
	`is£t
(
$fÜm_¡©e
['values']['name'])) {

299 
$´edefšed
 = 
	`_loÿË_g‘_´edefšed_li¡
();

300 ià(!
	`is£t
(
$´edefšed
[
$Ïngcode
])) {

301 
	`fÜm_£t_”rÜ
('Ïngcode', 
	`t
('Invalid†anguage code.'));

306 
	`loÿË_Ïnguages_ed™_fÜm_v®id©e
(
$fÜm
, 
$fÜm_¡©e
);

308 
	}
}

313 
funùiÚ
 
	$loÿË_Ïnguages_´edefšed_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

314 
$Ïngcode
 = 
$fÜm_¡©e
['values']['langcode'];

315 ià(
	`is£t
(
$fÜm_¡©e
['values']['name'])) {

317 
	`loÿË_add_Ïnguage
(
$Ïngcode
, 
$fÜm_¡©e
['values']['name'], $form_state['values']['native'], $form_state['values']['direction'], $form_state['values']['domain'], $form_state['values']['prefix']);

318 
	`dru·l_£t_mes§ge
(
	`t
('ThÏnguag%Ïnguagha b“Àü—‹d‡nd cª‚ow bu£d. MÜšfÜm©iÚ i avaabË oÀth<¨h»f="@loÿË-h–p">h–°sü“n</a>.', 
	`¬¿y
('%Ïnguage' =>(
$fÜm_¡©e
['v®ues']['Çme']), '@loÿË-h–p' => 
	`u¾
('admin/help/locale'))));

322 
$´edefšed
 = 
	`_loÿË_g‘_´edefšed_li¡
();

323 
	`loÿË_add_Ïnguage
(
$Ïngcode
);

324 
	`dru·l_£t_mes§ge
(
	`t
('ThÏnguag%Ïnguagha b“Àü—‹d‡nd cª‚ow bu£d. MÜšfÜm©iÚ i avaabË oÀth<¨h»f="@loÿË-h–p">h–°sü“n</a>.', 
	`¬¿y
('%Ïnguage' =>(
$´edefšed
[
$Ïngcode
][0]), '@loÿË-h–p' => 
	`u¾
('admin/help/locale'))));

329 ià(
$b©ch
 = 
	`loÿË_b©ch_by_Ïnguage
(
$Ïngcode
, '_locale_batch_language_finished')) {

330 
	`b©ch_£t
(
$b©ch
);

333 
$fÜm_¡©e
['redirect'] = 'admin/settings/language';

335 
	}
}

340 
funùiÚ
 
	$loÿË_Ïnguages_ed™_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

342 ià(
	`´eg_m©ch
('/["<>\']/', 
$fÜm_¡©e
['values']['langcode'])) {

343 
	`fÜm_£t_”rÜ
('Ïngcode', 
	`t
('The characters &lt;, &gt;, "‡nd \'‡re‚ot‡llowed inhe†anguage code field.'));

345 ià(
	`´eg_m©ch
('/["<>\']/', 
$fÜm_¡©e
['values']['name'])) {

346 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('The characters &lt;, &gt;, "‡nd \'‡re‚ot‡llowed inhe†anguage‚ame in English field.'));

348 ià(
	`´eg_m©ch
('/["<>\']/', 
$fÜm_¡©e
['values']['native'])) {

349 
	`fÜm_£t_”rÜ
('Çtive', 
	`t
('The characters &lt;, &gt;, "‡nd \'‡re‚ot‡llowed inhe‚ative†anguage‚ame field.'));

352 ià(!
	`em±y
(
$fÜm_¡©e
['values']['domain']) && !empty($form_state['values']['prefix'])) {

353 
	`fÜm_£t_”rÜ
('´efix', 
	`t
('Domain‡nd…ath…refix values should‚ot be set‡the sameime.'));

355 ià(!
	`em±y
(
$fÜm_¡©e
['v®ues']['domaš']è&& 
$du¶iÿ‹
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT†anguage FROM {languages} WHERE domain = '%s' AND†anguage != '%s'", $form_state['values']['domain'], $form_state['values']['langcode']))) {

356 
	`fÜm_£t_”rÜ
('domaš', 
	`t
('Thdomaš (%domašèi ®»ady›dØ¨Ïnguag(%Ïnguage).', 
	`¬¿y
('%domaš' => 
$fÜm_¡©e
['v®ues']['domaš'], '%Ïnguage' => 
$du¶iÿ‹
->
Ïnguage
)));

358 ià(
	`em±y
(
$fÜm_¡©e
['v®ues']['´efix']è&& 
	`Ïnguage_deçuÉ
('language') != $form_state['values']['langcode'] &&ƒmpty($form_state['values']['domain'])) {

359 
	`fÜm_£t_”rÜ
('´efix', 
	`t
('Onlyhe default†anguage can have bothhe domain‡nd…refixƒmpty.'));

361 ià(!
	`em±y
(
$fÜm_¡©e
['v®ues']['´efix']è&& 
$du¶iÿ‹
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT†anguage FROM {languages} WHERE…refix = '%s' AND†anguage != '%s'", $form_state['values']['prefix'], $form_state['values']['langcode']))) {

362 
	`fÜm_£t_”rÜ
('´efix', 
	`t
('Th´efix (%´efixèi ®»ady›dØ¨Ïnguag(%Ïnguage).', 
	`¬¿y
('%´efix' => 
$fÜm_¡©e
['v®ues']['´efix'], '%Ïnguage' => 
$du¶iÿ‹
->
Ïnguage
)));

364 
	}
}

369 
funùiÚ
 
	$loÿË_Ïnguages_ed™_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

370 
	`db_qu”y
("UPDATE {Ïnguages} SET‚amğ'%s',‚©ivğ'%s', domaš = '%s',…»fix = '%s', dœeùiÚ = %d WHERE†ªguagğ'%s'", 
$fÜm_¡©e
['values']['name'], $form_state['values']['native'], $form_state['values']['domain'], $form_state['values']['prefix'], $form_state['values']['direction'], $form_state['values']['langcode']);

371 
$deçuÉ
 = 
	`Ïnguage_deçuÉ
();

372 ià(
$deçuÉ
->
Ïnguage
 =ğ
$fÜm_¡©e
['values']['langcode']) {

373 
$´İ”t›s
 = 
	`¬¿y
('name', 'native', 'direction', 'enabled', 'plurals', 'formula', 'domain', 'prefix', 'weight');

374 
	`fÜ—ch
 (
$´İ”t›s
 
as
 
$keyÇme
) {

375 ià(
	`is£t
(
$fÜm_¡©e
['v®ues'][
$keyÇme
])) {

376 
$deçuÉ
->
$keyÇme
 = 
$fÜm_¡©e
['values'][$keyname];

379 
	`v¬ŸbË_£t
('Ïnguage_deçuÉ', 
$deçuÉ
);

381 
$fÜm_¡©e
['redirect'] = 'admin/settings/language';

383 
	}
}

396 
funùiÚ
 
	$loÿË_Ïnguages_d–‘e_fÜm
(&
$fÜm_¡©e
, 
$Ïngcode
) {

399 ià(
$Ïngcode
 == 'en') {

400 
	`dru·l_£t_mes§ge
(
	`t
('The English†anguage cannot be deleted.'));

401 
	`dru·l_gÙo
('admin/settings/language');

404 ià(
	`Ïnguage_deçuÉ
('Ïnguage'è=ğ
$Ïngcode
) {

405 
	`dru·l_£t_mes§ge
(
	`t
('The default†anguage cannot be deleted.'));

406 
	`dru·l_gÙo
('admin/settings/language');

410 
$Ïnguages
 = 
	`Ïnguage_li¡
();

412 ià(!
	`is£t
(
$Ïnguages
[
$Ïngcode
])) {

413 
	`dru·l_nÙ_found
();

416 
$fÜm
['Ïngcode'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$Ïngcode
);

417  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØd–‘thÏnguag%Çme?', 
	`¬¿y
('%Çme' =>(
$Ïnguages
[
$Ïngcode
]->
Çme
))), 'admin/settings/language',('Deleting‡†anguage will„emove‡ll interfaceranslations‡ssociated with it,‡nd…osts inhis†anguage will be seto be†anguage‚eutral. This‡ction cannot be undone.'),('Delete'),('Cancel'));

419 
	}
}

424 
funùiÚ
 
	$loÿË_Ïnguages_d–‘e_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

425 
$Ïnguages
 = 
	`Ïnguage_li¡
();

426 ià(
	`is£t
(
$Ïnguages
[
$fÜm_¡©e
['values']['langcode']])) {

428 
	`db_qu”y
("DELETE FROM {loÿËs_rg‘} WHERE†ªguagğ'%s'", 
$fÜm_¡©e
['values']['langcode']);

429 
	`ÿche_ş—r_®l
('loÿË:'. 
$fÜm_¡©e
['values']['langcode'], 'cache');

431 
	`_loÿË_»bud_js
(
$fÜm_¡©e
['values']['langcode']);

433 
	`db_qu”y
("DELETE FROM {Ïnguages} WHERE†ªguagğ'%s'", 
$fÜm_¡©e
['values']['langcode']);

434 
	`db_qu”y
("UPDATE {node} SET†ªguagğ'' WHERE†ªguagğ'%s'", 
$fÜm_¡©e
['values']['langcode']);

435 
$v¬ŸbËs
 = 
	`¬¿y
('%loÿË' => 
$Ïnguages
[
$fÜm_¡©e
['v®ues']['Ïngcode']]->
Çme
);

436 
	`dru·l_£t_mes§ge
(
	`t
('ThÏnguag%loÿË ha b“À»moved.', 
$v¬ŸbËs
));

437 
	`w©chdog
('loÿË', 'ThÏnguag%loÿË ha b“À»moved.', 
$v¬ŸbËs
);

441 
	`ÿche_ş—r_®l
('*', 'ÿche_·ge', 
TRUE
);

443 
$fÜm_¡©e
['redirect'] = 'admin/settings/language';

445 
	}
}

458 
funùiÚ
 
	$loÿË_Ïnguages_cÚfigu»_fÜm
() {

459 
$fÜm
['Ïnguage_ÃgÙŸtiÚ'] = 
	`¬¿y
(

460 '#t™Ë' => 
	`t
('Language‚egotiation'),

462 '#İtiÚs' => 
	`¬¿y
(

463 
LANGUAGE_NEGOTIATION_NONE
 => 
	`t
('None.'),

464 
LANGUAGE_NEGOTIATION_PATH_DEFAULT
 => 
	`t
('Path…refix only.'),

465 
LANGUAGE_NEGOTIATION_PATH
 => 
	`t
('Path…refix with†anguage fallback.'),

466 
LANGUAGE_NEGOTIATION_DOMAIN
 => 
	`t
('Domain‚ame only.')),

467 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('Ïnguage_ÃgÙŸtiÚ', 
LANGUAGE_NEGOTIATION_NONE
),

468 '#desütiÚ' => 
	`t
("Selecthe mechanism usedo determine your site's…resentation†anguage. <strong>Modifyinghis setting may break‡ll incoming URLs‡nd should be used with caution in‡…roductionƒnvironment.</strong>")

470 
$fÜm
['subm™'] = 
	`¬¿y
(

472 '#v®ue' => 
	`t
('Save settings')

474  
$fÜm
;

475 
	}
}

480 
funùiÚ
 
	$loÿË_Ïnguages_cÚfigu»_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

481 
	`v¬ŸbË_£t
('Ïnguage_ÃgÙŸtiÚ', 
$fÜm_¡©e
['values']['language_negotiation']);

482 
	`dru·l_£t_mes§ge
(
	`t
('Language‚egotiation configuration saved.'));

483 
$fÜm_¡©e
['redirect'] = 'admin/settings/language';

485 
	}
}

498 
funùiÚ
 
	$loÿË_Œª¦©e_ov”v›w_sü“n
() {

499 
$Ïnguages
 = 
	`Ïnguage_li¡
('Ïnguage', 
TRUE
);

500 
$groups
 = 
	`moduË_švoke_®l
('locale', 'groups');

503 
$h—d”s
 = 
	`¬¿y_m”ge
(
	`¬¿y
(
	`t
('Lªguage')), 
	`¬¿y_v®ues
(
$groups
));

506 
$sums
 = 
	`db_qu”y
("SELECT COUNT(*) AS strings,extgroup FROM {locales_source} GROUP BYextgroup");

507 
$groupsums
 = 
	`¬¿y
();

508 
$group
 = 
	`db_ãtch_objeù
(
$sums
)) {

509 
$groupsums
[
$group
->
‹xtgroup
] = $group->
¡ršgs
;

513 
$rows
 = 
	`¬¿y
();

514 
	`fÜ—ch
 (
$Ïnguages
 
as
 
$Ïngcode
 => 
$Ïnguage
) {

515 
$rows
[
$Ïngcode
] = 
	`¬¿y
('Çme' => ($Ïngcod=ğ'’' ? 
	`t
('English (but-š)'è:(
$Ïnguage
->
Çme
)));

516 
	`fÜ—ch
 (
$groups
 
as
 
$group
 => 
$Çme
) {

517 
$rows
[
$Ïngcode
][
$group
] = ($Ïngcod=ğ'’' ? 
	`t
('n/a'è: '0/'. (
	`is£t
(
$groupsums
[$group]) ? $groupsums[$group] : 0) .' (0%)');

522 
$Œª¦©iÚs
 = 
	`db_qu”y
("SELECT COUNT(*) ASranslation,.language, s.textgroup FROM {locales_source} s INNER JOIN {locales_target} ON s.lid =.lid GROUP BYextgroup,†anguage");

523 
$d©a
 = 
	`db_ãtch_objeù
(
$Œª¦©iÚs
)) {

524 
$¿tio
 = (!
	`em±y
(
$groupsums
[
$d©a
->
‹xtgroup
]è&& $d©a->
Œª¦©iÚ
 > 0è? 
	`round
(($data->translation/$groupsums[$data->textgroup])*100., 2) : 0;

525 
$rows
[
$d©a
->
Ïnguage
][$d©a->
‹xtgroup
] = $d©a->
Œª¦©iÚ
 .'/'. 
$groupsums
[$data->textgroup] ." ($ratio%)";

528  
	`theme
('bË', 
$h—d”s
, 
$rows
);

529 
	}
}

542 
funùiÚ
 
	$loÿË_Œª¦©e_£ek_sü“n
() {

543 
$ouut
 = 
	`_loÿË_Œª¦©e_£ek
();

544 
$ouut
 .ğ
	`dru·l_g‘_fÜm
('locale_translate_seek_form');

545  
$ouut
;

546 
	}
}

551 
funùiÚ
 
	$loÿË_Œª¦©e_£ek_fÜm
() {

553 
$¿w_Ïnguages
 = 
	`loÿË_Ïnguage_li¡
('Çme', 
TRUE
);

554 
	`un£t
(
$¿w_Ïnguages
['en']);

556 
$Ïnguages
 = 
	`¬¿y
();

557 
	`fÜ—ch
 (
$¿w_Ïnguages
 
as
 
$key
 => 
$v®ue
) {

558 
$Ïnguages
[
	`check_¶aš
(
$key
)] = check_¶aš(
$v®ue
);

562 
$qu”y
 = 
	`_loÿË_Œª¦©e_£ek_qu”y
();

563 
$fÜm
 = 
	`¬¿y
();

564 
$fÜm
['£¬ch'] = 
	`¬¿y
('#type' => 'fieldset',

565 '#t™Ë' => 
	`t
('Search'),

567 
$fÜm
['£¬ch']['¡ršg'] = 
	`¬¿y
('#type' => 'textfield',

568 '#t™Ë' => 
	`t
('String contains'),

569 '#deçuÉ_v®ue' => @
$qu”y
['string'],

570 '#desütiÚ' => 
	`t
('Leave blanko show‡ll strings. The search is case sensitive.'),

572 
$fÜm
['£¬ch']['Ïnguage'] = 
	`¬¿y
(

575 '#ty³' => (
	`couÁ
(
$Ïnguages
) <= 3 ? 'radios' : 'select'),

576 '#t™Ë' => 
	`t
('Language'),

577 '#deçuÉ_v®ue' => (!
	`em±y
(
$qu”y
['language']) ? $query['language'] : 'all'),

578 '#İtiÚs' => 
	`¬¿y_m”ge
(
	`¬¿y
('®l' => 
	`t
('AÎ†ªguages'), '’' =>('English (´ovided by Dru·l)')), 
$Ïnguages
),

580 
$fÜm
['£¬ch']['Œª¦©iÚ'] = 
	`¬¿y
('#type' => 'radios',

581 '#t™Ë' => 
	`t
('Search in'),

582 '#deçuÉ_v®ue' => (!
	`em±y
(
$qu”y
['translation']) ? $query['translation'] : 'all'),

583 '#İtiÚs' => 
	`¬¿y
('®l' => 
	`t
('Bothranslated‡nd untranslated strings'), 'translated' =>('Onlyranslated strings'), 'untranslated' =>('Only untranslated strings')),

585 
$groups
 = 
	`moduË_švoke_®l
('locale', 'groups');

586 
$fÜm
['£¬ch']['group'] = 
	`¬¿y
('#type' => 'radios',

587 '#t™Ë' => 
	`t
('Limit searcho'),

588 '#deçuÉ_v®ue' => (!
	`em±y
(
$qu”y
['group']) ? $query['group'] : 'all'),

589 '#İtiÚs' => 
	`¬¿y_m”ge
(
	`¬¿y
('®l' => 
	`t
('AÎexˆgroups')), 
$groups
),

592 
$fÜm
['£¬ch']['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Search'));

593 
$fÜm
['#»dœeù'] = 
FALSE
;

595  
$fÜm
;

596 
	}
}

609 
funùiÚ
 
	$loÿË_Œª¦©e_impÜt_fÜm
() {

611 
$Çmes
 = 
	`loÿË_Ïnguage_li¡
('Çme', 
TRUE
);

612 
	`un£t
(
$Çmes
['en']);

614 ià(!
	`couÁ
(
$Çmes
)) {

615 
$Ïnguages
 = 
	`_loÿË_´•¬e_´edefšed_li¡
();

616 
$deçuÉ
 = 
	`¬¿y_shiá
(
	`¬¿y_keys
(
$Ïnguages
));

619 
$Ïnguages
 = 
	`¬¿y
(

620 
	`t
('AÌ—dy‡dded†ªguages'è=> 
$Çmes
,

621 
	`t
('Lªguage nÙ y‘‡dded'è=> 
	`_loÿË_´•¬e_´edefšed_li¡
()

623 
$deçuÉ
 = 
	`¬¿y_shiá
(
	`¬¿y_keys
(
$Çmes
));

626 
$fÜm
 = 
	`¬¿y
();

627 
$fÜm
['impÜt'] = 
	`¬¿y
('#type' => 'fieldset',

628 '#t™Ë' => 
	`t
('Importranslation'),

630 
$fÜm
['impÜt']['fe'] = 
	`¬¿y
('#type' => 'file',

631 '#t™Ë' => 
	`t
('Language file'),

633 '#desütiÚ' => 
	`t
('A Gettext Portable Object (<em>.po</em>) file.'),

635 
$fÜm
['impÜt']['Ïngcode'] = 
	`¬¿y
('#type' => 'select',

636 '#t™Ë' => 
	`t
('Import into'),

637 '#İtiÚs' => 
$Ïnguages
,

638 '#deçuÉ_v®ue' => 
$deçuÉ
,

639 '#desütiÚ' => 
	`t
('Choosehe†anguage you wanto‡dd strings into. If you choose‡†anguage which is‚ot yet set up, it will be‡dded.'),

641 
$fÜm
['impÜt']['group'] = 
	`¬¿y
('#type' => 'radios',

642 '#t™Ë' => 
	`t
('Text group'),

644 '#İtiÚs' => 
	`moduË_švoke_®l
('locale', 'groups'),

645 '#desütiÚ' => 
	`t
('Importedranslations will be‡ddedohisext group.'),

647 
$fÜm
['impÜt']['mode'] = 
	`¬¿y
('#type' => 'radios',

648 '#t™Ë' => 
	`t
('Mode'),

649 '#deçuÉ_v®ue' => 
LOCALE_IMPORT_KEEP
,

650 '#İtiÚs' => 
	`¬¿y
(

651 
LOCALE_IMPORT_OVERWRITE
 => 
	`t
('Strings inhe uploaded file„eplaceƒxisting ones,‚ew ones‡re‡dded'),

652 
LOCALE_IMPORT_KEEP
 => 
	`t
('Existing strings‡re kept, only‚ew strings‡re‡dded')

655 
$fÜm
['impÜt']['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Import'));

656 
$fÜm
['#attributes']['enctype'] = 'multipart/form-data';

658  
$fÜm
;

659 
	}
}

664 
funùiÚ
 
	$loÿË_Œª¦©e_impÜt_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

666 ià(
$fe
 = 
	`fe_§ve_u¶ßd
('file')) {

669 
$Ïnguages
 = 
	`Ïnguage_li¡
('Ïnguage', 
TRUE
);

670 
$Ïngcode
 = 
$fÜm_¡©e
['values']['langcode'];

671 ià(!
	`is£t
(
$Ïnguages
[
$Ïngcode
])) {

672 
$´edefšed
 = 
	`_loÿË_g‘_´edefšed_li¡
();

673 
	`loÿË_add_Ïnguage
(
$Ïngcode
);

674 
	`dru·l_£t_mes§ge
(
	`t
('ThÏnguag%Ïnguagha b“Àü—‹d.', 
	`¬¿y
('%Ïnguage' =>(
$´edefšed
[
$Ïngcode
][0]))));

678 ià(
$»t
 = 
	`_loÿË_impÜt_po
(
$fe
, 
$Ïngcode
, 
$fÜm_¡©e
['v®ues']['mode'], $fÜm_¡©e['v®ues']['group']è=ğ
FALSE
) {

679 
$v¬ŸbËs
 = 
	`¬¿y
('%f’ame' => 
$fe
->
f’ame
);

680 
	`dru·l_£t_mes§ge
(
	`t
('ThŒª¦©iÚ impÜˆoà%f’amçed.', 
$v¬ŸbËs
), 'error');

681 
	`w©chdog
('loÿË', 'ThŒª¦©iÚ impÜˆoà%f’amçed.', 
$v¬ŸbËs
, 
WATCHDOG_ERROR
);

685 
	`dru·l_£t_mes§ge
(
	`t
('Fileo import‚ot found.'), 'error');

686 
$fÜm_¡©e
['redirect'] = 'admin/build/translate/import';

690 
$fÜm_¡©e
['redirect'] = 'admin/build/translate';

692 
	}
}

705 
funùiÚ
 
	$loÿË_Œª¦©e_expÜt_sü“n
() {

707 
$Çmes
 = 
	`loÿË_Ïnguage_li¡
('Çme', 
TRUE
);

708 
	`un£t
(
$Çmes
['en']);

709 
$ouut
 = '';

711 ià(
	`couÁ
(
$Çmes
)) {

712 
$ouut
 = 
	`dru·l_g‘_fÜm
('loÿË_Œª¦©e_expÜt_po_fÜm', 
$Çmes
);

714 
$ouut
 .ğ
	`dru·l_g‘_fÜm
('locale_translate_export_pot_form');

715  
$ouut
;

716 
	}
}

724 
funùiÚ
 
	$loÿË_Œª¦©e_expÜt_po_fÜm
(&
$fÜm_¡©e
, 
$Çmes
) {

725 
$fÜm
['expÜt'] = 
	`¬¿y
('#type' => 'fieldset',

726 '#t™Ë' => 
	`t
('Exportranslation'),

727 '#cŞÏpsibË' => 
TRUE
,

729 
$fÜm
['expÜt']['Ïngcode'] = 
	`¬¿y
('#type' => 'select',

730 '#t™Ë' => 
	`t
('Language‚ame'),

731 '#İtiÚs' => 
$Çmes
,

732 '#desütiÚ' => 
	`t
('Selecthe†anguageoƒxport in Gettext Portable Object (<em>.po</em>) format.'),

734 
$fÜm
['expÜt']['group'] = 
	`¬¿y
('#type' => 'radios',

735 '#t™Ë' => 
	`t
('Text group'),

737 '#İtiÚs' => 
	`moduË_švoke_®l
('locale', 'groups'),

739 
$fÜm
['expÜt']['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Export'));

740  
$fÜm
;

741 
	}
}

746 
funùiÚ
 
	$loÿË_Œª¦©e_expÜt_pÙ_fÜm
() {

748 
$fÜm
['expÜt'] = 
	`¬¿y
('#type' => 'fieldset',

749 '#t™Ë' => 
	`t
('Exportemplate'),

750 '#cŞÏpsibË' => 
TRUE
,

751 '#desütiÚ' => 
	`t
('Generate‡ Gettext Portable Object Template (<em>.pot</em>) file with‡ll strings fromhe Drupal†ocale database.'),

753 
$fÜm
['expÜt']['group'] = 
	`¬¿y
('#type' => 'radios',

754 '#t™Ë' => 
	`t
('Text group'),

756 '#İtiÚs' => 
	`moduË_švoke_®l
('locale', 'groups'),

758 
$fÜm
['expÜt']['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Export'));

760 
$fÜm
['#submit'][] = 'locale_translate_export_po_form_submit';

761 
$fÜm
['#validate'][] = 'locale_translate_export_po_form_validate';

762  
$fÜm
;

763 
	}
}

768 
funùiÚ
 
	$loÿË_Œª¦©e_expÜt_po_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

770 
$Ïnguage
 = 
NULL
;

771 ià(
	`is£t
(
$fÜm_¡©e
['values']['langcode'])) {

772 
$Ïnguages
 = 
	`Ïnguage_li¡
();

773 
$Ïnguage
 = 
$Ïnguages
[
$fÜm_¡©e
['values']['langcode']];

775 
	`_loÿË_expÜt_po
(
$Ïnguage
, 
	`_loÿË_expÜt_po_g’”©e
($Ïnguage, 
	`_loÿË_expÜt_g‘_¡ršgs
($Ïnguage, 
$fÜm_¡©e
['values']['group'])));

776 
	}
}

789 
funùiÚ
 
	$loÿË_Œª¦©e_ed™_fÜm
(&
$fÜm_¡©e
, 
$lid
) {

791 
$sourû
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT sourû,extgroup,†oÿtiÚ FROM {loÿËs_sourû} WHERE†id = %d', 
$lid
));

792 ià(!
$sourû
) {

793 
	`dru·l_£t_mes§ge
(
	`t
('String‚ot found.'), 'error');

794 
	`dru·l_gÙo
('admin/build/translate/search');

798 
$fÜm
 = 
	`¬¿y
(

799 'Üigš®' => 
	`¬¿y
(

801 '#t™Ë' => 
	`t
('Originalext'),

802 '#v®ue' => 
	`check_¶aš
(
	`wÜdw¿p
(
$sourû
->
sourû
, 0)),

804 'lid' => 
	`¬¿y
(

806 '#v®ue' => 
$lid


808 '‹xtgroup' => 
	`¬¿y
(

810 '#v®ue' => 
$sourû
->
‹xtgroup
,

812 'loÿtiÚ' => 
	`¬¿y
(

814 '#v®ue' => 
$sourû
->
loÿtiÚ


820 
$Ïnguages
 = 
	`Ïnguage_li¡
();

821 
$deçuÉ
 = 
	`Ïnguage_deçuÉ
();

823 
$om™
 = 
$sourû
->
‹xtgroup
 =ğ'deçuÉ' ? '’' : 
$deçuÉ
->
Ïnguage
;

824 
	`un£t
(
$Ïnguages
[(
$om™
)]);

825 
$fÜm
['Œª¦©iÚs'] = 
	`¬¿y
('#Œ“' => 
TRUE
);

827 
$rows
 = 
	`mš
(
	`û
(
	`¡r_wÜd_couÁ
(
$sourû
->
sourû
) / 12), 10);

828 
	`fÜ—ch
 (
$Ïnguages
 
as
 
$Ïngcode
 => 
$Ïnguage
) {

829 
$fÜm
['Œª¦©iÚs'][
$Ïngcode
] = 
	`¬¿y
(

831 '#t™Ë' => 
	`t
(
$Ïnguage
->
Çme
),

832 '#rows' => 
$rows
,

838 
$»suÉ
 = 
	`db_qu”y
("SELECT DISTINCT¿n¦©iÚ,†ªguagFROM {loÿËs_rg‘} WHERE†id = %d AND†ªguag!ğ'%s'", 
$lid
, 
$om™
);

839 
$Œª¦©iÚ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

840 
$fÜm
['Œª¦©iÚs'][
$Œª¦©iÚ
->
Ïnguage
]['#deçuÉ_v®ue'] = $Œª¦©iÚ->
Œª¦©iÚ
;

843 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Saveranslations'));

844  
$fÜm
;

845 
	}
}

861 
funùiÚ
 
	$loÿË_¡ršg_is_§ã
(
$¡ršg
) {

862  
	`decode_’t™›s
(
$¡ršg
è=ğdecode_’t™›s(
	`f‹r_xss
($¡ršg, 
	`¬¿y
('a', 'abbr', 'acronym', 'address', 'b', 'bdo', 'big', 'blockquote', 'br', 'caption', 'cite', 'code', 'col', 'colgroup', 'dd', 'del', 'dfn', 'dl', 'dt', 'em', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'ins', 'kbd', 'li', 'ol', 'p', 'pre', 'q', 'samp', 'small', 'span', 'strong', 'sub', 'sup', 'table', 'tbody', 'td', 'tfoot', 'th', 'thead', 'tr', 'tt', 'ul', 'var')));

863 
	}
}

868 
funùiÚ
 
	$loÿË_Œª¦©e_ed™_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

870 
$§ã_check_Ãeded
 = 
$fÜm_¡©e
['values']['textgroup'] == 'default';

871 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['Œª¦©iÚs'] 
as
 
$key
 => 
$v®ue
) {

872 ià(
$§ã_check_Ãeded
 && !
	`loÿË_¡ršg_is_§ã
(
$v®ue
)) {

873 
	`fÜm_£t_”rÜ
('Œª¦©iÚs', 
	`t
('Thsubm™‹d sŒšg cÚš di§Îowed HTML: %¡ršg', 
	`¬¿y
('%¡ršg' => 
$v®ue
)));

874 
	`w©chdog
('loÿË', 'A‰em±ed submissiÚ oà¨Œª¦©iÚ sŒšg w™h di§Îowed HTML: %¡ršg', 
	`¬¿y
('%¡ršg' => 
$v®ue
), 
WATCHDOG_WARNING
);

877 
	}
}

884 
funùiÚ
 
	$loÿË_Œª¦©e_ed™_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

885 
$lid
 = 
$fÜm_¡©e
['values']['lid'];

886 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['Œª¦©iÚs'] 
as
 
$key
 => 
$v®ue
) {

887 
$Œª¦©iÚ
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT¿n¦©iÚ FROM {loÿËs_rg‘} WHERE†id = %d AND†ªguagğ'%s'", 
$lid
, 
$key
));

888 ià(!
	`em±y
(
$v®ue
)) {

890 ià(!
	`em±y
(
$Œª¦©iÚ
)) {

891 
	`db_qu”y
("UPDATE {loÿËs_rg‘} SET¿n¦©iÚ = '%s' WHERE†id = %d AND†ªguagğ'%s'", 
$v®ue
, 
$lid
, 
$key
);

894 
	`db_qu”y
("INSERT INTO {loÿËs_rg‘} (lid,¿n¦©iÚ,†ªguageèVALUES (%d, '%s', '%s')", 
$lid
, 
$v®ue
, 
$key
);

897 
	`–£if
 (!
	`em±y
(
$Œª¦©iÚ
)) {

899 
	`db_qu”y
("DELETE FROM {loÿËs_rg‘} WHERE†id = %d AND†ªguagğ'%s'", 
$lid
, 
$key
);

903 
	`_loÿË_šv®id©e_js
(
$key
);

906 
	`dru·l_£t_mes§ge
(
	`t
('The string has been saved.'));

909 
	`_loÿË_šv®id©e_js
();

910 
	`ÿche_ş—r_®l
('loÿË:', 'ÿche', 
TRUE
);

912 
$fÜm_¡©e
['redirect'] = 'admin/build/translate/search';

914 
	}
}

927 
funùiÚ
 
	$loÿË_Œª¦©e_d–‘e_·ge
(
$lid
) {

928 ià(
$sourû
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT * FROM {loÿËs_sourû} WHERE†id = %d', 
$lid
))) {

929  
	`dru·l_g‘_fÜm
('loÿË_Œª¦©e_d–‘e_fÜm', 
$sourû
);

932  
	`dru·l_nÙ_found
();

934 
	}
}

939 
funùiÚ
 
	$loÿË_Œª¦©e_d–‘e_fÜm
(&
$fÜm_¡©e
, 
$sourû
) {

940 
$fÜm
['lid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$sourû
->
lid
);

941  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØd–‘th¡ršg "%sourû"?', 
	`¬¿y
('%sourû' => 
$sourû
->
sourû
)), 'admin/build/translate/search',('Deletinghe string will„emove‡llranslations ofhis string in‡ll†anguages. This‡ction cannot be undone.'),('Delete'),('Cancel'));

942 
	}
}

947 
funùiÚ
 
	$loÿË_Œª¦©e_d–‘e_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

948 
	`db_qu”y
('DELETE FROM {loÿËs_sourû} WHERE†id = %d', 
$fÜm_¡©e
['values']['lid']);

949 
	`db_qu”y
('DELETE FROM {loÿËs_rg‘} WHERE†id = %d', 
$fÜm_¡©e
['values']['lid']);

951 
	`_loÿË_šv®id©e_js
();

952 
	`ÿche_ş—r_®l
('loÿË:', 'ÿche', 
TRUE
);

953 
	`dru·l_£t_mes§ge
(
	`t
('The string has been„emoved.'));

954 
$fÜm_¡©e
['redirect'] = 'admin/build/translate/search';

955 
	}
}

987 
funùiÚ
 
loÿË_add_Ïnguage
(
$Ïngcode
, 
$Çme
 = 
NULL
, 
$Çtive
 = NULL, 
$dœeùiÚ
 = 
LANGUAGE_LTR
, 
$domaš
 = '', 
$´efix
 = '', 
$’abËd
 = 
TRUE
, 
$deçuÉ
 = 
FALSE
) {

989 ià(
em±y
(
$´efix
)) {

990 
$´efix
 = 
$Ïngcode
;

994 ià(!
is£t
(
$Çme
)) {

995 
	g$´edefšed
 = 
_loÿË_g‘_´edefšed_li¡
();

996 
	g$Çme
 = 
$´edefšed
[
$Ïngcode
][0];

997 
	g$Çtive
 = 
is£t
(
$´edefšed
[
$Ïngcode
][1]) ? $predefined[$langcode][1] : $predefined[$langcode][0];

998 
	g$dœeùiÚ
 = 
is£t
(
$´edefšed
[
$Ïngcode
][2]è? $´edefšed[$Ïngcode][2] : 
LANGUAGE_LTR
;

1001 
db_qu”y
("INSERT INTO {Ïnguages} (Ïnguage,‚ame,‚©ive, dœeùiÚ, domaš,…»fix,ƒÇbËdèVALUES ('%s', '%s', '%s', %d, '%s', '%s', %d)", 
$Ïngcode
, 
$Çme
, 
$Çtive
, 
$dœeùiÚ
, 
$domaš
, 
$´efix
, 
$’abËd
);

1004 ià(
	g$’abËd
 && 
	g$deçuÉ
) {

1005 
v¬ŸbË_£t
('Ïnguage_deçuÉ', (
objeù
è
¬¿y
('Ïnguage' => 
$Ïngcode
, 'Çme' => 
$Çme
, 'Çtive' => 
$Çtive
, 'dœeùiÚ' => 
$dœeùiÚ
, '’abËd' => (è
$’abËd
, '¶u¿ls' => 0, 'fÜmuÏ' => '', 'domaš' => '', '´efix' => 
$´efix
, 'weight' => 0, 'javascript' => ''));

1008 ià(
	g$’abËd
) {

1010 
v¬ŸbË_£t
('Ïnguage_couÁ', 
v¬ŸbË_g‘
('language_count', 1) + 1);

1014 
_loÿË_šv®id©e_js
(
$Ïngcode
);

1016 
w©chdog
('loÿË', 'Th%ÏnguagÏnguag(%codeèha b“Àü—‹d.', 
¬¿y
('%Ïnguage' => 
$Çme
, '%code' => 
$Ïngcode
));

1039 
funùiÚ
 
	$_loÿË_impÜt_po
(
$fe
, 
$Ïngcode
, 
$mode
, 
$group
 = 
NULL
) {

1041 ià(
	`funùiÚ_exi¡s
('set_time_limit')) {

1042 @
	`£t_time_lim™
(240);

1046 ià(!
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT†ªguagFROM {Ïnguages} WHERE†ªguagğ'%s'", 
$Ïngcode
))) {

1047 
	`dru·l_£t_mes§ge
(
	`t
('The†anguage selected for import is‚ot supported.'), 'error');

1048  
FALSE
;

1052 
$¡©us
 = 
	`_loÿË_impÜt_»ad_po
('db-¡Üe', 
$fe
, 
$mode
, 
$Ïngcode
, 
$group
);

1053 ià(
$¡©us
 ==ğ
FALSE
) {

1055  
FALSE
;

1059 
	`li¡
(
$h—d”dÚe
, 
$add™iÚs
, 
$upd©es
, 
$d–‘es
, 
$sks
èğ
	`_loÿË_impÜt_Úe_¡ršg
('db-report');

1061 ià(!
$h—d”dÚe
) {

1062 
	`dru·l_£t_mes§ge
(
	`t
('ThŒª¦©iÚ f%f’am­³¬ tØhav¨missšg o¸m®fÜmed h—d”.', 
	`¬¿y
('%f’ame' => 
$fe
->
f’ame
)), 'error');

1066 
	`_loÿË_šv®id©e_js
(
$Ïngcode
);

1067 
	`ÿche_ş—r_®l
('loÿË:', 'ÿche', 
TRUE
);

1070 
	`m’u_»bud
();

1072 
	`dru·l_£t_mes§ge
(
	`t
('ThŒª¦©iÚ wa sucûssfuÎy impÜ‹d. Th”¬%numb”‚ewly c»©ed¿n¦©ed sŒšgs, %upd©¡ršg w”upd©ed‡nd %d–‘¡ršg w”»moved.', 
	`¬¿y
('%numb”' => 
$add™iÚs
, '%upd©e' => 
$upd©es
, '%d–‘e' => 
$d–‘es
)));

1073 
	`w©chdog
('loÿË', 'ImpÜ‹d %fštØ%loÿË: %numb”‚ew sŒšg added, %upd©upd©ed‡nd %d–‘»moved.', 
	`¬¿y
('%fe' => 
$fe
->
f’ame
, '%loÿË' => 
$Ïngcode
, '%numb”' => 
$add™iÚs
, '%upd©e' => 
$upd©es
, '%d–‘e' => 
$d–‘es
));

1074 ià(
$sks
) {

1075 
$sk_mes§ge
 = 
	`fÜm©_¶u¿l
(
$sks
, 'Oneranslation string was skipped because it contains disallowed HTML.', '@countranslation strings were skipped becausehey contain disallowed HTML.');

1076 
	`dru·l_£t_mes§ge
(
$sk_mes§ge
);

1077 
	`w©chdog
('loÿË', 
$sk_mes§ge
, 
NULL
, 
WATCHDOG_WARNING
);

1079  
TRUE
;

1080 
	}
}

1096 
funùiÚ
 
_loÿË_impÜt_»ad_po
(
$İ
, 
$fe
, 
$mode
 = 
NULL
, 
$Ïng
 = NULL, 
$group
 = 'default') {

1098 
$fd
 = 
fİ’
(
$fe
->
f•©h
, "rb");

1099 ià(!
	g$fd
) {

1100 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ impÜˆçed, beÿu£hf%f’amcould‚Ù b»ad.', 
$fe
);

1101  
	gFALSE
;

1104 
	g$cÚ‹xt
 = "COMMENT";

1105 
	g$cu¼’t
 = 
¬¿y
();

1106 
	g$¶u¿l
 = 0;

1107 
	g$lš’o
 = 0;

1109 !
ãof
(
$fd
)) {

1110 
	g$lše
 = 
fg‘s
(
$fd
, 10*1024);

1111 ià(
	g$lš’o
 == 0) {

1113 
$lše
 = 
¡r_»¶aû
("\xEF\xBB\xBF", '', $line);

1115 
	g$lš’o
++;

1116 
	g$lše
 = 
Œim
(
¡¹r
(
$lše
, 
¬¿y
("\\\n" => "")));

1118 ià(!
¡ºcmp
("#", 
$lše
, 1)) {

1119 ià(
	g$cÚ‹xt
 == "COMMENT") {

1120 
$cu¼’t
["#"][] = 
sub¡r
(
$lše
, 1);

1122 
–£if
 ((
$cÚ‹xt
 == "MSGSTR") || ($context == "MSGSTR_ARR")) {

1123 
_loÿË_impÜt_Úe_¡ršg
(
$İ
, 
$cu¼’t
, 
$mode
, 
$Ïng
, 
$fe
, 
$group
);

1124 
	g$cu¼’t
 = 
¬¿y
();

1125 
	g$cu¼’t
["#"][] = 
sub¡r
(
$lše
, 1);

1126 
	g$cÚ‹xt
 = "COMMENT";

1129 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’amcÚš ªƒ¼Ü: "msg¡r" wa ex³ùed buˆnÙ found oÀlš%lše.', 
$fe
, 
$lš’o
);

1130  
	gFALSE
;

1133 
–£if
 (!
¡ºcmp
("msgid_¶u¿l", 
$lše
, 12)) {

1134 ià(
	g$cÚ‹xt
 != "MSGID") {

1135 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’amcÚš ªƒ¼Ü: "msgid_¶u¿l" wa ex³ùed buˆnÙ found oÀlš%lše.', 
$fe
, 
$lš’o
);

1136  
	gFALSE
;

1138 
	g$lše
 = 
Œim
(
sub¡r
(
$lše
, 12));

1139 
	g$quÙed
 = 
_loÿË_impÜt_·r£_quÙed
(
$lše
);

1140 ià(
	g$quÙed
 ==ğ
FALSE
) {

1141 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’amcÚš ¨syÁaxƒ¼Ü oÀlš%lše.', 
$fe
, 
$lš’o
);

1142  
	gFALSE
;

1144 
	g$cu¼’t
["msgid"] = 
$cu¼’t
["msgid"] ."\0". 
$quÙed
;

1145 
	g$cÚ‹xt
 = "MSGID_PLURAL";

1147 
–£if
 (!
¡ºcmp
("msgid", 
$lše
, 5)) {

1148 ià((
	g$cÚ‹xt
 =ğ"MSGSTR"è|| (
$cÚ‹xt
 == "MSGSTR_ARR")) {

1149 
_loÿË_impÜt_Úe_¡ršg
(
$İ
, 
$cu¼’t
, 
$mode
, 
$Ïng
, 
$fe
, 
$group
);

1150 
	g$cu¼’t
 = 
¬¿y
();

1152 
–£if
 (
$cÚ‹xt
 == "MSGID") {

1153 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’amcÚš ªƒ¼Ü: "msgid" i uÃx³ùed oÀlš%lše.', 
$fe
, 
$lš’o
);

1154  
	gFALSE
;

1156 
	g$lše
 = 
Œim
(
sub¡r
(
$lše
, 5));

1157 
	g$quÙed
 = 
_loÿË_impÜt_·r£_quÙed
(
$lše
);

1158 ià(
	g$quÙed
 ==ğ
FALSE
) {

1159 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’amcÚš ¨syÁaxƒ¼Ü oÀlš%lše.', 
$fe
, 
$lš’o
);

1160  
	gFALSE
;

1162 
	g$cu¼’t
["msgid"] = 
$quÙed
;

1163 
	g$cÚ‹xt
 = "MSGID";

1165 
–£if
 (!
¡ºcmp
("msg¡r[", 
$lše
, 7)) {

1166 ià((
	g$cÚ‹xt
 !ğ"MSGID"è&& (
$cÚ‹xt
 != "MSGID_PLURAL") && ($context != "MSGSTR_ARR")) {

1167 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’amcÚš ªƒ¼Ü: "msg¡r[]" i uÃx³ùed oÀlš%lše.', 
$fe
, 
$lš’o
);

1168  
	gFALSE
;

1170 ià(
¡½os
(
$lše
, "]"è==ğ
FALSE
) {

1171 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’amcÚš ¨syÁaxƒ¼Ü oÀlš%lše.', 
$fe
, 
$lš’o
);

1172  
	gFALSE
;

1174 
	g$äomb¿ck‘
 = 
¡r¡r
(
$lše
, "[");

1175 
	g$¶u¿l
 = 
sub¡r
(
$äomb¿ck‘
, 1, 
¡½os
($frombracket, "]") - 1);

1176 
	g$lše
 = 
Œim
(
¡r¡r
(
$lše
, " "));

1177 
	g$quÙed
 = 
_loÿË_impÜt_·r£_quÙed
(
$lše
);

1178 ià(
	g$quÙed
 ==ğ
FALSE
) {

1179 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’amcÚš ¨syÁaxƒ¼Ü oÀlš%lše.', 
$fe
, 
$lš’o
);

1180  
	gFALSE
;

1182 
	g$cu¼’t
["msg¡r"][
$¶u¿l
] = 
$quÙed
;

1183 
	g$cÚ‹xt
 = "MSGSTR_ARR";

1185 
–£if
 (!
¡ºcmp
("msg¡r", 
$lše
, 6)) {

1186 ià(
	g$cÚ‹xt
 != "MSGID") {

1187 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’amcÚš ªƒ¼Ü: "msg¡r" i uÃx³ùed oÀlš%lše.', 
$fe
, 
$lš’o
);

1188  
	gFALSE
;

1190 
	g$lše
 = 
Œim
(
sub¡r
(
$lše
, 6));

1191 
	g$quÙed
 = 
_loÿË_impÜt_·r£_quÙed
(
$lše
);

1192 ià(
	g$quÙed
 ==ğ
FALSE
) {

1193 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’amcÚš ¨syÁaxƒ¼Ü oÀlš%lše.', 
$fe
, 
$lš’o
);

1194  
	gFALSE
;

1196 
	g$cu¼’t
["msg¡r"] = 
$quÙed
;

1197 
	g$cÚ‹xt
 = "MSGSTR";

1199 
–£if
 (
$lše
 != "") {

1200 
$quÙed
 = 
_loÿË_impÜt_·r£_quÙed
(
$lše
);

1201 ià(
	g$quÙed
 ==ğ
FALSE
) {

1202 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’amcÚš ¨syÁaxƒ¼Ü oÀlš%lše.', 
$fe
, 
$lš’o
);

1203  
	gFALSE
;

1205 ià((
	g$cÚ‹xt
 =ğ"MSGID"è|| (
$cÚ‹xt
 == "MSGID_PLURAL")) {

1206 
$cu¼’t
["msgid"] .ğ
$quÙed
;

1208 
–£if
 (
$cÚ‹xt
 == "MSGSTR") {

1209 
$cu¼’t
["msg¡r"] .ğ
$quÙed
;

1211 
–£if
 (
$cÚ‹xt
 == "MSGSTR_ARR") {

1212 
$cu¼’t
["msg¡r"][
$¶u¿l
] .ğ
$quÙed
;

1215 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’amcÚš ªƒ¼Ü:h”i ª uÃx³ùed sŒšg oÀlš%lše.', 
$fe
, 
$lš’o
);

1216  
	gFALSE
;

1222 ià((
	g$cÚ‹xt
 =ğ"MSGSTR"è|| (
$cÚ‹xt
 == "MSGSTR_ARR")) {

1223 
_loÿË_impÜt_Úe_¡ršg
(
$İ
, 
$cu¼’t
, 
$mode
, 
$Ïng
, 
$fe
, 
$group
);

1225 
–£if
 (
$cÚ‹xt
 != "COMMENT") {

1226 
_loÿË_impÜt_mes§ge
('ThŒª¦©iÚ f%f’am’ded uÃx³ùedly‡ˆlš%lše.', 
$fe
, 
$lš’o
);

1227  
	gFALSE
;

1242 
funùiÚ
 
	$_loÿË_impÜt_mes§ge
(
$mes§ge
, 
$fe
, 
$lš’o
 = 
NULL
) {

1243 
$v¬s
 = 
	`¬¿y
('%f’ame' => 
$fe
->
f’ame
);

1244 ià(
	`is£t
(
$lš’o
)) {

1245 
$v¬s
['%lše'] = 
$lš’o
;

1247 
$t
 = 
	`g‘_t
();

1248 
	`dru·l_£t_mes§ge
(
	`$t
(
$mes§ge
, 
$v¬s
), 'error');

1249 
	}
}

1267 
funùiÚ
 
_loÿË_impÜt_Úe_¡ršg
(
$İ
, 
$v®ue
 = 
NULL
, 
$mode
 = NULL, 
$Ïng
 = NULL, 
$fe
 = NULL, 
$group
 = 'default') {

1268 
$»pÜt
 = 
¬¿y
('additions' => 0, 'updates' => 0, 'deletes' => 0, 'skips' => 0);

1269 
	g$h—d”dÚe
 = 
FALSE
;

1270 
	g$¡ršgs
 = 
¬¿y
();

1272 
	g$İ
) {

1275  
$¡ršgs
;

1279 
$¡ršgs
[
$v®ue
['msgid']] = $value['msgstr'];

1284  
¬¿y
(
$h—d”dÚe
, 
$»pÜt
['additions'], $report['updates'], $report['deletes'], $report['skips']);

1289 ià(
$v®ue
['msgid'] == '') {

1290 
$Ïnguages
 = 
Ïnguage_li¡
();

1291 ià((
	g$mode
 !ğ
LOCALE_IMPORT_KEEP
è|| 
em±y
(
$Ïnguages
[
$Ïng
]->
¶u¿ls
)) {

1295 
$h—d”
 = 
_loÿË_impÜt_·r£_h—d”
(
$v®ue
['msgstr']);

1298 ià(
is£t
(
$h—d”
["Plu¿l-FÜms"]è&& 
	g$p
 = 
_loÿË_impÜt_·r£_¶u¿l_fÜms
($h—d”["Plu¿l-FÜms"], 
$fe
->
f’ame
)) {

1299 
li¡
(
$Ålu¿ls
, 
$¶u¿l
èğ
$p
;

1300 
db_qu”y
("UPDATE {Ïnguages} SET…lu¿l ğ%d, fÜmuÏ = '%s' WHERE†ªguagğ'%s'", 
$Ålu¿ls
, 
$¶u¿l
, 
$Ïng
);

1303 
db_qu”y
("UPDATE {Ïnguages} SET…lu¿l ğ%d, fÜmuÏ = '%s' WHERE†ªguagğ'%s'", 0, '', 
$Ïng
);

1306 
	g$h—d”dÚe
 = 
TRUE
;

1311 
	g$comm’ts
 = 
_loÿË_impÜt_shÜ‹n_comm’ts
(
em±y
(
$v®ue
['#']è? 
¬¿y
() : $value['#']);

1313 ià(
¡½os
(
$v®ue
['msgid'], "\0")) {

1315 
	g$’glish
 = 
ex¶ode
("\0", 
$v®ue
['msgid'], 2);

1316 
	g$’Œ›s
 = 
¬¿y_keys
(
$v®ue
['msgstr']);

1317 
	g$i
 = 3; $˜<ğ
couÁ
(
$’Œ›s
); $i++) {

1318 
	g$’glish
[] = 
$’glish
[1];

1320 
	g$Œª¦©iÚ
 = 
¬¿y_m­
('_loÿË_impÜt_­³nd_¶u¿l', 
$v®ue
['msg¡r'], 
$’Œ›s
);

1321 
	g$’glish
 = 
¬¿y_m­
('_loÿË_impÜt_­³nd_¶u¿l', 
$’glish
, 
$’Œ›s
);

1322 
fÜ—ch
 (
$Œª¦©iÚ
 
as
 
$key
 => 
$Œªs
) {

1323 ià(
$key
 == 0) {

1324 
$¶id
 = 0;

1326 
	g$¶id
 = 
_loÿË_impÜt_Úe_¡ršg_db
(
$»pÜt
, 
$Ïng
, 
$’glish
[
$key
], 
$Œªs
, 
$group
, 
$comm’ts
, 
$mode
, 
$¶id
, $key);

1332 
	g$’glish
 = 
$v®ue
['msgid'];

1333 
	g$Œª¦©iÚ
 = 
$v®ue
['msgstr'];

1334 
_loÿË_impÜt_Úe_¡ršg_db
(
$»pÜt
, 
$Ïng
, 
$’glish
, 
$Œª¦©iÚ
, 
$group
, 
$comm’ts
, 
$mode
);

1365 
funùiÚ
 
	$_loÿË_impÜt_Úe_¡ršg_db
(&
$»pÜt
, 
$Ïngcode
, 
$sourû
, 
$Œª¦©iÚ
, 
$‹xtgroup
, 
$loÿtiÚ
, 
$mode
, 
$¶id
 = 
NULL
, 
$¶u¿l
 = NULL) {

1366 
$lid
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT†id FROM {loÿËs_sourû} WHERE sourû = '%s' ANDextgrou°ğ'%s'", 
$sourû
, 
$‹xtgroup
));

1368 ià(!
	`em±y
(
$Œª¦©iÚ
)) {

1372 ià(
$‹xtgroup
 =ğ"deçuÉ" && !
	`loÿË_¡ršg_is_§ã
(
$Œª¦©iÚ
)) {

1373 
$»pÜt
['skips']++;

1374 
$lid
 = 0;

1376 
	`–£if
 (
$lid
) {

1378 
	`db_qu”y
("UPDATE {loÿËs_sourû} SET†oÿtiÚ = '%s' WHERE†id = %d", 
$loÿtiÚ
, 
$lid
);

1379 
$exi¡s
 = (
boŞ
è
	`db_»suÉ
(
	`db_qu”y
("SELECT†id FROM {loÿËs_rg‘} WHERE†id = %d AND†ªguagğ'%s'", 
$lid
, 
$Ïngcode
));

1380 ià(!
$exi¡s
) {

1382 
	`db_qu”y
("INSERT INTO {loÿËs_rg‘} (lid,†ªguage,¿n¦©iÚ,…lid,…lu¿lèVALUES (%d, '%s', '%s', %d, %d)", 
$lid
, 
$Ïngcode
, 
$Œª¦©iÚ
, 
$¶id
, 
$¶u¿l
);

1383 
$»pÜt
['additions']++;

1385 ià(
$mode
 =ğ
LOCALE_IMPORT_OVERWRITE
) {

1387 
	`db_qu”y
("UPDATE {loÿËs_rg‘} SET¿n¦©iÚ = '%s',…lid = %d,…lu¿Èğ%d WHERE†ªguagğ'%s' AND†id = %d", 
$Œª¦©iÚ
, 
$¶id
, 
$¶u¿l
, 
$Ïngcode
, 
$lid
);

1388 
$»pÜt
['updates']++;

1393 
	`db_qu”y
("INSERT INTO {loÿËs_sourû} (loÿtiÚ, sourû,extgroupèVALUES ('%s', '%s', '%s')", 
$loÿtiÚ
, 
$sourû
, 
$‹xtgroup
);

1394 
$lid
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT†id FROM {loÿËs_sourû} WHERE sourû = '%s' ANDextgrou°ğ'%s'", 
$sourû
, 
$‹xtgroup
));

1395 
	`db_qu”y
("INSERT INTO {loÿËs_rg‘} (lid,†ªguage,¿n¦©iÚ,…lid,…lu¿lèVALUES (%d, '%s', '%s', %d, %d)", 
$lid
, 
$Ïngcode
, 
$Œª¦©iÚ
, 
$¶id
, 
$¶u¿l
);

1396 
$»pÜt
['additions']++;

1399 
	`–£if
 (
$mode
 =ğ
LOCALE_IMPORT_OVERWRITE
) {

1401 
	`db_qu”y
("DELETE FROM {loÿËs_rg‘} WHERE†ªguagğ'%s' AND†id = %d AND…lid = %d AND…lu¿Èğ%d", 
$Ïngcode
, 
$lid
, 
$¶id
, 
$¶u¿l
);

1402 
$»pÜt
['deletes']++;

1405  
$lid
;

1406 
	}
}

1416 
funùiÚ
 
	$_loÿË_impÜt_·r£_h—d”
(
$h—d”
) {

1417 
$h—d”_·r£d
 = 
	`¬¿y
();

1418 
$lšes
 = 
	`¬¿y_m­
('Œim', 
	`ex¶ode
("\n", 
$h—d”
));

1419 
	`fÜ—ch
 (
$lšes
 
as
 
$lše
) {

1420 ià(
$lše
) {

1421 
	`li¡
(
$g
, 
$cÚ‹Ás
èğ
	`ex¶ode
(":", 
$lše
, 2);

1422 
$h—d”_·r£d
[
	`Œim
(
$g
)] =rim(
$cÚ‹Ás
);

1425  
$h—d”_·r£d
;

1426 
	}
}

1439 
funùiÚ
 
	$_loÿË_impÜt_·r£_¶u¿l_fÜms
(
$¶u¿lfÜms
, 
$f’ame
) {

1441 
$¶u¿lfÜms
 = 
	`¡¹r
($¶u¿lfÜms, 
	`¬¿y
(" " => "", "\t" => ""));

1444 
$Ålu¿ls
 = 
	`¡r¡r
(
$¶u¿lfÜms
, "nplurals=");

1445 ià(
	`¡½os
(
$Ålu¿ls
, ";")) {

1446 
$Ålu¿ls
 = 
	`sub¡r
($Ålu¿ls, 9, 
	`¡½os
($nplurals, ";") - 9);

1449  
FALSE
;

1451 
$¶u¿l
 = 
	`¡r¡r
(
$¶u¿lfÜms
, "plural=");

1452 ià(
	`¡½os
(
$¶u¿l
, ";")) {

1453 
$¶u¿l
 = 
	`sub¡r
($¶u¿l, 7, 
	`¡½os
($plural, ";") - 7);

1456  
FALSE
;

1460 
$¶u¿l
 = 
	`_loÿË_impÜt_·r£_¬™hm‘ic
($plural);

1462 ià(
$¶u¿l
 !=ğ
FALSE
) {

1463  
	`¬¿y
(
$Ålu¿ls
, 
$¶u¿l
);

1466 
	`dru·l_£t_mes§ge
(
	`t
('ThŒª¦©iÚ f%f’amcÚš ªƒ¼Ü:h¶u¿ÈfÜmuÏ could‚Ù b·r£d.', 
	`¬¿y
('%f’ame' => 
$f’ame
)), 'error');

1467  
FALSE
;

1469 
	}
}

1482 
funùiÚ
 
	$_loÿË_impÜt_·r£_¬™hm‘ic
(
$¡ršg
) {

1484 
$´ec
 = 
	`¬¿y
("(" => -1, ")" => -1, "?" => 1, ":" => 1, "||" => 3, "&&" => 4, "==" => 5, "!=" => 5, "<" => 6, ">" => 6, "<=" => 6, ">=" => 6, "+" => 7, "-" => 7, "*" => 8, "/" => 8, "%" => 8);

1486 
$¿sc
 = 
	`¬¿y
("?" => 1, ":" => 1);

1488 
$tok’s
 = 
	`_loÿË_impÜt_tok’ize_fÜmuÏ
(
$¡ršg
);

1491 
$İ¡k
 = 
	`¬¿y
();

1492 
$–¡k
 = 
	`¬¿y
();

1494 
	`fÜ—ch
 (
$tok’s
 
as
 
$tok’
) {

1495 
$ùok
 = 
$tok’
;

1498 ià(
	`is_num”ic
(
$tok’
)) {

1499 
$–¡k
[] = 
$ùok
;

1501 
	`–£if
 (
$ùok
 == "n") {

1502 
$–¡k
[] = '$n';

1504 
	`–£if
 (
$ùok
 == "(") {

1505 
$İ¡k
[] = 
$ùok
;

1507 
	`–£if
 (
$ùok
 == ")") {

1508 
$tİİ
 = 
	`¬¿y_pİ
(
$İ¡k
);

1509 
	`is£t
(
$tİİ
) && ($topop != "(")) {

1510 
$–¡k
[] = 
$tİİ
;

1511 
$tİİ
 = 
	`¬¿y_pİ
(
$İ¡k
);

1514 
	`–£if
 (!
	`em±y
(
$´ec
[
$ùok
])) {

1517 
$tİİ
 = 
	`¬¿y_pİ
(
$İ¡k
);

1518 
	`is£t
(
$tİİ
è&& (
$´ec
[$tİİ] >ğ$´ec[
$ùok
]è&& !(($´ec[$tİİ] =ğ$´ec[$ùok]è&& !
	`em±y
(
$¿sc
[$topop]) && !empty($rasc[$ctok]))) {

1519 
$–¡k
[] = 
$tİİ
;

1520 
$tİİ
 = 
	`¬¿y_pİ
(
$İ¡k
);

1522 ià(
$tİİ
) {

1523 
$İ¡k
[] = 
$tİİ
;

1525 
$İ¡k
[] = 
$ùok
;

1528  
FALSE
;

1533 
$tİİ
 = 
	`¬¿y_pİ
(
$İ¡k
);

1534 
$tİİ
 !ğ
NULL
) {

1535 
$–¡k
[] = 
$tİİ
;

1536 
$tİİ
 = 
	`¬¿y_pİ
(
$İ¡k
);

1540 
$´evsize
 = 
	`couÁ
(
$–¡k
) + 1;

1541 
	`couÁ
(
$–¡k
è< 
$´evsize
) {

1542 
$´evsize
 = 
	`couÁ
(
$–¡k
);

1543 
$i
 = 2; $˜< 
	`couÁ
(
$–¡k
); $i++) {

1544 
$İ
 = 
$–¡k
[
$i
];

1545 ià(!
	`em±y
(
$´ec
[
$İ
])) {

1546 
$f
 = "";

1547 ià(
$İ
 == ":") {

1548 
$f
 = 
$–¡k
[
$i
 - 2] ."):". $elstk[$i - 1] .")";

1550 
	`–£if
 (
$İ
 == "?") {

1551 
$f
 = "(". 
$–¡k
[
$i
 - 2] ."?(". $elstk[$i - 1];

1554 
$f
 = "(". 
$–¡k
[
$i
 - 2] . 
$İ
 . $elstk[$i - 1] .")";

1556 
	`¬¿y_¥liû
(
$–¡k
, 
$i
 - 2, 3, 
$f
);

1563 ià(
	`couÁ
(
$–¡k
) == 1) {

1564  
$–¡k
[0];

1567  
FALSE
;

1569 
	}
}

1579 
funùiÚ
 
	$_loÿË_impÜt_tok’ize_fÜmuÏ
(
$fÜmuÏ
) {

1580 
$fÜmuÏ
 = 
	`¡r_»¶aû
(" ", "", $formula);

1581 
$tok’s
 = 
	`¬¿y
();

1582 
$i
 = 0; $˜< 
	`¡¾’
(
$fÜmuÏ
); $i++) {

1583 ià(
	`is_num”ic
(
$fÜmuÏ
[
$i
])) {

1584 
$num
 = 
$fÜmuÏ
[
$i
];

1585 
$j
 = 
$i
 + 1;

1586 
$j
 < 
	`¡¾’
(
$fÜmuÏ
è&& 
	`is_num”ic
($formula[$j])) {

1587 
$num
 .ğ
$fÜmuÏ
[
$j
];

1588 
$j
++;

1590 
$i
 = 
$j
 - 1;

1591 
$tok’s
[] = 
$num
;

1593 
	`–£if
 (
$pos
 = 
	`¡½os
(" =<>!&|", 
$fÜmuÏ
[
$i
])) {

1594 
$Ãxt
 = 
$fÜmuÏ
[
$i
 + 1];

1595 
$pos
) {

1600 ià(
$Ãxt
 == '=') {

1601 
$tok’s
[] = 
$fÜmuÏ
[
$i
] .'=';

1602 
$i
++;

1605 
$tok’s
[] = 
$fÜmuÏ
[
$i
];

1609 ià(
$Ãxt
 == '&') {

1610 
$tok’s
[] = '&&';

1611 
$i
++;

1614 
$tok’s
[] = 
$fÜmuÏ
[
$i
];

1618 ià(
$Ãxt
 == '|') {

1619 
$tok’s
[] = '||';

1620 
$i
++;

1623 
$tok’s
[] = 
$fÜmuÏ
[
$i
];

1629 
$tok’s
[] = 
$fÜmuÏ
[
$i
];

1632  
$tok’s
;

1633 
	}
}

1645 
funùiÚ
 
	$_loÿË_impÜt_­³nd_¶u¿l
(
$’Œy
, 
$key
) {

1647 ià(
$key
 == 0 || $key == 1) {

1648  
$’Œy
;

1652 
$’Œy
 = 
	`´eg_»¶aû
('/(@count)\[[0-9]\]/', '\\1', $entry);

1653  
	`´eg_»¶aû
('/(@couÁ)/', "\\1[$key]", 
$’Œy
);

1654 
	}
}

1664 
funùiÚ
 
	$_loÿË_impÜt_shÜ‹n_comm’ts
(
$comm’t
) {

1665 
$comm
 = '';

1666 
	`couÁ
(
$comm’t
)) {

1667 
$‹¡
 = 
$comm
 . 
	`sub¡r
(
	`¬¿y_shiá
(
$comm’t
), 1) .', ';

1668 ià(
	`¡¾’
(
$comm
) < 130) {

1669 
$comm
 = 
$‹¡
;

1675  
	`sub¡r
(
$comm
, 0, -2);

1676 
	}
}

1686 
funùiÚ
 
	$_loÿË_impÜt_·r£_quÙed
(
$¡ršg
) {

1687 ià(
	`sub¡r
(
$¡ršg
, 0, 1) != substr($string, -1, 1)) {

1688  
FALSE
;

1690 
$quÙe
 = 
	`sub¡r
(
$¡ršg
, 0, 1);

1691 
$¡ršg
 = 
	`sub¡r
($string, 1, -1);

1692 ià(
$quÙe
 == '"') {

1693  
	`¡rc¦ashes
(
$¡ršg
);

1695 
	`–£if
 (
$quÙe
 == "'") {

1696  
$¡ršg
;

1699  
FALSE
;

1701 
	}
}

1710 
funùiÚ
 
	$_loÿË_·r£_js_fe
(
$f•©h
) {

1711 
glob®
 
$Ïnguage
;

1714 
$fe
 = 
	`fe_g‘_cÚ‹Ás
(
$f•©h
);

1718 
	`´eg_m©ch_®l
('~[^\w]Dru·l\s*\.\s*t\s*\(\s*('. 
LOCALE_JS_STRING
 .')\s*[,\)]~s', 
$fe
, 
$t_m©ches
);

1721 
	`´eg_m©ch_®l
('~[^\w]Dru·l\s*\.\s*fÜm©Plu¿l\s*\(\s*.+?\s*,\s*('. 
LOCALE_JS_STRING
 .')\s*,\s*((?:(?:\'(?:\\\\\'|[^\'])*@couÁ(?:\\\\\'|[^\'])*\'|"(?:\\\\"|[^"])*@couÁ(?:\\\\"|[^"])*")(?:\s*\+\s*)?)+)\s*[,\)]~s', 
$fe
, 
$¶u¿l_m©ches
);

1724 
$®l_m©ches
 = 
	`¬¿y_m”ge
(
$¶u¿l_m©ches
[1], 
$t_m©ches
[1]);

1725 
	`fÜ—ch
 (
$®l_m©ches
 
as
 
$key
 => 
$¡ršg
) {

1726 
$¡ršgs
 = 
	`¬¿y
(
$¡ršg
);

1729 ià(
	`is£t
(
$¶u¿l_m©ches
[2][
$key
])) {

1730 
$¡ršgs
[] = 
$¶u¿l_m©ches
[2][
$key
];

1733 
	`fÜ—ch
 (
$¡ršgs
 
as
 
$key
 => 
$¡ršg
) {

1735 
$¡ršg
 = 
	`im¶ode
('', 
	`´eg_¥l™
('~(?<!\\\\)[\'"]\s*\+\s*[\'"]~s', 
	`sub¡r
($string, 1, -1)));

1737 
$»suÉ
 = 
	`db_qu”y
("SELECT†id,†oÿtiÚ FROM {loÿËs_sourû} WHERE sourû = '%s' ANDextgrou°ğ'deçuÉ'", 
$¡ršg
);

1738 ià(
$sourû
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1741 
$loÿtiÚs
 = 
	`´eg_¥l™
('~\s*;\s*~', 
$sourû
->
loÿtiÚ
);

1743 ià(!
	`š_¬¿y
(
$f•©h
, 
$loÿtiÚs
)) {

1744 
$loÿtiÚs
[] = 
$f•©h
;

1745 
$loÿtiÚs
 = 
	`im¶ode
('; ', $locations);

1748 
	`db_qu”y
("UPDATE {loÿËs_sourû} SET†oÿtiÚ = '%s' WHERE†id = %d", 
$loÿtiÚs
, 
$sourû
->
lid
);

1753 
	`db_qu”y
("INSERT INTO {loÿËs_sourû} (loÿtiÚ, sourû,extgroupèVALUES ('%s', '%s', 'deçuÉ')", 
$f•©h
, 
$¡ršg
);

1757 
	}
}

1775 
funùiÚ
 
_loÿË_expÜt_g‘_¡ršgs
(
$Ïnguage
 = 
NULL
, 
$group
 = 'default') {

1776 ià(
is£t
(
$Ïnguage
)) {

1777 
$»suÉ
 = 
db_qu”y
("SELECT s.lid, s.sourû, s.loÿtiÚ,.Œª¦©iÚ,.¶id,.¶u¿ÈFROM {loÿËs_sourû} s LEFT JOIN {loÿËs_rg‘} ON s.lid =.lid AND.Ïnguagğ'%s' WHERE s.‹xtgrou°ğ'%s' ORDER BY.¶id,.¶u¿l", 
$Ïnguage
->
Ïnguage
, 
$group
);

1780 
	g$»suÉ
 = 
db_qu”y
("SELECT s.lid, s.sourû, s.loÿtiÚ,.¶id,.¶u¿ÈFROM {loÿËs_sourû} s LEFT JOIN {loÿËs_rg‘} ON s.lid =.lid WHERE s.‹xtgrou°ğ'%s' ORDER BY.¶id,.¶u¿l", 
$group
);

1782 
	g$¡ršgs
 = 
¬¿y
();

1783 
	g$chd
 = 
db_ãtch_objeù
(
$»suÉ
)) {

1784 
$¡ršg
 = 
¬¿y
(

1785 'comm’t' => 
$chd
->
loÿtiÚ
,

1786 'sourû' => 
$chd
->
sourû
,

1787 'Œª¦©iÚ' => 
is£t
(
$chd
->
Œª¦©iÚ
) ? $child->translation : ''

1789 ià(
	g$chd
->
	g¶id
) {

1794 
	g$¡ršg
['chd'] = 
TRUE
;

1795 
	g$¡ršgs
[
$chd
->
¶id
]['¶u¿l'] = $chd->
lid
;

1797 
	g$¡ršgs
[
$chd
->
lid
] = 
$¡ršg
;

1799  
	g$¡ršgs
;

1815 
funùiÚ
 
_loÿË_expÜt_po_g’”©e
(
$Ïnguage
 = 
NULL
, 
$¡ršgs
 = 
¬¿y
(), 
$h—d”
 = NULL) {

1816 
glob®
 
$u£r
;

1818 ià(!
is£t
(
$h—d”
)) {

1819 ià(
is£t
(
$Ïnguage
)) {

1820 
	g$h—d”
 = '# '. 
$Ïnguage
->
Çme
 .'¿n¦©iÚ oà'. 
v¬ŸbË_g‘
('site_name', 'Drupal') ."\n";

1821 
	g$h—d”
 .ğ'# G’”©ed by '. 
$u£r
->
Çme
 .' <'. $u£r->
ma
 .">\n";

1822 
	g$h—d”
 .= "#\n";

1823 
	g$h—d”
 .= "msgid \"\"\n";

1824 
	g$h—d”
 .= "msgstr \"\"\n";

1825 
	g$h—d”
 .= "\"Project-Id-Version: PROJECT VERSION\\n\"\n";

1826 
	g$h—d”
 .ğ"\"POT-C»©iÚ-D©e: ". 
d©e
("Y-m-d H:iO") ."\\n\"\n";

1827 
	g$h—d”
 .ğ"\"PO-RevisiÚ-D©e: ". 
d©e
("Y-m-d H:iO") ."\\n\"\n";

1828 
	g$h—d”
 .= "\"Last-Translator: NAME <EMAIL@ADDRESS>\\n\"\n";

1829 
	g$h—d”
 .= "\"Language-Team: LANGUAGE <EMAIL@ADDRESS>\\n\"\n";

1830 
	g$h—d”
 .= "\"MIME-Version: 1.0\\n\"\n";

1831 
	g$h—d”
 .= "\"Content-Type:ext/plain; charset=utf-8\\n\"\n";

1832 
	g$h—d”
 .= "\"Content-Transfer-Encoding: 8bit\\n\"\n";

1833 ià(
	g$Ïnguage
->
	gfÜmuÏ
 && $Ïnguage->
	g¶u¿ls
) {

1834 
	g$h—d”
 .ğ"\"Plu¿l-FÜms:‚¶u¿ls=". 
$Ïnguage
->
¶u¿ls
 .";…lu¿l=". 
¡¹r
($Ïnguage->
fÜmuÏ
, 
¬¿y
('$' => '')) .";\\n\"\n";

1838 
	g$h—d”
 = "# LANGUAGEranslation of PROJECT\n";

1839 
	g$h—d”
 .= "# Copyright (c) YEAR NAME <EMAIL@ADDRESS>\n";

1840 
	g$h—d”
 .= "#\n";

1841 
	g$h—d”
 .= "msgid \"\"\n";

1842 
	g$h—d”
 .= "msgstr \"\"\n";

1843 
	g$h—d”
 .= "\"Project-Id-Version: PROJECT VERSION\\n\"\n";

1844 
	g$h—d”
 .ğ"\"POT-C»©iÚ-D©e: ". 
d©e
("Y-m-d H:iO") ."\\n\"\n";

1845 
	g$h—d”
 .= "\"PO-Revision-Date: YYYY-mm-DD HH:MM+ZZZZ\\n\"\n";

1846 
	g$h—d”
 .= "\"Last-Translator: NAME <EMAIL@ADDRESS>\\n\"\n";

1847 
	g$h—d”
 .= "\"Language-Team: LANGUAGE <EMAIL@ADDRESS>\\n\"\n";

1848 
	g$h—d”
 .= "\"MIME-Version: 1.0\\n\"\n";

1849 
	g$h—d”
 .= "\"Content-Type:ext/plain; charset=utf-8\\n\"\n";

1850 
	g$h—d”
 .= "\"Content-Transfer-Encoding: 8bit\\n\"\n";

1851 
	g$h—d”
 .= "\"Plural-Forms:‚plurals=INTEGER;…lural=EXPRESSION;\\n\"\n";

1855 
	g$ouut
 = 
$h—d”
 ."\n";

1857 
fÜ—ch
 (
$¡ršgs
 
as
 
$lid
 => 
$¡ršg
) {

1859 ià(!
is£t
(
$¡ršg
['child'])) {

1860 ià(
$¡ršg
['comment']) {

1861 
$ouut
 .ğ'#: '. 
$¡ršg
['comment'] ."\n";

1863 
	g$ouut
 .ğ'msgid '. 
_loÿË_expÜt_¡ršg
(
$¡ršg
['source']);

1864 ià(!
em±y
(
$¡ršg
['plural'])) {

1865 
	g$¶u¿l
 = 
$¡ršg
['plural'];

1866 
	g$ouut
 .ğ'msgid_¶u¿È'. 
_loÿË_expÜt_¡ršg
(
$¡ršgs
[
$¶u¿l
]['source']);

1867 ià(
is£t
(
$Ïnguage
)) {

1868 
	g$Œª¦©iÚ
 = 
$¡ršg
['translation'];

1869 
	g$i
 = 0; $˜< 
	g$Ïnguage
->
	g¶u¿ls
; $i++) {

1870 
	g$ouut
 .ğ'msg¡r['. 
$i
 .'] '. 
_loÿË_expÜt_¡ršg
(
$Œª¦©iÚ
);

1871 ià(
	g$¶u¿l
) {

1872 
	g$Œª¦©iÚ
 = 
_loÿË_expÜt_»move_¶u¿l
(
$¡ršgs
[
$¶u¿l
]['translation']);

1873 
	g$¶u¿l
 = 
is£t
(
$¡ršgs
[
$¶u¿l
]['plural']) ? $strings[$plural]['plural'] : 0;

1876 
	g$Œª¦©iÚ
 = '';

1881 
	g$ouut
 .= 'msgstr[0] ""'."\n";

1882 
	g$ouut
 .= 'msgstr[1] ""'."\n";

1886 
	g$ouut
 .ğ'msg¡¸'. 
_loÿË_expÜt_¡ršg
(
$¡ršg
['translation']);

1888 
	g$ouut
 .= "\n";

1891  
	g$ouut
;

1904 
funùiÚ
 
	$_loÿË_expÜt_po
(
$Ïnguage
 = 
NULL
, 
$ouut
 = NULL) {

1906 ià(
	`is£t
(
$Ïnguage
)) {

1907 
$f’ame
 = 
$Ïnguage
->
Ïnguage
 .'.po';

1908 
	`w©chdog
('loÿË', 'ExpÜ‹d %loÿË¿n¦©iÚ fe: %f’ame.', 
	`¬¿y
('%loÿË' => 
$Ïnguage
->
Çme
, '%f’ame' => 
$f’ame
));

1911 
$f’ame
 = 'drupal.pot';

1912 
	`w©chdog
('loÿË', 'ExpÜ‹d¿n¦©iÚ fe: %f’ame.', 
	`¬¿y
('%f’ame' => 
$f’ame
));

1915 
	`h—d”
("Content-Disposition:‡ttachment; filename=$filename");

1916 
	`h—d”
("Content-Type:ext/plain; charset=utf-8");

1917 
´št
 
$ouut
;

1918 
	`d›
();

1919 
	}
}

1924 
funùiÚ
 
	$_loÿË_expÜt_¡ršg
(
$¡r
) {

1925 
$¡ri
 = 
	`addc¦ashes
(
$¡r
, "\0..\37\\\"");

1926 
$·¹s
 = 
	`¬¿y
();

1929 
$¡ri
 != "") {

1930 
$i
 = 
	`¡½os
(
$¡ri
, "\\n");

1931 ià(
$i
 ==ğ
FALSE
) {

1932 
$cur¡r
 = 
$¡ri
;

1933 
$¡ri
 = "";

1936 
$cur¡r
 = 
	`sub¡r
(
$¡ri
, 0, 
$i
 + 2);

1937 
$¡ri
 = 
	`sub¡r
($¡ri, 
$i
 + 2);

1939 
$cu½¬ts
 = 
	`ex¶ode
("\n", 
	`_loÿË_expÜt_w¿p
(
$cur¡r
, 70));

1940 
$·¹s
 = 
	`¬¿y_m”ge
($·¹s, 
$cu½¬ts
);

1944 ià(
	`couÁ
(
$·¹s
) > 1) {

1945  "\"\"\n\"". 
	`im¶ode
("\"\n\"", 
$·¹s
) ."\"\n";

1948 
	`–£if
 (
	`couÁ
(
$·¹s
) == 1) {

1955 
	}
}

1960 
funùiÚ
 
	$_loÿË_expÜt_w¿p
(
$¡r
, 
$Ën
) {

1961 
$wÜds
 = 
	`ex¶ode
(' ', 
$¡r
);

1962 
$»t
 = 
	`¬¿y
();

1964 
$cur
 = "";

1965 
$n¡r
 = 1;

1966 
	`couÁ
(
$wÜds
)) {

1967 
$wÜd
 = 
	`¬¿y_shiá
(
$wÜds
);

1968 ià(
$n¡r
) {

1969 
$cur
 = 
$wÜd
;

1970 
$n¡r
 = 0;

1972 
	`–£if
 (
	`¡¾’
("$cu¸$wÜd"è> 
$Ën
) {

1973 
$»t
[] = 
$cur
 ." ";

1974 
$cur
 = 
$wÜd
;

1977 
$cur
 = "$cur $word";

1980 
$»t
[] = 
$cur
;

1982  
	`im¶ode
("\n", 
$»t
);

1983 
	}
}

1988 
funùiÚ
 
	$_loÿË_expÜt_»move_¶u¿l
(
$’Œy
) {

1989  
	`´eg_»¶aû
('/(@couÁ)\[[0-9]\]/', '\\1', 
$’Œy
);

1990 
	}
}

2003 
funùiÚ
 
	$_loÿË_Œª¦©e_£ek
() {

2004 
$ouut
 = '';

2007 ià(
$qu”y
 = 
	`_loÿË_Œª¦©e_£ek_qu”y
()) {

2008 
$još
 = "SELECT s.source, s.location, s.lid, s.textgroup,.translation,.language FROM {locales_source} s LEFT JOIN {locales_target} ON s.lid =.lid ";

2010 
$¬gum’ts
 = 
	`¬¿y
();

2011 
$lim™_Ïnguage
 = 
FALSE
;

2013 
$qu”y
['translation']) {

2015 
$wh”e
 = "WHERE (t.translation LIKE '%%%s%%')";

2016 
$Üd”by
 = "ORDER BY.translation";

2017 
$¬gum’ts
[] = 
$qu”y
['string'];

2020 
$wh”e
 = "WHERE (s.source LIKE '%%%s%%' AND.translation IS NULL)";

2021 
$Üd”by
 = "ORDER BY s.source";

2022 
$¬gum’ts
[] = 
$qu”y
['string'];

2026 
$wh”e
 = "WHERE (s.source LIKE '%%%s%%' OR.translation LIKE '%%%s%%')";

2027 
$Üd”by
 = '';

2028 
$¬gum’ts
[] = 
$qu”y
['string'];

2029 
$¬gum’ts
[] = 
$qu”y
['string'];

2032 
$grou¶im™
 = '';

2033 ià(!
	`em±y
(
$qu”y
['group']) && $query['group'] != 'all') {

2034 
$grou¶im™
 = " AND s.textgroup = '%s'";

2035 
$¬gum’ts
[] = 
$qu”y
['group'];

2038 
$qu”y
['language']) {

2041 
$sql
 = 
$još
 ." WHERE s.source LIKE '%%%s%%' $grouplimit ORDER BY s.source";

2042 
$¬gum’ts
 = 
	`¬¿y
(
$qu”y
['string']);

2043 ià(!
	`em±y
(
$grou¶im™
)) {

2044 
$¬gum’ts
[] = 
$qu”y
['group'];

2049 
$sql
 = "$join $where $grouplimit $orderby";

2053 
$sql
 = "$join AND.language = '%s' $where $grouplimit $orderby";

2054 
	`¬¿y_unshiá
(
$¬gum’ts
, 
$qu”y
['language']);

2056 
$lim™_Ïnguage
 = 
$qu”y
['language'];

2059 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
, 50, 0, 
NULL
, 
$¬gum’ts
);

2061 
$groups
 = 
	`moduË_švoke_®l
('locale', 'groups');

2062 
$h—d”
 = 
	`¬¿y
(
	`t
('Texˆgroup'),('SŒšg'), (
$lim™_Ïnguage
) ?('Language') :('Languages'),‡rray('data' =>('Operations'), 'colspan' => '2'));

2063 
$¬r
 = 
	`¬¿y
();

2064 
$loÿË
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

2065 
$¬r
[
$loÿË
->
lid
]['group'] = 
$groups
[$loÿË->
‹xtgroup
];

2066 
$¬r
[
$loÿË
->
lid
]['Ïnguages'][$loÿË->
Ïnguage
] = $loÿË->
Œª¦©iÚ
;

2067 
$¬r
[
$loÿË
->
lid
]['loÿtiÚ'] = $loÿË->
loÿtiÚ
;

2068 
$¬r
[
$loÿË
->
lid
]['sourû'] = $loÿË->
sourû
;

2070 
$rows
 = 
	`¬¿y
();

2071 
	`fÜ—ch
 (
$¬r
 
as
 
$lid
 => 
$v®ue
) {

2072 
$rows
[] = 
	`¬¿y
(

2073 
$v®ue
['group'],

2074 
	`¬¿y
('d©a' => 
	`check_¶aš
(
	`Œunÿ‹_utf8
(
$v®ue
['sourû'], 150, 
FALSE
, 
TRUE
)) .'<br /><small>'. $value['location'] .'</small>'),

2075 
	`¬¿y
('d©a' => 
	`_loÿË_Œª¦©e_Ïnguage_li¡
(
$v®ue
['Ïnguages'], 
$lim™_Ïnguage
), 'align' => 'center'),

2076 
	`¬¿y
('d©a' => 
	`l
(
	`t
('edit'), "admin/build/translate/edit/$lid"), 'class' => 'nowrap'),

2077 
	`¬¿y
('d©a' => 
	`l
(
	`t
('delete'), "admin/build/translate/delete/$lid"), 'class' => 'nowrap'),

2081 ià(
	`couÁ
(
$rows
)) {

2082 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

2083 ià(
$·g”
 = 
	`theme
('·g”', 
NULL
, 50)) {

2084 
$ouut
 .ğ
$·g”
;

2088 
$ouut
 .ğ
	`t
('No strings found for your search.');

2092  
$ouut
;

2093 
	}
}

2098 
funùiÚ
 
	$_loÿË_Œª¦©e_£ek_qu”y
() {

2099 
$qu”y
 = 
NULL
;

2100 ià(!
	`is£t
(
$qu”y
)) {

2101 
$qu”y
 = 
	`¬¿y
();

2102 
$f›lds
 = 
	`¬¿y
('string', 'language', 'translation', 'group');

2103 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
) {

2104 ià(
	`is£t
(
$_REQUEST
[
$f›ld
])) {

2105 
$qu”y
[
$f›ld
] = 
$_REQUEST
[$field];

2109  
$qu”y
;

2110 
	}
}

2125 
funùiÚ
 
	$_loÿË_šv®id©e_js
(
$Ïngcode
 = 
NULL
) {

2126 
$·r£d
 = 
	`v¬ŸbË_g‘
('javasüt_·r£d', 
	`¬¿y
());

2128 ià(
	`em±y
(
$Ïngcode
)) {

2130 
$Ïnguages
 = 
	`Ïnguage_li¡
();

2131 
	`un£t
(
$Ïnguages
['en']);

2132 
	`fÜ—ch
 (
$Ïnguages
 
as
 
$lcode
 => 
$d©a
) {

2133 
$·r£d
['»äesh:'. 
$lcode
] = 'waiting';

2138 
$·r£d
['»äesh:'. 
$Ïngcode
] = 'waiting';

2141 
	`v¬ŸbË_£t
('javasüt_·r£d', 
$·r£d
);

2142  
$·r£d
;

2143 
	}
}

2151 
funùiÚ
 
	$_loÿË_»bud_js
(
$Ïngcode
 = 
NULL
) {

2152 ià(!
	`is£t
(
$Ïngcode
)) {

2153 
glob®
 
$Ïnguage
;

2157 
$Ïnguages
 = 
	`Ïnguage_li¡
();

2158 
$Ïnguage
 = 
$Ïnguages
[
$Ïngcode
];

2163 
$»suÉ
 = 
	`db_qu”y
("SELECT s.lid, s.sourû,.¶id,.¶u¿l,.Œª¦©iÚ FROM {loÿËs_sourû} s LEFT JOIN {loÿËs_rg‘} ON s.lid =.lid AND.Ïnguagğ'%s' WHERE s.loÿtiÚ LIKE '%%.js%%' AND s.‹xtgrou°ğ'deçuÉ' ORDER BY.¶u¿ÈDESC", 
$Ïnguage
->
Ïnguage
);

2165 
$Œª¦©iÚs
 = 
$¶u¿ls
 = 
	`¬¿y
();

2166 
$d©a
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

2168 ià(!
	`em±y
(
$d©a
->
Œª¦©iÚ
)) {

2169 ià(
$d©a
->
¶u¿l
) {

2172 ià(!
	`is£t
(
$¶u¿ls
[
$d©a
->
¶id
])) {

2173 
$¶u¿ls
[
$d©a
->
¶id
] = 
	`¬¿y
($d©a->
¶u¿l
 => $d©a->
Œª¦©iÚ
);

2176 
$¶u¿ls
[
$d©a
->
¶id
] +ğ
	`¬¿y
($d©a->
¶u¿l
 => $d©a->
Œª¦©iÚ
);

2179 
	`–£if
 (
	`is£t
(
$¶u¿ls
[
$d©a
->
lid
])) {

2182 
$Œª¦©iÚs
[
$d©a
->
sourû
] = 
	`¬¿y
($d©a->
¶u¿l
 => $d©a->
Œª¦©iÚ
è+ 
$¶u¿ls
[$d©a->
lid
];

2183 
	`un£t
(
$¶u¿ls
[
$d©a
->
lid
]);

2188 
$Œª¦©iÚs
[
$d©a
->
sourû
] = $d©a->
Œª¦©iÚ
;

2194 
$d©a_hash
 = 
NULL
;

2195 
$d©a
 = 
$¡©us
 = '';

2196 ià(!
	`em±y
(
$Œª¦©iÚs
)) {

2198 
$d©a
 = "Drupal.locale = { ";

2200 ià(!
	`em±y
(
$Ïnguage
->
fÜmuÏ
)) {

2201 
$d©a
 .= "'pluralFormula': function(\$n) {„eturn Number({$language->formula}); }, ";

2204 
$d©a
 .ğ"'¡ršgs': ". 
	`dru·l_to_js
(
$Œª¦©iÚs
) ." };";

2205 
$d©a_hash
 = 
	`md5
(
$d©a
);

2210 
$dœ
 = 
	`fe_ü—‹_·th
(
	`v¬ŸbË_g‘
('locale_js_directory', 'languages'));

2213 
$chªged_hash
 = 
$Ïnguage
->
javasüt
 !ğ
$d©a_hash
;

2214 ià(!
	`em±y
(
$Ïnguage
->
javasüt
è&& (!
$d©a
 || 
$chªged_hash
)) {

2215 
	`fe_d–‘e
(
	`fe_ü—‹_·th
(
$dœ
 .'/'. 
$Ïnguage
->
Ïnguage
 .'_'. $Ïnguage->
javasüt
 .'.js'));

2216 
$Ïnguage
->
javasüt
 = '';

2217 
$¡©us
 = 'deleted';

2222 
$de¡
 = 
$dœ
 .'/'. 
$Ïnguage
->
Ïnguage
 .'_'. 
$d©a_hash
 .'.js';

2223 ià(
$d©a
 && (
$chªged_hash
 || !
	`fe_exi¡s
(
$de¡
))) {

2225 
	`fe_check_dœeùÜy
(
$dœ
, 
TRUE
);

2228 ià(
	`fe_§ve_d©a
(
$d©a
, 
$de¡
)) {

2229 
$Ïnguage
->
javasüt
 = 
$d©a_hash
;

2232 ià(
$¡©us
 == 'deleted') {

2233 
$¡©us
 = 'updated';

2237 
	`–£if
 (
$chªged_hash
) {

2238 
$¡©us
 = 'created';

2243 
$¡©us
 = 'rebuilt';

2247 
$Ïnguage
->
javasüt
 = '';

2248 
$¡©us
 = 'error';

2255 ià(
$¡©us
 && 
$chªged_hash
) {

2256 
	`db_qu”y
("UPDATE {Ïnguages} SET javasüˆğ'%s' WHERE†ªguagğ'%s'", 
$Ïnguage
->
javasüt
, $Ïnguage->
Ïnguage
);

2261 
$deçuÉ_Ïngcode
 = 
	`Ïnguage_deçuÉ
('language');

2262 ià(
$deçuÉ_Ïngcode
 =ğ
$Ïnguage
->
Ïnguage
) {

2263 
$deçuÉ
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT * FROM {Ïnguages} WHERE†ªguagğ'%s'", 
$deçuÉ_Ïngcode
));

2264 
	`v¬ŸbË_£t
('Ïnguage_deçuÉ', 
$deçuÉ
);

2269 
$¡©us
) {

2271 
	`w©chdog
('loÿË', 'Upd©ed JavaSüˆŒª¦©iÚ ffÜhÏnguag%Ïnguage.', 
	`¬¿y
('%Ïnguage' => 
	`t
(
$Ïnguage
->
Çme
)));

2272  
TRUE
;

2274 
	`w©chdog
('loÿË', 'JavaSüˆŒª¦©iÚ f%fe.j wa lo¡.', 
	`¬¿y
('%fe' => 
$Ïnguage
->
javasüt
), 
WATCHDOG_WARNING
);

2278 
	`w©chdog
('loÿË', 'C»©ed JavaSüˆŒª¦©iÚ ffÜhÏnguag%Ïnguage.', 
	`¬¿y
('%Ïnguage' => 
	`t
(
$Ïnguage
->
Çme
)));

2279  
TRUE
;

2281 
	`w©chdog
('loÿË', 'Removed JavaSüˆŒª¦©iÚ ffÜhÏnguag%Ïnguage, beÿu£‚ØŒª¦©iÚ cu¼’yƒxi¡ fÜh©†ªguage.', 
	`¬¿y
('%Ïnguage' => 
	`t
(
$Ïnguage
->
Çme
)));

2282  
TRUE
;

2284 
	`w©chdog
('loÿË', 'AÀ”rÜ occu¼ed duršg c»©iÚ oàthJavaSüˆŒª¦©iÚ ffÜhÏnguag%Ïnguage.', 
	`¬¿y
('%Ïnguage' => 
	`t
(
$Ïnguage
->
Çme
)), 
WATCHDOG_ERROR
);

2285  
FALSE
;

2288  
TRUE
;

2290 
	}
}

2295 
funùiÚ
 
	$_loÿË_Œª¦©e_Ïnguage_li¡
(
$Œª¦©iÚ
, 
$lim™_Ïnguage
) {

2297 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('moduË', 'loÿË'è.'/loÿË.css', 'moduË', '®l', 
FALSE
);

2299 
$Ïnguages
 = 
	`Ïnguage_li¡
();

2300 
	`un£t
(
$Ïnguages
['en']);

2301 
$ouut
 = '';

2302 
	`fÜ—ch
 (
$Ïnguages
 
as
 
$Ïngcode
 => 
$Ïnguage
) {

2303 ià(!
$lim™_Ïnguage
 || $lim™_Ïnguag=ğ
$Ïngcode
) {

2304 
$ouut
 .ğ(!
	`em±y
(
$Œª¦©iÚ
[
$Ïngcode
])) ? $langcode .' ' : "<em class=\"locale-untranslated\">$langcode</em> ";

2308  
$ouut
;

2309 
	}
}

2322 
funùiÚ
 
	$_loÿË_´•¬e_´edefšed_li¡
() {

2323 
$Ïnguages
 = 
	`Ïnguage_li¡
();

2324 
$´edefšed
 = 
	`_loÿË_g‘_´edefšed_li¡
();

2325 
	`fÜ—ch
 (
$´edefšed
 
as
 
$key
 => 
$v®ue
) {

2326 ià(
	`is£t
(
$Ïnguages
[
$key
])) {

2327 
	`un£t
(
$´edefšed
[
$key
]);

2331 ià(
	`couÁ
(
$v®ue
) > 1) {

2332 
$Šame
 = 
	`t
(
$v®ue
[0]);

2333 
$´edefšed
[
$key
] = (
$Šame
 =ğ
$v®ue
[1]) ? $tname : "$tname ($value[1])";

2336 
$´edefšed
[
$key
] = 
	`t
(
$v®ue
[0]);

2339 
	`asÜt
(
$´edefšed
);

2340  
$´edefšed
;

2341 
	}
}

2348 
funùiÚ
 
	$_loÿË_g‘_´edefšed_li¡
() {

2349  
	`¬¿y
(

2350 "¯" => 
	`¬¿y
("Afar"),

2351 "ab" => 
	`¬¿y
("Abkhazian", "Ğ°Ò§ÑÑƒĞ° Ğ±Ñ‹Ğ·ÑˆÓ™Ğ°"),

2352 "«" => 
	`¬¿y
("Avestan"),

2353 "af" => 
	`¬¿y
("Afrikaans"),

2354 "ak" => 
	`¬¿y
("Akan"),

2355 "am" => 
	`¬¿y
("Amharic", "áŠ áˆ›áˆ­áŠ›"),

2356 "¬" => 
	`¬¿y
("A¿bic", "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©", 
LANGUAGE_RTL
),

2357 "as" => 
	`¬¿y
("Assamese"),

2358 "av" => 
	`¬¿y
("Avar"),

2359 "ay" => 
	`¬¿y
("Aymara"),

2360 "az" => 
	`¬¿y
("Azerbaijani", "azÉ™rbaycan"),

2361 "ba" => 
	`¬¿y
("Bashkir"),

2362 "be" => 
	`¬¿y
("Belarusian", "Ğ‘ĞµĞ»Ğ°Ñ€ÑƒÑĞºĞ°Ñ"),

2363 "bg" => 
	`¬¿y
("Bulgarian", "Ğ‘ÑŠĞ»Ğ³Ğ°Ñ€ÑĞºĞ¸"),

2364 "bh" => 
	`¬¿y
("Bihari"),

2365 "bi" => 
	`¬¿y
("Bislama"),

2366 "bm" => 
	`¬¿y
("Bambara", "Bamanankan"),

2367 "bn" => 
	`¬¿y
("Bengali"),

2368 "bo" => 
	`¬¿y
("Tibetan"),

2369 "br" => 
	`¬¿y
("Breton"),

2370 "bs" => 
	`¬¿y
("Bosnian", "Bosanski"),

2371 "ÿ" => 
	`¬¿y
("Catalan", "CatalÃ "),

2372 "û" => 
	`¬¿y
("Chechen"),

2373 "ch" => 
	`¬¿y
("Chamorro"),

2374 "co" => 
	`¬¿y
("Corsican"),

2375 "ü" => 
	`¬¿y
("Cree"),

2376 "cs" => 
	`¬¿y
("Czech", "ÄŒeÅ¡tina"),

2377 "cu" => 
	`¬¿y
("Old Slavonic"),

2378 "cv" => 
	`¬¿y
("Chuvash"),

2379 "cy" => 
	`¬¿y
("Welsh", "Cymraeg"),

2380 "da" => 
	`¬¿y
("Danish", "Dansk"),

2381 "de" => 
	`¬¿y
("German", "Deutsch"),

2382 "dv" => 
	`¬¿y
("Maldivian"),

2383 "dz" => 
	`¬¿y
("Bhutani"),

2384 "“" => 
	`¬¿y
("Ewe", "ÆÊ‹É›"),

2385 "–" => 
	`¬¿y
("Greek", "Î•Î»Î»Î·Î½Î¹ÎºÎ¬"),

2386 "’" => 
	`¬¿y
("English"),

2387 "eo" => 
	`¬¿y
("Esperanto"),

2388 "es" => 
	`¬¿y
("Spanish", "EspaÃ±ol"),

2389 "‘" => 
	`¬¿y
("Estonian", "Eesti"),

2390 "eu" => 
	`¬¿y
("Basque", "Euskera"),

2391 "ç" => 
	`¬¿y
("P”sŸn", "ÙØ§Ø±Ø³ÛŒ", 
LANGUAGE_RTL
),

2392 "ff" => 
	`¬¿y
("Fulah", "Fulfulde"),

2393 "fi" => 
	`¬¿y
("Finnish", "Suomi"),

2394 "fj" => 
	`¬¿y
("Fiji"),

2395 "fo" => 
	`¬¿y
("Faeroese"),

2396 "ä" => 
	`¬¿y
("French", "FranÃ§ais"),

2397 "fy" => 
	`¬¿y
("Frisian", "Frysk"),

2398 "ga" => 
	`¬¿y
("Irish", "Gaeilge"),

2399 "gd" => 
	`¬¿y
("Scots Gaelic"),

2400 "gl" => 
	`¬¿y
("Galician", "Galego"),

2401 "gn" => 
	`¬¿y
("Guarani"),

2402 "gu" => 
	`¬¿y
("Gujarati"),

2403 "gv" => 
	`¬¿y
("Manx"),

2404 "ha" => 
	`¬¿y
("Hausa"),

2405 "he" => 
	`¬¿y
("Heb»w", "×¢×‘×¨×™×ª", 
LANGUAGE_RTL
),

2406 "hi" => 
	`¬¿y
("Hindi", "à¤¹à¤¿à¤¨à¥à¤¦à¥€"),

2407 "ho" => 
	`¬¿y
("Hiri Motu"),

2408 "hr" => 
	`¬¿y
("Croatian", "Hrvatski"),

2409 "hu" => 
	`¬¿y
("Hungarian", "Magyar"),

2410 "hy" => 
	`¬¿y
("Armenian", "Õ€Õ¡ÕµÕ¥Ö€Õ¥Õ¶"),

2411 "hz" => 
	`¬¿y
("Herero"),

2412 "Ÿ" => 
	`¬¿y
("Interlingua"),

2413 "id" => 
	`¬¿y
("Indonesian", "Bahasa Indonesia"),

2414 "›" => 
	`¬¿y
("Interlingue"),

2415 "ig" => 
	`¬¿y
("Igbo"),

2416 "ik" => 
	`¬¿y
("Inupiak"),

2417 "is" => 
	`¬¿y
("Icelandic", "Ãslenska"),

2418 "™" => 
	`¬¿y
("Italian", "Italiano"),

2419 "iu" => 
	`¬¿y
("Inuktitut"),

2420 "ja" => 
	`¬¿y
("Japanese", "æ—¥æœ¬èª"),

2421 "jv" => 
	`¬¿y
("Javanese"),

2422 "ka" => 
	`¬¿y
("Georgian"),

2423 "kg" => 
	`¬¿y
("Kongo"),

2424 "ki" => 
	`¬¿y
("Kikuyu"),

2425 "kj" => 
	`¬¿y
("Kwanyama"),

2426 "kk" => 
	`¬¿y
("Kazakh", "ÒšĞ°Ğ·Ğ°Ò›"),

2427 "kl" => 
	`¬¿y
("Greenlandic"),

2428 "km" => 
	`¬¿y
("Cambodian"),

2429 "kn" => 
	`¬¿y
("Kannada", "à²•à²¨à³à²¨à²¡"),

2430 "ko" => 
	`¬¿y
("Korean", "í•œêµ­ì–´"),

2431 "kr" => 
	`¬¿y
("Kanuri"),

2432 "ks" => 
	`¬¿y
("Kashmiri"),

2433 "ku" => 
	`¬¿y
("Kurdish", "KurdÃ®"),

2434 "kv" => 
	`¬¿y
("Komi"),

2435 "kw" => 
	`¬¿y
("Cornish"),

2436 "ky" => 
	`¬¿y
("Kirghiz", "ĞšÑ‹Ñ€Ğ³Ñ‹Ğ·"),

2437 "Ï" => 
	`¬¿y
("Latin", "Latina"),

2438 "lb" => 
	`¬¿y
("Luxembourgish"),

2439 "lg" => 
	`¬¿y
("Luganda"),

2440 "Ê" => 
	`¬¿y
("Lingala"),

2441 "lo" => 
	`¬¿y
("Laothian"),

2442 "É" => 
	`¬¿y
("Lithuanian", "LietuviÅ³"),

2443 "lv" => 
	`¬¿y
("Latvian", "LatvieÅ¡u"),

2444 "mg" => 
	`¬¿y
("Malagasy"),

2445 "mh" => 
	`¬¿y
("Marshallese"),

2446 "mi" => 
	`¬¿y
("Maori"),

2447 "mk" => 
	`¬¿y
("Macedonian", "ĞœĞ°ĞºĞµĞ´Ğ¾Ğ½ÑĞºĞ¸"),

2448 "ml" => 
	`¬¿y
("Malayalam", "à´®à´²à´¯à´¾à´³à´‚"),

2449 "mn" => 
	`¬¿y
("Mongolian"),

2450 "mo" => 
	`¬¿y
("Moldavian"),

2451 "mr" => 
	`¬¿y
("Marathi"),

2452 "ms" => 
	`¬¿y
("Malay", "Bahasa Melayu"),

2453 "mt" => 
	`¬¿y
("Maltese", "Malti"),

2454 "my" => 
	`¬¿y
("Burmese"),

2455 "Ç" => 
	`¬¿y
("Nauru"),

2456 "nd" => 
	`¬¿y
("North Ndebele"),

2457 "Ã" => 
	`¬¿y
("Nepali"),

2458 "ng" => 
	`¬¿y
("Ndonga"),

2459 "Æ" => 
	`¬¿y
("Dutch", "Nederlands"),

2460 "nb" => 
	`¬¿y
("Norwegian BokmÃ¥l", "BokmÃ¥l"),

2461 "Â" => 
	`¬¿y
("Norwegian Nynorsk", "Nynorsk"),

2462 "Ä" => 
	`¬¿y
("South Ndebele"),

2463 "nv" => 
	`¬¿y
("Navajo"),

2464 "ny" => 
	`¬¿y
("Chichewa"),

2465 "oc" => 
	`¬¿y
("Occitan"),

2466 "om" => 
	`¬¿y
("Oromo"),

2467 "Ü" => 
	`¬¿y
("Oriya"),

2468 "os" => 
	`¬¿y
("Ossetian"),

2469 "·" => 
	`¬¿y
("Punjabi"),

2470 "pi" => 
	`¬¿y
("Pali"),

2471 "¶" => 
	`¬¿y
("Polish", "Polski"),

2472 "ps" => 
	`¬¿y
("Pashto", "Ù¾ÚšØªÙˆ", 
LANGUAGE_RTL
),

2473 "±-±" => 
	`¬¿y
("Portuguese, Portugal", "PortuguÃªs"),

2474 "±-br" => 
	`¬¿y
("Portuguese, Brazil", "PortuguÃªs"),

2475 "qu" => 
	`¬¿y
("Quechua"),

2476 "rm" => 
	`¬¿y
("Rhaeto-Romance"),

2477 "º" => 
	`¬¿y
("Kirundi"),

2478 "ro" => 
	`¬¿y
("Romanian", "RomÃ¢nÄƒ"),

2479 "ru" => 
	`¬¿y
("Russian", "Ğ ÑƒÑÑĞºĞ¸Ğ¹"),

2480 "rw" => 
	`¬¿y
("Kinyarwanda"),

2481 "§" => 
	`¬¿y
("Sanskrit"),

2482 "sc" => 
	`¬¿y
("Sardinian"),

2483 "sd" => 
	`¬¿y
("Sindhi"),

2484 "£" => 
	`¬¿y
("Northern Sami"),

2485 "sg" => 
	`¬¿y
("Sango"),

2486 "sh" => 
	`¬¿y
("Serbo-Croatian"),

2487 "si" => 
	`¬¿y
("Sinhala", "à·ƒà·’à¶‚à·„à¶½"),

2488 "sk" => 
	`¬¿y
("Slovak", "SlovenÄina"),

2489 "¦" => 
	`¬¿y
("Slovenian", "SlovenÅ¡Äina"),

2490 "sm" => 
	`¬¿y
("Samoan"),

2491 "¢" => 
	`¬¿y
("Shona"),

2492 "so" => 
	`¬¿y
("Somali"),

2493 "sq" => 
	`¬¿y
("Albanian", "Shqip"),

2494 "¤" => 
	`¬¿y
("Serbian", "Ğ¡Ñ€Ğ¿ÑĞºĞ¸"),

2495 "ss" => 
	`¬¿y
("Siswati"),

2496 "¡" => 
	`¬¿y
("Sesotho"),

2497 "su" => 
	`¬¿y
("Sudanese"),

2498 "sv" => 
	`¬¿y
("Swedish", "Svenska"),

2499 "sw" => 
	`¬¿y
("Swahili", "Kiswahili"),

2500 "" => 
	`¬¿y
("Tamil", "à®¤à®®à®¿à®´à¯"),

2501 "‹" => 
	`¬¿y
("Telugu", "à°¤à±†à°²à±à°—à±"),

2502 "tg" => 
	`¬¿y
("Tajik"),

2503 "th" => 
	`¬¿y
("Thai", "à¸ à¸²à¸©à¸²à¹„à¸—à¸¢"),

2504 "ti" => 
	`¬¿y
("Tigrinya"),

2505 "tk" => 
	`¬¿y
("Turkmen"),

2506 "" => 
	`¬¿y
("Tagalog"),

2507 "Š" => 
	`¬¿y
("Setswana"),

2508 "to" => 
	`¬¿y
("Tonga"),

2509 "Œ" => 
	`¬¿y
("Turkish", "TÃ¼rkÃ§e"),

2510 "ts" => 
	`¬¿y
("Tsonga"),

2511 "‰" => 
	`¬¿y
("Tatar", "TatarÃ§a"),

2512 "tw" => 
	`¬¿y
("Twi"),

2513 "ty" => 
	`¬¿y
("Tahitian"),

2514 "ug" => 
	`¬¿y
("Uighur"),

2515 "uk" => 
	`¬¿y
("Ukrainian", "Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°"),

2516 "ur" => 
	`¬¿y
("Urdu", "Ø§Ø±Ø¯Ùˆ", 
LANGUAGE_RTL
),

2517 "uz" => 
	`¬¿y
("Uzbek", "o'zbek"),

2518 "ve" => 
	`¬¿y
("Venda"),

2519 "vi" => 
	`¬¿y
("Vietnamese", "Tiáº¿ng Viá»‡t"),

2520 "wo" => 
	`¬¿y
("Wolof"),

2521 "xh" => 
	`¬¿y
("Xhosa", "isiXhosa"),

2522 "yi" => 
	`¬¿y
("Yiddish"),

2523 "yo" => 
	`¬¿y
("Yoruba", "YorÃ¹bÃ¡"),

2524 "za" => 
	`¬¿y
("Zhuang"),

2525 "zh-hªs" => 
	`¬¿y
("Chinese, Simplified", "ç®€ä½“ä¸­æ–‡"),

2526 "zh-hªt" => 
	`¬¿y
("Chinese, Traditional", "ç¹é«”ä¸­æ–‡"),

2527 "zu" => 
	`¬¿y
("Zulu", "isiZulu"),

2529 
	}
}

2553 
funùiÚ
 
loÿË_b©ch_by_Ïnguage
(
$Ïngcode
, 
$fšished
 = 
NULL
, 
$sk
 = 
	$¬¿y
()) {

2555 
$fes
 = 
	`¬¿y
();

2556 
$compÚ’ts
 = 
	`¬¿y
();

2557 
$qu”y
 = "SELECT‚ame, filename FROM {system} WHERE status = 1";

2558 ià(
	`couÁ
(
$sk
)) {

2559 
$qu”y
 .ğ" AND‚amNOT IN (". 
	`db_¶aûhŞd”s
(
$sk
, 'varchar') .")";

2561 
$»suÉ
 = 
	`db_qu”y
(
$qu”y
, 
$sk
);

2562 
$compÚ’t
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

2567 
$fes
 = 
	`¬¿y_m”ge
($fes, 
	`fe_sÿn_dœeùÜy
(
	`dœÇme
(
$compÚ’t
->
f’ame
è.'/Œª¦©iÚs', '(^|\.)'. 
$Ïngcode
 .'\.po$', 
	`¬¿y
('.', '..', 'CVS'), 0, 
FALSE
));

2568 
$compÚ’ts
[] = 
$compÚ’t
->
Çme
;

2571  
	`_loÿË_b©ch_bud
(
$fes
, 
$fšished
, 
$compÚ’ts
);

2572 
	}
}

2585 
funùiÚ
 
loÿË_b©ch_by_compÚ’t
(
$compÚ’ts
, 
$fšished
 = '_locale_batch_system_finished') {

2586 
$fes
 = 
¬¿y
();

2587 
	g$Ïnguages
 = 
Ïnguage_li¡
('enabled');

2588 
un£t
(
$Ïnguages
[1]['en']);

2589 ià(
couÁ
(
$Ïnguages
[1])) {

2590 
	g$Ïnguage_li¡
 = 
još
('|', 
¬¿y_keys
(
$Ïnguages
[1]));

2592 
	g$»suÉ
 = 
db_qu”y
("SELECT‚ame, filename FROM {system} WHERE status = 1");

2593 
	g$compÚ’t
 = 
db_ãtch_objeù
(
$»suÉ
)) {

2594 ià(
š_¬¿y
(
$compÚ’t
->
Çme
, 
$compÚ’ts
)) {

2599 
$fes
 = 
¬¿y_m”ge
($fes, 
fe_sÿn_dœeùÜy
(
dœÇme
(
$compÚ’t
->
f’ame
è.'/Œª¦©iÚs', '(^|\.)('. 
$Ïnguage_li¡
 .')\.po$', 
¬¿y
('.', '..', 'CVS'), 0, 
FALSE
));

2602  
_loÿË_b©ch_bud
(
$fes
, 
$fšished
);

2604  
	gFALSE
;

2619 
funùiÚ
 
_loÿË_b©ch_bud
(
$fes
, 
$fšished
 = 
NULL
, 
$compÚ’ts
 = 
	$¬¿y
()) {

2620 
$t
 = 
	`g‘_t
();

2621 ià(
	`couÁ
(
$fes
)) {

2622 
$İ”©iÚs
 = 
	`¬¿y
();

2623 
	`fÜ—ch
 (
$fes
 
as
 
$fe
) {

2625 
$İ”©iÚs
[] = 
	`¬¿y
('_loÿË_b©ch_impÜt',‡¼ay(
$fe
->
f’ame
)); }

2626 
$b©ch
 = 
	`¬¿y
(

2627 'İ”©iÚs' => 
$İ”©iÚs
,

2628 't™Ë' => 
	`$t
('Importing interfaceranslations'),

2629 'š™_mes§ge' => 
	`$t
('Starting import'),

2630 '”rÜ_mes§ge' => 
	`$t
('Error importing interfaceranslations'),

2634 '#compÚ’ts' => 
$compÚ’ts
,

2636 ià(
	`is£t
(
$fšished
)) {

2637 
$b©ch
['fšished'] = 
$fšished
;

2639  
$b©ch
;

2641  
FALSE
;

2642 
	}
}

2652 
funùiÚ
 
	$_loÿË_b©ch_impÜt
(
$f•©h
, &
$cÚ‹xt
) {

2655 ià(
	`´eg_m©ch
('!(/|\.)([^\./]+)\.po$!', 
$f•©h
, 
$Ïngcode
)) {

2656 
$fe
 = (
objeù
è
	`¬¿y
('f’ame' => 
	`ba£Çme
(
$f•©h
), 'filepath' => $filepath);

2657 
	`_loÿË_impÜt_»ad_po
('db-¡Üe', 
$fe
, 
LOCALE_IMPORT_KEEP
, 
$Ïngcode
[2]);

2658 
$cÚ‹xt
['»suÉs'][] = 
$f•©h
;

2660 
	}
}

2666 
funùiÚ
 
	$_loÿË_b©ch_sy¡em_fšished
(
$sucûss
, 
$»suÉs
) {

2667 ià(
$sucûss
) {

2668 
	`dru·l_£t_mes§ge
(
	`fÜm©_¶u¿l
(
	`couÁ
(
$»suÉs
), 'Oneranslation file imported forhe‚ewly installed modules.', '@countranslation files imported forhe‚ewly installed modules.'));

2670 
	}
}

2676 
funùiÚ
 
	$_loÿË_b©ch_Ïnguage_fšished
(
$sucûss
, 
$»suÉs
) {

2677 ià(
$sucûss
) {

2678 
	`dru·l_£t_mes§ge
(
	`fÜm©_¶u¿l
(
	`couÁ
(
$»suÉs
), 'Oneranslation file imported forheƒnabled modules.', '@countranslation files imported forheƒnabled modules.'));

2680 
	}
}

	@/srv/http/subs/notes/www/includes/lock.inc

1 <?
php


66 
funùiÚ
 
	$lock_š™
() {

67 
glob®
 
$locks
;

69 
$locks
 = 
	`¬¿y
();

70 
	}
}

75 
funùiÚ
 
	$_lock_id
() {

76 
$lock_id
;

78 ià(!
	`is£t
(
$lock_id
)) {

80 
$lock_id
 = 
	`uniqid
(
	`mt_¿nd
(), 
TRUE
);

82 
	`»gi¡”_shutdown_funùiÚ
('lock_»Ëa£_®l', 
$lock_id
);

84  
$lock_id
;

85 
	}
}

97 
funùiÚ
 
	$lock_acquœe
(
$Çme
, 
$timeout
 = 30.0) {

98 
glob®
 
$locks
;

101 
$timeout
 = 
	`max
($timeout, 0.001);

102 
	`li¡
(
$u£c
, 
$£c
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

103 
$expœe
 = ()
$u£c
 + ()
$£c
 + 
$timeout
;

104 ià(
	`is£t
(
$locks
[
$Çme
])) {

106 ià(!
	`db_»suÉ
(
	`db_qu”y
("UPDATE {£m­hÜe} SETƒxpœğ%àWHERE‚amğ'%s' AND v®uğ'%s'", 
$expœe
, 
$Çme
, 
	`_lock_id
()))) {

108 
	`un£t
(
$locks
[
$Çme
]);

114 
$»Œy
 = 
FALSE
;

117 ià(@
	`db_qu”y
("INSERT INTO {£m­hÜe} (Çme, v®ue,ƒxpœeèVALUES ('%s', '%s', %f)", 
$Çme
, 
	`_lock_id
(), 
$expœe
)) {

119 
$locks
[
$Çme
] = 
TRUE
;

121 
$»Œy
 = 
FALSE
;

129 
$»Œy
 = $»Œy ? 
FALSE
 : 
	`lock_may_be_avaabË
(
$Çme
);

133 } 
$»Œy
);

135  
	`is£t
(
$locks
[
$Çme
]);

136 
	}
}

148 
funùiÚ
 
	$lock_may_be_avaabË
(
$Çme
) {

149 
$lock
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECTƒxpœe, v®uFROM {£m­hÜe} WHERE‚amğ'%s'", 
$Çme
));

150 ià(!
$lock
) {

151  
TRUE
;

153 
$expœe
 = (è
$lock
['expire'];

154 
	`li¡
(
$u£c
, 
$£c
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

155 
$now
 = ()
$u£c
 + ()
$£c
;

156 ià(
$now
 > 
$lock
['expire']) {

160 
	`db_qu”y
("DELETE FROM {£m­hÜe} WHERE‚amğ'%s' AND v®uğ'%s' ANDƒxpœ<ğ%f", 
$Çme
, 
$lock
['v®ue'], 0.0001 + 
$expœe
);

161  (
boŞ
)
	`db_afãùed_rows
();

163  
FALSE
;

164 
	}
}

182 
funùiÚ
 
	$lock_wa™
(
$Çme
, 
$d–ay
 = 30) {

184 
$d–ay
--) {

188 
	`¦“p
(1);

189 ià(
	`lock_may_be_avaabË
(
$Çme
)) {

191  
FALSE
;

195  
TRUE
;

196 
	}
}

206 
funùiÚ
 
	$lock_»Ëa£
(
$Çme
) {

207 
glob®
 
$locks
;

209 
	`un£t
(
$locks
[
$Çme
]);

210 
	`db_qu”y
("DELETE FROM {£m­hÜe} WHERE‚amğ'%s' AND v®uğ'%s'", 
$Çme
, 
	`_lock_id
());

211 
	}
}

216 
funùiÚ
 
	$lock_»Ëa£_®l
(
$lock_id
 = 
NULL
) {

217 
glob®
 
$locks
;

219 
$locks
 = 
	`¬¿y
();

220 ià(
	`em±y
(
$lock_id
)) {

221 
$lock_id
 = 
	`_lock_id
();

224 
	`db_qu”y
("DELETE FROM {£m­hÜe} WHERE v®uğ'%s'", 
	`_lock_id
());

225 
	}
}

	@/srv/http/subs/notes/www/includes/mail.inc

1 <?
php


83 
funùiÚ
 
dru·l_ma
(
$moduË
, 
$key
, 
$to
, 
$Ïnguage
, 
$·¿ms
 = 
¬¿y
(), 
$äom
 = 
NULL
, 
$£nd
 = 
TRUE
) {

84 
$deçuÉ_äom
 = 
v¬ŸbË_g‘
('s™e_ma', 
ši_g‘
('sendmail_from'));

87 
	g$mes§ge
 = 
¬¿y
(

88 'id' => 
$moduË
 .'_'. 
$key
,

89 'to' => 
$to
,

90 'äom' => 
is£t
(
$äom
è? $äom : 
$deçuÉ_äom
,

91 'Ïnguage' => 
$Ïnguage
,

92 '·¿ms' => 
$·¿ms
,

94 'body' => 
¬¿y
()

98 
	g$h—d”s
 = 
¬¿y
(

104 ià(
	g$deçuÉ_äom
) {

108 
	g$h—d”s
['From'] = 
$h—d”s
['S’d”'] = $h—d”s['R‘uº-P©h'] = $h—d”s['E¼Üs-To'] = 
$deçuÉ_äom
;

110 ià(
	g$äom
) {

111 
	g$h—d”s
['From'] = 
$äom
;

113 
	g$mes§ge
['h—d”s'] = 
$h—d”s
;

118 ià(
funùiÚ_exi¡s
(
$funùiÚ
 = 
$moduË
 .'_mail')) {

119 
$funùiÚ
(
$key
, 
$mes§ge
, 
$·¿ms
);

123 
dru·l_®‹r
('ma', 
$mes§ge
);

126 
	g$mes§ge
['body'] = 
is_¬¿y
(
$mes§ge
['body']è? 
dru·l_w¿p_ma
(
im¶ode
("\n\n", $message['body'])) : drupal_wrap_mail($message['body']);

129 ià(
	g$£nd
) {

130 
	g$mes§ge
['»suÉ'] = 
dru·l_ma_£nd
(
$mes§ge
);

133 ià(!
	g$mes§ge
['result']) {

134 
w©chdog
('ma', 'E¼Ü s’dšgƒ-ma (äom %äomØ%to).', 
¬¿y
('%äom' => 
$mes§ge
['äom'], '%to' => $mes§ge['to']), 
WATCHDOG_ERROR
);

135 
dru·l_£t_mes§ge
(
t
('Unableo sendƒ-mail. Please contacthe site‡dministrator ifhe…roblem…ersists.'), 'error');

139  
	g$mes§ge
;

173 
funùiÚ
 
	$dru·l_ma_£nd
(
$mes§ge
) {

175 ià(
	`v¬ŸbË_g‘
('sm_lib¿ry', ''è&& 
	`fe_exi¡s
(variable_get('smtp_library', ''))) {

176 
šşude_Úû
 './'. 
	`v¬ŸbË_g‘
('smtp_library', '');

177  
	`dru·l_ma_w¿µ”
(
$mes§ge
);

180 
$mimeh—d”s
 = 
	`¬¿y
();

181 
	`fÜ—ch
 (
$mes§ge
['h—d”s'] 
as
 
$Çme
 => 
$v®ue
) {

182 
$mimeh—d”s
[] = 
$Çme
 .': '. 
	`mime_h—d”_’code
(
$v®ue
);

184  
	`ma
(

185 
$mes§ge
['to'],

186 
	`mime_h—d”_’code
(
$mes§ge
['subject']),

189 
	`¡r_»¶aû
("\r", '', 
$mes§ge
['body']),

192 
	`još
("\n", 
$mimeh—d”s
)

195 
	}
}

211 
funùiÚ
 
dru·l_w¿p_ma
(
$‹xt
, 
$šd’t
 = '') {

213 
$‹xt
 = 
¡r_»¶aû
("\r", '', $text);

215 
	g$ş—n_šd’t
 = 
_dru·l_html_to_‹xt_ş—n
(
$šd’t
);

216 
	g$soá
 = 
¡½os
(
$ş—n_šd’t
, ' 'è==ğ
FALSE
;

218 ià(
¡½os
(
$‹xt
, "\n"è!=ğ
FALSE
) {

220 
$‹xt
 = 
´eg_»¶aû
('/ +\n/m', "\n", $text);

222 
	g$lšes
 = 
ex¶ode
("\n", 
$‹xt
);

223 
¬¿y_w®k
(
$lšes
, '_dru·l_w¿p_ma_lše', 
¬¿y
('soá' => 
$soá
, 'Ëngth' => 
¡¾’
(
$šd’t
)));

224 
	g$‹xt
 = 
im¶ode
("\n", 
$lšes
);

228 
_dru·l_w¿p_ma_lše
(
$‹xt
, 0, 
¬¿y
('soá' => 
$soá
, 'Ëngth' => 
¡¾’
(
$šd’t
)));

231 
	g$‹xt
 = 
´eg_»¶aû
('/^ +\n/m', "\n", 
$‹xt
);

233 
	g$‹xt
 = 
´eg_»¶aû
('/^(>| |From)/m', ' $1', 
$‹xt
);

235 
	g$‹xt
 = 
$šd’t
 . 
sub¡r
(
´eg_»¶aû
('/^/m', 
$ş—n_šd’t
, 
$‹xt
), 
¡¾’
($indent));

237  
	g$‹xt
;

261 
funùiÚ
 
	$dru·l_html_to_‹xt
(
$¡ršg
, 
$®lowed_gs
 = 
NULL
) {

263 
$suµÜ‹d_gs
;

264 ià(
	`em±y
(
$suµÜ‹d_gs
)) {

265 
$suµÜ‹d_gs
 = 
	`¬¿y
('a', 'em', 'i', 'strong', 'b', 'br', 'p', 'blockquote', 'ul', 'ol', 'li', 'dl', 'dt', 'dd', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr');

269 
$®lowed_gs
 = 
	`is£t
($®lowed_gsè? 
	`¬¿y_š‹r£ù
(
$suµÜ‹d_gs
, $allowed_tags) : $supported_tags;

272 
$¡ršg
 = 
	`_f‹r_htmlcÜ»ùÜ
(
	`f‹r_xss
($¡ršg, 
$®lowed_gs
));

275 
$¡ršg
 = 
	`´eg_»¶aû
('!</?(em|i)((?> +)[^>]*)?>!i', '/', $string);

276 
$¡ršg
 = 
	`´eg_»¶aû
('!</?(strong|b)((?> +)[^>]*)?>!i', '*', $string);

281 
	`_dru·l_html_to_ma_u¾s
(
NULL
, 
TRUE
);

282 
$·‰”n
 = '@(<a[^>]+?href="([^"]*)"[^>]*?>(.+?)</a>)@i';

283 
$¡ršg
 = 
	`´eg_»¶aû_ÿÎback
(
$·‰”n
, '_drupal_html_to_mail_urls', $string);

284 
$u¾s
 = 
	`_dru·l_html_to_ma_u¾s
();

285 
$foÙnÙes
 = '';

286 ià(
	`couÁ
(
$u¾s
)) {

287 
$foÙnÙes
 .= "\n";

288 
$i
 = 0, 
$max
 = 
	`couÁ
(
$u¾s
); $i < $max; $i++) {

289 
$foÙnÙes
 .ğ'['. (
$i
 + 1è.'] '. 
$u¾s
[$i] ."\n";

294 
$¥l™
 = 
	`´eg_¥l™
('/<([^>]+?)>/', 
$¡ršg
, -1, 
PREG_SPLIT_DELIM_CAPTURE
);

298 
$g
 = 
FALSE
;

299 
$ÿsšg
 = 
NULL
;

300 
$ouut
 = '';

301 
$šd’t
 = 
	`¬¿y
();

302 
$li¡s
 = 
	`¬¿y
();

303 
	`fÜ—ch
 (
$¥l™
 
as
 
$v®ue
) {

304 
$chunk
 = 
NULL
;

307 ià(
$g
) {

308 
	`li¡
(
$gÇme
èğ
	`ex¶ode
(' ', 
	`¡¹Şow”
(
$v®ue
), 2);

309 
$gÇme
) {

312 
	`¬¿y_unshiá
(
$li¡s
, '*');

315 
	`¬¿y_unshiá
(
$li¡s
, 1);

319 
	`¬¿y_shiá
(
$li¡s
);

320 
$chunk
 = '';

326 
$šd’t
[] = 
	`couÁ
(
$li¡s
) ? ' "' : '>';

329 
$šd’t
[] = 
	`is_num”ic
(
$li¡s
[0]) ? ' '. $lists[0]++ .') ' : ' * ';

332 
$šd’t
[] = ' ';

335 
$šd’t
[] = '.... ';

338 
$šd’t
[] = '.. ';

341 ià(
	`couÁ
(
$li¡s
)) {

343 
$ouut
 = 
	`¹rim
($output, "> \n") ."\"\n";

344 
$chunk
 = '';

349 
	`¬¿y_pİ
(
$šd’t
);

353 
	`¬¿y_pİ
(
$šd’t
);

356 
$chunk
 = '';

361 
$šd’t
[] = '======== ';

362 
$ÿsšg
 = 'drupal_strtoupper';

365 
$šd’t
[] = '-------- ';

366 
$ÿsšg
 = 'drupal_strtoupper';

370 
$ÿsšg
 = 
NULL
;

372 
$ouut
 = 
	`_dru·l_html_to_‹xt_·d
($ouut, (
$gÇme
 == '/h1') ? '=' : '-', ' ');

373 
	`¬¿y_pİ
(
$šd’t
);

374 
$chunk
 = '';

380 
$ouut
 .ğ
	`dru·l_w¿p_ma
('', 
	`im¶ode
('', 
$šd’t
)) ."\n";

381 
$ouut
 = 
	`_dru·l_html_to_‹xt_·d
($output, '-');

387 
$chunk
 = '';

394 
$v®ue
 = 
	`Œim
(
	`´eg_»¶aû
('/\s+/', ' ', 
	`decode_’t™›s
($value)));

395 ià(
	`¡¾’
(
$v®ue
)) {

396 
$chunk
 = 
$v®ue
;

401 ià(
	`is£t
(
$chunk
)) {

403 ià(
	`is£t
(
$ÿsšg
)) {

404 
$chunk
 = 
	`$ÿsšg
($chunk);

407 
$ouut
 .ğ
	`dru·l_w¿p_ma
(
$chunk
, 
	`im¶ode
('', 
$šd’t
)) ."\n";

409 
$šd’t
 = 
	`¬¿y_m­
('_drupal_html_to_text_clean', $indent);

412 
$g
 = !$tag;

415  
$ouut
 . 
$foÙnÙes
;

416 
	}
}

423 
funùiÚ
 
	$_dru·l_w¿p_ma_lše
(&
$lše
, 
$key
, 
$v®ues
) {

425 
$lše
 = 
	`wÜdw¿p
($lše, 77 - 
$v®ues
['length'], $values['soft'] ? " \n" : "\n");

427 
$lše
 = 
	`wÜdw¿p
($lše, 996 - 
$v®ues
['length'], $values['soft'] ? " \n" : "\n");

428 
	}
}

435 
funùiÚ
 
	$_dru·l_html_to_ma_u¾s
(
$m©ch
 = 
NULL
, 
$»£t
 = 
FALSE
) {

436 
glob®
 
$ba£_u¾
, 
$ba£_·th
;

437 
$u¾s
 = 
	`¬¿y
(), 
$»gexp
;

439 ià(
$»£t
) {

441 
$u¾s
 = 
	`¬¿y
();

444 ià(
	`em±y
(
$»gexp
)) {

445 
$»gexp
 = '@^'. 
	`´eg_quÙe
(
$ba£_·th
, '@') .'@';

447 ià(
$m©ch
) {

448 
	`li¡
(, , 
$u¾
, 
$Ïb–
èğ
$m©ch
;

450 
$u¾s
[] = 
	`¡½os
(
$u¾
, '://'è? $u¾ : 
	`´eg_»¶aû
(
$»gexp
, 
$ba£_u¾
 .'/', $url);

451  
$Ïb–
 .' ['. 
	`couÁ
(
$u¾s
) .']';

454  
$u¾s
;

455 
	}
}

462 
funùiÚ
 
	$_dru·l_html_to_‹xt_ş—n
(
$šd’t
) {

463  
	`´eg_»¶aû
('/[^>]/', ' ', 
$šd’t
);

464 
	}
}

471 
funùiÚ
 
_dru·l_html_to_‹xt_·d
(
$‹xt
, 
$·d
, 
$´efix
 = '') {

473 
$‹xt
 = 
sub¡r
($text, 0, -1);

475 ià((
	g$p
 = 
¡¼pos
(
$‹xt
, "\n")è==ğ
FALSE
) {

476 
$p
 = -1;

478 
	g$n
 = 
max
(0, 79 - (
¡¾’
(
$‹xt
è- 
$p
è- sŒËn(
$´efix
));

480  
	g$‹xt
 . 
	g$´efix
 . 
¡r_»³©
(
$·d
, 
$n
) ."\n";

	@/srv/http/subs/notes/www/includes/menu.inc

1 <?
php


80 
defše
('MENU_IS_ROOT', 0x0001);

81 
defše
('MENU_VISIBLE_IN_TREE', 0x0002);

82 
defše
('MENU_VISIBLE_IN_BREADCRUMB', 0x0004);

83 
defše
('MENU_LINKS_TO_PARENT', 0x0008);

84 
defše
('MENU_MODIFIED_BY_ADMIN', 0x0020);

85 
defše
('MENU_CREATED_BY_ADMIN', 0x0040);

86 
defše
('MENU_IS_LOCAL_TASK', 0x0080);

104 
defše
('MENU_NORMAL_ITEM', 
MENU_VISIBLE_IN_TREE
 | 
MENU_VISIBLE_IN_BREADCRUMB
);

110 
defše
('MENU_CALLBACK', 
MENU_VISIBLE_IN_BREADCRUMB
);

118 
defše
('MENU_SUGGESTED_ITEM', 
MENU_VISIBLE_IN_BREADCRUMB
 | 0x0010);

125 
defše
('MENU_LOCAL_TASK', 
MENU_IS_LOCAL_TASK
);

131 
defše
('MENU_DEFAULT_LOCAL_TASK', 
MENU_IS_LOCAL_TASK
 | 
MENU_LINKS_TO_PARENT
);

143 
defše
('MENU_FOUND', 1);

144 
defše
('MENU_NOT_FOUND', 2);

145 
defše
('MENU_ACCESS_DENIED', 3);

146 
defše
('MENU_SITE_OFFLINE', 4);

161 
defše
('MENU_MAX_PARTS', 7);

167 
defše
('MENU_MAX_DEPTH', 9);

201 
funùiÚ
 
	$m’u_g‘_ªû¡Üs
(
$·¹s
) {

202 
$numb”_·¹s
 = 
	`couÁ
(
$·¹s
);

203 
$¶aûhŞd”s
 = 
	`¬¿y
();

204 
$ªû¡Üs
 = 
	`¬¿y
();

205 
$Ëngth
 = 
$numb”_·¹s
 - 1;

206 
$’d
 = (1 << 
$numb”_·¹s
) - 1;

207 
$masks
 = 
	`v¬ŸbË_g‘
('m’u_masks', 
	`¬¿y
());

209 
	`fÜ—ch
 (
$masks
 
as
 
$i
) {

210 ià(
$i
 > 
$’d
) {

214 
	`–£if
 (
$i
 < (1 << 
$Ëngth
)) {

216 --
$Ëngth
;

218 
$cu¼’t
 = '';

219 
$j
 = 
$Ëngth
; $j >= 0; $j--) {

220 ià(
$i
 & (1 << 
$j
)) {

221 
$cu¼’t
 .ğ
$·¹s
[
$Ëngth
 - 
$j
];

224 
$cu¼’t
 .= '%';

226 ià(
$j
) {

227 
$cu¼’t
 .= '/';

230 
$¶aûhŞd”s
[] = "'%s'";

231 
$ªû¡Üs
[] = 
$cu¼’t
;

233  
	`¬¿y
(
$ªû¡Üs
, 
$¶aûhŞd”s
);

234 
	}
}

256 
funùiÚ
 
	$m’u_un£rŸlize
(
$d©a
, 
$m­
) {

257 ià(
$d©a
 = 
	`un£rŸlize
($data)) {

258 
	`fÜ—ch
 (
$d©a
 
as
 
$k
 => 
$v
) {

259 ià(
	`is_št
(
$v
)) {

260 
$d©a
[
$k
] = 
	`is£t
(
$m­
[
$v
]) ? $map[$v] : '';

263  
$d©a
;

266  
	`¬¿y
();

268 
	}
}

283 
funùiÚ
 
	$m’u_£t_™em
(
$·th
, 
$rou‹r_™em
) {

284 
	`m’u_g‘_™em
(
$·th
, 
$rou‹r_™em
);

285 
	}
}

302 
funùiÚ
 
	$m’u_g‘_™em
(
$·th
 = 
NULL
, 
$rou‹r_™em
 = NULL) {

303 
$rou‹r_™ems
;

304 ià(!
	`is£t
(
$·th
)) {

305 
$·th
 = 
$_GET
['q'];

307 ià(
	`is£t
(
$rou‹r_™em
)) {

308 
$rou‹r_™ems
[
$·th
] = 
$rou‹r_™em
;

310 ià(!
	`is£t
(
$rou‹r_™ems
[
$·th
])) {

311 
$Üigš®_m­
 = 
	`¬g
(
NULL
, 
$·th
);

312 
$·¹s
 = 
	`¬¿y_¦iû
(
$Üigš®_m­
, 0, 
MENU_MAX_PARTS
);

313 
	`li¡
(
$ªû¡Üs
, 
$¶aûhŞd”s
èğ
	`m’u_g‘_ªû¡Üs
(
$·¹s
);

315 ià(
$rou‹r_™em
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y_¿nge
('SELECT * FROM {m’u_rou‹r} WHERE…©h IN ('. 
	`im¶ode
 (',', 
$¶aûhŞd”s
è.'èORDER BY f™ DESC', 
$ªû¡Üs
, 0, 1))) {

316 
$m­
 = 
	`_m’u_Œª¦©e
(
$rou‹r_™em
, 
$Üigš®_m­
);

317 ià(
$m­
 ==ğ
FALSE
) {

318 
$rou‹r_™ems
[
$·th
] = 
FALSE
;

319  
FALSE
;

321 ià(
$rou‹r_™em
['access']) {

322 
$rou‹r_™em
['m­'] = 
$m­
;

323 
$rou‹r_™em
['·ge_¬gum’ts'] = 
	`¬¿y_m”ge
(
	`m’u_un£rŸlize
($rou‹r_™em['·ge_¬gum’ts'], 
$m­
), 
	`¬¿y_¦iû
($map, $router_item['number_parts']));

326 
$rou‹r_™ems
[
$·th
] = 
$rou‹r_™em
;

328  
$rou‹r_™ems
[
$·th
];

329 
	}
}

334 
funùiÚ
 
	$m’u_execu‹_aùive_hªdËr
(
$·th
 = 
NULL
) {

335 ià(
	`_m’u_s™e_is_ofæše
()) {

336  
MENU_SITE_OFFLINE
;

340 ià(
	`v¬ŸbË_g‘
('m’u_»bud_Ãeded', 
FALSE
è|| !v¬ŸbË_g‘('m’u_masks', 
	`¬¿y
())) {

341 
	`m’u_»bud
();

343 ià(
$rou‹r_™em
 = 
	`m’u_g‘_™em
(
$·th
)) {

344 ià(
$rou‹r_™em
['access']) {

345 ià(
$rou‹r_™em
['file']) {

346 
	`»quœe_Úû
(
$rou‹r_™em
['file']);

348  
	`ÿÎ_u£r_func_¬¿y
(
$rou‹r_™em
['page_callback'], $router_item['page_arguments']);

351  
MENU_ACCESS_DENIED
;

354  
MENU_NOT_FOUND
;

355 
	}
}

371 
funùiÚ
 
	$_m’u_lßd_objeùs
(&
$™em
, &
$m­
) {

372 ià(
$lßd_funùiÚs
 = 
$™em
['load_functions']) {

374 ià(
$lßd_funùiÚs_un£rŸlized
 = 
	`un£rŸlize
(
$lßd_funùiÚs
)) {

375 
$lßd_funùiÚs
 = 
$lßd_funùiÚs_un£rŸlized
;

377 
$·th_m­
 = 
$m­
;

378 
	`fÜ—ch
 (
$lßd_funùiÚs
 
as
 
$šdex
 => 
$funùiÚ
) {

379 ià(
$funùiÚ
) {

380 
$v®ue
 = 
	`is£t
(
$·th_m­
[
$šdex
]) ? $path_map[$index] : '';

381 ià(
	`is_¬¿y
(
$funùiÚ
)) {

386 
	`li¡
(
$funùiÚ
, 
$¬gs
èğ
	`—ch
($function);

387 
$lßd_funùiÚs
[
$šdex
] = 
$funùiÚ
;

390 
	`fÜ—ch
 (
$¬gs
 
as
 
$i
 => 
$¬g
) {

391 ià(
$¬g
 === '%index') {

394 
$¬gs
[
$i
] = 
$šdex
;

396 ià(
$¬g
 === '%map') {

400 
$¬gs
[
$i
] = &
$m­
;

402 ià(
	`is_št
(
$¬g
)) {

403 
$¬gs
[
$i
] = 
	`is£t
(
$·th_m­
[
$¬g
]) ? $path_map[$arg] : '';

406 
	`¬¿y_unshiá
(
$¬gs
, 
$v®ue
);

407 
$»tuº
 = 
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
$¬gs
);

410 
$»tuº
 = 
	`$funùiÚ
(
$v®ue
);

413 ià(
$»tuº
 ==ğ
FALSE
) {

414 
$™em
['acûss'] = 
FALSE
;

415 
$m­
 = 
FALSE
;

416  
FALSE
;

418 
$m­
[
$šdex
] = 
$»tuº
;

421 
$™em
['lßd_funùiÚs'] = 
$lßd_funùiÚs
;

423  
TRUE
;

424 
	}
}

436 
funùiÚ
 
	$_m’u_check_acûss
(&
$™em
, 
$m­
) {

439 
$ÿÎback
 = 
	`em±y
(
$™em
['acûss_ÿÎback']è? 0 : 
	`Œim
($item['access_callback']);

441 ià(
	`is_num”ic
(
$ÿÎback
)) {

442 
$™em
['acûss'] = (
boŞ
)
$ÿÎback
;

445 
$¬gum’ts
 = 
	`m’u_un£rŸlize
(
$™em
['acûss_¬gum’ts'], 
$m­
);

448 ià(
$ÿÎback
 == 'user_access') {

449 
$™em
['acûss'] = (
	`couÁ
(
$¬gum’ts
è=ğ1è? 
	`u£r_acûss
($arguments[0]) : user_access($arguments[0], $arguments[1]);

452 
$™em
['acûss'] = 
	`ÿÎ_u£r_func_¬¿y
(
$ÿÎback
, 
$¬gum’ts
);

455 
	}
}

482 
funùiÚ
 
	$_m’u_™em_loÿlize
(&
$™em
, 
$m­
, 
$lšk_Œª¦©e
 = 
FALSE
) {

483 
$ÿÎback
 = 
$™em
['title_callback'];

484 
$™em
['localized_options'] = $item['options'];

491 ià(!
$lšk_Œª¦©e
 || (
$™em
['title'] == $item['link_title'])) {

494 ià(
$ÿÎback
 == 't') {

495 ià(
	`em±y
(
$™em
['title_arguments'])) {

496 
$™em
['t™Ë'] = 
	`t
($item['title']);

499 
$™em
['t™Ë'] = 
	`t
($™em['t™Ë'], 
	`m’u_un£rŸlize
($™em['t™Ë_¬gum’ts'], 
$m­
));

502 
	`–£if
 (
$ÿÎback
) {

503 ià(
	`em±y
(
$™em
['title_arguments'])) {

504 
$™em
['t™Ë'] = 
	`$ÿÎback
($item['title']);

507 
$™em
['t™Ë'] = 
	`ÿÎ_u£r_func_¬¿y
(
$ÿÎback
, 
	`m’u_un£rŸlize
($™em['t™Ë_¬gum’ts'], 
$m­
));

510 ià(
$ÿÎback
 == 'check_plain') {

511 
$™em
['loÿlized_İtiÚs']['html'] = 
TRUE
;

515 
	`–£if
 (
$lšk_Œª¦©e
) {

516 
$™em
['title'] = $item['link_title'];

520 ià(!
	`em±y
(
$™em
['description'])) {

521 
$Üigš®_desütiÚ
 = 
$™em
['description'];

522 
$™em
['desütiÚ'] = 
	`t
($item['description']);

523 ià(
$lšk_Œª¦©e
 && 
	`is£t
(
$™em
['İtiÚs']['©Œibu‹s']['t™Ë']è&& $™em['İtiÚs']['©Œibu‹s']['t™Ë'] =ğ
$Üigš®_desütiÚ
) {

524 
$™em
['localized_options']['attributes']['title'] = $item['description'];

527 
	}
}

558 
funùiÚ
 
	$_m’u_Œª¦©e
(&
$rou‹r_™em
, 
$m­
, 
$to_¬g
 = 
FALSE
) {

559 ià(
$to_¬g
) {

561 
	`_m’u_lšk_m­_Œª¦©e
(
$m­
, 
$rou‹r_™em
['to_arg_functions']);

565 
$·th_m­
 = 
$m­
;

566 ià(!
	`_m’u_lßd_objeùs
(
$rou‹r_™em
, 
$m­
)) {

568 
$rou‹r_™em
['acûss'] = 
FALSE
;

569  
FALSE
;

573 
$lšk_m­
 = 
	`ex¶ode
('/', 
$rou‹r_™em
['path']);

574 
$i
 = 0; $˜< 
$rou‹r_™em
['number_parts']; $i++) {

575 ià(
$lšk_m­
[
$i
] == '%') {

576 
$lšk_m­
[
$i
] = 
$·th_m­
[$i];

579 
$rou‹r_™em
['h»f'] = 
	`im¶ode
('/', 
$lšk_m­
);

580 
$rou‹r_™em
['İtiÚs'] = 
	`¬¿y
();

581 
	`_m’u_check_acûss
(
$rou‹r_™em
, 
$m­
);

584 ià(
$rou‹r_™em
['access']) {

585 
	`_m’u_™em_loÿlize
(
$rou‹r_™em
, 
$m­
);

588  
$m­
;

589 
	}
}

601 
funùiÚ
 
	$_m’u_lšk_m­_Œª¦©e
(&
$m­
, 
$to_¬g_funùiÚs
) {

602 ià(
$to_¬g_funùiÚs
) {

603 
$to_¬g_funùiÚs
 = 
	`un£rŸlize
($to_arg_functions);

604 
	`fÜ—ch
 (
$to_¬g_funùiÚs
 
as
 
$šdex
 => 
$funùiÚ
) {

606 
$¬g
 = 
	`$funùiÚ
(!
	`em±y
(
$m­
[
$šdex
]) ? $map[$index] : '', $map, $index);

607 ià(!
	`em±y
(
$m­
[
$šdex
]è|| 
	`is£t
(
$¬g
)) {

608 
$m­
[
$šdex
] = 
$¬g
;

611 
	`un£t
(
$m­
[
$šdex
]);

615 
	}
}

617 
funùiÚ
 
	$m’u__to_¬g
(
$¬g
, 
$m­
, 
$šdex
) {

618  
	`im¶ode
('/', 
	`¬¿y_¦iû
(
$m­
, 
$šdex
));

619 
	}
}

636 
funùiÚ
 
	$_m’u_lšk_Œª¦©e
(&
$™em
) {

637 
$™em
['İtiÚs'] = 
	`un£rŸlize
($item['options']);

638 ià(
$™em
['external']) {

639 
$™em
['access'] = 1;

640 
$m­
 = 
	`¬¿y
();

641 
$™em
['href'] = $item['link_path'];

642 
$™em
['title'] = $item['link_title'];

643 
$™em
['localized_options'] = $item['options'];

646 
$m­
 = 
	`ex¶ode
('/', 
$™em
['link_path']);

647 
	`_m’u_lšk_m­_Œª¦©e
(
$m­
, 
$™em
['to_arg_functions']);

648 
$™em
['h»f'] = 
	`im¶ode
('/', 
$m­
);

651 ià(
	`¡½os
(
$™em
['h»f'], '%'è!=ğ
FALSE
) {

652 
$™em
['acûss'] = 
FALSE
;

653  
FALSE
;

656 ià(!
	`is£t
(
$™em
['access'])) {

657 ià(!
	`_m’u_lßd_objeùs
(
$™em
, 
$m­
)) {

659 
$™em
['acûss'] = 
FALSE
;

660  
FALSE
;

662 
	`_m’u_check_acûss
(
$™em
, 
$m­
);

665 ià(
$™em
['access']) {

666 
	`_m’u_™em_loÿlize
(
$™em
, 
$m­
, 
TRUE
);

673 ià(!
	`em±y
(
$™em
['options']['alter'])) {

674 
	`dru·l_®‹r
('Œª¦©ed_m’u_lšk', 
$™em
, 
$m­
);

677  
$m­
;

678 
	}
}

700 
funùiÚ
 
m’u_g‘_objeù
(
$ty³
 = 'node', 
$pos™iÚ
 = 1, 
$·th
 = 
NULL
) {

701 
$rou‹r_™em
 = 
m’u_g‘_™em
(
$·th
);

702 ià(
is£t
(
$rou‹r_™em
['lßd_funùiÚs'][
$pos™iÚ
]è&& !
em±y
($rou‹r_™em['m­'][$pos™iÚ]è&& 
	g$rou‹r_™em
['lßd_funùiÚs'][$pos™iÚ] =ğ
$ty³
 .'_load') {

703  
$rou‹r_™em
['m­'][
$pos™iÚ
];

719 
funùiÚ
 
m’u_Œ“
(
$m’u_Çme
 = 'navigation') {

720 
$m’u_ouut
 = 
¬¿y
();

722 ià(!
is£t
(
$m’u_ouut
[
$m’u_Çme
])) {

723 
	g$Œ“
 = 
m’u_Œ“_·ge_d©a
(
$m’u_Çme
);

724 
	g$m’u_ouut
[
$m’u_Çme
] = 
m’u_Œ“_ouut
(
$Œ“
);

726  
	g$m’u_ouut
[
$m’u_Çme
];

737 
funùiÚ
 
	$m’u_Œ“_ouut
(
$Œ“
) {

738 
$ouut
 = '';

739 
$™ems
 = 
	`¬¿y
();

743 
	`fÜ—ch
 (
$Œ“
 
as
 
$d©a
) {

744 ià(!
$d©a
['link']['hidden']) {

745 
$™ems
[] = 
$d©a
;

749 
$num_™ems
 = 
	`couÁ
(
$™ems
);

750 
	`fÜ—ch
 (
$™ems
 
as
 
$i
 => 
$d©a
) {

751 
$exŒa_şass
 = 
	`¬¿y
();

752 ià(
$i
 == 0) {

753 
$exŒa_şass
[] = 'first';

755 ià(
$i
 =ğ
$num_™ems
 - 1) {

756 
$exŒa_şass
[] = 'last';

758 
$exŒa_şass
 = 
	`im¶ode
(' ', $extra_class);

759 
$lšk
 = 
	`theme
('m’u_™em_lšk', 
$d©a
['link']);

760 ià(
$d©a
['below']) {

761 
$ouut
 .ğ
	`theme
('m’u_™em', 
$lšk
, 
$d©a
['lšk']['has_chd»n'], 
	`m’u_Œ“_ouut
($d©a['b–ow']), $d©a['lšk']['š_aùive_Œa'], 
$exŒa_şass
);

764 
$ouut
 .ğ
	`theme
('m’u_™em', 
$lšk
, 
$d©a
['lšk']['has_chd»n'], '', $d©a['lšk']['š_aùive_Œa'], 
$exŒa_şass
);

767  
$ouut
 ? 
	`theme
('menu_tree', $output) : '';

768 
	}
}

785 
funùiÚ
 
m’u_Œ“_®l_d©a
(
$m’u_Çme
 = 'Çvig©iÚ', 
$™em
 = 
NULL
) {

786 
$Œ“
 = 
¬¿y
();

789 
	g$mlid
 = 
is£t
(
$™em
['mlid']) ? $item['mlid'] : 0;

791 
	g$cid
 = 'lšks:'. 
$m’u_Çme
 .':®l-cid:'. 
$mlid
;

793 ià(!
is£t
(
$Œ“
[
$cid
])) {

795 
	g$ÿche
 = 
ÿche_g‘
(
$cid
, 'cache_menu');

796 ià(
	g$ÿche
 && 
is£t
(
$ÿche
->
d©a
)) {

799 
	g$ÿche
 = 
ÿche_g‘
(
$ÿche
->
d©a
, 'cache_menu');

800 ià(
	g$ÿche
 && 
is£t
(
$ÿche
->
d©a
)) {

801 
	g$d©a
 = 
$ÿche
->
d©a
;

805 ià(!
is£t
(
$d©a
)) {

807 ià(
	g$mlid
) {

810 
	g$¬gs
 = 
¬¿y
(0);

811 
	g$i
 = 1; $˜< 
	gMENU_MAX_DEPTH
; $i++) {

812 
	g$¬gs
[] = 
$™em
["p$i"];

814 
	g$¬gs
 = 
¬¿y_unique
(
$¬gs
);

815 
	g$¶aûhŞd”s
 = 
im¶ode
(', ', 
¬¿y_fl
(0, 
couÁ
(
$¬gs
), '%d'));

816 
	g$wh”e
 = ' AND ml.¶id IN ('. 
$¶aûhŞd”s
 .')';

817 
	g$·»Ás
 = 
$¬gs
;

818 
	g$·»Ás
[] = 
$™em
['mlid'];

822 
	g$wh”e
 = '';

823 
	g$¬gs
 = 
¬¿y
();

824 
	g$·»Ás
 = 
¬¿y
();

826 
¬¿y_unshiá
(
$¬gs
, 
$m’u_Çme
);

830 
	g$d©a
['Œ“'] = 
m’u_Œ“_d©a
(
db_qu”y
("

831 
SELECT
 
m
.
lßd_funùiÚs
, m.
to_¬g_funùiÚs
, m.
acûss_ÿÎback
, m.
acûss_¬gum’ts
, m.
·ge_ÿÎback
, m.
·ge_¬gum’ts
, m.
t™Ë
, m.
t™Ë_ÿÎback
, m.
t™Ë_¬gum’ts
, m.
ty³
, m.
desütiÚ
, 
ml
.*

832 
FROM
 {
m’u_lšks
} 
ml
 
LEFT
 
JOIN
 {
m’u_rou‹r
} 
m
 
ON
 m.
·th
 = ml.
rou‹r_·th


833 
WHERE
 
ml
.
m’u_Çme
 = '%s'". $where ."

834 
ORDER
 
BY
 
p1
 
ASC
, 
p2
 ASC, 
p3
 ASC, 
p4
 ASC, 
p5
 ASC, 
p6
 ASC, 
p7
 ASC, 
p8
 ASC, 
p9
 ASC", $args), $parents);

835 
$d©a
['node_lšks'] = 
¬¿y
();

836 
m’u_Œ“_cŞËù_node_lšks
(
$d©a
['tree'], $data['node_links']);

838 
$Œ“_cid
 = 
_m’u_Œ“_cid
(
$m’u_Çme
, 
$d©a
);

839 ià(!
ÿche_g‘
(
$Œ“_cid
, 'cache_menu')) {

840 
ÿche_£t
(
$Œ“_cid
, 
$d©a
, 'cache_menu');

843 
ÿche_£t
(
$cid
, 
$Œ“_cid
, 'cache_menu');

846 
m’u_Œ“_check_acûss
(
$d©a
['tree'], $data['node_links']);

847 
$Œ“
[
$cid
] = 
$d©a
['tree'];

850  
$Œ“
[
$cid
];

868 
funùiÚ
 
m’u_Œ“_·ge_d©a
(
$m’u_Çme
 = 'navigation') {

869 
$Œ“
 = 
¬¿y
();

872 ià(
$™em
 = 
m’u_g‘_™em
()) {

874 
$cid
 = 'lšks:'. 
$m’u_Çme
 .':·ge-cid:'. 
$™em
['href'] .':'. ()$item['access'];

876 ià(!
is£t
(
$Œ“
[
$cid
])) {

878 
$ÿche
 = 
ÿche_g‘
(
$cid
, 'cache_menu');

879 ià(
$ÿche
 && 
is£t
($ÿche->
d©a
)) {

882 
$ÿche
 = 
ÿche_g‘
($ÿche->
d©a
, 'cache_menu');

883 ià(
$ÿche
 && 
is£t
($ÿche->
d©a
)) {

884 
$d©a
 = 
$ÿche
->
d©a
;

888 ià(!
is£t
(
$d©a
)) {

890 ià(
$™em
['access']) {

892 
$¬gs
 = 
¬¿y
(
$m’u_Çme
, 
$™em
['href']);

893 
$¶aûhŞd”s
 = "'%s'";

894 ià(
dru·l_is_äÚt_·ge
()) {

895 
$¬gs
[] = '<front>';

896 
$¶aûhŞd”s
 .= ", '%s'";

898 
$·»Ás
 = 
db_ãtch_¬¿y
(
db_qu”y
("SELECT…1,…2,…3,…4,…5,…6,…7,…8 FROM {m’u_lšks} WHERE m’u_Çmğ'%s' AND†šk_·th IN (". 
$¶aûhŞd”s
 .")", 
$¬gs
));

900 ià(
em±y
(
$·»Ás
)) {

903 
$·»Ás
 = 
db_ãtch_¬¿y
(
db_qu”y
("SELECT…1,…2,…3,…4,…5,…6,…7,…8 FROM {m’u_lšks} WHERE m’u_Çmğ'%s' AND†šk_·th = '%s'", 
$m’u_Çme
, 
$™em
['tab_root']));

906 
$·»Ás
[] = '0';

909 
$¬gs
 = 
$·»Ás
 = 
¬¿y_unique
(
¬¿y_v®ues
($parents));

910 
$¶aûhŞd”s
 = 
im¶ode
(', ', 
¬¿y_fl
(0, 
couÁ
(
$¬gs
), '%d'));

911 
$ex·nded
 = 
v¬ŸbË_g‘
('m’u_ex·nded', 
¬¿y
());

913 ià(
š_¬¿y
(
$m’u_Çme
, 
$ex·nded
)) {

917 
$»suÉ
 = 
db_qu”y
("SELECT mlid FROM {m’u_lšks} WHERE m’u_Çmğ'%s' ANDƒx·nded = 1 AND has_chd»Àğ1 AND…lid IN (". 
$¶aûhŞd”s
 .'èAND mlid NOT IN ('. $¶aûhŞd” .')', 
¬¿y_m”ge
(
¬¿y
(
$m’u_Çme
), 
$¬gs
, $args));

918 
$num_rows
 = 
FALSE
;

919 
$™em
 = 
db_ãtch_¬¿y
(
$»suÉ
)) {

920 
$¬gs
[] = 
$™em
['mlid'];

921 
$num_rows
 = 
TRUE
;

923 
$¶aûhŞd”s
 = 
im¶ode
(', ', 
¬¿y_fl
(0, 
couÁ
(
$¬gs
), '%d'));

924 } 
$num_rows
);

926 
¬¿y_unshiá
(
$¬gs
, 
$m’u_Çme
);

930 
$¬gs
 = 
¬¿y
(
$m’u_Çme
, '0');

931 
$¶aûhŞd”s
 = '%d';

932 
$·»Ás
 = 
¬¿y
();

937 
$d©a
['Œ“'] = 
m’u_Œ“_d©a
(
db_qu”y
("

938 
SELECT
 
m
.
lßd_funùiÚs
, m.
to_¬g_funùiÚs
, m.
acûss_ÿÎback
, m.
acûss_¬gum’ts
, m.
·ge_ÿÎback
, m.
·ge_¬gum’ts
, m.
t™Ë
, m.
t™Ë_ÿÎback
, m.
t™Ë_¬gum’ts
, m.
ty³
, m.
desütiÚ
, 
ml
.*

939 
FROM
 {
m’u_lšks
} 
ml
 
LEFT
 
JOIN
 {
m’u_rou‹r
} 
m
 
ON
 m.
·th
 = ml.
rou‹r_·th


940 
WHERE
 
ml
.
m’u_Çme
 = '%s' 
AND
 ml.
¶id
 
IN
 (". $placeholders .")

941 
ORDER
 
BY
 
p1
 
ASC
, 
p2
 ASC, 
p3
 ASC, 
p4
 ASC, 
p5
 ASC, 
p6
 ASC, 
p7
 ASC, 
p8
 ASC, 
p9
 ASC", $args), $parents);

942 
$d©a
['node_lšks'] = 
¬¿y
();

943 
m’u_Œ“_cŞËù_node_lšks
(
$d©a
['tree'], $data['node_links']);

945 
$Œ“_cid
 = 
_m’u_Œ“_cid
(
$m’u_Çme
, 
$d©a
);

946 ià(!
ÿche_g‘
(
$Œ“_cid
, 'cache_menu')) {

947 
ÿche_£t
(
$Œ“_cid
, 
$d©a
, 'cache_menu');

950 
ÿche_£t
(
$cid
, 
$Œ“_cid
, 'cache_menu');

953 
m’u_Œ“_check_acûss
(
$d©a
['tree'], $data['node_links']);

954 
$Œ“
[
$cid
] = 
$d©a
['tree'];

956  
$Œ“
[
$cid
];

959  
¬¿y
();

965 
funùiÚ
 
	$_m’u_Œ“_cid
(
$m’u_Çme
, 
$d©a
) {

966  'lšks:'. 
$m’u_Çme
 .':Œ“-d©a:'. 
	`md5
(
	`£rŸlize
(
$d©a
));

967 
	}
}

977 
funùiÚ
 
	$m’u_Œ“_cŞËù_node_lšks
(&
$Œ“
, &
$node_lšks
) {

978 
	`fÜ—ch
 (
$Œ“
 
as
 
$key
 => 
$v
) {

979 ià(
$Œ“
[
$key
]['link']['router_path'] == 'node/%') {

980 
$nid
 = 
	`sub¡r
(
$Œ“
[
$key
]['link']['link_path'], 5);

981 ià(
	`is_num”ic
(
$nid
)) {

982 
$node_lšks
[
$nid
][
$Œ“
[
$key
]['link']['mlid']] = &$tree[$key]['link'];

983 
$Œ“
[
$key
]['lšk']['acûss'] = 
FALSE
;

986 ià(
$Œ“
[
$key
]['below']) {

987 
	`m’u_Œ“_cŞËù_node_lšks
(
$Œ“
[
$key
]['b–ow'], 
$node_lšks
);

990 
	}
}

1001 
funùiÚ
 
m’u_Œ“_check_acûss
(&
$Œ“
, 
$node_lšks
 = 
	$¬¿y
()) {

1003 ià(
$node_lšks
) {

1005 
$nids
 = 
	`¬¿y_keys
(
$node_lšks
);

1006 
$¶aûhŞd”s
 = '%d'. 
	`¡r_»³©
(', %d', 
	`couÁ
(
$nids
) - 1);

1007 
$»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
("SELECT‚.nid FROM {node}‚ WHERE‚.¡©u ğ1 AND‚.nid IN (". 
$¶aûhŞd”s
 .")"), 
$nids
);

1008 
$node
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

1009 
$nid
 = 
$node
['nid'];

1010 
	`fÜ—ch
 (
$node_lšks
[
$nid
] 
as
 
$mlid
 => 
$lšk
) {

1011 
$node_lšks
[
$nid
][
$mlid
]['acûss'] = 
TRUE
;

1015 
	`_m’u_Œ“_check_acûss
(
$Œ“
);

1017 
	}
}

1022 
funùiÚ
 
	$_m’u_Œ“_check_acûss
(&
$Œ“
) {

1023 
$Ãw_Œ“
 = 
	`¬¿y
();

1024 
	`fÜ—ch
 (
$Œ“
 
as
 
$key
 => 
$v
) {

1025 
$™em
 = &
$Œ“
[
$key
]['link'];

1026 
	`_m’u_lšk_Œª¦©e
(
$™em
);

1027 ià(
$™em
['access']) {

1028 ià(
$Œ“
[
$key
]['below']) {

1029 
	`_m’u_Œ“_check_acûss
(
$Œ“
[
$key
]['below']);

1034 
$Ãw_Œ“
[(50000 + 
$™em
['weight']è.' '. $™em['t™Ë'] .' '. $™em['mlid']] = 
$Œ“
[
$key
];

1038 
	`ksÜt
(
$Ãw_Œ“
);

1039 
$Œ“
 = 
$Ãw_Œ“
;

1040 
	}
}

1055 
funùiÚ
 
m’u_Œ“_d©a
(
$»suÉ
 = 
NULL
, 
$·»Ás
 = 
¬¿y
(), 
$d•th
 = 1) {

1056 
li¡
(, 
$Œ“
èğ
_m’u_Œ“_d©a
(
$»suÉ
, 
$·»Ás
, 
$d•th
);

1057  
$Œ“
;

1067 
funùiÚ
 
_m’u_Œ“_d©a
(
$»suÉ
, 
$·»Ás
, 
$d•th
, 
$´evious_–em’t
 = '') {

1068 
$»mÇÁ
 = 
NULL
;

1069 
$Œ“
 = 
¬¿y
();

1070 
$™em
 = 
db_ãtch_¬¿y
(
$»suÉ
)) {

1073 
$™em
['š_aùive_Œa'] = 
š_¬¿y
($™em['mlid'], 
$·»Ás
);

1075 ià(
$™em
['d•th'] > 
$d•th
) {

1077 
li¡
(
$™em
, 
$b–ow
èğ
_m’u_Œ“_d©a
(
$»suÉ
, 
$·»Ás
, $item['depth'], $item);

1078 ià(
$´evious_–em’t
) {

1079 
$Œ“
[
$´evious_–em’t
['mlid']] = 
¬¿y
(

1080 'lšk' => 
$´evious_–em’t
,

1081 'b–ow' => 
$b–ow
,

1085 
$Œ“
 = 
$b–ow
;

1088 ià(!
is£t
(
$™em
è|| $™em['d•th'] < 
$d•th
) {

1089  
¬¿y
(
$™em
, 
$Œ“
);

1092 
$´evious_–em’t
 = 
$™em
;

1095 
–£if
 (
$™em
['d•th'] =ğ
$d•th
) {

1096 ià(
$´evious_–em’t
) {

1098 
$Œ“
[
$´evious_–em’t
['mlid']] = 
¬¿y
(

1099 'lšk' => 
$´evious_–em’t
,

1100 'b–ow' => 
FALSE
,

1104 
$´evious_–em’t
 = 
$™em
;

1108 
$»mÇÁ
 = 
$™em
;

1112 ià(
$´evious_–em’t
) {

1114 
$Œ“
[
$´evious_–em’t
['mlid']] = 
¬¿y
(

1115 'lšk' => 
$´evious_–em’t
,

1116 'b–ow' => 
FALSE
,

1119  
¬¿y
(
$»mÇÁ
, 
$Œ“
);

1127 
funùiÚ
 
	$theme_m’u_™em_lšk
(
$lšk
) {

1128 ià(
	`em±y
(
$lšk
['localized_options'])) {

1129 
$lšk
['loÿlized_İtiÚs'] = 
	`¬¿y
();

1132  
	`l
(
$lšk
['title'], $link['href'], $link['localized_options']);

1133 
	}
}

1140 
funùiÚ
 
	$theme_m’u_Œ“
(
$Œ“
) {

1141  '<uÈşass="m’u">'. 
$Œ“
 .'</ul>';

1142 
	}
}

1149 
funùiÚ
 
theme_m’u_™em
(
$lšk
, 
$has_chd»n
, 
$m’u
 = '', 
$š_aùive_Œa
 = 
FALSE
, 
$exŒa_şass
 = 
NULL
) {

1150 
$şass
 = (
$m’u
 ? 'ex·nded' : (
$has_chd»n
 ? 'collapsed' : 'leaf'));

1151 ià(!
em±y
(
$exŒa_şass
)) {

1152 
$şass
 .ğ' '. 
$exŒa_şass
;

1154 ià(
$š_aùive_Œa
) {

1155 
$şass
 .= '‡ctive-trail';

1157  '<l˜şass="'. 
$şass
 .'">'. 
$lšk
 . 
$m’u
 ."</li>\n";

1165 
funùiÚ
 
	$theme_m’u_loÿl_sk
(
$lšk
, 
$aùive
 = 
FALSE
) {

1166  '<l˜'. (
$aùive
 ? 'şass="aùive" ' : ''è.'>'. 
$lšk
 ."</li>\n";

1167 
	}
}

1172 
funùiÚ
 
dru·l_h–p_¬g
(
$¬g
 = 
	$¬¿y
()) {

1174  
$¬g
 + 
	`¬¿y
('', '', '', '', '', '', '', '', '', '', '', '');

1175 
	}
}

1180 
funùiÚ
 
	$m’u_g‘_aùive_h–p
() {

1181 
$ouut
 = '';

1182 
$rou‹r_·th
 = 
	`m’u_b_roÙ_·th
();

1184 ià(!
$rou‹r_·th
) {

1188 
$¬g
 = 
	`dru·l_h–p_¬g
(
	`¬g
(
NULL
));

1189 
$em±y_¬g
 = 
	`dru·l_h–p_¬g
();

1191 
	`fÜ—ch
 (
	`moduË_li¡
(è
as
 
$Çme
) {

1192 ià(
	`moduË_hook
(
$Çme
, 'help')) {

1194 ià(
$h–p
 = 
	`moduË_švoke
(
$Çme
, 'h–p', 
$rou‹r_·th
, 
$¬g
)) {

1195 
$ouut
 .ğ
$h–p
 ."\n";

1199 ià(
$¬g
[0] =ğ"admš" && 
	`moduË_exi¡s
('h–p'è&& 
	`moduË_švoke
(
$Çme
, 'h–p', 'admš/h–p#'. $¬g[2], 
$em±y_¬g
è&& 
$h–p
) {

1200 
$ouut
 .ğ
	`theme
("mÜe_h–p_lšk", 
	`u¾
('admš/h–p/'. 
$¬g
[2]));

1204  
$ouut
;

1205 
	}
}

1210 
funùiÚ
 
	$m’u_g‘_Çmes
(
$»£t
 = 
FALSE
) {

1211 
$Çmes
;

1213 ià(
$»£t
 || 
	`em±y
(
$Çmes
)) {

1214 
$Çmes
 = 
	`¬¿y
();

1215 
$»suÉ
 = 
	`db_qu”y
("SELECT DISTINCT(menu_name) FROM {menu_links} ORDER BY menu_name");

1216 
$Çme
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

1217 
$Çmes
[] = 
$Çme
['menu_name'];

1220  
$Çmes
;

1221 
	}
}

1226 
funùiÚ
 
	$m’u_li¡_sy¡em_m’us
() {

1227  
	`¬¿y
('navigation', 'primary-links', 'secondary-links');

1228 
	}
}

1233 
funùiÚ
 
	$m’u_´im¬y_lšks
() {

1234  
	`m’u_Çvig©iÚ_lšks
(
	`v¬ŸbË_g‘
('menu_primary_links_source', 'primary-links'));

1235 
	}
}

1240 
funùiÚ
 
	$m’u_£cÚd¬y_lšks
() {

1244 ià(
	`v¬ŸbË_g‘
('menu_secondary_links_source', 'secondary-links') == variable_get('menu_primary_links_source', 'primary-links')) {

1245  
	`m’u_Çvig©iÚ_lšks
(
	`v¬ŸbË_g‘
('menu_primary_links_source', 'primary-links'), 1);

1248  
	`m’u_Çvig©iÚ_lšks
(
	`v¬ŸbË_g‘
('menu_secondary_links_source', 'secondary-links'), 0);

1250 
	}
}

1262 
funùiÚ
 
	$m’u_Çvig©iÚ_lšks
(
$m’u_Çme
, 
$Ëv–
 = 0) {

1264 ià(
	`em±y
(
$m’u_Çme
)) {

1265  
	`¬¿y
();

1269 
$Œ“
 = 
	`m’u_Œ“_·ge_d©a
(
$m’u_Çme
);

1272 
$Ëv–
-- > 0 && 
$Œ“
) {

1274 
$™em
 = 
	`¬¿y_shiá
(
$Œ“
)) {

1275 ià(
$™em
['link']['in_active_trail']) {

1277 
$Œ“
 = 
	`em±y
(
$™em
['b–ow']è? 
	`¬¿y
() : $item['below'];

1284 
$lšks
 = 
	`¬¿y
();

1285 
	`fÜ—ch
 (
$Œ“
 
as
 
$™em
) {

1286 ià(!
$™em
['link']['hidden']) {

1287 
$şass
 = '';

1288 
$l
 = 
$™em
['link']['localized_options'];

1289 
$l
['h»f'] = 
$™em
['link']['href'];

1290 
$l
['t™Ë'] = 
$™em
['link']['title'];

1291 ià(
$™em
['link']['in_active_trail']) {

1292 
$şass
 = '‡ctive-trail';

1295 
$lšks
['m’u-'. 
$™em
['lšk']['mlid'] . 
$şass
] = 
$l
;

1298  
$lšks
;

1299 
	}
}

1313 
funùiÚ
 
	$m’u_loÿl_sks
(
$Ëv–
 = 0, 
$»tuº_roÙ
 = 
FALSE
) {

1314 
$bs
;

1315 
$roÙ_·th
;

1317 ià(!
	`is£t
(
$bs
)) {

1318 
$bs
 = 
	`¬¿y
();

1320 
$rou‹r_™em
 = 
	`m’u_g‘_™em
();

1321 ià(!
$rou‹r_™em
 || !$router_item['access']) {

1325 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {m’u_rou‹r} WHEREab_roÙ = '%s' ORDER BY weight,™Ë", 
$rou‹r_™em
['tab_root']);

1326 
$m­
 = 
	`¬g
();

1327 
$chd»n
 = 
	`¬¿y
();

1328 
$sks
 = 
	`¬¿y
();

1329 
$roÙ_·th
 = 
$rou‹r_™em
['path'];

1331 
$™em
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

1332 
	`_m’u_Œª¦©e
(
$™em
, 
$m­
, 
TRUE
);

1333 ià(
$™em
['tab_parent']) {

1335 
$chd»n
[
$™em
['tab_parent']][$item['path']] = $item;

1338 
$sks
[
$™em
['path']] = $item;

1342 
$·th
 = 
$rou‹r_™em
['path'];

1345 
$d•th
 = 1001;

1346 
	`is£t
(
$chd»n
[
$·th
])) {

1347 
$bs_cu¼’t
 = '';

1348 
$Ãxt_·th
 = '';

1349 
$couÁ
 = 0;

1350 
	`fÜ—ch
 (
$chd»n
[
$·th
] 
as
 
$™em
) {

1351 ià(
$™em
['access']) {

1352 
$couÁ
++;

1354 ià(
$™em
['ty³'] =ğ
MENU_DEFAULT_LOCAL_TASK
) {

1356 
$p
 = 
$™em
['b_·»Á']; 
$sks
[$p]['ty³'] =ğ
MENU_DEFAULT_LOCAL_TASK
; $p = $tasks[$p]['tab_parent']);

1357 
$lšk
 = 
	`theme
('m’u_™em_lšk', 
	`¬¿y
('h»f' => 
$sks
[
$p
]['h»f']è+ 
$™em
);

1358 
$bs_cu¼’t
 .ğ
	`theme
('m’u_loÿl_sk', 
$lšk
, 
TRUE
);

1359 
$Ãxt_·th
 = 
$™em
['path'];

1362 
$lšk
 = 
	`theme
('m’u_™em_lšk', 
$™em
);

1363 
$bs_cu¼’t
 .ğ
	`theme
('m’u_loÿl_sk', 
$lšk
);

1367 
$·th
 = 
$Ãxt_·th
;

1368 
$bs
[
$d•th
]['couÁ'] = 
$couÁ
;

1369 
$bs
[
$d•th
]['ouut'] = 
$bs_cu¼’t
;

1370 
$d•th
++;

1374 
$·»Á
 = 
$rou‹r_™em
['tab_parent'];

1375 
$·th
 = 
$rou‹r_™em
['path'];

1376 
$cu¼’t
 = 
$rou‹r_™em
;

1377 
$d•th
 = 1000;

1378 
	`is£t
(
$chd»n
[
$·»Á
])) {

1379 
$bs_cu¼’t
 = '';

1380 
$Ãxt_·th
 = '';

1381 
$Ãxt_·»Á
 = '';

1382 
$couÁ
 = 0;

1383 
	`fÜ—ch
 (
$chd»n
[
$·»Á
] 
as
 
$™em
) {

1384 ià(
$™em
['access']) {

1385 
$couÁ
++;

1386 ià(
$™em
['ty³'] =ğ
MENU_DEFAULT_LOCAL_TASK
) {

1388 
$p
 = 
$™em
['b_·»Á']; 
$sks
[$p]['ty³'] =ğ
MENU_DEFAULT_LOCAL_TASK
; $p = $tasks[$p]['tab_parent']);

1389 
$lšk
 = 
	`theme
('m’u_™em_lšk', 
	`¬¿y
('h»f' => 
$sks
[
$p
]['h»f']è+ 
$™em
);

1390 ià(
$™em
['·th'] =ğ
$rou‹r_™em
['path']) {

1391 
$roÙ_·th
 = 
$sks
[
$p
]['path'];

1395 
$lšk
 = 
	`theme
('m’u_™em_lšk', 
$™em
);

1398 ià(
$™em
['·th'] =ğ
$·th
) {

1399 
$bs_cu¼’t
 .ğ
	`theme
('m’u_loÿl_sk', 
$lšk
, 
TRUE
);

1400 
$Ãxt_·th
 = 
$™em
['tab_parent'];

1401 ià(
	`is£t
(
$sks
[
$Ãxt_·th
])) {

1402 
$Ãxt_·»Á
 = 
$sks
[
$Ãxt_·th
]['tab_parent'];

1406 
$bs_cu¼’t
 .ğ
	`theme
('m’u_loÿl_sk', 
$lšk
);

1410 
$·th
 = 
$Ãxt_·th
;

1411 
$·»Á
 = 
$Ãxt_·»Á
;

1412 
$bs
[
$d•th
]['couÁ'] = 
$couÁ
;

1413 
$bs
[
$d•th
]['ouut'] = 
$bs_cu¼’t
;

1414 
$d•th
--;

1417 
	`ksÜt
(
$bs
);

1419 
$bs
 = 
	`¬¿y_v®ues
($tabs);

1422 ià(
$»tuº_roÙ
) {

1423  
$roÙ_·th
;

1427  (
	`is£t
(
$bs
[
$Ëv–
]) && $tabs[$level]['count'] > 1) ? $tabs[$level]['output'] : '';

1429 
	}
}

1434 
funùiÚ
 
	$m’u_´im¬y_loÿl_sks
() {

1435  
	`m’u_loÿl_sks
(0);

1436 
	}
}

1441 
funùiÚ
 
	$m’u_£cÚd¬y_loÿl_sks
() {

1442  
	`m’u_loÿl_sks
(1);

1443 
	}
}

1448 
funùiÚ
 
	$m’u_b_roÙ_·th
() {

1449  
	`m’u_loÿl_sks
(0, 
TRUE
);

1450 
	}
}

1457 
funùiÚ
 
	$theme_m’u_loÿl_sks
() {

1458 
$ouut
 = '';

1460 ià(
$´im¬y
 = 
	`m’u_´im¬y_loÿl_sks
()) {

1461 
$ouut
 .ğ"<uÈşass=\"b ´im¬y\">\n". 
$´im¬y
 ."</ul>\n";

1463 ià(
$£cÚd¬y
 = 
	`m’u_£cÚd¬y_loÿl_sks
()) {

1464 
$ouut
 .ğ"<uÈşass=\"b £cÚd¬y\">\n". 
$£cÚd¬y
 ."</ul>\n";

1467  
$ouut
;

1468 
	}
}

1473 
funùiÚ
 
	$m’u_£t_aùive_m’u_Çme
(
$m’u_Çme
 = 
NULL
) {

1474 
$aùive
;

1476 ià(
	`is£t
(
$m’u_Çme
)) {

1477 
$aùive
 = 
$m’u_Çme
;

1479 
	`–£if
 (!
	`is£t
(
$aùive
)) {

1480 
$aùive
 = 'navigation';

1482  
$aùive
;

1483 
	}
}

1488 
funùiÚ
 
	$m’u_g‘_aùive_m’u_Çme
() {

1489  
	`m’u_£t_aùive_m’u_Çme
();

1490 
	}
}

1502 
funùiÚ
 
	$m’u_£t_aùive_™em
(
$·th
) {

1503 
$_GET
['q'] = 
$·th
;

1504 
	}
}

1527 
funùiÚ
 
	$m’u_£t_aùive_Œa
(
$Ãw_Œa
 = 
NULL
) {

1528 
$Œa
;

1530 ià(
	`is£t
(
$Ãw_Œa
)) {

1531 
$Œa
 = 
$Ãw_Œa
;

1533 
	`–£if
 (!
	`is£t
(
$Œa
)) {

1534 
$Œa
 = 
	`¬¿y
();

1535 
$Œa
[] = 
	`¬¿y
('t™Ë' => 
	`t
('Home'), 'href' => '<front>', 'localized_options' =>‡rray(), 'type' => 0);

1536 
$™em
 = 
	`m’u_g‘_™em
();

1539 ià(
$™em
['tab_parent']) {

1544 
$·¹s
 = 
	`ex¶ode
('/', 
$™em
['tab_root']);

1545 
$¬gs
 = 
	`¬g
();

1547 
	`fÜ—ch
 (
$·¹s
 
as
 
$šdex
 => 
$·¹
) {

1548 ià(
$·¹
 == '%') {

1549 
$·¹s
[
$šdex
] = 
$¬gs
[$index];

1553 
$roÙ_™em
 = 
	`m’u_g‘_™em
(
	`im¶ode
('/', 
$·¹s
));

1554 ià(
$roÙ_™em
 && $root_item['access']) {

1555 
$™em
 = 
$roÙ_™em
;

1559 
$Œ“
 = 
	`m’u_Œ“_·ge_d©a
(
	`m’u_g‘_aùive_m’u_Çme
());

1560 
	`li¡
(
$key
, 
$cu¼
èğ
	`—ch
(
$Œ“
);

1562 
$cu¼
) {

1564 ià(
$cu¼
['lšk']['h»f'] =ğ
$™em
['href']) {

1565 
$Œa
[] = 
$cu¼
['link'];

1566 
$cu¼
 = 
FALSE
;

1570 ià(
$cu¼
['link']['in_active_trail']) {

1571 
$Œa
[] = 
$cu¼
['link'];

1572 
$Œ“
 = 
$cu¼
['b–ow'] ? $cu¼['b–ow'] : 
	`¬¿y
();

1574 
	`li¡
(
$key
, 
$cu¼
èğ
	`—ch
(
$Œ“
);

1579 
$Ï¡
 = 
	`couÁ
(
$Œa
) - 1;

1580 ià(
$Œa
[
$Ï¡
]['h»f'] !ğ
$™em
['h»f'] && !(
boŞ
)($™em['ty³'] & 
MENU_IS_LOCAL_TASK
è&& !
	`dru·l_is_äÚt_·ge
()) {

1581 
$Œa
[] = 
$™em
;

1584  
$Œa
;

1585 
	}
}

1592 
funùiÚ
 
	$m’u_g‘_aùive_Œa
() {

1593  
	`m’u_£t_aùive_Œa
();

1594 
	}
}

1599 
funùiÚ
 
	$m’u_g‘_aùive_b»adüumb
() {

1600 
$b»adüumb
 = 
	`¬¿y
();

1603 ià(
	`dru·l_is_äÚt_·ge
()) {

1604  
$b»adüumb
;

1607 
$™em
 = 
	`m’u_g‘_™em
();

1608 ià(
$™em
 && $item['access']) {

1609 
$aùive_Œa
 = 
	`m’u_g‘_aùive_Œa
();

1611 
	`fÜ—ch
 (
$aùive_Œa
 
as
 
$·»Á
) {

1612 
$b»adüumb
[] = 
	`l
(
$·»Á
['title'], $parent['href'], $parent['localized_options']);

1614 
$’d
 = 
	`’d
(
$aùive_Œa
);

1617 ià(
$™em
['h»f'] =ğ
$’d
['h»f'] || ($™em['ty³'] =ğ
MENU_DEFAULT_LOCAL_TASK
 && $end['href'] != '<front>')) {

1618 
	`¬¿y_pİ
(
$b»adüumb
);

1621  
$b»adüumb
;

1622 
	}
}

1627 
funùiÚ
 
	$m’u_g‘_aùive_t™Ë
() {

1628 
$aùive_Œa
 = 
	`m’u_g‘_aùive_Œa
();

1630 
	`fÜ—ch
 (
	`¬¿y_»v”£
(
$aùive_Œa
è
as
 
$™em
) {

1631 ià(!(
boŞ
)(
$™em
['ty³'] & 
MENU_IS_LOCAL_TASK
)) {

1632  
$™em
['title'];

1635 
	}
}

1650 
funùiÚ
 
	$m’u_lšk_lßd
(
$mlid
) {

1651 ià(
	`is_num”ic
(
$mlid
è&& 
$™em
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT m.*, ml.* FROM {menu_links} ml LEFT JOIN {menu_router} m ON m.path = ml.router_path WHERE ml.mlid = %d", $mlid))) {

1652 
	`_m’u_lšk_Œª¦©e
(
$™em
);

1653  
$™em
;

1655  
FALSE
;

1656 
	}
}

1661 
funùiÚ
 
m’u_ÿche_ş—r
(
$m’u_Çme
 = 'navigation') {

1662 
$ÿche_ş—»d
 = 
¬¿y
();

1664 ià(
em±y
(
$ÿche_ş—»d
[
$m’u_Çme
])) {

1665 
ÿche_ş—r_®l
('lšks:'. 
$m’u_Çme
 .':', 'ÿche_m’u', 
TRUE
);

1666 
$ÿche_ş—»d
[
$m’u_Çme
] = 1;

1668 
–£if
 (
$ÿche_ş—»d
[
$m’u_Çme
] == 1) {

1669 
»gi¡”_shutdown_funùiÚ
('ÿche_ş—r_®l', 'lšks:'. 
$m’u_Çme
 .':', 'ÿche_m’u', 
TRUE
);

1670 
$ÿche_ş—»d
[
$m’u_Çme
] = 2;

1678 
funùiÚ
 
	$m’u_ÿche_ş—r_®l
() {

1679 
	`ÿche_ş—r_®l
('*', 'ÿche_m’u', 
TRUE
);

1680 
	}
}

1692 
funùiÚ
 
	$m’u_»bud
() {

1693 ià(!
	`lock_acquœe
('menu_rebuild')) {

1697 
	`lock_wa™
('menu_rebuild');

1698  
FALSE
;

1701 
$m’u
 = 
	`m’u_rou‹r_bud
(
TRUE
);

1702 
	`_m’u_Çvig©iÚ_lšks_»bud
(
$m’u
);

1704 
	`m’u_ÿche_ş—r_®l
();

1705 
	`_m’u_ş—r_·ge_ÿche
();

1707 ià(
	`defšed
('MAINTENANCE_MODE')) {

1708 
	`v¬ŸbË_£t
('m’u_»bud_Ãeded', 
TRUE
);

1711 
	`v¬ŸbË_d–
('menu_rebuild_needed');

1713 
	`lock_»Ëa£
('menu_rebuild');

1714  
TRUE
;

1715 
	}
}

1720 
funùiÚ
 
	$m’u_rou‹r_bud
(
$»£t
 = 
FALSE
) {

1721 
$m’u
;

1723 ià(!
	`is£t
(
$m’u
è|| 
$»£t
) {

1726 
$ÿÎbacks
 = 
	`¬¿y
();

1727 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('m’u'è
as
 
$moduË
) {

1728 
$rou‹r_™ems
 = 
	`ÿÎ_u£r_func
(
$moduË
 .'_menu');

1729 ià(
	`is£t
(
$rou‹r_™ems
è&& 
	`is_¬¿y
($router_items)) {

1730 
	`fÜ—ch
 (
	`¬¿y_keys
(
$rou‹r_™ems
è
as
 
$·th
) {

1731 
$rou‹r_™ems
[
$·th
]['moduË'] = 
$moduË
;

1733 
$ÿÎbacks
 = 
	`¬¿y_m”ge
($ÿÎbacks, 
$rou‹r_™ems
);

1737 
	`dru·l_®‹r
('m’u', 
$ÿÎbacks
);

1738 
$m’u
 = 
	`_m’u_rou‹r_bud
(
$ÿÎbacks
);

1739 
	`_m’u_rou‹r_ÿche
(
$m’u
);

1741  
$m’u
;

1742 
	}
}

1747 
funùiÚ
 
	$_m’u_rou‹r_ÿche
(
$Ãw_m’u
 = 
NULL
) {

1748 
$m’u
 = 
NULL
;

1750 ià(
	`is£t
(
$Ãw_m’u
)) {

1751 
$m’u
 = 
$Ãw_m’u
;

1753  
$m’u
;

1754 
	}
}

1759 
funùiÚ
 
	$_m’u_lšk_bud
(
$™em
) {

1760 ià(
$™em
['ty³'] =ğ
MENU_CALLBACK
) {

1761 
$™em
['hidden'] = -1;

1763 
	`–£if
 (
$™em
['ty³'] =ğ
MENU_SUGGESTED_ITEM
) {

1764 
$™em
['hidden'] = 1;

1768 
$™em
['module'] = 'system';

1769 
$™em
 +ğ
	`¬¿y
(

1771 'lšk_t™Ë' => 
$™em
['title'],

1772 'lšk_·th' => 
$™em
['path'],

1774 'İtiÚs' => 
	`em±y
(
$™em
['desütiÚ']è? 
	`¬¿y
() :‡rray('attributes' =>‡rray('title' => $item['description'])),

1776  
$™em
;

1777 
	}
}

1782 
funùiÚ
 
	$_m’u_Çvig©iÚ_lšks_»bud
(
$m’u
) {

1784 
$m’u_lšks
 = 
	`¬¿y
();

1785 
	`fÜ—ch
 (
$m’u
 
as
 
$·th
 => 
$™em
) {

1786 ià(
$™em
['_visible']) {

1787 
$™em
 = 
	`_m’u_lšk_bud
($item);

1788 
$m’u_lšks
[
$·th
] = 
$™em
;

1789 
$sÜt
[
$·th
] = 
$™em
['_number_parts'];

1792 ià(
$m’u_lšks
) {

1794 
	`¬¿y_muÉisÜt
(
$sÜt
, 
SORT_NUMERIC
, 
$m’u_lšks
);

1796 
	`fÜ—ch
 (
$m’u_lšks
 
as
 
$™em
) {

1797 
$exi¡šg_™em
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT mlid, m’u_Çme,…lid, cu¡omized, has_chd»n, upd©ed FROM {m’u_lšks} WHERE†šk_·th = '%s' AND moduË = '%s'", 
$™em
['link_path'], 'system'));

1798 ià(
$exi¡šg_™em
) {

1799 
$™em
['mlid'] = 
$exi¡šg_™em
['mlid'];

1801 ià(
	`em±y
(
$™em
['m’u_Çme']è|| ($™em['m’u_Çme'] =ğ
$exi¡šg_™em
['menu_name'])) {

1802 
$™em
['m’u_Çme'] = 
$exi¡šg_™em
['menu_name'];

1803 
$™em
['¶id'] = 
$exi¡šg_™em
['plid'];

1805 
$™em
['has_chd»n'] = 
$exi¡šg_™em
['has_children'];

1806 
$™em
['upd©ed'] = 
$exi¡šg_™em
['updated'];

1808 ià(!
$exi¡šg_™em
 || !$existing_item['customized']) {

1809 
	`m’u_lšk_§ve
(
$™em
);

1813 
$¶aûhŞd”s
 = 
	`db_¶aûhŞd”s
(
$m’u
, 'varchar');

1814 
$·ths
 = 
	`¬¿y_keys
(
$m’u
);

1816 
$»suÉ
 = 
	`db_qu”y
("SELECT ml.lšk_·th, ml.mlid, ml.rou‹r_·th, ml.upd©ed FROM {m’u_lšks} mÈWHERE ml.upd©ed = 1 OR (rou‹r_·th NOT IN ($¶aûhŞd”sèANDƒx‹º® = 0 AND cu¡omized = 1)", 
$·ths
);

1817 
$™em
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

1818 
$rou‹r_·th
 = 
	`_m’u_fšd_rou‹r_·th
(
$™em
['link_path']);

1819 ià(!
	`em±y
(
$rou‹r_·th
è&& ($rou‹r_·th !ğ
$™em
['router_path'] || $item['updated'])) {

1822 
$upd©ed
 = 
$™em
['upd©ed'] && 
$rou‹r_·th
 != $item['link_path'];

1823 
	`db_qu”y
("UPDATE {m’u_lšks} SET„ou‹r_·th = '%s', upd©ed = %d WHERE mlid = %d", 
$rou‹r_·th
, 
$upd©ed
, 
$™em
['mlid']);

1827 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {m’u_lšks} WHERE„ou‹r_·th NOT IN ($¶aûhŞd”sèANDƒx‹º® = 0 AND upd©ed = 0 AND cu¡omized = 0 ORDER BY d•th DESC", 
$·ths
);

1830 
$™em
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

1831 
	`_m’u_d–‘e_™em
(
$™em
, 
TRUE
);

1833 
	}
}

1843 
funùiÚ
 
	$m’u_lšk_d–‘e
(
$mlid
, 
$·th
 = 
NULL
) {

1844 ià(
	`is£t
(
$mlid
)) {

1845 
	`_m’u_d–‘e_™em
(
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT * FROM {m’u_lšks} WHERE mlid = %d", 
$mlid
)));

1848 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {m’u_lšks} WHERE†šk_·th = '%s'", 
$·th
);

1849 
$lšk
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

1850 
	`_m’u_d–‘e_™em
(
$lšk
);

1853 
	}
}

1863 
funùiÚ
 
	$_m’u_d–‘e_™em
(
$™em
, 
$fÜû
 = 
FALSE
) {

1864 ià(
$™em
 && ($™em['moduË'] !ğ'sy¡em' || $™em['upd©ed'] || 
$fÜû
)) {

1866 ià(
$™em
['has_children']) {

1867 
$»suÉ
 = 
	`db_qu”y
("SELECT mlid FROM {m’u_lšks} WHERE…lid = %d", 
$™em
['mlid']);

1868 
$m
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

1869 
$chd
 = 
	`m’u_lšk_lßd
(
$m
['mlid']);

1870 
$chd
['¶id'] = 
$™em
['plid'];

1871 
	`m’u_lšk_§ve
(
$chd
);

1874 
	`db_qu”y
('DELETE FROM {m’u_lšks} WHERE mlid = %d', 
$™em
['mlid']);

1877 
	`_m’u_upd©e_·»Á®_¡©us
(
$™em
);

1878 
	`m’u_ÿche_ş—r
(
$™em
['menu_name']);

1879 
	`_m’u_ş—r_·ge_ÿche
();

1881 
	}
}

1900 
funùiÚ
 
	$m’u_lšk_§ve
(&
$™em
) {

1904 
$m’u
 = 
	`_m’u_rou‹r_ÿche
();

1905 
	`dru·l_®‹r
('m’u_lšk', 
$™em
, 
$m’u
);

1909 
$™em
['_ex‹º®'] = 
	`m’u_·th_is_ex‹º®
($item['link_path']) || $item['link_path'] == '<front>';

1911 
$™em
 +ğ
	`¬¿y
(

1918 'İtiÚs' => 
	`¬¿y
(),

1923 
$exi¡šg_™em
 = 
FALSE
;

1924 ià(
	`is£t
(
$™em
['mlid'])) {

1925 
$exi¡šg_™em
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT * FROM {m’u_lšks} WHERE mlid = %d", 
$™em
['mlid']));

1928 ià(
	`is£t
(
$™em
['plid'])) {

1929 
$·»Á
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT * FROM {m’u_lšks} WHERE mlid = %d", 
$™em
['plid']));

1933 
$·»Á_·th
 = 
$™em
['link_path'];

1934 
$wh”e
 = "WHERE†ink_path = '%s'";

1937 ià(
$™em
['module'] == 'system') {

1938 
$wh”e
 .= " AND module = '%s'";

1939 
$¬g2
 = 'system';

1943 
$wh”e
 .= " AND menu_name = '%s'";

1944 
$¬g2
 = 
$™em
['menu_name'];

1947 
$·»Á
 = 
FALSE
;

1948 
$·»Á_·th
 = 
	`sub¡r
($·»Á_·th, 0, 
	`¡¼pos
($parent_path, '/'));

1949 
$»suÉ
 = 
	`db_qu”y
("SELECT COUNT(*èFROM {m’u_lšks} ". 
$wh”e
, 
$·»Á_·th
, 
$¬g2
);

1951 ià(
	`db_»suÉ
(
$»suÉ
) == 1) {

1952 
$·»Á
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT * FROM {m’u_lšks} ". 
$wh”e
, 
$·»Á_·th
, 
$¬g2
));

1954 } 
$·»Á
 ==ğ
FALSE
 && 
$·»Á_·th
);

1956 ià(
$·»Á
 !=ğ
FALSE
) {

1957 
$™em
['m’u_Çme'] = 
$·»Á
['menu_name'];

1959 
$m’u_Çme
 = 
$™em
['menu_name'];

1962 ià(
	`em±y
(
$·»Á
['mlid']) || $parent['hidden'] < 0) {

1963 
$™em
['plid'] = 0;

1966 
$™em
['¶id'] = 
$·»Á
['mlid'];

1969 ià(!
$exi¡šg_™em
) {

1970 
	`db_qu”y
("INSERT INTO {menu_links} (

1971 
m’u_Çme
, 
¶id
, 
lšk_·th
,

1972 
hidd’
, 
ex‹º®
, 
has_chd»n
,

1973 
ex·nded
, 
weight
,

1974 
moduË
, 
lšk_t™Ë
, 
İtiÚs
,

1975 
cu¡omized
, 
upd©ed
è
	`VALUES
 (

1976 '%s', %
d
, '%s',

1977 %
d
, %d, %d,

1978 %
d
, %d,

1979 '%s', '%s', '%s', %
d
, %d)",

1980 
$™em
['menu_name'], $item['plid'], $item['link_path'],

1981 
$™em
['hidden'], $item['_external'], $item['has_children'],

1982 
$™em
['expanded'], $item['weight'],

1983 
$™em
['moduË'], $™em['lšk_t™Ë'], 
	`£rŸlize
($item['options']),

1984 
$™em
['customized'], $item['updated']);

1985 
$™em
['mlid'] = 
	`db_Ï¡_š£¹_id
('menu_links', 'mlid');

1988 ià(!
$™em
['plid']) {

1989 
$™em
['p1'] = $item['mlid'];

1990 
$i
 = 2; $˜<ğ
MENU_MAX_DEPTH
; $i++) {

1991 
$™em
["p$i"] = 0;

1993 
$™em
['depth'] = 1;

1997 ià(
$™em
['has_chd»n'] && 
$exi¡šg_™em
) {

1998 
$lim™
 = 
MENU_MAX_DEPTH
 - 
	`m’u_lšk_chd»n_»Ïtive_d•th
(
$exi¡šg_™em
) - 1;

2001 
$lim™
 = 
MENU_MAX_DEPTH
 - 1;

2003 ià(
$·»Á
['d•th'] > 
$lim™
) {

2004  
FALSE
;

2006 
$™em
['d•th'] = 
$·»Á
['depth'] + 1;

2007 
	`_m’u_lšk_·»Ás_£t
(
$™em
, 
$·»Á
);

2010 ià(
$exi¡šg_™em
 && (
$™em
['¶id'] !ğ$exi¡šg_™em['¶id'] || 
$m’u_Çme
 != $existing_item['menu_name'])) {

2011 
	`_m’u_lšk_move_chd»n
(
$™em
, 
$exi¡šg_™em
);

2015 ià(!
	`is£t
(
$_SESSION
['sy¡em_upd©e_6021']è&& (
	`em±y
(
$™em
['rou‹r_·th']è|| !
$exi¡šg_™em
 || ($existing_item['link_path'] != $item['link_path']))) {

2016 ià(
$™em
['_external']) {

2017 
$™em
['router_path'] = '';

2021 
$™em
['·¹s'] = 
	`ex¶ode
('/', $™em['lšk_·th'], 
MENU_MAX_PARTS
);

2022 
$™em
['rou‹r_·th'] = 
	`_m’u_fšd_rou‹r_·th
($item['link_path']);

2025 
	`db_qu”y
("UPDATE {menu_links} SET menu_name = '%s',…lid = %d,†ink_path = '%s',

2026 
rou‹r_·th
 = '%s', 
hidd’
 = %
d
, 
ex‹º®
 = %d, 
has_chd»n
 = %d,

2027 
ex·nded
 = %
d
, 
weight
 = %d, 
d•th
 = %d,

2028 
p1
 = %
d
, 
p2
 = %d, 
p3
 = %d, 
p4
 = %d, 
p5
 = %d, 
p6
 = %d, 
p7
 = %d, 
p8
 = %d, 
p9
 = %d,

2029 
moduË
 = '%s', 
lšk_t™Ë
 = '%s', 
İtiÚs
 = '%s', 
cu¡omized
 = %
d
 
WHERE
 
mlid
 = %d",

2030 
$™em
['menu_name'], $item['plid'], $item['link_path'],

2031 
$™em
['router_path'], $item['hidden'], $item['_external'], $item['has_children'],

2032 
$™em
['expanded'], $item['weight'], $item['depth'],

2033 
$™em
['p1'], $item['p2'], $item['p3'], $item['p4'], $item['p5'], $item['p6'], $item['p7'], $item['p8'], $item['p9'],

2034 
$™em
['moduË'], $™em['lšk_t™Ë'], 
	`£rŸlize
($item['options']), $item['customized'], $item['mlid']);

2036 
	`_m’u_upd©e_·»Á®_¡©us
(
$™em
);

2037 
	`m’u_ÿche_ş—r
(
$m’u_Çme
);

2038 ià(
$exi¡šg_™em
 && 
$m’u_Çme
 != $existing_item['menu_name']) {

2039 
	`m’u_ÿche_ş—r
(
$exi¡šg_™em
['menu_name']);

2042 
	`_m’u_ş—r_·ge_ÿche
();

2043  
$™em
['mlid'];

2044 
	}
}

2049 
funùiÚ
 
	$_m’u_ş—r_·ge_ÿche
() {

2050 
$ÿche_ş—»d
 = 0;

2054 ià(
	`em±y
(
$ÿche_ş—»d
)) {

2055 
	`ÿche_ş—r_®l
();

2057 
	`_m’u_£t_ex·nded_m’us
();

2058 
$ÿche_ş—»d
 = 1;

2060 
	`–£if
 (
$ÿche_ş—»d
 == 1) {

2061 
	`»gi¡”_shutdown_funùiÚ
('cache_clear_all');

2063 
	`»gi¡”_shutdown_funùiÚ
('_menu_set_expanded_menus');

2064 
$ÿche_ş—»d
 = 2;

2066 
	}
}

2071 
funùiÚ
 
	$_m’u_£t_ex·nded_m’us
() {

2072 
$Çmes
 = 
	`¬¿y
();

2073 
$»suÉ
 = 
	`db_qu”y
("SELECT menu_name FROM {menu_links} WHEREƒxpanded != 0 GROUP BY menu_name");

2074 
$n
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

2075 
$Çmes
[] = 
$n
['menu_name'];

2077 
	`v¬ŸbË_£t
('m’u_ex·nded', 
$Çmes
);

2078 
	}
}

2089 
funùiÚ
 
	$_m’u_fšd_rou‹r_·th
(
$lšk_·th
) {

2091 
$m’u
 = 
	`_m’u_rou‹r_ÿche
();

2093 
$rou‹r_·th
 = 
$lšk_·th
;

2094 
$·¹s
 = 
	`ex¶ode
('/', 
$lšk_·th
, 
MENU_MAX_PARTS
);

2095 
	`li¡
(
$ªû¡Üs
, 
$¶aûhŞd”s
èğ
	`m’u_g‘_ªû¡Üs
(
$·¹s
);

2097 ià(
	`em±y
(
$m’u
)) {

2099 
$rou‹r_·th
 = (
¡ršg
)
	`db_»suÉ
(
	`db_qu”y_¿nge
('SELECT…©h FROM {m’u_rou‹r} WHERE…©h IN ('. 
	`im¶ode
 (',', 
$¶aûhŞd”s
è.'èORDER BY f™ DESC', 
$ªû¡Üs
, 0, 1));

2101 
	`–£if
 (!
	`is£t
(
$m’u
[
$rou‹r_·th
])) {

2103 
$ªû¡Üs
[] = '';

2104 
	`fÜ—ch
 (
$ªû¡Üs
 
as
 
$key
 => 
$rou‹r_·th
) {

2105 ià(
	`is£t
(
$m’u
[
$rou‹r_·th
])) {

2113  
$rou‹r_·th
;

2114 
	}
}

2131 
funùiÚ
 
	$m’u_lšk_mašš
(
$moduË
, 
$İ
, 
$lšk_·th
, 
$lšk_t™Ë
) {

2132 
$İ
) {

2134 
$m’u_lšk
 = 
	`¬¿y
(

2135 'lšk_t™Ë' => 
$lšk_t™Ë
,

2136 'lšk_·th' => 
$lšk_·th
,

2137 'moduË' => 
$moduË
,

2139  
	`m’u_lšk_§ve
(
$m’u_lšk
);

2142 
	`db_qu”y
("UPDATE {m’u_lšks} SET†šk_t™Ë = '%s' WHERE†šk_·th = '%s' AND cu¡omized = 0 AND moduË = '%s'", 
$lšk_t™Ë
, 
$lšk_·th
, 
$moduË
);

2143 
$»suÉ
 = 
	`db_qu”y
("SELECT m’u_ÇmFROM {m’u_lšks} WHERE†šk_·th = '%s' AND cu¡omized = 0 AND moduË = '%s'", 
$lšk_·th
, 
$moduË
);

2144 
$™em
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

2145 
	`m’u_ÿche_ş—r
(
$™em
['menu_name']);

2149 
	`m’u_lšk_d–‘e
(
NULL
, 
$lšk_·th
);

2152 
	}
}

2166 
funùiÚ
 
	$m’u_lšk_chd»n_»Ïtive_d•th
(
$™em
) {

2167 
$i
 = 1;

2168 
$m©ch
 = '';

2169 
$¬gs
[] = 
$™em
['menu_name'];

2170 
$p
 = 'p1';

2171 
$i
 <ğ
MENU_MAX_DEPTH
 && 
$™em
[
$p
]) {

2172 
$m©ch
 .= " AND $p = %d";

2173 
$¬gs
[] = 
$™em
[
$p
];

2174 
$p
 = 'p'. ++
$i
;

2177 
$max_d•th
 = 
	`db_»suÉ
(
	`db_qu”y_¿nge
("SELECT d•th FROM {m’u_lšks} WHERE m’u_Çmğ'%s'". 
$m©ch
 ." ORDER BY d•th DESC", 
$¬gs
, 0, 1));

2179  (
$max_d•th
 > 
$™em
['depth']) ? $max_depth - $item['depth'] : 0;

2180 
	}
}

2188 
funùiÚ
 
	$_m’u_lšk_move_chd»n
(
$™em
, 
$exi¡šg_™em
) {

2190 
$¬gs
[] = 
$™em
['menu_name'];

2191 
$£t
[] = "menu_name = '%s'";

2193 
$i
 = 1;

2194 
$i
 <ğ
$™em
['depth']) {

2195 
$p
 = 'p'. 
$i
++;

2196 
$£t
[] = "$p = %d";

2197 
$¬gs
[] = 
$™em
[
$p
];

2199 
$j
 = 
$exi¡šg_™em
['depth'] + 1;

2200 
$i
 <ğ
MENU_MAX_DEPTH
 && 
$j
 <= MENU_MAX_DEPTH) {

2201 
$£t
[] = 'p'. 
$i
++ .' =…'. 
$j
++;

2203 
$i
 <ğ
MENU_MAX_DEPTH
) {

2204 
$£t
[] = 'p'. 
$i
++ .' = 0';

2207 
$shiá
 = 
$™em
['d•th'] - 
$exi¡šg_™em
['depth'];

2208 ià(
$shiá
 < 0) {

2209 
$¬gs
[] = -
$shiá
;

2210 
$£t
[] = 'depth = depth - %d';

2212 
	`–£if
 (
$shiá
 > 0) {

2217 
$£t
 = 
	`¬¿y_»v”£
($set);

2218 
$¬gs
 = 
	`¬¿y_»v”£
($args);

2220 
$¬gs
[] = 
$shiá
;

2221 
$£t
[] = 'depth = depth + %d';

2223 
$wh”e
[] = "menu_name = '%s'";

2224 
$¬gs
[] = 
$exi¡šg_™em
['menu_name'];

2225 
$p
 = 'p1';

2226 
$i
 = 1; $˜<ğ
MENU_MAX_DEPTH
 && 
$exi¡šg_™em
[
$p
]; $p = 'p'. ++$i) {

2227 
$wh”e
[] = "$p = %d";

2228 
$¬gs
[] = 
$exi¡šg_™em
[
$p
];

2231 
	`db_qu”y
("UPDATE {m’u_lšks} SET ". 
	`im¶ode
(', ', 
$£t
è." WHERE ". im¶ode(' AND ', 
$wh”e
), 
$¬gs
);

2233 
	`_m’u_upd©e_·»Á®_¡©us
(
$exi¡šg_™em
, 
TRUE
);

2234 
	}
}

2239 
funùiÚ
 
	$_m’u_upd©e_·»Á®_¡©us
(
$™em
, 
$exşude
 = 
FALSE
) {

2241 ià(
$™em
['plid']) {

2243 
$wh”e
 = 
$exşude
 ? " AND mlid != %d" : '';

2245 
$·»Á_has_chd»n
 = (
boŞ
)
	`db_»suÉ
(
	`db_qu”y_¿nge
("SELECT mlid FROM {m’u_lšks} WHERE m’u_Çmğ'%s' AND…lid = %d AND hidd’ = 0". 
$wh”e
, 
$™em
['menu_name'], $item['plid'], $item['mlid'], 0, 1));

2246 
	`db_qu”y
("UPDATE {m’u_lšks} SET has_chd»Àğ%d WHERE mlid = %d", 
$·»Á_has_chd»n
, 
$™em
['plid']);

2248 
	}
}

2253 
funùiÚ
 
	$_m’u_lšk_·»Ás_£t
(&
$™em
, 
$·»Á
) {

2254 
$i
 = 1;

2255 
$i
 < 
$™em
['depth']) {

2256 
$p
 = 'p'. 
$i
++;

2257 
$™em
[
$p
] = 
$·»Á
[$p];

2259 
$p
 = 'p'. 
$i
++;

2261 
$™em
[
$p
] = $item['mlid'];

2262 
$i
 <ğ
MENU_MAX_DEPTH
) {

2263 
$p
 = 'p'. 
$i
++;

2264 
$™em
[
$p
] = 0;

2266 
	}
}

2271 
funùiÚ
 
	$_m’u_rou‹r_bud
(
$ÿÎbacks
) {

2274 
$m’u
 = 
	`¬¿y
();

2275 
	`fÜ—ch
 (
$ÿÎbacks
 
as
 
$·th
 => 
$™em
) {

2276 
$lßd_funùiÚs
 = 
	`¬¿y
();

2277 
$to_¬g_funùiÚs
 = 
	`¬¿y
();

2278 
$f™
 = 0;

2279 
$move
 = 
FALSE
;

2281 
$·¹s
 = 
	`ex¶ode
('/', 
$·th
, 
MENU_MAX_PARTS
);

2282 
$numb”_·¹s
 = 
	`couÁ
(
$·¹s
);

2285 
$¦ashes
 = 
$numb”_·¹s
 - 1;

2287 
	`fÜ—ch
 (
$·¹s
 
as
 
$k
 => 
$·¹
) {

2288 
$m©ch
 = 
FALSE
;

2292 ià(
	`´eg_m©ch
('/^%(|[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*)$/', 
$·¹
, 
$m©ches
)) {

2293 ià(
	`em±y
(
$m©ches
[1])) {

2294 
$m©ch
 = 
TRUE
;

2295 
$lßd_funùiÚs
[
$k
] = 
NULL
;

2298 ià(
	`funùiÚ_exi¡s
(
$m©ches
[1] .'_to_arg')) {

2299 
$to_¬g_funùiÚs
[
$k
] = 
$m©ches
[1] .'_to_arg';

2300 
$lßd_funùiÚs
[
$k
] = 
NULL
;

2301 
$m©ch
 = 
TRUE
;

2303 ià(
	`funùiÚ_exi¡s
(
$m©ches
[1] .'_load')) {

2304 
$funùiÚ
 = 
$m©ches
[1] .'_load';

2308 
$lßd_funùiÚs
[
$k
] = 
	`is£t
(
$™em
['lßd‡rgum’ts']è? 
	`¬¿y
(
$funùiÚ
 => $item['load‡rguments']) : $function;

2309 
$m©ch
 = 
TRUE
;

2313 ià(
$m©ch
) {

2314 
$·¹s
[
$k
] = '%';

2317 
$f™
 |ğ1 << (
$¦ashes
 - 
$k
);

2320 ià(
$f™
) {

2321 
$move
 = 
TRUE
;

2325 
$f™
 = (1 << 
$numb”_·¹s
) - 1;

2327 
$masks
[
$f™
] = 1;

2328 
$™em
['lßd_funùiÚs'] = 
	`em±y
(
$lßd_funùiÚs
è? '' : 
	`£rŸlize
($load_functions);

2329 
$™em
['to_¬g_funùiÚs'] = 
	`em±y
(
$to_¬g_funùiÚs
è? '' : 
	`£rŸlize
($to_arg_functions);

2330 
$™em
 +ğ
	`¬¿y
(

2333 'ty³' => 
MENU_NORMAL_ITEM
,

2334 '_numb”_·¹s' => 
$numb”_·¹s
,

2335 '_·¹s' => 
$·¹s
,

2336 '_f™' => 
$f™
,

2338 
$™em
 +ğ
	`¬¿y
(

2339 '_visibË' => (
boŞ
)(
$™em
['ty³'] & 
MENU_VISIBLE_IN_BREADCRUMB
),

2340 '_b' => (
boŞ
)(
$™em
['ty³'] & 
MENU_IS_LOCAL_TASK
),

2342 ià(
$move
) {

2343 
$Ãw_·th
 = 
	`im¶ode
('/', 
$™em
['_parts']);

2344 
$m’u
[
$Ãw_·th
] = 
$™em
;

2345 
$sÜt
[
$Ãw_·th
] = 
$numb”_·¹s
;

2348 
$m’u
[
$·th
] = 
$™em
;

2349 
$sÜt
[
$·th
] = 
$numb”_·¹s
;

2352 
	`¬¿y_muÉisÜt
(
$sÜt
, 
SORT_NUMERIC
, 
$m’u
);

2354 ià(!
$m’u
) {

2356 
	`w©chdog
('php', 'M’u„ou‹¸»bud faed - som·th may‚Ù wÜk cÜ»ùly.', 
	`¬¿y
(), 
WATCHDOG_ERROR
);

2357  
	`¬¿y
();

2360 
	`db_qu”y
('DELETE FROM {menu_router}');

2362 
	`fÜ—ch
 (
$m’u
 
as
 
$·th
 => 
$v
) {

2363 
$™em
 = &
$m’u
[
$·th
];

2364 ià(!
$™em
['_tab']) {

2366 
$™em
['tab_parent'] = '';

2367 
$™em
['b_roÙ'] = 
$·th
;

2369 
$i
 = 
$™em
['_number_parts'] - 1; $i; $i--) {

2370 
$·»Á_·th
 = 
	`im¶ode
('/', 
	`¬¿y_¦iû
(
$™em
['_·¹s'], 0, 
$i
));

2371 ià(
	`is£t
(
$m’u
[
$·»Á_·th
])) {

2373 
$·»Á
 = 
$m’u
[
$·»Á_·th
];

2375 ià(!
	`is£t
(
$™em
['tab_parent'])) {

2377 
$™em
['b_·»Á'] = 
$·»Á_·th
;

2379 ià(!
	`is£t
(
$™em
['b_roÙ']è&& !
$·»Á
['_tab']) {

2380 
$™em
['b_roÙ'] = 
$·»Á_·th
;

2385 ià((
$™em
['ty³'] =ğ
MENU_DEFAULT_LOCAL_TASK
è&& !
	`is£t
($™em['acûs ÿÎback']è&& is£t(
$·»Á
['access callback'])) {

2386 
$™em
['acûs ÿÎback'] = 
$·»Á
['access callback'];

2387 ià(!
	`is£t
(
$™em
['acûs ¬gum’ts']è&& is£t(
$·»Á
['access‡rguments'])) {

2388 
$™em
['acûs ¬gum’ts'] = 
$·»Á
['access‡rguments'];

2392 ià(!
	`is£t
(
$™em
['·gÿÎback']è&& is£t(
$·»Á
['page callback'])) {

2393 
$™em
['·gÿÎback'] = 
$·»Á
['page callback'];

2394 ià(!
	`is£t
(
$™em
['·g¬gum’ts']è&& is£t(
$·»Á
['page‡rguments'])) {

2395 
$™em
['·g¬gum’ts'] = 
$·»Á
['page‡rguments'];

2397 ià(!
	`is£t
(
$™em
['fe']è&& is£t(
$·»Á
['file'])) {

2398 
$™em
['fe'] = 
$·»Á
['file'];

2400 ià(!
	`is£t
(
$™em
['f·th']è&& is£t(
$·»Á
['file…ath'])) {

2401 
$™em
['f·th'] = 
$·»Á
['file…ath'];

2406 ià(!
	`is£t
(
$™em
['access callback']) && isset($item['access‡rguments'])) {

2408 
$™em
['access callback'] = 'user_access';

2410 ià(!
	`is£t
(
$™em
['acûs ÿÎback']è|| 
	`em±y
($item['page callback'])) {

2411 
$™em
['access callback'] = 0;

2413 ià(
	`is_boŞ
(
$™em
['access callback'])) {

2414 
$™em
['acûs ÿÎback'] = 
	`štv®
($item['access callback']);

2417 
$™em
 +ğ
	`¬¿y
(

2418 'acûs ¬gum’ts' => 
	`¬¿y
(),

2420 '·g¬gum’ts' => 
	`¬¿y
(),

2423 't™Ë‡rgum’ts' => 
	`¬¿y
(),

2428 'b_roÙ' => 
$·th
,

2429 '·th' => 
$·th
,

2436 ià(
$™em
['file']) {

2437 
$fe_·th
 = 
$™em
['f·th'] ? $™em['f·th'] : 
	`dru·l_g‘_·th
('module', $item['module']);

2438 
$™em
['šşudfe'] = 
$fe_·th
 .'/'. $item['file'];

2441 
$t™Ë_¬gum’ts
 = 
$™em
['t™Ë‡rgum’ts'] ? 
	`£rŸlize
($item['title‡rguments']) : '';

2442 
	`db_qu”y
("INSERT INTO {menu_router}

2443 (
·th
, 
lßd_funùiÚs
, 
to_¬g_funùiÚs
, 
acûss_ÿÎback
,

2444 
acûss_¬gum’ts
, 
·ge_ÿÎback
, 
·ge_¬gum’ts
, 
f™
,

2445 
numb”_·¹s
, 
b_·»Á
, 
b_roÙ
,

2446 
t™Ë
, 
t™Ë_ÿÎback
, 
t™Ë_¬gum’ts
,

2447 
ty³
, 
block_ÿÎback
, 
desütiÚ
, 
pos™iÚ
, 
weight
, 
fe
)

2448 
	`VALUES
 ('%s', '%s', '%s', '%s',

2449 '%s', '%s', '%s', %
d
,

2450 %
d
, '%s', '%s',

2452 %
d
, '%s', '%s', '%s', %d, '%s')",

2453 
$·th
, 
$™em
['load_functions'], $item['to_arg_functions'], $item['access callback'],

2454 
	`£rŸlize
(
$™em
['access‡rguments']), $item['page callback'], serialize($item['page‡rguments']), $item['_fit'],

2455 
$™em
['_number_parts'], $item['tab_parent'], $item['tab_root'],

2456 
$™em
['t™Ë'], $™em['t™Ë c®lback'], 
$t™Ë_¬gum’ts
,

2457 
$™em
['type'], $item['block callback'], $item['description'], $item['position'], $item['weight'], $item['include file']);

2460 
$masks
 = 
	`¬¿y_keys
($masks);

2461 
	`rsÜt
(
$masks
);

2462 
	`v¬ŸbË_£t
('m’u_masks', 
$masks
);

2464  
$m’u
;

2465 
	}
}

2470 
funùiÚ
 
	$m’u_·th_is_ex‹º®
(
$·th
) {

2471 
$cŞÚpos
 = 
	`¡½os
(
$·th
, ':');

2472  
$cŞÚpos
 !=ğ
FALSE
 && !
	`´eg_m©ch
('![/?#]!', 
	`sub¡r
(
$·th
, 0, $cŞÚpos)è&& 
	`f‹r_xss_bad_´ÙocŞ
($·th, FALSEè=ğ
	`check_¶aš
($path);

2473 
	}
}

2486 
funùiÚ
 
	$_m’u_s™e_is_ofæše
() {

2488 ià(
	`v¬ŸbË_g‘
('site_offline', 0)) {

2490 ià(
	`u£r_acûss
('administer site configuration')) {

2494 ià(
	`dru·l_g‘_nÜm®_·th
(
$_GET
['q']) != 'admin/settings/site-maintenance') {

2495 
	`dru·l_£t_mes§ge
(
	`l
(
	`t
('O³¿tšg iÀoff-lšmode.'), 'admš/£‰šgs/s™e-maš‹Çnû'), '¡©us', 
FALSE
);

2500 ià(
	`u£r_is_ªÚymous
()) {

2501  
$_GET
['q'] != 'user' && $_GET['q'] != 'user/login';

2504 
»quœe_Úû
 
	`dru·l_g‘_·th
('module', 'user') .'/user.pages.inc';

2505 
	`u£r_logout
();

2508  
FALSE
;

2509 
	}
}

2518 
funùiÚ
 
	$m’u_v®id_·th
(
$fÜm_™em
) {

2519 
glob®
 
$m’u_admš
;

2520 
$™em
 = 
	`¬¿y
();

2521 
$·th
 = 
$fÜm_™em
['link_path'];

2523 
$m’u_admš
 = 
TRUE
;

2524 ià(
$·th
 =ğ'<äÚt>' || 
	`m’u_·th_is_ex‹º®
($path)) {

2525 
$™em
 = 
	`¬¿y
('acûss' => 
TRUE
);

2527 
	`–£if
 (
	`´eg_m©ch
('/\/\%/', 
$·th
)) {

2529 ià(
$™em
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT * FROM {m’u_rou‹r} wh”·th = '%s' ", 
$·th
))) {

2530 
$™em
['lšk_·th'] = 
$fÜm_™em
['link_path'];

2531 
$™em
['lšk_t™Ë'] = 
$fÜm_™em
['link_title'];

2532 
$™em
['ex‹º®'] = 
FALSE
;

2533 
$™em
['options'] = '';

2534 
	`_m’u_lšk_Œª¦©e
(
$™em
);

2538 
$™em
 = 
	`m’u_g‘_™em
(
$·th
);

2540 
$m’u_admš
 = 
FALSE
;

2541  
$™em
 && $item['access'];

2542 
	}
}

	@/srv/http/subs/notes/www/includes/module.inc

1 <?
php


12 
funùiÚ
 
	$moduË_lßd_®l
() {

13 
	`fÜ—ch
 (
	`moduË_li¡
(
TRUE
, 
FALSE
è
as
 
$moduË
) {

14 
	`dru·l_lßd
('moduË', 
$moduË
);

16 
	}
}

21 
funùiÚ
 
moduË_™”©e
(
$funùiÚ
, 
$¬gum’t
 = '') {

22 
fÜ—ch
 (
moduË_li¡
(è
as
 
$Çme
) {

23 
$funùiÚ
(
$Çme
, 
$¬gum’t
);

47 
funùiÚ
 
	$moduË_li¡
(
$»äesh
 = 
FALSE
, 
$boÙ¡¿p
 = 
TRUE
, 
$sÜt
 = FALSE, 
$fixed_li¡
 = 
NULL
) {

48 
$li¡
, 
$sÜ‹d_li¡
;

50 ià(
$»äesh
 || 
$fixed_li¡
) {

51 
$li¡
 = 
	`¬¿y
();

52 
$sÜ‹d_li¡
 = 
NULL
;

53 ià(
$fixed_li¡
) {

54 
	`fÜ—ch
 (
$fixed_li¡
 
as
 
$Çme
 => 
$moduË
) {

55 
	`dru·l_g‘_f’ame
('moduË', 
$Çme
, 
$moduË
['filename']);

56 
$li¡
[
$Çme
] = $name;

60 ià(
$boÙ¡¿p
) {

61 
$»suÉ
 = 
	`db_qu”y
("SELECT‚ame, filename,hrottle FROM {system} WHEREype = 'module' AND status = 1 AND bootstrap = 1 ORDER BY weight ASC, filename ASC");

64 
$»suÉ
 = 
	`db_qu”y
("SELECT‚ame, filename,hrottle FROM {system} WHEREype = 'module' AND status = 1 ORDER BY weight ASC, filename ASC");

66 
$moduË
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

67 ià(
	`fe_exi¡s
(
$moduË
->
f’ame
)) {

71 
$thrÙe
 = (
$moduË
->
thrÙe
 && 
	`v¬ŸbË_g‘
('throttle_level', 0) > 0);

72 ià(!
$thrÙe
) {

73 
	`dru·l_g‘_f’ame
('moduË', 
$moduË
->
Çme
, $moduË->
f’ame
);

74 
$li¡
[
$moduË
->
Çme
] = $module->name;

80 ià(
$sÜt
) {

81 ià(!
	`is£t
(
$sÜ‹d_li¡
)) {

82 
$sÜ‹d_li¡
 = 
$li¡
;

83 
	`ksÜt
(
$sÜ‹d_li¡
);

85  
$sÜ‹d_li¡
;

87  
$li¡
;

88 
	}
}

96 
funùiÚ
 
	$moduË_»bud_ÿche
() {

98 
$fes
 = 
	`dru·l_sy¡em_li¡šg
('\.module$', 'modules', 'name', 0);

101 
	`sy¡em_g‘_fes_d©aba£
(
$fes
, 'module');

103 
	`ksÜt
(
$fes
);

106 
$deçuÉs
 = 
	`¬¿y
(

107 'd•’d’c›s' => 
	`¬¿y
(),

108 'd•’d’ts' => 
	`¬¿y
(),

110 'v”siÚ' => 
NULL
,

111 'php' => 
DRUPAL_MINIMUM_PHP
,

114 
	`fÜ—ch
 (
$fes
 
as
 
$f’ame
 => 
$fe
) {

116 
$fe
->
šfo
 = 
	`dru·l_·r£_šfo_fe
(
	`dœÇme
($fe->
f’ame
è.'/'. $fe->
Çme
 .'.info');

119 ià(
	`em±y
(
$fe
->
šfo
)) {

120 
	`un£t
(
$fes
[
$f’ame
]);

124 
$fes
[
$f’ame
]->
šfo
 = 
$fe
->šfØ+ 
$deçuÉs
;

128 
	`dru·l_®‹r
('sy¡em_šfo', 
$fes
[
$f’ame
]->
šfo
, $files[$filename]);

131 
$boÙ¡¿p
 = 0;

132 
	`fÜ—ch
 (
	`boÙ¡¿p_hooks
(è
as
 
$hook
) {

133 ià(
	`moduË_hook
(
$fe
->
Çme
, 
$hook
)) {

134 
$boÙ¡¿p
 = 1;

140 ià(
	`is£t
(
$fe
->
¡©us
è|| (is£t($fe->
Şd_f’ame
è&& $fe->Şd_f’am!ğ$fe->
f’ame
)) {

141 
	`db_qu”y
("UPDATE {sy¡em} SET infØğ'%s',‚amğ'%s', f’amğ'%s', boÙ¡¿°ğ%d WHERE f’amğ'%s'", 
	`£rŸlize
(
$fes
[
$f’ame
]->
šfo
), 
$fe
->
Çme
, $fe->
f’ame
, 
$boÙ¡¿p
, $fe->
Şd_f’ame
);

145 
$fes
[
$f’ame
]->
¡©us
 = 0;

146 
$fes
[
$f’ame
]->
thrÙe
 = 0;

147 
	`db_qu”y
("INSERT INTO {sy¡em} (Çme, info,y³, f’ame, stus,hrÙe, boÙ¡¿pèVALUES ('%s', '%s', '%s', '%s', %d, %d, %d)", 
$fe
->
Çme
, 
	`£rŸlize
(
$fes
[
$f’ame
]->
šfo
), 'moduË', $fe->
f’ame
, 0, 0, 
$boÙ¡¿p
);

150 
$fes
 = 
	`_moduË_bud_d•’d’c›s
($files);

151  
$fes
;

152 
	}
}

172 
funùiÚ
 
	$_moduË_bud_d•’d’c›s
(
$fes
) {

174 
$Ãw_d•’d’cy
 = 
FALSE
;

175 
	`fÜ—ch
 (
$fes
 
as
 
$f’ame
 => 
$fe
) {

177 
$fe
 = &
$fes
[
$f’ame
];

178 ià(
	`is£t
(
$fe
->
šfo
['d•’d’c›s']è&& 
	`is_¬¿y
($file->info['dependencies'])) {

179 
	`fÜ—ch
 (
$fe
->
šfo
['d•’d’c›s'] 
as
 
$d•’d’cy_Çme
) {

181 ià(
$d•’d’cy_Çme
 =ğ'-cœcuÏr-' || !
	`is£t
(
$fes
[$dependency_name])) {

185 
$fes
[
$d•’d’cy_Çme
]->
šfo
['d•’d’ts'][
$f’ame
] = $filename;

186 
$d•’d’cy
 = 
$fes
[
$d•’d’cy_Çme
];

187 ià(
	`is£t
(
$d•’d’cy
->
šfo
['d•’d’c›s']è&& 
	`is_¬¿y
($dependency->info['dependencies'])) {

189 
	`fÜ—ch
 (
$d•’d’cy
->
šfo
['d•’d’c›s'] 
as
 
$ÿndid©e
) {

190 ià(
	`¬¿y_£¬ch
(
$ÿndid©e
, 
$fe
->
šfo
['d•’d’c›s']è==ğ
FALSE
) {

192 ià(
$ÿndid©e
 =ğ
$f’ame
) {

195 
$ÿndid©e
 = '-circular-';

197 ià(
	`¬¿y_£¬ch
(
$ÿndid©e
, 
$fe
->
šfo
['d•’d’c›s']è!=ğ
FALSE
) {

200 
	`dru·l_£t_mes§ge
(
	`t
('%moduË i ·¹ oà¨cœcuÏ¸d•’d’cy. Thi i nÙ suµÜ‹d‡nd you wÈnÙ babËØsw™ch iˆÚ.', 
	`¬¿y
('%moduË' => 
$fe
->
šfo
['name'])), 'error');

206 
$Ãw_d•’d’cy
 = 
TRUE
;

208 
$fe
->
šfo
['d•’d’c›s'][] = 
$ÿndid©e
;

215 
	`un£t
(
$fe
);

217 } 
$Ãw_d•’d’cy
);

218  
$fes
;

219 
	}
}

229 
funùiÚ
 
	$moduË_exi¡s
(
$moduË
) {

230 
$li¡
 = 
	`moduË_li¡
();

231  
	`¬¿y_key_exi¡s
(
$moduË
, 
$li¡
);

232 
	}
}

237 
funùiÚ
 
	$moduË_lßd_š¡®l
(
$moduË
) {

239 
šşude_Úû
 './includes/install.inc';

241 
	`moduË_lßd_šşude
('š¡®l', 
$moduË
);

242 
	}
}

266 
funùiÚ
 
	$moduË_lßd_šşude
(
$ty³
, 
$moduË
, 
$Çme
 = 
NULL
) {

267 ià(
	`em±y
(
$Çme
)) {

268 
$Çme
 = 
$moduË
;

271 
$fe
 = './'. 
	`dru·l_g‘_·th
('moduË', 
$moduË
) ."/$name.$type";

273 ià(
	`is_fe
(
$fe
)) {

274 
»quœe_Úû
 
$fe
;

277  
FALSE
;

279 
	}
}

285 
funùiÚ
 
	$moduË_lßd_®l_šşudes
(
$ty³
, 
$Çme
 = 
NULL
) {

286 
$moduËs
 = 
	`moduË_li¡
();

287 
	`fÜ—ch
 (
$moduËs
 
as
 
$moduË
) {

288 
	`moduË_lßd_šşude
(
$ty³
, 
$moduË
, 
$Çme
);

290 
	}
}

298 
funùiÚ
 
	$moduË_’abË
(
$moduË_li¡
) {

299 
$švoke_moduËs
 = 
	`¬¿y
();

300 
	`fÜ—ch
 (
$moduË_li¡
 
as
 
$moduË
) {

301 
$exi¡šg
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT stu FROM {sy¡em} WHEREy³ = '%s' AND‚amğ'%s'", 'moduË', 
$moduË
));

302 ià(
$exi¡šg
->
¡©us
 == 0) {

303 
	`moduË_lßd_š¡®l
(
$moduË
);

304 
	`db_qu”y
("UPDATE {sy¡em} SET stu ğ%d,hrÙğ%d WHEREy³ = '%s' AND‚amğ'%s'", 1, 0, 'moduË', 
$moduË
);

305 
	`dru·l_lßd
('moduË', 
$moduË
);

306 
$švoke_moduËs
[] = 
$moduË
;

310 ià(!
	`em±y
(
$švoke_moduËs
)) {

312 
	`moduË_li¡
(
TRUE
, 
FALSE
);

314 
	`moduË_im¶em’ts
('', 
FALSE
, 
TRUE
);

317 
	`fÜ—ch
 (
$švoke_moduËs
 
as
 
$moduË
) {

318 
	`moduË_švoke
(
$moduË
, 'enable');

323 ià(
	`funùiÚ_exi¡s
('node_acûss_Ãeds_»bud'è&& !
	`node_acûss_Ãeds_»bud
(è&& 
	`moduË_hook
(
$moduË
, 'node_grants')) {

324 
	`node_acûss_Ãeds_»bud
(
TRUE
);

327 
	}
}

335 
funùiÚ
 
	$moduË_di§bË
(
$moduË_li¡
) {

336 
$švoke_moduËs
 = 
	`¬¿y
();

337 
	`fÜ—ch
 (
$moduË_li¡
 
as
 
$moduË
) {

338 ià(
	`moduË_exi¡s
(
$moduË
)) {

340 ià(!
	`node_acûss_Ãeds_»bud
(è&& 
	`moduË_hook
(
$moduË
, 'node_grants')) {

341 
	`node_acûss_Ãeds_»bud
(
TRUE
);

344 
	`moduË_lßd_š¡®l
(
$moduË
);

345 
	`moduË_švoke
(
$moduË
, 'disable');

346 
	`db_qu”y
("UPDATE {sy¡em} SET stu ğ%d,hrÙğ%d WHEREy³ = '%s' AND‚amğ'%s'", 0, 0, 'moduË', 
$moduË
);

347 
$švoke_moduËs
[] = 
$moduË
;

351 ià(!
	`em±y
(
$švoke_moduËs
)) {

353 
	`moduË_li¡
(
TRUE
, 
FALSE
);

355 
	`moduË_im¶em’ts
('', 
FALSE
, 
TRUE
);

360 ià(
	`node_acûss_Ãeds_»bud
(è&& 
	`couÁ
(
	`moduË_im¶em’ts
('node_grants')) == 0) {

361 
	`node_acûss_»bud
();

363 
	}
}

397 
funùiÚ
 
	$moduË_hook
(
$moduË
, 
$hook
) {

398  
	`funùiÚ_exi¡s
(
$moduË
 .'_'. 
$hook
);

399 
	}
}

416 
funùiÚ
 
	$moduË_im¶em’ts
(
$hook
, 
$sÜt
 = 
FALSE
, 
$»äesh
 = FALSE) {

417 
$im¶em’tiÚs
;

419 ià(
$»äesh
) {

420 
$im¶em’tiÚs
 = 
	`¬¿y
();

424 ià(!
	`is£t
(
$im¶em’tiÚs
[
$hook
])) {

425 
$im¶em’tiÚs
[
$hook
] = 
	`¬¿y
();

426 
$li¡
 = 
	`moduË_li¡
(
FALSE
, 
TRUE
, 
$sÜt
);

427 
	`fÜ—ch
 (
$li¡
 
as
 
$moduË
) {

428 ià(
	`moduË_hook
(
$moduË
, 
$hook
)) {

429 
$im¶em’tiÚs
[
$hook
][] = 
$moduË
;

440  (
¬¿y
)
$im¶em’tiÚs
[
$hook
];

441 
	}
}

455 
funùiÚ
 
	$moduË_švoke
() {

456 
$¬gs
 = 
	`func_g‘_¬gs
();

457 
$moduË
 = 
$¬gs
[0];

458 
$hook
 = 
$¬gs
[1];

459 
	`un£t
(
$¬gs
[0], $args[1]);

460 
$funùiÚ
 = 
$moduË
 .'_'. 
$hook
;

461 ià(
	`moduË_hook
(
$moduË
, 
$hook
)) {

462  
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
$¬gs
);

464 
	}
}

476 
funùiÚ
 
	$moduË_švoke_®l
() {

477 
$¬gs
 = 
	`func_g‘_¬gs
();

478 
$hook
 = 
$¬gs
[0];

479 
	`un£t
(
$¬gs
[0]);

480 
$»tuº
 = 
	`¬¿y
();

481 
	`fÜ—ch
 (
	`moduË_im¶em’ts
(
$hook
è
as
 
$moduË
) {

482 
$funùiÚ
 = 
$moduË
 .'_'. 
$hook
;

483 
$»suÉ
 = 
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
$¬gs
);

484 ià(
	`is£t
(
$»suÉ
è&& 
	`is_¬¿y
($result)) {

485 
$»tuº
 = 
	`¬¿y_m”ge_»cursive
($»tuº, 
$»suÉ
);

487 ià(
	`is£t
(
$»suÉ
)) {

488 
$»tuº
[] = 
$»suÉ
;

492  
$»tuº
;

493 
	}
}

502 
funùiÚ
 
	$dru·l_»quœed_moduËs
() {

503  
	`¬¿y
('block', 'filter', 'node', 'system', 'user');

504 
	}
}

	@/srv/http/subs/notes/www/includes/pager.inc

1 <?
php


51 
funùiÚ
 
	$·g”_qu”y
(
$qu”y
, 
$lim™
 = 10, 
$–em’t
 = 0, 
$couÁ_qu”y
 = 
NULL
) {

52 
glob®
 
$·g”_·ge_¬¿y
, 
$·g”_tÙ®
, 
$·g”_tÙ®_™ems
;

53 
$·ge
 = 
	`is£t
(
$_GET
['page']) ? $_GET['page'] : '';

56 
$¬gs
 = 
	`func_g‘_¬gs
();

57 
$¬gs
 = 
	`¬¿y_¦iû
($args, 4);

59 ià(
	`is£t
(
$¬gs
[0]è&& 
	`is_¬¿y
($args[0])) {

60 
$¬gs
 = $args[0];

64 ià(!
	`is£t
(
$couÁ_qu”y
)) {

65 
$couÁ_qu”y
 = 
	`´eg_»¶aû
(
	`¬¿y
('/SELECT.*?FROM /As', '/ORDER BY .*/'),‡¼ay('SELECT COUNT(*èFROM ', ''), 
$qu”y
);

69 
$·g”_·ge_¬¿y
 = 
	`ex¶ode
(',', 
$·ge
);

72 
$·g”_tÙ®_™ems
[
$–em’t
] = 
	`db_»suÉ
(
	`db_qu”y
(
$couÁ_qu”y
, 
$¬gs
));

73 
$·g”_tÙ®
[
$–em’t
] = 
	`û
(
$·g”_tÙ®_™ems
[$–em’t] / 
$lim™
);

74 
$·g”_·ge_¬¿y
[
$–em’t
] = 
	`max
(0, 
	`mš
(()$·g”_·ge_¬¿y[$–em’t], (()
$·g”_tÙ®
[$element]) - 1));

75  
	`db_qu”y_¿nge
(
$qu”y
, 
$¬gs
, 
$·g”_·ge_¬¿y
[
$–em’t
] * 
$lim™
, $limit);

76 
	}
}

85 
funùiÚ
 
	$·g”_g‘_qu”y¡ršg
() {

86 
$¡ršg
 = 
NULL
;

87 ià(!
	`is£t
(
$¡ršg
)) {

88 
$¡ršg
 = 
	`dru·l_qu”y_¡ršg_’code
(
$_REQUEST
, 
	`¬¿y_m”ge
(
	`¬¿y
('q', '·ge', '·ss'), 
	`¬¿y_keys
(
$_COOKIE
)));

90  
$¡ršg
;

91 
	}
}

115 
funùiÚ
 
theme_·g”
(
$gs
 = 
¬¿y
(), 
$lim™
 = 10, 
$–em’t
 = 0, 
$·¿m‘”s
 =‡¼ay(), 
$quªt™y
 = 9) {

116 
glob®
 
$·g”_·ge_¬¿y
, 
$·g”_tÙ®
;

120 
	g$·g”_middË
 = 
û
(
$quªt™y
 / 2);

122 
	g$·g”_cu¼’t
 = 
$·g”_·ge_¬¿y
[
$–em’t
] + 1;

124 
	g$·g”_fœ¡
 = 
$·g”_cu¼’t
 - 
$·g”_middË
 + 1;

126 
	g$·g”_Ï¡
 = 
$·g”_cu¼’t
 + 
$quªt™y
 - 
$·g”_middË
;

128 
	g$·g”_max
 = 
$·g”_tÙ®
[
$–em’t
];

132 
	g$i
 = 
$·g”_fœ¡
;

133 ià(
	g$·g”_Ï¡
 > 
	g$·g”_max
) {

135 
	g$i
 = 
$i
 + (
$·g”_max
 - 
$·g”_Ï¡
);

136 
	g$·g”_Ï¡
 = 
$·g”_max
;

138 ià(
	g$i
 <= 0) {

140 
$·g”_Ï¡
 = $·g”_Ï¡ + (1 - 
$i
);

141 
	g$i
 = 1;

145 
	g$li_fœ¡
 = 
theme
('·g”_fœ¡', (
is£t
(
$gs
[0]è? $gs[0] : 
t
('Â« fœ¡')), 
$lim™
, 
$–em’t
, 
$·¿m‘”s
);

146 
	g$li_´evious
 = 
theme
('·g”_´evious', (
is£t
(
$gs
[1]è? $gs[1] : 
t
('â€¹…»vious')), 
$lim™
, 
$–em’t
, 1, 
$·¿m‘”s
);

147 
	g$li_Ãxt
 = 
theme
('·g”_Ãxt', (
is£t
(
$gs
[3]è? $gs[3] : 
t
('Ãxˆâ€º')), 
$lim™
, 
$–em’t
, 1, 
$·¿m‘”s
);

148 
	g$li_Ï¡
 = 
theme
('·g”_Ï¡', (
is£t
(
$gs
[4]è? $gs[4] : 
t
('Ï¡ Â»')), 
$lim™
, 
$–em’t
, 
$·¿m‘”s
);

150 ià(
	g$·g”_tÙ®
[
$–em’t
] > 1) {

151 ià(
	g$li_fœ¡
) {

152 
	g$™ems
[] = 
¬¿y
(

154 'd©a' => 
$li_fœ¡
,

157 ià(
	g$li_´evious
) {

158 
	g$™ems
[] = 
¬¿y
(

160 'd©a' => 
$li_´evious
,

165 ià(
	g$i
 !ğ
$·g”_max
) {

166 ià(
$i
 > 1) {

167 
$™ems
[] = 
¬¿y
(

173 ; 
	g$i
 <ğ
$·g”_Ï¡
 && 
$i
 <ğ
$·g”_max
; $i++) {

174 ià(
	g$i
 < 
	g$·g”_cu¼’t
) {

175 
	g$™ems
[] = 
¬¿y
(

177 'd©a' => 
theme
('·g”_´evious', 
$i
, 
$lim™
, 
$–em’t
, (
$·g”_cu¼’t
 - $i), 
$·¿m‘”s
),

180 ià(
	g$i
 =ğ
$·g”_cu¼’t
) {

181 
$™ems
[] = 
¬¿y
(

183 'd©a' => 
$i
,

186 ià(
	g$i
 > 
	g$·g”_cu¼’t
) {

187 
	g$™ems
[] = 
¬¿y
(

189 'd©a' => 
theme
('·g”_Ãxt', 
$i
, 
$lim™
, 
$–em’t
, ($˜- 
$·g”_cu¼’t
), 
$·¿m‘”s
),

193 ià(
	g$i
 < 
	g$·g”_max
) {

194 
	g$™ems
[] = 
¬¿y
(

201 ià(
	g$li_Ãxt
) {

202 
	g$™ems
[] = 
¬¿y
(

204 'd©a' => 
$li_Ãxt
,

207 ià(
	g$li_Ï¡
) {

208 
	g$™ems
[] = 
¬¿y
(

210 'd©a' => 
$li_Ï¡
,

213  
theme
('™em_li¡', 
$™ems
, 
NULL
, 'ul', 
¬¿y
('class' => 'pager'));

241 
funùiÚ
 
theme_·g”_fœ¡
(
$‹xt
, 
$lim™
, 
$–em’t
 = 0, 
$·¿m‘”s
 = 
	$¬¿y
()) {

242 
glob®
 
$·g”_·ge_¬¿y
;

243 
$ouut
 = '';

246 ià(
$·g”_·ge_¬¿y
[
$–em’t
] > 0) {

247 
$ouut
 = 
	`theme
('·g”_lšk', 
$‹xt
, 
	`·g”_lßd_¬¿y
(0, 
$–em’t
, 
$·g”_·ge_¬¿y
), $–em’t, 
$·¿m‘”s
);

250  
$ouut
;

251 
	}
}

271 
funùiÚ
 
theme_·g”_´evious
(
$‹xt
, 
$lim™
, 
$–em’t
 = 0, 
$š‹rv®
 = 1, 
$·¿m‘”s
 = 
	$¬¿y
()) {

272 
glob®
 
$·g”_·ge_¬¿y
;

273 
$ouut
 = '';

276 ià(
$·g”_·ge_¬¿y
[
$–em’t
] > 0) {

277 
$·ge_Ãw
 = 
	`·g”_lßd_¬¿y
(
$·g”_·ge_¬¿y
[
$–em’t
] - 
$š‹rv®
, $element, $pager_page_array);

280 ià(
$·ge_Ãw
[
$–em’t
] == 0) {

281 
$ouut
 = 
	`theme
('·g”_fœ¡', 
$‹xt
, 
$lim™
, 
$–em’t
, 
$·¿m‘”s
);

285 
$ouut
 = 
	`theme
('·g”_lšk', 
$‹xt
, 
$·ge_Ãw
, 
$–em’t
, 
$·¿m‘”s
);

289  
$ouut
;

290 
	}
}

310 
funùiÚ
 
theme_·g”_Ãxt
(
$‹xt
, 
$lim™
, 
$–em’t
 = 0, 
$š‹rv®
 = 1, 
$·¿m‘”s
 = 
	$¬¿y
()) {

311 
glob®
 
$·g”_·ge_¬¿y
, 
$·g”_tÙ®
;

312 
$ouut
 = '';

315 ià(
$·g”_·ge_¬¿y
[
$–em’t
] < (
$·g”_tÙ®
[$element] - 1)) {

316 
$·ge_Ãw
 = 
	`·g”_lßd_¬¿y
(
$·g”_·ge_¬¿y
[
$–em’t
] + 
$š‹rv®
, $element, $pager_page_array);

318 ià(
$·ge_Ãw
[
$–em’t
] =ğ(
$·g”_tÙ®
[$element] - 1)) {

319 
$ouut
 = 
	`theme
('·g”_Ï¡', 
$‹xt
, 
$lim™
, 
$–em’t
, 
$·¿m‘”s
);

323 
$ouut
 = 
	`theme
('·g”_lšk', 
$‹xt
, 
$·ge_Ãw
, 
$–em’t
, 
$·¿m‘”s
);

327  
$ouut
;

328 
	}
}

346 
funùiÚ
 
theme_·g”_Ï¡
(
$‹xt
, 
$lim™
, 
$–em’t
 = 0, 
$·¿m‘”s
 = 
	$¬¿y
()) {

347 
glob®
 
$·g”_·ge_¬¿y
, 
$·g”_tÙ®
;

348 
$ouut
 = '';

351 ià(
$·g”_·ge_¬¿y
[
$–em’t
] < (
$·g”_tÙ®
[$element] - 1)) {

352 
$ouut
 = 
	`theme
('·g”_lšk', 
$‹xt
, 
	`·g”_lßd_¬¿y
(
$·g”_tÙ®
[
$–em’t
] - 1, $–em’t, 
$·g”_·ge_¬¿y
), $–em’t, 
$·¿m‘”s
);

355  
$ouut
;

356 
	}
}

375 
funùiÚ
 
theme_·g”_lšk
(
$‹xt
, 
$·ge_Ãw
, 
$–em’t
, 
$·¿m‘”s
 = 
¬¿y
(), 
$©Œibu‹s
 = 
	$¬¿y
()) {

376 
$·ge
 = 
	`is£t
(
$_GET
['page']) ? $_GET['page'] : '';

377 ià(
$Ãw_·ge
 = 
	`im¶ode
(',', 
	`·g”_lßd_¬¿y
(
$·ge_Ãw
[
$–em’t
], $–em’t, 
	`ex¶ode
(',', 
$·ge
)))) {

378 
$·¿m‘”s
['·ge'] = 
$Ãw_·ge
;

381 
$qu”y
 = 
	`¬¿y
();

382 ià(
	`couÁ
(
$·¿m‘”s
)) {

383 
$qu”y
[] = 
	`dru·l_qu”y_¡ršg_’code
(
$·¿m‘”s
, 
	`¬¿y
());

385 
$qu”y¡ršg
 = 
	`·g”_g‘_qu”y¡ršg
();

386 ià(
$qu”y¡ršg
 != '') {

387 
$qu”y
[] = 
$qu”y¡ršg
;

391 ià(!
	`is£t
(
$©Œibu‹s
['title'])) {

392 
$t™Ës
 = 
NULL
;

393 ià(!
	`is£t
(
$t™Ës
)) {

394 
$t™Ës
 = 
	`¬¿y
(

395 
	`t
('Â« first') =>('Goo first…age'),

396 
	`t
('â€¹…revious') =>('Goo…revious…age'),

397 
	`t
('next â€º') =>('Goo‚ext…age'),

398 
	`t
('last Â»') =>('Goo†ast…age'),

401 ià(
	`is£t
(
$t™Ës
[
$‹xt
])) {

402 
$©Œibu‹s
['t™Ë'] = 
$t™Ës
[
$‹xt
];

404 ià(
	`is_num”ic
(
$‹xt
)) {

405 
$©Œibu‹s
['t™Ë'] = 
	`t
('GØtØ·g@numb”', 
	`¬¿y
('@numb”' => 
$‹xt
));

409  
	`l
(
$‹xt
, 
$_GET
['q'], 
	`¬¿y
('©Œibu‹s' => 
$©Œibu‹s
, 'qu”y' => 
	`couÁ
(
$qu”y
è? 
	`im¶ode
('&', $qu”yè: 
NULL
));

410 
	}
}

422 
funùiÚ
 
	$·g”_lßd_¬¿y
(
$v®ue
, 
$–em’t
, 
$Şd_¬¿y
) {

423 
$Ãw_¬¿y
 = 
$Şd_¬¿y
;

425 
$i
 = 0; $˜< 
$–em’t
; $i++) {

426 ià(!
$Ãw_¬¿y
[
$i
]) {

428 
$Ãw_¬¿y
[
$i
] = 0;

432 
$Ãw_¬¿y
[
$–em’t
] = ()
$v®ue
;

433  
$Ãw_¬¿y
;

434 
	}
}

	@/srv/http/subs/notes/www/includes/path.inc

1 <?
php


16 
funùiÚ
 
	$dru·l_š™_·th
() {

17 ià(!
	`em±y
(
$_GET
['q'])) {

18 
$_GET
['q'] = 
	`dru·l_g‘_nÜm®_·th
(
	`Œim
($_GET['q'], '/'));

21 
$_GET
['q'] = 
	`dru·l_g‘_nÜm®_·th
(
	`v¬ŸbË_g‘
('site_frontpage', 'node'));

23 
	}
}

46 
funùiÚ
 
dru·l_lookup_·th
(
$aùiÚ
, 
$·th
 = '', 
$·th_Ïnguage
 = '') {

47 
glob®
 
$Ïnguage
;

49 
	g$m­
 = 
¬¿y
(), 
	g$no_¤c
 =‡¼ay(), 
	g$couÁ
;

51 
	g$·th_Ïnguage
 = 
$·th_Ïnguage
 ? $·th_Ïnguag: 
$Ïnguage
->
Ïnguage
;

54 ià(!
is£t
(
$couÁ
)) {

55 
	g$couÁ
 = 
db_»suÉ
(
db_qu”y
('SELECT COUNT(pid) FROM {url_alias}'));

58 ià(
	g$aùiÚ
 == 'wipe') {

59 
$m­
 = 
¬¿y
();

60 
	g$no_¤c
 = 
¬¿y
();

61 
	g$couÁ
 = 
NULL
;

63 
–£if
 (
$couÁ
 > 0 && 
$·th
 != '') {

64 ià(
$aùiÚ
 == 'alias') {

65 ià(
is£t
(
$m­
[
$·th_Ïnguage
][
$·th
])) {

66  
$m­
[
$·th_Ïnguage
][
$·th
];

69 
	g$®Ÿs
 = 
db_»suÉ
(
db_qu”y
("SELECT d¡ FROM {u¾_®Ÿs} WHERE srøğ'%s' AND†ªguagIN('%s', ''èORDER BY†ªguagDESC,…id DESC", 
$·th
, 
$·th_Ïnguage
));

70 
	g$m­
[
$·th_Ïnguage
][
$·th
] = 
$®Ÿs
;

71  
	g$®Ÿs
;

75 
–£if
 (
$aùiÚ
 =ğ'sourû' && !
is£t
(
$no_¤c
[
$·th_Ïnguage
][
$·th
])) {

77 
$¤c
 = '';

78 ià(!
is£t
(
$m­
[
$·th_Ïnguage
]è|| !(
	g$¤c
 = 
¬¿y_£¬ch
(
$·th
, $map[$path_language]))) {

80 ià(
	g$¤c
 = 
db_»suÉ
(
db_qu”y
("SELECT srøFROM {u¾_®Ÿs} WHERE d¡ = '%s' AND†ªguagIN('%s', ''èORDER BY†ªguagDESC,…id DESC", 
$·th
, 
$·th_Ïnguage
))) {

81 
	g$m­
[
$·th_Ïnguage
][
$¤c
] = 
$·th
;

87 
	g$no_¤c
[
$·th_Ïnguage
][
$·th
] = 
TRUE
;

90  
	g$¤c
;

94  
	gFALSE
;

109 
funùiÚ
 
dru·l_g‘_·th_®Ÿs
(
$·th
, 
$·th_Ïnguage
 = '') {

110 
$»suÉ
 = 
$·th
;

111 ià(
	g$®Ÿs
 = 
dru·l_lookup_·th
('®Ÿs', 
$·th
, 
$·th_Ïnguage
)) {

112 
	g$»suÉ
 = 
$®Ÿs
;

114  
	g$»suÉ
;

129 
funùiÚ
 
dru·l_g‘_nÜm®_·th
(
$·th
, 
$·th_Ïnguage
 = '') {

130 
$»suÉ
 = 
$·th
;

131 ià(
	g$¤c
 = 
dru·l_lookup_·th
('sourû', 
$·th
, 
$·th_Ïnguage
)) {

132 
	g$»suÉ
 = 
$¤c
;

134 ià(
funùiÚ_exi¡s
('custom_url_rewrite_inbound')) {

136 
cu¡om_u¾_»wr™e_šbound
(
$»suÉ
, 
$·th
, 
$·th_Ïnguage
);

138  
	g$»suÉ
;

160 
funùiÚ
 
	$¬g
(
$šdex
 = 
NULL
, 
$·th
 = NULL) {

161 
$¬gum’ts
;

163 ià(!
	`is£t
(
$·th
)) {

164 
$·th
 = 
$_GET
['q'];

166 ià(!
	`is£t
(
$¬gum’ts
[
$·th
])) {

167 
$¬gum’ts
[
$·th
] = 
	`ex¶ode
('/', $path);

169 ià(!
	`is£t
(
$šdex
)) {

170  
$¬gum’ts
[
$·th
];

172 ià(
	`is£t
(
$¬gum’ts
[
$·th
][
$šdex
])) {

173  
$¬gum’ts
[
$·th
][
$šdex
];

175 
	}
}

183 
funùiÚ
 
	$dru·l_g‘_t™Ë
() {

184 
$t™Ë
 = 
	`dru·l_£t_t™Ë
();

187 ià(!
	`is£t
(
$t™Ë
è&& 
	`funùiÚ_exi¡s
('menu_get_active_title')) {

188 
$t™Ë
 = 
	`check_¶aš
(
	`m’u_g‘_aùive_t™Ë
());

191  
$t™Ë
;

192 
	}
}

204 
funùiÚ
 
	$dru·l_£t_t™Ë
(
$t™Ë
 = 
NULL
) {

205 
$¡Üed_t™Ë
;

207 ià(
	`is£t
(
$t™Ë
)) {

208 
$¡Üed_t™Ë
 = 
$t™Ë
;

210  
$¡Üed_t™Ë
;

211 
	}
}

219 
funùiÚ
 
	$dru·l_is_äÚt_·ge
() {

220 
$is_äÚt_·ge
;

222 ià(!
	`is£t
(
$is_äÚt_·ge
)) {

225 
$is_äÚt_·ge
 = (
$_GET
['q'] =ğ
	`dru·l_g‘_nÜm®_·th
(
	`v¬ŸbË_g‘
('site_frontpage', 'node')));

228  
$is_äÚt_·ge
;

229 
	}
}

242 
funùiÚ
 
	$dru·l_m©ch_·th
(
$·th
, 
$·‰”ns
) {

243 
$»gexps
;

245 ià(!
	`is£t
(
$»gexps
[
$·‰”ns
])) {

246 
$»gexps
[
$·‰”ns
] = '/^('. 
	`´eg_»¶aû
(
	`¬¿y
('/(\r\n?|\n)/', '/\\\\\*/', '/(^|\|)\\\\<äÚt\\\\>($|\|)/'),‡¼ay('|', '.*', '\1'. 
	`´eg_quÙe
(
	`v¬ŸbË_g‘
('site_frontpage', 'node'), '/') .'\2'),…reg_quote($patterns, '/')) .')$/';

248  
	`´eg_m©ch
(
$»gexps
[
$·‰”ns
], 
$·th
);

249 
	}
}

	@/srv/http/subs/notes/www/includes/session.inc

1 <?
php


9 
funùiÚ
 
	$£ss_İ’
(
$§ve_·th
, 
$£ssiÚ_Çme
) {

10  
TRUE
;

11 
	}
}

13 
funùiÚ
 
	$£ss_şo£
() {

14  
TRUE
;

15 
	}
}

17 
funùiÚ
 
	$£ss_»ad
(
$key
) {

18 
glob®
 
$u£r
;

23 
	`»gi¡”_shutdown_funùiÚ
('session_write_close');

26 ià(!
	`is£t
(
$_COOKIE
[
	`£ssiÚ_Çme
()])) {

27 
$u£r
 = 
	`dru·l_ªÚymous_u£r
();

32 
$u£r
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT u.*, s.* FROM {u£rs} u INNER JOIN {£ssiÚs} s ON u.uid = s.uid WHERE s.sid = '%s'", 
$key
));

36 ià(
$u£r
 && $u£r->
uid
 > 0 && $u£r->
¡©us
 == 1) {

38 
$u£r
 = 
	`dru·l_uÅack
($user);

41 
$u£r
->
rŞes
 = 
	`¬¿y
();

42 
$u£r
->
rŞes
[
DRUPAL_AUTHENTICATED_RID
] = 'authenticated user';

43 
$»suÉ
 = 
	`db_qu”y
("SELECT„.rid,„.ÇmFROM {rŞe}„ INNER JOIN {u£rs_rŞes} u¸ON ur.rid =„.rid WHERE ur.uid = %d", 
$u£r
->
uid
);

44 
$rŞe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

45 
$u£r
->
rŞes
[
$rŞe
->
rid
] = $rŞe->
Çme
;

51 
$£ssiÚ
 = 
	`is£t
(
$u£r
->
£ssiÚ
) ? $user->session : '';

52 
$u£r
 = 
	`dru·l_ªÚymous_u£r
(
$£ssiÚ
);

55  
$u£r
->
£ssiÚ
;

56 
	}
}

58 
funùiÚ
 
	$£ss_wr™e
(
$key
, 
$v®ue
) {

59 
glob®
 
$u£r
;

66 ià(!
	`£ssiÚ_§ve_£ssiÚ
(è|| (
$u£r
->
uid
 =ğ0 && 
	`em±y
(
$_COOKIE
[
	`£ssiÚ_Çme
()]è&&ƒm±y(
$v®ue
))) {

67  
TRUE
;

70 
	`db_qu”y
("UPDATE {£ssiÚs} SET uid = %d, cachğ%d, ho¡Çmğ'%s', sessiÚ = '%s',ime¡am°ğ%d WHERE sid = '%s'", 
$u£r
->
uid
, 
	`is£t
($u£r->
ÿche
è? $u£r->ÿch: '', 
	`_add»ss
(), 
$v®ue
, 
	`time
(), 
$key
);

71 ià(
	`db_afãùed_rows
()) {

74 ià(
$u£r
->
uid
 && 
	`time
(è- $u£r->
acûss
 > 
	`v¬ŸbË_g‘
('session_write_interval', 180)) {

75 
	`db_qu”y
("UPDATE {u£rs} SET‡cûs ğ%d WHERE uid = %d", 
	`time
(), 
$u£r
->
uid
);

81 @
	`db_qu”y
("INSERT INTO {£ssiÚs} (sid, uid, cache, ho¡Çme, sessiÚ,ime¡ampèVALUES ('%s', %d, %d, '%s', '%s', %d)", 
$key
, 
$u£r
->
uid
, 
	`is£t
($u£r->
ÿche
è? $u£r->ÿch: '', 
	`_add»ss
(), 
$v®ue
, 
	`time
());

84  
TRUE
;

85 
	}
}

90 
funùiÚ
 
	$£ss_»g’”©e
() {

91 
$Şd_£ssiÚ_id
 = 
	`£ssiÚ_id
();

98 ià(
	`is£t
(
$_COOKIE
[
	`£ssiÚ_Çme
()])) {

99 
	`£tcook›
(
	`£ssiÚ_Çme
(), '', 
	`time
() - 42000, '/');

102 
	`£ssiÚ_»g’”©e_id
();

104 
	`db_qu”y
("UPDATE {£ssiÚs} SET sid = '%s' WHERE sid = '%s'", 
	`£ssiÚ_id
(), 
$Şd_£ssiÚ_id
);

105 
	}
}

119 
funùiÚ
 
	$£ss_couÁ
(
$time¡amp
 = 0, 
$ªÚymous
 = 
Œue
) {

120 
$qu”y
 = 
$ªÚymous
 ? ' AND uid = 0' : ' AND uid > 0';

121  
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(sidèAS couÁ FROM {£ssiÚs} WHEREime¡am°>ğ%d'. 
$qu”y
, 
$time¡amp
));

122 
	}
}

130 
funùiÚ
 
	$£ss_de¡roy_sid
(
$sid
) {

131 
	`db_qu”y
("DELETE FROM {£ssiÚs} WHERE sid = '%s'", 
$sid
);

132 
	}
}

140 
funùiÚ
 
	$£ss_de¡roy_uid
(
$uid
) {

141 
	`db_qu”y
('DELETE FROM {£ssiÚs} WHERE uid = %d', 
$uid
);

142 
	}
}

144 
funùiÚ
 
	$£ss_gc
(
$liãtime
) {

150 
	`db_qu”y
("DELETE FROM {£ssiÚs} WHEREime¡am°< %d", 
	`time
(è- 
$liãtime
);

152  
TRUE
;

153 
	}
}

167 
funùiÚ
 
	$£ssiÚ_§ve_£ssiÚ
(
$¡©us
 = 
NULL
) {

168 
$§ve_£ssiÚ
 = 
TRUE
;

169 ià(
	`is£t
(
$¡©us
)) {

170 
$§ve_£ssiÚ
 = 
$¡©us
;

172  (
$§ve_£ssiÚ
);

173 
	}
}

	@/srv/http/subs/notes/www/includes/tablesort.inc

1 <?
php


15 
funùiÚ
 
	$bËsÜt_š™
(
$h—d”
) {

16 
$ts
 = 
	`bËsÜt_g‘_Üd”
(
$h—d”
);

17 
$ts
['sÜt'] = 
	`bËsÜt_g‘_sÜt
(
$h—d”
);

18 
$ts
['qu”y_¡ršg'] = 
	`bËsÜt_g‘_qu”y¡ršg
();

19  
$ts
;

20 
	}
}

39 
funùiÚ
 
bËsÜt_sql
(
$h—d”
, 
$befÜe
 = '') {

40 
$ts
 = 
bËsÜt_š™
(
$h—d”
);

41 ià(
	g$ts
['sql']) {

43 
	g$f›ld
 = 
´eg_»¶aû
('/[^A-Za-z0-9_.]+/', '', 
$ts
['sql']);

46 
	g$sÜt
 = 
dru·l_¡¹ouµ”
(
$ts
['sort']);

47 
	g$sÜt
 = 
š_¬¿y
(
$sÜt
, 
¬¿y
('ASC', 'DESC')) ? $sort : '';

68 
funùiÚ
 
	$bËsÜt_h—d”
(
$ûÎ
, 
$h—d”
, 
$ts
) {

70 ià(
	`is_¬¿y
(
$ûÎ
è&& 
	`is£t
($cell['field'])) {

71 
$t™Ë
 = 
	`t
('sÜˆby @s', 
	`¬¿y
('@s' => 
$ûÎ
['data']));

72 ià(
$ûÎ
['d©a'] =ğ
$ts
['name']) {

73 
$ts
['sort'] = (($ts['sort'] == 'asc') ? 'desc' : 'asc');

74 ià(
	`is£t
(
$ûÎ
['class'])) {

75 
$ûÎ
['class'] .= '‡ctive';

78 
$ûÎ
['class'] = 'active';

80 
$image
 = 
	`theme
('bËsÜt_šdiÿtÜ', 
$ts
['sort']);

84 
$ts
['sort'] = 'asc';

85 
$image
 = '';

88 ià(!
	`em±y
(
$ts
['query_string'])) {

89 
$ts
['query_string'] = '&'. $ts['query_string'];

91 
$ûÎ
['d©a'] = 
	`l
($ûÎ['d©a'] . 
$image
, 
$_GET
['q'], 
	`¬¿y
('©Œibu‹s' =>‡¼ay('t™Ë' => 
$t™Ë
), 'qu”y' => 'sÜt='. 
$ts
['sÜt'] .'&Üd”='. 
	`u¾’code
($ûÎ['d©a']è. $ts['qu”y_¡ršg'], 'html' => 
TRUE
));

93 
	`un£t
(
$ûÎ
['field'], $cell['sort']);

95  
$ûÎ
;

96 
	}
}

114 
funùiÚ
 
	$bËsÜt_ûÎ
(
$ûÎ
, 
$h—d”
, 
$ts
, 
$i
) {

115 ià(
	`is£t
(
$h—d”
[
$i
]['d©a']è&& $h—d”[$i]['d©a'] =ğ
$ts
['Çme'] && !
	`em±y
($header[$i]['field'])) {

116 ià(
	`is_¬¿y
(
$ûÎ
)) {

117 ià(
	`is£t
(
$ûÎ
['class'])) {

118 
$ûÎ
['class'] .= '‡ctive';

121 
$ûÎ
['class'] = 'active';

125 
$ûÎ
 = 
	`¬¿y
('data' => $cell, 'class' => 'active');

128  
$ûÎ
;

129 
	}
}

138 
funùiÚ
 
	$bËsÜt_g‘_qu”y¡ršg
() {

139  
	`dru·l_qu”y_¡ršg_’code
(
$_REQUEST
, 
	`¬¿y_m”ge
(
	`¬¿y
('q', 'sÜt', 'Üd”', '·ss'), 
	`¬¿y_keys
(
$_COOKIE
)));

140 
	}
}

152 
funùiÚ
 
	$bËsÜt_g‘_Üd”
(
$h—d”s
) {

153 
$Üd”
 = 
	`is£t
(
$_GET
['order']) ? $_GET['order'] : '';

154 
	`fÜ—ch
 (
$h—d”s
 
as
 
$h—d”
) {

155 ià(
	`is£t
(
$h—d”
['d©a']è&& 
$Üd”
 == $header['data']) {

156  
	`¬¿y
('Çme' => 
$h—d”
['d©a'], 'sql' => 
	`is£t
($header['field']) ? $header['field'] : '');

159 ià(
	`is£t
(
$h—d”
['sort']) && ($header['sort'] == 'asc' || $header['sort'] == 'desc')) {

160 
$deçuÉ
 = 
	`¬¿y
('Çme' => 
$h—d”
['d©a'], 'sql' => 
	`is£t
($header['field']) ? $header['field'] : '');

164 ià(
	`is£t
(
$deçuÉ
)) {

165  
$deçuÉ
;

169 ià(
	`is_¬¿y
(
$h—d”s
[0])) {

170 
$h—d”s
[0] +ğ
	`¬¿y
('d©a' => 
NULL
, 'field' => NULL);

171  
	`¬¿y
('Çme' => 
$h—d”s
[0]['data'], 'sql' => $headers[0]['field']);

174  
	`¬¿y
('Çme' => 
$h—d”s
[0]);

177 
	}
}

187 
funùiÚ
 
	$bËsÜt_g‘_sÜt
(
$h—d”s
) {

188 ià(
	`is£t
(
$_GET
['sort'])) {

189  (
$_GET
['sort'] == 'desc') ? 'desc' : 'asc';

193 
	`fÜ—ch
 (
$h—d”s
 
as
 
$h—d”
) {

194 ià(
	`is_¬¿y
(
$h—d”
è&& 
	`¬¿y_key_exi¡s
('sort', $header)) {

195  
$h—d”
['sort'];

200 
	}
}

	@/srv/http/subs/notes/www/includes/theme.inc

1 <?
php


20 
defše
('MARK_READ', 0);

21 
defše
('MARK_NEW', 1);

22 
defše
('MARK_UPDATED', 2);

30 
funùiÚ
 
	$š™_theme
() {

31 
glob®
 
$theme
, 
$u£r
, 
$cu¡om_theme
, 
$theme_key
;

34 ià(
	`is£t
(
$theme
)) {

38 
	`dru·l_boÙ¡¿p
(
DRUPAL_BOOTSTRAP_DATABASE
);

39 
$themes
 = 
	`li¡_themes
();

43 
$theme
 = !
	`em±y
(
$u£r
->
theme
è&& !em±y(
$themes
[$u£r->theme]->
¡©us
è? $u£r->them: 
	`v¬ŸbË_g‘
('theme_default', 'garland');

47 
$theme
 = 
$cu¡om_theme
 && 
$themes
[$custom_theme] ? $custom_theme : $theme;

50 
$theme_key
 = 
$theme
;

53 
$ba£_theme
 = 
	`¬¿y
();

54 
$ªû¡Ü
 = 
$theme
;

55 
$ªû¡Ü
 && 
	`is£t
(
$themes
[$ªû¡Ü]->
ba£_theme
)) {

56 
$ba£_theme
[] = 
$Ãw_ba£_theme
 = 
$themes
[$themes[
$ªû¡Ü
]->
ba£_theme
];

57 
$ªû¡Ü
 = 
$themes
[$ªû¡Ü]->
ba£_theme
;

59 
	`_š™_theme
(
$themes
[
$theme
], 
	`¬¿y_»v”£
(
$ba£_theme
));

60 
	}
}

87 
funùiÚ
 
_š™_theme
(
$theme
, 
$ba£_theme
 = 
¬¿y
(), 
$»gi¡ry_ÿÎback
 = '_theme_load_registry') {

88 
glob®
 
$theme_šfo
, 
$ba£_theme_šfo
, 
$theme_’gše
, 
$theme_·th
;

89 
	g$theme_šfo
 = 
$theme
;

90 
	g$ba£_theme_šfo
 = 
$ba£_theme
;

92 
	g$theme_·th
 = 
dœÇme
(
$theme
->
f’ame
);

97 
	g$fš®_¡yËsh“ts
 = 
¬¿y
();

100 
fÜ—ch
 (
$ba£_theme
 
as
 
$ba£
) {

101 ià(!
em±y
(
$ba£
->
¡yËsh“ts
)) {

102 
fÜ—ch
 (
$ba£
->
¡yËsh“ts
 
as
 
$medŸ
 => 
$¡yËsh“ts
) {

103 
fÜ—ch
 (
$¡yËsh“ts
 
as
 
$Çme
 => 
$¡yËsh“t
) {

104 
$fš®_¡yËsh“ts
[
$medŸ
][
$Çme
] = 
$¡yËsh“t
;

111 ià(!
em±y
(
$theme
->
¡yËsh“ts
)) {

112 
fÜ—ch
 (
$theme
->
¡yËsh“ts
 
as
 
$medŸ
 => 
$¡yËsh“ts
) {

113 
fÜ—ch
 (
$¡yËsh“ts
 
as
 
$Çme
 => 
$¡yËsh“t
) {

114 
$fš®_¡yËsh“ts
[
$medŸ
][
$Çme
] = 
$¡yËsh“t
;

120 
fÜ—ch
 (
$fš®_¡yËsh“ts
 
as
 
$medŸ
 => 
$¡yËsh“ts
) {

121 
fÜ—ch
 (
$¡yËsh“ts
 
as
 
$¡yËsh“t
) {

122 
dru·l_add_css
(
$¡yËsh“t
, 'theme', 
$medŸ
);

127 
	g$fš®_süts
 = 
¬¿y
();

130 
fÜ—ch
 (
$ba£_theme
 
as
 
$ba£
) {

131 ià(!
em±y
(
$ba£
->
süts
)) {

132 
fÜ—ch
 (
$ba£
->
süts
 
as
 
$Çme
 => 
$süt
) {

133 
$fš®_süts
[
$Çme
] = 
$süt
;

139 ià(!
em±y
(
$theme
->
süts
)) {

140 
fÜ—ch
 (
$theme
->
süts
 
as
 
$Çme
 => 
$süt
) {

141 
$fš®_süts
[
$Çme
] = 
$süt
;

146 
fÜ—ch
 (
$fš®_süts
 
as
 
$süt
) {

147 
dru·l_add_js
(
$süt
, 'theme');

150 
	g$theme_’gše
 = 
NULL
;

153 ià(
is£t
(
$theme
->
’gše
)) {

155 
	gšşude_Úû
 './'. 
	g$theme
->
	gowÃr
;

157 
	g$theme_’gše
 = 
$theme
->
’gše
;

158 ià(
funùiÚ_exi¡s
(
$theme_’gše
 .'_init')) {

159 
fÜ—ch
 (
$ba£_theme
 
as
 
$ba£
) {

160 
ÿÎ_u£r_func
(
$theme_’gše
 .'_š™', 
$ba£
);

162 
ÿÎ_u£r_func
(
$theme_’gše
 .'_š™', 
$theme
);

167 
fÜ—ch
 (
$ba£_theme
 
as
 
$ba£
) {

169 ià(!
em±y
(
$ba£
->
owÃr
)) {

170 
	gšşude_Úû
 './'. 
	g$ba£
->
	gowÃr
;

174 ià(!
em±y
(
$theme
->
owÃr
)) {

175 
	gšşude_Úû
 './'. 
	g$theme
->
	gowÃr
;

179 
$»gi¡ry_ÿÎback
(
$theme
, 
$ba£_theme
, 
$theme_’gše
);

188 
funùiÚ
 
	$theme_g‘_»gi¡ry
(
$»gi¡ry
 = 
NULL
) {

189 
$theme_»gi¡ry
 = 
NULL
;

190 ià(
	`is£t
(
$»gi¡ry
)) {

191 
$theme_»gi¡ry
 = 
$»gi¡ry
;

194  
$theme_»gi¡ry
;

195 
	}
}

200 
funùiÚ
 
	$_theme_£t_»gi¡ry
(
$»gi¡ry
) {

202  
	`theme_g‘_»gi¡ry
(
$»gi¡ry
);

203 
	}
}

217 
funùiÚ
 
	$_theme_lßd_»gi¡ry
(
$theme
, 
$ba£_theme
 = 
NULL
, 
$theme_’gše
 = NULL) {

219 
$ÿche
 = 
	`ÿche_g‘
("theme_registry:$theme->name", 'cache');

220 ià(
	`is£t
(
$ÿche
->
d©a
)) {

221 
$»gi¡ry
 = 
$ÿche
->
d©a
;

225 
$»gi¡ry
 = 
	`_theme_bud_»gi¡ry
(
$theme
, 
$ba£_theme
, 
$theme_’gše
);

226 
	`_theme_§ve_»gi¡ry
(
$theme
, 
$»gi¡ry
);

228 
	`_theme_£t_»gi¡ry
(
$»gi¡ry
);

229 
	}
}

234 
funùiÚ
 
	$_theme_§ve_»gi¡ry
(
$theme
, 
$»gi¡ry
) {

235 
	`ÿche_£t
("theme_»gi¡ry:$theme->Çme", 
$»gi¡ry
);

236 
	}
}

243 
funùiÚ
 
	$dru·l_»bud_theme_»gi¡ry
() {

244 
	`ÿche_ş—r_®l
('theme_»gi¡ry', 'ÿche', 
TRUE
);

245 
	}
}

262 
funùiÚ
 
	$_theme_´oûss_»gi¡ry
(&
$ÿche
, 
$Çme
, 
$ty³
, 
$theme
, 
$·th
) {

263 
$»suÉ
 = 
	`¬¿y
();

264 
$funùiÚ
 = 
$Çme
 .'_theme';

265 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

266 
$»suÉ
 = 
	`$funùiÚ
(
$ÿche
, 
$ty³
, 
$theme
, 
$·th
);

268 
	`fÜ—ch
 (
$»suÉ
 
as
 
$hook
 => 
$šfo
) {

269 
$»suÉ
[
$hook
]['ty³'] = 
$ty³
;

270 
$»suÉ
[
$hook
]['them·th'] = 
$·th
;

273 ià(!
	`is£t
(
$šfo
['template']) && !isset($info['function'])) {

274 
$»suÉ
[
$hook
]['funùiÚ'] = (
$ty³
 =ğ'moduË' ? 'theme_' : 
$Çme
 .'_') . $hook;

278 ià(!
	`is£t
(
$šfo
['include files'])) {

279 
$»suÉ
[
$hook
]['šşudfes'] = 
	`¬¿y
();

287 ià(
	`is£t
(
$šfo
['file']) && !isset($info['path'])) {

289 
$f’ame
 = './'. 
$·th
 .'/'. 
$šfo
['file'];

290 ià(
	`fe_exi¡s
(
$f’ame
)) {

291 
»quœe_Úû
 
$f’ame
;

292 
$»suÉ
[
$hook
]['šşudfes'][] = 
$f’ame
;

295 
$f’ame
 = './'. 
$šfo
['file'];

296 ià(
	`fe_exi¡s
(
$f’ame
)) {

297 
»quœe_Úû
 
$f’ame
;

298 
$»suÉ
[
$hook
]['šşudfes'][] = 
$f’ame
;

302 
	`–£if
 (
	`is£t
(
$šfo
['file']) && isset($info['path'])) {

303 
$f’ame
 = './'. 
$šfo
['path'] .'/'. $info['file'];

304 ià(
	`fe_exi¡s
(
$f’ame
)) {

305 
»quœe_Úû
 
$f’ame
;

306 
$»suÉ
[
$hook
]['šşudfes'][] = 
$f’ame
;

311 ià(
	`is£t
(
$šfo
['template']) && !isset($info['path'])) {

312 
$»suÉ
[
$hook
]['‹m¶©e'] = 
$·th
 .'/'. 
$šfo
['template'];

317 ià(!
	`is£t
(
$šfo
['¬gum’ts']è&& is£t(
$ÿche
[
$hook
])) {

318 
$»suÉ
[
$hook
]['¬gum’ts'] = 
$ÿche
[$hook]['arguments'];

322 ià(!
	`is£t
(
$šfo
['them·ths']è&& is£t(
$ÿche
[
$hook
])) {

323 
$»suÉ
[
$hook
]['them·ths'] = 
$ÿche
[$hook]['theme…aths'];

326 
$»suÉ
[
$hook
]['them·ths'][] = 
	`is£t
(
$šfo
['·th']è? $šfo['·th'] : 
$·th
;

329 ià(!
	`is£t
(
$šfo
['´•roûs funùiÚs']è|| !
	`is_¬¿y
($info['preprocess functions'])) {

330 
$šfo
['´•roûs funùiÚs'] = 
	`¬¿y
();

331 
$´efixes
 = 
	`¬¿y
();

332 ià(
$ty³
 == 'module') {

334 
$´efixes
[] = 'template';

337 
$´efixes
 +ğ
	`moduË_li¡
();

339 
	`–£if
 (
$ty³
 == 'theme_engine' || $type == 'base_theme_engine') {

341 
$´efixes
[] = 
$Çme
 .'_engine';

343 
$´efixes
[] = 
$Çme
;

344 
$´efixes
[] = 
$theme
;

348 
$´efixes
[] = 
$Çme
;

351 
	`fÜ—ch
 (
$´efixes
 
as
 
$´efix
) {

352 ià(
	`funùiÚ_exi¡s
(
$´efix
 .'_preprocess')) {

353 
$šfo
['´•roûs funùiÚs'][] = 
$´efix
 .'_preprocess';

356 ià(
	`funùiÚ_exi¡s
(
$´efix
 .'_´•roûss_'. 
$hook
)) {

357 
$šfo
['´•roûs funùiÚs'][] = 
$´efix
 .'_´•roûss_'. 
$hook
;

360 ià(!
	`em±y
(
$šfo
['Üigš® hook']è&& 
	`funùiÚ_exi¡s
(
$´efix
 .'_preprocess_'. $info['original hook'])) {

361 
$šfo
['´•roûs funùiÚs'][] = 
$´efix
 .'_preprocess_'. $info['original hook'];

367 ià(!
	`em±y
(
$šfo
['override…reprocess functions'])) {

369 
	`un£t
(
$»suÉ
[
$hook
]['override…reprocess functions']);

371 
	`–£if
 (
	`is£t
(
$ÿche
[
$hook
]['´•roûs funùiÚs']è&& 
	`is_¬¿y
($cache[$hook]['preprocess functions'])) {

372 
$šfo
['´•roûs funùiÚs'] = 
	`¬¿y_m”ge
(
$ÿche
[
$hook
]['preprocess functions'], $info['preprocess functions']);

374 
	`–£if
 (
	`is£t
(
$šfo
['Üigš® hook']è&& is£t(
$ÿche
[$šfo['Üigš® hook']]['´•roûs funùiÚs']è&& 
	`is_¬¿y
($cache[$info['original hook']]['preprocess functions'])) {

375 
$šfo
['´•roûs funùiÚs'] = 
	`¬¿y_m”ge
(
$ÿche
[$info['original hook']]['preprocess functions'], $info['preprocess functions']);

377 
$»suÉ
[
$hook
]['´•roûs funùiÚs'] = 
$šfo
['preprocess functions'];

381 
$ÿche
 = 
	`¬¿y_m”ge
($ÿche, 
$»suÉ
);

385 ià(
$ty³
 == 'theme' || $type == 'base_theme') {

386 
	`fÜ—ch
 (
$ÿche
 
as
 
$hook
 => 
$šfo
) {

388 ià(!
	`em±y
(
$šfo
['‹m¶©e']è&&ƒm±y(
$»suÉ
[
$hook
])) {

389 ià(!
	`is£t
(
$šfo
['preprocess functions'])) {

390 
$ÿche
[
$hook
]['´•roûs funùiÚs'] = 
	`¬¿y
();

392 ià(
	`funùiÚ_exi¡s
(
$Çme
 .'_preprocess')) {

393 
$ÿche
[
$hook
]['´•roûs funùiÚs'][] = 
$Çme
 .'_preprocess';

395 ià(
	`funùiÚ_exi¡s
(
$Çme
 .'_´•roûss_'. 
$hook
)) {

396 
$ÿche
[
$hook
]['´•roûs funùiÚs'][] = 
$Çme
 .'_preprocess_'. $hook;

399 
$ÿche
[
$hook
]['´•roûs funùiÚs'] = 
	`¬¿y_unique
($cache[$hook]['preprocess functions']);

403 
	}
}

416 
funùiÚ
 
	$_theme_bud_»gi¡ry
(
$theme
, 
$ba£_theme
, 
$theme_’gše
) {

417 
$ÿche
 = 
	`¬¿y
();

420 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('theme'è
as
 
$moduË
) {

421 
	`_theme_´oûss_»gi¡ry
(
$ÿche
, 
$moduË
, 'moduË', $moduË, 
	`dru·l_g‘_·th
('module', $module));

425 
	`fÜ—ch
 (
$ba£_theme
 
as
 
$ba£
) {

427 
$ba£_·th
 = 
	`dœÇme
(
$ba£
->
f’ame
);

428 ià(
$theme_’gše
) {

429 
	`_theme_´oûss_»gi¡ry
(
$ÿche
, 
$theme_’gše
, 'ba£_theme_’gše', 
$ba£
->
Çme
, 
$ba£_·th
);

431 
	`_theme_´oûss_»gi¡ry
(
$ÿche
, 
$ba£
->
Çme
, 'ba£_theme', $ba£->Çme, 
$ba£_·th
);

435 ià(
$theme_’gše
) {

436 
	`_theme_´oûss_»gi¡ry
(
$ÿche
, 
$theme_’gše
, 'theme_’gše', 
$theme
->
Çme
, 
	`dœÇme
($theme->
f’ame
));

440 
	`_theme_´oûss_»gi¡ry
(
$ÿche
, 
$theme
->
Çme
, 'theme', $theme->Çme, 
	`dœÇme
($theme->
f’ame
));

443 
	`dru·l_®‹r
('theme_»gi¡ry', 
$ÿche
);

444  
$ÿche
;

445 
	}
}

458 
funùiÚ
 
	$li¡_themes
(
$»äesh
 = 
FALSE
) {

459 
$li¡
 = 
	`¬¿y
();

461 ià(
$»äesh
) {

462 
$li¡
 = 
	`¬¿y
();

465 ià(
	`em±y
(
$li¡
)) {

466 
$li¡
 = 
	`¬¿y
();

467 
$themes
 = 
	`¬¿y
();

470 ià(
	`db_is_aùive
(è&& !
	`defšed
('MAINTENANCE_MODE')) {

471 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {system} WHEREype = '%s'", 'theme');

472 
$theme
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

473 ià(
	`fe_exi¡s
(
$theme
->
f’ame
)) {

474 
$theme
->
šfo
 = 
	`un£rŸlize
($theme->info);

475 
$themes
[] = 
$theme
;

481 
$themes
 = 
	`_sy¡em_theme_d©a
();

484 
	`fÜ—ch
 (
$themes
 
as
 
$theme
) {

485 
	`fÜ—ch
 (
$theme
->
šfo
['¡yËsh“ts'] 
as
 
$medŸ
 => 
$¡yËsh“ts
) {

486 
	`fÜ—ch
 (
$¡yËsh“ts
 
as
 
$¡yËsh“t
 => 
$·th
) {

487 
$theme
->
¡yËsh“ts
[
$medŸ
][
$¡yËsh“t
] = 
$·th
;

490 
	`fÜ—ch
 (
$theme
->
šfo
['süts'] 
as
 
$süt
 => 
$·th
) {

491 ià(
	`fe_exi¡s
(
$·th
)) {

492 
$theme
->
süts
[
$süt
] = 
$·th
;

495 ià(
	`is£t
(
$theme
->
šfo
['engine'])) {

496 
$theme
->
’gše
 = $theme->
šfo
['engine'];

498 ià(
	`is£t
(
$theme
->
šfo
['baseheme'])) {

499 
$theme
->
ba£_theme
 = $theme->
šfo
['baseheme'];

503 ià(!
	`is£t
(
$theme
->
¡©us
)) {

504 
$theme
->
¡©us
 = 0;

506 
$li¡
[
$theme
->
Çme
] = $theme;

510  
$li¡
;

511 
	}
}

600 
funùiÚ
 
	$theme
() {

601 
$¬gs
 = 
	`func_g‘_¬gs
();

602 
$hook
 = 
	`¬¿y_shiá
(
$¬gs
);

604 
$hooks
 = 
NULL
;

605 ià(!
	`is£t
(
$hooks
)) {

606 
	`š™_theme
();

607 
$hooks
 = 
	`theme_g‘_»gi¡ry
();

610 ià(
	`is_¬¿y
(
$hook
)) {

611 
	`fÜ—ch
 (
$hook
 
as
 
$ÿndid©e
) {

612 ià(
	`is£t
(
$hooks
[
$ÿndid©e
])) {

616 
$hook
 = 
$ÿndid©e
;

619 ià(!
	`is£t
(
$hooks
[
$hook
])) {

623 
$šfo
 = 
$hooks
[
$hook
];

624 
glob®
 
$theme_·th
;

625 
$‹mp
 = 
$theme_·th
;

627 
$theme_·th
 = 
$hooks
[
$hook
]['theme…ath'];

630 ià(!
	`em±y
(
$šfo
['include files'])) {

631 
	`fÜ—ch
 (
$šfo
['šşudfes'] 
as
 
$šşude_fe
) {

632 
	`šşude_Úû
(
$šşude_fe
);

637 ià(!
	`em±y
(
$šfo
['file'])) {

638 
$šşuded_fes
 = 
	`¬¿y
();

639 
$šşude_fe
 = 
$šfo
['file'];

640 ià(!
	`em±y
(
$šfo
['path'])) {

641 
$šşude_fe
 = 
$šfo
['path'] .'/'. $include_file;

644 ià(
	`em±y
(
$šşuded_fes
[
$šşude_fe
])) {

647 
$šşuded_fes
[
$šşude_fe
] = 
TRUE
;

648 ià(
	`fe_exi¡s
('./'. 
$šşude_fe
)) {

649 
	`šşude_Úû
('./'. 
$šşude_fe
);

654 ià(
	`is£t
(
$šfo
['function'])) {

656 
$ouut
 = 
	`ÿÎ_u£r_func_¬¿y
(
$šfo
['funùiÚ'], 
$¬gs
);

660 
$v¬ŸbËs
 = 
	`¬¿y
(

661 '‹m¶©e_fes' => 
	`¬¿y
()

663 ià(!
	`em±y
(
$šfo
['arguments'])) {

664 
$couÁ
 = 0;

665 
	`fÜ—ch
 (
$šfo
['¬gum’ts'] 
as
 
$Çme
 => 
$deçuÉ
) {

666 
$v¬ŸbËs
[
$Çme
] = 
	`is£t
(
$¬gs
[
$couÁ
]è? $¬gs[$couÁ] : 
$deçuÉ
;

667 
$couÁ
++;

672 
$»nd”_funùiÚ
 = 'theme_render_template';

673 
$ex‹nsiÚ
 = '.tpl.php';

676 
glob®
 
$theme_’gše
;

677 ià(
	`is£t
(
$theme_’gše
)) {

680 ià(
$hooks
[
$hook
]['type'] != 'module') {

681 ià(
	`funùiÚ_exi¡s
(
$theme_’gše
 .'_render_template')) {

682 
$»nd”_funùiÚ
 = 
$theme_’gše
 .'_render_template';

684 
$ex‹nsiÚ_funùiÚ
 = 
$theme_’gše
 .'_extension';

685 ià(
	`funùiÚ_exi¡s
(
$ex‹nsiÚ_funùiÚ
)) {

686 
$ex‹nsiÚ
 = 
	`$ex‹nsiÚ_funùiÚ
();

691 ià(
	`is£t
(
$šfo
['´•roûs funùiÚs']è&& 
	`is_¬¿y
($info['preprocess functions'])) {

694 
$¬gs
 = 
	`¬¿y
(&
$v¬ŸbËs
, 
$hook
);

695 
	`fÜ—ch
 (
$šfo
['´•roûs funùiÚs'] 
as
 
$´•roûss_funùiÚ
) {

696 ià(
	`funùiÚ_exi¡s
(
$´•roûss_funùiÚ
)) {

697 
	`ÿÎ_u£r_func_¬¿y
(
$´•roûss_funùiÚ
, 
$¬gs
);

706 
$sugge¡iÚs
 = 
	`¬¿y
();

708 ià(
	`is£t
(
$v¬ŸbËs
['template_files'])) {

709 
$sugge¡iÚs
 = 
$v¬ŸbËs
['template_files'];

711 ià(
	`is£t
(
$v¬ŸbËs
['template_file'])) {

712 
$sugge¡iÚs
[] = 
$v¬ŸbËs
['template_file'];

715 ià(
$sugge¡iÚs
) {

716 
$‹m¶©e_fe
 = 
	`dru·l_discov”_‹m¶©e
(
$šfo
['them·ths'], 
$sugge¡iÚs
, 
$ex‹nsiÚ
);

719 ià(
	`em±y
(
$‹m¶©e_fe
)) {

720 
$‹m¶©e_fe
 = 
$hooks
[
$hook
]['‹m¶©e'] . 
$ex‹nsiÚ
;

721 ià(
	`is£t
(
$hooks
[
$hook
]['path'])) {

722 
$‹m¶©e_fe
 = 
$hooks
[
$hook
]['path'] .'/'. $template_file;

725 
$ouut
 = 
	`$»nd”_funùiÚ
(
$‹m¶©e_fe
, 
$v¬ŸbËs
);

728 
$theme_·th
 = 
$‹mp
;

730 ià(
$hook
 == 'page' || $hook == 'book_export_html') {

731 
$ouut
 = 
	`dru·l_fš®_m¬kup
($output);

733  
$ouut
;

734 
	}
}

741 
funùiÚ
 
dru·l_discov”_‹m¶©e
(
$·ths
, 
$sugge¡iÚs
, 
$ex‹nsiÚ
 = '.tpl.php') {

742 
glob®
 
$theme_’gše
;

746 
	g$ex‹nsiÚ
 = 
¡r_»¶aû
(
¬¿y
("/", "\\", "\0"), '', 
$ex‹nsiÚ
);

749 
	g$sugge¡iÚs
 = 
¬¿y_»v”£
(
$sugge¡iÚs
);

750 
	g$·ths
 = 
¬¿y_»v”£
(
$·ths
);

751 
fÜ—ch
 (
$sugge¡iÚs
 
as
 
$sugge¡iÚ
) {

752 ià(!
em±y
(
$sugge¡iÚ
)) {

753 
	g$sugge¡iÚ
 = 
¡r_»¶aû
(
¬¿y
("/", "\\", "\0"), '', 
$sugge¡iÚ
);

754 
fÜ—ch
 (
$·ths
 
as
 
$·th
) {

755 ià(
fe_exi¡s
(
$fe
 = 
$·th
 .'/'. 
$sugge¡iÚ
 . 
$ex‹nsiÚ
)) {

756  
$fe
;

773 
funùiÚ
 
	$·th_to_theme
() {

774 
glob®
 
$theme_·th
;

776 ià(!
	`is£t
(
$theme_·th
)) {

777 
	`š™_theme
();

780  
$theme_·th
;

781 
	}
}

795 
funùiÚ
 
	$dru·l_fšd_theme_funùiÚs
(
$ÿche
, 
$´efixes
) {

796 
$‹m¶©es
 = 
	`¬¿y
();

797 
$funùiÚs
 = 
	`g‘_defšed_funùiÚs
();

799 
	`fÜ—ch
 (
$ÿche
 
as
 
$hook
 => 
$šfo
) {

800 
	`fÜ—ch
 (
$´efixes
 
as
 
$´efix
) {

801 ià(!
	`em±y
(
$šfo
['pattern'])) {

802 
$m©ches
 = 
	`´eg_g»p
('/^'. 
$´efix
 .'_'. 
$šfo
['·‰”n'] .'/', 
$funùiÚs
['user']);

803 ià(
$m©ches
) {

804 
	`fÜ—ch
 (
$m©ches
 
as
 
$m©ch
) {

805 
$Ãw_hook
 = 
	`¡r_»¶aû
(
$´efix
 .'_', '', 
$m©ch
);

806 
$‹m¶©es
[
$Ãw_hook
] = 
	`¬¿y
(

807 'funùiÚ' => 
$m©ch
,

808 '¬gum’ts' => 
$šfo
['arguments'],

809 'Üigš® hook' => 
$hook
,

810 'šşudfes' => 
$šfo
['include files'],

816 ià(
	`funùiÚ_exi¡s
(
$´efix
 .'_'. 
$hook
)) {

817 
$‹m¶©es
[
$hook
] = 
	`¬¿y
(

818 'funùiÚ' => 
$´efix
 .'_'. 
$hook
,

819 'šşudfes' => 
$šfo
['include files'],

824 ià(
	`is£t
(
$šfo
['pattern'])) {

825 
$‹m¶©es
[
$hook
]['·‰”n'] = 
$šfo
['pattern'];

833  
$‹m¶©es
;

834 
	}
}

847 
funùiÚ
 
	$dru·l_fšd_theme_‹m¶©es
(
$ÿche
, 
$ex‹nsiÚ
, 
$·th
) {

848 
$‹m¶©es
 = 
	`¬¿y
();

853 
$theme_·ths
 = 
	`¬¿y
();

854 
	`fÜ—ch
 (
	`li¡_themes
(è
as
 
$theme_šfo
) {

855 ià(!
	`em±y
(
$theme_šfo
->
ba£_theme
)) {

856 
$theme_·ths
[
$theme_šfo
->
ba£_theme
][$theme_šfo->
Çme
] = 
	`dœÇme
($theme_šfo->
f’ame
);

859 
	`fÜ—ch
 (
$theme_·ths
 
as
 
$ba£theme
 => 
$subthemes
) {

860 
	`fÜ—ch
 (
$subthemes
 
as
 
$subtheme
 => 
$subtheme_·th
) {

861 ià(
	`is£t
(
$theme_·ths
[
$subtheme
])) {

862 
$theme_·ths
[
$ba£theme
] = 
	`¬¿y_m”ge
($theme_·ths[$ba£theme], $theme_·ths[
$subtheme
]);

866 
glob®
 
$theme
;

867 
$subtheme_·ths
 = 
	`is£t
(
$theme_·ths
[
$theme
]è? $theme_·ths[$theme] : 
	`¬¿y
();

870 
$»gex
 = 
	`¡r_»¶aû
('.', '\.', 
$ex‹nsiÚ
) .'$';

873 
$fes
 = 
	`dru·l_sy¡em_li¡šg
(
$»gex
, 
$·th
, 'name', 0);

874 
	`fÜ—ch
 (
$fes
 
as
 
$‹m¶©e
 => 
$fe
) {

876 ià(
	`¡½os
(
$fe
->
f’ame
, 
	`¡r_»¶aû
(
$subtheme_·ths
, '', $file->filename)) !== 0) {

882 ià((
$pos
 = 
	`¡½os
(
$‹m¶©e
, '.')è!=ğ
FALSE
) {

883 
$‹m¶©e
 = 
	`sub¡r
($‹m¶©e, 0, 
$pos
);

887 
$hook
 = 
	`¡¹r
(
$‹m¶©e
, '-', '_');

888 ià(
	`is£t
(
$ÿche
[
$hook
])) {

889 
$‹m¶©es
[
$hook
] = 
	`¬¿y
(

890 '‹m¶©e' => 
$‹m¶©e
,

891 '·th' => 
	`dœÇme
(
$fe
->
f’ame
),

892 'šşudfes' => 
$ÿche
[
$hook
]['include files'],

898 ià(
	`is£t
(
$ÿche
[
$hook
]['pattern'])) {

899 
$‹m¶©es
[
$hook
]['·‰”n'] = 
$ÿche
[$hook]['pattern'];

903 
$·‰”ns
 = 
	`¬¿y_keys
(
$fes
);

905 
	`fÜ—ch
 (
$ÿche
 
as
 
$hook
 => 
$šfo
) {

906 ià(!
	`em±y
(
$šfo
['pattern'])) {

909 
$·‰”n
 = 
	`¡¹r
(
$šfo
['pattern'], '_', '-');

911 
$m©ches
 = 
	`´eg_g»p
('/^'. 
$·‰”n
 .'/', 
$·‰”ns
);

912 ià(
$m©ches
) {

913 
	`fÜ—ch
 (
$m©ches
 
as
 
$m©ch
) {

914 
$fe
 = 
	`sub¡r
(
$m©ch
, 0, 
	`¡½os
($match, '.'));

916 
$‹m¶©es
[
	`¡¹r
(
$fe
, '-', '_')] = 
	`¬¿y
(

917 '‹m¶©e' => 
$fe
,

918 '·th' => 
	`dœÇme
(
$fes
[
$m©ch
]->
f’ame
),

919 '¬gum’ts' => 
$šfo
['arguments'],

920 'Üigš® hook' => 
$hook
,

921 'šşudfes' => 
$šfo
['include files'],

927  
$‹m¶©es
;

928 
	}
}

947 
funùiÚ
 
	$theme_g‘_£‰šgs
(
$key
 = 
NULL
) {

948 
$deçuÉs
 = 
	`¬¿y
(

968 ià(
	`moduË_exi¡s
('node')) {

969 
	`fÜ—ch
 (
	`node_g‘_ty³s
(è
as
 
$ty³
 => 
$Çme
) {

970 
$deçuÉs
['toggË_node_šfo_'. 
$ty³
] = 1;

973 
$£‰šgs
 = 
	`¬¿y_m”ge
(
$deçuÉs
, 
	`v¬ŸbË_g‘
('theme_£‰šgs', 
	`¬¿y
()));

975 ià(
$key
) {

976 
$£‰šgs
 = 
	`¬¿y_m”ge
($£‰šgs, 
	`v¬ŸbË_g‘
(
	`¡r_»¶aû
('/', '_', 'theme_'. 
$key
 .'_£‰šgs'), 
	`¬¿y
()));

980 ià(!
	`moduË_exi¡s
('£¬ch'è|| !
	`u£r_acûss
('search content')) {

981 
$£‰šgs
['toggle_search'] = 0;

984  
$£‰šgs
;

985 
	}
}

1003 
funùiÚ
 
	$theme_g‘_£‰šg
(
$£‰šg_Çme
, 
$»äesh
 = 
FALSE
) {

1004 
glob®
 
$theme_key
;

1005 
$£‰šgs
;

1007 ià(
	`em±y
(
$£‰šgs
è|| 
$»äesh
) {

1008 
$£‰šgs
 = 
	`theme_g‘_£‰šgs
(
$theme_key
);

1010 
$themes
 = 
	`li¡_themes
();

1011 
$theme_objeù
 = 
$themes
[
$theme_key
];

1013 ià(
$£‰šgs
['mission'] == '') {

1014 
$£‰šgs
['missiÚ'] = 
	`v¬ŸbË_g‘
('site_mission', '');

1017 ià(!
$£‰šgs
['toggle_mission']) {

1018 
$£‰šgs
['mission'] = '';

1021 ià(
$£‰šgs
['toggle_logo']) {

1022 ià(
$£‰šgs
['default_logo']) {

1023 
$£‰šgs
['logo'] = 
	`ba£_·th
(è. 
	`dœÇme
(
$theme_objeù
->
f’ame
) .'/logo.png';

1025 
	`–£if
 (
$£‰šgs
['logo_path']) {

1026 
$£‰šgs
['logo'] = 
	`ba£_·th
() . $settings['logo_path'];

1030 ià(
$£‰šgs
['toggle_favicon']) {

1031 ià(
$£‰šgs
['default_favicon']) {

1032 ià(
	`fe_exi¡s
(
$çvicÚ
 = 
	`dœÇme
(
$theme_objeù
->
f’ame
) .'/favicon.ico')) {

1033 
$£‰šgs
['çvicÚ'] = 
	`ba£_·th
(è. 
$çvicÚ
;

1036 
$£‰šgs
['çvicÚ'] = 
	`ba£_·th
() .'misc/favicon.ico';

1039 
	`–£if
 (
$£‰šgs
['favicon_path']) {

1040 
$£‰šgs
['çvicÚ'] = 
	`ba£_·th
() . $settings['favicon_path'];

1043 
$£‰šgs
['toggË_çvicÚ'] = 
FALSE
;

1048  
	`is£t
(
$£‰šgs
[
$£‰šg_Çme
]è? $£‰šgs[$£‰šg_Çme] : 
NULL
;

1049 
	}
}

1063 
funùiÚ
 
	$theme_»nd”_‹m¶©e
(
$‹m¶©e_fe
, 
$v¬ŸbËs
) {

1064 
	`exŒaù
(
$v¬ŸbËs
, 
EXTR_SKIP
);

1065 
	`ob_¡¬t
();

1066 
šşude
 "./$template_file";

1067 
$cÚ‹Ás
 = 
	`ob_g‘_cÚ‹Ás
();

1068 
	`ob_’d_ş—n
();

1069  
$cÚ‹Ás
;

1070 
	}
}

1147 
funùiÚ
 
	$theme_¶aûhŞd”
(
$‹xt
) {

1148  '<em>'. 
	`check_¶aš
(
$‹xt
) .'</em>';

1149 
	}
}

1161 
funùiÚ
 
	$theme_¡©us_mes§ges
(
$di¥Ïy
 = 
NULL
) {

1162 
$ouut
 = '';

1163 
	`fÜ—ch
 (
	`dru·l_g‘_mes§ges
(
$di¥Ïy
è
as
 
$ty³
 => 
$mes§ges
) {

1164 
$ouut
 .= "<div class=\"messages $type\">\n";

1165 ià(
	`couÁ
(
$mes§ges
) > 1) {

1166 
$ouut
 .= " <ul>\n";

1167 
	`fÜ—ch
 (
$mes§ges
 
as
 
$mes§ge
) {

1168 
$ouut
 .ğ' <li>'. 
$mes§ge
 ."</li>\n";

1170 
$ouut
 .= " </ul>\n";

1173 
$ouut
 .ğ
$mes§ges
[0];

1175 
$ouut
 .= "</div>\n";

1177  
$ouut
;

1178 
	}
}

1190 
funùiÚ
 
theme_lšks
(
$lšks
, 
$©Œibu‹s
 = 
¬¿y
('class' => 'links')) {

1191 
glob®
 
$Ïnguage
;

1192 
	g$ouut
 = '';

1194 ià(
couÁ
(
$lšks
) > 0) {

1195 
	g$ouut
 = '<ul'. 
dru·l_©Œibu‹s
(
$©Œibu‹s
) .'>';

1197 
	g$num_lšks
 = 
couÁ
(
$lšks
);

1198 
	g$i
 = 1;

1200 
fÜ—ch
 (
$lšks
 
as
 
$key
 => 
$lšk
) {

1201 
$şass
 = 
$key
;

1204 ià(
	g$i
 == 1) {

1205 
$şass
 .= ' first';

1207 ià(
	g$i
 =ğ
$num_lšks
) {

1208 
$şass
 .= '†ast';

1210 ià(
is£t
(
$lšk
['h»f']è&& (
	g$lšk
['h»f'] =ğ
$_GET
['q'] || ($lšk['h»f'] =ğ'<äÚt>' && 
dru·l_is_äÚt_·ge
()))

1211 && (
em±y
(
$lšk
['Ïnguage']è|| $lšk['Ïnguage']->
Ïnguage
 =ğ
$Ïnguage
->language)) {

1212 
$şass
 .= '‡ctive';

1214 
	g$ouut
 .ğ'<li'. 
dru·l_©Œibu‹s
(
¬¿y
('şass' => 
$şass
)) .'>';

1216 ià(
is£t
(
$lšk
['href'])) {

1218 
	g$ouut
 .ğ
l
(
$lšk
['title'], $link['href'], $link);

1220 ià(!
em±y
(
$lšk
['title'])) {

1222 ià(
em±y
(
$lšk
['html'])) {

1223 
	g$lšk
['t™Ë'] = 
check_¶aš
(
$lšk
['title']);

1225 
	g$¥ª_©Œibu‹s
 = '';

1226 ià(
is£t
(
$lšk
['attributes'])) {

1227 
	g$¥ª_©Œibu‹s
 = 
dru·l_©Œibu‹s
(
$lšk
['attributes']);

1229 
	g$ouut
 .ğ'<¥ª'. 
$¥ª_©Œibu‹s
 .'>'. 
$lšk
['title'] .'</span>';

1232 
	g$i
++;

1233 
	g$ouut
 .= "</li>\n";

1236 
	g$ouut
 .= '</ul>';

1239  
	g$ouut
;

1258 
funùiÚ
 
theme_image
(
$·th
, 
$®t
 = '', 
$t™Ë
 = '', 
$©Œibu‹s
 = 
NULL
, 
$g‘size
 = 
TRUE
) {

1259 ià(!
$g‘size
 || (
is_fe
(
$·th
è&& (
li¡
(
$width
, 
$height
, 
$ty³
, 
$image_©Œibu‹s
èğ@
g‘imagesize
($path)))) {

1260 
$©Œibu‹s
 = 
dru·l_©Œibu‹s
($attributes);

1261 
	g$u¾
 = (
u¾
(
$·th
è=ğ$·thè? $·th : (
ba£_·th
() . $path);

1262  '<img src="'. 
check_u¾
(
$u¾
è.'"‡É="'. 
check_¶aš
(
$®t
è.'"™Ë="'. check_¶aš(
$t™Ë
è.'" '. (
is£t
(
$image_©Œibu‹s
è? 
	g$image_©Œibu‹s
 : ''è. 
$©Œibu‹s
 .' />';

1273 
funùiÚ
 
	$theme_b»adüumb
(
$b»adüumb
) {

1274 ià(!
	`em±y
(
$b»adüumb
)) {

1275  '<div cÏss="b»adüumb">'. 
	`im¶ode
(' Â» ', 
$b»adüumb
) .'</div>';

1277 
	}
}

1284 
funùiÚ
 
	$theme_h–p
() {

1285 ià(
$h–p
 = 
	`m’u_g‘_aùive_h–p
()) {

1286  '<div cÏss="h–p">'. 
$h–p
 .'</div>';

1288 
	}
}

1296 
funùiÚ
 
	$theme_subm’u
(
$lšks
) {

1297  '<div cÏss="subm’u">'. 
	`im¶ode
(' | ', 
$lšks
) .'</div>';

1298 
	}
}

1343 
funùiÚ
 
theme_bË
(
$h—d”
, 
$rows
, 
$©Œibu‹s
 = 
¬¿y
(), 
$ÿ±iÚ
 = 
NULL
) {

1346 ià(
couÁ
(
$h—d”
)) {

1347 
dru·l_add_js
('misc/tableheader.js');

1350 
	g$©Œibu‹s
['şass'] = 
em±y
(
$©Œibu‹s
['class']) ? 'sticky-enabled' : ($attributes['class'] .' sticky-enabled');

1353 
	g$ouut
 = '<bË'. 
dru·l_©Œibu‹s
(
$©Œibu‹s
) .">\n";

1355 ià(
is£t
(
$ÿ±iÚ
)) {

1356 
	g$ouut
 .ğ'<ÿ±iÚ>'. 
$ÿ±iÚ
 ."</caption>\n";

1360 ià(
couÁ
(
$h—d”
)) {

1361 
	g$ts
 = 
bËsÜt_š™
(
$h—d”
);

1364 
	g$ouut
 .ğ(
couÁ
(
$rows
) ? ' <thead><tr>' : ' <tr>');

1365 
fÜ—ch
 (
$h—d”
 
as
 
$ûÎ
) {

1366 
	g$ûÎ
 = 
bËsÜt_h—d”
(
$ûÎ
, 
$h—d”
, 
$ts
);

1367 
	g$ouut
 .ğ
_theme_bË_ûÎ
(
$ûÎ
, 
TRUE
);

1370 
	g$ouut
 .ğ(
couÁ
(
$rows
) ? " </tr></thead>\n" : "</tr>\n");

1373 
	g$ts
 = 
¬¿y
();

1377 ià(
couÁ
(
$rows
)) {

1378 
	g$ouut
 .= "<tbody>\n";

1379 
	g$æ
 = 
¬¿y
('even' => 'odd', 'odd' => 'even');

1380 
	g$şass
 = 'even';

1381 
fÜ—ch
 (
$rows
 
as
 
$numb”
 => 
$row
) {

1382 
$©Œibu‹s
 = 
¬¿y
();

1385 ià(
is£t
(
$row
['data'])) {

1386 
fÜ—ch
 (
$row
 
as
 
$key
 => 
$v®ue
) {

1387 ià(
$key
 == 'data') {

1388 
$ûÎs
 = 
$v®ue
;

1391 
	g$©Œibu‹s
[
$key
] = 
$v®ue
;

1396 
	g$ûÎs
 = 
$row
;

1398 ià(
couÁ
(
$ûÎs
)) {

1400 
	g$şass
 = 
$æ
[
$şass
];

1401 ià(
is£t
(
$©Œibu‹s
['class'])) {

1402 
	g$©Œibu‹s
['şass'] .ğ' '. 
$şass
;

1405 
	g$©Œibu‹s
['şass'] = 
$şass
;

1409 
	g$ouut
 .ğ' <Œ'. 
dru·l_©Œibu‹s
(
$©Œibu‹s
) .'>';

1410 
	g$i
 = 0;

1411 
fÜ—ch
 (
$ûÎs
 
as
 
$ûÎ
) {

1412 
	g$ûÎ
 = 
bËsÜt_ûÎ
(
$ûÎ
, 
$h—d”
, 
$ts
, 
$i
++);

1413 
	g$ouut
 .ğ
_theme_bË_ûÎ
(
$ûÎ
);

1415 
	g$ouut
 .= " </tr>\n";

1418 
	g$ouut
 .= "</tbody>\n";

1421 
	g$ouut
 .= "</table>\n";

1422  
	g$ouut
;

1428 
funùiÚ
 
	$theme_bË_£Ëù_h—d”_ûÎ
() {

1429 
	`dru·l_add_js
('misc/tableselect.js');

1431  
	`¬¿y
('class' => 'select-all');

1432 
	}
}

1442 
funùiÚ
 
	$theme_bËsÜt_šdiÿtÜ
(
$¡yË
) {

1443 ià(
$¡yË
 == "asc") {

1444  
	`theme
('image', 'misc/¬row-asc.²g', 
	`t
('sort icon'),('sort‡scending'));

1447  
	`theme
('image', 'misc/¬row-desc.²g', 
	`t
('sort icon'),('sort descending'));

1449 
	}
}

1463 
funùiÚ
 
theme_box
(
$t™Ë
, 
$cÚ‹Á
, 
$»giÚ
 = 'main') {

1464 
$ouut
 = '<h2 cÏss="t™Ë">'. 
$t™Ë
 .'</h2><div>'. 
$cÚ‹Á
 .'</div>';

1465  
	g$ouut
;

1478 
funùiÚ
 
	$theme_m¬k
(
$ty³
 = 
MARK_NEW
) {

1479 
glob®
 
$u£r
;

1480 ià(
$u£r
->
uid
) {

1481 ià(
$ty³
 =ğ
MARK_NEW
) {

1482  ' <¥ª cÏss="m¬k”">'. 
	`t
('new') .'</span>';

1484 ià(
$ty³
 =ğ
MARK_UPDATED
) {

1485  ' <¥ª cÏss="m¬k”">'. 
	`t
('updated') .'</span>';

1488 
	}
}

1508 
funùiÚ
 
theme_™em_li¡
(
$™ems
 = 
¬¿y
(), 
$t™Ë
 = 
NULL
, 
$ty³
 = 'ul', 
$©Œibu‹s
 = NULL) {

1509 
$ouut
 = '<div class="item-list">';

1510 ià(
is£t
(
$t™Ë
)) {

1511 
	g$ouut
 .ğ'<h3>'. 
$t™Ë
 .'</h3>';

1514 ià(!
em±y
(
$™ems
)) {

1515 
	g$ouut
 .ğ"<$ty³". 
dru·l_©Œibu‹s
(
$©Œibu‹s
) .'>';

1516 
	g$num_™ems
 = 
couÁ
(
$™ems
);

1517 
fÜ—ch
 (
$™ems
 
as
 
$i
 => 
$™em
) {

1518 
$©Œibu‹s
 = 
¬¿y
();

1519 
	g$chd»n
 = 
¬¿y
();

1520 ià(
is_¬¿y
(
$™em
)) {

1521 
fÜ—ch
 (
$™em
 
as
 
$key
 => 
$v®ue
) {

1522 ià(
$key
 == 'data') {

1523 
$d©a
 = 
$v®ue
;

1525 
–£if
 (
$key
 == 'children') {

1526 
$chd»n
 = 
$v®ue
;

1529 
	g$©Œibu‹s
[
$key
] = 
$v®ue
;

1534 
	g$d©a
 = 
$™em
;

1536 ià(
couÁ
(
$chd»n
) > 0) {

1537 
	g$d©a
 .ğ
theme_™em_li¡
(
$chd»n
, 
NULL
, 
$ty³
, 
$©Œibu‹s
);

1539 ià(
	g$i
 == 0) {

1540 
$©Œibu‹s
['şass'] = 
em±y
($attributes['class']) ? 'first' : ($attributes['class'] .' first');

1542 ià(
	g$i
 =ğ
$num_™ems
 - 1) {

1543 
$©Œibu‹s
['şass'] = 
em±y
($attributes['class']) ? 'last' : ($attributes['class'] .'†ast');

1545 
	g$ouut
 .ğ'<li'. 
dru·l_©Œibu‹s
(
$©Œibu‹s
è.'>'. 
$d©a
 ."</li>\n";

1547 
	g$ouut
 .= "</$type>";

1549 
	g$ouut
 .= '</div>';

1550  
	g$ouut
;

1556 
funùiÚ
 
	$theme_mÜe_h–p_lšk
(
$u¾
) {

1557  '<div cÏss="mÜe-h–p-lšk">'. 
	`t
('[<¨h»f="@lšk">mÜh–p...</a>]', 
	`¬¿y
('@lšk' => 
	`check_u¾
(
$u¾
))) .'</div>';

1558 
	}
}

1569 
funùiÚ
 
	$theme_xml_icÚ
(
$u¾
) {

1570 ià(
$image
 = 
	`theme
('image', 'misc/xml.²g', 
	`t
('XML feed'),('XML feed'))) {

1571  '<¨h»f="'. 
	`check_u¾
(
$u¾
è.'" cÏss="xml-icÚ">'. 
$image
 .'</a>';

1573 
	}
}

1583 
funùiÚ
 
	$theme_ãed_icÚ
(
$u¾
, 
$t™Ë
) {

1584 ià(
$image
 = 
	`theme
('image', 'misc/ãed.²g', 
	`t
('Syndiÿ‹ cÚ‹Á'), 
$t™Ë
)) {

1585  '<¨h»f="'. 
	`check_u¾
(
$u¾
è.'" cÏss="ãed-icÚ">'. 
$image
 .'</a>';

1587 
	}
}

1597 
funùiÚ
 
	$theme_mÜe_lšk
(
$u¾
, 
$t™Ë
) {

1598  '<div cÏss="mÜe-lšk">'. 
	`t
('<¨h»f="@lšk"™Ë="@t™Ë">mÜe</a>', 
	`¬¿y
('@lšk' => 
	`check_u¾
(
$u¾
), '@t™Ë' => 
$t™Ë
)) .'</div>';

1599 
	}
}

1610 
funùiÚ
 
	$theme_şosu»
(
$maš
 = 0) {

1611 
$foÙ”
 = 
	`moduË_švoke_®l
('foÙ”', 
$maš
);

1612  
	`im¶ode
("\n", 
$foÙ”
è. 
	`dru·l_g‘_js
('footer');

1613 
	}
}

1623 
funùiÚ
 
	$theme_blocks
(
$»giÚ
) {

1624 
$ouut
 = '';

1626 ià(
$li¡
 = 
	`block_li¡
(
$»giÚ
)) {

1627 
	`fÜ—ch
 (
$li¡
 
as
 
$key
 => 
$block
) {

1629 
$ouut
 .ğ
	`theme
('block', 
$block
);

1634 
$ouut
 .ğ
	`dru·l_g‘_cÚ‹Á
(
$»giÚ
);

1636  
$ouut
;

1637 
	}
}

1648 
funùiÚ
 
	$theme_u£ºame
(
$objeù
) {

1650 ià(
$objeù
->
uid
 && $objeù->
Çme
) {

1652 ià(
	`dru·l_¡¾’
(
$objeù
->
Çme
) > 20) {

1653 
$Çme
 = 
	`dru·l_sub¡r
(
$objeù
->
Çme
, 0, 15) .'...';

1656 
$Çme
 = 
$objeù
->
Çme
;

1659 ià(
	`u£r_acûss
('access user…rofiles')) {

1660 
$ouut
 = 
	`l
(
$Çme
, 'u£r/'. 
$objeù
->
uid
, 
	`¬¿y
('©Œibu‹s' =>‡¼ay('t™Ë' => 
	`t
('View user…rofile.'))));

1663 
$ouut
 = 
	`check_¶aš
(
$Çme
);

1666 ià(
$objeù
->
Çme
) {

1671 ià(!
	`em±y
(
$objeù
->
hom•age
)) {

1672 
$ouut
 = 
	`l
(
$objeù
->
Çme
, $objeù->
hom•age
, 
	`¬¿y
('attributes' =>‡rray('rel' => 'nofollow')));

1675 
$ouut
 = 
	`check_¶aš
(
$objeù
->
Çme
);

1678 
$ouut
 .ğ' ('. 
	`t
('not verified') .')';

1681 
$ouut
 = 
	`check_¶aš
(
	`v¬ŸbË_g‘
('ªÚymous', 
	`t
('Anonymous')));

1684  
$ouut
;

1685 
	}
}

1697 
funùiÚ
 
	$theme_´og»ss_b¬
(
$³rûÁ
, 
$mes§ge
) {

1698 
$ouut
 = '<div id="progress" class="progress">';

1699 
$ouut
 .ğ'<div cÏss="b¬"><div cÏss="fËd" styË="width: '. 
$³rûÁ
 .'%"></div></div>';

1700 
$ouut
 .ğ'<div cÏss="³rûÁage">'. 
$³rûÁ
 .'%</div>';

1701 
$ouut
 .ğ'<div cÏss="mes§ge">'. 
$mes§ge
 .'</div>';

1702 
$ouut
 .= '</div>';

1704  
$ouut
;

1705 
	}
}

1715 
funùiÚ
 
	$theme_šd’tiÚ
(
$size
 = 1) {

1716 
$ouut
 = '';

1717 
$n
 = 0; $À< 
$size
; $n++) {

1718 
$ouut
 .= '<div class="indentation">&nbsp;</div>';

1720  
$ouut
;

1721 
	}
}

1727 
funùiÚ
 
	$_theme_bË_ûÎ
(
$ûÎ
, 
$h—d”
 = 
FALSE
) {

1728 
$©Œibu‹s
 = '';

1730 ià(
	`is_¬¿y
(
$ûÎ
)) {

1731 
$d©a
 = 
	`is£t
(
$ûÎ
['data']) ? $cell['data'] : '';

1732 
$h—d”
 |ğ
	`is£t
(
$ûÎ
['header']);

1733 
	`un£t
(
$ûÎ
['data']);

1734 
	`un£t
(
$ûÎ
['header']);

1735 
$©Œibu‹s
 = 
	`dru·l_©Œibu‹s
(
$ûÎ
);

1738 
$d©a
 = 
$ûÎ
;

1741 ià(
$h—d”
) {

1742 
$ouut
 = "<th$attributes>$data</th>";

1745 
$ouut
 = "<td$attributes>$data</td>";

1748  
$ouut
;

1749 
	}
}

1757 
funùiÚ
 
	$‹m¶©e_´•roûss
(&
$v¬ŸbËs
, 
$hook
) {

1758 
glob®
 
$u£r
;

1759 
$couÁ
 = 
	`¬¿y
();

1763 
$couÁ
[
$hook
] = 
	`is£t
($couÁ[$hook]è&& 
	`is_št
($count[$hook]) ? $count[$hook] : 1;

1764 
$v¬ŸbËs
['zeb¿'] = (
$couÁ
[
$hook
] % 2) ? 'odd' : 'even';

1765 
$v¬ŸbËs
['id'] = 
$couÁ
[
$hook
]++;

1768 
$v¬ŸbËs
['dœeùÜy'] = 
	`·th_to_theme
();

1771 
$v¬ŸbËs
['is_admš'] = 
FALSE
;

1772 
$v¬ŸbËs
['is_äÚt'] = 
FALSE
;

1773 
$v¬ŸbËs
['logged_š'] = 
FALSE
;

1774 ià(
$v¬ŸbËs
['db_is_aùive'] = 
	`db_is_aùive
(è&& !
	`defšed
('MAINTENANCE_MODE')) {

1776 ià(
	`u£r_acûss
('access‡dministration…ages')) {

1777 
$v¬ŸbËs
['is_admš'] = 
TRUE
;

1780 
$v¬ŸbËs
['is_äÚt'] = 
	`dru·l_is_äÚt_·ge
();

1782 
$v¬ŸbËs
['logged_š'] = (
$u£r
->
uid
 > 0);

1784 
$v¬ŸbËs
['u£r'] = 
$u£r
;

1786 
	}
}

1807 
funùiÚ
 
	$‹m¶©e_´•roûss_·ge
(&
$v¬ŸbËs
) {

1809 ià(
	`theme_g‘_£‰šg
('toggle_favicon')) {

1810 
	`dru·l_£t_html_h—d
('<lšk„–="shÜtcuˆicÚ" h»f="'. 
	`check_u¾
(
	`theme_g‘_£‰šg
('favicon')) .'"ype="image/x-icon" />');

1813 
glob®
 
$theme
;

1815 
$»giÚs
 = 
	`sy¡em_»giÚ_li¡
(
$theme
);

1817 
	`fÜ—ch
 (
	`¬¿y_keys
(
$»giÚs
è
as
 
$»giÚ
) {

1819 ià(!(!
$v¬ŸbËs
['show_blocks'] && (
$»giÚ
 == 'left' || $region == 'right'))) {

1820 
$blocks
 = 
	`theme
('blocks', 
$»giÚ
);

1823 
$blocks
 = '';

1826 
	`is£t
(
$v¬ŸbËs
[
$»giÚ
]è? $v¬ŸbËs[$»giÚ] .ğ
$blocks
 : $variables[$region] = $blocks;

1830 
$v¬ŸbËs
['layout'] = 'none';

1831 ià(!
	`em±y
(
$v¬ŸbËs
['left'])) {

1832 
$v¬ŸbËs
['layout'] = 'left';

1834 ià(!
	`em±y
(
$v¬ŸbËs
['right'])) {

1835 
$v¬ŸbËs
['layout'] = ($variables['layout'] == 'left') ? 'both' : 'right';

1839 ià(
	`dru·l_is_äÚt_·ge
()) {

1840 
$missiÚ
 = 
	`f‹r_xss_admš
(
	`theme_g‘_£‰šg
('mission'));

1844 ià(
	`dru·l_g‘_t™Ë
()) {

1845 
$h—d_t™Ë
 = 
	`¬¿y
(
	`¡r_gs
(
	`dru·l_g‘_t™Ë
()), 
	`v¬ŸbË_g‘
('site_name', 'Drupal'));

1848 
$h—d_t™Ë
 = 
	`¬¿y
(
	`v¬ŸbË_g‘
('site_name', 'Drupal'));

1849 ià(
	`v¬ŸbË_g‘
('site_slogan', '')) {

1850 
$h—d_t™Ë
[] = 
	`v¬ŸbË_g‘
('site_slogan', '');

1853 
$v¬ŸbËs
['h—d_t™Ë'] = 
	`im¶ode
(' | ', 
$h—d_t™Ë
);

1854 
$v¬ŸbËs
['ba£_·th'] = 
	`ba£_·th
();

1855 
$v¬ŸbËs
['äÚt_·ge'] = 
	`u¾
();

1856 
$v¬ŸbËs
['b»adüumb'] = 
	`theme
('b»adüumb', 
	`dru·l_g‘_b»adüumb
());

1857 
$v¬ŸbËs
['ãed_icÚs'] = 
	`dru·l_g‘_ãeds
();

1858 
$v¬ŸbËs
['foÙ”_mes§ge'] = 
	`f‹r_xss_admš
(
	`v¬ŸbË_g‘
('s™e_foÙ”', 
FALSE
));

1859 
$v¬ŸbËs
['h—d'] = 
	`dru·l_g‘_html_h—d
();

1860 
$v¬ŸbËs
['h–p'] = 
	`theme
('help');

1861 
$v¬ŸbËs
['Ïnguage'] = 
$GLOBALS
['language'];

1862 
$v¬ŸbËs
['Ïnguage']->
dœ
 = 
$GLOBALS
['Ïnguage']->
dœeùiÚ
 ? 'rtl' : 'ltr';

1863 
$v¬ŸbËs
['logo'] = 
	`theme_g‘_£‰šg
('logo');

1864 
$v¬ŸbËs
['mes§ges'] = $v¬ŸbËs['show_mes§ges'] ? 
	`theme
('status_messages') : '';

1865 
$v¬ŸbËs
['missiÚ'] = 
	`is£t
(
$missiÚ
) ? $mission : '';

1866 
$v¬ŸbËs
['´im¬y_lšks'] = 
	`theme_g‘_£‰šg
('toggË_´im¬y_lšks'è? 
	`m’u_´im¬y_lšks
(è: 
	`¬¿y
();

1867 
$v¬ŸbËs
['£cÚd¬y_lšks'] = 
	`theme_g‘_£‰šg
('toggË_£cÚd¬y_lšks'è? 
	`m’u_£cÚd¬y_lšks
(è: 
	`¬¿y
();

1868 
$v¬ŸbËs
['£¬ch_box'] = (
	`theme_g‘_£‰šg
('toggË_£¬ch'è? 
	`dru·l_g‘_fÜm
('search_theme_form') : '');

1869 
$v¬ŸbËs
['s™e_Çme'] = (
	`theme_g‘_£‰šg
('toggË_Çme'è? 
	`f‹r_xss_admš
(
	`v¬ŸbË_g‘
('site_name', 'Drupal')) : '');

1870 
$v¬ŸbËs
['s™e_¦ogª'] = (
	`theme_g‘_£‰šg
('toggË_¦ogª'è? 
	`f‹r_xss_admš
(
	`v¬ŸbË_g‘
('site_slogan', '')) : '');

1871 
$v¬ŸbËs
['css'] = 
	`dru·l_add_css
();

1872 
$v¬ŸbËs
['¡yËs'] = 
	`dru·l_g‘_css
();

1873 
$v¬ŸbËs
['süts'] = 
	`dru·l_g‘_js
();

1874 
$v¬ŸbËs
['bs'] = 
	`theme
('menu_local_tasks');

1875 
$v¬ŸbËs
['t™Ë'] = 
	`dru·l_g‘_t™Ë
();

1877 
$v¬ŸbËs
['şosu»'] = 
	`theme
('closure');

1879 ià(
$node
 = 
	`m’u_g‘_objeù
()) {

1880 
$v¬ŸbËs
['node'] = 
$node
;

1885 
$body_şas£s
 = 
	`¬¿y
();

1887 
$body_şas£s
[] = 
$v¬ŸbËs
['is_front'] ? 'front' : 'not-front';

1889 
$body_şas£s
[] = 
$v¬ŸbËs
['logged_in'] ? 'logged-in' : 'not-logged-in';

1894 
$body_şas£s
[] = 
	`´eg_»¶aû
('![^abcdefghijklmnİqr¡uvwxyz0-9-_]+!s', '', '·ge-'. 
	`fÜm_ş—n_id
(
	`dru·l_¡¹Şow”
(
	`¬g
(0))));

1896 ià(
	`is£t
(
$v¬ŸbËs
['node']è&& $v¬ŸbËs['node']->
ty³
) {

1897 
$body_şas£s
[] = 'node-ty³-'. 
	`fÜm_ş—n_id
(
$v¬ŸbËs
['node']->
ty³
);

1900 ià(
$v¬ŸbËs
['layout'] == 'both') {

1901 
$body_şas£s
[] = 'two-sidebars';

1903 
	`–£if
 (
$v¬ŸbËs
['layout'] == 'none') {

1904 
$body_şas£s
[] = 'no-sidebars';

1907 
$body_şas£s
[] = 'Úe-sideb¬ sideb¬-'. 
$v¬ŸbËs
['layout'];

1910 
$v¬ŸbËs
['body_şas£s'] = 
	`im¶ode
(' ', 
$body_şas£s
);

1922 
$i
 = 0;

1923 
$sugge¡iÚ
 = 'page';

1924 
$sugge¡iÚs
 = 
	`¬¿y
();

1925 
$¬g
 = 
	`¬g
(
$i
++)) {

1926 
$¬g
 = 
	`¡r_»¶aû
(
	`¬¿y
("/", "\\", "\0"), '', $arg);

1927 
$sugge¡iÚs
[] = 
$sugge¡iÚ
 .'-'. 
$¬g
;

1928 ià(!
	`is_num”ic
(
$¬g
)) {

1929 
$sugge¡iÚ
 .ğ'-'. 
$¬g
;

1932 ià(
	`dru·l_is_äÚt_·ge
()) {

1933 
$sugge¡iÚs
[] = 'page-front';

1936 ià(
$sugge¡iÚs
) {

1937 
$v¬ŸbËs
['‹m¶©e_fes'] = 
$sugge¡iÚs
;

1939 
	}
}

1955 
funùiÚ
 
	$‹m¶©e_´•roûss_node
(&
$v¬ŸbËs
) {

1956 
$node
 = 
$v¬ŸbËs
['node'];

1957 ià(
	`moduË_exi¡s
('taxonomy')) {

1958 
$v¬ŸbËs
['xÚomy'] = 
	`xÚomy_lšk
('xÚomy”ms', 
$node
);

1961 
$v¬ŸbËs
['xÚomy'] = 
	`¬¿y
();

1964 ià(
$v¬ŸbËs
['‹a£r'] && 
$node
->
‹a£r
) {

1965 
$v¬ŸbËs
['cÚ‹Á'] = 
$node
->
‹a£r
;

1967 
	`–£if
 (
	`is£t
(
$node
->
body
)) {

1968 
$v¬ŸbËs
['cÚ‹Á'] = 
$node
->
body
;

1971 
$v¬ŸbËs
['content'] = '';

1974 
$v¬ŸbËs
['d©e'] = 
	`fÜm©_d©e
(
$node
->
ü—‹d
);

1975 
$v¬ŸbËs
['lšks'] = !
	`em±y
(
$node
->
lšks
è? 
	`theme
('lšks', $node->lšks, 
	`¬¿y
('class' => 'links inline')) : '';

1976 
$v¬ŸbËs
['Çme'] = 
	`theme
('u£ºame', 
$node
);

1977 
$v¬ŸbËs
['node_u¾'] = 
	`u¾
('node/'. 
$node
->
nid
);

1978 
$v¬ŸbËs
['‹rms'] = 
	`theme
('lšks', $v¬ŸbËs['xÚomy'], 
	`¬¿y
('class' => 'links inline'));

1979 
$v¬ŸbËs
['t™Ë'] = 
	`check_¶aš
(
$node
->
t™Ë
);

1982 
$v¬ŸbËs
 = 
	`¬¿y_m”ge
((
¬¿y
)
$node
, $variables);

1985 ià(
	`theme_g‘_£‰šg
('toggË_node_šfo_'. 
$node
->
ty³
)) {

1986 
$v¬ŸbËs
['subm™‹d'] = 
	`theme
('node_subm™‹d', 
$node
);

1987 
$v¬ŸbËs
['piùu»'] = 
	`theme_g‘_£‰šg
('toggË_node_u£r_piùu»'è? 
	`theme
('u£r_piùu»', 
$node
) : '';

1990 
$v¬ŸbËs
['submitted'] = '';

1991 
$v¬ŸbËs
['picture'] = '';

1994 
$v¬ŸbËs
['‹m¶©e_fes'][] = 'node-'. 
$node
->
ty³
;

1995 
	}
}

2014 
funùiÚ
 
	$‹m¶©e_´•roûss_block
(&
$v¬ŸbËs
) {

2015 
$block_couÁ”
 = 
	`¬¿y
();

2017 ià(!
	`is£t
(
$block_couÁ”
[
$v¬ŸbËs
['block']->
»giÚ
])) {

2018 
$block_couÁ”
[
$v¬ŸbËs
['block']->
»giÚ
] = 1;

2021 
$v¬ŸbËs
['block_zeb¿'] = (
$block_couÁ”
[$v¬ŸbËs['block']->
»giÚ
] % 2) ? 'odd' : 'even';

2022 
$v¬ŸbËs
['block_id'] = 
$block_couÁ”
[$v¬ŸbËs['block']->
»giÚ
]++;

2024 
$v¬ŸbËs
['‹m¶©e_fes'][] = 'block-'. $v¬ŸbËs['block']->
»giÚ
;

2025 
$v¬ŸbËs
['‹m¶©e_fes'][] = 'block-'. $v¬ŸbËs['block']->
moduË
;

2026 
$v¬ŸbËs
['‹m¶©e_fes'][] = 'block-'. $v¬ŸbËs['block']->
moduË
 .'-'. $v¬ŸbËs['block']->
d–
;

2027 
	}
}

	@/srv/http/subs/notes/www/includes/theme.maintenance.inc

1 <?
php


17 
funùiÚ
 
	$_dru·l_maš‹Çnû_theme
() {

18 
glob®
 
$theme
, 
$theme_key
;

21 ià(
	`is£t
(
$theme
)) {

25 
»quœe_Úû
 './includes/path.inc';

26 
»quœe_Úû
 './includes/theme.inc';

27 
»quœe_Úû
 './includes/common.inc';

28 
»quœe_Úû
 './includes/unicode.inc';

29 
»quœe_Úû
 './includes/file.inc';

30 
»quœe_Úû
 './includes/module.inc';

31 
»quœe_Úû
 './includes/database.inc';

32 
	`unicode_check
();

35 ià(
	`defšed
('MAINTENANCE_MODE'è&& (
MAINTENANCE_MODE
 == 'install' || MAINTENANCE_MODE == 'update')) {

36 
$theme
 = 'minnelli';

39 ià(!
	`db_is_aùive
()) {

42 
$moduË_li¡
['system']['filename'] = 'modules/system/system.module';

43 
$moduË_li¡
['filter']['filename'] = 'modules/filter/filter.module';

44 
	`moduË_li¡
(
TRUE
, 
FALSE
, FALSE, 
$moduË_li¡
);

45 
	`dru·l_lßd
('module', 'system');

46 
	`dru·l_lßd
('module', 'filter');

49 
$theme
 = 
	`v¬ŸbË_g‘
('maintenance_theme', 'minnelli');

52 
$themes
 = 
	`li¡_themes
();

55 
$theme_key
 = 
$theme
;

58 
$ba£_theme
 = 
	`¬¿y
();

59 
$ªû¡Ü
 = 
$theme
;

60 
$ªû¡Ü
 && 
	`is£t
(
$themes
[$ªû¡Ü]->
ba£_theme
)) {

61 
$ba£_theme
[] = 
$Ãw_ba£_theme
 = 
$themes
[$themes[
$ªû¡Ü
]->
ba£_theme
];

62 
$ªû¡Ü
 = 
$themes
[$ªû¡Ü]->
ba£_theme
;

64 
	`_š™_theme
(
$themes
[
$theme
], 
	`¬¿y_»v”£
(
$ba£_theme
), '_theme_load_offline_registry');

68 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'system') .'/defaults.css', 'module');

69 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'system') .'/system.css', 'module');

70 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'system') .'/system-menus.css', 'module');

71 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'system') .'/maintenance.css', 'module');

72 
	}
}

77 
funùiÚ
 
	$_theme_lßd_ofæše_»gi¡ry
(
$theme
, 
$ba£_theme
 = 
NULL
, 
$theme_’gše
 = NULL) {

78 
$»gi¡ry
 = 
	`_theme_bud_»gi¡ry
(
$theme
, 
$ba£_theme
, 
$theme_’gše
);

79 
	`_theme_£t_»gi¡ry
(
$»gi¡ry
);

80 
	}
}

87 
funùiÚ
 
	$theme_sk_li¡
(
$™ems
, 
$aùive
 = 
NULL
) {

88 
$dÚe
 = 
	`is£t
(
$™ems
[
$aùive
]è|| $aùiv=ğ
NULL
;

89 
$ouut
 = '<ol class="task-list">';

90 
	`fÜ—ch
 (
$™ems
 
as
 
$k
 => 
$™em
) {

91 ià(
$aùive
 =ğ
$k
) {

92 
$şass
 = 'active';

93 
$dÚe
 = 
çl£
;

96 
$şass
 = 
$dÚe
 ? 'done' : '';

98 
$ouut
 .ğ'<l˜şass="'. 
$şass
 .'">'. 
$™em
 .'</li>';

100 
$ouut
 .= '</ol>';

101  
$ouut
;

102 
	}
}

112 
funùiÚ
 
	$theme_š¡®l_·ge
(
$cÚ‹Á
) {

113 
	`dru·l_£t_h—d”
('Content-Type:ext/html; charset=utf-8');

116 
$v¬ŸbËs
['cÚ‹Á'] = 
$cÚ‹Á
;

118 
$v¬ŸbËs
['show_mes§ges'] = 
FALSE
;

120 
	`‹m¶©e_´•roûss_maš‹Çnû_·ge
(
$v¬ŸbËs
);

123 
$mes§ges
 = 
	`dru·l_£t_mes§ge
();

124 ià(
	`is£t
(
$mes§ges
['error'])) {

125 
$t™Ë
 = 
	`couÁ
(
$mes§ges
['”rÜ']è> 1 ? 
	`¡
('The followingƒrrors must be„esolved before you can continuehe installation…rocess') : st('The followingƒrror must be„esolved before you can continuehe installation…rocess');

126 
$v¬ŸbËs
['mes§ges'] .ğ'<h3>'. 
$t™Ë
 .':</h3>';

127 
$v¬ŸbËs
['mes§ges'] .ğ
	`theme
('status_messages', 'error');

128 
$v¬ŸbËs
['cÚ‹Á'] .ğ'<p>'. 
	`¡
('PËa£ checkh”rÜ mes§ge ªd <¨h»f="!u¾">Œy‡gaš</a>.', 
	`¬¿y
('!u¾' => 
	`check_u¾
(
	`»que¡_uri
()))) .'</p>';

132 ià(
	`is£t
(
$mes§ges
['warning'])) {

133 
$t™Ë
 = 
	`couÁ
(
$mes§ges
['w¬nšg']è> 1 ? 
	`¡
('The following installation warnings should be carefully„eviewed') : st('The following installation warning should be carefully„eviewed');

134 
$v¬ŸbËs
['mes§ges'] .ğ'<h4>'. 
$t™Ë
 .':</h4>';

135 
$v¬ŸbËs
['mes§ges'] .ğ
	`theme
('status_messages', 'warning');

139 ià(
	`is£t
(
$mes§ges
['status'])) {

140 
$t™Ë
 = 
	`couÁ
(
$mes§ges
['¡©us']è> 1 ? 
	`¡
('The following installation warnings should be carefully„eviewed, but in most cases may be safely ignored') : st('The following installation warning should be carefully„eviewed, but in most cases may be safely ignored');

141 
$v¬ŸbËs
['mes§ges'] .ğ'<h4>'. 
$t™Ë
 .':</h4>';

142 
$v¬ŸbËs
['mes§ges'] .ğ
	`theme
('status_messages', 'status');

148 
glob®
 
$theme_·th
;

149 
$theme_·th
 = 'themes/garland';

151  
	`theme_»nd”_‹m¶©e
('themes/g¬Ïnd/maš‹Çnû-·ge.l.php', 
$v¬ŸbËs
);

152 
	}
}

165 
funùiÚ
 
	$theme_upd©e_·ge
(
$cÚ‹Á
, 
$show_mes§ges
 = 
TRUE
) {

167 
	`dru·l_£t_h—d”
('Content-Type:ext/html; charset=utf-8');

170 
$v¬ŸbËs
['cÚ‹Á'] = 
$cÚ‹Á
;

171 
$v¬ŸbËs
['show_mes§ges'] = 
$show_mes§ges
;

173 
	`‹m¶©e_´•roûss_maš‹Çnû_·ge
(
$v¬ŸbËs
);

176 
$mes§ges
 = 
	`dru·l_£t_mes§ge
();

177 ià(
	`is£t
(
$mes§ges
['warning'])) {

178 
$t™Ë
 = 
	`couÁ
(
$mes§ges
['warning']) > 1 ? 'The following update warnings should be carefully„eviewed before continuing' : 'The following update warning should be carefully„eviewed before continuing';

179 
$v¬ŸbËs
['mes§ges'] .ğ'<h4>'. 
$t™Ë
 .':</h4>';

180 
$v¬ŸbËs
['mes§ges'] .ğ
	`theme
('status_messages', 'warning');

186 
glob®
 
$theme_·th
;

187 
$theme_·th
 = 'themes/garland';

189  
	`theme_»nd”_‹m¶©e
('themes/g¬Ïnd/maš‹Çnû-·ge.l.php', 
$v¬ŸbËs
);

190 
	}
}

208 
funùiÚ
 
	$‹m¶©e_´•roûss_maš‹Çnû_·ge
(&
$v¬ŸbËs
) {

210 ià(
	`theme_g‘_£‰šg
('toggle_favicon')) {

211 
	`dru·l_£t_html_h—d
('<lšk„–="shÜtcuˆicÚ" h»f="'. 
	`check_u¾
(
	`theme_g‘_£‰šg
('favicon')) .'"ype="image/x-icon" />');

214 
glob®
 
$theme
;

216 
$theme_d©a
 = 
	`_sy¡em_theme_d©a
();

217 
$»giÚs
 = 
$theme_d©a
[
$theme
]->
šfo
['regions'];

220 
	`fÜ—ch
 (
	`¬¿y_keys
(
$»giÚs
è
as
 
$»giÚ
) {

222 
$»giÚ_cÚ‹Á
 = 
	`dru·l_g‘_cÚ‹Á
(
$»giÚ
);

223 
	`is£t
(
$v¬ŸbËs
[
$»giÚ
]è? $v¬ŸbËs[$»giÚ] .ğ
$»giÚ_cÚ‹Á
 : $variables[$region] = $region_content;

227 
$v¬ŸbËs
['layout'] = 'none';

228 ià(!
	`em±y
(
$v¬ŸbËs
['left'])) {

229 
$v¬ŸbËs
['layout'] = 'left';

231 ià(!
	`em±y
(
$v¬ŸbËs
['right'])) {

232 
$v¬ŸbËs
['layout'] = ($variables['layout'] == 'left') ? 'both' : 'right';

236 ià(
	`dru·l_g‘_t™Ë
()) {

237 
$h—d_t™Ë
 = 
	`¬¿y
(
	`¡r_gs
(
	`dru·l_g‘_t™Ë
()), 
	`v¬ŸbË_g‘
('site_name', 'Drupal'));

240 
$h—d_t™Ë
 = 
	`¬¿y
(
	`v¬ŸbË_g‘
('site_name', 'Drupal'));

241 ià(
	`v¬ŸbË_g‘
('site_slogan', '')) {

242 
$h—d_t™Ë
[] = 
	`v¬ŸbË_g‘
('site_slogan', '');

245 
$v¬ŸbËs
['h—d_t™Ë'] = 
	`im¶ode
(' | ', 
$h—d_t™Ë
);

246 
$v¬ŸbËs
['ba£_·th'] = 
	`ba£_·th
();

247 
$v¬ŸbËs
['breadcrumb'] = '';

248 
$v¬ŸbËs
['feed_icons'] = '';

249 
$v¬ŸbËs
['foÙ”_mes§ge'] = 
	`f‹r_xss_admš
(
	`v¬ŸbË_g‘
('s™e_foÙ”', 
FALSE
));

250 
$v¬ŸbËs
['h—d'] = 
	`dru·l_g‘_html_h—d
();

251 
$v¬ŸbËs
['help'] = '';

252 
$v¬ŸbËs
['Ïnguage'] = 
$GLOBALS
['language'];

253 
$v¬ŸbËs
['Ïnguage']->
dœ
 = 
$GLOBALS
['Ïnguage']->
dœeùiÚ
 ? 'rtl' : 'ltr';

254 
$v¬ŸbËs
['logo'] = 
	`theme_g‘_£‰šg
('logo');

255 
$v¬ŸbËs
['mes§ges'] = $v¬ŸbËs['show_mes§ges'] ? 
	`theme
('status_messages') : '';

256 
$v¬ŸbËs
['mission'] = '';

257 
$v¬ŸbËs
['´im¬y_lšks'] = 
	`¬¿y
();

258 
$v¬ŸbËs
['£cÚd¬y_lšks'] = 
	`¬¿y
();

259 
$v¬ŸbËs
['search_box'] = '';

260 
$v¬ŸbËs
['s™e_Çme'] = (
	`theme_g‘_£‰šg
('toggË_Çme'è? 
	`v¬ŸbË_g‘
('site_name', 'Drupal') : '');

261 
$v¬ŸbËs
['s™e_¦ogª'] = (
	`theme_g‘_£‰šg
('toggË_¦ogª'è? 
	`v¬ŸbË_g‘
('site_slogan', '') : '');

262 
$v¬ŸbËs
['css'] = 
	`dru·l_add_css
();

263 
$v¬ŸbËs
['¡yËs'] = 
	`dru·l_g‘_css
();

264 
$v¬ŸbËs
['süts'] = 
	`dru·l_g‘_js
();

265 
$v¬ŸbËs
['tabs'] = '';

266 
$v¬ŸbËs
['t™Ë'] = 
	`dru·l_g‘_t™Ë
();

267 
$v¬ŸbËs
['closure'] = '';

270 
$body_şas£s
 = 
	`¬¿y
();

271 
$body_şas£s
[] = 'in-maintenance';

272 ià(
	`is£t
(
$v¬ŸbËs
['db_is_active']) && !$variables['db_is_active']) {

273 
$body_şas£s
[] = 'db-offline';

275 ià(
$v¬ŸbËs
['layout'] == 'both') {

276 
$body_şas£s
[] = 'two-sidebars';

278 
	`–£if
 (
$v¬ŸbËs
['layout'] == 'none') {

279 
$body_şas£s
[] = 'no-sidebars';

282 
$body_şas£s
[] = 'Úe-sideb¬ sideb¬-'. 
$v¬ŸbËs
['layout'];

284 
$v¬ŸbËs
['body_şas£s'] = 
	`im¶ode
(' ', 
$body_şas£s
);

288 ià(
	`is£t
(
$v¬ŸbËs
['db_is_active']) && !$variables['db_is_active']) {

289 
$v¬ŸbËs
['template_file'] = 'maintenance-page-offline';

291 
	}
}

	@/srv/http/subs/notes/www/includes/unicode.inc

1 <?
php


7 
defše
('UNICODE_ERROR', -1);

12 
defše
('UNICODE_SINGLEBYTE', 0);

18 
defše
('UNICODE_MULTIBYTE', 1);

23 
funùiÚ
 
	$unicode_check
() {

24 
	`li¡
(
$GLOBALS
['muÉiby‹']èğ
	`_unicode_check
();

25 
	}
}

38 
funùiÚ
 
	$_unicode_check
() {

40 
$t
 = 
	`g‘_t
();

43 
	`£oÿË
(
LC_CTYPE
, 'C');

47 ià(
	`´eg_m©ch
('/[Ã -Ã¡]/u', 'Ã¢')) {

48  
	`¬¿y
(
UNICODE_ERROR
, 
	`$t
('The PCRE†ibrary in your PHP installation is outdated. This will cause…roblems when handling Unicodeext. If you‡re„unning PHP 4.3.3 or higher, make sure you‡re usinghe PCRE†ibrary supplied by PHP. Please„eferohe <a href="@url">PHP PCRE documentation</a> for more information.',‡rray('@url' => 'http://www.php.net/pcre')));

52 ià(!
	`funùiÚ_exi¡s
('mb_strlen')) {

53  
	`¬¿y
(
UNICODE_SINGLEBYTE
, 
	`$t
('Operations on Unicode strings‡reƒmulated on‡ best-effort basis. Installhe <a href="@url">PHP mbstringƒxtension</a> for improved Unicode support.',‡rray('@url' => 'http://www.php.net/mbstring')));

57 ià(
	`ši_g‘
('mbstring.func_overload') != 0) {

58  
	`¬¿y
(
UNICODE_ERROR
, 
	`$t
('Multibyte string function overloading in PHP is‡ctive‡nd must be disabled. Checkhe…hp.ini <em>mbstring.func_overload</em> setting. Please„eferohe <a href="@url">PHP mbstring documentation</a> for more information.',‡rray('@url' => 'http://www.php.net/mbstring')));

60 ià(
	`ši_g‘
('mbstring.encoding_translation') != 0) {

61  
	`¬¿y
(
UNICODE_ERROR
, 
	`$t
('Multibyte string input conversion in PHP is‡ctive‡nd must be disabled. Checkhe…hp.ini <em>mbstring.encoding_translation</em> setting. Please„eferohe <a href="@url">PHP mbstring documentation</a> for more information.',‡rray('@url' => 'http://www.php.net/mbstring')));

63 ià(
	`ši_g‘
('mbstring.http_input') != 'pass') {

64  
	`¬¿y
(
UNICODE_ERROR
, 
	`$t
('Multibyte string input conversion in PHP is‡ctive‡nd must be disabled. Checkhe…hp.ini <em>mbstring.http_input</em> setting. Please„eferohe <a href="@url">PHP mbstring documentation</a> for more information.',‡rray('@url' => 'http://www.php.net/mbstring')));

66 ià(
	`ši_g‘
('mbstring.http_output') != 'pass') {

67  
	`¬¿y
(
UNICODE_ERROR
, 
	`$t
('Multibyte string output conversion in PHP is‡ctive‡nd must be disabled. Checkhe…hp.ini <em>mbstring.http_output</em> setting. Please„eferohe <a href="@url">PHP mbstring documentation</a> for more information.',‡rray('@url' => 'http://www.php.net/mbstring')));

71 
	`mb_š‹º®_’codšg
('utf-8');

72 
	`mb_Ïnguage
('uni');

73  
	`¬¿y
(
UNICODE_MULTIBYTE
, '');

74 
	}
}

79 
funùiÚ
 
	$unicode_»quœem’ts
() {

81 
$t
 = 
	`g‘_t
();

83 
$lib¿r›s
 = 
	`¬¿y
(

84 
UNICODE_SINGLEBYTE
 => 
	`$t
('Standard PHP'),

85 
UNICODE_MULTIBYTE
 => 
	`$t
('PHP Mbstring Extension'),

86 
UNICODE_ERROR
 => 
	`$t
('Error'),

88 
$£v”™›s
 = 
	`¬¿y
(

89 
UNICODE_SINGLEBYTE
 => 
REQUIREMENT_WARNING
,

90 
UNICODE_MULTIBYTE
 => 
REQUIREMENT_OK
,

91 
UNICODE_ERROR
 => 
REQUIREMENT_ERROR
,

93 
	`li¡
(
$lib¿ry
, 
$desütiÚ
èğ
	`_unicode_check
();

95 
$»quœem’ts
['unicode'] = 
	`¬¿y
(

96 't™Ë' => 
	`$t
('Unicode†ibrary'),

97 'v®ue' => 
$lib¿r›s
[
$lib¿ry
],

99 ià(
$desütiÚ
) {

100 
$»quœem’ts
['unicode']['desütiÚ'] = 
$desütiÚ
;

103 
$»quœem’ts
['unicode']['£v”™y'] = 
$£v”™›s
[
$lib¿ry
];

105  
$»quœem’ts
;

106 
	}
}

126 
funùiÚ
 
	$dru·l_xml_·r£r_ü—‹
(&
$d©a
) {

128 
$’codšg
 = 'utf-8';

129 
$bom
 = 
FALSE
;

132 ià(!
	`¡ºcmp
(
$d©a
, "\xEF\xBB\xBF", 3)) {

133 
$bom
 = 
TRUE
;

134 
$d©a
 = 
	`sub¡r
($data, 3);

138 ià(!
$bom
 && 
	`”eg
('^<\?xml[^>]+’codšg="([^"]+)"', 
$d©a
, 
$m©ch
)) {

139 
$’codšg
 = 
$m©ch
[1];

143 
$php_suµÜ‹d
 = 
	`¬¿y
('utf-8', 'iso-8859-1', 'us-ascii');

144 ià(!
	`š_¬¿y
(
	`¡¹Şow”
(
$’codšg
), 
$php_suµÜ‹d
)) {

145 
$out
 = 
	`dru·l_cÚv”t_to_utf8
(
$d©a
, 
$’codšg
);

146 ià(
$out
 !=ğ
FALSE
) {

147 
$’codšg
 = 'utf-8';

148 
$d©a
 = 
	`”eg_»¶aû
('^(<\?xml[^>]+’codšg)="([^"]+)"', '\\1="utf-8"', 
$out
);

151 
	`w©chdog
('php', 'Could‚Ù cÚv”ˆXMLƒncodšg % tØUTF-8.', 
	`¬¿y
('%s' => 
$’codšg
), 
WATCHDOG_WARNING
);

156 
$xml_·r£r
 = 
	`xml_·r£r_ü—‹
(
$’codšg
);

157 
	`xml_·r£r_£t_İtiÚ
(
$xml_·r£r
, 
XML_OPTION_TARGET_ENCODING
, 'utf-8');

158  
$xml_·r£r
;

159 
	}
}

173 
funùiÚ
 
	$dru·l_cÚv”t_to_utf8
(
$d©a
, 
$’codšg
) {

174 ià(
	`funùiÚ_exi¡s
('iconv')) {

175 
$out
 = @
	`icÚv
(
$’codšg
, 'utf-8', 
$d©a
);

177 ià(
	`funùiÚ_exi¡s
('mb_convert_encoding')) {

178 
$out
 = @
	`mb_cÚv”t_’codšg
(
$d©a
, 'utf-8', 
$’codšg
);

180 ià(
	`funùiÚ_exi¡s
('recode_string')) {

181 
$out
 = @
	`»code_¡ršg
(
$’codšg
 .'..utf-8', 
$d©a
);

184 
	`w©chdog
('php', 'UnsuµÜ‹dƒncodšg %s. PËa£ in¡®ÈicÚv, GNU„ecodÜ mb¡ršg fÜ PHP.', 
	`¬¿y
('%s' => 
$’codšg
), 
WATCHDOG_ERROR
);

185  
FALSE
;

188  
$out
;

189 
	}
}

209 
funùiÚ
 
	$dru·l_Œunÿ‹_by‹s
(
$¡ršg
, 
$Ën
) {

210 ià(
	`¡¾’
(
$¡ršg
è<ğ
$Ën
) {

211  
$¡ršg
;

213 ià((
	`Üd
(
$¡ršg
[
$Ën
]) < 0x80) || (ord($string[$len]) >= 0xC0)) {

214  
	`sub¡r
(
$¡ršg
, 0, 
$Ën
);

216 --
$Ën
 >ğ0 && 
	`Üd
(
$¡ršg
[$len]) >= 0x80 && ord($string[$len]) < 0xC0) {};

217  
	`sub¡r
(
$¡ršg
, 0, 
$Ën
);

218 
	}
}

234 
funùiÚ
 
	$Œunÿ‹_utf8
(
$¡ršg
, 
$Ën
, 
$wÜd§ã
 = 
FALSE
, 
$dÙs
 = FALSE) {

236 ià(
	`dru·l_¡¾’
(
$¡ršg
è<ğ
$Ën
) {

237  
$¡ršg
;

240 ià(
$dÙs
) {

241 
$Ën
 -= 4;

244 ià(
$wÜd§ã
) {

245 
$¡ršg
 = 
	`dru·l_sub¡r
($¡ršg, 0, 
$Ën
 + 1);

246 ià(
$Ï¡_¥aû
 = 
	`¡¼pos
(
$¡ršg
, ' ')) {

247 
$¡ršg
 = 
	`sub¡r
($¡ršg, 0, 
$Ï¡_¥aû
);

250 
$¡ršg
 = 
	`dru·l_sub¡r
($¡ršg, 0, 
$Ën
);

254 
$¡ršg
 = 
	`dru·l_sub¡r
($¡ršg, 0, 
$Ën
);

257 ià(
$dÙs
) {

258 
$¡ršg
 .= ' ...';

261  
$¡ršg
;

262 
	}
}

279 
funùiÚ
 
	$mime_h—d”_’code
(
$¡ršg
) {

280 ià(
	`´eg_m©ch
('/[^\x20-\x7E]/', 
$¡ršg
)) {

281 
$chunk_size
 = 47;

282 
$Ën
 = 
	`¡¾’
(
$¡ršg
);

283 
$ouut
 = '';

284 
$Ën
 > 0) {

285 
$chunk
 = 
	`dru·l_Œunÿ‹_by‹s
(
$¡ršg
, 
$chunk_size
);

286 
$ouut
 .ğ' =?UTF-8?B?'. 
	`ba£64_’code
(
$chunk
) ."?=\n";

287 
$c
 = 
	`¡¾’
(
$chunk
);

288 
$¡ršg
 = 
	`sub¡r
($¡ršg, 
$c
);

289 
$Ën
 -ğ
$c
;

291  
	`Œim
(
$ouut
);

293  
$¡ršg
;

294 
	}
}

299 
funùiÚ
 
	$mime_h—d”_decode
(
$h—d”
) {

301 
$h—d”
 = 
	`´eg_»¶aû_ÿÎback
('/=\?([^?]+)\?(Q|B)\?([^?]+|\?(?!=))\?=\s+(?==\?)/', '_mime_header_decode', $header);

303  
	`´eg_»¶aû_ÿÎback
('/=\?([^?]+)\?(Q|B)\?([^?]+|\?(?!=))\?=/', '_mime_h—d”_decode', 
$h—d”
);

304 
	}
}

309 
funùiÚ
 
	$_mime_h—d”_decode
(
$m©ches
) {

314 
$d©a
 = (
$m©ches
[2] =ğ'B'è? 
	`ba£64_decode
($m©ches[3]è: 
	`¡r_»¶aû
('_', ' ', 
	`quÙed_´šbË_decode
($matches[3]));

315 ià(
	`¡¹Şow”
(
$m©ches
[1]) != 'utf-8') {

316 
$d©a
 = 
	`dru·l_cÚv”t_to_utf8
($d©a, 
$m©ches
[1]);

318  
$d©a
;

319 
	}
}

337 
funùiÚ
 
decode_’t™›s
(
$‹xt
, 
$exşude
 = 
	$¬¿y
()) {

338 
$bË
;

340 ià(!
	`is£t
(
$bË
)) {

342 
$bË
 = 
	`¬¿y_æ
(
	`g‘_html_Œª¦©iÚ_bË
(
HTML_ENTITIES
));

344 
$bË
 = 
	`¬¿y_m­
('utf8_encode', $table);

346 
$bË
['&apos;'] = "'";

348 
$ÃwbË
 = 
	`¬¿y_diff
(
$bË
, 
$exşude
);

351  
	`´eg_»¶aû
('/&(#x?)?([A-Za-z0-9]+);/e', '_decode_’t™›s("$1", "$2", "$0", $ÃwbË, $exşude)', 
$‹xt
);

352 
	}
}

357 
funùiÚ
 
	$_decode_’t™›s
(
$´efix
, 
$cod•ošt
, 
$Üigš®
, &
$bË
, &
$exşude
) {

359 ià(!
$´efix
) {

360 ià(
	`is£t
(
$bË
[
$Üigš®
])) {

361  
$bË
[
$Üigš®
];

364  
$Üigš®
;

368 ià(
$´efix
 == '#x') {

369 
$cod•ošt
 = 
	`ba£_cÚv”t
($codepoint, 16, 10);

373 
$cod•ošt
 = 
	`´eg_»¶aû
('/^0+/', '', $codepoint);

376 ià(
$cod•ošt
 < 0x80) {

377 
$¡r
 = 
	`chr
(
$cod•ošt
);

379 ià(
$cod•ošt
 < 0x800) {

380 
$¡r
 = 
	`chr
(0xC0 | (
$cod•ošt
 >> 6))

381 . 
	`chr
(0x80 | (
$cod•ošt
 & 0x3F));

383 ià(
$cod•ošt
 < 0x10000) {

384 
$¡r
 = 
	`chr
(0xE0 | ( 
$cod•ošt
 >> 12))

385 . 
	`chr
(0x80 | ((
$cod•ošt
 >> 6) & 0x3F))

386 . 
	`chr
(0x80 | ( 
$cod•ošt
 & 0x3F));

388 ià(
$cod•ošt
 < 0x200000) {

389 
$¡r
 = 
	`chr
(0xF0 | ( 
$cod•ošt
 >> 18))

390 . 
	`chr
(0x80 | ((
$cod•ošt
 >> 12) & 0x3F))

391 . 
	`chr
(0x80 | ((
$cod•ošt
 >> 6) & 0x3F))

392 . 
	`chr
(0x80 | ( 
$cod•ošt
 & 0x3F));

395 ià(
	`š_¬¿y
(
$¡r
, 
$exşude
)) {

396  
$Üigš®
;

399  
$¡r
;

401 
	}
}

407 
funùiÚ
 
	$dru·l_¡¾’
(
$‹xt
) {

408 
glob®
 
$muÉiby‹
;

409 ià(
$muÉiby‹
 =ğ
UNICODE_MULTIBYTE
) {

410  
	`mb_¡¾’
(
$‹xt
);

414  
	`¡¾’
(
	`´eg_»¶aû
("/[\x80-\xBF]/", '', 
$‹xt
));

416 
	}
}

421 
funùiÚ
 
	$dru·l_¡¹ouµ”
(
$‹xt
) {

422 
glob®
 
$muÉiby‹
;

423 ià(
$muÉiby‹
 =ğ
UNICODE_MULTIBYTE
) {

424  
	`mb_¡¹ouµ”
(
$‹xt
);

428 
$‹xt
 = 
	`¡¹ouµ”
($text);

430 
$‹xt
 = 
	`´eg_»¶aû_ÿÎback
('/\xC3[\xA0-\xB6\xB8-\xBE]/', '_unicode_caseflip', $text);

431  
$‹xt
;

433 
	}
}

438 
funùiÚ
 
	$dru·l_¡¹Şow”
(
$‹xt
) {

439 
glob®
 
$muÉiby‹
;

440 ià(
$muÉiby‹
 =ğ
UNICODE_MULTIBYTE
) {

441  
	`mb_¡¹Şow”
(
$‹xt
);

445 
$‹xt
 = 
	`¡¹Şow”
($text);

447 
$‹xt
 = 
	`´eg_»¶aû_ÿÎback
('/\xC3[\x80-\x96\x98-\x9E]/', '_unicode_caseflip', $text);

448  
$‹xt
;

450 
	}
}

456 
funùiÚ
 
	$_unicode_ÿ£æ
(
$m©ches
) {

457  
$m©ches
[0][0] . 
	`chr
(
	`Üd
($matches[0][1]) ^ 32);

458 
	}
}

463 
funùiÚ
 
	$dru·l_ucfœ¡
(
$‹xt
) {

465  
	`dru·l_¡¹ouµ”
(
	`dru·l_sub¡r
(
$‹xt
, 0, 1)) . drupal_substr($text, 1);

466 
	}
}

476 
funùiÚ
 
	$dru·l_sub¡r
(
$‹xt
, 
$¡¬t
, 
$Ëngth
 = 
NULL
) {

477 
glob®
 
$muÉiby‹
;

478 ià(
$muÉiby‹
 =ğ
UNICODE_MULTIBYTE
) {

479  
$Ëngth
 ==ğ
NULL
 ? 
	`mb_sub¡r
(
$‹xt
, 
$¡¬t
) : mb_substr($text, $start, $length);

482 
$¡¾’
 = 
	`¡¾’
(
$‹xt
);

484 
$by‹s
 = 0;

485 ià(
$¡¬t
 > 0) {

488 
$by‹s
 = -1; 
$ch¬s
 = -1;

489 
$by‹s
 < 
$¡¾’
 && 
$ch¬s
 < 
$¡¬t
) {

490 
$by‹s
++;

491 
$c
 = 
	`Üd
(
$‹xt
[
$by‹s
]);

492 ià(
$c
 < 0x80 || $c >= 0xC0) {

493 
$ch¬s
++;

497 ià(
$¡¬t
 < 0) {

500 
$¡¬t
 = 
	`abs
($start);

501 
$by‹s
 = 
$¡¾’
; 
$ch¬s
 = 0;

502 
$by‹s
 > 0 && 
$ch¬s
 < 
$¡¬t
) {

503 
$by‹s
--;

504 
$c
 = 
	`Üd
(
$‹xt
[
$by‹s
]);

505 ià(
$c
 < 0x80 || $c >= 0xC0) {

506 
$ch¬s
++;

510 
$i¡¬t
 = 
$by‹s
;

513 ià(
$Ëngth
 ==ğ
NULL
) {

514 
$by‹s
 = 
$¡¾’
 - 1;

516 ià(
$Ëngth
 > 0) {

519 
$by‹s
 = 
$i¡¬t
; 
$ch¬s
 = 0;

520 
$by‹s
 < 
$¡¾’
 && 
$ch¬s
 < 
$Ëngth
) {

521 
$by‹s
++;

522 
$c
 = 
	`Üd
(
$‹xt
[
$by‹s
]);

523 ià(
$c
 < 0x80 || $c >= 0xC0) {

524 
$ch¬s
++;

527 
$by‹s
--;

529 ià(
$Ëngth
 < 0) {

532 
$Ëngth
 = 
	`abs
($length);

533 
$by‹s
 = 
$¡¾’
 - 1; 
$ch¬s
 = 0;

534 
$by‹s
 >ğ0 && 
$ch¬s
 < 
$Ëngth
) {

535 
$c
 = 
	`Üd
(
$‹xt
[
$by‹s
]);

536 ià(
$c
 < 0x80 || $c >= 0xC0) {

537 
$ch¬s
++;

539 
$by‹s
--;

542 
$›nd
 = 
$by‹s
;

544  
	`sub¡r
(
$‹xt
, 
$i¡¬t
, 
	`max
(0, 
$›nd
 - $istart + 1));

546 
	}
}

	@/srv/http/subs/notes/www/includes/xmlrpc.inc

1 <?
php


23 
funùiÚ
 
	$xmÌpc_v®ue
(
$d©a
, 
$ty³
 = 
FALSE
) {

24 
$xmÌpc_v®ue
 = 
Ãw
 
	`¡dCÏss
();

25 
$xmÌpc_v®ue
->
d©a
 = 
$d©a
;

26 ià(!
$ty³
) {

27 
$ty³
 = 
	`xmÌpc_v®ue_ÿlcuÏ‹_ty³
(
$xmÌpc_v®ue
);

29 
$xmÌpc_v®ue
->
ty³
 = 
$ty³
;

30 ià(
$ty³
 == 'struct') {

32 
	`fÜ—ch
 (
$xmÌpc_v®ue
->
d©a
 
as
 
$key
 => 
$v®ue
) {

33 
$xmÌpc_v®ue
->
d©a
[
$key
] = 
	`xmÌpc_v®ue
(
$v®ue
);

36 ià(
$ty³
 == 'array') {

37 
$i
 = 0, 
$j
 = 
	`couÁ
(
$xmÌpc_v®ue
->
d©a
); $i < $j; $i++) {

38 
$xmÌpc_v®ue
->
d©a
[
$i
] = 
	`xmÌpc_v®ue
($xmlrpc_value->data[$i]);

41  
$xmÌpc_v®ue
;

42 
	}
}

54 
funùiÚ
 
	$xmÌpc_v®ue_ÿlcuÏ‹_ty³
(&
$xmÌpc_v®ue
) {

56 ià(
	`is_boŞ
(
$xmÌpc_v®ue
->
d©a
)) {

59 ià(
	`is_doubË
(
$xmÌpc_v®ue
->
d©a
)) {

62 ià(
	`is_št
(
$xmÌpc_v®ue
->
d©a
)) {

65 ià(
	`is_¬¿y
(
$xmÌpc_v®ue
->
d©a
)) {

67  
	`em±y
(
$xmÌpc_v®ue
->
d©a
è|| 
	`¿nge
(0, 
	`couÁ
($xmÌpc_v®ue->d©aè- 1è==ğ
	`¬¿y_keys
($xmlrpc_value->data) ? 'array' : 'struct';

69 ià(
	`is_objeù
(
$xmÌpc_v®ue
->
d©a
)) {

70 ià(
$xmÌpc_v®ue
->
d©a
->
is_d©e
) {

73 ià(
$xmÌpc_v®ue
->
d©a
->
is_ba£64
) {

76 
$xmÌpc_v®ue
->
d©a
 = 
	`g‘_objeù_v¬s
($xmlrpc_value->data);

81 
	}
}

90 
funùiÚ
 
	$xmÌpc_v®ue_g‘_xml
(
$xmÌpc_v®ue
) {

91 
$xmÌpc_v®ue
->
ty³
) {

93  '<boŞ—n>'. ((
$xmÌpc_v®ue
->
d©a
) ? '1' : '0') .'</boolean>';

96  '<št>'. 
$xmÌpc_v®ue
->
d©a
 .'</int>';

99  '<doubË>'. 
$xmÌpc_v®ue
->
d©a
 .'</double>';

104  '<¡ršg>'. 
	`html¥ecŸlch¬s
(
$xmÌpc_v®ue
->
d©a
) .'</string>';

107 
$»tuº
 = '<array><data>'."\n";

108 
	`fÜ—ch
 (
$xmÌpc_v®ue
->
d©a
 
as
 
$™em
) {

109 
$»tuº
 .ğ' <v®ue>'. 
	`xmÌpc_v®ue_g‘_xml
(
$™em
) ."</value>\n";

111 
$»tuº
 .= '</data></array>';

112  
$»tuº
;

115 
$»tuº
 = '<struct>'."\n";

116 
	`fÜ—ch
 (
$xmÌpc_v®ue
->
d©a
 
as
 
$Çme
 => 
$v®ue
) {

117 
$»tuº
 .ğ" <memb”><Çme>". 
	`check_¶aš
(
$Çme
) ."</name><value>";

118 
$»tuº
 .ğ
	`xmÌpc_v®ue_g‘_xml
(
$v®ue
) ."</value></member>\n";

120 
$»tuº
 .= '</struct>';

121  
$»tuº
;

124  
	`xmÌpc_d©e_g‘_xml
(
$xmÌpc_v®ue
->
d©a
);

127  
	`xmÌpc_ba£64_g‘_xml
(
$xmÌpc_v®ue
->
d©a
);

130  
FALSE
;

131 
	}
}

141 
funùiÚ
 
	$xmÌpc_mes§ge
(
$mes§ge
) {

142 
$xmÌpc_mes§ge
 = 
Ãw
 
	`¡dCÏss
();

143 
$xmÌpc_mes§ge
->
¬¿y_¡ruùs
 = 
	`¬¿y
();

144 
$xmÌpc_mes§ge
->
¬¿y_¡ruùs_ty³s
 = 
	`¬¿y
();

145 
$xmÌpc_mes§ge
->
cu¼’t_¡ruù_Çme
 = 
	`¬¿y
();

146 
$xmÌpc_mes§ge
->
mes§ge
 = 
$mes§ge
;

147  
$xmÌpc_mes§ge
;

148 
	}
}

159 
funùiÚ
 
	$xmÌpc_mes§ge_·r£
(&
$xmÌpc_mes§ge
) {

160 
$xmÌpc_mes§ge
->
_·r£r
 = 
	`xml_·r£r_ü—‹
();

162 
	`xml_·r£r_£t_İtiÚ
(
$xmÌpc_mes§ge
->
_·r£r
, 
XML_OPTION_CASE_FOLDING
, 
FALSE
);

164 
	`xml_£t_–em’t_hªdËr
(
$xmÌpc_mes§ge
->
_·r£r
, 'xmlrpc_message_tag_open', 'xmlrpc_message_tag_close');

165 
	`xml_£t_ch¬aù”_d©a_hªdËr
(
$xmÌpc_mes§ge
->
_·r£r
, 'xmlrpc_message_cdata');

166 
	`xmÌpc_mes§ge_£t
(
$xmÌpc_mes§ge
);

167 ià(!
	`xml_·r£
(
$xmÌpc_mes§ge
->
_·r£r
, $xmÌpc_mes§ge->
mes§ge
)) {

168  
FALSE
;

170 
	`xml_·r£r_ä“
(
$xmÌpc_mes§ge
->
_·r£r
);

172 
$xmÌpc_mes§ge
 = 
	`xmÌpc_mes§ge_g‘
();

173 ià(!
	`is£t
(
$xmÌpc_mes§ge
->
mes§g‘y³
)) {

174  
FALSE
;

176 
	`–£if
 (
$xmÌpc_mes§ge
->
mes§g‘y³
 == 'fault') {

177 
$xmÌpc_mes§ge
->
çuÉ_code
 = $xmÌpc_mes§ge->
·¿ms
[0]['faultCode'];

178 
$xmÌpc_mes§ge
->
çuÉ_¡ršg
 = $xmÌpc_mes§ge->
·¿ms
[0]['faultString'];

180  
TRUE
;

181 
	}
}

191 
funùiÚ
 
	$xmÌpc_mes§ge_£t
(
$v®ue
 = 
NULL
) {

192 
$xmÌpc_mes§ge
;

193 ià(
$v®ue
) {

194 
$xmÌpc_mes§ge
 = 
$v®ue
;

196  
$xmÌpc_mes§ge
;

197 
	}
}

199 
funùiÚ
 
	$xmÌpc_mes§ge_g‘
() {

200  
	`xmÌpc_mes§ge_£t
();

201 
	}
}

203 
funùiÚ
 
	$xmÌpc_mes§ge_g_İ’
(
$·r£r
, 
$g
, 
$©Œ
) {

204 
$xmÌpc_mes§ge
 = 
	`xmÌpc_mes§ge_g‘
();

205 
$xmÌpc_mes§ge
->
cu¼’t_g_cÚ‹Ás
 = '';

206 
$xmÌpc_mes§ge
->
Ï¡_İ’
 = 
$g
;

207 
$g
) {

211 
$xmÌpc_mes§ge
->
mes§g‘y³
 = 
$g
;

215 
$xmÌpc_mes§ge
->
¬¿y_¡ruùs_ty³s
[] = 'array';

216 
$xmÌpc_mes§ge
->
¬¿y_¡ruùs
[] = 
	`¬¿y
();

219 
$xmÌpc_mes§ge
->
¬¿y_¡ruùs_ty³s
[] = 'struct';

220 
$xmÌpc_mes§ge
->
¬¿y_¡ruùs
[] = 
	`¬¿y
();

223 
	`xmÌpc_mes§ge_£t
(
$xmÌpc_mes§ge
);

224 
	}
}

226 
funùiÚ
 
	$xmÌpc_mes§ge_cd©a
(
$·r£r
, 
$cd©a
) {

227 
$xmÌpc_mes§ge
 = 
	`xmÌpc_mes§ge_g‘
();

228 
$xmÌpc_mes§ge
->
cu¼’t_g_cÚ‹Ás
 .ğ
$cd©a
;

229 
	`xmÌpc_mes§ge_£t
(
$xmÌpc_mes§ge
);

230 
	}
}

232 
funùiÚ
 
	$xmÌpc_mes§ge_g_şo£
(
$·r£r
, 
$g
) {

233 
$xmÌpc_mes§ge
 = 
	`xmÌpc_mes§ge_g‘
();

234 
$v®ue_æag
 = 
FALSE
;

235 
$g
) {

238 
$v®ue
 = ()
	`Œim
(
$xmÌpc_mes§ge
->
cu¼’t_g_cÚ‹Ás
);

239 
$v®ue_æag
 = 
TRUE
;

242 
$v®ue
 = ()
	`Œim
(
$xmÌpc_mes§ge
->
cu¼’t_g_cÚ‹Ás
);

243 
$v®ue_æag
 = 
TRUE
;

246 
$v®ue
 = 
$xmÌpc_mes§ge
->
cu¼’t_g_cÚ‹Ás
;

247 
$v®ue_æag
 = 
TRUE
;

250 
$v®ue
 = 
	`xmÌpc_d©e
(
	`Œim
(
$xmÌpc_mes§ge
->
cu¼’t_g_cÚ‹Ás
));

252 
$v®ue_æag
 = 
TRUE
;

257 ià(
	`Œim
(
$xmÌpc_mes§ge
->
cu¼’t_g_cÚ‹Ás
è!ğ'' || (
	`is£t
($xmÌpc_mes§ge->
Ï¡_İ’
) && ($xmlrpc_message->last_open == 'value'))) {

258 
$v®ue
 = (
¡ršg
)
$xmÌpc_mes§ge
->
cu¼’t_g_cÚ‹Ás
;

259 
$v®ue_æag
 = 
TRUE
;

261 
	`un£t
(
$xmÌpc_mes§ge
->
Ï¡_İ’
);

264 
$v®ue
 = (
boŞ—n
)
	`Œim
(
$xmÌpc_mes§ge
->
cu¼’t_g_cÚ‹Ás
);

265 
$v®ue_æag
 = 
TRUE
;

268 
$v®ue
 = 
	`ba£64_decode
(
	`Œim
(
$xmÌpc_mes§ge
->
cu¼’t_g_cÚ‹Ás
));

269 
$v®ue_æag
 = 
TRUE
;

274 
$v®ue
 = 
	`¬¿y_pİ
(
$xmÌpc_mes§ge
->
¬¿y_¡ruùs
 );

275 
	`¬¿y_pİ
(
$xmÌpc_mes§ge
->
¬¿y_¡ruùs_ty³s
);

276 
$v®ue_æag
 = 
TRUE
;

279 
	`¬¿y_pİ
(
$xmÌpc_mes§ge
->
cu¼’t_¡ruù_Çme
);

282 
$xmÌpc_mes§ge
->
cu¼’t_¡ruù_Çme
[] = 
	`Œim
($xmÌpc_mes§ge->
cu¼’t_g_cÚ‹Ás
);

285 
$xmÌpc_mes§ge
->
m‘hodÇme
 = 
	`Œim
($xmÌpc_mes§ge->
cu¼’t_g_cÚ‹Ás
);

288 ià(
$v®ue_æag
) {

289 ià(
	`couÁ
(
$xmÌpc_mes§ge
->
¬¿y_¡ruùs
 ) > 0) {

291 ià(
$xmÌpc_mes§ge
->
¬¿y_¡ruùs_ty³s
[
	`couÁ
($xmlrpc_message->array_structs_types)-1] == 'struct') {

293 
$xmÌpc_mes§ge
->
¬¿y_¡ruùs
 [
	`couÁ
($xmÌpc_mes§ge->¬¿y_¡ruù )-1][$xmÌpc_mes§ge->
cu¼’t_¡ruù_Çme
[couÁ($xmÌpc_mes§ge->cu¼’t_¡ruù_Çme)-1]] = 
$v®ue
;

297 
$xmÌpc_mes§ge
->
¬¿y_¡ruùs
 [
	`couÁ
($xmÌpc_mes§ge->¬¿y_¡ruù )-1][] = 
$v®ue
;

302 
$xmÌpc_mes§ge
->
·¿ms
[] = 
$v®ue
;

305 ià(!
	`š_¬¿y
(
$g
, 
	`¬¿y
("data", "struct", "member"))) {

306 
$xmÌpc_mes§ge
->
cu¼’t_g_cÚ‹Ás
 = '';

308 
	`xmÌpc_mes§ge_£t
(
$xmÌpc_mes§ge
);

309 
	}
}

321 
funùiÚ
 
	$xmÌpc_»que¡
(
$m‘hod
, 
$¬gs
) {

322 
$xmÌpc_»que¡
 = 
Ãw
 
	`¡dCÏss
();

323 
$xmÌpc_»que¡
->
m‘hod
 = 
$m‘hod
;

324 
$xmÌpc_»que¡
->
¬gs
 = 
$¬gs
;

325 
$xmÌpc_»que¡
->
xml
 = <<<
EOD


326 <?
xml
 
v”siÚ
="1.0"?>

327 <
m‘hodC®l
>

328 <
m‘hodName
>{
$xmÌpc_»que¡
->
m‘hod
}</methodName>

329 <
·¿ms
>

331 
EOD
;

332 
	`fÜ—ch
 (
$xmÌpc_»que¡
->
¬gs
 
as
 
$¬g
) {

333 
$xmÌpc_»que¡
->
xml
 .= '<param><value>';

334 
$v
 = 
	`xmÌpc_v®ue
(
$¬g
);

335 
$xmÌpc_»que¡
->
xml
 .ğ
	`xmÌpc_v®ue_g‘_xml
(
$v
);

336 
$xmÌpc_»que¡
->
xml
 .= "</value></param>\n";

338 
$xmÌpc_»que¡
->
xml
 .= '</params></methodCall>';

339  
$xmÌpc_»que¡
;

340 
	}
}

343 
funùiÚ
 
	$xmÌpc_”rÜ
(
$code
 = 
NULL
, 
$mes§ge
 = NULL, 
$»£t
 = 
FALSE
) {

344 
$xmÌpc_”rÜ
;

345 ià(
	`is£t
(
$code
)) {

346 
$xmÌpc_”rÜ
 = 
Ãw
 
	`¡dCÏss
();

347 
$xmÌpc_”rÜ
->
is_”rÜ
 = 
TRUE
;

348 
$xmÌpc_”rÜ
->
code
 = 
$code
;

349 
$xmÌpc_”rÜ
->
mes§ge
 = 
$mes§ge
;

351 
	`–£if
 (
$»£t
) {

352 
$xmÌpc_”rÜ
 = 
NULL
;

354  
$xmÌpc_”rÜ
;

355 
	}
}

357 
funùiÚ
 
	$xmÌpc_”rÜ_g‘_xml
(
$xmÌpc_”rÜ
) {

358  <<<
EOD


359 <
m‘hodRe¥Ú£
>

360 <
çuÉ
>

361 <
v®ue
>

363 <
memb”
>

364 <
Çme
>
çuÉCode
</name>

365 <
v®ue
><>{
$xmÌpc_”rÜ
->
code
}</></value>

366 </
memb”
>

367 <
memb”
>

368 <
Çme
>
çuÉSŒšg
</name>

369 <
v®ue
><
¡ršg
>{
$xmÌpc_”rÜ
->
mes§ge
}</string></value>

370 </
memb”
>

372 </
v®ue
>

373 </
çuÉ
>

374 </
m‘hodRe¥Ú£
>

376 
EOD
;

377 
	}
}

379 
funùiÚ
 
	$xmÌpc_d©e
(
$time
) {

380 
$xmÌpc_d©e
 = 
Ãw
 
	`¡dCÏss
();

381 
$xmÌpc_d©e
->
is_d©e
 = 
TRUE
;

383 ià(
	`is_num”ic
(
$time
)) {

384 
$xmÌpc_d©e
->
y—r
 = 
	`gmd©e
('Y', 
$time
);

385 
$xmÌpc_d©e
->
mÚth
 = 
	`gmd©e
('m', 
$time
);

386 
$xmÌpc_d©e
->
day
 = 
	`gmd©e
('d', 
$time
);

387 
$xmÌpc_d©e
->
hour
 = 
	`gmd©e
('H', 
$time
);

388 
$xmÌpc_d©e
->
mšu‹
 = 
	`gmd©e
('i', 
$time
);

389 
$xmÌpc_d©e
->
£cÚd
 = 
	`gmd©e
('s', 
$time
);

390 
$xmÌpc_d©e
->
iso8601
 = 
	`gmd©e
('Ymd\TH:i:s', 
$time
);

393 
$xmÌpc_d©e
->
iso8601
 = 
$time
;

394 
$time
 = 
	`¡r_»¶aû
(
	`¬¿y
('-', ':'), '', $time);

395 
$xmÌpc_d©e
->
y—r
 = 
	`sub¡r
(
$time
, 0, 4);

396 
$xmÌpc_d©e
->
mÚth
 = 
	`sub¡r
(
$time
, 4, 2);

397 
$xmÌpc_d©e
->
day
 = 
	`sub¡r
(
$time
, 6, 2);

398 
$xmÌpc_d©e
->
hour
 = 
	`sub¡r
(
$time
, 9, 2);

399 
$xmÌpc_d©e
->
mšu‹
 = 
	`sub¡r
(
$time
, 11, 2);

400 
$xmÌpc_d©e
->
£cÚd
 = 
	`sub¡r
(
$time
, 13, 2);

402  
$xmÌpc_d©e
;

403 
	}
}

405 
funùiÚ
 
	$xmÌpc_d©e_g‘_xml
(
$xmÌpc_d©e
) {

406  '<d©eTime.iso8601>'. 
$xmÌpc_d©e
->
y—r
 . $xmÌpc_d©e->
mÚth
 . $xmÌpc_d©e->
day
 .'T'. $xmÌpc_d©e->
hour
 .':'. $xmÌpc_d©e->
mšu‹
 .':'. $xmÌpc_d©e->
£cÚd
 .'</dateTime.iso8601>';

407 
	}
}

409 
funùiÚ
 
	$xmÌpc_ba£64
(
$d©a
) {

410 
$xmÌpc_ba£64
 = 
Ãw
 
	`¡dCÏss
();

411 
$xmÌpc_ba£64
->
is_ba£64
 = 
TRUE
;

412 
$xmÌpc_ba£64
->
d©a
 = 
$d©a
;

413  
$xmÌpc_ba£64
;

414 
	}
}

416 
funùiÚ
 
	$xmÌpc_ba£64_g‘_xml
(
$xmÌpc_ba£64
) {

417  '<ba£64>'. 
	`ba£64_’code
(
$xmÌpc_ba£64
->
d©a
) .'</base64>';

418 
	}
}

427 
funùiÚ
 
	$_xmÌpc
() {

428 
$¬gs
 = 
	`func_g‘_¬gs
();

429 
$u¾
 = 
	`¬¿y_shiá
(
$¬gs
);

430 
	`xmÌpc_ş—r_”rÜ
();

431 ià(
	`is_¬¿y
(
$¬gs
[0])) {

432 
$m‘hod
 = 'system.multicall';

433 
$muÉiÿÎ_¬gs
 = 
	`¬¿y
();

434 
	`fÜ—ch
 (
$¬gs
[0] 
as
 
$ÿÎ
) {

435 
$muÉiÿÎ_¬gs
[] = 
	`¬¿y
('m‘hodName' => 
	`¬¿y_shiá
(
$ÿÎ
), 'params' => $call);

437 
$¬gs
 = 
	`¬¿y
(
$muÉiÿÎ_¬gs
);

440 
$m‘hod
 = 
	`¬¿y_shiá
(
$¬gs
);

442 
$xmÌpc_»que¡
 = 
	`xmÌpc_»que¡
(
$m‘hod
, 
$¬gs
);

443 
$»suÉ
 = 
	`dru·l_h‰p_»que¡
(
$u¾
, 
	`¬¿y
("CÚ‹Á-Ty³" => "‹xt/xml"), 'POST', 
$xmÌpc_»que¡
->
xml
);

444 ià(
$»suÉ
->
code
 != 200) {

445 
	`xmÌpc_”rÜ
(
$»suÉ
->
code
, $»suÉ->
”rÜ
);

446  
FALSE
;

448 
$mes§ge
 = 
	`xmÌpc_mes§ge
(
$»suÉ
->
d©a
);

450 ià(!
	`xmÌpc_mes§ge_·r£
(
$mes§ge
)) {

452 
	`xmÌpc_”rÜ
(-32700, 
	`t
('Parseƒrror. Not well formed'));

453  
FALSE
;

456 ià(
$mes§ge
->
mes§g‘y³
 == 'fault') {

457 
	`xmÌpc_”rÜ
(
$mes§ge
->
çuÉ_code
, $mes§ge->
çuÉ_¡ršg
);

458  
FALSE
;

461  
$mes§ge
->
·¿ms
[0];

462 
	}
}

467 
funùiÚ
 
	$xmÌpc_”ºo
() {

468 
$”rÜ
 = 
	`xmÌpc_”rÜ
();

469  (
$”rÜ
 !ğ
NULL
 ? $”rÜ->
code
 : NULL);

470 
	}
}

475 
funùiÚ
 
	$xmÌpc_”rÜ_msg
() {

476 
$”rÜ
 = 
	`xmÌpc_”rÜ
();

477  (
$”rÜ
 !ğ
NULL
 ? $”rÜ->
mes§ge
 : NULL);

478 
	}
}

483 
funùiÚ
 
	$xmÌpc_ş—r_”rÜ
() {

484 
	`xmÌpc_”rÜ
(
NULL
, NULL, 
TRUE
);

485 
	}
}

	@/srv/http/subs/notes/www/includes/xmlrpcs.inc

1 <?
php


10 
funùiÚ
 
	$xmÌpc_£rv”
(
$ÿÎbacks
) {

11 
$xmÌpc_£rv”
 = 
Ãw
 
	`¡dCÏss
();

13 
$deçuÉs
 = 
	`¬¿y
(

15 
	`¬¿y
(

18 
	`¬¿y
('array', 'string'),

21 
	`¬¿y
(

24 
	`¬¿y
('struct'),

27 
	`¬¿y
(

30 
	`¬¿y
('array'),

32 
	`¬¿y
(

35 
	`¬¿y
('string', 'string'),

41 
	`fÜ—ch
 (
	`¬¿y_m”ge
(
$deçuÉs
, (
¬¿y
)
$ÿÎbacks
è
as
 
$key
 => 
$ÿÎback
) {

43 ià(
	`is_št
(
$key
)) {

44 
$m‘hod
 = 
$ÿÎback
[0];

45 
$xmÌpc_£rv”
->
ÿÎbacks
[
$m‘hod
] = 
$ÿÎback
[1];

46 
$xmÌpc_£rv”
->
sigÇtu»s
[
$m‘hod
] = 
$ÿÎback
[2];

47 
$xmÌpc_£rv”
->
h–p
[
$m‘hod
] = 
$ÿÎback
[3];

50 
$xmÌpc_£rv”
->
ÿÎbacks
[
$key
] = 
$ÿÎback
;

51 
$xmÌpc_£rv”
->
sigÇtu»s
[
$key
] = '';

52 
$xmÌpc_£rv”
->
h–p
[
$key
] = '';

56 
$d©a
 = 
	`fe_g‘_cÚ‹Ás
('php://input');

57 ià(!
$d©a
) {

58 
	`d›
('XML-RPC server‡ccepts POST„equests only.');

60 
$xmÌpc_£rv”
->
mes§ge
 = 
	`xmÌpc_mes§ge
(
$d©a
);

61 ià(!
	`xmÌpc_mes§ge_·r£
(
$xmÌpc_£rv”
->
mes§ge
)) {

62 
	`xmÌpc_£rv”_”rÜ
(-32700, 
	`t
('Parseƒrror. Request‚ot well formed.'));

64 ià(
$xmÌpc_£rv”
->
mes§ge
->
mes§g‘y³
 != 'methodCall') {

65 
	`xmÌpc_£rv”_”rÜ
(-32600, 
	`t
('Serverƒrror. Invalid XML-RPC. Request must be‡ methodCall.'));

67 ià(!
	`is£t
(
$xmÌpc_£rv”
->
mes§ge
->
·¿ms
)) {

68 
$xmÌpc_£rv”
->
mes§ge
->
·¿ms
 = 
	`¬¿y
();

70 
	`xmÌpc_£rv”_£t
(
$xmÌpc_£rv”
);

71 
$»suÉ
 = 
	`xmÌpc_£rv”_ÿÎ
(
$xmÌpc_£rv”
, $xmÌpc_£rv”->
mes§ge
->
m‘hodÇme
, $xmÌpc_£rv”->mes§ge->
·¿ms
);

73 ià(
	`is_objeù
(
$»suÉ
è&& !
	`em±y
($»suÉ->
is_”rÜ
)) {

74 
	`xmÌpc_£rv”_”rÜ
(
$»suÉ
);

77 
$r
 = 
	`xmÌpc_v®ue
(
$»suÉ
);

79 
$xml
 = '

80 <
m‘hodRe¥Ú£
>

81 <
·¿ms
>

82 <
·¿m
>

83 <
v®ue
>'.

84 
	`xmÌpc_v®ue_g‘_xml
(
$r
)

86 </
·¿m
>

87 </
·¿ms
>

88 </
m‘hodRe¥Ú£
>

92 
	`xmÌpc_£rv”_ouut
(
$xml
);

93 
	}
}

103 
funùiÚ
 
	$xmÌpc_£rv”_”rÜ
(
$”rÜ
, 
$mes§ge
 = 
FALSE
) {

104 ià(
$mes§ge
 && !
	`is_objeù
(
$”rÜ
)) {

105 
$”rÜ
 = 
	`xmÌpc_”rÜ
($”rÜ, 
$mes§ge
);

107 
	`xmÌpc_£rv”_ouut
(
	`xmÌpc_”rÜ_g‘_xml
(
$”rÜ
));

108 
	}
}

110 
funùiÚ
 
	$xmÌpc_£rv”_ouut
(
$xml
) {

111 
$xml
 = '<?xml version="1.0"?>'."\n". $xml;

112 
	`h—d”
('Connection: close');

113 
	`h—d”
('CÚ‹Á-L’gth: '. 
	`¡¾’
(
$xml
));

114 
	`h—d”
('Content-Type:ext/xml');

115 
	`h—d”
('D©e: '. 
	`d©e
('r'));

116 
echo
 
$xml
;

117 
ex™
;

118 
	}
}

126 
funùiÚ
 
	$xmÌpc_£rv”_£t
(
$xmÌpc_£rv”
 = 
NULL
) {

127 
$£rv”
;

128 ià(!
	`is£t
(
$£rv”
)) {

129 
$£rv”
 = 
$xmÌpc_£rv”
;

131  
$£rv”
;

132 
	}
}

135 
funùiÚ
 
	$xmÌpc_£rv”_g‘
() {

136  
	`xmÌpc_£rv”_£t
();

137 
	}
}

148 
funùiÚ
 
	$xmÌpc_£rv”_ÿÎ
(
$xmÌpc_£rv”
, 
$m‘hodÇme
, 
$¬gs
) {

150 ià(
$¬gs
 && !
	`is_¬¿y
($args)) {

151 
$¬gs
 = 
	`¬¿y
($args);

154 ià(!
	`is£t
(
$xmÌpc_£rv”
->
ÿÎbacks
[
$m‘hodÇme
])) {

155  
	`xmÌpc_”rÜ
(-32601, 
	`t
('S”v”ƒ¼Ü. Reque¡ed m‘hod @m‘hodÇmnÙ s³cif›d.', 
	`¬¿y
("@m‘hodÇme" => 
$xmÌpc_£rv”
->
mes§ge
->
m‘hodÇme
)));

157 
$m‘hod
 = 
$xmÌpc_£rv”
->
ÿÎbacks
[
$m‘hodÇme
];

158 
$sigÇtu»
 = 
$xmÌpc_£rv”
->
sigÇtu»s
[
$m‘hodÇme
];

161 ià(
	`is_¬¿y
(
$sigÇtu»
)) {

162 
$ok
 = 
TRUE
;

163 
$»tuº_ty³
 = 
	`¬¿y_shiá
(
$sigÇtu»
);

165 ià(
	`couÁ
(
$¬gs
è!ğcouÁ(
$sigÇtu»
)) {

166  
	`xmÌpc_”rÜ
(-32602, 
	`t
('Serverƒrror. Wrong‚umber of method…arameters.'));

169 
	`fÜ—ch
 (
$sigÇtu»
 
as
 
$key
 => 
$ty³
) {

170 
$¬g
 = 
$¬gs
[
$key
];

171 
$ty³
) {

174 ià(
	`is_¬¿y
(
$¬g
è|| !
	`is_št
($arg)) {

175 
$ok
 = 
FALSE
;

180 ià(!
	`is_¡ršg
(
$¬g
)) {

181 
$ok
 = 
FALSE
;

185 ià(
$¬g
 !=ğ
FALSE
 && $¬g !=ğ
TRUE
) {

186 
$ok
 = 
FALSE
;

191 ià(!
	`is_æßt
(
$¬g
)) {

192 
$ok
 = 
FALSE
;

197 ià(!
$¬g
->
is_d©e
) {

198 
$ok
 = 
FALSE
;

202 ià(!
$ok
) {

203  
	`xmÌpc_”rÜ
(-32602, 
	`t
('Serverƒrror. Invalid method…arameters.'));

208 ià(!
	`funùiÚ_exi¡s
(
$m‘hod
)) {

209  
	`xmÌpc_”rÜ
(-32601, 
	`t
('S”v”ƒ¼Ü. Reque¡ed funùiÚ @m‘hod dÛ nÙƒxi¡.', 
	`¬¿y
("@m‘hod" => 
$m‘hod
)));

212  
	`ÿÎ_u£r_func_¬¿y
(
$m‘hod
, 
$¬gs
);

213 
	}
}

215 
funùiÚ
 
	$xmÌpc_£rv”_muÉiÿÎ
(
$m‘hodÿÎs
) {

217 
$»tuº
 = 
	`¬¿y
();

218 
$xmÌpc_£rv”
 = 
	`xmÌpc_£rv”_g‘
();

219 
	`fÜ—ch
 (
$m‘hodÿÎs
 
as
 
$ÿÎ
) {

220 
$ok
 = 
TRUE
;

221 ià(!
	`is£t
(
$ÿÎ
['methodName']) || !isset($call['params'])) {

222 
$»suÉ
 = 
	`xmÌpc_”rÜ
(3, 
	`t
('Invalid syntax for system.multicall.'));

223 
$ok
 = 
FALSE
;

225 
$m‘hod
 = 
$ÿÎ
['methodName'];

226 
$·¿ms
 = 
$ÿÎ
['params'];

227 ià(
$m‘hod
 == 'system.multicall') {

228 
$»suÉ
 = 
	`xmÌpc_”rÜ
(-32600, 
	`t
('Recursive callso system.multicall‡re forbidden.'));

230 
	`–£if
 (
$ok
) {

231 
$»suÉ
 = 
	`xmÌpc_£rv”_ÿÎ
(
$xmÌpc_£rv”
, 
$m‘hod
, 
$·¿ms
);

233 ià(
	`is_objeù
(
$»suÉ
è&& !
	`em±y
($»suÉ->
is_”rÜ
)) {

234 
$»tuº
[] = 
	`¬¿y
(

235 'çuÉCode' => 
$»suÉ
->
code
,

236 'çuÉSŒšg' => 
$»suÉ
->
mes§ge


240 
$»tuº
[] = 
$»suÉ
;

243  
$»tuº
;

244 
	}
}

250 
funùiÚ
 
	$xmÌpc_£rv”_li¡_m‘hods
() {

251 
$xmÌpc_£rv”
 = 
	`xmÌpc_£rv”_g‘
();

252  
	`¬¿y_keys
(
$xmÌpc_£rv”
->
ÿÎbacks
);

253 
	}
}

259 
funùiÚ
 
	$xmÌpc_£rv”_g‘_ÿ·b™›s
() {

260  
	`¬¿y
(

261 'xmÌpc' => 
	`¬¿y
(

265 'çuÉs_š‹rİ' => 
	`¬¿y
(

269 'sy¡em.muÉiÿÎ' => 
	`¬¿y
(

273 'šŒo¥eùiÚ' => 
	`¬¿y
(

278 
	}
}

291 
funùiÚ
 
	$xmÌpc_£rv”_m‘hod_sigÇtu»
(
$m‘hodÇme
) {

292 
$xmÌpc_£rv”
 = 
	`xmÌpc_£rv”_g‘
();

293 ià(!
	`is£t
(
$xmÌpc_£rv”
->
ÿÎbacks
[
$m‘hodÇme
])) {

294  
	`xmÌpc_”rÜ
(-32601, 
	`t
('S”v”ƒ¼Ü. Reque¡ed m‘hod @m‘hodÇmnÙ s³cif›d.', 
	`¬¿y
("@m‘hodÇme" => 
$m‘hodÇme
)));

296 ià(!
	`is_¬¿y
(
$xmÌpc_£rv”
->
sigÇtu»s
[
$m‘hodÇme
])) {

297  
	`xmÌpc_”rÜ
(-32601, 
	`t
('S”v”ƒ¼Ü. Reque¡ed m‘hod @m‘hodÇmsigÇtu»‚Ù s³cif›d.', 
	`¬¿y
("@m‘hodÇme" => 
$m‘hodÇme
)));

300 
$»tuº
 = 
	`¬¿y
();

301 
	`fÜ—ch
 (
$xmÌpc_£rv”
->
sigÇtu»s
[
$m‘hodÇme
] 
as
 
$ty³
) {

302 
$»tuº
[] = 
$ty³
;

304  
$»tuº
;

305 
	}
}

313 
funùiÚ
 
	$xmÌpc_£rv”_m‘hod_h–p
(
$m‘hod
) {

314 
$xmÌpc_£rv”
 = 
	`xmÌpc_£rv”_g‘
();

315  
$xmÌpc_£rv”
->
h–p
[
$m‘hod
];

316 
	}
}

	@/srv/http/subs/notes/www/modules/aggregator/aggregator-feed-source.tpl.php

1 <?
	gphp


23 <
div
 
	gşass
="feed-source">

24 <?
php
 
´št
 
$sourû_icÚ
; ?>

25 <?
php
 
´št
 
	g$sourû_image
; ?>

26 <
div
 
	gşass
="feed-description">

27 <?
php
 
´št
 
$sourû_desütiÚ
; ?>

28 </
	gdiv
>

29 <
div
 
	gşass
="feed-url">

30 <
em
><?
php
 
´št
 
t
('URL:'); ?></
	gem
> <
a
 
	gh»f
="<?ph°´šˆ$sourû_u¾; ?>"><?ph°´šˆ
$sourû_u¾
; ?></
	ga
>

31 </
	gdiv
>

32 <
div
 
	gşass
="feed-updated">

33 <
em
><?
php
 
´št
 
t
('Upd©ed:'); ?></
	gem
> <?ph°´šˆ
	g$Ï¡_checked
; ?>

34 </
	gdiv
>

35 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/aggregator/aggregator-item.tpl.php

1 <?
	gphp


22 <
div
 
	gşass
="feed-item">

23 <
h3
 
şass
="feed-item-title">

24 <
a
 
h»f
="<?ph°´šˆ$ãed_u¾; ?>"><?
php
 
´št
 
$ãed_t™Ë
; ?></
	ga
>

25 </
	gh3
>

27 <
div
 
	gşass
="feed-item-meta">

28 <?
php
 ià(
$sourû_u¾
) : ?>

29 <
a
 
h»f
="<?ph°´šˆ$sourû_u¾; ?>" 
şass
="ãed-™em-sourû"><?
php
 
´št
 
$sourû_t™Ë
; ?></
	ga
> -

30 <?
php
 
	g’dif
; ?>

31 <
¥ª
 
	gşass
="ãed-™em-d©e"><?
php
 
´št
 
$sourû_d©e
; ?></
	g¥ª
>

32 </
	gdiv
>

34 <?
php
 ià(
	g$cÚ‹Á
) : ?>

35 <
div
 
şass
="feed-item-body">

36 <?
php
 
´št
 
$cÚ‹Á
; ?>

37 </
	gdiv
>

38 <?
php
 
	g’dif
; ?>

40 <?
php
 ià(
	g$ÿ‹gÜ›s
) : ?>

41 <
div
 
şass
="feed-item-categories">

42 <?
php
 
´št
 
t
('C©egÜ›s'); ?>: <?ph°´šˆ
im¶ode
(', ', 
$ÿ‹gÜ›s
); ?>

43 </
	gdiv
>

44 <?
php
 
	g’dif
 ;?>

46 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/aggregator/aggregator-summary-item.tpl.php

1 <?
	gphp


19 <
a
 
	gh»f
="<?ph°´šˆ$ãed_u¾; ?>"><?
php
 
´št
 
$ãed_t™Ë
; ?></
	ga
> <
¥ª
 
	gşass
="age"><?ph°´šˆ
$ãed_age
; ?></
	g¥ª
><?ph°ià(
	g$sourû_u¾
è: ?>, <¥ª cÏss="sourû"><¨
h»f
="<?ph°´šˆ$sourû_u¾; ?>"><?ph°´šˆ
$sourû_t™Ë
; ?></a></¥ª><?ph°
	g’dif
; ?>

	@/srv/http/subs/notes/www/modules/aggregator/aggregator-summary-items.tpl.php

1 <?
	gphp


20 <
	gh2
><?
php
 
´št
 
	g$t™Ë
; ?></h2>

21 <?
php
 
´št
 
	g$summ¬y_li¡
; ?>

22 <
div
 
	gşass
="links">

23 <
a
 
h»f
="<?ph°´šˆ$sourû_u¾; ?>"><?
php
 
´št
 
t
('MÜe'); ?></
	ga
>

24 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/aggregator/aggregator-wrapper.tpl.php

1 <?
	gphp


16 <
div
 
	gid
="aggregator">

17 <?
php
 
´št
 
$cÚ‹Á
; ?>

18 <?
php
 
´št
 
	g$·g”
; ?>

19 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/aggregator/aggregator.admin.inc

1 <?
php


12 
funùiÚ
 
	$agg»g©Ü_admš_ov”v›w
() {

13  
	`agg»g©Ü_v›w
();

14 
	}
}

22 
funùiÚ
 
	$agg»g©Ü_v›w
() {

23 
$»suÉ
 = 
	`db_qu”y
('SELECT f.*, COUNT(i.iid) AS items FROM {aggregator_feed} f LEFT JOIN {aggregator_item} i ON f.fid = i.fid GROUP BY f.fid, f.title, f.url, f.refresh, f.checked, f.link, f.description, f.etag, f.modified, f.image, f.block ORDER BY f.title');

25 
$ouut
 = '<h3>'. 
	`t
('Feed overview') .'</h3>';

27 
$h—d”
 = 
	`¬¿y
(
	`t
('Title'),('Items'),('Last update'),('Next update'),‡rray('data' =>('Operations'), 'colspan' => '3'));

28 
$rows
 = 
	`¬¿y
();

29 
$ãed
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

30 
$rows
[] = 
	`¬¿y
(
	`l
(
$ãed
->
t™Ë
, "agg»g©Ü/sourûs/$ãed->fid"), 
	`fÜm©_¶u¿l
($ãed->
™ems
, '1 i‹m', '@couÁ i‹ms'), ($ãed->
checked
 ? 
	`t
('@timago',‡¼ay('@time' => 
	`fÜm©_š‹rv®
(
	`time
(è- $ãed->checked))è:('Ãv”')), ($ãed->checked ?('%timËá',‡¼ay('%time' => fÜm©_š‹rv®($ãed->checked + $ãed->
»äesh
 -ime()))) :('never')),†(t('edit'), "admin/content/aggregator/edit/feed/$feed->fid"),†(t('remove items'), "admin/content/aggregator/remove/$feed->fid"),†(t('update items'), "admin/content/aggregator/update/$feed->fid"));

32 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

34 
$»suÉ
 = 
	`db_qu”y
('SELECT c.cid, c.title, count(ci.iid)‡s items FROM {aggregator_category} c LEFT JOIN {aggregator_category_item} ci ON c.cid = ci.cid GROUP BY c.cid, c.title ORDER BYitle');

36 
$ouut
 .ğ'<h3>'. 
	`t
('Category overview') .'</h3>';

38 
$h—d”
 = 
	`¬¿y
(
	`t
('Title'),('Items'),('Operations'));

39 
$rows
 = 
	`¬¿y
();

40 
$ÿ‹gÜy
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

41 
$rows
[] = 
	`¬¿y
(
	`l
(
$ÿ‹gÜy
->
t™Ë
, "agg»g©Ü/ÿ‹gÜ›s/$ÿ‹gÜy->cid"), 
	`fÜm©_¶u¿l
($ÿ‹gÜy->
™ems
, '1 i‹m', '@couÁ i‹ms'),†(
	`t
('edit'), "admin/content/aggregator/edit/category/$category->cid"));

43 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

45  
$ouut
;

46 
	}
}

55 
funùiÚ
 
agg»g©Ü_fÜm_ãed
(&
$fÜm_¡©e
, 
$ed™
 = 
¬¿y
('»äesh' => 900, 't™Ë' => '', 'u¾' => '', 'fid' => 
NULL
)) {

56 
$³riod
 = 
dru·l_m­_assoc
(
¬¿y
(900, 1800, 3600, 7200, 10800, 21600, 32400, 43200, 64800, 86400, 172800, 259200, 604800, 1209600, 2419200), 'format_interval');

58 ià(
	g$ed™
['refresh'] == '') {

59 
$ed™
['refresh'] = 3600;

62 
	g$fÜm
['t™Ë'] = 
¬¿y
('#type' => 'textfield',

63 '#t™Ë' => 
t
('Title'),

64 '#deçuÉ_v®ue' => 
$ed™
['title'],

66 '#desütiÚ' => 
t
('The‚ame ofhe feed (orhe‚ame ofhe website…rovidinghe feed).'),

67 '#»quœed' => 
TRUE
,

69 
	g$fÜm
['u¾'] = 
¬¿y
('#type' => 'textfield',

70 '#t™Ë' => 
t
('URL'),

71 '#deçuÉ_v®ue' => 
$ed™
['url'],

73 '#desütiÚ' => 
t
('The fully-qualified URL ofhe feed.'),

74 '#»quœed' => 
TRUE
,

76 
	g$fÜm
['»äesh'] = 
¬¿y
('#type' => 'select',

77 '#t™Ë' => 
t
('Update interval'),

78 '#deçuÉ_v®ue' => 
$ed™
['refresh'],

79 '#İtiÚs' => 
$³riod
,

80 '#desütiÚ' => 
t
('ThËngth oàtimb‘w“Àãed upd©es. (Requœe ¨cÜ»ùly cÚfigu»d <¨h»f="@üÚ">üÚ maš‹Çnûask</a>.)', 
¬¿y
('@üÚ' => 
u¾
('admin/reports/status'))),

84 
	g$İtiÚs
 = 
¬¿y
();

85 
	g$v®ues
 = 
¬¿y
();

86 
	g$ÿ‹gÜ›s
 = 
db_qu”y
('SELECT c.cid, c.t™Ë, f.fid FROM {agg»g©Ü_ÿ‹gÜy} c LEFT JOIN {agg»g©Ü_ÿ‹gÜy_ãed} f ON c.cid = f.cid AND f.fid = %d ORDER BY™Ë', 
$ed™
['fid']);

87 
	g$ÿ‹gÜy
 = 
db_ãtch_objeù
(
$ÿ‹gÜ›s
)) {

88 
$İtiÚs
[
$ÿ‹gÜy
->
cid
] = 
check_¶aš
($ÿ‹gÜy->
t™Ë
);

89 ià(
	g$ÿ‹gÜy
->
	gfid
è
	g$v®ues
[] = 
$ÿ‹gÜy
->
cid
;

91 ià(
	g$İtiÚs
) {

92 
	g$fÜm
['ÿ‹gÜy'] = 
¬¿y
('#type' => 'checkboxes',

93 '#t™Ë' => 
t
('Categorize‚ews items'),

94 '#deçuÉ_v®ue' => 
$v®ues
,

95 '#İtiÚs' => 
$İtiÚs
,

96 '#desütiÚ' => 
t
('New feed items‡re‡utomatically filed inhe checked categories.'),

99 
	g$fÜm
['subm™'] = 
¬¿y
('#ty³' => 'subm™', '#v®ue' => 
t
('Save'));

101 ià(
	g$ed™
['fid']) {

102 
	g$fÜm
['d–‘e'] = 
¬¿y
('#ty³' => 'subm™', '#v®ue' => 
t
('Delete'));

103 
	g$fÜm
['fid'] = 
¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$ed™
['fid']);

106  
	g$fÜm
;

112 
funùiÚ
 
	$agg»g©Ü_fÜm_ãed_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

113 ià(
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('Save')) {

115 ià(!
	`v®id_u¾
(
$fÜm_¡©e
['v®ues']['u¾'], 
TRUE
)) {

116 
	`fÜm_£t_”rÜ
('u¾', 
	`t
('ThURL %u¾ i šv®id. PËa£ƒÁ”‡ fuÎy-qu®if›d URL, such‡ h‰p://www.exam¶e.com/ãed.xml.', 
	`¬¿y
('%u¾' => 
$fÜm_¡©e
['values']['url'])));

119 ià(
	`is£t
(
$fÜm_¡©e
['values']['fid'])) {

120 
$»suÉ
 = 
	`db_qu”y
("SELECT™Ë, u¾ FROM {agg»g©Ü_ãed} WHERE (t™Ë = '%s' OR u¾ = '%s'èAND fid <> %d", 
$fÜm_¡©e
['values']['title'], $form_state['values']['url'], $form_state['values']['fid']);

123 
$»suÉ
 = 
	`db_qu”y
("SELECT™Ë, u¾ FROM {agg»g©Ü_ãed} WHERE™Ë = '%s' OR u¾ = '%s'", 
$fÜm_¡©e
['values']['title'], $form_state['values']['url']);

125 
$ãed
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

126 ià(
	`¡rÿ£cmp
(
$ãed
->
t™Ë
, 
$fÜm_¡©e
['values']['title']) == 0) {

127 
	`fÜm_£t_”rÜ
('t™Ë', 
	`t
('A f“d‚amed %ãed‡Ì—dyƒxi¡s. PËa£ƒÁ”‡ uniqut™Ë.', 
	`¬¿y
('%ãed' => 
$fÜm_¡©e
['values']['title'])));

129 ià(
	`¡rÿ£cmp
(
$ãed
->
u¾
, 
$fÜm_¡©e
['values']['url']) == 0) {

130 
	`fÜm_£t_”rÜ
('u¾', 
	`t
('A f“d w™hhi URL %u¾‡Ì—dyƒxi¡s. PËa£ƒÁ”‡ uniquURL.', 
	`¬¿y
('%u¾' => 
$fÜm_¡©e
['values']['url'])));

134 
	}
}

141 
funùiÚ
 
	$agg»g©Ü_fÜm_ãed_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

142 ià(
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('Delete')) {

143 
$t™Ë
 = 
$fÜm_¡©e
['values']['title'];

145 
	`un£t
(
$fÜm_¡©e
['values']['title']);

147 
	`agg»g©Ü_§ve_ãed
(
$fÜm_¡©e
['values']);

148 ià(
	`is£t
(
$fÜm_¡©e
['values']['fid'])) {

149 ià(
	`is£t
(
$fÜm_¡©e
['values']['title'])) {

150 
	`dru·l_£t_mes§ge
(
	`t
('Thãed %ãed ha b“Àupd©ed.', 
	`¬¿y
('%ãed' => 
$fÜm_¡©e
['values']['title'])));

151 ià(
	`¬g
(0) == 'admin') {

152 
$fÜm_¡©e
['redirect'] = 'admin/content/aggregator/';

156 
$fÜm_¡©e
['redirect'] = 'aggregator/sources/'. $form_state['values']['fid'];

161 
	`w©chdog
('agg»g©Ü', 'F“d %ãed d–‘ed.', 
	`¬¿y
('%ãed' => 
$t™Ë
));

162 
	`dru·l_£t_mes§ge
(
	`t
('Thãed %ãed ha b“Àd–‘ed.', 
	`¬¿y
('%ãed' => 
$t™Ë
)));

163 ià(
	`¬g
(0) == 'admin') {

164 
$fÜm_¡©e
['redirect'] = 'admin/content/aggregator/';

168 
$fÜm_¡©e
['redirect'] = 'aggregator/sources/';

174 
	`w©chdog
('agg»g©Ü', 'F“d %ãed‡dded.', 
	`¬¿y
('%ãed' => 
$fÜm_¡©e
['v®ues']['t™Ë']), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('view'), 'admin/content/aggregator'));

175 
	`dru·l_£t_mes§ge
(
	`t
('Thãed %ãed ha b“Àadded.', 
	`¬¿y
('%ãed' => 
$fÜm_¡©e
['values']['title'])));

177 
	}
}

179 
funùiÚ
 
	$agg»g©Ü_admš_»move_ãed
(
$fÜm_¡©e
, 
$ãed
) {

180  
	`cÚfœm_fÜm
(

181 
	`¬¿y
(

182 'ãed' => 
	`¬¿y
(

184 '#v®ue' => 
$ãed
,

187 
	`t
('A» you su» you wªˆtØ»mov®È™em äomhãed %ãed?', 
	`¬¿y
('%ãed' => 
$ãed
['title'])),

189 
	`t
('This‡ction cannot be undone.'),

190 
	`t
('Remove items'),

191 
	`t
('Cancel')

193 
	}
}

201 
funùiÚ
 
	$agg»g©Ü_admš_»move_ãed_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

202 
	`agg»g©Ü_»move
(
$fÜm_¡©e
['values']['feed']);

203 
$fÜm_¡©e
['redirect'] = 'admin/content/aggregator';

204 
	}
}

212 
funùiÚ
 
	$agg»g©Ü_admš_»äesh_ãed
(
$ãed
) {

213 
	`agg»g©Ü_»äesh
(
$ãed
);

214 
	`dru·l_gÙo
('admin/content/aggregator');

215 
	}
}

223 
funùiÚ
 
	$agg»g©Ü_admš_£‰šgs
() {

224 
$™ems
 = 
	`¬¿y
(0 => 
	`t
('nÚe')è+ 
	`dru·l_m­_assoc
(array(3, 5, 10, 15, 20, 25), '_aggregator_items');

225 
$³riod
 = 
	`dru·l_m­_assoc
(
	`¬¿y
(3600, 10800, 21600, 32400, 43200, 86400, 172800, 259200, 604800, 1209600, 2419200, 4838400, 9676800), 'format_interval');

227 
$fÜm
['agg»g©Ü_®lowed_html_gs'] = 
	`¬¿y
(

228 '#ty³' => '‹xtf›ld', '#t™Ë' => 
	`t
('Allowed HTMLags'), '#size' => 80, '#maxlength' => 255,

229 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('aggregator_allowed_html_tags', '<a> <b> <br> <dd> <dl> <dt> <em> <i> <li> <ol> <p> <strong> <u> <ul>'),

230 '#desütiÚ' => 
	`t
('A space-separated†ist of HTMLags‡llowed inhe content of feed items. (Tags inhis†ist‡re‚ot„emoved by Drupal.)')

233 
$fÜm
['agg»g©Ü_summ¬y_™ems'] = 
	`¬¿y
(

234 '#ty³' => '£Ëù', '#t™Ë' => 
	`t
('Items shown in sources‡nd categories…ages') ,

235 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('agg»g©Ü_summ¬y_™ems', 3), '#İtiÚs' => 
$™ems
,

236 '#desütiÚ' => 
	`t
('Number of feed items displayed in feed‡nd category summary…ages.')

239 
$fÜm
['agg»g©Ü_ş—r'] = 
	`¬¿y
(

240 '#ty³' => '£Ëù', '#t™Ë' => 
	`t
('Discard items olderhan'),

241 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('agg»g©Ü_ş—r', 9676800), '#İtiÚs' => 
$³riod
,

242 '#desütiÚ' => 
	`t
('ThËngth oàtimtØ»š f“d i‹m befÜdisÿrdšg. (Requœe ¨cÜ»ùly cÚfigu»d <¨h»f="@üÚ">üÚ maš‹Çnûask</a>.)', 
	`¬¿y
('@üÚ' => 
	`u¾
('admin/reports/status')))

245 
$fÜm
['agg»g©Ü_ÿ‹gÜy_£ËùÜ'] = 
	`¬¿y
(

246 '#ty³' => '¿dios', '#t™Ë' => 
	`t
('C©egÜy s–eùiÚy³'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('aggregator_category_selector', 'checkboxes'),

247 '#İtiÚs' => 
	`¬¿y
('checkboxes' => 
	`t
('checkboxes'), 'select' =>('multiple selector')),

248 '#desütiÚ' => 
	`t
('Theype of category selection widget displayed on categorization…ages. (For‡ small‚umber of categories, checkboxes‡reƒasiero use, while‡ multiple selector work well with†arge‚umbers of categories.)')

251  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

252 
	}
}

261 
funùiÚ
 
agg»g©Ü_fÜm_ÿ‹gÜy
(&
$fÜm_¡©e
, 
$ed™
 = 
¬¿y
('t™Ë' => '', 'desütiÚ' => '', 'cid' => 
NULL
)) {

262 
$fÜm
['t™Ë'] = 
¬¿y
('#type' => 'textfield',

263 '#t™Ë' => 
t
('Title'),

264 '#deçuÉ_v®ue' => 
$ed™
['title'],

266 '#»quœed' => 
TRUE
,

268 
	g$fÜm
['desütiÚ'] = 
¬¿y
('#type' => 'textarea',

269 '#t™Ë' => 
t
('Description'),

270 '#deçuÉ_v®ue' => 
$ed™
['description'],

272 
	g$fÜm
['subm™'] = 
¬¿y
('#ty³' => 'subm™', '#v®ue' => 
t
('Save'));

274 ià(
	g$ed™
['cid']) {

275 
	g$fÜm
['d–‘e'] = 
¬¿y
('#ty³' => 'subm™', '#v®ue' => 
t
('Delete'));

276 
	g$fÜm
['cid'] = 
¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$ed™
['cid']);

279  
	g$fÜm
;

285 
funùiÚ
 
	$agg»g©Ü_fÜm_ÿ‹gÜy_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

286 ià(
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('Save')) {

288 ià(
	`is£t
(
$fÜm_¡©e
['values']['cid'])) {

289 
$ÿ‹gÜy
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT cid FROM {agg»g©Ü_ÿ‹gÜy} WHERE™Ë = '%s' AND cid <> %d", 
$fÜm_¡©e
['values']['title'], $form_state['values']['cid']));

292 
$ÿ‹gÜy
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT cid FROM {agg»g©Ü_ÿ‹gÜy} WHERE™Ë = '%s'", 
$fÜm_¡©e
['values']['title']));

294 ià(
$ÿ‹gÜy
) {

295 
	`fÜm_£t_”rÜ
('t™Ë', 
	`t
('A c©egÜy‚amed %ÿ‹gÜy‡Ì—dyƒxi¡s. PËa£ƒÁ”‡ uniqut™Ë.', 
	`¬¿y
('%ÿ‹gÜy' => 
$fÜm_¡©e
['values']['title'])));

298 
	}
}

305 
funùiÚ
 
	$agg»g©Ü_fÜm_ÿ‹gÜy_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

306 ià(
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('Delete')) {

307 
$t™Ë
 = 
$fÜm_¡©e
['values']['title'];

309 
	`un£t
(
$fÜm_¡©e
['values']['title']);

311 
	`agg»g©Ü_§ve_ÿ‹gÜy
(
$fÜm_¡©e
['values']);

312 ià(
	`is£t
(
$fÜm_¡©e
['values']['cid'])) {

313 ià(
	`is£t
(
$fÜm_¡©e
['values']['title'])) {

314 
	`dru·l_£t_mes§ge
(
	`t
('Thÿ‹gÜy %ÿ‹gÜy ha b“Àupd©ed.', 
	`¬¿y
('%ÿ‹gÜy' => 
$fÜm_¡©e
['values']['title'])));

315 ià(
	`¬g
(0) == 'admin') {

316 
$fÜm_¡©e
['redirect'] = 'admin/content/aggregator/';

320 
$fÜm_¡©e
['redirect'] = 'aggregator/categories/'. $form_state['values']['cid'];

325 
	`w©chdog
('agg»g©Ü', 'C©egÜy %ÿ‹gÜy d–‘ed.', 
	`¬¿y
('%ÿ‹gÜy' => 
$t™Ë
));

326 
	`dru·l_£t_mes§ge
(
	`t
('Thÿ‹gÜy %ÿ‹gÜy ha b“Àd–‘ed.', 
	`¬¿y
('%ÿ‹gÜy' => 
$t™Ë
)));

327 ià(
	`¬g
(0) == 'admin') {

328 
$fÜm_¡©e
['redirect'] = 'admin/content/aggregator/';

332 
$fÜm_¡©e
['redirect'] = 'aggregator/categories/';

338 
	`w©chdog
('agg»g©Ü', 'C©egÜy %ÿ‹gÜy‡dded.', 
	`¬¿y
('%ÿ‹gÜy' => 
$fÜm_¡©e
['v®ues']['t™Ë']), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('view'), 'admin/content/aggregator'));

339 
	`dru·l_£t_mes§ge
(
	`t
('Thÿ‹gÜy %ÿ‹gÜy ha b“Àadded.', 
	`¬¿y
('%ÿ‹gÜy' => 
$fÜm_¡©e
['values']['title'])));

341 
	}
}

	@/srv/http/subs/notes/www/modules/aggregator/aggregator.module

1 <?
php


12 
funùiÚ
 
	$agg»g©Ü_h–p
(
$·th
, 
$¬g
) {

13 
$·th
) {

15 
$ouut
 = '<p>'. 
	`t
('Thagg»g©Ü i ¨pow”fuÈÚ-s™syndiÿtÜ‡nd‚ew »ad”h© g©h” äesh cÚ‹Á from RSS-, RDF-,‡nd Atom-ba£d f“d madavaabË‡üos thweb. Thou§nd oàs™e Õ¬ticuÏ¾y‚ew s™e ªd blogsèpublishheœ†©e¡ h—dlše ªd…o¡ š f“ds, usšg‡‚umb” oà¡ªd¬dized XML-ba£d fÜm©s. FÜm© suµÜ‹d byhagg»g©Ü inşud<¨h»f="@rss">RSS</a>, <¨h»f="@rdf">RDF</a>,‡nd <¨h»f="@©om">Atom</a>.', 
	`¬¿y
('@rss' => 'http://cyber.law.harvard.edu/rss/', '@rdf' => 'http://www.w3.org/RDF/', '@atom' => 'http://www.atomenabled.org')) .'</p>';

16 
$ouut
 .ğ'<p>'. 
	`t
('F“d cÚš f“d i‹ms, o¸šdividu®…o¡ published byhs™´ovidšghãed. F“d may bgrou³d iÀÿ‹gÜ›s, g’”®ly byİic. U£r v›w f“d i‹m šh<¨h»f="@agg»g©Ü">maš‡gg»g©Ü di¥Ïy</a> o¸by <¨h»f="@agg»g©Ü-sourûs">theœ sourû</a>. Admši¡¿tÜ ÿÀ<¨h»f="@ãeded™">add,ƒd™‡nd d–‘ãeds</a>‡nd choo£ how oá’Øcheckƒach f“d fÜ‚ewly upd©ed i‹ms. Thmo¡„eûÁ i‹m šƒ™h”‡ f“d o¸ÿ‹gÜy cª bdi¥Ïyed‡ ¨blockhroughh<¨h»f="@admš-block">block admši¡¿tiÚ…age</a>. A <¨h»f="@agg»g©Ü-İml">machše-»adabË OPML fe</a> oà®Èãed i avaabË. A cÜ»ùly cÚfigu»d <¨h»f="@üÚ">üÚ maš‹Çnûask</a> i »quœedØupd©ãed autom©iÿÎy.', 
	`¬¿y
('@agg»g©Ü' => 
	`u¾
('aggregator'), '@aggregator-sources' => url('aggregator/sources'), '@feededit' => url('admin/content/aggregator'), '@admin-block' => url('admin/build/block'), '@aggregator-opml' => url('aggregator/opml'), '@cron' => url('admin/reports/status'))) .'</p>';

17 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@agg»g©Ü">Agg»g©Ü moduË</a>.', 
	`¬¿y
('@aggregator' => 'http://drupal.org/handbook/modules/aggregator/')) .'</p>';

18  
$ouut
;

20 
$ouut
 = '<p>'. 
	`t
('Thou§nd oàs™e Õ¬ticuÏ¾y‚ew s™e ªd blogsèpublishheœ†©e¡ h—dlše ªd…o¡ š f“ds, usšg‡‚umb” oà¡ªd¬dized XML-ba£d fÜm©s. FÜm© suµÜ‹d byhagg»g©Ü inşud<¨h»f="@rss">RSS</a>, <¨h»f="@rdf">RDF</a>,‡nd <¨h»f="@©om">Atom</a>.', 
	`¬¿y
('@rss' => 'http://cyber.law.harvard.edu/rss/', '@rdf' => 'http://www.w3.org/RDF/', '@atom' => 'http://www.atomenabled.org')) .'</p>';

21 
$ouut
 .ğ'<p>'. 
	`t
('Cu¼’ˆãed ¬li¡ed b–ow,‡nd <¨h»f="@addãed">Ãw f“d may badded</a>. FÜƒach f“d o¸ãed c©egÜy,h<em>Ï‹¡ i‹ms</em> block may b’abËd‡ˆth<¨h»f="@block">block admši¡¿tiÚ…age</a>.', 
	`¬¿y
('@addãed' => 
	`u¾
('admin/content/aggregator/add/feed'), '@block' => url('admin/build/block'))) .'</p>';

22  
$ouut
;

24  '<p>'. 
	`t
('Add‡ feed in RSS, RDF or Atom format. A feed may only have oneƒntry.') .'</p>';

26  '<p>'. 
	`t
('Categories‡llow feed items from different feedso be groupedogether. Forƒxample, several sport-related feeds may belongo‡ category‚amed <em>Sports</em>. Feed items may be grouped‡utomatically (by selecting‡ category when creating orƒditing‡ feed) or manually (viahe <em>Categorize</em>…age‡vailable from feed item†istings). Each category…rovides its own feed…age‡nd block.') .'</p>';

28 
	}
}

33 
funùiÚ
 
	$agg»g©Ü_theme
() {

34  
	`¬¿y
(

35 'agg»g©Ü_w¿µ”' => 
	`¬¿y
(

36 '¬gum’ts' => 
	`¬¿y
('cÚ‹Á' => 
NULL
),

40 'agg»g©Ü_ÿ‹gÜize_™ems' => 
	`¬¿y
(

41 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

44 'agg»g©Ü_ãed_sourû' => 
	`¬¿y
(

45 '¬gum’ts' => 
	`¬¿y
('ãed' => 
NULL
),

49 'agg»g©Ü_block_™em' => 
	`¬¿y
(

50 '¬gum’ts' => 
	`¬¿y
('™em' => 
NULL
, 'feed' => 0),

52 'agg»g©Ü_summ¬y_™ems' => 
	`¬¿y
(

53 '¬gum’ts' => 
	`¬¿y
('summ¬y_™ems' => 
NULL
, 'source' => NULL),

57 'agg»g©Ü_summ¬y_™em' => 
	`¬¿y
(

58 '¬gum’ts' => 
	`¬¿y
('™em' => 
NULL
),

62 'agg»g©Ü_™em' => 
	`¬¿y
(

63 '¬gum’ts' => 
	`¬¿y
('™em' => 
NULL
),

67 'agg»g©Ü_·ge_İml' => 
	`¬¿y
(

68 '¬gum’ts' => 
	`¬¿y
('ãeds' => 
NULL
),

71 'agg»g©Ü_·ge_rss' => 
	`¬¿y
(

72 '¬gum’ts' => 
	`¬¿y
('ãeds' => 
NULL
, 'category' => NULL),

76 
	}
}

81 
funùiÚ
 
	$agg»g©Ü_m’u
() {

82 
$™ems
['admš/cÚ‹Á/agg»g©Ü'] = 
	`¬¿y
(

86 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚ews feeds'),

89 
$™ems
['admš/cÚ‹Á/agg»g©Ü/add/ãed'] = 
	`¬¿y
(

92 '·g¬gum’ts' => 
	`¬¿y
('aggregator_form_feed'),

93 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚ews feeds'),

94 'ty³' => 
MENU_LOCAL_TASK
,

98 
$™ems
['admš/cÚ‹Á/agg»g©Ü/add/ÿ‹gÜy'] = 
	`¬¿y
(

101 '·g¬gum’ts' => 
	`¬¿y
('aggregator_form_category'),

102 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚ews feeds'),

103 'ty³' => 
MENU_LOCAL_TASK
,

107 
$™ems
['admš/cÚ‹Á/agg»g©Ü/»move/%agg»g©Ü_ãed'] = 
	`¬¿y
(

110 '·g¬gum’ts' => 
	`¬¿y
('aggregator_admin_remove_feed', 4),

111 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚ews feeds'),

112 'ty³' => 
MENU_CALLBACK
,

115 
$™ems
['admš/cÚ‹Á/agg»g©Ü/upd©e/%agg»g©Ü_ãed'] = 
	`¬¿y
(

118 '·g¬gum’ts' => 
	`¬¿y
(4),

119 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚ews feeds'),

120 'ty³' => 
MENU_CALLBACK
,

123 
$™ems
['admš/cÚ‹Á/agg»g©Ü/li¡'] = 
	`¬¿y
(

125 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

128 
$™ems
['admš/cÚ‹Á/agg»g©Ü/£‰šgs'] = 
	`¬¿y
(

131 '·g¬gum’ts' => 
	`¬¿y
('aggregator_admin_settings'),

132 'ty³' => 
MENU_LOCAL_TASK
,

134 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚ews feeds'),

137 
$™ems
['agg»g©Ü'] = 
	`¬¿y
(

140 'acûs ¬gum’ts' => 
	`¬¿y
('access‚ews feeds'),

144 
$™ems
['agg»g©Ü/sourûs'] = 
	`¬¿y
(

147 'acûs ¬gum’ts' => 
	`¬¿y
('access‚ews feeds'),

150 
$™ems
['agg»g©Ü/ÿ‹gÜ›s'] = 
	`¬¿y
(

156 
$™ems
['agg»g©Ü/rss'] = 
	`¬¿y
(

159 'acûs ¬gum’ts' => 
	`¬¿y
('access‚ews feeds'),

160 'ty³' => 
MENU_CALLBACK
,

163 
$™ems
['agg»g©Ü/İml'] = 
	`¬¿y
(

166 'acûs ¬gum’ts' => 
	`¬¿y
('access‚ews feeds'),

167 'ty³' => 
MENU_CALLBACK
,

170 
$™ems
['agg»g©Ü/ÿ‹gÜ›s/%agg»g©Ü_ÿ‹gÜy'] = 
	`¬¿y
(

172 't™Ë‡rgum’ts' => 
	`¬¿y
(2),

174 '·g¬gum’ts' => 
	`¬¿y
(2),

176 'acûs ¬gum’ts' => 
	`¬¿y
('access‚ews feeds'),

179 
$™ems
['agg»g©Ü/ÿ‹gÜ›s/%agg»g©Ü_ÿ‹gÜy/v›w'] = 
	`¬¿y
(

181 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

184 
$™ems
['agg»g©Ü/ÿ‹gÜ›s/%agg»g©Ü_ÿ‹gÜy/ÿ‹gÜize'] = 
	`¬¿y
(

187 '·g¬gum’ts' => 
	`¬¿y
('aggregator_page_category', 2),

188 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚ews feeds'),

189 'ty³' => 
MENU_LOCAL_TASK
,

192 
$™ems
['agg»g©Ü/ÿ‹gÜ›s/%agg»g©Ü_ÿ‹gÜy/cÚfigu»'] = 
	`¬¿y
(

195 '·g¬gum’ts' => 
	`¬¿y
('aggregator_form_category', 2),

196 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚ews feeds'),

197 'ty³' => 
MENU_LOCAL_TASK
,

201 
$™ems
['agg»g©Ü/sourûs/%agg»g©Ü_ãed'] = 
	`¬¿y
(

203 '·g¬gum’ts' => 
	`¬¿y
(2),

204 'acûs ¬gum’ts' => 
	`¬¿y
('access‚ews feeds'),

205 'ty³' => 
MENU_CALLBACK
,

208 
$™ems
['agg»g©Ü/sourûs/%agg»g©Ü_ãed/v›w'] = 
	`¬¿y
(

210 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

213 
$™ems
['agg»g©Ü/sourûs/%agg»g©Ü_ãed/ÿ‹gÜize'] = 
	`¬¿y
(

216 '·g¬gum’ts' => 
	`¬¿y
('aggregator_page_source', 2),

217 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚ews feeds'),

218 'ty³' => 
MENU_LOCAL_TASK
,

221 
$™ems
['agg»g©Ü/sourûs/%agg»g©Ü_ãed/cÚfigu»'] = 
	`¬¿y
(

224 '·g¬gum’ts' => 
	`¬¿y
('aggregator_form_feed', 2),

225 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚ews feeds'),

226 'ty³' => 
MENU_LOCAL_TASK
,

230 
$™ems
['admš/cÚ‹Á/agg»g©Ü/ed™/ãed/%agg»g©Ü_ãed'] = 
	`¬¿y
(

233 '·g¬gum’ts' => 
	`¬¿y
('aggregator_form_feed', 5),

234 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚ews feeds'),

235 'ty³' => 
MENU_CALLBACK
,

238 
$™ems
['admš/cÚ‹Á/agg»g©Ü/ed™/ÿ‹gÜy/%agg»g©Ü_ÿ‹gÜy'] = 
	`¬¿y
(

241 '·g¬gum’ts' => 
	`¬¿y
('aggregator_form_category', 5),

242 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚ews feeds'),

243 'ty³' => 
MENU_CALLBACK
,

247  
$™ems
;

248 
	}
}

256 
funùiÚ
 
	$_agg»g©Ü_ÿ‹gÜy_t™Ë
(
$ÿ‹gÜy
) {

257  
$ÿ‹gÜy
['title'];

258 
	}
}

263 
funùiÚ
 
	$agg»g©Ü_š™
() {

264 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'aggregator') .'/aggregator.css');

265 
	}
}

273 
funùiÚ
 
	$_agg»g©Ü_has_ÿ‹gÜ›s
() {

274  
	`u£r_acûss
('acûs Ãw ãeds'è&& 
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(*) FROM {aggregator_category}'));

275 
	}
}

280 
funùiÚ
 
	$agg»g©Ü_³rm
() {

281  
	`¬¿y
('administer‚ews feeds', 'access‚ews feeds');

282 
	}
}

289 
funùiÚ
 
	$agg»g©Ü_üÚ
() {

290 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {agg»g©Ü_ãed} WHERE checked +„eäesh < %d', 
	`time
());

291 
$ãed
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

292 
	`agg»g©Ü_»äesh
(
$ãed
);

294 
	}
}

301 
funùiÚ
 
agg»g©Ü_block
(
$İ
 = 'li¡', 
$d–
 = 0, 
$ed™
 = 
	$¬¿y
()) {

302 ià(
	`u£r_acûss
('access‚ews feeds')) {

303 ià(
$İ
 == 'list') {

304 
$»suÉ
 = 
	`db_qu”y
('SELECT cid,itle FROM {aggregator_category} ORDER BYitle');

305 
$ÿ‹gÜy
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

306 
$block
['ÿ‹gÜy-'. 
$ÿ‹gÜy
->
cid
]['šfo'] = 
	`t
('!t™Ë c©egÜy†©e¡ i‹ms', 
	`¬¿y
('!t™Ë' => $ÿ‹gÜy->
t™Ë
));

308 
$»suÉ
 = 
	`db_qu”y
('SELECT fid,itle FROM {aggregator_feed} ORDER BY fid');

309 
$ãed
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

310 
$block
['ãed-'. 
$ãed
->
fid
]['šfo'] = 
	`t
('!t™Ë f“d†©e¡ i‹ms', 
	`¬¿y
('!t™Ë' => $ãed->
t™Ë
));

313 ià(
$İ
 == 'configure') {

314 
	`li¡
(
$ty³
, 
$id
èğ
	`ex¶ode
('-', 
$d–
);

315 ià(
$ty³
 == 'category') {

316 
$v®ue
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT block FROM {agg»g©Ü_ÿ‹gÜy} WHERE cid = %d', 
$id
));

319 
$v®ue
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT block FROM {agg»g©Ü_ãed} WHERE fid = %d', 
$id
));

321 
$fÜm
['block'] = 
	`¬¿y
('#ty³' => '£Ëù', '#t™Ë' => 
	`t
('Numb” oàÃw ™em š block'), '#deçuÉ_v®ue' => 
$v®ue
, '#İtiÚs' => 
	`dru·l_m­_assoc
(array(2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)));

322  
$fÜm
;

324 ià(
$İ
 == 'save') {

325 
	`li¡
(
$ty³
, 
$id
èğ
	`ex¶ode
('-', 
$d–
);

326 ià(
$ty³
 == 'category') {

327 
$v®ue
 = 
	`db_qu”y
('UPDATE {agg»g©Ü_ÿ‹gÜy} SET block = %d WHERE cid = %d', 
$ed™
['block'], 
$id
);

330 
$v®ue
 = 
	`db_qu”y
('UPDATE {agg»g©Ü_ãed} SET block = %d WHERE fid = %d', 
$ed™
['block'], 
$id
);

333 ià(
$İ
 == 'view') {

334 
	`li¡
(
$ty³
, 
$id
èğ
	`ex¶ode
('-', 
$d–
);

335 
$ty³
) {

337 ià(
$ãed
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT fid,™Ë, block FROM {agg»g©Ü_ãed} WHERE fid = %d', 
$id
))) {

338 
$block
['subjeù'] = 
	`check_¶aš
(
$ãed
->
t™Ë
);

339 
$»suÉ
 = 
	`db_qu”y_¿nge
('SELECT * FROM {agg»g©Ü_™em} WHERE fid = %d ORDER BYime¡am°DESC, iid DESC', 
$ãed
->
fid
, 0, $ãed->
block
);

340 
$»ad_mÜe
 = 
	`theme
('mÜe_lšk', 
	`u¾
('agg»g©Ü/sourûs/'. 
$ãed
->
fid
), 
	`t
("Viewhis feed's„ecent‚ews."));

345 ià(
$ÿ‹gÜy
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT cid,™Ë, block FROM {agg»g©Ü_ÿ‹gÜy} WHERE cid = %d', 
$id
))) {

346 
$block
['subjeù'] = 
	`check_¶aš
(
$ÿ‹gÜy
->
t™Ë
);

347 
$»suÉ
 = 
	`db_qu”y_¿nge
('SELECT i.* FROM {agg»g©Ü_ÿ‹gÜy_™em} c˜LEFT JOIN {agg»g©Ü_™em} i ON ci.iid = i.iid WHERE ci.cid = %d ORDER BY i.time¡am°DESC, i.iid DESC', 
$ÿ‹gÜy
->
cid
, 0, $ÿ‹gÜy->
block
);

348 
$»ad_mÜe
 = 
	`theme
('mÜe_lšk', 
	`u¾
('agg»g©Ü/ÿ‹gÜ›s/'. 
$ÿ‹gÜy
->
cid
), 
	`t
("Viewhis category's„ecent‚ews."));

352 
$™ems
 = 
	`¬¿y
();

353 
$™em
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

354 
$™ems
[] = 
	`theme
('agg»g©Ü_block_™em', 
$™em
);

358 ià(
	`couÁ
(
$™ems
) > 0) {

359 
$block
['cÚ‹Á'] = 
	`theme
('™em_li¡', 
$™ems
è. 
$»ad_mÜe
;

362 ià(
	`is£t
(
$block
)) {

363  
$block
;

366 
	}
}

374 
funùiÚ
 
	$agg»g©Ü_§ve_ÿ‹gÜy
(
$ed™
) {

375 
$lšk_·th
 = 'aggregator/categories/';

376 ià(!
	`em±y
(
$ed™
['cid'])) {

377 
$lšk_·th
 .ğ
$ed™
['cid'];

378 ià(!
	`em±y
(
$ed™
['title'])) {

379 
	`db_qu”y
("UPDATE {agg»g©Ü_ÿ‹gÜy} SET™Ë = '%s', desütiÚ = '%s' WHERE cid = %d", 
$ed™
['title'], $edit['description'], $edit['cid']);

380 
$İ
 = 'update';

383 
	`db_qu”y
('DELETE FROM {agg»g©Ü_ÿ‹gÜy} WHERE cid = %d', 
$ed™
['cid']);

385 
	`db_qu”y
("DELETE FROM {blocks} WHERE moduË = '%s' AND d– = '%s'", 'agg»g©Ü', 'ÿ‹gÜy-' . 
$ed™
['cid']);

386 
$ed™
['title'] = '';

387 
$İ
 = 'delete';

390 ià(!
	`em±y
(
$ed™
['title'])) {

392 
	`db_qu”y
("INSERT INTO {agg»g©Ü_ÿ‹gÜy} (t™Ë, desütiÚ, blockèVALUES ('%s', '%s', 5)", 
$ed™
['title'], $edit['description']);

393 
$lšk_·th
 .ğ
	`db_Ï¡_š£¹_id
('aggregator_category', 'cid');

394 
$İ
 = 'insert';

396 ià(
	`is£t
(
$İ
)) {

397 
	`m’u_lšk_mašš
('agg»g©Ü', 
$İ
, 
$lšk_·th
, 
$ed™
['title']);

399 
	}
}

407 
funùiÚ
 
	$agg»g©Ü_§ve_ãed
(
$ed™
) {

408 ià(!
	`em±y
(
$ed™
['fid'])) {

410 
	`db_qu”y
('DELETE FROM {agg»g©Ü_ÿ‹gÜy_ãed} WHERE fid = %d', 
$ed™
['fid']);

412 ià(!
	`em±y
(
$ed™
['fid']) && !empty($edit['title'])) {

413 
	`db_qu”y
("UPDATE {agg»g©Ü_ãed} SET™Ë = '%s', u¾ = '%s',„eäesh = %d WHERE fid = %d", 
$ed™
['title'], $edit['url'], $edit['refresh'], $edit['fid']);

415 ià(!
	`em±y
(
$ed™
['fid'])) {

416 
$™ems
 = 
	`¬¿y
();

417 
$»suÉ
 = 
	`db_qu”y
('SELECT iid FROM {agg»g©Ü_™em} WHERE fid = %d', 
$ed™
['fid']);

418 
$™em
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

419 
$™ems
[] = "iid = $item->iid";

421 ià(!
	`em±y
(
$™ems
)) {

422 
	`db_qu”y
('DELETE FROM {agg»g©Ü_ÿ‹gÜy_™em} WHERE '. 
	`im¶ode
(' OR ', 
$™ems
));

424 
	`db_qu”y
('DELETE FROM {agg»g©Ü_ãed} WHERE fid = %d', 
$ed™
['fid']);

425 
	`db_qu”y
('DELETE FROM {agg»g©Ü_™em} WHERE fid = %d', 
$ed™
['fid']);

427 
	`db_qu”y
("DELETE FROM {blocks} WHERE moduË = '%s' AND d– = '%s'", 'agg»g©Ü', 'ãed-' . 
$ed™
['fid']);

429 ià(!
	`em±y
(
$ed™
['title'])) {

430 
	`db_qu”y
("INSERT INTO {agg»g©Ü_ãed} (t™Ë, u¾,„eäesh, block, desütiÚ, imageèVALUES ('%s', '%s', %d, 5, '', '')", 
$ed™
['title'], $edit['url'], $edit['refresh']);

432 
$ed™
['fid'] = 
	`db_Ï¡_š£¹_id
('aggregator_feed', 'fid');

434 ià(!
	`em±y
(
$ed™
['title'])) {

436 ià(!
	`em±y
(
$ed™
['category'])) {

437 
	`fÜ—ch
 (
$ed™
['ÿ‹gÜy'] 
as
 
$cid
 => 
$v®ue
) {

438 ià(
$v®ue
) {

439 
	`db_qu”y
('INSERT INTO {agg»g©Ü_ÿ‹gÜy_ãed} (fid, cidèVALUES (%d, %d)', 
$ed™
['fid'], 
$cid
);

444 
	}
}

452 
funùiÚ
 
	$agg»g©Ü_»move
(
$ãed
) {

453 
$»suÉ
 = 
	`db_qu”y
('SELECT iid FROM {agg»g©Ü_™em} WHERE fid = %d', 
$ãed
['fid']);

454 
$™em
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

455 
$™ems
[] = "iid = $item->iid";

457 ià(!
	`em±y
(
$™ems
)) {

458 
	`db_qu”y
('DELETE FROM {agg»g©Ü_ÿ‹gÜy_™em} WHERE '. 
	`im¶ode
(' OR ', 
$™ems
));

460 
	`db_qu”y
('DELETE FROM {agg»g©Ü_™em} WHERE fid = %d', 
$ãed
['fid']);

461 
	`db_qu”y
("UPDATE {agg»g©Ü_ãed} SET checked = 0,ƒg = '', modif›d = 0 WHERE fid = %d", 
$ãed
['fid']);

462 
	`dru·l_£t_mes§ge
(
	`t
('ThÃw ™em äom %s™havb“À»moved.', 
	`¬¿y
('%s™e' => 
$ãed
['title'])));

463 
	}
}

468 
funùiÚ
 
	$agg»g©Ü_–em’t_¡¬t
(
$·r£r
, 
$Çme
, 
$©Œibu‹s
) {

469 
glob®
 
$™em
, 
$–em’t
, 
$g
, 
$™ems
, 
$chªÃl
;

471 
$Çme
) {

480 
$–em’t
 = 
$Çme
;

483 ià(
$–em’t
 != 'ITEM') {

484 
$–em’t
 = 
$Çme
;

487 ià(!
	`em±y
(
$©Œibu‹s
['REL']) && $attributes['REL'] == 'alternate') {

488 ià(
$–em’t
 == 'ITEM') {

489 
$™ems
[
$™em
]['LINK'] = 
$©Œibu‹s
['HREF'];

492 
$chªÃl
['LINK'] = 
$©Œibu‹s
['HREF'];

497 
$–em’t
 = 
$Çme
;

498 
$™em
 += 1;

501 
$–em’t
 = 'ITEM';

502 
$™em
 += 1;

506 
$g
 = 
$Çme
;

507 
	}
}

512 
funùiÚ
 
	$agg»g©Ü_–em’t_’d
(
$·r£r
, 
$Çme
) {

513 
glob®
 
$–em’t
;

515 
$Çme
) {

522 
$–em’t
 = '';

525 ià(
$–em’t
 == 'ID') {

526 
$–em’t
 = '';

529 
	}
}

534 
funùiÚ
 
	$agg»g©Ü_–em’t_d©a
(
$·r£r
, 
$d©a
) {

535 
glob®
 
$chªÃl
, 
$–em’t
, 
$™ems
, 
$™em
, 
$image
, 
$g
;

536 
$™ems
 +ğ
	`¬¿y
(
$™em
 =>‡rray());

537 
$–em’t
) {

539 
$™ems
[
$™em
] +ğ
	`¬¿y
(
$g
 => '');

540 
$™ems
[
$™em
][
$g
] .ğ
$d©a
;

544 
$image
 +ğ
	`¬¿y
(
$g
 => '');

545 
$image
[
$g
] .ğ
$d©a
;

548 ià(
$d©a
) {

549 
$™ems
[
$™em
] +ğ
	`¬¿y
(
$g
 => '');

550 
$™ems
[
$™em
][
$g
] .ğ
$d©a
;

554 
$™ems
[
$™em
] +ğ
	`¬¿y
('CONTENT' => '');

555 
$™ems
[
$™em
]['CONTENT'] .ğ
$d©a
;

558 
$™ems
[
$™em
] +ğ
	`¬¿y
('SUMMARY' => '');

559 
$™ems
[
$™em
]['SUMMARY'] .ğ
$d©a
;

563 
$chªÃl
 +ğ
	`¬¿y
('DESCRIPTION' => '');

564 
$chªÃl
['DESCRIPTION'] .ğ
$d©a
;

573 
$chªÃl
 +ğ
	`¬¿y
(
$g
 => '');

574 
$chªÃl
[
$g
] .ğ
$d©a
;

576 
	}
}

584 
funùiÚ
 
	$agg»g©Ü_»äesh
(
$ãed
) {

585 
glob®
 
$chªÃl
, 
$image
;

588 
$h—d”s
 = 
	`¬¿y
();

589 ià(
$ãed
['etag']) {

590 
$h—d”s
['If-NÚe-M©ch'] = 
$ãed
['etag'];

592 ià(
$ãed
['modified']) {

593 
$h—d”s
['If-Modif›d-Sšû'] = 
	`gmd©e
('D, d M Y H:i:s', 
$ãed
['modified']) .' GMT';

597 
$»suÉ
 = 
	`dru·l_h‰p_»que¡
(
$ãed
['u¾'], 
$h—d”s
);

600 
$»suÉ
->
code
) {

602 
	`db_qu”y
('UPDATE {agg»g©Ü_ãed} SET checked = %d WHERE fid = %d', 
	`time
(), 
$ãed
['fid']);

603 
	`dru·l_£t_mes§ge
(
	`t
('Th”i nØÃw syndiÿ‹d cÚ‹Á from %s™e.', 
	`¬¿y
('%s™e' => 
$ãed
['title'])));

606 
$ãed
['u¾'] = 
$»suÉ
->
»dœeù_u¾
;

607 
	`w©chdog
('agg»g©Ü', 'Upd©ed URL fÜ f“d %t™ËØ%u¾.', 
	`¬¿y
('%t™Ë' => 
$ãed
['title'], '%url' => $feed['url']));

613 ià(
	`agg»g©Ü_·r£_ãed
(
$»suÉ
->
d©a
, 
$ãed
)) {

614 
$modif›d
 = 
	`em±y
(
$»suÉ
->
h—d”s
['La¡-Modif›d']è? 0 : 
	`¡¹Ùime
($result->headers['Last-Modified']);

617 
	`fÜ—ch
 (
$chªÃl
 
as
 
$key
 => 
$v®ue
) {

618 
$chªÃl
[
$key
] = 
	`Œim
(
$v®ue
);

622 
	`fÜ—ch
 (
$image
 
as
 
$key
 => 
$v®ue
) {

623 
$image
[
$key
] = 
	`Œim
(
$v®ue
);

626 ià(!
	`em±y
(
$image
['LINK']) && !empty($image['URL']) && !empty($image['TITLE'])) {

628 
$image
 = '<¨h»f="'. 
	`check_u¾
($image['LINK']è.'" cÏss="ãed-image"><img src="'. check_u¾($image['URL']è.'"‡É="'. 
	`check_¶aš
($image['TITLE']) .'" /></a>';

631 
$image
 = 
NULL
;

634 
$‘ag
 = 
	`em±y
(
$»suÉ
->
h—d”s
['ETag']) ? '' : $result->headers['ETag'];

636 
	`db_qu”y
("UPDATE {agg»g©Ü_ãed} SET u¾ = '%s', checked = %d,†šk = '%s', desütiÚ = '%s', imagğ'%s',ƒg = '%s', modif›d = %d WHERE fid = %d", 
$ãed
['u¾'], 
	`time
(), 
$chªÃl
['LINK'], $chªÃl['DESCRIPTION'], 
$image
, 
$‘ag
, 
$modif›d
, $feed['fid']);

639 
	`ÿche_ş—r_®l
();

641 
	`w©chdog
('agg»g©Ü', 'Th”i Ãw syndiÿ‹d cÚ‹Á from %s™e.', 
	`¬¿y
('%s™e' => 
$ãed
['title']));

642 
	`dru·l_£t_mes§ge
(
	`t
('Th”i Ãw syndiÿ‹d cÚ‹Á from %s™e.', 
	`¬¿y
('%s™e' => 
$ãed
['title'])));

646 
	`w©chdog
('agg»g©Ü', 'Thãed from %s™£em tØbbrok’, dutØ"%”rÜ".', 
	`¬¿y
('%s™e' => 
$ãed
['t™Ë'], '%”rÜ' => 
$»suÉ
->
code
 .' '. $»suÉ->
”rÜ
), 
WATCHDOG_WARNING
);

647 
	`dru·l_£t_mes§ge
(
	`t
('Thãed from %s™£em tØbbrok’, beÿu£ oà”rÜ "%”rÜ".', 
	`¬¿y
('%s™e' => 
$ãed
['t™Ë'], '%”rÜ' => 
$»suÉ
->
code
 .' '. $»suÉ->
”rÜ
)));

649 
	}
}

662 
funùiÚ
 
	$agg»g©Ü_·r£_w3cdtf
(
$d©e_¡r
) {

663 ià(
	`´eg_m©ch
('/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2})(:(\d{2}))?(?:([-+])(\d{2}):?(\d{2})|(Z))?/', 
$d©e_¡r
, 
$m©ch
)) {

664 
	`li¡
(
$y—r
, 
$mÚth
, 
$day
, 
$hours
, 
$mšu‹s
, 
$£cÚds
èğ
	`¬¿y
(
$m©ch
[1], $match[2], $match[3], $match[4], $match[5], $match[6]);

666 
$•och
 = 
	`gmmktime
(
$hours
, 
$mšu‹s
, 
$£cÚds
, 
$mÚth
, 
$day
, 
$y—r
);

667 ià(
$m©ch
[10] != 'Z') {

668 
	`li¡
(
$tz_mod
, 
$tz_hour
, 
$tz_mš
èğ
	`¬¿y
(
$m©ch
[8], $match[9], $match[10]);

670 ià(!
$tz_hour
) {

671 
$tz_hour
 = 0;

673 ià(!
$tz_mš
) {

674 
$tz_mš
 = 0;

676 
$off£t_£cs
 = ((
$tz_hour
 * 60è+ 
$tz_mš
) * 60;

678 ià(
$tz_mod
 == '+') {

679 
$off£t_£cs
 *= -1;

681 
$•och
 +ğ
$off£t_£cs
;

683  
$•och
;

686  
FALSE
;

688 
	}
}

700 
funùiÚ
 
	$agg»g©Ü_·r£_ãed
(&
$d©a
, 
$ãed
) {

701 
glob®
 
$™ems
, 
$image
, 
$chªÃl
;

704 
	`un£t
(
$GLOBALS
['element'], $GLOBALS['item'], $GLOBALS['tag']);

705 
$™ems
 = 
	`¬¿y
();

706 
$image
 = 
	`¬¿y
();

707 
$chªÃl
 = 
	`¬¿y
();

710 
$xml_·r£r
 = 
	`dru·l_xml_·r£r_ü—‹
(
$d©a
);

711 
	`xml_£t_–em’t_hªdËr
(
$xml_·r£r
, 'aggregator_element_start', 'aggregator_element_end');

712 
	`xml_£t_ch¬aù”_d©a_hªdËr
(
$xml_·r£r
, 'aggregator_element_data');

714 ià(!
	`xml_·r£
(
$xml_·r£r
, 
$d©a
, 1)) {

715 
	`w©chdog
('agg»g©Ü', 'Thãed from %s™£em tØbbrok’, dutØªƒ¼Ü "%”rÜ" oÀlš%lše.', 
	`¬¿y
('%s™e' => 
$ãed
['t™Ë'], '%”rÜ' => 
	`xml_”rÜ_¡ršg
(
	`xml_g‘_”rÜ_code
(
$xml_·r£r
)), '%lše' => 
	`xml_g‘_cu¼’t_lše_numb”
($xml_·r£r)), 
WATCHDOG_WARNING
);

716 
	`dru·l_£t_mes§ge
(
	`t
('Thãed from %s™£em tØbbrok’, beÿu£ oà”rÜ "%”rÜ" oÀlš%lše.', 
	`¬¿y
('%s™e' => 
$ãed
['t™Ë'], '%”rÜ' => 
	`xml_”rÜ_¡ršg
(
	`xml_g‘_”rÜ_code
(
$xml_·r£r
)), '%lše' => 
	`xml_g‘_cu¼’t_lše_numb”
($xml_parser))), 'error');

719 
	`xml_·r£r_ä“
(
$xml_·r£r
);

723 
$™ems
 = 
	`¬¿y_»v”£
($items);

726 
$t™Ë
 = 
$lšk
 = 
$authÜ
 = 
$desütiÚ
 = 
$guid
 = 
NULL
;

727 
	`fÜ—ch
 (
$™ems
 
as
 
$™em
) {

728 
	`un£t
(
$t™Ë
, 
$lšk
, 
$authÜ
, 
$desütiÚ
, 
$guid
);

731 
	`fÜ—ch
 (
$™em
 
as
 
$key
 => 
$v®ue
) {

732 
$™em
[
$key
] = 
	`Œim
(
$v®ue
);

738 ià(!
	`em±y
(
$™em
['TITLE'])) {

739 
$t™Ë
 = 
$™em
['TITLE'];

741 
	`–£if
 (!
	`em±y
(
$™em
['DESCRIPTION'])) {

742 
$t™Ë
 = 
	`´eg_»¶aû
('/^(.*)[^\w;&].*?$/', "\\1", 
	`Œunÿ‹_utf8
(
$™em
['DESCRIPTION'], 40));

745 
$t™Ë
 = '';

749 ià(!
	`em±y
(
$™em
['LINK'])) {

750 
$lšk
 = 
$™em
['LINK'];

753 
$lšk
 = 
$ãed
['link'];

755 
$guid
 = 
	`is£t
(
$™em
['GUID']) ? $item['GUID'] : '';

758 ià(!
	`em±y
(
$™em
['CONTENT:ENCODED'])) {

759 
$™em
['DESCRIPTION'] = $item['CONTENT:ENCODED'];

761 ià(!
	`em±y
(
$™em
['SUMMARY'])) {

762 
$™em
['DESCRIPTION'] = $item['SUMMARY'];

764 ià(!
	`em±y
(
$™em
['CONTENT'])) {

765 
$™em
['DESCRIPTION'] = $item['CONTENT'];

770 
$d©e
 = 'now';

771 
	`fÜ—ch
 (
	`¬¿y
('PUBDATE', 'DC:DATE', 'DCTERMS:ISSUED', 'DCTERMS:CREATED', 'DCTERMS:MODIFIED', 'ISSUED', 'CREATED', 'MODIFIED', 'PUBLISHED', 'UPDATED'è
as
 
$key
) {

772 ià(!
	`em±y
(
$™em
[
$key
])) {

773 
$d©e
 = 
$™em
[
$key
];

778 
$time¡amp
 = 
	`¡¹Ùime
(
$d©e
);

779 ià(
$time¡amp
 <= 0) {

780 
$time¡amp
 = 
	`agg»g©Ü_·r£_w3cdtf
(
$d©e
);

781 ià(!
$time¡amp
) {

782 
$time¡amp
 = 
	`time
();

789 ià(!
	`em±y
(
$guid
)) {

790 
$’Œy
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT iid FROM {agg»g©Ü_™em} WHERE fid = %d AND guid = '%s'", 
$ãed
['fid'], 
$guid
));

792 ià(
$lšk
 && $lšk !ğ
$ãed
['link'] && $link != $feed['url']) {

793 
$’Œy
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT iid FROM {agg»g©Ü_™em} WHERE fid = %d AND†šk = '%s'", 
$ãed
['fid'], 
$lšk
));

796 
$’Œy
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT iid FROM {agg»g©Ü_™em} WHERE fid = %d AND™Ë = '%s'", 
$ãed
['fid'], 
$t™Ë
));

798 
$™em
 +ğ
	`¬¿y
('AUTHOR' => '', 'DESCRIPTION' => '');

799 
	`agg»g©Ü_§ve_™em
(
	`¬¿y
('iid' => (
	`is£t
(
$’Œy
->
iid
è? $’Œy->iid: ''), 'fid' => 
$ãed
['fid'], 'time¡amp' => 
$time¡amp
, 't™Ë' => 
$t™Ë
, 'lšk' => 
$lšk
, 'authÜ' => 
$™em
['AUTHOR'], 'desütiÚ' => $™em['DESCRIPTION'], 'guid' => 
$guid
));

803 
$age
 = 
	`time
(è- 
	`v¬ŸbË_g‘
('aggregator_clear', 9676800);

804 
$»suÉ
 = 
	`db_qu”y
('SELECT iid FROM {agg»g©Ü_™em} WHERE fid = %d ANDime¡am°< %d', 
$ãed
['fid'], 
$age
);

806 
$™ems
 = 
	`¬¿y
();

807 
$num_rows
 = 
FALSE
;

808 
$™em
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

809 
$™ems
[] = 
$™em
->
iid
;

810 
$num_rows
 = 
TRUE
;

812 ià(
$num_rows
) {

813 
	`db_qu”y
('DELETE FROM {agg»g©Ü_ÿ‹gÜy_™em} WHERE iid IN ('. 
	`im¶ode
(', ', 
$™ems
) .')');

814 
	`db_qu”y
('DELETE FROM {agg»g©Ü_™em} WHERE fid = %d ANDime¡am°< %d', 
$ãed
['fid'], 
$age
);

818 
	}
}

826 
funùiÚ
 
	$agg»g©Ü_§ve_™em
(
$ed™
) {

827 ià(
$ed™
['iid'] && $edit['title']) {

828 
	`db_qu”y
("UPDATE {agg»g©Ü_™em} SET™Ë = '%s',†šk = '%s',‡uthÜ = '%s', desütiÚ = '%s', guid = '%s',ime¡am°ğ%d WHERE iid = %d", 
$ed™
['title'], $edit['link'], $edit['author'], $edit['description'], $edit['guid'], $edit['timestamp'], $edit['iid']);

830 ià(
$ed™
['iid']) {

831 
	`db_qu”y
('DELETE FROM {agg»g©Ü_™em} WHERE iid = %d', 
$ed™
['iid']);

832 
	`db_qu”y
('DELETE FROM {agg»g©Ü_ÿ‹gÜy_™em} WHERE iid = %d', 
$ed™
['iid']);

834 ià(
$ed™
['title'] && $edit['link']) {

835 
	`db_qu”y
("INSERT INTO {agg»g©Ü_™em} (fid,™Ë,†šk,‡uthÜ, desütiÚ,ime¡amp, guidèVALUES (%d, '%s', '%s', '%s', '%s', %d, '%s')", 
$ed™
['fid'], $edit['title'], $edit['link'], $edit['author'], $edit['description'], $edit['timestamp'], $edit['guid']);

836 
$ed™
['iid'] = 
	`db_Ï¡_š£¹_id
('aggregator_item', 'iid');

838 
$ÿ‹gÜ›s
 = 
	`db_qu”y
('SELECT cid FROM {agg»g©Ü_ÿ‹gÜy_ãed} WHERE fid = %d', 
$ed™
['fid']);

839 
$ÿ‹gÜy
 = 
	`db_ãtch_objeù
(
$ÿ‹gÜ›s
)) {

840 
	`db_qu”y
('INSERT INTO {agg»g©Ü_ÿ‹gÜy_™em} (cid, iidèVALUES (%d, %d)', 
$ÿ‹gÜy
->
cid
, 
$ed™
['iid']);

843 
	}
}

853 
funùiÚ
 
	$agg»g©Ü_ãed_lßd
(
$fid
) {

854 
$ãeds
;

855 ià(!
	`is£t
(
$ãeds
[
$fid
])) {

856 
$ãeds
[
$fid
] = 
	`db_ãtch_¬¿y
(
	`db_qu”y
('SELECT * FROM {aggregator_feed} WHERE fid = %d', $fid));

858  
$ãeds
[
$fid
];

859 
	}
}

869 
funùiÚ
 
	$agg»g©Ü_ÿ‹gÜy_lßd
(
$cid
) {

870 
$ÿ‹gÜ›s
;

871 ià(!
	`is£t
(
$ÿ‹gÜ›s
[
$cid
])) {

872 
$ÿ‹gÜ›s
[
$cid
] = 
	`db_ãtch_¬¿y
(
	`db_qu”y
('SELECT * FROM {aggregator_category} WHERE cid = %d', $cid));

874  
$ÿ‹gÜ›s
[
$cid
];

875 
	}
}

888 
funùiÚ
 
	$theme_agg»g©Ü_block_™em
(
$™em
, 
$ãed
 = 0) {

889 
glob®
 
$u£r
;

891 
$ouut
 = '';

892 ià(
$u£r
->
uid
 && 
	`moduË_exi¡s
('blog'è&& 
	`u£r_acûss
('create blogƒntries')) {

893 ià(
$image
 = 
	`theme
('image', 'misc/blog.²g', 
	`t
('blog it'),('blog it'))) {

894 
$ouut
 .ğ'<div cÏss="icÚ">'. 
	`l
(
$image
, 'node/add/blog', 
	`¬¿y
('©Œibu‹s' =>‡¼ay('t™Ë' => 
	`t
('Comm’ˆÚhi Ãw ™em iÀyou¸³rsÚ® blog.'), 'şass' => 'blog-™'), 'qu”y' => "iid=$™em->iid", 'html' => 
TRUE
)) .'</div>';

899 
$ouut
 .ğ'<¨h»f="'. 
	`check_u¾
(
$™em
->
lšk
è.'">'. 
	`check_¶aš
($™em->
t™Ë
) ."</a>\n";

901  
$ouut
;

902 
	}
}

912 
funùiÚ
 
	$agg»g©Ü_f‹r_xss
(
$v®ue
) {

913  
	`f‹r_xss
(
$v®ue
, 
	`´eg_¥l™
('/\s+|<|>/', 
	`v¬ŸbË_g‘
('agg»g©Ü_®lowed_html_gs', '<a> <b> <br> <dd> <dl> <dt> <em> <i> <li> <Ş> <p> <¡rÚg> <u> <ul>'), -1, 
PREG_SPLIT_NO_EMPTY
));

914 
	}
}

924 
funùiÚ
 
	$_agg»g©Ü_™ems
(
$couÁ
) {

925  
	`fÜm©_¶u¿l
(
$couÁ
, '1 item', '@count items');

926 
	}
}

	@/srv/http/subs/notes/www/modules/aggregator/aggregator.pages.inc

1 <?
php


15 
funùiÚ
 
	$agg»g©Ü_·ge_Ï¡
() {

16 
	`dru·l_add_ãed
(
	`u¾
('agg»g©Ü/rss'), 
	`v¬ŸbË_g‘
('s™e_Çme', 'Dru·l'è.' '. 
	`t
('aggregator'));

18 
$™ems
 = 
	`agg»g©Ü_ãed_™ems_lßd
('SELECT i.*, f.title AS ftitle, f.link AS flink FROM {aggregator_item} i INNER JOIN {aggregator_feed} f ON i.fid = f.fid ORDER BY i.timestamp DESC, i.iid DESC');

20  
	`_agg»g©Ü_·ge_li¡
(
$™ems
, 
	`¬g
(1));

21 
	}
}

35 
funùiÚ
 
	$agg»g©Ü_·ge_sourû
(
$¬g1
, 
$¬g2
 = 
NULL
) {

38 
$ãed
 = 
	`is_¬¿y
(
$¬g2
è? $¬g2 : 
$¬g1
;

39 
$ãed
 = (
objeù
)$feed;

40 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$ãed
->
t™Ë
));

41 
$ãed_sourû
 = 
	`theme
('agg»g©Ü_ãed_sourû', 
$ãed
);

45 
$™ems
 = 
	`agg»g©Ü_ãed_™ems_lßd
('SELECT * FROM {agg»g©Ü_™em} WHERE fid = '. 
$ãed
->
fid
 .' ORDER BYimestamp DESC, iid DESC');

47  
	`_agg»g©Ü_·ge_li¡
(
$™ems
, 
	`¬g
(3), 
$ãed_sourû
);

48 
	}
}

62 
funùiÚ
 
	$agg»g©Ü_·ge_ÿ‹gÜy
(
$¬g1
, 
$¬g2
 = 
NULL
) {

65 
$ÿ‹gÜy
 = 
	`is_¬¿y
(
$¬g2
è? $¬g2 : 
$¬g1
;

67 
	`dru·l_add_ãed
(
	`u¾
('agg»g©Ü/rss/'. 
$ÿ‹gÜy
['cid']), 
	`v¬ŸbË_g‘
('s™e_Çme', 'Dru·l'è.' '. 
	`t
('agg»g©Ü - @t™Ë', 
	`¬¿y
('@title' => $category['title'])));

71 
$™ems
 = 
	`agg»g©Ü_ãed_™ems_lßd
('SELECT i.*, f.t™Ë AS ft™Ë, f.lšk AS flšk FROM {agg»g©Ü_ÿ‹gÜy_™em} c LEFT JOIN {agg»g©Ü_™em} i ON c.iid = i.iid LEFT JOIN {agg»g©Ü_ãed} f ON i.fid = f.fid WHERE cid = '. 
$ÿ‹gÜy
['cid'] .' ORDER BYimestamp DESC, i.iid DESC');

73  
	`_agg»g©Ü_·ge_li¡
(
$™ems
, 
	`¬g
(3));

74 
	}
}

84 
funùiÚ
 
	$agg»g©Ü_ãed_™ems_lßd
(
$sql
) {

85 
$™ems
 = 
	`¬¿y
();

86 ià(
	`is£t
(
$sql
)) {

87 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
, 20);

88 
$™em
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

89 
$»suÉ_ÿ‹gÜy
 = 
	`db_qu”y
('SELECT c.t™Ë, c.cid FROM {agg»g©Ü_ÿ‹gÜy_™em} c˜LEFT JOIN {agg»g©Ü_ÿ‹gÜy} c ON ci.cid = c.cid WHERE ci.iid = %d ORDER BY c.t™Ë', 
$™em
->
iid
);

90 
$™em
->
ÿ‹gÜ›s
 = 
	`¬¿y
();

91 
$™em_ÿ‹gÜ›s
 = 
	`db_ãtch_objeù
(
$»suÉ_ÿ‹gÜy
)) {

92 
$™em
->
ÿ‹gÜ›s
[] = 
$™em_ÿ‹gÜ›s
;

94 
$™ems
[
$™em
->
iid
] = $item;

97  
$™ems
;

98 
	}
}

114 
funùiÚ
 
_agg»g©Ü_·ge_li¡
(
$™ems
, 
$İ
, 
$ãed_sourû
 = '') {

115 ià(
u£r_acûss
('admši¡”‚ew ãeds'è&& (
$İ
 == 'categorize')) {

117 
$ouut
 = 
agg»g©Ü_ÿ‹gÜize_™ems
(
$™ems
, 
$ãed_sourû
);

121 
	g$ouut
 = 
$ãed_sourû
;

122 
fÜ—ch
 (
$™ems
 
as
 
$™em
) {

123 
	g$ouut
 .ğ
theme
('agg»g©Ü_™em', 
$™em
);

125 
	g$ouut
 = 
theme
('agg»g©Ü_w¿µ”', 
$ouut
);

127  
	g$ouut
;

143 
funùiÚ
 
agg»g©Ü_ÿ‹gÜize_™ems
(
$™ems
, 
$ãed_sourû
 = '') {

144 
$fÜm
['#submit'][] = 'aggregator_categorize_items_submit';

145 
	g$fÜm
['#validate'][] = 'aggregator_categorize_items_validate';

146 
	g$fÜm
['#theme'] = 'aggregator_categorize_items';

147 
	g$fÜm
['ãed_sourû'] = 
¬¿y
('#v®ue' => 
$ãed_sourû
);

148 
	g$ÿ‹gÜ›s
 = 
¬¿y
();

149 
	g$dÚe
 = 
FALSE
;

150 
	g$fÜm
['™ems'] = 
¬¿y
();

151 
	g$fÜm
['ÿ‹gÜ›s'] = 
¬¿y
('#Œ“' => 
TRUE
);

152 
fÜ—ch
 (
$™ems
 
as
 
$™em
) {

153 
	g$fÜm
['™ems'][
$™em
->
iid
] = 
¬¿y
('#v®ue' => 
theme
('aggregator_item', $item));

154 
	g$fÜm
['ÿ‹gÜ›s'][
$™em
->
iid
] = 
¬¿y
();

155 
	g$ÿ‹gÜ›s_»suÉ
 = 
db_qu”y
('SELECT c.cid, c.t™Ë, ci.iid FROM {agg»g©Ü_ÿ‹gÜy} c LEFT JOIN {agg»g©Ü_ÿ‹gÜy_™em} c˜ON c.cid = ci.cid AND ci.iid = %d', 
$™em
->
iid
);

156 
	g$£Ëùed
 = 
¬¿y
();

157 
	g$ÿ‹gÜy
 = 
db_ãtch_objeù
(
$ÿ‹gÜ›s_»suÉ
)) {

158 ià(!
$dÚe
) {

159 
$ÿ‹gÜ›s
[
$ÿ‹gÜy
->
cid
] = 
check_¶aš
($ÿ‹gÜy->
t™Ë
);

161 ià(
	g$ÿ‹gÜy
->
	giid
) {

162 
	g$£Ëùed
[] = 
$ÿ‹gÜy
->
cid
;

165 
	g$dÚe
 = 
TRUE
;

166 
	g$fÜm
['ÿ‹gÜ›s'][
$™em
->
iid
] = 
¬¿y
(

167 '#ty³' => 
v¬ŸbË_g‘
('aggregator_category_selector', 'checkboxes'),

168 '#deçuÉ_v®ue' => 
$£Ëùed
,

169 '#İtiÚs' => 
$ÿ‹gÜ›s
,

171 '#muÉË' => 
TRUE


174 
	g$fÜm
['subm™'] = 
¬¿y
('#ty³' => 'subm™', '#v®ue' => 
t
('Save categories'));

176  
	g$fÜm
;

182 
funùiÚ
 
	$agg»g©Ü_ÿ‹gÜize_™ems_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

183 ià(!
	`u£r_acûss
('administer‚ews feeds')) {

184 
	`fÜm_”rÜ
(
$fÜm
, 
	`t
('You‡re‚ot‡llowedo categorizehis feed item.'));

186 
	}
}

191 
funùiÚ
 
	$agg»g©Ü_ÿ‹gÜize_™ems_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

192 ià(!
	`em±y
(
$fÜm_¡©e
['values']['categories'])) {

193 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['ÿ‹gÜ›s'] 
as
 
$iid
 => 
$£ËùiÚ
) {

194 
	`db_qu”y
('DELETE FROM {agg»g©Ü_ÿ‹gÜy_™em} WHERE iid = %d', 
$iid
);

195 
	`fÜ—ch
 (
$£ËùiÚ
 
as
 
$cid
) {

196 ià(
$cid
) {

197 
	`db_qu”y
('INSERT INTO {agg»g©Ü_ÿ‹gÜy_™em} (cid, iidèVALUES (%d, %d)', 
$cid
, 
$iid
);

202 
	`dru·l_£t_mes§ge
(
	`t
('The categories have been saved.'));

203 
	}
}

214 
funùiÚ
 
	$theme_agg»g©Ü_ÿ‹gÜize_™ems
(
$fÜm
) {

215 
$ouut
 = 
	`dru·l_»nd”
(
$fÜm
['feed_source']);

216 
$rows
 = 
	`¬¿y
();

217 ià(
$fÜm
['items']) {

218 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['™ems']è
as
 
$key
) {

219 ià(
	`is_¬¿y
(
$fÜm
['™ems'][
$key
])) {

220 
$rows
[] = 
	`¬¿y
(

221 
	`dru·l_»nd”
(
$fÜm
['™ems'][
$key
]),

222 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
['ÿ‹gÜ›s'][
$key
]), 'class' => 'categorize-item'),

227 
$ouut
 .ğ
	`theme
('bË', 
	`¬¿y
('', 
	`t
('C©egÜize')), 
$rows
);

228 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['submit']);

229 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

230  
	`theme
('agg»g©Ü_w¿µ”', 
$ouut
);

231 
	}
}

238 
funùiÚ
 
	$‹m¶©e_´•roûss_agg»g©Ü_w¿µ”
(&
$v¬ŸbËs
) {

239 
$v¬ŸbËs
['·g”'] = 
	`theme
('·g”', 
NULL
, 20, 0);

240 
	}
}

247 
funùiÚ
 
	$‹m¶©e_´•roûss_agg»g©Ü_™em
(&
$v¬ŸbËs
) {

248 
$™em
 = 
$v¬ŸbËs
['item'];

250 
$v¬ŸbËs
['ãed_u¾'] = 
	`check_u¾
(
$™em
->
lšk
);

251 
$v¬ŸbËs
['ãed_t™Ë'] = 
	`check_¶aš
(
$™em
->
t™Ë
);

252 
$v¬ŸbËs
['cÚ‹Á'] = 
	`agg»g©Ü_f‹r_xss
(
$™em
->
desütiÚ
);

254 
$v¬ŸbËs
['source_url'] = '';

255 
$v¬ŸbËs
['source_title'] = '';

256 ià(
	`is£t
(
$™em
->
á™Ë
è&& is£t($™em->
fid
)) {

257 
$v¬ŸbËs
['sourû_u¾'] = 
	`u¾
("aggregator/sources/$item->fid");

258 
$v¬ŸbËs
['sourû_t™Ë'] = 
	`check_¶aš
(
$™em
->
á™Ë
);

260 ià(
	`d©e
('Ymd', 
$™em
->
time¡amp
) == date('Ymd')) {

261 
$v¬ŸbËs
['sourû_d©e'] = 
	`t
('%agØago', 
	`¬¿y
('%ago' => 
	`fÜm©_š‹rv®
(
	`time
(è- 
$™em
->
time¡amp
)));

264 
$v¬ŸbËs
['sourû_d©e'] = 
	`fÜm©_d©e
(
$™em
->
time¡amp
, 'cu¡om', 
	`v¬ŸbË_g‘
('date_format_medium', 'D, m/d/Y - H:i'));

267 
$v¬ŸbËs
['ÿ‹gÜ›s'] = 
	`¬¿y
();

268 
	`fÜ—ch
 (
$™em
->
ÿ‹gÜ›s
 
as
 
$ÿ‹gÜy
) {

269 
$v¬ŸbËs
['ÿ‹gÜ›s'][
$ÿ‹gÜy
->
cid
] = 
	`l
($ÿ‹gÜy->
t™Ë
, 'aggregator/categories/'. $category->cid);

271 
	}
}

276 
funùiÚ
 
	$agg»g©Ü_·ge_sourûs
() {

277 
$»suÉ
 = 
	`db_qu”y
('SELECT f.fid, f.title, f.description, f.image, MAX(i.timestamp) AS†ast FROM {aggregator_feed} f LEFT JOIN {aggregator_item} i ON f.fid = i.fid GROUP BY f.fid, f.title, f.description, f.image ORDER BY†ast DESC, f.title');

279 
$ouut
 = '';

280 
$ãed
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

282 
$summ¬y_™ems
 = 
	`¬¿y
();

283 ià(
	`v¬ŸbË_g‘
('aggregator_summary_items', 3)) {

284 
$™ems
 = 
	`db_qu”y_¿nge
('SELECT i.t™Ë, i.time¡amp, i.lšk FROM {agg»g©Ü_™em} i WHERE i.fid = %d ORDER BY i.time¡am°DESC', 
$ãed
->
fid
, 0, 
	`v¬ŸbË_g‘
('aggregator_summary_items', 3));

285 
$™em
 = 
	`db_ãtch_objeù
(
$™ems
)) {

286 
$summ¬y_™ems
[] = 
	`theme
('agg»g©Ü_summ¬y_™em', 
$™em
);

289 
$ãed
->
u¾
 = 
	`u¾
('agg»g©Ü/sourûs/'. $ãed->
fid
);

290 
$ouut
 .ğ
	`theme
('agg»g©Ü_summ¬y_™ems', 
$summ¬y_™ems
, 
$ãed
);

292 
$ouut
 .ğ
	`theme
('ãed_icÚ', 
	`u¾
('agg»g©Ü/İml'), 
	`t
('OPML feed'));

294  
	`theme
('agg»g©Ü_w¿µ”', 
$ouut
);

295 
	}
}

300 
funùiÚ
 
	$agg»g©Ü_·ge_ÿ‹gÜ›s
() {

301 
$»suÉ
 = 
	`db_qu”y
('SELECT c.cid, c.title, c.description FROM {aggregator_category} c LEFT JOIN {aggregator_category_item} ci ON c.cid = ci.cid LEFT JOIN {aggregator_item} i ON ci.iid = i.iid GROUP BY c.cid, c.title, c.description');

303 
$ouut
 = '';

304 
$ÿ‹gÜy
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

305 ià(
	`v¬ŸbË_g‘
('aggregator_summary_items', 3)) {

306 
$summ¬y_™ems
 = 
	`¬¿y
();

307 
$™ems
 = 
	`db_qu”y_¿nge
('SELECT i.t™Ë, i.time¡amp, i.lšk, f.t™Ë‡ ãed_t™Ë, f.lšk‡ ãed_lšk FROM {agg»g©Ü_ÿ‹gÜy_™em} c˜LEFT JOIN {agg»g©Ü_™em} i ON i.iid = ci.iid LEFT JOIN {agg»g©Ü_ãed} f ON i.fid = f.fid WHERE ci.cid = %d ORDER BY i.time¡am°DESC', 
$ÿ‹gÜy
->
cid
, 0, 
	`v¬ŸbË_g‘
('aggregator_summary_items', 3));

308 
$™em
 = 
	`db_ãtch_objeù
(
$™ems
)) {

309 
$summ¬y_™ems
[] = 
	`theme
('agg»g©Ü_summ¬y_™em', 
$™em
);

312 
$ÿ‹gÜy
->
u¾
 = 
	`u¾
('agg»g©Ü/ÿ‹gÜ›s/'. $ÿ‹gÜy->
cid
);

313 
$ouut
 .ğ
	`theme
('agg»g©Ü_summ¬y_™ems', 
$summ¬y_™ems
, 
$ÿ‹gÜy
);

316  
	`theme
('agg»g©Ü_w¿µ”', 
$ouut
);

317 
	}
}

322 
funùiÚ
 
	$agg»g©Ü_·ge_rss
() {

323 
$»suÉ
 = 
NULL
;

325 ià(
	`¬g
(2)) {

326 
$ÿ‹gÜy
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT cid,™Ë FROM {agg»g©Ü_ÿ‹gÜy} WHERE cid = %d', 
	`¬g
(2)));

327 
$sql
 = 'SELECT i.*, f.title AS ftitle, f.link AS flink FROM {aggregator_category_item} c LEFT JOIN {aggregator_item} i ON c.iid = i.iid LEFT JOIN {aggregator_feed} f ON i.fid = f.fid WHERE cid = %d ORDER BYimestamp DESC, i.iid DESC';

328 
$»suÉ
 = 
	`db_qu”y_¿nge
(
$sql
, 
$ÿ‹gÜy
->
cid
, 0, 
	`v¬ŸbË_g‘
('feed_default_items', 10));

332 
$ÿ‹gÜy
 = 
NULL
;

333 
$sql
 = 'SELECT i.*, f.title AS ftitle, f.link AS flink FROM {aggregator_item} i INNER JOIN {aggregator_feed} f ON i.fid = f.fid ORDER BY i.timestamp DESC, i.iid DESC';

334 
$»suÉ
 = 
	`db_qu”y_¿nge
(
$sql
, 0, 
	`v¬ŸbË_g‘
('feed_default_items', 10));

337 
$ãeds
 = 
	`¬¿y
();

338 
$™em
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

339 
$ãeds
[] = 
$™em
;

341  
	`theme
('agg»g©Ü_·ge_rss', 
$ãeds
, 
$ÿ‹gÜy
);

342 
	}
}

353 
funùiÚ
 
	$theme_agg»g©Ü_·ge_rss
(
$ãeds
, 
$ÿ‹gÜy
 = 
NULL
) {

354 
	`dru·l_£t_h—d”
('Content-Type:‡pplication/rss+xml; charset=utf-8');

356 
$™ems
 = '';

357 
$ãed_Ëngth
 = 
	`v¬ŸbË_g‘
('feed_item_length', 'teaser');

358 
	`fÜ—ch
 (
$ãeds
 
as
 
$ãed
) {

359 
$ãed_Ëngth
) {

361 
$‹a£r
 = 
	`node_‹a£r
(
$ãed
->
desütiÚ
);

362 ià(
$‹a£r
 !ğ
$ãed
->
desütiÚ
) {

363 
$‹a£r
 .ğ'<p><¨h»f="'. 
	`check_u¾
(
$ãed
->
lšk
è.'">'. 
	`t
('read more') ."</a></p>\n";

365 
$ãed
->
desütiÚ
 = 
$‹a£r
;

368 
$ãed
->
desütiÚ
 = '';

371 
$™ems
 .ğ
	`fÜm©_rss_™em
(
$ãed
->
á™Ë
 .': '. $ãed->
t™Ë
, $ãed->
lšk
, $ãed->
desütiÚ
, 
	`¬¿y
('pubD©e' => 
	`d©e
('r', $ãed->
time¡amp
)));

374 
$s™e_Çme
 = 
	`v¬ŸbË_g‘
('site_name', 'Drupal');

375 
$u¾
 = 
	`u¾
((
	`is£t
(
$ÿ‹gÜy
è? 'agg»g©Ü/ÿ‹gÜ›s/'. $ÿ‹gÜy->
cid
 : 'agg»g©Ü'), 
	`¬¿y
('absŞu‹' => 
TRUE
));

376 
$desütiÚ
 = 
	`is£t
(
$ÿ‹gÜy
è? 
	`t
('@s™e_Çm-‡gg»g©ed f“d š c©egÜy @t™Ë', 
	`¬¿y
('@s™e_Çme' => 
$s™e_Çme
, '@t™Ë' => $ÿ‹gÜy->
t™Ë
)) :('@site_name -‡ggregated feeds',‡rray('@site_name' => $site_name));

378 
$ouut
 = "<?xml version=\"1.0\"ƒncoding=\"utf-8\"?>\n";

379 
$ouut
 .= "<rss version=\"2.0\">\n";

380 
$ouut
 .ğ
	`fÜm©_rss_chªÃl
(
	`t
('@s™e_Çmagg»g©Ü', 
	`¬¿y
('@s™e_Çme' => 
$s™e_Çme
)), 
$u¾
, 
$desütiÚ
, 
$™ems
);

381 
$ouut
 .= "</rss>\n";

383 
´št
 
$ouut
;

384 
	}
}

394 
funùiÚ
 
	$agg»g©Ü_·ge_İml
(
$cid
 = 
NULL
) {

395 ià(
$cid
) {

396 
$»suÉ
 = 
	`db_qu”y
('SELECT f.t™Ë, f.u¾ FROM {agg»g©Ü_ãed} f LEFT JOIN {agg»g©Ü_ÿ‹gÜy_ãed} c oÀf.fid = c.fid WHERE c.cid = %d ORDER BY™Ë', 
$cid
);

399 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {aggregator_feed} ORDER BYitle');

402 
$ãeds
 = 
	`¬¿y
();

403 
$™em
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

404 
$ãeds
[] = 
$™em
;

407  
	`theme
('agg»g©Ü_·ge_İml', 
$ãeds
);

408 
	}
}

417 
funùiÚ
 
	$theme_agg»g©Ü_·ge_İml
(
$ãeds
) {

419 
	`dru·l_£t_h—d”
('Content-Type:ext/xml; charset=utf-8');

421 
$ouut
 = "<?xml version=\"1.0\"ƒncoding=\"utf-8\"?>\n";

422 
$ouut
 .= "<opml version=\"1.1\">\n";

423 
$ouut
 .= "<head>\n";

424 
$ouut
 .ğ'<t™Ë>'. 
	`check_¶aš
(
	`v¬ŸbË_g‘
('site_name', 'Drupal')) ."</title>\n";

425 
$ouut
 .ğ'<d©eModif›d>'. 
	`gmd©e
('r') ."</dateModified>\n";

426 
$ouut
 .= "</head>\n";

427 
$ouut
 .= "<body>\n";

428 
	`fÜ—ch
 (
$ãeds
 
as
 
$ãed
) {

429 
$ouut
 .ğ'<ouš‹xt="'. 
	`check_¶aš
(
$ãed
->
t™Ë
è.'" xmlU¾="'. 
	`check_u¾
($ãed->
u¾
) ."\" />\n";

431 
$ouut
 .= "</body>\n";

432 
$ouut
 .= "</opml>\n";

434 
´št
 
$ouut
;

435 
	}
}

442 
funùiÚ
 
	$‹m¶©e_´•roûss_agg»g©Ü_summ¬y_™ems
(&
$v¬ŸbËs
) {

443 
$v¬ŸbËs
['t™Ë'] = 
	`check_¶aš
($v¬ŸbËs['sourû']->
t™Ë
);

444 
$v¬ŸbËs
['summ¬y_li¡'] = 
	`theme
('item_list', $variables['summary_items']);

445 
$v¬ŸbËs
['sourû_u¾'] = $v¬ŸbËs['sourû']->
u¾
;

446 
	}
}

453 
funùiÚ
 
	$‹m¶©e_´•roûss_agg»g©Ü_summ¬y_™em
(&
$v¬ŸbËs
) {

454 
$™em
 = 
$v¬ŸbËs
['item'];

456 
$v¬ŸbËs
['ãed_u¾'] = 
	`check_u¾
(
$™em
->
lšk
);

457 
$v¬ŸbËs
['ãed_t™Ë'] = 
	`check_¶aš
(
$™em
->
t™Ë
);

458 
$v¬ŸbËs
['ãed_age'] = 
	`t
('%agŞd', 
	`¬¿y
('%age' => 
	`fÜm©_š‹rv®
(
	`time
(è- 
$™em
->
time¡amp
)));

460 
$v¬ŸbËs
['source_url'] = '';

461 
$v¬ŸbËs
['source_title'] = '';

462 ià(!
	`em±y
(
$™em
->
ãed_lšk
)) {

463 
$v¬ŸbËs
['sourû_u¾'] = 
	`check_u¾
(
$™em
->
ãed_lšk
);

464 
$v¬ŸbËs
['sourû_t™Ë'] = 
	`check_¶aš
(
$™em
->
ãed_t™Ë
);

466 
	}
}

473 
funùiÚ
 
	$‹m¶©e_´•roûss_agg»g©Ü_ãed_sourû
(&
$v¬ŸbËs
) {

474 
$ãed
 = 
$v¬ŸbËs
['feed'];

476 
$v¬ŸbËs
['sourû_icÚ'] = 
	`theme
('ãed_icÚ', 
$ãed
->
u¾
, 
	`t
('!t™Ë f“d', 
	`¬¿y
('!t™Ë' => $ãed->
t™Ë
)));

477 
$v¬ŸbËs
['sourû_image'] = 
$ãed
->
image
;

478 
$v¬ŸbËs
['sourû_desütiÚ'] = 
	`agg»g©Ü_f‹r_xss
(
$ãed
->
desütiÚ
);

479 
$v¬ŸbËs
['sourû_u¾'] = 
	`check_u¾
(
	`u¾
(
$ãed
->
lšk
, 
	`¬¿y
('absŞu‹' => 
TRUE
)));

481 ià(
$ãed
->
checked
) {

482 
$v¬ŸbËs
['Ï¡_checked'] = 
	`t
('@timago', 
	`¬¿y
('@time' => 
	`fÜm©_š‹rv®
(
	`time
(è- 
$ãed
->
checked
)));

485 
$v¬ŸbËs
['Ï¡_checked'] = 
	`t
('never');

488 ià(
	`u£r_acûss
('administer‚ews feeds')) {

489 
$v¬ŸbËs
['Ï¡_checked'] = 
	`l
($variables['last_checked'], 'admin/content/aggregator');

491 
	}
}

	@/srv/http/subs/notes/www/modules/block/block-admin-display-form.tpl.php

1 <?
	gphp


29 <?
php


31 
dru·l_add_js
('misc/tableheader.js');

32 
dru·l_add_js
(
dru·l_g‘_·th
('module', 'block') .'/block.js');

33 
fÜ—ch
 (
$block_»giÚs
 
as
 
$»giÚ
 => 
$t™Ë
) {

34 
dru·l_add_bËd¿g
('blocks', 'm©ch', 'siblšg', 'block-»giÚ-£Ëù', 'block-»giÚ-'. 
$»giÚ
, 
NULL
, 
FALSE
);

35 
dru·l_add_bËd¿g
('blocks', 'Üd”', 'siblšg', 'block-weight', 'block-weight-'. 
$»giÚ
);

38 <
bË
 
	gid
="blocks" 
şass
="sticky-enabled">

39 <
th—d
>

40 <
Œ
>

41 <
th
><?
php
 
´št
 
t
('Block'); ?></
	gth
>

42 <
	gth
><?
php
 
´št
 
t
('Region'); ?></th>

43 <
	gth
><?
php
 
´št
 
t
('Weight'); ?></th>

44 <?
php
 ià(
	g$thrÙe
): ?>

45 <
th
><?
php
 
´št
 
t
('ThrÙe'); ?></
	gth
>

46 <?
php
 
	g’dif
; ?>

47 <
th
 
	gcŞ¥ª
="2"><?
php
 
´št
 
t
('O³¿tiÚs'); ?></
	gth
>

48 </
	gŒ
>

49 </
	gth—d
>

50 <
	gtbody
>

51 <?
php
 
	g$row
 = 0; ?>

52 <?
php
 
fÜ—ch
 (
$block_»giÚs
 
as
 
$»giÚ
 => 
$t™Ë
): ?>

53 <
Œ
 
şass
="region„egion-<?php…rint $region?>">

54 <
td
 
cŞ¥ª
="<?ph°´šˆ$thrÙ? '6' : '5'; ?>" 
şass
="»giÚ"><?
php
 
´št
 
$t™Ë
; ?></
	gtd
>

55 </
	gŒ
>

56 <
Œ
 
	gşass
="region-message„egion-<?php…rint $region?>-message <?php…rintƒmpty($block_listing[$region]) ? 'region-empty' : 'region-populated'; ?>">

57 <
td
 
cŞ¥ª
="<?ph°´šˆ$thrÙ? '6' : '5'; ?>"><
em
><?
php
 
´št
 
t
('NØblock šhi »giÚ'); ?></
	gem
></
	gtd
>

58 </
	gŒ
>

59 <?
php
 
fÜ—ch
 (
$block_li¡šg
[
$»giÚ
] 
as
 
$d–
 => 
$d©a
): ?>

60 <
Œ
 
şass
="draggable <?php…rint $row % 2 == 0 ? 'odd' : 'even'; ?><?php…rint $data->row_class ? ' '. $data->row_class : ''; ?>">

61 <
td
 
şass
="block"><?
php
 
´št
 
$d©a
->
block_t™Ë
; ?></
	gtd
>

62 <
	gtd
><?
php
 
´št
 
	g$d©a
->
	g»giÚ_£Ëù
; ?></td>

63 <
	gtd
><?
php
 
´št
 
	g$d©a
->
	gweight_£Ëù
; ?></td>

64 <?
php
 ià(
	g$thrÙe
): ?>

65 <
td
><?
php
 
´št
 
$d©a
->
thrÙe_check
; ?></
	gtd
>

66 <?
php
 
	g’dif
; ?>

67 <
	gtd
><?
php
 
´št
 
	g$d©a
->
	gcÚfigu»_lšk
; ?></td>

68 <
	gtd
><?
php
 
´št
 
	g$d©a
->
	gd–‘e_lšk
; ?></td>

69 </
	gŒ
>

70 <?
php
 
	g$row
++; ?>

71 <?
php
 
	g’dfÜ—ch
; ?>

72 <?
php
 
	g’dfÜ—ch
; ?>

73 </
	gtbody
>

74 </
	gbË
>

76 <?
php
 
´št
 
	g$fÜm_subm™
; ?>

	@/srv/http/subs/notes/www/modules/block/block.admin.inc

1 <?
php


12 
funùiÚ
 
	$block_admš_di¥Ïy
(
$theme
 = 
NULL
) {

13 
glob®
 
$cu¡om_theme
;

16 
$cu¡om_theme
 = 
	`is£t
(
$theme
è? $them: 
	`v¬ŸbË_g‘
('theme_default', 'garland');

19 
$blocks
 = 
	`_block_»hash
();

20 
	`usÜt
(
$blocks
, '_block_compare');

22  
	`dru·l_g‘_fÜm
('block_admš_di¥Ïy_fÜm', 
$blocks
, 
$theme
);

23 
	}
}

28 
funùiÚ
 
	$block_admš_di¥Ïy_fÜm
(&
$fÜm_¡©e
, 
$blocks
, 
$theme
 = 
NULL
) {

29 
glob®
 
$theme_key
, 
$cu¡om_theme
;

32 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('moduË', 'block'è.'/block.css', 'moduË', '®l', 
FALSE
);

35 
$cu¡om_theme
 = 
	`is£t
(
$theme
è? $them: 
	`v¬ŸbË_g‘
('theme_default', 'garland');

36 
	`š™_theme
();

38 
$thrÙe
 = 
	`moduË_exi¡s
('throttle');

39 
$block_»giÚs
 = 
	`sy¡em_»giÚ_li¡
(
$theme_key
è+ 
	`¬¿y
(
BLOCK_REGION_NONE
 => '<'. 
	`t
('none') .'>');

44 
$weight_d–
 = 
	`round
(
	`couÁ
(
$blocks
) / 2);

47 
$fÜm
 = 
	`¬¿y
(

48 '#aùiÚ' => 
	`¬g
(4è? 
	`u¾
('admš/bud/block/li¡/'. 
$theme_key
) : url('admin/build/block'),

49 '#Œ“' => 
TRUE
,

52 
	`fÜ—ch
 (
$blocks
 
as
 
$i
 => 
$block
) {

53 
$key
 = 
$block
['module'] .'_'. $block['delta'];

54 
$fÜm
[
$key
]['moduË'] = 
	`¬¿y
(

56 '#v®ue' => 
$block
['module'],

58 
$fÜm
[
$key
]['d–'] = 
	`¬¿y
(

60 '#v®ue' => 
$block
['delta'],

62 
$fÜm
[
$key
]['šfo'] = 
	`¬¿y
(

63 '#v®ue' => 
	`check_¶aš
(
$block
['info'])

65 
$fÜm
[
$key
]['theme'] = 
	`¬¿y
(

67 '#v®ue' => 
$theme_key


69 
$fÜm
[
$key
]['weight'] = 
	`¬¿y
(

71 '#deçuÉ_v®ue' => 
$block
['weight'],

72 '#d–' => 
$weight_d–
,

74 
$fÜm
[
$key
]['»giÚ'] = 
	`¬¿y
(

76 '#deçuÉ_v®ue' => 
$block
['region'],

77 '#İtiÚs' => 
$block_»giÚs
,

80 ià(
$thrÙe
) {

81 
$fÜm
[
$key
]['thrÙe'] = 
	`¬¿y
('#ty³' => 'checkbox', '#deçuÉ_v®ue' => 
	`is£t
(
$block
['thrÙe']è? $block['thrÙe'] : 
FALSE
);

83 
$fÜm
[
$key
]['cÚfigu»'] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('cÚfigu»'), 'admš/bud/block/cÚfigu»/'. 
$block
['module'] .'/'. $block['delta']));

84 ià(
$block
['module'] == 'block') {

85 
$fÜm
[
$key
]['d–‘e'] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('d–‘e'), 'admš/bud/block/d–‘e/'. 
$block
['delta']));

89 
$fÜm
['subm™'] = 
	`¬¿y
(

91 '#v®ue' => 
	`t
('Save blocks'),

94  
$fÜm
;

95 
	}
}

100 
funùiÚ
 
	$block_admš_di¥Ïy_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

101 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues'] 
as
 
$block
) {

102 
$block
['¡©us'] = $block['»giÚ'] !ğ
BLOCK_REGION_NONE
;

103 
$block
['region'] = $block['status'] ? $block['region'] : '';

104 
	`db_qu”y
("UPDATE {blocks} SET stu ğ%d, weighˆğ%d,„egiÚ = '%s',hrÙğ%d WHERE moduË = '%s' AND d– = '%s' ANDhemğ'%s'", 
$block
['¡©us'], $block['weight'], $block['»giÚ'], 
	`is£t
($block['throttle']) ? $block['throttle'] : 0, $block['module'], $block['delta'], $block['theme']);

106 
	`dru·l_£t_mes§ge
(
	`t
('The block settings have been updated.'));

107 
	`ÿche_ş—r_®l
();

108 
	}
}

116 
funùiÚ
 
	$_block_com·»
(
$a
, 
$b
) {

117 
glob®
 
$theme_key
;

118 
$»giÚs
;

121 ià(!
	`is£t
(
$»giÚs
)) {

122 
$»giÚs
 = 
	`¬¿y_æ
(
	`¬¿y_keys
(
	`sy¡em_»giÚ_li¡
(
$theme_key
)));

123 
$»giÚs
[
BLOCK_REGION_NONE
] = 
	`couÁ
($regions);

127 
$¡©us
 = 
$b
['¡©us'] - 
$a
['status'];

128 ià(
$¡©us
) {

129  
$¡©us
;

132 ià((!
	`em±y
(
$a
['»giÚ']è&& !em±y(
$b
['»giÚ'])è&& (
$¶aû
 = (
$»giÚs
[$a['region']] - $regions[$b['region']]))) {

133  
$¶aû
;

136 
$weight
 = 
$a
['weight'] - 
$b
['weight'];

137 ià(
$weight
) {

138  
$weight
;

141  
	`¡rcmp
(
$a
['šfo'], 
$b
['info']);

142 
	}
}

147 
funùiÚ
 
	$block_admš_cÚfigu»
(&
$fÜm_¡©e
, 
$moduË
 = 
NULL
, 
$d–
 = 0) {

149 
$fÜm
['moduË'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$moduË
);

150 
$fÜm
['d–'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$d–
);

152 
$ed™
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT…ages, visib™y, cu¡om,™Ë FROM {blocks} WHERE moduË = '%s' AND d– = '%s'", 
$moduË
, 
$d–
));

154 
$fÜm
['block_£‰šgs'] = 
	`¬¿y
(

156 '#t™Ë' => 
	`t
('Block specific settings'),

157 '#cŞÏpsibË' => 
TRUE
,

159 
$fÜm
['block_£‰šgs']['t™Ë'] = 
	`¬¿y
(

161 '#t™Ë' => 
	`t
('Blockitle'),

163 '#desütiÚ' => 
$moduË
 =ğ'block' ? 
	`t
('Theitle ofhe block‡s shownohe user.') :('Overridehe defaultitle forhe block. Use <em>&lt;none&gt;</em>o display‚oitle, or†eave blanko usehe default blockitle.'),

164 '#deçuÉ_v®ue' => 
$ed™
['title'],

170 ià(
$£‰šgs
 = 
	`moduË_švoke
(
$moduË
, 'block', 'cÚfigu»', 
$d–
)) {

171 
	`fÜ—ch
 (
$£‰šgs
 
as
 
$k
 => 
$v
) {

172 
$fÜm
['block_£‰šgs'][
$k
] = 
$v
;

177 
$šfo
 = 
	`moduË_švoke
(
$moduË
, 'block', 'list');

178 ià(
	`is£t
(
$šfo
[
$d–
])) {

179 
	`dru·l_£t_t™Ë
(
	`t
("'%Çme' block", 
	`¬¿y
('%Çme' => 
$šfo
[
$d–
]['info'])));

183 
$fÜm
['u£r_vis_£‰šgs'] = 
	`¬¿y
(

185 '#t™Ë' => 
	`t
('User specific visibility settings'),

186 '#cŞÏpsibË' => 
TRUE
,

188 
$fÜm
['u£r_vis_£‰šgs']['cu¡om'] = 
	`¬¿y
(

190 '#t™Ë' => 
	`t
('Custom visibility settings'),

191 '#İtiÚs' => 
	`¬¿y
(

192 
	`t
('Users cannot control whether or‚othey seehis block.'),

193 
	`t
('Showhis block by default, but†et individual users hide it.'),

194 
	`t
('Hidehis block by default but†et individual users show it.')

196 '#desütiÚ' => 
	`t
('Allow individual userso customizehe visibility ofhis block inheir‡ccount settings.'),

197 '#deçuÉ_v®ue' => 
$ed™
['custom'],

201 
$deçuÉ_rŞe_İtiÚs
 = 
	`¬¿y
();

202 
$»suÉ
 = 
	`db_qu”y
("SELECT„id FROM {blocks_rŞes} WHERE moduË = '%s' AND d– = '%s'", 
$moduË
, 
$d–
);

203 
$rŞe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

204 
$deçuÉ_rŞe_İtiÚs
[] = 
$rŞe
->
rid
;

206 
$»suÉ
 = 
	`db_qu”y
('SELECT„id,‚ame FROM {role} ORDER BY‚ame');

207 
$rŞe_İtiÚs
 = 
	`¬¿y
();

208 
$rŞe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

209 
$rŞe_İtiÚs
[
$rŞe
->
rid
] = $rŞe->
Çme
;

211 
$fÜm
['rŞe_vis_£‰šgs'] = 
	`¬¿y
(

213 '#t™Ë' => 
	`t
('Role specific visibility settings'),

214 '#cŞÏpsibË' => 
TRUE
,

216 
$fÜm
['rŞe_vis_£‰šgs']['rŞes'] = 
	`¬¿y
(

218 '#t™Ë' => 
	`t
('Show block for specific„oles'),

219 '#deçuÉ_v®ue' => 
$deçuÉ_rŞe_İtiÚs
,

220 '#İtiÚs' => 
$rŞe_İtiÚs
,

221 '#desütiÚ' => 
	`t
('Showhis block only forhe selected„ole(s). If you select‚o„oles,he block will be visibleo‡ll users.'),

224 
$fÜm
['·ge_vis_£‰šgs'] = 
	`¬¿y
(

226 '#t™Ë' => 
	`t
('Page specific visibility settings'),

227 '#cŞÏpsibË' => 
TRUE
,

229 
$acûss
 = 
	`u£r_acûss
('use PHP for block visibility');

231 ià(
$ed™
['visib™y'] =ğ2 && !
$acûss
) {

232 
$fÜm
['·ge_vis_£‰šgs'] = 
	`¬¿y
();

233 
$fÜm
['·ge_vis_£‰šgs']['visib™y'] = 
	`¬¿y
('#type' => 'value', '#value' => 2);

234 
$fÜm
['·ge_vis_£‰šgs']['·ges'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$ed™
['pages']);

237 
$İtiÚs
 = 
	`¬¿y
(
	`t
('Show onƒvery…ageƒxcepthe†isted…ages.'),('Show on onlyhe†isted…ages.'));

238 
$desütiÚ
 = 
	`t
("EÁ” oÃ…ag³¸lša Dru·È·ths. Th'*' ch¬aù” i ¨wdÿrd. Exam¶·th ¬%blog fÜhblog…agªd %blog-wdÿrd fÜƒv”y…”sÚ® blog. %äÚˆi thäÚˆ·ge.", 
	`¬¿y
('%blog' => 'blog', '%blog-wildcard' => 'blog/*', '%front' => '<front>'));

240 ià(
$acûss
) {

241 
$İtiÚs
[] = 
	`t
('Show ifhe following PHP code„eturns <code>TRUE</code> (PHP-mode,ƒxperts only).');

242 
$desütiÚ
 .ğ' '. 
	`t
('IàthPHP-modi cho£n,ƒÁ” PHP codb‘w“À%php. NÙth©ƒxecutšg incÜ»ù PHP-codÿÀb»ak you¸Dru·Ès™e.', 
	`¬¿y
('%php' => '<?php ?>'));

244 
$fÜm
['·ge_vis_£‰šgs']['visib™y'] = 
	`¬¿y
(

246 '#t™Ë' => 
	`t
('Show block on specific…ages'),

247 '#İtiÚs' => 
$İtiÚs
,

248 '#deçuÉ_v®ue' => 
$ed™
['visibility'],

250 
$fÜm
['·ge_vis_£‰šgs']['·ges'] = 
	`¬¿y
(

252 '#t™Ë' => 
	`t
('Pages'),

253 '#deçuÉ_v®ue' => 
$ed™
['pages'],

254 '#desütiÚ' => 
$desütiÚ
,

258 
$fÜm
['subm™'] = 
	`¬¿y
(

260 '#v®ue' => 
	`t
('Save block'),

263  
$fÜm
;

264 
	}
}

266 
funùiÚ
 
	$block_admš_cÚfigu»_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

267 ià(
$fÜm_¡©e
['values']['module'] == 'block') {

268 ià(
	`em±y
(
$fÜm_¡©e
['v®ues']['šfo']è|| 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*) FROM {boxes} WHERE bid != %d AND info = '%s'", $form_state['values']['delta'], $form_state['values']['info']))) {

269 
	`fÜm_£t_”rÜ
('šfo', 
	`t
('Pleaseƒnsurehatƒach block description is unique.'));

272 
	}
}

274 
funùiÚ
 
	$block_admš_cÚfigu»_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

275 ià(!
	`fÜm_g‘_”rÜs
()) {

276 
	`db_qu”y
("UPDATE {blocks} SET visib™y = %d,…age ğ'%s', cu¡om = %d,™Ë = '%s' WHERE moduË = '%s' AND d– = '%s'", 
$fÜm_¡©e
['v®ues']['visib™y'], 
	`Œim
($form_state['values']['pages']), $form_state['values']['custom'], $form_state['values']['title'], $form_state['values']['module'], $form_state['values']['delta']);

277 
	`db_qu”y
("DELETE FROM {blocks_rŞes} WHERE moduË = '%s' AND d– = '%s'", 
$fÜm_¡©e
['values']['module'], $form_state['values']['delta']);

278 
	`fÜ—ch
 (
	`¬¿y_f‹r
(
$fÜm_¡©e
['v®ues']['rŞes']è
as
 
$rid
) {

279 
	`db_qu”y
("INSERT INTO {blocks_rŞes} (rid, moduË, d–èVALUES (%d, '%s', '%s')", 
$rid
, 
$fÜm_¡©e
['values']['module'], $form_state['values']['delta']);

281 
	`moduË_švoke
(
$fÜm_¡©e
['values']['module'], 'block', 'save', $form_state['values']['delta'], $form_state['values']);

282 
	`dru·l_£t_mes§ge
(
	`t
('The block configuration has been saved.'));

283 
	`ÿche_ş—r_®l
();

284 
$fÜm_¡©e
['redirect'] = 'admin/build/block';

287 
	}
}

292 
funùiÚ
 
	$block_add_block_fÜm
(&
$fÜm_¡©e
) {

293  
	`block_admš_cÚfigu»
(
$fÜm_¡©e
, 'block', 
NULL
);

294 
	}
}

296 
funùiÚ
 
	$block_add_block_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

297 ià(
	`em±y
(
$fÜm_¡©e
['v®ues']['šfo']è|| 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*) FROM {boxes} WHERE info = '%s'", $form_state['values']['info']))) {

298 
	`fÜm_£t_”rÜ
('šfo', 
	`t
('Pleaseƒnsurehatƒach block description is unique.'));

300 
	}
}

305 
funùiÚ
 
	$block_add_block_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

306 
	`db_qu”y
("INSERT INTO {boxes} (body, info, fÜm©èVALUES ('%s', '%s', %d)", 
$fÜm_¡©e
['values']['body'], $form_state['values']['info'], $form_state['values']['format']);

307 
$d–
 = 
	`db_Ï¡_š£¹_id
('boxes', 'bid');

309 
	`fÜ—ch
 (
	`li¡_themes
(è
as
 
$key
 => 
$theme
) {

310 ià(
$theme
->
¡©us
) {

311 
	`db_qu”y
("INSERT INTO {blocks} (visib™y,…ages, cu¡om,™Ë, moduË,heme, stus, weight, d–, cacheèVALUES(%d, '%s', %d, '%s', '%s', '%s', %d, %d, '%s', %d)", 
$fÜm_¡©e
['v®ues']['visib™y'], 
	`Œim
($fÜm_¡©e['v®ues']['·ges']), $fÜm_¡©e['v®ues']['cu¡om'], $fÜm_¡©e['v®ues']['t™Ë'], $fÜm_¡©e['v®ues']['moduË'], 
$theme
->
Çme
, 0, 0, 
$d–
, 
BLOCK_NO_CACHE
);

315 
	`fÜ—ch
 (
	`¬¿y_f‹r
(
$fÜm_¡©e
['v®ues']['rŞes']è
as
 
$rid
) {

316 
	`db_qu”y
("INSERT INTO {blocks_rŞes} (rid, moduË, d–èVALUES (%d, '%s', '%s')", 
$rid
, 
$fÜm_¡©e
['v®ues']['moduË'], 
$d–
);

319 
	`dru·l_£t_mes§ge
(
	`t
('The block has been created.'));

320 
	`ÿche_ş—r_®l
();

322 
$fÜm_¡©e
['redirect'] = 'admin/build/block';

324 
	}
}

329 
funùiÚ
 
	$block_box_d–‘e
(&
$fÜm_¡©e
, 
$bid
 = 0) {

330 
$box
 = 
	`block_box_g‘
(
$bid
);

331 
$fÜm
['šfo'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$box
['info']);

332 
$fÜm
['bid'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$bid
);

334  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØd–‘thblock %Çme?', 
	`¬¿y
('%Çme' => 
$box
['info'])), 'admin/build/block', '',('Delete'),('Cancel'));

335 
	}
}

340 
funùiÚ
 
	$block_box_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

341 
	`db_qu”y
('DELETE FROM {boxes} WHERE bid = %d', 
$fÜm_¡©e
['values']['bid']);

342 
	`db_qu”y
("DELETE FROM {blocks} WHERE moduË = 'block' AND d– = '%s'", 
$fÜm_¡©e
['values']['bid']);

343 
	`dru·l_£t_mes§ge
(
	`t
('Thblock %Çmha b“À»moved.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['info'])));

344 
	`ÿche_ş—r_®l
();

345 
$fÜm_¡©e
['redirect'] = 'admin/build/block';

347 
	}
}

358 
funùiÚ
 
	$‹m¶©e_´•roûss_block_admš_di¥Ïy_fÜm
(&
$v¬ŸbËs
) {

359 
glob®
 
$theme_key
;

361 
$block_»giÚs
 = 
	`sy¡em_»giÚ_li¡
(
$theme_key
);

362 
$v¬ŸbËs
['thrÙe'] = 
	`moduË_exi¡s
('throttle');

363 
$v¬ŸbËs
['block_»giÚs'] = 
$block_»giÚs
 + 
	`¬¿y
(
BLOCK_REGION_NONE
 => 
	`t
('Disabled'));

365 
	`fÜ—ch
 (
$block_»giÚs
 
as
 
$key
 => 
$v®ue
) {

367 
	`dru·l_£t_cÚ‹Á
(
$key
, '<div cÏss="block-»giÚ">'. 
$v®ue
 .'</div>');

369 
$v¬ŸbËs
['block_li¡šg'][
$key
] = 
	`¬¿y
();

373 
$v¬ŸbËs
['block_li¡šg'][
BLOCK_REGION_NONE
] = 
	`¬¿y
();

376 
$Ï¡_»giÚ
 = '';

377 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$v¬ŸbËs
['fÜm']è
as
 
$i
) {

378 
$block
 = &
$v¬ŸbËs
['fÜm'][
$i
];

381 ià(
	`is£t
(
$block
['info'])) {

383 
$»giÚ
 = 
$block
['region']['#default_value'];

386 
$v¬ŸbËs
['fÜm'][
$i
]['»giÚ']['#©Œibu‹s']['şass'] = 'block-»giÚ-£Ëù block-»giÚ-'. 
$»giÚ
;

387 
$v¬ŸbËs
['fÜm'][
$i
]['weight']['#©Œibu‹s']['şass'] = 'block-weighˆblock-weight-'. 
$»giÚ
;

389 
$v¬ŸbËs
['block_li¡šg'][
$»giÚ
][
$i
]->
row_şass
 = 
	`is£t
(
$block
['#attributes']['class']) ? $block['#attributes']['class'] : '';

390 
$v¬ŸbËs
['block_li¡šg'][
$»giÚ
][
$i
]->
block_modif›d
 = 
	`is£t
(
$block
['#©Œibu‹s']['şass']è&& 
	`¡½os
($block['#©Œibu‹s']['şass'], 'block-modif›d'è!=ğ
FALSE
 ? 
TRUE
 : FALSE;

391 
$v¬ŸbËs
['block_li¡šg'][
$»giÚ
][
$i
]->
block_t™Ë
 = 
	`dru·l_»nd”
(
$block
['info']);

392 
$v¬ŸbËs
['block_li¡šg'][
$»giÚ
][
$i
]->
»giÚ_£Ëù
 = 
	`dru·l_»nd”
(
$block
['region']) . drupal_render($block['theme']);

393 
$v¬ŸbËs
['block_li¡šg'][
$»giÚ
][
$i
]->
weight_£Ëù
 = 
	`dru·l_»nd”
(
$block
['weight']);

394 
$v¬ŸbËs
['block_li¡šg'][
$»giÚ
][
$i
]->
thrÙe_check
 = $v¬ŸbËs['thrÙe'] ? 
	`dru·l_»nd”
(
$block
['throttle']) : '';

395 
$v¬ŸbËs
['block_li¡šg'][
$»giÚ
][
$i
]->
cÚfigu»_lšk
 = 
	`dru·l_»nd”
(
$block
['configure']);

396 
$v¬ŸbËs
['block_li¡šg'][
$»giÚ
][
$i
]->
d–‘e_lšk
 = !
	`em±y
(
$block
['d–‘e']è? 
	`dru·l_»nd”
($block['delete']) : '';

397 
$v¬ŸbËs
['block_li¡šg'][
$»giÚ
][
$i
]->
´š‹d
 = 
FALSE
;

399 
$Ï¡_»giÚ
 = 
$»giÚ
;

403 
$v¬ŸbËs
['fÜm_subm™'] = 
	`dru·l_»nd”
($variables['form']);

404 
	}
}

	@/srv/http/subs/notes/www/modules/block/block.module

1 <?
php


13 
defše
('BLOCK_REGION_NONE', -1);

39 
defše
('BLOCK_NO_CACHE', -1);

45 
defše
('BLOCK_CACHE_PER_ROLE', 0x0001);

52 
defše
('BLOCK_CACHE_PER_USER', 0x0002);

57 
defše
('BLOCK_CACHE_PER_PAGE', 0x0004);

62 
defše
('BLOCK_CACHE_GLOBAL', 0x0008);

67 
funùiÚ
 
	$block_h–p
(
$·th
, 
$¬g
) {

68 
$·th
) {

70 
$ouut
 = '<p>'. 
	`t
('Block ¬boxe oàcÚ‹Á„’d”ed iÁØª‡»a, o¸»giÚ, oà¨web…age. ThdeçuÉhemG¬Ïnd, fÜƒxam¶e, im¶em’t th»giÚ "Ëá sideb¬", "righˆsideb¬", "cÚ‹Á", "h—d”",‡nd "foÙ”",‡nd‡ block may‡µ—¸š‡ny oÃ oàthe£‡»as. Th<¨h»f="@blocks">block admši¡¿tiÚ…age</a>…rovide ¨d¿g-ªd-drİ iÁ”çû fÜ‡ssignšg‡ blockØ¨»giÚ,‡nd fÜ cÚŒŞlšghÜd” oàblock w™hš„egiÚs.', 
	`¬¿y
('@blocks' => 
	`u¾
('admin/build/block'))) .'</p>';

71 
$ouut
 .ğ'<p>'. 
	`t
('AÉhough block ¬usu®ly g’”©ed‡utom©iÿÎy by moduË Öikth<em>U£¸logš</em> block, fÜƒxam¶e),‡dmši¡¿tÜ ÿÀ®sØdefšcu¡om blocks. Cu¡om block hav¨t™Ë, desütiÚ,‡nd body. Thbody oàthblock cª ba lÚg‡ Ãûs§ry,‡nd cª cÚš cÚ‹Á suµÜ‹d by‡ny‡vaabË <¨h»f="@šput-fÜm©">špuˆfÜm©</a>.', 
	`¬¿y
('@šput-fÜm©' => 
	`u¾
('admin/settings/filters'))) .'</p>';

72 
$ouut
 .ğ'<p>'. 
	`t
('When working with blocks,„ememberhat:') .'</p>';

73 
$ouut
 .ğ'<ul><li>'. 
	`t
('since‚ot‡llhemes implementhe same„egions, or display„egions inhe same way, blocks‡re…ositioned on‡…er-theme basis.') .'</li>';

74 
$ouut
 .ğ'<li>'. 
	`t
('disabled blocks, or blocks‚ot in‡„egion,‡re‚ever shown.') .'</li>';

75 
$ouut
 .ğ'<li>'. 
	`t
('whenhrottle module isƒnabled,hrottled blocks (blocks withhe <em>Throttle</em> checkbox selected)‡re hidden during high server†oads.') .'</li>';

76 
$ouut
 .ğ'<li>'. 
	`t
('blocks can be configuredo be visible only on certain…ages.') .'</li>';

77 
$ouut
 .ğ'<li>'. 
	`t
('blocks can be configuredo be visible only when specific conditions‡rerue.') .'</li>';

78 
$ouut
 .ğ'<li>'. 
	`t
('blocks can be configuredo be visible only for certain user„oles.') .'</li>';

79 
$ouut
 .ğ'<li>'. 
	`t
('when‡llowed by‡n‡dministrator, specific blocks may beƒnabled or disabled on‡…er-user basis usinghe <em>My‡ccount</em>…age.') .'</li>';

80 
$ouut
 .ğ'<li>'. 
	`t
('some dynamic blocks, such‡shose generated by modules, will be displayed only on certain…ages.') .'</li></ul>';

81 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@block">Block moduË</a>.', 
	`¬¿y
('@block' => 'http://drupal.org/handbook/modules/block/')) .'</p>';

82  
$ouut
;

84 
$thrÙe
 = 
	`moduË_exi¡s
('throttle');

85 
$ouut
 = '<p>'. 
	`t
('This…age…rovides‡ drag-and-drop interface for‡ssigning‡ blocko‡„egion,‡nd for controllinghe order of blocks within„egions. To changehe„egion or order of‡ block, grab‡ drag-and-drop handle underhe <em>Block</em> column‡nd draghe blocko‡‚ew†ocation inhe†ist. (Grab‡ handle by clicking‡nd holdinghe mouse while hovering over‡ handle icon.) Since‚ot‡llhemes implementhe same„egions, or display„egions inhe same way, blocks‡re…ositioned on‡…er-theme basis. Rememberhat your changes will‚ot be saved until you clickhe <em>Save blocks</em> button‡the bottom ofhe…age.') .'</p>';

86 ià(
$thrÙe
) {

87 
$ouut
 .ğ'<p>'. 
	`t
('TØ»duû CPU u§ge, d©aba£¿ffiøÜ bªdwidth, block may bautom©iÿÎy di§bËd duršg high s”v”†ßd by s–eùšgheœ <em>ThrÙe</em> checkbox. Adju¡hrÙth»shŞd Úh<¨h»f="@thrÙecÚfig">thrÙcÚfigu¿tiÚ…age</a>.', 
	`¬¿y
('@thrÙecÚfig' => 
	`u¾
('admin/settings/throttle'))) .'</p>';

89 
$ouut
 .ğ'<p>'. 
	`t
('Clickh<em>cÚfigu»</em>†šk‚exˆtØ—ch blockØcÚfigu» it ¥ecifiøt™Ë‡nd visib™y s‘tšgs. U£h<¨h»f="@add-block">add block…age</a>Øü—‹‡ cu¡om block.', 
	`¬¿y
('@add-block' => 
	`u¾
('admin/build/block/add'))) .'</p>';

90  
$ouut
;

92  '<p>'. 
	`t
('U£hi ·gtØü—‹‡‚ew cu¡om block. New block ¬di§bËd by deçuÉ,‡nd mu¡ bmovedØ¨»giÚ oÀth<¨h»f="@blocks">block admši¡¿tiÚ…age</a>ØbvisibË.', 
	`¬¿y
('@blocks' => 
	`u¾
('admin/build/block'))) .'</p>';

94 
	}
}

99 
funùiÚ
 
	$block_theme
() {

100  
	`¬¿y
(

101 'block_admš_di¥Ïy_fÜm' => 
	`¬¿y
(

104 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

107 
	}
}

112 
funùiÚ
 
	$block_³rm
() {

113  
	`¬¿y
('administer blocks', 'use PHP for block visibility');

114 
	}
}

119 
funùiÚ
 
	$block_m’u
() {

120 
$™ems
['admš/bud/block'] = 
	`¬¿y
(

124 'acûs ¬gum’ts' => 
	`¬¿y
('administer blocks'),

127 
$™ems
['admš/bud/block/li¡'] = 
	`¬¿y
(

129 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

132 
$™ems
['admš/bud/block/li¡/js'] = 
	`¬¿y
(

135 'acûs ¬gum’ts' => 
	`¬¿y
('administer blocks'),

136 'ty³' => 
MENU_CALLBACK
,

139 
$™ems
['admš/bud/block/cÚfigu»'] = 
	`¬¿y
(

142 '·g¬gum’ts' => 
	`¬¿y
('block_admin_configure'),

143 'acûs ¬gum’ts' => 
	`¬¿y
('administer blocks'),

144 'ty³' => 
MENU_CALLBACK
,

147 
$™ems
['admš/bud/block/d–‘e'] = 
	`¬¿y
(

150 '·g¬gum’ts' => 
	`¬¿y
('block_box_delete'),

151 'acûs ¬gum’ts' => 
	`¬¿y
('administer blocks'),

152 'ty³' => 
MENU_CALLBACK
,

155 
$™ems
['admš/bud/block/add'] = 
	`¬¿y
(

158 '·g¬gum’ts' => 
	`¬¿y
('block_add_block_form'),

159 'acûs ¬gum’ts' => 
	`¬¿y
('administer blocks'),

160 'ty³' => 
MENU_LOCAL_TASK
,

163 
$deçuÉ
 = 
	`v¬ŸbË_g‘
('theme_default', 'garland');

164 
	`fÜ—ch
 (
	`li¡_themes
(è
as
 
$key
 => 
$theme
) {

165 
$™ems
['admš/bud/block/li¡/'. 
$key
] = 
	`¬¿y
(

166 't™Ë' => 
	`check_¶aš
(
$theme
->
šfo
['name']),

167 '·g¬gum’ts' => 
	`¬¿y
(
$key
),

168 'ty³' => 
$key
 =ğ
$deçuÉ
 ? 
MENU_DEFAULT_LOCAL_TASK
 : 
MENU_LOCAL_TASK
,

169 'weight' => 
$key
 =ğ
$deçuÉ
 ? -10 : 0,

172 'acûs ¬gum’ts' => 
	`¬¿y
(
$theme
),

175  
$™ems
;

176 
	}
}

181 
funùiÚ
 
	$_block_themes_acûss
(
$theme
) {

182  
	`u£r_acûss
('admši¡” blocks'è&& (
$theme
->
¡©us
 || $theme->
Çme
 =ğ
	`v¬ŸbË_g‘
('admin_theme', '0'));

183 
	}
}

190 
funùiÚ
 
block_block
(
$İ
 = 'li¡', 
$d–
 = 0, 
$ed™
 = 
	$¬¿y
()) {

191 
$İ
) {

193 
$blocks
 = 
	`¬¿y
();

195 
$»suÉ
 = 
	`db_qu”y
('SELECT bid, info FROM {boxes} ORDER BY info');

196 
$block
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

197 
$blocks
[
$block
->
bid
]['šfo'] = $block->
šfo
;

199 
$blocks
[
$block
->
bid
]['ÿche'] = 
BLOCK_NO_CACHE
;

201  
$blocks
;

204 
$box
 = 
	`¬¿y
('fÜm©' => 
FILTER_FORMAT_DEFAULT
);

205 ià(
$d–
) {

206 
$box
 = 
	`block_box_g‘
(
$d–
);

208 ià(
	`f‹r_acûss
(
$box
['format'])) {

209  
	`block_box_fÜm
(
$box
);

214 
	`block_box_§ve
(
$ed™
, 
$d–
);

218 
$block
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT body, fÜm© FROM {boxes} WHERE bid = %d', 
$d–
));

219 
$d©a
['cÚ‹Á'] = 
	`check_m¬kup
(
$block
->
body
, $block->
fÜm©
, 
FALSE
);

220  
$d©a
;

222 
	}
}

230 
funùiÚ
 
	$_block_»hash
() {

231 
glob®
 
$theme_key
;

233 
	`š™_theme
();

235 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {blocks} WHEREhemğ'%s'", 
$theme_key
);

236 
$Şd_blocks
 = 
	`¬¿y
();

237 
$Şd_block
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

238 
$Şd_blocks
[
$Şd_block
['module']][$old_block['delta']] = $old_block;

241 
$blocks
 = 
	`¬¿y
();

243 
$»giÚs
 = 
	`sy¡em_»giÚ_li¡
(
$theme_key
);

245 
	`fÜ—ch
 (
	`moduË_li¡
(è
as
 
$moduË
) {

246 
$moduË_blocks
 = 
	`moduË_švoke
(
$moduË
, 'block', 'list');

247 ià(
$moduË_blocks
) {

248 
	`fÜ—ch
 (
$moduË_blocks
 
as
 
$d–
 => 
$block
) {

249 ià(
	`em±y
(
$Şd_blocks
[
$moduË
][
$d–
])) {

251 
$block
['moduË'] = 
$moduË
;

252 
$block
['d–'] = 
$d–
;

253 
$block
['theme'] = 
$theme_key
;

254 ià(!
	`is£t
(
$block
['pages'])) {

258 
$block
['pages'] = '';

261 
	`dru·l_wr™e_»cÜd
('blocks', 
$block
);

263 
$block
['»giÚ'] = $block['¡©us'] ? $block['»giÚ'] : 
BLOCK_REGION_NONE
;

265 
$blocks
[] = 
$block
;

273 
$Şd_blocks
[
$moduË
][
$d–
]['šfo'] = 
$block
['info'];

275 ià(!
	`em±y
(
$Şd_blocks
[
$moduË
][
$d–
]['»giÚ']è&& !
	`is£t
(
$»giÚs
[$old_blocks[$module][$delta]['region']])) {

276 
	`dru·l_£t_mes§ge
(
	`t
('Thblock %šfØwa assigÃdØthšv®id„egiÚ %»giÚ‡nd ha b“Àdi§bËd.', 
	`¬¿y
('%šfo' => 
$Şd_blocks
[
$moduË
][
$d–
]['info'], '%region' => $old_blocks[$module][$delta]['region'])), 'warning');

277 
$Şd_blocks
[
$moduË
][
$d–
]['status'] = 0;

278 
$Şd_blocks
[
$moduË
][
$d–
]['»giÚ'] = 
BLOCK_REGION_NONE
;

281 
$Şd_blocks
[
$moduË
][
$d–
]['»giÚ'] = $Şd_blocks[$moduË][$d–]['¡©us'] ? $Şd_blocks[$moduË][$d–]['»giÚ'] : 
BLOCK_REGION_NONE
;

284 
$blocks
[] = 
$Şd_blocks
[
$moduË
][
$d–
];

286 
	`un£t
(
$Şd_blocks
[
$moduË
][
$d–
]);

293 
	`fÜ—ch
 (
$Şd_blocks
 
as
 
$moduË
 => 
$Şd_moduË_blocks
) {

294 
	`fÜ—ch
 (
$Şd_moduË_blocks
 
as
 
$d–
 => 
$block
) {

295 
	`db_qu”y
("DELETE FROM {blocks} WHERE moduË = '%s' AND d– = '%s' ANDhemğ'%s'", 
$moduË
, 
$d–
, 
$theme_key
);

298  
$blocks
;

299 
	}
}

314 
funùiÚ
 
	$block_box_g‘
(
$bid
) {

315  
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT * FROM {boxes} WHERE bid = %d", 
$bid
));

316 
	}
}

321 
funùiÚ
 
block_box_fÜm
(
$ed™
 = 
	$¬¿y
()) {

322 
$ed™
 +ğ
	`¬¿y
(

326 
$fÜm
['šfo'] = 
	`¬¿y
(

328 '#t™Ë' => 
	`t
('Block description'),

329 '#deçuÉ_v®ue' => 
$ed™
['info'],

331 '#desütiÚ' => 
	`t
('A br›àdesütiÚ oàyou¸block. U£d oÀth<¨h»f="@ov”v›w">block ov”v›w…age</a>.', 
	`¬¿y
('@ov”v›w' => 
	`u¾
('admin/build/block'))),

332 '#»quœed' => 
TRUE
,

335 
$fÜm
['body_field']['#weight'] = -17;

336 
$fÜm
['body_f›ld']['body'] = 
	`¬¿y
(

338 '#t™Ë' => 
	`t
('Block body'),

339 '#deçuÉ_v®ue' => 
$ed™
['body'],

341 '#desütiÚ' => 
	`t
('The content ofhe block‡s shownohe user.'),

344 ià(!
	`is£t
(
$ed™
['format'])) {

345 
$ed™
['fÜm©'] = 
FILTER_FORMAT_DEFAULT
;

347 
$fÜm
['body_f›ld']['fÜm©'] = 
	`f‹r_fÜm
(
$ed™
['format'], -16);

349  
$fÜm
;

350 
	}
}

365 
funùiÚ
 
	$block_box_§ve
(
$ed™
, 
$d–
) {

366 ià(!
	`f‹r_acûss
(
$ed™
['format'])) {

367 
$ed™
['fÜm©'] = 
FILTER_FORMAT_DEFAULT
;

370 
	`db_qu”y
("UPDATE {boxes} SET body = '%s', infØğ'%s', fÜm© = %d WHERE bid = %d", 
$ed™
['body'], $ed™['šfo'], $ed™['fÜm©'], 
$d–
);

372  
TRUE
;

373 
	}
}

381 
funùiÚ
 
	$block_u£r
(
$ty³
, 
$ed™
, &
$accouÁ
, 
$ÿ‹gÜy
 = 
NULL
) {

382 
$ty³
) {

384 ià(
$ÿ‹gÜy
 == 'account') {

385 
$rids
 = 
	`¬¿y_keys
(
$accouÁ
->
rŞes
);

386 
$»suÉ
 = 
	`db_qu”y
("SELECT DISTINCT b.* FROM {blocks} b LEFT JOIN {blocks_rŞes}„ ON b.moduË =„.moduË AND b.d– =„.d– WHERE b.¡©u ğ1 AND b.cu¡om !ğ0 AND (r.rid IN (". 
	`db_¶aûhŞd”s
(
$rids
) .") OR„.rid IS NULL) ORDER BY b.weight, b.module", $rids);

387 
$fÜm
['block'] = 
	`¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
	`t
('Block cÚfigu¿tiÚ'), '#weight' => 3, '#cŞÏpsibË' => 
TRUE
, '#tree' => TRUE);

388 
$block
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

389 
$d©a
 = 
	`moduË_švoke
(
$block
->
moduË
, 'block', 'list');

390 ià(
$d©a
[
$block
->
d–
]['info']) {

391 
$»tuº
 = 
TRUE
;

392 
$fÜm
['block'][
$block
->
moduË
][$block->
d–
] = 
	`¬¿y
('#ty³' => 'checkbox', '#t™Ë' => 
	`check_¶aš
(
$d©a
[$block->d–]['šfo']), '#deçuÉ_v®ue' => 
	`is£t
(
$accouÁ
->
block
[$block->moduË][$block->d–]è? $accouÁ->block[$block->moduË][$block->d–] : ($block->
cu¡om
 == 1));

396 ià(!
	`em±y
(
$»tuº
)) {

397  
$fÜm
;

403 ià(
	`em±y
(
$ed™
['block'])) {

404 
$ed™
['block'] = 
	`¬¿y
();

406  
$ed™
;

408 
	}
}

426 
funùiÚ
 
	$block_li¡
(
$»giÚ
) {

427 
glob®
 
$u£r
, 
$theme_key
;

429 
$blocks
 = 
	`¬¿y
();

431 ià(!
	`couÁ
(
$blocks
)) {

432 
$rids
 = 
	`¬¿y_keys
(
$u£r
->
rŞes
);

433 
$»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
("SELECT DISTINCT b.* FROM {blocks} b LEFT JOIN {blocks_rŞes}„ ON b.moduË =„.moduË AND b.d– =„.d– WHERE b.themğ'%s' AND b.¡©u ğ1 AND (r.rid IN (". 
	`db_¶aûhŞd”s
(
$rids
è."èOR„.rid IS NULLèORDER BY b.»giÚ, b.weight, b.moduË", 'b', 'bid'), 
	`¬¿y_m”ge
(
	`¬¿y
(
$theme_key
), $rids));

434 
$block
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

435 ià(!
	`is£t
(
$blocks
[
$block
->
»giÚ
])) {

436 
$blocks
[
$block
->
»giÚ
] = 
	`¬¿y
();

439 ià(
$block
->
cu¡om
 != 0) {

440 ià(
$u£r
->
uid
 && 
	`is£t
($u£r->
block
[
$block
->
moduË
][$block->
d–
])) {

441 
$’abËd
 = 
$u£r
->
block
[
$block
->
moduË
][$block->
d–
];

444 
$’abËd
 = (
$block
->
cu¡om
 == 1);

448 
$’abËd
 = 
TRUE
;

452 ià(
$block
->
·ges
) {

453 ià(
$block
->
visib™y
 < 2) {

454 
$·th
 = 
	`dru·l_g‘_·th_®Ÿs
(
$_GET
['q']);

456 
$·ge_m©ch
 = 
	`dru·l_m©ch_·th
(
$·th
, 
$block
->
·ges
);

457 ià(
$·th
 !ğ
$_GET
['q']) {

458 
$·ge_m©ch
 = $·ge_m©ch || 
	`dru·l_m©ch_·th
(
$_GET
['q'], 
$block
->
·ges
);

463 
$·ge_m©ch
 = !(
$block
->
visib™y
 
xÜ
 $page_match);

466 
$·ge_m©ch
 = 
	`dru·l_ev®
(
$block
->
·ges
);

470 
$·ge_m©ch
 = 
TRUE
;

472 
$block
->
’abËd
 = 
$’abËd
;

473 
$block
->
·ge_m©ch
 = 
$·ge_m©ch
;

474 
$blocks
[
$block
->
»giÚ
]["{$block->module}_{$block->delta}"] = $block;

479 ià(!
	`is£t
(
$blocks
[
$»giÚ
])) {

480 
$blocks
[
$»giÚ
] = 
	`¬¿y
();

483 
	`fÜ—ch
 (
$blocks
[
$»giÚ
] 
as
 
$key
 => 
$block
) {

485 ià(!
	`is£t
(
$block
->
cÚ‹Á
)) {

487 
	`un£t
(
$blocks
[
$»giÚ
][
$key
]);

488 ià(
$block
->
’abËd
 && $block->
·ge_m©ch
) {

491 ià(!(
$block
->
thrÙe
 && (
	`moduË_švoke
('throttle', 'status') > 0))) {

495 ià(!
	`couÁ
(
	`moduË_im¶em’ts
('node_g¿Ás')è&& 
$_SERVER
['REQUEST_METHOD'] =ğ'GET' && (
$cid
 = 
	`_block_g‘_ÿche_id
(
$block
)è&& (
$ÿche
 = 
	`ÿche_g‘
($cid, 'cache_block'))) {

496 
$¬¿y
 = 
$ÿche
->
d©a
;

499 
$¬¿y
 = 
	`moduË_švoke
(
$block
->
moduË
, 'block', 'v›w', $block->
d–
);

500 ià(
	`is£t
(
$cid
)) {

501 
	`ÿche_£t
(
$cid
, 
$¬¿y
, 'ÿche_block', 
CACHE_TEMPORARY
);

505 ià(
	`is£t
(
$¬¿y
è&& 
	`is_¬¿y
($array)) {

506 
	`fÜ—ch
 (
$¬¿y
 
as
 
$k
 => 
$v
) {

507 
$block
->
$k
 = 
$v
;

511 ià(
	`is£t
(
$block
->
cÚ‹Á
) && $block->content) {

513 ià(
$block
->
t™Ë
) {

515 
$block
->
subjeù
 = $block->
t™Ë
 =ğ'<nÚe>' ? '' : 
	`check_¶aš
($block->title);

517 ià(!
	`is£t
(
$block
->
subjeù
)) {

518 
$block
->
subjeù
 = '';

520 
$blocks
[
$block
->
»giÚ
]["{$block->module}_{$block->delta}"] = $block;

525  
$blocks
[
$»giÚ
];

526 
	}
}

543 
funùiÚ
 
	$_block_g‘_ÿche_id
(
$block
) {

544 
glob®
 
$theme
, 
$ba£_roÙ
, 
$u£r
;

550 ià(
	`v¬ŸbË_g‘
('block_ÿche', 0è&& 
$block
->
ÿche
 !ğ
BLOCK_NO_CACHE
 && 
$u£r
->
uid
 != 1) {

551 
$cid_·¹s
 = 
	`¬¿y
();

554 
$cid_·¹s
[] = 
$block
->
moduË
;

555 
$cid_·¹s
[] = 
$block
->
d–
;

556 
$cid_·¹s
[] = 
$theme
;

557 ià(
	`moduË_exi¡s
('locale')) {

558 
glob®
 
$Ïnguage
;

559 
$cid_·¹s
[] = 
$Ïnguage
->
Ïnguage
;

565 ià(
$block
->
ÿche
 & 
BLOCK_CACHE_PER_ROLE
) {

566 
$cid_·¹s
[] = 'r.'. 
	`im¶ode
(',', 
	`¬¿y_keys
(
$u£r
->
rŞes
));

568 
	`–£if
 (
$block
->
ÿche
 & 
BLOCK_CACHE_PER_USER
) {

569 
$cid_·¹s
[] = "u.$user->uid";

572 ià(
$block
->
ÿche
 & 
BLOCK_CACHE_PER_PAGE
) {

573 
$cid_·¹s
[] = 
$ba£_roÙ
 . 
	`»que¡_uri
();

576  
	`im¶ode
(':', 
$cid_·¹s
);

578 
	}
}

	@/srv/http/subs/notes/www/modules/blog/blog.module

1 <?
php


12 
funùiÚ
 
	$blog_node_šfo
() {

13  
	`¬¿y
(

14 'blog' => 
	`¬¿y
(

15 'Çme' => 
	`t
('Blogƒntry'),

17 'desütiÚ' => 
	`t
('A <em>blogƒntry</em> is‡ single…osto‡n online journal, or <em>blog</em>.'),

20 
	}
}

25 
funùiÚ
 
	$blog_³rm
() {

26  
	`¬¿y
('create blogƒntries', 'delete own blogƒntries', 'delete‡ny blogƒntry', 'edit own blogƒntries', 'edit‡ny blogƒntry');

27 
	}
}

32 
funùiÚ
 
	$blog_acûss
(
$İ
, 
$node
, 
$accouÁ
) {

33 
$İ
) {

36  
	`u£r_acûss
('ü—‹ blogƒÁr›s', 
$accouÁ
è&& $accouÁ->
uid
 ? 
TRUE
 : 
NULL
;

38  
	`u£r_acûss
('ed™‡ny blogƒÁry', 
$accouÁ
è|| (u£r_acûss('ed™ owÀblogƒÁr›s', $accouÁè&& (
$node
->
uid
 =ğ$accouÁ->uid)è? 
TRUE
 : 
NULL
;

40  
	`u£r_acûss
('d–‘ªy blogƒÁry', 
$accouÁ
è|| (u£r_acûss('d–‘owÀblogƒÁr›s', $accouÁè&& (
$node
->
uid
 =ğ$accouÁ->uid)è? 
TRUE
 : 
NULL
;

42 
	}
}

47 
funùiÚ
 
	$blog_u£r
(
$ty³
, &
$ed™
, &
$u£r
) {

48 ià(
$ty³
 =ğ'v›w' && 
	`u£r_acûss
('ü—‹ blogƒÁr›s', 
$u£r
)) {

49 
$u£r
->
cÚ‹Á
['summ¬y']['blog'] = 
	`¬¿y
(

51 '#t™Ë' => 
	`t
('Blog'),

53 '#v®ue' => 
	`l
(
	`t
('V›w„eûÁ blogƒÁr›s'), "blog/$u£r->uid", 
	`¬¿y
('©Œibu‹s' =>‡¼ay('t™Ë' =>("R—d !u£ºame' Ï‹¡ blogƒÁr›s.",‡¼ay('!u£ºame' => 
$u£r
->
Çme
))))),

54 '#©Œibu‹s' => 
	`¬¿y
('class' => 'blog'),

57 
	}
}

62 
funùiÚ
 
	$blog_h–p
(
$·th
, 
$¬g
) {

63 
$·th
) {

65 
$ouut
 = '<p>'. 
	`t
('The blog module‡llows„egistered userso maintain‡n online journal, or <em>blog</em>. Blogs‡re made up of individual <em>blogƒntries</em>,‡ndhe blogƒntries‡re most often displayed in descending order by creationime.') .'</p>';

66 
$ouut
 .ğ'<p>'. 
	`t
('There is‡n (optional) <em>Blogs</em> menu item‡ddedohe Navigation menu, which displays‡ll blogs‡vailable on your site,‡nd‡ <em>My blog</em> item displayinghe current user\'s blogƒntries. The <em>Blogƒntry</em> menu item under <em>Create content</em>‡llows‚ew blogƒntrieso be created.') .'</p>';

67 
$ouut
 .ğ'<p>'. 
	`t
('Each blogƒÁry i di¥Ïyed w™h‡Àautom©iølškØÙh” blog ü—‹d byh§mu£r. By deçuÉ, blogƒÁr› havcomm’t ’abËd‡nd‡»‡utom©iÿÎy…romÙedØths™äÚˆ·ge. Thblog moduË‡lsØü—‹ ¨<em>ReûÁ blog…o¡s</em> blockh© may b’abËd‡ˆth<¨h»f="@blocks">block admši¡¿tiÚ…age</a>.', 
	`¬¿y
('@blocks' => 
	`u¾
('admin/build/block'))) .'</p>';

68 
$ouut
 .ğ'<p>'. 
	`t
('Wh’ usšghagg»g©Ü moduË‡Àautom©iø<em>blog it</em> icÚ i di¥Ïyed‚exˆtØth™em š‡ f“d\' <em>Ï‹¡ i‹ms</em> block. Clickšghi icÚ…İuÏ‹ ¨<em>blogƒÁry</em> w™h‡™Ë (tht™Ë oàthãed i‹mèªd body (¨lškØthsourû i‹m oÀ™ Üigš® s™ªd iÎu¡¿tivcÚ‹Á su™abË fÜ u£ iÀ¨block quÙe). Blog‡uthÜ ÿÀu£hi ã©u»Ø—sy comm’ˆÚ i‹m oàš‹»¡h©‡µ—¸š‡gg»g©Ü f“d äom oth” s™es. TØu£hi ã©u», bsu»Ø<¨h»f="@moduËs">’abË</a>hagg»g©Ü moduË, <¨h»f="@ãeds">add‡nd cÚfigu»</a>‡ f“d from‡nÙh” s™e,‡nd <¨h»f="@blocks">pos™iÚ</a>hãed\' <em>Ï‹¡ i‹ms</em> block.', 
	`¬¿y
('@moduËs' => 
	`u¾
('admin/build/modules'), '@feeds' => url('admin/content/aggregator'), '@blocks' => url('admin/build/block'))) .'</p>';

69 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@blog">Blog moduË</a>.', 
	`¬¿y
('@blog' => 'http://drupal.org/handbook/modules/blog/')) .'</p>';

70  
$ouut
;

72 
	}
}

77 
funùiÚ
 
	$blog_fÜm
(&
$node
) {

78 
glob®
 
$nid
;

79 
$iid
 = 
	`is£t
(
$_GET
['iid']) ? ()$_GET['iid'] : 0;

80 
$ty³
 = 
	`node_g‘_ty³s
('ty³', 
$node
);

83 ià(
	`em±y
(
$node
->
body
)) {

86 ià(
$nid
 && 
$blog
 = 
	`node_lßd
($nid)) {

87 
$node
->
body
 = '<em>'. 
$blog
->body .'</em> ['. 
	`l
($blog->
Çme
, "node/$nid") .']';

90 ià(
$iid
 && 
$™em
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT i.*, f.title‡s ftitle, f.link‡s flink FROM {aggregator_item} i, {aggregator_feed} f WHERE i.iid = %d AND i.fid = f.fid', $iid))) {

91 
$node
->
t™Ë
 = 
$™em
->title;

93 
$node
->
body
 = '<¨h»f="'. 
	`check_u¾
(
$™em
->
lšk
è.'">'. 
	`check_¶aš
($™em->
t™Ë
è.'</a> - <em>'. $™em->
desütiÚ
 .'</em> [<¨h»f="'. check_u¾($™em->
æšk
è.'">'. check_¶aš($™em->
á™Ë
) ."</a>]\n";

98 
$fÜm
['t™Ë'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => 
	`check_¶aš
(
$ty³
->
t™Ë_Ïb–
), '#»quœed' => 
TRUE
, '#deçuÉ_v®ue' => !
	`em±y
(
$node
->
t™Ë
è? $node->t™Ë : 
NULL
, '#weight' => -5);

99 
$fÜm
['body_f›ld'] = 
	`node_body_f›ld
(
$node
, 
$ty³
->
body_Ïb–
, $ty³->
mš_wÜd_couÁ
);

100  
$fÜm
;

101 
	}
}

106 
funùiÚ
 
	$blog_v›w
(
$node
, 
$‹a£r
 = 
FALSE
, 
$·ge
 = FALSE) {

107 ià(
$·ge
) {

109 
	`dru·l_£t_b»adüumb
(
	`¬¿y
(
	`l
(
	`t
('Home'), 
NULL
),†Ñ('Blogs'), 'blog'),†Ñ("!Çme' blog",‡¼ay('!Çme' => 
$node
->
Çme
)), 'blog/'. $node->
uid
)));

111  
	`node_´•¬e
(
$node
, 
$‹a£r
);

112 
	}
}

117 
funùiÚ
 
	$blog_lšk
(
$ty³
, 
$node
 = 
NULL
, 
$‹a£r
 = 
FALSE
) {

118 
$lšks
 = 
	`¬¿y
();

120 ià(
$ty³
 =ğ'node' && 
$node
->
ty³
 == 'blog') {

121 ià(
	`¬g
(0è!ğ'blog' ||‡rg(1è!ğ
$node
->
uid
) {

123 
$lšks
['blog_u£ºames_blog'] = 
	`¬¿y
(

124 't™Ë' => 
	`t
("!u£ºame' blog", 
	`¬¿y
('!u£ºame' => 
$node
->
Çme
)),

126 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
	`t
("R—d !u£ºame' Ï‹¡ blogƒÁr›s.",‡¼ay('!u£ºame' => 
$node
->
Çme
)))

131  
$lšks
;

132 
	}
}

137 
funùiÚ
 
	$blog_m’u
() {

138 
$™ems
['blog'] = 
	`¬¿y
(

141 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

142 'ty³' => 
MENU_SUGGESTED_ITEM
,

145 
$™ems
['blog/%u£r_uid_İtiÚ®'] = 
	`¬¿y
(

148 '·g¬gum’ts' => 
	`¬¿y
(1),

150 'acûs ¬gum’ts' => 
	`¬¿y
(1),

153 
$™ems
['blog/%u£r/ãed'] = 
	`¬¿y
(

156 '·g¬gum’ts' => 
	`¬¿y
(1),

158 'acûs ¬gum’ts' => 
	`¬¿y
(1),

159 'ty³' => 
MENU_CALLBACK
,

162 
$™ems
['blog/ãed'] = 
	`¬¿y
(

165 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

166 'ty³' => 
MENU_CALLBACK
,

170  
$™ems
;

171 
	}
}

176 
funùiÚ
 
	$blog_·ge_u£r_acûss
(
$accouÁ
) {

180  
$accouÁ
->
uid
 && 
	`u£r_acûss
('acûs cÚ‹Á'è&& (u£r_acûss('ü—‹ blogƒÁr›s', $accouÁè|| 
	`_blog_po¡_exi¡s
($account));

181 
	}
}

186 
funùiÚ
 
	$_blog_po¡_exi¡s
(
$accouÁ
) {

187  (
boŞ
)
	`db_»suÉ
(
	`db_qu”y_¿nge
(
	`db_»wr™e_sql
("SELECT 1 FROM {node}‚ WHERE‚.ty³ = 'blog' AND‚.uid = %d AND‚.¡©u ğ1"), 
$accouÁ
->
uid
, 0, 1));

188 
	}
}

195 
funùiÚ
 
blog_block
(
$İ
 = 'li¡', 
$d–
 = 0) {

196 
glob®
 
$u£r
;

197 ià(
	g$İ
 == 'list') {

198 
$block
[0]['šfo'] = 
t
('Recent blog…osts');

199  
	g$block
;

201 ià(
	g$İ
 == 'view') {

202 ià(
u£r_acûss
('access content')) {

203 
$»suÉ
 = 
db_qu”y_¿nge
(
db_»wr™e_sql
("SELECT‚.nid,‚.title,‚.created FROM {node}‚ WHERE‚.type = 'blog' AND‚.status = 1 ORDER BY‚.created DESC"), 0, 10);

204 ià(
	g$node_t™Ë_li¡
 = 
node_t™Ë_li¡
(
$»suÉ
)) {

205 
$block
['cÚ‹Á'] = 
$node_t™Ë_li¡
;

206 
	g$block
['cÚ‹Á'] .ğ
theme
('mÜe_lšk', 
u¾
('blog'), 
t
('Readhe†atest blogƒntries.'));

207 
	g$block
['subjeù'] = 
t
('Recent blog…osts');

208  
	g$block
;

	@/srv/http/subs/notes/www/modules/blog/blog.pages.inc

1 <?
php


12 
funùiÚ
 
	$blog_·ge_u£r
(
$accouÁ
) {

13 
glob®
 
$u£r
;

15 
	`dru·l_£t_t™Ë
(
$t™Ë
 = 
	`t
("@Çme' blog", 
	`¬¿y
('@Çme' => 
$accouÁ
->
Çme
)));

17 
$™ems
 = 
	`¬¿y
();

19 ià((
$accouÁ
->
uid
 =ğ
$u£r
->uidè&& 
	`u£r_acûss
('create blogƒntries')) {

20 
$™ems
[] = 
	`l
(
	`t
('Post‚ew blogƒntry.'), "node/add/blog");

22 ià(
$accouÁ
->
uid
 =ğ
$u£r
->uid) {

23 
$™ems
[] = 
	`t
('You‡re‚ot‡llowedo…ost‡‚ew blogƒntry.');

26 
$ouut
 = 
	`theme
('™em_li¡', 
$™ems
);

28 
$»suÉ
 = 
	`·g”_qu”y
(
	`db_»wr™e_sql
("SELECT‚.nid,‚.¡icky,‚.ü—‹d FROM {node}‚ WHERE‚.ty³ = 'blog' AND‚.uid = %d AND‚.¡©u ğ1 ORDER BY‚.¡icky DESC,‚.ü—‹d DESC"), 
	`v¬ŸbË_g‘
('deçuÉ_nodes_maš', 10), 0, 
NULL
, 
$accouÁ
->
uid
);

29 
$has_po¡s
 = 
FALSE
;

31 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

32 
$ouut
 .ğ
	`node_v›w
(
	`node_lßd
(
$node
->
nid
), 1);

33 
$has_po¡s
 = 
TRUE
;

36 ià(
$has_po¡s
) {

37 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 
	`v¬ŸbË_g‘
('default_nodes_main', 10));

40 ià(
$accouÁ
->
uid
 =ğ
$u£r
->uid) {

41 
	`dru·l_£t_mes§ge
(
	`t
('You have‚ot created‡ny blogƒntries.'));

44 
	`dru·l_£t_mes§ge
(
	`t
('!authÜ ha nÙ c»©ed‡ny blogƒÁr›s.', 
	`¬¿y
('!authÜ' => 
	`theme
('u£ºame', 
$accouÁ
))));

47 
	`dru·l_add_ãed
(
	`u¾
('blog/'. 
$accouÁ
->
uid
 .'/ãed'), 
	`t
('RSS - !t™Ë', 
	`¬¿y
('!t™Ë' => 
$t™Ë
)));

49  
$ouut
;

50 
	}
}

55 
funùiÚ
 
	$blog_·ge_Ï¡
() {

56 
glob®
 
$u£r
;

58 
$ouut
 = '';

59 
$™ems
 = 
	`¬¿y
();

61 ià(
	`u£r_acûss
('create blogƒntries')) {

62 
$™ems
[] = 
	`l
(
	`t
('Create‚ew blogƒntry.'), "node/add/blog");

65 
$ouut
 = 
	`theme
('™em_li¡', 
$™ems
);

67 
$»suÉ
 = 
	`·g”_qu”y
(
	`db_»wr™e_sql
("SELECT‚.nid,‚.ü—‹d FROM {node}‚ WHERE‚.ty³ = 'blog' AND‚.¡©u ğ1 ORDER BY‚.¡icky DESC,‚.ü—‹d DESC"), 
	`v¬ŸbË_g‘
('default_nodes_main', 10));

68 
$has_po¡s
 = 
FALSE
;

70 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

71 
$ouut
 .ğ
	`node_v›w
(
	`node_lßd
(
$node
->
nid
), 1);

72 
$has_po¡s
 = 
TRUE
;

75 ià(
$has_po¡s
) {

76 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 
	`v¬ŸbË_g‘
('default_nodes_main', 10));

79 
	`dru·l_£t_mes§ge
(
	`t
('No blogƒntries have been created.'));

81 
	`dru·l_add_ãed
(
	`u¾
('blog/ãed'), 
	`t
('RSS - blogs'));

83  
$ouut
;

84 
	}
}

89 
funùiÚ
 
	$blog_ãed_u£r
(
$accouÁ
) {

90 
$»suÉ
 = 
	`db_qu”y_¿nge
(
	`db_»wr™e_sql
("SELECT‚.nid,‚.ü—‹d FROM {node}‚ WHERE‚.ty³ = 'blog' AND‚.uid = %d AND‚.¡©u ğ1 ORDER BY‚.ü—‹d DESC"), 
$accouÁ
->
uid
, 0, 
	`v¬ŸbË_g‘
('feed_default_items', 10));

91 
$chªÃl
['t™Ë'] = 
	`t
("!Çme' blog", 
	`¬¿y
('!Çme' => 
$accouÁ
->
Çme
));

92 
$chªÃl
['lšk'] = 
	`u¾
('blog/'. 
$accouÁ
->
uid
, 
	`¬¿y
('absŞu‹' => 
TRUE
));

94 
$™ems
 = 
	`¬¿y
();

95 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

96 
$™ems
[] = 
$row
->
nid
;

98 
	`node_ãed
(
$™ems
, 
$chªÃl
);

99 
	}
}

104 
funùiÚ
 
	$blog_ãed_Ï¡
() {

105 
$»suÉ
 = 
	`db_qu”y_¿nge
(
	`db_»wr™e_sql
("SELECT‚.nid,‚.ü—‹d FROM {node}‚ WHERE‚.ty³ = 'blog' AND‚.¡©u ğ1 ORDER BY‚.ü—‹d DESC"), 0, 
	`v¬ŸbË_g‘
('feed_default_items', 10));

106 
$chªÃl
['t™Ë'] = 
	`t
('!s™e_Çmblogs', 
	`¬¿y
('!s™e_Çme' => 
	`v¬ŸbË_g‘
('site_name', 'Drupal')));

107 
$chªÃl
['lšk'] = 
	`u¾
('blog', 
	`¬¿y
('absŞu‹' => 
TRUE
));

109 
$™ems
 = 
	`¬¿y
();

110 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

111 
$™ems
[] = 
$row
->
nid
;

114 
	`node_ãed
(
$™ems
, 
$chªÃl
);

115 
	}
}

	@/srv/http/subs/notes/www/modules/blogapi/blogapi.module

1 <?
php


12 
funùiÚ
 
	$blog­i_h–p
(
$·th
, 
$¬g
) {

13 
$·th
) {

15 
$ouut
 = '<p>'. 
	`t
("The Blog API module‡llows your site's userso‡ccess‡nd…ostoheir blogs fromƒxternal blogging clients. External blogging clients‡re‡vailable for‡ wide„ange of desktop operating systems,‡nd generally…rovide‡ feature-rich graphicalƒnvironment for creating‡ndƒditing…osts.") .'</p>';

16 
$ouut
 .ğ'<p>'. 
	`t
('<¨h»f="@eùo-lšk">Eùo</a>,‡ bloggšg cl›Á‡vaabË fÜ bÙh MaøOS X‡nd Miüosoá Wšdows, cª bu£d w™h Blog API. Blog API‡lsØsuµÜt <¨h»f="@blogg”-­i">Blogg” API</a>, <¨h»f="@m‘aweblog-­i">M‘aWeblog API</a>,‡nd mo¡ oàth<¨h»f="@movabËty³-­i">MovabË Ty³ API</a>. Bloggšg cl›Á ªd oth” s”viû Ó.g. <¨h»f="@æickr">Flickr\'s</a> "po¡Øblog"èth© suµÜˆthe£ API may‡lsØbcom·tibË.', 
	`¬¿y
('@eùo-lšk' => 
	`u¾
('http://infinite-sushi.com/software/ecto/'), '@blogger-api' => url('http://www.blogger.com/developers/api/1_docs/'), '@metaweblog-api' => url('http://www.xmlrpc.com/metaWeblogApi'), '@movabletype-api' => url('http://www.movabletype.org/docs/mtmanual_programmatic.html'), '@flickr' => url('http://www.flickr.com'))) .'</p>';

17 
$ouut
 .ğ'<p>'. 
	`t
('S–eùhcÚ‹Áy³ avaabËØex‹º® cl›Á Úh<¨h»f="@blog­i-£‰šgs">Blog API s‘tšg ·ge</a>. IàsuµÜ‹d‡nd‡vaabË,ƒach cÚ‹Áy³ wÈbdi¥Ïyed‡ ¨£·¿‹ "blog" byhex‹º® cl›Á.', 
	`¬¿y
('@blog­i-£‰šgs' => 
	`u¾
('admin/settings/blogapi'))) .'</p>';

18 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@blog­i">Blog API moduË</a>.', 
	`¬¿y
('@blog­i' => 
	`u¾
('http://drupal.org/handbook/modules/blogapi/'))) .'</p>';

19  
$ouut
;

21 
	}
}

26 
funùiÚ
 
	$blog­i_³rm
() {

27  
	`¬¿y
('administer content with blog‡pi');

28 
	}
}

33 
funùiÚ
 
	$blog­i_xmÌpc
() {

34  
	`¬¿y
(

35 
	`¬¿y
(

38 
	`¬¿y
('array', 'string', 'string', 'string'),

39 
	`t
('Returns‡†ist of blogso which‡n‡uthor has…osting…rivileges.')),

40 
	`¬¿y
(

43 
	`¬¿y
('struct', 'string', 'string', 'string'),

44 
	`t
('Returns information‡bout‡n‡uthor inhe system.')),

45 
	`¬¿y
(

48 
	`¬¿y
('string', 'string', 'string', 'string', 'string', 'string', 'boolean'),

49 
	`t
('Creates‡‚ew…ost,‡nd optionally…ublishes it.')),

50 
	`¬¿y
(

53 
	`¬¿y
('boolean', 'string', 'string', 'string', 'string', 'string', 'boolean'),

54 
	`t
('Updateshe information‡bout‡nƒxisting…ost.')),

55 
	`¬¿y
(

58 
	`¬¿y
('struct', 'string', 'string', 'string', 'string'),

59 
	`t
('Returns information‡bout‡ specific…ost.')),

60 
	`¬¿y
(

63 
	`¬¿y
('boolean', 'string', 'string', 'string', 'string', 'boolean'),

64 
	`t
('Deletes‡…ost.')),

65 
	`¬¿y
(

68 
	`¬¿y
('array', 'string', 'string', 'string', 'string', 'int'),

69 
	`t
('Returns‡†ist ofhe most„ecent…osts inhe system.')),

70 
	`¬¿y
(

73 
	`¬¿y
('string', 'string', 'string', 'string', 'struct', 'boolean'),

74 
	`t
('Creates‡‚ew…ost,‡nd optionally…ublishes it.')),

75 
	`¬¿y
(

78 
	`¬¿y
('boolean', 'string', 'string', 'string', 'struct', 'boolean'),

79 
	`t
('Updates information‡bout‡nƒxisting…ost.')),

80 
	`¬¿y
(

83 
	`¬¿y
('struct', 'string', 'string', 'string'),

84 
	`t
('Returns information‡bout‡ specific…ost.')),

85 
	`¬¿y
(

88 
	`¬¿y
('string', 'string', 'string', 'string', 'struct'),

89 
	`t
('Uploads‡ fileo your webserver.')),

90 
	`¬¿y
(

93 
	`¬¿y
('struct', 'string', 'string', 'string'),

94 
	`t
('Returns‡†ist of‡ll categorieso whichhe…ost is‡ssigned.')),

95 
	`¬¿y
(

98 
	`¬¿y
('array', 'string', 'string', 'string', 'int'),

99 
	`t
('Returns‡†ist ofhe most„ecent…osts inhe system.')),

100 
	`¬¿y
(

103 
	`¬¿y
('array', 'string', 'string', 'string', 'int'),

104 
	`t
('Returns‡ bandwidth-friendly†ist ofhe most„ecent…osts inhe system.')),

105 
	`¬¿y
(

108 
	`¬¿y
('array', 'string', 'string', 'string'),

109 
	`t
('Returns‡†ist of‡ll categories defined inhe blog.')),

110 
	`¬¿y
(

113 
	`¬¿y
('array', 'string', 'string', 'string'),

114 
	`t
('Returns‡†ist of‡ll categorieso whichhe…ost is‡ssigned.')),

115 
	`¬¿y
(

118 
	`¬¿y
('boolean', 'string', 'string', 'string', 'array'),

119 
	`t
('Setshe categories for‡…ost.')),

120 
	`¬¿y
(

123 
	`¬¿y
('array'),

124 
	`t
('Retrieve information‡bouthe XML-RPC methods supported byhe server.')),

125 
	`¬¿y
(

128 
	`¬¿y
('array'),

129 
	`t
('Retrieve information‡boutheext formatting…lugins supported byhe server.')),

130 
	`¬¿y
(

133 
	`¬¿y
('boolean', 'string', 'string', 'string'),

134 
	`t
('Publish (rebuild)‡ll ofhe static files„elatedo‡nƒntry from your blog. Equivalento saving‡nƒntry inhe system (but withouthe…ing).')));

135 
	}
}

141 
funùiÚ
 
	$blog­i_blogg”_g‘_u£rs_blogs
(
$­pid
, 
$u£ºame
, 
$·sswÜd
) {

143 
$u£r
 = 
	`blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
);

144 ià(
$u£r
->
uid
) {

145 
$ty³s
 = 
	`_blog­i_g‘_node_ty³s
();

146 
$¡ruùs
 = 
	`¬¿y
();

147 
	`fÜ—ch
 (
$ty³s
 
as
 
$ty³
) {

148 
$¡ruùs
[] = 
	`¬¿y
('u¾' => 
	`u¾
('blog/'. 
$u£r
->
uid
,‡¼ay('absŞu‹' => 
TRUE
)), 'blogid' => 
$ty³
, 'blogName' => $u£r->
Çme
 .": ". $type);

150  
$¡ruùs
;

153  
	`blog­i_”rÜ
(
$u£r
);

155 
	}
}

160 
funùiÚ
 
	$blog­i_blogg”_g‘_u£r_šfo
(
$­pkey
, 
$u£ºame
, 
$·sswÜd
) {

161 
$u£r
 = 
	`blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
);

163 ià(
$u£r
->
uid
) {

164 
$Çme
 = 
	`ex¶ode
(' ', 
$u£r
->
»®Çme
 ? $u£r->»®Çm: $u£r->
Çme
, 2);

165  
	`¬¿y
(

166 'u£rid' => 
$u£r
->
uid
,

167 'Ï¡Çme' => 
$Çme
[1],

168 'fœ¡Çme' => 
$Çme
[0],

169 'nickÇme' => 
$u£r
->
Çme
,

170 'ema' => 
$u£r
->
ma
,

171 'u¾' => 
	`u¾
('blog/'. 
$u£r
->
uid
, 
	`¬¿y
('absŞu‹' => 
TRUE
)));

174  
	`blog­i_”rÜ
(
$u£r
);

176 
	}
}

181 
funùiÚ
 
	$blog­i_blogg”_Ãw_po¡
(
$­pkey
, 
$blogid
, 
$u£ºame
, 
$·sswÜd
, 
$cÚ‹Á
, 
$publish
) {

182 
$u£r
 = 
	`blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
);

183 ià(!
$u£r
->
uid
) {

184  
	`blog­i_”rÜ
(
$u£r
);

187 ià((
$”rÜ
 = 
	`_blog­i_v®id©e_blogid
(
$blogid
)è!=ğ
TRUE
) {

189  
$”rÜ
;

192 
$ed™
 = 
	`¬¿y
();

193 
$ed™
['ty³'] = 
$blogid
;

195 
$node_ty³_deçuÉ
 = 
	`v¬ŸbË_g‘
('node_İtiÚs_'. 
$ed™
['ty³'], 
	`¬¿y
('status', 'promote'));

196 
$ed™
['uid'] = 
$u£r
->
uid
;

197 
$ed™
['Çme'] = 
$u£r
->
Çme
;

198 
$ed™
['´omÙe'] = 
	`š_¬¿y
('´omÙe', 
$node_ty³_deçuÉ
);

199 
$ed™
['comm’t'] = 
	`v¬ŸbË_g‘
('comment_'. $edit['type'], 2);

200 
$ed™
['»visiÚ'] = 
	`š_¬¿y
('»visiÚ', 
$node_ty³_deçuÉ
);

201 
$ed™
['fÜm©'] = 
FILTER_FORMAT_DEFAULT
;

202 
$ed™
['¡©us'] = 
$publish
;

205 ià(
	`is_¬¿y
(
$cÚ‹Á
)) {

206 
$ed™
['t™Ë'] = 
$cÚ‹Á
['title'];

207 
$ed™
['body'] = 
$cÚ‹Á
['description'];

208 
	`_blog­i_mt_exŒa
(
$ed™
, 
$cÚ‹Á
);

211 
$ed™
['t™Ë'] = 
	`blog­i_blogg”_t™Ë
(
$cÚ‹Á
);

212 
$ed™
['body'] = 
$cÚ‹Á
;

215 ià(!
	`node_acûss
('ü—‹', 
$ed™
['type'])) {

216  
	`blog­i_”rÜ
(
	`t
('You do‚ot have…ermissiono createhisype of…ost.'));

219 ià(
	`u£r_acûss
('admši¡”‚odes'è&& !
	`is£t
(
$ed™
['date'])) {

220 
$ed™
['d©e'] = 
	`fÜm©_d©e
(
	`time
(), 'custom', 'Y-m-d H:i:s O');

223 
	`node_švoke_nod—pi
(
$ed™
, 'blogapi‚ew');

225 
$v®id
 = 
	`blog­i_¡©us_”rÜ_check
(
$ed™
, 
$publish
);

226 ià(
$v®id
 !=ğ
TRUE
) {

227  
$v®id
;

230 
	`node_v®id©e
(
$ed™
);

231 ià(
$”rÜs
 = 
	`fÜm_g‘_”rÜs
()) {

232  
	`blog­i_”rÜ
(
	`im¶ode
("\n", 
$”rÜs
));

235 
$node
 = 
	`node_subm™
(
$ed™
);

236 
	`node_§ve
(
$node
);

237 ià(
$node
->
nid
) {

238 
	`w©chdog
('cÚ‹Á', '@ty³:‡dded %t™Ë usšg blog API.', 
	`¬¿y
('@ty³' => 
$node
->
ty³
, '%t™Ë' => $node->
t™Ë
), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('view'), "node/$node->nid"));

243  
	`blog­i_”rÜ
(
	`t
('Error storing…ost.'));

244 
	}
}

249 
funùiÚ
 
	$blog­i_blogg”_ed™_po¡
(
$­pkey
, 
$po¡id
, 
$u£ºame
, 
$·sswÜd
, 
$cÚ‹Á
, 
$publish
) {

251 
$u£r
 = 
	`blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
);

253 ià(!
$u£r
->
uid
) {

254  
	`blog­i_”rÜ
(
$u£r
);

257 
$node
 = 
	`node_lßd
(
$po¡id
);

258 ià(!
$node
) {

259  
	`blog­i_”rÜ
(
	`t
('n/a'));

262 
	`un£t
(
$node
->
‹a£r
);

264 ià(!
	`node_acûss
('upd©e', 
$node
)) {

265  
	`blog­i_”rÜ
(
	`t
('You do‚ot have…ermissiono updatehis…ost.'));

268 
$Üigš®_¡©us
 = 
$node
->
¡©us
;

269 
$node
->
¡©us
 = 
$publish
;

272 ià(
	`is_¬¿y
(
$cÚ‹Á
)) {

273 
$node
->
t™Ë
 = 
$cÚ‹Á
['title'];

274 
$node
->
body
 = 
$cÚ‹Á
['description'];

275 
	`_blog­i_mt_exŒa
(
$node
, 
$cÚ‹Á
);

278 
$node
->
t™Ë
 = 
	`blog­i_blogg”_t™Ë
(
$cÚ‹Á
);

279 
$node
->
body
 = 
$cÚ‹Á
;

282 
	`node_švoke_nod—pi
(
$node
, 'blogapiƒdit');

284 
$v®id
 = 
	`blog­i_¡©us_”rÜ_check
(
$node
, 
$Üigš®_¡©us
);

285 ià(
$v®id
 !=ğ
TRUE
) {

286  
$v®id
;

289 
	`node_v®id©e
(
$node
);

290 ià(
$”rÜs
 = 
	`fÜm_g‘_”rÜs
()) {

291  
	`blog­i_”rÜ
(
	`im¶ode
("\n", 
$”rÜs
));

294 ià(
	`u£r_acûss
('admši¡”‚odes'è&& !
	`is£t
(
$ed™
['date'])) {

295 
$node
->
d©e
 = 
	`fÜm©_d©e
($node->
ü—‹d
, 'custom', 'Y-m-d H:i:s O');

297 
$node
 = 
	`node_subm™
($node);

298 
	`node_§ve
(
$node
);

299 ià(
$node
->
nid
) {

300 
	`w©chdog
('cÚ‹Á', '@ty³: upd©ed %t™Ë usšg Blog API.', 
	`¬¿y
('@ty³' => 
$node
->
ty³
, '%t™Ë' => $node->
t™Ë
), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('view'), "node/$node->nid"));

301  
TRUE
;

304  
	`blog­i_”rÜ
(
	`t
('Error storing…ost.'));

305 
	}
}

310 
funùiÚ
 
	$blog­i_blogg”_g‘_po¡
(
$­pkey
, 
$po¡id
, 
$u£ºame
, 
$·sswÜd
) {

311 
$u£r
 = 
	`blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
);

312 ià(!
$u£r
->
uid
) {

313  
	`blog­i_”rÜ
(
$u£r
);

316 
$node
 = 
	`node_lßd
(
$po¡id
);

318  
	`_blog­i_g‘_po¡
(
$node
, 
TRUE
);

319 
	}
}

327 
funùiÚ
 
	$blog­i_¡©us_”rÜ_check
(
$node
, 
$Üigš®_¡©us
) {

329 
$node
 = (
objeù
) $node;

331 
$node_ty³_deçuÉ
 = 
	`v¬ŸbË_g‘
('node_İtiÚs_'. 
$node
->
ty³
, 
	`¬¿y
('status', 'promote'));

336 ià(!
	`u£r_acûss
('admši¡”‚odes'è&& ((
$node
->
¡©us
 !ğ
$Üigš®_¡©us
è|| (
	`em±y
($node->
nid
è&& $node->¡©u !ğ
	`š_¬¿y
('¡©us', 
$node_ty³_deçuÉ
)))) {

337 ià(
$node
->
¡©us
) {

338  
	`blog­i_”rÜ
(
	`t
('You do‚ot have…ermissiono…ublishhisype of…ost. Please save it‡s‡ draft instead.'));

341  
	`blog­i_”rÜ
(
	`t
('You do‚ot have…ermissiono savehis…ost‡s‡ draft. Please…ublish it instead.'));

344  
TRUE
;

345 
	}
}

351 
funùiÚ
 
	$blog­i_blogg”_d–‘e_po¡
(
$­pkey
, 
$po¡id
, 
$u£ºame
, 
$·sswÜd
, 
$publish
) {

352 
$u£r
 = 
	`blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
);

353 ià(!
$u£r
->
uid
) {

354  
	`blog­i_”rÜ
(
$u£r
);

357 
	`node_d–‘e
(
$po¡id
);

358  
TRUE
;

359 
	}
}

366 
funùiÚ
 
	$blog­i_blogg”_g‘_»ûÁ_po¡s
(
$­pkey
, 
$blogid
, 
$u£ºame
, 
$·sswÜd
, 
$numb”_of_po¡s
, 
$bod›s
 = 
TRUE
) {

368 
$u£r
 = 
	`blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
);

369 ià(!
$u£r
->
uid
) {

370  
	`blog­i_”rÜ
(
$u£r
);

373 ià((
$”rÜ
 = 
	`_blog­i_v®id©e_blogid
(
$blogid
)è!=ğ
TRUE
) {

375  
$”rÜ
;

378 ià(
$bod›s
) {

379 
$»suÉ
 = 
	`db_qu”y_¿nge
("SELECT‚.nid,‚.t™Ë,„.body,„.fÜm©,‚.comm’t,‚.ü—‹d, u.ÇmFROM {node}‚, {node_»visiÚs}„, {u£rs} u WHERE‚.uid = u.uid AND‚.vid =„.vid AND‚.ty³ = '%s' AND‚.uid = %d ORDER BY‚.ü—‹d DESC", 
$blogid
, 
$u£r
->
uid
, 0, 
$numb”_of_po¡s
);

382 
$»suÉ
 = 
	`db_qu”y_¿nge
("SELECT‚.nid,‚.t™Ë,‚.ü—‹d, u.ÇmFROM {node}‚, {u£rs} u WHERE‚.uid = u.uid AND‚.ty³ = '%s' AND‚.uid = %d ORDER BY‚.ü—‹d DESC", 
$blogid
, 
$u£r
->
uid
, 0, 
$numb”_of_po¡s
);

384 
$blogs
 = 
	`¬¿y
();

385 
$blog
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

386 
$blogs
[] = 
	`_blog­i_g‘_po¡
(
$blog
, 
$bod›s
);

388  
$blogs
;

389 
	}
}

391 
funùiÚ
 
	$blog­i_m‘aweblog_Ãw_po¡
(
$blogid
, 
$u£ºame
, 
$·sswÜd
, 
$cÚ‹Á
, 
$publish
) {

392  
	`blog­i_blogg”_Ãw_po¡
('0123456789ABCDEF', 
$blogid
, 
$u£ºame
, 
$·sswÜd
, 
$cÚ‹Á
, 
$publish
);

393 
	}
}

395 
funùiÚ
 
	$blog­i_m‘aweblog_ed™_po¡
(
$po¡id
, 
$u£ºame
, 
$·sswÜd
, 
$cÚ‹Á
, 
$publish
) {

396  
	`blog­i_blogg”_ed™_po¡
('0123456789ABCDEF', 
$po¡id
, 
$u£ºame
, 
$·sswÜd
, 
$cÚ‹Á
, 
$publish
);

397 
	}
}

399 
funùiÚ
 
	$blog­i_m‘aweblog_g‘_po¡
(
$po¡id
, 
$u£ºame
, 
$·sswÜd
) {

400  
	`blog­i_blogg”_g‘_po¡
('01234567890ABCDEF', 
$po¡id
, 
$u£ºame
, 
$·sswÜd
);

401 
	}
}

406 
funùiÚ
 
	$blog­i_m‘aweblog_Ãw_medŸ_objeù
(
$blogid
, 
$u£ºame
, 
$·sswÜd
, 
$fe
) {

407 
$u£r
 = 
	`blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
);

408 ià(!
$u£r
->
uid
) {

409  
	`blog­i_”rÜ
(
$u£r
);

412 
$u£rsize
 = 0;

413 
$u¶ßdsize
 = 0;

415 
$rŞes
 = 
	`¬¿y_š‹r£ù
(
	`u£r_rŞes
(
FALSE
, 'admši¡” cÚ‹Á w™h blog‡pi'), 
$u£r
->
rŞes
);

417 
	`fÜ—ch
 (
$rŞes
 
as
 
$rid
 => 
$Çme
) {

418 
$ex‹nsiÚs
 .ğ' '. 
	`¡¹Şow”
(
	`v¬ŸbË_g‘
("blogapi_extensions_$rid", variable_get('blogapi_extensions_default', 'jpg jpeg gif…ngxt doc xls…df…pt…ps odt ods odp')));

419 
$u£rsize
ğ
	`max
($u£rsize, 
	`v¬ŸbË_g‘
("blogapi_usersize_$rid", variable_get('blogapi_usersize_default', 1)) * 1024 * 1024);

420 
$u¶ßdsize
 = 
	`max
($u¶ßdsize, 
	`v¬ŸbË_g‘
("blogapi_uploadsize_$rid", variable_get('blogapi_uploadsize_default', 1)) * 1024 * 1024);

423 
$fesize
 = 
	`¡¾’
(
$fe
['bits']);

425 ià(
$fesize
 > 
$u¶ßdsize
) {

426  
	`blog­i_”rÜ
(
	`t
('Iˆi nÙ…ossibËØu¶ßdhfe, beÿu£ iˆexûededhmaximum fesizoà@maxsize.', 
	`¬¿y
('@maxsize' => 
	`fÜm©_size
(
$u¶ßdsize
))));

429 ià(
	`_blog­i_¥aû_u£d
(
$u£r
->
uid
è+ 
$fesize
 > 
$u£rsize
) {

430  
	`blog­i_”rÜ
(
	`t
('ThfÿÀnÙ b©chedØthi po¡, beÿu£hdisk quÙ¨oà@quÙ¨ha b“À»ached.', 
	`¬¿y
('@quÙa' => 
	`fÜm©_size
(
$u£rsize
))));

437 
$wh™–i¡
 = 
	`¬¿y_unique
(
	`ex¶ode
(' ', 
	`Œim
(
$ex‹nsiÚs
)));

439 
$Çme
 = 
	`ba£Çme
(
$fe
['name']);

441 ià(
$ex‹nsiÚ_pos™iÚ
 = 
	`¡¼pos
(
$Çme
, '.')) {

442 
$f’ame
 = 
	`dru·l_sub¡r
(
$Çme
, 0, 
$ex‹nsiÚ_pos™iÚ
);

443 
$fš®_ex‹nsiÚ
 = 
	`dru·l_sub¡r
(
$Çme
, 
$ex‹nsiÚ_pos™iÚ
 + 1);

445 ià(!
	`š_¬¿y
(
	`¡¹Şow”
(
$fš®_ex‹nsiÚ
), 
$wh™–i¡
)) {

446  
	`blog­i_”rÜ
(
	`t
('Iˆi nÙ…ossibËØu¶ßdhfe, beÿu£ iˆi Úly…ossibËØu¶ßd fe w™hhfŞlowšgƒx‹nsiÚs: @ex‹nsiÚs', 
	`¬¿y
('@ex‹nsiÚs' => 
	`im¶ode
(' ', 
$wh™–i¡
))));

449 
$f’ame
 = 
	`¡r_»¶aû
('.', '_', $filename);

450 
$f’ame
 .ğ'.'. 
$fš®_ex‹nsiÚ
;

453 
$d©a
 = 
$fe
['bits'];

455 ià(!
$d©a
) {

456  
	`blog­i_”rÜ
(
	`t
('No file sent.'));

459 ià(!
$fe
 = 
	`fe_§ve_d©a
(
$d©a
, 
$f’ame
)) {

460  
	`blog­i_”rÜ
(
	`t
('Error storing file.'));

463 
$row
 = 
Ãw
 
	`¡dCÏss
();

464 
$row
->
uid
 = 
$u£r
->uid;

465 
$row
->
f•©h
 = 
$fe
;

466 
$row
->
fesize
 = 
$fesize
;

468 
	`dru·l_wr™e_»cÜd
('blog­i_fes', 
$row
);

471  
	`¬¿y
('u¾' => 
	`fe_ü—‹_u¾
(
$fe
), 'struct');

472 
	}
}

477 
funùiÚ
 
	$blog­i_m‘aweblog_g‘_ÿ‹gÜy_li¡
(
$blogid
, 
$u£ºame
, 
$·sswÜd
) {

478 
$u£r
 = 
	`blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
);

479 ià(!
$u£r
->
uid
) {

480  
	`blog­i_”rÜ
(
$u£r
);

483 ià((
$”rÜ
 = 
	`_blog­i_v®id©e_blogid
(
$blogid
)è!=ğ
TRUE
) {

485  
$”rÜ
;

488 
$voÿbuÏr›s
 = 
	`moduË_švoke
('xÚomy', 'g‘_voÿbuÏr›s', 
$blogid
, 'vid');

489 
$ÿ‹gÜ›s
 = 
	`¬¿y
();

490 ià(
$voÿbuÏr›s
) {

491 
	`fÜ—ch
 (
$voÿbuÏr›s
 
as
 
$voÿbuÏry
) {

492 
$‹rms
 = 
	`moduË_švoke
('xÚomy', 'g‘_Œ“', 
$voÿbuÏry
->
vid
, 0, -1);

493 
	`fÜ—ch
 (
$‹rms
 
as
 
$‹rm
) {

494 
$‹rm_Çme
 = 
$‹rm
->
Çme
;

495 
	`fÜ—ch
 (
	`moduË_švoke
('xÚomy', 'g‘_·»Ás', 
$‹rm
->
tid
, 'tid'è
as
 
$·»Á
) {

496 
$‹rm_Çme
 = 
$·»Á
->
Çme
 .'/'. $term_name;

498 
$ÿ‹gÜ›s
[] = 
	`¬¿y
('ÿ‹gÜyName' => 
$‹rm_Çme
, 'ÿ‹gÜyId' => 
$‹rm
->
tid
);

502  
$ÿ‹gÜ›s
;

503 
	}
}

505 
funùiÚ
 
	$blog­i_m‘aweblog_g‘_»ûÁ_po¡s
(
$blogid
, 
$u£ºame
, 
$·sswÜd
, 
$numb”_of_po¡s
) {

506  
	`blog­i_blogg”_g‘_»ûÁ_po¡s
('0123456789ABCDEF', 
$blogid
, 
$u£ºame
, 
$·sswÜd
, 
$numb”_of_po¡s
, 
TRUE
);

507 
	}
}

509 
funùiÚ
 
	$blog­i_mt_g‘_»ûÁ_po¡_t™Ës
(
$blogid
, 
$u£ºame
, 
$·sswÜd
, 
$numb”_of_po¡s
) {

510  
	`blog­i_blogg”_g‘_»ûÁ_po¡s
('0123456789ABCDEF', 
$blogid
, 
$u£ºame
, 
$·sswÜd
, 
$numb”_of_po¡s
, 
FALSE
);

511 
	}
}

513 
funùiÚ
 
	$blog­i_mt_g‘_ÿ‹gÜy_li¡
(
$blogid
, 
$u£ºame
, 
$·sswÜd
) {

514  
	`blog­i_m‘aweblog_g‘_ÿ‹gÜy_li¡
(
$blogid
, 
$u£ºame
, 
$·sswÜd
);

515 
	}
}

521 
funùiÚ
 
	$blog­i_mt_g‘_po¡_ÿ‹gÜ›s
(
$po¡id
, 
$u£ºame
, 
$·sswÜd
) {

522 
$u£r
 = 
	`blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
);

523 ià(!
$u£r
->
uid
) {

524  
	`blog­i_”rÜ
(
$u£r
);

527 
$node
 = 
	`node_lßd
(
$po¡id
);

528 
$‹rms
 = 
	`moduË_švoke
('xÚomy', 'node_g‘_‹rms', 
$node
, 'tid');

529 
$ÿ‹gÜ›s
 = 
	`¬¿y
();

530 
	`fÜ—ch
 (
$‹rms
 
as
 
$‹rm
) {

531 
$‹rm_Çme
 = 
$‹rm
->
Çme
;

532 
	`fÜ—ch
 (
	`moduË_švoke
('xÚomy', 'g‘_·»Ás', 
$‹rm
->
tid
, 'tid'è
as
 
$·»Á
) {

533 
$‹rm_Çme
 = 
$·»Á
->
Çme
 .'/'. $term_name;

535 
$ÿ‹gÜ›s
[] = 
	`¬¿y
('ÿ‹gÜyName' => 
$‹rm_Çme
, 'ÿ‹gÜyId' => 
$‹rm
->
tid
, 'isPrim¬y' => 
TRUE
);

538  
$ÿ‹gÜ›s
;

539 
	}
}

544 
funùiÚ
 
	$blog­i_mt_£t_po¡_ÿ‹gÜ›s
(
$po¡id
, 
$u£ºame
, 
$·sswÜd
, 
$ÿ‹gÜ›s
) {

545 
$u£r
 = 
	`blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
);

546 ià(!
$u£r
->
uid
) {

547  
	`blog­i_”rÜ
(
$u£r
);

550 
$node
 = 
	`node_lßd
(
$po¡id
);

551 
$node
->
xÚomy
 = 
	`¬¿y
();

552 
	`fÜ—ch
 (
$ÿ‹gÜ›s
 
as
 
$ÿ‹gÜy
) {

553 
$node
->
xÚomy
[] = 
$ÿ‹gÜy
['categoryId'];

555 
$v®id©ed
 = 
	`blog­i_mt_v®id©e_‹rms
(
$node
);

556 ià(
$v®id©ed
 !=ğ
TRUE
) {

557  
$v®id©ed
;

559 
	`node_§ve
(
$node
);

560  
TRUE
;

561 
	}
}

566 
funùiÚ
 
	$blog­i_mt_v®id©e_‹rms
(
$node
) {

569 ià(
	`moduË_exi¡s
('taxonomy')) {

570 
$found_‹rms
 = 
	`¬¿y
();

571 ià(!
	`em±y
(
$node
->
xÚomy
)) {

572 
$‹rm_li¡
 = 
	`¬¿y_unique
(
$node
->
xÚomy
);

573 
$·¿ms
 = 
$‹rm_li¡
;

574 
$·¿ms
[] = 
$node
->
ty³
;

575 
$»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
("SELECT.tid,.vid FROM {‹rm_d©a} INNER JOIN {voÿbuÏry_node_ty³s}‚ ON.vid =‚.vid WHERE.tid IN (". 
	`db_¶aûhŞd”s
(
$‹rm_li¡
è."èAND‚.ty³ = '%s'", 't', 'tid'), 
$·¿ms
);

576 
$found_‹rms
 = 
	`¬¿y
();

577 
$found_couÁ
 = 0;

578 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

579 
$found_‹rms
[
$‹rm
->
vid
][$‹rm->
tid
] = $term->tid;

580 
$found_couÁ
++;

583 ià(
	`couÁ
(
$‹rm_li¡
è!ğ
$found_couÁ
) {

584  
	`blog­i_”rÜ
(
	`t
('Invalid categories submitted.'));

588 
$»suÉ2
 = 
	`db_qu”y
(
	`db_»wr™e_sql
("SELECT v.vid, v.Çme, v.»quœed, v.muÉË FROM {voÿbuÏry} v INNER JOIN {voÿbuÏry_node_ty³s}‚ ON v.vid =‚.vid WHERE‚.ty³ = '%s'", 'v', 'vid'), 
$node
->
ty³
);

590 
$voÿbuÏry
 = 
	`db_ãtch_objeù
(
$»suÉ2
)) {

592 ià(
$voÿbuÏry
->
»quœed
 && 
	`em±y
(
$found_‹rms
[$voÿbuÏry->
vid
])) {

593  
	`blog­i_”rÜ
(
	`t
('A c©egÜy fromh@voÿbuÏry_ÇmvoÿbuÏry i »quœed.', 
	`¬¿y
('@voÿbuÏry_Çme' => 
$voÿbuÏry
->
Çme
)));

596 ià(!(
$voÿbuÏry
->
muÉË
è&& (
	`is£t
(
$found_‹rms
[$voÿbuÏry->
vid
]è&& 
	`couÁ
($found_terms[$vocabulary->vid]) > 1)) {

597  
	`blog­i_”rÜ
(
	`t
('You may oÆy choo£ oÃ c©egÜy fromh@voÿbuÏry_ÇmvoÿbuÏry.'), 
	`¬¿y
('@voÿbuÏry_Çme' => 
$voÿbuÏry
->
Çme
));

601 
	`–£if
 (!
	`em±y
(
$node
->
xÚomy
)) {

602  
	`blog­i_”rÜ
(
	`t
('Error saving categories. This feature is‚ot‡vailable.'));

604  
TRUE
;

605 
	}
}

610 
funùiÚ
 
	$blog­i_mt_suµÜ‹d_‹xt_f‹rs
() {

613 
$fÜm©s
 = 
	`f‹r_fÜm©s
();

615 
$f‹rs
 = 
	`¬¿y
();

616 
	`fÜ—ch
 (
$fÜm©s
 
as
 
$fÜm©
) {

617 
$f‹r
['key'] = 
$fÜm©
->
fÜm©
;

618 
$f‹r
['Ïb–'] = 
$fÜm©
->
Çme
;

619 
$f‹rs
[] = 
$f‹r
;

622  
$f‹rs
;

623 
	}
}

628 
funùiÚ
 
	$blog­i_mt_publish_po¡
(
$po¡id
, 
$u£ºame
, 
$·sswÜd
) {

629 
$u£r
 = 
	`blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
);

630 ià(!
$u£r
->
uid
) {

631  
	`blog­i_”rÜ
(
$u£r
);

633 
$node
 = 
	`node_lßd
(
$po¡id
);

634 ià(!
$node
) {

635  
	`blog­i_”rÜ
(
	`t
('Invalid…ost.'));

639 ià(
$node
->
¡©us
) {

643 ià(!
	`node_acûss
('upd©e', 
$node
è|| !
	`u£r_acûss
('administer‚odes')) {

644  
	`blog­i_”rÜ
(
	`t
('You do‚ot have…ermissiono updatehis…ost.'));

647 
$node
->
¡©us
 = 1;

648 
	`node_§ve
(
$node
);

650  
TRUE
;

651 
	}
}

656 
funùiÚ
 
	$blog­i_”rÜ
(
$mes§ge
) {

657 
$xmÌpcu£»¼
;

658 ià(!
	`is_¬¿y
(
$mes§ge
)) {

659 
$mes§ge
 = 
	`¬¿y
($message);

662 
$mes§ge
 = 
	`im¶ode
(' ', $message);

664  
	`xmÌpc_”rÜ
(
$xmÌpcu£»¼
 + 1, 
	`¡r_gs
(
$mes§ge
));

665 
	}
}

670 
funùiÚ
 
	$blog­i_v®id©e_u£r
(
$u£ºame
, 
$·sswÜd
) {

671 
glob®
 
$u£r
;

673 
$u£r
 = 
	`u£r_auth’tiÿ‹
(
	`¬¿y
('Çme' => 
$u£ºame
, '·ss' => 
$·sswÜd
));

675 ià(
$u£r
->
uid
) {

676 ià(
	`u£r_acûss
('admši¡” cÚ‹Á w™h blog‡pi', 
$u£r
)) {

677  
$u£r
;

680  
	`t
('You do‚ot have…ermissionoƒdithis blog.');

684  
	`t
('Wrong username or…assword.');

686 
	}
}

691 
funùiÚ
 
	$blog­i_blogg”_t™Ë
(&
$cÚ‹Ás
) {

692 ià(
	`”egi
('<t™Ë>([^<]*)</t™Ë>', 
$cÚ‹Ás
, 
$t™Ë
)) {

693 
$t™Ë
 = 
	`¡r_gs
($title[0]);

694 
$cÚ‹Ás
 = 
	`”eg_»¶aû
('<title>[^<]*</title>', '', $contents);

697 
	`li¡
(
$t™Ë
, 
$cÚ‹Ás
èğ
	`ex¶ode
("\n", $contents, 2);

699  
$t™Ë
;

700 
	}
}

702 
funùiÚ
 
	$blog­i_admš_£‰šgs
() {

703 
$node_ty³s
 = 
	`¬¿y_m­
('check_¶aš', 
	`node_g‘_ty³s
('names'));

704 
$deçuÉs
 = 
	`is£t
(
$node_ty³s
['blog']è? 
	`¬¿y
('blog' => 1) :‡rray();

705 
$fÜm
['blog­i_node_ty³s'] = 
	`¬¿y
(

707 '#t™Ë' => 
	`t
('Enable forƒxternal blogging clients'),

708 '#»quœed' => 
TRUE
,

709 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('blog­i_node_ty³s', 
$deçuÉs
),

710 '#İtiÚs' => 
$node_ty³s
,

711 '#desütiÚ' => 
	`t
('Selecthe contentypes‡vailableoƒxternal blogging clients via Blog API. If supported,ƒachƒnabled contentype will be displayed‡s‡ separate "blog" byheƒxternal client.')

714 
$blog­i_ex‹nsiÚs_deçuÉ
 = 
	`v¬ŸbË_g‘
('blogapi_extensions_default', 'jpg jpeg gif…ngxt doc xls…df…pt…ps odt ods odp');

715 
$blog­i_u¶ßdsize_deçuÉ
 = 
	`v¬ŸbË_g‘
('blogapi_uploadsize_default', 1);

716 
$blog­i_u£rsize_deçuÉ
 = 
	`v¬ŸbË_g‘
('blogapi_usersize_default', 1);

718 
$fÜm
['£‰šgs_g’”®'] = 
	`¬¿y
(

720 '#t™Ë' => 
	`t
('File settings'),

721 '#cŞÏpsibË' => 
TRUE
,

724 
$fÜm
['£‰šgs_g’”®']['blog­i_ex‹nsiÚs_deçuÉ'] = 
	`¬¿y
(

726 '#t™Ë' => 
	`t
('Default…ermitted fileƒxtensions'),

727 '#deçuÉ_v®ue' => 
$blog­i_ex‹nsiÚs_deçuÉ
,

729 '#desütiÚ' => 
	`t
('Defaultƒxtensionshat users can upload. Separateƒxtensions with‡ space‡nd do‚ot includehe†eading dot.'),

732 
$fÜm
['£‰šgs_g’”®']['blog­i_u¶ßdsize_deçuÉ'] = 
	`¬¿y
(

734 '#t™Ë' => 
	`t
('Default maximum file size…er upload'),

735 '#deçuÉ_v®ue' => 
$blog­i_u¶ßdsize_deçuÉ
,

738 '#desütiÚ' => 
	`t
('The default maximum file size‡ user can upload.'),

739 '#f›ld_suffix' => 
	`t
('MB')

742 
$fÜm
['£‰šgs_g’”®']['blog­i_u£rsize_deçuÉ'] = 
	`¬¿y
(

744 '#t™Ë' => 
	`t
('Defaultotal file size…er user'),

745 '#deçuÉ_v®ue' => 
$blog­i_u£rsize_deçuÉ
,

748 '#desütiÚ' => 
	`t
('The default maximum size of‡ll files‡ user can have onhe site.'),

749 '#f›ld_suffix' => 
	`t
('MB')

752 
$fÜm
['£‰šgs_g’”®']['u¶ßd_max_size'] = 
	`¬¿y
('#v®ue' => '<p>'. 
	`t
('You¸PHP s‘tšg lim™hmaximum fsiz³¸u¶ßdØ%size.',‡¼ay('%size' => 
	`fÜm©_size
(
	`fe_u¶ßd_max_size
()))).'</p>');

754 
$rŞes
 = 
	`u£r_rŞes
(0, 'administer content with blog‡pi');

755 
$fÜm
['rŞes'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$rŞes
);

757 
	`fÜ—ch
 (
$rŞes
 
as
 
$rid
 => 
$rŞe
) {

758 
$fÜm
['£‰šgs_rŞe_'. 
$rid
] = 
	`¬¿y
(

760 '#t™Ë' => 
	`t
('S‘tšg fÜ @rŞe', 
	`¬¿y
('@rŞe' => 
$rŞe
)),

761 '#cŞÏpsibË' => 
TRUE
,

762 '#cŞÏp£d' => 
TRUE
,

764 
$fÜm
['£‰šgs_rŞe_'. 
$rid
]['blog­i_ex‹nsiÚs_'. $rid] = 
	`¬¿y
(

766 '#t™Ë' => 
	`t
('Permitted fileƒxtensions'),

767 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('blog­i_ex‹nsiÚs_'. 
$rid
, 
$blog­i_ex‹nsiÚs_deçuÉ
),

769 '#desütiÚ' => 
	`t
('Extensionshat users inhis„ole can upload. Separateƒxtensions with‡ space‡nd do‚ot includehe†eading dot.'),

771 
$fÜm
['£‰šgs_rŞe_'. 
$rid
]['blog­i_u¶ßdsize_'. $rid] = 
	`¬¿y
(

773 '#t™Ë' => 
	`t
('Maximum file size…er upload'),

774 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('blog­i_u¶ßdsize_'. 
$rid
, 
$blog­i_u¶ßdsize_deçuÉ
),

777 '#desütiÚ' => 
	`t
('The maximum size of‡ file‡ user can upload (in megabytes).'),

779 
$fÜm
['£‰šgs_rŞe_'. 
$rid
]['blog­i_u£rsize_'. $rid] = 
	`¬¿y
(

781 '#t™Ë' => 
	`t
('Total file size…er user'),

782 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('blog­i_u£rsize_'. 
$rid
, 
$blog­i_u£rsize_deçuÉ
),

785 '#desütiÚ' => 
	`t
('The maximum size of‡ll files‡ user can have onhe site (in megabytes).'),

789  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

790 
	}
}

792 
funùiÚ
 
	$blog­i_m’u
() {

793 
$™ems
['blog­i/rsd'] = 
	`¬¿y
(

796 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

797 'ty³' => 
MENU_CALLBACK
,

799 
$™ems
['admš/£‰šgs/blog­i'] = 
	`¬¿y
(

803 '·g¬gum’ts' => 
	`¬¿y
('blogapi_admin_settings'),

804 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

805 'ty³' => 
MENU_NORMAL_ITEM
,

808  
$™ems
;

809 
	}
}

811 
funùiÚ
 
	$blog­i_š™
() {

812 ià(
	`dru·l_is_äÚt_·ge
()) {

813 
	`dru·l_add_lšk
(
	`¬¿y
('rel' => 'EditURI',

815 't™Ë' => 
	`t
('RSD'),

816 'h»f' => 
	`u¾
('blog­i/rsd', 
	`¬¿y
('absŞu‹' => 
TRUE
))));

818 
	}
}

820 
funùiÚ
 
	$blog­i_rsd
() {

821 
glob®
 
$ba£_u¾
;

823 
$xmÌpc
 = 
$ba£_u¾
 .'/xmlrpc.php';

824 
$ba£
 = 
	`u¾
('', 
	`¬¿y
('absŞu‹' => 
TRUE
));

825 
$blogid
 = 1; #uÁ 
we
 
figu»
 
out
 
how
 
to
 
hªdË
 
muÉË
 
blogg”s


827 
	`dru·l_£t_h—d”
('Content-Type:‡pplication/rsd+xml; charset=utf-8');

828 
´št
 <<<
__RSD__


829 <?
xml
 
v”siÚ
="1.0"?>

830 <
rsd
 
v”siÚ
="1.0" 
xmÊs
="http://archipelago.phrasewise.com/rsd">

831 <
£rviû
>

832 <
’gšeName
>
Dru·l
</engineName>

833 <
’gšeLšk
>
h‰p
:

834 <
homePageLšk
>
$ba£
</homePageLink>

835 <
­is
>

836 <
­i
 
Çme
="M‘aWeblog" 
´eã¼ed
="çl£" 
­iLšk
="$xmÌpc" 
blogID
="$blogid" />

837 <
­i
 
Çme
="Blogg”" 
´eã¼ed
="çl£" 
­iLšk
="$xmÌpc" 
blogID
="$blogid" />

838 <
­i
 
Çme
="MovabËTy³" 
´eã¼ed
="Œue" 
­iLšk
="$xmÌpc" 
blogID
="$blogid" />

839 </
­is
>

840 </
£rviû
>

841 </
rsd
>

842 
__RSD__
;

843 
	}
}

848 
funùiÚ
 
	$_blog­i_mt_exŒa
(&
$node
, 
$¡ruù
) {

849 ià(
	`is_¬¿y
(
$node
)) {

850 
$was_¬¿y
 = 
TRUE
;

851 
$node
 = (
objeù
)$node;

855 ià(
	`¬¿y_key_exi¡s
('mt_®low_comm’ts', 
$¡ruù
)) {

856 
$¡ruù
['mt_allow_comments']) {

858 
$node
->
comm’t
 = 
COMMENT_NODE_DISABLED
;

861 
$node
->
comm’t
 = 
COMMENT_NODE_READ_WRITE
;

864 
$node
->
comm’t
 = 
COMMENT_NODE_READ_ONLY
;

871 ià(
$¡ruù
['mt_excerpt']) {

872 
$node
->
body
 = 
$¡ruù
['mt_excerpt'] .'<!--break-->'. $node->body;

874 ià(
$¡ruù
['mt_text_more']) {

875 
$node
->
body
 = $node->body .'<!--ex‹nded-->'. 
$¡ruù
['mt_text_more'];

879 ià(
$¡ruù
['mt_convert_breaks']) {

880 
$node
->
fÜm©
 = 
$¡ruù
['mt_convert_breaks'];

884 ià(
$¡ruù
['dateCreated']) {

885 
$node
->
d©e
 = 
	`fÜm©_d©e
(
	`mktime
(
$¡ruù
['d©eC»©ed']->
hour
, $¡ruù['d©eC»©ed']->
mšu‹
, $¡ruù['d©eC»©ed']->
£cÚd
, $¡ruù['d©eC»©ed']->
mÚth
, $¡ruù['d©eC»©ed']->
day
, $¡ruù['d©eC»©ed']->
y—r
), 'custom', 'Y-m-d H:i:s O');

888 ià(
$was_¬¿y
) {

889 
$node
 = (
¬¿y
)$node;

891 
	}
}

893 
funùiÚ
 
	$_blog­i_g‘_po¡
(
$node
, 
$bod›s
 = 
TRUE
) {

894 
$xmÌpcv®
 = 
	`¬¿y
(

895 'u£rid' => 
$node
->
Çme
,

896 'd©eC»©ed' => 
	`xmÌpc_d©e
(
$node
->
ü—‹d
),

897 't™Ë' => 
$node
->
t™Ë
,

898 'po¡id' => 
$node
->
nid
,

899 'lšk' => 
	`u¾
('node/'. 
$node
->
nid
, 
	`¬¿y
('absŞu‹' => 
TRUE
)),

900 '³rmaLšk' => 
	`u¾
('node/'. 
$node
->
nid
, 
	`¬¿y
('absŞu‹' => 
TRUE
)),

902 ià(
$bod›s
) {

903 ià(
$node
->
comm’t
 == 1) {

904 
$comm’t
 = 2;

906 ià(
$node
->
comm’t
 == 2) {

907 
$comm’t
 = 1;

909 
$xmÌpcv®
['content'] = "<title>$node->title</title>$node->body";

910 
$xmÌpcv®
['desütiÚ'] = 
$node
->
body
;

912 
$xmÌpcv®
['mt_®low_comm’ts'] = (è
$comm’t
;

913 
$xmÌpcv®
['mt_cÚv”t_b»aks'] = 
$node
->
fÜm©
;

916  
$xmÌpcv®
;

917 
	}
}

928 
funùiÚ
 
	$_blog­i_v®id©e_blogid
(
$blogid
) {

929 
$ty³s
 = 
	`_blog­i_g‘_node_ty³s
();

930 ià(
	`š_¬¿y
(
$blogid
, 
$ty³s
, 
TRUE
)) {

931  
TRUE
;

933  
	`blog­i_”rÜ
(
	`t
("Blog API moduË i nÙ cÚfigu»dØsuµÜˆth%ty³ cÚ‹Áy³, o¸you dÚ'ˆhavsuffic›Á…”missiÚ tØpo¡hi ty³ oàcÚ‹Á.", 
	`¬¿y
('%ty³' => 
$blogid
)));

934 
	}
}

936 
funùiÚ
 
	$_blog­i_g‘_node_ty³s
() {

937 
$avaabË_ty³s
 = 
	`¬¿y_keys
(
	`¬¿y_f‹r
(
	`v¬ŸbË_g‘
('blog­i_node_ty³s', 
	`¬¿y
('blog' => 1))));

938 
$ty³s
 = 
	`¬¿y
();

939 
	`fÜ—ch
 (
	`node_g‘_ty³s
(è
as
 
$ty³
 => 
$Çme
) {

940 ià(
	`node_acûss
('ü—‹', 
$ty³
è&& 
	`š_¬¿y
($ty³, 
$avaabË_ty³s
)) {

941 
$ty³s
[] = 
$ty³
;

945  
$ty³s
;

946 
	}
}

948 
funùiÚ
 
	$_blog­i_¥aû_u£d
(
$uid
) {

949  
	`db_»suÉ
(
	`db_qu”y
('SELECT SUM(fesizeèFROM {blog­i_fes} f WHERE f.uid = %d', 
$uid
));

950 
	}
}

	@/srv/http/subs/notes/www/modules/book/book-all-books-block.tpl.php

1 <?
	gphp


18 <?
php
 
fÜ—ch
 (
$book_m’us
 
as
 
$book_id
 => 
$m’u
) : ?>

19 <
div
 
id
="book-block-m’u-<?ph°´šˆ$book_id; ?>" 
şass
="book-block-menu">

20 <?
php
 
´št
 
$m’u
; ?>

21 </
	gdiv
>

22 <?
php
 
	g’dfÜ—ch
; ?>

	@/srv/http/subs/notes/www/modules/book/book-export-html.tpl.php

1 <?
	gphp


20 <!
DOCTYPE
 
html
 
	gPUBLIC
 "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

21 <
html
 
	gxmÊs
="h‰p://www.w3.Üg/1999/xhtml" 
Ïng
="<?ph°´šˆ$Ïnguage->Ïnguage; ?>" 
xml
:lang="<?php…rint $language->language; ?>">

22 <
h—d
>

23 <?
php
 
´št
 
$h—d
; ?>

24 <
	gt™Ë
><?
php
 
´št
 
	g$t™Ë
; ?></title>

25 <
ba£
 
	gh»f
="<?php…rint $base_url; ?>" />

26 <
lšk
 
ty³
="‹xt/css" 
»l
="¡yËsh“t" 
h»f
="misc/print.css" />

27 <?
php
 ià(
$Ïnguage_¹l
): ?>

28 <
lšk
 
ty³
="‹xt/css" 
»l
="¡yËsh“t" 
h»f
="misc/print-rtl.css" />

29 <?
php
 
’dif
; ?>

30 </
	gh—d
>

31 <
	gbody
>

32 <?
php


42 
	g$div_şo£
 = '';

44 <?
php
 
	g$i
 = 1; $˜< 
	g$d•th
; $i++) : ?>

45 <
div
 
şass
="section-<?php…rint $i; ?>">

46 <?
php
 
$div_şo£
 .= '</div>'; ?>

47 <?
php
 
	g’dfÜ
; ?>

49 <?
php
 
´št
 
	g$cÚ‹Ás
; ?>

50 <?
php
 
´št
 
	g$div_şo£
; ?>

52 </
	gbody
>

53 </
	ghtml
>

	@/srv/http/subs/notes/www/modules/book/book-navigation.tpl.php

1 <?
	gphp


33 <?
php
 ià(
	g$Œ“
 || 
	g$has_lšks
): ?>

34 <
div
 
id
="book-Çvig©iÚ-<?ph°´šˆ$book_id; ?>" 
şass
="book-navigation">

35 <?
php
 
´št
 
$Œ“
; ?>

37 <?
php
 ià(
	g$has_lšks
): ?>

38 <
div
 
şass
="page-links clear-block">

39 <?
php
 ià(
$´ev_u¾
) : ?>

40 <
a
 
h»f
="<?ph°´šˆ$´ev_u¾; ?>" 
şass
="·ge-´evious" 
t™Ë
="<?ph°´šˆt('GØtØ´eviou ·ge'); ?>"><?
php
 
´št
 
t
('â€¹ 'è. 
$´ev_t™Ë
; ?></
	ga
>

41 <?
php
 
	g’dif
; ?>

42 <?
php
 ià(
	g$·»Á_u¾
) : ?>

43 <
a
 
h»f
="<?ph°´šˆ$·»Á_u¾; ?>" 
şass
="·ge-up" 
t™Ë
="<?ph°´šˆt('GØtØ·»Á…age'); ?>"><?
php
 
´št
 
t
('up'); ?></
	ga
>

44 <?
php
 
	g’dif
; ?>

45 <?
php
 ià(
	g$Ãxt_u¾
) : ?>

46 <
a
 
h»f
="<?ph°´šˆ$Ãxt_u¾; ?>" 
şass
="·ge-Ãxt" 
t™Ë
="<?ph°´šˆt('GØtØÃxˆ·ge'); ?>"><?
php
 
´št
 
$Ãxt_t™Ë
 . 
t
(' â€º'); ?></
	ga
>

47 <?
php
 
	g’dif
; ?>

48 </
	gdiv
>

49 <?
php
 
	g’dif
; ?>

51 </
	gdiv
>

52 <?
php
 
	g’dif
; ?>

	@/srv/http/subs/notes/www/modules/book/book-node-export-html.tpl.php

1 <?
	gphp


21 <
div
 
	gid
="node-<?ph°´šˆ$node->nid; ?>" 
şass
="section-<?php…rint $depth; ?>">

22 <
h1
 
şass
="book-h—dšg"><?
php
 
´št
 
$t™Ë
; ?></
	gh1
>

23 <?
php
 
´št
 
	g$cÚ‹Á
; ?>

24 <?
php
 
´št
 
	g$chd»n
; ?>

25 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/book/book.admin.inc

1 <?
php


12 
funùiÚ
 
	$book_admš_ov”v›w
() {

13 
$rows
 = 
	`¬¿y
();

14 
	`fÜ—ch
 (
	`book_g‘_books
(è
as
 
$book
) {

15 
$rows
[] = 
	`¬¿y
(
	`l
(
$book
['t™Ë'], $book['h»f'], $book['İtiÚs']),†(
	`t
('edit order‡nditles'), "admin/content/book/". $book['nid']));

17 
$h—d”s
 = 
	`¬¿y
(
	`t
('Book'),('Operations'));

19  
	`theme
('bË', 
$h—d”s
, 
$rows
);

20 
	}
}

29 
funùiÚ
 
	$book_admš_£‰šgs
() {

30 
$ty³s
 = 
	`node_g‘_ty³s
('names');

31 
$fÜm
['book_®lowed_ty³s'] = 
	`¬¿y
(

33 '#t™Ë' => 
	`t
('Allowed book outlineypes'),

34 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('book_®lowed_ty³s', 
	`¬¿y
('book')),

35 '#İtiÚs' => 
$ty³s
,

36 '#desütiÚ' => 
	`t
('S–eù cÚ‹Áy³ which u£r w™hh%add-³rm…”missiÚ wÈb®lowedØaddØthbook h›¿rchy. U£r w™hh%ouše-³rm…”missiÚ cª‡dd‡Î cÚ‹Áy³s.', 
	`¬¿y
('%add-perm' =>('add contento books'), '%outline-perm' =>('administer book outlines'))),

37 '#»quœed' => 
TRUE
,

39 
$fÜm
['book_chd_ty³'] = 
	`¬¿y
(

41 '#t™Ë' => 
	`t
('Default child…ageype'),

42 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('book_child_type', 'book'),

43 '#İtiÚs' => 
$ty³s
,

44 '#desütiÚ' => 
	`t
('ThcÚ‹Áy³ fÜh%add-chd†šk mu¡ bÚoàtho£ s–eùed‡ ª‡Îowed book oušty³.', 
	`¬¿y
('%add-child' =>('Add child…age'))),

45 '#»quœed' => 
TRUE
,

47 
$fÜm
['¬¿y_f‹r'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
TRUE
);

48 
$fÜm
['#validate'][] = 'book_admin_settings_validate';

49  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

50 
	}
}

57 
funùiÚ
 
	$book_admš_£‰šgs_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

58 
$chd_ty³
 = 
$fÜm_¡©e
['values']['book_child_type'];

59 ià(
	`em±y
(
$fÜm_¡©e
['v®ues']['book_®lowed_ty³s'][
$chd_ty³
])) {

60 
	`fÜm_£t_”rÜ
('book_chd_ty³', 
	`t
('ThcÚ‹Áy³ fÜh%add-chd†šk mu¡ bÚoàtho£ s–eùed‡ ª‡Îowed book oušty³.', 
	`¬¿y
('%add-child' =>('Add child…age'))));

62 
	}
}

71 
funùiÚ
 
	$book_admš_ed™
(
$fÜm_¡©e
, 
$node
) {

72 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$node
->
t™Ë
));

73 
$fÜm
 = 
	`¬¿y
();

74 
$fÜm
['#node'] = 
$node
;

75 
	`_book_admš_bË
(
$node
, 
$fÜm
);

76 
$fÜm
['§ve'] = 
	`¬¿y
(

78 '#v®ue' => 
	`t
('Save book…ages'),

80  
$fÜm
;

81 
	}
}

88 
funùiÚ
 
	$book_admš_ed™_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

89 ià(
$fÜm_¡©e
['values']['tree_hash'] != $form_state['values']['tree_current_hash']) {

90 
	`fÜm_£t_”rÜ
('', 
	`t
('This book has been modified by‡nother user,he changes could‚ot be saved.'));

91 
$fÜm_¡©e
['»bud'] = 
TRUE
;

93 
	}
}

104 
funùiÚ
 
	$book_admš_ed™_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

107 
$Üd”
 = 
	`¬¿y_æ
(
	`¬¿y_keys
(
$fÜm
['#post']['table']));

108 
$fÜm
['bË'] = 
	`¬¿y_m”ge
(
$Üd”
, $form['table']);

110 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['bË']è
as
 
$key
) {

111 ià(
$fÜm
['bË'][
$key
]['#item']) {

112 
$row
 = 
$fÜm
['bË'][
$key
];

113 
$v®ues
 = 
$fÜm_¡©e
['v®ues']['bË'][
$key
];

116 ià(
$row
['¶id']['#deçuÉ_v®ue'] !ğ
$v®ues
['plid'] || $row['weight']['#default_value'] != $values['weight']) {

117 
$row
['#™em']['¶id'] = 
$v®ues
['plid'];

118 
$row
['#™em']['weight'] = 
$v®ues
['weight'];

119 
	`m’u_lšk_§ve
(
$row
['#item']);

123 ià(
$row
['t™Ë']['#deçuÉ_v®ue'] !ğ
$v®ues
['title']) {

124 
$node
 = 
	`node_lßd
(
$v®ues
['nid'], 
FALSE
);

125 
$node
->
t™Ë
 = 
$v®ues
['title'];

126 
$node
->
book
['lšk_t™Ë'] = 
$v®ues
['title'];

127 
$node
->
»visiÚ
 = 1;

128 
$node
->
log
 = 
	`t
('T™Ë chªged from %Üigš®Ø%cu¼’t.', 
	`¬¿y
('%Üigš®' => $node->
t™Ë
, '%cu¼’t' => 
$v®ues
['title']));

129 
	`node_§ve
(
$node
);

130 
	`w©chdog
('cÚ‹Á', 'book: upd©ed %t™Ë.', 
	`¬¿y
('%t™Ë' => 
$node
->
t™Ë
), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('v›w'), 'node/'. $node->
nid
));

135 
	`dru·l_£t_mes§ge
(
	`t
('Upd©ed book %t™Ë.', 
	`¬¿y
('%t™Ë' => 
$fÜm
['#node']->
t™Ë
)));

136 
	}
}

143 
funùiÚ
 
	$_book_admš_bË
(
$node
, &
$fÜm
) {

144 
$fÜm
['bË'] = 
	`¬¿y
(

146 '#Œ“' => 
TRUE
,

149 
$Œ“
 = 
	`book_m’u_subŒ“_d©a
(
$node
->
book
);

150 
$Œ“
 = 
	`¬¿y_shiá
($tree);

151 ià(
$Œ“
['below']) {

152 
$hash
 = 
	`sha1
(
	`£rŸlize
(
$Œ“
['below']));

155 
$fÜm
['Œ“_hash'] = 
	`¬¿y
(

157 '#deçuÉ_v®ue' => 
$hash
,

159 
$fÜm
['Œ“_cu¼’t_hash'] = 
	`¬¿y
(

161 '#v®ue' => 
$hash
,

163 
	`_book_admš_bË_Œ“
(
$Œ“
['b–ow'], 
$fÜm
['table']);

165 
	}
}

172 
funùiÚ
 
	$_book_admš_bË_Œ“
(
$Œ“
, &
$fÜm
) {

173 
	`fÜ—ch
 (
$Œ“
 
as
 
$d©a
) {

174 
$fÜm
['book-admš-'. 
$d©a
['lšk']['nid']] = 
	`¬¿y
(

175 '#™em' => 
$d©a
['link'],

176 'nid' => 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$d©a
['link']['nid']),

177 'd•th' => 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$d©a
['link']['depth']),

178 'h»f' => 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$d©a
['link']['href']),

179 't™Ë' => 
	`¬¿y
(

181 '#deçuÉ_v®ue' => 
$d©a
['link']['link_title'],

185 'weight' => 
	`¬¿y
(

187 '#deçuÉ_v®ue' => 
$d©a
['link']['weight'],

190 '¶id' => 
	`¬¿y
(

192 '#deçuÉ_v®ue' => 
$d©a
['link']['plid'],

195 'mlid' => 
	`¬¿y
(

197 '#deçuÉ_v®ue' => 
$d©a
['link']['mlid'],

200 ià(
$d©a
['below']) {

201 
	`_book_admš_bË_Œ“
(
$d©a
['b–ow'], 
$fÜm
);

205  
$fÜm
;

206 
	}
}

214 
funùiÚ
 
	$theme_book_admš_bË
(
$fÜm
) {

215 
	`dru·l_add_bËd¿g
('book-ouše', 'm©ch', '·»Á', 'book-¶id', 'book-¶id', 'book-mlid', 
TRUE
, 
MENU_MAX_DEPTH
 - 2);

216 
	`dru·l_add_bËd¿g
('book-outline', 'order', 'sibling', 'book-weight');

218 
$h—d”
 = 
	`¬¿y
(
	`t
('Title'),('Weight'),('Parent'),‡rray('data' =>('Operations'), 'colspan' => '3'));

220 
$rows
 = 
	`¬¿y
();

221 
$de¡š©iÚ
 = 
	`dru·l_g‘_de¡š©iÚ
();

222 
$acûss
 = 
	`u£r_acûss
('administer‚odes');

223 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$key
) {

224 
$nid
 = 
$fÜm
[
$key
]['nid']['#value'];

225 
$h»f
 = 
$fÜm
[
$key
]['href']['#value'];

228 
$fÜm
[
$key
]['plid']['#attributes']['class'] = 'book-plid';

229 
$fÜm
[
$key
]['mlid']['#attributes']['class'] = 'book-mlid';

230 
$fÜm
[
$key
]['weight']['#attributes']['class'] = 'book-weight';

232 
$d©a
 = 
	`¬¿y
(

233 
	`theme
('šd’tiÚ', 
$fÜm
[
$key
]['d•th']['#v®ue'] - 2è. 
	`dru·l_»nd”
($form[$key]['title']),

234 
	`dru·l_»nd”
(
$fÜm
[
$key
]['weight']),

235 
	`dru·l_»nd”
(
$fÜm
[
$key
]['plid']) . drupal_render($form[$key]['mlid']),

236 
	`l
(
	`t
('v›w'), 
$h»f
),

237 
$acûss
 ? 
	`l
(
	`t
('ed™'), 'node/'. 
$nid
 .'/ed™', 
	`¬¿y
('qu”y' => 
$de¡š©iÚ
)) : '&nbsp',

238 
$acûss
 ? 
	`l
(
	`t
('d–‘e'), 'node/'. 
$nid
 .'/d–‘e', 
	`¬¿y
('qu”y' => 
$de¡š©iÚ
) ) : '&nbsp',

240 
$row
 = 
	`¬¿y
('d©a' => 
$d©a
);

241 ià(
	`is£t
(
$fÜm
[
$key
]['#attributes'])) {

242 
$row
 = 
	`¬¿y_m”ge
($row, 
$fÜm
[
$key
]['#attributes']);

244 
$row
['şass'] = 
	`em±y
($row['class']) ? 'draggable' : $row['class'] .' draggable';

245 
$rows
[] = 
$row
;

248  
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('id' => 'book-outline'));

249 
	}
}

	@/srv/http/subs/notes/www/modules/book/book.module

1 <?
php


12 
funùiÚ
 
	$book_theme
() {

13  
	`¬¿y
(

14 'book_Çvig©iÚ' => 
	`¬¿y
(

15 '¬gum’ts' => 
	`¬¿y
('book_lšk' => 
NULL
),

18 'book_expÜt_html' => 
	`¬¿y
(

19 '¬gum’ts' => 
	`¬¿y
('t™Ë' => 
NULL
, 'contents' => NULL, 'depth' => NULL),

22 'book_admš_bË' => 
	`¬¿y
(

23 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

25 'book_t™Ë_lšk' => 
	`¬¿y
(

26 '¬gum’ts' => 
	`¬¿y
('lšk' => 
NULL
),

28 'book_®l_books_block' => 
	`¬¿y
(

29 '¬gum’ts' => 
	`¬¿y
('book_menus' =>‡rray()),

32 'book_node_expÜt_html' => 
	`¬¿y
(

33 '¬gum’ts' => 
	`¬¿y
('node' => 
NULL
, 'children' => NULL),

37 
	}
}

42 
funùiÚ
 
	$book_³rm
() {

43  
	`¬¿y
('add contento books', 'administer book outlines', 'create‚ew books', 'access…rinter-friendly version');

44 
	}
}

49 
funùiÚ
 
	$book_lšk
(
$ty³
, 
$node
 = 
NULL
, 
$‹a£r
 = 
FALSE
) {

50 
$lšks
 = 
	`¬¿y
();

52 ià(
$ty³
 =ğ'node' && 
	`is£t
(
$node
->
book
)) {

53 ià(!
$‹a£r
) {

54 
$chd_ty³
 = 
	`v¬ŸbË_g‘
('book_child_type', 'book');

55 ià((
	`u£r_acûss
('add cÚ‹ÁØbooks'è|| u£r_acûss('admši¡” book oušes')è&& 
	`node_acûss
('ü—‹', 
$chd_ty³
è&& 
$node
->
¡©us
 =ğ1 && $node->
book
['d•th'] < 
MENU_MAX_DEPTH
) {

56 
$lšks
['book_add_chd'] = 
	`¬¿y
(

57 't™Ë' => 
	`t
('Add child…age'),

58 'h»f' => "node/add/". 
	`¡r_»¶aû
('_', '-', 
$chd_ty³
),

59 'qu”y' => "·»Á=". 
$node
->
book
['mlid'],

62 ià(
	`u£r_acûss
('access…rinter-friendly version')) {

63 
$lšks
['book_´š‹r'] = 
	`¬¿y
(

64 't™Ë' => 
	`t
('Printer-friendly version'),

65 'h»f' => 'book/expÜt/html/'. 
$node
->
nid
,

66 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
	`t
('Show‡…rinter-friendly version ofhis book…age‡nd its sub-pages.'))

71  
$lšks
;

72 
	}
}

77 
funùiÚ
 
	$book_m’u
() {

78 
$™ems
['admš/cÚ‹Á/book'] = 
	`¬¿y
(

82 'acûs ¬gum’ts' => 
	`¬¿y
('administer book outlines'),

85 
$™ems
['admš/cÚ‹Á/book/li¡'] = 
	`¬¿y
(

87 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

89 
$™ems
['admš/cÚ‹Á/book/£‰šgs'] = 
	`¬¿y
(

92 '·g¬gum’ts' => 
	`¬¿y
('book_admin_settings'),

93 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

94 'ty³' => 
MENU_LOCAL_TASK
,

98 
$™ems
['admš/cÚ‹Á/book/%node'] = 
	`¬¿y
(

101 '·g¬gum’ts' => 
	`¬¿y
('book_admin_edit', 3),

103 'acûs ¬gum’ts' => 
	`¬¿y
(3),

104 'ty³' => 
MENU_CALLBACK
,

107 
$™ems
['book'] = 
	`¬¿y
(

110 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

111 'ty³' => 
MENU_SUGGESTED_ITEM
,

114 
$™ems
['book/expÜt/%/%'] = 
	`¬¿y
(

116 '·g¬gum’ts' => 
	`¬¿y
(2, 3),

117 'acûs ¬gum’ts' => 
	`¬¿y
('access…rinter-friendly version'),

118 'ty³' => 
MENU_CALLBACK
,

121 
$™ems
['node/%node/ouše'] = 
	`¬¿y
(

124 '·g¬gum’ts' => 
	`¬¿y
(1),

126 'acûs ¬gum’ts' => 
	`¬¿y
(1),

127 'ty³' => 
MENU_LOCAL_TASK
,

131 
$™ems
['node/%node/ouše/»move'] = 
	`¬¿y
(

134 '·g¬gum’ts' => 
	`¬¿y
('book_remove_form', 1),

136 'acûs ¬gum’ts' => 
	`¬¿y
(1),

137 'ty³' => 
MENU_CALLBACK
,

140 
$™ems
['book/js/fÜm'] = 
	`¬¿y
(

142 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

143 'ty³' => 
MENU_CALLBACK
,

146  
$™ems
;

147 
	}
}

152 
funùiÚ
 
	$_book_ouše_acûss
(
$node
) {

153  
	`u£r_acûss
('admši¡” book oušes'è&& 
	`node_acûss
('v›w', 
$node
);

154 
	}
}

159 
funùiÚ
 
	$_book_ouše_»move_acûss
(
$node
) {

160  
	`is£t
(
$node
->
book
è&& ($node->book['bid'] !ğ$node->
nid
è&& 
	`_book_ouše_acûss
($node);

161 
	}
}

166 
funùiÚ
 
	$book_š™
() {

167 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'book') .'/book.css');

168 
	}
}

176 
funùiÚ
 
book_block
(
$İ
 = 'li¡', 
$d–
 = 0, 
$ed™
 = 
	$¬¿y
()) {

177 
$block
 = 
	`¬¿y
();

178 
$İ
) {

180 
$block
[0]['šfo'] = 
	`t
('Book‚avigation');

181 
$block
[0]['ÿche'] = 
BLOCK_CACHE_PER_PAGE
 | 
BLOCK_CACHE_PER_ROLE
;

182  
$block
;

184 
$cu¼’t_bid
 = 0;

185 ià(
$node
 = 
	`m’u_g‘_objeù
()) {

186 
$cu¼’t_bid
 = 
	`em±y
(
$node
->
book
['bid']) ? 0 : $node->book['bid'];

188 ià(
	`v¬ŸbË_g‘
('book_block_mode', 'all…ages') == 'all…ages') {

189 
$block
['subjeù'] = 
	`t
('Book‚avigation');

190 
$book_m’us
 = 
	`¬¿y
();

191 
$p£udo_Œ“
 = 
	`¬¿y
(0 =>‡¼ay('b–ow' => 
FALSE
));

192 
	`fÜ—ch
 (
	`book_g‘_books
(è
as
 
$book_id
 => 
$book
) {

193 ià(
$book
['bid'] =ğ
$cu¼’t_bid
) {

196 
$book_m’us
[
$book_id
] = 
	`m’u_Œ“_ouut
(
	`m’u_Œ“_®l_d©a
(
$node
->
book
['menu_name'], $node->book));

201 
$book
['š_aùive_Œa'] = 
FALSE
;

202 
$p£udo_Œ“
[0]['lšk'] = 
$book
;

203 
$book_m’us
[
$book_id
] = 
	`m’u_Œ“_ouut
(
$p£udo_Œ“
);

206 
$block
['cÚ‹Á'] = 
	`theme
('book_®l_books_block', 
$book_m’us
);

208 
	`–£if
 (
$cu¼’t_bid
) {

210 
$t™Ë
 = 
	`db_»suÉ
(
	`db_qu”y
(
	`db_»wr™e_sql
('SELECT‚.t™Ë FROM {node}‚ WHERE‚.nid = %d'), 
$node
->
book
['bid']));

212 ià(
$t™Ë
) {

213 
$Œ“
 = 
	`m’u_Œ“_®l_d©a
(
$node
->
book
['menu_name'], $node->book);

215 
$d©a
 = 
	`¬¿y_shiá
(
$Œ“
);

216 
$block
['subjeù'] = 
	`theme
('book_t™Ë_lšk', 
$d©a
['link']);

217 
$block
['cÚ‹Á'] = (
$d©a
['b–ow']è? 
	`m’u_Œ“_ouut
($data['below']) : '';

220  
$block
;

222 
$İtiÚs
 = 
	`¬¿y
(

223 '®È·ges' => 
	`t
('Show block on‡ll…ages'),

224 'book…ages' => 
	`t
('Show block only on book…ages'),

226 
$fÜm
['book_block_mode'] = 
	`¬¿y
(

228 '#t™Ë' => 
	`t
('Book‚avigation block display'),

229 '#İtiÚs' => 
$İtiÚs
,

230 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('book_block_mode', 'all…ages'),

231 '#desütiÚ' => 
	`t
("If <em>Show block on‡ll…ages</em> is selected,he block will containhe‡utomatically generated menus for‡ll ofhe site's books. If <em>Show block only on book…ages</em> is selected,he block will contain onlyhe one menu correspondingohe current…age's book. Inhis case, ifhe current…age is‚ot in‡ book,‚o block will be displayed. The <em>Page specific visibility settings</em> or other visibility settings can be used in‡dditiono selectively displayhis block."),

233  
$fÜm
;

235 
	`v¬ŸbË_£t
('book_block_mode', 
$ed™
['book_block_mode']);

238 
	}
}

245 
funùiÚ
 
	$theme_book_t™Ë_lšk
(
$lšk
) {

246 
$lšk
['options']['attributes']['class'] = 'book-title';

247  
	`l
(
$lšk
['title'], $link['href'], $link['options']);

248 
	}
}

256 
funùiÚ
 
	$book_g‘_books
() {

257 
$®l_books
;

259 ià(!
	`is£t
(
$®l_books
)) {

260 
$®l_books
 = 
	`¬¿y
();

261 
$»suÉ
 = 
	`db_qu”y
("SELECT DISTINCT(bid) FROM {book}");

262 
$nids
 = 
	`¬¿y
();

263 
$book
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

264 
$nids
[] = 
$book
['bid'];

266 ià(
$nids
) {

267 
$»suÉ2
 = 
	`db_qu”y
(
	`db_»wr™e_sql
("SELECT‚.ty³,‚.t™Ë, b.*, ml.* FROM {book} b INNER JOIN {node}‚ oÀb.nid =‚.nid INNER JOIN {m’u_lšks} mÈON b.mlid = ml.mlid WHERE‚.nid IN (". 
	`im¶ode
(',', 
$nids
) .") AND‚.status = 1 ORDER BY ml.weight, ml.link_title"));

268 
$lšk
 = 
	`db_ãtch_¬¿y
(
$»suÉ2
)) {

269 
$lšk
['href'] = $link['link_path'];

270 
$lšk
['İtiÚs'] = 
	`un£rŸlize
($link['options']);

271 
$®l_books
[
$lšk
['bid']] = $link;

275  
$®l_books
;

276 
	}
}

284 
funùiÚ
 
	$book_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

286 ià(
	`is£t
(
$fÜm
['ty³']è&& is£t($fÜm['#node']è&& $fÜm['ty³']['#v®ue'] .'_node_fÜm' =ğ
$fÜm_id
) {

288 
$node
 = 
$fÜm
['#node'];

290 
$acûss
 = 
	`u£r_acûss
('administer book outlines');

291 ià(!
$acûss
) {

292 ià(
	`u£r_acûss
('add cÚ‹ÁØbooks'è&& ((!
	`em±y
(
$node
->
book
['mlid']è&& !em±y($node->
nid
)è|| 
	`book_ty³_is_®lowed
($node->
ty³
))) {

294 
$acûss
 = 
TRUE
;

298 ià(
$acûss
) {

299 
	`_book_add_fÜm_–em’ts
(
$fÜm
, 
$node
);

300 
$fÜm
['book']['pick-book'] = 
	`¬¿y
(

302 '#v®ue' => 
	`t
('Change book (update†ist of…arents)'),

308 '#subm™' => 
	`¬¿y
('node_form_submit_build_node'),

313 
	}
}

322 
funùiÚ
 
	$_book_·»Á_£Ëù
(
$book_lšk
) {

323 ià(
	`v¬ŸbË_g‘
('m’u_ov”ride_·»Á_£ËùÜ', 
FALSE
)) {

324  
	`¬¿y
();

327 
$fÜm
 = 
	`¬¿y
(

334 ià(
$book_lšk
['nid'] === $book_link['bid']) {

336 ià(
$book_lšk
['original_bid'] === $book_link['bid']) {

337 
$fÜm
['#´efix'] .ğ'<em>'. 
	`t
('This isheop-level…age inhis book.') .'</em>';

340 
$fÜm
['#´efix'] .ğ'<em>'. 
	`t
('This will beheop-level…age inhis book.') .'</em>';

343 
	`–£if
 (!
$book_lšk
['bid']) {

344 
$fÜm
['#´efix'] .ğ'<em>'. 
	`t
('No book selected.') .'</em>';

347 
$fÜm
 = 
	`¬¿y
(

349 '#t™Ë' => 
	`t
('Parent item'),

350 '#deçuÉ_v®ue' => 
$book_lšk
['plid'],

351 '#desütiÚ' => 
	`t
('Th·»Á…agšhbook. Thmaximum d•th fÜ‡ book‡nd‡Î chd…age i !maxd•th. Som·ge šh£Ëùed book may‚Ù bavaabË‡ ·»Á ià£Ëùšghem wouldƒxûedhi lim™.', 
	`¬¿y
('!maxd•th' => 
MENU_MAX_DEPTH
)),

352 '#İtiÚs' => 
	`book_toc
(
$book_lšk
['bid'], 
	`¬¿y
($book_link['mlid']), $book_link['parent_depth_limit']),

353 '#©Œibu‹s' => 
	`¬¿y
('class' => 'book-title-select'),

356  
$fÜm
;

357 
	}
}

362 
funùiÚ
 
	$_book_add_fÜm_–em’ts
(&
$fÜm
, 
$node
) {

364 
$fÜm
['#ÿche'] = 
TRUE
;

365 
	`dru·l_add_js
("if (Drupal.jsEnabled) { $(document).ready(function() { $('#edit-book-pick-book').css('display', 'none'); }); }", 'inline');

367 
$fÜm
['book'] = 
	`¬¿y
(

369 '#t™Ë' => 
	`t
('Book outline'),

371 '#cŞÏpsibË' => 
TRUE
,

372 '#cŞÏp£d' => 
TRUE
,

373 '#Œ“' => 
TRUE
,

374 '#©Œibu‹s' => 
	`¬¿y
('class' => 'book-outline-form'),

376 
	`fÜ—ch
 (
	`¬¿y
('m’u_Çme', 'mlid', 'nid', 'rou‹r_·th', 'has_chd»n', 'İtiÚs', 'moduË', 'Üigš®_bid', '·»Á_d•th_lim™'è
as
 
$key
) {

377 
$fÜm
['book'][
$key
] = 
	`¬¿y
(

379 '#v®ue' => 
$node
->
book
[
$key
],

383 
$fÜm
['book']['¶id'] = 
	`_book_·»Á_£Ëù
(
$node
->
book
);

385 
$fÜm
['book']['weight'] = 
	`¬¿y
(

387 '#t™Ë' => 
	`t
('Weight'),

388 '#deçuÉ_v®ue' => 
$node
->
book
['weight'],

391 '#desütiÚ' => 
	`t
('Pages‡t‡ given†evel‡re ordered first by weight‡ndhen byitle.'),

393 
$İtiÚs
 = 
	`¬¿y
();

394 
$nid
 = 
	`is£t
(
$node
->
nid
) ? $node->nid : 'new';

396 ià(
	`is£t
(
$node
->
nid
è&& (
$nid
 =ğ$node->
book
['original_bid']) && ($node->book['parent_depth_limit'] == 0)) {

398 
$İtiÚs
[
$node
->
nid
] = $node->
t™Ë
;

401 
	`fÜ—ch
 (
	`book_g‘_books
(è
as
 
$book
) {

402 
$İtiÚs
[
$book
['nid']] = $book['title'];

406 ià(
	`u£r_acûss
('ü—‹‚ew books'è&& (
$nid
 =ğ'Ãw' || ($nid !ğ
$node
->
book
['original_bid']))) {

408 
$İtiÚs
 = 
	`¬¿y
(
$nid
 => '<'. 
	`t
('create‡‚ew book') .'>') + $options;

410 ià(!
$node
->
book
['mlid']) {

412 
$İtiÚs
 = 
	`¬¿y
(0 => '<'. 
	`t
('none') .'>') + $options;

416 
$fÜm
['book']['bid'] = 
	`¬¿y
(

418 '#t™Ë' => 
	`t
('Book'),

419 '#deçuÉ_v®ue' => 
$node
->
book
['bid'],

420 '#İtiÚs' => 
$İtiÚs
,

421 '#acûss' => (
boŞ
)
$İtiÚs
,

422 '#desütiÚ' => 
	`t
('Your…age will be‡…art ofhe selected book.'),

424 '#©Œibu‹s' => 
	`¬¿y
('class' => 'book-title-select'),

425 '#ahah' => 
	`¬¿y
(

431 
	}
}

439 
funùiÚ
 
	$_book_upd©e_ouše
(&
$node
) {

440 ià(
	`em±y
(
$node
->
book
['bid'])) {

441  
FALSE
;

443 
$Ãw
 = 
	`em±y
(
$node
->
book
['mlid']);

445 
$node
->
book
['lšk_·th'] = 'node/'. $node->
nid
;

446 
$node
->
book
['lšk_t™Ë'] = $node->
t™Ë
;

447 
$node
->
book
['·»Á_mism©ch'] = 
FALSE
;

449 ià(
$node
->
book
['bid'] =ğ$node->
nid
) {

450 
$node
->
book
['plid'] = 0;

451 
$node
->
book
['m’u_Çme'] = 
	`book_m’u_Çme
($node->
nid
);

455 ià(!
	`em±y
(
$node
->
book
['plid'])) {

456 
$·»Á
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT * FROM {book} WHERE mlid = %d", 
$node
->
book
['plid']));

458 ià(
	`em±y
(
$node
->
book
['¶id']è|| !
$·»Á
 || $parent['bid'] != $node->book['bid']) {

459 
$node
->
book
['¶id'] = 
	`db_»suÉ
(
	`db_qu”y
("SELECT mlid FROM {book} WHERE‚id = %d", $node->book['bid']));

460 
$node
->
book
['·»Á_mism©ch'] = 
TRUE
;

463 ià(
	`m’u_lšk_§ve
(
$node
->
book
)) {

464 ià(
$Ãw
) {

466 
	`db_qu”y
("INSERT INTO {book} (nid, mlid, bidèVALUES (%d, %d, %d)", 
$node
->
nid
, $node->
book
['mlid'], $node->book['bid']);

469 ià(
$node
->
book
['bid'] !ğ
	`db_»suÉ
(
	`db_qu”y
("SELECT bid FROM {book} WHERE‚id = %d", $node->
nid
))) {

471 
	`book_upd©e_bid
(
$node
->
book
);

474  
TRUE
;

477  
FALSE
;

478 
	}
}

486 
funùiÚ
 
	$book_upd©e_bid
(
$book_lšk
) {

488 
$i
 = 1; $˜<ğ
MENU_MAX_DEPTH
 && 
$book_lšk
["p$i"]; $i++) {

489 
$m©ch
[] = "p$i = %d";

490 
$¬gs
[] = 
$book_lšk
["p$i"];

492 
$»suÉ
 = 
	`db_qu”y
("SELECT mlid FROM {m’u_lšks} WHERE ". 
	`im¶ode
(' AND ', 
$m©ch
), 
$¬gs
);

494 
$mlids
 = 
	`¬¿y
();

495 
$a
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

496 
$mlids
[] = 
$a
['mlid'];

498 ià(
$mlids
) {

499 
	`db_qu”y
("UPDATE {book} SET bid = %d WHERE mlid IN (". 
	`im¶ode
(',', 
$mlids
è.")", 
$book_lšk
['bid']);

501 
	}
}

514 
funùiÚ
 
	$book_g‘_æ©_m’u
(
$book_lšk
) {

515 
$æ©
 = 
	`¬¿y
();

517 ià(!
	`is£t
(
$æ©
[
$book_lšk
['mlid']])) {

519 
$Œ“
 = 
	`m’u_Œ“_®l_d©a
(
$book_lšk
['menu_name'], $book_link);

520 
$æ©
[
$book_lšk
['mlid']] = 
	`¬¿y
();

521 
	`_book_æ©‹n_m’u
(
$Œ“
, 
$æ©
[
$book_lšk
['mlid']]);

523  
$æ©
[
$book_lšk
['mlid']];

524 
	}
}

529 
funùiÚ
 
	$_book_æ©‹n_m’u
(
$Œ“
, &
$æ©
) {

530 
	`fÜ—ch
 (
$Œ“
 
as
 
$d©a
) {

531 ià(!
$d©a
['link']['hidden']) {

532 
$æ©
[
$d©a
['link']['mlid']] = $data['link'];

533 ià(
$d©a
['below']) {

534 
	`_book_æ©‹n_m’u
(
$d©a
['b–ow'], 
$æ©
);

538 
	}
}

543 
funùiÚ
 
	$book_´ev
(
$book_lšk
) {

545 ià(
$book_lšk
['plid'] == 0) {

546  
NULL
;

548 
$æ©
 = 
	`book_g‘_æ©_m’u
(
$book_lšk
);

550 
$cu¼
 = 
NULL
;

552 
$´ev
 = 
$cu¼
;

553 
	`li¡
(
$key
, 
$cu¼
èğ
	`—ch
(
$æ©
);

554 } 
$key
 && $key !ğ
$book_lšk
['mlid']);

556 ià(
$key
 =ğ
$book_lšk
['mlid']) {

558 ià(
$´ev
['d•th'] =ğ
$book_lšk
['depth'] && $prev['has_children']) {

560 
$d©a
 = 
	`¬¿y_shiá
(
	`book_m’u_subŒ“_d©a
(
$´ev
));

562 
$d©a
['below']) {

563 
$d©a
 = 
	`’d
($data['below']);

565  
$d©a
['link'];

568  
$´ev
;

571 
	}
}

576 
funùiÚ
 
	$book_Ãxt
(
$book_lšk
) {

577 
$æ©
 = 
	`book_g‘_æ©_m’u
(
$book_lšk
);

580 
	`li¡
(
$key
, 
$cu¼
èğ
	`—ch
(
$æ©
);

581 } 
$key
 && $key !ğ
$book_lšk
['mlid']);

582 ià(
$key
 =ğ
$book_lšk
['mlid']) {

583  
	`cu¼’t
(
$æ©
);

585 
	}
}

590 
funùiÚ
 
	$book_chd»n
(
$book_lšk
) {

591 
$æ©
 = 
	`book_g‘_æ©_m’u
(
$book_lšk
);

593 
$chd»n
 = 
	`¬¿y
();

595 ià(
$book_lšk
['has_children']) {

598 
$lšk
 = 
	`¬¿y_shiá
(
$æ©
);

599 } 
$lšk
 && ($lšk['mlid'] !ğ
$book_lšk
['mlid']));

601 (
$lšk
 = 
	`¬¿y_shiá
(
$æ©
)è&& $lšk['¶id'] =ğ
$book_lšk
['mlid']) {

602 
$d©a
['lšk'] = 
$lšk
;

603 
$d©a
['below'] = '';

604 
$chd»n
[] = 
$d©a
;

607  
$chd»n
 ? 
	`m’u_Œ“_ouut
($children) : '';

608 
	}
}

613 
funùiÚ
 
	$book_m’u_Çme
(
$bid
) {

614  'book-toc-'. 
$bid
;

615 
	}
}

620 
funùiÚ
 
	$book_bud_aùive_Œa
(
$book_lšk
) {

621 
$Œa
;

623 ià(!
	`is£t
(
$Œa
)) {

624 
$Œa
 = 
	`¬¿y
();

625 
$Œa
[] = 
	`¬¿y
('t™Ë' => 
	`t
('Home'), 'href' => '<front>', 'localized_options' =>‡rray());

627 
$Œ“
 = 
	`m’u_Œ“_®l_d©a
(
$book_lšk
['menu_name'], $book_link);

628 
$cu¼
 = 
	`¬¿y_shiá
(
$Œ“
);

630 
$cu¼
) {

631 ià(
$cu¼
['lšk']['h»f'] =ğ
$book_lšk
['href']) {

632 
$Œa
[] = 
$cu¼
['link'];

633 
$cu¼
 = 
FALSE
;

636 ià(
$cu¼
['below'] && $curr['link']['in_active_trail']) {

637 
$Œa
[] = 
$cu¼
['link'];

638 
$Œ“
 = 
$cu¼
['below'];

640 
$cu¼
 = 
	`¬¿y_shiá
(
$Œ“
);

644  
$Œa
;

645 
	}
}

653 
funùiÚ
 
	$book_nod—pi
(&
$node
, 
$İ
, 
$‹a£r
, 
$·ge
) {

654 
$İ
) {

657 
$šfo
['book'] = 
	`db_ãtch_¬¿y
(
	`db_qu”y
('SELECT * FROM {book} b INNER JOIN {m’u_lšks} mÈON b.mlid = ml.mlid WHERE b.nid = %d', 
$node
->
nid
));

658 ià(
$šfo
['book']) {

659 
$šfo
['book']['href'] = $info['book']['link_path'];

660 
$šfo
['book']['title'] = $info['book']['link_title'];

661 
$šfo
['book']['İtiÚs'] = 
	`un£rŸlize
($info['book']['options']);

662  
$šfo
;

666 ià(!
$‹a£r
) {

667 ià(!
	`em±y
(
$node
->
book
['bid']è&& $node->
bud_mode
 =ğ
NODE_BUILD_NORMAL
) {

669 
$node
->
cÚ‹Á
['book_Çvig©iÚ'] = 
	`¬¿y
(

670 '#v®ue' => 
	`theme
('book_Çvig©iÚ', 
$node
->
book
),

674 ià(
$·ge
) {

675 
	`m’u_£t_aùive_Œa
(
	`book_bud_aùive_Œa
(
$node
->
book
));

676 
	`m’u_£t_aùive_m’u_Çme
(
$node
->
book
['menu_name']);

683 ià(!
	`em±y
(
$node
->
book
['bid']è&& !
	`u£r_acûss
('administer‚odes')) {

684 
$node
->
»visiÚ
 = 1;

687 ià(
	`em±y
(
$node
->
nid
)) {

688 
$node
->
book
['mlid'] = 
NULL
;

693 ià(!
	`em±y
(
$node
->
book
['bid'])) {

694 ià(
$node
->
book
['bid'] == 'new') {

696 
$node
->
book
['bid'] = $node->
nid
;

698 
$node
->
book
['nid'] = $node->
nid
;

699 
$node
->
book
['m’u_Çme'] = 
	`book_m’u_Çme
($node->book['bid']);

700 
	`_book_upd©e_ouše
(
$node
);

704 ià(!
	`em±y
(
$node
->
book
['bid'])) {

705 ià(
$node
->
nid
 =ğ$node->
book
['bid']) {

707 
$»suÉ
 = 
	`db_qu”y
("SELECT b.nid FROM {m’u_lšks} mÈINNER JOIN {book} b oÀb.mlid = ml.mlid WHERE ml.¶id = %d", 
$node
->
book
['mlid']);

708 
$chd
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

709 
$chd_node
 = 
	`node_lßd
(
$chd
['nid']);

710 
$chd_node
->
book
['bid'] = $chd_node->
nid
;

711 
	`_book_upd©e_ouše
(
$chd_node
);

714 
	`m’u_lšk_d–‘e
(
$node
->
book
['mlid']);

715 
	`db_qu”y
('DELETE FROM {book} WHERE mlid = %d', 
$node
->
book
['mlid']);

720 ià(
	`em±y
(
$node
->
book
è&& (
	`u£r_acûss
('add contento books') || user_access('administer book outlines'))) {

721 
$node
->
book
 = 
	`¬¿y
();

722 ià(
	`em±y
(
$node
->
nid
è&& 
	`is£t
(
$_GET
['·»Á']è&& 
	`is_num”ic
($_GET['parent'])) {

724 
$·»Á
 = 
	`book_lšk_lßd
(
$_GET
['parent']);

725 ià(
$·»Á
 && $parent['access']) {

726 
$node
->
book
['bid'] = 
$·»Á
['bid'];

727 
$node
->
book
['¶id'] = 
$·»Á
['mlid'];

728 
$node
->
book
['m’u_Çme'] = 
$·»Á
['menu_name'];

732 
$node
->
book
 +ğ
	`_book_lšk_deçuÉs
(!
	`em±y
($node->
nid
) ? $node->nid : 'new');

735 ià(
	`is£t
(
$node
->
book
['bid']) && !isset($node->book['original_bid'])) {

736 
$node
->
book
['original_bid'] = $node->book['bid'];

740 ià(
	`is£t
(
$node
->
book
['bid']) && !isset($node->book['parent_depth_limit'])) {

741 
$node
->
book
['·»Á_d•th_lim™'] = 
	`_book_·»Á_d•th_lim™
($node->book);

745 
	}
}

750 
funùiÚ
 
	$_book_·»Á_d•th_lim™
(
$book_lšk
) {

751  
MENU_MAX_DEPTH
 - 1 - ((
$book_lšk
['mlid'] && $book_lšk['has_chd»n']è? 
	`m’u_lšk_chd»n_»Ïtive_d•th
($book_link) : 0);

752 
	}
}

757 
funùiÚ
 
	$book_fÜm_node_d–‘e_cÚfœm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
) {

759 
$node
 = 
	`node_lßd
(
$fÜm
['nid']['#value']);

761 ià(
	`is£t
(
$node
->
book
) && $node->book['has_children']) {

762 
$fÜm
['book_w¬nšg'] = 
	`¬¿y
(

763 '#v®ue' => '<p>'. 
	`t
('%t™Ë i ·¹ oà¨book ouše,‡nd ha assocŸ‹d chd…ages. Iàyou…roûed w™h d–‘iÚ,hchd…age wÈb»loÿ‹d‡utom©iÿÎy.', 
	`¬¿y
('%t™Ë' => 
$node
->
t™Ë
)) .'</p>',

767 
	}
}

772 
funùiÚ
 
	$_book_lšk_deçuÉs
(
$nid
) {

773  
	`¬¿y
('Üigš®_bid' => 0, 'm’u_Çme' => '', 'nid' => 
$nid
, 'bid' => 0, 'router_path' => 'node/%', 'plid' => 0, 'mlid' => 0, 'has_children' => 0, 'weight' => 0, 'module' => 'book', 'options' =>‡rray());

774 
	}
}

784 
funùiÚ
 
	$‹m¶©e_´•roûss_book_Çvig©iÚ
(&
$v¬ŸbËs
) {

785 
$book_lšk
 = 
$v¬ŸbËs
['book_link'];

788 
$v¬ŸbËs
['book_id'] = 
$book_lšk
['bid'];

789 
$v¬ŸbËs
['book_t™Ë'] = 
	`check_¶aš
(
$book_lšk
['link_title']);

790 
$v¬ŸbËs
['book_u¾'] = 'node/'. 
$book_lšk
['bid'];

791 
$v¬ŸbËs
['cu¼’t_d•th'] = 
$book_lšk
['depth'];

793 
$v¬ŸbËs
['tree'] = '';

794 ià(
$book_lšk
['mlid']) {

795 
$v¬ŸbËs
['Œ“'] = 
	`book_chd»n
(
$book_lšk
);

797 ià(
$´ev
 = 
	`book_´ev
(
$book_lšk
)) {

798 
$´ev_h»f
 = 
	`u¾
(
$´ev
['href']);

799 
	`dru·l_add_lšk
(
	`¬¿y
('»l' => '´ev', 'h»f' => 
$´ev_h»f
));

800 
$v¬ŸbËs
['´ev_u¾'] = 
$´ev_h»f
;

801 
$v¬ŸbËs
['´ev_t™Ë'] = 
	`check_¶aš
(
$´ev
['title']);

803 ià(
$book_lšk
['¶id'] && 
$·»Á
 = 
	`book_lšk_lßd
($book_link['plid'])) {

804 
$·»Á_h»f
 = 
	`u¾
(
$·»Á
['href']);

805 
	`dru·l_add_lšk
(
	`¬¿y
('»l' => 'up', 'h»f' => 
$·»Á_h»f
));

806 
$v¬ŸbËs
['·»Á_u¾'] = 
$·»Á_h»f
;

807 
$v¬ŸbËs
['·»Á_t™Ë'] = 
	`check_¶aš
(
$·»Á
['title']);

809 ià(
$Ãxt
 = 
	`book_Ãxt
(
$book_lšk
)) {

810 
$Ãxt_h»f
 = 
	`u¾
(
$Ãxt
['href']);

811 
	`dru·l_add_lšk
(
	`¬¿y
('»l' => 'Ãxt', 'h»f' => 
$Ãxt_h»f
));

812 
$v¬ŸbËs
['Ãxt_u¾'] = 
$Ãxt_h»f
;

813 
$v¬ŸbËs
['Ãxt_t™Ë'] = 
	`check_¶aš
(
$Ãxt
['title']);

817 
$v¬ŸbËs
['has_lšks'] = 
FALSE
;

819 
$lšks
 = 
	`¬¿y
('prev_url', 'prev_title', 'parent_url', 'parent_title', 'next_url', 'next_title');

820 
	`fÜ—ch
 (
$lšks
 
as
 
$lšk
) {

821 ià(
	`is£t
(
$v¬ŸbËs
[
$lšk
])) {

823 
$v¬ŸbËs
['has_lšks'] = 
TRUE
;

827 
$v¬ŸbËs
[
$lšk
] = '';

830 
	}
}

835 
funùiÚ
 
	$_book_toc_»cur£
(
$Œ“
, 
$šd’t
, &
$toc
, 
$exşude
, 
$d•th_lim™
) {

836 
	`fÜ—ch
 (
$Œ“
 
as
 
$d©a
) {

837 ià(
$d©a
['lšk']['d•th'] > 
$d•th_lim™
) {

841 ià(!
	`š_¬¿y
(
$d©a
['lšk']['mlid'], 
$exşude
)) {

842 
$toc
[
$d©a
['lšk']['mlid']] = 
$šd’t
 .' '. 
	`Œunÿ‹_utf8
($d©a['lšk']['t™Ë'], 30, 
TRUE
, TRUE);

843 ià(
$d©a
['below']) {

844 
	`_book_toc_»cur£
(
$d©a
['b–ow'], 
$šd’t
 .'--', 
$toc
, 
$exşude
, 
$d•th_lim™
);

848 
	}
}

863 
funùiÚ
 
book_toc
(
$bid
, 
$exşude
 = 
¬¿y
(), 
$d•th_lim™
) {

865 
	g$Œ“
 = 
m’u_Œ“_®l_d©a
(
book_m’u_Çme
(
$bid
));

866 
	g$toc
 = 
¬¿y
();

867 
_book_toc_»cur£
(
$Œ“
, '', 
$toc
, 
$exşude
, 
$d•th_lim™
);

869  
	g$toc
;

882 
funùiÚ
 
	$‹m¶©e_´•roûss_book_expÜt_html
(&
$v¬ŸbËs
) {

883 
glob®
 
$ba£_u¾
, 
$Ïnguage
;

885 
$v¬ŸbËs
['t™Ë'] = 
	`check_¶aš
($variables['title']);

886 
$v¬ŸbËs
['ba£_u¾'] = 
$ba£_u¾
;

887 
$v¬ŸbËs
['Ïnguage'] = 
$Ïnguage
;

888 
$v¬ŸbËs
['Ïnguage_¹l'] = (
$Ïnguage
->
dœeùiÚ
 =ğ
LANGUAGE_RTL
);

889 
$v¬ŸbËs
['h—d'] = 
	`dru·l_g‘_html_h—d
();

890 
	}
}

906 
funùiÚ
 
	$book_expÜt_Œav”£
(
$Œ“
, 
$vis™_func
) {

907 
$ouut
 = '';

909 
	`fÜ—ch
 (
$Œ“
 
as
 
$d©a
) {

911 ià(
$node
 = 
	`node_lßd
(
$d©a
['lšk']['nid'], 
FALSE
)) {

912 
$chd»n
 = '';

913 ià(
$d©a
['below']) {

914 
$chd»n
 = 
	`book_expÜt_Œav”£
(
$d©a
['b–ow'], 
$vis™_func
);

917 ià(
	`funùiÚ_exi¡s
(
$vis™_func
)) {

918 
$ouut
 .ğ
	`ÿÎ_u£r_func
(
$vis™_func
, 
$node
, 
$chd»n
);

922 
$ouut
 .ğ
	`book_node_expÜt
(
$node
, 
$chd»n
);

926  
$ouut
;

927 
	}
}

941 
funùiÚ
 
book_node_expÜt
(
$node
, 
$chd»n
 = '') {

943 
$node
->
bud_mode
 = 
NODE_BUILD_PRINT
;

944 
	g$node
 = 
node_bud_cÚ‹Á
(
$node
, 
FALSE
, FALSE);

945 
	g$node
->
	gbody
 = 
dru·l_»nd”
(
$node
->
cÚ‹Á
);

947  
theme
('book_node_expÜt_html', 
$node
, 
$chd»n
);

959 
funùiÚ
 
	$‹m¶©e_´•roûss_book_node_expÜt_html
(&
$v¬ŸbËs
) {

960 
$v¬ŸbËs
['d•th'] = $v¬ŸbËs['node']->
book
['depth'];

961 
$v¬ŸbËs
['t™Ë'] = 
	`check_¶aš
($v¬ŸbËs['node']->
t™Ë
);

962 
$v¬ŸbËs
['cÚ‹Á'] = $v¬ŸbËs['node']->
body
;

963 
	}
}

968 
funùiÚ
 
	$book_ty³_is_®lowed
(
$ty³
) {

969  
	`š_¬¿y
(
$ty³
, 
	`v¬ŸbË_g‘
('book_®lowed_ty³s', 
	`¬¿y
('book')));

970 
	}
}

978 
funùiÚ
 
	$book_node_ty³
(
$İ
, 
$ty³
) {

980 
$İ
) {

982 ià(!
	`em±y
(
$ty³
->
Şd_ty³
è&& $ty³->Şd_ty³ !ğ$ty³->
ty³
) {

984 
$®lowed_ty³s
 = 
	`v¬ŸbË_g‘
('book_®lowed_ty³s', 
	`¬¿y
('book'));

985 
$key
 = 
	`¬¿y_£¬ch
(
$ty³
->
Şd_ty³
, 
$®lowed_ty³s
);

986 ià(
$key
 !=ğ
FALSE
) {

987 
$®lowed_ty³s
[
$ty³
->
ty³
] = $®lowed_ty³s[
$key
] ? $type->type : 0;

988 
	`un£t
(
$®lowed_ty³s
[
$key
]);

989 
	`v¬ŸbË_£t
('book_®lowed_ty³s', 
$®lowed_ty³s
);

992 ià(
	`v¬ŸbË_g‘
('book_chd_ty³', 'book'è=ğ
$ty³
->
Şd_ty³
) {

993 
	`v¬ŸbË_£t
('book_chd_ty³', 
$ty³
->
ty³
);

998 
	}
}

1003 
funùiÚ
 
	$book_h–p
(
$·th
, 
$¬g
) {

1004 
$·th
) {

1006 
$ouut
 = '<p>'. 
	`t
('The book module is suited for creating structured, multi-page hypertexts such‡s site„esource guides, manuals,‡nd Frequently Asked Questions (FAQs). It…ermits‡ documento have chapters, sections, subsections,ƒtc. Authors with suitable…ermissions can‡dd…ageso‡ collaborative book,…lacinghem intoheƒxisting document by‡ddinghemo‡able of contents menu.') .'</p>';

1007 
$ouut
 .ğ'<p>'. 
	`t
('Page šhbook h›¿rchy havÇvig©iÚƒËm’t ©hbÙtom oàth·gfÜ movšghroughh‹xt. The£†šk ËadØth´eviou ªd‚exˆ·ge šhbook,‡ndØthËv–‡bovthcu¼’ˆ·gšhbook\' ¡ruùu». MÜcom´eh’sivÇvig©iÚ may b´ovided byƒÇblšgh<em>book‚avig©iÚ block</em> oÀth<¨h»f="@admš-block">block admši¡¿tiÚ…age</a>.', 
	`¬¿y
('@admš-block' => 
	`u¾
('admin/build/block'))) .'</p>';

1008 
$ouut
 .ğ'<p>'. 
	`t
('Users can selecthe <em>printer-friendly version</em>†ink visible‡the bottom of‡ book…ageo generate‡…rinter-friendly display ofhe…age‡nd‡ll of its subsections. ') .'</p>';

1009 
$ouut
 .ğ'<p>'. 
	`t
("Users withhe <em>administer book outlines</em>…ermission can‡dd‡…ost of‡ny contentypeo‡ book, by selectinghe‡ppropriate book whileƒditinghe…ost or by usinghe interface‡vailable onhe…ost's <em>outline</em>ab.") .'</p>';

1010 
$ouut
 .ğ'<p>'. 
	`t
('Admši¡¿tÜ ÿÀv›w‡†i¡ oà®Èbook Úh<¨h»f="@admš-node-book">book‡dmši¡¿tiÚ…age</a>. Th<em>Ouše</em>…agfÜƒach book‡Îow £ùiÚ™Ë tØbed™ed o¸»¬¿nged.', 
	`¬¿y
('@admš-node-book' => 
	`u¾
('admin/content/book'))) .'</p>';

1011 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@book">Book moduË</a>.', 
	`¬¿y
('@book' => 'http://drupal.org/handbook/modules/book/')) .'</p>';

1012  
$ouut
;

1014  '<p>'. 
	`t
('The book module offers‡ meanso organize‡ collection of„elated…osts, collectively known‡s‡ book. When viewed,hese…osts‡utomatically display†inkso‡djacent book…ages,…roviding‡ simple‚avigation system for creating‡nd„eviewing structured content.') .'</p>';

1016  '<p>'. 
	`t
('Thoušã©u»‡Îow youØšşudpo¡ šh<¨h»f="@book">book h›¿rchy</a>,‡ w–Èa movthem w™hšhh›¿rchy o¸tØ<¨h»f="@book-admš">»Üd”‡À’tœbook</a>.', 
	`¬¿y
('@book' => 
	`u¾
('book'), '@book-admin' => url('admin/content/book'))) .'</p>';

1018 
	}
}

1025 
funùiÚ
 
	$book_lšk_lßd
(
$mlid
) {

1026 ià(
$™em
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT * FROM {m’u_lšks} mÈINNER JOIN {book} b ON b.mlid = ml.mlid LEFT JOIN {m’u_rou‹r} m ON m.·th = ml.rou‹r_·th WHERE ml.mlid = %d", 
$mlid
))) {

1027 
	`_m’u_lšk_Œª¦©e
(
$™em
);

1028  
$™em
;

1030  
FALSE
;

1031 
	}
}

1044 
funùiÚ
 
	$book_m’u_subŒ“_d©a
(
$™em
) {

1045 
$Œ“
 = 
	`¬¿y
();

1048 
$cid
 = 'lšks:'. 
$™em
['menu_name'] .':subtree-cid:'. $item['mlid'];

1050 ià(!
	`is£t
(
$Œ“
[
$cid
])) {

1051 
$ÿche
 = 
	`ÿche_g‘
(
$cid
, 'cache_menu');

1052 ià(
$ÿche
 && 
	`is£t
($ÿche->
d©a
)) {

1055 
$ÿche
 = 
	`ÿche_g‘
($ÿche->
d©a
, 'cache_menu');

1056 ià(
$ÿche
 && 
	`is£t
($ÿche->
d©a
)) {

1057 
$d©a
 = 
$ÿche
->
d©a
;

1061 ià(!
	`is£t
(
$d©a
)) {

1062 
$m©ch
 = 
	`¬¿y
("menu_name = '%s'");

1063 
$¬gs
 = 
	`¬¿y
(
$™em
['menu_name']);

1064 
$i
 = 1;

1065 
$i
 <ğ
MENU_MAX_DEPTH
 && 
$™em
["p$i"]) {

1066 
$m©ch
[] = "p$i = %d";

1067 
$¬gs
[] = 
$™em
["p$i"];

1068 
$i
++;

1070 
$sql
 = "

1071 
SELECT
 
b
.*, 
m
.
lßd_funùiÚs
, m.
to_¬g_funùiÚs
, m.
acûss_ÿÎback
, m.
acûss_¬gum’ts
, m.
·ge_ÿÎback
, m.
·ge_¬gum’ts
, m.
t™Ë
, m.
t™Ë_ÿÎback
, m.
t™Ë_¬gum’ts
, m.
ty³
, 
ml
.*

1072 
FROM
 {
m’u_lšks
} 
ml
 
INNER
 
JOIN
 {
m’u_rou‹r
} 
m
 
ON
 m.
·th
 = ml.
rou‹r_·th


1073 
INNER
 
JOIN
 {
book
} 
b
 
ON
 
ml
.
mlid
 = b.mlid

1074 
WHERE
 ". implode(' AND ', $match) ."

1075 
ORDER
 
BY
 
p1
 
ASC
, 
p2
 ASC, 
p3
 ASC, 
p4
 ASC, 
p5
 ASC, 
p6
 ASC, 
p7
 ASC, 
p8
 ASC, 
p9
 ASC";

1077 
$d©a
['Œ“'] = 
	`m’u_Œ“_d©a
(
	`db_qu”y
(
$sql
, 
$¬gs
), 
	`¬¿y
(), 
$™em
['depth']);

1078 
$d©a
['node_lšks'] = 
	`¬¿y
();

1079 
	`m’u_Œ“_cŞËù_node_lšks
(
$d©a
['tree'], $data['node_links']);

1081 
$Œ“_cid
 = 'lšks:'. 
$™em
['m’u_Çme'] .':subŒ“-d©a:'. 
	`md5
(
	`£rŸlize
(
$d©a
));

1083 ià(!
	`ÿche_g‘
(
$Œ“_cid
, 'cache_menu')) {

1084 
	`ÿche_£t
(
$Œ“_cid
, 
$d©a
, 'cache_menu');

1087 
	`ÿche_£t
(
$cid
, 
$Œ“_cid
, 'cache_menu');

1090 
	`m’u_Œ“_check_acûss
(
$d©a
['tree'], $data['node_links']);

1091 
$Œ“
[
$cid
] = 
$d©a
['tree'];

1094  
$Œ“
[
$cid
];

1095 
	}
}

	@/srv/http/subs/notes/www/modules/book/book.pages.inc

1 <?
php


12 
funùiÚ
 
	$book_»nd”
() {

13 
$book_li¡
 = 
	`¬¿y
();

14 
	`fÜ—ch
 (
	`book_g‘_books
(è
as
 
$book
) {

15 
$book_li¡
[] = 
	`l
(
$book
['title'], $book['href'], $book['options']);

18  
	`theme
('™em_li¡', 
$book_li¡
);

19 
	}
}

42 
funùiÚ
 
	$book_expÜt
(
$ty³
, 
$nid
) {

44 
$ty³
 = 
	`dru·l_¡¹Şow”
($type);

46 
$expÜt_funùiÚ
 = 'book_expÜt_'. 
$ty³
;

48 ià(
	`funùiÚ_exi¡s
(
$expÜt_funùiÚ
)) {

49 
´št
 
	`ÿÎ_u£r_func
(
$expÜt_funùiÚ
, 
$nid
);

52 
	`dru·l_£t_mes§ge
(
	`t
('Unknownƒxport format.'));

53 
	`dru·l_nÙ_found
();

55 
	}
}

74 
funùiÚ
 
	$book_expÜt_html
(
$nid
) {

75 ià(
	`u£r_acûss
('access…rinter-friendly version')) {

76 
$expÜt_d©a
 = 
	`¬¿y
();

77 
$node
 = 
	`node_lßd
(
$nid
);

78 ià(
	`is£t
(
$node
->
book
)) {

79 
$Œ“
 = 
	`book_m’u_subŒ“_d©a
(
$node
->
book
);

80 
$cÚ‹Ás
 = 
	`book_expÜt_Œav”£
(
$Œ“
, 'book_node_export');

82  
	`theme
('book_expÜt_html', 
$node
->
t™Ë
, 
$cÚ‹Ás
, $node->
book
['depth']);

85 
	`dru·l_acûss_d’›d
();

87 
	}
}

92 
funùiÚ
 
	$book_ouše
(
$node
) {

93 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$node
->
t™Ë
));

94  
	`dru·l_g‘_fÜm
('book_ouše_fÜm', 
$node
);

95 
	}
}

105 
funùiÚ
 
	$book_ouše_fÜm
(&
$fÜm_¡©e
, 
$node
) {

107 ià(!
	`is£t
(
$node
->
book
)) {

109 
$node
->
book
 = 
	`_book_lšk_deçuÉs
($node->
nid
);

112 
$node
->
book
['original_bid'] = $node->book['bid'];

115 ià(!
	`is£t
(
$node
->
book
['parent_depth_limit'])) {

116 
$node
->
book
['·»Á_d•th_lim™'] = 
	`_book_·»Á_d•th_lim™
($node->book);

118 
$fÜm
['#node'] = 
$node
;

119 
$fÜm
['#id'] = 'book-outline';

120 
	`_book_add_fÜm_–em’ts
(
$fÜm
, 
$node
);

122 
$fÜm
['book']['#cŞÏpsibË'] = 
FALSE
;

124 
$fÜm
['upd©e'] = 
	`¬¿y
(

126 '#v®ue' => 
$node
->
book
['Üigš®_bid'] ? 
	`t
('Update book outline') :('Addo book outline'),

130 
$fÜm
['»move'] = 
	`¬¿y
(

132 '#v®ue' => 
	`t
('Remove from book outline'),

133 '#acûss' => 
$node
->
nid
 !ğ$node->
book
['bid'] && $node->book['bid'],

135 '#subm™' => 
	`¬¿y
('book_remove_button_submit'),

138  
$fÜm
;

139 
	}
}

146 
funùiÚ
 
	$book_»move_bu‰Ú_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

147 
$fÜm_¡©e
['»dœeù'] = 'node/'. 
$fÜm
['#node']->
nid
 .'/outline/remove';

148 
	}
}

155 
funùiÚ
 
	$book_ouše_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

156 
$node
 = 
$fÜm
['#node'];

157 
$fÜm_¡©e
['»dœeù'] = "node/". 
$node
->
nid
;

158 
$book_lšk
 = 
$fÜm_¡©e
['values']['book'];

159 ià(!
$book_lšk
['bid']) {

160 
	`dru·l_£t_mes§ge
(
	`t
('No changes were made'));

164 
$book_lšk
['m’u_Çme'] = 
	`book_m’u_Çme
($book_link['bid']);

165 
$node
->
book
 = 
$book_lšk
;

166 ià(
	`_book_upd©e_ouše
(
$node
)) {

167 ià(
$node
->
book
['parent_mismatch']) {

169 
	`dru·l_£t_mes§ge
(
	`t
('The…ost has been‡ddedohe selected book. You may‚ow…osition it„elativeo other…ages.'));

170 
$fÜm_¡©e
['»dœeù'] = "node/". 
$node
->
nid
 ."/outline";

173 
	`dru·l_£t_mes§ge
(
	`t
('The book outline has been updated.'));

177 
	`dru·l_£t_mes§ge
(
	`t
('There was‡nƒrror‡ddinghe…ostohe book.'), 'error');

179 
	}
}

188 
funùiÚ
 
	$book_»move_fÜm
(&
$fÜm_¡©e
, 
$node
) {

189 
$fÜm
['#node'] = 
$node
;

190 
$t™Ë
 = 
	`¬¿y
('%t™Ë' => 
$node
->
t™Ë
);

192 ià(
$node
->
book
['has_children']) {

193 
$desütiÚ
 = 
	`t
('%t™Ë ha assocŸ‹d chd…ages, which wÈb»loÿ‹d‡utom©iÿÎyØmaššheœ cÚÃùiÚØthbook. TØ»ü—‹hh›¿rchy (a ™ wa befÜ»movšghi ·ge), %t™Ë may badded‡gaš usšghOušb,‡ndƒach oà™ fÜm” chd…age wÈÃedØb»loÿ‹d mªu®ly.', 
$t™Ë
);

196 
$desütiÚ
 = 
	`t
('%t™Ë may baddedØh›¿rchy‡gaš usšghOušb.', 
$t™Ë
);

199  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØ»mov%t™Ë fromhbook h›¿rchy?', 
$t™Ë
), 'node/'. 
$node
->
nid
, 
$desütiÚ
,('Remove'));

200 
	}
}

207 
funùiÚ
 
	$book_»move_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

208 
$node
 = 
$fÜm
['#node'];

209 ià(
$node
->
nid
 !ğ$node->
book
['bid']) {

211 
	`m’u_lšk_d–‘e
(
$node
->
book
['mlid']);

212 
	`db_qu”y
('DELETE FROM {book} WHERE‚id = %d', 
$node
->
nid
);

213 
	`dru·l_£t_mes§ge
(
	`t
('The…ost has been„emoved fromhe book.'));

215 
$fÜm_¡©e
['»dœeù'] = 'node/'. 
$node
->
nid
;

216 
	}
}

229 
funùiÚ
 
	$book_fÜm_upd©e
() {

230 
$bid
 = 
$_POST
['book']['bid'];

231 ià(
$fÜm
 = 
	`fÜm_g‘_ÿche
(
$_POST
['fÜm_bud_id'], 
$fÜm_¡©e
)) {

234 ià(
	`is£t
(
$fÜm
['book']['bid']['#İtiÚs'][
$bid
])) {

235 
$book_lšk
 = 
$fÜm
['#node']->
book
;

236 
$book_lšk
['bid'] = 
$bid
;

238 
$fÜm
['book']['¶id'] = 
	`_book_·»Á_£Ëù
(
$book_lšk
);

239 
	`fÜm_£t_ÿche
(
$_POST
['fÜm_bud_id'], 
$fÜm
, 
$fÜm_¡©e
);

242 
$fÜm_¡©e
 = 
	`¬¿y
();

243 
$fÜm
['#po¡'] = 
	`¬¿y
();

244 
$fÜm
 = 
	`fÜm_bud”
($fÜm['fÜm_id']['#v®ue'] , $fÜm, 
$fÜm_¡©e
);

245 
$ouut
 = 
	`dru·l_»nd”
(
$fÜm
['book']['plid']);

246 
	`dru·l_jsÚ
(
	`¬¿y
('¡©us' => 
TRUE
, 'd©a' => 
$ouut
));

249 
	`dru·l_jsÚ
(
	`¬¿y
('¡©us' => 
FALSE
, 'data' => ''));

253 
	`dru·l_jsÚ
(
	`¬¿y
('¡©us' => 
FALSE
, 'data' => ''));

255 
	`ex™
();

256 
	}
}

	@/srv/http/subs/notes/www/modules/color/color.module

1 <?
php


7 
funùiÚ
 
	$cŞÜ_h–p
(
$·th
, 
$¬g
) {

8 
$·th
) {

10 
$ouut
 = '<p>'. 
	`t
('ThcŞÜ moduË‡Îow ¨s™admši¡¿tÜØquickly‡ndƒasy chªgthcŞÜ schemoàû¹ašhemes. AÉhough‚Ù‡Îheme suµÜˆcŞÜ moduË, bÙh G¬Ïnd (thdeçuÉhemeèªd MšÃÎ˜w”desigÃdØkadvªgoà™ ã©u»s. By usšg cŞÜ moduË w™h‡ com·tibËheme, you cªƒasy chªgthcŞÜ oàlšks, backgrounds,ext,‡nd oth”hem–em’ts. CŞÜ moduË„equœe th© you¸<¨h»f="@u¾">fdowÆßd m‘hod</a> b£ˆtØpublic.', 
	`¬¿y
('@u¾' => 
	`u¾
('admin/settings/file-system'))) .'</p>';

11 
$ouut
 .ğ'<p>'. 
	`t
("It is importanto„ememberhat color module saves‡ modified copy ofheheme's specified stylesheets inhe files directory. This meanshat if you make‡ny manual changeso yourheme's stylesheet, you must save your color settings‡gain,ƒven ifhey haven't changed. This causeshe color module generated version ofhe stylesheets inhe files directoryo be„ecreated usinghe‚ew version ofhe original file.") .'</p>';

12 
$ouut
 .ğ'<p>'. 
	`t
('TØchªgthcŞÜ s‘tšg fÜ‡ com·tibËheme, s–eùh"cÚfigu»"†šk fÜhthemÚh<¨h»f="@themes">theme admši¡¿tiÚ…age</a>.', 
	`¬¿y
('@themes' => 
	`u¾
('admin/build/themes'))) .'</p>';

13 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@cŞÜ">CŞÜ moduË</a>.', 
	`¬¿y
('@color' => 'http://drupal.org/handbook/modules/color/')) .'</p>';

14  
$ouut
;

16 
	}
}

21 
funùiÚ
 
	$cŞÜ_theme
() {

22  
	`¬¿y
(

23 'cŞÜ_scheme_fÜm' => 
	`¬¿y
(

24 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

27 
	}
}

32 
funùiÚ
 
	$cŞÜ_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

34 ià(
$fÜm_id
 =ğ'sy¡em_theme_£‰šgs' && 
	`cŞÜ_g‘_šfo
(
	`¬g
(4)è&& 
	`funùiÚ_exi¡s
('gd_info')) {

35 ià(
	`v¬ŸbË_g‘
('fe_dowÆßds', 
FILE_DOWNLOADS_PUBLIC
) != FILE_DOWNLOADS_PUBLIC) {

38 
	`dru·l_£t_mes§ge
(
	`t
('ThcŞÜ…ick” oÆy wÜk iàth<¨h»f="@u¾">dowÆßd m‘hod</a> i £ˆtØpublic.', 
	`¬¿y
('@u¾' => 
	`u¾
('admin/settings/file-system'))), 'warning');

41 
$fÜm
['cŞÜ'] = 
	`¬¿y
(

43 '#t™Ë' => 
	`t
('Color scheme'),

45 '#©Œibu‹s' => 
	`¬¿y
('id' => 'color_scheme_form'),

48 
$fÜm
['cŞÜ'] +ğ
	`cŞÜ_scheme_fÜm
(
$fÜm_¡©e
, 
	`¬g
(4));

49 
$fÜm
['#submit'][] = 'color_scheme_form_submit';

54 ià(
$fÜm_id
 == 'system_theme_select_form' || $form_id == 'system_themes') {

55 
$themes
 = 
	`li¡_themes
();

56 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$theme
) {

57 ià(
$sü“nshÙ
 = 
	`v¬ŸbË_g‘
('cŞÜ_'. 
$theme
 .'_sü“nshÙ', 
NULL
)) {

58 ià(
	`is£t
(
$fÜm
[
$theme
]['screenshot'])) {

59 
$fÜm
[
$theme
]['sü“nshÙ']['#v®ue'] = 
	`theme
('image', 
$sü“nshÙ
, '', '', 
	`¬¿y
('şass' => 'sü“nshÙ'), 
FALSE
);

64 
	}
}

69 
funùiÚ
 
	$_cŞÜ_·ge_®‹r
(&
$v¬s
) {

70 
glob®
 
$Ïnguage
, 
$theme_key
;

73 
$cŞÜ_·ths
 = 
	`v¬ŸbË_g‘
('cŞÜ_'. 
$theme_key
 .'_¡yËsh“ts', 
	`¬¿y
());

74 ià(!
	`em±y
(
$cŞÜ_·ths
)) {

77 
$Ãw_theme_css
 = 
	`¬¿y
();

79 
	`fÜ—ch
 (
$v¬s
['css']['®l']['theme'] 
as
 
$Şd_·th
 => 
$Şd_´•roûss
) {

82 
$Ãw_theme_css
[
$Şd_·th
] = 
$Şd_´•roûss
;

86 
	`fÜ—ch
 (
$cŞÜ_·ths
 
as
 
$cŞÜ_·th
) {

89 ià(
	`ba£Çme
(
$Şd_·th
è=ğba£Çme(
$cŞÜ_·th
)) {

91 
	`un£t
(
$Ãw_theme_css
[
$Şd_·th
]);

92 
$Ãw_theme_css
[
$cŞÜ_·th
] = 
$Şd_´•roûss
;

96 ià(
$Ïnguage
->
dœeùiÚ
 =ğ
LANGUAGE_RTL
) {

97 
$¹l_Şd_·th
 = 
	`¡r_»¶aû
('.css', '-¹l.css', 
$Şd_·th
);

98 
$¹l_cŞÜ_·th
 = 
	`¡r_»¶aû
('.css', '-¹l.css', 
$cŞÜ_·th
);

99 ià(
	`fe_exi¡s
(
$¹l_cŞÜ_·th
)) {

100 
	`un£t
(
$Ãw_theme_css
[
$¹l_Şd_·th
]);

101 
$Ãw_theme_css
[
$¹l_cŞÜ_·th
] = 
$Şd_´•roûss
;

108 
$v¬s
['css']['®l']['theme'] = 
$Ãw_theme_css
;

109 
$v¬s
['¡yËs'] = 
	`dru·l_g‘_css
($vars['css']);

113 
$logo
 = 
	`v¬ŸbË_g‘
('cŞÜ_'. 
$theme_key
 .'_logo', 
NULL
);

114 ià(
$logo
 && 
$v¬s
['logo'] && 
	`´eg_m©ch
('!'. 
$theme_key
 .'/logo.png$!', $vars['logo'])) {

115 
$v¬s
['logo'] = 
	`ba£_·th
(è. 
$logo
;

117 
	}
}

122 
funùiÚ
 
	$cŞÜ_g‘_šfo
(
$theme
) {

123 
$·th
 = 
	`dru·l_g‘_·th
('theme', 
$theme
);

124 
$fe
 = 
$·th
 .'/color/color.inc';

125 ià(
$·th
 && 
	`fe_exi¡s
(
$fe
)) {

126 
šşude
 
$fe
;

127  
$šfo
;

129 
	}
}

134 
funùiÚ
 
	$cŞÜ_g‘_·Ë‰e
(
$theme
, 
$deçuÉ
 = 
çl£
) {

136 
$f›lds
 = 
	`¬¿y
('base', 'link', 'top', 'bottom', 'text');

137 
$šfo
 = 
	`cŞÜ_g‘_šfo
(
$theme
);

138 
$keys
 = 
	`¬¿y_keys
(
$šfo
['schemes']);

139 
	`fÜ—ch
 (
	`ex¶ode
(',', 
	`¬¿y_shiá
(
$keys
)è
as
 
$k
 => 
$scheme
) {

140 
$·Ë‰e
[
$f›lds
[
$k
]] = 
$scheme
;

144  
$deçuÉ
 ? 
$·Ë‰e
 : 
	`v¬ŸbË_g‘
('cŞÜ_'. 
$theme
 .'_palette', $palette);

145 
	}
}

150 
funùiÚ
 
	$cŞÜ_scheme_fÜm
(&
$fÜm_¡©e
, 
$theme
) {

151 
$ba£
 = 
	`dru·l_g‘_·th
('module', 'color');

152 
$šfo
 = 
	`cŞÜ_g‘_šfo
(
$theme
);

155 
	`dru·l_add_css
('misc/çrb¡ic/çrb¡ic.css', 'moduË', '®l', 
FALSE
);

156 
	`dru·l_add_js
('misc/farbtastic/farbtastic.js');

159 
	`dru·l_add_css
(
$ba£
 .'/cŞÜ.css', 'moduË', '®l', 
FALSE
);

160 
	`dru·l_add_js
(
$ba£
 .'/color.js');

161 
	`dru·l_add_js
(
	`¬¿y
('color' =>‡rray(

162 '»ã»nû' => 
	`cŞÜ_g‘_·Ë‰e
(
$theme
, 
Œue
)

166 
$cu¼’t
 = 
	`im¶ode
(',', 
	`v¬ŸbË_g‘
('cŞÜ_'. 
$theme
 .'_·Ë‰e', 
	`¬¿y
()));

168 
$cu¼’t
 = 
	`is£t
(
$šfo
['schemes'][$cu¼’t]è? $cu¼’ˆ: ($cu¼’ˆ=ğ'' ? 
	`»£t
($info['schemes']) : '');

171 
$šfo
['schemes'][''] = 
	`t
('Custom');

172 
$fÜm
['scheme'] = 
	`¬¿y
(

174 '#t™Ë' => 
	`t
('Color set'),

175 '#İtiÚs' => 
$šfo
['schemes'],

176 '#deçuÉ_v®ue' => 
$cu¼’t
,

180 
$·Ë‰e
 = 
	`cŞÜ_g‘_·Ë‰e
(
$theme
);

181 
$Çmes
 = 
	`¬¿y
(

182 'ba£' => 
	`t
('Base color'),

183 'lšk' => 
	`t
('Link color'),

184 'tİ' => 
	`t
('Headerop'),

185 'bÙtom' => 
	`t
('Header bottom'),

186 '‹xt' => 
	`t
('Text color')

188 
$fÜm
['·Ë‰e']['#Œ“'] = 
Œue
;

189 
	`fÜ—ch
 (
$·Ë‰e
 
as
 
$Çme
 => 
$v®ue
) {

190 
$fÜm
['·Ë‰e'][
$Çme
] = 
	`¬¿y
(

192 '#t™Ë' => 
$Çmes
[
$Çme
],

193 '#deçuÉ_v®ue' => 
$v®ue
,

197 
$fÜm
['theme'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
	`¬g
(4));

198 
$fÜm
['šfo'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$šfo
);

200  
$fÜm
;

201 
	}
}

208 
funùiÚ
 
	$theme_cŞÜ_scheme_fÜm
(
$fÜm
) {

210 
$theme
 = 
$fÜm
['theme']['#value'];

211 
$šfo
 = 
$fÜm
['info']['#value'];

212 
$·th
 = 
	`dru·l_g‘_·th
('theme', 
$theme
) .'/';

213 
	`dru·l_add_css
(
$·th
 . 
$šfo
['preview_css']);

214 
$ouut
 = '';

216 
$ouut
 .= '<div class="color-form clear-block">';

219 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['scheme']);

222 
$ouut
 .= '<div id="palette" class="clear-block">';

223 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['·Ë‰e']è
as
 
$Çme
) {

224 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['·Ë‰e'][
$Çme
]);

226 
$ouut
 .= '</div>';

229 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

230 
$ouut
 .ğ'<h2>'. 
	`t
('Preview') .'</h2>';

231 
$ouut
 .ğ'<div id="´ev›w"><div id="‹xt"><h2>LÜem ipsum dŞÜ</h2><p>S™‡m‘, cÚ£ù‘u¸adisicšgƒl™, sed dØeiusmodempÜ incididuÁ uˆÏbÜ‘ dŞÜmagÇ‡liqua. Uˆ’im‡d mšim v’Ÿm, qui no¡rud <¨h»f="#">ex”c™©iÚ uÎamco</a>†abÜi nis˜uˆ®iquƒxƒ¨commodØcÚ£qu©. Dui au‹ iru» dŞÜ iÀ»´eh’d”™ iÀvŞu±©v–™ƒs£ clum dŞÜeu fugŸˆnuÎ¨·rŸtur. Exû±eu¸sšˆocÿeÿˆcupid©©‚Ú…roid’t, suÁ iÀcuÍ¨qu˜officŸ de£ruÁ mŞl™‡nim idƒ¡†abÜum.</p></div><div id="img" styË="background-image: u¾('. 
	`ba£_·th
(è. 
$·th
 . 
$šfo
['preview_image'] .')"></div></div>';

234 
$ouut
 .= '</div>';

236  
$ouut
;

237 
	}
}

242 
funùiÚ
 
	$cŞÜ_scheme_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

244 ià(!
	`is£t
(
$fÜm_¡©e
['values']['info'])) {

247 
$theme
 = 
$fÜm_¡©e
['values']['theme'];

248 
$šfo
 = 
$fÜm_¡©e
['values']['info'];

251 
$·Ë‰e
 = 
$fÜm_¡©e
['values']['palette'];

252 ià(
$fÜm_¡©e
['values']['scheme'] != '') {

253 
$scheme
 = 
	`ex¶ode
(',', 
$fÜm_¡©e
['values']['scheme']);

254 
	`fÜ—ch
 (
$·Ë‰e
 
as
 
$k
 => 
$cŞÜ
) {

255 
$·Ë‰e
[
$k
] = 
	`¬¿y_shiá
(
$scheme
);

260 ià(
	`funùiÚ_exi¡s
('memory_get_usage')) {

262 
$sourû
 = 
	`dru·l_g‘_·th
('theme', 
$theme
è.'/'. 
$šfo
['base_image'];

263 
	`li¡
(
$width
, 
$height
èğ
	`g‘imagesize
(
$sourû
);

267 
$»quœed
 = 
$width
 * 
$height
 * 8;

268 
$u§ge
 = 
	`memÜy_g‘_u§ge
();

269 
$lim™
 = 
	`·r£_size
(
	`ši_g‘
('memory_limit'));

270 ià(
$u§ge
 + 
$»quœed
 > 
$lim™
) {

271 
	`dru·l_£t_mes§ge
(
	`t
('Th”i nÙƒnough memÜy‡vaabËØPHPØchªgthi theme\' cŞÜ scheme. You‚“d‡ˆËa¡ %sizmÜe. Checkh<¨h»f="@u¾">PHP docum’tiÚ</a> fÜ mÜšfÜm©iÚ.', 
	`¬¿y
('%size' => 
	`fÜm©_size
(
$u§ge
 + 
$»quœed
 - 
$lim™
), '@url' => 'http://www.php.net/manual/en/ini.core.php#ini.sect.resource-limits')), 'error');

277 
	`fÜ—ch
 (
	`v¬ŸbË_g‘
('cŞÜ_'. 
$theme
 .'_fes', 
	`¬¿y
()è
as
 
$fe
) {

278 @
	`uÆšk
(
$fe
);

280 ià(
	`is£t
(
$fe
è&& $fğ
	`dœÇme
($file)) {

281 @
	`rmdœ
(
$fe
);

285 ià(
	`im¶ode
(',', 
	`cŞÜ_g‘_·Ë‰e
(
$theme
, 
Œue
)è=ğim¶ode(',', 
$·Ë‰e
)

286 || 
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('Reseto defaults')) {

287 
	`v¬ŸbË_d–
('cŞÜ_'. 
$theme
 .'_palette');

288 
	`v¬ŸbË_d–
('cŞÜ_'. 
$theme
 .'_stylesheets');

289 
	`v¬ŸbË_d–
('cŞÜ_'. 
$theme
 .'_logo');

290 
	`v¬ŸbË_d–
('cŞÜ_'. 
$theme
 .'_files');

291 
	`v¬ŸbË_d–
('cŞÜ_'. 
$theme
 .'_screenshot');

296 
$id
 = 
$theme
 .'-'. 
	`sub¡r
(
	`md5
(
	`£rŸlize
(
$·Ë‰e
è. 
	`miüÙime
()), 0, 8);

297 
$·ths
['cŞÜ'] = 
	`fe_dœeùÜy_·th
() .'/color';

298 
$·ths
['rg‘'] = $·ths['cŞÜ'] .'/'. 
$id
;

299 
	`fÜ—ch
 (
$·ths
 
as
 
$·th
) {

300 
	`fe_check_dœeùÜy
(
$·th
, 
FILE_CREATE_DIRECTORY
);

302 
$·ths
['target'] = $paths['target'] .'/';

303 
$·ths
['id'] = 
$id
;

304 
$·ths
['sourû'] = 
	`dru·l_g‘_·th
('theme', 
$theme
) .'/';

305 
$·ths
['fes'] = $·ths['m­'] = 
	`¬¿y
();

308 
	`v¬ŸbË_£t
('cŞÜ_'. 
$theme
 .'_·Ë‰e', 
$·Ë‰e
);

309 
	`v¬ŸbË_£t
('cŞÜ_'. 
$theme
 .'_logo', 
$·ths
['target'] .'logo.png');

312 
	`fÜ—ch
 (
$šfo
['cİy'] 
as
 
$fe
) {

313 
$ba£
 = 
	`ba£Çme
(
$fe
);

314 
$sourû
 = 
$·ths
['sourû'] . 
$fe
;

315 
	`fe_cİy
(
$sourû
, 
$·ths
['rg‘'] . 
$ba£
);

316 
$·ths
['m­'][
$fe
] = 
$ba£
;

317 
$·ths
['fes'][] = $·ths['rg‘'] . 
$ba£
;

321 ià(
$šfo
['base_image']) {

322 
	`_cŞÜ_»nd”_images
(
$theme
, 
$šfo
, 
$·ths
, 
$·Ë‰e
);

326 
$css
 = 
	`¬¿y
();

327 
	`fÜ—ch
 (
$šfo
['css'] 
as
 
$¡yËsh“t
) {

329 
$fes
 = 
	`¬¿y
();

330 ià(
	`fe_exi¡s
(
$·ths
['sourû'] . 
$¡yËsh“t
)) {

331 
$fes
[] = 
$¡yËsh“t
;

333 
$¹l_fe
 = 
	`¡r_»¶aû
('.css', '-¹l.css', 
$¡yËsh“t
);

334 ià(
	`fe_exi¡s
(
$·ths
['sourû'] . 
$¹l_fe
)) {

335 
$fes
[] = 
$¹l_fe
;

339 
	`fÜ—ch
 (
$fes
 
as
 
$fe
) {

343 
$¡yË
 = 
	`dru·l_lßd_¡yËsh“t
(
$·ths
['sourû'] . 
$fe
, 
FALSE
);

347 
$ba£
 = 
	`ba£_·th
(è. 
	`dœÇme
(
$·ths
['sourû'] . 
$fe
) .'/';

348 
	`_dru·l_bud_css_·th
(
NULL
, 
$ba£
);

351 
$¡yË
 = 
	`´eg_»¶aû_ÿÎback
('/url\([\'"]?(?![a-z]+:|\/+)([^\'")]+)[\'"]?\)/i', '_drupal_build_css_path', $style);

354 
$¡yË
 = 
	`_cŞÜ_»wr™e_¡yËsh“t
(
$theme
, 
$šfo
, 
$·ths
, 
$·Ë‰e
, $style);

355 
$ba£_fe
 = 
	`ba£Çme
(
$fe
);

356 
$css
[] = 
$·ths
['rg‘'] . 
$ba£_fe
;

357 
	`_cŞÜ_§ve_¡yËsh“t
(
$·ths
['rg‘'] . 
$ba£_fe
, 
$¡yË
, $paths);

362 
	`v¬ŸbË_£t
('cŞÜ_'. 
$theme
 .'_¡yËsh“ts', 
$css
);

363 
	`v¬ŸbË_£t
('cŞÜ_'. 
$theme
 .'_fes', 
$·ths
['files']);

364 
	}
}

369 
funùiÚ
 
	$_cŞÜ_»wr™e_¡yËsh“t
(
$theme
, &
$šfo
, &
$·ths
, 
$·Ë‰e
, 
$¡yË
) {

370 
$themes
 = 
	`li¡_themes
();

373 
$cÚv”siÚ
 = 
$·Ë‰e
;

374 
	`un£t
(
$cÚv”siÚ
['base']);

375 
	`fÜ—ch
 (
$cÚv”siÚ
 
as
 
$k
 => 
$v
) {

376 
$cÚv”siÚ
[
$k
] = 
	`dru·l_¡¹Şow”
(
$v
);

378 
$deçuÉ
 = 
	`cŞÜ_g‘_·Ë‰e
(
$theme
, 
Œue
);

381 
$¥l™
 = "Color Module: Don'touch";

382 ià(
	`¡½os
(
$¡yË
, 
$¥l™
è!=ğ
FALSE
) {

383 
	`li¡
(
$¡yË
, 
$fixed
èğ
	`ex¶ode
(
$¥l™
, $style);

387 
$¡yË
 = 
	`´eg_¥l™
('/(#[0-9a-f]{6}|#[0-9a-f]{3})/i', $¡yË, -1, 
PREG_SPLIT_DELIM_CAPTURE
);

388 
$is_cŞÜ
 = 
çl£
;

389 
$ouut
 = '';

390 
$ba£
 = 'base';

393 
	`fÜ—ch
 (
$¡yË
 
as
 
$chunk
) {

394 ià(
$is_cŞÜ
) {

395 
$chunk
 = 
	`dru·l_¡¹Şow”
($chunk);

397 ià(
$key
 = 
	`¬¿y_£¬ch
(
$chunk
, 
$deçuÉ
)) {

398 
$chunk
 = 
$cÚv”siÚ
[
$key
];

402 
$chunk
 = 
	`_cŞÜ_shiá
(
$·Ë‰e
[
$ba£
], 
$deçuÉ
[$ba£], $chunk, 
$šfo
['blend_target']);

409 ià(
	`´eg_m©ch
('@[^a-z0-9_-]×)[^a-z0-9_-][^/{]*{[^{]+$@i', 
$chunk
)) {

410 
$ba£
 = 'link';

413 ià(
	`´eg_m©ch
('/(?<!-)cŞÜ[^{:]*:[^{#]*$/i', 
$chunk
)) {

414 
$ba£
 = 'text';

418 
$ba£
 = 'base';

421 
$ouut
 .ğ
$chunk
;

422 
$is_cŞÜ
 = !$is_color;

425 ià(
	`is£t
(
$fixed
)) {

426 
$ouut
 .ğ
$fixed
;

430 
	`fÜ—ch
 (
$·ths
['m­'] 
as
 
$befÜe
 => 
$aá”
) {

431 
$befÜe
 = 
	`ba£_·th
(è. 
$·ths
['source'] . $before;

432 
$befÜe
 = 
	`´eg_»¶aû
('`(^|/)(?!../)([^/]+)/../`', '$1', $before);

433 
$ouut
 = 
	`¡r_»¶aû
(
$befÜe
, 
$aá”
, $output);

436  
$ouut
;

437 
	}
}

442 
funùiÚ
 
	$_cŞÜ_§ve_¡yËsh“t
(
$fe
, 
$¡yË
, &
$·ths
) {

445 
	`fe_§ve_d©a
(
$¡yË
, 
$fe
, 
FILE_EXISTS_REPLACE
);

446 
$·ths
['fes'][] = 
$fe
;

449 @
	`chmod
(
$fe
, 0664);

450 
	}
}

455 
funùiÚ
 
	$_cŞÜ_»nd”_images
(
$theme
, &
$šfo
, &
$·ths
, 
$·Ë‰e
) {

458 
$sourû
 = 
$·ths
['sourû'] .'/'. 
$šfo
['base_image'];

459 
$sourû
 = 
	`imageü—‹äom²g
($source);

460 
$width
 = 
	`imagesx
(
$sourû
);

461 
$height
 = 
	`imagesy
(
$sourû
);

464 
$rg‘
 = 
	`imageü—‹ŒuecŞÜ
(
$width
, 
$height
);

465 
	`imag—ÍhabËndšg
(
$rg‘
, 
Œue
);

468 
	`fÜ—ch
 (
$šfo
['fl'] 
as
 
$cŞÜ
 => 
$fl
) {

469 
	`imagefËd»ùªgË
(
$rg‘
, 
$fl
[0], $fl[1], $fl[0] + $fl[2], $fl[1] + $fl[3], 
	`_cŞÜ_gd
($rg‘, 
$·Ë‰e
[
$cŞÜ
]));

473 
$y
 = 0; $y < 
$šfo
['gradient'][3]; ++$y) {

474 
$cŞÜ
 = 
	`_cŞÜ_bËnd
(
$rg‘
, 
$·Ë‰e
['tİ'], $·Ë‰e['bÙtom'], 
$y
 / (
$šfo
['gradient'][3] - 1));

475 
	`imagefËd»ùªgË
(
$rg‘
, 
$šfo
['g¿d›Á'][0], $šfo['g¿d›Á'][1] + 
$y
, $šfo['g¿d›Á'][0] + $šfo['g¿d›Á'][2], $šfo['g¿d›Á'][1] + $y + 1, 
$cŞÜ
);

479 
	`imagecİy
(
$rg‘
, 
$sourû
, 0, 0, 0, 0, 
$width
, 
$height
);

482 
	`imagede¡roy
(
$sourû
);

485 
	`fÜ—ch
 (
$šfo
['¦iûs'] 
as
 
$fe
 => 
$coÜd
) {

486 
	`li¡
(
$x
, 
$y
, 
$width
, 
$height
èğ
$coÜd
;

487 
$ba£
 = 
	`ba£Çme
(
$fe
);

488 
$image
 = 
$·ths
['rg‘'] . 
$ba£
;

491 ià(
$fe
 == 'screenshot.png') {

492 
$¦iû
 = 
	`imageü—‹ŒuecŞÜ
(150, 90);

493 
	`imagecİy»§m¶ed
(
$¦iû
, 
$rg‘
, 0, 0, 
$x
, 
$y
, 150, 90, 
$width
, 
$height
);

494 
	`v¬ŸbË_£t
('cŞÜ_'. 
$theme
 .'_sü“nshÙ', 
$image
);

497 
$¦iû
 = 
	`imageü—‹ŒuecŞÜ
(
$width
, 
$height
);

498 
	`imagecİy
(
$¦iû
, 
$rg‘
, 0, 0, 
$x
, 
$y
, 
$width
, 
$height
);

502 
	`imag•ng
(
$¦iû
, 
$image
);

503 
	`imagede¡roy
(
$¦iû
);

504 
$·ths
['fes'][] = 
$image
;

507 @
	`chmod
(
	`»®·th
(
$image
), 0664);

510 
$·ths
['m­'][
$fe
] = 
$ba£
;

514 
	`imagede¡roy
(
$rg‘
);

515 
	}
}

529 
funùiÚ
 
	$_cŞÜ_shiá
(
$giv’
, 
$»f1
, 
$»f2
, 
$rg‘
) {

535 
$rg‘
 = 
	`_cŞÜ_uÅack
($rg‘, 
Œue
);

536 
$»f1
 = 
	`_cŞÜ_uÅack
($»f1, 
Œue
);

537 
$»f2
 = 
	`_cŞÜ_uÅack
($»f2, 
Œue
);

538 
$num”©Ü
 = 0;

539 
$d’omš©Ü
 = 0;

540 
$i
 = 0; $i < 3; ++$i) {

541 
$num”©Ü
 +ğ(
$»f2
[
$i
] - 
$»f1
[$i]) * ($ref2[$i] - $ref1[$i]);

542 
$d’omš©Ü
 +ğ(
$rg‘
[
$i
] - 
$»f1
[$i]) * ($target[$i] - $ref1[$i]);

544 
$d–
 = (
$d’omš©Ü
 > 0è? (1 - 
	`sq¹
(
$num”©Ü
 / $denominator)) : 0;

547 
$i
 = 0; $i < 3; ++$i) {

548 
$»f3
[
$i
] = 
$rg‘
[$i] + (
$»f1
[$i] - $rg‘[$i]è* 
$d–
;

553 
$»f2
 = 
	`_cŞÜ_rgb2h¦
($ref2);

554 
$»f3
 = 
	`_cŞÜ_rgb2h¦
($ref3);

555 
$i
 = 0; $i < 3; ++$i) {

556 
$shiá
[
$i
] = 
$»f2
[$i] - 
$»f3
[$i];

560 
$giv’
 = 
	`_cŞÜ_uÅack
($giv’, 
Œue
);

561 
$i
 = 0; $i < 3; ++$i) {

562 
$»suÉ
[
$i
] = 
$rg‘
[$i] + (
$giv’
[$i] - $rg‘[$i]è* 
$d–
;

567 
$»suÉ
 = 
	`_cŞÜ_rgb2h¦
($result);

568 
$i
 = 0; $i < 3; ++$i) {

569 
$»suÉ
[
$i
] = 
	`mš
(1, 
	`max
(0, $»suÉ[$i] + 
$shiá
[$i]));

571 
$»suÉ
 = 
	`_cŞÜ_h¦2rgb
($result);

574  
	`_cŞÜ_·ck
(
$»suÉ
, 
Œue
);

575 
	}
}

580 
funùiÚ
 
	$_cŞÜ_gd
(
$img
, 
$hex
) {

581 
$c
 = 
	`¬¿y_m”ge
(
	`¬¿y
(
$img
), 
	`_cŞÜ_uÅack
(
$hex
));

582  
	`ÿÎ_u£r_func_¬¿y
('imagecŞÜ®loÿ‹', 
$c
);

583 
	}
}

588 
funùiÚ
 
	$_cŞÜ_bËnd
(
$img
, 
$hex1
, 
$hex2
, 
$®pha
) {

589 
$š1
 = 
	`_cŞÜ_uÅack
(
$hex1
);

590 
$š2
 = 
	`_cŞÜ_uÅack
(
$hex2
);

591 
$out
 = 
	`¬¿y
(
$img
);

592 
$i
 = 0; $i < 3; ++$i) {

593 
$out
[] = 
$š1
[
$i
] + (
$š2
[$i] - $š1[$i]è* 
$®pha
;

595  
	`ÿÎ_u£r_func_¬¿y
('imagecŞÜ®loÿ‹', 
$out
);

596 
	}
}

601 
funùiÚ
 
	$_cŞÜ_uÅack
(
$hex
, 
$nÜm®ize
 = 
çl£
) {

602 ià(
	`¡¾’
(
$hex
) == 4) {

603 
$hex
 = $hex[1] . $hex[1] . $hex[2] . $hex[2] . $hex[3] . $hex[3];

605 
$c
 = 
	`hexdec
(
$hex
);

606 
$i
 = 16; $i >= 0; $i -= 8) {

607 
$out
[] = ((
$c
 >> 
$i
è& 0xFFè/ (
$nÜm®ize
 ? 255 : 1);

609  
$out
;

610 
	}
}

615 
funùiÚ
 
	$_cŞÜ_·ck
(
$rgb
, 
$nÜm®ize
 = 
çl£
) {

616 
$out
 = 0;

617 
	`fÜ—ch
 (
$rgb
 
as
 
$k
 => 
$v
) {

618 
$out
 |ğ((
$v
 * (
$nÜm®ize
 ? 255 : 1)è<< (16 - 
$k
 * 8));

620  '#'. 
	`¡r_·d
(
	`dechex
(
$out
), 6, 0, 
STR_PAD_LEFT
);

621 
	}
}

626 
funùiÚ
 
	$_cŞÜ_h¦2rgb
(
$h¦
) {

627 
$h
 = 
$h¦
[0];

628 
$s
 = 
$h¦
[1];

629 
$l
 = 
$h¦
[2];

630 
$m2
 = (
$l
 <ğ0.5è? $È* (
$s
 + 1) : $l + $s - $l*$s;

631 
$m1
 = 
$l
 * 2 - 
$m2
;

632  
	`¬¿y
(

633 
	`_cŞÜ_hue2rgb
(
$m1
, 
$m2
, 
$h
 + 0.33333),

634 
	`_cŞÜ_hue2rgb
(
$m1
, 
$m2
, 
$h
),

635 
	`_cŞÜ_hue2rgb
(
$m1
, 
$m2
, 
$h
 - 0.33333),

637 
	}
}

642 
funùiÚ
 
	$_cŞÜ_hue2rgb
(
$m1
, 
$m2
, 
$h
) {

643 
$h
 = ($h < 0) ? $h + 1 : (($h > 1) ? $h - 1 : $h);

644 ià(
$h
 * 6 < 1è 
$m1
 + (
$m2
 - $m1) * $h * 6;

645 ià(
$h
 * 2 < 1è 
$m2
;

646 ià(
$h
 * 3 < 2è 
$m1
 + (
$m2
 - $m1) * (0.66666 - $h) * 6;

647  
$m1
;

648 
	}
}

653 
funùiÚ
 
	$_cŞÜ_rgb2h¦
(
$rgb
) {

654 
$r
 = 
$rgb
[0];

655 
$g
 = 
$rgb
[1];

656 
$b
 = 
$rgb
[2];

657 
$mš
 = 
	`mš
(
$r
, mš(
$g
, 
$b
));

658 
$max
 = 
	`max
(
$r
, max(
$g
, 
$b
));

659 
$d–
 = 
$max
 - 
$mš
;

660 
$l
 = (
$mš
 + 
$max
) / 2;

661 
$s
 = 0;

662 ià(
$l
 > 0 && $l < 1) {

663 
$s
 = 
$d–
 / (
$l
 < 0.5 ? (2 * $l) : (2 - 2 * $l));

665 
$h
 = 0;

666 ià(
$d–
 > 0) {

667 ià(
$max
 =ğ
$r
 && $max !ğ
$g
è
$h
 +ğ($g - 
$b
è/ 
$d–
;

668 ià(
$max
 =ğ
$g
 && $max !ğ
$b
è
$h
 +ğ(2 + ($b - 
$r
è/ 
$d–
);

669 ià(
$max
 =ğ
$b
 && $max !ğ
$r
è
$h
 +ğ(4 + ($¸- 
$g
è/ 
$d–
);

670 
$h
 /= 6;

672  
	`¬¿y
(
$h
, 
$s
, 
$l
);

673 
	}
}

	@/srv/http/subs/notes/www/modules/comment/comment-folded.tpl.php

1 <?
	gphp


19 <
div
 
	gşass
="comment-folded">

20 <
¥ª
 
şass
="subjeù"><?
php
 
´št
 
$t™Ë
 .' '. 
$Ãw
; ?></
	g¥ª
><¥ª 
	gşass
="üed™"><?ph°´šˆ
t
('by'è.' '. 
$authÜ
; ?></span>

21 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/comment/comment-wrapper.tpl.php

1 <?
	gphp


34 <
div
 
	gid
="comments">

35 <?
php
 
´št
 
$cÚ‹Á
; ?>

36 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/comment/comment.admin.inc

1 <?
php


12 
funùiÚ
 
comm’t_admš
(
$ty³
 = 'new') {

13 
$ed™
 = 
$_POST
;

15 ià(
is£t
(
$ed™
['İ”©iÚ']è&& (
	g$ed™
['operation'] == 'delete') && isset($edit['comments']) && $edit['comments']) {

16  
dru·l_g‘_fÜm
('comment_multiple_delete_confirm');

19  
dru·l_g‘_fÜm
('comm’t_admš_ov”v›w', 
$ty³
, 
¬g
(4));

37 
funùiÚ
 
comm’t_admš_ov”v›w
(
$ty³
 = 'Ãw', 
$¬g
) {

39 
	g$fÜm
['İtiÚs'] = 
¬¿y
(

40 '#ty³' => 'f›ld£t', '#t™Ë' => 
t
('Update options'),

43 
	g$İtiÚs
 = 
¬¿y
();

44 
fÜ—ch
 (
comm’t_İ”©iÚs
(
$¬g
 =ğ'­´ov®' ? 'publish' : 'uÅublish'è
as
 
$key
 => 
$v®ue
) {

45 
$İtiÚs
[
$key
] = 
$v®ue
[0];

47 
	g$fÜm
['İtiÚs']['İ”©iÚ'] = 
¬¿y
('#ty³' => '£Ëù', '#İtiÚs' => 
$İtiÚs
, '#default_value' => 'publish');

48 
	g$fÜm
['İtiÚs']['subm™'] = 
¬¿y
('#ty³' => 'subm™', '#v®ue' => 
t
('Update'));

51 
	g$¡©us
 = (
$¬g
 =ğ'­´ov®'è? 
COMMENT_NOT_PUBLISHED
 : 
COMMENT_PUBLISHED
;

52 
	g$fÜm
['h—d”'] = 
¬¿y
('#type' => 'value', '#value' =>‡rray(

53 
theme
('table_select_header_cell'),

54 
¬¿y
('d©a' => 
t
('Subject'), 'field' => 'subject'),

55 
¬¿y
('d©a' => 
t
('Author'), 'field' => 'name'),

56 
¬¿y
('d©a' => 
t
('Posted in'), 'field' => 'node_title'),

57 
¬¿y
('d©a' => 
t
('Time'), 'field' => 'timestamp', 'sort' => 'desc'),

58 
¬¿y
('d©a' => 
t
('Operations'))

60 
	g$»suÉ
 = 
·g”_qu”y
('SELECT c.subjeù, c.nid, c.cid, c.comm’t, c.time¡amp, c.¡©us, c.Çme, c.hom•age, u.ÇmAS„egi¡”ed_Çme, u.uid,‚.t™Ë‡ node_t™Ë FROM {comm’ts} c INNER JOIN {u£rs} u ON u.uid = c.uid INNER JOIN {node}‚ ON‚.nid = c.nid WHERE c.¡©u ğ%d'. 
bËsÜt_sql
(
$fÜm
['h—d”']['#v®ue']), 50, 0, 
NULL
, 
$¡©us
);

63 
	g$de¡š©iÚ
 = 
dru·l_g‘_de¡š©iÚ
();

64 
	g$comm’t
 = 
db_ãtch_objeù
(
$»suÉ
)) {

65 
$comm’ts
[
$comm’t
->
cid
] = '';

66 
	g$comm’t
->
	gÇme
 = 
$comm’t
->
uid
 ? $comm’t->
»gi¡”ed_Çme
 : $comm’t->
Çme
;

67 
	g$fÜm
['subjeù'][
$comm’t
->
cid
] = 
¬¿y
('#v®ue' => 
l
($comm’t->
subjeù
, 'node/'. $comm’t->
nid
,‡¼ay('©Œibu‹s' =>‡¼ay('t™Ë' => 
Œunÿ‹_utf8
($comm’t->
comm’t
, 128)), 'fragment' => 'comment-'. $comment->cid)));

68 
	g$fÜm
['u£ºame'][
$comm’t
->
cid
] = 
¬¿y
('#v®ue' => 
theme
('username', $comment));

69 
	g$fÜm
['node_t™Ë'][
$comm’t
->
cid
] = 
¬¿y
('#v®ue' => 
l
($comm’t->
node_t™Ë
, 'node/'. $comm’t->
nid
));

70 
	g$fÜm
['time¡amp'][
$comm’t
->
cid
] = 
¬¿y
('#v®ue' => 
fÜm©_d©e
($comm’t->
time¡amp
, 'small'));

71 
	g$fÜm
['İ”©iÚs'][
$comm’t
->
cid
] = 
¬¿y
('#v®ue' => 
l
(
t
('ed™'), 'comm’t/ed™/'. $comm’t->cid,‡¼ay('qu”y' => 
$de¡š©iÚ
)));

73 
	g$fÜm
['comm’ts'] = 
¬¿y
('#ty³' => 'checkboxes', '#İtiÚs' => 
is£t
(
$comm’ts
) ? $comments:‡rray());

74 
	g$fÜm
['·g”'] = 
¬¿y
('#v®ue' => 
theme
('·g”', 
NULL
, 50, 0));

75  
	g$fÜm
;

83 
funùiÚ
 
	$comm’t_admš_ov”v›w_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

84 
$fÜm_¡©e
['v®ues']['comm’ts'] = 
	`¬¿y_diff
($fÜm_¡©e['v®ues']['comm’ts'], 
	`¬¿y
(0));

85 ià(
	`couÁ
(
$fÜm_¡©e
['values']['comments']) == 0) {

86 
	`fÜm_£t_”rÜ
('', 
	`t
('Please select one or more commentso…erformhe update on.'));

88 
	}
}

96 
funùiÚ
 
	$comm’t_admš_ov”v›w_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

97 
$İ”©iÚs
 = 
	`comm’t_İ”©iÚs
();

98 ià(!
	`em±y
(
$İ”©iÚs
[
$fÜm_¡©e
['values']['operation']][1])) {

100 
$qu”y
 = 
$İ”©iÚs
[
$fÜm_¡©e
['values']['operation']][1];

101 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['comm’ts'] 
as
 
$cid
 => 
$v®ue
) {

102 ià(
$v®ue
) {

104 
	`db_qu”y
(
$qu”y
, 
$cid
);

105 
$comm’t
 = 
	`_comm’t_lßd
(
$cid
);

106 
	`_comm’t_upd©e_node_¡©i¡ics
(
$comm’t
->
nid
);

108 
	`comm’t_švoke_comm’t
(
$comm’t
, 
$fÜm_¡©e
['values']['operation']);

110 
	`w©chdog
('cÚ‹Á', 'Comm’t: upd©ed %subjeù.', 
	`¬¿y
('%subjeù' => 
$comm’t
->
subjeù
), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('v›w'), 'node/'. $comm’t->
nid
,‡¼ay('äagm’t' => 'comm’t-'. $comm’t->
cid
)));

113 
	`ÿche_ş—r_®l
();

114 
	`dru·l_£t_mes§ge
(
	`t
('The update has been…erformed.'));

115 
$fÜm_¡©e
['redirect'] = 'admin/content/comment';

117 
	}
}

126 
funùiÚ
 
	$theme_comm’t_admš_ov”v›w
(
$fÜm
) {

127 
$ouut
 = 
	`dru·l_»nd”
(
$fÜm
['options']);

128 ià(
	`is£t
(
$fÜm
['subjeù']è&& 
	`is_¬¿y
($form['subject'])) {

129 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['subjeù']è
as
 
$key
) {

130 
$row
 = 
	`¬¿y
();

131 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['comm’ts'][
$key
]);

132 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['subjeù'][
$key
]);

133 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['u£ºame'][
$key
]);

134 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['node_t™Ë'][
$key
]);

135 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['time¡amp'][
$key
]);

136 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['İ”©iÚs'][
$key
]);

137 
$rows
[] = 
$row
;

141 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No comments‡vailable.'), 'colspan' => '6'));

144 
$ouut
 .ğ
	`theme
('bË', 
$fÜm
['h—d”']['#v®ue'], 
$rows
);

145 ià(
$fÜm
['pager']['#value']) {

146 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['pager']);

149 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

151  
$ouut
;

152 
	}
}

165 
funùiÚ
 
	$comm’t_muÉË_d–‘e_cÚfœm
(&
$fÜm_¡©e
) {

166 
$ed™
 = 
$fÜm_¡©e
['post'];

168 
$fÜm
['comm’ts'] = 
	`¬¿y
('#´efix' => '<ul>', '#suffix' => '</ul>', '#Œ“' => 
TRUE
);

170 
$comm’t_couÁ”
 = 0;

171 
	`fÜ—ch
 (
	`¬¿y_f‹r
(
$ed™
['comm’ts']è
as
 
$cid
 => 
$v®ue
) {

172 
$comm’t
 = 
	`_comm’t_lßd
(
$cid
);

173 ià(
	`is_objeù
(
$comm’t
è&& 
	`is_num”ic
($comm’t->
cid
)) {

174 
$subjeù
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT subjeù FROM {comm’ts} WHERE cid = %d', 
$cid
));

175 
$fÜm
['comm’ts'][
$cid
] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => $cid, '#´efix' => '<li>', '#suffix' => 
	`check_¶aš
(
$subjeù
) .'</li>');

176 
$comm’t_couÁ”
++;

179 
$fÜm
['İ”©iÚ'] = 
	`¬¿y
('#type' => 'hidden', '#value' => 'delete');

181 ià(!
$comm’t_couÁ”
) {

182 
	`dru·l_£t_mes§ge
(
	`t
('There do‚ot‡ppearo be‡ny commentso delete or your selected comment was deleted by‡nother‡dministrator.'));

183 
	`dru·l_gÙo
('admin/content/comment');

186  
	`cÚfœm_fÜm
(
$fÜm
,

187 
	`t
('Are you sure you wanto deletehese comments‡nd‡llheir children?'),

188 'admš/cÚ‹Á/comm’t', 
	`t
('This‡ction cannot be undone.'),

189 
	`t
('Delete comments'),('Cancel'));

191 
	}
}

198 
funùiÚ
 
	$comm’t_muÉË_d–‘e_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

199 ià(
$fÜm_¡©e
['values']['confirm']) {

200 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['comm’ts'] 
as
 
$cid
 => 
$v®ue
) {

201 
$comm’t
 = 
	`_comm’t_lßd
(
$cid
);

202 
	`_comm’t_d–‘e_th»ad
(
$comm’t
);

203 
	`_comm’t_upd©e_node_¡©i¡ics
(
$comm’t
->
nid
);

205 
	`ÿche_ş—r_®l
();

206 
	`dru·l_£t_mes§ge
(
	`t
('The comments have been deleted.'));

208 
$fÜm_¡©e
['redirect'] = 'admin/content/comment';

209 
	}
}

217 
funùiÚ
 
	$comm’t_d–‘e
(
$cid
 = 
NULL
) {

218 
$comm’t
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT c.*, u.ÇmAS„egi¡”ed_Çme, u.uid FROM {comm’ts} c INNER JOIN {u£rs} u ON u.uid = c.uid WHERE c.cid = %d', 
$cid
));

219 
$comm’t
->
Çme
 = $comm’t->
uid
 ? $comm’t->
»gi¡”ed_Çme
 : $comment->name;

221 
$ouut
 = '';

223 ià(
	`is_objeù
(
$comm’t
è&& 
	`is_num”ic
($comm’t->
cid
)) {

224 
$ouut
 = 
	`dru·l_g‘_fÜm
('comm’t_cÚfœm_d–‘e', 
$comm’t
);

227 
	`dru·l_£t_mes§ge
(
	`t
('The comment‚o†ongerƒxists.'));

230  
$ouut
;

231 
	}
}

239 
funùiÚ
 
	$comm’t_cÚfœm_d–‘e
(&
$fÜm_¡©e
, 
$comm’t
) {

240 
$fÜm
 = 
	`¬¿y
();

241 
$fÜm
['#comm’t'] = 
$comm’t
;

242  
	`cÚfœm_fÜm
(

243 
$fÜm
,

244 
	`t
('A» you su» you wªˆtØd–‘thcomm’ˆ%t™Ë?', 
	`¬¿y
('%t™Ë' => 
$comm’t
->
subjeù
)),

245 'node/'. 
$comm’t
->
nid
,

246 
	`t
('Any„epliesohis comment will be†ost. This‡ction cannot be undone.'),

247 
	`t
('Delete'),

248 
	`t
('Cancel'),

250 
	}
}

255 
funùiÚ
 
	$comm’t_cÚfœm_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

256 
	`dru·l_£t_mes§ge
(
	`t
('The comment‡nd‡ll its„eplies have been deleted.'));

258 
$comm’t
 = 
$fÜm
['#comment'];

261 
	`_comm’t_d–‘e_th»ad
(
$comm’t
);

263 
	`_comm’t_upd©e_node_¡©i¡ics
(
$comm’t
->
nid
);

266 
	`ÿche_ş—r_®l
();

268 
$fÜm_¡©e
['redirect'] = "node/$comment->nid";

269 
	}
}

277 
funùiÚ
 
	$_comm’t_d–‘e_th»ad
(
$comm’t
) {

278 ià(!
	`is_objeù
(
$comm’t
è|| !
	`is_num”ic
($comm’t->
cid
)) {

279 
	`w©chdog
('cÚ‹Á', 'CªnÙ d–‘nÚ-exi¡’ˆcomm’t.', 
	`¬¿y
(), 
WATCHDOG_WARNING
);

284 
	`db_qu”y
('DELETE FROM {comm’ts} WHERE cid = %d', 
$comm’t
->
cid
);

285 
	`w©chdog
('cÚ‹Á', 'Comm’t: d–‘ed %subjeù.', 
	`¬¿y
('%subjeù' => 
$comm’t
->
subjeù
));

287 
	`comm’t_švoke_comm’t
(
$comm’t
, 'delete');

290 
$»suÉ
 = 
	`db_qu”y
('SELECT c.*, u.ÇmAS„egi¡”ed_Çme, u.uid FROM {comm’ts} c INNER JOIN {u£rs} u ON u.uid = c.uid WHERE…id = %d', 
$comm’t
->
cid
);

291 
$comm’t
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

292 
$comm’t
->
Çme
 = $comm’t->
uid
 ? $comm’t->
»gi¡”ed_Çme
 : $comment->name;

293 
	`_comm’t_d–‘e_th»ad
(
$comm’t
);

295 
	}
}

	@/srv/http/subs/notes/www/modules/comment/comment.module

1 <?
php


16 
defše
('COMMENT_PUBLISHED', 0);

21 
defše
('COMMENT_NOT_PUBLISHED', 1);

26 
defše
('COMMENT_MODE_FLAT_COLLAPSED', 1);

31 
defše
('COMMENT_MODE_FLAT_EXPANDED', 2);

36 
defše
('COMMENT_MODE_THREADED_COLLAPSED', 3);

41 
defše
('COMMENT_MODE_THREADED_EXPANDED', 4);

46 
defše
('COMMENT_ORDER_NEWEST_FIRST', 1);

51 
defše
('COMMENT_ORDER_OLDEST_FIRST', 2);

56 
defše
('COMMENT_CONTROLS_ABOVE', 0);

61 
defše
('COMMENT_CONTROLS_BELOW', 1);

66 
defše
('COMMENT_CONTROLS_ABOVE_BELOW', 2);

71 
defše
('COMMENT_CONTROLS_HIDDEN', 3);

76 
defše
('COMMENT_ANONYMOUS_MAYNOT_CONTACT', 0);

81 
defše
('COMMENT_ANONYMOUS_MAY_CONTACT', 1);

86 
defše
('COMMENT_ANONYMOUS_MUST_CONTACT', 2);

91 
defše
('COMMENT_FORM_SEPARATE_PAGE', 0);

96 
defše
('COMMENT_FORM_BELOW', 1);

101 
defše
('COMMENT_NODE_DISABLED', 0);

106 
defše
('COMMENT_NODE_READ_ONLY', 1);

111 
defše
('COMMENT_NODE_READ_WRITE', 2);

116 
defše
('COMMENT_PREVIEW_OPTIONAL', 0);

121 
defše
('COMMENT_PREVIEW_REQUIRED', 1);

126 
funùiÚ
 
	$comm’t_h–p
(
$·th
, 
$¬g
) {

127 
$·th
) {

129 
$ouut
 = '<p>'. 
	`t
('Thcomm’ˆmoduË‡Îow vis™Ü tØcomm’ˆÚ you¸po¡s, c»©šg‡d hoødiscussiÚ bßrds. Any <¨h»f="@cÚ‹Á-ty³">cÚ‹Áy³</a> may hav™ <em>DeçuÉ comm’ˆ£‰šg</em> s‘Ø<em>R—d/Wr™e</em>Ø®low comm’ts, o¸<em>Di§bËd</em>,Ø´ev’ˆcomm’ts. Comm’ˆdi¥Ïy s‘tšg ªd oth” cÚŒŞ may‡lsØbcu¡omized fÜƒach cÚ‹Áy³ (somdi¥Ïy s‘tšg ¬cu¡omizabË by individu® u£rs).', 
	`¬¿y
('@cÚ‹Á-ty³' => 
	`u¾
('admin/content/types'))) .'</p>';

130 
$ouut
 .ğ'<p>'. 
	`t
('Comment…ermissions‡re‡ssignedo user„oles,‡nd‡re usedo determine whether‡nonymous users (or other„oles)‡re‡llowedo comment on…osts. If‡nonymous users‡re‡llowedo comment,heir individual contact information may be„etained in cookies stored onheir†ocal computer for use in†ater comment submissions. When‡ comment has‚o„eplies, it may be (optionally)ƒdited by its‡uthor. The comment module useshe same input formats‡nd HTMLags‡vailable when creating other forms of content.') .'</p>';

131 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@comm’t">Comm’ˆmoduË</a>.', 
	`¬¿y
('@comment' => 'http://drupal.org/handbook/modules/comment/')) .'</p>';

132  
$ouut
;

134  '<p>'. 
	`t
("Below is‡†ist ofhe†atest comments…ostedo your site. Click on‡ subjecto seehe comment,he‡uthor's‚ameoƒdithe‡uthor's user information, 'edit'o modifyheext,‡nd 'delete'o„emoveheir submission.") .'</p>';

136  '<p>'. 
	`t
("Below is‡†ist ofhe comments…ostedo your sitehat‚eed‡pproval. To‡pprove‡ comment, click on 'edit'‡ndhen change its 'moderation status'o Approved. Click on‡ subjecto seehe comment,he‡uthor's‚ameoƒdithe‡uthor's user information, 'edit'o modifyheext,‡nd 'delete'o„emoveheir submission.") .'</p>';

138 
	}
}

143 
funùiÚ
 
	$comm’t_theme
() {

144  
	`¬¿y
(

145 'comm’t_block' => 
	`¬¿y
(

146 '¬gum’ts' => 
	`¬¿y
(),

148 'comm’t_admš_ov”v›w' => 
	`¬¿y
(

149 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

151 'comm’t_´ev›w' => 
	`¬¿y
(

152 '¬gum’ts' => 
	`¬¿y
('comm’t' => 
NULL
, 'node' => NULL, 'links' =>‡rray(), 'visible' => 1),

154 'comm’t_v›w' => 
	`¬¿y
(

155 '¬gum’ts' => 
	`¬¿y
('comm’t' => 
NULL
, 'node' => NULL, 'links' =>‡rray(), 'visible' => 1),

157 'comm’t_cÚŒŞs' => 
	`¬¿y
(

158 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

160 'comm’t' => 
	`¬¿y
(

162 '¬gum’ts' => 
	`¬¿y
('comm’t' => 
NULL
, 'node' => NULL, 'links' =>‡rray()),

164 'comm’t_fŞded' => 
	`¬¿y
(

166 '¬gum’ts' => 
	`¬¿y
('comm’t' => 
NULL
),

168 'comm’t_æ©_cŞÏp£d' => 
	`¬¿y
(

169 '¬gum’ts' => 
	`¬¿y
('comm’t' => 
NULL
, 'node' => NULL),

171 'comm’t_æ©_ex·nded' => 
	`¬¿y
(

172 '¬gum’ts' => 
	`¬¿y
('comm’t' => 
NULL
, 'node' => NULL),

174 'comm’t_th»ad_cŞÏp£d' => 
	`¬¿y
(

175 '¬gum’ts' => 
	`¬¿y
('comm’t' => 
NULL
, 'node' => NULL),

177 'comm’t_th»ad_ex·nded' => 
	`¬¿y
(

178 '¬gum’ts' => 
	`¬¿y
('comm’t' => 
NULL
, 'node' => NULL),

180 'comm’t_po¡_fÜbidd’' => 
	`¬¿y
(

181 '¬gum’ts' => 
	`¬¿y
('nid' => 
NULL
),

183 'comm’t_w¿µ”' => 
	`¬¿y
(

185 '¬gum’ts' => 
	`¬¿y
('cÚ‹Á' => 
NULL
, 'node' => NULL),

187 'comm’t_subm™‹d' => 
	`¬¿y
(

188 '¬gum’ts' => 
	`¬¿y
('comm’t' => 
NULL
),

191 
	}
}

196 
funùiÚ
 
	$comm’t_m’u
() {

197 
$™ems
['admš/cÚ‹Á/comm’t'] = 
	`¬¿y
(

201 'acûs ¬gum’ts' => 
	`¬¿y
('administer comments'),

206 
$™ems
['admš/cÚ‹Á/comm’t/Ãw'] = 
	`¬¿y
(

208 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

211 
$™ems
['admš/cÚ‹Á/comm’t/­´ov®'] = 
	`¬¿y
(

213 '·g¬gum’ts' => 
	`¬¿y
('approval'),

214 'acûs ¬gum’ts' => 
	`¬¿y
('administer comments'),

215 'ty³' => 
MENU_LOCAL_TASK
,

219 
$™ems
['comm’t/d–‘e'] = 
	`¬¿y
(

222 'acûs ¬gum’ts' => 
	`¬¿y
('administer comments'),

223 'ty³' => 
MENU_CALLBACK
,

227 
$™ems
['comm’t/ed™'] = 
	`¬¿y
(

230 'acûs ¬gum’ts' => 
	`¬¿y
('post comments'),

231 'ty³' => 
MENU_CALLBACK
,

234 
$™ems
['comm’t/»¶y/%node'] = 
	`¬¿y
(

237 '·g¬gum’ts' => 
	`¬¿y
(2),

239 'acûs ¬gum’ts' => 
	`¬¿y
('view', 2),

240 'ty³' => 
MENU_CALLBACK
,

244  
$™ems
;

245 
	}
}

250 
funùiÚ
 
	$comm’t_node_ty³
(
$İ
, 
$šfo
) {

251 
$£‰šgs
 = 
	`¬¿y
(

262 
$İ
) {

264 
	`fÜ—ch
 (
$£‰šgs
 
as
 
$£‰šg
) {

265 
	`v¬ŸbË_d–
(
$£‰šg
 .'_'. 
$šfo
->
ty³
);

269 
	}
}

274 
funùiÚ
 
	$comm’t_³rm
() {

275  
	`¬¿y
('access comments', 'post comments', 'administer comments', 'post comments without‡pproval');

276 
	}
}

283 
funùiÚ
 
comm’t_block
(
$İ
 = 'li¡', 
$d–
 = 0) {

284 ià(
$İ
 == 'list') {

285 
$blocks
[0]['šfo'] = 
t
('Recent comments');

286  
	g$blocks
;

288 ià(
	g$İ
 =ğ'v›w' && 
u£r_acûss
('access comments')) {

289 
$block
['subjeù'] = 
t
('Recent comments');

290 
	g$block
['cÚ‹Á'] = 
theme
('comment_block');

291  
	g$block
;

310 
funùiÚ
 
	$comm’t_g‘_»ûÁ
(
$numb”
 = 10) {

314 
$»suÉ
 = 
	`db_qu”y_¿nge
(
	`db_»wr™e_sql
("SELECT‚c.nid FROM {node_comm’t_¡©i¡ics}‚øWHERE‚c.comm’t_couÁ > 0 ORDER BY‚c.Ï¡_comm’t_time¡am°DESC", 'nc'), 0, 
$numb”
);

316 
$nids
 = 
	`¬¿y
();

317 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

318 
$nids
[] = 
$row
->
nid
;

321 
$comm’ts
 = 
	`¬¿y
();

322 ià(!
	`em±y
(
$nids
)) {

325 
$»suÉ
 = 
	`db_qu”y_¿nge
('SELECT c.nid, c.subjeù, c.cid, c.time¡am°FROM {comm’ts} c INNER JOIN {node}‚ ON‚.nid = c.nid WHERE c.nid IN ('. 
	`im¶ode
(',', 
$nids
è.'èAND‚.¡©u ğ1 AND c.¡©u ğ%d ORDER BY c.cid DESC', 
COMMENT_PUBLISHED
, 0, 
$numb”
);

326 
$comm’t
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

327 
$comm’ts
[] = 
$comm’t
;

331  
$comm’ts
;

332 
	}
}

346 
funùiÚ
 
	$comm’t_Ãw_·ge_couÁ
(
$num_comm’ts
, 
$Ãw_»¶›s
, 
$node
) {

347 
$comm’ts_³r_·ge
 = 
	`_comm’t_g‘_di¥Ïy_£‰šg
('comm’ts_³r_·ge', 
$node
);

348 
$mode
 = 
	`_comm’t_g‘_di¥Ïy_£‰šg
('mode', 
$node
);

349 
$Üd”
 = 
	`_comm’t_g‘_di¥Ïy_£‰šg
('sÜt', 
$node
);

350 
$·g’um
 = 
NULL
;

351 
$æ©
 = 
	`š_¬¿y
(
$mode
, 
	`¬¿y
(
COMMENT_MODE_FLAT_COLLAPSED
, 
COMMENT_MODE_FLAT_EXPANDED
));

352 ià(
$num_comm’ts
 <ğ
$comm’ts_³r_·ge
 || (
$æ©
 && 
$Üd”
 =ğ
COMMENT_ORDER_NEWEST_FIRST
)) {

355 
$·g’o
 = 0;

358 ià(
$æ©
) {

360 
$couÁ
 = 
$num_comm’ts
 - 
$Ãw_»¶›s
;

364 ià(
$Üd”
 =ğ
COMMENT_ORDER_NEWEST_FIRST
) {

366 
$»suÉ
 = 
	`db_qu”y
('SELECTh»ad FROM (SELECTh»ad FROM {comm’ts} WHERE‚id = %d AND stu ğ0 ORDER BYime¡am°DESC LIMIT %dèASh»ad ORDER BYh»ad DESC LIMIT 1', 
$node
->
nid
, 
$Ãw_»¶›s
);

367 
$th»ad
 = 
	`db_»suÉ
(
$»suÉ
);

368 
$»suÉ_couÁ
 = 
	`db_qu”y
("SELECT COUNT(*èFROM {comm’ts} WHERE‚id = %d AND stu ğ0 ANDh»ad > '". 
$th»ad
 ."'", 
$node
->
nid
);

372 
$»suÉ
 = 
	`db_qu”y
('SELECTh»ad FROM (SELECTh»ad FROM {comm’ts} WHERE‚id = %d AND stu ğ0 ORDER BYime¡am°DESC LIMIT %dèASh»ad ORDER BY SUBSTRINGÑh»ad, 1, (LENGTHÑh»adè- 1)èLIMIT 1', 
$node
->
nid
, 
$Ãw_»¶›s
);

373 
$th»ad
 = 
	`sub¡r
(
	`db_»suÉ
(
$»suÉ
), 0, -1);

374 
$»suÉ_couÁ
 = 
	`db_qu”y
("SELECT COUNT(*èFROM {comm’ts} WHERE‚id = %d AND stu ğ0 AND SUBSTRINGÑh»ad, 1, (LENGTHÑh»adè- 1)è< '". 
$th»ad
 ."'", 
$node
->
nid
);

376 
$couÁ
 = 
	`db_»suÉ
(
$»suÉ_couÁ
);

378 
$·g’o
 = 
$couÁ
 / 
$comm’ts_³r_·ge
;

380 ià(
$·g’o
 >= 1) {

381 
$·g’um
 = "·ge=". 
	`štv®
(
$·g’o
);

383  
$·g’um
;

384 
	}
}

393 
funùiÚ
 
	$theme_comm’t_block
() {

394 
$™ems
 = 
	`¬¿y
();

395 
	`fÜ—ch
 (
	`comm’t_g‘_»ûÁ
(è
as
 
$comm’t
) {

396 
$™ems
[] = 
	`l
(
$comm’t
->
subjeù
, 'node/'. $comm’t->
nid
, 
	`¬¿y
('äagm’t' => 'comm’t-'. $comm’t->
cid
)è.'<b¸/>'. 
	`t
('@timago',‡¼ay('@time' => 
	`fÜm©_š‹rv®
(
	`time
(è- $comm’t->
time¡amp
)));

398 ià(
$™ems
) {

399  
	`theme
('™em_li¡', 
$™ems
);

401 
	}
}

406 
funùiÚ
 
	$comm’t_lšk
(
$ty³
, 
$node
 = 
NULL
, 
$‹a£r
 = 
FALSE
) {

407 
$lšks
 = 
	`¬¿y
();

409 ià(
$ty³
 =ğ'node' && 
$node
->
comm’t
) {

411 ià(
$‹a£r
) {

414 ià(
	`u£r_acûss
('access comments')) {

415 
$®l
 = 
	`comm’t_num_®l
(
$node
->
nid
);

417 ià(
$®l
) {

418 
$lšks
['comm’t_comm’ts'] = 
	`¬¿y
(

419 't™Ë' => 
	`fÜm©_¶u¿l
(
$®l
, '1 comment', '@count comments'),

421 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
	`t
('Jumpohe first comment ofhis…osting.')),

425 
$Ãw
 = 
	`comm’t_num_Ãw
(
$node
->
nid
);

427 ià(
$Ãw
) {

428 
$lšks
['comm’t_Ãw_comm’ts'] = 
	`¬¿y
(

429 't™Ë' => 
	`fÜm©_¶u¿l
(
$Ãw
, '1‚ew comment', '@count‚ew comments'),

431 'qu”y' => 
	`comm’t_Ãw_·ge_couÁ
(
$®l
, 
$Ãw
, 
$node
),

432 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
	`t
('Jumpohe first‚ew comment ofhis…osting.')),

438 ià(
$node
->
comm’t
 =ğ
COMMENT_NODE_READ_WRITE
) {

439 ià(
	`u£r_acûss
('post comments')) {

440 
$lšks
['comm’t_add'] = 
	`¬¿y
(

441 't™Ë' => 
	`t
('Add‚ew comment'),

443 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
	`t
('Add‡‚ew commentohis…age.')),

448 
$lšks
['comm’t_fÜbidd’']['t™Ë'] = 
	`theme
('comm’t_po¡_fÜbidd’', 
$node
);

458 ià(
$node
->
comm’t
 =ğ
COMMENT_NODE_READ_WRITE
) {

459 ià(
	`u£r_acûss
('post comments')) {

460 ià(
	`v¬ŸbË_g‘
('comm’t_fÜm_loÿtiÚ_'. 
$node
->
ty³
, 
COMMENT_FORM_SEPARATE_PAGE
) == COMMENT_FORM_SEPARATE_PAGE) {

461 
$lšks
['comm’t_add'] = 
	`¬¿y
(

462 't™Ë' => 
	`t
('Add‚ew comment'),

464 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
	`t
('Share yourhoughts‡nd opinions„elatedohis…osting.')),

470 
$lšks
['comm’t_fÜbidd’']['t™Ë'] = 
	`theme
('comm’t_po¡_fÜbidd’', 
$node
);

476 ià(
$ty³
 == 'comment') {

477 
$lšks
 = 
	`comm’t_lšks
(
$node
, 
$‹a£r
);

479 ià(
	`is£t
(
$lšks
['comment_forbidden'])) {

480 
$lšks
['comm’t_fÜbidd’']['html'] = 
TRUE
;

483  
$lšks
;

484 
	}
}

489 
funùiÚ
 
	$comm’t_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

490 ià(
$fÜm_id
 =ğ'node_ty³_fÜm' && 
	`is£t
(
$fÜm
['identity']['type'])) {

491 
$fÜm
['comm’t'] = 
	`¬¿y
(

493 '#t™Ë' => 
	`t
('Comment settings'),

494 '#cŞÏpsibË' => 
TRUE
,

495 '#cŞÏp£d' => 
TRUE
,

497 
$fÜm
['comm’t']['comm’t'] = 
	`¬¿y
(

499 '#t™Ë' => 
	`t
('Default comment setting'),

500 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('comm’t_'. 
$fÜm
['#node_ty³']->
ty³
, 
COMMENT_NODE_READ_WRITE
),

501 '#İtiÚs' => 
	`¬¿y
(
	`t
('Disabled'),('Read only'),('Read/Write')),

502 '#desütiÚ' => 
	`t
('Users withhe <em>administer comments</em>…ermission will be‡bleo overridehis setting.'),

504 
$fÜm
['comm’t']['comm’t_deçuÉ_mode'] = 
	`¬¿y
(

506 '#t™Ë' => 
	`t
('Default display mode'),

507 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('comm’t_deçuÉ_mode_'. 
$fÜm
['#node_ty³']->
ty³
, 
COMMENT_MODE_THREADED_EXPANDED
),

508 '#İtiÚs' => 
	`_comm’t_g‘_modes
(),

509 '#desütiÚ' => 
	`t
('The default view for comments. Expanded views displayhe body ofhe comment. Threaded views keep„epliesogether.'),

511 
$fÜm
['comm’t']['comm’t_deçuÉ_Üd”'] = 
	`¬¿y
(

513 '#t™Ë' => 
	`t
('Default display order'),

514 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('comm’t_deçuÉ_Üd”_'. 
$fÜm
['#node_ty³']->
ty³
, 
COMMENT_ORDER_NEWEST_FIRST
),

515 '#İtiÚs' => 
	`_comm’t_g‘_Üd”s
(),

516 '#desütiÚ' => 
	`t
('The default sorting for‚ew users‡nd‡nonymous users while viewing comments. These users may changeheir view usinghe comment control…anel. For„egistered users,his change is„emembered‡s‡…ersistent user…reference.'),

518 
$fÜm
['comm’t']['comm’t_deçuÉ_³r_·ge'] = 
	`¬¿y
(

520 '#t™Ë' => 
	`t
('Default comments…er…age'),

521 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('comm’t_deçuÉ_³r_·ge_'. 
$fÜm
['#node_ty³']->
ty³
, 50),

522 '#İtiÚs' => 
	`_comm’t_³r_·ge
(),

523 '#desütiÚ' => 
	`t
('Default‚umber of comments forƒach…age: more comments‡re distributed in several…ages.'),

525 
$fÜm
['comm’t']['comm’t_cÚŒŞs'] = 
	`¬¿y
(

527 '#t™Ë' => 
	`t
('Comment controls'),

528 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('comm’t_cÚŒŞs_'. 
$fÜm
['#node_ty³']->
ty³
, 
COMMENT_CONTROLS_HIDDEN
),

529 '#İtiÚs' => 
	`¬¿y
(

530 
	`t
('Display‡bovehe comments'),

531 
	`t
('Display belowhe comments'),

532 
	`t
('Display‡bove‡nd belowhe comments'),

533 
	`t
('Do‚ot display')),

534 '#desütiÚ' => 
	`t
('Position ofhe comment controls box. The comment controls†ethe user changehe default display mode‡nd display order of comments.'),

536 
$fÜm
['comm’t']['comm’t_ªÚymous'] = 
	`¬¿y
(

538 '#t™Ë' => 
	`t
('Anonymous commenting'),

539 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('comm’t_ªÚymous_'. 
$fÜm
['#node_ty³']->
ty³
, 
COMMENT_ANONYMOUS_MAYNOT_CONTACT
),

540 '#İtiÚs' => 
	`¬¿y
(

541 
COMMENT_ANONYMOUS_MAYNOT_CONTACT
 => 
	`t
('Anonymous…osters may‚otƒnterheir contact information'),

542 
COMMENT_ANONYMOUS_MAY_CONTACT
 => 
	`t
('Anonymous…osters may†eaveheir contact information'),

543 
COMMENT_ANONYMOUS_MUST_CONTACT
 => 
	`t
('Anonymous…osters must†eaveheir contact information')),

544 '#desütiÚ' => 
	`t
('Thi İtiÚ i ’abËd wh’‡nÚymou u£r hav³rmissiÚØpo¡ comm’t Úh<¨h»f="@u¾">³rmissiÚ ·ge</a>.', 
	`¬¿y
('@u¾' => 
	`u¾
('admin/user/permissions',‡rray('fragment' => 'module-comment')))),

546 ià(!
	`u£r_acûss
('po¡ comm’ts', 
	`dru·l_ªÚymous_u£r
())) {

547 
$fÜm
['comm’t']['comm’t_ªÚymous']['#di§bËd'] = 
TRUE
;

549 
$fÜm
['comm’t']['comm’t_subjeù_f›ld'] = 
	`¬¿y
(

551 '#t™Ë' => 
	`t
('Comment subject field'),

552 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('comm’t_subjeù_f›ld_'. 
$fÜm
['#node_ty³']->
ty³
, 1),

553 '#İtiÚs' => 
	`¬¿y
(
	`t
('Disabled'),('Enabled')),

554 '#desütiÚ' => 
	`t
('Can users…rovide‡ unique subject forheir comments?'),

556 
$fÜm
['comm’t']['comm’t_´ev›w'] = 
	`¬¿y
(

558 '#t™Ë' => 
	`t
('Preview comment'),

559 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('comm’t_´ev›w_'. 
$fÜm
['#node_ty³']->
ty³
, 
COMMENT_PREVIEW_REQUIRED
),

560 '#İtiÚs' => 
	`¬¿y
(
	`t
('Optional'),('Required')),

561 '#desütiÚ' => 
	`t
("Forces‡ usero†ook‡their comment by clicking on‡ 'Preview' button beforehey can‡ctually‡ddhe comment"),

563 
$fÜm
['comm’t']['comm’t_fÜm_loÿtiÚ'] = 
	`¬¿y
(

565 '#t™Ë' => 
	`t
('Location of comment submission form'),

566 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('comm’t_fÜm_loÿtiÚ_'. 
$fÜm
['#node_ty³']->
ty³
, 
COMMENT_FORM_SEPARATE_PAGE
),

567 '#İtiÚs' => 
	`¬¿y
(
	`t
('Display on separate…age'),('Display below…ost or comments')),

570 
	`–£if
 (
	`is£t
(
$fÜm
['type']) && isset($form['#node'])) {

571 ià(
$fÜm
['ty³']['#v®ue'] .'_node_fÜm' =ğ
$fÜm_id
) {

572 
$node
 = 
$fÜm
['#node'];

573 
$fÜm
['comm’t_£‰šgs'] = 
	`¬¿y
(

575 '#acûss' => 
	`u£r_acûss
('administer comments'),

576 '#t™Ë' => 
	`t
('Comment settings'),

577 '#cŞÏpsibË' => 
TRUE
,

578 '#cŞÏp£d' => 
TRUE
,

581 
$fÜm
['comm’t_£‰šgs']['comm’t'] = 
	`¬¿y
(

583 '#·»Ás' => 
	`¬¿y
('comment'),

584 '#deçuÉ_v®ue' => 
$node
->
comm’t
,

585 '#İtiÚs' => 
	`¬¿y
(
	`t
('Disabled'),('Read only'),('Read/Write')),

589 
	}
}

594 
funùiÚ
 
	$comm’t_nod—pi
(&
$node
, 
$İ
, 
$¬g
 = 0) {

595 
$İ
) {

597  
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT†a¡_comm’t_time¡amp,†a¡_comm’t_Çme, comm’t_couÁ FROM {node_comm’t_¡©i¡ics} WHERE‚id = %d", 
$node
->
nid
));

601 ià(!
	`is£t
(
$node
->
comm’t
)) {

602 
$node
->
comm’t
 = 
	`v¬ŸbË_g‘
("comm’t_$node->ty³", 
COMMENT_NODE_READ_WRITE
);

607 
	`db_qu”y
('INSERT INTO {node_comm’t_¡©i¡ics} (nid,†a¡_comm’t_time¡amp,†a¡_comm’t_Çme,†a¡_comm’t_uid, comm’t_couÁèVALUES (%d, %d, NULL, %d, 0)', 
$node
->
nid
, $node->
chªged
, $node->
uid
);

611 
	`db_qu”y
('DELETE FROM {comm’ts} WHERE‚id = %d', 
$node
->
nid
);

612 
	`db_qu”y
('DELETE FROM {node_comm’t_¡©i¡ics} WHERE‚id = %d', 
$node
->
nid
);

616 
$‹xt
 = '';

617 
$comm’ts
 = 
	`db_qu”y
('SELECT subjeù, comm’t, fÜm© FROM {comm’ts} WHERE‚id = %d AND stu ğ%d', 
$node
->
nid
, 
COMMENT_PUBLISHED
);

618 
$comm’t
 = 
	`db_ãtch_objeù
(
$comm’ts
)) {

619 
$‹xt
 .ğ'<h2>'. 
	`check_¶aš
(
$comm’t
->
subjeù
è.'</h2>'. 
	`check_m¬kup
($comm’t->
comm’t
, $comm’t->
fÜm©
, 
FALSE
);

621  
$‹xt
;

624 
$comm’ts
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT comm’t_couÁ FROM {node_comm’t_¡©i¡ics} WHERE‚id = %d', 
$node
->
nid
));

625  
	`fÜm©_¶u¿l
(
$comm’ts
, '1 comment', '@count comments');

628 ià(
$node
->
comm’t
 !ğ
COMMENT_NODE_DISABLED
) {

629  
	`¬¿y
×¼ay('key' => 'comm’ts', 'v®ue' => 
	`u¾
('node/'. 
$node
->
nid
,‡¼ay('äagm’t' => 'comm’ts', 'absŞu‹' => 
TRUE
))));

632  
	`¬¿y
();

635 
	}
}

640 
funùiÚ
 
	$comm’t_u£r
(
$ty³
, 
$ed™
, &
$u£r
, 
$ÿ‹gÜy
 = 
NULL
) {

641 ià(
$ty³
 == 'delete') {

642 
	`db_qu”y
('UPDATE {comm’ts} SET uid = 0 WHERE uid = %d', 
$u£r
->
uid
);

643 
	`db_qu”y
('UPDATE {node_comm’t_¡©i¡ics} SET†a¡_comm’t_uid = 0 WHERE†a¡_comm’t_uid = %d', 
$u£r
->
uid
);

645 
	}
}

662 
funùiÚ
 
	$comm’t_acûss
(
$İ
, 
$comm’t
) {

663 
glob®
 
$u£r
;

665 ià(
$İ
 == 'edit') {

666  (
$u£r
->
uid
 && $u£r->uid =ğ
$comm’t
->uid && 
	`comm’t_num_»¶›s
($comm’t->
cid
è=ğ0 && $comm’t->
¡©us
 =ğ
COMMENT_PUBLISHED
è|| 
	`u£r_acûss
('administer comments');

668 
	}
}

676 
funùiÚ
 
	$comm’t_node_u¾
() {

677  
	`¬g
(0) .'/'.‡rg(1);

678 
	}
}

690 
funùiÚ
 
	$comm’t_§ve
(
$ed™
) {

691 
glob®
 
$u£r
;

692 ià(
	`u£r_acûss
('po¡ comm’ts'è&& (u£r_acûss('admši¡” comm’ts'è|| 
	`node_comm’t_mode
(
$ed™
['nid']è=ğ
COMMENT_NODE_READ_WRITE
)) {

693 ià(!
	`fÜm_g‘_”rÜs
()) {

694 
$ed™
 +ğ
	`¬¿y
(

698 '¡©us' => 
	`u£r_acûss
('po¡ comm’t w™houˆ­´ov®'è? 
COMMENT_PUBLISHED
 : 
COMMENT_NOT_PUBLISHED
,

700 ià(
$ed™
['cid']) {

702 
	`db_qu”y
("UPDATE {comm’ts} SET stu ğ%d,ime¡am°ğ%d, subjeù = '%s', comm’ˆğ'%s', fÜm© = %d, uid = %d,‚amğ'%s', ma = '%s', hom•agğ'%s' WHERE cid = %d", 
$ed™
['status'], $edit['timestamp'], $edit['subject'], $edit['comment'], $edit['format'], $edit['uid'], $edit['name'], $edit['mail'], $edit['homepage'], $edit['cid']);

705 
	`comm’t_švoke_comm’t
(
$ed™
, 'update');

708 
	`w©chdog
('cÚ‹Á', 'Comm’t: upd©ed %subjeù.', 
	`¬¿y
('%subjeù' => 
$ed™
['subjeù']), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('view'), 'node/'. $edit['nid'],‡rray('fragment' => 'comment-'. $edit['cid'])));

714 ià(
$ed™
['pid'] == 0) {

717 
$max
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT MAXÑh»adèFROM {comm’ts} WHERE‚id = %d', 
$ed™
['nid']));

720 
$max
 = 
	`¹rim
($max, '/');

723 
$th»ad
 = 
	`št2vªcode
(
	`vªcode2št
(
$max
) + 1) .'/';

730 
$·»Á
 = 
	`_comm’t_lßd
(
$ed™
['pid']);

733 
$·»Á
->
th»ad
 = (
¡ršg
è
	`¹rim
((string) $parent->thread, '/');

736 
$max
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT MAXÑh»adèFROM {comm’ts} WHEREh»ad LIKE '%s.%%' AND‚id = %d", 
$·»Á
->
th»ad
, 
$ed™
['nid']));

738 ià(
$max
 == '') {

740 
$th»ad
 = 
$·»Á
->
th»ad
 .'.'. 
	`št2vªcode
(0) .'/';

744 
$max
 = 
	`¹rim
($max, '/');

747 
$·¹s
 = 
	`ex¶ode
('.', 
$max
);

748 
$·»Á_d•th
 = 
	`couÁ
(
	`ex¶ode
('.', 
$·»Á
->
th»ad
));

749 
$Ï¡
 = 
$·¹s
[
$·»Á_d•th
];

752 
$th»ad
 = 
$·»Á
->
th»ad
 .'.'. 
	`št2vªcode
(
	`vªcode2št
(
$Ï¡
) + 1) .'/';

756 ià(
	`em±y
(
$ed™
['timestamp'])) {

757 
$ed™
['time¡amp'] = 
	`time
();

760 ià(
$ed™
['uid'] ==ğ
$u£r
->
uid
 && 
	`is£t
($u£r->
Çme
)) {

761 
$ed™
['Çme'] = 
$u£r
->
Çme
;

764 
	`db_qu”y
("INSERT INTO {comm’ts} (nid,…id, uid, subjeù, comm’t, fÜm©, ho¡Çme,ime¡amp, stus,h»ad,‚ame, ma, hom•ageèVALUES (%d, %d, %d, '%s', '%s', %d, '%s', %d, %d, '%s', '%s', '%s', '%s')", 
$ed™
['nid'], $ed™['pid'], $ed™['uid'], $ed™['subjeù'], $ed™['comm’t'], $ed™['fÜm©'], 
	`_add»ss
(), $ed™['time¡amp'], $ed™['¡©us'], 
$th»ad
, $edit['name'], $edit['mail'], $edit['homepage']);

765 
$ed™
['cid'] = 
	`db_Ï¡_š£¹_id
('comments', 'cid');

768 
	`comm’t_švoke_comm’t
(
$ed™
, 'insert');

771 
	`w©chdog
('cÚ‹Á', 'Comm’t:‡dded %subjeù.', 
	`¬¿y
('%subjeù' => 
$ed™
['subjeù']), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('view'), 'node/'. $edit['nid'],‡rray('fragment' => 'comment-'. $edit['cid'])));

773 
	`_comm’t_upd©e_node_¡©i¡ics
(
$ed™
['nid']);

776 
	`ÿche_ş—r_®l
();

780 ià(
$ed™
['¡©us'] =ğ
COMMENT_NOT_PUBLISHED
) {

781 
	`dru·l_£t_mes§ge
(
	`t
('Your comment has been queued for moderation by site‡dministrators‡nd will be…ublished‡fter‡pproval.'));

784 
	`comm’t_švoke_comm’t
(
$ed™
, 'publish');

786  
$ed™
['cid'];

789  
FALSE
;

793 
	`w©chdog
('cÚ‹Á', 'Comm’t: uÇuthÜized comm’ˆsubm™‹d o¸comm’ˆsubm™‹dØ¨şo£d…o¡ %subjeù.', 
	`¬¿y
('%subjeù' => 
$ed™
['subjeù']), 
WATCHDOG_WARNING
);

794 
	`dru·l_£t_mes§ge
(
	`t
('Comm’t: uÇuthÜized comm’ˆsubm™‹d o¸comm’ˆsubm™‹dØ¨şo£d…o¡ %subjeù.', 
	`¬¿y
('%subjeù' => 
$ed™
['subject'])), 'error');

795  
FALSE
;

797 
	}
}

809 
funùiÚ
 
	$comm’t_lšks
(
$comm’t
, 
$»tuº
 = 1) {

810 
glob®
 
$u£r
;

812 
$lšks
 = 
	`¬¿y
();

815 ià(
$»tuº
) {

816 
$lšks
['comm’t_·»Á'] = 
	`¬¿y
(

817 't™Ë' => 
	`t
('parent'),

818 'h»f' => 
	`comm’t_node_u¾
(),

823 ià(
	`node_comm’t_mode
(
$comm’t
->
nid
è=ğ
COMMENT_NODE_READ_WRITE
) {

824 ià(
	`u£r_acûss
('administer comments') && user_access('post comments')) {

825 
$lšks
['comm’t_d–‘e'] = 
	`¬¿y
(

826 't™Ë' => 
	`t
('delete'),

829 
$lšks
['comm’t_ed™'] = 
	`¬¿y
(

830 't™Ë' => 
	`t
('edit'),

833 
$lšks
['comm’t_»¶y'] = 
	`¬¿y
(

834 't™Ë' => 
	`t
('reply'),

838 ià(
	`u£r_acûss
('post comments')) {

839 ià(
	`comm’t_acûss
('ed™', 
$comm’t
)) {

840 
$lšks
['comm’t_ed™'] = 
	`¬¿y
(

841 't™Ë' => 
	`t
('edit'),

845 
$lšks
['comm’t_»¶y'] = 
	`¬¿y
(

846 't™Ë' => 
	`t
('reply'),

851 
$node
 = 
	`node_lßd
(
$comm’t
->
nid
);

852 
$lšks
['comm’t_fÜbidd’']['t™Ë'] = 
	`theme
('comm’t_po¡_fÜbidd’', 
$node
);

856  
$lšks
;

857 
	}
}

921 
funùiÚ
 
	$comm’t_»nd”
(
$node
, 
$cid
 = 0) {

922 
glob®
 
$u£r
;

924 
$ouut
 = '';

926 ià(
	`u£r_acûss
('access comments')) {

928 
$nid
 = 
$node
->
nid
;

929 ià(
	`em±y
(
$nid
)) {

930 
$nid
 = 0;

933 
$mode
 = 
	`_comm’t_g‘_di¥Ïy_£‰šg
('mode', 
$node
);

934 
$Üd”
 = 
	`_comm’t_g‘_di¥Ïy_£‰šg
('sÜt', 
$node
);

935 
$comm’ts_³r_·ge
 = 
	`_comm’t_g‘_di¥Ïy_£‰šg
('comm’ts_³r_·ge', 
$node
);

937 ià(
$cid
 && 
	`is_num”ic
($cid)) {

939 
$qu”y
 = 'SELECT c.cid, c.pid, c.nid, c.subject, c.comment, c.format, c.timestamp, c.name, c.mail, c.homepage, u.uid, u.name AS„egistered_name, u.signature, u.signature_format, u.picture, u.data, c.status FROM {comments} c INNER JOIN {users} u ON c.uid = u.uid WHERE c.cid = %d';

940 
$qu”y_¬gs
 = 
	`¬¿y
(
$cid
);

941 ià(!
	`u£r_acûss
('administer comments')) {

942 
$qu”y
 .= ' AND c.status = %d';

943 
$qu”y_¬gs
[] = 
COMMENT_PUBLISHED
;

946 
$qu”y
 = 
	`db_»wr™e_sql
($query, 'c', 'cid');

947 
$»suÉ
 = 
	`db_qu”y
(
$qu”y
, 
$qu”y_¬gs
);

949 ià(
$comm’t
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

950 
$comm’t
->
Çme
 = $comm’t->
uid
 ? $comm’t->
»gi¡”ed_Çme
 : $comment->name;

951 
$lšks
 = 
	`moduË_švoke_®l
('lšk', 'comm’t', 
$comm’t
, 1);

952 
	`dru·l_®‹r
('lšk', 
$lšks
, 
$node
, 
$comm’t
);

954 
$ouut
 .ğ
	`theme
('comm’t_v›w', 
$comm’t
, 
$node
, 
$lšks
);

959 
$qu”y_couÁ
 = 'SELECT COUNT(*) FROM {comments} c WHERE c.nid = %d';

960 
$qu”y
 = 'SELECT c.cid‡s cid, c.pid, c.nid, c.subject, c.comment, c.format, c.timestamp, c.name, c.mail, c.homepage, u.uid, u.name AS„egistered_name, u.signature, u.signature_format, u.picture, u.data, c.thread, c.status FROM {comments} c INNER JOIN {users} u ON c.uid = u.uid WHERE c.nid = %d';

962 
$qu”y_¬gs
 = 
	`¬¿y
(
$nid
);

963 ià(!
	`u£r_acûss
('administer comments')) {

964 
$qu”y
 .= ' AND c.status = %d';

965 
$qu”y_couÁ
 .= ' AND c.status = %d';

966 
$qu”y_¬gs
[] = 
COMMENT_PUBLISHED
;

969 ià(
$Üd”
 =ğ
COMMENT_ORDER_NEWEST_FIRST
) {

970 ià(
$mode
 =ğ
COMMENT_MODE_FLAT_COLLAPSED
 || $mod=ğ
COMMENT_MODE_FLAT_EXPANDED
) {

971 
$qu”y
 .= ' ORDER BY c.cid DESC';

974 
$qu”y
 .= ' ORDER BY c.thread DESC';

977 ià(
$Üd”
 =ğ
COMMENT_ORDER_OLDEST_FIRST
) {

978 ià(
$mode
 =ğ
COMMENT_MODE_FLAT_COLLAPSED
 || $mod=ğ
COMMENT_MODE_FLAT_EXPANDED
) {

979 
$qu”y
 .= ' ORDER BY c.cid';

985 
$qu”y
 .= ' ORDER BY SUBSTRING(c.thread, 1, (LENGTH(c.thread) - 1))';

988 
$qu”y
 = 
	`db_»wr™e_sql
($query, 'c', 'cid');

989 
$qu”y_couÁ
 = 
	`db_»wr™e_sql
($query_count, 'c', 'cid');

992 
$»suÉ
 = 
	`·g”_qu”y
(
$qu”y
, 
$comm’ts_³r_·ge
, 0, 
$qu”y_couÁ
, 
$qu”y_¬gs
);

994 
$divs
 = 0;

995 
$num_rows
 = 
FALSE
;

996 
$comm’ts
 = '';

997 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'comment') .'/comment.css');

998 
$comm’t
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

999 
$comm’t
 = 
	`dru·l_uÅack
($comment);

1000 
$comm’t
->
Çme
 = $comm’t->
uid
 ? $comm’t->
»gi¡”ed_Çme
 : $comment->name;

1001 
$comm’t
->
d•th
 = 
	`couÁ
(
	`ex¶ode
('.', $comm’t->
th»ad
)) - 1;

1003 ià(
$mode
 =ğ
COMMENT_MODE_THREADED_COLLAPSED
 || $mod=ğ
COMMENT_MODE_THREADED_EXPANDED
) {

1004 ià(
$comm’t
->
d•th
 > 
$divs
) {

1005 
$divs
++;

1006 
$comm’ts
 .= '<div class="indented">';

1009 
$comm’t
->
d•th
 < 
$divs
) {

1010 
$divs
--;

1011 
$comm’ts
 .= '</div>';

1016 ià(
$mode
 =ğ
COMMENT_MODE_FLAT_COLLAPSED
) {

1017 
$comm’ts
 .ğ
	`theme
('comm’t_æ©_cŞÏp£d', 
$comm’t
, 
$node
);

1019 ià(
$mode
 =ğ
COMMENT_MODE_FLAT_EXPANDED
) {

1020 
$comm’ts
 .ğ
	`theme
('comm’t_æ©_ex·nded', 
$comm’t
, 
$node
);

1022 ià(
$mode
 =ğ
COMMENT_MODE_THREADED_COLLAPSED
) {

1023 
$comm’ts
 .ğ
	`theme
('comm’t_th»ad_cŞÏp£d', 
$comm’t
, 
$node
);

1025 ià(
$mode
 =ğ
COMMENT_MODE_THREADED_EXPANDED
) {

1026 
$comm’ts
 .ğ
	`theme
('comm’t_th»ad_ex·nded', 
$comm’t
, 
$node
);

1029 
$num_rows
 = 
TRUE
;

1031 
$divs
-- > 0) {

1032 
$comm’ts
 .= '</div>';

1035 
$comm’t_cÚŒŞs
 = 
	`v¬ŸbË_g‘
('comm’t_cÚŒŞs_'. 
$node
->
ty³
, 
COMMENT_CONTROLS_HIDDEN
);

1036 ià(
$num_rows
 && (
$comm’t_cÚŒŞs
 =ğ
COMMENT_CONTROLS_ABOVE
 || $comm’t_cÚŒŞ =ğ
COMMENT_CONTROLS_ABOVE_BELOW
)) {

1037 
$ouut
 .ğ
	`dru·l_g‘_fÜm
('comm’t_cÚŒŞs', 
$mode
, 
$Üd”
, 
$comm’ts_³r_·ge
);

1040 
$ouut
 .ğ
$comm’ts
;

1041 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 
$comm’ts_³r_·ge
, 0);

1043 ià(
$num_rows
 && (
$comm’t_cÚŒŞs
 =ğ
COMMENT_CONTROLS_BELOW
 || $comm’t_cÚŒŞ =ğ
COMMENT_CONTROLS_ABOVE_BELOW
)) {

1044 
$ouut
 .ğ
	`dru·l_g‘_fÜm
('comm’t_cÚŒŞs', 
$mode
, 
$Üd”
, 
$comm’ts_³r_·ge
);

1049 
$»¶y
 = 
	`¬g
(0) == 'comment' &&‡rg(1) == 'reply';

1050 ià(
	`u£r_acûss
('po¡ comm’ts'è&& 
	`node_comm’t_mode
(
$nid
è=ğ
COMMENT_NODE_READ_WRITE
 && (
	`v¬ŸbË_g‘
('comm’t_fÜm_loÿtiÚ_'. 
$node
->
ty³
, 
COMMENT_FORM_SEPARATE_PAGE
è=ğ
COMMENT_FORM_BELOW
è&& !
$»¶y
) {

1051 
$ouut
 .ğ
	`comm’t_fÜm_box
(
	`¬¿y
('nid' => 
$nid
), 
	`t
('Post‚ew comment'));

1054 ià(
$ouut
) {

1055 
$ouut
 = 
	`theme
('comm’t_w¿µ”', $ouut, 
$node
);

1059  
$ouut
;

1060 
	}
}

1071 
funùiÚ
 
	$comm’t_İ”©iÚs
(
$aùiÚ
 = 
NULL
) {

1072 ià(
$aùiÚ
 == 'publish') {

1073 
$İ”©iÚs
 = 
	`¬¿y
(

1074 'publish' => 
	`¬¿y
(
	`t
('Publishh£Ëùed comm’ts'), 'UPDATE {comm’ts} SET stu ğ'. 
COMMENT_PUBLISHED
 .' WHERE cid = %d'),

1075 'd–‘e' => 
	`¬¿y
(
	`t
('Deletehe selected comments'), ''),

1078 ià(
$aùiÚ
 == 'unpublish') {

1079 
$İ”©iÚs
 = 
	`¬¿y
(

1080 'uÅublish' => 
	`¬¿y
(
	`t
('UÅublishh£Ëùed comm’ts'), 'UPDATE {comm’ts} SET stu ğ'. 
COMMENT_NOT_PUBLISHED
 .' WHERE cid = %d'),

1081 'd–‘e' => 
	`¬¿y
(
	`t
('Deletehe selected comments'), ''),

1085 
$İ”©iÚs
 = 
	`¬¿y
(

1086 'publish' => 
	`¬¿y
(
	`t
('Publishh£Ëùed comm’ts'), 'UPDATE {comm’ts} SET stu ğ'. 
COMMENT_PUBLISHED
 .' WHERE cid = %d'),

1087 'uÅublish' => 
	`¬¿y
(
	`t
('UÅublishh£Ëùed comm’ts'), 'UPDATE {comm’ts} SET stu ğ'. 
COMMENT_NOT_PUBLISHED
 .' WHERE cid = %d'),

1088 'd–‘e' => 
	`¬¿y
(
	`t
('Deletehe selected comments'), ''),

1091  
$İ”©iÚs
;

1092 
	}
}

1106 
funùiÚ
 
	$_comm’t_lßd
(
$cid
) {

1107  
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT * FROM {comm’ts} WHERE cid = %d', 
$cid
));

1108 
	}
}

1118 
funùiÚ
 
	$comm’t_num_®l
(
$nid
) {

1119 
$ÿche
;

1121 ià(!
	`is£t
(
$ÿche
[
$nid
])) {

1122 
$ÿche
[
$nid
] = 
	`db_»suÉ
(
	`db_qu”y
('SELECT comment_count FROM {node_comment_statistics} WHERE‚id = %d', $nid));

1124  
$ÿche
[
$nid
];

1125 
	}
}

1135 
funùiÚ
 
	$comm’t_num_»¶›s
(
$pid
) {

1136 
$ÿche
;

1138 ià(!
	`is£t
(
$ÿche
[
$pid
])) {

1139 
$ÿche
[
$pid
] = 
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(cidèFROM {comm’ts} WHERE…id = %d AND stu ğ%d', $pid, 
COMMENT_PUBLISHED
));

1142  
$ÿche
[
$pid
];

1143 
	}
}

1154 
funùiÚ
 
	$comm’t_num_Ãw
(
$nid
, 
$time¡amp
 = 0) {

1155 
glob®
 
$u£r
;

1157 ià(
$u£r
->
uid
) {

1160 ià(!
$time¡amp
) {

1161 
$time¡amp
 = 
	`node_Ï¡_v›wed
(
$nid
);

1163 
$time¡amp
 = ($time¡am°> 
NODE_NEW_LIMIT
 ? $timestamp : NODE_NEW_LIMIT);

1166 
$»suÉ
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(c.cidèFROM {node}‚ INNER JOIN {comm’ts} c ON‚.nid = c.nid WHERE‚.nid = %d ANDime¡am°> %d AND c.¡©u ğ%d', 
$nid
, 
$time¡amp
, 
COMMENT_PUBLISHED
));

1168  
$»suÉ
;

1174 
	}
}

1184 
funùiÚ
 
	$comm’t_v®id©e
(
$ed™
) {

1185 
glob®
 
$u£r
;

1188 
	`comm’t_švoke_comm’t
(
$ed™
, 'validate');

1190 ià(
	`is£t
(
$ed™
['date'])) {

1192 ià(
	`¡¹Ùime
(
$ed™
['date']) <= 0) {

1193 
	`fÜm_£t_”rÜ
('d©e', 
	`t
('You haveo specify‡ valid date.'));

1196 ià(
	`is£t
(
$ed™
['authÜ']è&& !
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('name' => $edit['author']))) {

1197 
	`fÜm_£t_”rÜ
('authÜ', 
	`t
('You haveo specify‡ valid‡uthor.'));

1201 ià(!
$u£r
->
uid
 || 
	`is£t
(
$ed™
['is_anonymous'])) {

1202 
$node
 = 
	`node_lßd
(
$ed™
['nid']);

1203 ià(
	`v¬ŸbË_g‘
('comm’t_ªÚymous_'. 
$node
->
ty³
, 
COMMENT_ANONYMOUS_MAYNOT_CONTACT
) > COMMENT_ANONYMOUS_MAYNOT_CONTACT) {

1204 ià(
$ed™
['name']) {

1205 
$k’
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(uidèFROM {u£rs} WHERE LOWERÒameèğ'%s'", 
$ed™
['name']));

1207 ià(
$k’
 != 0) {

1208 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('The‚ame you used belongso‡„egistered user.'));

1212 ià(
	`v¬ŸbË_g‘
('comm’t_ªÚymous_'. 
$node
->
ty³
, 
COMMENT_ANONYMOUS_MAYNOT_CONTACT
è=ğ
COMMENT_ANONYMOUS_MUST_CONTACT
) {

1213 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('You haveo†eave your‚ame.'));

1216 ià(
$ed™
['mail']) {

1217 ià(!
	`v®id_ema_add»ss
(
$ed™
['mail'])) {

1218 
	`fÜm_£t_”rÜ
('ma', 
	`t
('Theƒ-mail‡ddress you specified is‚ot valid.'));

1221 ià(
	`v¬ŸbË_g‘
('comm’t_ªÚymous_'. 
$node
->
ty³
, 
COMMENT_ANONYMOUS_MAYNOT_CONTACT
è=ğ
COMMENT_ANONYMOUS_MUST_CONTACT
) {

1222 
	`fÜm_£t_”rÜ
('ma', 
	`t
('You haveo†eave‡nƒ-mail‡ddress.'));

1225 ià(
$ed™
['homepage']) {

1226 ià(!
	`v®id_u¾
(
$ed™
['hom•age'], 
TRUE
)) {

1227 
	`fÜm_£t_”rÜ
('hom•age', 
	`t
('The URL of your homepage is‚ot valid. Rememberhat it must be fully qualified, i.e. ofhe form <code>http://example.com/directory</code>.'));

1233  
$ed™
;

1234 
	}
}

1245 
funùiÚ
 
	$comm’t_fÜm
(&
$fÜm_¡©e
, 
$ed™
, 
$t™Ë
 = 
NULL
) {

1246 
glob®
 
$u£r
;

1248 
$İ
 = 
	`is£t
(
$_POST
['op']) ? $_POST['op'] : '';

1249 
$node
 = 
	`node_lßd
(
$ed™
['nid']);

1251 ià(!
$u£r
->
uid
 && 
	`v¬ŸbË_g‘
('comm’t_ªÚymous_'. 
$node
->
ty³
, 
COMMENT_ANONYMOUS_MAYNOT_CONTACT
) != COMMENT_ANONYMOUS_MAYNOT_CONTACT) {

1252 
	`dru·l_add_js
(
	`dru·l_g‘_·th
('module', 'comment') .'/comment.js');

1254 
$ed™
 +ğ
	`¬¿y
('name' => '', 'mail' => '', 'homepage' => '');

1255 ià(
$u£r
->
uid
) {

1256 ià(!
	`em±y
(
$ed™
['cid']è&& 
	`u£r_acûss
('administer comments')) {

1257 ià(!
	`em±y
(
$ed™
['author'])) {

1258 
$authÜ
 = 
$ed™
['author'];

1260 
	`–£if
 (!
	`em±y
(
$ed™
['name'])) {

1261 
$authÜ
 = 
$ed™
['name'];

1264 
$authÜ
 = 
$ed™
['registered_name'];

1267 ià(!
	`em±y
(
$ed™
['status'])) {

1268 
$¡©us
 = 
$ed™
['status'];

1271 
$¡©us
 = 0;

1274 ià(!
	`em±y
(
$ed™
['date'])) {

1275 
$d©e
 = 
$ed™
['date'];

1278 
$d©e
 = 
	`fÜm©_d©e
(
$ed™
['timestamp'], 'custom', 'Y-m-d H:i O');

1281 
$fÜm
['admš'] = 
	`¬¿y
(

1283 '#t™Ë' => 
	`t
('Administration'),

1284 '#cŞÏpsibË' => 
TRUE
,

1285 '#cŞÏp£d' => 
TRUE
,

1289 ià(
$ed™
['registered_name'] != '') {

1291 
$fÜm
['admš']['authÜ'] = 
	`¬¿y
(

1293 '#t™Ë' => 
	`t
('Authored by'),

1297 '#deçuÉ_v®ue' => 
$authÜ
,

1303 
$fÜm
['is_ªÚymous'] = 
	`¬¿y
(

1305 '#v®ue' => 
TRUE
,

1307 
$fÜm
['admš']['Çme'] = 
	`¬¿y
(

1309 '#t™Ë' => 
	`t
('Authored by'),

1312 '#deçuÉ_v®ue' => 
$authÜ
,

1315 
$fÜm
['admš']['ma'] = 
	`¬¿y
(

1317 '#t™Ë' => 
	`t
('E-mail'),

1320 '#deçuÉ_v®ue' => 
$ed™
['mail'],

1321 '#desütiÚ' => 
	`t
('The content ofhis field is kept…rivate‡nd will‚ot be shown…ublicly.'),

1324 
$fÜm
['admš']['hom•age'] = 
	`¬¿y
(

1326 '#t™Ë' => 
	`t
('Homepage'),

1329 '#deçuÉ_v®ue' => 
$ed™
['homepage'],

1333 
$fÜm
['admš']['d©e'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#·»Ás' =>‡¼ay('d©e'), '#t™Ë' => 
	`t
('AuthÜed on'), '#size' => 20, '#maxËngth' => 25, '#deçuÉ_v®ue' => 
$d©e
, '#weight' => -1);

1335 
$fÜm
['admš']['¡©us'] = 
	`¬¿y
('#ty³' => '¿dios', '#·»Ás' =>‡¼ay('¡©us'), '#t™Ë' => 
	`t
('Stus'), '#deçuÉ_v®ue' => 
$¡©us
, '#options' =>‡rray(t('Published'),('Not…ublished')), '#weight' => -1);

1339 
$fÜm
['_authÜ'] = 
	`¬¿y
('#ty³' => '™em', '#t™Ë' => 
	`t
('You¸Çme'), '#v®ue' => 
	`theme
('u£ºame', 
$u£r
)

1341 
$fÜm
['authÜ'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$u£r
->
Çme
);

1344 ià(
	`v¬ŸbË_g‘
('comm’t_ªÚymous_'. 
$node
->
ty³
, 
COMMENT_ANONYMOUS_MAYNOT_CONTACT
è=ğ
COMMENT_ANONYMOUS_MAY_CONTACT
) {

1345 
$fÜm
['Çme'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => 
	`t
('You¸Çme'), '#maxËngth' => 60, '#size' => 30, '#deçuÉ_v®ue' => 
$ed™
['Çme'] ? $ed™['Çme'] : 
	`v¬ŸbË_g‘
('anonymous',('Anonymous'))

1348 
$fÜm
['ma'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => 
	`t
('E-ma'), '#maxËngth' => 64, '#size' => 30, '#deçuÉ_v®ue' => 
$ed™
['mail'], '#description' =>('The content ofhis field is kept…rivate‡nd will‚ot be shown…ublicly.')

1351 
$fÜm
['hom•age'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => 
	`t
('Hom•age'), '#maxËngth' => 255, '#size' => 30, '#deçuÉ_v®ue' => 
$ed™
['homepage']);

1353 ià(
	`v¬ŸbË_g‘
('comm’t_ªÚymous_'. 
$node
->
ty³
, 
COMMENT_ANONYMOUS_MAYNOT_CONTACT
è=ğ
COMMENT_ANONYMOUS_MUST_CONTACT
) {

1354 
$fÜm
['Çme'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => 
	`t
('You¸Çme'), '#maxËngth' => 60, '#size' => 30, '#deçuÉ_v®ue' => 
$ed™
['Çme'] ? $ed™['Çme'] : 
	`v¬ŸbË_g‘
('ªÚymous',('AnÚymous')), '#»quœed' => 
TRUE
);

1356 
$fÜm
['ma'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => 
	`t
('E-ma'), '#maxËngth' => 64, '#size' => 30, '#deçuÉ_v®ue' => 
$ed™
['ma'], '#desütiÚ' =>('ThcÚ‹Á oàthi f›ld i k•ˆ´iv©ªd wÈnÙ bshowÀpublişy.'), '#»quœed' => 
TRUE
);

1358 
$fÜm
['hom•age'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => 
	`t
('Hom•age'), '#maxËngth' => 255, '#size' => 30, '#deçuÉ_v®ue' => 
$ed™
['homepage']);

1361 ià(
	`v¬ŸbË_g‘
('comm’t_subjeù_f›ld_'. 
$node
->
ty³
, 1) == 1) {

1362 
$fÜm
['subjeù'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => 
	`t
('Subjeù'), '#maxËngth' => 64, '#deçuÉ_v®ue' => !
	`em±y
(
$ed™
['subject']) ? $edit['subject'] : '');

1365 ià(!
	`em±y
(
$ed™
['comment'])) {

1366 
$deçuÉ
 = 
$ed™
['comment'];

1369 
$deçuÉ
 = '';

1372 
$fÜm
['comm’t_f‹r']['comm’t'] = 
	`¬¿y
(

1374 '#t™Ë' => 
	`t
('Comment'),

1376 '#deçuÉ_v®ue' => 
$deçuÉ
,

1377 '#»quœed' => 
TRUE
,

1379 ià(!
	`is£t
(
$ed™
['format'])) {

1380 
$ed™
['fÜm©'] = 
FILTER_FORMAT_DEFAULT
;

1382 
$fÜm
['comm’t_f‹r']['fÜm©'] = 
	`f‹r_fÜm
(
$ed™
['format']);

1384 
$fÜm
['cid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => !
	`em±y
(
$ed™
['cid']è? $ed™['cid'] : 
NULL
);

1385 
$fÜm
['pid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => !
	`em±y
(
$ed™
['pid']è? $ed™['pid'] : 
NULL
);

1386 
$fÜm
['nid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$ed™
['nid']);

1387 
$fÜm
['uid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => !
	`em±y
(
$ed™
['uid']) ? $edit['uid'] : 0);

1392 ià(!
	`fÜm_g‘_”rÜs
(è&& ((
	`v¬ŸbË_g‘
('comm’t_´ev›w_'. 
$node
->
ty³
, 
COMMENT_PREVIEW_REQUIRED
è=ğ
COMMENT_PREVIEW_OPTIONAL
è|| (
$İ
 =ğ
	`t
('Preview')) || ($op ==('Save')))) {

1393 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save'), '#weight' => 19);

1396 
$fÜm
['´ev›w'] = 
	`¬¿y
('#ty³' => 'bu‰Ú', '#v®ue' => 
	`t
('Preview'), '#weight' => 20);

1397 
$fÜm
['#tok’'] = 'comm’t'. 
$ed™
['nid'] . (
	`is£t
($edit['pid']) ? $edit['pid'] : '');

1399 ià(
$İ
 =ğ
	`t
('Preview')) {

1400 
$fÜm
['#aá”_bud'] = 
	`¬¿y
('comment_form_add_preview');

1403 ià(
	`em±y
(
$ed™
['cid']) &&ƒmpty($edit['pid'])) {

1404 
$fÜm
['#aùiÚ'] = 
	`u¾
('comm’t/»¶y/'. 
$ed™
['nid']);

1407  
$fÜm
;

1408 
	}
}

1418 
funùiÚ
 
	$comm’t_fÜm_box
(
$ed™
, 
$t™Ë
 = 
NULL
) {

1419  
	`theme
('box', 
$t™Ë
, 
	`dru·l_g‘_fÜm
('comm’t_fÜm', 
$ed™
, $title));

1420 
	}
}

1427 
funùiÚ
 
	$comm’t_fÜm_add_´ev›w
(
$fÜm
, &
$fÜm_¡©e
) {

1428 
glob®
 
$u£r
;

1429 
$ed™
 = 
$fÜm_¡©e
['values'];

1430 
	`dru·l_£t_t™Ë
(
	`t
('Preview comment'));

1432 
$ouut
 = '';

1433 
$node
 = 
	`node_lßd
(
$ed™
['nid']);

1439 
	`dru·l_v®id©e_fÜm
(
$fÜm
['fÜm_id']['#v®ue'], $fÜm, 
$fÜm_¡©e
);

1440 ià(!
	`fÜm_g‘_”rÜs
()) {

1441 
	`_comm’t_fÜm_subm™
(
$ed™
);

1442 
$comm’t
 = (
objeù
)
$ed™
;

1445 ià(!
	`em±y
(
$ed™
['author'])) {

1446 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('Çme' => 
$ed™
['author']));

1448 
	`–£if
 (
$u£r
->
uid
 && !
	`is£t
(
$ed™
['is_anonymous'])) {

1449 
$accouÁ
 = 
$u£r
;

1451 ià(!
	`em±y
(
$accouÁ
)) {

1452 
$comm’t
->
uid
 = 
$accouÁ
->uid;

1453 
$comm’t
->
Çme
 = 
	`check_¶aš
(
$accouÁ
->name);

1455 
	`–£if
 (
	`em±y
(
$comm’t
->
Çme
)) {

1456 
$comm’t
->
Çme
 = 
	`v¬ŸbË_g‘
('ªÚymous', 
	`t
('Anonymous'));

1458 
$comm’t
->
time¡amp
 = !
	`em±y
(
$ed™
['time¡amp']è? $ed™['time¡amp'] : 
	`time
();

1459 
$ouut
 .ğ
	`theme
('comm’t_v›w', 
$comm’t
, 
$node
);

1461 
$fÜm
['comm’t_´ev›w'] = 
	`¬¿y
(

1462 '#v®ue' => 
$ouut
,

1468 
$ouut
 = '';

1470 ià(
$ed™
['pid']) {

1471 
$comm’t
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT c.*, u.uid, u.ÇmAS„egi¡”ed_Çme, u.sigÇtu», u.sigÇtu»_fÜm©, u.piùu», u.d©¨FROM {comm’ts} c INNER JOIN {u£rs} u ON c.uid = u.uid WHERE c.cid = %d AND c.¡©u ğ%d', 
$ed™
['pid'], 
COMMENT_PUBLISHED
));

1472 
$comm’t
 = 
	`dru·l_uÅack
($comment);

1473 
$comm’t
->
Çme
 = $comm’t->
uid
 ? $comm’t->
»gi¡”ed_Çme
 : $comment->name;

1474 
$ouut
 .ğ
	`theme
('comm’t_v›w', 
$comm’t
, 
$node
);

1477 
$suffix
 = 
	`em±y
(
$fÜm
['#suffix']) ? '' : $form['#suffix'];

1478 
$fÜm
['#suffix'] = 
$suffix
 . 
	`node_v›w
(
$node
);

1479 
$ed™
['pid'] = 0;

1482 
$fÜm
['comm’t_´ev›w_b–ow'] = 
	`¬¿y
('#v®ue' => 
$ouut
, '#weight' => 100);

1484  
$fÜm
;

1485 
	}
}

1490 
funùiÚ
 
	$comm’t_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

1491 
glob®
 
$u£r
;

1492 ià(
$u£r
->
uid
 === 0) {

1493 
	`fÜ—ch
 (
	`¬¿y
('Çme', 'hom•age', 'ma'è
as
 
$f›ld
) {

1495 ià(
	`is£t
(
$fÜm_¡©e
['v®ues'][
$f›ld
])) {

1496 
	`£tcook›
('comm’t_šfo_'. 
$f›ld
, 
$fÜm_¡©e
['v®ues'][$f›ld], 
	`time
() + 31536000, '/');

1500 
	`comm’t_v®id©e
(
$fÜm_¡©e
['values']);

1501 
	}
}

1509 
funùiÚ
 
	$_comm’t_fÜm_subm™
(&
$comm’t_v®ues
) {

1510 
$comm’t_v®ues
 +ğ
	`¬¿y
('subject' => '');

1511 ià(!
	`is£t
(
$comm’t_v®ues
['date'])) {

1512 
$comm’t_v®ues
['date'] = 'now';

1514 
$comm’t_v®ues
['time¡amp'] = 
	`¡¹Ùime
($comment_values['date']);

1515 ià(
	`is£t
(
$comm’t_v®ues
['author'])) {

1516 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('Çme' => 
$comm’t_v®ues
['author']));

1517 
$comm’t_v®ues
['uid'] = 
$accouÁ
->
uid
;

1518 
$comm’t_v®ues
['name'] = $comment_values['author'];

1522 ià(
	`Œim
(
$comm’t_v®ues
['subject']) == '') {

1528 
$comm’t_v®ues
['subjeù'] = 
	`Œunÿ‹_utf8
(
	`Œim
(
	`decode_’t™›s
(
	`¡r_gs
(
	`check_m¬kup
($comm’t_v®ues['comm’t'], $comm’t_v®ues['fÜm©'])))), 29, 
TRUE
);

1531 ià(
$comm’t_v®ues
['subject'] == '') {

1532 
$comm’t_v®ues
['subjeù'] = 
	`t
('(No subject)');

1535 
	}
}

1540 
funùiÚ
 
	$comm’t_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1541 
	`_comm’t_fÜm_subm™
(
$fÜm_¡©e
['values']);

1542 ià(
$cid
 = 
	`comm’t_§ve
(
$fÜm_¡©e
['values'])) {

1543 
$node
 = 
	`node_lßd
(
$fÜm_¡©e
['values']['nid']);

1545 
$comm’t_couÁ
 = 
$node
->
comm’t_couÁ
 + 1;

1546 
$·ge
 = 
	`comm’t_Ãw_·ge_couÁ
(
$comm’t_couÁ
, 1, 
$node
);

1547 
$fÜm_¡©e
['»dœeù'] = 
	`¬¿y
('node/'. 
$node
->
nid
, 
$·ge
, "comment-$cid");

1550 
	}
}

1569 
funùiÚ
 
theme_comm’t_v›w
(
$comm’t
, 
$node
, 
$lšks
 = 
¬¿y
(), 
$visibË
 = 
TRUE
) {

1570 
$fœ¡_Ãw
 = 
TRUE
;

1572 
	g$ouut
 = '';

1573 
	g$comm’t
->
	gÃw
 = 
node_m¬k
(
$comm’t
->
nid
, $comm’t->
time¡amp
);

1574 ià(
	g$fœ¡_Ãw
 && 
	g$comm’t
->
	gÃw
 !ğ
MARK_READ
) {

1577 
$fœ¡_Ãw
 = 
FALSE
;

1578 
	g$ouut
 .= "<a id=\"new\"></a>\n";

1581 
	g$ouut
 .= "<a id=\"comment-$comment->cid\"></a>\n";

1584 ià(
	g$visibË
) {

1585 
	g$comm’t
->
	gcomm’t
 = 
check_m¬kup
(
$comm’t
->
comm’t
, $comm’t->
fÜm©
, 
FALSE
);

1588 
comm’t_švoke_comm’t
(
$comm’t
, 'view');

1590 
	g$ouut
 .ğ
theme
('comm’t', 
$comm’t
, 
$node
, 
$lšks
);

1593 
	g$ouut
 .ğ
theme
('comm’t_fŞded', 
$comm’t
);

1596  
	g$ouut
;

1611 
funùiÚ
 
	$comm’t_cÚŒŞs
(&
$fÜm_¡©e
, 
$mode
 = 
COMMENT_MODE_THREADED_EXPANDED
, 
$Üd”
 = 
COMMENT_ORDER_NEWEST_FIRST
, 
$comm’ts_³r_·ge
 = 50) {

1612 
$fÜm
['mode'] = 
	`¬¿y
('#type' => 'select',

1613 '#deçuÉ_v®ue' => 
$mode
,

1614 '#İtiÚs' => 
	`_comm’t_g‘_modes
(),

1617 
$fÜm
['Üd”'] = 
	`¬¿y
(

1619 '#deçuÉ_v®ue' => 
$Üd”
,

1620 '#İtiÚs' => 
	`_comm’t_g‘_Üd”s
(),

1623 
	`fÜ—ch
 (
	`_comm’t_³r_·ge
(è
as
 
$i
) {

1624 
$İtiÚs
[
$i
] = 
	`t
('!¨comm’t ³¸·ge', 
	`¬¿y
('!a' => $i));

1626 
$fÜm
['comm’ts_³r_·ge'] = 
	`¬¿y
('#type' => 'select',

1627 '#deçuÉ_v®ue' => 
$comm’ts_³r_·ge
,

1628 '#İtiÚs' => 
$İtiÚs
,

1632 
$fÜm
['subm™'] = 
	`¬¿y
('#type' => 'submit',

1633 '#v®ue' => 
	`t
('Save settings'),

1637  
$fÜm
;

1638 
	}
}

1647 
funùiÚ
 
	$theme_comm’t_cÚŒŞs
(
$fÜm
) {

1648 
$ouut
 = '<div class="container-inline">';

1649 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

1650 
$ouut
 .= '</div>';

1651 
$ouut
 .ğ'<div cÏss="desütiÚ">'. 
	`t
('Select your…referred wayo displayhe comments‡nd click "Save settings"o‡ctivate your changes.') .'</div>';

1652  
	`theme
('box', 
	`t
('Comm’ˆv›wšg o±iÚs'), 
$ouut
);

1653 
	}
}

1658 
funùiÚ
 
	$comm’t_cÚŒŞs_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1659 
glob®
 
$u£r
;

1661 
$mode
 = 
$fÜm_¡©e
['values']['mode'];

1662 
$Üd”
 = 
$fÜm_¡©e
['values']['order'];

1663 
$comm’ts_³r_·ge
 = 
$fÜm_¡©e
['values']['comments_per_page'];

1665 ià(
$u£r
->
uid
) {

1666 
$accouÁ
 = 
	`u£r_§ve
(
$u£r
, 
	`¬¿y
('mode' => 
$mode
, 'sÜt' => 
$Üd”
, 'comm’ts_³r_·ge' => 
$comm’ts_³r_·ge
));

1668 ià(!
$accouÁ
) {

1669 
	`dru·l_£t_mes§ge
(
	`t
("Error saving user‡ccount."), 'error');

1672 
$u£r
 = 
$accouÁ
;

1675 
$_SESSION
['comm’t_mode'] = 
$mode
;

1676 
$_SESSION
['comm’t_sÜt'] = 
$Üd”
;

1677 
$_SESSION
['comm’t_comm’ts_³r_·ge'] = 
$comm’ts_³r_·ge
;

1679 
	}
}

1687 
funùiÚ
 
	$‹m¶©e_´•roûss_comm’t
(&
$v¬ŸbËs
) {

1688 
$comm’t
 = 
$v¬ŸbËs
['comment'];

1689 
$node
 = 
$v¬ŸbËs
['node'];

1690 
$v¬ŸbËs
['authÜ'] = 
	`theme
('u£ºame', 
$comm’t
);

1691 
$v¬ŸbËs
['cÚ‹Á'] = 
$comm’t
->
comm’t
;

1692 
$v¬ŸbËs
['d©e'] = 
	`fÜm©_d©e
(
$comm’t
->
time¡amp
);

1693 
$v¬ŸbËs
['lšks'] = 
	`is£t
($v¬ŸbËs['lšks']è? 
	`theme
('links', $variables['links']) : '';

1694 
$v¬ŸbËs
['Ãw'] = 
$comm’t
->
Ãw
 ? 
	`t
('new') : '';

1695 
$v¬ŸbËs
['piùu»'] = 
	`theme_g‘_£‰šg
('toggË_comm’t_u£r_piùu»'è? 
	`theme
('u£r_piùu»', 
$comm’t
) : '';

1696 
$v¬ŸbËs
['sigÇtu»'] = 
$comm’t
->
sigÇtu»
;

1697 
$v¬ŸbËs
['subm™‹d'] = 
	`theme
('comm’t_subm™‹d', 
$comm’t
);

1698 
$v¬ŸbËs
['t™Ë'] = 
	`l
(
$comm’t
->
subjeù
, 
$_GET
['q'], 
	`¬¿y
('fragment' => "comment-$comment->cid"));

1699 
$v¬ŸbËs
['‹m¶©e_fes'][] = 'comm’t-'. 
$node
->
ty³
;

1701 ià(
	`is£t
(
$comm’t
->
´ev›w
)) {

1702 
$v¬ŸbËs
['status'] = 'comment-preview';

1705 
$v¬ŸbËs
['¡©us'] = (
$comm’t
->
¡©us
 =ğ
COMMENT_NOT_PUBLISHED
) ? 'comment-unpublished' : 'comment-published';

1707 
	}
}

1715 
funùiÚ
 
	$‹m¶©e_´•roûss_comm’t_fŞded
(&
$v¬ŸbËs
) {

1716 
$comm’t
 = 
$v¬ŸbËs
['comment'];

1717 
$v¬ŸbËs
['authÜ'] = 
	`theme
('u£ºame', 
$comm’t
);

1718 
$v¬ŸbËs
['d©e'] = 
	`fÜm©_d©e
(
$comm’t
->
time¡amp
);

1719 
$v¬ŸbËs
['Ãw'] = 
$comm’t
->
Ãw
 ? 
	`t
('new') : '';

1720 
$v¬ŸbËs
['t™Ë'] = 
	`l
(
$comm’t
->
subjeù
, 
	`comm’t_node_u¾
(è.'/'. $comm’t->
cid
, 
	`¬¿y
('fragment' => "comment-$comment->cid"));

1721 
	}
}

1732 
funùiÚ
 
	$theme_comm’t_æ©_cŞÏp£d
(
$comm’t
, 
$node
) {

1733  
	`theme
('comm’t_v›w', 
$comm’t
, 
$node
, '', 0);

1734 
	}
}

1745 
funùiÚ
 
	$theme_comm’t_æ©_ex·nded
(
$comm’t
, 
$node
) {

1746 
$lšks
 = 
	`moduË_švoke_®l
('lšk', 'comm’t', 
$comm’t
, 0);

1747 
	`dru·l_®‹r
('lšk', 
$lšks
, 
$node
, 
$comm’t
);

1748  
	`theme
('comm’t_v›w', 
$comm’t
, 
$node
, 
$lšks
);

1749 
	}
}

1760 
funùiÚ
 
	$theme_comm’t_th»ad_cŞÏp£d
(
$comm’t
, 
$node
) {

1761  
	`theme
('comm’t_v›w', 
$comm’t
, 
$node
, '', 0);

1762 
	}
}

1773 
funùiÚ
 
	$theme_comm’t_th»ad_ex·nded
(
$comm’t
, 
$node
) {

1774 
$lšks
 = 
	`moduË_švoke_®l
('lšk', 'comm’t', 
$comm’t
, 0);

1775 
	`dru·l_®‹r
('lšk', 
$lšks
, 
$node
, 
$comm’t
);

1776  
	`theme
('comm’t_v›w', 
$comm’t
, 
$node
, 
$lšks
);

1777 
	}
}

1786 
funùiÚ
 
	$theme_comm’t_po¡_fÜbidd’
(
$node
) {

1787 
glob®
 
$u£r
;

1788 
$auth’tiÿ‹d_po¡_comm’ts
;

1790 ià(!
$u£r
->
uid
) {

1791 ià(!
	`is£t
(
$auth’tiÿ‹d_po¡_comm’ts
)) {

1794 
$auth’tiÿ‹d_po¡_comm’ts
 = 
	`¬¿y_key_exi¡s
(
DRUPAL_AUTHENTICATED_RID
, 
	`u£r_rŞes
(
TRUE
, 'post comments') + user_roles(TRUE, 'post comments without‡pproval'));

1797 ià(
$auth’tiÿ‹d_po¡_comm’ts
) {

1800 ià(
	`v¬ŸbË_g‘
('comm’t_fÜm_loÿtiÚ_'. 
$node
->
ty³
, 
COMMENT_FORM_SEPARATE_PAGE
) == COMMENT_FORM_SEPARATE_PAGE) {

1801 
$de¡š©iÚ
 = 'de¡š©iÚ='. 
	`¿wu¾’code
("comment/reply/$node->nid#comment-form");

1804 
$de¡š©iÚ
 = 'de¡š©iÚ='. 
	`¿wu¾’code
("node/$node->nid#comment-form");

1807 ià(
	`v¬ŸbË_g‘
('user_register', 1)) {

1809  
	`t
('<¨h»f="@logš">Logš</a> o¸<¨h»f="@»gi¡”">»gi¡”</a>Øpo¡ comm’ts', 
	`¬¿y
('@logš' => 
	`u¾
('u£r/logš',‡¼ay('qu”y' => 
$de¡š©iÚ
)), '@register' => url('user/register',‡rray('query' => $destination))));

1813  
	`t
('<¨h»f="@logš">Logš</a>Øpo¡ comm’ts', 
	`¬¿y
('@logš' => 
	`u¾
('u£r/logš',‡¼ay('qu”y' => 
$de¡š©iÚ
))));

1817 
	}
}

1825 
funùiÚ
 
	$‹m¶©e_´•roûss_comm’t_w¿µ”
(&
$v¬ŸbËs
) {

1827 
$v¬ŸbËs
['di¥Ïy_mode'] = 
	`_comm’t_g‘_di¥Ïy_£‰šg
('mode', $variables['node']);

1828 
$v¬ŸbËs
['di¥Ïy_Üd”'] = 
	`_comm’t_g‘_di¥Ïy_£‰šg
('sort', $variables['node']);

1829 
$v¬ŸbËs
['comm’t_cÚŒŞs_¡©e'] = 
	`v¬ŸbË_g‘
('comm’t_cÚŒŞs_'. $v¬ŸbËs['node']->
ty³
, 
COMMENT_CONTROLS_HIDDEN
);

1830 
$v¬ŸbËs
['‹m¶©e_fes'][] = 'comm’t-w¿µ”-'. $v¬ŸbËs['node']->
ty³
;

1831 
	}
}

1840 
funùiÚ
 
	$theme_comm’t_subm™‹d
(
$comm’t
) {

1841  
	`t
('Submitted by !username on @datetime.',

1842 
	`¬¿y
(

1843 '!u£ºame' => 
	`theme
('u£ºame', 
$comm’t
),

1844 '@d©‘ime' => 
	`fÜm©_d©e
(
$comm’t
->
time¡amp
)

1846 
	}
}

1854 
funùiÚ
 
	$_comm’t_g‘_modes
() {

1855  
	`¬¿y
(

1856 
COMMENT_MODE_FLAT_COLLAPSED
 => 
	`t
('Flat†ist - collapsed'),

1857 
COMMENT_MODE_FLAT_EXPANDED
 => 
	`t
('Flat†ist -ƒxpanded'),

1858 
COMMENT_MODE_THREADED_COLLAPSED
 => 
	`t
('Threaded†ist - collapsed'),

1859 
COMMENT_MODE_THREADED_EXPANDED
 => 
	`t
('Threaded†ist -ƒxpanded')

1861 
	}
}

1869 
funùiÚ
 
	$_comm’t_g‘_Üd”s
() {

1870  
	`¬¿y
(

1871 
COMMENT_ORDER_NEWEST_FIRST
 => 
	`t
('Date -‚ewest first'),

1872 
COMMENT_ORDER_OLDEST_FIRST
 => 
	`t
('Date - oldest first')

1874 
	}
}

1880 
funùiÚ
 
	$_comm’t_³r_·ge
() {

1881  
	`dru·l_m­_assoc
(
	`¬¿y
(10, 30, 50, 70, 90, 150, 200, 250, 300));

1882 
	}
}

1892 
funùiÚ
 
	$_comm’t_g‘_di¥Ïy_£‰šg
(
$£‰šg
, 
$node
) {

1893 
glob®
 
$u£r
;

1895 ià(
	`is£t
(
$_GET
[
$£‰šg
])) {

1896 
$v®ue
 = 
$_GET
[
$£‰šg
];

1900 
$£‰šg
) {

1902 
$deçuÉ
 = 
	`v¬ŸbË_g‘
('comm’t_deçuÉ_mode_'. 
$node
->
ty³
, 
COMMENT_MODE_THREADED_EXPANDED
);

1905 
$deçuÉ
 = 
	`v¬ŸbË_g‘
('comm’t_deçuÉ_Üd”_'. 
$node
->
ty³
, 
COMMENT_ORDER_NEWEST_FIRST
);

1908 
$deçuÉ
 = 
	`v¬ŸbË_g‘
('comm’t_deçuÉ_³r_·ge_'. 
$node
->
ty³
, 50);

1910 ià(
	`v¬ŸbË_g‘
('comm’t_cÚŒŞs_'. 
$node
->
ty³
, 
COMMENT_CONTROLS_HIDDEN
) == COMMENT_CONTROLS_HIDDEN) {

1912 
$v®ue
 = 
$deçuÉ
;

1916 ià(
	`is£t
(
$u£r
->
$£‰šg
) && $user->$setting) {

1917 
$v®ue
 = 
$u£r
->
$£‰šg
;

1919 ià(
	`is£t
(
$_SESSION
['comm’t_'. 
$£‰šg
]) && $_SESSION['comment_'. $setting]) {

1920 
$v®ue
 = 
$_SESSION
['comm’t_'. 
$£‰šg
];

1923 
$v®ue
 = 
$deçuÉ
;

1927  
$v®ue
;

1928 
	}
}

1940 
funùiÚ
 
	$_comm’t_upd©e_node_¡©i¡ics
(
$nid
) {

1941 
$couÁ
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(cidèFROM {comm’ts} WHERE‚id = %d AND stu ğ%d', 
$nid
, 
COMMENT_PUBLISHED
));

1944 ià(
$couÁ
 > 0) {

1945 
$Ï¡_»¶y
 = 
	`db_ãtch_objeù
(
	`db_qu”y_¿nge
('SELECT cid,‚ame,ime¡amp, uid FROM {comm’ts} WHERE‚id = %d AND stu ğ%d ORDER BY cid DESC', 
$nid
, 
COMMENT_PUBLISHED
, 0, 1));

1946 
	`db_qu”y
("UPDATE {node_comm’t_¡©i¡ics} SET comm’t_couÁ = %d,†a¡_comm’t_time¡am°ğ%d,†a¡_comm’t_Çmğ'%s',†a¡_comm’t_uid = %d WHERE‚id = %d", 
$couÁ
, 
$Ï¡_»¶y
->
time¡amp
, $Ï¡_»¶y->
uid
 ? '' : $Ï¡_»¶y->
Çme
, $Ï¡_»¶y->uid, 
$nid
);

1951 
$node
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT uid, c»©ed FROM {node} WHERE‚id = %d", 
$nid
));

1952 
	`db_qu”y
("UPDATE {node_comm’t_¡©i¡ics} SET comm’t_couÁ = 0,†a¡_comm’t_time¡am°ğ%d,†a¡_comm’t_Çmğ'',†a¡_comm’t_uid = %d WHERE‚id = %d", 
$node
->
ü—‹d
, $node->
uid
, 
$nid
);

1954 
	}
}

1966 
funùiÚ
 
	$comm’t_švoke_comm’t
(&
$comm’t
, 
$İ
) {

1967 
$»tuº
 = 
	`¬¿y
();

1968 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('comm’t'è
as
 
$Çme
) {

1969 
$funùiÚ
 = 
$Çme
 .'_comment';

1970 
$»suÉ
 = 
	`$funùiÚ
(
$comm’t
, 
$İ
);

1971 ià(
	`is£t
(
$»suÉ
è&& 
	`is_¬¿y
($result)) {

1972 
$»tuº
 = 
	`¬¿y_m”ge
($»tuº, 
$»suÉ
);

1974 ià(
	`is£t
(
$»suÉ
)) {

1975 
$»tuº
[] = 
$»suÉ
;

1978  
$»tuº
;

1979 
	}
}

1994 
funùiÚ
 
	$št2vªcode
(
$i
 = 0) {

1995 
$num
 = 
	`ba£_cÚv”t
(()
$i
, 10, 36);

1996 
$Ëngth
 = 
	`¡¾’
(
$num
);

1997  
	`chr
(
$Ëngth
 + 
	`Üd
('0'è- 1è. 
$num
;

1998 
	}
}

2003 
funùiÚ
 
vªcode2št
(
$c
 = '00') {

2004  
ba£_cÚv”t
(
sub¡r
(
$c
, 1), 36, 10);

2010 
funùiÚ
 
	$comm’t_hook_šfo
() {

2011  
	`¬¿y
(

2012 'comm’t' => 
	`¬¿y
(

2013 'comm’t' => 
	`¬¿y
(

2014 'š£¹' => 
	`¬¿y
(

2015 'run wh’' => 
	`t
('After saving‡‚ew comment'),

2017 'upd©e' => 
	`¬¿y
(

2018 'run wh’' => 
	`t
('After saving‡n updated comment'),

2020 'd–‘e' => 
	`¬¿y
(

2021 'run wh’' => 
	`t
('After deleting‡ comment')

2023 'v›w' => 
	`¬¿y
(

2024 'run wh’' => 
	`t
('When‡ comment is being viewed by‡n‡uthenticated user')

2029 
	}
}

2034 
funùiÚ
 
	$comm’t_aùiÚ_šfo
() {

2035  
	`¬¿y
(

2036 'comm’t_publish_aùiÚ' => 
	`¬¿y
(

2037 'desütiÚ' => 
	`t
('Publish comment'),

2039 'cÚfigu¿bË' => 
FALSE
,

2040 'hooks' => 
	`¬¿y
(

2041 'comm’t' => 
	`¬¿y
('insert', 'update'),

2044 'comm’t_uÅublish_aùiÚ' => 
	`¬¿y
(

2045 'desütiÚ' => 
	`t
('Unpublish comment'),

2047 'cÚfigu¿bË' => 
FALSE
,

2048 'hooks' => 
	`¬¿y
(

2049 'comm’t' => 
	`¬¿y
('insert', 'update'),

2052 'comm’t_uÅublish_by_keywÜd_aùiÚ' => 
	`¬¿y
(

2053 'desütiÚ' => 
	`t
('Unpublish comment containing keyword(s)'),

2055 'cÚfigu¿bË' => 
TRUE
,

2056 'hooks' => 
	`¬¿y
(

2057 'comm’t' => 
	`¬¿y
('insert', 'update'),

2061 
	}
}

2073 
funùiÚ
 
comm’t_publish_aùiÚ
(
$comm’t
, 
$cÚ‹xt
 = 
	$¬¿y
()) {

2074 ià(
	`is£t
(
$comm’t
->
cid
)) {

2075 
$cid
 = 
$comm’t
->
cid
;

2076 
$subjeù
 = 
$comm’t
->
subjeù
;

2079 
$cid
 = 
$cÚ‹xt
['cid'];

2080 
$subjeù
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT subjeù FROM {comm’ts} WHERE cid = %d", 
$cid
));

2082 
	`db_qu”y
('UPDATE {comm’ts} SET stu ğ%d WHERE cid = %d', 
COMMENT_PUBLISHED
, 
$cid
);

2083 
	`w©chdog
('aùiÚ', 'Published comm’ˆ%subjeù.', 
	`¬¿y
('%subjeù' => 
$subjeù
));

2084 
	}
}

2096 
funùiÚ
 
comm’t_uÅublish_aùiÚ
(
$comm’t
, 
$cÚ‹xt
 = 
	$¬¿y
()) {

2097 ià(
	`is£t
(
$comm’t
->
cid
)) {

2098 
$cid
 = 
$comm’t
->
cid
;

2099 
$subjeù
 = 
$comm’t
->
subjeù
;

2102 
$cid
 = 
$cÚ‹xt
['cid'];

2103 
$subjeù
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT subjeù FROM {comm’ts} WHERE cid = %d", 
$cid
));

2105 
	`db_qu”y
('UPDATE {comm’ts} SET stu ğ%d WHERE cid = %d', 
COMMENT_NOT_PUBLISHED
, 
$cid
);

2106 
	`w©chdog
('aùiÚ', 'UÅublished comm’ˆ%subjeù.', 
	`¬¿y
('%subjeù' => 
$subjeù
));

2107 
	}
}

2123 
funùiÚ
 
	$comm’t_uÅublish_by_keywÜd_aùiÚ
(
$comm’t
, 
$cÚ‹xt
) {

2124 
	`fÜ—ch
 (
$cÚ‹xt
['keywÜds'] 
as
 
$keywÜd
) {

2125 ià(
	`¡½os
(
$comm’t
->
comm’t
, 
$keywÜd
è!=ğ
FALSE
 || sŒpos($comm’t->
subjeù
, $keyword) !== FALSE) {

2126 
	`db_qu”y
('UPDATE {comm’ts} SET stu ğ%d WHERE cid = %d', 
COMMENT_NOT_PUBLISHED
, 
$comm’t
->
cid
);

2127 
	`w©chdog
('aùiÚ', 'UÅublished comm’ˆ%subjeù.', 
	`¬¿y
('%subjeù' => 
$comm’t
->
subjeù
));

2131 
	}
}

2140 
funùiÚ
 
	$comm’t_uÅublish_by_keywÜd_aùiÚ_fÜm
(
$cÚ‹xt
) {

2141 
$fÜm
['keywÜds'] = 
	`¬¿y
(

2142 '#t™Ë' => 
	`t
('Keywords'),

2144 '#desütiÚ' => 
	`t
('The comment will be unpublished if it contains‡ny ofhe character sequences‡bove. Use‡ comma-separated†ist of character sequences. Example: funny, bungee jumping, "Company, Inc.". Character sequences‡re case-sensitive.'),

2145 '#deçuÉ_v®ue' => 
	`is£t
(
$cÚ‹xt
['keywÜds']è? 
	`dru·l_im¶ode_gs
($context['keywords']) : '',

2147  
$fÜm
;

2148 
	}
}

2155 
funùiÚ
 
	$comm’t_uÅublish_by_keywÜd_aùiÚ_subm™
(
$fÜm
, 
$fÜm_¡©e
) {

2156  
	`¬¿y
('keywÜds' => 
	`dru·l_ex¶ode_gs
(
$fÜm_¡©e
['values']['keywords']));

2157 
	}
}

	@/srv/http/subs/notes/www/modules/comment/comment.pages.inc

1 <?
php


16 
funùiÚ
 
	$comm’t_ed™
(
$cid
) {

17 
glob®
 
$u£r
;

19 
$comm’t
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT c.*, u.uid, u.ÇmAS„egi¡”ed_Çme, u.d©¨FROM {comm’ts} c INNER JOIN {u£rs} u ON c.uid = u.uid WHERE c.cid = %d', 
$cid
));

20 
$comm’t
 = 
	`dru·l_uÅack
($comment);

21 
$comm’t
->
Çme
 = $comm’t->
uid
 ? $comm’t->
»gi¡”ed_Çme
 : $comment->name;

22 ià(
	`comm’t_acûss
('ed™', 
$comm’t
)) {

23  
	`comm’t_fÜm_box
((
¬¿y
)
$comm’t
);

26 
	`dru·l_acûss_d’›d
();

28 
	}
}

51 
funùiÚ
 
	$comm’t_»¶y
(
$node
, 
$pid
 = 
NULL
) {

53 
	`dru·l_£t_b»adüumb
(
	`¬¿y
(
	`l
(
	`t
('Home'), 
NULL
),†(
$node
->
t™Ë
, 'node/'. $node->
nid
)));

54 
$İ
 = 
	`is£t
(
$_POST
['op']) ? $_POST['op'] : '';

56 
$ouut
 = '';

58 ià(
	`u£r_acûss
('access comments')) {

60 ià(
$İ
 =ğ
	`t
('Preview')) {

61 ià(
	`u£r_acûss
('post comments')) {

62 
$ouut
 .ğ
	`comm’t_fÜm_box
(
	`¬¿y
('pid' => 
$pid
, 'nid' => 
$node
->
nid
), 
NULL
);

65 
	`dru·l_£t_mes§ge
(
	`t
('You‡re‚ot‡uthorizedo…ost comments.'), 'error');

66 
	`dru·l_gÙo
("node/$node->nid");

71 ià(
$pid
) {

73 ià(
$comm’t
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT c.*, u.uid, u.ÇmAS„egi¡”ed_Çme, u.sigÇtu», u.sigÇtu»_fÜm©, u.piùu», u.d©¨FROM {comm’ts} c INNER JOIN {u£rs} u ON c.uid = u.uid WHERE c.cid = %d AND c.¡©u ğ%d', 
$pid
, 
COMMENT_PUBLISHED
))) {

76 ià(
$comm’t
->
nid
 !ğ
$node
->nid) {

78 
	`dru·l_£t_mes§ge
(
	`t
('The comment you‡re„eplyingo does‚otƒxist.'), 'error');

79 
	`dru·l_gÙo
("node/$node->nid");

82 
$comm’t
 = 
	`dru·l_uÅack
($comment);

83 
$comm’t
->
Çme
 = $comm’t->
uid
 ? $comm’t->
»gi¡”ed_Çme
 : $comment->name;

84 
$ouut
 .ğ
	`theme
('comm’t_v›w', 
$comm’t
, 
$node
);

87 
	`dru·l_£t_mes§ge
(
	`t
('The comment you‡re„eplyingo does‚otƒxist.'), 'error');

88 
	`dru·l_gÙo
("node/$node->nid");

92 ià(
	`u£r_acûss
('access content')) {

93 
$ouut
 .ğ
	`node_v›w
(
$node
);

97 ià(
	`node_comm’t_mode
(
$node
->
nid
è!ğ
COMMENT_NODE_READ_WRITE
) {

98 
	`dru·l_£t_mes§ge
(
	`t
("This discussion is closed: you can't…ost‚ew comments."), 'error');

99 
	`dru·l_gÙo
("node/$node->nid");

101 ià(
	`u£r_acûss
('post comments')) {

102 
$ouut
 .ğ
	`comm’t_fÜm_box
(
	`¬¿y
('pid' => 
$pid
, 'nid' => 
$node
->
nid
), 
	`t
('Reply'));

105 
	`dru·l_£t_mes§ge
(
	`t
('You‡re‚ot‡uthorizedo…ost comments.'), 'error');

106 
	`dru·l_gÙo
("node/$node->nid");

111 
	`dru·l_£t_mes§ge
(
	`t
('You‡re‚ot‡uthorizedo view comments.'), 'error');

112 
	`dru·l_gÙo
("node/$node->nid");

115  
$ouut
;

116 
	}
}

	@/srv/http/subs/notes/www/modules/comment/comment.tpl.php

1 <?
	gphp


29 <
div
 
	gşass
="comment<?php…rint ($comment->new) ? ' comment-new' : '';…rint ' '. $status ?> clear-block">

30 <?
php
 
´št
 
$piùu»
 ?>

32 <?
php
 ià(
$comm’t
->
Ãw
): ?>

33 <
¥ª
 
şass
="Ãw"><?
php
 
´št
 
$Ãw
 ?></span>

34 <?
php
 
’dif
; ?>

36 <
	gh3
><?
php
 
´št
 
	g$t™Ë
 ?></h3>

38 <
div
 
	gşass
="submitted">

39 <?
php
 
´št
 
$subm™‹d
 ?>

40 </
div
>

42 <
div
 
şass
="content">

43 <?
php
 
´št
 
$cÚ‹Á
 ?>

44 <?
php
 ià(
$sigÇtu»
): ?>

45 <
div
 
şass
="user-signature clear-block">

46 <?
php
 
´št
 
$sigÇtu»
 ?>

47 </
div
>

48 <?
php
 
’dif
; ?>

49 </
	gdiv
>

51 <?
php
 
´št
 
	g$lšks
 ?>

52 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/contact/contact.admin.inc

1 <?
php


12 
funùiÚ
 
	$cÚù_admš_ÿ‹gÜ›s
() {

13 
$»suÉ
 = 
	`db_qu”y
('SELECT cid, category,„ecipients, selected FROM {contact} ORDER BY weight, category');

14 
$rows
 = 
	`¬¿y
();

15 
$ÿ‹gÜy
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

16 
$rows
[] = 
	`¬¿y
(
	`check_¶aš
(
$ÿ‹gÜy
->
ÿ‹gÜy
), check_¶aš($ÿ‹gÜy->
»c›Ás
), ($ÿ‹gÜy->
£Ëùed
 ? 
	`t
('Yes'è:('No')), 
	`l
Ñ('ed™'), 'admš/bud/cÚù/ed™/'. $ÿ‹gÜy->
cid
),†(t('delete'), 'admin/build/contact/delete/'. $category->cid));

18 
$h—d”
 = 
	`¬¿y
(
	`t
('Category'),('Recipients'),('Selected'),‡rray('data' =>('Operations'), 'colspan' => 2));

20  
	`theme
('bË', 
$h—d”
, 
$rows
);

21 
	}
}

26 
funùiÚ
 
cÚù_admš_ed™
(
$fÜm_¡©e
 = 
¬¿y
(), 
$İ
, 
$cÚù
 = 
NULL
) {

28 ià(
em±y
(
$cÚù
è|| 
$İ
 == 'add') {

29 
$cÚù
 = 
¬¿y
(

35 'cid' => 
NULL
,

38 
	g$fÜm
['cÚù_İ'] = 
¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$İ
);

39 
	g$fÜm
['ÿ‹gÜy'] = 
¬¿y
('#type' => 'textfield',

40 '#t™Ë' => 
t
('Category'),

42 '#deçuÉ_v®ue' => 
$cÚù
['category'],

43 '#desütiÚ' => 
t
("Example: 'website feedback' or 'product information'."),

44 '#»quœed' => 
TRUE
,

46 
	g$fÜm
['»c›Ás'] = 
¬¿y
('#type' => 'textarea',

47 '#t™Ë' => 
t
('Recipients'),

48 '#deçuÉ_v®ue' => 
$cÚù
['recipients'],

49 '#desütiÚ' => 
t
("Example: 'webmaster@example.com' or 'sales@example.com,support@example.com'. To specify multiple„ecipients, separateƒachƒ-mail‡ddress with‡ comma."),

50 '#»quœed' => 
TRUE
,

52 
	g$fÜm
['»¶y'] = 
¬¿y
('#type' => 'textarea',

53 '#t™Ë' => 
t
('Auto-reply'),

54 '#deçuÉ_v®ue' => 
$cÚù
['reply'],

55 '#desütiÚ' => 
t
('Optional‡uto-reply. Leaveƒmpty if you do‚ot wanto sendhe user‡n‡uto-reply message.'),

57 
	g$fÜm
['weight'] = 
¬¿y
('#type' => 'weight',

58 '#t™Ë' => 
t
('Weight'),

59 '#deçuÉ_v®ue' => 
$cÚù
['weight'],

60 '#desütiÚ' => 
t
('When†isting categories,hose with†ighter (smaller) weights get†isted before categories with heavier (larger) weights. Categories withƒqual weights‡re sorted‡lphabetically.'),

62 
	g$fÜm
['£Ëùed'] = 
¬¿y
('#type' => 'select',

63 '#t™Ë' => 
t
('Selected'),

64 '#İtiÚs' => 
¬¿y
('0' => 
t
('No'), '1' =>('Yes')),

65 '#deçuÉ_v®ue' => 
$cÚù
['selected'],

66 '#desütiÚ' => 
t
('Sethiso <em>Yes</em> if you would†ikehis categoryo be selected by default.'),

68 
	g$fÜm
['cid'] = 
¬¿y
('#type' => 'value',

69 '#v®ue' => 
$cÚù
['cid'],

71 
	g$fÜm
['subm™'] = 
¬¿y
('#type' => 'submit',

72 '#v®ue' => 
t
('Save'),

75  
	g$fÜm
;

81 
funùiÚ
 
	$cÚù_admš_ed™_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

82 ià(
	`em±y
(
$fÜm_¡©e
['values']['category'])) {

83 
	`fÜm_£t_”rÜ
('ÿ‹gÜy', 
	`t
('You mustƒnter‡ category.'));

85 ià(
	`em±y
(
$fÜm_¡©e
['values']['recipients'])) {

86 
	`fÜm_£t_”rÜ
('»c›Ás', 
	`t
('You mustƒnter one or more„ecipients.'));

89 
$»c›Ás
 = 
	`ex¶ode
(',', 
$fÜm_¡©e
['values']['recipients']);

90 
	`fÜ—ch
 (
$»c›Ás
 
as
 
$»c›Á
) {

91 ià(!
	`v®id_ema_add»ss
(
	`Œim
(
$»c›Á
))) {

92 
	`fÜm_£t_”rÜ
('»c›Ás', 
	`t
('%»c›Á i ª inv®idƒ-ma‡dd»ss.', 
	`¬¿y
('%»c›Á' => 
$»c›Á
)));

96 
	}
}

101 
funùiÚ
 
	$cÚù_admš_ed™_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

102 ià(
$fÜm_¡©e
['values']['selected']) {

104 
	`db_qu”y
('UPDATE {contact} SET selected = 0');

106 
$»c›Ás
 = 
	`ex¶ode
(',', 
$fÜm_¡©e
['values']['recipients']);

107 
	`fÜ—ch
 (
$»c›Ás
 
as
 
$key
 => 
$»c›Á
) {

109 
$»c›Ás
[
$key
] = 
	`Œim
(
$»c›Á
);

111 
$fÜm_¡©e
['v®ues']['»c›Ás'] = 
	`im¶ode
(',', 
$»c›Ás
);

112 ià(
	`em±y
(
$fÜm_¡©e
['values']['cid']) || $form_state['values']['contact_op'] == 'add') {

113 
	`dru·l_wr™e_»cÜd
('cÚù', 
$fÜm_¡©e
['values']);

114 
	`dru·l_£t_mes§ge
(
	`t
('C©egÜy %ÿ‹gÜy ha b“Àadded.', 
	`¬¿y
('%ÿ‹gÜy' => 
$fÜm_¡©e
['values']['category'])));

115 
	`w©chdog
('ma', 'CÚù fÜm: c©egÜy %ÿ‹gÜy‡dded.', 
	`¬¿y
('%ÿ‹gÜy' => 
$fÜm_¡©e
['v®ues']['ÿ‹gÜy']), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('view'), 'admin/build/contact'));

119 
	`dru·l_wr™e_»cÜd
('cÚù', 
$fÜm_¡©e
['values'], 'cid');

120 
	`dru·l_£t_mes§ge
(
	`t
('C©egÜy %ÿ‹gÜy ha b“Àupd©ed.', 
	`¬¿y
('%ÿ‹gÜy' => 
$fÜm_¡©e
['values']['category'])));

121 
	`w©chdog
('ma', 'CÚù fÜm: c©egÜy %ÿ‹gÜy upd©ed.', 
	`¬¿y
('%ÿ‹gÜy' => 
$fÜm_¡©e
['v®ues']['ÿ‹gÜy']), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('view'), 'admin/build/contact'));

124 
$fÜm_¡©e
['redirect'] = 'admin/build/contact';

126 
	}
}

131 
funùiÚ
 
	$cÚù_admš_d–‘e
(&
$fÜm_¡©e
, 
$cÚù
) {

133 
$fÜm
['cÚù'] = 
	`¬¿y
(

135 '#v®ue' => 
$cÚù
,

138  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØd–‘%ÿ‹gÜy?', 
	`¬¿y
('%ÿ‹gÜy' => 
$cÚù
['category'])), 'admin/build/contact',('This‡ction cannot be undone.'),('Delete'),('Cancel'));

139 
	}
}

144 
funùiÚ
 
	$cÚù_admš_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

145 
$cÚù
 = 
$fÜm_¡©e
['values']['contact'];

146 
	`db_qu”y
("DELETE FROM {cÚù} WHERE cid = %d", 
$cÚù
['cid']);

147 
	`dru·l_£t_mes§ge
(
	`t
('C©egÜy %ÿ‹gÜy ha b“Àd–‘ed.', 
	`¬¿y
('%ÿ‹gÜy' => 
$cÚù
['category'])));

148 
	`w©chdog
('ma', 'CÚù fÜm: c©egÜy %ÿ‹gÜy d–‘ed.', 
	`¬¿y
('%ÿ‹gÜy' => 
$cÚù
['ÿ‹gÜy']), 
WATCHDOG_NOTICE
);

150 
$fÜm_¡©e
['redirect'] = 'admin/build/contact';

152 
	}
}

154 
funùiÚ
 
	$cÚù_admš_£‰šgs
() {

155 
$fÜm
['cÚù_fÜm_šfÜm©iÚ'] = 
	`¬¿y
('#type' => 'textarea',

156 '#t™Ë' => 
	`t
('Additional information'),

157 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('cÚù_fÜm_šfÜm©iÚ', 
	`t
('You can†eave‡ message usinghe contact form below.')),

158 '#desütiÚ' => 
	`t
('InfÜm©iÚØshow oÀth<¨h»f="@fÜm">cÚù…age</a>. Cª bªythšg from submissiÚ guid–še tØyou¸po¡®‡dd»s Ü–•hÚnumb”.', 
	`¬¿y
('@fÜm' => 
	`u¾
('contact'))),

160 
$fÜm
['cÚù_hou¾y_th»shŞd'] = 
	`¬¿y
('#type' => 'select',

161 '#t™Ë' => 
	`t
('Hourlyhreshold'),

162 '#İtiÚs' => 
	`dru·l_m­_assoc
(
	`¬¿y
(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 20, 30, 40, 50)),

163 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('contact_hourly_threshold', 3),

164 '#desütiÚ' => 
	`t
('The maximum‚umber of contact form submissions‡ user can…erform…er hour.'),

166 
$fÜm
['cÚù_deçuÉ_¡©us'] = 
	`¬¿y
(

168 '#t™Ë' => 
	`t
('Enable…ersonal contact form by default'),

169 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('contact_default_status', 1),

170 '#desütiÚ' => 
	`t
('Default status ofhe…ersonal contact form for‚ew users.'),

172  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

173 
	}
}

	@/srv/http/subs/notes/www/modules/contact/contact.module

1 <?
php


12 
funùiÚ
 
	$cÚù_h–p
(
$·th
, 
$¬g
) {

13 
$·th
) {

15 
$ouut
 = '<p>'. 
	`t
('ThcÚù moduË fac™©e communiÿtiÚ vŸƒ-ma, by‡Îowšg you¸s™e\' vis™Ü tØcÚù oÃ‡nÙh” (³rsÚ® cÚù fÜms),‡nd by…rovidšg‡ sim¶wayØdœeù mes§ge tØ¨£ˆoàadmši¡¿tÜ-defšed„ec›Á Ñh<¨h»f="@cÚù">cÚù…age</a>). W™hƒ™h” fÜm, u£r ¥ecify‡ subjeù, wr™theœ mes§ge,‡nd (İtiÚ®lyèhav¨cİy oàtheœ mes§g£ÁØtheœ owÀe-ma‡dd»ss.', 
	`¬¿y
('@cÚù' => 
	`u¾
('contact'))) .'</p>';

16 
$ouut
 .ğ'<p>'. 
	`t
("Personal contact forms‡llow userso be contacted viaƒ-mail, while keeping„ecipientƒ-mail‡ddresses…rivate. Users mayƒnable or disableheir…ersonal contact forms byƒditingheir <em>My‡ccount</em>…age. Ifƒnabled,‡ <em>Contact</em>ab†eadingoheir…ersonal contact form is‡vailable onheir user…rofile. Site‡dministrators have‡ccesso‡ll…ersonal contact forms (even ifhey have been disabled). The <em>Contact</em>ab is only visible when viewing‡nother user's…rofile (users do‚ot seeheir own <em>Contact</em>ab).") .'</p>';

17 
$ouut
 .ğ'<p>'. 
	`t
('Th<¨h»f="@cÚù">cÚù…age</a>…rovide ¨sim¶fÜm fÜ vis™Ü tØËavcomm’ts, f“dback, o¸Ùh”„eque¡s. Mes§ge ¬rou‹d by s–eùšg‡ c©egÜy from‡†i¡ oàadmši¡¿tÜ-defšed o±iÚs;ƒach c©egÜy ha ™ owÀ£ˆoàe-ma„ec›Ás. CommÚ c©egÜ› fÜ‡ busšes s™šşude, fÜƒxam¶e, "Webs™ãedback" (mes§ge ¬fÜw¬dedØweb s™admši¡¿tÜsèªd "Produù infÜm©iÚ" (mes§ge ¬fÜw¬dedØmemb” oàth§Ë d•¬tm’t). Thaùu®ƒ-ma‡dd»s£ defšed w™hš‡ c©egÜy‡»‚Ù di¥Ïyed. OÆy u£r š„Şe w™hh<em>acûs s™e-widcÚù fÜm</em>…”missiÚ may‡cûs th<¨h»f="@cÚù">cÚù…age</a>.', 
	`¬¿y
('@cÚù' => 
	`u¾
('contact'))) .'</p>';

18 
$ouut
 .ğ'<p>'. 
	`t
('A†škØyou¸s™e\' <¨h»f="@cÚù">cÚù…age</a> fromhmaš <em>Navig©iÚ</em> m’u i ü—‹d, buˆi di§bËd by deçuÉ. C»©¨sim¬†šk oÀªÙh” m’u by‡ddšg‡ m’u i‹m…oštšgØth·th "cÚù"', 
	`¬¿y
('@cÚù' => 
	`u¾
('contact'))) .'</p>';

19 
$ouut
 .ğ'<p>'. 
	`t
('Cu¡omizth<¨h»f="@cÚù">cÚù…age</a> w™h‡dd™iÚ® infÜm©iÚ (likphysiÿÈloÿtiÚ, mašg‡dd»ss,‡nd–•hÚnumb”èusšgh<¨h»f="@cÚù-£‰šgs">cÚù fÜm s‘tšg ·ge</a>. Th<¨h»f="@cÚù-£‰šgs">£‰šg ·ge</a>‡lsØ´ovide cÚfigu¿tiÚ o±iÚ fÜhmaximum‚umb” oàcÚù fÜm submissiÚ ¨u£¸may…”fÜm…” hour,‡ndhdeçuÉ stu oàu£rs\'…”sÚ® cÚù fÜms.', 
	`¬¿y
('@cÚù-£‰šgs' => 
	`u¾
('admin/build/contact/settings'), '@contact' => url('contact'))) .'</p>';

20 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@cÚù">CÚù moduË</a>.', 
	`¬¿y
('@cÚù' => 
	`u¾
('h‰p://dru·l.Üg/hªdbook/moduËs/cÚù/',‡¼ay('absŞu‹' => 
TRUE
)))) .'</p>';

21  
$ouut
;

23 
$ouut
 = '<p>'. 
	`t
('Thi ·gËt you s‘ u°<¨h»f="@fÜm">you¸s™e-widcÚù fÜm</a>. TØdØso,‡dd oÃ o¸mÜÿ‹gÜ›s. You cª‡ssocŸ‹ difã»Á„ec›Á w™hƒach c©egÜyØrou‹ƒ-ma tØdifã»Á…eİË. FÜƒxam¶e, you cª„ou‹ webs™ãedbackØthwebma¡”‡nd dœeù…roduù infÜm©iÚ„eque¡ tØth§Ë d•¬tm’t. OÀth<¨h»f="@£‰šgs">£‰šg ·ge</a>, you cª cu¡omizthšfÜm©iÚ showÀabovthcÚù fÜm. Thi ÿÀbu£fuÈtØ´ovidadd™iÚ® cÚù infÜm©iÚ such‡ you¸po¡®‡dd»s ªd–•hÚnumb”.', 
	`¬¿y
('@£‰šgs' => 
	`u¾
('admin/build/contact/settings'), '@form' => url('contact'))) .'</p>';

24 ià(!
	`moduË_exi¡s
('menu')) {

25 
$m’u_nÙe
 = 
	`t
('Thm’u i‹m cª bcu¡omized‡nd cÚfigu»d oÆy onûhm’u moduË ha b“À<¨h»f="@moduËs-·ge">’abËd</a>.', 
	`¬¿y
('@moduËs-·ge' => 
	`u¾
('admin/settings/modules')));

28 
$m’u_nÙe
 = '';

30 
$ouut
 .ğ'<p>'. 
	`t
('ThcÚù moduË‡lsØadd ¨<¨h»f="@m’u-£‰šgs">m’u i‹m</a> (di§bËd by deçuÉètØthÇvig©iÚ block.', 
	`¬¿y
('@m’u-£‰šgs' => 
	`u¾
('admš/bud/m’u'))è.' '. 
$m’u_nÙe
 .'</p>';

31  
$ouut
;

33 
	}
}

38 
funùiÚ
 
	$cÚù_³rm
() {

39  
	`¬¿y
('access site-wide contact form', 'administer site-wide contact form');

40 
	}
}

44 
funùiÚ
 
	$cÚù_m’u
() {

45 
$™ems
['admš/bud/cÚù'] = 
	`¬¿y
(

49 'acûs ¬gum’ts' => 
	`¬¿y
('administer site-wide contact form'),

52 
$™ems
['admš/bud/cÚù/li¡'] = 
	`¬¿y
(

55 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

58 
$™ems
['admš/bud/cÚù/add'] = 
	`¬¿y
(

61 '·g¬gum’ts' => 
	`¬¿y
('contact_admin_edit', 3),

62 'acûs ¬gum’ts' => 
	`¬¿y
('administer site-wide contact form'),

63 'ty³' => 
MENU_LOCAL_TASK
,

67 
$™ems
['admš/bud/cÚù/ed™/%cÚù'] = 
	`¬¿y
(

70 '·g¬gum’ts' => 
	`¬¿y
('contact_admin_edit', 3, 4),

71 'acûs ¬gum’ts' => 
	`¬¿y
('administer site-wide contact form'),

72 'ty³' => 
MENU_CALLBACK
,

75 
$™ems
['admš/bud/cÚù/d–‘e/%cÚù'] = 
	`¬¿y
(

78 '·g¬gum’ts' => 
	`¬¿y
('contact_admin_delete', 4),

79 'acûs ¬gum’ts' => 
	`¬¿y
('administer site-wide contact form'),

80 'ty³' => 
MENU_CALLBACK
,

83 
$™ems
['admš/bud/cÚù/£‰šgs'] = 
	`¬¿y
(

86 '·g¬gum’ts' => 
	`¬¿y
('contact_admin_settings'),

87 'acûs ¬gum’ts' => 
	`¬¿y
('administer site-wide contact form'),

88 'ty³' => 
MENU_LOCAL_TASK
,

92 
$™ems
['cÚù'] = 
	`¬¿y
(

95 'acûs ¬gum’ts' => 
	`¬¿y
('access site-wide contact form'),

96 'ty³' => 
MENU_SUGGESTED_ITEM
,

99 
$™ems
['u£r/%u£r/cÚù'] = 
	`¬¿y
(

102 '·g¬gum’ts' => 
	`¬¿y
(1),

103 'ty³' => 
MENU_LOCAL_TASK
,

105 'acûs ¬gum’ts' => 
	`¬¿y
(1),

109  
$™ems
;

110 
	}
}

121 
funùiÚ
 
	$_cÚù_u£r_b_acûss
(
$accouÁ
) {

122 
glob®
 
$u£r
;

125 ià(!
$u£r
->
uid
 || !
$accouÁ
->uid) {

126  
FALSE
;

130 ià(
	`u£r_acûss
('administer users')) {

131  
TRUE
;

135 ià(
$u£r
->
uid
 =ğ
$accouÁ
->uid) {

136  
FALSE
;

141 ià(
	`em±y
(
$accouÁ
->
cÚù
)) {

142  
FALSE
;

145  
TRUE
;

146 
	}
}

151 
funùiÚ
 
	$cÚù_lßd
(
$cid
) {

152 
$cÚù
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT * FROM {cÚù} WHERE cid = %d", 
$cid
));

153  
	`em±y
(
$cÚù
è? 
FALSE
 : $contact;

154 
	}
}

161 
funùiÚ
 
	$cÚù_u£r
(
$ty³
, &
$ed™
, &
$u£r
, 
$ÿ‹gÜy
 = 
NULL
) {

162 ià(
$ty³
 =ğ'fÜm' && 
$ÿ‹gÜy
 == 'account') {

163 
$fÜm
['cÚù'] = 
	`¬¿y
('#type' => 'fieldset',

164 '#t™Ë' => 
	`t
('Contact settings'),

166 '#cŞÏpsibË' => 
TRUE
,

168 
$fÜm
['cÚù']['cÚù'] = 
	`¬¿y
('#type' => 'checkbox',

169 '#t™Ë' => 
	`t
('Personal contact form'),

170 '#deçuÉ_v®ue' => !
	`em±y
(
$ed™
['cÚù']è? $ed™['cÚù'] : 
FALSE
,

171 '#desütiÚ' => 
	`t
('AÎow oth” u£r tØcÚù you byƒ-ma vŸ <¨h»f="@u¾">you¸³rsÚ® cÚù fÜm</a>. NÙth© whyou¸e-ma‡dd»s i nÙ madpubliøtØÙh” memb” oàthcommun™y,…riveged u£r such‡ s™admši¡¿tÜ ¬abËØcÚù youƒv’ iàyou choo£‚ÙØ’abËhi ã©u».', 
	`¬¿y
('@u¾' => 
	`u¾
("user/$user->uid/contact"))),

173  
$fÜm
;

175 
	`–£if
 (
$ty³
 == 'validate') {

176  
	`¬¿y
('cÚù' => 
	`is£t
(
$ed™
['cÚù']è? $ed™['cÚù'] : 
FALSE
);

178 
	`–£if
 (
$ty³
 == 'insert') {

179 
$ed™
['cÚù'] = 
	`v¬ŸbË_g‘
('contact_default_status', 1);

181 
	}
}

186 
funùiÚ
 
	$cÚù_ma
(
$key
, &
$mes§ge
, 
$·¿ms
) {

187 
$Ïnguage
 = 
$mes§ge
['language'];

188 
$key
) {

191 
$cÚù
 = 
$·¿ms
['contact'];

192 
$mes§ge
['subjeù'] .ğ
	`t
('[!ÿ‹gÜy] !subjeù', 
	`¬¿y
('!ÿ‹gÜy' => 
$cÚù
['ÿ‹gÜy'], '!subjeù' => 
$·¿ms
['subjeù']), 
$Ïnguage
->
Ïnguage
);

193 
$mes§ge
['body'][] = 
	`t
("!Çm£Á‡ mes§gusšghcÚù fÜm‡ˆ!fÜm.", 
	`¬¿y
('!Çme' => 
$·¿ms
['Çme'], '!fÜm' => 
	`u¾
(
$_GET
['q'],‡¼ay('absŞu‹' => 
TRUE
, 'Ïnguage' => 
$Ïnguage
))), $Ïnguage->
Ïnguage
);

194 
$mes§ge
['body'][] = 
$·¿ms
['message'];

197 
$cÚù
 = 
$·¿ms
['contact'];

198 
$mes§ge
['subjeù'] .ğ
	`t
('[!ÿ‹gÜy] !subjeù', 
	`¬¿y
('!ÿ‹gÜy' => 
$cÚù
['ÿ‹gÜy'], '!subjeù' => 
$·¿ms
['subjeù']), 
$Ïnguage
->
Ïnguage
);

199 
$mes§ge
['body'][] = 
$cÚù
['reply'];

203 
$u£r
 = 
$·¿ms
['user'];

204 
$accouÁ
 = 
$·¿ms
['account'];

205 
$mes§ge
['subjeù'] .ğ'['. 
	`v¬ŸbË_g‘
('s™e_Çme', 'Dru·l'è.'] '. 
$·¿ms
['subject'];

206 
$mes§ge
['body'][] = "$account->name,";

207 
$mes§ge
['body'][] = 
	`t
("!Çm(!Çme-u¾èha £Á you‡ mes§gvŸ you¸cÚù fÜm (!fÜm-u¾è© !s™e.", 
	`¬¿y
('!Çme' => 
$u£r
->
Çme
, '!Çme-u¾' => 
	`u¾
("u£r/$u£r->uid",‡¼ay('absŞu‹' => 
TRUE
, 'Ïnguage' => 
$Ïnguage
)), '!fÜm-u¾' => u¾(
$_GET
['q'],‡¼ay('absŞu‹' => TRUE, 'Ïnguage' => $Ïnguage)), '!s™e' => 
	`v¬ŸbË_g‘
('s™e_Çme', 'Dru·l')), $Ïnguage->
Ïnguage
);

208 
$mes§ge
['body'][] = 
	`t
("Iàyou dÚ'ˆwªˆtØ»ûivsuchƒ-mas, you cª chªgyou¸£‰šg © !u¾.", 
	`¬¿y
('!u¾' => 
	`u¾
("u£r/$accouÁ->uid",‡¼ay('absŞu‹' => 
TRUE
, 'Ïnguage' => 
$Ïnguage
))), $Ïnguage->
Ïnguage
);

209 
$mes§ge
['body'][] = 
	`t
('Mes§ge:', 
NULL
, 
$Ïnguage
->
Ïnguage
);

210 
$mes§ge
['body'][] = 
$·¿ms
['message'];

213 
	}
}

	@/srv/http/subs/notes/www/modules/contact/contact.pages.inc

1 <?
php


13 
funùiÚ
 
	$cÚù_s™e_·ge
() {

14 
glob®
 
$u£r
;

16 ià(!
	`æood_is_®lowed
('cÚù', 
	`v¬ŸbË_g‘
('contact_hourly_threshold', 3))) {

17 
$ouut
 = 
	`t
("You cªnÙ s’d mÜthª %numb” mes§ge ³¸hour. PËa£ry‡gaš†©”.", 
	`¬¿y
('%numb”' => 
	`v¬ŸbË_g‘
('contact_hourly_threshold', 3)));

20 
$ouut
 = 
	`dru·l_g‘_fÜm
('contact_mail_page');

23  
$ouut
;

24 
	}
}

26 
funùiÚ
 
	$cÚù_ma_·ge
() {

27 
glob®
 
$u£r
;

29 
$fÜm
 = 
$ÿ‹gÜ›s
 = 
	`¬¿y
();

31 
$»suÉ
 = 
	`db_qu”y
('SELECT cid, category, selected FROM {contact} ORDER BY weight, category');

32 
$ÿ‹gÜy
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

33 
$ÿ‹gÜ›s
[
$ÿ‹gÜy
->
cid
] = $ÿ‹gÜy->
ÿ‹gÜy
;

34 ià(
$ÿ‹gÜy
->
£Ëùed
) {

35 
$deçuÉ_ÿ‹gÜy
 = 
$ÿ‹gÜy
->
cid
;

39 ià(
	`couÁ
(
$ÿ‹gÜ›s
) > 0) {

40 
$fÜm
['#tok’'] = 
$u£r
->
uid
 ? $u£r->
Çme
 . $u£r->
ma
 : '';

41 
$fÜm
['cÚù_šfÜm©iÚ'] = 
	`¬¿y
('#v®ue' => 
	`f‹r_xss_admš
(
	`v¬ŸbË_g‘
('cÚù_fÜm_šfÜm©iÚ', 
	`t
('You can†eave‡ message usinghe contact form below.'))));

42 
$fÜm
['Çme'] = 
	`¬¿y
('#type' => 'textfield',

43 '#t™Ë' => 
	`t
('Your‚ame'),

45 '#deçuÉ_v®ue' => 
$u£r
->
uid
 ? $u£r->
Çme
 : '',

46 '#»quœed' => 
TRUE
,

48 
$fÜm
['ma'] = 
	`¬¿y
('#type' => 'textfield',

49 '#t™Ë' => 
	`t
('Yourƒ-mail‡ddress'),

51 '#deçuÉ_v®ue' => 
$u£r
->
uid
 ? $u£r->
ma
 : '',

52 '#»quœed' => 
TRUE
,

54 
$fÜm
['subjeù'] = 
	`¬¿y
('#type' => 'textfield',

55 '#t™Ë' => 
	`t
('Subject'),

57 '#»quœed' => 
TRUE
,

59 ià(
	`couÁ
(
$ÿ‹gÜ›s
) > 1) {

62 ià(!
	`is£t
(
$deçuÉ_ÿ‹gÜy
)) {

63 
$deçuÉ_ÿ‹gÜy
 = 
	`t
('- Please choose -');

64 
$ÿ‹gÜ›s
 = 
	`¬¿y
(
$deçuÉ_ÿ‹gÜy
) + $categories;

66 
$fÜm
['cid'] = 
	`¬¿y
('#type' => 'select',

67 '#t™Ë' => 
	`t
('Category'),

68 '#deçuÉ_v®ue' => 
$deçuÉ_ÿ‹gÜy
,

69 '#İtiÚs' => 
$ÿ‹gÜ›s
,

70 '#»quœed' => 
TRUE
,

75 
$ÿ‹gÜy_keys
 = 
	`¬¿y_keys
(
$ÿ‹gÜ›s
);

76 
$fÜm
['cid'] = 
	`¬¿y
('#type' => 'value',

77 '#v®ue' => 
	`¬¿y_shiá
(
$ÿ‹gÜy_keys
),

80 
$fÜm
['mes§ge'] = 
	`¬¿y
('#type' => 'textarea',

81 '#t™Ë' => 
	`t
('Message'),

82 '#»quœed' => 
TRUE
,

86 ià(
$u£r
->
uid
) {

87 
$fÜm
['cİy'] = 
	`¬¿y
('#type' => 'checkbox',

88 '#t™Ë' => 
	`t
('Send yourself‡ copy.'),

92 
$fÜm
['cİy'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
FALSE
);

94 
$fÜm
['subm™'] = 
	`¬¿y
('#type' => 'submit',

95 '#v®ue' => 
	`t
('Sendƒ-mail'),

99 
	`dru·l_£t_mes§ge
(
	`t
('ThcÚù fÜm ha nÙ b“ÀcÚfigu»d. <¨h»f="@add">Add oÃ o¸mÜÿ‹gÜ›s</a>ØthfÜm.', 
	`¬¿y
('@add' => 
	`u¾
('admin/build/contact/add'))), 'error');

101  
$fÜm
;

102 
	}
}

107 
funùiÚ
 
	$cÚù_ma_·ge_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

108 ià(!
$fÜm_¡©e
['values']['cid']) {

109 
	`fÜm_£t_”rÜ
('cid', 
	`t
('You must select‡ valid category.'));

111 ià(!
	`v®id_ema_add»ss
(
$fÜm_¡©e
['values']['mail'])) {

112 
	`fÜm_£t_”rÜ
('ma', 
	`t
('You mustƒnter‡ validƒ-mail‡ddress.'));

114 
	}
}

119 
funùiÚ
 
	$cÚù_ma_·ge_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

120 
glob®
 
$Ïnguage
;

122 
$v®ues
 = 
$fÜm_¡©e
['values'];

126 
$äom
 = 
$v®ues
['mail'];

129 
$cÚù
 = 
	`cÚù_lßd
(
$v®ues
['cid']);

130 
$v®ues
['cÚù'] = 
$cÚù
;

133 
	`dru·l_ma
('cÚù', '·ge_ma', 
$cÚù
['»c›Ás'], 
	`Ïnguage_deçuÉ
(), 
$v®ues
, 
$äom
);

136 ià(
$v®ues
['copy']) {

137 
	`dru·l_ma
('cÚù', '·ge_cİy', 
$äom
, 
$Ïnguage
, 
$v®ues
, $from);

141 ià(
$cÚù
['reply']) {

142 
	`dru·l_ma
('cÚù', '·ge_autÜ•ly', 
$äom
, 
$Ïnguage
, 
$v®ues
, 
$cÚù
['recipients']);

145 
	`æood_»gi¡”_ev’t
('contact');

146 
	`w©chdog
('ma', '%Çme-äom s’ˆªƒ-ma„eg¬dšg %ÿ‹gÜy.', 
	`¬¿y
('%Çme-äom' => 
$v®ues
['Çme'] ." [$äom]", '%ÿ‹gÜy' => 
$cÚù
['category']));

147 
	`dru·l_£t_mes§ge
(
	`t
('Your message has been sent.'));

151 
$fÜm_¡©e
['redirect'] = '';

152 
	}
}

157 
funùiÚ
 
	$cÚù_u£r_·ge
(
$accouÁ
) {

158 
glob®
 
$u£r
;

160 ià(!
	`v®id_ema_add»ss
(
$u£r
->
ma
)) {

161 
$ouut
 = 
	`t
('You‚“dØ´ovid¨v®idƒ-ma‡dd»s tØcÚù oth” u£rs. PËa£ upd©you¸<¨h»f="@u¾">u£¸šfÜm©iÚ</a>‡ndry‡gaš.', 
	`¬¿y
('@u¾' => 
	`u¾
("user/$user->uid/edit")));

163 ià(!
	`æood_is_®lowed
('cÚù', 
	`v¬ŸbË_g‘
('contact_hourly_threshold', 3))) {

164 
$ouut
 = 
	`t
('You cªnÙ cÚù mÜthª %numb” u£r ³¸hour. PËa£ry‡gaš†©”.', 
	`¬¿y
('%numb”' => 
	`v¬ŸbË_g‘
('contact_hourly_threshold', 3)));

167 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$accouÁ
->
Çme
));

168 
$ouut
 = 
	`dru·l_g‘_fÜm
('cÚù_ma_u£r', 
$accouÁ
);

171  
$ouut
;

172 
	}
}

174 
funùiÚ
 
	$cÚù_ma_u£r
(&
$fÜm_¡©e
, 
$»c›Á
) {

175 
glob®
 
$u£r
;

176 
$fÜm
['#tok’'] = 
$u£r
->
Çme
 . $u£r->
ma
;

177 
$fÜm
['»c›Á'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$»c›Á
);

178 
$fÜm
['äom'] = 
	`¬¿y
('#type' => 'item',

179 '#t™Ë' => 
	`t
('From'),

180 '#v®ue' => 
	`theme
('u£ºame', 
$u£r
è.' &É;'. 
	`check_¶aš
($u£r->
ma
) .'&gt;',

182 
$fÜm
['to'] = 
	`¬¿y
('#type' => 'item',

183 '#t™Ë' => 
	`t
('To'),

184 '#v®ue' => 
	`theme
('u£ºame', 
$»c›Á
),

186 
$fÜm
['subjeù'] = 
	`¬¿y
('#type' => 'textfield',

187 '#t™Ë' => 
	`t
('Subject'),

189 '#»quœed' => 
TRUE
,

191 
$fÜm
['mes§ge'] = 
	`¬¿y
('#type' => 'textarea',

192 '#t™Ë' => 
	`t
('Message'),

194 '#»quœed' => 
TRUE
,

196 
$fÜm
['cİy'] = 
	`¬¿y
('#type' => 'checkbox',

197 '#t™Ë' => 
	`t
('Send yourself‡ copy.'),

199 
$fÜm
['subm™'] = 
	`¬¿y
('#type' => 'submit',

200 '#v®ue' => 
	`t
('Sendƒ-mail'),

202  
$fÜm
;

203 
	}
}

208 
funùiÚ
 
	$cÚù_ma_u£r_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

209 
glob®
 
$u£r
, 
$Ïnguage
;

211 
$accouÁ
 = 
$fÜm_¡©e
['values']['recipient'];

214 
$to
 = 
$accouÁ
->
ma
;

215 
$äom
 = 
$u£r
->
ma
;

218 
$v®ues
 = 
$fÜm_¡©e
['values'];

219 
$v®ues
['accouÁ'] = 
$accouÁ
;

220 
$v®ues
['u£r'] = 
$u£r
;

223 
	`dru·l_ma
('cÚù', 'u£r_ma', 
$to
, 
	`u£r_´eã¼ed_Ïnguage
(
$accouÁ
), 
$v®ues
, 
$äom
);

226 ià(
$fÜm_¡©e
['values']['copy']) {

227 
	`dru·l_ma
('cÚù', 'u£r_cİy', 
$äom
, 
$Ïnguage
, 
$v®ues
, $from);

230 
	`æood_»gi¡”_ev’t
('contact');

231 
	`w©chdog
('ma', '%Çme-äom s’ˆ%Çme-tØªƒ-ma.', 
	`¬¿y
('%Çme-äom' => 
$u£r
->
Çme
, '%Çme-to' => 
$accouÁ
->name));

232 
	`dru·l_£t_mes§ge
(
	`t
('The message has been sent.'));

235 
$fÜm_¡©e
['redirect'] = "user/$account->uid";

236 
	}
}

	@/srv/http/subs/notes/www/modules/dblog/dblog.admin.inc

1 <?
php


15 
funùiÚ
 
	$dblog_admš_£‰šgs
() {

16 
$fÜm
['dblog_row_lim™'] = 
	`¬¿y
(

18 '#t™Ë' => 
	`t
('Discard†ogƒntries‡bovehe following„ow†imit'),

19 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('dblog_row_limit', 1000),

20 '#İtiÚs' => 
	`dru·l_m­_assoc
(
	`¬¿y
(100, 1000, 10000, 100000, 1000000)),

21 '#desütiÚ' => 
	`t
('Thmaximum‚umb” oàrow tØk“°šhd©aba£†og. Old”ƒÁr› wÈbautom©iÿÎy disÿrded. (Requœe ¨cÜ»ùly cÚfigu»d <¨h»f="@üÚ">üÚ maš‹Çnûask</a>.)', 
	`¬¿y
('@üÚ' => 
	`u¾
('admin/reports/status')))

24  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

25 
	}
}

30 
funùiÚ
 
	$dblog_ov”v›w
() {

31 
$f‹r
 = 
	`dblog_bud_f‹r_qu”y
();

32 
$rows
 = 
	`¬¿y
();

33 
$icÚs
 = 
	`¬¿y
(

34 
WATCHDOG_DEBUG
 => '',

35 
WATCHDOG_INFO
 => '',

36 
WATCHDOG_NOTICE
 => '',

37 
WATCHDOG_WARNING
 => 
	`theme
('image', 'misc/w©chdog-w¬nšg.²g', 
	`t
('warning'),('warning')),

38 
WATCHDOG_ERROR
 => 
	`theme
('image', 'misc/w©chdog-”rÜ.²g', 
	`t
('error'),('error')),

39 
WATCHDOG_CRITICAL
 => 
	`theme
('image', 'misc/w©chdog-”rÜ.²g', 
	`t
('critical'),('critical')),

40 
WATCHDOG_ALERT
 => 
	`theme
('image', 'misc/w©chdog-”rÜ.²g', 
	`t
('alert'),('alert')),

41 
WATCHDOG_EMERG
 => 
	`theme
('image', 'misc/w©chdog-”rÜ.²g', 
	`t
('emergency'),('emergency')),

43 
$şas£s
 = 
	`¬¿y
(

44 
WATCHDOG_DEBUG
 => 'dblog-debug',

45 
WATCHDOG_INFO
 => 'dblog-info',

46 
WATCHDOG_NOTICE
 => 'dblog-notice',

47 
WATCHDOG_WARNING
 => 'dblog-warning',

48 
WATCHDOG_ERROR
 => 'dblog-error',

49 
WATCHDOG_CRITICAL
 => 'dblog-critical',

50 
WATCHDOG_ALERT
 => 'dblog-alert',

51 
WATCHDOG_EMERG
 => 'dblog-emerg',

54 
$ouut
 = 
	`dru·l_g‘_fÜm
('dblog_filter_form');

56 
$h—d”
 = 
	`¬¿y
(

58 
	`¬¿y
('d©a' => 
	`t
('Type'), 'field' => 'w.type'),

59 
	`¬¿y
('d©a' => 
	`t
('Date'), 'field' => 'w.wid', 'sort' => 'desc'),

60 
	`t
('Message'),

61 
	`¬¿y
('d©a' => 
	`t
('User'), 'field' => 'u.name'),

62 
	`¬¿y
('d©a' => 
	`t
('Operations')),

65 
$sql
 = "SELECT w.wid, w.uid, w.severity, w.type, w.timestamp, w.message, w.variables, w.link, u.name FROM {watchdog} w INNER JOIN {users} u ON w.uid = u.uid";

66 
$bËsÜt
 = 
	`bËsÜt_sql
(
$h—d”
);

67 ià(!
	`em±y
(
$f‹r
['where'])) {

68 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
 ." WHERE ". 
$f‹r
['wh”e'] . 
$bËsÜt
, 50, 0, 
NULL
, $filter['args']);

71 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
 . 
$bËsÜt
, 50);

74 
$dblog
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

75 
$rows
[] = 
	`¬¿y
('data' =>

76 
	`¬¿y
(

78 
$icÚs
[
$dblog
->
£v”™y
],

79 
	`t
(
$dblog
->
ty³
),

80 
	`fÜm©_d©e
(
$dblog
->
time¡amp
, 'small'),

81 
	`l
(
	`Œunÿ‹_utf8
(
	`_dblog_fÜm©_mes§ge
(
$dblog
), 56, 
TRUE
, TRUE), 'admš/»pÜts/ev’t/'. $dblog->
wid
, 
	`¬¿y
('html' => TRUE)),

82 
	`theme
('u£ºame', 
$dblog
),

83 
$dblog
->
lšk
,

86 'şass' => "dblog-". 
	`´eg_»¶aû
('/[^a-z]/i', '-', 
$dblog
->
ty³
è.' '. 
$şas£s
[$dblog->
£v”™y
]

90 ià(!
$rows
) {

91 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No†og messages‡vailable.'), 'colspan' => 6));

94 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('id' => 'admin-dblog'));

95 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 50, 0);

97  
$ouut
;

98 
	}
}

104 
funùiÚ
 
	$dblog_tİ
(
$ty³
) {

106 
$h—d”
 = 
	`¬¿y
(

107 
	`¬¿y
('d©a' => 
	`t
('Count'), 'field' => 'count', 'sort' => 'desc'),

108 
	`¬¿y
('d©a' => 
	`t
('Message'), 'field' => 'message')

111 
$»suÉ
 = 
	`·g”_qu”y
("SELECT COUNT(widèAS couÁ, mes§ge, v¬ŸbË FROM {w©chdog} WHEREy³ = '%s' GROUP BY mes§ge, v¬ŸbË ". 
	`bËsÜt_sql
(
$h—d”
), 30, 0, "SELECT COUNT(DISTINCT(mes§ge)èFROM {w©chdog} WHEREy³ = '%s'", 
$ty³
);

113 
$rows
 = 
	`¬¿y
();

114 
$dblog
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

115 
$rows
[] = 
	`¬¿y
(
$dblog
->
couÁ
, 
	`Œunÿ‹_utf8
(
	`_dblog_fÜm©_mes§ge
($dblog), 56, 
TRUE
, TRUE));

118 ià(
	`em±y
(
$rows
)) {

119 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No†og messages‡vailable.'), 'colspan' => 2));

122 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

123 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 30, 0);

125  
$ouut
;

126 
	}
}

131 
funùiÚ
 
	$dblog_ev’t
(
$id
) {

132 
$£v”™y
 = 
	`w©chdog_£v”™y_Ëv–s
();

133 
$ouut
 = '';

134 
$»suÉ
 = 
	`db_qu”y
('SELECT w.*, u.Çme, u.uid FROM {w©chdog} w INNER JOIN {u£rs} u ON w.uid = u.uid WHERE w.wid = %d', 
$id
);

135 ià(
$dblog
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

136 
$rows
 = 
	`¬¿y
(

137 
	`¬¿y
(

138 
	`¬¿y
('d©a' => 
	`t
('Ty³'), 'h—d”' => 
TRUE
),

139 
	`t
(
$dblog
->
ty³
),

141 
	`¬¿y
(

142 
	`¬¿y
('d©a' => 
	`t
('D©e'), 'h—d”' => 
TRUE
),

143 
	`fÜm©_d©e
(
$dblog
->
time¡amp
, 'large'),

145 
	`¬¿y
(

146 
	`¬¿y
('d©a' => 
	`t
('U£r'), 'h—d”' => 
TRUE
),

147 
	`theme
('u£ºame', 
$dblog
),

149 
	`¬¿y
(

150 
	`¬¿y
('d©a' => 
	`t
('LoÿtiÚ'), 'h—d”' => 
TRUE
),

151 
	`l
(
$dblog
->
loÿtiÚ
, $dblog->location),

153 
	`¬¿y
(

154 
	`¬¿y
('d©a' => 
	`t
('Reã¼”'), 'h—d”' => 
TRUE
),

155 
	`l
(
$dblog
->
»ã»r
, $dblog->referer),

157 
	`¬¿y
(

158 
	`¬¿y
('d©a' => 
	`t
('Mes§ge'), 'h—d”' => 
TRUE
),

159 
	`_dblog_fÜm©_mes§ge
(
$dblog
),

161 
	`¬¿y
(

162 
	`¬¿y
('d©a' => 
	`t
('Sev”™y'), 'h—d”' => 
TRUE
),

163 
$£v”™y
[
$dblog
->
£v”™y
],

165 
	`¬¿y
(

166 
	`¬¿y
('d©a' => 
	`t
('Ho¡Çme'), 'h—d”' => 
TRUE
),

167 
	`check_¶aš
(
$dblog
->
ho¡Çme
),

169 
	`¬¿y
(

170 
	`¬¿y
('d©a' => 
	`t
('O³¿tiÚs'), 'h—d”' => 
TRUE
),

171 
$dblog
->
lšk
,

174 
$©Œibu‹s
 = 
	`¬¿y
('class' => 'dblog-event');

175 
$ouut
 = 
	`theme
('bË', 
	`¬¿y
(), 
$rows
, 
$©Œibu‹s
);

177  
$ouut
;

178 
	}
}

183 
funùiÚ
 
	$dblog_bud_f‹r_qu”y
() {

184 ià(
	`em±y
(
$_SESSION
['dblog_overview_filter'])) {

188 
$f‹rs
 = 
	`dblog_f‹rs
();

191 
$wh”e
 = 
$¬gs
 = 
	`¬¿y
();

192 
	`fÜ—ch
 (
$_SESSION
['dblog_ov”v›w_f‹r'] 
as
 
$key
 => 
$f‹r
) {

193 
$f‹r_wh”e
 = 
	`¬¿y
();

194 
	`fÜ—ch
 (
$f‹r
 
as
 
$v®ue
) {

195 
$f‹r_wh”e
[] = 
$f‹rs
[
$key
]['where'];

196 
$¬gs
[] = 
$v®ue
;

198 ià(!
	`em±y
(
$f‹r_wh”e
)) {

199 
$wh”e
[] = '('. 
	`im¶ode
(' OR ', 
$f‹r_wh”e
) .')';

202 
$wh”e
 = !
	`em±y
($wh”eè? 
	`im¶ode
(' AND ', $where) : '';

204  
	`¬¿y
(

205 'wh”e' => 
$wh”e
,

206 '¬gs' => 
$¬gs
,

208 
	}
}

214 
funùiÚ
 
	$dblog_f‹rs
() {

215 
$f‹rs
 = 
	`¬¿y
();

217 
	`fÜ—ch
 (
	`_dblog_g‘_mes§ge_ty³s
(è
as
 
$ty³
) {

218 
$ty³s
[
$ty³
] = $type;

221 ià(!
	`em±y
(
$ty³s
)) {

222 
$f‹rs
['ty³'] = 
	`¬¿y
(

223 't™Ë' => 
	`t
('Type'),

225 'İtiÚs' => 
$ty³s
,

229 
$f‹rs
['£v”™y'] = 
	`¬¿y
(

230 't™Ë' => 
	`t
('Severity'),

232 'İtiÚs' => 
	`w©chdog_£v”™y_Ëv–s
(),

235  
$f‹rs
;

236 
	}
}

244 
funùiÚ
 
	$_dblog_fÜm©_mes§ge
(
$dblog
) {

246 ià(
$dblog
->
v¬ŸbËs
 === 'N;') {

247  
$dblog
->
mes§ge
;

251  
	`t
(
$dblog
->
mes§ge
, 
	`un£rŸlize
($dblog->
v¬ŸbËs
));

253 
	}
}

263 
funùiÚ
 
	$dblog_f‹r_fÜm
() {

264 
$£ssiÚ
 = &
$_SESSION
['dblog_overview_filter'];

265 
$£ssiÚ
 = 
	`is_¬¿y
($£ssiÚè? $£ssiÚ : 
	`¬¿y
();

266 
$f‹rs
 = 
	`dblog_f‹rs
();

268 
$fÜm
['f‹rs'] = 
	`¬¿y
(

270 '#t™Ë' => 
	`t
('Filter†og messages'),

272 '#cŞÏpsibË' => 
TRUE
,

273 '#cŞÏp£d' => 
	`em±y
(
$£ssiÚ
),

275 
	`fÜ—ch
 (
$f‹rs
 
as
 
$key
 => 
$f‹r
) {

276 
$fÜm
['f‹rs']['¡©us'][
$key
] = 
	`¬¿y
(

277 '#t™Ë' => 
$f‹r
['title'],

279 '#muÉË' => 
TRUE
,

281 '#İtiÚs' => 
$f‹r
['options'],

283 ià(!
	`em±y
(
$£ssiÚ
[
$key
])) {

284 
$fÜm
['f‹rs']['¡©us'][
$key
]['#deçuÉ_v®ue'] = 
$£ssiÚ
[$key];

288 
$fÜm
['f‹rs']['bu‰Ús']['subm™'] = 
	`¬¿y
(

290 '#v®ue' => 
	`t
('Filter'),

292 ià(!
	`em±y
(
$£ssiÚ
)) {

293 
$fÜm
['f‹rs']['bu‰Ús']['»£t'] = 
	`¬¿y
(

295 '#v®ue' => 
	`t
('Reset')

299  
$fÜm
;

300 
	}
}

305 
funùiÚ
 
	$dblog_f‹r_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

306 ià(
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('F‹r'è&& 
	`em±y
($form_state['values']['type']) &&ƒmpty($form_state['values']['severity'])) {

307 
	`fÜm_£t_”rÜ
('ty³', 
	`t
('You must select somethingo filter by.'));

309 
	}
}

314 
funùiÚ
 
	$dblog_f‹r_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

315 
$İ
 = 
$fÜm_¡©e
['values']['op'];

316 
$f‹rs
 = 
	`dblog_f‹rs
();

317 
$İ
) {

318 
	`t
('Filter'):

319 
	`fÜ—ch
 (
$f‹rs
 
as
 
$Çme
 => 
$f‹r
) {

320 ià(
	`is£t
(
$fÜm_¡©e
['v®ues'][
$Çme
])) {

321 
$_SESSION
['dblog_ov”v›w_f‹r'][
$Çme
] = 
$fÜm_¡©e
['values'][$name];

325 
	`t
('Reset'):

326 
$_SESSION
['dblog_ov”v›w_f‹r'] = 
	`¬¿y
();

330 
	}
}

	@/srv/http/subs/notes/www/modules/dblog/dblog.module

1 <?
php


18 
funùiÚ
 
	$dblog_h–p
(
$·th
, 
$¬g
) {

19 
$·th
) {

21 
$ouut
 = '<p>'. 
	`t
('The dblog module monitors your system, capturing systemƒvents in‡†ogo be„eviewed by‡n‡uthorized individual‡t‡†aterime. This is useful for site‡dministrators who want‡ quick overview of‡ctivities onheir site. The†ogs‡lso„ecordhe sequence ofƒvents, so it can be useful for debugging siteƒrrors.') .'</p>';

22 
$ouut
 .ğ'<p>'. 
	`t
('The dblog†og is simply‡†ist of„ecordedƒvents containing usage data,…erformance data,ƒrrors, warnings‡nd operational information. Administrators should checkhe dblog„eport on‡„egular basisoƒnsureheir site is working…roperly.') .'</p>';

23 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@dblog">Dblog moduË</a>.', 
	`¬¿y
('@dblog' => 'http://drupal.org/handbook/modules/dblog/')) .'</p>';

24  
$ouut
;

26  '<p>'. 
	`t
('The dblog module monitors your website, capturing systemƒvents in‡†ogo be„eviewed by‡n‡uthorized individual‡t‡†aterime. The dblog†og is simply‡†ist of„ecordedƒvents containing usage data,…erformance data,ƒrrors, warnings‡nd operational information. It is vitalo checkhe dblog„eport on‡„egular basis‡s it is oftenhe only wayoell what is going on.') .'</p>';

28 
	}
}

33 
funùiÚ
 
	$dblog_theme
() {

34  
	`¬¿y
(

35 'dblog_f‹rs' => 
	`¬¿y
(

36 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

39 
	}
}

44 
funùiÚ
 
	$dblog_m’u
() {

45 
$™ems
['admš/£‰šgs/loggšg/dblog'] = 
	`¬¿y
(

49 '·g¬gum’ts' => 
	`¬¿y
('dblog_admin_settings'),

50 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

54 
$™ems
['admš/»pÜts/dblog'] = 
	`¬¿y
(

58 'acûs ¬gum’ts' => 
	`¬¿y
('access site„eports'),

62 
$™ems
['admš/»pÜts/·ge-nÙ-found'] = 
	`¬¿y
(

66 '·g¬gum’ts' => 
	`¬¿y
('page‚ot found'),

67 'acûs ¬gum’ts' => 
	`¬¿y
('access site„eports'),

70 
$™ems
['admš/»pÜts/acûss-d’›d'] = 
	`¬¿y
(

74 '·g¬gum’ts' => 
	`¬¿y
('access denied'),

75 'acûs ¬gum’ts' => 
	`¬¿y
('access site„eports'),

78 
$™ems
['admš/»pÜts/ev’t/%'] = 
	`¬¿y
(

81 '·g¬gum’ts' => 
	`¬¿y
(3),

82 'acûs ¬gum’ts' => 
	`¬¿y
('access site„eports'),

83 'ty³' => 
MENU_CALLBACK
,

86  
$™ems
;

87 
	}
}

89 
funùiÚ
 
	$dblog_š™
() {

90 ià(
	`¬g
(0) == 'admin' &&‡rg(1) == 'reports') {

92 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('moduË', 'dblog'è.'/dblog.css', 'moduË', '®l', 
FALSE
);

94 
	}
}

103 
funùiÚ
 
	$dblog_üÚ
() {

105 
$max
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT MAX(wid) FROM {watchdog}'));

106 
	`db_qu”y
('DELETE FROM {w©chdog} WHERE wid <ğ%d', 
$max
 - 
	`v¬ŸbË_g‘
('dblog_row_limit', 1000));

107 
	}
}

112 
funùiÚ
 
	$dblog_u£r
(
$İ
, &
$ed™
, &
$u£r
) {

113 ià(
$İ
 == 'delete') {

114 
	`db_qu”y
('UPDATE {w©chdog} SET uid = 0 WHERE uid = %d', 
$u£r
->
uid
);

116 
	}
}

118 
funùiÚ
 
	$_dblog_g‘_mes§ge_ty³s
() {

119 
$ty³s
 = 
	`¬¿y
();

121 
$»suÉ
 = 
	`db_qu”y
('SELECT DISTINCT(type) FROM {watchdog} ORDER BYype');

122 
$objeù
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

123 
$ty³s
[] = 
$objeù
->
ty³
;

126  
$ty³s
;

127 
	}
}

132 
funùiÚ
 
dblog_w©chdog
(
$log
 = 
	$¬¿y
()) {

133 
$cu¼’t_db
 = 
	`db_£t_aùive
();

134 
	`db_qu”y
("INSERT INTO {watchdog}

135 (
uid
, 
ty³
, 
mes§ge
, 
v¬ŸbËs
, 
£v”™y
, 
lšk
, 
loÿtiÚ
, 
»ã»r
, 
ho¡Çme
, 
time¡amp
)

136 
VALUES


137 (%
d
, '%s', '%s', '%s', %d, '%s', '%s', '%s', '%s', %d)",

138 
$log
['u£r']->
uid
,

139 
$log
['type'],

140 
$log
['message'],

141 
	`£rŸlize
(
$log
['variables']),

142 
$log
['severity'],

143 
$log
['link'],

144 
$log
['request_uri'],

145 
$log
['referer'],

146 
$log
['ip'],

147 
$log
['timestamp']);

149 ià(
$cu¼’t_db
) {

150 
	`db_£t_aùive
(
$cu¼’t_db
);

152 
	}
}

159 
funùiÚ
 
	$theme_dblog_f‹rs
(
$fÜm
) {

160 
$ouut
 = '';

161 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['¡©us']è
as
 
$key
) {

162 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['¡©us'][
$key
]);

164 
$ouut
 .ğ'<div id="dblog-admš-bu‰Ús">'. 
	`dru·l_»nd”
(
$fÜm
['buttons']) .'</div>';

165  
$ouut
;

166 
	}
}

	@/srv/http/subs/notes/www/modules/filter/filter.admin.inc

1 <?
php


16 
funùiÚ
 
	$f‹r_admš_ov”v›w
() {

19 
$fÜm©s
 = 
	`f‹r_fÜm©s
();

20 
$”rÜ
 = 
FALSE
;

22 
	`fÜ—ch
 (
$fÜm©s
 
as
 
$id
 => 
$fÜm©
) {

23 
$rŞes
 = 
	`¬¿y
();

24 
	`fÜ—ch
 (
	`u£r_rŞes
(è
as
 
$rid
 => 
$Çme
) {

26 ià(
	`¡r¡r
(
$fÜm©
->
rŞes
, ",$rid,")) {

27 
$rŞes
[] = 
$Çme
;

30 
$deçuÉ
 = (
$id
 =ğ
	`v¬ŸbË_g‘
('filter_default_format', 1));

31 
$İtiÚs
[
$id
] = '';

32 
$fÜm
[
$fÜm©
->
Çme
]['id'] = 
	`¬¿y
('#v®ue' => 
$id
);

33 
$fÜm
[
$fÜm©
->
Çme
]['rŞes'] = 
	`¬¿y
('#v®ue' => 
$deçuÉ
 ? 
	`t
('AÎ„Şe may u£ deçuÉ fÜm©'è: (
$rŞes
 ? 
	`im¶ode
(', ', $roles) :('No„oles may usehis format')));

34 
$fÜm
[
$fÜm©
->
Çme
]['cÚfigu»'] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('cÚfigu»'), 'admš/£‰šgs/f‹rs/'. 
$id
));

35 
$fÜm
[
$fÜm©
->
Çme
]['d–‘e'] = 
	`¬¿y
('#v®ue' => 
$deçuÉ
 ? '' : 
	`l
(
	`t
('d–‘e'), 'admš/£‰šgs/f‹rs/d–‘e/'. 
$id
));

37 
$fÜm
['deçuÉ'] = 
	`¬¿y
('#ty³' => '¿dios', '#İtiÚs' => 
$İtiÚs
, '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('filter_default_format', 1));

38 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Set default format'));

39  
$fÜm
;

40 
	}
}

42 
funùiÚ
 
	$f‹r_admš_ov”v›w_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

44 ià(
	`is_num”ic
(
$fÜm_¡©e
['values']['default'])) {

45 
	`dru·l_£t_mes§ge
(
	`t
('Default format updated.'));

46 
	`v¬ŸbË_£t
('f‹r_deçuÉ_fÜm©', 
$fÜm_¡©e
['values']['default']);

48 
	}
}

55 
funùiÚ
 
	$theme_f‹r_admš_ov”v›w
(
$fÜm
) {

56 
$rows
 = 
	`¬¿y
();

57 
	`fÜ—ch
 (
$fÜm
 
as
 
$Çme
 => 
$–em’t
) {

58 ià(
	`is£t
(
$–em’t
['rŞes']è&& 
	`is_¬¿y
($element['roles'])) {

59 
$rows
[] = 
	`¬¿y
(

60 
	`dru·l_»nd”
(
$fÜm
['deçuÉ'][
$–em’t
['id']['#value']]),

61 
	`check_¶aš
(
$Çme
),

62 
	`dru·l_»nd”
(
$–em’t
['roles']),

63 
	`dru·l_»nd”
(
$–em’t
['configure']),

64 
	`dru·l_»nd”
(
$–em’t
['delete'])

66 
	`un£t
(
$fÜm
[
$Çme
]);

69 
$h—d”
 = 
	`¬¿y
(
	`t
('Default'),('Name'),('Roles'),‡rray('data' =>('Operations'), 'colspan' => 2));

70 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

71 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

73  
$ouut
;

74 
	}
}

79 
funùiÚ
 
	$f‹r_admš_fÜm©_·ge
(
$fÜm©
 = 
NULL
) {

80 ià(!
	`is£t
(
$fÜm©
->
Çme
)) {

81 
	`dru·l_£t_t™Ë
(
	`t
("Add input format"));

82 
$fÜm©
 = (
objeù
)
	`¬¿y
('name' => '', 'roles' => '', 'format' => '');

84  
	`dru·l_g‘_fÜm
('f‹r_admš_fÜm©_fÜm', 
$fÜm©
);

85 
	}
}

94 
funùiÚ
 
	$f‹r_admš_fÜm©_fÜm
(&
$fÜm_¡©e
, 
$fÜm©
) {

95 
$deçuÉ
 = (
$fÜm©
->
fÜm©
 =ğ
	`v¬ŸbË_g‘
('filter_default_format', 1));

96 ià(
$deçuÉ
) {

97 
$h–p
 = 
	`t
('All„oles forhe default format must beƒnabled‡nd cannot be changed.');

98 
$fÜm
['deçuÉ_fÜm©'] = 
	`¬¿y
('#type' => 'hidden', '#value' => 1);

101 
$fÜm
['Çme'] = 
	`¬¿y
('#type' => 'textfield',

102 '#t™Ë' => 
	`t
('Name'),

103 '#deçuÉ_v®ue' => 
$fÜm©
->
Çme
,

104 '#desütiÚ' => 
	`t
('Specify‡ unique‚ame forhis filter format.'),

105 '#»quœed' => 
TRUE
,

109 
$fÜm
['rŞes'] = 
	`¬¿y
('#type' => 'fieldset',

110 '#t™Ë' => 
	`t
('Roles'),

111 '#desütiÚ' => 
$deçuÉ
 ? 
$h–p
 : 
	`t
('Choose which„oles may usehis filter format. Notehat„oles withhe "administer filters"…ermission can‡lways use‡llhe filter formats.'),

112 '#Œ“' => 
TRUE
,

115 
	`fÜ—ch
 (
	`u£r_rŞes
(è
as
 
$rid
 => 
$Çme
) {

116 
$checked
 = 
	`¡r¡r
(
$fÜm©
->
rŞes
, ",$rid,");

117 
$fÜm
['rŞes'][
$rid
] = 
	`¬¿y
('#type' => 'checkbox',

118 '#t™Ë' => 
$Çme
,

119 '#deçuÉ_v®ue' => (
$deçuÉ
 || 
$checked
),

121 ià(
$deçuÉ
) {

122 
$fÜm
['rŞes'][
$rid
]['#di§bËd'] = 
TRUE
;

126 
$®l
 = 
	`f‹r_li¡_®l
();

127 
$’abËd
 = 
	`f‹r_li¡_fÜm©
(
$fÜm©
->
fÜm©
);

129 
$fÜm
['f‹rs'] = 
	`¬¿y
('#type' => 'fieldset',

130 '#t™Ë' => 
	`t
('Filters'),

131 '#desütiÚ' => 
	`t
('Choosehe filtershat will be used inhis filter format.'),

132 '#Œ“' => 
TRUE
,

134 
	`fÜ—ch
 (
$®l
 
as
 
$id
 => 
$f‹r
) {

135 
$fÜm
['f‹rs'][
$id
] = 
	`¬¿y
('#type' => 'checkbox',

136 '#t™Ë' => 
$f‹r
->
Çme
,

137 '#deçuÉ_v®ue' => 
	`is£t
(
$’abËd
[
$id
]),

138 '#desütiÚ' => 
	`moduË_švoke
(
$f‹r
->
moduË
, 'f‹r', 'desütiÚ', $f‹r->
d–
),

141 ià(!
	`em±y
(
$fÜm©
->
fÜm©
)) {

142 
$fÜm
['fÜm©'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$fÜm©
->
fÜm©
);

145 
$ts
 = 
	`_f‹r_ts
(
$fÜm©
->
fÜm©
, 
FALSE
);

146 
$exŒa
 = '<p>'. 
	`l
(
	`t
('More information‡bout formatting options'), 'filter/tips') .'</p>';

147 
$tli¡
 = 
	`theme
('f‹r_ts', 
$ts
, 
FALSE
, 
$exŒa
);

148 ià(!
$tli¡
) {

149 
$tli¡
 = '<p>'. 
	`t
('No guidelines‡vailable.') .'</p>';

151 
$group
 = '<p>'. 
	`t
('These‡rehe guidelineshat users will see for…osting inhis input format. They‡re‡utomatically generated fromhe filter settings.') .'</p>';

152 
$group
 .ğ
$tli¡
;

153 
$fÜm
['ts'] = 
	`¬¿y
('#v®ue' => '<h2>'. 
	`t
('FÜm©tšg guid–šes'è.'</h2>'. 
$group
);

155 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save configuration'));

157  
$fÜm
;

158 
	}
}

163 
funùiÚ
 
	$f‹r_admš_fÜm©_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

164 ià(!
	`is£t
(
$fÜm_¡©e
['values']['format'])) {

165 
$Çme
 = 
	`Œim
(
$fÜm_¡©e
['values']['name']);

166 
$»suÉ
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT fÜm© FROM {f‹r_fÜm©s} WHERE‚ame='%s'", 
$Çme
));

167 ià(
$»suÉ
) {

168 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('F‹¸fÜm©‚ame ÃedØbunique. A fÜm©‚amed %Çm®»adyƒxi¡s.', 
	`¬¿y
('%Çme' => 
$Çme
)));

171 
	}
}

176 
funùiÚ
 
	$f‹r_admš_fÜm©_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

177 
$fÜm©
 = 
	`is£t
(
$fÜm_¡©e
['v®ues']['fÜm©']è? $fÜm_¡©e['v®ues']['fÜm©'] : 
NULL
;

178 
$cu¼’t
 = 
	`f‹r_li¡_fÜm©
(
$fÜm©
);

179 
$Çme
 = 
	`Œim
(
$fÜm_¡©e
['values']['name']);

180 
$ÿche
 = 
TRUE
;

183 ià(!
$fÜm©
) {

184 
$Ãw
 = 
TRUE
;

185 
	`db_qu”y
("INSERT INTO {f‹r_fÜm©s} (ÇmeèVALUES ('%s')", 
$Çme
);

186 
$fÜm©
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT MAX(format) AS format FROM {filter_formats}"));

187 
	`dru·l_£t_mes§ge
(
	`t
('Added iÅuˆfÜm© %fÜm©.', 
	`¬¿y
('%fÜm©' => 
$Çme
)));

190 
	`dru·l_£t_mes§ge
(
	`t
('The input format settings have been updated.'));

193 
	`db_qu”y
("DELETE FROM {f‹rs} WHERE fÜm© = %d", 
$fÜm©
);

194 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['f‹rs'] 
as
 
$id
 => 
$checked
) {

195 ià(
$checked
) {

196 
	`li¡
(
$moduË
, 
$d–
èğ
	`ex¶ode
('/', 
$id
);

198 
$weight
 = 
	`is£t
(
$cu¼’t
[
$id
]->
weight
) ? $current[$id]->weight : 10;

199 
	`db_qu”y
("INSERT INTO {f‹rs} (fÜm©, moduË, d–, weightèVALUES (%d, '%s', %d, %d)", 
$fÜm©
, 
$moduË
, 
$d–
, 
$weight
);

202 
$ÿche
 &ğ!
	`moduË_švoke
(
$moduË
, 'f‹r', 'nØÿche', 
$d–
);

209 
$rŞes
 = 
	`¬¿y
();

210 ià(
	`is£t
(
$fÜm_¡©e
['values']['roles'])) {

211 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['rŞes'] 
as
 
$id
 => 
$checked
) {

212 ià(
$checked
) {

213 
$rŞes
[] = 
$id
;

217 ià(!
	`em±y
(
$fÜm_¡©e
['values']['default_format'])) {

218 
$rŞes
 = ','. 
	`im¶ode
(',', 
	`¬¿y_keys
(
	`u£r_rŞes
())) .',';

221 
$rŞes
 = ','. 
	`im¶ode
(',', $roles) .',';

224 
	`db_qu”y
("UPDATE {f‹r_fÜm©s} SET cachğ%d,‚ame='%s',„Şe ğ'%s' WHERE fÜm© = %d", 
$ÿche
, 
$Çme
, 
$rŞes
, 
$fÜm©
);

226 
	`ÿche_ş—r_®l
(
$fÜm©
 .':', 'ÿche_f‹r', 
TRUE
);

229 
$»tuº
 = 'admin/settings/filters';

230 ià(!
	`em±y
(
$Ãw
)) {

231 
$»tuº
 .ğ'/'. 
$fÜm©
;

233 
$fÜm_¡©e
['»dœeù'] = 
$»tuº
;

235 
	}
}

243 
funùiÚ
 
	$f‹r_admš_d–‘e
() {

244 
$fÜm©
 = 
	`¬g
(4);

245 
$fÜm©
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT * FROM {filter_formats} WHERE format = %d', $format));

247 ià(
$fÜm©
) {

248 ià(
$fÜm©
->
fÜm©
 !ğ
	`v¬ŸbË_g‘
('filter_default_format', 1)) {

249 
$fÜm
['fÜm©'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$fÜm©
->
fÜm©
);

250 
$fÜm
['Çme'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$fÜm©
->
Çme
);

252  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØd–‘thšpuˆfÜm© %fÜm©?', 
	`¬¿y
('%fÜm©' => 
$fÜm©
->
Çme
)), 'admin/settings/filters',('If you have‡ny content†eft inhis input format, it will be switchedohe default input format. This‡ction cannot be undone.'),('Delete'),('Cancel'));

255 
	`dru·l_£t_mes§ge
(
	`t
('The default format cannot be deleted.'));

256 
	`dru·l_gÙo
('admin/settings/filters');

260 
	`dru·l_nÙ_found
();

262 
	}
}

267 
funùiÚ
 
	$f‹r_admš_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

268 
	`db_qu”y
("DELETE FROM {f‹r_fÜm©s} WHERE fÜm© = %d", 
$fÜm_¡©e
['values']['format']);

269 
	`db_qu”y
("DELETE FROM {f‹rs} WHERE fÜm© = %d", 
$fÜm_¡©e
['values']['format']);

271 
$deçuÉ
 = 
	`v¬ŸbË_g‘
('filter_default_format', 1);

273 
	`db_qu”y
("UPDATE {node_»visiÚs} SET fÜm© = %d WHERE fÜm© = %d", 
$deçuÉ
, 
$fÜm_¡©e
['values']['format']);

274 
	`db_qu”y
("UPDATE {comm’ts} SET fÜm© = %d WHERE fÜm© = %d", 
$deçuÉ
, 
$fÜm_¡©e
['values']['format']);

275 
	`db_qu”y
("UPDATE {boxes} SET fÜm© = %d WHERE fÜm© = %d", 
$deçuÉ
, 
$fÜm_¡©e
['values']['format']);

277 
	`ÿche_ş—r_®l
(
$fÜm_¡©e
['v®ues']['fÜm©'] .':', 'ÿche_f‹r', 
TRUE
);

278 
	`dru·l_£t_mes§ge
(
	`t
('D–‘ed iÅuˆfÜm© %fÜm©.', 
	`¬¿y
('%fÜm©' => 
$fÜm_¡©e
['values']['name'])));

280 
$fÜm_¡©e
['redirect'] = 'admin/settings/filters';

282 
	}
}

288 
funùiÚ
 
	$f‹r_admš_cÚfigu»_·ge
(
$fÜm©
) {

289 
	`dru·l_£t_t™Ë
(
	`t
("CÚfigu» %fÜm©", 
	`¬¿y
('%fÜm©' => 
$fÜm©
->
Çme
)));

290  
	`dru·l_g‘_fÜm
('f‹r_admš_cÚfigu»', 
$fÜm©
);

291 
	}
}

298 
funùiÚ
 
	$f‹r_admš_cÚfigu»
(&
$fÜm_¡©e
, 
$fÜm©
) {

299 
$li¡
 = 
	`f‹r_li¡_fÜm©
(
$fÜm©
->
fÜm©
);

300 
$fÜm
 = 
	`¬¿y
();

301 
	`fÜ—ch
 (
$li¡
 
as
 
$f‹r
) {

302 
$fÜm_moduË
 = 
	`moduË_švoke
(
$f‹r
->
moduË
, 'f‹r', '£‰šgs', $f‹r->
d–
, 
$fÜm©
->
fÜm©
);

303 ià(
	`is£t
(
$fÜm_moduË
è&& 
	`is_¬¿y
($form_module)) {

304 
$fÜm
 = 
	`¬¿y_m”ge
($fÜm, 
$fÜm_moduË
);

308 ià(!
	`em±y
(
$fÜm
)) {

309 
$fÜm
 = 
	`sy¡em_£‰šgs_fÜm
($form);

312 
$fÜm
['”rÜ'] = 
	`¬¿y
('#v®ue' => 
	`t
('No settings‡re‡vailable.'));

314 
$fÜm
['fÜm©'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$fÜm©
->
fÜm©
);

315 
$fÜm
['#submit'][] = 'filter_admin_configure_submit';

316  
$fÜm
;

317 
	}
}

322 
funùiÚ
 
	$f‹r_admš_cÚfigu»_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

323 
	`ÿche_ş—r_®l
(
$fÜm_¡©e
['v®ues']['fÜm©'] .':', 'ÿche_f‹r', 
TRUE
);

324 
	}
}

329 
funùiÚ
 
	$f‹r_admš_Üd”_·ge
(
$fÜm©
) {

330 
	`dru·l_£t_t™Ë
(
	`t
("R—¼ªg%fÜm©", 
	`¬¿y
('%fÜm©' => 
$fÜm©
->
Çme
)));

331  
	`dru·l_g‘_fÜm
('f‹r_admš_Üd”', 
$fÜm©
);

332 
	}
}

341 
funùiÚ
 
	$f‹r_admš_Üd”
(&
$fÜm_¡©e
, 
$fÜm©
 = 
NULL
) {

343 
$f‹rs
 = 
	`f‹r_li¡_fÜm©
(
$fÜm©
->
fÜm©
);

345 
$fÜm
['weights'] = 
	`¬¿y
('#Œ“' => 
TRUE
);

346 
	`fÜ—ch
 (
$f‹rs
 
as
 
$id
 => 
$f‹r
) {

347 
$fÜm
['Çmes'][
$id
] = 
	`¬¿y
('#v®ue' => 
$f‹r
->
Çme
);

348 
$fÜm
['weights'][
$id
] = 
	`¬¿y
('#ty³' => 'weight', '#deçuÉ_v®ue' => 
$f‹r
->
weight
);

350 
$fÜm
['fÜm©'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$fÜm©
->
fÜm©
);

351 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save configuration'));

353  
$fÜm
;

354 
	}
}

361 
funùiÚ
 
	$theme_f‹r_admš_Üd”
(
$fÜm
) {

362 
$h—d”
 = 
	`¬¿y
(
	`t
('Name'),('Weight'));

363 
$rows
 = 
	`¬¿y
();

364 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['Çmes']è
as
 
$id
) {

366 ià(
	`is_¬¿y
(
$fÜm
['Çmes'][
$id
])) {

367 
$fÜm
['weights'][
$id
]['#attributes']['class'] = 'filter-order-weight';

368 
$rows
[] = 
	`¬¿y
(

369 'd©a' => 
	`¬¿y
(
	`dru·l_»nd”
(
$fÜm
['Çmes'][
$id
]), drupal_render($form['weights'][$id])),

375 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('id' => 'filter-order'));

376 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

378 
	`dru·l_add_bËd¿g
('f‹r-Üd”', 'Üd”', 'siblšg', 'f‹r-Üd”-weight', 
NULL
, NULL, 
FALSE
);

380  
$ouut
;

381 
	}
}

386 
funùiÚ
 
	$f‹r_admš_Üd”_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

387 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['weights'] 
as
 
$id
 => 
$weight
) {

388 
	`li¡
(
$moduË
, 
$d–
èğ
	`ex¶ode
('/', 
$id
);

389 
	`db_qu”y
("UPDATE {f‹rs} SET weighˆğ%d WHERE fÜm© = %d AND moduË = '%s' AND d– = %d", 
$weight
, 
$fÜm_¡©e
['v®ues']['fÜm©'], 
$moduË
, 
$d–
);

391 
	`dru·l_£t_mes§ge
(
	`t
('The filter ordering has been saved.'));

393 
	`ÿche_ş—r_®l
(
$fÜm_¡©e
['v®ues']['fÜm©'] .':', 'ÿche_f‹r', 
TRUE
);

394 
	}
}

	@/srv/http/subs/notes/www/modules/filter/filter.module

1 <?
php


12 
defše
('FILTER_FORMAT_DEFAULT', 0);

14 
defše
('FILTER_HTML_STRIP', 1);

15 
defše
('FILTER_HTML_ESCAPE', 2);

20 
funùiÚ
 
	$f‹r_h–p
(
$·th
, 
$¬g
) {

21 
$·th
) {

23 
$ouut
 = '<p>'. 
	`t
("The filter module‡llows‡dministratorso configureext input formats for use on your site. An input format defineshe HTMLags, codes,‡nd other input‡llowed in both content‡nd comments,‡nd is‡ key feature in guarding‡gainst…otentially damaging input from malicious users. Two input formats included by default‡re <em>Filtered HTML</em> (which‡llows only‡n‡dministrator-approved subset of HTMLags)‡nd <em>Full HTML</em> (which‡llowshe full set of HTMLags). Additional input formats may be created by‡n‡dministrator.") .'</p>';

24 
$ouut
 .ğ'<p>'. 
	`t
('Each input format uses filterso manipulateext,‡nd most input formats‡pply several different filtersoext in‡ specific order. Each filter is designed for‡ specific…urpose,‡nd generallyƒither‡dds,„emoves orransformsƒlements within user-enteredext before it is displayed. A filter does‚ot changehe‡ctual content of‡…ost, but instead, modifies itemporarily before it is displayed. A filter may„emove unapproved HTMLags, for instance, while‡nother‡utomatically‡dds HTMLo make†inks„eferenced inext clickable.') .'</p>';

25 
$ouut
 .ğ'<p>'. 
	`t
('Users can choose betweenhe‡vailable input formats when creating orƒditing content. Administrators can configure which input formats‡re‡vailableo which user„oles,‡s well‡s choose‡ default input format.') .'</p>';

26 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@f‹r">F‹¸moduË</a>.', 
	`¬¿y
('@filter' => 'http://drupal.org/handbook/modules/filter/')) .'</p>';

27  
$ouut
;

29 
$ouut
 = '<p>'. 
	`t
('<em>Input formats</em> define‡ way of…rocessing user-suppliedext in Drupal. Each input format uses filterso manipulateext,‡nd most input formats‡pply several different filtersoext, in‡ specific order. Each filter is designedo‡ccomplish‡ specific…urpose,‡nd generallyƒither„emovesƒlements from or‡ddsƒlementsoext before it is displayed. Users can choose betweenhe‡vailable input formats when submitting content.') .'</p>';

30 
$ouut
 .ğ'<p>'. 
	`t
('Usehe†ist belowo configure which input formats‡re‡vailableo which„oles,‡s well‡s choose‡ default input format (used for imported content, forƒxample). The default format is‡lways‡vailableo users. All input formats‡re‡vailableo users in‡„ole withhe "administer filters"…ermission.') .'</p>';

31  
$ouut
;

33  '<p>'. 
	`t
('Ev”y <em>f‹r</em>…”fÜm Ú·¹icuÏ¸chªgÚhu£¸šput, fÜƒxam¶¡rpšg ouˆm®iciou HTML o¸makšg URL şickabË. Choo£ which f‹r you wªˆtØ­¶yØ‹xˆšhi špuˆfÜm©. Iàyou‚Ùiû somf‹r ¬ÿusšg cÚæiù šhouut, you cª <¨h»f="@»¬¿nge">»¬¿ngthem</a>.', 
	`¬¿y
('@»¬¿nge' => 
	`u¾
('admš/£‰šgs/f‹rs/'. 
$¬g
[3] .'/order'))) .'</p>';

35  '<p>'. 
	`t
('Iàyou cªnÙ fšdh£‰šg fÜ‡ c”š f‹r, maksu» you hav’abËd iˆÚh<¨h»f="@u¾">v›wab</a> fœ¡.', 
	`¬¿y
('@u¾' => 
	`u¾
('admš/£‰šgs/f‹rs/'. 
$¬g
[3]))) .'</p>';

37 
$ouut
 = '<p>'. 
	`t
('Because ofhe flexible filtering system, you mightƒncounter‡ situation where one filter…revents‡nother from doing its job. Forƒxample:‡ word in‡n URL gets converted into‡ glossaryerm, beforehe URL can be convertedo‡ clickable†ink. Whenhis happens,„earrangehe order ofhe filters.') .'</p>';

38 
$ouut
 .ğ'<p>'. 
	`t
("Filters‡reƒxecuted fromop-to-bottom. To changehe order ofhe filters, modifyhe values inhe <em>Weight</em> column or grab‡ drag-and-drop handle underhe <em>Name</em> column‡nd drag filterso‚ew†ocations inhe†ist. (Grab‡ handle by clicking‡nd holdinghe mouse while hovering over‡ handle icon.) Rememberhat your changes will‚ot be saved until you clickhe <em>Save configuration</em> button‡the bottom ofhe…age.") .'</p>';

39  
$ouut
;

41 
	}
}

46 
funùiÚ
 
	$f‹r_theme
() {

47  
	`¬¿y
(

48 'f‹r_admš_ov”v›w' => 
	`¬¿y
(

49 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

52 'f‹r_admš_Üd”' => 
	`¬¿y
(

53 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

56 'f‹r_ts' => 
	`¬¿y
(

57 '¬gum’ts' => 
	`¬¿y
('ts' => 
NULL
, 'lÚg' => 
FALSE
, 'extra' => ''),

60 'f‹r_ts_mÜe_šfo' => 
	`¬¿y
(

61 '¬gum’ts' => 
	`¬¿y
(),

64 
	}
}

69 
funùiÚ
 
	$f‹r_m’u
() {

70 
$™ems
['admš/£‰šgs/f‹rs'] = 
	`¬¿y
(

74 '·g¬gum’ts' => 
	`¬¿y
('filter_admin_overview'),

75 'acûs ¬gum’ts' => 
	`¬¿y
('administer filters'),

78 
$™ems
['admš/£‰šgs/f‹rs/li¡'] = 
	`¬¿y
(

80 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

82 
$™ems
['admš/£‰šgs/f‹rs/add'] = 
	`¬¿y
(

85 'acûs ¬gum’ts' => 
	`¬¿y
('administer filters'),

86 'ty³' => 
MENU_LOCAL_TASK
,

90 
$™ems
['admš/£‰šgs/f‹rs/d–‘e'] = 
	`¬¿y
(

93 '·g¬gum’ts' => 
	`¬¿y
('filter_admin_delete'),

94 'acûs ¬gum’ts' => 
	`¬¿y
('administer filters'),

95 'ty³' => 
MENU_CALLBACK
,

98 
$™ems
['f‹r/ts'] = 
	`¬¿y
(

101 'acûs ÿÎback' => 
TRUE
,

102 'ty³' => 
MENU_SUGGESTED_ITEM
,

105 
$™ems
['admš/£‰šgs/f‹rs/%f‹r_fÜm©'] = 
	`¬¿y
(

106 'ty³' => 
MENU_CALLBACK
,

108 't™Ë‡rgum’ts' => 
	`¬¿y
(3),

110 '·g¬gum’ts' => 
	`¬¿y
(3),

111 'acûs ¬gum’ts' => 
	`¬¿y
('administer filters'),

115 
$™ems
['admš/£‰šgs/f‹rs/%f‹r_fÜm©/ed™'] = 
	`¬¿y
(

117 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

121 
$™ems
['admš/£‰šgs/f‹rs/%f‹r_fÜm©/cÚfigu»'] = 
	`¬¿y
(

124 '·g¬gum’ts' => 
	`¬¿y
(3),

125 'acûs ¬gum’ts' => 
	`¬¿y
('administer filters'),

126 'ty³' => 
MENU_LOCAL_TASK
,

130 
$™ems
['admš/£‰šgs/f‹rs/%f‹r_fÜm©/Üd”'] = 
	`¬¿y
(

133 '·g¬gum’ts' => 
	`¬¿y
(3),

134 'acûs ¬gum’ts' => 
	`¬¿y
('administer filters'),

135 'ty³' => 
MENU_LOCAL_TASK
,

139  
$™ems
;

140 
	}
}

142 
funùiÚ
 
	$f‹r_fÜm©_lßd
(
$¬g
) {

143  
	`f‹r_fÜm©s
(
$¬g
);

144 
	}
}

149 
funùiÚ
 
	$f‹r_admš_fÜm©_t™Ë
(
$fÜm©
) {

150  
$fÜm©
->
Çme
;

151 
	}
}

156 
funùiÚ
 
	$f‹r_³rm
() {

157  
	`¬¿y
('administer filters');

158 
	}
}

165 
funùiÚ
 
	$f‹r_üÚ
() {

166 
	`ÿche_ş—r_®l
(
NULL
, 'cache_filter');

167 
	}
}

172 
funùiÚ
 
	$f‹r_f‹r_ts
(
$d–
, 
$fÜm©
, 
$lÚg
 = 
FALSE
) {

173 
glob®
 
$ba£_u¾
;

174 
$d–
) {

176 ià(
	`v¬ŸbË_g‘
("f‹r_html_$fÜm©", 
FILTER_HTML_STRIP
) == FILTER_HTML_STRIP) {

177 ià(
$®lowed_html
 = 
	`v¬ŸbË_g‘
("allowed_html_$format", '<a> <em> <strong> <cite> <code> <ul> <ol> <li> <dl> <dt> <dd>')) {

178 
$lÚg
) {

180  
	`t
('AÎowed HTMLags: @gs', 
	`¬¿y
('@gs' => 
$®lowed_html
));

182 
$ouut
 = '<p>'. 
	`t
('AÎowed HTMLags: @gs', 
	`¬¿y
('@gs' => 
$®lowed_html
)) .'</p>';

183 ià(!
	`v¬ŸbË_g‘
("filter_html_help_$format", 1)) {

184  
$ouut
;

187 
$ouut
 .ğ
	`t
('

188 <
p
>
This
 
s™e
 
®lows
 
HTML
 
cÚ‹Á
. 
Whe
 
Ë¬nšg
 
®l
 
of
 HTML 
may
 
ã–
 
štimid©šg
,†—ºšg 
how
 
to
 
u£
 
a
 
v”y
 
sm®l
 
numb”
 oà
the
 
mo¡
 
basic
 HTML "gs" 
is
 v”y 
—sy
. Thi 
bË
 
´ovides
 
exam¶es
 
—ch
 
g
 
th©
 i 
’abËd
 
Ú
 
this
 site.</p>

189 <
p
>
FÜ
 
mÜe
 
šfÜm©iÚ
 
£e
 
W3C
\'s <a href="http://www.w3.org/TR/html/">HTML Specifications</a> or use your favorite searchƒngineo find other siteshatƒxplain HTML.</p>');

190 
$ts
 = 
	`¬¿y
(

191 'a' => 
	`¬¿y
Ğ
	`t
('AnchÜ ¬u£dØmaklšk tØÙh”…ages.'), '<¨h»f="'. 
$ba£_u¾
 .'">'. 
	`v¬ŸbË_g‘
('site_name', 'Drupal') .'</a>'),

192 'br' => 
	`¬¿y
Ğ
	`t
('By default†ine breakags‡re‡utomatically‡dded, so usehisago‡dd‡dditional ones. Use ofhisag is different because it is‚ot used with‡n open/close…air†ike‡llhe others. Useheƒxtra " /" insideheago maintain XHTML 1.0 compatibility'),('Text with <br />line break')),

193 'p' => 
	`¬¿y
Ğ
	`t
('By default…aragraphags‡re‡utomatically‡dded, so usehisago‡dd‡dditional ones.'), '<p>'.('Paragraph one.') .'</p> <p>'.('Paragraphwo.') .'</p>'),

194 '¡rÚg' => 
	`¬¿y
Ğ
	`t
('Strong'), '<strong>'.('Strong') .'</strong>'),

195 'em' => 
	`¬¿y
Ğ
	`t
('Emphasized'), '<em>'.('Emphasized') .'</em>'),

196 'c™e' => 
	`¬¿y
Ğ
	`t
('Cited'), '<cite>'.('Cited') .'</cite>'),

197 'code' => 
	`¬¿y
Ğ
	`t
('Codedext usedo show…rogramming source code'), '<code>'.('Coded') .'</code>'),

198 'b' => 
	`¬¿y
Ğ
	`t
('Bolded'), '<b>'.('Bolded') .'</b>'),

199 'u' => 
	`¬¿y
Ğ
	`t
('Underlined'), '<u>'.('Underlined') .'</u>'),

200 'i' => 
	`¬¿y
Ğ
	`t
('Italicized'), '<i>'.('Italicized') .'</i>'),

201 'sup' => 
	`¬¿y
Ğ
	`t
('Superscripted'),('<sup>Super</sup>scripted')),

202 'sub' => 
	`¬¿y
Ğ
	`t
('Subscripted'),('<sub>Sub</sub>scripted')),

203 '´e' => 
	`¬¿y
Ğ
	`t
('Preformatted'), '<pre>'.('Preformatted') .'</pre>'),

204 'abbr' => 
	`¬¿y
Ğ
	`t
('Abbreviation'),('<abbritle="Abbreviation">Abbrev.</abbr>')),

205 'aüÚym' => 
	`¬¿y
Ğ
	`t
('Acronym'),('<acronymitle="Three-Letter Acronym">TLA</acronym>')),

206 'blockquÙe' => 
	`¬¿y
Ğ
	`t
('Block quoted'), '<blockquote>'.('Block quoted') .'</blockquote>'),

207 'q' => 
	`¬¿y
Ğ
	`t
('Quoted inline'), '<q>'.('Quoted inline') .'</q>'),

209 'bË' => 
	`¬¿y
Ğ
	`t
('Table'), '<table> <tr><th>'.('Table header') .'</th></tr> <tr><td>'.('Table cell') .'</td></tr> </table>'),

210 'Œ' => 
NULL
, 'td' => NULL, 'th' => NULL,

211 'd–' => 
	`¬¿y
Ğ
	`t
('Deleted'), '<del>'.('Deleted') .'</del>'),

212 'šs' => 
	`¬¿y
Ğ
	`t
('Inserted'), '<ins>'.('Inserted') .'</ins>'),

214 'Ş' => 
	`¬¿y
Ğ
	`t
('Ordered†ist - usehe &lt;li&gt;o beginƒach†ist item'), '<ol> <li>'.('First item') .'</li> <li>'.('Second item') .'</li> </ol>'),

215 'ul' => 
	`¬¿y
Ğ
	`t
('Unordered†ist - usehe &lt;li&gt;o beginƒach†ist item'), '<ul> <li>'.('First item') .'</li> <li>'.('Second item') .'</li> </ul>'),

216 'li' => 
NULL
,

218 'dl' => 
	`¬¿y
Ğ
	`t
('Definition†ists‡re similaro other HTML†ists. &lt;dl&gt; beginshe definition†ist, &lt;dt&gt; beginshe definitionerm‡nd &lt;dd&gt; beginshe definition description.'), '<dl> <dt>'.('Firsterm') .'</dt> <dd>'.('First definition') .'</dd> <dt>'.('Seconderm') .'</dt> <dd>'.('Second definition') .'</dd> </dl>'),

219 'dt' => 
NULL
, 'dd' => NULL,

220 'h1' => 
	`¬¿y
Ğ
	`t
('Header'), '<h1>'.('Title') .'</h1>'),

221 'h2' => 
	`¬¿y
Ğ
	`t
('Header'), '<h2>'.('Subtitle') .'</h2>'),

222 'h3' => 
	`¬¿y
Ğ
	`t
('Header'), '<h3>'.('Subtitlehree') .'</h3>'),

223 'h4' => 
	`¬¿y
Ğ
	`t
('Header'), '<h4>'.('Subtitle four') .'</h4>'),

224 'h5' => 
	`¬¿y
Ğ
	`t
('Header'), '<h5>'.('Subtitle five') .'</h5>'),

225 'h6' => 
	`¬¿y
Ğ
	`t
('Header'), '<h6>'.('Subtitle six') .'</h6>')

227 
$h—d”
 = 
	`¬¿y
(
	`t
('Tag Description'),('You Type'),('You Get'));

228 
	`´eg_m©ch_®l
('/<([a-z0-9]+)[^a-z0-9]/i', 
$®lowed_html
, 
$out
);

229 
	`fÜ—ch
 (
$out
[1] 
as
 
$g
) {

230 ià(
	`¬¿y_key_exi¡s
(
$g
, 
$ts
)) {

231 ià(
$ts
[
$g
]) {

232 
$rows
[] = 
	`¬¿y
(

233 
	`¬¿y
('d©a' => 
$ts
[
$g
][0], 'class' => 'description'),

234 
	`¬¿y
('d©a' => '<code>'. 
	`check_¶aš
(
$ts
[
$g
][1]) .'</code>', 'class' => 'type'),

235 
	`¬¿y
('d©a' => 
$ts
[
$g
][1], 'class' => 'get')

240 
$rows
[] = 
	`¬¿y
(

241 
	`¬¿y
('d©a' => 
	`t
('NØh–°´ovided fÜag %g.',‡¼ay('%g' => 
$g
)), 'class' => 'description', 'colspan' => 3),

245 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

247 
$ouut
 .ğ
	`t
('

248 <
p
>
Mo¡
 
unusu®
 
ch¬aù”s
 
ÿn
 
be
 
dœeùly
 
’‹»d
 
w™hout
 
ªy
 
´obËms
.</p>

249 <
p
>
If
 
you
 dØ
’couÁ”
 
´obËms
, 
Œy
 
usšg
 
HTML
 
ch¬aù”
 
’t™›s
. 
A
 
commÚ
 
exam¶e
 
looks
 
like
 &
amp
;amp; 
ª
 
am³r§nd
 &amp; ch¬aù”. 
FÜ
 
a
 
fuÎ
 
li¡
 
of
ƒÁ™› 
£e
 HTML\'s <a href="http://www.w3.org/TR/html4/sgml/entities.html">entities</a>…age. Some ofhe‡vailable characters include:</p>');

250 
$’t™›s
 = 
	`¬¿y
(

251 
	`¬¿y
Ğ
	`t
('Ampersand'), '&amp;'),

252 
	`¬¿y
Ğ
	`t
('Greaterhan'), '&gt;'),

253 
	`¬¿y
Ğ
	`t
('Lesshan'), '&lt;'),

254 
	`¬¿y
Ğ
	`t
('Quotation mark'), '&quot;'),

256 
$h—d”
 = 
	`¬¿y
(
	`t
('Character Description'),('You Type'),('You Get'));

257 
	`un£t
(
$rows
);

258 
	`fÜ—ch
 (
$’t™›s
 
as
 
$’t™y
) {

259 
$rows
[] = 
	`¬¿y
(

260 
	`¬¿y
('d©a' => 
$’t™y
[0], 'class' => 'description'),

261 
	`¬¿y
('d©a' => '<code>'. 
	`check_¶aš
(
$’t™y
[1]) .'</code>', 'class' => 'type'),

262 
	`¬¿y
('d©a' => 
$’t™y
[1], 'class' => 'get')

265 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

266  
$ouut
;

270  
	`t
('No HTMLags‡llowed');

276 
$lÚg
) {

278  
	`t
('Lines‡nd…aragraphs break‡utomatically.');

280  
	`t
('Lines‡nd…aragraphs‡re‡utomatically„ecognized. The &lt;br /&gt;†ine break, &lt;p&gt;…aragraph‡nd &lt;/p&gt; close…aragraphags‡re inserted‡utomatically. If…aragraphs‡re‚ot„ecognized simply‡dd‡ couple blank†ines.');

284  
	`t
('Web…age‡ddresses‡ndƒ-mail‡ddressesurn into†inks‡utomatically.');

286 
	}
}

291 
funùiÚ
 
	$f‹r_fÜm©s
(
$šdex
 = 
NULL
) {

292 
glob®
 
$u£r
;

293 
$fÜm©s
;

296 
$®l
 = 
	`u£r_acûss
('administer filters');

298 ià(!
	`is£t
(
$fÜm©s
)) {

299 
$fÜm©s
 = 
	`¬¿y
();

301 
$qu”y
 = 'SELECT * FROM {filter_formats}';

304 
$¬gs
 = 
	`¬¿y
();

305 ià(!
$®l
) {

306 
$wh”e
 = 
	`¬¿y
();

307 
	`fÜ—ch
 (
$u£r
->
rŞes
 
as
 
$rid
 => 
$rŞe
) {

308 
$wh”e
[] = "roles LIKE '%%,%d,%%'";

309 
$¬gs
[] = 
$rid
;

311 
$qu”y
 .ğ' WHERE '. 
	`im¶ode
(' OR ', 
$wh”e
) .' OR format = %d';

312 
$¬gs
[] = 
	`v¬ŸbË_g‘
('filter_default_format', 1);

315 
$»suÉ
 = 
	`db_qu”y
(
$qu”y
, 
$¬gs
);

316 
$fÜm©
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

317 
$fÜm©s
[
$fÜm©
->
fÜm©
] = $format;

320 ià(
	`is£t
(
$šdex
)) {

321  
	`is£t
(
$fÜm©s
[
$šdex
]è? $fÜm©s[$šdex] : 
FALSE
;

323  
$fÜm©s
;

324 
	}
}

329 
funùiÚ
 
	$f‹r_li¡_®l
() {

330 
$f‹rs
 = 
	`¬¿y
();

332 
	`fÜ—ch
 (
	`moduË_li¡
(è
as
 
$moduË
) {

333 
$li¡
 = 
	`moduË_švoke
(
$moduË
, 'filter', 'list');

334 ià(
	`is£t
(
$li¡
è&& 
	`is_¬¿y
($list)) {

335 
	`fÜ—ch
 (
$li¡
 
as
 
$d–
 => 
$Çme
) {

336 
$f‹rs
[
$moduË
 .'/'. 
$d–
] = (
objeù
)
	`¬¿y
('moduË' => $moduË, 'd–' => $d–, 'Çme' => 
$Çme
);

341 
	`uasÜt
(
$f‹rs
, '_filter_list_cmp');

343  
$f‹rs
;

344 
	}
}

349 
funùiÚ
 
	$_f‹r_li¡_cmp
(
$a
, 
$b
) {

350  
	`¡rcmp
(
$a
->
Çme
, 
$b
->name);

351 
	}
}

356 
funùiÚ
 
	$f‹r_»sŞve_fÜm©
(
$fÜm©
) {

357  
$fÜm©
 =ğ
FILTER_FORMAT_DEFAULT
 ? 
	`v¬ŸbË_g‘
('filter_default_format', 1) : $format;

358 
	}
}

362 
funùiÚ
 
	$f‹r_fÜm©_®lowÿche
(
$fÜm©
) {

363 
$ÿche
 = 
	`¬¿y
();

364 
$fÜm©
 = 
	`f‹r_»sŞve_fÜm©
($format);

365 ià(!
	`is£t
(
$ÿche
[
$fÜm©
])) {

366 
$ÿche
[
$fÜm©
] = 
	`db_»suÉ
(
	`db_qu”y
('SELECT cache FROM {filter_formats} WHERE format = %d', $format));

368  
$ÿche
[
$fÜm©
];

369 
	}
}

374 
funùiÚ
 
	$f‹r_li¡_fÜm©
(
$fÜm©
) {

375 
$f‹rs
 = 
	`¬¿y
();

377 ià(!
	`is£t
(
$f‹rs
[
$fÜm©
])) {

378 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {f‹rs} WHERE fÜm© = %d ORDER BY weight, moduË, d–", 
$fÜm©
);

379 ià(
	`db_afãùed_rows
(
$»suÉ
è=ğ0 && !
	`db_»suÉ
(
	`db_qu”y
("SELECT 1 FROM {f‹r_fÜm©s} WHERE fÜm© = %d", 
$fÜm©
))) {

382 
$f‹rs
[
$fÜm©
] = 
	`f‹r_li¡_fÜm©
(
	`v¬ŸbË_g‘
('filter_default_format', 1));

385 
$f‹rs
[
$fÜm©
] = 
	`¬¿y
();

386 
$f‹r
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

387 
$li¡
 = 
	`moduË_švoke
(
$f‹r
->
moduË
, 'filter', 'list');

388 ià(
	`is£t
(
$li¡
è&& 
	`is_¬¿y
($li¡è&& is£t($li¡[
$f‹r
->
d–
])) {

389 
$f‹r
->
Çme
 = 
$li¡
[$f‹r->
d–
];

390 
$f‹rs
[
$fÜm©
][
$f‹r
->
moduË
 .'/'. $f‹r->
d–
] = $filter;

396  
$f‹rs
[
$fÜm©
];

397 
	}
}

429 
funùiÚ
 
	$check_m¬kup
(
$‹xt
, 
$fÜm©
 = 
FILTER_FORMAT_DEFAULT
, 
$check
 = 
TRUE
) {

431 ià(
	`is£t
(
$‹xt
è&& (!
$check
 || 
	`f‹r_acûss
(
$fÜm©
))) {

432 
$fÜm©
 = 
	`f‹r_»sŞve_fÜm©
($format);

435 
$ÿche_id
 = 
$fÜm©
 .':'. 
	`md5
(
$‹xt
);

436 ià(
$ÿched
 = 
	`ÿche_g‘
(
$ÿche_id
, 'cache_filter')) {

437  
$ÿched
->
d©a
;

441 
$ÿche
 = 
	`f‹r_fÜm©_®lowÿche
(
$fÜm©
);

445 
$‹xt
 = 
	`¡r_»¶aû
(
	`¬¿y
("\r\n", "\r"), "\n", $text);

448 
$f‹rs
 = 
	`f‹r_li¡_fÜm©
(
$fÜm©
);

451 
	`fÜ—ch
 (
$f‹rs
 
as
 
$f‹r
) {

452 
$‹xt
 = 
	`moduË_švoke
(
$f‹r
->
moduË
, 'f‹r', '´•¬e', $f‹r->
d–
, 
$fÜm©
, $‹xt, 
$ÿche_id
);

456 
	`fÜ—ch
 (
$f‹rs
 
as
 
$f‹r
) {

457 
$‹xt
 = 
	`moduË_švoke
(
$f‹r
->
moduË
, 'f‹r', '´oûss', $f‹r->
d–
, 
$fÜm©
, $‹xt, 
$ÿche_id
);

461 ià(
$ÿche
) {

462 
	`ÿche_£t
(
$ÿche_id
, 
$‹xt
, 'ÿche_f‹r', 
	`time
() + (60 * 60 * 24));

466 
$‹xt
 = 
	`t
('n/a');

469  
$‹xt
;

470 
	}
}

490 
funùiÚ
 
f‹r_fÜm
(
$v®ue
 = 
FILTER_FORMAT_DEFAULT
, 
$weight
 = 
NULL
, 
$·»Ás
 = 
¬¿y
('format')) {

491 
$v®ue
 = 
f‹r_»sŞve_fÜm©
($value);

492 
	g$fÜm©s
 = 
f‹r_fÜm©s
();

494 
	g$exŒa
 = 
theme
('filter_tips_more_info');

496 ià(
couÁ
(
$fÜm©s
) > 1) {

497 
	g$fÜm
 = 
¬¿y
(

499 '#t™Ë' => 
t
('Input format'),

500 '#cŞÏpsibË' => 
TRUE
,

501 '#cŞÏp£d' => 
TRUE
,

502 '#weight' => 
$weight
,

503 '#–em’t_v®id©e' => 
¬¿y
('filter_form_validate'),

506 
fÜ—ch
 (
$fÜm©s
 
as
 
$fÜm©
) {

509 
	g$·»Ás_fÜ_id
 = 
¬¿y_m”ge
(
$·»Ás
, 
¬¿y
(
$fÜm©
->
fÜm©
));

510 
	g$fÜm
[
$fÜm©
->
fÜm©
] = 
¬¿y
(

512 '#t™Ë' => 
$fÜm©
->
Çme
,

513 '#deçuÉ_v®ue' => 
$v®ue
,

514 '#»tuº_v®ue' => 
$fÜm©
->
fÜm©
,

515 '#·»Ás' => 
$·»Ás
,

516 '#desütiÚ' => 
theme
('f‹r_ts', 
_f‹r_ts
(
$fÜm©
->
fÜm©
, 
FALSE
)),

517 '#id' => 
fÜm_ş—n_id
('ed™-'. 
im¶ode
('-', 
$·»Ás_fÜ_id
)),

523 
	g$fÜm©
 = 
¬¿y_shiá
(
$fÜm©s
);

524 
	g$fÜm
[
$fÜm©
->
fÜm©
] = 
¬¿y
('#ty³' => 'v®ue', '#v®ue' => $fÜm©->fÜm©, '#·»Ás' => 
$·»Ás
);

525 
	g$ts
 = 
_f‹r_ts
(
v¬ŸbË_g‘
('f‹r_deçuÉ_fÜm©', 1), 
FALSE
);

526 
	g$fÜm
['fÜm©']['guid–šes'] = 
¬¿y
(

527 '#t™Ë' => 
t
('Formatting guidelines'),

528 '#v®ue' => 
theme
('f‹r_ts', 
$ts
, 
FALSE
, 
$exŒa
),

531 
	g$fÜm
[] = 
¬¿y
('#v®ue' => 
$exŒa
);

532  
	g$fÜm
;

540 
funùiÚ
 
	$f‹r_fÜm_v®id©e
(
$fÜm
) {

541 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$key
) {

542 ià(
$fÜm
[
$key
]['#value'] == $form[$key]['#return_value']) {

546 
	`fÜm_”rÜ
(
$fÜm
, 
	`t
('An illegal choice has been detected. Please contacthe site‡dministrator.'));

547 
	`w©chdog
('fÜm', 'IÎeg® choiû %choiû iÀ%Çm–em’t.', 
	`¬¿y
('%choiû' => 
$fÜm
[
$key
]['#v®ue'], '%Çme' => 
	`em±y
($fÜm['#t™Ë']è? $fÜm['#·»Ás'][0] : $fÜm['#t™Ë']), 
WATCHDOG_ERROR
);

548 
	}
}

553 
funùiÚ
 
	$f‹r_acûss
(
$fÜm©
) {

554 
$fÜm©
 = 
	`f‹r_»sŞve_fÜm©
($format);

555 ià(
	`u£r_acûss
('admši¡” f‹rs'è|| (
$fÜm©
 =ğ
	`v¬ŸbË_g‘
('filter_default_format', 1))) {

556  
TRUE
;

559 
$fÜm©s
 = 
	`f‹r_fÜm©s
();

560  
	`is£t
(
$fÜm©s
[
$fÜm©
]);

562 
	}
}

572 
funùiÚ
 
	$_f‹r_ts
(
$fÜm©
, 
$lÚg
 = 
FALSE
) {

573 ià(
$fÜm©
 == -1) {

574 
$fÜm©s
 = 
	`f‹r_fÜm©s
();

577 
$fÜm©s
 = 
	`¬¿y
(
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT * FROM {f‹r_fÜm©s} WHERE fÜm© = %d", 
$fÜm©
)));

580 
$ts
 = 
	`¬¿y
();

582 
	`fÜ—ch
 (
$fÜm©s
 
as
 
$fÜm©
) {

583 
$f‹rs
 = 
	`f‹r_li¡_fÜm©
(
$fÜm©
->
fÜm©
);

585 
$ts
[
$fÜm©
->
Çme
] = 
	`¬¿y
();

586 
	`fÜ—ch
 (
$f‹rs
 
as
 
$id
 => 
$f‹r
) {

587 ià(
$t
 = 
	`moduË_švoke
(
$f‹r
->
moduË
, 'f‹r_ts', $f‹r->
d–
, 
$fÜm©
->
fÜm©
, 
$lÚg
)) {

588 
$ts
[
$fÜm©
->
Çme
][] = 
	`¬¿y
('t' => 
$t
, 'id' => 
$id
);

593  
$ts
;

594 
	}
}

602 
funùiÚ
 
	$theme_f‹r_ts_mÜe_šfo
() {

603  '<p>'. 
	`l
(
	`t
('More information‡bout formatting options'), 'filter/tips') .'</p>';

604 
	}
}

621 
funùiÚ
 
f‹r_f‹r
(
$İ
, 
$d–
 = 0, 
$fÜm©
 = -1, 
$‹xt
 = '') {

622 
$İ
) {

624  
¬¿y
(0 => 
t
('HTML filter'), 1 =>('Line break converter'), 2 =>('URL filter'), 3 =>('HTML corrector'));

627 
$d–
) {

629  
t
('Allows youo„estrict whether users can…ost HTML‡nd whichagso filter out. It will‡lso„emove harmful content such‡s JavaScriptƒvents, JavaScript URLs‡nd CSS styles fromhoseagshat‡re‚ot„emoved.');

631  
t
('Converts†ine breaks into HTML (i.e. &lt;br&gt;‡nd &lt;p&gt;ags).');

633  
t
('Turns web‡ndƒ-mail‡ddresses into clickable†inks.');

635  
t
('Corrects faulty‡nd chopped off HTML in…ostings.');

641 
$d–
) {

643  
_f‹r_html
(
$‹xt
, 
$fÜm©
);

645  
_f‹r_autİ
(
$‹xt
);

647  
_f‹r_u¾
(
$‹xt
, 
$fÜm©
);

649  
_f‹r_htmlcÜ»ùÜ
(
$‹xt
);

651  
$‹xt
;

655 
$d–
) {

657  
_f‹r_html_£‰šgs
(
$fÜm©
);

659  
_f‹r_u¾_£‰šgs
(
$fÜm©
);

665  
$‹xt
;

672 
funùiÚ
 
	$_f‹r_html_£‰šgs
(
$fÜm©
) {

673 
$fÜm
['f‹r_html'] = 
	`¬¿y
(

675 '#t™Ë' => 
	`t
('HTML filter'),

676 '#cŞÏpsibË' => 
TRUE
,

678 
$fÜm
['f‹r_html']["f‹r_html_$fÜm©"] = 
	`¬¿y
(

680 '#t™Ë' => 
	`t
('Filter HTMLags'),

681 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
("f‹r_html_$fÜm©", 
FILTER_HTML_STRIP
),

682 '#İtiÚs' => 
	`¬¿y
(
FILTER_HTML_STRIP
 => 
	`t
('SŒ di§Îowedags'), 
FILTER_HTML_ESCAPE
 =>('Escape‡llags')),

683 '#desütiÚ' => 
	`t
('Howo deal with HTMLags in user-contributed content. If seto "Strip disallowedags", dangerousags‡re„emoved (see below). If seto "Escapeags",‡ll HTML isƒscaped‡nd…resented‡s it wasyped.'),

685 
$fÜm
['f‹r_html']["®lowed_html_$fÜm©"] = 
	`¬¿y
(

687 '#t™Ë' => 
	`t
('Allowed HTMLags'),

688 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
("allowed_html_$format", '<a> <em> <strong> <cite> <code> <ul> <ol> <li> <dl> <dt> <dd>'),

691 '#desütiÚ' => 
	`t
('If "Strip disallowedags" is selected, optionally specifyags which should‚ot be stripped. JavaScriptƒvent‡ttributes‡re‡lways stripped.'),

693 
$fÜm
['f‹r_html']["f‹r_html_h–p_$fÜm©"] = 
	`¬¿y
(

695 '#t™Ë' => 
	`t
('Display HTML help'),

696 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
("filter_html_help_$format", 1),

697 '#desütiÚ' => 
	`t
('Ifƒnabled, Drupal will display some basic HTML help inhe†ong filterips.'),

699 
$fÜm
['f‹r_html']["f‹r_html_nofŞlow_$fÜm©"] = 
	`¬¿y
(

701 '#t™Ë' => 
	`t
('Spam†ink deterrent'),

702 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
("f‹r_html_nofŞlow_$fÜm©", 
FALSE
),

703 '#desütiÚ' => 
	`t
('Ifƒnabled, Drupal will‡dd„el="nofollow"o‡ll†inks,‡s‡ measureo„educeheƒffectiveness of spam†inks. Note:his will‡lso…revent valid†inks from being followed by searchƒngines,herefore it is†ikely mostƒffective whenƒnabled for‡nonymous users.'),

705  
$fÜm
;

706 
	}
}

711 
funùiÚ
 
	$_f‹r_html
(
$‹xt
, 
$fÜm©
) {

712 ià(
	`v¬ŸbË_g‘
("f‹r_html_$fÜm©", 
FILTER_HTML_STRIP
) == FILTER_HTML_STRIP) {

713 
$®lowed_gs
 = 
	`´eg_¥l™
('/\s+|<|>/', 
	`v¬ŸbË_g‘
("®lowed_html_$fÜm©", '<a> <em> <¡rÚg> <c™e> <code> <ul> <Ş> <li> <dl> <dt> <dd>'), -1, 
PREG_SPLIT_NO_EMPTY
);

714 
$‹xt
 = 
	`f‹r_xss
($‹xt, 
$®lowed_gs
);

717 ià(
	`v¬ŸbË_g‘
("f‹r_html_$fÜm©", 
FILTER_HTML_STRIP
è=ğ
FILTER_HTML_ESCAPE
) {

719 
$‹xt
 = 
	`check_¶aš
($text);

722 ià(
	`v¬ŸbË_g‘
("f‹r_html_nofŞlow_$fÜm©", 
FALSE
)) {

723 
$‹xt
 = 
	`´eg_»¶aû
('/<a([^>]+)>/i', '<a\\1„el="nofollow">', $text);

726  
	`Œim
(
$‹xt
);

727 
	}
}

732 
funùiÚ
 
	$_f‹r_u¾_£‰šgs
(
$fÜm©
) {

733 
$fÜm
['f‹r_u¾f‹r'] = 
	`¬¿y
(

735 '#t™Ë' => 
	`t
('URL filter'),

736 '#cŞÏpsibË' => 
TRUE
,

738 
$fÜm
['f‹r_u¾f‹r']['f‹r_u¾_Ëngth_'. 
$fÜm©
] = 
	`¬¿y
(

740 '#t™Ë' => 
	`t
('Maximum†inkext†ength'),

741 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('f‹r_u¾_Ëngth_'. 
$fÜm©
, 72),

743 '#desütiÚ' => 
	`t
('URLs†ongerhanhis‚umber of characters will beruncatedo…revent†ong stringshat break formatting. The†ink itself will be„etained; justheext…ortion ofhe†ink will beruncated.'),

745  
$fÜm
;

746 
	}
}

752 
funùiÚ
 
	$_f‹r_u¾
(
$‹xt
, 
$fÜm©
) {

754 
	`_f‹r_u¾_Œim
(
NULL
, 
	`v¬ŸbË_g‘
('f‹r_u¾_Ëngth_'. 
$fÜm©
, 72));

756 
$‹xt
 = ' '. $text .' ';

759 
$‹xt
 = 
	`´eg_»¶aû_ÿÎback
("`(<p>|<li>|<br\s*/?>|[ \n\r\t\(])((http://|https://|ftp://|mailto:|smb://|afp://|file://|gopher://|news://|ssl://|sslv2://|sslv3://|tls://|tcp://|udp://)([a-zA-Z0-9@:%_+*~#?&=.,/;-]*[a-zA-Z0-9@:%_+*~#&=/;-]))([.,?!]*?)(?=(</p>|</li>|<br\s*/?>|[ \n\r\t\)]))`i", '_filter_url_parse_full_links', $text);

762 
$‹xt
 = 
	`´eg_»¶aû
("`(<p>|<li>|<br\s*/?>|[ \n\r\t\(])([A-Za-z0-9._-]+@[A-Za-z0-9._+-]+\.[A-Za-z]{2,4})([.,?!]*?)(?=(</p>|</li>|<br\s*/?>|[ \n\r\t\)]))`i", '\1<a href="mailto:\2">\2</a>\3', $text);

765 
$‹xt
 = 
	`´eg_»¶aû_ÿÎback
("`(<p>|<li>|[ \n\r\t\(])(www\.[a-zA-Z0-9@:%_+*~#?&=.,/;-]*[a-zA-Z0-9@:%_+~#\&=/;-])([.,?!]*?)(?=(</p>|</li>|<br\s*/?>|[ \n\r\t\)]))`i", '_filter_url_parse_partial_links', $text);

766 
$‹xt
 = 
	`sub¡r
($text, 1, -1);

768  
$‹xt
;

769 
	}
}

774 
funùiÚ
 
	$_f‹r_htmlcÜ»ùÜ
(
$‹xt
) {

776 
$no_Ã¡šg
, 
$sšgË_u£
;

777 ià(!
	`is£t
(
$no_Ã¡šg
)) {

779 
$no_Ã¡šg
 = 
	`dru·l_m­_assoc
(
	`¬¿y
('li', 'p'));

782 
$sšgË_u£
 = 
	`dru·l_m­_assoc
(
	`¬¿y
('base', 'meta', 'link', 'hr', 'br', 'param', 'img', 'area', 'input', 'col', 'frame'));

786 
$‹xt
 = 
	`´eg_»¶aû
('@<(?=[^a-zA-Z!/]|$)@', '&lt;', $text);

789 
$¥l™
 = 
	`´eg_¥l™
('/<(!--.*?--|[^>]+?)>/s', 
$‹xt
, -1, 
PREG_SPLIT_DELIM_CAPTURE
);

793 
$g
 = 
çl£
;

794 
$¡ack
 = 
	`¬¿y
();

795 
$ouut
 = '';

796 
	`fÜ—ch
 (
$¥l™
 
as
 
$v®ue
) {

798 ià(
$g
) {

800 ià(
	`sub¡r
(
$v®ue
, 0, 3) == '!--') {

801 
$ouut
 .ğ'<'. 
$v®ue
 .'>';

804 
	`li¡
(
$gÇme
èğ
	`´eg_¥l™
('/\s/', 
	`¡¹Şow”
(
$v®ue
), 2);

806 ià(
$gÇme
{0} == '/') {

807 
$gÇme
 = 
	`sub¡r
($tagname, 1);

809 ià(!
	`is£t
(
$sšgË_u£
[
$gÇme
])) {

811 ià(
	`š_¬¿y
(
$gÇme
, 
$¡ack
)) {

814 
$ouut
 .ğ'</'. 
$¡ack
[0] .'>';

815 } 
	`¬¿y_shiá
(
$¡ack
è!ğ
$gÇme
);

823 ià(
	`couÁ
(
$¡ack
è&& ($¡ack[0] =ğ
$gÇme
è&& 
	`is£t
(
$no_Ã¡šg
[$stack[0]])) {

824 
$ouut
 .ğ'</'. 
	`¬¿y_shiá
(
$¡ack
) .'>';

827 ià(!
	`is£t
(
$sšgË_u£
[
$gÇme
])) {

828 
	`¬¿y_unshiá
(
$¡ack
, 
$gÇme
);

832 
$v®ue
 = 
	`¹rim
($value, ' /') .' /';

834 
$ouut
 .ğ'<'. 
$v®ue
 .'>';

840 
$ouut
 .ğ
$v®ue
;

842 
$g
 = !$tag;

845 
	`couÁ
(
$¡ack
) > 0) {

846 
$ouut
 .ğ'</'. 
	`¬¿y_shiá
(
$¡ack
) .'>';

848  
$ouut
;

849 
	}
}

854 
funùiÚ
 
	$_f‹r_u¾_·r£_fuÎ_lšks
(
$m©ch
) {

855 
$m©ch
[2] = 
	`decode_’t™›s
($match[2]);

856 
$ÿ±iÚ
 = 
	`check_¶aš
(
	`_f‹r_u¾_Œim
(
$m©ch
[2]));

857 
$m©ch
[2] = 
	`check_u¾
($match[2]);

858  
$m©ch
[1] .'<¨h»f="'. $m©ch[2] .'"™Ë="'. $m©ch[2] .'">'. 
$ÿ±iÚ
 .'</a>'. $match[5];

859 
	}
}

864 
funùiÚ
 
	$_f‹r_u¾_·r£_·¹Ÿl_lšks
(
$m©ch
) {

865 
$m©ch
[2] = 
	`decode_’t™›s
($match[2]);

866 
$ÿ±iÚ
 = 
	`check_¶aš
(
	`_f‹r_u¾_Œim
(
$m©ch
[2]));

867 
$m©ch
[2] = 
	`check_¶aš
($match[2]);

868  
$m©ch
[1] .'<¨h»f="h‰p://'. $m©ch[2] .'"™Ë="'. $m©ch[2] .'">'. 
$ÿ±iÚ
 .'</a>'. $match[3];

869 
	}
}

874 
funùiÚ
 
	$_f‹r_u¾_Œim
(
$‹xt
, 
$Ëngth
 = 
NULL
) {

875 
$_Ëngth
;

876 ià(
$Ëngth
 !=ğ
NULL
) {

877 
$_Ëngth
 = 
$Ëngth
;

881 ià(
	`¡¾’
(
$‹xt
è> 
$_Ëngth
 + 3) {

882 
$‹xt
 = 
	`sub¡r
($‹xt, 0, 
$_Ëngth
) .'...';

885  
$‹xt
;

886 
	}
}

892 
funùiÚ
 
	$_f‹r_autİ
(
$‹xt
) {

894 
$block
 = '(?:table|thead|tfoot|caption|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|form|blockquote|address|p|h[1-6]|hr)';

900 
$chunks
 = 
	`´eg_¥l™
('@(<(?:!--.*?--|/?(?:´e|süt|¡yË|objeù)[^>]*)>)@si', 
$‹xt
, -1, 
PREG_SPLIT_DELIM_CAPTURE
);

903 
$ignÜe
 = 
FALSE
;

904 
$ignÜ‘ag
 = '';

905 
$ouut
 = '';

906 
	`fÜ—ch
 (
$chunks
 
as
 
$i
 => 
$chunk
) {

907 ià(
$i
 % 2) {

909 ià(
	`sub¡r
(
$chunk
, 1, 3) == '!--') {

910 
$ouut
 .ğ
$chunk
;

914 
$İ’
 = (
$chunk
[1] != '/');

915 
	`li¡
(
$g
èğ
	`¥l™
('[ >]', 
	`sub¡r
(
$chunk
, 2 - 
$İ’
), 2);

916 ià(!
$ignÜe
) {

917 ià(
$İ’
) {

918 
$ignÜe
 = 
TRUE
;

919 
$ignÜ‘ag
 = 
$g
;

923 ià(!
$İ’
 && 
$ignÜ‘ag
 =ğ
$g
) {

924 
$ignÜe
 = 
FALSE
;

925 
$ignÜ‘ag
 = '';

929 ià(!
$ignÜe
) {

930 
$chunk
 = 
	`´eg_»¶aû
('|\n*$|', '', $chunk) ."\n\n";

931 
$chunk
 = 
	`´eg_»¶aû
('|<br />\s*<br />|', "\n\n", $chunk);

932 
$chunk
 = 
	`´eg_»¶aû
('!(<'. 
$block
 .'[^>]*>)!', "\n$1", $chunk);

933 
$chunk
 = 
	`´eg_»¶aû
('!(</'. 
$block
 .'>)!', "$1\n\n", $chunk);

934 
$chunk
 = 
	`´eg_»¶aû
("/\n\n+/", "\n\n", $chunk);

935 
$chunk
 = 
	`´eg_»¶aû
('/^\n|\n\s*\n$/', '', $chunk);

936 
$chunk
 = '<p>'. 
	`´eg_»¶aû
('/\n\s*\n\n?(.)/', "</p>\n<p>$1", $chunk) ."</p>\n";

937 
$chunk
 = 
	`´eg_»¶aû
("|<p>(<li.+?)</p>|", "$1", $chunk);

938 
$chunk
 = 
	`´eg_»¶aû
('|<p><blockquote([^>]*)>|i', "<blockquote$1><p>", $chunk);

939 
$chunk
 = 
	`¡r_»¶aû
('</blockquote></p>', '</p></blockquote>', $chunk);

940 
$chunk
 = 
	`´eg_»¶aû
('|<p>\s*</p>\n?|', '', $chunk);

941 
$chunk
 = 
	`´eg_»¶aû
('!<p>\s*(</?'. 
$block
 .'[^>]*>)!', "$1", $chunk);

942 
$chunk
 = 
	`´eg_»¶aû
('!(</?'. 
$block
 .'[^>]*>)\s*</p>!', "$1", $chunk);

943 
$chunk
 = 
	`´eg_»¶aû
('|(?<!<br />)\s*\n|', "<br />\n", $chunk);

944 
$chunk
 = 
	`´eg_»¶aû
('!(</?'. 
$block
 .'[^>]*>)\s*<br />!', "$1", $chunk);

945 
$chunk
 = 
	`´eg_»¶aû
('!<br />(\s*</?(?:p|li|div|th|pre|td|ul|ol)>)!', '$1', $chunk);

946 
$chunk
 = 
	`´eg_»¶aû
('/&([^#])(?![A-Za-z0-9]{1,8};)/', '&amp;$1', $chunk);

948 
$ouut
 .ğ
$chunk
;

950  
$ouut
;

951 
	}
}

963 
funùiÚ
 
	$f‹r_xss_admš
(
$¡ršg
) {

964  
	`f‹r_xss
(
$¡ršg
, 
	`¬¿y
('a', 'abbr', 'acronym', 'address', 'b', 'bdo', 'big', 'blockquote', 'br', 'caption', 'cite', 'code', 'col', 'colgroup', 'dd', 'del', 'dfn', 'div', 'dl', 'dt', 'em', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'img', 'ins', 'kbd', 'li', 'ol', 'p', 'pre', 'q', 'samp', 'small', 'span', 'strong', 'sub', 'sup', 'table', 'tbody', 'td', 'tfoot', 'th', 'thead', 'tr', 'tt', 'ul', 'var'));

965 
	}
}

993 
funùiÚ
 
f‹r_xss
(
$¡ršg
, 
$®lowed_gs
 = 
¬¿y
('a', 'em', 'strong', 'cite', 'code', 'ul', 'ol', 'li', 'dl', 'dt', 'dd')) {

996 ià(!
dru·l_v®id©e_utf8
(
$¡ršg
)) {

1000 
_f‹r_xss_¥l™
(
$®lowed_gs
, 
TRUE
);

1002 
	g$¡ršg
 = 
¡r_»¶aû
(
chr
(0), '', 
$¡ršg
);

1004 
	g$¡ršg
 = 
´eg_»¶aû
('%&\s*\{[^}]*(\}\s*;?|$)%', '', 
$¡ršg
);

1007 
	g$¡ršg
 = 
¡r_»¶aû
('&', '&amp;', 
$¡ršg
);

1010 
	g$¡ršg
 = 
´eg_»¶aû
('/&amp;#([0-9]+;)/', '&#\1', 
$¡ršg
);

1012 
	g$¡ršg
 = 
´eg_»¶aû
('/&amp;#[Xx]0*((?:[0-9A-Fa-f]{2})+;)/', '&#x\1', 
$¡ršg
);

1014 
	g$¡ršg
 = 
´eg_»¶aû
('/&amp;([A-Za-z][A-Za-z0-9]*;)/', '&\1', 
$¡ršg
);

1016  
´eg_»¶aû_ÿÎback
('%

1018 <(?=[^
a
-
zA
-
Z
!/]è#¨
lÚe
 <

1020 <!--.*?--> #¨
comm’t


1022 <[^>]*(>|
$
è#¨
¡ršg
 
th©
 
¡¬ts
 
w™h
 
a
 <, 
up
 
uÁ
 
the
 > 
Ü
h
’d
 
of
he string

1024 > #ju¡ 
a
 >

1025 )%
x
', '
_f‹r_xss_¥l™
', $string);

1041 
funùiÚ
 
	$_f‹r_xss_¥l™
(
$m
, 
$¡Üe
 = 
FALSE
) {

1042 
$®lowed_html
;

1044 ià(
$¡Üe
) {

1045 
$®lowed_html
 = 
	`¬¿y_æ
(
$m
);

1049 
$¡ršg
 = 
$m
[1];

1051 ià(
	`sub¡r
(
$¡ršg
, 0, 1) != '<') {

1055 ià(
	`¡¾’
(
$¡ršg
) == 1) {

1060 ià(!
	`´eg_m©ch
('%^(?:<\s*(/\s*)?([a-zA-Z0-9]+)([^>]*)>?|(<!--.*?-->))$%', 
$¡ršg
, 
$m©ches
)) {

1065 
$¦ash
 = 
	`Œim
(
$m©ches
[1]);

1066 
$–em
 = &
$m©ches
[2];

1067 
$©Œli¡
 = &
$m©ches
[3];

1068 
$comm’t
 = &
$m©ches
[4];

1070 ià(
$comm’t
) {

1071 
$–em
 = '!--';

1074 ià(!
	`is£t
(
$®lowed_html
[
	`¡¹Şow”
(
$–em
)])) {

1079 ià(
$comm’t
) {

1080  
$comm’t
;

1083 ià(
$¦ash
 != '') {

1089 
$xhtml_¦ash
 = 
	`´eg_m©ch
('%\s?/\s*$%', 
$©Œli¡
) ? ' /' : '';

1090 
$©Œli¡
 = 
	`´eg_»¶aû
('%(\s?)/\s*$%', '\1', $attrlist);

1093 
$©Œ2
 = 
	`im¶ode
(' ', 
	`_f‹r_xss_©Œibu‹s
(
$©Œli¡
));

1094 
$©Œ2
 = 
	`´eg_»¶aû
('/[<>]/', '', $attr2);

1095 
$©Œ2
 = 
	`¡¾’
($attr2) ? ' '. $attr2 : '';

1098 
	}
}

1106 
funùiÚ
 
	$_f‹r_xss_©Œibu‹s
(
$©Œ
) {

1107 
$©Œ¬r
 = 
	`¬¿y
();

1108 
$mode
 = 0;

1109 
$©ŒÇme
 = '';

1111 
	`¡¾’
(
$©Œ
) != 0) {

1113 
$wÜkšg
 = 0;

1115 
$mode
) {

1118 ià(
	`´eg_m©ch
('/^([-a-zA-Z]+)/', 
$©Œ
, 
$m©ch
)) {

1119 
$©ŒÇme
 = 
	`¡¹Şow”
(
$m©ch
[1]);

1120 
$sk
 = (
$©ŒÇme
 =ğ'¡yË' || 
	`sub¡r
($attrname, 0, 2) == 'on');

1121 
$wÜkšg
 = 
$mode
 = 1;

1122 
$©Œ
 = 
	`´eg_»¶aû
('/^[-a-zA-Z]+/', '', $attr);

1129 ià(
	`´eg_m©ch
('/^\s*=\s*/', 
$©Œ
)) {

1130 
$wÜkšg
 = 1; 
$mode
 = 2;

1131 
$©Œ
 = 
	`´eg_»¶aû
('/^\s*=\s*/', '', $attr);

1135 ià(
	`´eg_m©ch
('/^\s+/', 
$©Œ
)) {

1136 
$wÜkšg
 = 1; 
$mode
 = 0;

1137 ià(!
$sk
) {

1138 
$©Œ¬r
[] = 
$©ŒÇme
;

1140 
$©Œ
 = 
	`´eg_»¶aû
('/^\s+/', '', $attr);

1147 ià(
	`´eg_m©ch
('/^"([^"]*)"(\s+|$)/', 
$©Œ
, 
$m©ch
)) {

1148 
$thisv®
 = 
	`f‹r_xss_bad_´ÙocŞ
(
$m©ch
[1]);

1150 ià(!
$sk
) {

1151 
$©Œ¬r
[] = "$attrname=\"$thisval\"";

1153 
$wÜkšg
 = 1;

1154 
$mode
 = 0;

1155 
$©Œ
 = 
	`´eg_»¶aû
('/^"[^"]*"(\s+|$)/', '', $attr);

1159 ià(
	`´eg_m©ch
("/^'([^']*)'(\s+|$)/", 
$©Œ
, 
$m©ch
)) {

1160 
$thisv®
 = 
	`f‹r_xss_bad_´ÙocŞ
(
$m©ch
[1]);

1162 ià(!
$sk
) {

1163 
$©Œ¬r
[] = "$attrname='$thisval'";;

1165 
$wÜkšg
 = 1; 
$mode
 = 0;

1166 
$©Œ
 = 
	`´eg_»¶aû
("/^'[^']*'(\s+|$)/", '', $attr);

1170 ià(
	`´eg_m©ch
("%^([^\s\"']+)(\s+|$)%", 
$©Œ
, 
$m©ch
)) {

1171 
$thisv®
 = 
	`f‹r_xss_bad_´ÙocŞ
(
$m©ch
[1]);

1173 ià(!
$sk
) {

1174 
$©Œ¬r
[] = "$attrname=\"$thisval\"";

1176 
$wÜkšg
 = 1; 
$mode
 = 0;

1177 
$©Œ
 = 
	`´eg_»¶aû
("%^[^\s\"']+(\s+|$)%", '', $attr);

1183 ià(
$wÜkšg
 == 0) {

1185 
$©Œ
 = 
	`´eg_»¶aû
('/

1192 \
S
 #- 
a
 
nÚ
-
wh™e¥aû
 
ch¬aù”


1193 )* #ªy 
numb”
 
of
 
the
 
above
 
th»e


1194 \
s
* #ªy 
numb”
 
of
 
wh™e¥aûs


1195 /
x
', '', $attr);

1196 
$mode
 = 0;

1201 ià(
$mode
 == 1) {

1202 
$©Œ¬r
[] = 
$©ŒÇme
;

1204  
$©Œ¬r
;

1205 
	}
}

1219 
funùiÚ
 
	$f‹r_xss_bad_´ÙocŞ
(
$¡ršg
, 
$decode
 = 
TRUE
) {

1220 
$®lowed_´ÙocŞs
;

1221 ià(!
	`is£t
(
$®lowed_´ÙocŞs
)) {

1222 
$®lowed_´ÙocŞs
 = 
	`¬¿y_æ
(
	`v¬ŸbË_g‘
('f‹r_®lowed_´ÙocŞs', 
	`¬¿y
('http', 'https', 'ftp', 'news', 'nntp', 'telnet', 'mailto', 'irc', 'ssh', 'sftp', 'webcal', 'rtsp')));

1226 ià(
$decode
) {

1227 
$¡ršg
 = 
	`decode_’t™›s
($string);

1233 
$befÜe
 = 
$¡ršg
;

1234 
$cŞÚpos
 = 
	`¡½os
(
$¡ršg
, ':');

1235 ià(
$cŞÚpos
 > 0) {

1237 
$´ÙocŞ
 = 
	`sub¡r
(
$¡ršg
, 0, 
$cŞÚpos
);

1241 ià(
	`´eg_m©ch
('![/?#]!', 
$´ÙocŞ
)) {

1246 ià(!
	`is£t
(
$®lowed_´ÙocŞs
[
	`¡¹Şow”
(
$´ÙocŞ
)])) {

1247 
$¡ršg
 = 
	`sub¡r
($¡ršg, 
$cŞÚpos
 + 1);

1250 } 
$befÜe
 !ğ
$¡ršg
);

1251  
	`check_¶aš
(
$¡ršg
);

1252 
	}
}

	@/srv/http/subs/notes/www/modules/filter/filter.pages.inc

1 <?
php


13 
funùiÚ
 
	$f‹r_ts_lÚg
() {

14 
$fÜm©
 = 
	`¬g
(2);

15 ià(
$fÜm©
) {

16 
$ouut
 = 
	`theme
('f‹r_ts', 
	`_f‹r_ts
(
$fÜm©
, 
TRUE
), TRUE);

19 
$ouut
 = 
	`theme
('f‹r_ts', 
	`_f‹r_ts
(-1, 
TRUE
), TRUE);

21  
$ouut
;

22 
	}
}

30 
funùiÚ
 
theme_f‹r_ts
(
$ts
, 
$lÚg
 = 
FALSE
, 
$exŒa
 = '') {

31 
$ouut
 = '';

33 
	g$muÉË
 = 
couÁ
(
$ts
) > 1;

34 ià(
	g$muÉË
) {

35 
	g$ouut
 = 
t
('input formats') .':';

38 ià(
couÁ
(
$ts
)) {

39 ià(
	g$muÉË
) {

40 
	g$ouut
 .= '<ul>';

42 
fÜ—ch
 (
$ts
 
as
 
$Çme
 => 
$tli¡
) {

43 ià(
$muÉË
) {

44 
$ouut
 .= '<li>';

45 
	g$ouut
 .ğ'<¡rÚg>'. 
$Çme
 .'</strong>:<br />';

48 ià(
couÁ
(
$tli¡
) > 0) {

49 
	g$ouut
 .= '<ul class="tips">';

50 
fÜ—ch
 (
$tli¡
 
as
 
$t
) {

51 
	g$ouut
 .ğ'<li'. (
$lÚg
 ? ' id="f‹r-'. 
¡r_»¶aû
("/", "-", 
$t
['id']) .'">' : '>') . $tip['tip'] .'</li>';

53 
	g$ouut
 .= '</ul>';

56 ià(
	g$muÉË
) {

57 
	g$ouut
 .= '</li>';

60 ià(
	g$muÉË
) {

61 
	g$ouut
 .= '</ul>';

65  
	g$ouut
;

	@/srv/http/subs/notes/www/modules/forum/forum-icon.tpl.php

1 <?
	gphp


17 <?
php
 ià(
	g$Ãw_po¡s
): ?>

18 <
a
 
Çme
="new">

19 <?
php
 
’dif
; ?>

21 <?
php
 
´št
 
theme
('image', "misc/forum-$icon.png") ?>

23 <?
php
 ià(
	g$Ãw_po¡s
): ?>

24 </
a
>

25 <?
php
 
’dif
; ?>

	@/srv/http/subs/notes/www/modules/forum/forum-list.tpl.php

1 <?
	gphp


34 <
bË
 
	gid
="forum-<?php…rint $forum_id; ?>">

35 <
th—d
>

36 <
Œ
>

37 <
th
><?
php
 
´št
 
t
('FÜum'); ?></
	gth
>

38 <
	gth
><?
php
 
´št
 
t
('Topics');?></th>

39 <
	gth
><?
php
 
´št
 
t
('Posts'); ?></th>

40 <
	gth
><?
php
 
´št
 
t
('Last…ost'); ?></th>

41 </
	gŒ
>

42 </
	gth—d
>

43 <
	gtbody
>

44 <?
php
 
fÜ—ch
 (
$fÜums
 
as
 
$chd_id
 => 
$fÜum
): ?>

45 <
Œ
 
id
="fÜum-li¡-<?ph°´šˆ$chd_id; ?>" 
şass
="<?php…rint $forum->zebra; ?>">

46 <
td
 <?
php
 
´št
 
$fÜum
->
is_cÚš”
 ? 'colspan="4" class="container"' : 'class="forum"'; ?>>

47 <?
	gphp


51 <?
php
 
´št
 
¡r_»³©
('<div cÏss="šd’t">', 
$fÜum
->
d•th
); ?>

52 <
div
 
	gşass
="Çme"><
a
 
h»f
="<?ph°´šˆ$fÜum->lšk; ?>"><?
php
 
´št
 
$fÜum
->
Çme
; ?></
	ga
></
	gdiv
>

53 <?
php
 ià(
	g$fÜum
->
	gdesütiÚ
): ?>

54 <
div
 
şass
="desütiÚ"><?
php
 
´št
 
$fÜum
->
desütiÚ
; ?></
	gdiv
>

55 <?
php
 
	g’dif
; ?>

56 <?
php
 
´št
 
¡r_»³©
('</div>', 
$fÜum
->
d•th
); ?>

57 </
	gtd
>

58 <?
php
 ià(!
	g$fÜum
->
	gis_cÚš”
): ?>

59 <
td
 
şass
="topics">

60 <?
php
 
´št
 
$fÜum
->
num_tİics
 ?>

61 <?
php
 ià(
$fÜum
->
Ãw_tİics
): ?>

62 <
br
 />

63 <
a
 
h»f
="<?ph°´šˆ$fÜum->Ãw_u¾; ?>"><?
php
 
´št
 
$fÜum
->
Ãw_‹xt
; ?></
	ga
>

64 <?
php
 
	g’dif
; ?>

65 </
	gtd
>

66 <
td
 
	gşass
="po¡s"><?
php
 
´št
 
$fÜum
->
num_po¡s
 ?></td>

67 <
td
 
şass
="Ï¡-»¶y"><?
php
 
´št
 
$fÜum
->
Ï¡_»¶y
 ?></td>

68 <?
php
 
’dif
; ?>

69 </
	gŒ
>

70 <?
php
 
	g’dfÜ—ch
; ?>

71 </
	gtbody
>

72 </
	gbË
>

	@/srv/http/subs/notes/www/modules/forum/forum-submitted.tpl.php

1 <?
	gphp


20 <?
php
 ià(
	g$time
): ?>

21 <?
php
 
´št
 
t
(

22 '@timago<b¸/>by !authÜ', 
¬¿y
(

23 '@time' => 
$time
,

24 '!authÜ' => 
$authÜ
,

26 <?
php
 : ?>

27 <?
php
 
´št
 
t
('n/a'); ?>

28 <?
php
 
	g’dif
; ?>

	@/srv/http/subs/notes/www/modules/forum/forum-topic-list.tpl.php

1 <?
	gphp


36 <
bË
 
	gid
="forum-topic-<?php…rint $topic_id; ?>">

37 <
th—d
>

38 <
Œ
><?
php
 
´št
 
$h—d”
; ?></
	gŒ
>

39 </
	gth—d
>

40 <
	gtbody
>

41 <?
php
 
	$fÜ—ch
 (
$tİics
 
as
 
$tİic
): ?>

42 <
Œ
 
şass
="<?php…rint $topic->zebra;?>">

43 <
td
 
şass
="icÚ"><?
php
 
´št
 
$tİic
->
icÚ
; ?></td>

44 <
td
 
şass
="t™Ë"><?
php
 
´št
 
$tİic
->
t™Ë
; ?></td>

45 <?
php
 ià(
$tİic
->
moved
): ?>

46 <
td
 
cŞ¥ª
="3"><?
php
 
´št
 
$tİic
->
mes§ge
; ?></td>

47 <?
php
 : ?>

48 <
td
 
şass
="replies">

49 <?
php
 
´št
 
$tİic
->
num_comm’ts
; ?>

50 <?
php
 ià(
$tİic
->
Ãw_»¶›s
): ?>

51 <
br
 />

52 <
a
 
h»f
="<?ph°´šˆ$tİic->Ãw_u¾; ?>"><?
php
 
´št
 
$tİic
->
Ãw_‹xt
; ?></a>

53 <?
php
 
’dif
; ?>

54 </
td
>

55 <
td
 
şass
="ü—‹d"><?
php
 
´št
 
$tİic
->
ü—‹d
; ?></td>

56 <
td
 
şass
="Ï¡-»¶y"><?
php
 
´št
 
$tİic
->
Ï¡_»¶y
; ?></td>

57 <?
php
 
’dif
; ?>

58 </
Œ
>

59 <?
php
 
’dfÜ—ch
; ?>

60 </
tbody
>

61 </
bË
>

62 <?
php
 
´št
 
$·g”
; ?>

	@/srv/http/subs/notes/www/modules/forum/forum-topic-navigation.tpl.php

1 <?
	gphp


26 <?
php
 ià(
	g$´ev
 || 
	g$Ãxt
): ?>

27 <
div
 
şass
="forum-topic-navigation clear-block">

28 <?
php
 ià(
$´ev
): ?>

29 <
a
 
h»f
="<?ph°´šˆ$´ev_u¾; ?>" 
şass
="tİic-´evious" 
t™Ë
="<?ph°´šˆt('GØtØ´eviou fÜumİic'è?>">â€¹ <?
php
 
´št
 
$´ev_t™Ë
 ?></a>

30 <?
php
 
’dif
; ?>

31 <?
php
 ià(
	g$Ãxt
): ?>

32 <
a
 
h»f
="<?ph°´šˆ$Ãxt_u¾; ?>" 
şass
="tİic-Ãxt" 
t™Ë
="<?ph°´šˆt('GØtØÃxˆfÜumİic'è?>"><?
php
 
´št
 
$Ãxt_t™Ë
 ?> â€º</a>

33 <?
php
 
’dif
; ?>

34 </
	gdiv
>

35 <?
php
 
	g’dif
; ?>

	@/srv/http/subs/notes/www/modules/forum/forum.admin.inc

1 <?
php


9 
funùiÚ
 
fÜum_fÜm_maš
(
$ty³
, 
$ed™
 = 
	$¬¿y
()) {

10 ià((
	`is£t
(
$_POST
['İ']è&& $_POST['İ'] =ğ
	`t
('D–‘e')è|| !
	`em±y
($_POST['confirm'])) {

11  
	`dru·l_g‘_fÜm
('fÜum_cÚfœm_d–‘e', 
$ed™
['tid']);

13 
$ty³
) {

15  
	`dru·l_g‘_fÜm
('fÜum_fÜm_fÜum', 
$ed™
);

18  
	`dru·l_g‘_fÜm
('fÜum_fÜm_cÚš”', 
$ed™
);

21 
	}
}

30 
funùiÚ
 
fÜum_fÜm_fÜum
(&
$fÜm_¡©e
, 
$ed™
 = 
	$¬¿y
()) {

31 
$ed™
 +ğ
	`¬¿y
(

34 'tid' => 
NULL
,

37 
$fÜm
['Çme'] = 
	`¬¿y
('#type' => 'textfield',

38 '#t™Ë' => 
	`t
('Forum‚ame'),

39 '#deçuÉ_v®ue' => 
$ed™
['name'],

41 '#desütiÚ' => 
	`t
('Short but meaningful‚ame forhis collection ofhreaded discussions.'),

42 '#»quœed' => 
TRUE
,

44 
$fÜm
['desütiÚ'] = 
	`¬¿y
('#type' => 'textarea',

45 '#t™Ë' => 
	`t
('Description'),

46 '#deçuÉ_v®ue' => 
$ed™
['description'],

47 '#desütiÚ' => 
	`t
('Description‡nd guidelines for discussions withinhis forum.'),

49 
$fÜm
['·»Á']['#Œ“'] = 
TRUE
;

50 
$fÜm
['·»Á'][0] = 
	`_fÜum_·»Á_£Ëù
(
$ed™
['tid'], 
	`t
('Parent'), 'forum');

51 
$fÜm
['weight'] = 
	`¬¿y
('#type' => 'weight',

52 '#t™Ë' => 
	`t
('Weight'),

53 '#deçuÉ_v®ue' => 
$ed™
['weight'],

54 '#desütiÚ' => 
	`t
('Forums‡re displayed in‡scending order by weight (forums withƒqual weights‡re displayed‡lphabetically).'),

57 
$fÜm
['vid'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', ''));

58 
$fÜm
['subm™' ] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save'));

59 ià(
$ed™
['tid']) {

60 
$fÜm
['d–‘e'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Delete'));

61 
$fÜm
['tid'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$ed™
['tid']);

63 
$fÜm
['#submit'][] = 'forum_form_submit';

64 
$fÜm
['#theme'] = 'forum_form';

66  
$fÜm
;

67 
	}
}

72 
funùiÚ
 
	$fÜum_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

73 ià(
$fÜm
['form_id']['#value'] == 'forum_form_container') {

74 
$cÚš”
 = 
TRUE
;

75 
$ty³
 = 
	`t
('forum container');

78 
$cÚš”
 = 
FALSE
;

79 
$ty³
 = 
	`t
('forum');

82 
$¡©us
 = 
	`xÚomy_§ve_‹rm
(
$fÜm_¡©e
['values']);

83 
$¡©us
) {

84 
SAVED_NEW
:

85 ià(
$cÚš”
) {

86 
$cÚš”s
 = 
	`v¬ŸbË_g‘
('fÜum_cÚš”s', 
	`¬¿y
());

87 
$cÚš”s
[] = 
$fÜm_¡©e
['values']['tid'];

88 
	`v¬ŸbË_£t
('fÜum_cÚš”s', 
$cÚš”s
);

90 
	`dru·l_£t_mes§ge
(
	`t
('C»©ed‚ew @ty³ %‹rm.', 
	`¬¿y
('%‹rm' => 
$fÜm_¡©e
['v®ues']['Çme'], '@ty³' => 
$ty³
)));

92 
SAVED_UPDATED
:

93 
	`dru·l_£t_mes§ge
(
	`t
('Th@ty³ %‹rm ha b“Àupd©ed.', 
	`¬¿y
('%‹rm' => 
$fÜm_¡©e
['v®ues']['Çme'], '@ty³' => 
$ty³
)));

96 
$fÜm_¡©e
['redirect'] = 'admin/content/forum';

98 
	}
}

107 
funùiÚ
 
fÜum_fÜm_cÚš”
(&
$fÜm_¡©e
, 
$ed™
 = 
	$¬¿y
()) {

108 
$ed™
 +ğ
	`¬¿y
(

111 'tid' => 
NULL
,

115 
$fÜm
['Çme'] = 
	`¬¿y
(

116 '#t™Ë' => 
	`t
('Container‚ame'),

118 '#deçuÉ_v®ue' => 
$ed™
['name'],

120 '#desütiÚ' => 
	`t
('Short but meaningful‚ame forhis collection of„elated forums.'),

121 '#»quœed' => 
TRUE


124 
$fÜm
['desütiÚ'] = 
	`¬¿y
(

126 '#t™Ë' => 
	`t
('Description'),

127 '#deçuÉ_v®ue' => 
$ed™
['description'],

128 '#desütiÚ' => 
	`t
('Description‡nd guidelines for forums withinhis container.')

130 
$fÜm
['·»Á']['#Œ“'] = 
TRUE
;

131 
$fÜm
['·»Á'][0] = 
	`_fÜum_·»Á_£Ëù
(
$ed™
['tid'], 
	`t
('Parent'), 'container');

132 
$fÜm
['weight'] = 
	`¬¿y
(

134 '#t™Ë' => 
	`t
('Weight'),

135 '#deçuÉ_v®ue' => 
$ed™
['weight'],

136 '#desütiÚ' => 
	`t
('Containers‡re displayed in‡scending order by weight (containers withƒqual weights‡re displayed‡lphabetically).')

139 
$fÜm
['vid'] = 
	`¬¿y
(

141 '#v®ue' => 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', ''),

143 
$fÜm
['subm™'] = 
	`¬¿y
(

145 '#v®ue' => 
	`t
('Save')

147 ià(
$ed™
['tid']) {

148 
$fÜm
['d–‘e'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Delete'));

149 
$fÜm
['tid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$ed™
['tid']);

151 
$fÜm
['#submit'][] = 'forum_form_submit';

152 
$fÜm
['#theme'] = 'forum_form';

154  
$fÜm
;

155 
	}
}

162 
funùiÚ
 
	$fÜum_cÚfœm_d–‘e
(&
$fÜm_¡©e
, 
$tid
) {

163 
$‹rm
 = 
	`xÚomy_g‘_‹rm
(
$tid
);

165 
$fÜm
['tid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$tid
);

166 
$fÜm
['Çme'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$‹rm
->
Çme
);

168  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØd–‘thfÜum %Çme?', 
	`¬¿y
('%Çme' => 
$‹rm
->
Çme
)), 'admš/cÚ‹Á/fÜum',('D–‘šg‡ fÜum o¸cÚš” wÈ®sØd–‘™ sub-fÜums, iàªy. TØd–‘po¡ šhi fÜum, vis™ <¨h»f="@cÚ‹Á">cÚ‹Á‡dmši¡¿tiÚ</a> fœ¡. Thi aùiÚ cªnÙ bundÚe.',‡¼ay('@cÚ‹Á' => 
	`u¾
('admin/content/node'))),('Delete'),('Cancel'));

169 
	}
}

174 
funùiÚ
 
	$fÜum_cÚfœm_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

175 
	`xÚomy_d–_‹rm
(
$fÜm_¡©e
['values']['tid']);

176 
	`dru·l_£t_mes§ge
(
	`t
('ThfÜum %‹rm‡nd‡Î sub-fÜum ªd‡ssocŸ‹d…o¡ havb“Àd–‘ed.', 
	`¬¿y
('%‹rm' => 
$fÜm_¡©e
['values']['name'])));

177 
	`w©chdog
('cÚ‹Á', 'fÜum: d–‘ed %‹rm‡nd‡Î it sub-fÜum ªd‡ssocŸ‹d…o¡s.', 
	`¬¿y
('%‹rm' => 
$fÜm_¡©e
['values']['name']));

179 
$fÜm_¡©e
['redirect'] = 'admin/content/forum';

181 
	}
}

188 
funùiÚ
 
	$fÜum_admš_£‰šgs
() {

189 
$fÜm
 = 
	`¬¿y
();

190 
$numb”
 = 
	`dru·l_m­_assoc
(
	`¬¿y
(5, 10, 15, 20, 25, 30, 35, 40, 50, 60, 80, 100, 150, 200, 250, 300, 350, 400, 500));

191 
$fÜm
['fÜum_hÙ_tİic'] = 
	`¬¿y
('#type' => 'select',

192 '#t™Ë' => 
	`t
('Hotopichreshold'),

193 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('forum_hot_topic', 15),

194 '#İtiÚs' => 
$numb”
,

195 '#desütiÚ' => 
	`t
('The‚umber of…osts‡opic must haveo be considered "hot".'),

197 
$numb”
 = 
	`dru·l_m­_assoc
(
	`¬¿y
(10, 25, 50, 75, 100));

198 
$fÜm
['fÜum_³r_·ge'] = 
	`¬¿y
('#type' => 'select',

199 '#t™Ë' => 
	`t
('Topics…er…age'),

200 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('forum_per_page', 25),

201 '#İtiÚs' => 
$numb”
,

202 '#desütiÚ' => 
	`t
('Default‚umber of forumopics displayed…er…age.'),

204 
$fÜd”
 = 
	`¬¿y
(1 => 
	`t
('Date -‚ewest first'), 2 =>('Date - oldest first'), 3 =>('Posts - most‡ctive first'), 4 =>('Posts -†east‡ctive first'));

205 
$fÜm
['fÜum_Üd”'] = 
	`¬¿y
('#type' => 'radios',

206 '#t™Ë' => 
	`t
('Default order'),

207 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('forum_order', '1'),

208 '#İtiÚs' => 
$fÜd”
,

209 '#desütiÚ' => 
	`t
('Default display order foropics.'),

211  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

212 
	}
}

217 
funùiÚ
 
	$fÜum_ov”v›w
(&
$fÜm_¡©e
) {

218 
	`moduË_lßd_šşude
('inc', 'taxonomy', 'taxonomy.admin');

220 
$vid
 = 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', '');

221 
$voÿbuÏry
 = 
	`xÚomy_voÿbuÏry_lßd
(
$vid
);

222 
$fÜm
 = 
	`xÚomy_ov”v›w_‹rms
(
$fÜm_¡©e
, 
$voÿbuÏry
);

224 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$key
) {

225 ià(
	`is£t
(
$fÜm
[
$key
]['#term'])) {

226 
$‹rm
 = 
$fÜm
[
$key
]['#term'];

227 
$fÜm
[
$key
]['v›w']['#v®ue'] = 
	`l
(
$‹rm
['name'], 'forum/'. $term['tid']);

228 ià(
	`š_¬¿y
(
$fÜm
[
$key
]['#‹rm']['tid'], 
	`v¬ŸbË_g‘
('fÜum_cÚš”s', 
	`¬¿y
()))) {

229 
$fÜm
[
$key
]['ed™']['#v®ue'] = 
	`l
(
	`t
('ed™ cÚš”'), 'admš/cÚ‹Á/fÜum/ed™/cÚš”/'. 
$‹rm
['tid']);

232 
$fÜm
[
$key
]['ed™']['#v®ue'] = 
	`l
(
	`t
('ed™ fÜum'), 'admš/cÚ‹Á/fÜum/ed™/fÜum/'. 
$‹rm
['tid']);

238 
	`un£t
(
$fÜm
['reset_alphabetical']);

241 
$fÜm
['#theme'] = 'taxonomy_overview_terms';

242 
$fÜm
['#subm™'] = 
	`¬¿y
('taxonomy_overview_terms_submit');

243 
$fÜm
['#v®id©e'] = 
	`¬¿y
('taxonomy_overview_terms_validate');

244 
$fÜm
['#em±y_‹xt'] = '<em>'. 
	`t
('Th”¬nØexi¡šg cÚš” Ü fÜums. CÚš” ªd fÜum may badded usšgh<¨h»f="@cÚš”">add cÚš”</a>‡nd <¨h»f="@fÜum">add fÜum</a>…ages.', 
	`¬¿y
('@cÚš”' => 
	`u¾
('admin/content/forum/add/container'), '@forum' => url('admin/content/forum/add/forum'))) .'</em>';

245  
$fÜm
;

246 
	}
}

255 
funùiÚ
 
	$_fÜum_·»Á_£Ëù
(
$tid
, 
$t™Ë
, 
$chd_ty³
) {

257 
$·»Ás
 = 
	`xÚomy_g‘_·»Ás
(
$tid
);

258 ià(
$·»Ás
) {

259 
$·»Á
 = 
	`¬¿y_shiá
(
$·»Ás
);

260 
$·»Á
 = $·»Á->
tid
;

263 
$·»Á
 = 0;

266 
$vid
 = 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', '');

267 
$chd»n
 = 
	`xÚomy_g‘_Œ“
(
$vid
, 
$tid
);

270 
	`fÜ—ch
 (
$chd»n
 
as
 
$chd
) {

271 
$exşude
[] = 
$chd
->
tid
;

273 
$exşude
[] = 
$tid
;

275 
$Œ“
 = 
	`xÚomy_g‘_Œ“
(
$vid
);

276 
$İtiÚs
[0] = '<'. 
	`t
('root') .'>';

277 ià(
$Œ“
) {

278 
	`fÜ—ch
 (
$Œ“
 
as
 
$‹rm
) {

279 ià(!
	`š_¬¿y
(
$‹rm
->
tid
, 
$exşude
)) {

280 
$İtiÚs
[
$‹rm
->
tid
] = 
	`¡r_»³©
(' -- ', $‹rm->
d•th
è. $‹rm->
Çme
;

284 ià(
$chd_ty³
 == 'container') {

285 
$desütiÚ
 = 
	`t
('Containers‡re usually…laced‡theop (root)†evel, but may‡lso be…laced inside‡nother container or forum.');

287 ià(
$chd_ty³
 == 'forum') {

288 
$desütiÚ
 = 
	`t
('Forums may be…laced‡theop (root)†evel, or inside‡nother container or forum.');

291  
	`¬¿y
('#ty³' => '£Ëù', '#t™Ë' => 
$t™Ë
, '#deçuÉ_v®ue' => 
$·»Á
, '#İtiÚs' => 
$İtiÚs
, '#desütiÚ' => 
$desütiÚ
, '#»quœed' => 
TRUE
);

292 
	}
}

	@/srv/http/subs/notes/www/modules/forum/forum.module

1 <?
php


12 
funùiÚ
 
	$fÜum_h–p
(
$·th
, 
$¬g
) {

13 
$·th
) {

15 
$ouut
 = '<p>'. 
	`t
('ThfÜum moduË†‘ you c»©th»aded discussiÚ fÜum w™h funùiÚ®™y sim¬ØÙh” mes§gbßrd sy¡ems. FÜum ¬u£fuÈbeÿu£hey‡Îow commun™y memb” tØdiscus tİic w™h oÃ‡nÙh” wh’suršgho£ cÚv”§tiÚ ¬¬chived fÜ†©”„eã»nû. Th<¨h»f="@ü—‹-tİic">fÜumİic</a> m’u i‹m (und” <em>C»©cÚ‹Á</em> oÀthNavig©iÚ m’uèü—‹ thš™ŸÈpo¡ oà¨Ãwh»aded discussiÚ, o¸th»ad.', 
	`¬¿y
('@ü—‹-tİic' => 
	`u¾
('node/add/forum'))) .'</p>';

16 
$ouut
 .ğ'<p>'. 
	`t
('Ahreaded discussion occurs‡s…eople†eave comments on‡ forumopic (or on other comments withinhatopic). A forumopic is contained within‡ forum, which may hold many similar or„elated forumopics. Forums‡re (optionally)‚ested within‡ container, which may hold many similar or„elated forums. Both containers‡nd forums may be‚ested within other containers‡nd forums,‡nd…rovide structure for your message board. By carefully…lanninghis structure, you make itƒasier for userso find‡nd comment on‡ specific forumopic.') .'</p>';

17 
$ouut
 .ğ'<p>'. 
	`t
('When‡dministering‡ forum,‚otehat:') .'</p>';

18 
$ouut
 .ğ'<ul><li>'. 
	`t
('a forumopic (and‡ll of its comments) may be moved between forums by selecting‡ different forum whileƒditing‡ forumopic.') .'</li>';

19 
$ouut
 .ğ'<li>'. 
	`t
('when moving‡ forumopic between forums,he <em>Leave shadow copy</em> option creates‡†ink inhe original forum…ointingohe‚ew†ocation.') .'</li>';

20 
$ouut
 .ğ'<li>'. 
	`t
('selecting <em>Read only</em> under <em>Comment settings</em> whileƒditing‡ forumopic will†ock (prevent‚ew comments) onhehread.') .'</li>';

21 
$ouut
 .ğ'<li>'. 
	`t
('selecting <em>Disabled</em> under <em>Comment settings</em> whileƒditing‡ forumopic will hide‡llƒxisting comments onhehread,‡nd…revent‚ew ones.') .'</li></ul>';

22 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@fÜum">FÜum moduË</a>.', 
	`¬¿y
('@forum' => 'http://drupal.org/handbook/modules/forum/')) .'</p>';

23  
$ouut
;

25  '<p>'. 
	`t
('This…age displays‡†ist ofƒxisting forums‡nd containers. Containers (optionally) hold forums,‡nd forums hold forumopics (a forumopic ishe initial…osto‡hreaded discussion). To…rovide structure, both containers‡nd forums may be…laced inside other containers‡nd forums. To„earrange forums‡nd containers, grab‡ drag-and-drop handle underhe <em>Name</em> column‡nd draghe forum or containero‡‚ew†ocation inhe†ist. (Grab‡ handle by clicking‡nd holdinghe mouse while hovering over‡ handle icon.) Rememberhat your changes will‚ot be saved until you clickhe <em>Save</em> button‡the bottom ofhe…age.') .'</p>';

27  '<p>'. 
	`t
('By grouping„elated or similar forums, containers help organize forums. Forƒxample,‡ container‚amed "Food" may holdwo forums‚amed "Fruit"‡nd "Vegetables",„espectively.') .'</p>';

29  '<p>'. 
	`t
('A forum holds„elated or similar forumopics (a forumopic ishe initial…osto‡hreaded discussion). Forƒxample,‡ forum‚amed "Fruit" may contain forumopicsitled "Apples"‡nd "Bananas",„espectively.') .'</p>';

31  '<p>'. 
	`t
('The£ s‘tšg ®low youØadju¡hdi¥Ïy oàyou¸fÜumİics. ThcÚ‹Áy³ avaabË fÜ u£ w™hš‡ fÜum may b£Ëùed byƒd™šgh<em>CÚ‹Áy³s</em> oÀth<¨h»f="@fÜum-voÿbuÏry">fÜum voÿbuÏry…age</a>.', 
	`¬¿y
('@fÜum-voÿbuÏry' => 
	`u¾
('admš/cÚ‹Á/xÚomy/ed™/voÿbuÏry/'. 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', '')))) .'</p>';

33 
	}
}

38 
funùiÚ
 
	$fÜum_theme
() {

39  
	`¬¿y
(

40 'fÜums' => 
	`¬¿y
(

42 '¬gum’ts' => 
	`¬¿y
('fÜums' => 
NULL
, 'topics' => NULL, 'parents' => NULL, 'tid' => NULL, 'sortby' => NULL, 'forum_per_page' => NULL),

44 'fÜum_li¡' => 
	`¬¿y
(

46 '¬gum’ts' => 
	`¬¿y
('fÜums' => 
NULL
, 'parents' => NULL, 'tid' => NULL),

48 'fÜum_tİic_li¡' => 
	`¬¿y
(

50 '¬gum’ts' => 
	`¬¿y
('tid' => 
NULL
, 'topics' => NULL, 'sortby' => NULL, 'forum_per_page' => NULL),

52 'fÜum_icÚ' => 
	`¬¿y
(

54 '¬gum’ts' => 
	`¬¿y
('Ãw_po¡s' => 
NULL
, 'num_posts' => 0, 'comment_mode' => 0, 'sticky' => 0),

56 'fÜum_tİic_Çvig©iÚ' => 
	`¬¿y
(

58 '¬gum’ts' => 
	`¬¿y
('node' => 
NULL
),

60 'fÜum_subm™‹d' => 
	`¬¿y
(

62 '¬gum’ts' => 
	`¬¿y
('tİic' => 
NULL
),

65 
	}
}

76 
funùiÚ
 
	$fÜum_‹rm_lßd
(
$tid
) {

77 
$»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
('SELECT.tid,.vid,.Çme,.desütiÚ,.weighˆFROM {‹rm_d©a} WHERE.tid = %d AND.vid = %d', 't', 'tid'), 
$tid
, 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', ''));

78  
	`db_ãtch_¬¿y
(
$»suÉ
);

79 
	}
}

84 
funùiÚ
 
	$fÜum_m’u
() {

85 
$™ems
['fÜum'] = 
	`¬¿y
(

88 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

89 'ty³' => 
MENU_SUGGESTED_ITEM
,

92 
$™ems
['admš/cÚ‹Á/fÜum'] = 
	`¬¿y
(

96 '·g¬gum’ts' => 
	`¬¿y
('forum_overview'),

97 'acûs ¬gum’ts' => 
	`¬¿y
('administer forums'),

100 
$™ems
['admš/cÚ‹Á/fÜum/li¡'] = 
	`¬¿y
(

102 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

105 
$™ems
['admš/cÚ‹Á/fÜum/add/cÚš”'] = 
	`¬¿y
(

108 '·g¬gum’ts' => 
	`¬¿y
('container'),

109 'acûs ¬gum’ts' => 
	`¬¿y
('administer forums'),

110 'ty³' => 
MENU_LOCAL_TASK
,

114 
$™ems
['admš/cÚ‹Á/fÜum/add/fÜum'] = 
	`¬¿y
(

117 '·g¬gum’ts' => 
	`¬¿y
('forum'),

118 'acûs ¬gum’ts' => 
	`¬¿y
('administer forums'),

119 'ty³' => 
MENU_LOCAL_TASK
,

123 
$™ems
['admš/cÚ‹Á/fÜum/£‰šgs'] = 
	`¬¿y
(

126 '·g¬gum’ts' => 
	`¬¿y
('forum_admin_settings'),

127 'acûs ¬gum’ts' => 
	`¬¿y
('administer forums'),

129 'ty³' => 
MENU_LOCAL_TASK
,

133 
$™ems
['admš/cÚ‹Á/fÜum/ed™/%fÜum_‹rm'] = 
	`¬¿y
(

135 'acûs ¬gum’ts' => 
	`¬¿y
('administer forums'),

136 'ty³' => 
MENU_CALLBACK
,

139 
$™ems
['admš/cÚ‹Á/fÜum/ed™/cÚš”/%fÜum_‹rm'] = 
	`¬¿y
(

142 '·g¬gum’ts' => 
	`¬¿y
('container', 5),

143 'acûs ¬gum’ts' => 
	`¬¿y
('administer forums'),

144 'ty³' => 
MENU_CALLBACK
,

147 
$™ems
['admš/cÚ‹Á/fÜum/ed™/fÜum/%fÜum_‹rm'] = 
	`¬¿y
(

150 '·g¬gum’ts' => 
	`¬¿y
('forum', 5),

151 'acûs ¬gum’ts' => 
	`¬¿y
('administer forums'),

152 'ty³' => 
MENU_CALLBACK
,

155  
$™ems
;

156 
	}
}

162 
funùiÚ
 
	$fÜum_š™
() {

163 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'forum') .'/forum.css');

164 
	}
}

169 
funùiÚ
 
	$fÜum_nod—pi
(&
$node
, 
$İ
, 
$‹a£r
, 
$·ge
) {

174 
$vid
 = 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', '');

175 
$voÿbuÏry
 = 
	`xÚomy_voÿbuÏry_lßd
(
$vid
);

176 ià(
	`em±y
(
$voÿbuÏry
)) {

181 ià(!
	`š_¬¿y
(
$node
->
ty³
, 
$voÿbuÏry
->
nodes
)) {

185 
$İ
) {

187 ià(
$·ge
 && 
	`xÚomy_node_g‘_‹rms_by_voÿbuÏry
(
$node
, 
$vid
è&& 
$Œ“
 = 
	`xÚomy_g‘_Œ“
($vid)) {

189 
	`fÜ—ch
 (
$Œ“
 
as
 
$‹rm
) {

190 
$fÜum_‹rms
[] = 
$‹rm
->
tid
;

192 
	`fÜ—ch
 (
$node
->
xÚomy
 
as
 
$‹rm_id
 => 
$‹rm
) {

193 ià(
	`š_¬¿y
(
$‹rm_id
, 
$fÜum_‹rms
)) {

194 
$node
->
tid
 = 
$‹rm_id
;

198 
$b»adüumb
[] = 
	`l
(
	`t
('Home'), 
NULL
);

199 
$b»adüumb
[] = 
	`l
(
$voÿbuÏry
->
Çme
, 'forum');

200 ià(
$·»Ás
 = 
	`xÚomy_g‘_·»Ás_®l
(
$node
->
tid
)) {

201 
$·»Ás
 = 
	`¬¿y_»v”£
($parents);

202 
	`fÜ—ch
 (
$·»Ás
 
as
 
$p
) {

203 
$b»adüumb
[] = 
	`l
(
$p
->
Çme
, 'fÜum/'. $p->
tid
);

206 
	`dru·l_£t_b»adüumb
(
$b»adüumb
);

208 ià(!
$‹a£r
) {

209 
$node
->
cÚ‹Á
['fÜum_Çvig©iÚ'] = 
	`¬¿y
(

210 '#v®ue' => 
	`theme
('fÜum_tİic_Çvig©iÚ', 
$node
),

218 ià(
	`em±y
(
$node
->
nid
)) {

220 
$node
->
xÚomy
[
	`¬g
(3)]->
vid
 = 
$vid
;

221 
$node
->
xÚomy
[
	`¬g
(3)]->
tid
 =‡rg(3);

228 ià(
$node
->
xÚomy
) {

230 
$voÿbuÏry
 = 
$vid
;

231 
$cÚš”s
 = 
	`v¬ŸbË_g‘
('fÜum_cÚš”s', 
	`¬¿y
());

232 
	`fÜ—ch
 (
$node
->
xÚomy
 
as
 
$‹rm
) {

233 ià(
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(*èFROM {‹rm_d©a} WHEREid = %d AND vid = %d', 
$‹rm
, 
$voÿbuÏry
))) {

234 ià(
	`š_¬¿y
(
$‹rm
, 
$cÚš”s
)) {

235 
$‹rm
 = 
	`xÚomy_g‘_‹rm
($term);

236 
	`fÜm_£t_”rÜ
('xÚomy', 
	`t
('Th™em %fÜum i Úly‡ cÚš” fÜ fÜums. PËa£ s–eù oÃ oàthfÜum b–ow it.', 
	`¬¿y
('%fÜum' => 
$‹rm
->
Çme
)));

246 
$node
->
icÚ
 = !
	`em±y
($node->icon) ? $node->icon : '';

248 ià(
$node
->
xÚomy
 && 
$Œ“
 = 
	`xÚomy_g‘_Œ“
(
$vid
)) {

250 
	`fÜ—ch
 (
$Œ“
 
as
 
$‹rm
) {

251 
$fÜum_‹rms
[] = 
$‹rm
->
tid
;

253 
	`fÜ—ch
 (
$node
->
xÚomy
 
as
 
$‹rm_id
) {

254 ià(
	`š_¬¿y
(
$‹rm_id
, 
$fÜum_‹rms
)) {

255 
$node
->
tid
 = 
$‹rm_id
;

258 
$Şd_tid
 = 
	`db_»suÉ
(
	`db_qu”y_¿nge
("SELECT.tid FROM {‹rm_node} INNER JOIN {node}‚ ON.vid =‚.vid WHERE‚.nid = %d ORDER BY.vid DESC", 
$node
->
nid
, 0, 1));

259 ià(
$Şd_tid
 && 
	`is£t
(
$node
->
tid
è&& ($node->tid !ğ$Şd_tidè&& !
	`em±y
($node->
shadow
)) {

261 
$node
->
xÚomy
[] = 
$Şd_tid
;

267 ià(
	`em±y
(
$node
->
»visiÚ
è&& 
	`db_»suÉ
(
	`db_qu”y
('SELECTid FROM {fÜum} WHERE‚id=%d', $node->
nid
))) {

268 ià(!
	`em±y
(
$node
->
tid
)) {

269 
	`db_qu”y
('UPDATE {fÜum} SETid = %d WHERE vid = %d', 
$node
->
tid
, $node->
vid
);

273 
	`db_qu”y
('DELETE FROM {fÜum} WHERE‚id = %d', 
$node
->
nid
);

280 ià(!
	`em±y
(
$node
->
tid
)) {

281 
	`db_qu”y
('INSERT INTO {fÜum} (tid, vid,‚idèVALUES (%d, %d, %d)', 
$node
->
tid
, $node->
vid
, $node->
nid
);

286 
	`db_qu”y
('DELETE FROM {fÜum} WHERE‚id = %d', 
$node
->
nid
);

290  
	`db_ãtch_¬¿y
(
	`db_qu”y
('SELECTid AS fÜum_tid FROM {fÜum} WHERE vid = %d', 
$node
->
vid
));

294 
	}
}

299 
funùiÚ
 
	$fÜum_node_šfo
() {

300  
	`¬¿y
(

301 'fÜum' => 
	`¬¿y
(

302 'Çme' => 
	`t
('Forumopic'),

304 'desütiÚ' => 
	`t
('A <em>forumopic</em> ishe initial…osto‡‚ew discussionhread within‡ forum.'),

305 't™Ë_Ïb–' => 
	`t
('Subject'),

308 
	}
}

313 
funùiÚ
 
	$fÜum_acûss
(
$İ
, 
$node
, 
$accouÁ
) {

314 
$İ
) {

316  
	`u£r_acûss
('ü—‹ fÜumİics', 
$accouÁ
è? 
TRUE
 : 
NULL
;

318  
	`u£r_acûss
('ed™‡ny fÜumİic', 
$accouÁ
è|| (u£r_acûss('ed™ owÀfÜumİics', $accouÁè&& ($accouÁ->
uid
 =ğ
$node
->uid)è? 
TRUE
 : 
NULL
;

320  
	`u£r_acûss
('d–‘ªy fÜumİic', 
$accouÁ
è|| (u£r_acûss('d–‘owÀfÜumİics', $accouÁè&& ($accouÁ->
uid
 =ğ
$node
->uid)è? 
TRUE
 : 
NULL
;

322 
	}
}

327 
funùiÚ
 
	$fÜum_³rm
() {

328  
	`¬¿y
('create forumopics', 'delete own forumopics', 'delete‡ny forumopic', 'edit own forumopics', 'edit‡ny forumopic', 'administer forums');

329 
	}
}

334 
funùiÚ
 
	$fÜum_xÚomy
(
$İ
, 
$ty³
, 
$‹rm
 = 
NULL
) {

335 ià(
$İ
 =ğ'd–‘e' && 
$‹rm
['vid'] =ğ
	`v¬ŸbË_g‘
('forum_nav_vocabulary', '')) {

336 
$ty³
) {

338 
$»suÉs
 = 
	`db_qu”y
('SELECTn.nid FROM {‹rm_node}ÀWHEREn.tid = %d', 
$‹rm
['tid']);

339 
$node
 = 
	`db_ãtch_objeù
(
$»suÉs
)) {

341 
	`node_d–‘e
(
$node
->
nid
);

345 
$cÚš”s
 = 
	`v¬ŸbË_g‘
('fÜum_cÚš”s', 
	`¬¿y
());

346 
$key
 = 
	`¬¿y_£¬ch
(
$‹rm
['tid'], 
$cÚš”s
);

347 ià(
$key
 !=ğ
FALSE
) {

348 
	`un£t
(
$cÚš”s
[
$key
]);

350 
	`v¬ŸbË_£t
('fÜum_cÚš”s', 
$cÚš”s
);

353 
	`v¬ŸbË_d–
('forum_nav_vocabulary');

356 
	}
}

361 
funùiÚ
 
	$fÜum_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

362 
$vid
 = 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', '');

363 ià(
	`is£t
(
$fÜm
['vid']è&& $fÜm['vid']['#v®ue'] =ğ
$vid
) {

365 ià(
$fÜm_id
 == 'taxonomy_form_vocabulary') {

366 
$fÜm
['h–p_fÜum_voÿb'] = 
	`¬¿y
(

367 '#v®ue' => 
	`t
('This ishe designated forum vocabulary. Some ofhe‚ormal vocabulary options have been„emoved.'),

370 
$fÜm
['cÚ‹Á_ty³s']['nodes']['#»quœed'] = 
TRUE
;

371 
$fÜm
['h›¿rchy'] = 
	`¬¿y
('#type' => 'value', '#value' => 1);

372 
$fÜm
['£‰šgs']['»quœed'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
FALSE
);

373 
$fÜm
['£‰šgs']['»ÏtiÚs'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
FALSE
);

374 
$fÜm
['£‰šgs']['gs'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
FALSE
);

375 
$fÜm
['£‰šgs']['muÉË'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
FALSE
);

376 
	`un£t
(
$fÜm
['delete']);

379 
	`–£if
 (
$fÜm_id
 == 'taxonomy_form_term') {

380 
$fÜm
['advªûd']['·»Á']['#acûss'] = 
FALSE
;

383 ià(
$fÜm_id
 == 'forum_node_form') {

385 
$vid
 = 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', '');

386 
$fÜm
['xÚomy'][
$vid
]['#»quœed'] = 
TRUE
;

387 
$fÜm
['xÚomy'][
$vid
]['#İtiÚs'][''] = 
	`t
('- Please choose -');

389 
	}
}

394 
funùiÚ
 
	$fÜum_lßd
(
$node
) {

395 
$fÜum
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT * FROM {fÜum} WHERE vid = %d', 
$node
->
vid
));

397  
$fÜum
;

398 
	}
}

406 
funùiÚ
 
fÜum_block
(
$İ
 = 'li¡', 
$d–
 = 0, 
$ed™
 = 
	$¬¿y
()) {

407 
$İ
) {

409 
$blocks
[0]['šfo'] = 
	`t
('Active forumopics');

410 
$blocks
[1]['šfo'] = 
	`t
('New forumopics');

411  
$blocks
;

414 
$fÜm
['fÜum_block_num_'. 
$d–
] = 
	`¬¿y
('#ty³' => '£Ëù', '#t™Ë' => 
	`t
('Numb” oàtİics'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('fÜum_block_num_'. $d–, '5'), '#İtiÚs' => 
	`dru·l_m­_assoc
(array(2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)));

415  
$fÜm
;

418 
	`v¬ŸbË_£t
('fÜum_block_num_'. 
$d–
, 
$ed™
['forum_block_num_'. $delta]);

422 ià(
	`u£r_acûss
('access content')) {

423 
$d–
) {

425 
$t™Ë
 = 
	`t
('Active forumopics');

426 
$sql
 = 
	`db_»wr™e_sql
("SELECT‚.nid,‚.title,†.comment_count,†.last_comment_timestamp FROM {node}‚ INNER JOIN {term_node}n ONn.vid =‚.vid INNER JOIN {term_data}d ONd.tid =n.tid INNER JOIN {node_comment_statistics}† ON‚.nid =†.nid WHERE‚.status = 1 ANDd.vid = %d ORDER BY†.last_comment_timestamp DESC");

427 
$»suÉ
 = 
	`db_qu”y_¿nge
(
$sql
, 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', ''), 0, variable_get('forum_block_num_0', '5'));

428 
$cÚ‹Á
 = 
	`node_t™Ë_li¡
(
$»suÉ
);

432 
$t™Ë
 = 
	`t
('New forumopics');

433 
$sql
 = 
	`db_»wr™e_sql
("SELECT‚.nid,‚.title,†.comment_count FROM {node}‚ INNER JOIN {term_node}n ONn.vid =‚.vid INNER JOIN {term_data}d ONd.tid =n.tid INNER JOIN {node_comment_statistics}† ON‚.nid =†.nid WHERE‚.status = 1 ANDd.vid = %d ORDER BY‚.nid DESC");

434 
$»suÉ
 = 
	`db_qu”y_¿nge
(
$sql
, 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', ''), 0, variable_get('forum_block_num_1', '5'));

435 
$cÚ‹Á
 = 
	`node_t™Ë_li¡
(
$»suÉ
);

439 ià(!
	`em±y
(
$cÚ‹Á
)) {

440 
$block
['subjeù'] = 
$t™Ë
;

441 
$block
['cÚ‹Á'] = 
$cÚ‹Á
 . 
	`theme
('mÜe_lšk', 
	`u¾
('fÜum'), 
	`t
('Readhe†atest forumopics.'));

442  
$block
;

446 
	}
}

451 
funùiÚ
 
	$fÜum_fÜm
(&
$node
, 
$fÜm_¡©e
) {

452 
$ty³
 = 
	`node_g‘_ty³s
('ty³', 
$node
);

453 
$fÜm
['t™Ë'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => 
	`check_¶aš
(
$ty³
->
t™Ë_Ïb–
), '#deçuÉ_v®ue' => !
	`em±y
(
$node
->
t™Ë
è? $node->t™Ë : '', '#»quœed' => 
TRUE
, '#weight' => -5);

455 ià(!
	`em±y
(
$node
->
nid
)) {

456 
$vid
 = 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', '');

457 
$fÜum_‹rms
 = 
	`xÚomy_node_g‘_‹rms_by_voÿbuÏry
(
$node
, 
$vid
);

459 
$shadow
 = (
	`couÁ
(
$fÜum_‹rms
) > 1);

460 
$fÜm
['shadow'] = 
	`¬¿y
('#ty³' => 'checkbox', '#t™Ë' => 
	`t
('L—vshadow cİy'), '#deçuÉ_v®ue' => 
$shadow
, '#description' =>('If you movehisopic, you can†eave‡†ink inhe old forumohe‚ew forum.'));

463 
$fÜm
['body_f›ld'] = 
	`node_body_f›ld
(
$node
, 
$ty³
->
body_Ïb–
, 1);

465 
$fÜm
['#submit'][] = 'forum_submit';

468  
$fÜm
;

469 
	}
}

474 
funùiÚ
 
	$fÜum_‹rm_·th
(
$‹rm
) {

475  'fÜum/'. 
$‹rm
->
tid
;

476 
	}
}

491 
funùiÚ
 
	$fÜum_g‘_fÜums
(
$tid
 = 0) {

493 
$fÜums
 = 
	`¬¿y
();

494 
$vid
 = 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', '');

495 
$_fÜums
 = 
	`xÚomy_g‘_Œ“
(
$vid
, 
$tid
);

497 ià(
	`couÁ
(
$_fÜums
)) {

499 
$couÁs
 = 
	`¬¿y
();

501 
$sql
 = "SELECT„.tid, COUNT(n.nid) ASopic_count, SUM(l.comment_count) AS comment_count FROM {node}‚ INNER JOIN {node_comment_statistics}† ON‚.nid =†.nid INNER JOIN {term_node}„ ON‚.vid =„.vid WHERE‚.status = 1 GROUP BY„.tid";

502 
$sql
 = 
	`db_»wr™e_sql
($sql);

503 
$_couÁs
 = 
	`db_qu”y
(
$sql
);

504 
$couÁ
 = 
	`db_ãtch_objeù
(
$_couÁs
)) {

505 
$couÁs
[
$couÁ
->
tid
] = $count;

509 
	`fÜ—ch
 (
$_fÜums
 
as
 
$fÜum
) {

510 ià(
	`š_¬¿y
(
$fÜum
->
tid
, 
	`v¬ŸbË_g‘
('fÜum_cÚš”s', 
	`¬¿y
()))) {

511 
$fÜum
->
cÚš”
 = 1;

514 ià(!
	`em±y
(
$couÁs
[
$fÜum
->
tid
])) {

515 
$fÜum
->
num_tİics
 = 
$couÁs
[$fÜum->
tid
]->
tİic_couÁ
;

516 
$fÜum
->
num_po¡s
 = 
$couÁs
[$fÜum->
tid
]->
tİic_couÁ
 + $couÁs[$fÜum->tid]->
comm’t_couÁ
;

519 
$fÜum
->
num_tİics
 = 0;

520 
$fÜum
->
num_po¡s
 = 0;

526 
$sql
 = "SELECT‚cs.last_comment_timestamp, IF (ncs.last_comment_uid != 0, u2.name,‚cs.last_comment_name) AS†ast_comment_name,‚cs.last_comment_uid FROM {node}‚ INNER JOIN {users} u1 ON‚.uid = u1.uid INNER JOIN {term_node}n ON‚.vid =n.vid INNER JOIN {node_comment_statistics}‚cs ON‚.nid =‚cs.nid INNER JOIN {users} u2 ON‚cs.last_comment_uid=u2.uid WHERE‚.status = 1 ANDn.tid = %d ORDER BY‚cs.last_comment_timestamp DESC";

527 
$sql
 = 
	`db_»wr™e_sql
($sql);

528 
$tİic
 = 
	`db_ãtch_objeù
(
	`db_qu”y_¿nge
(
$sql
, 
$fÜum
->
tid
, 0, 1));

530 
$Ï¡_po¡
 = 
Ãw
 
	`¡dCÏss
();

531 ià(!
	`em±y
(
$tİic
->
Ï¡_comm’t_time¡amp
)) {

532 
$Ï¡_po¡
->
time¡amp
 = 
$tİic
->
Ï¡_comm’t_time¡amp
;

533 
$Ï¡_po¡
->
Çme
 = 
$tİic
->
Ï¡_comm’t_Çme
;

534 
$Ï¡_po¡
->
uid
 = 
$tİic
->
Ï¡_comm’t_uid
;

536 
$fÜum
->
Ï¡_po¡
 = 
$Ï¡_po¡
;

538 
$fÜums
[
$fÜum
->
tid
] = $forum;

541  
$fÜums
;

542 
	}
}

548 
funùiÚ
 
	$_fÜum_tİics_uÄ—d
(
$‹rm
, 
$uid
) {

549 
$sql
 = "SELECT COUNT(n.nid) FROM {node}‚ INNER JOIN {term_node}n ON‚.vid =n.vid ANDn.tid = %d LEFT JOIN {history} h ON‚.nid = h.nid AND h.uid = %d WHERE‚.status = 1 AND‚.created > %d AND h.nid IS NULL";

550 
$sql
 = 
	`db_»wr™e_sql
($sql);

551  
	`db_»suÉ
(
	`db_qu”y
(
$sql
, 
$‹rm
, 
$uid
, 
NODE_NEW_LIMIT
));

552 
	}
}

554 
funùiÚ
 
	$fÜum_g‘_tİics
(
$tid
, 
$sÜtby
, 
$fÜum_³r_·ge
) {

555 
glob®
 
$u£r
, 
$fÜum_tİic_li¡_h—d”
;

557 
$fÜum_tİic_li¡_h—d”
 = 
	`¬¿y
(

558 
NULL
,

559 
	`¬¿y
('d©a' => 
	`t
('Topic'), 'field' => 'n.title'),

560 
	`¬¿y
('d©a' => 
	`t
('Replies'), 'field' => 'l.comment_count'),

561 
	`¬¿y
('d©a' => 
	`t
('Created'), 'field' => 'n.created'),

562 
	`¬¿y
('d©a' => 
	`t
('Last„eply'), 'field' => 'l.last_comment_timestamp'),

565 
$Üd”
 = 
	`_fÜum_g‘_tİic_Üd”
(
$sÜtby
);

566 
$i
 = 0; $˜< 
	`couÁ
(
$fÜum_tİic_li¡_h—d”
); $i++) {

567 ià(
$fÜum_tİic_li¡_h—d”
[
$i
]['f›ld'] =ğ
$Üd”
['field']) {

568 
$fÜum_tİic_li¡_h—d”
[
$i
]['sÜt'] = 
$Üd”
['sort'];

572 
$‹rm
 = 
	`xÚomy_g‘_‹rm
(
$tid
);

574 
$sql
 = 
	`db_»wr™e_sql
("SELECT‚.nid,„.tid,‚.title,‚.type,‚.sticky, u.name, u.uid,‚.created ASimestamp,‚.comment AS comment_mode,†.last_comment_timestamp, IF(l.last_comment_uid != 0, cu.name,†.last_comment_name) AS†ast_comment_name,†.last_comment_uid,†.comment_count AS‚um_comments, f.tid AS forum_tid FROM {node_comment_statistics}† INNER JOIN {node}‚ ON‚.nid =†.nid INNER JOIN {users} cu ON†.last_comment_uid = cu.uid INNER JOIN {term_node}„ ON‚.vid =„.vid INNER JOIN {users} u ON‚.uid = u.uid INNER JOIN {forum} f ON‚.vid = f.vid WHERE‚.status = 1 AND„.tid = %d");

575 
$sql
 .ğ
	`bËsÜt_sql
(
$fÜum_tİic_li¡_h—d”
, 'n.sticky DESC,');

576 
$sql
 .= ',‚.created DESC';

578 
$sql_couÁ
 = 
	`db_»wr™e_sql
("SELECT COUNT(n.nid) FROM {node}‚ INNER JOIN {term_node}„ ON‚.vid =„.vid AND„.tid = %d WHERE‚.status = 1");

580 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
, 
$fÜum_³r_·ge
, 0, 
$sql_couÁ
, 
$tid
);

581 
$tİics
 = 
	`¬¿y
();

582 
$tİic
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

583 ià(
$u£r
->
uid
) {

585 ià(
$tİic
->
tid
 !ğ
$tid
) {

586 
$tİic
->
Ãw
 = 0;

589 
$hi¡Üy
 = 
	`_fÜum_u£r_Ï¡_vis™
(
$tİic
->
nid
);

590 
$tİic
->
Ãw_»¶›s
 = 
	`comm’t_num_Ãw
($tİic->
nid
, 
$hi¡Üy
);

591 
$tİic
->
Ãw
 = $tİic->
Ãw_»¶›s
 || ($tİic->
time¡amp
 > 
$hi¡Üy
);

596 
$tİic
->
Ãw_»¶›s
 = 0;

597 
$tİic
->
Ãw
 = 0;

600 ià(
$tİic
->
num_comm’ts
 > 0) {

601 
$Ï¡_»¶y
 = 
Ãw
 
	`¡dCÏss
();

602 
$Ï¡_»¶y
->
time¡amp
 = 
$tİic
->
Ï¡_comm’t_time¡amp
;

603 
$Ï¡_»¶y
->
Çme
 = 
$tİic
->
Ï¡_comm’t_Çme
;

604 
$Ï¡_»¶y
->
uid
 = 
$tİic
->
Ï¡_comm’t_uid
;

605 
$tİic
->
Ï¡_»¶y
 = 
$Ï¡_»¶y
;

607 
$tİics
[] = 
$tİic
;

610  
$tİics
;

611 
	}
}

616 
funùiÚ
 
	$_fÜum_Ãw
(
$tid
) {

617 
glob®
 
$u£r
;

619 
$sql
 = "SELECT‚.nid FROM {node}‚ LEFT JOIN {history} h ON‚.nid = h.nid AND h.uid = %d INNER JOIN {term_node}„ ON‚.nid =„.nid AND„.tid = %d WHERE‚.status = 1 AND h.nid IS NULL AND‚.created > %d ORDER BY created";

620 
$sql
 = 
	`db_»wr™e_sql
($sql);

621 
$nid
 = 
	`db_»suÉ
(
	`db_qu”y_¿nge
(
$sql
, 
$u£r
->
uid
, 
$tid
, 
NODE_NEW_LIMIT
, 0, 1));

623  
$nid
 ? $nid : 0;

624 
	}
}

639 
funùiÚ
 
	$‹m¶©e_´•roûss_fÜums
(&
$v¬ŸbËs
) {

640 
glob®
 
$u£r
;

642 
$vid
 = 
	`v¬ŸbË_g‘
('forum_nav_vocabulary', '');

643 
$voÿbuÏry
 = 
	`xÚomy_voÿbuÏry_lßd
(
$vid
);

644 
$t™Ë
 = !
	`em±y
(
$voÿbuÏry
->
Çme
) ? $vocabulary->name : '';

647 
$b»adüumb
[] = 
	`l
(
	`t
('Home'), 
NULL
);

648 ià(
$v¬ŸbËs
['tid']) {

649 
$b»adüumb
[] = 
	`l
(
$voÿbuÏry
->
Çme
, 'forum');

651 ià(
$v¬ŸbËs
['parents']) {

652 
$v¬ŸbËs
['·»Ás'] = 
	`¬¿y_»v”£
($variables['parents']);

653 
	`fÜ—ch
 (
$v¬ŸbËs
['·»Ás'] 
as
 
$p
) {

654 ià(
$p
->
tid
 =ğ
$v¬ŸbËs
['tid']) {

655 
$t™Ë
 = 
$p
->
Çme
;

658 
$b»adüumb
[] = 
	`l
(
$p
->
Çme
, 'fÜum/'. $p->
tid
);

662 
	`dru·l_£t_b»adüumb
(
$b»adüumb
);

663 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$t™Ë
));

665 ià(
$v¬ŸbËs
['fÜums_defšed'] = 
	`couÁ
($variables['forums']) || count($variables['parents'])) {

667 
$fÜum_ty³s
 = 
	`¬¿y
();

670 
	`fÜ—ch
 (
$voÿbuÏry
->
nodes
 
as
 
$ty³
) {

672 ià(
	`node_acûss
('ü—‹', 
$ty³
)) {

675 
$fÜum_ty³s
[
$ty³
] = 
	`¬¿y
('t™Ë' => 
	`t
('Po¡‚ew @node_ty³',‡¼ay('@node_ty³' => 
	`node_g‘_ty³s
('Çme', $ty³))), 'h»f' => 'node/add/'. 
	`¡r_»¶aû
('_', '-', $ty³è.'/'. 
$v¬ŸbËs
['tid']);

679 ià(
	`em±y
(
$fÜum_ty³s
)) {

681 ià(
$u£r
->
uid
) {

682 
$fÜum_ty³s
['di§Îowed'] = 
	`¬¿y
('t™Ë' => 
	`t
('You‡re‚ot‡llowedo…ost‚ew content inhe forum.'));

686 
$fÜum_ty³s
['logš'] = 
	`¬¿y
('t™Ë' => 
	`t
('<¨h»f="@logš">Logš</a>Øpo¡‚ew cÚ‹Á iÀthfÜum.',‡¼ay('@logš' => 
	`u¾
('u£r/logš',‡¼ay('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
())))), 'html' => 
TRUE
);

689 
$v¬ŸbËs
['lšks'] = 
$fÜum_ty³s
;

691 ià(!
	`em±y
(
$v¬ŸbËs
['forums'])) {

692 
$v¬ŸbËs
['fÜums'] = 
	`theme
('forum_list', $variables['forums'], $variables['parents'], $variables['tid']);

695 
$v¬ŸbËs
['forums'] = '';

698 ià(
$v¬ŸbËs
['tid'] && !
	`š_¬¿y
($v¬ŸbËs['tid'], 
	`v¬ŸbË_g‘
('fÜum_cÚš”s', 
	`¬¿y
()))) {

699 
$v¬ŸbËs
['tİics'] = 
	`theme
('forum_topic_list', $variables['tid'], $variables['topics'], $variables['sortby'], $variables['forum_per_page']);

700 
	`dru·l_add_ãed
(
	`u¾
('xÚomy/‹rm/'. 
$v¬ŸbËs
['tid'] .'/0/ãed'), 'RSS - '. 
$t™Ë
);

703 
$v¬ŸbËs
['topics'] = '';

708 ià(
$v¬ŸbËs
['forums'] && !$variables['topics']) {

709 
$v¬ŸbËs
['template_files'][] = 'forums-containers';

710 
$v¬ŸbËs
['template_files'][] = 'forums-'. $variables['tid'];

711 
$v¬ŸbËs
['template_files'][] = 'forums-containers-'. $variables['tid'];

713 
	`–£if
 (!
$v¬ŸbËs
['forums'] && $variables['topics']) {

714 
$v¬ŸbËs
['template_files'][] = 'forums-topics';

715 
$v¬ŸbËs
['template_files'][] = 'forums-'. $variables['tid'];

716 
$v¬ŸbËs
['template_files'][] = 'forums-topics-'. $variables['tid'];

719 
$v¬ŸbËs
['template_files'][] = 'forums-'. $variables['tid'];

724 
	`dru·l_£t_t™Ë
(
	`t
('No forums defined'));

725 
$v¬ŸbËs
['lšks'] = 
	`¬¿y
();

726 
$v¬ŸbËs
['forums'] = '';

727 
$v¬ŸbËs
['topics'] = '';

729 
	}
}

742 
funùiÚ
 
	$‹m¶©e_´•roûss_fÜum_li¡
(&
$v¬ŸbËs
) {

743 
glob®
 
$u£r
;

744 
$row
 = 0;

746 
	`fÜ—ch
 (
$v¬ŸbËs
['fÜums'] 
as
 
$id
 => 
$fÜum
) {

747 
$v¬ŸbËs
['fÜums'][
$id
]->
desütiÚ
 = !
	`em±y
(
$fÜum
->desütiÚè? 
	`f‹r_xss_admš
($forum->description) : '';

748 
$v¬ŸbËs
['fÜums'][
$id
]->
lšk
 = 
	`u¾
("forum/$forum->tid");

749 
$v¬ŸbËs
['fÜums'][
$id
]->
Çme
 = 
	`check_¶aš
(
$fÜum
->name);

750 
$v¬ŸbËs
['fÜums'][
$id
]->
is_cÚš”
 = !
	`em±y
(
$fÜum
->
cÚš”
);

751 
$v¬ŸbËs
['fÜums'][
$id
]->
zeb¿
 = 
$row
 % 2 == 0 ? 'odd' : 'even';

752 
$row
++;

754 
$v¬ŸbËs
['fÜums'][
$id
]->
Ãw_‹xt
 = '';

755 
$v¬ŸbËs
['fÜums'][
$id
]->
Ãw_u¾
 = '';

756 
$v¬ŸbËs
['fÜums'][
$id
]->
Ãw_tİics
 = 0;

757 
$v¬ŸbËs
['fÜums'][
$id
]->
Şd_tİics
 = 
$fÜum
->
num_tİics
;

758 ià(
$u£r
->
uid
) {

759 
$v¬ŸbËs
['fÜums'][
$id
]->
Ãw_tİics
 = 
	`_fÜum_tİics_uÄ—d
(
$fÜum
->
tid
, 
$u£r
->
uid
);

760 ià(
$v¬ŸbËs
['fÜums'][
$id
]->
Ãw_tİics
) {

761 
$v¬ŸbËs
['fÜums'][
$id
]->
Ãw_‹xt
 = 
	`fÜm©_¶u¿l
($v¬ŸbËs['fÜums'][$id]->
Ãw_tİics
, '1‚ew', '@count‚ew');

762 
$v¬ŸbËs
['fÜums'][
$id
]->
Ãw_u¾
 = 
	`u¾
("fÜum/$fÜum->tid", 
	`¬¿y
('fragment' => 'new'));

764 
$v¬ŸbËs
['fÜums'][
$id
]->
Şd_tİics
 = 
$fÜum
->
num_tİics
 - $v¬ŸbËs['fÜums'][$id]->
Ãw_tİics
;

766 
$v¬ŸbËs
['fÜums'][
$id
]->
Ï¡_»¶y
 = 
	`theme
('fÜum_subm™‹d', 
$fÜum
->
Ï¡_po¡
);

769 
$v¬ŸbËs
['forum_id'] = $variables['tid'];

770 
	`un£t
(
$v¬ŸbËs
['tid']);

771 
	}
}

785 
funùiÚ
 
	$‹m¶©e_´•roûss_fÜum_tİic_li¡
(&
$v¬ŸbËs
) {

786 
glob®
 
$fÜum_tİic_li¡_h—d”
;

789 
$ts
 = 
	`bËsÜt_š™
(
$fÜum_tİic_li¡_h—d”
);

790 
$h—d”
 = '';

791 
	`fÜ—ch
 (
$fÜum_tİic_li¡_h—d”
 
as
 
$ûÎ
) {

792 
$ûÎ
 = 
	`bËsÜt_h—d”
($ûÎ, 
$fÜum_tİic_li¡_h—d”
, 
$ts
);

793 
$h—d”
 .ğ
	`_theme_bË_ûÎ
(
$ûÎ
, 
TRUE
);

795 
$v¬ŸbËs
['h—d”'] = 
$h—d”
;

797 ià(!
	`em±y
(
$v¬ŸbËs
['topics'])) {

798 
$row
 = 0;

799 
	`fÜ—ch
 (
$v¬ŸbËs
['tİics'] 
as
 
$id
 => 
$tİic
) {

800 
$v¬ŸbËs
['tİics'][
$id
]->
icÚ
 = 
	`theme
('fÜum_icÚ', 
$tİic
->
Ãw
, $tİic->
num_comm’ts
, $tİic->
comm’t_mode
, $tİic->
¡icky
);

801 
$v¬ŸbËs
['tİics'][
$id
]->
zeb¿
 = 
$row
 % 2 == 0 ? 'odd' : 'even';

802 
$row
++;

807 ià(
$tİic
->
fÜum_tid
 !ğ
$v¬ŸbËs
['tid']) {

808 
$v¬ŸbËs
['tİics'][
$id
]->
moved
 = 
TRUE
;

809 
$v¬ŸbËs
['tİics'][
$id
]->
t™Ë
 = 
	`check_¶aš
(
$tİic
->title);

810 
$v¬ŸbËs
['tİics'][
$id
]->
mes§ge
 = 
	`l
(
	`t
('Thisopic has been moved'), "forum/$topic->forum_tid");

813 
$v¬ŸbËs
['tİics'][
$id
]->
moved
 = 
FALSE
;

814 
$v¬ŸbËs
['tİics'][
$id
]->
t™Ë
 = 
	`l
(
$tİic
->title, "node/$topic->nid");

815 
$v¬ŸbËs
['tİics'][
$id
]->
mes§ge
 = '';

817 
$v¬ŸbËs
['tİics'][
$id
]->
ü—‹d
 = 
	`theme
('fÜum_subm™‹d', 
$tİic
);

818 
$v¬ŸbËs
['tİics'][
$id
]->
Ï¡_»¶y
 = 
	`theme
('fÜum_subm™‹d', 
	`is£t
(
$tİic
->Ï¡_»¶yè? $tİic->Ï¡_»¶y : 
NULL
);

820 
$v¬ŸbËs
['tİics'][
$id
]->
Ãw_‹xt
 = '';

821 
$v¬ŸbËs
['tİics'][
$id
]->
Ãw_u¾
 = '';

822 ià(
$tİic
->
Ãw_»¶›s
) {

823 
$v¬ŸbËs
['tİics'][
$id
]->
Ãw_‹xt
 = 
	`fÜm©_¶u¿l
(
$tİic
->
Ãw_»¶›s
, '1‚ew', '@count‚ew');

824 
$v¬ŸbËs
['tİics'][
$id
]->
Ãw_u¾
 = 
	`u¾
("node/$tİic->nid", 
	`¬¿y
('qu”y' => 
	`comm’t_Ãw_·ge_couÁ
(
$tİic
->
num_comm’ts
, $tİic->
Ãw_»¶›s
, $topic), 'fragment' => 'new'));

831 
$v¬ŸbËs
['tİics'] = 
	`¬¿y
();

834 
$v¬ŸbËs
['topic_id'] = $variables['tid'];

835 
	`un£t
(
$v¬ŸbËs
['tid']);

837 
$v¬ŸbËs
['·g”'] = 
	`theme
('·g”', 
NULL
, $variables['forum_per_page'], 0);

838 
	}
}

852 
funùiÚ
 
	$‹m¶©e_´•roûss_fÜum_icÚ
(&
$v¬ŸbËs
) {

853 
$v¬ŸbËs
['hÙ_th»shŞd'] = 
	`v¬ŸbË_g‘
('forum_hot_topic', 15);

854 ià(
$v¬ŸbËs
['num_posts'] > $variables['hot_threshold']) {

855 
$v¬ŸbËs
['icon'] = $variables['new_posts'] ? 'hot-new' : 'hot';

858 
$v¬ŸbËs
['icon'] = $variables['new_posts'] ? 'new' : 'default';

861 ià(
$v¬ŸbËs
['comm’t_mode'] =ğ
COMMENT_NODE_READ_ONLY
 || $v¬ŸbËs['comm’t_mode'] =ğ
COMMENT_NODE_DISABLED
) {

862 
$v¬ŸbËs
['icon'] = 'closed';

865 ià(
$v¬ŸbËs
['sticky'] == 1) {

866 
$v¬ŸbËs
['icon'] = 'sticky';

868 
	}
}

878 
funùiÚ
 
	$‹m¶©e_´•roûss_fÜum_tİic_Çvig©iÚ
(&
$v¬ŸbËs
) {

879 
$ouut
 = '';

882 
$sql
 = "SELECT‚.nid,‚.t™Ë,‚.¡icky,†.comm’t_couÁ,†.Ï¡_comm’t_time¡am°FROM {node}‚ INNER JOIN {node_comm’t_¡©i¡ics}† ON‚.nid =†.nid INNER JOIN {‹rm_node}„ ON‚.nid =„.nid AND„.tid = %d WHERE‚.¡©u ğ1 ORDER BY‚.¡icky DESC, ". 
	`_fÜum_g‘_tİic_Üd”_sql
(
	`v¬ŸbË_g‘
('forum_order', 1));

883 
$»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
(
$sql
), 
	`is£t
(
$v¬ŸbËs
['node']->
tid
) ? $variables['node']->tid : 0);

885 
$¡İ
 = 
$v¬ŸbËs
['prev'] = $variables['next'] = 0;

887 
$tİic
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

888 ià(
$¡İ
 == 1) {

889 
$v¬ŸbËs
['Ãxt'] = 
$tİic
->
nid
;

890 
$v¬ŸbËs
['Ãxt_t™Ë'] = 
	`check_¶aš
(
$tİic
->
t™Ë
);

891 
$v¬ŸbËs
['Ãxt_u¾'] = 
	`u¾
("node/$topic->nid");

894 ià(
$tİic
->
nid
 =ğ
$v¬ŸbËs
['node']->nid) {

895 
$¡İ
 = 1;

898 
$v¬ŸbËs
['´ev'] = 
$tİic
->
nid
;

899 
$v¬ŸbËs
['´ev_t™Ë'] = 
	`check_¶aš
(
$tİic
->
t™Ë
);

900 
$v¬ŸbËs
['´ev_u¾'] = 
	`u¾
("node/$topic->nid");

903 
	}
}

913 
funùiÚ
 
	$‹m¶©e_´•roûss_fÜum_subm™‹d
(&
$v¬ŸbËs
) {

914 
$v¬ŸbËs
['authÜ'] = 
	`is£t
($v¬ŸbËs['tİic']->
uid
è? 
	`theme
('username', $variables['topic']) : '';

915 
$v¬ŸbËs
['time'] = 
	`is£t
($v¬ŸbËs['tİic']->
time¡amp
è? 
	`fÜm©_š‹rv®
(
	`time
() - $variables['topic']->timestamp) : '';

916 
	}
}

918 
funùiÚ
 
	$_fÜum_u£r_Ï¡_vis™
(
$nid
) {

919 
glob®
 
$u£r
;

920 
$hi¡Üy
 = 
	`¬¿y
();

922 ià(
	`em±y
(
$hi¡Üy
)) {

923 
$»suÉ
 = 
	`db_qu”y
('SELECT‚id,ime¡am°FROM {hi¡Üy} WHERE uid = %d', 
$u£r
->
uid
);

924 
$t
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

925 
$hi¡Üy
[
$t
->
nid
] = $t->
time¡amp
 > 
NODE_NEW_LIMIT
 ? $t->timestamp : NODE_NEW_LIMIT;

928  
	`is£t
(
$hi¡Üy
[
$nid
]è? $hi¡Üy[$nid] : 
NODE_NEW_LIMIT
;

929 
	}
}

931 
funùiÚ
 
	$_fÜum_g‘_tİic_Üd”
(
$sÜtby
) {

932 
$sÜtby
) {

934  
	`¬¿y
('field' => 'l.last_comment_timestamp', 'sort' => 'desc');

937  
	`¬¿y
('field' => 'l.last_comment_timestamp', 'sort' => 'asc');

940  
	`¬¿y
('field' => 'l.comment_count', 'sort' => 'desc');

943  
	`¬¿y
('field' => 'l.comment_count', 'sort' => 'asc');

946 
	}
}

948 
funùiÚ
 
	$_fÜum_g‘_tİic_Üd”_sql
(
$sÜtby
) {

949 
$Üd”
 = 
	`_fÜum_g‘_tİic_Üd”
(
$sÜtby
);

950  
$Üd”
['f›ld'] .' '. 
	`¡¹ouµ”
($order['sort']);

951 
	}
}

	@/srv/http/subs/notes/www/modules/forum/forum.pages.inc

1 <?
php


12 
funùiÚ
 
	$fÜum_·ge
(
$tid
 = 0) {

13 ià(!
	`is_num”ic
(
$tid
)) {

14  
MENU_NOT_FOUND
;

16 
$tid
 = ()$tid;

18 
$tİics
 = '';

19 
$fÜum_³r_·ge
 = 
	`v¬ŸbË_g‘
('forum_per_page', 25);

20 
$sÜtby
 = 
	`v¬ŸbË_g‘
('forum_order', 1);

22 
$fÜums
 = 
	`fÜum_g‘_fÜums
(
$tid
);

23 
$·»Ás
 = 
	`xÚomy_g‘_·»Ás_®l
(
$tid
);

24 ià(
$tid
 && !
	`š_¬¿y
($tid, 
	`v¬ŸbË_g‘
('fÜum_cÚš”s', 
	`¬¿y
()))) {

25 
$tİics
 = 
	`fÜum_g‘_tİics
(
$tid
, 
$sÜtby
, 
$fÜum_³r_·ge
);

28  
	`theme
('fÜums', 
$fÜums
, 
$tİics
, 
$·»Ás
, 
$tid
, 
$sÜtby
, 
$fÜum_³r_·ge
);

29 
	}
}

	@/srv/http/subs/notes/www/modules/forum/forums.tpl.php

1 <?
	gphp


21 <?
php
 ià(
	g$fÜums_defšed
): ?>

22 <
div
 
id
="forum">

23 <?
php
 
´št
 
theme
('lšks', 
$lšks
); ?>

24 <?
php
 
´št
 
	g$fÜums
; ?>

25 <?
php
 
´št
 
	g$tİics
; ?>

26 </
	gdiv
>

27 <?
php
 
	g’dif
; ?>

	@/srv/http/subs/notes/www/modules/help/help.admin.inc

1 <?
php


12 
funùiÚ
 
	$h–p_maš
() {

14 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('moduË', 'h–p'è.'/h–p.css', 'moduË', '®l', 
FALSE
);

15 
$ouut
 = '<h2>'. 
	`t
('H–°tİics'è.'</h2><p>'.('H–°i avaabË oÀthfŞlowšg i‹ms:'è.'</p>'. 
	`h–p_lšks_as_li¡
();

16  
$ouut
;

17 
	}
}

22 
funùiÚ
 
	$h–p_·ge
(
$Çme
) {

23 
$ouut
 = '';

24 ià(
	`moduË_hook
(
$Çme
, 'help')) {

25 
$moduË
 = 
	`dru·l_·r£_šfo_fe
(
	`dru·l_g‘_·th
('moduË', 
$Çme
) .'/'. $name .'.info');

26 
	`dru·l_£t_t™Ë
(
$moduË
['name']);

28 
$‹mp
 = 
	`moduË_švoke
(
$Çme
, 'h–p', "admš/h–p#$Çme", 
	`dru·l_h–p_¬g
());

29 ià(
	`em±y
(
$‹mp
)) {

30 
$ouut
 .ğ
	`t
("NØh–°i avaabË fÜ moduË %moduË.", 
	`¬¿y
('%moduË' => 
$moduË
['name']));

33 
$ouut
 .ğ
$‹mp
;

38 
$admš_sks
 = 
	`sy¡em_g‘_moduË_admš_sks
(
$Çme
);

39 ià(!
	`em±y
(
$admš_sks
)) {

40 
	`ksÜt
(
$admš_sks
);

41 
$ouut
 .ğ
	`theme
('™em_li¡', 
$admš_sks
, 
	`t
('@moduË‡dmši¡¿tiÚ…ages', 
	`¬¿y
('@moduË' => 
$moduË
['name'])));

45  
$ouut
;

46 
	}
}

48 
funùiÚ
 
	$h–p_lšks_as_li¡
() {

49 
$em±y_¬g
 = 
	`dru·l_h–p_¬g
();

50 
$moduË_šfo
 = 
	`moduË_»bud_ÿche
();

52 
$moduËs
 = 
	`¬¿y
();

53 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('h–p', 
TRUE
è
as
 
$moduË
) {

54 ià(
	`moduË_švoke
(
$moduË
, 'h–p', "admš/h–p#$moduË", 
$em±y_¬g
)) {

55 
$moduËs
[
$moduË
] = 
$moduË_šfo
[$moduË]->
šfo
['name'];

58 
	`asÜt
(
$moduËs
);

61 
$couÁ
 = 
	`couÁ
(
$moduËs
);

62 
$b»ak
 = 
	`û
(
$couÁ
 / 4);

63 
$ouut
 = '<div class="clear-block"><div class="help-items"><ul>';

64 
$i
 = 0;

65 
	`fÜ—ch
 (
$moduËs
 
as
 
$moduË
 => 
$Çme
) {

66 
$ouut
 .ğ'<li>'. 
	`l
(
$Çme
, 'admš/h–p/'. 
$moduË
) .'</li>';

67 ià((
$i
 + 1è% 
$b»ak
 =ğ0 && ($˜+ 1è!ğ
$couÁ
) {

68 
$ouut
 .ğ'</ul></div><div cÏss="h–p-™ems'. (
$i
 + 1 =ğ
$b»ak
 * 3 ? ' help-items-last' : '') .'"><ul>';

70 
$i
++;

72 
$ouut
 .= '</ul></div></div>';

74  
$ouut
;

75 
	}
}

	@/srv/http/subs/notes/www/modules/help/help.module

1 <?
php


12 
funùiÚ
 
	$h–p_m’u
() {

13 
$™ems
['admš/h–p'] = 
	`¬¿y
(

16 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

21 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('h–p', 
TRUE
è
as
 
$moduË
) {

22 
$™ems
['admš/h–p/'. 
$moduË
] = 
	`¬¿y
(

23 't™Ë' => 
$moduË
,

25 '·g¬gum’ts' => 
	`¬¿y
(2),

26 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

27 'ty³' => 
MENU_CALLBACK
,

32  
$™ems
;

33 
	}
}

38 
funùiÚ
 
	$h–p_h–p
(
$·th
, 
$¬g
) {

39 
$·th
) {

41 
$ouut
 = '<p>'. 
	`t
('Thi guid´ovide cÚ‹xˆ£ns™ivh–°Úhu£‡nd cÚfigu¿tiÚ oà<¨h»f="@dru·l">Dru·l</a>‡nd it moduËs,‡nd i ¨suµËm’ˆtØthmÜex‹nsivÚlš<¨h»f="@hªdbook">Dru·Èhªdbook</a>. ThÚlšhªdbook may cÚš mÜup-to-d©šfÜm©iÚ, i ªnÙ©ed w™h h–pfuÈu£r-cÚŒibu‹d comm’ts,‡nd s”ve a thdefš™iv»ã»nû…ošˆfÜ‡Î Dru·Èdocum’tiÚ.', 
	`¬¿y
('@drupal' => 'http://drupal.org', '@handbook' => 'http://drupal.org/handbook')) .'</p>';

42  
$ouut
;

44 
$ouut
 = '<p>'. 
	`t
('Thh–°moduË…rovide cÚ‹xˆ£ns™ivh–°Úhu£‡nd cÚfigu¿tiÚ oà<¨h»f="@dru·l">Dru·l</a>‡nd it moduËs,‡nd i ¨suµËm’ˆtØthmÜex‹nsivÚlš<¨h»f="@hªdbook">Dru·Èhªdbook</a>. ThÚlšhªdbook may cÚš mÜup-to-d©šfÜm©iÚ, i ªnÙ©ed w™h h–pfuÈu£r-cÚŒibu‹d comm’ts,‡nd s”ve a thdefš™iv»ã»nû…ošˆfÜ‡Î Dru·Èdocum’tiÚ.', 
	`¬¿y
('@drupal' => 'http://drupal.org', '@handbook' => 'http://drupal.org/handbook')) .'</p>';

45 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@h–p">H–°moduË</a>.', 
	`¬¿y
('@help' => 'http://drupal.org/handbook/modules/help/')) .'</p>';

46  
$ouut
;

48 
	}
}

	@/srv/http/subs/notes/www/modules/locale/locale.module

1 <?
php


21 
funùiÚ
 
	$loÿË_h–p
(
$·th
, 
$¬g
) {

22 
$·th
) {

24 
$ouut
 = '<p>'. 
	`t
('The†ocale module‡llows your Drupal siteo be…resented in†anguages otherhanhe default English,‡ defining feature of multi-lingual websites. The†ocale module works byƒxaminingext‡s it is‡bouto be displayed: when‡ranslation ofheext is‡vailable inhe†anguageo be displayed,heranslation is displayed„atherhanhe originalext. When‡ranslation is unavailable,he originalext is displayed,‡ndhen stored for†ater„eview by‡ranslator.') .'</p>';

25 
$ouut
 .ğ'<p>'. 
	`t
('BeyÚd¿n¦©iÚ oàthDru·Èš‹rçû,hloÿË moduË…rovide ¨ã©u» s‘aÜedØthÃed oà¨muÉi-lšgu® s™e. LªguagÃgÙŸtiÚ‡Îow you¸s™tØautom©iÿÎy chªgÏnguagba£d oÀthdomaš o¸·th u£d fÜƒach„eque¡. U£r may (İtiÚ®lyè£Ëùheœ…»ã¼ed†ªguagÚheœ <em>My‡ccouÁ</em>…age,‡nd you¸s™ÿÀbcÚfigu»dØhÚÜ‡ web brow£r\' ´eã¼ed†ªguag£‰šgs. You¸s™cÚ‹Á cª bü—‹d iÀ×nd¿n¦©edoèªyƒÇbËd†ªguage,‡ndƒach…o¡ may hav¨Ïnguage-­´İrŸ‹‡lŸ fÜƒach oà™ Œª¦©iÚs. ThloÿË moduË wÜk š cÚû¹ w™hh<¨h»f="@cÚ‹Á-h–p">cÚ‹Á¿n¦©iÚ moduË</a>ØmªagŒª¦©ed cÚ‹Á.', 
	`¬¿y
('@cÚ‹Á-h–p' => 
	`u¾
('admin/help/translation'))) .'</p>';

26 
$ouut
 .ğ'<p>'. 
	`t
('Translations may be…rovided by:') .'</p>';

27 
$ouut
 .ğ'<ul><li>'. 
	`t
("translatinghe originalext viahe†ocale module's integrated web interface, or") .'</li>';

28 
$ouut
 .ğ'<li>'. 
	`t
('impÜtšg fe äom‡ s‘ oàexi¡šg¿n¦©iÚs, knowÀa ¨Œª¦©iÚ…ackage. A¿n¦©iÚ…ackag’abË thdi¥Ïy oà¨¥ecifiøv”siÚ oàDru·Èš‡ s³cifiøÏnguage,‡nd cÚš fe šhG‘‹xˆPÜbË Objeù (<em>.po</em>èfÜm©. AÉhough‚Ù‡Î†ªguage ¬avaabË fÜƒv”y v”siÚ oàDru·l,¿n¦©iÚ…ackage fÜ mªy†ªguage ¬avaabË fÜ dowÆßd fromh<¨h»f="@Œª¦©iÚs">Dru·ÈŒª¦©iÚ…age</a>.', 
	`¬¿y
('@translations' => 'http://drupal.org/project/translations')) .'</li></ul>';

29 
$ouut
 .ğ'<p>'. 
	`t
('Iàªƒxi¡šg¿n¦©iÚ…ackagdÛ nÙ m“ˆyou¸Ãeds,hG‘‹xˆPÜbË Objeù (<em>.po</em>èfe w™hš‡…ackagmay bmodif›d, o¸Ãw <em>.po</em> fe may bü—‹d, usšg‡ desktİ G‘‹xˆed™Ü. ThloÿË moduË\' <¨h»f="@impÜt">impÜt</a> f—tu»‡Îow thŒª¦©ed sŒšg äom‡‚ew o¸modif›d <em>.po</em> ftØbaddedØyou¸s™e. ThloÿË moduË\' <¨h»f="@expÜt">expÜt</a> f—tu» g’”©e fe äom you¸s™e\' Œª¦©ed sŒšgs,h© cªƒ™h” bsh¬ed w™h oth” Üƒd™ed ofæšby‡ G‘‹xˆŒª¦©iÚƒd™Ü.', 
	`¬¿y
('@impÜt' => 
	`u¾
('admin/build/translate/import'), '@export' => url('admin/build/translate/export'))) .'</p>';

30 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@loÿË">LoÿË moduË</a>.', 
	`¬¿y
('@locale' => 'http://drupal.org/handbook/modules/locale/')) .'</p>';

31  
$ouut
;

33 
$ouut
 = '<p>'. 
	`t
("This…age…rovides‡n overview of your site'sƒnabled†anguages. If multiple†anguages‡re‡vailable‡ndƒnabled,heext on your site interface may beranslated,„egistered users may selectheir…referred†anguage onhe <em>My‡ccount</em>…age,‡nd site‡uthors may indicate‡ specific†anguage when creating…osts. The site's default†anguage is used for‡nonymous visitors‡nd for users who have‚ot selected‡…referred†anguage.") .'</p>';

34 
$ouut
 .ğ'<p>'. 
	`t
('Forƒach†anguage‡vailable onhe site, usehe <em>edit</em>†inko configure†anguage details, including‚ame,‡n optional†anguage-specific…ath or domain,‡nd whetherhe†anguage is‚atively…resentedƒither†eft-to-right or„ight-to-left. These†anguages‡lso‡ppear inhe <em>Language</em> selection when creating‡…ost of‡ contentype with multilingual support.') .'</p>';

35 
$ouut
 .ğ'<p>'. 
	`t
('U£h<¨h»f="@add-Ïnguage">add†ªguag·ge</a>Ø’abË‡dd™iÚ®†ªguage ×nd‡utom©iÿÎy impÜˆfe äom‡¿n¦©iÚ…ackage, iàavaabË),h<¨h»f="@£¬ch">Œª¦©š‹rçû…age</a>Øloÿ‹ sŒšg fÜ mªu®¿n¦©iÚ, o¸th<¨h»f="@impÜt">impÜˆ·ge</a>Øadd¿n¦©iÚ äom individu® <em>.po</em> fes. A‚umb” oàcÚŒibu‹d¿n¦©iÚ…ackage cÚššg <em>.po</em> fe ¬avaabË oÀth<¨h»f="@Œª¦©iÚs">Dru·l.Üg¿n¦©iÚ ·ge</a>.', 
	`¬¿y
('@add-Ïnguage' => 
	`u¾
('admin/settings/language/add'), '@search' => url('admin/build/translate/search'), '@import' => url('admin/build/translate/import'), '@translations' => 'http://drupal.org/project/translations')) .'</p>';

36  
$ouut
;

38  '<p>'. 
	`t
('Add‡ll†anguageso be supported by your site. If your desired†anguage is‚ot‡vailable inhe <em>Language‚ame</em> drop-down, click <em>Custom†anguage</em>‡nd…rovide‡†anguage code‡nd other details manually. When…roviding‡†anguage code manually, be sureoƒnter‡ standardized†anguage code, sincehis code may be used by browserso determine‡n‡ppropriate display†anguage.') .'</p>';

40 
$ouut
 = '<p>'. 
	`t
("Language‚egotiation settings determinehe site's…resentation†anguage. Available options include:") .'</p>';

41 
$ouut
 .ğ'<ul><li>'. 
	`t
('<strong>None.</strong> The default†anguage is used for site…resentation,hough users may (optionally) select‡…referred†anguage onhe <em>My Account</em>…age. (User†anguage…references will be used for siteƒ-mails, if‡vailable.)') .'</li>';

42 
$ouut
 .ğ'<li>'. 
	`t
('<strong>Path…refix only.</strong> The…resentation†anguage is determined byƒxamininghe…ath for‡†anguage code or other custom stringhat matcheshe…ath…refix (if‡ny) specified forƒach†anguage. If‡ suitable…refix is‚ot identified,he default†anguage is used. <em>Example: "example.com/de/contact" sets…resentation†anguageo German based onhe use of "de" withinhe…ath.</em>') .'</li>';

43 
$ouut
 .ğ'<li>'. 
	`t
("<strong>Path…refix with†anguage fallback.</strong> The…resentation†anguage is determined byƒxamininghe…ath for‡†anguage code or other custom stringhat matcheshe…ath…refix (if‡ny) specified forƒach†anguage. If‡ suitable…refix is‚ot identified,he display†anguage is determined byhe user's†anguage…references fromhe <em>My Account</em>…age, or byhe browser's†anguage settings. If‡…resentation†anguage cannot be determined,he default†anguage is used.") .'</li>';

44 
$ouut
 .ğ'<li>'. 
	`t
('<strong>Domain‚ame only.</strong> The…resentation†anguage is determined byƒxamininghe domain usedo‡ccesshe site,‡nd comparing itohe†anguage domain (if‡ny) specified forƒach†anguage. If‡ match is‚ot identified,he default†anguage is used. <em>Example: "http://de.example.com/contact" sets…resentation†anguageo German based onhe use of "http://de.example.com" inhe domain.</em>') .'</li></ul>';

45 
$ouut
 .ğ'<p>'. 
	`t
('Th·th…»fix o¸domaš‚amfÜ‡†ªguagmay b£ˆbyƒd™šgh<¨h»f="@Ïnguages">avaabË†ªguages</a>. IÀthab£nû oàª‡µrİrŸ‹ m©ch,hs™i di¥Ïyed iÀth<¨h»f="@Ïnguages">deçuÉ†ªguage</a>.', 
	`¬¿y
('@Ïnguages' => 
	`u¾
('admin/settings/language'))) .'</p>';

46  
$ouut
;

48 
$ouut
 = '<p>'. 
	`t
('This…age…rovides‡n overview of‡vailableranslatable strings. Drupal displaysranslatable strings inext groups; modules may define‡dditionalext groups containing otherranslatable strings. Becauseext groups…rovide‡ method of grouping„elated strings,hey‡re often usedo focusranslationƒfforts on specific‡reas ofhe Drupal interface.') .'</p>';

49 
$ouut
 .ğ'<p>'. 
	`t
('Rev›wh<¨h»f="@Ïnguages">Ïnguage ·ge</a> fÜ mÜšfÜm©iÚ oÀaddšg suµÜˆfÜ‡dd™iÚ®†ªguages.', 
	`¬¿y
('@Ïnguages' => 
	`u¾
('admin/settings/language'))) .'</p>';

50  
$ouut
;

52 
$ouut
 = '<p>'. 
	`t
('This…age importsheranslated strings contained in‡n individual Gettext Portable Object (<em>.po</em>) file. Normally distributed‡s…art of‡ranslation…ackage (eachranslation…ackage may contain several <em>.po</em> files),‡ <em>.po</em> file may‚eedo be imported‡fter off-lineƒditing in‡ Gettextranslationƒditor. Importing‡n individual <em>.po</em> file may be‡†engthy…rocess.') .'</p>';

53 
$ouut
 .ğ'<p>'. 
	`t
('NÙth©h<em>.po</em> fe w™hš‡¿n¦©iÚ…ackag¬impÜ‹d‡utom©iÿÎy (iàavaabËèwh’‚ew moduË Üheme ¬’abËd, o¸a Ãw†ªguage ¬added. Sšûhi ·gÚly‡Îow thimpÜˆoàÚ<em>.po</em> f©‡ime, iˆmay bsim¶”ØdowÆßd‡ndƒxŒaù‡¿n¦©iÚ…ackagštØyou¸Dru·Èš¡®ÏtiÚ dœeùÜy‡nd <¨h»f="@Ïnguage-add">addhÏnguage</a> (which‡utom©iÿÎy impÜt ®È<em>.po</em> fe w™hšh·ckage). T¿n¦©iÚ…ackage ¬avaabË fÜ dowÆßd oÀth<¨h»f="@Œª¦©iÚs">Dru·ÈŒª¦©iÚ…age</a>.', 
	`¬¿y
('@Ïnguage-add' => 
	`u¾
('admin/settings/language/add'), '@translations' => 'http://drupal.org/project/translations')) .'</p>';

54  
$ouut
;

56  '<p>'. 
	`t
('This…ageƒxportsheranslated strings used by your site. Anƒxport file may be in Gettext Portable Object (<em>.po</em>) form, which includes bothhe original string‡ndheranslation (usedo shareranslations with others), or in Gettext Portable Object Template (<em>.pot</em>) form, which includeshe original strings only (usedo create‚ewranslations with‡ Gettextranslationƒditor).') .'</p>';

58  '<p>'. 
	`t
('Thi ·g®low ¨Œª¦©ÜØ£¬ch fÜ s³cifiøŒª¦©ed‡nd uÁ¿n¦©ed sŒšgs,‡nd i u£d wh’ c»©šg o¸ed™šg¿n¦©iÚs. (NÙe: FÜ¿n¦©iÚask švŞvšg mªy sŒšgs, iˆmay bmÜcÚv’›ÁØ<¨h»f="@expÜt">expÜt</a> sŒšg fÜ off-lšed™šg iÀ¨desktİ G‘‹xˆŒª¦©iÚƒd™Ü.èS—rche may blim™edØ¡ršg found w™hš‡ s³cifiø‹xˆgrou°Ü iÀ¨¥ecifiøÏnguage.', 
	`¬¿y
('@expÜt' => 
	`u¾
('admin/build/translate/export'))) .'</p>';

60 ià(
$¬g
[4] == 'locale' && $arg[5] == 0) {

61  '<p>'. 
	`t
('Thi block i Úly showÀià<¨h»f="@Ïnguages">©†—¡wØÏnguage ¬’abËd</a>‡nd <¨h»f="@cÚfigu¿tiÚ">ÏnguagÃgÙŸtiÚ</a> i £ˆtØsom‘hšg oth”hª <em>NÚe</em>.', 
	`¬¿y
('@Ïnguages' => 
	`u¾
('admin/settings/language'), '@configuration' => url('admin/settings/language/configure'))) .'</p>';

65 
	}
}

73 
funùiÚ
 
	$loÿË_m’u
() {

75 
$™ems
['admš/£‰šgs/Ïnguage'] = 
	`¬¿y
(

79 '·g¬gum’ts' => 
	`¬¿y
('drupal_get_form', 'locale_languages_overview_form'),

80 'acûs ¬gum’ts' => 
	`¬¿y
('administer†anguages'),

82 
$™ems
['admš/£‰šgs/Ïnguage/ov”v›w'] = 
	`¬¿y
(

85 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

87 
$™ems
['admš/£‰šgs/Ïnguage/add'] = 
	`¬¿y
(

90 '·g¬gum’ts' => 
	`¬¿y
('locale_languages_add_screen'),

91 'acûs ¬gum’ts' => 
	`¬¿y
('administer†anguages'),

93 'ty³' => 
MENU_LOCAL_TASK
,

95 
$™ems
['admš/£‰šgs/Ïnguage/cÚfigu»'] = 
	`¬¿y
(

98 '·g¬gum’ts' => 
	`¬¿y
('drupal_get_form', 'locale_languages_configure_form'),

99 'acûs ¬gum’ts' => 
	`¬¿y
('administer†anguages'),

101 'ty³' => 
MENU_LOCAL_TASK
,

103 
$™ems
['admš/£‰šgs/Ïnguage/ed™/%'] = 
	`¬¿y
(

106 '·g¬gum’ts' => 
	`¬¿y
('drupal_get_form', 'locale_languages_edit_form', 4),

107 'acûs ¬gum’ts' => 
	`¬¿y
('administer†anguages'),

108 'ty³' => 
MENU_CALLBACK
,

110 
$™ems
['admš/£‰šgs/Ïnguage/d–‘e/%'] = 
	`¬¿y
(

113 '·g¬gum’ts' => 
	`¬¿y
('drupal_get_form', 'locale_languages_delete_form', 4),

114 'acûs ¬gum’ts' => 
	`¬¿y
('administer†anguages'),

115 'ty³' => 
MENU_CALLBACK
,

119 
$™ems
['admš/bud/Œª¦©e'] = 
	`¬¿y
(

123 '·g¬gum’ts' => 
	`¬¿y
('locale_translate_overview_screen'),

124 'acûs ¬gum’ts' => 
	`¬¿y
('translate interface'),

126 
$™ems
['admš/bud/Œª¦©e/ov”v›w'] = 
	`¬¿y
(

129 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

131 
$™ems
['admš/bud/Œª¦©e/£¬ch'] = 
	`¬¿y
(

134 'ty³' => 
MENU_LOCAL_TASK
,

136 '·g¬gum’ts' => 
	`¬¿y
('locale_translate_seek_screen'),

137 'acûs ¬gum’ts' => 
	`¬¿y
('translate interface'),

139 
$™ems
['admš/bud/Œª¦©e/impÜt'] = 
	`¬¿y
(

142 '·g¬gum’ts' => 
	`¬¿y
('drupal_get_form', 'locale_translate_import_form'),

143 'acûs ¬gum’ts' => 
	`¬¿y
('translate interface'),

145 'ty³' => 
MENU_LOCAL_TASK
,

147 
$™ems
['admš/bud/Œª¦©e/expÜt'] = 
	`¬¿y
(

150 '·g¬gum’ts' => 
	`¬¿y
('locale_translate_export_screen'),

151 'acûs ¬gum’ts' => 
	`¬¿y
('translate interface'),

153 'ty³' => 
MENU_LOCAL_TASK
,

155 
$™ems
['admš/bud/Œª¦©e/ed™/%'] = 
	`¬¿y
(

158 '·g¬gum’ts' => 
	`¬¿y
('drupal_get_form', 'locale_translate_edit_form', 4),

159 'acûs ¬gum’ts' => 
	`¬¿y
('translate interface'),

160 'ty³' => 
MENU_CALLBACK
,

162 
$™ems
['admš/bud/Œª¦©e/d–‘e/%'] = 
	`¬¿y
(

165 '·g¬gum’ts' => 
	`¬¿y
('locale_translate_delete_page', 4),

166 'acûs ¬gum’ts' => 
	`¬¿y
('translate interface'),

167 'ty³' => 
MENU_CALLBACK
,

170  
$™ems
;

171 
	}
}

176 
funùiÚ
 
	$loÿË_šc_ÿÎback
() {

177 
$¬gs
 = 
	`func_g‘_¬gs
();

178 
$funùiÚ
 = 
	`¬¿y_shiá
(
$¬gs
);

179 
šşude_Úû
 './includes/locale.inc';

180  
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
$¬gs
);

181 
	}
}

186 
funùiÚ
 
	$loÿË_³rm
() {

187  
	`¬¿y
('administer†anguages', 'translate interface');

188 
	}
}

193 
funùiÚ
 
loÿË_loÿË
(
$İ
 = 'groups') {

194 
$İ
) {

196  
¬¿y
('deçuÉ' => 
t
('Built-in interface'));

203 
funùiÚ
 
	$loÿË_u£r
(
$ty³
, 
$ed™
, &
$u£r
, 
$ÿ‹gÜy
 = 
NULL
) {

204 
glob®
 
$Ïnguage
;

208 ià(
	`v¬ŸbË_g‘
('Ïnguage_couÁ', 1è> 1 && (
$ty³
 =ğ'»gi¡”' && 
	`u£r_acûss
('admši¡” u£rs'è|| $ty³ =ğ'fÜm' && 
$ÿ‹gÜy
 == 'account' )) {

209 
$Ïnguages
 = 
	`Ïnguage_li¡
('enabled');

210 
$Ïnguages
 = $languages[1];

213 
$u£r_´eã¼ed_Ïnguage
 = 
$u£r
 ? 
	`u£r_´eã¼ed_Ïnguage
($u£rè: 
$Ïnguage
;

215 
$Çmes
 = 
	`¬¿y
();

216 
	`fÜ—ch
 (
$Ïnguages
 
as
 
$Ïngcode
 => 
$™em
) {

217 
$Çme
 = 
	`t
(
$™em
->
Çme
);

218 
$Çmes
[
	`check_¶aš
(
$Ïngcode
)] = check_¶aš(
$Çme
 . (
$™em
->
Çtive
 != $name ? ' ('. $item->native .')' : ''));

220 
$fÜm
['loÿË'] = 
	`¬¿y
(

222 '#t™Ë' => 
	`t
('Language settings'),

227 
$mode
 = 
	`v¬ŸbË_g‘
('Ïnguage_ÃgÙŸtiÚ', 
LANGUAGE_NEGOTIATION_NONE
);

228 
$fÜm
['loÿË']['Ïnguage'] = 
	`¬¿y
(

229 '#ty³' => (
	`couÁ
(
$Çmes
) <= 5 ? 'radios' : 'select'),

230 '#t™Ë' => 
	`t
('Language'),

231 '#deçuÉ_v®ue' => 
	`check_¶aš
(
$u£r_´eã¼ed_Ïnguage
->
Ïnguage
),

232 '#İtiÚs' => 
$Çmes
,

233 '#desütiÚ' => (
$mode
 =ğ
LANGUAGE_NEGOTIATION_PATH
è? 
	`t
("This‡ccount's default†anguage forƒ-mails,‡nd…referred†anguage for site…resentation.") :("This‡ccount's default†anguage forƒ-mails."),

235  
$fÜm
;

237 
	}
}

242 
funùiÚ
 
	$loÿË_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

243 
$fÜm_id
) {

247 
$fÜm
['Ïnguage'] = 
	`¬¿y
(

249 '#t™Ë' => 
	`t
('Language'),

250 '#İtiÚs' => 
	`¬¿y
('' => 
	`t
('AÎ†ªguages')è+ 
	`loÿË_Ïnguage_li¡
('name'),

251 '#deçuÉ_v®ue' => 
$fÜm
['language']['#value'],

253 '#desütiÚ' => 
	`t
('A…ath‡lias set for‡ specific†anguage will‡lways be used when displayinghis…age inhat†anguage,‡ndakes…recedence over…ath‡liases set for <em>All†anguages</em>.'),

259 ià(
	`is£t
(
$fÜm
['identity']['type'])) {

260 
$fÜm
['wÜkæow']['Ïnguage_cÚ‹Á_ty³'] = 
	`¬¿y
(

262 '#t™Ë' => 
	`t
('Multilingual support'),

263 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('Ïnguage_cÚ‹Á_ty³_'. 
$fÜm
['#node_ty³']->
ty³
, 0),

264 '#İtiÚs' => 
	`¬¿y
(
	`t
('Disabled'),('Enabled')),

265 '#desütiÚ' => 
	`t
('EÇbË muÉšgu® suµÜˆfÜhi cÚ‹Áy³. Ià’abËd,‡†ªguag£ËùiÚ f›ld wÈbaddedØthed™šg fÜm,‡Îowšg youØ£Ëù from oÃ oàth<¨h»f="!Ïnguages">’abËd†ªguages</a>. Iàdi§bËd,‚ew…o¡ ¬§ved w™hhdeçuÉ†ªguage. Exi¡šg cÚ‹Á wÈnÙ bafãùed by chªgšghi İtiÚ.', 
	`¬¿y
('!Ïnguages' => 
	`u¾
('admin/settings/language'))),

272 ià(
	`is£t
(
$fÜm
['#id']) && $form['#id'] == 'node-form') {

273 ià(
	`is£t
(
$fÜm
['#node']->
ty³
è&& 
	`v¬ŸbË_g‘
('language_content_type_'. $form['#node']->type, 0)) {

274 
$fÜm
['Ïnguage'] = 
	`¬¿y
(

276 '#t™Ë' => 
	`t
('Language'),

277 '#deçuÉ_v®ue' => (
	`is£t
(
$fÜm
['#node']->
Ïnguage
) ? $form['#node']->language : ''),

278 '#İtiÚs' => 
	`¬¿y
('' => 
	`t
('LªguagÃuŒ®')è+ 
	`loÿË_Ïnguage_li¡
('name'),

282 
	`–£if
 (!
	`is£t
(
$fÜm
['#node']->
nid
)) {

283 
$deçuÉ
 = 
	`Ïnguage_deçuÉ
();

284 
$fÜm
['Ïnguage'] = 
	`¬¿y
(

286 '#v®ue' => 
$deçuÉ
->
Ïnguage


291 
	}
}

296 
funùiÚ
 
	$loÿË_theme
() {

297  
	`¬¿y
(

298 'loÿË_Ïnguages_ov”v›w_fÜm' => 
	`¬¿y
(

299 '¬gum’ts' => 
	`¬¿y
('form' =>‡rray()),

302 
	}
}

307 
funùiÚ
 
	$loÿË_node_ty³
(
$İ
, 
$šfo
) {

308 ià(
$İ
 == 'delete') {

309 
	`v¬ŸbË_d–
('Ïnguage_cÚ‹Á_ty³_'. 
$šfo
->
ty³
);

311 
	}
}

330 
funùiÚ
 
	$loÿË
(
$¡ršg
 = 
NULL
, 
$Ïngcode
 = NULL, 
$»£t
 = 
FALSE
) {

331 
glob®
 
$Ïnguage
;

332 
$loÿË_t
;

334 ià(
$»£t
) {

336 
$loÿË_t
 = 
NULL
;

339 ià(!
	`is£t
(
$¡ršg
)) {

341  
$loÿË_t
;

344 
$Ïngcode
 = 
	`is£t
($Ïngcodeè? $Ïngcod: 
$Ïnguage
->
Ïnguage
;

347 ià(!
	`is£t
(
$loÿË_t
[
$Ïngcode
])) {

348 
$loÿË_t
[
$Ïngcode
] = 
	`¬¿y
();

353 ià(
	`v¬ŸbË_g‘
('locale_cache_strings', 1) == 1) {

354 ià(
$ÿche
 = 
	`ÿche_g‘
('loÿË:'. 
$Ïngcode
, 'cache')) {

355 
$loÿË_t
[
$Ïngcode
] = 
$ÿche
->
d©a
;

357 
	`–£if
 (
	`lock_acquœe
('loÿË_ÿche_' . 
$Ïngcode
)) {

361 
$»suÉ
 = 
	`db_qu”y
("SELECT s.sourû,.Œª¦©iÚ,.ÏnguagFROM {loÿËs_sourû} s LEFT JOIN {loÿËs_rg‘} ON s.lid =.lid AND.Ïnguagğ'%s' WHERE s.‹xtgrou°ğ'deçuÉ' AND s.v”siÚ = '%s' AND LENGTH(s.sourûè< 75", 
$Ïngcode
, 
VERSION
);

362 
$d©a
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

363 
$loÿË_t
[
$Ïngcode
][
$d©a
->
sourû
] = (
	`em±y
($d©a->
Œª¦©iÚ
è? 
TRUE
 : $data->translation);

365 
	`ÿche_£t
('loÿË:'. 
$Ïngcode
, 
$loÿË_t
[$langcode]);

366 
	`lock_»Ëa£
('loÿË_ÿche_' . 
$Ïngcode
);

372 ià(!
	`is£t
(
$loÿË_t
[
$Ïngcode
][
$¡ršg
])) {

375 
$Œª¦©iÚ
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT s.lid,.Œª¦©iÚ, s.v”siÚ FROM {loÿËs_sourû} s LEFT JOIN {loÿËs_rg‘} ON s.lid =.lid AND.Ïnguagğ'%s' WHERE s.sourû = '%s' AND s.‹xtgrou°ğ'deçuÉ'", 
$Ïngcode
, 
$¡ršg
));

376 ià(
$Œª¦©iÚ
) {

379 
$loÿË_t
[
$Ïngcode
][
$¡ršg
] = (
	`em±y
(
$Œª¦©iÚ
->
Œª¦©iÚ
è? 
TRUE
 : $translation->translation);

381 ià(
$Œª¦©iÚ
->
v”siÚ
 !ğ
VERSION
) {

385 
	`db_qu”y
("UPDATE {loÿËs_sourû} SET v”siÚ = '%s' WHERE†id = %d", 
VERSION
, 
$Œª¦©iÚ
->
lid
);

386 
	`ÿche_ş—r_®l
('loÿË:', 'ÿche', 
TRUE
);

391 
	`db_qu”y
("INSERT INTO {loÿËs_sourû} (loÿtiÚ, sourû,extgroup, v”siÚèVALUES ('%s', '%s', 'deçuÉ', '%s')", 
	`»que¡_uri
(), 
$¡ršg
, 
VERSION
);

392 
$loÿË_t
[
$Ïngcode
][
$¡ršg
] = 
TRUE
;

394 
	`ÿche_ş—r_®l
('loÿË:', 'ÿche', 
TRUE
);

398  (
$loÿË_t
[
$Ïngcode
][
$¡ršg
] ==ğ
TRUE
 ? $string : $locale_t[$langcode][$string]);

399 
	}
}

412 
funùiÚ
 
	$loÿË_g‘_¶u¿l
(
$couÁ
, 
$Ïngcode
 = 
NULL
) {

413 
glob®
 
$Ïnguage
;

414 
$loÿË_fÜmuÏ
, 
$¶u¿ls
 = 
	`¬¿y
();

416 
$Ïngcode
 = $Ïngcod? $Ïngcod: 
$Ïnguage
->
Ïnguage
;

418 ià(!
	`is£t
(
$¶u¿ls
[
$Ïngcode
][
$couÁ
])) {

419 ià(!
	`is£t
(
$loÿË_fÜmuÏ
)) {

420 
$Ïnguage_li¡
 = 
	`Ïnguage_li¡
();

421 
$loÿË_fÜmuÏ
[
$Ïngcode
] = 
$Ïnguage_li¡
[$Ïngcode]->
fÜmuÏ
;

423 ià(
$loÿË_fÜmuÏ
[
$Ïngcode
]) {

424 
$n
 = 
$couÁ
;

425 
$¶u¿ls
[
$Ïngcode
][
$couÁ
] = @
	`ev®
('»tuº iÁv®('. 
$loÿË_fÜmuÏ
[$langcode] .');');

426  
$¶u¿ls
[
$Ïngcode
][
$couÁ
];

429 
$¶u¿ls
[
$Ïngcode
][
$couÁ
] = -1;

433  
$¶u¿ls
[
$Ïngcode
][
$couÁ
];

434 
	}
}

440 
funùiÚ
 
	$loÿË_Ïnguage_Çme
(
$Ïng
) {

441 
$li¡
 = 
NULL
;

442 ià(!
	`is£t
(
$li¡
)) {

443 
$li¡
 = 
	`loÿË_Ïnguage_li¡
();

445  (
$Ïng
 && 
	`is£t
(
$li¡
[$Ïng])è? $li¡[$Ïng] : 
	`t
('All');

446 
	}
}

457 
funùiÚ
 
loÿË_Ïnguage_li¡
(
$f›ld
 = 'Çme', 
$®l
 = 
FALSE
) {

458 ià(
$®l
) {

459 
$Ïnguages
 = 
Ïnguage_li¡
();

462 
	g$Ïnguages
 = 
Ïnguage_li¡
('enabled');

463 
	g$Ïnguages
 = 
$Ïnguages
[1];

465 
	g$li¡
 = 
¬¿y
();

466 
fÜ—ch
 (
$Ïnguages
 
as
 
$Ïnguage
) {

467 
	g$li¡
[
$Ïnguage
->
Ïnguage
] = (
$f›ld
 =ğ'Çme'è? 
t
($Ïnguage->
Çme
) : $language->$field;

469  
	g$li¡
;

482 
funùiÚ
 
	$loÿË_sy¡em_upd©e
(
$compÚ’ts
) {

483 
šşude_Úû
 'includes/locale.inc';

484 ià(
$b©ch
 = 
	`loÿË_b©ch_by_compÚ’t
(
$compÚ’ts
)) {

485 
	`b©ch_£t
(
$b©ch
);

487 
	}
}

497 
funùiÚ
 
	$loÿË_upd©e_js_fes
() {

498 
glob®
 
$Ïnguage
;

500 
$dœ
 = 
	`fe_ü—‹_·th
(
	`v¬ŸbË_g‘
('locale_js_directory', 'languages'));

501 
$·r£d
 = 
	`v¬ŸbË_g‘
('javasüt_·r£d', 
	`¬¿y
());

506 
$javasüt
 = 
	`dru·l_add_js
(
NULL
, NULL, NULL);

507 
$fes
 = 
$Ãw_fes
 = 
FALSE
;

509 
	`fÜ—ch
 (
$javasüt
 
as
 
$scİe
) {

510 
	`fÜ—ch
 (
$scİe
 
as
 
$ty³
 => 
$d©a
) {

511 ià(
$ty³
 != 'setting' && $type != 'inline') {

512 
	`fÜ—ch
 (
$d©a
 
as
 
$f•©h
 => 
$šfo
) {

513 
$fes
 = 
TRUE
;

514 ià(!
	`š_¬¿y
(
$f•©h
, 
$·r£d
)) {

516 ià(
	`sub¡r
(
$f•©h
, 0, 
	`¡¾’
(
$dœ
)) != $dir) {

517 
	`loÿË_šc_ÿÎback
('_loÿË_·r£_js_fe', 
$f•©h
);

518 
$·r£d
[] = 
$f•©h
;

519 
$Ãw_fes
 = 
TRUE
;

530 ià(
$Ãw_fes
) {

531 
$·r£d
 +ğ
	`loÿË_šc_ÿÎback
('_locale_invalidate_js');

535 ià(!
	`em±y
(
$·r£d
['»äesh:'. 
$Ïnguage
->
Ïnguage
])) {

538 ià(
	`loÿË_šc_ÿÎback
('_locale_rebuild_js')) {

539 
	`un£t
(
$·r£d
['»äesh:'. 
$Ïnguage
->
Ïnguage
]);

542 
	`v¬ŸbË_£t
('javasüt_·r£d', 
$·r£d
);

546 ià(
$Ãw_fes
) {

547 
	`v¬ŸbË_£t
('javasüt_·r£d', 
$·r£d
);

551 ià(
$fes
 && !
	`em±y
(
$Ïnguage
->
javasüt
)) {

552 
	`dru·l_add_js
(
$dœ
 .'/'. 
$Ïnguage
->
Ïnguage
 .'_'. $Ïnguage->
javasüt
 .'.js', 'core');

554 
	}
}

563 
funùiÚ
 
loÿË_block
(
$İ
 = 'li¡', 
$d–
 = 0) {

564 ià(
$İ
 == 'list') {

565 
$block
[0]['šfo'] = 
t
('Language switcher');

567 
	g$block
[0]['ÿche'] = 
BLOCK_NO_CACHE
;

568  
	g$block
;

573 
–£if
 (
$İ
 =ğ'v›w' && 
v¬ŸbË_g‘
('Ïnguage_couÁ', 1è> 1 && v¬ŸbË_g‘('Ïnguage_ÃgÙŸtiÚ', 
LANGUAGE_NEGOTIATION_NONE
) != LANGUAGE_NEGOTIATION_NONE) {

574 
$·th
 = 
dru·l_is_äÚt_·ge
(è? '<äÚt>' : 
$_GET
['q'];

575 
	g$Ïnguages
 = 
Ïnguage_li¡
('enabled');

576 
	g$lšks
 = 
¬¿y
();

577 
fÜ—ch
 (
$Ïnguages
[1] 
as
 
$Ïnguage
) {

578 
	g$lšks
[
$Ïnguage
->
Ïnguage
] = 
¬¿y
(

579 'h»f' => 
$·th
,

580 't™Ë' => 
$Ïnguage
->
Çtive
,

581 'Ïnguage' => 
$Ïnguage
,

582 '©Œibu‹s' => 
¬¿y
('class' => 'language-link'),

590 
dru·l_®‹r
('Œª¦©iÚ_lšk', 
$lšks
, 
$·th
);

592 
	g$block
['subjeù'] = 
t
('Languages');

593 
	g$block
['cÚ‹Á'] = 
theme
('lšks', 
$lšks
, 
¬¿y
());

594  
	g$block
;

	@/srv/http/subs/notes/www/modules/menu/menu.admin.inc

1 <?
php


12 
funùiÚ
 
	$m’u_ov”v›w_·ge
() {

13 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {menu_custom} ORDER BYitle");

14 
$cÚ‹Á
 = 
	`¬¿y
();

15 
$m’u
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

16 
$m’u
['href'] = 'admin/build/menu-customize/'. $menu['menu_name'];

17 
$m’u
['loÿlized_İtiÚs'] = 
	`¬¿y
();

18 
$m’u
['desütiÚ'] = 
	`f‹r_xss_admš
($menu['description']);

19 
$cÚ‹Á
[] = 
$m’u
;

21  
	`theme
('admš_block_cÚ‹Á', 
$cÚ‹Á
);

22 
	}
}

30 
funùiÚ
 
	$m’u_ov”v›w_fÜm
(&
$fÜm_¡©e
, 
$m’u
) {

31 
glob®
 
$m’u_admš
;

32 
$sql
 = "

33 
SELECT
 
m
.
lßd_funùiÚs
, m.
to_¬g_funùiÚs
, m.
acûss_ÿÎback
, m.
acûss_¬gum’ts
, m.
·ge_ÿÎback
, m.
·ge_¬gum’ts
, m.
t™Ë
, m.
t™Ë_ÿÎback
, m.
t™Ë_¬gum’ts
, m.
ty³
, m.
desütiÚ
, 
ml
.*

34 
FROM
 {
m’u_lšks
} 
ml
 
LEFT
 
JOIN
 {
m’u_rou‹r
} 
m
 
ON
 m.
·th
 = ml.
rou‹r_·th


35 
WHERE
 
ml
.
m’u_Çme
 = '%s'

36 
ORDER
 
BY
 
p1
 
ASC
, 
p2
 ASC, 
p3
 ASC, 
p4
 ASC, 
p5
 ASC, 
p6
 ASC, 
p7
 ASC, 
p8
 ASC, 
p9
 ASC";

37 
$»suÉ
 = 
	`db_qu”y
(
$sql
, 
$m’u
['menu_name']);

38 
$Œ“
 = 
	`m’u_Œ“_d©a
(
$»suÉ
);

39 
$node_lšks
 = 
	`¬¿y
();

40 
	`m’u_Œ“_cŞËù_node_lšks
(
$Œ“
, 
$node_lšks
);

42 
$m’u_admš
 = 
TRUE
;

43 
	`m’u_Œ“_check_acûss
(
$Œ“
, 
$node_lšks
);

44 
$m’u_admš
 = 
FALSE
;

46 
$fÜm
 = 
	`_m’u_ov”v›w_Œ“_fÜm
(
$Œ“
);

47 
$fÜm
['#m’u'] = 
$m’u
;

48 ià(
	`–em’t_chd»n
(
$fÜm
)) {

49 
$fÜm
['subm™'] = 
	`¬¿y
(

51 '#v®ue' => 
	`t
('Save configuration'),

55 
$fÜm
['em±y_m’u'] = 
	`¬¿y
('#v®ue' => 
	`t
('There‡re‚o menu items yet.'));

57  
$fÜm
;

58 
	}
}

63 
funùiÚ
 
	$_m’u_ov”v›w_Œ“_fÜm
(
$Œ“
) {

64 
$fÜm
 = 
	`¬¿y
('#Œ“' => 
TRUE
);

65 
	`fÜ—ch
 (
$Œ“
 
as
 
$d©a
) {

66 
$t™Ë
 = '';

67 
$™em
 = 
$d©a
['link'];

69 ià(
$™em
 && $item['hidden'] >= 0) {

70 
$mlid
 = 'mlid:'. 
$™em
['mlid'];

71 
$fÜm
[
$mlid
]['#™em'] = 
$™em
;

72 
$fÜm
[
$mlid
]['#©Œibu‹s'] = 
$™em
['hidd’'] ? 
	`¬¿y
('class' => 'menu-disabled') :‡rray('class' => 'menu-enabled');

73 
$fÜm
[
$mlid
]['t™Ë']['#v®ue'] = 
	`l
(
$™em
['t™Ë'], $™em['h»f'], $™em['loÿlized_İtiÚs']è. ($™em['hidd’'] ? ' ('. 
	`t
('disabled') .')' : '');

74 
$fÜm
[
$mlid
]['hidd’'] = 
	`¬¿y
(

76 '#deçuÉ_v®ue' => !
$™em
['hidden'],

78 
$fÜm
[
$mlid
]['ex·nded'] = 
	`¬¿y
(

80 '#deçuÉ_v®ue' => 
$™em
['expanded'],

82 
$fÜm
[
$mlid
]['weight'] = 
	`¬¿y
(

85 '#deçuÉ_v®ue' => 
	`is£t
(
$fÜm_¡©e
[
$mlid
]['weight']è? $fÜm_¡©e[$mlid]['weight'] : 
$™em
['weight'],

87 
$fÜm
[
$mlid
]['mlid'] = 
	`¬¿y
(

89 '#v®ue' => 
$™em
['mlid'],

91 
$fÜm
[
$mlid
]['¶id'] = 
	`¬¿y
(

93 '#deçuÉ_v®ue' => 
	`is£t
(
$fÜm_¡©e
[
$mlid
]['¶id']è? $fÜm_¡©e[$mlid]['¶id'] : 
$™em
['plid'],

97 
$İ”©iÚs
 = 
	`¬¿y
();

98 
$İ”©iÚs
['ed™'] = 
	`l
(
	`t
('ed™'), 'admš/bud/m’u/™em/'. 
$™em
['mlid'] .'/edit');

100 ià(
$™em
['module'] == 'menu' || $item['updated'] == 1) {

101 
$İ”©iÚs
['d–‘e'] = 
	`l
(
	`t
('d–‘e'), 'admš/bud/m’u/™em/'. 
$™em
['mlid'] .'/delete');

104 
	`–£if
 (
$™em
['module'] == 'system' && $item['customized']) {

105 
$İ”©iÚs
['»£t'] = 
	`l
(
	`t
('»£t'), 'admš/bud/m’u/™em/'. 
$™em
['mlid'] .'/reset');

108 
$fÜm
[
$mlid
]['İ”©iÚs'] = 
	`¬¿y
();

109 
	`fÜ—ch
 (
$İ”©iÚs
 
as
 
$İ
 => 
$v®ue
) {

110 
$fÜm
[
$mlid
]['İ”©iÚs'][
$İ
] = 
	`¬¿y
('#v®ue' => 
$v®ue
);

114 ià(
$d©a
['below']) {

115 
	`_m’u_ov”v›w_Œ“_fÜm
(
$d©a
['below']);

118  
$fÜm
;

119 
	}
}

129 
funùiÚ
 
	$m’u_ov”v›w_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

136 
$Üd”
 = 
	`¬¿y_æ
(
	`¬¿y_keys
(
$fÜm
['#post']));

137 
$fÜm
 = 
	`¬¿y_m”ge
(
$Üd”
, $form);

139 
$upd©ed_™ems
 = 
	`¬¿y
();

140 
$f›lds
 = 
	`¬¿y
('expanded', 'weight', 'plid');

141 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$mlid
) {

142 ià(
	`is£t
(
$fÜm
[
$mlid
]['#item'])) {

143 
$–em’t
 = 
$fÜm
[
$mlid
];

145 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
) {

146 ià(
$–em’t
[
$f›ld
]['#value'] != $element[$field]['#default_value']) {

147 
$–em’t
['#™em'][
$f›ld
] = $element[$field]['#value'];

148 
$upd©ed_™ems
[
$mlid
] = 
$–em’t
['#item'];

152 ià(
$–em’t
['hidden']['#value'] != $element['hidden']['#default_value']) {

153 
$–em’t
['#item']['hidden'] = !$element['hidden']['#value'];

154 
$upd©ed_™ems
[
$mlid
] = 
$–em’t
['#item'];

160 
	`fÜ—ch
 (
$upd©ed_™ems
 
as
 
$™em
) {

161 
$™em
['customized'] = 1;

162 
	`m’u_lšk_§ve
(
$™em
);

164 
	}
}

171 
funùiÚ
 
	$theme_m’u_ov”v›w_fÜm
(
$fÜm
) {

172 
	`dru·l_add_bËd¿g
('m’u-ov”v›w', 'm©ch', '·»Á', 'm’u-¶id', 'm’u-¶id', 'm’u-mlid', 
TRUE
, 
MENU_MAX_DEPTH
 - 1);

173 
	`dru·l_add_bËd¿g
('menu-overview', 'order', 'sibling', 'menu-weight');

175 
$h—d”
 = 
	`¬¿y
(

176 
	`t
('Menu item'),

177 
	`¬¿y
('d©a' => 
	`t
('Enabled'), 'class' => 'checkbox'),

178 
	`¬¿y
('d©a' => 
	`t
('Expanded'), 'class' => 'checkbox'),

179 
	`t
('Weight'),

180 
	`¬¿y
('d©a' => 
	`t
('Operations'), 'colspan' => '3'),

183 
$rows
 = 
	`¬¿y
();

184 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$mlid
) {

185 ià(
	`is£t
(
$fÜm
[
$mlid
]['hidden'])) {

186 
$–em’t
 = &
$fÜm
[
$mlid
];

188 
$İ”©iÚs
 = 
	`¬¿y
();

189 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$–em’t
['İ”©iÚs']è
as
 
$İ
) {

190 
$İ”©iÚs
[] = 
	`dru·l_»nd”
(
$–em’t
['İ”©iÚs'][
$İ
]);

192 
	`couÁ
(
$İ”©iÚs
) < 2) {

193 
$İ”©iÚs
[] = '';

197 
$–em’t
['plid']['#attributes']['class'] = 'menu-plid';

198 
$–em’t
['mlid']['#attributes']['class'] = 'menu-mlid';

199 
$–em’t
['weight']['#attributes']['class'] = 'menu-weight';

202 
$–em’t
['plid']['#type'] = 'hidden';

204 
$row
 = 
	`¬¿y
();

205 
$row
[] = 
	`theme
('šd’tiÚ', 
$–em’t
['#™em']['d•th'] - 1è. 
	`dru·l_»nd”
($element['title']);

206 
$row
[] = 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$–em’t
['hidden']), 'class' => 'checkbox');

207 
$row
[] = 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$–em’t
['expanded']), 'class' => 'checkbox');

208 
$row
[] = 
	`dru·l_»nd”
(
$–em’t
['weight']) . drupal_render($element['plid']) . drupal_render($element['mlid']);

209 
$row
 = 
	`¬¿y_m”ge
($row, 
$İ”©iÚs
);

211 
$row
 = 
	`¬¿y_m”ge
(
	`¬¿y
('d©a' => $row), 
$–em’t
['#attributes']);

212 
$row
['şass'] = !
	`em±y
($row['class']) ? $row['class'] .' draggable' : 'draggable';

213 
$rows
[] = 
$row
;

216 
$ouut
 = '';

217 ià(
$rows
) {

218 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('id' => 'menu-overview'));

220 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

221  
$ouut
;

222 
	}
}

227 
funùiÚ
 
	$m’u_ed™_™em
(&
$fÜm_¡©e
, 
$ty³
, 
$™em
, 
$m’u
) {

229 
$fÜm
['m’u'] = 
	`¬¿y
(

231 '#t™Ë' => 
	`t
('Menu settings'),

232 '#cŞÏpsibË' => 
FALSE
,

233 '#Œ“' => 
TRUE
,

235 '#©Œibu‹s' => 
	`¬¿y
('class' => 'menu-item-form'),

236 '#™em' => 
$™em
,

238 ià(
$ty³
 =ğ'add' || 
	`em±y
(
$™em
)) {

240 
$™em
 = 
	`¬¿y
('lšk_t™Ë' => '', 'mlid' => 0, '¶id' => 0, 'm’u_Çme' => 
$m’u
['menu_name'], 'weight' => 0, 'link_path' => '', 'options' =>‡rray(), 'module' => 'menu', 'expanded' => 0, 'hidden' => 0, 'has_children' => 0);

242 
	`fÜ—ch
 (
	`¬¿y
('lšk_·th', 'mlid', 'moduË', 'has_chd»n', 'İtiÚs'è
as
 
$key
) {

243 
$fÜm
['m’u'][
$key
] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$™em
[$key]);

246 
$fÜm
['m’u']['cu¡omized'] = 
	`¬¿y
('#type' => 'value', '#value' => 1);

247 
$fÜm
['m’u']['Üigš®_™em'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$™em
);

249 
$·th
 = 
$™em
['link_path'];

250 ià(
	`is£t
(
$™em
['options']['query'])) {

251 
$·th
 .ğ'?'. 
$™em
['options']['query'];

253 ià(
	`is£t
(
$™em
['options']['fragment'])) {

254 
$·th
 .ğ'#'. 
$™em
['options']['fragment'];

256 ià(
$™em
['module'] == 'menu') {

257 
$fÜm
['m’u']['lšk_·th'] = 
	`¬¿y
(

259 '#t™Ë' => 
	`t
('Path'),

260 '#deçuÉ_v®ue' => 
$·th
,

261 '#desütiÚ' => 
	`t
('Th·thhi m’u i‹m†šk to. Thi ÿÀbª iÁ”ÇÈDru·È·th such‡ %add-nodÜ‡Àex‹º® URL such‡ %dru·l. EÁ” %äÚˆtØlškØthäÚˆ·ge.', 
	`¬¿y
('%front' => '<front>', '%add-node' => 'node/add', '%drupal' => 'http://drupal.org')),

262 '#»quœed' => 
TRUE
,

264 
$fÜm
['d–‘e'] = 
	`¬¿y
(

266 '#v®ue' => 
	`t
('Delete'),

267 '#acûss' => 
$™em
['mlid'],

268 '#subm™' => 
	`¬¿y
('menu_item_delete_submit'),

273 
$fÜm
['m’u']['_·th'] = 
	`¬¿y
(

275 '#t™Ë' => 
	`t
('Path'),

276 '#desütiÚ' => 
	`l
(
$™em
['link_title'], $item['href'], $item['options']),

279 
$fÜm
['m’u']['lšk_t™Ë'] = 
	`¬¿y
('#type' => 'textfield',

280 '#t™Ë' => 
	`t
('Menu†inkitle'),

281 '#deçuÉ_v®ue' => 
$™em
['link_title'],

282 '#desütiÚ' => 
	`t
('The†inkext correspondingohis itemhat should‡ppear inhe menu.'),

283 '#»quœed' => 
TRUE
,

285 
$fÜm
['m’u']['desütiÚ'] = 
	`¬¿y
(

287 '#t™Ë' => 
	`t
('Description'),

288 '#deçuÉ_v®ue' => 
	`is£t
(
$™em
['options']['attributes']['title']) ? $item['options']['attributes']['title'] : '',

290 '#desütiÚ' => 
	`t
('The description displayed when hovering over‡ menu item.'),

292 
$fÜm
['m’u']['’abËd'] = 
	`¬¿y
(

294 '#t™Ë' => 
	`t
('Enabled'),

295 '#deçuÉ_v®ue' => !
$™em
['hidden'],

296 '#desütiÚ' => 
	`t
('Menu itemshat‡re‚otƒnabled will‚ot be†isted in‡ny menu.'),

298 
$fÜm
['m’u']['ex·nded'] = 
	`¬¿y
(

300 '#t™Ë' => 
	`t
('Expanded'),

301 '#deçuÉ_v®ue' => 
$™em
['expanded'],

302 '#desütiÚ' => 
	`t
('If selected‡ndhis menu item has children,he menu will‡lways‡ppearƒxpanded.'),

306 
$İtiÚs
 = 
	`m’u_·»Á_İtiÚs
(
	`m’u_g‘_m’us
(), 
$™em
);

307 
$deçuÉ
 = 
$™em
['menu_name'] .':'. $item['plid'];

308 ià(!
	`is£t
(
$İtiÚs
[
$deçuÉ
])) {

309 
$deçuÉ
 = 'navigation:0';

311 
$fÜm
['m’u']['·»Á'] = 
	`¬¿y
(

313 '#t™Ë' => 
	`t
('Parent item'),

314 '#deçuÉ_v®ue' => 
$deçuÉ
,

315 '#İtiÚs' => 
$İtiÚs
,

316 '#desütiÚ' => 
	`t
('Thmaximum d•th fÜ‡À™em‡nd‡Î it chd»Ài fixed‡ˆ!maxd•th. Somm’u i‹m may‚Ù bavaabË‡ ·»Á ià£Ëùšghem wouldƒxûedhi lim™.', 
	`¬¿y
('!maxd•th' => 
MENU_MAX_DEPTH
)),

317 '#©Œibu‹s' => 
	`¬¿y
('class' => 'menu-title-select'),

319 
$fÜm
['m’u']['weight'] = 
	`¬¿y
(

321 '#t™Ë' => 
	`t
('Weight'),

323 '#deçuÉ_v®ue' => 
$™em
['weight'],

324 '#desütiÚ' => 
	`t
('Optional. Inhe menu,he heavier items will sink‡ndhe†ighter items will be…ositioned‚earerheop.'),

326 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save'));

329  
$fÜm
;

330 
	}
}

335 
funùiÚ
 
	$m’u_ed™_™em_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

336 
$™em
 = &
$fÜm_¡©e
['values']['menu'];

337 
$nÜm®_·th
 = 
	`dru·l_g‘_nÜm®_·th
(
$™em
['link_path']);

338 ià(
$™em
['lšk_·th'] !ğ
$nÜm®_·th
) {

339 
	`dru·l_£t_mes§ge
(
	`t
('Thm’u sy¡em stÜe sy¡em…©h Úly, buˆwÈu£hURL‡lŸ fÜ di¥Ïy. %lšk_·th ha b“À¡Üed‡ %nÜm®_·th', 
	`¬¿y
('%lšk_·th' => 
$™em
['lšk_·th'], '%nÜm®_·th' => 
$nÜm®_·th
)));

340 
$™em
['lšk_·th'] = 
$nÜm®_·th
;

342 ià(!
	`m’u_·th_is_ex‹º®
(
$™em
['link_path'])) {

343 
$·r£d_lšk
 = 
	`·r£_u¾
(
$™em
['link_path']);

344 ià(
	`is£t
(
$·r£d_lšk
['query'])) {

345 
$™em
['İtiÚs']['qu”y'] = 
$·r£d_lšk
['query'];

350 
	`un£t
(
$™em
['options']['query']);

352 ià(
	`is£t
(
$·r£d_lšk
['fragment'])) {

353 
$™em
['İtiÚs']['äagm’t'] = 
$·r£d_lšk
['fragment'];

356 
	`un£t
(
$™em
['options']['fragment']);

358 ià(
$™em
['lšk_·th'] !ğ
$·r£d_lšk
['path']) {

359 
$™em
['lšk_·th'] = 
$·r£d_lšk
['path'];

362 ià(!
	`Œim
(
$™em
['lšk_·th']è|| !
	`m’u_v®id_·th
($item)) {

363 
	`fÜm_£t_”rÜ
('lšk_·th', 
	`t
("Th·th '@lšk_·th' i e™h” inv®id o¸you dØnÙ havacûs tØ™.", 
	`¬¿y
('@lšk_·th' => 
$™em
['link_path'])));

365 
	}
}

370 
funùiÚ
 
	$m’u_™em_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

371 
$fÜm_¡©e
['redirect'] = 'admin/build/menu/item/'. $form_state['values']['menu']['mlid'] .'/delete';

372 
	}
}

377 
funùiÚ
 
	$m’u_ed™_™em_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

378 
$™em
 = &
$fÜm_¡©e
['values']['menu'];

382 
$™em
['hidden'] = () !$item['enabled'];

383 
	`un£t
(
$™em
['enabled']);

385 
$™em
['options']['attributes']['title'] = $item['description'];

386 
	`li¡
(
$™em
['m’u_Çme'], $™em['¶id']èğ
	`ex¶ode
(':', $item['parent']);

387 ià(!
	`m’u_lšk_§ve
(
$™em
)) {

388 
	`dru·l_£t_mes§ge
(
	`t
('There was‡nƒrror savinghe menu†ink.'), 'error');

390 
$fÜm_¡©e
['»dœeù'] = 'admš/bud/m’u-cu¡omize/'. 
$™em
['menu_name'];

391 
	}
}

396 
funùiÚ
 
m’u_ed™_m’u
(&
$fÜm_¡©e
, 
$ty³
, 
$m’u
 = 
	$¬¿y
()) {

397 ià(
$ty³
 == 'edit') {

398 
$fÜm
['m’u_Çme'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$m’u
['menu_name']);

399 
$fÜm
['#š£¹'] = 
FALSE
;

400 
$fÜm
['d–‘e'] = 
	`¬¿y
(

402 '#v®ue' => 
	`t
('Delete'),

403 '#acûss' => !
	`š_¬¿y
(
$m’u
['m’u_Çme'], 
	`m’u_li¡_sy¡em_m’us
()),

404 '#subm™' => 
	`¬¿y
('menu_custom_delete_submit'),

409 
$m’u
 = 
	`¬¿y
('menu_name' => '', 'title' => '', 'description' => '');

410 
$fÜm
['m’u_Çme'] = 
	`¬¿y
(

412 '#t™Ë' => 
	`t
('Menu‚ame'),

413 '#maxsize' => 
MENU_MAX_MENU_NAME_LENGTH_UI
,

414 '#desütiÚ' => 
	`t
('The machine-readable‚ame ofhis menu. Thisext will be used for constructinghe URL ofhe <em>menu overview</em>…age forhis menu. This‚ame must contain only†owercase†etters,‚umbers,‡nd hyphens,‡nd must be unique.'),

415 '#»quœed' => 
TRUE
,

417 
$fÜm
['#š£¹'] = 
TRUE
;

419 
$fÜm
['#t™Ë'] = 
$m’u
['title'];

420 
$fÜm
['t™Ë'] = 
	`¬¿y
(

422 '#t™Ë' => 
	`t
('Title'),

423 '#deçuÉ_v®ue' => 
$m’u
['title'],

424 '#»quœed' => 
TRUE
,

426 
$fÜm
['desütiÚ'] = 
	`¬¿y
(

428 '#t™Ë' => 
	`t
('Description'),

429 '#deçuÉ_v®ue' => 
$m’u
['description'],

431 
$fÜm
['subm™'] = 
	`¬¿y
(

433 '#v®ue' => 
	`t
('Save'),

436  
$fÜm
;

437 
	}
}

442 
funùiÚ
 
	$m’u_cu¡om_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

443 
$fÜm_¡©e
['redirect'] = 'admin/build/menu-customize/'. $form_state['values']['menu_name'] .'/delete';

444 
	}
}

449 
funùiÚ
 
	$m’u_d–‘e_m’u_·ge
(
$m’u
) {

451 ià(
	`š_¬¿y
(
$m’u
['m’u_Çme'], 
	`m’u_li¡_sy¡em_m’us
())) {

452 
	`dru·l_acûss_d’›d
();

455  
	`dru·l_g‘_fÜm
('m’u_d–‘e_m’u_cÚfœm', 
$m’u
);

456 
	}
}

461 
funùiÚ
 
	$m’u_d–‘e_m’u_cÚfœm
(&
$fÜm_¡©e
, 
$m’u
) {

462 
$fÜm
['#m’u'] = 
$m’u
;

463 
$ÿ±iÚ
 = '';

464 
$num_lšks
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {m’u_lšks} WHERE m’u_Çmğ'%s'", 
$m’u
['menu_name']));

465 ià(
$num_lšks
) {

466 
$ÿ±iÚ
 .ğ'<p>'. 
	`fÜm©_¶u¿l
(
$num_lšks
, '<¡rÚg>W¬nšg:</¡rÚg> Th”i cu¼’y 1 m’u i‹m iÀ%t™Ë. IˆwÈbd–‘ed (sy¡em-defšed i‹m wÈb»£t).', '<¡rÚg>W¬nšg:</¡rÚg> Th”¬cu¼’y @couÁ m’u i‹m š %t™Ë. They wÈbd–‘ed (sy¡em-defšed i‹m wÈb»£t).', 
	`¬¿y
('%t™Ë' => 
$m’u
['title'])) .'</p>';

468 
$ÿ±iÚ
 .ğ'<p>'. 
	`t
('This‡ction cannot be undone.') .'</p>';

469  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØd–‘thcu¡om m’u %t™Ë?', 
	`¬¿y
('%t™Ë' => 
$m’u
['t™Ë'])), 'admš/bud/m’u-cu¡omize/'. $m’u['m’u_Çme'], 
$ÿ±iÚ
,('Delete'));

470 
	}
}

475 
funùiÚ
 
	$m’u_d–‘e_m’u_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

476 
$m’u
 = 
$fÜm
['#menu'];

477 
$fÜm_¡©e
['redirect'] = 'admin/build/menu';

479 ià(
	`š_¬¿y
(
$m’u
['m’u_Çme'], 
	`m’u_li¡_sy¡em_m’us
()è|| !
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*) FROM {menu_custom} WHERE menu_name = '%s'", $menu['menu_name']))) {

483 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {m’u_lšks} mÈINNER JOIN {m’u_rou‹r} m ON ml.rou‹r_·th = m.·th WHERE ml.m’u_Çmğ'%s' AND ml.moduË = 'sy¡em' ORDER BY m.numb”_·¹ ASC", 
$m’u
['menu_name']);

484 
$™em
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

485 
	`m’u_»£t_™em
(
$™em
);

488 
$»suÉ
 = 
	`db_qu”y
("SELECT mlid FROM {m’u_lšks} mÈWHERE ml.lšk_·th = '%s'", 'admš/bud/m’u-cu¡omize/'. 
$m’u
['menu_name']);

489 
$m
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

490 
	`m’u_lšk_d–‘e
(
$m
['mlid']);

493 
	`db_qu”y
("DELETE FROM {m’u_lšks} WHERE m’u_Çmğ'%s'", 
$m’u
['menu_name']);

494 
	`db_qu”y
("DELETE FROM {m’u_cu¡om} WHERE m’u_Çmğ'%s'", 
$m’u
['menu_name']);

496 
	`db_qu”y
("DELETE FROM {blocks} WHERE moduË = 'm’u' AND d– = '%s'", 
$m’u
['menu_name']);

497 
	`db_qu”y
("DELETE FROM {blocks_rŞes} WHERE moduË = 'm’u' AND d– = '%s'", 
$m’u
['menu_name']);

498 
	`m’u_ÿche_ş—r_®l
();

499 
	`ÿche_ş—r_®l
();

500 
$t_¬gs
 = 
	`¬¿y
('%t™Ë' => 
$m’u
['title']);

501 
	`dru·l_£t_mes§ge
(
	`t
('Thcu¡om m’u %t™Ë ha b“Àd–‘ed.', 
$t_¬gs
));

502 
	`w©chdog
('m’u', 'D–‘ed cu¡om m’u %t™Ë‡nd‡Î it m’u i‹ms.', 
$t_¬gs
, 
WATCHDOG_NOTICE
);

503 
	}
}

508 
funùiÚ
 
	$m’u_ed™_m’u_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

509 
$™em
 = 
$fÜm_¡©e
['values'];

510 ià(
	`´eg_m©ch
('/[^a-z0-9-]/', 
$™em
['menu_name'])) {

511 
	`fÜm_£t_”rÜ
('m’u_Çme', 
	`t
('The menu‚ame may only consist of†owercase†etters,‚umbers,‡nd hyphens.'));

513 ià(
	`¡¾’
(
$™em
['m’u_Çme']è> 
MENU_MAX_MENU_NAME_LENGTH_UI
) {

514 
	`fÜm_£t_”rÜ
('m’u_Çme', 
	`fÜm©_¶u¿l
(
MENU_MAX_MENU_NAME_LENGTH_UI
, "The menu‚ame can't be†ongerhan 1 character.", "The menu‚ame can't be†ongerhan @count characters."));

516 ià(
$fÜm
['#insert']) {

518 
$™em
['menu_name'] = 'menu-'. $item['menu_name'];

519 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT m’u_ÇmFROM {m’u_cu¡om} WHERE m’u_Çmğ'%s'", 
$™em
['menu_name'])) ||

520 
	`db_»suÉ
(
	`db_qu”y_¿nge
("SELECT m’u_ÇmFROM {m’u_lšks} WHERE m’u_Çmğ'%s'", 
$™em
['menu_name'], 0, 1))) {

521 
	`fÜm_£t_”rÜ
('m’u_Çme', 
	`t
('The menu‡lreadyƒxists.'));

524 
	}
}

529 
funùiÚ
 
	$m’u_ed™_m’u_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

530 
$m’u
 = 
$fÜm_¡©e
['values'];

531 
$·th
 = 'admin/build/menu-customize/';

532 ià(
$fÜm
['#insert']) {

534 
$m’u
['menu_name'] = 'menu-'. $menu['menu_name'];

535 
$lšk
['lšk_t™Ë'] = 
$m’u
['title'];

536 
$lšk
['lšk_·th'] = 
$·th
 . 
$m’u
['menu_name'];

537 
$lšk
['rou‹r_·th'] = 
$·th
 .'%';

538 
$lšk
['module'] = 'menu';

539 
$lšk
['¶id'] = 
	`db_»suÉ
(
	`db_qu”y
("SELECT mlid FROM {menu_links} WHERE†ink_path = '%s' AND module = '%s'", 'admin/build/menu', 'system'));

540 
	`m’u_lšk_§ve
(
$lšk
);

541 
	`db_qu”y
("INSERT INTO {m’u_cu¡om} (m’u_Çme,™Ë, desütiÚèVALUES ('%s', '%s', '%s')", 
$m’u
['menu_name'], $menu['title'], $menu['description']);

544 
	`db_qu”y
("UPDATE {m’u_cu¡om} SET™Ë = '%s', desütiÚ = '%s' WHERE m’u_Çmğ'%s'", 
$m’u
['title'], $menu['description'], $menu['menu_name']);

545 
$»suÉ
 = 
	`db_qu”y
("SELECT mlid FROM {m’u_lšks} WHERE†šk_·th = '%s'", 
$·th
 . 
$m’u
['menu_name']);

546 
$m
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

547 
$lšk
 = 
	`m’u_lšk_lßd
(
$m
['mlid']);

548 
$lšk
['lšk_t™Ë'] = 
$m’u
['title'];

549 
	`m’u_lšk_§ve
(
$lšk
);

552 
$fÜm_¡©e
['»dœeù'] = 
$·th
 . 
$m’u
['menu_name'];

553 
	}
}

558 
funùiÚ
 
	$m’u_™em_d–‘e_·ge
(
$™em
) {

561 ià(
$™em
['module'] == 'system' && !$item['updated']) {

562 
	`dru·l_acûss_d’›d
();

565  
	`dru·l_g‘_fÜm
('m’u_™em_d–‘e_fÜm', 
$™em
);

566 
	}
}

571 
funùiÚ
 
	$m’u_™em_d–‘e_fÜm
(&
$fÜm_¡©e
, 
$™em
) {

572 
$fÜm
['#™em'] = 
$™em
;

573  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØd–‘thcu¡om m’u i‹m %™em?', 
	`¬¿y
('%™em' => 
$™em
['link_title'])), 'admin/build/menu-customize/'. $item['menu_name']);

574 
	}
}

579 
funùiÚ
 
	$m’u_™em_d–‘e_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

580 
$™em
 = 
$fÜm
['#item'];

581 
	`m’u_lšk_d–‘e
(
$™em
['mlid']);

582 
$t_¬gs
 = 
	`¬¿y
('%t™Ë' => 
$™em
['link_title']);

583 
	`dru·l_£t_mes§ge
(
	`t
('Thm’u i‹m %t™Ë ha b“Àd–‘ed.', 
$t_¬gs
));

584 
	`w©chdog
('m’u', 'D–‘ed m’u i‹m %t™Ë.', 
$t_¬gs
, 
WATCHDOG_NOTICE
);

585 
$fÜm_¡©e
['»dœeù'] = 'admš/bud/m’u-cu¡omize/'. 
$™em
['menu_name'];

586 
	}
}

591 
funùiÚ
 
	$m’u_»£t_™em_cÚfœm
(&
$fÜm_¡©e
, 
$™em
) {

592 
$fÜm
['™em'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$™em
);

593  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØ»£ˆth™em %™emØ™ deçuÉ v®ues?', 
	`¬¿y
('%™em' => 
$™em
['link_title'])), 'admin/build/menu-customize/'. $item['menu_name'],('Any customizations will be†ost. This‡ction cannot be undone.'),('Reset'));

594 
	}
}

599 
funùiÚ
 
	$m’u_»£t_™em_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

600 
$™em
 = 
$fÜm_¡©e
['values']['item'];

601 
$Ãw_™em
 = 
	`m’u_»£t_™em
(
$™em
);

602 
	`dru·l_£t_mes§ge
(
	`t
('The menu item was„eseto its default settings.'));

603 
$fÜm_¡©e
['»dœeù'] = 'admš/bud/m’u-cu¡omize/'. 
$Ãw_™em
['menu_name'];

604 
	}
}

609 
funùiÚ
 
	$m’u_cÚfigu»
() {

610 
$fÜm
['šŒo'] = 
	`¬¿y
(

612 '#v®ue' => 
	`t
('The menu module‡llows on-the-fly creation of menu†inks inhe content‡uthoring forms. The following option setshe default menu in which‡‚ew†ink will be‡dded.'),

615 
$m’u_İtiÚs
 = 
	`m’u_g‘_m’us
();

616 
$fÜm
['m’u_deçuÉ_node_m’u'] = 
	`¬¿y
(

618 '#t™Ë' => 
	`t
('Default menu for content'),

619 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('menu_default_node_menu', 'primary-links'),

620 '#İtiÚs' => 
$m’u_İtiÚs
,

621 '#desütiÚ' => 
	`t
('Choosehe menuo behe default inhe menu options inhe content‡uthoring form.'),

624 
$´im¬y
 = 
	`v¬ŸbË_g‘
('menu_primary_links_source', 'primary-links');

625 
$´im¬y_İtiÚs
 = 
	`¬¿y_m”ge
(
$m’u_İtiÚs
, 
	`¬¿y
('' => 
	`t
('No…rimary†inks')));

626 
$fÜm
['m’u_´im¬y_lšks_sourû'] = 
	`¬¿y
(

628 '#t™Ë' => 
	`t
('Source forhe…rimary†inks'),

629 '#deçuÉ_v®ue' => 
$´im¬y
,

630 '#İtiÚs' => 
$´im¬y_İtiÚs
,

631 '#Œ“' => 
FALSE
,

632 '#desütiÚ' => 
	`t
('Select what should be displayed‡she…rimary†inks.'),

635 
$£cÚd¬y_İtiÚs
 = 
	`¬¿y_m”ge
(
$m’u_İtiÚs
, 
	`¬¿y
('' => 
	`t
('No secondary†inks')));

636 
$fÜm
["m’u_£cÚd¬y_lšks_sourû"] = 
	`¬¿y
(

638 '#t™Ë' => 
	`t
('Source forhe secondary†inks'),

639 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('menu_secondary_links_source', 'secondary-links'),

640 '#İtiÚs' => 
$£cÚd¬y_İtiÚs
,

641 '#Œ“' => 
FALSE
,

642 '#desütiÚ' => 
	`t
('S–eù wh© should bdi¥Ïyed‡ th£cÚd¬y†šks. You cª choo£h§mm’u fÜ secÚd¬y†šk a fÜ…rim¬y†šk (cu¼’y %´im¬y). Iàyou dØthis,hchd»Àoàthaùiv´im¬y m’u†šk wÈbdi¥Ïyed‡ £cÚd¬y†šks.', 
	`¬¿y
('%´im¬y' => 
$´im¬y_İtiÚs
[
$´im¬y
])),

645  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

646 
	}
}

	@/srv/http/subs/notes/www/modules/menu/menu.module

1 <?
php


13 
defše
('MENU_MAX_MENU_NAME_LENGTH_UI', 27);

18 
funùiÚ
 
	$m’u_h–p
(
$·th
, 
$¬g
) {

19 
$·th
) {

21 
$ouut
 = '<p>'. 
	`t
("The menu module…rovides‡n interfaceo control‡nd customize Drupal's…owerful menu system. Menus‡re‡ hierarchical collection of†inks, or menu items, usedo‚avigate‡ website,‡nd‡re…ositioned‡nd displayed using Drupal's flexible block system. By default,hree menus‡re created during installation: <em>Navigation</em>, <em>Primary†inks</em>,‡nd <em>Secondary†inks</em>. The <em>Navigation</em> menu contains most†inks‚ecessary for working with‡nd‚avigating your site,‡nd is often displayed inƒitherhe†eft or„ight sidebar. Most Drupalhemes‡lso…rovide support for <em>Primary†inks</em>‡nd <em>Secondary†inks</em>, by displayinghem inƒitherhe header or footer ofƒach…age. By default, <em>Primary†inks</em>‡nd <em>Secondary†inks</em> contain‚o menu items but may be configuredo contain custom menu items specifico your site.") .'</p>';

22 
$ouut
 .ğ'<p>'. 
	`t
('Th<¨h»f="@m’u">m’u ·ge</a> di¥Ïy ®Èm’u cu¼’y‡vaabË oÀyou¸s™e. S–eù‡ m’u fromhi li¡Øadd o¸ed™‡ m’u i‹m, o¸tØ»¬¿ng™em w™hšhm’u. C»©Ãw m’u usšgh<¨h»f="@add-m’u">add m’u…age</a> (thblock cÚššg‡‚ew m’u mu¡‡lsØb’abËd oÀth<¨h»f="@blocks">block admši¡¿tiÚ…age</a>).', 
	`¬¿y
('@m’u' => 
	`u¾
('admin/build/menu'), '@add-menu' => url('admin/build/menu/add'), '@blocks' => url('admin/build/block'))) .'</p>';

23 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@m’u">M’u moduË</a>.', 
	`¬¿y
('@menu' => 'http://drupal.org/handbook/modules/menu/')) .'</p>';

24  
$ouut
;

26  '<p>'. 
	`t
('Menus‡re‡ collection of†inks (menu items) usedo‚avigate‡ website. The menus currently‡vailable on your site‡re displayed below. Select‡ menu fromhis†isto manage its menu items.') .'</p>';

28  '<p>'. 
	`t
('EÁ”hÇmfÜ you¸Ãw m’u. Rememb”Ø’abËhÃwly c»©ed block iÀth<¨h»f="@blocks">block admši¡¿tiÚ…age</a>.', 
	`¬¿y
('@blocks' => 
	`u¾
('admin/build/block'))) .'</p>';

30  '<p>'. 
	`t
('To„earrange menu items, grab‡ drag-and-drop handle underhe <em>Menu item</em> column‡nd draghe items (or group of items)o‡‚ew†ocation inhe†ist. (Grab‡ handle by clicking‡nd holdinghe mouse while hovering over‡ handle icon.) Rememberhat your changes will‚ot be saved until you clickhe <em>Save configuration</em> button‡the bottom ofhe…age.') .'</p>';

32  '<p>'. 
	`t
('Enterheitle‡nd…ath for your‚ew menu item.') .'</p>';

34 
	}
}

39 
funùiÚ
 
	$m’u_³rm
() {

40  
	`¬¿y
('administer menu');

41 
	}
}

46 
funùiÚ
 
	$m’u_m’u
() {

47 
$™ems
['admš/bud/m’u'] = 
	`¬¿y
(

52 'acûs ¬gum’ts' => 
	`¬¿y
('administer menu'),

56 
$™ems
['admš/bud/m’u/li¡'] = 
	`¬¿y
(

58 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

62 
$™ems
['admš/bud/m’u/add'] = 
	`¬¿y
(

65 '·g¬gum’ts' => 
	`¬¿y
('menu_edit_menu', 'add'),

66 'acûs ¬gum’ts' => 
	`¬¿y
('administer menu'),

67 'ty³' => 
MENU_LOCAL_TASK
,

70 
$™ems
['admš/bud/m’u/£‰šgs'] = 
	`¬¿y
(

73 '·g¬gum’ts' => 
	`¬¿y
('menu_configure'),

74 'acûs ¬gum’ts' => 
	`¬¿y
('administer menu'),

75 'ty³' => 
MENU_LOCAL_TASK
,

79 
$™ems
['admš/bud/m’u-cu¡omize/%m’u'] = 
	`¬¿y
(

82 '·g¬gum’ts' => 
	`¬¿y
('menu_overview_form', 3),

84 't™Ë‡rgum’ts' => 
	`¬¿y
(3),

85 'acûs ¬gum’ts' => 
	`¬¿y
('administer menu'),

86 'ty³' => 
MENU_CALLBACK
,

89 
$™ems
['admš/bud/m’u-cu¡omize/%m’u/li¡'] = 
	`¬¿y
(

92 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

95 
$™ems
['admš/bud/m’u-cu¡omize/%m’u/add'] = 
	`¬¿y
(

98 '·g¬gum’ts' => 
	`¬¿y
('m’u_ed™_™em', 'add', 
NULL
, 3),

99 'acûs ¬gum’ts' => 
	`¬¿y
('administer menu'),

100 'ty³' => 
MENU_LOCAL_TASK
,

103 
$™ems
['admš/bud/m’u-cu¡omize/%m’u/ed™'] = 
	`¬¿y
(

106 '·g¬gum’ts' => 
	`¬¿y
('menu_edit_menu', 'edit', 3),

107 'acûs ¬gum’ts' => 
	`¬¿y
('administer menu'),

108 'ty³' => 
MENU_LOCAL_TASK
,

111 
$™ems
['admš/bud/m’u-cu¡omize/%m’u/d–‘e'] = 
	`¬¿y
(

114 '·g¬gum’ts' => 
	`¬¿y
(3),

115 'acûs ¬gum’ts' => 
	`¬¿y
('administer menu'),

116 'ty³' => 
MENU_CALLBACK
,

119 
$™ems
['admš/bud/m’u/™em/%m’u_lšk/ed™'] = 
	`¬¿y
(

122 '·g¬gum’ts' => 
	`¬¿y
('m’u_ed™_™em', 'ed™', 4, 
NULL
),

123 'acûs ¬gum’ts' => 
	`¬¿y
('administer menu'),

124 'ty³' => 
MENU_CALLBACK
,

127 
$™ems
['admš/bud/m’u/™em/%m’u_lšk/»£t'] = 
	`¬¿y
(

130 '·g¬gum’ts' => 
	`¬¿y
('menu_reset_item_confirm', 4),

131 'acûs ¬gum’ts' => 
	`¬¿y
('administer menu'),

132 'ty³' => 
MENU_CALLBACK
,

135 
$™ems
['admš/bud/m’u/™em/%m’u_lšk/d–‘e'] = 
	`¬¿y
(

138 '·g¬gum’ts' => 
	`¬¿y
(4),

139 'acûs ¬gum’ts' => 
	`¬¿y
('administer menu'),

140 'ty³' => 
MENU_CALLBACK
,

144  
$™ems
;

145 
	}
}

150 
funùiÚ
 
	$m’u_theme
() {

151  
	`¬¿y
(

152 'm’u_ov”v›w_fÜm' => 
	`¬¿y
(

154 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

157 
	}
}

164 
funùiÚ
 
	$m’u_’abË
() {

165 
	`m’u_»bud
();

166 
$ba£_lšk
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT mlid AS…lid, menu_name from {menu_links} WHERE†ink_path = 'admin/build/menu' AND module = 'system'"));

167 
$ba£_lšk
['router_path'] = 'admin/build/menu-customize/%';

168 
$ba£_lšk
['module'] = 'menu';

169 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {menu_custom}");

170 
$m’u
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

172 
$lšk
 = 
$ba£_lšk
;

173 
$lšk
['mlid'] = 0;

174 
$lšk
['lšk_t™Ë'] = 
$m’u
['title'];

175 
$lšk
['lšk_·th'] = 'admš/bud/m’u-cu¡omize/'. 
$m’u
['menu_name'];

176 ià(!
	`db_»suÉ
(
	`db_qu”y
("SELECT mlid FROM {m’u_lšks} WHERE†šk_·th = '%s' AND…lid = %d", 
$lšk
['link_path'], $link['plid']))) {

177 
	`m’u_lšk_§ve
(
$lšk
);

180 
	`m’u_ÿche_ş—r_®l
();

181 
	}
}

186 
funùiÚ
 
	$m’u_ov”v›w_t™Ë
(
$m’u
) {

187  
$m’u
['title'];

188 
	}
}

193 
funùiÚ
 
	$m’u_lßd
(
$m’u_Çme
) {

194  
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT * FROM {m’u_cu¡om} WHERE m’u_Çmğ'%s'", 
$m’u_Çme
));

195 
	}
}

209 
funùiÚ
 
	$m’u_·»Á_İtiÚs
(
$m’us
, 
$™em
) {

214 ià(
	`v¬ŸbË_g‘
('m’u_ov”ride_·»Á_£ËùÜ', 
FALSE
)) {

215  
	`¬¿y
();

218 ià(
	`is£t
(
$™em
['parent_depth_limit'])) {

219 
$lim™
 = 
$™em
['parent_depth_limit'];

222 
$lim™
 = 
	`_m’u_·»Á_d•th_lim™
(
$™em
);

225 
	`fÜ—ch
 (
$m’us
 
as
 
$m’u_Çme
 => 
$t™Ë
) {

226 
$Œ“
 = 
	`m’u_Œ“_®l_d©a
(
$m’u_Çme
, 
NULL
);

227 
$İtiÚs
[
$m’u_Çme
 .':0'] = '<'. 
$t™Ë
 .'>';

228 
	`_m’u_·»Ás_»cur£
(
$Œ“
, 
$m’u_Çme
, '--', 
$İtiÚs
, 
$™em
['mlid'], 
$lim™
);

230  
$İtiÚs
;

231 
	}
}

236 
funùiÚ
 
	$_m’u_·»Ás_»cur£
(
$Œ“
, 
$m’u_Çme
, 
$šd’t
, &
$İtiÚs
, 
$exşude
, 
$d•th_lim™
) {

237 
	`fÜ—ch
 (
$Œ“
 
as
 
$d©a
) {

238 ià(
$d©a
['lšk']['d•th'] > 
$d•th_lim™
) {

242 ià(
$d©a
['lšk']['mlid'] !ğ
$exşude
 && $data['link']['hidden'] >= 0) {

243 
$t™Ë
 = 
$šd’t
 .' '. 
	`Œunÿ‹_utf8
(
$d©a
['lšk']['t™Ë'], 30, 
TRUE
, 
FALSE
);

244 ià(
$d©a
['link']['hidden']) {

245 
$t™Ë
 .ğ' ('. 
	`t
('disabled') .')';

247 
$İtiÚs
[
$m’u_Çme
 .':'. 
$d©a
['lšk']['mlid']] = 
$t™Ë
;

248 ià(
$d©a
['below']) {

249 
	`_m’u_·»Ás_»cur£
(
$d©a
['b–ow'], 
$m’u_Çme
, 
$šd’t
 .'--', 
$İtiÚs
, 
$exşude
, 
$d•th_lim™
);

253 
	}
}

258 
funùiÚ
 
	$m’u_»£t_™em
(
$™em
) {

259 
$Ãw_™em
 = 
	`_m’u_lšk_bud
(
	`m’u_g‘_™em
(
$™em
['router_path']));

260 
	`fÜ—ch
 (
	`¬¿y
('mlid', 'has_chd»n'è
as
 
$key
) {

261 
$Ãw_™em
[
$key
] = 
$™em
[$key];

263 
	`m’u_lšk_§ve
(
$Ãw_™em
);

264  
$Ãw_™em
;

265 
	}
}

270 
funùiÚ
 
m’u_block
(
$İ
 = 'li¡', 
$d–
 = 0) {

271 
$m’us
 = 
m’u_g‘_m’us
();

273 
un£t
(
$m’us
['navigation']);

274 ià(
	g$İ
 == 'list') {

275 
$blocks
 = 
¬¿y
();

276 
fÜ—ch
 (
$m’us
 
as
 
$Çme
 => 
$t™Ë
) {

278 
$blocks
[
$Çme
]['šfo'] = 
check_¶aš
(
$t™Ë
);

281 
	g$blocks
[
$Çme
]['ÿche'] = 
BLOCK_NO_CACHE
;

283  
	g$blocks
;

285 ià(
	g$İ
 == 'view') {

286 
$d©a
['subjeù'] = 
check_¶aš
(
$m’us
[
$d–
]);

287 
	g$d©a
['cÚ‹Á'] = 
m’u_Œ“
(
$d–
);

288  
	g$d©a
;

295 
funùiÚ
 
	$m’u_nod—pi
(&
$node
, 
$İ
) {

296 
$İ
) {

299 ià(
	`is£t
(
$node
->
m’u
)) {

300 
$™em
 = &
$node
->
m’u
;

301 ià(!
	`em±y
(
$™em
['delete'])) {

302 
	`m’u_lšk_d–‘e
(
$™em
['mlid']);

304 
	`–£if
 (
	`Œim
(
$™em
['link_title'])) {

305 
$™em
['lšk_t™Ë'] = 
	`Œim
($item['link_title']);

306 
$™em
['link_path'] = "node/$node->nid";

307 ià(!
$™em
['customized']) {

308 
$™em
['İtiÚs']['©Œibu‹s']['t™Ë'] = 
	`Œim
(
$node
->
t™Ë
);

310 ià(!
	`m’u_lšk_§ve
(
$™em
)) {

311 
	`dru·l_£t_mes§ge
(
	`t
('There was‡nƒrror savinghe menu†ink.'), 'error');

318 
$»suÉ
 = 
	`db_qu”y
("SELECT mlid FROM {m’u_lšks} WHERE†šk_·th = 'node/%d' AND moduË = 'm’u'", 
$node
->
nid
);

319 
$m
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

320 
	`m’u_lšk_d–‘e
(
$m
['mlid']);

324 ià(
	`em±y
(
$node
->
m’u
)) {

326 
$m’u_Çme
 = 
	`v¬ŸbË_g‘
('menu_default_node_menu', 'primary-links');

327 
$™em
 = 
	`¬¿y
();

328 ià(
	`is£t
(
$node
->
nid
)) {

330 
$mlid
 = 
	`db_»suÉ
(
	`db_qu”y_¿nge
("SELECT mlid FROM {m’u_lšks} WHERE†šk_·th = 'node/%d' AND m’u_Çmğ'%s' AND moduË = 'm’u' ORDER BY mlid ASC", 
$node
->
nid
, 
$m’u_Çme
, 0, 1));

332 ià(!
$mlid
) {

333 
$mlid
 = 
	`db_»suÉ
(
	`db_qu”y_¿nge
("SELECT mlid FROM {m’u_lšks} WHERE†šk_·th = 'node/%d' AND moduË = 'm’u' ORDER BY mlid ASC", 
$node
->
nid
, 0, 1));

335 ià(
$mlid
) {

336 
$™em
 = 
	`m’u_lšk_lßd
(
$mlid
);

340 
$node
->
m’u
 = 
$™em
 + 
	`¬¿y
('lšk_t™Ë' => '', 'mlid' => 0, '¶id' => 0, 'm’u_Çme' => 
$m’u_Çme
, 'weight' => 0, 'options' =>‡rray(), 'module' => 'menu', 'expanded' => 0, 'hidden' => 0, 'has_children' => 0, 'customized' => 0);

343 ià(!
	`is£t
(
$node
->
m’u
['parent_depth_limit'])) {

344 
$node
->
m’u
['·»Á_d•th_lim™'] = 
	`_m’u_·»Á_d•th_lim™
($node->menu);

348 
	}
}

353 
funùiÚ
 
	$_m’u_·»Á_d•th_lim™
(
$™em
) {

354  
MENU_MAX_DEPTH
 - 1 - ((
$™em
['mlid'] && $™em['has_chd»n']è? 
	`m’u_lšk_chd»n_»Ïtive_d•th
($item) : 0);

355 
	}
}

360 
funùiÚ
 
	$m’u_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

361 ià(
	`is£t
(
$fÜm
['#node']è&& $fÜm['#node']->
ty³
 .'_node_fÜm' =ğ
$fÜm_id
) {

363 
$fÜm
['#ÿche'] = 
TRUE
;

365 
$fÜm
['m’u'] = 
	`¬¿y
(

367 '#t™Ë' => 
	`t
('Menu settings'),

368 '#acûss' => 
	`u£r_acûss
('administer menu'),

369 '#cŞÏpsibË' => 
TRUE
,

370 '#cŞÏp£d' => 
FALSE
,

371 '#Œ“' => 
TRUE
,

373 '#©Œibu‹s' => 
	`¬¿y
('class' => 'menu-item-form'),

375 
$™em
 = 
$fÜm
['#node']->
m’u
;

377 ià(
$™em
['mlid']) {

379 
$fÜm
['m’u']['d–‘e'] = 
	`¬¿y
(

381 '#t™Ë' => 
	`t
('Deletehis menu item.'),

384 ià(!
$™em
['link_title']) {

385 
$fÜm
['m’u']['#cŞÏp£d'] = 
TRUE
;

388 
	`fÜ—ch
 (
	`¬¿y
('mlid', 'moduË', 'hidd’', 'has_chd»n', 'cu¡omized', 'İtiÚs', 'ex·nded', 'hidd’', '·»Á_d•th_lim™'è
as
 
$key
) {

389 
$fÜm
['m’u'][
$key
] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$™em
[$key]);

391 
$fÜm
['m’u']['#™em'] = 
$™em
;

393 
$fÜm
['m’u']['lšk_t™Ë'] = 
	`¬¿y
('#type' => 'textfield',

394 '#t™Ë' => 
	`t
('Menu†inkitle'),

395 '#deçuÉ_v®ue' => 
$™em
['link_title'],

396 '#desütiÚ' => 
	`t
('The†inkext correspondingohis itemhat should‡ppear inhe menu. Leave blank if you do‚ot wisho‡ddhis…ostohe menu.'),

397 '#»quœed' => 
FALSE
,

400 
$İtiÚs
 = 
	`m’u_·»Á_İtiÚs
(
	`m’u_g‘_m’us
(), 
$™em
);

401 
$deçuÉ
 = 
$™em
['menu_name'] .':'. $item['plid'];

402 ià(!
	`is£t
(
$İtiÚs
[
$deçuÉ
])) {

403 
$deçuÉ
 = 'primary-links:0';

405 
$fÜm
['m’u']['·»Á'] = 
	`¬¿y
(

407 '#t™Ë' => 
	`t
('Parent item'),

408 '#deçuÉ_v®ue' => 
$deçuÉ
,

409 '#İtiÚs' => 
$İtiÚs
,

410 '#desütiÚ' => 
	`t
('Thmaximum d•th fÜ‡À™em‡nd‡Î it chd»Ài fixed‡ˆ!maxd•th. Somm’u i‹m may‚Ù bavaabË‡ ·»Á ià£Ëùšghem wouldƒxûedhi lim™.', 
	`¬¿y
('!maxd•th' => 
MENU_MAX_DEPTH
)),

411 '#©Œibu‹s' => 
	`¬¿y
('class' => 'menu-title-select'),

413 
$fÜm
['#submit'][] = 'menu_node_form_submit';

415 
$fÜm
['m’u']['weight'] = 
	`¬¿y
(

417 '#t™Ë' => 
	`t
('Weight'),

419 '#deçuÉ_v®ue' => 
$™em
['weight'],

420 '#desütiÚ' => 
	`t
('Optional. Inhe menu,he heavier items will sink‡ndhe†ighter items will be…ositioned‚earerheop.'),

423 
	}
}

428 
funùiÚ
 
	$m’u_node_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

429 
	`li¡
(
$fÜm_¡©e
['v®ues']['m’u']['m’u_Çme'], $fÜm_¡©e['v®ues']['m’u']['¶id']èğ
	`ex¶ode
(':', $form_state['values']['menu']['parent']);

430 
	}
}

442 
funùiÚ
 
	$m’u_g‘_m’us
(
$®l
 = 
TRUE
) {

443 
$sy¡em_m’us
 = 
	`m’u_li¡_sy¡em_m’us
();

444 
$sql
 = 'SELECT * FROM {menu_custom}';

445 ià(!
$®l
) {

446 
$sql
 .ğ' WHERE m’u_ÇmNOT IN ('. 
	`im¶ode
(',', 
	`¬¿y_fl
(0, 
	`couÁ
(
$sy¡em_m’us
), "'%s'")) .')';

448 
$sql
 .= ' ORDER BYitle';

449 
$»suÉ
 = 
	`db_qu”y
(
$sql
, 
$sy¡em_m’us
);

450 
$rows
 = 
	`¬¿y
();

451 
$r
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

452 
$rows
[
$r
['menu_name']] = $r['title'];

454  
$rows
;

455 
	}
}

	@/srv/http/subs/notes/www/modules/node/content_types.inc

1 <?
php


12 
funùiÚ
 
	$node_ov”v›w_ty³s
() {

13 
$ty³s
 = 
	`node_g‘_ty³s
();

14 
$Çmes
 = 
	`node_g‘_ty³s
('names');

15 
$h—d”
 = 
	`¬¿y
(
	`t
('Name'),('Type'),('Description'),‡rray('data' =>('Operations'), 'colspan' => '2'));

16 
$rows
 = 
	`¬¿y
();

18 
	`fÜ—ch
 (
$Çmes
 
as
 
$key
 => 
$Çme
) {

19 
$ty³
 = 
$ty³s
[
$key
];

20 ià(
	`node_hook
(
$ty³
, 'form')) {

21 
$ty³_u¾_¡r
 = 
	`¡r_»¶aû
('_', '-', 
$ty³
->
ty³
);

22 
$row
 = 
	`¬¿y
(

23 
	`l
(
$Çme
, 'admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
),

24 
	`check_¶aš
(
$ty³
->
ty³
),

25 
	`f‹r_xss_admš
(
$ty³
->
desütiÚ
),

28 
$row
[] = 
	`¬¿y
('d©a' => 
	`l
(
	`t
('ed™'), 'admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
));

31 ià(
$ty³
->
cu¡om
) {

32 
$row
[] = 
	`¬¿y
('d©a' => 
	`l
(
	`t
('d–‘e'), 'admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
 .'/delete'));

35 
$row
[] = 
	`¬¿y
('data' => '');

37 
$rows
[] = 
$row
;

41 ià(
	`em±y
(
$rows
)) {

42 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No contentypes‡vailable.'), 'colspan' => '5', 'class' => 'message'));

45  
	`theme
('bË', 
$h—d”
, 
$rows
);

46 
	}
}

51 
funùiÚ
 
	$node_ty³_fÜm
(&
$fÜm_¡©e
, 
$ty³
 = 
NULL
) {

52 ià(!
	`is£t
(
$ty³
->
ty³
)) {

53 
$ty³
 = 
Ãw
 
	`¡dCÏss
();

54 
$ty³
->
ty³
 = $ty³->
Çme
 = $ty³->
moduË
 = $ty³->
desütiÚ
 = $ty³->
h–p
 = '';

55 
$ty³
->
mš_wÜd_couÁ
 = 0;

56 
$ty³
->
has_t™Ë
 = 
TRUE
;

57 
$ty³
->
has_body
 = 
TRUE
;

58 
$ty³
->
t™Ë_Ïb–
 = 
	`t
('Title');

59 
$ty³
->
body_Ïb–
 = 
	`t
('Body');

60 
$ty³
->
cu¡om
 = 
TRUE
;

61 
$ty³
->
modif›d
 = 
FALSE
;

62 
$ty³
->
locked
 = 
FALSE
;

65 
$fÜm
['#node_ty³'] = 
$ty³
;

67 
$fÜm
['id’t™y'] = 
	`¬¿y
(

69 '#t™Ë' => 
	`t
('Identification'),

71 
$fÜm
['id’t™y']['Çme'] = 
	`¬¿y
(

72 '#t™Ë' => 
	`t
('Name'),

74 '#deçuÉ_v®ue' => 
$ty³
->
Çme
,

75 '#desütiÚ' => 
	`t
('The human-readable‚ame ofhis contentype. Thisext will be displayed‡s…art ofhe†ist onhe <em>create content</em>…age. It is„ecommendedhathis‚ame begin with‡ capital†etter‡nd contain only†etters,‚umbers,‡nd <strong>spaces</strong>. This‚ame must be unique.'),

76 '#»quœed' => 
TRUE
,

79 ià(!
$ty³
->
locked
) {

80 
$fÜm
['id’t™y']['ty³'] = 
	`¬¿y
(

81 '#t™Ë' => 
	`t
('Type'),

83 '#deçuÉ_v®ue' => 
$ty³
->
ty³
,

85 '#»quœed' => 
TRUE
,

86 '#desütiÚ' => 
	`t
('The machine-readable‚ame ofhis contentype. Thisext will be used for constructinghe URL ofhe <em>create content</em>…age forhis contentype. This‚ame must contain only†owercase†etters,‚umbers,‡nd underscores. Underscores will be converted into hyphens when constructinghe URL ofhe <em>create content</em>…age. This‚ame must be unique.'),

90 
$fÜm
['id’t™y']['ty³'] = 
	`¬¿y
(

92 '#v®ue' => 
$ty³
->
ty³
,

94 
$fÜm
['id’t™y']['ty³_di¥Ïy'] = 
	`¬¿y
(

95 '#t™Ë' => 
	`t
('Type'),

97 '#v®ue' => 
	`theme
('¶aûhŞd”', 
$ty³
->
ty³
),

98 '#desütiÚ' => 
	`t
('The machine-readable‚ame ofhis contentype. This field cannot be modified for system-defined contentypes.'),

102 
$fÜm
['id’t™y']['desütiÚ'] = 
	`¬¿y
(

103 '#t™Ë' => 
	`t
('Description'),

105 '#deçuÉ_v®ue' => 
$ty³
->
desütiÚ
,

106 '#desütiÚ' => 
	`t
('A brief description ofhis contentype. Thisext will be displayed‡s…art ofhe†ist onhe <em>create content</em>…age.'),

109 
$fÜm
['submissiÚ'] = 
	`¬¿y
(

111 '#t™Ë' => 
	`t
('Submission form settings'),

112 '#cŞÏpsibË' => 
TRUE
,

113 '#cŞÏp£d' => 
TRUE
,

115 
$fÜm
['submissiÚ']['t™Ë_Ïb–'] = 
	`¬¿y
(

116 '#t™Ë' => 
	`t
('Title field†abel'),

118 '#deçuÉ_v®ue' => 
$ty³
->
t™Ë_Ïb–
,

119 '#»quœed' => 
TRUE
,

121 ià(!
$ty³
->
has_t™Ë
) {

124 
$fÜm
['submissiÚ']['t™Ë_Ïb–']['#©Œibu‹s'] = 
	`¬¿y
('disabled' => 'disabled');

125 
$fÜm
['submissiÚ']['t™Ë_Ïb–']['#desütiÚ'] = 
	`t
('This contentype does‚ot have‡itle field.');

126 
$fÜm
['submissiÚ']['t™Ë_Ïb–']['#»quœed'] = 
FALSE
;

128 
$fÜm
['submissiÚ']['body_Ïb–'] = 
	`¬¿y
(

129 '#t™Ë' => 
	`t
('Body field†abel'),

131 '#deçuÉ_v®ue' => 
	`is£t
(
$ty³
->
body_Ïb–
) ? $type->body_label : '',

132 '#desütiÚ' => 
	`t
('To omithe body field forhis contentype,„emove‡nyext‡nd†eavehis field blank.'),

134 
$fÜm
['submissiÚ']['mš_wÜd_couÁ'] = 
	`¬¿y
(

136 '#t™Ë' => 
	`t
('Minimum‚umber of words'),

137 '#deçuÉ_v®ue' => 
$ty³
->
mš_wÜd_couÁ
,

138 '#İtiÚs' => 
	`dru·l_m­_assoc
(
	`¬¿y
(0, 1, 10, 25, 50, 75, 100, 125, 150, 175, 200)),

139 '#desütiÚ' => 
	`t
('The minimum‚umber of words forhe body fieldo be considered valid forhis contentype. This can be usefulo„ule out submissionshat do‚ot meethe site\'s standards, such‡s shortest…osts.')

141 
$fÜm
['submissiÚ']['h–p'] = 
	`¬¿y
(

143 '#t™Ë' => 
	`t
('Explanation or submission guidelines'),

144 '#deçuÉ_v®ue' => 
$ty³
->
h–p
,

145 '#desütiÚ' => 
	`t
('Thisext will be displayed‡theop ofhe submission form forhis contentype. It is useful for helping or instructing your users.')

147 
$fÜm
['wÜkæow'] = 
	`¬¿y
(

149 '#t™Ë' => 
	`t
('Workflow settings'),

150 '#cŞÏpsibË' => 
TRUE
,

151 '#cŞÏp£d' => 
TRUE
,

153 
$fÜm
['wÜkæow']['node_İtiÚs'] = 
	`¬¿y
('#type' => 'checkboxes',

154 '#t™Ë' => 
	`t
('Default options'),

155 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('node_İtiÚs_'. 
$ty³
->
ty³
, 
	`¬¿y
('status', 'promote')),

156 '#İtiÚs' => 
	`¬¿y
(

157 '¡©us' => 
	`t
('Published'),

158 '´omÙe' => 
	`t
('Promotedo front…age'),

159 '¡icky' => 
	`t
('Sticky‡top of†ists'),

160 '»visiÚ' => 
	`t
('Create‚ew„evision'),

162 '#desütiÚ' => 
	`t
('Users withhe <em>administer‚odes</em>…ermission will be‡bleo overridehese options.'),

165 
$fÜm
['Şd_ty³'] = 
	`¬¿y
(

167 '#v®ue' => 
$ty³
->
ty³
,

169 
$fÜm
['Üig_ty³'] = 
	`¬¿y
(

171 '#v®ue' => 
	`is£t
(
$ty³
->
Üig_ty³
) ? $type->orig_type : '',

173 
$fÜm
['moduË'] = 
	`¬¿y
(

175 '#v®ue' => 
$ty³
->
moduË
,

177 
$fÜm
['cu¡om'] = 
	`¬¿y
(

179 '#v®ue' => 
$ty³
->
cu¡om
,

181 
$fÜm
['modif›d'] = 
	`¬¿y
(

183 '#v®ue' => 
$ty³
->
modif›d
,

185 
$fÜm
['locked'] = 
	`¬¿y
(

187 '#v®ue' => 
$ty³
->
locked
,

190 
$fÜm
['subm™'] = 
	`¬¿y
(

192 '#v®ue' => 
	`t
('Save contentype'),

196 ià(
$ty³
->
cu¡om
) {

197 ià(!
	`em±y
(
$ty³
->
ty³
)) {

198 
$fÜm
['d–‘e'] = 
	`¬¿y
(

200 '#v®ue' => 
	`t
('Delete contentype'),

206 
$fÜm
['»£t'] = 
	`¬¿y
(

208 '#v®ue' => 
	`t
('Reseto defaults'),

213  
$fÜm
;

214 
	}
}

219 
funùiÚ
 
	$node_ty³_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

220 
$ty³
 = 
Ãw
 
	`¡dCÏss
();

221 
$ty³
->
ty³
 = 
	`Œim
(
$fÜm_¡©e
['values']['type']);

222 
$ty³
->
Çme
 = 
	`Œim
(
$fÜm_¡©e
['values']['name']);

225 
$Şd_ty³
 = 
	`Œim
(
$fÜm_¡©e
['values']['old_type']);

227 
$ty³s
 = 
	`node_g‘_ty³s
('names');

229 ià(!
$fÜm_¡©e
['values']['locked']) {

230 ià(
	`is£t
(
$ty³s
[
$ty³
->
ty³
]è&& $ty³->ty³ !ğ
$Şd_ty³
) {

231 
	`fÜm_£t_”rÜ
('ty³', 
	`t
('Thmachše-»adabË‚am%ty³ i ®»adyak’.', 
	`¬¿y
('%ty³' => 
$ty³
->
ty³
)));

233 ià(!
	`´eg_m©ch
('!^[a-z0-9_]+$!', 
$ty³
->
ty³
)) {

234 
	`fÜm_£t_”rÜ
('ty³', 
	`t
('The machine-readable‚ame must contain only†owercase†etters,‚umbers,‡nd underscores.'));

238 ià(
	`š_¬¿y
(
$ty³
->
ty³
, 
	`¬¿y
('0', 'theme'))) {

239 
	`fÜm_£t_”rÜ
('ty³', 
	`t
("Inv®id machše-»adabË‚ame. PËa£ƒÁ”‡‚amÙh”hª %šv®id.", 
	`¬¿y
('%šv®id' => 
$ty³
->
ty³
)));

243 
$Çmes
 = 
	`¬¿y_æ
(
$ty³s
);

245 ià(
	`is£t
(
$Çmes
[
$ty³
->
Çme
]è&& $Çmes[$ty³->Çme] !ğ
$Şd_ty³
) {

246 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('Thhumª-»adabË‚am%Çmi ®»adyak’.', 
	`¬¿y
('%Çme' => 
$ty³
->
Çme
)));

248 
	}
}

253 
funùiÚ
 
	$node_ty³_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

254 
$İ
 = 
	`is£t
(
$fÜm_¡©e
['values']['op']) ? $form_state['values']['op'] : '';

256 
$ty³
 = 
Ãw
 
	`¡dCÏss
();

258 
$ty³
->
ty³
 = 
	`Œim
(
$fÜm_¡©e
['values']['type']);

259 
$ty³
->
Çme
 = 
	`Œim
(
$fÜm_¡©e
['values']['name']);

260 
$ty³
->
Üig_ty³
 = 
	`Œim
(
$fÜm_¡©e
['values']['orig_type']);

261 
$ty³
->
Şd_ty³
 = 
	`is£t
(
$fÜm_¡©e
['v®ues']['Şd_ty³']è? $fÜm_¡©e['v®ues']['Şd_ty³'] : $ty³->
ty³
;

263 
$ty³
->
desütiÚ
 = 
$fÜm_¡©e
['values']['description'];

264 
$ty³
->
h–p
 = 
$fÜm_¡©e
['values']['help'];

265 
$ty³
->
mš_wÜd_couÁ
 = 
$fÜm_¡©e
['values']['min_word_count'];

266 
$ty³
->
t™Ë_Ïb–
 = 
$fÜm_¡©e
['values']['title_label'];

267 
$ty³
->
body_Ïb–
 = 
$fÜm_¡©e
['values']['body_label'];

271 
$ty³
->
has_t™Ë
 = ($ty³->
t™Ë_Ïb–
 != '');

272 
$ty³
->
has_body
 = ($ty³->
body_Ïb–
 != '');

274 
$ty³
->
moduË
 = !
	`em±y
(
$fÜm_¡©e
['values']['module']) ? $form_state['values']['module'] : 'node';

275 
$ty³
->
cu¡om
 = 
$fÜm_¡©e
['values']['custom'];

276 
$ty³
->
modif›d
 = 
TRUE
;

277 
$ty³
->
locked
 = 
$fÜm_¡©e
['values']['locked'];

279 ià(
$İ
 =ğ
	`t
('Reseto defaults')) {

280 
	`node_ty³_»£t
(
$ty³
);

282 
	`–£if
 (
$İ
 =ğ
	`t
('Delete contentype')) {

283 
$fÜm_¡©e
['»dœeù'] = 'admš/cÚ‹Á/node-ty³/'. 
	`¡r_»¶aû
('_', '-', 
$ty³
->
Şd_ty³
) .'/delete';

287 
$¡©us
 = 
	`node_ty³_§ve
(
$ty³
);

289 
$v¬ŸbËs
 = 
$fÜm_¡©e
['values'];

293 
	`fÜ—ch
 (
$v¬ŸbËs
 
as
 
$key
 => 
$v®ue
) {

294 ià(
	`is£t
(
$ty³
->
$key
)) {

295 
	`un£t
(
$v¬ŸbËs
[
$key
]);

299 
	`un£t
(
$v¬ŸbËs
['form_token'], $variables['op'], $variables['submit'], $variables['delete'], $variables['reset'], $variables['form_id']);

302 
	`fÜ—ch
 (
$v¬ŸbËs
 
as
 
$key
 => 
$v®ue
) {

303 
$v¬ŸbË_Ãw
 = 
$key
 .'_'. 
$ty³
->
ty³
;

304 
$v¬ŸbË_Şd
 = 
$key
 .'_'. 
$ty³
->
Şd_ty³
;

306 ià(
$İ
 =ğ
	`t
('Reseto defaults')) {

307 
	`v¬ŸbË_d–
(
$v¬ŸbË_Şd
);

310 ià(
	`is_¬¿y
(
$v®ue
)) {

311 
$v®ue
 = 
	`¬¿y_keys
(
	`¬¿y_f‹r
($value));

313 
	`v¬ŸbË_£t
(
$v¬ŸbË_Ãw
, 
$v®ue
);

315 ià(
$v¬ŸbË_Ãw
 !ğ
$v¬ŸbË_Şd
) {

316 
	`v¬ŸbË_d–
(
$v¬ŸbË_Şd
);

321 
	`node_ty³s_»bud
();

322 
	`m’u_»bud
();

323 
$t_¬gs
 = 
	`¬¿y
('%Çme' => 
$ty³
->
Çme
);

325 ià(
$İ
 =ğ
	`t
('Reseto defaults')) {

326 
	`dru·l_£t_mes§ge
(
	`t
('ThcÚ‹Áy³ %Çmha b“À»£ˆtØ™ deçuÉ v®ues.', 
$t_¬gs
));

330 ià(
$¡©us
 =ğ
SAVED_UPDATED
) {

331 
	`dru·l_£t_mes§ge
(
	`t
('ThcÚ‹Áy³ %Çmha b“Àupd©ed.', 
$t_¬gs
));

333 
	`–£if
 (
$¡©us
 =ğ
SAVED_NEW
) {

334 
	`dru·l_£t_mes§ge
(
	`t
('ThcÚ‹Áy³ %Çmha b“Àadded.', 
$t_¬gs
));

335 
	`w©chdog
('node', 'Added cÚ‹Áy³ %Çme.', 
$t_¬gs
, 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('view'), 'admin/content/types'));

338 
$fÜm_¡©e
['redirect'] = 'admin/content/types';

340 
	}
}

345 
funùiÚ
 
	$node_node_ty³
(
$İ
, 
$šfo
) {

346 ià(
$İ
 !ğ'd–‘e' && !
	`em±y
(
$šfo
->
Şd_ty³
è&& $šfo->Şd_ty³ !ğ$šfo->
ty³
) {

347 
$upd©e_couÁ
 = 
	`node_ty³_upd©e_nodes
(
$šfo
->
Şd_ty³
, $šfo->
ty³
);

349 ià(
$upd©e_couÁ
) {

350 
	`dru·l_£t_mes§ge
(
	`fÜm©_¶u¿l
(
$upd©e_couÁ
, 'ChªgedhcÚ‹Áy³ oà1…o¡ from %Şd-ty³Ø%ty³.', 'ChªgedhcÚ‹Áy³ oà@couÁ…o¡ äom %Şd-ty³Ø%ty³.', 
	`¬¿y
('%Şd-ty³' => 
$šfo
->
Şd_ty³
, '%ty³' => $šfo->
ty³
)));

353 
	}
}

364 
funùiÚ
 
	$node_ty³_»£t
(&
$ty³
) {

365 
$šfo_¬¿y
 = 
	`moduË_švoke_®l
('node_info');

366 ià(
	`is£t
(
$šfo_¬¿y
[
$ty³
->
Üig_ty³
])) {

367 
$šfo_¬¿y
[
$ty³
->
Üig_ty³
]['type'] = $type->orig_type;

368 
$šfo
 = 
	`_node_ty³_£t_deçuÉs
(
$šfo_¬¿y
[
$ty³
->
Üig_ty³
]);

370 
	`fÜ—ch
 (
$šfo
 
as
 
$f›ld
 => 
$v®ue
) {

371 
$ty³
->
$f›ld
 = 
$v®ue
;

374 
	}
}

379 
funùiÚ
 
	$node_ty³_d–‘e_cÚfœm
(&
$fÜm_¡©e
, 
$ty³
) {

380 
$fÜm
['ty³'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$ty³
->
ty³
);

381 
$fÜm
['Çme'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$ty³
->
Çme
);

383 
$mes§ge
 = 
	`t
('A» you su» you wªˆtØd–‘thcÚ‹Áy³ %ty³?', 
	`¬¿y
('%ty³' => 
$ty³
->
Çme
));

384 
$ÿ±iÚ
 = '';

386 
$num_nodes
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {node} WHEREy³ = '%s'", 
$ty³
->
ty³
));

387 ià(
$num_nodes
) {

388 
$ÿ±iÚ
 .ğ'<p>'. 
	`fÜm©_¶u¿l
(
$num_nodes
, '<¡rÚg>W¬nšg:</¡rÚg>h”i cu¼’y 1 %ty³…o¡ oÀyou¸s™e. Iˆmay‚Ù babËØbdi¥Ïyed o¸ed™ed cÜ»ùly, onû you hav»movedhi cÚ‹Áy³.', '<¡rÚg>W¬nšg:</¡rÚg>h”¬cu¼’y @couÁ %ty³…o¡ Ú you¸s™e. They may‚Ù babËØbdi¥Ïyed o¸ed™ed cÜ»ùly, onû you hav»movedhi cÚ‹Áy³.', 
	`¬¿y
('%ty³' => 
$ty³
->
Çme
)) .'</p>';

391 
$ÿ±iÚ
 .ğ'<p>'. 
	`t
('This‡ction cannot be undone.') .'</p>';

393  
	`cÚfœm_fÜm
(
$fÜm
, 
$mes§ge
, 'admš/cÚ‹Á/ty³s', 
$ÿ±iÚ
, 
	`t
('Delete'));

394 
	}
}

399 
funùiÚ
 
	$node_ty³_d–‘e_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

400 
	`node_ty³_d–‘e
(
$fÜm_¡©e
['values']['type']);

402 
$t_¬gs
 = 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['name']);

403 
	`dru·l_£t_mes§ge
(
	`t
('ThcÚ‹Áy³ %Çmha b“Àd–‘ed.', 
$t_¬gs
));

404 
	`w©chdog
('m’u', 'D–‘ed cÚ‹Áy³ %Çme.', 
$t_¬gs
, 
WATCHDOG_NOTICE
);

406 
	`node_ty³s_»bud
();

407 
	`m’u_»bud
();

409 
$fÜm_¡©e
['redirect'] = 'admin/content/types';

411 
	}
}

	@/srv/http/subs/notes/www/modules/node/node.admin.inc

1 <?
php


12 
funùiÚ
 
	$node_cÚfigu»
() {

13 
$¡©us
 = '<p>'. 
	`t
('Ifhe site isƒxperiencing…roblems with…ermissionso content, you may haveo„ebuildhe…ermissions cache. Possible causes for…ermission…roblems‡re disabling modules or configuration changeso…ermissions. Rebuilding will„emove‡ll…rivilegeso…osts,‡nd„eplacehem with…ermissions based onhe current modules‡nd settings.') .'</p>';

14 
$¡©us
 .ğ'<p>'. 
	`t
('Rebuilding mayake someime ifhere is‡†ot of content or complex…ermission settings. After„ebuilding has completed…osts will‡utomatically usehe‚ew…ermissions.') .'</p>';

16 
$fÜm
['acûss'] = 
	`¬¿y
(

18 '#t™Ë' => 
	`t
('Node‡ccess status'),

20 
$fÜm
['acûss']['¡©us'] = 
	`¬¿y
('#v®ue' => 
$¡©us
);

21 
$fÜm
['acûss']['»bud'] = 
	`¬¿y
(

23 '#v®ue' => 
	`t
('Rebuild…ermissions'),

24 '#subm™' => 
	`¬¿y
('node_configure_access_submit'),

27 
$fÜm
['deçuÉ_nodes_maš'] = 
	`¬¿y
(

28 '#ty³' => '£Ëù', '#t™Ë' => 
	`t
('Numb” oàpo¡ Ú maš…age'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('default_nodes_main', 10),

29 '#İtiÚs' => 
	`dru·l_m­_assoc
(
	`¬¿y
(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 20, 25, 30)),

30 '#desütiÚ' => 
	`t
('The default maximum‚umber of…ostso display…er…age on overview…ages such‡she main…age.')

32 
$fÜm
['‹a£r_Ëngth'] = 
	`¬¿y
(

33 '#ty³' => '£Ëù', '#t™Ë' => 
	`t
('L’gth oàŒimmed…o¡s'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('teaser_length', 600),

34 '#İtiÚs' => 
	`¬¿y
(

35 0 => 
	`t
('Unlimited'),

36 200 => 
	`t
('200 characters'),

37 400 => 
	`t
('400 characters'),

38 600 => 
	`t
('600 characters'),

39 800 => 
	`t
('800 characters'),

40 1000 => 
	`t
('1000 characters'),

41 1200 => 
	`t
('1200 characters'),

42 1400 => 
	`t
('1400 characters'),

43 1600 => 
	`t
('1600 characters'),

44 1800 => 
	`t
('1800 characters'),

45 2000 => 
	`t
('2000 characters'),

47 '#desütiÚ' => 
	`t
("The maximum‚umber of characters used inherimmed version of‡…ost. Drupal will usehis settingo determine‡t which offset†ong…osts should berimmed. Therimmed version of‡…ost isypically used‡s‡easer when displayinghe…ost onhe main…age, in XML feeds,ƒtc. To disableeasers, seto 'Unlimited'. Notehathis setting will only‡ffect‚ew or updated content‡nd will‚ot‡ffectƒxistingeasers.")

50 
$fÜm
['node_´ev›w'] = 
	`¬¿y
(

52 '#t™Ë' => 
	`t
('Preview…ost'),

53 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('node_preview', 0),

54 '#İtiÚs' => 
	`¬¿y
(
	`t
('Optional'),('Required')),

55 '#desütiÚ' => 
	`t
('Must users…review…osts before submitting?'),

58  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

59 
	}
}

64 
funùiÚ
 
	$node_cÚfigu»_acûss_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

65 
$fÜm_¡©e
['redirect'] = 'admin/content/node-settings/rebuild';

66 
	}
}

71 
funùiÚ
 
	$node_cÚfigu»_»bud_cÚfœm
() {

72  
	`cÚfœm_fÜm
(
	`¬¿y
(), 
	`t
('Are you sure you wanto„ebuildhe…ermissions on site content?'),

73 'admš/cÚ‹Á/node-£‰šgs', 
	`t
('This‡ction„ebuilds‡ll…ermissions on site content,‡nd may be‡†engthy…rocess. This‡ction cannot be undone.'),('Rebuild…ermissions'),('Cancel'));

74 
	}
}

79 
funùiÚ
 
	$node_cÚfigu»_»bud_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

80 
	`node_acûss_»bud
(
TRUE
);

81 
$fÜm_¡©e
['redirect'] = 'admin/content/node-settings';

82 
	}
}

87 
funùiÚ
 
	$node_node_İ”©iÚs
() {

88 
$İ”©iÚs
 = 
	`¬¿y
(

89 'publish' => 
	`¬¿y
(

90 'Ïb–' => 
	`t
('Publish'),

92 'ÿÎback‡rgum’ts' => 
	`¬¿y
('updates' =>‡rray('status' => 1)),

94 'uÅublish' => 
	`¬¿y
(

95 'Ïb–' => 
	`t
('Unpublish'),

97 'ÿÎback‡rgum’ts' => 
	`¬¿y
('updates' =>‡rray('status' => 0)),

99 '´omÙe' => 
	`¬¿y
(

100 'Ïb–' => 
	`t
('Promoteo front…age'),

102 'ÿÎback‡rgum’ts' => 
	`¬¿y
('updates' =>‡rray('status' => 1, 'promote' => 1)),

104 'demÙe' => 
	`¬¿y
(

105 'Ïb–' => 
	`t
('Demote from front…age'),

107 'ÿÎback‡rgum’ts' => 
	`¬¿y
('updates' =>‡rray('promote' => 0)),

109 '¡icky' => 
	`¬¿y
(

110 'Ïb–' => 
	`t
('Make sticky'),

112 'ÿÎback‡rgum’ts' => 
	`¬¿y
('updates' =>‡rray('status' => 1, 'sticky' => 1)),

114 'un¡icky' => 
	`¬¿y
(

115 'Ïb–' => 
	`t
('Remove stickiness'),

117 'ÿÎback‡rgum’ts' => 
	`¬¿y
('updates' =>‡rray('sticky' => 0)),

119 'd–‘e' => 
	`¬¿y
(

120 'Ïb–' => 
	`t
('Delete'),

121 'ÿÎback' => 
NULL
,

124  
$İ”©iÚs
;

125 
	}
}

130 
funùiÚ
 
	$node_f‹rs
() {

132 
$f‹rs
['¡©us'] = 
	`¬¿y
(

133 't™Ë' => 
	`t
('status'),

134 'İtiÚs' => 
	`¬¿y
(

135 '¡©us-1' => 
	`t
('published'),

136 '¡©us-0' => 
	`t
('not…ublished'),

137 '´omÙe-1' => 
	`t
('promoted'),

138 '´omÙe-0' => 
	`t
('not…romoted'),

139 '¡icky-1' => 
	`t
('sticky'),

140 '¡icky-0' => 
	`t
('not sticky'),

144 ià(
	`moduË_exi¡s
('translation')) {

145 
$f‹rs
['¡©us']['İtiÚs'] +ğ
	`¬¿y
(

146 'Œª¦©e-0' => 
	`t
('Upo dateranslation'),

147 'Œª¦©e-1' => 
	`t
('Outdatedranslation'),

151 
$f‹rs
['ty³'] = 
	`¬¿y
('t™Ë' => 
	`t
('ty³'), 'İtiÚs' => 
	`node_g‘_ty³s
('names'));

154 ià(
$xÚomy
 = 
	`moduË_švoke
('taxonomy', 'form_all', 1)) {

155 
$f‹rs
['ÿ‹gÜy'] = 
	`¬¿y
('t™Ë' => 
	`t
('ÿ‹gÜy'), 'İtiÚs' => 
$xÚomy
);

158 ià(
$Ïnguages
 = 
	`moduË_švoke
('locale', 'language_list')) {

159 
$Ïnguages
 = 
	`¬¿y
('' => 
	`t
('Language‚eutral')) + $languages;

160 
$f‹rs
['Ïnguage'] = 
	`¬¿y
('t™Ë' => 
	`t
('Ïnguage'), 'İtiÚs' => 
$Ïnguages
);

162  
$f‹rs
;

163 
	}
}

168 
funùiÚ
 
	$node_bud_f‹r_qu”y
() {

169 
$f‹rs
 = 
	`node_f‹rs
();

172 
$wh”e
 = 
$¬gs
 = 
	`¬¿y
();

173 
$još
 = '';

174 
	`fÜ—ch
 (
$_SESSION
['node_ov”v›w_f‹r'] 
as
 
$šdex
 => 
$f‹r
) {

175 
	`li¡
(
$key
, 
$v®ue
èğ
$f‹r
;

176 
$key
) {

179 
	`li¡
(
$key
, 
$v®ue
èğ
	`ex¶ode
('-', $value, 2);

180 
$wh”e
[] = 'n.'. 
$key
 .' = %d';

183 
$bË
 = "tn$index";

184 
$wh”e
[] = "$table.tid = %d";

185 
$još
 .= "INNER JOIN {term_node} $table ON‚.nid = $table.nid ";

188 
$wh”e
[] = "n.type = '%s'";

191 
$wh”e
[] = "n.language = '%s'";

194 
$¬gs
[] = 
$v®ue
;

196 
$wh”e
 = 
	`couÁ
($wh”eè? 'WHERE '. 
	`im¶ode
(' AND ', $where) : '';

198  
	`¬¿y
('wh”e' => 
$wh”e
, 'još' => 
$još
, '¬gs' => 
$¬gs
);

199 
	}
}

204 
funùiÚ
 
	$node_f‹r_fÜm
() {

205 
$£ssiÚ
 = &
$_SESSION
['node_overview_filter'];

206 
$£ssiÚ
 = 
	`is_¬¿y
($£ssiÚè? $£ssiÚ : 
	`¬¿y
();

207 
$f‹rs
 = 
	`node_f‹rs
();

209 
$i
 = 0;

210 
$fÜm
['f‹rs'] = 
	`¬¿y
(

212 '#t™Ë' => 
	`t
('Show only items where'),

215 
$fÜm
['#submit'][] = 'node_filter_form_submit';

216 
	`fÜ—ch
 (
$£ssiÚ
 
as
 
$f‹r
) {

217 
	`li¡
(
$ty³
, 
$v®ue
èğ
$f‹r
;

218 ià(
$ty³
 == 'category') {

220 
$v®ue
 = 
	`moduË_švoke
('taxonomy', 'get_term', $value);

221 
$v®ue
 = $v®ue->
Çme
;

223 ià(
$ty³
 == 'language') {

224 
$v®ue
 = 
	`em±y
($v®ueè? 
	`t
('LªguagÃuŒ®'è: 
	`moduË_švoke
('locale', 'language_name', $value);

227 
$v®ue
 = 
$f‹rs
[
$ty³
]['options'][$value];

229 ià(
$i
++) {

230 
$fÜm
['f‹rs']['cu¼’t'][] = 
	`¬¿y
('#v®ue' => 
	`t
('<em>ªd</em> wh”<¡rÚg>%a</¡rÚg> i <¡rÚg>%b</¡rÚg>',‡¼ay('%a' => 
$f‹rs
[
$ty³
]['t™Ë'], '%b' => 
$v®ue
)));

233 
$fÜm
['f‹rs']['cu¼’t'][] = 
	`¬¿y
('#v®ue' => 
	`t
('<¡rÚg>%a</¡rÚg> i <¡rÚg>%b</¡rÚg>',‡¼ay('%a' => 
$f‹rs
[
$ty³
]['t™Ë'], '%b' => 
$v®ue
)));

235 ià(
	`š_¬¿y
(
$ty³
, 
	`¬¿y
('type', 'language'))) {

237 
	`un£t
(
$f‹rs
[
$ty³
]);

241 
	`fÜ—ch
 (
$f‹rs
 
as
 
$key
 => 
$f‹r
) {

242 
$Çmes
[
$key
] = 
$f‹r
['title'];

243 
$fÜm
['f‹rs']['¡©us'][
$key
] = 
	`¬¿y
('#ty³' => '£Ëù', '#İtiÚs' => 
$f‹r
['options']);

246 
$fÜm
['f‹rs']['f‹r'] = 
	`¬¿y
('#ty³' => '¿dios', '#İtiÚs' => 
$Çmes
, '#default_value' => 'status');

247 
$fÜm
['f‹rs']['bu‰Ús']['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => (
	`couÁ
(
$£ssiÚ
è? 
	`t
('Refine') :('Filter')));

248 ià(
	`couÁ
(
$£ssiÚ
)) {

249 
$fÜm
['f‹rs']['bu‰Ús']['undo'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Undo'));

250 
$fÜm
['f‹rs']['bu‰Ús']['»£t'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Reset'));

253 
	`dru·l_add_js
('misc/form.js', 'core');

255  
$fÜm
;

256 
	}
}

263 
funùiÚ
 
	$theme_node_f‹r_fÜm
(
$fÜm
) {

264 
$ouut
 = '';

265 
$ouut
 .= '<div id="node-admin-filter">';

266 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['filters']);

267 
$ouut
 .= '</div>';

268 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

269  
$ouut
;

270 
	}
}

277 
funùiÚ
 
	$theme_node_f‹rs
(
$fÜm
) {

278 
$ouut
 = '';

279 
$ouut
 .= '<ul class="clear-block">';

280 ià(!
	`em±y
(
$fÜm
['current'])) {

281 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['cu¼’t']è
as
 
$key
) {

282 
$ouut
 .ğ'<li>'. 
	`dru·l_»nd”
(
$fÜm
['cu¼’t'][
$key
]) .'</li>';

286 
$ouut
 .ğ'<li><dÈşass="muÉi£Ëù">'. (!
	`em±y
(
$fÜm
['cu¼’t']è? '<dt><em>'. 
	`t
('and') .'</em> '.('where') .'</dt>' : '') .'<dd class="a">';

287 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['f‹r']è
as
 
$key
) {

288 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['f‹r'][
$key
]);

290 
$ouut
 .= '</dd>';

292 
$ouut
 .ğ'<dt>'. 
	`t
('is') .'</dt><dd class="b">';

294 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['¡©us']è
as
 
$key
) {

295 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['¡©us'][
$key
]);

297 
$ouut
 .= '</dd>';

299 
$ouut
 .= '</dl>';

300 
$ouut
 .ğ'<div cÏss="cÚš”-šlše" id="node-admš-bu‰Ús">'. 
	`dru·l_»nd”
(
$fÜm
['buttons']) .'</div>';

301 
$ouut
 .= '</li></ul>';

303  
$ouut
;

304 
	}
}

309 
funùiÚ
 
	$node_f‹r_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

310 
$f‹rs
 = 
	`node_f‹rs
();

311 
$fÜm_¡©e
['values']['op']) {

312 
	`t
('Filter'):

313 
	`t
('Refine'):

314 ià(
	`is£t
(
$fÜm_¡©e
['values']['filter'])) {

315 
$f‹r
 = 
$fÜm_¡©e
['values']['filter'];

318 
$æ©_İtiÚs
 = 
	`fÜm_İtiÚs_æ©‹n
(
$f‹rs
[
$f‹r
]['options']);

320 ià(
	`is£t
(
$æ©_İtiÚs
[
$fÜm_¡©e
['v®ues'][
$f‹r
]])) {

321 
$_SESSION
['node_ov”v›w_f‹r'][] = 
	`¬¿y
(
$f‹r
, 
$fÜm_¡©e
['values'][$filter]);

325 
	`t
('Undo'):

326 
	`¬¿y_pİ
(
$_SESSION
['node_overview_filter']);

328 
	`t
('Reset'):

329 
$_SESSION
['node_ov”v›w_f‹r'] = 
	`¬¿y
();

332 
	}
}

348 
funùiÚ
 
	$node_mass_upd©e
(
$nodes
, 
$upd©es
) {

351 ià(
	`couÁ
(
$nodes
) > 10) {

352 
$b©ch
 = 
	`¬¿y
(

353 'İ”©iÚs' => 
	`¬¿y
(

354 
	`¬¿y
('_node_mass_upd©e_b©ch_´oûss',‡¼ay(
$nodes
, 
$upd©es
))

357 't™Ë' => 
	`t
('Processing'),

361 '”rÜ_mes§ge' => 
	`t
('The update hasƒncountered‡nƒrror.'),

364 'fe' => 
	`dru·l_g‘_·th
('module', 'node') .'/node.admin.inc',

366 
	`b©ch_£t
(
$b©ch
);

369 
	`fÜ—ch
 (
$nodes
 
as
 
$nid
) {

370 
	`_node_mass_upd©e_h–³r
(
$nid
, 
$upd©es
);

372 
	`dru·l_£t_mes§ge
(
	`t
('The update has been…erformed.'));

374 
	}
}

379 
funùiÚ
 
	$_node_mass_upd©e_h–³r
(
$nid
, 
$upd©es
) {

380 
$node
 = 
	`node_lßd
(
$nid
, 
NULL
, 
TRUE
);

381 
	`fÜ—ch
 (
$upd©es
 
as
 
$Çme
 => 
$v®ue
) {

382 
$node
->
$Çme
 = 
$v®ue
;

384 
	`node_§ve
(
$node
);

385  
$node
;

386 
	}
}

391 
funùiÚ
 
	$_node_mass_upd©e_b©ch_´oûss
(
$nodes
, 
$upd©es
, &
$cÚ‹xt
) {

392 ià(!
	`is£t
(
$cÚ‹xt
['sandbox']['progress'])) {

393 
$cÚ‹xt
['sandbox']['progress'] = 0;

394 
$cÚ‹xt
['§ndbox']['max'] = 
	`couÁ
(
$nodes
);

395 
$cÚ‹xt
['§ndbox']['nodes'] = 
$nodes
;

399 
$couÁ
 = 
	`mš
(5, 
	`couÁ
(
$cÚ‹xt
['sandbox']['nodes']));

400 
$i
 = 1; $˜<ğ
$couÁ
; $i++) {

402 
$nid
 = 
	`¬¿y_shiá
(
$cÚ‹xt
['sandbox']['nodes']);

403 
$node
 = 
	`_node_mass_upd©e_h–³r
(
$nid
, 
$upd©es
);

406 
$cÚ‹xt
['»suÉs'][] = 
	`l
(
$node
->
t™Ë
, 'node/'. $node->
nid
);

409 
$cÚ‹xt
['sandbox']['progress']++;

414 ià(
$cÚ‹xt
['sandbox']['progress'] != $context['sandbox']['max']) {

415 
$cÚ‹xt
['finished'] = $context['sandbox']['progress'] / $context['sandbox']['max'];

417 
	}
}

422 
funùiÚ
 
	$_node_mass_upd©e_b©ch_fšished
(
$sucûss
, 
$»suÉs
, 
$İ”©iÚs
) {

423 ià(
$sucûss
) {

424 
	`dru·l_£t_mes§ge
(
	`t
('The update has been…erformed.'));

427 
	`dru·l_£t_mes§ge
(
	`t
('Anƒrror occurred‡nd…rocessing did‚ot complete.'), 'error');

428 
$mes§ge
 = 
	`fÜm©_¶u¿l
(
	`couÁ
(
$»suÉs
), '1 item successfully…rocessed:', '@count items successfully…rocessed:');

429 
$mes§ge
 .ğ
	`theme
('™em_li¡', 
$»suÉs
);

430 
	`dru·l_£t_mes§ge
(
$mes§ge
);

432 
	}
}

437 
funùiÚ
 
	$node_admš_cÚ‹Á
(
$fÜm_¡©e
) {

438 ià(
	`is£t
(
$fÜm_¡©e
['values']['operation']) && $form_state['values']['operation'] == 'delete') {

439  
	`node_muÉË_d–‘e_cÚfœm
(
$fÜm_¡©e
, 
	`¬¿y_f‹r
($form_state['values']['nodes']));

441 
$fÜm
 = 
	`node_f‹r_fÜm
();

443 
$fÜm
['#theme'] = 'node_filter_form';

444 
$fÜm
['admš'] = 
	`node_admš_nodes
();

446  
$fÜm
;

447 
	}
}

452 
funùiÚ
 
	$node_admš_nodes
() {

454 
$f‹r
 = 
	`node_bud_f‹r_qu”y
();

456 
$»suÉ
 = 
	`·g”_qu”y
(
	`db_»wr™e_sql
('SELECT‚.*, u.ÇmFROM {node}‚ '. 
$f‹r
['još'] .' INNER JOIN {u£rs} u ON‚.uid = u.uid '. $f‹r['wh”e'] .' ORDER BY‚.chªged DESC'), 50, 0, 
NULL
, $filter['args']);

459 
$couÁ
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*) FROM {node}‚ WHERE†anguage != ''"));

460 
$muÉªguage
 = (
	`moduË_exi¡s
('loÿË'è|| 
$couÁ
);

462 
$fÜm
['İtiÚs'] = 
	`¬¿y
(

464 '#t™Ë' => 
	`t
('Update options'),

468 
$İtiÚs
 = 
	`¬¿y
();

469 
	`fÜ—ch
 (
	`moduË_švoke_®l
('node_İ”©iÚs'è
as
 
$İ”©iÚ
 => 
$¬¿y
) {

470 
$İtiÚs
[
$İ”©iÚ
] = 
$¬¿y
['label'];

472 
$fÜm
['İtiÚs']['İ”©iÚ'] = 
	`¬¿y
(

474 '#İtiÚs' => 
$İtiÚs
,

477 
$fÜm
['İtiÚs']['subm™'] = 
	`¬¿y
(

479 '#v®ue' => 
	`t
('Update'),

480 '#subm™' => 
	`¬¿y
('node_admin_nodes_submit'),

483 
$Ïnguages
 = 
	`Ïnguage_li¡
();

484 
$de¡š©iÚ
 = 
	`dru·l_g‘_de¡š©iÚ
();

485 
$nodes
 = 
	`¬¿y
();

486 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

487 
$nodes
[
$node
->
nid
] = '';

488 
$İtiÚs
 = 
	`em±y
(
$node
->
Ïnguage
è? 
	`¬¿y
(è:‡¼ay('Ïnguage' => 
$Ïnguages
[$node->language]);

489 
$fÜm
['t™Ë'][
$node
->
nid
] = 
	`¬¿y
('#v®ue' => 
	`l
($node->
t™Ë
, 'node/'. $node->nid, 
$İtiÚs
è.' '. 
	`theme
('m¬k', 
	`node_m¬k
($node->nid, $node->
chªged
)));

490 
$fÜm
['Çme'][
$node
->
nid
] = 
	`¬¿y
('#v®ue' => 
	`check_¶aš
(
	`node_g‘_ty³s
('name', $node)));

491 
$fÜm
['u£ºame'][
$node
->
nid
] = 
	`¬¿y
('#v®ue' => 
	`theme
('username', $node));

492 
$fÜm
['¡©us'][
$node
->
nid
] = 
	`¬¿y
('#v®ue' => ($node->
¡©us
 ? 
	`t
('published') :('not…ublished')));

493 ià(
$muÉªguage
) {

494 
$fÜm
['Ïnguage'][
$node
->
nid
] = 
	`¬¿y
('#v®ue' => 
	`em±y
($node->
Ïnguage
è? 
	`t
('LªguagÃuŒ®'è:(
$Ïnguages
[$node->Ïnguage]->
Çme
));

496 
$fÜm
['İ”©iÚs'][
$node
->
nid
] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('ed™'), 'node/'. $node->nid .'/ed™',‡¼ay('qu”y' => 
$de¡š©iÚ
)));

498 
$fÜm
['nodes'] = 
	`¬¿y
('#ty³' => 'checkboxes', '#İtiÚs' => 
$nodes
);

499 
$fÜm
['·g”'] = 
	`¬¿y
('#v®ue' => 
	`theme
('·g”', 
NULL
, 50, 0));

500 
$fÜm
['#theme'] = 'node_admin_nodes';

501  
$fÜm
;

502 
	}
}

510 
funùiÚ
 
	$node_admš_nodes_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

511 
$nodes
 = 
	`¬¿y_f‹r
(
$fÜm_¡©e
['values']['nodes']);

512 ià(
	`couÁ
(
$nodes
) == 0) {

513 
	`fÜm_£t_”rÜ
('', 
	`t
('No items selected.'));

515 
	}
}

522 
funùiÚ
 
	$node_admš_nodes_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

523 
$İ”©iÚs
 = 
	`moduË_švoke_®l
('node_operations');

524 
$İ”©iÚ
 = 
$İ”©iÚs
[
$fÜm_¡©e
['values']['operation']];

526 
$nodes
 = 
	`¬¿y_f‹r
(
$fÜm_¡©e
['values']['nodes']);

527 ià(
$funùiÚ
 = 
$İ”©iÚ
['callback']) {

529 ià(
	`is£t
(
$İ”©iÚ
['callback‡rguments'])) {

530 
$¬gs
 = 
	`¬¿y_m”ge
(
	`¬¿y
(
$nodes
), 
$İ”©iÚ
['callback‡rguments']);

533 
$¬gs
 = 
	`¬¿y
(
$nodes
);

535 
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
$¬gs
);

537 
	`ÿche_ş—r_®l
();

542 
$fÜm_¡©e
['»bud'] = 
TRUE
;

544 
	}
}

552 
funùiÚ
 
	$theme_node_admš_nodes
(
$fÜm
) {

555 
$has_po¡s
 = 
	`is£t
(
$fÜm
['t™Ë']è&& 
	`is_¬¿y
($form['title']);

556 
$£Ëù_h—d”
 = 
$has_po¡s
 ? 
	`theme
('table_select_header_cell') : '';

557 
$h—d”
 = 
	`¬¿y
(
$£Ëù_h—d”
, 
	`t
('Title'),('Type'),('Author'),('Status'));

558 ià(
	`is£t
(
$fÜm
['language'])) {

559 
$h—d”
[] = 
	`t
('Language');

561 
$h—d”
[] = 
	`t
('Operations');

562 
$ouut
 = '';

564 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['options']);

565 ià(
$has_po¡s
) {

566 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['t™Ë']è
as
 
$key
) {

567 
$row
 = 
	`¬¿y
();

568 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['nodes'][
$key
]);

569 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['t™Ë'][
$key
]);

570 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['Çme'][
$key
]);

571 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['u£ºame'][
$key
]);

572 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['¡©us'][
$key
]);

573 ià(
	`is£t
(
$fÜm
['language'])) {

574 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['Ïnguage'][
$key
]);

576 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['İ”©iÚs'][
$key
]);

577 
$rows
[] = 
$row
;

582 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No…osts‡vailable.'), 'colspan' => '6'));

585 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

586 ià(
$fÜm
['pager']['#value']) {

587 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['pager']);

590 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

592  
$ouut
;

593 
	}
}

595 
funùiÚ
 
	$node_muÉË_d–‘e_cÚfœm
(&
$fÜm_¡©e
, 
$nodes
) {

597 
$fÜm
['nodes'] = 
	`¬¿y
('#´efix' => '<ul>', '#suffix' => '</ul>', '#Œ“' => 
TRUE
);

599 
	`fÜ—ch
 (
$nodes
 
as
 
$nid
 => 
$v®ue
) {

600 
$t™Ë
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT™Ë FROM {node} WHERE‚id = %d', 
$nid
));

601 
$fÜm
['nodes'][
$nid
] = 
	`¬¿y
(

603 '#v®ue' => 
$nid
,

605 '#suffix' => 
	`check_¶aš
(
$t™Ë
) ."</li>\n",

608 
$fÜm
['İ”©iÚ'] = 
	`¬¿y
('#type' => 'hidden', '#value' => 'delete');

609 
$fÜm
['#submit'][] = 'node_multiple_delete_confirm_submit';

610  
	`cÚfœm_fÜm
(
$fÜm
,

611 
	`t
('Are you sure you wanto deletehese items?'),

612 'admš/cÚ‹Á/node', 
	`t
('This‡ction cannot be undone.'),

613 
	`t
('Delete‡ll'),('Cancel'));

614 
	}
}

616 
funùiÚ
 
	$node_muÉË_d–‘e_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

617 ià(
$fÜm_¡©e
['values']['confirm']) {

618 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['nodes'] 
as
 
$nid
 => 
$v®ue
) {

619 
	`node_d–‘e
(
$nid
);

621 
	`dru·l_£t_mes§ge
(
	`t
('The items have been deleted.'));

623 
$fÜm_¡©e
['redirect'] = 'admin/content/node';

625 
	}
}

	@/srv/http/subs/notes/www/modules/node/node.module

1 <?
php


16 
defše
('NODE_NEW_LIMIT', 
time
() - 30 * 24 * 60 * 60);

18 
defše
('NODE_BUILD_NORMAL', 0);

19 
defše
('NODE_BUILD_PREVIEW', 1);

20 
defše
('NODE_BUILD_SEARCH_INDEX', 2);

21 
defše
('NODE_BUILD_SEARCH_RESULT', 3);

22 
defše
('NODE_BUILD_RSS', 4);

23 
defše
('NODE_BUILD_PRINT', 5);

28 
funùiÚ
 
	$node_h–p
(
$·th
, 
$¬g
) {

32 ià(
$·th
 !ğ'admš/cÚ‹Á/node-£‰šgs/»bud' && $·th !ğ'b©ch' && 
	`¡½os
($·th, '#'è==ğ
FALSE


33 && 
	`u£r_acûss
('acûs admši¡¿tiÚ…ages'è&& 
	`node_acûss_Ãeds_»bud
()) {

34 ià(
$·th
 == 'admin/content/node-settings') {

35 
$mes§ge
 = 
	`t
('The content‡ccess…ermissions‚eedo be„ebuilt.');

38 
$mes§ge
 = 
	`t
('ThcÚ‹Á‡cûs ³rmissiÚ ÃedØb»but. PËa£ vis™ <¨h»f="@node_acûss_»bud">thi ·ge</a>.', 
	`¬¿y
('@node_acûss_»bud' => 
	`u¾
('admin/content/node-settings/rebuild')));

40 
	`dru·l_£t_mes§ge
(
$mes§ge
, 'error');

43 
$·th
) {

45 
$ouut
 = '<p>'. 
	`t
('The‚ode module manages content on your site,‡nd stores‡ll…osts (regardless ofype)‡s‡ "node". In‡dditiono basic…ublishing settings, including whetherhe…ost has been…ublished,…romotedohe site front…age, or should„emain…resent (or sticky)‡theop of†ists,he‚ode module‡lso„ecords basic information‡bouthe‡uthor of‡…ost. Optional„evision control overƒdits is‡vailable. For‡dditional functionality,he‚ode module is oftenƒxtended by other modules.') .'</p>';

46 
$ouut
 .ğ'<p>'. 
	`t
('Thoughƒach…o¡ oÀyou¸s™i ¨node,ƒach…o¡ i ®sØoà¨·¹icuÏ¸<¨h»f="@cÚ‹Á-ty³">cÚ‹Áy³</a>. <¨h»f="@cÚ‹Á-ty³">CÚ‹Áy³s</a>‡» u£dØdefšthch¬aù”i¡ic oà¨po¡, inşudšght™Ë‡nd desütiÚ oàthf›ld di¥Ïyed oÀ™ add‡ndƒd™…ages. Each cÚ‹Áy³ may havdifã»Á deçuÉ s‘tšg fÜ <em>Publishšg o±iÚs</em>‡nd oth” wÜkæow cÚŒŞs. By deçuÉ,htwØcÚ‹Áy³ š‡ snd¬d Dru·Èš¡®ÏtiÚ‡» <em>Page</em>‡nd <em>StÜy</em>. U£h<¨h»f="@cÚ‹Á-ty³">cÚ‹Áy³ ·ge</a>Øadd‚ew o¸ed™ƒxi¡šg cÚ‹Áy³s. Add™iÚ® cÚ‹Áy³ ®sØbecomavaabË‡ youƒÇbË‡dd™iÚ® cÜe, cÚŒibu‹d‡nd cu¡om moduËs.', 
	`¬¿y
('@cÚ‹Á-ty³' => 
	`u¾
('admin/content/types'))) .'</p>';

47 
$ouut
 .ğ'<p>'. 
	`t
('Thadmši¡¿tiv<¨h»f="@cÚ‹Á">cÚ‹Á…age</a>‡Îow youØ»v›w‡nd mªagyou¸s™cÚ‹Á. Th<¨h»f="@po¡-£‰šgs">po¡ s‘tšg ·ge</a> s‘ û¹aš o±iÚ fÜhdi¥Ïy oàpo¡s. ThnodmoduË make ¨numb” oà³rmissiÚ avaabË fÜƒach cÚ‹Áy³, which may b£ˆby„ŞÚh<¨h»f="@³rmissiÚs">³rmissiÚ ·ge</a>.', 
	`¬¿y
('@cÚ‹Á' => 
	`u¾
('admin/content/node'), '@post-settings' => url('admin/content/node-settings'), '@permissions' => url('admin/user/permissions'))) .'</p>';

48 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@node">NodmoduË</a>.', 
	`¬¿y
('@node' => 'http://drupal.org/handbook/modules/node/')) .'</p>';

49  
$ouut
;

53  '<p>'. 
	`t
('Below is‡†ist of‡llhe contentypes on your site. All…ostshatƒxist on your site‡re instances of one ofhese contentypes.') .'</p>';

55  '<p>'. 
	`t
('To create‡‚ew contentype,ƒnterhe human-readable‚ame,he machine-readable‚ame,‡nd‡ll other„elevant fieldshat‡re onhis…age. Once created, users of your site will be‡bleo create…ostshat‡re instances ofhis contentype.') .'</p>';

57  '<p>'. 
	`t
('The„evisions†et yourack differences between multiple versions of‡…ost.') .'</p>';

59 
$node
 = 
	`node_lßd
(
$¬g
[1]);

60 
$ty³
 = 
	`node_g‘_ty³s
('ty³', 
$node
->
ty³
);

61  (!
	`em±y
(
$ty³
->
h–p
è? '<p>'. 
	`f‹r_xss_admš
($type->help) .'</p>' : '');

64 ià(
$¬g
[0] == 'node' && $arg[1] == 'add' && $arg[2]) {

65 
$ty³
 = 
	`node_g‘_ty³s
('ty³', 
	`¡r_»¶aû
('-', '_', 
$¬g
[2]));

66  (!
	`em±y
(
$ty³
->
h–p
è? '<p>'. 
	`f‹r_xss_admš
($type->help) .'</p>' : '');

68 
	}
}

73 
funùiÚ
 
	$node_theme
() {

74  
	`¬¿y
(

75 'node' => 
	`¬¿y
(

76 '¬gum’ts' => 
	`¬¿y
('node' => 
NULL
, '‹a£r' => 
FALSE
, 'page' => FALSE),

79 'node_li¡' => 
	`¬¿y
(

80 '¬gum’ts' => 
	`¬¿y
('™ems' => 
NULL
, 'title' => NULL),

82 'node_£¬ch_admš' => 
	`¬¿y
(

83 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

85 'node_f‹r_fÜm' => 
	`¬¿y
(

86 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

89 'node_f‹rs' => 
	`¬¿y
(

90 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

93 'node_admš_nodes' => 
	`¬¿y
(

94 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

97 'node_add_li¡' => 
	`¬¿y
(

98 '¬gum’ts' => 
	`¬¿y
('cÚ‹Á' => 
NULL
),

101 'node_fÜm' => 
	`¬¿y
(

102 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

105 'node_´ev›w' => 
	`¬¿y
(

106 '¬gum’ts' => 
	`¬¿y
('node' => 
NULL
),

109 'node_log_mes§ge' => 
	`¬¿y
(

110 '¬gum’ts' => 
	`¬¿y
('log' => 
NULL
),

112 'node_subm™‹d' => 
	`¬¿y
(

113 '¬gum’ts' => 
	`¬¿y
('node' => 
NULL
),

116 
	}
}

121 
funùiÚ
 
	$node_üÚ
() {

122 
	`db_qu”y
('DELETE FROM {hi¡Üy} WHEREime¡am°< %d', 
NODE_NEW_LIMIT
);

123 
	}
}

140 
funùiÚ
 
	$node_t™Ë_li¡
(
$»suÉ
, 
$t™Ë
 = 
NULL
) {

141 
$™ems
 = 
	`¬¿y
();

142 
$num_rows
 = 
FALSE
;

143 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

144 
$™ems
[] = 
	`l
(
$node
->
t™Ë
, 'node/'. $node->
nid
, !
	`em±y
($node->
comm’t_couÁ
è? 
	`¬¿y
('©Œibu‹s' =>‡¼ay('t™Ë' => 
	`fÜm©_¶u¿l
($node->comment_count, '1 comment', '@count comments'))) :‡rray());

145 
$num_rows
 = 
TRUE
;

148  
$num_rows
 ? 
	`theme
('node_li¡', 
$™ems
, 
$t™Ë
è: 
FALSE
;

149 
	}
}

156 
funùiÚ
 
	$theme_node_li¡
(
$™ems
, 
$t™Ë
 = 
NULL
) {

157  
	`theme
('™em_li¡', 
$™ems
, 
$t™Ë
);

158 
	}
}

163 
funùiÚ
 
	$node_g_Ãw
(
$nid
) {

164 
glob®
 
$u£r
;

166 ià(
$u£r
->
uid
) {

167 ià(
	`node_Ï¡_v›wed
(
$nid
)) {

168 
	`db_qu”y
('UPDATE {hi¡Üy} SETime¡am°ğ%d WHERE uid = %d AND‚id = %d', 
	`time
(), 
$u£r
->
uid
, 
$nid
);

171 @
	`db_qu”y
('INSERT INTO {hi¡Üy} (uid,‚id,ime¡ampèVALUES (%d, %d, %d)', 
$u£r
->
uid
, 
$nid
, 
	`time
());

174 
	}
}

180 
funùiÚ
 
	$node_Ï¡_v›wed
(
$nid
) {

181 
glob®
 
$u£r
;

182 
$hi¡Üy
;

184 ià(!
	`is£t
(
$hi¡Üy
[
$nid
])) {

185 
$hi¡Üy
[
$nid
] = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECTime¡am°FROM {hi¡Üy} WHERE uid = %d AND‚id = %d", 
$u£r
->
uid
, $nid));

188  (
	`is£t
(
$hi¡Üy
[
$nid
]->
time¡amp
) ? $history[$nid]->timestamp : 0);

189 
	}
}

201 
funùiÚ
 
	$node_m¬k
(
$nid
, 
$time¡amp
) {

202 
glob®
 
$u£r
;

203 
$ÿche
;

205 ià(!
$u£r
->
uid
) {

206  
MARK_READ
;

208 ià(!
	`is£t
(
$ÿche
[
$nid
])) {

209 
$ÿche
[
$nid
] = 
	`node_Ï¡_v›wed
($nid);

211 ià(
$ÿche
[
$nid
] =ğ0 && 
$time¡amp
 > 
NODE_NEW_LIMIT
) {

212  
MARK_NEW
;

214 
	`–£if
 (
$time¡amp
 > 
$ÿche
[
$nid
] && $time¡am°> 
NODE_NEW_LIMIT
) {

215  
MARK_UPDATED
;

217  
MARK_READ
;

218 
	}
}

223 
funùiÚ
 
	$node_‹a£r_js
(&
$fÜm
, &
$fÜm_¡©e
) {

224 ià(
	`is£t
(
$fÜm
['#post']['teaser_js'])) {

226 ià(
	`Œim
(
$fÜm_¡©e
['values']['teaser_js'])) {

228 
$body
 = 
	`Œim
(
$fÜm_¡©e
['values']['teaser_js']) ."\r\n<!--break-->\r\n".rim($form_state['values']['body']);

232 
$body
 = '<!--b»ak-->'. 
$fÜm_¡©e
['values']['body'];

235 
	`fÜm_£t_v®ue
(
$fÜm
['body'], 
$body
, 
$fÜm_¡©e
);

238 
$fÜm
['body']['#v®ue'] = 
$body
;

240  
$fÜm
;

241 
	}
}

258 
funùiÚ
 
	$node_‹a£r_šşude_v”ify
(&
$fÜm
, &
$fÜm_¡©e
) {

259 
$mes§ge
 = '';

262 ià(
	`is£t
(
$fÜm
['#po¡']['body']è&& is£t(
$fÜm_¡©e
['values']['teaser_include']) && !$form_state['values']['teaser_include']) {

264 ià(
	`¡½os
(
$fÜm_¡©e
['values']['body'], '<!--break-->') === 0) {

266 
$mes§ge
 = 
	`t
('You specifiedhathe summary should‚ot be shown whenhis…ost is displayed in full view. This setting is ignored whenhe summary isƒmpty.');

268 
	`–£if
 (
	`¡½os
(
$fÜm_¡©e
['v®ues']['body'], '<!--b»ak-->'è==ğ
FALSE
) {

270 
$mes§ge
 = 
	`t
('You specifiedhathe summary should‚ot be shown whenhis…ost is displayed in full view. This setting has been ignored since you have‚ot defined‡ summary forhe…ost. (To define‡ summary, inserthe delimiter "&lt;!--break--&gt;" (withouthe quotes) inhe Body ofhe…osto indicateheƒnd ofhe summary‡ndhe start ofhe main content.)');

273 ià(!
	`em±y
(
$mes§ge
)) {

274 
	`dru·l_£t_mes§ge
(
$mes§ge
, 'warning');

276 
	`fÜm_£t_v®ue
(
$fÜm
['‹a£r_šşude'], 1, 
$fÜm_¡©e
);

279 
$fÜm
['teaser_include']['#value'] = 1;

283  
$fÜm
;

284 
	}
}

307 
funùiÚ
 
	$node_‹a£r
(
$body
, 
$fÜm©
 = 
NULL
, 
$size
 = NULL) {

309 ià(!
	`is£t
(
$size
)) {

310 
$size
 = 
	`v¬ŸbË_g‘
('teaser_length', 600);

314 
$d–im™”
 = 
	`¡½os
(
$body
, '<!--break-->');

317 ià(
$size
 =ğ0 && 
$d–im™”
 ==ğ
FALSE
) {

318  
$body
;

322 ià(
$d–im™”
 !=ğ
FALSE
) {

323  
	`sub¡r
(
$body
, 0, 
$d–im™”
);

329 ià(
	`is£t
(
$fÜm©
)) {

330 
$f‹rs
 = 
	`f‹r_li¡_fÜm©
(
$fÜm©
);

331 ià(
	`is£t
(
$f‹rs
['php/0']è&& 
	`¡½os
(
$body
, '<?'è!=ğ
FALSE
) {

332  
$body
;

337 ià(
	`dru·l_¡¾’
(
$body
è<ğ
$size
) {

338  
$body
;

345 
$‹a£r
 = 
	`Œunÿ‹_utf8
(
$body
, 
$size
);

349 
$max_½os
 = 
	`¡¾’
(
$‹a£r
);

354 
$mš_½os
 = 
$max_½os
;

358 
$»v”£d
 = 
	`¡¼ev
(
$‹a£r
);

361 
$b»ak_pošts
 = 
	`¬¿y
();

364 
$b»ak_pošts
[] = 
	`¬¿y
('</p>' => 0);

367 
$lše_b»aks
 = 
	`¬¿y
('<br />' => 6, '<br>' => 4);

370 ià(
	`is£t
(
$f‹rs
['filter/1'])) {

371 
$lše_b»aks
["\n"] = 1;

373 
$b»ak_pošts
[] = 
$lše_b»aks
;

376 
$b»ak_pošts
[] = 
	`¬¿y
('. ' => 1, '! ' => 1, '? ' => 1, 'ã€‚' => 0, 'ØŸ ' => 1);

379 
	`fÜ—ch
 (
$b»ak_pošts
 
as
 
$pošts
) {

381 
	`fÜ—ch
 (
$pošts
 
as
 
$pošt
 => 
$off£t
) {

383 
$½os
 = 
	`¡½os
(
$»v”£d
, 
	`¡¼ev
(
$pošt
));

384 ià(
$½os
 !=ğ
FALSE
) {

385 
$mš_½os
 = 
	`mš
(
$½os
 + 
$off£t
, $min_rpos);

390 ià(
$mš_½os
 !=ğ
$max_½os
) {

392  (
$mš_½os
 ==ğ0è? 
$‹a£r
 : 
	`sub¡r
($teaser, 0, 0 - $min_rpos);

397  
$‹a£r
;

398 
	}
}

419 
funùiÚ
 
node_g‘_ty³s
(
$İ
 = 'ty³s', 
$node
 = 
NULL
, 
$»£t
 = 
FALSE
) {

420 
$_node_ty³s
, 
$_node_Çmes
;

422 ià(
	g$»£t
 || !
is£t
(
$_node_ty³s
)) {

423 
li¡
(
$_node_ty³s
, 
$_node_Çmes
èğ
_node_ty³s_bud
();

426 ià(
	g$node
) {

427 ià(
is_¬¿y
(
$node
)) {

428 
	g$ty³
 = 
$node
['type'];

430 
–£if
 (
is_objeù
(
$node
)) {

431 
	g$ty³
 = 
$node
->
ty³
;

433 
–£if
 (
is_¡ršg
(
$node
)) {

434 
	g$ty³
 = 
$node
;

436 ià(!
is£t
(
$_node_ty³s
[
$ty³
])) {

437  
	gFALSE
;

440 
	g$İ
) {

442  
$_node_ty³s
;

444  
is£t
(
$_node_ty³s
[
$ty³
]è? $_node_ty³s[$ty³] : 
FALSE
;

446  
is£t
(
$_node_ty³s
[
$ty³
]->
moduË
è? $_node_ty³s[$ty³]->moduË : 
FALSE
;

448  
$_node_Çmes
;

450  
is£t
(
$_node_Çmes
[
$ty³
]è? $_node_Çmes[$ty³] : 
FALSE
;

458 
funùiÚ
 
	$node_ty³s_»bud
() {

459 
	`_node_ty³s_bud
();

461 
$node_ty³s
 = 
	`node_g‘_ty³s
('ty³s', 
NULL
, 
TRUE
);

463 
	`fÜ—ch
 (
$node_ty³s
 
as
 
$ty³
 => 
$šfo
) {

464 ià(!
	`em±y
(
$šfo
->
is_Ãw
)) {

465 
	`node_ty³_§ve
(
$šfo
);

467 ià(!
	`em±y
(
$šfo
->
di§bËd
)) {

468 
	`node_ty³_d–‘e
(
$šfo
->
ty³
);

472 
	`_node_ty³s_bud
();

473 
	}
}

484 
funùiÚ
 
	$node_ty³_§ve
(
$šfo
) {

485 
$is_exi¡šg
 = 
FALSE
;

486 
$exi¡šg_ty³
 = !
	`em±y
(
$šfo
->
Şd_ty³
è? $šfo->Şd_ty³ : $šfo->
ty³
;

487 
$is_exi¡šg
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {node_ty³} WHEREy³ = '%s'", 
$exi¡šg_ty³
));

488 ià(!
	`is£t
(
$šfo
->
h–p
)) {

489 
$šfo
->
h–p
 = '';

491 ià(!
	`is£t
(
$šfo
->
mš_wÜd_couÁ
)) {

492 
$šfo
->
mš_wÜd_couÁ
 = 0;

494 ià(!
	`is£t
(
$šfo
->
body_Ïb–
)) {

495 
$šfo
->
body_Ïb–
 = '';

498 ià(
$is_exi¡šg
) {

499 
	`db_qu”y
("UPDATE {node_ty³} SETy³ = '%s',‚amğ'%s', moduË = '%s', has_t™Ë = %d,™Ë_Ïb– = '%s', has_body = %d, body_Ïb– = '%s', desütiÚ = '%s', h–°ğ'%s', mš_wÜd_couÁ = %d, cu¡om = %d, modif›d = %d,†ocked = %d WHEREy³ = '%s'", 
$šfo
->
ty³
, $šfo->
Çme
, $šfo->
moduË
, $šfo->
has_t™Ë
, $šfo->
t™Ë_Ïb–
, $šfo->
has_body
, $šfo->
body_Ïb–
, $šfo->
desütiÚ
, $šfo->
h–p
, $šfo->
mš_wÜd_couÁ
, $šfo->
cu¡om
, $šfo->
modif›d
, $šfo->
locked
, 
$exi¡šg_ty³
);

501 
	`moduË_švoke_®l
('node_ty³', 'upd©e', 
$šfo
);

502  
SAVED_UPDATED
;

505 
	`db_qu”y
("INSERT INTO {node_ty³} (ty³,‚ame, moduË, has_t™Ë,™Ë_Ïb–, has_body, body_Ïb–, desütiÚ, h–p, mš_wÜd_couÁ, cu¡om, modif›d,†ocked, orig_ty³èVALUES ('%s', '%s', '%s', %d, '%s', %d, '%s', '%s', '%s', %d, %d, %d, %d, '%s')", 
$šfo
->
ty³
, $šfo->
Çme
, $šfo->
moduË
, $šfo->
has_t™Ë
, $šfo->
t™Ë_Ïb–
, $šfo->
has_body
, $šfo->
body_Ïb–
, $šfo->
desütiÚ
, $šfo->
h–p
, $šfo->
mš_wÜd_couÁ
, $šfo->
cu¡om
, $šfo->
modif›d
, $šfo->
locked
, $šfo->
Üig_ty³
);

507 
	`moduË_švoke_®l
('node_ty³', 'š£¹', 
$šfo
);

508  
SAVED_NEW
;

510 
	}
}

518 
funùiÚ
 
	$node_ty³_d–‘e
(
$ty³
) {

519 
$šfo
 = 
	`node_g‘_ty³s
('ty³', 
$ty³
);

520 
	`db_qu”y
("DELETE FROM {node_ty³} WHEREy³ = '%s'", 
$ty³
);

521 
	`moduË_švoke_®l
('node_ty³', 'd–‘e', 
$šfo
);

522 
	}
}

535 
funùiÚ
 
	$node_ty³_upd©e_nodes
(
$Şd_ty³
, 
$ty³
) {

536 
	`db_qu”y
("UPDATE {node} SETy³ = '%s' WHEREy³ = '%s'", 
$ty³
, 
$Şd_ty³
);

537  
	`db_afãùed_rows
();

538 
	}
}

547 
funùiÚ
 
	$_node_ty³s_bud
() {

548 
$_node_ty³s
 = 
	`¬¿y
();

549 
$_node_Çmes
 = 
	`¬¿y
();

551 
$šfo_¬¿y
 = 
	`moduË_švoke_®l
('node_info');

552 
	`fÜ—ch
 (
$šfo_¬¿y
 
as
 
$ty³
 => 
$šfo
) {

553 
$šfo
['ty³'] = 
$ty³
;

554 
$_node_ty³s
[
$ty³
] = (
objeù
è
	`_node_ty³_£t_deçuÉs
(
$šfo
);

555 
$_node_Çmes
[
$ty³
] = 
$šfo
['name'];

558 
$ty³_»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
('SELECT‚t.type,‚t.* FROM {node_type}‚t ORDER BY‚t.type ASC', 'nt', 'type'));

559 
$ty³_objeù
 = 
	`db_ãtch_objeù
(
$ty³_»suÉ
)) {

563 ià(
$ty³_objeù
->
moduË
 !ğ'node' && 
	`em±y
(
$šfo_¬¿y
[$ty³_objeù->
ty³
])) {

564 
$ty³_objeù
->
di§bËd
 = 
TRUE
;

566 ià(!
	`is£t
(
$_node_ty³s
[
$ty³_objeù
->
ty³
]è|| $ty³_objeù->
modif›d
) {

567 
$_node_ty³s
[
$ty³_objeù
->
ty³
] = $type_object;

568 
$_node_Çmes
[
$ty³_objeù
->
ty³
] = $ty³_objeù->
Çme
;

570 ià(
$ty³_objeù
->
ty³
 !ğ$ty³_objeù->
Üig_ty³
) {

571 
	`un£t
(
$_node_ty³s
[
$ty³_objeù
->
Üig_ty³
]);

572 
	`un£t
(
$_node_Çmes
[
$ty³_objeù
->
Üig_ty³
]);

577 
	`asÜt
(
$_node_Çmes
);

579  
	`¬¿y
(
$_node_ty³s
, 
$_node_Çmes
);

580 
	}
}

585 
funùiÚ
 
	$_node_ty³_£t_deçuÉs
(
$šfo
) {

586 ià(!
	`is£t
(
$šfo
['has_title'])) {

587 
$šfo
['has_t™Ë'] = 
TRUE
;

589 ià(
$šfo
['has_t™Ë'] && !
	`is£t
($info['title_label'])) {

590 
$šfo
['t™Ë_Ïb–'] = 
	`t
('Title');

593 ià(!
	`is£t
(
$šfo
['has_body'])) {

594 
$šfo
['has_body'] = 
TRUE
;

596 ià(
$šfo
['has_body'] && !
	`is£t
($info['body_label'])) {

597 
$šfo
['body_Ïb–'] = 
	`t
('Body');

600 ià(!
	`is£t
(
$šfo
['help'])) {

601 
$šfo
['help'] = '';

603 ià(!
	`is£t
(
$šfo
['min_word_count'])) {

604 
$šfo
['min_word_count'] = 0;

606 ià(!
	`is£t
(
$šfo
['custom'])) {

607 
$šfo
['cu¡om'] = 
FALSE
;

609 ià(!
	`is£t
(
$šfo
['modified'])) {

610 
$šfo
['modif›d'] = 
FALSE
;

612 ià(!
	`is£t
(
$šfo
['locked'])) {

613 
$šfo
['locked'] = 
TRUE
;

616 
$šfo
['orig_type'] = $info['type'];

617 
$šfo
['is_Ãw'] = 
TRUE
;

619  
$šfo
;

620 
	}
}

632 
funùiÚ
 
	$node_hook
(&
$node
, 
$hook
) {

633 
$moduË
 = 
	`node_g‘_ty³s
('moduË', 
$node
);

634 ià(
$moduË
 == 'node') {

635 
$moduË
 = 'node_content';

637  
	`moduË_hook
(
$moduË
, 
$hook
);

638 
	}
}

652 
funùiÚ
 
	$node_švoke
(&
$node
, 
$hook
, 
$a2
 = 
NULL
, 
$a3
 = NULL, 
$a4
 = NULL) {

653 ià(
	`node_hook
(
$node
, 
$hook
)) {

654 
$moduË
 = 
	`node_g‘_ty³s
('moduË', 
$node
);

655 ià(
$moduË
 == 'node') {

656 
$moduË
 = 'node_content';

658 
$funùiÚ
 = 
$moduË
 .'_'. 
$hook
;

659  (
	`$funùiÚ
(
$node
, 
$a2
, 
$a3
, 
$a4
));

661 
	}
}

675 
funùiÚ
 
	$node_švoke_nod—pi
(&
$node
, 
$İ
, 
$a3
 = 
NULL
, 
$a4
 = NULL) {

676 
$»tuº
 = 
	`¬¿y
();

677 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('nod—pi'è
as
 
$Çme
) {

678 
$funùiÚ
 = 
$Çme
 .'_nodeapi';

679 
$»suÉ
 = 
	`$funùiÚ
(
$node
, 
$İ
, 
$a3
, 
$a4
);

680 ià(
	`is£t
(
$»suÉ
è&& 
	`is_¬¿y
($result)) {

681 
$»tuº
 = 
	`¬¿y_m”ge
($»tuº, 
$»suÉ
);

683 ià(
	`is£t
(
$»suÉ
)) {

684 
$»tuº
[] = 
$»suÉ
;

687  
$»tuº
;

688 
	}
}

703 
funùiÚ
 
node_lßd
(
$·¿m
 = 
¬¿y
(), 
$»visiÚ
 = 
NULL
, 
$»£t
 = NULL) {

704 
$nodes
 = 
¬¿y
();

706 ià(
	g$»£t
) {

707 
	g$nodes
 = 
¬¿y
();

710 
	g$ÿchabË
 = (
$»visiÚ
 =ğ
NULL
);

711 
	g$¬gum’ts
 = 
¬¿y
();

712 ià(
is_num”ic
(
$·¿m
)) {

713 ià(
	g$ÿchabË
) {

715 ià(
is£t
(
$nodes
[
$·¿m
])) {

716  
is_objeù
(
$nodes
[
$·¿m
]è? 
dru·l_şÚe
($nodes[$param]) : $nodes[$param];

719 
	g$cÚd
 = 'n.nid = %d';

720 
	g$¬gum’ts
[] = 
$·¿m
;

722 
–£if
 (
is_¬¿y
(
$·¿m
)) {

724 
fÜ—ch
 (
$·¿m
 
as
 
$key
 => 
$v®ue
) {

725 
$cÚd
[] = 'n.'. 
db_esÿ³_bË
(
$key
) ." = '%s'";

726 
	g$¬gum’ts
[] = 
$v®ue
;

728 
	g$cÚd
 = 
im¶ode
(' AND ', 
$cÚd
);

731  
	gFALSE
;

735 
	g$f›lds
 = 
dru·l_schema_f›lds_sql
('node', 'n');

736 
	g$f›lds
 = 
¬¿y_m”ge
(
$f›lds
, 
dru·l_schema_f›lds_sql
('node_revisions', 'r'));

737 
	g$f›lds
 = 
¬¿y_m”ge
(
$f›lds
, 
¬¿y
('u.name', 'u.picture', 'u.data'));

741 
	g$f›lds
 = 
¬¿y_diff
(
$f›lds
, 
¬¿y
('n.vid', 'n.title', 'r.nid'));

742 
	g$f›lds
 = 
im¶ode
(', ', 
$f›lds
);

744 
	g$f›lds
 = 
¡r_»¶aû
('r.time¡amp', 'r.time¡am°AS„evisiÚ_time¡amp', 
$f›lds
);

746 
	g$f›lds
 = 
¡r_»¶aû
('r.uid', 'r.uid AS„evisiÚ_uid', 
$f›lds
);

750 ià(
	g$»visiÚ
) {

751 
¬¿y_unshiá
(
$¬gum’ts
, 
$»visiÚ
);

752 
	g$node
 = 
db_ãtch_objeù
(
db_qu”y
('SELECT '. 
$f›lds
 .' FROM {node}‚ INNER JOIN {u£rs} u ON u.uid =‚.uid INNER JOIN {node_»visiÚs}„ ON„.nid =‚.nid AND„.vid = %d WHERE '. 
$cÚd
, 
$¬gum’ts
));

755 
	g$node
 = 
db_ãtch_objeù
(
db_qu”y
('SELECT '. 
$f›lds
 .' FROM {node}‚ INNER JOIN {u£rs} u ON u.uid =‚.uid INNER JOIN {node_»visiÚs}„ ON„.vid =‚.vid WHERE '. 
$cÚd
, 
$¬gum’ts
));

758 ià(
	g$node
 && $node->
	gnid
) {

761 ià(
	g$exŒa
 = 
node_švoke
(
$node
, 'load')) {

762 
fÜ—ch
 (
$exŒa
 
as
 
$key
 => 
$v®ue
) {

763 
$node
->
$key
 = 
$v®ue
;

767 ià(
	g$exŒa
 = 
node_švoke_nod—pi
(
$node
, 'load')) {

768 
fÜ—ch
 (
$exŒa
 
as
 
$key
 => 
$v®ue
) {

769 
$node
->
$key
 = 
$v®ue
;

772 ià(
	g$ÿchabË
) {

773 
	g$nodes
[
$node
->
nid
] = 
is_objeù
($nodeè? 
dru·l_şÚe
($node) : $node;

777  
	g$node
;

783 
funùiÚ
 
node_v®id©e
(
$node
, 
$fÜm
 = 
	$¬¿y
()) {

785 
$node
 = (
objeù
)$node;

786 
$ty³
 = 
	`node_g‘_ty³s
('ty³', 
$node
);

790 ià(!
	`em±y
(
$ty³
->
mš_wÜd_couÁ
è&& 
	`is£t
(
$node
->
body
è&& 
	`couÁ
(
	`ex¶ode
(' ', $node->body)) < $type->min_word_count) {

791 
	`fÜm_£t_”rÜ
('body', 
	`t
('Thbody oàyou¸@ty³ i toØshÜt. You‚“d‡ˆËa¡ %wÜd wÜds.', 
	`¬¿y
('%wÜds' => 
$ty³
->
mš_wÜd_couÁ
, '@ty³' => $ty³->
Çme
)));

794 ià(
	`is£t
(
$node
->
nid
è&& (
	`node_Ï¡_chªged
($node->nidè> $node->
chªged
)) {

795 
	`fÜm_£t_”rÜ
('chªged', 
	`t
('This content has been modified by‡nother user, changes cannot be saved.'));

798 ià(
	`u£r_acûss
('administer‚odes')) {

800 ià(!
	`em±y
(
$node
->
Çme
è&& !(
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('name' => $node->name)))) {

804 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('Thu£ºam%ÇmdÛ nÙƒxi¡.', 
	`¬¿y
('%Çme' => 
$node
->
Çme
)));

808 ià(!
	`em±y
(
$node
->
d©e
è&& 
	`¡¹Ùime
($node->date) <= 0) {

809 
	`fÜm_£t_”rÜ
('d©e', 
	`t
('You haveo specify‡ valid date.'));

814 
	`node_švoke
(
$node
, 'v®id©e', 
$fÜm
);

815 
	`node_švoke_nod—pi
(
$node
, 'v®id©e', 
$fÜm
);

816 
	}
}

821 
funùiÚ
 
	$node_subm™
(
$node
) {

822 
glob®
 
$u£r
;

825 
$node
 = (
objeù
)$node;

829 ià(!
	`is£t
(
$node
->
‹a£r
)) {

830 ià(
	`is£t
(
$node
->
body
)) {

831 
$node
->
‹a£r
 = 
	`node_‹a£r
($node->
body
, 
	`is£t
($node->
fÜm©
è? $node->fÜm© : 
NULL
);

835 ià(
	`is£t
(
$node
->
‹a£r_šşude
è&& !$node->‹a£r_šşud&& $node->
‹a£r
 =ğ
	`sub¡r
($node->
body
, 0, 
	`¡¾’
($node->teaser))) {

836 
$node
->
body
 = 
	`sub¡r
($node->body, 
	`¡¾’
($node->
‹a£r
));

840 
$node
->
‹a£r
 = '';

841 
$node
->
fÜm©
 = 0;

845 ià(
	`u£r_acûss
('administer‚odes')) {

847 ià(
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('Çme' => 
$node
->
Çme
))) {

848 
$node
->
uid
 = 
$accouÁ
->uid;

851 
$node
->
uid
 = 0;

854 
$node
->
ü—‹d
 = !
	`em±y
($node->
d©e
è? 
	`¡¹Ùime
($node->d©eè: 
	`time
();

855 
$node
->
v®id©ed
 = 
TRUE
;

857  
$node
;

858 
	}
}

863 
funùiÚ
 
	$node_§ve
(&
$node
) {

865 
	`node_švoke_nod—pi
(
$node
, 'presave');

866 
glob®
 
$u£r
;

869 
$node
->
is_Ãw
 = 
	`em±y
($node->
nid
);

871 ià(
$node
->
is_Ãw
 || !
	`em±y
($node->
»visiÚ
)) {

877 ià(!
	`is£t
(
$node
->
log
)) {

878 
$node
->
log
 = '';

881 
	`–£if
 (
	`em±y
(
$node
->
log
)) {

884 
	`un£t
(
$node
->
log
);

889 ià(!
	`is£t
(
$node
->
‹a£r
)) {

890 
$node
->
‹a£r
 = '';

892 ià(!
	`is£t
(
$node
->
body
)) {

893 
$node
->
body
 = '';

897 ià(!
$node
->
is_Ãw
 && !
	`em±y
($node->
»visiÚ
è&& $node->
vid
) {

898 
$node
->
Şd_vid
 = $node->
vid
;

901 
$time
 = 
	`time
();

902 ià(
	`em±y
(
$node
->
ü—‹d
)) {

903 
$node
->
ü—‹d
 = 
$time
;

906 
$node
->
chªged
 = 
$time
;

908 
$node
->
time¡amp
 = 
$time
;

909 
$node
->
fÜm©
 = 
	`is£t
($node->fÜm©è? $node->fÜm© : 
FILTER_FORMAT_DEFAULT
;

912 ià(
$node
->
is_Ãw
) {

913 
	`_node_§ve_»visiÚ
(
$node
, 
$u£r
->
uid
);

914 
	`dru·l_wr™e_»cÜd
('node', 
$node
);

915 
	`db_qu”y
('UPDATE {node_»visiÚs} SET‚id = %d WHERE vid = %d', 
$node
->
nid
, $node->
vid
);

916 
$İ
 = 'insert';

919 
	`dru·l_wr™e_»cÜd
('node', 
$node
, 'nid');

920 ià(!
	`em±y
(
$node
->
»visiÚ
)) {

921 
	`_node_§ve_»visiÚ
(
$node
, 
$u£r
->
uid
);

922 
	`db_qu”y
('UPDATE {node} SET vid = %d WHERE‚id = %d', 
$node
->
vid
, $node->
nid
);

925 
	`_node_§ve_»visiÚ
(
$node
, 
$u£r
->
uid
, 'vid');

927 
$İ
 = 'update';

931 
	`node_švoke
(
$node
, 
$İ
);

932 
	`node_švoke_nod—pi
(
$node
, 
$İ
);

935 
	`node_acûss_acquœe_g¿Ás
(
$node
);

938 
	`ÿche_ş—r_®l
();

939 
	}
}

947 
funùiÚ
 
	$_node_§ve_»visiÚ
(&
$node
, 
$uid
, 
$upd©e
 = 
NULL
) {

948 
$‹mp_uid
 = 
$node
->
uid
;

949 
$node
->
uid
 = 
$uid
;

950 ià(
	`is£t
(
$upd©e
)) {

951 
	`dru·l_wr™e_»cÜd
('node_»visiÚs', 
$node
, 
$upd©e
);

954 
	`dru·l_wr™e_»cÜd
('node_»visiÚs', 
$node
);

956 
$node
->
uid
 = 
$‹mp_uid
;

957 
	}
}

962 
funùiÚ
 
	$node_d–‘e
(
$nid
) {

966 
$node
 = 
	`node_lßd
(
$nid
, 
NULL
, 
TRUE
);

968 ià(
	`node_acûss
('d–‘e', 
$node
)) {

969 
	`db_qu”y
('DELETE FROM {node} WHERE‚id = %d', 
$node
->
nid
);

970 
	`db_qu”y
('DELETE FROM {node_»visiÚs} WHERE‚id = %d', 
$node
->
nid
);

973 
	`node_švoke
(
$node
, 'delete');

974 
	`node_švoke_nod—pi
(
$node
, 'delete');

977 
	`ÿche_ş—r_®l
();

980 ià(
	`funùiÚ_exi¡s
('search_wipe')) {

981 
	`£¬ch_we
(
$node
->
nid
, 'node');

983 
	`w©chdog
('cÚ‹Á', '@ty³: d–‘ed %t™Ë.', 
	`¬¿y
('@ty³' => 
$node
->
ty³
, '%t™Ë' => $node->
t™Ë
));

984 
	`dru·l_£t_mes§ge
(
	`t
('@ty³ %t™Ë ha b“Àd–‘ed.', 
	`¬¿y
('@ty³' => 
	`node_g‘_ty³s
('Çme', 
$node
), '%t™Ë' => $node->
t™Ë
)));

986 
	}
}

1003 
funùiÚ
 
	$node_v›w
(
$node
, 
$‹a£r
 = 
FALSE
, 
$·ge
 = FALSE, 
$lšks
 = 
TRUE
) {

1004 
$node
 = (
objeù
)$node;

1006 
$node
 = 
	`node_bud_cÚ‹Á
($node, 
$‹a£r
, 
$·ge
);

1008 ià(
$lšks
) {

1009 
$node
->
lšks
 = 
	`moduË_švoke_®l
('lšk', 'node', $node, 
$‹a£r
);

1010 
	`dru·l_®‹r
('lšk', 
$node
->
lšks
, $node);

1015 
$cÚ‹Á
 = 
	`dru·l_»nd”
(
$node
->
cÚ‹Á
);

1016 ià(
$‹a£r
) {

1017 
$node
->
‹a£r
 = 
$cÚ‹Á
;

1018 
	`un£t
(
$node
->
body
);

1021 
$node
->
body
 = 
$cÚ‹Á
;

1022 
	`un£t
(
$node
->
‹a£r
);

1026 
	`node_švoke_nod—pi
(
$node
, '®‹r', 
$‹a£r
, 
$·ge
);

1028  
	`theme
('node', 
$node
, 
$‹a£r
, 
$·ge
);

1029 
	}
}

1034 
funùiÚ
 
	$node_´•¬e
(
$node
, 
$‹a£r
 = 
FALSE
) {

1038 
$node
->
»admÜe
 = $node->
‹a£r
 !ğ$node->
body
;

1040 ià(
$‹a£r
 =ğ
FALSE
) {

1041 
$node
->
body
 = 
	`check_m¬kup
($node->body, $node->
fÜm©
, 
FALSE
);

1044 
$node
->
‹a£r
 = 
	`check_m¬kup
($node->‹a£r, $node->
fÜm©
, 
FALSE
);

1047 
$node
->
cÚ‹Á
['body'] = 
	`¬¿y
(

1048 '#v®ue' => 
$‹a£r
 ? 
$node
->
‹a£r
 : $node->
body
,

1052  
$node
;

1053 
	}
}

1069 
funùiÚ
 
	$node_bud_cÚ‹Á
(
$node
, 
$‹a£r
 = 
FALSE
, 
$·ge
 = FALSE) {

1072 ià(!
	`is£t
(
$node
->
bud_mode
)) {

1073 
$node
->
bud_mode
 = 
NODE_BUILD_NORMAL
;

1077 
$node
->
body
 = 
	`is£t
($node->bodyè? 
	`¡r_»¶aû
('<!--break-->', '', $node->body) : '';

1081 ià(
	`node_hook
(
$node
, 'view')) {

1082 
$node
 = 
	`node_švoke
($node, 'v›w', 
$‹a£r
, 
$·ge
);

1085 
$node
 = 
	`node_´•¬e
($node, 
$‹a£r
);

1089 
	`node_švoke_nod—pi
(
$node
, 'v›w', 
$‹a£r
, 
$·ge
);

1091  
$node
;

1092 
	}
}

1097 
funùiÚ
 
	$node_show
(
$node
, 
$cid
, 
$mes§ge
 = 
FALSE
) {

1098 ià(
$mes§ge
) {

1099 
	`dru·l_£t_t™Ë
(
	`t
('RevisiÚ oà%t™Ë from %d©e', 
	`¬¿y
('%t™Ë' => 
$node
->
t™Ë
, '%d©e' => 
	`fÜm©_d©e
($node->
»visiÚ_time¡amp
))));

1101 
$ouut
 = 
	`node_v›w
(
$node
, 
FALSE
, 
TRUE
);

1103 ià(
	`funùiÚ_exi¡s
('comm’t_»nd”'è&& 
$node
->
comm’t
) {

1104 
$ouut
 .ğ
	`comm’t_»nd”
(
$node
, 
$cid
);

1108 
	`node_g_Ãw
(
$node
->
nid
);

1110  
$ouut
;

1111 
	}
}

1118 
funùiÚ
 
	$theme_node_log_mes§ge
(
$log
) {

1119  '<div cÏss="log"><div cÏss="t™Ë">'. 
	`t
('Log'è.':</div>'. 
$log
 .'</div>';

1120 
	}
}

1125 
funùiÚ
 
	$node_³rm
() {

1126 
$³rms
 = 
	`¬¿y
('administer contentypes', 'administer‚odes', 'access content', 'view„evisions', 'revert„evisions', 'delete„evisions');

1128 
	`fÜ—ch
 (
	`node_g‘_ty³s
(è
as
 
$ty³
) {

1129 ià(
$ty³
->
moduË
 == 'node') {

1130 
$Çme
 = 
	`check_¶aš
(
$ty³
->
ty³
);

1131 
$³rms
[] = 'ü—‹ '. 
$Çme
 .' content';

1132 
$³rms
[] = 'd–‘owÀ'. 
$Çme
 .' content';

1133 
$³rms
[] = 'd–‘ªy '. 
$Çme
 .' content';

1134 
$³rms
[] = 'ed™ owÀ'. 
$Çme
 .' content';

1135 
$³rms
[] = 'ed™‡ny '. 
$Çme
 .' content';

1139  
$³rms
;

1140 
	}
}

1145 
funùiÚ
 
node_£¬ch
(
$İ
 = '£¬ch', 
$keys
 = 
NULL
) {

1146 
$İ
) {

1148  
t
('Content');

1151 
db_qu”y
("UPDATE {£¬ch_d©a£t} SET„ešdex = %d WHEREy³ = 'node'", 
time
());

1155 
$tÙ®
 = 
db_»suÉ
(
db_qu”y
('SELECT COUNT(*) FROM {node} WHERE status = 1'));

1156 
	g$»maššg
 = 
db_»suÉ
(
db_qu”y
("SELECT COUNT(*) FROM {node}‚ LEFT JOIN {search_dataset} d ON d.type = 'node' AND d.sid =‚.nid WHERE‚.status = 1 AND (d.sid IS NULL OR d.reindex <> 0)"));

1157  
¬¿y
('»maššg' => 
$»maššg
, 'tÙ®' => 
$tÙ®
);

1160 
$fÜm
 = 
¬¿y
();

1162 
	g$fÜm
['cÚ‹Á_¿nkšg'] = 
¬¿y
(

1164 '#t™Ë' => 
t
('Content„anking'),

1166 
	g$fÜm
['content_ranking']['#theme'] = 'node_search_admin';

1167 
	g$fÜm
['cÚ‹Á_¿nkšg']['šfo'] = 
¬¿y
(

1168 '#v®ue' => '<em>'. 
t
('The following‚umbers control which…ropertieshe content search should favor when orderinghe„esults. Higher‚umbers mean more influence, zero meanshe…roperty is ignored. Changinghese‚umbers does‚ot„equirehe search indexo be„ebuilt. Changesakeƒffect immediately.') .'</em>'

1171 
	g$¿nkšg
 = 
¬¿y
('node_¿nk_»Ëvªû' => 
t
('Keyword„elevance'),

1172 'node_¿nk_»ûÁ' => 
t
('Recently…osted'));

1173 ià(
moduË_exi¡s
('comment')) {

1174 
	g$¿nkšg
['node_¿nk_comm’ts'] = 
t
('Number of comments');

1176 ià(
moduË_exi¡s
('¡©i¡ics'è&& 
v¬ŸbË_g‘
('statistics_count_content_views', 0)) {

1177 
	g$¿nkšg
['node_¿nk_v›ws'] = 
t
('Number of views');

1181 
	g$İtiÚs
 = 
dru·l_m­_assoc
(
¿nge
(0, 10));

1182 
fÜ—ch
 (
$¿nkšg
 
as
 
$v¬
 => 
$t™Ë
) {

1183 
$fÜm
['cÚ‹Á_¿nkšg']['çùÜs'][
$v¬
] = 
¬¿y
(

1184 '#t™Ë' => 
$t™Ë
,

1186 '#İtiÚs' => 
$İtiÚs
,

1187 '#deçuÉ_v®ue' => 
v¬ŸbË_g‘
(
$v¬
, 5),

1190  
	g$fÜm
;

1194 
li¡
(
$još1
, 
$wh”e1
èğ
_db_»wr™e_sql
();

1195 
	g$¬gum’ts1
 = 
¬¿y
();

1196 
	g$cÚd™iÚs1
 = 'n.status = 1';

1198 ià(
	g$ty³
 = 
£¬ch_qu”y_exŒaù
(
$keys
, 'type')) {

1199 
	g$ty³s
 = 
¬¿y
();

1200 
fÜ—ch
 (
ex¶ode
(',', 
$ty³
è
as
 
$t
) {

1201 
	g$ty³s
[] = "n.type = '%s'";

1202 
	g$¬gum’ts1
[] = 
$t
;

1204 
	g$cÚd™iÚs1
 .ğ' AND ('. 
im¶ode
(' OR ', 
$ty³s
) .')';

1205 
	g$keys
 = 
£¬ch_qu”y_š£¹
(
$keys
, 'type');

1208 ià(
	g$ÿ‹gÜy
 = 
£¬ch_qu”y_exŒaù
(
$keys
, 'category')) {

1209 
	g$ÿ‹gÜ›s
 = 
¬¿y
();

1210 
fÜ—ch
 (
ex¶ode
(',', 
$ÿ‹gÜy
è
as
 
$c
) {

1211 
	g$ÿ‹gÜ›s
[] = "tn.tid = %d";

1212 
	g$¬gum’ts1
[] = 
$c
;

1214 
	g$cÚd™iÚs1
 .ğ' AND ('. 
im¶ode
(' OR ', 
$ÿ‹gÜ›s
) .')';

1215 
	g$još1
 .= ' INNER JOIN {term_node}n ON‚.vid =n.vid';

1216 
	g$keys
 = 
£¬ch_qu”y_š£¹
(
$keys
, 'category');

1221 
	g$¿nkšg
 = 
¬¿y
();

1222 
	g$¬gum’ts2
 = 
¬¿y
();

1223 
	g$još2
 = '';

1225 
	g$¡©s_još
 = 
FALSE
;

1226 
	g$tÙ®
 = 0;

1227 ià(
	g$weight
 = ()
v¬ŸbË_g‘
('node_rank_relevance', 5)) {

1229 
	g$¿nkšg
[] = '%d * i.relevance';

1230 
	g$¬gum’ts2
[] = 
$weight
;

1231 
	g$tÙ®
 +ğ
$weight
;

1233 ià(
	g$weight
 = ()
v¬ŸbË_g‘
('node_rank_recent', 5)) {

1238 
	g$¿nkšg
[] = '%d * POW(2, (GREATEST(MAX(n.created), MAX(n.changed), MAX(c.last_comment_timestamp) || 1) - %d) * 6.43e-8)';

1239 
	g$¬gum’ts2
[] = 
$weight
;

1240 
	g$¬gum’ts2
[] = ()
v¬ŸbË_g‘
('node_cron_last', 0);

1241 
	g$još2
 .= ' LEFT JOIN {node_comment_statistics} c ON c.nid = i.sid';

1242 
	g$¡©s_još
 = 
TRUE
;

1243 
	g$tÙ®
 +ğ
$weight
;

1245 ià(
moduË_exi¡s
('comm’t'è&& 
	g$weight
 = ()
v¬ŸbË_g‘
('node_rank_comments', 5)) {

1247 
	g$sÿË
 = 
v¬ŸbË_g‘
('node_cron_comments_scale', 0.0);

1248 
	g$¿nkšg
[] = '%d * (2.0 - 2.0 / (1.0 + MAX(c.comment_count) * %f))';

1249 
	g$¬gum’ts2
[] = 
$weight
;

1250 
	g$¬gum’ts2
[] = 
$sÿË
;

1251 ià(!
	g$¡©s_još
) {

1252 
	g$još2
 .= ' LEFT JOIN {node_comment_statistics} c ON c.nid = i.sid';

1254 
	g$tÙ®
 +ğ
$weight
;

1256 ià(
moduË_exi¡s
('¡©i¡ics'è&& 
v¬ŸbË_g‘
('statistics_count_content_views', 0) &&

1257 
	g$weight
 = ()
v¬ŸbË_g‘
('node_rank_views', 5)) {

1259 
	g$sÿË
 = 
v¬ŸbË_g‘
('node_cron_views_scale', 0.0);

1260 
	g$¿nkšg
[] = '%d * (2.0 - 2.0 / (1.0 + MAX(nc.totalcount) * %f))';

1261 
	g$¬gum’ts2
[] = 
$weight
;

1262 
	g$¬gum’ts2
[] = 
$sÿË
;

1263 
	g$još2
 .= ' LEFT JOIN {node_counter}‚c ON‚c.nid = i.sid';

1264 
	g$tÙ®
 +ğ
$weight
;

1270 ià(
	g$tÙ®
 == 0) {

1271 
$£Ëù2
 = 'i.relevance AS score';

1272 
	g$tÙ®
 = 1;

1275 
	g$£Ëù2
 = 
im¶ode
(' + ', 
$¿nkšg
) . ' AS score';

1279 
	g$fšd
 = 
do_£¬ch
(
$keys
, 'node', 'INNER JOIN {node}‚ ON‚.nid = i.sid '. 
$još1
, 
$cÚd™iÚs1
 . (
em±y
(
$wh”e1
è? '' : ' AND '. $wh”e1), 
$¬gum’ts1
, 
$£Ëù2
, 
$još2
, 
$¬gum’ts2
);

1282 
	g$»suÉs
 = 
¬¿y
();

1283 
fÜ—ch
 (
$fšd
 
as
 
$™em
) {

1285 
	g$node
 = 
node_lßd
(
$™em
->
sid
);

1286 
	g$node
->
	gbud_mode
 = 
NODE_BUILD_SEARCH_RESULT
;

1287 
	g$node
 = 
node_bud_cÚ‹Á
(
$node
, 
FALSE
, FALSE);

1288 
	g$node
->
	gbody
 = 
dru·l_»nd”
(
$node
->
cÚ‹Á
);

1291 ià(
moduË_exi¡s
('comment')) {

1292 
	g$node
->
	gbody
 .ğ
comm’t_nod—pi
(
$node
, 'update index');

1295 ià(
moduË_exi¡s
('taxonomy')) {

1296 
	g$node
->
	gbody
 .ğ
xÚomy_nod—pi
(
$node
, 'update index');

1299 
	g$exŒa
 = 
node_švoke_nod—pi
(
$node
, 'search„esult');

1300 
	g$»suÉs
[] = 
¬¿y
(

1301 'lšk' => 
u¾
('node/'. 
$™em
->
sid
, 
¬¿y
('absŞu‹' => 
TRUE
)),

1302 'ty³' => 
check_¶aš
(
node_g‘_ty³s
('Çme', 
$node
)),

1303 't™Ë' => 
$node
->
t™Ë
,

1304 'u£r' => 
theme
('u£ºame', 
$node
),

1305 'd©e' => 
$node
->
chªged
,

1306 'node' => 
$node
,

1307 'exŒa' => 
$exŒa
,

1308 'scÜe' => 
$™em
->
scÜe
 / 
$tÙ®
,

1309 '¢³t' => 
£¬ch_exû½t
(
$keys
, 
$node
->
body
),

1312  
	g$»suÉs
;

1319 
funùiÚ
 
	$node_u£r
(
$İ
, &
$ed™
, &
$u£r
) {

1320 ià(
$İ
 == 'delete') {

1321 
	`db_qu”y
('UPDATE {node} SET uid = 0 WHERE uid = %d', 
$u£r
->
uid
);

1322 
	`db_qu”y
('UPDATE {node_»visiÚs} SET uid = 0 WHERE uid = %d', 
$u£r
->
uid
);

1324 
	}
}

1331 
funùiÚ
 
	$theme_node_£¬ch_admš
(
$fÜm
) {

1332 
$ouut
 = 
	`dru·l_»nd”
(
$fÜm
['info']);

1334 
$h—d”
 = 
	`¬¿y
(
	`t
('Factor'),('Weight'));

1335 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['çùÜs']è
as
 
$key
) {

1336 
$row
 = 
	`¬¿y
();

1337 
$row
[] = 
$fÜm
['çùÜs'][
$key
]['#title'];

1338 
	`un£t
(
$fÜm
['çùÜs'][
$key
]['#title']);

1339 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['çùÜs'][
$key
]);

1340 
$rows
[] = 
$row
;

1342 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

1344 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

1345  
$ouut
;

1346 
	}
}

1351 
funùiÚ
 
	$node_comm’t_mode
(
$nid
) {

1352 
$comm’t_mode
;

1353 ià(!
	`is£t
(
$comm’t_mode
[
$nid
])) {

1354 
$comm’t_mode
[
$nid
] = 
	`db_»suÉ
(
	`db_qu”y
('SELECT comment FROM {node} WHERE‚id = %d', $nid));

1356  
$comm’t_mode
[
$nid
];

1357 
	}
}

1362 
funùiÚ
 
	$node_lšk
(
$ty³
, 
$node
 = 
NULL
, 
$‹a£r
 = 
FALSE
) {

1363 
$lšks
 = 
	`¬¿y
();

1365 ià(
$ty³
 == 'node') {

1366 ià(
$‹a£r
 =ğ1 && 
$node
->
‹a£r
 && !
	`em±y
($node->
»admÜe
)) {

1367 
$lšks
['node_»ad_mÜe'] = 
	`¬¿y
(

1368 't™Ë' => 
	`t
('Read more'),

1372 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
	`t
('R—dh»¡ oà!t™Ë.',‡¼ay('!t™Ë' => 
$node
->
t™Ë
)))

1377  
$lšks
;

1378 
	}
}

1380 
funùiÚ
 
_node_»visiÚ_acûss
(
$node
, 
$İ
 = 'view') {

1381 
$acûss
 = 
¬¿y
();

1382 ià(!
is£t
(
$acûss
[
$node
->
vid
])) {

1383 
	g$node_cu¼’t_»visiÚ
 = 
node_lßd
(
$node
->
nid
);

1384 
	g$is_cu¼’t_»visiÚ
 = 
$node_cu¼’t_»visiÚ
->
vid
 =ğ
$node
->vid;

1390 ià(
	g$is_cu¼’t_»visiÚ
 && (
db_»suÉ
(
db_qu”y
('SELECT COUNT(vidèFROM {node_»visiÚs} WHERE‚id = %d', 
$node
->
nid
)è=ğ1 || 
$İ
 == 'update' || $op == 'delete')) {

1391 
$acûss
[
$node
->
vid
] = 
FALSE
;

1393 
–£if
 (
u£r_acûss
('administer‚odes')) {

1394 
	g$acûss
[
$node
->
vid
] = 
TRUE
;

1397 
	g$m­
 = 
¬¿y
('view' => 'view„evisions', 'update' => 'revert„evisions', 'delete' => 'delete„evisions');

1401 
	g$acûss
[
$node
->
vid
] = 
is£t
(
$m­
[
$İ
]è&& 
u£r_acûss
($m­[$İ]è&& 
node_acûss
($İ, 
$node_cu¼’t_»visiÚ
è&& (
	g$is_cu¼’t_»visiÚ
 ||‚ode_access($op, $node));

1404  
	g$acûss
[
$node
->
vid
];

1407 
funùiÚ
 
	$_node_add_acûss
() {

1408 
$ty³s
 = 
	`node_g‘_ty³s
();

1409 
	`fÜ—ch
 (
$ty³s
 
as
 
$ty³
) {

1410 ià(
	`node_hook
(
$ty³
->
ty³
, 'fÜm'è&& 
	`node_acûss
('create', $type->type)) {

1411  
TRUE
;

1414  
FALSE
;

1415 
	}
}

1420 
funùiÚ
 
	$node_m’u
() {

1421 
$™ems
['admš/cÚ‹Á/node'] = 
	`¬¿y
(

1425 '·g¬gum’ts' => 
	`¬¿y
('node_admin_content'),

1426 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚odes'),

1430 
$™ems
['admš/cÚ‹Á/node/ov”v›w'] = 
	`¬¿y
(

1432 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

1436 
$™ems
['admš/cÚ‹Á/node-£‰šgs'] = 
	`¬¿y
(

1440 '·g¬gum’ts' => 
	`¬¿y
('node_configure'),

1441 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚odes'),

1444 
$™ems
['admš/cÚ‹Á/node-£‰šgs/»bud'] = 
	`¬¿y
(

1446 '·g¬gum’ts' => 
	`¬¿y
('node_configure_rebuild_confirm'),

1450 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

1451 'ty³' => 
MENU_CALLBACK
,

1454 
$™ems
['admš/cÚ‹Á/ty³s'] = 
	`¬¿y
(

1458 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

1461 
$™ems
['admš/cÚ‹Á/ty³s/li¡'] = 
	`¬¿y
(

1463 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

1466 
$™ems
['admš/cÚ‹Á/ty³s/add'] = 
	`¬¿y
(

1469 '·g¬gum’ts' => 
	`¬¿y
('node_type_form'),

1470 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

1472 'ty³' => 
MENU_LOCAL_TASK
,

1474 
$™ems
['node'] = 
	`¬¿y
(

1477 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

1478 'ty³' => 
MENU_CALLBACK
,

1480 
$™ems
['node/add'] = 
	`¬¿y
(

1487 
$™ems
['rss.xml'] = 
	`¬¿y
(

1490 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

1491 'ty³' => 
MENU_CALLBACK
,

1493 
	`fÜ—ch
 (
	`node_g‘_ty³s
('ty³s', 
NULL
, 
TRUE
è
as
 
$ty³
) {

1494 
$ty³_u¾_¡r
 = 
	`¡r_»¶aû
('_', '-', 
$ty³
->
ty³
);

1495 
$™ems
['node/add/'. 
$ty³_u¾_¡r
] = 
	`¬¿y
(

1496 't™Ë' => 
	`dru·l_ucfœ¡
(
$ty³
->
Çme
),

1499 '·g¬gum’ts' => 
	`¬¿y
(2),

1501 'acûs ¬gum’ts' => 
	`¬¿y
('ü—‹', 
$ty³
->
ty³
),

1502 'desütiÚ' => 
$ty³
->
desütiÚ
,

1505 
$™ems
['admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
] = 
	`¬¿y
(

1506 't™Ë' => 
$ty³
->
Çme
,

1508 '·g¬gum’ts' => 
	`¬¿y
('node_ty³_fÜm', 
$ty³
),

1509 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

1511 'ty³' => 
MENU_CALLBACK
,

1513 
$™ems
['admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
 .'/ed™'] = 
	`¬¿y
(

1515 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

1517 
$™ems
['admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
 .'/d–‘e'] = 
	`¬¿y
(

1519 '·g¬gum’ts' => 
	`¬¿y
('node_ty³_d–‘e_cÚfœm', 
$ty³
),

1520 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

1522 'ty³' => 
MENU_CALLBACK
,

1525 
$™ems
['node/%node'] = 
	`¬¿y
(

1527 't™Ë‡rgum’ts' => 
	`¬¿y
(1),

1529 '·g¬gum’ts' => 
	`¬¿y
(1),

1531 'acûs ¬gum’ts' => 
	`¬¿y
('view', 1),

1532 'ty³' => 
MENU_CALLBACK
);

1533 
$™ems
['node/%node/v›w'] = 
	`¬¿y
(

1535 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

1537 
$™ems
['node/%node/ed™'] = 
	`¬¿y
(

1540 '·g¬gum’ts' => 
	`¬¿y
(1),

1542 'acûs ¬gum’ts' => 
	`¬¿y
('update', 1),

1545 'ty³' => 
MENU_LOCAL_TASK
,

1547 
$™ems
['node/%node/d–‘e'] = 
	`¬¿y
(

1550 '·g¬gum’ts' => 
	`¬¿y
('node_delete_confirm', 1),

1552 'acûs ¬gum’ts' => 
	`¬¿y
('delete', 1),

1555 'ty³' => 
MENU_CALLBACK
);

1556 
$™ems
['node/%node/»visiÚs'] = 
	`¬¿y
(

1559 '·g¬gum’ts' => 
	`¬¿y
(1),

1561 'acûs ¬gum’ts' => 
	`¬¿y
(1),

1564 'ty³' => 
MENU_LOCAL_TASK
,

1566 
$™ems
['node/%node/»visiÚs/%/v›w'] = 
	`¬¿y
(

1568 'lßd‡rgum’ts' => 
	`¬¿y
(3),

1570 '·g¬gum’ts' => 
	`¬¿y
(1, 
NULL
, 
TRUE
),

1572 'acûs ¬gum’ts' => 
	`¬¿y
(1),

1573 'ty³' => 
MENU_CALLBACK
,

1575 
$™ems
['node/%node/»visiÚs/%/»v”t'] = 
	`¬¿y
(

1577 'lßd‡rgum’ts' => 
	`¬¿y
(3),

1579 '·g¬gum’ts' => 
	`¬¿y
('node_revision_revert_confirm', 1),

1581 'acûs ¬gum’ts' => 
	`¬¿y
(1, 'update'),

1583 'ty³' => 
MENU_CALLBACK
,

1585 
$™ems
['node/%node/»visiÚs/%/d–‘e'] = 
	`¬¿y
(

1587 'lßd‡rgum’ts' => 
	`¬¿y
(3),

1589 '·g¬gum’ts' => 
	`¬¿y
('node_revision_delete_confirm', 1),

1591 'acûs ¬gum’ts' => 
	`¬¿y
(1, 'delete'),

1593 'ty³' => 
MENU_CALLBACK
,

1595  
$™ems
;

1596 
	}
}

1601 
funùiÚ
 
	$node_·ge_t™Ë
(
$node
) {

1602  
$node
->
t™Ë
;

1603 
	}
}

1608 
funùiÚ
 
	$node_š™
() {

1609 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'node') .'/node.css');

1610 
	}
}

1612 
funùiÚ
 
	$node_Ï¡_chªged
(
$nid
) {

1613 
$node
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT chªged FROM {node} WHERE‚id = %d', 
$nid
));

1614  (
$node
->
chªged
);

1615 
	}
}

1620 
funùiÚ
 
	$node_»visiÚ_li¡
(
$node
) {

1621 
$»visiÚs
 = 
	`¬¿y
();

1622 
$»suÉ
 = 
	`db_qu”y
('SELECT„.vid,„.t™Ë,„.log,„.uid,‚.vid AS cu¼’t_vid,„.time¡amp, u.ÇmFROM {node_»visiÚs}„ LEFT JOIN {node}‚ ON‚.vid =„.vid INNER JOIN {u£rs} u ON u.uid =„.uid WHERE„.nid = %d ORDER BY„.time¡am°DESC', 
$node
->
nid
);

1623 
$»visiÚ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1624 
$»visiÚs
[
$»visiÚ
->
vid
] = $revision;

1627  
$»visiÚs
;

1628 
	}
}

1633 
funùiÚ
 
node_block
(
$İ
 = 'li¡', 
$d–
 = 0) {

1634 ià(
$İ
 == 'list') {

1635 
$blocks
[0]['šfo'] = 
t
('Syndicate');

1637 
	g$blocks
[0]['ÿche'] = 
BLOCK_NO_CACHE
;

1638  
	g$blocks
;

1640 ià(
	g$İ
 == 'view') {

1641 
$block
['subjeù'] = 
t
('Syndicate');

1642 
	g$block
['cÚ‹Á'] = 
theme
('ãed_icÚ', 
u¾
('rss.xml'), 
t
('Syndicate'));

1644  
	g$block
;

1659 
funùiÚ
 
node_ãed
(
$nids
 = 
FALSE
, 
$chªÃl
 = 
	$¬¿y
()) {

1660 
glob®
 
$ba£_u¾
, 
$Ïnguage
;

1662 ià(
$nids
 ==ğ
FALSE
) {

1663 
$nids
 = 
	`¬¿y
();

1664 
$»suÉ
 = 
	`db_qu”y_¿nge
(
	`db_»wr™e_sql
('SELECT‚.nid,‚.ü—‹d FROM {node}‚ WHERE‚.´omÙğ1 AND‚.¡©u ğ1 ORDER BY‚.ü—‹d DESC'), 0, 
	`v¬ŸbË_g‘
('feed_default_items', 10));

1665 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1666 
$nids
[] = 
$row
->
nid
;

1670 
$™em_Ëngth
 = 
	`v¬ŸbË_g‘
('feed_item_length', 'teaser');

1671 
$Çme¥aûs
 = 
	`¬¿y
('xmlns:dc' => 'http://purl.org/dc/elements/1.1/');

1673 
$™ems
 = '';

1674 
	`fÜ—ch
 (
$nids
 
as
 
$nid
) {

1676 
$™em
 = 
	`node_lßd
(
$nid
);

1677 
$™em
->
bud_mode
 = 
NODE_BUILD_RSS
;

1678 
$™em
->
lšk
 = 
	`u¾
("node/$nid", 
	`¬¿y
('absŞu‹' => 
TRUE
));

1680 ià(
$™em_Ëngth
 != 'title') {

1681 
$‹a£r
 = (
$™em_Ëngth
 =ğ'‹a£r'è? 
TRUE
 : 
FALSE
;

1684 ià(
	`node_hook
(
$™em
, 'view')) {

1685 
$™em
 = 
	`node_švoke
($™em, 'v›w', 
$‹a£r
, 
FALSE
);

1688 
$™em
 = 
	`node_´•¬e
($™em, 
$‹a£r
);

1692 
	`node_švoke_nod—pi
(
$™em
, 'v›w', 
$‹a£r
, 
FALSE
);

1696 
$cÚ‹Á
 = 
	`dru·l_»nd”
(
$™em
->
cÚ‹Á
);

1697 ià(
$‹a£r
) {

1698 
$™em
->
‹a£r
 = 
$cÚ‹Á
;

1699 
	`un£t
(
$™em
->
body
);

1702 
$™em
->
body
 = 
$cÚ‹Á
;

1703 
	`un£t
(
$™em
->
‹a£r
);

1707 
	`node_švoke_nod—pi
(
$™em
, '®‹r', 
$‹a£r
, 
FALSE
);

1711 
$exŒa
 = 
	`node_švoke_nod—pi
(
$™em
, 'rss item');

1712 
$exŒa
 = 
	`¬¿y_m”ge
($exŒa, 
	`¬¿y
×¼ay('key' => 'pubD©e', 'v®ue' => 
	`gmd©e
('r', 
$™em
->
ü—‹d
)),‡¼ay('key' => 'dc:ü—tÜ', 'v®ue' => $™em->
Çme
),‡¼ay('key' => 'guid', 'v®ue' => $™em->
nid
 .'‡ˆ'. 
$ba£_u¾
, 'attributes' =>‡rray('isPermaLink' => 'false'))));

1713 
	`fÜ—ch
 (
$exŒa
 
as
 
$–em’t
) {

1714 ià(
	`is£t
(
$–em’t
['namespace'])) {

1715 
$Çme¥aûs
 = 
	`¬¿y_m”ge
($Çme¥aûs, 
$–em’t
['namespace']);

1720 
$™em_Ëngth
) {

1722 
$™em_‹xt
 = 
$™em
->
body
;

1725 
$™em_‹xt
 = 
$™em
->
‹a£r
;

1726 ià(!
	`em±y
(
$™em
->
»admÜe
)) {

1727 
$™em_‹xt
 .ğ'<p>'. 
	`l
(
	`t
('»ad mÜe'), 'node/'. 
$™em
->
nid
, 
	`¬¿y
('absŞu‹' => 
TRUE
, 'attributes' =>‡rray('target' => '_blank'))) .'</p>';

1731 
$™em_‹xt
 = '';

1735 
$™ems
 .ğ
	`fÜm©_rss_™em
(
$™em
->
t™Ë
, $™em->
lšk
, 
$™em_‹xt
, 
$exŒa
);

1738 
$chªÃl_deçuÉs
 = 
	`¬¿y
(

1740 't™Ë' => 
	`v¬ŸbË_g‘
('site_name', 'Drupal'),

1741 'lšk' => 
$ba£_u¾
,

1742 'desütiÚ' => 
	`v¬ŸbË_g‘
('site_mission', ''),

1743 'Ïnguage' => 
$Ïnguage
->
Ïnguage


1745 
$chªÃl
 = 
	`¬¿y_m”ge
(
$chªÃl_deçuÉs
, $channel);

1747 
$ouut
 = "<?xml version=\"1.0\"ƒncoding=\"utf-8\"?>\n";

1748 
$ouut
 .ğ"<rs v”siÚ=\"". 
$chªÃl
["v”siÚ"] ."\" xml:ba£=\"". 
$ba£_u¾
 ."\" ". 
	`dru·l_©Œibu‹s
(
$Çme¥aûs
) .">\n";

1749 
$ouut
 .ğ
	`fÜm©_rss_chªÃl
(
$chªÃl
['t™Ë'], $chªÃl['lšk'], $chªÃl['desütiÚ'], 
$™ems
, $channel['language']);

1750 
$ouut
 .= "</rss>\n";

1752 
	`dru·l_£t_h—d”
('Content-Type:‡pplication/rss+xml; charset=utf-8');

1753 
´št
 
$ouut
;

1754 
	}
}

1759 
funùiÚ
 
	$node_·ge_deçuÉ
() {

1760 
$»suÉ
 = 
	`·g”_qu”y
(
	`db_»wr™e_sql
('SELECT‚.nid,‚.¡icky,‚.ü—‹d FROM {node}‚ WHERE‚.´omÙğ1 AND‚.¡©u ğ1 ORDER BY‚.¡icky DESC,‚.ü—‹d DESC'), 
	`v¬ŸbË_g‘
('default_nodes_main', 10));

1762 
$ouut
 = '';

1763 
$num_rows
 = 
FALSE
;

1764 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1765 
$ouut
 .ğ
	`node_v›w
(
	`node_lßd
(
$node
->
nid
), 1);

1766 
$num_rows
 = 
TRUE
;

1769 ià(
$num_rows
) {

1770 
$ãed_u¾
 = 
	`u¾
('rss.xml', 
	`¬¿y
('absŞu‹' => 
TRUE
));

1771 
	`dru·l_add_ãed
(
$ãed_u¾
, 
	`v¬ŸbË_g‘
('s™e_Çme', 'Dru·l'è.' '. 
	`t
('RSS'));

1772 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 
	`v¬ŸbË_g‘
('default_nodes_main', 10));

1775 
$deçuÉ_mes§ge
 = 
	`t
('<h1 class="title">Welcomeo your‚ew Drupal website!</h1><p>Please followhese stepso set up‡nd start using your website:</p>');

1776 
$deçuÉ_mes§ge
 .= '<ol>';

1778 
$deçuÉ_mes§ge
 .ğ'<li>'. 
	`t
('<¡rÚg>CÚfigu» you¸webs™e</¡rÚg> Onû†ogged in, vis™h<¨h»f="@admš">admši¡¿tiÚ seùiÚ</a>, wh”you cª <¨h»f="@cÚfig">cu¡omizªd cÚfigu»</a>‡Î‡¥eù oàyou¸webs™e.', 
	`¬¿y
('@admš' => 
	`u¾
('admin'), '@config' => url('admin/settings'))) .'</li>';

1779 
$deçuÉ_mes§ge
 .ğ'<li>'. 
	`t
('<¡rÚg>EÇbË‡dd™iÚ® funùiÚ®™y</¡rÚg> Next, vis™h<¨h»f="@moduËs">moduË†i¡</a>‡ndƒÇbË f—tu» which su™ you¸¥ecifiøÃeds. You cª fšd‡dd™iÚ® moduË šh<¨h»f="@dowÆßd_moduËs">Dru·ÈmoduË dowÆßd seùiÚ</a>.', 
	`¬¿y
('@moduËs' => 
	`u¾
('admin/build/modules'), '@download_modules' => 'http://drupal.org/project/modules')) .'</li>';

1780 
$deçuÉ_mes§ge
 .ğ'<li>'. 
	`t
('<¡rÚg>Cu¡omizyou¸webs™design</¡rÚg> TØchªgth"look‡nd f“l" oàyou¸webs™e, vis™h<¨h»f="@themes">theme £ùiÚ</a>. You may choo£ from oÃ oàthšşudedheme Ü dowÆßd‡dd™iÚ®heme äomh<¨h»f="@dowÆßd_themes">Dru·Ètheme dowÆßd seùiÚ</a>.', 
	`¬¿y
('@themes' => 
	`u¾
('admin/build/themes'), '@download_themes' => 'http://drupal.org/project/themes')) .'</li>';

1781 
$deçuÉ_mes§ge
 .ğ'<li>'. 
	`t
('<¡rÚg>S¹…o¡šg cÚ‹Á</¡rÚg> Fš®ly, you cª <¨h»f="@cÚ‹Á">ü—‹ cÚ‹Á</a> fÜ you¸webs™e. Thi mes§gwÈdi§µ—¸Úû you hav´omÙed‡…o¡ØthäÚˆ·ge.', 
	`¬¿y
('@cÚ‹Á' => 
	`u¾
('node/add'))) .'</li>';

1782 
$deçuÉ_mes§ge
 .= '</ol>';

1783 
$deçuÉ_mes§ge
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ,…Ëa£„eã¸tØth<¨h»f="@h–p">h–°£ùiÚ</a>, o¸th<¨h»f="@hªdbook">ÚlšDru·Èhªdbooks</a>. You may‡lsØpo¡‡ˆth<¨h»f="@fÜum">Dru·ÈfÜum</a>, o¸v›whwid¿ngoà<¨h»f="@suµÜt">Ùh” suµÜˆİtiÚs</a>‡vaabË.', 
	`¬¿y
('@h–p' => 
	`u¾
('admin/help'), '@handbook' => 'http://drupal.org/handbooks', '@forum' => 'http://drupal.org/forum', '@support' => 'http://drupal.org/support')) .'</p>';

1785 
$ouut
 = '<div id="fœ¡-time">'. 
$deçuÉ_mes§ge
 .'</div>';

1787 
	`dru·l_£t_t™Ë
('');

1789  
$ouut
;

1790 
	}
}

1795 
funùiÚ
 
	$node_·ge_v›w
(
$node
, 
$cid
 = 
NULL
) {

1796 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$node
->
t™Ë
));

1797  
	`node_show
(
$node
, 
$cid
);

1798 
	}
}

1803 
funùiÚ
 
	$node_upd©e_šdex
() {

1804 
$lim™
 = ()
	`v¬ŸbË_g‘
('search_cron_limit', 100);

1807 
	`v¬ŸbË_£t
('node_üÚ_comm’ts_sÿË', 1.0 / 
	`max
(1, 
	`db_»suÉ
(
	`db_qu”y
('SELECT MAX(comment_count) FROM {node_comment_statistics}'))));

1808 
	`v¬ŸbË_£t
('node_üÚ_v›ws_sÿË', 1.0 / 
	`max
(1, 
	`db_»suÉ
(
	`db_qu”y
('SELECT MAX(totalcount) FROM {node_counter}'))));

1810 
$»suÉ
 = 
	`db_qu”y_¿nge
("SELECT‚.nid FROM {node}‚ LEFT JOIN {£¬ch_d©a£t} d ON d.ty³ = 'node' AND d.sid =‚.nid WHERE d.sid IS NULL OR d.»šdex <> 0 ORDER BY d.»šdex ASC,‚.nid ASC", 0, 
$lim™
);

1812 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1813 
	`_node_šdex_node
(
$node
);

1815 
	}
}

1823 
funùiÚ
 
	$_node_šdex_node
(
$node
) {

1824 
$node
 = 
	`node_lßd
($node->
nid
);

1827 
	`v¬ŸbË_£t
('node_üÚ_Ï¡', 
$node
->
chªged
);

1830 
$node
->
bud_mode
 = 
NODE_BUILD_SEARCH_INDEX
;

1831 
$node
 = 
	`node_bud_cÚ‹Á
($node, 
FALSE
, FALSE);

1832 
$node
->
body
 = 
	`dru·l_»nd”
($node->
cÚ‹Á
);

1834 
$‹xt
 = '<h1>'. 
	`check_¶aš
(
$node
->
t™Ë
è.'</h1>'. $node->
body
;

1837 
$exŒa
 = 
	`node_švoke_nod—pi
(
$node
, 'update index');

1838 
	`fÜ—ch
 (
$exŒa
 
as
 
$t
) {

1839 
$‹xt
 .ğ
$t
;

1843 
	`£¬ch_šdex
(
$node
->
nid
, 'node', 
$‹xt
);

1844 
	}
}

1849 
funùiÚ
 
	$node_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

1851 ià(
$fÜm_id
 =ğ'£¬ch_fÜm' && 
$fÜm
['moduË']['#v®ue'] =ğ'node' && 
	`u£r_acûss
('use‡dvanced search')) {

1853 
$fÜm
['advªûd'] = 
	`¬¿y
(

1855 '#t™Ë' => 
	`t
('Advanced search'),

1856 '#cŞÏpsibË' => 
TRUE
,

1857 '#cŞÏp£d' => 
TRUE
,

1858 '#©Œibu‹s' => 
	`¬¿y
('class' => 'search-advanced'),

1860 
$fÜm
['advªûd']['keywÜds'] = 
	`¬¿y
(

1864 
$fÜm
['advªûd']['keywÜds']['Ü'] = 
	`¬¿y
(

1866 '#t™Ë' => 
	`t
('Containing‡ny ofhe words'),

1870 
$fÜm
['advªûd']['keywÜds']['ph¿£'] = 
	`¬¿y
(

1872 '#t™Ë' => 
	`t
('Containinghe…hrase'),

1876 
$fÜm
['advªûd']['keywÜds']['Ãg©ive'] = 
	`¬¿y
(

1878 '#t™Ë' => 
	`t
('Containing‚one ofhe words'),

1884 ià(
$xÚomy
 = 
	`moduË_švoke
('taxonomy', 'form_all', 1)) {

1885 
$fÜm
['advªûd']['ÿ‹gÜy'] = 
	`¬¿y
(

1887 '#t™Ë' => 
	`t
('Only inhe category(s)'),

1891 '#İtiÚs' => 
$xÚomy
,

1892 '#muÉË' => 
TRUE
,

1897 
$ty³s
 = 
	`¬¿y_m­
('check_¶aš', 
	`node_g‘_ty³s
('names'));

1898 
$fÜm
['advªûd']['ty³'] = 
	`¬¿y
(

1900 '#t™Ë' => 
	`t
('Only ofheype(s)'),

1903 '#İtiÚs' => 
$ty³s
,

1905 
$fÜm
['advªûd']['subm™'] = 
	`¬¿y
(

1907 '#v®ue' => 
	`t
('Advanced search'),

1912 
$fÜm
['#validate'][] = 'node_search_validate';

1914 
	}
}

1919 
funùiÚ
 
	$node_£¬ch_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

1921 
$keys
 = 
$fÜm_¡©e
['values']['processed_keys'];

1924 ià(
	`is£t
(
$fÜm_¡©e
['v®ues']['ty³']è&& 
	`is_¬¿y
($form_state['values']['type'])) {

1926 
$fÜm_¡©e
['v®ues']['ty³'] = 
	`¬¿y_f‹r
($form_state['values']['type']);

1927 ià(
	`couÁ
(
$fÜm_¡©e
['values']['type'])) {

1928 
$keys
 = 
	`£¬ch_qu”y_š£¹
($keys, 'ty³', 
	`im¶ode
(',', 
	`¬¿y_keys
(
$fÜm_¡©e
['values']['type'])));

1932 ià(
	`is£t
(
$fÜm_¡©e
['v®ues']['ÿ‹gÜy']è&& 
	`is_¬¿y
($form_state['values']['category'])) {

1933 
$keys
 = 
	`£¬ch_qu”y_š£¹
($keys, 'ÿ‹gÜy', 
	`im¶ode
(',', 
$fÜm_¡©e
['values']['category']));

1935 ià(
$fÜm_¡©e
['values']['or'] != '') {

1936 ià(
	`´eg_m©ch_®l
('/ ("[^"]+"|[^" ]+)/i', ' '. 
$fÜm_¡©e
['v®ues']['Ü'], 
$m©ches
)) {

1937 
$keys
 .ğ' '. 
	`im¶ode
(' OR ', 
$m©ches
[1]);

1940 ià(
$fÜm_¡©e
['values']['negative'] != '') {

1941 ià(
	`´eg_m©ch_®l
('/ ("[^"]+"|[^" ]+)/i', ' '. 
$fÜm_¡©e
['v®ues']['Ãg©ive'], 
$m©ches
)) {

1942 
$keys
 .ğ' -'. 
	`im¶ode
(' -', 
$m©ches
[1]);

1945 ià(
$fÜm_¡©e
['values']['phrase'] != '') {

1946 
$keys
 .ğ' "'. 
	`¡r_»¶aû
('"', ' ', 
$fÜm_¡©e
['values']['phrase']) .'"';

1948 ià(!
	`em±y
(
$keys
)) {

1949 
	`fÜm_£t_v®ue
(
$fÜm
['basic']['šlše']['´oûs£d_keys'], 
	`Œim
(
$keys
), 
$fÜm_¡©e
);

1951 
	}
}

2005 
funùiÚ
 
	$node_acûss
(
$İ
, 
$node
, 
$accouÁ
 = 
NULL
) {

2006 
glob®
 
$u£r
;

2008 ià(!
$node
 || !
	`š_¬¿y
(
$İ
, 
	`¬¿y
('v›w', 'upd©e', 'd–‘e', 'ü—‹'), 
TRUE
)) {

2011  
FALSE
;

2014 ià(
$İ
 != 'create') {

2015 
$node
 = (
objeù
)$node;

2018 ià(
	`em±y
(
$accouÁ
)) {

2019 
$accouÁ
 = 
$u£r
;

2022 ià(
$İ
 =ğ'upd©e' && !
	`f‹r_acûss
(
$node
->
fÜm©
)) {

2023  
FALSE
;

2026 ià(
	`u£r_acûss
('admši¡”‚odes', 
$accouÁ
)) {

2027  
TRUE
;

2030 ià(!
	`u£r_acûss
('acûs cÚ‹Á', 
$accouÁ
)) {

2031  
FALSE
;

2036 
$moduË
 = 
	`node_g‘_ty³s
('moduË', 
$node
);

2037 ià(
$moduË
 == 'node') {

2038 
$moduË
 = 'node_content';

2040 
$acûss
 = 
	`moduË_švoke
(
$moduË
, 'acûss', 
$İ
, 
$node
, 
$accouÁ
);

2041 ià(!
	`is_nuÎ
(
$acûss
)) {

2042  
$acûss
;

2047 ià(
$İ
 !ğ'ü—‹' && 
$node
->
nid
 && $node->
¡©us
) {

2048 
$g¿Ás
 = 
	`¬¿y
();

2049 
	`fÜ—ch
 (
	`node_acûss_g¿Ás
(
$İ
, 
$accouÁ
è
as
 
$»®m
 => 
$gids
) {

2050 
	`fÜ—ch
 (
$gids
 
as
 
$gid
) {

2051 
$g¿Ás
[] = "(gid = $gid AND„ealm = '$realm')";

2055 
$g¿Ás_sql
 = '';

2056 ià(
	`couÁ
(
$g¿Ás
)) {

2057 
$g¿Ás_sql
 = 'AND ('. 
	`im¶ode
(' OR ', 
$g¿Ás
) .')';

2060 
$sql
 = "SELECT 1 FROM {node_access} WHERE (nid = 0 OR‚id = %d) $grants_sql AND grant_$op >= 1";

2061 
$»suÉ
 = 
	`db_qu”y_¿nge
(
$sql
, 
$node
->
nid
, 0, 1);

2062  (
boŞ
è
	`db_»suÉ
(
$»suÉ
);

2066 ià(
$İ
 =ğ'v›w' && 
$accouÁ
->
uid
 =ğ
$node
->uid && $account->uid != 0) {

2067  
TRUE
;

2070  
FALSE
;

2071 
	}
}

2085 
funùiÚ
 
_node_acûss_još_sql
(
$node_®Ÿs
 = 'n', 
$node_acûss_®Ÿs
 = 'na') {

2086 ià(
u£r_acûss
('administer‚odes')) {

2090  'INNER JOIN {node_acûss} '. 
	g$node_acûss_®Ÿs
 .' ON '. $node_acûss_®Ÿ .'.nid = '. 
	g$node_®Ÿs
 .'.nid';

2107 
funùiÚ
 
_node_acûss_wh”e_sql
(
$İ
 = 'v›w', 
$node_acûss_®Ÿs
 = 'Ç', 
$accouÁ
 = 
NULL
) {

2108 ià(
u£r_acûss
('administer‚odes')) {

2112 
	g$g¿Ás
 = 
¬¿y
();

2113 
fÜ—ch
 (
node_acûss_g¿Ás
(
$İ
, 
$accouÁ
è
as
 
$»®m
 => 
$gids
) {

2114 
fÜ—ch
 (
$gids
 
as
 
$gid
) {

2115 
$g¿Ás
[] = "($node_access_alias.gid = $gid AND $node_access_alias.realm = '$realm')";

2119 
	g$g¿Ás_sql
 = '';

2120 ià(
couÁ
(
$g¿Ás
)) {

2121 
	g$g¿Ás_sql
 = 'AND ('. 
im¶ode
(' OR ', 
$g¿Ás
) .')';

2124 
	g$sql
 = "$node_access_alias.grant_$op >= 1 $grants_sql";

2125  
	g$sql
;

2144 
funùiÚ
 
	$node_acûss_g¿Ás
(
$İ
, 
$accouÁ
 = 
NULL
) {

2146 ià(!
	`is£t
(
$accouÁ
)) {

2147 
$accouÁ
 = 
$GLOBALS
['user'];

2150  
	`¬¿y_m”ge
(
	`¬¿y
('®l' =>‡¼ay(0)), 
	`moduË_švoke_®l
('node_g¿Ás', 
$accouÁ
, 
$İ
));

2151 
	}
}

2156 
funùiÚ
 
	$node_acûss_v›w_®l_nodes
() {

2157 
$acûss
;

2159 ià(!
	`is£t
(
$acûss
)) {

2160 
$g¿Ás
 = 
	`¬¿y
();

2161 
	`fÜ—ch
 (
	`node_acûss_g¿Ás
('v›w'è
as
 
$»®m
 => 
$gids
) {

2162 
	`fÜ—ch
 (
$gids
 
as
 
$gid
) {

2163 
$g¿Ás
[] = "(gid = $gid AND„ealm = '$realm')";

2167 
$g¿Ás_sql
 = '';

2168 ià(
	`couÁ
(
$g¿Ás
)) {

2169 
$g¿Ás_sql
 = 'AND ('. 
	`im¶ode
(' OR ', 
$g¿Ás
) .')';

2172 
$sql
 = "SELECT COUNT(*) FROM {node_access} WHERE‚id = 0 $grants_sql AND grant_view >= 1";

2173 
$»suÉ
 = 
	`db_qu”y
(
$sql
);

2174 
$acûss
 = 
	`db_»suÉ
(
$»suÉ
);

2177  
$acûss
;

2178 
	}
}

2183 
funùiÚ
 
	$node_db_»wr™e_sql
(
$qu”y
, 
$´im¬y_bË
, 
$´im¬y_f›ld
) {

2184 ià(
$´im¬y_f›ld
 =ğ'nid' && !
	`node_acûss_v›w_®l_nodes
()) {

2185 
$»tuº
['još'] = 
	`_node_acûss_još_sql
(
$´im¬y_bË
);

2186 
$»tuº
['wh”e'] = 
	`_node_acûss_wh”e_sql
();

2187 
$»tuº
['distinct'] = 1;

2188  
$»tuº
;

2190 
	}
}

2204 
funùiÚ
 
	$node_acûss_acquœe_g¿Ás
(
$node
) {

2205 
$g¿Ás
 = 
	`moduË_švoke_®l
('node_acûss_»cÜds', 
$node
);

2206 ià(
	`em±y
(
$g¿Ás
)) {

2207 
$g¿Ás
[] = 
	`¬¿y
('realm' => 'all', 'gid' => 0, 'grant_view' => 1, 'grant_update' => 0, 'grant_delete' => 0);

2211 
$g¿Á_by_´iÜ™y
 = 
	`¬¿y
();

2212 
	`fÜ—ch
 (
$g¿Ás
 
as
 
$g
) {

2213 
$g¿Á_by_´iÜ™y
[
	`štv®
(
$g
['priority'])][] = $g;

2215 
	`krsÜt
(
$g¿Á_by_´iÜ™y
);

2216 
$g¿Ás
 = 
	`¬¿y_shiá
(
$g¿Á_by_´iÜ™y
);

2219 
	`node_acûss_wr™e_g¿Ás
(
$node
, 
$g¿Ás
);

2220 
	}
}

2244 
funùiÚ
 
	$node_acûss_wr™e_g¿Ás
(
$node
, 
$g¿Ás
, 
$»®m
 = 
NULL
, 
$d–‘e
 = 
TRUE
) {

2245 ià(
$d–‘e
) {

2246 
$qu”y
 = 'DELETE FROM {node_access} WHERE‚id = %d';

2247 ià(
$»®m
) {

2248 
$qu”y
 .= " AND„ealm in ('%s', 'all')";

2250 
	`db_qu”y
(
$qu”y
, 
$node
->
nid
, 
$»®m
);

2254 ià(
	`couÁ
(
	`moduË_im¶em’ts
('node_grants'))) {

2255 
	`fÜ—ch
 (
$g¿Ás
 
as
 
$g¿Á
) {

2256 ià(
$»®m
 && $»®m !ğ
$g¿Á
['realm']) {

2260 ià(
$g¿Á
['grant_view'] || $grant['grant_update'] || $grant['grant_delete']) {

2261 
	`db_qu”y
("INSERT INTO {node_acûss} (nid,„—lm, gid, g¿Á_v›w, g¿Á_upd©e, g¿Á_d–‘eèVALUES (%d, '%s', %d, %d, %d, %d)", 
$node
->
nid
, 
$g¿Á
['realm'], $grant['gid'], $grant['grant_view'], $grant['grant_update'], $grant['grant_delete']);

2265 
	}
}

2284 
funùiÚ
 
	$node_acûss_Ãeds_»bud
(
$»bud
 = 
NULL
) {

2285 ià(!
	`is£t
(
$»bud
)) {

2286  
	`v¬ŸbË_g‘
('node_acûss_Ãeds_»bud', 
FALSE
);

2288 
	`–£if
 (
$»bud
) {

2289 
	`v¬ŸbË_£t
('node_acûss_Ãeds_»bud', 
TRUE
);

2292 
	`v¬ŸbË_d–
('node_access_needs_rebuild');

2294 
	}
}

2318 
funùiÚ
 
	$node_acûss_»bud
(
$b©ch_mode
 = 
FALSE
) {

2319 
	`db_qu”y
("DELETE FROM {node_access}");

2321 ià(
	`couÁ
(
	`moduË_im¶em’ts
('node_grants'))) {

2322 ià(
$b©ch_mode
) {

2323 
$b©ch
 = 
	`¬¿y
(

2324 't™Ë' => 
	`t
('Rebuilding content‡ccess…ermissions'),

2325 'İ”©iÚs' => 
	`¬¿y
(

2326 
	`¬¿y
('_node_access_rebuild_batch_operation',‡rray()),

2330 
	`b©ch_£t
(
$b©ch
);

2334 ià(
	`funùiÚ_exi¡s
('set_time_limit')) {

2335 @
	`£t_time_lim™
(240);

2337 
$»suÉ
 = 
	`db_qu”y
("SELECT‚id FROM {node}");

2338 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

2339 
$lßded_node
 = 
	`node_lßd
(
$node
->
nid
, 
NULL
, 
TRUE
);

2342 ià(!
	`em±y
(
$lßded_node
)) {

2343 
	`node_acûss_acquœe_g¿Ás
(
$lßded_node
);

2350 
	`db_qu”y
("INSERT INTO {node_access} VALUES (0, 0, 'all', 1, 0, 0)");

2353 ià(!
	`is£t
(
$b©ch
)) {

2354 
	`dru·l_£t_mes§ge
(
	`t
('Content…ermissions have been„ebuilt.'));

2355 
	`node_acûss_Ãeds_»bud
(
FALSE
);

2356 
	`ÿche_ş—r_®l
();

2358 
	}
}

2367 
funùiÚ
 
	$_node_acûss_»bud_b©ch_İ”©iÚ
(&
$cÚ‹xt
) {

2368 ià(
	`em±y
(
$cÚ‹xt
['sandbox'])) {

2370 
$cÚ‹xt
['sandbox']['progress'] = 0;

2371 
$cÚ‹xt
['sandbox']['current_node'] = 0;

2372 
$cÚ‹xt
['§ndbox']['max'] = 
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(DISTINCT‚id) FROM {node}'));

2376 
$lim™
 = 20;

2377 
$»suÉ
 = 
	`db_qu”y_¿nge
("SELECT‚id FROM {node} WHERE‚id > %d ORDER BY‚id ASC", 
$cÚ‹xt
['§ndbox']['cu¼’t_node'], 0, 
$lim™
);

2378 
$row
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

2379 
$lßded_node
 = 
	`node_lßd
(
$row
['nid'], 
NULL
, 
TRUE
);

2382 ià(!
	`em±y
(
$lßded_node
)) {

2383 
	`node_acûss_acquœe_g¿Ás
(
$lßded_node
);

2385 
$cÚ‹xt
['sandbox']['progress']++;

2386 
$cÚ‹xt
['§ndbox']['cu¼’t_node'] = 
$row
['nid'];

2390 ià(
$cÚ‹xt
['sandbox']['progress'] != $context['sandbox']['max']) {

2391 
$cÚ‹xt
['finished'] = $context['sandbox']['progress'] / $context['sandbox']['max'];

2393 
	}
}

2398 
funùiÚ
 
	$_node_acûss_»bud_b©ch_fšished
(
$sucûss
, 
$»suÉs
, 
$İ”©iÚs
) {

2399 ià(
$sucûss
) {

2400 
	`dru·l_£t_mes§ge
(
	`t
('The content‡ccess…ermissions have been„ebuilt.'));

2401 
	`node_acûss_Ãeds_»bud
(
FALSE
);

2404 
	`dru·l_£t_mes§ge
(
	`t
('The content‡ccess…ermissions have‚ot been…roperly„ebuilt.'), 'error');

2406 
	`ÿche_ş—r_®l
();

2407 
	}
}

2424 
funùiÚ
 
	$node_cÚ‹Á_acûss
(
$İ
, 
$node
, 
$accouÁ
) {

2425 
$ty³
 = 
	`is_¡ršg
(
$node
è? $nod: (
	`is_¬¿y
($nodeè? $node['ty³'] : $node->
ty³
);

2427 ià(
$İ
 == 'create') {

2428  
	`u£r_acûss
('ü—‹ '. 
$ty³
 .' cÚ‹Á', 
$accouÁ
);

2431 ià(
$İ
 == 'update') {

2432 ià(
	`u£r_acûss
('ed™‡ny '. 
$ty³
 .' cÚ‹Á', 
$accouÁ
è|| (u£r_acûss('ed™ owÀ'. $ty³ .' cÚ‹Á', $accouÁè&& ($accouÁ->
uid
 =ğ
$node
->uid))) {

2433  
TRUE
;

2437 ià(
$İ
 == 'delete') {

2438 ià(
	`u£r_acûss
('d–‘ªy '. 
$ty³
 .' cÚ‹Á', 
$accouÁ
è|| (u£r_acûss('d–‘owÀ'. $ty³ .' cÚ‹Á', $accouÁè&& ($accouÁ->
uid
 =ğ
$node
->uid))) {

2439  
TRUE
;

2442 
	}
}

2447 
funùiÚ
 
	$node_cÚ‹Á_fÜm
(
$node
, 
$fÜm_¡©e
) {

2448 
$ty³
 = 
	`node_g‘_ty³s
('ty³', 
$node
);

2449 
$fÜm
 = 
	`¬¿y
();

2451 ià(
$ty³
->
has_t™Ë
) {

2452 
$fÜm
['t™Ë'] = 
	`¬¿y
(

2454 '#t™Ë' => 
	`check_¶aš
(
$ty³
->
t™Ë_Ïb–
),

2455 '#»quœed' => 
TRUE
,

2456 '#deçuÉ_v®ue' => 
$node
->
t™Ë
,

2462 ià(
$ty³
->
has_body
) {

2463 
$fÜm
['body_f›ld'] = 
	`node_body_f›ld
(
$node
, 
$ty³
->
body_Ïb–
, $ty³->
mš_wÜd_couÁ
);

2466  
$fÜm
;

2467 
	}
}

2476 
funùiÚ
 
	$node_fÜms
() {

2477 
$fÜms
 = 
	`¬¿y
();

2478 ià(
$ty³s
 = 
	`node_g‘_ty³s
()) {

2479 
	`fÜ—ch
 (
	`¬¿y_keys
(
$ty³s
è
as
 
$ty³
) {

2480 
$fÜms
[
$ty³
 .'_node_form']['callback'] = 'node_form';

2483  
$fÜms
;

2484 
	}
}

2491 
funùiÚ
 
	$theme_node_subm™‹d
(
$node
) {

2492  
	`t
('Submitted by !username on @datetime',

2493 
	`¬¿y
(

2494 '!u£ºame' => 
	`theme
('u£ºame', 
$node
),

2495 '@d©‘ime' => 
	`fÜm©_d©e
(
$node
->
ü—‹d
),

2497 
	}
}

2502 
funùiÚ
 
	$node_hook_šfo
() {

2503  
	`¬¿y
(

2504 'node' => 
	`¬¿y
(

2505 'nod—pi' => 
	`¬¿y
(

2506 '´e§ve' => 
	`¬¿y
(

2507 'run wh’' => 
	`t
('Whenƒither saving‡‚ew…ost or updating‡nƒxisting…ost'),

2509 'š£¹' => 
	`¬¿y
(

2510 'run wh’' => 
	`t
('After saving‡‚ew…ost'),

2512 'upd©e' => 
	`¬¿y
(

2513 'run wh’' => 
	`t
('After saving‡n updated…ost'),

2515 'd–‘e' => 
	`¬¿y
(

2516 'run wh’' => 
	`t
('After deleting‡…ost')

2518 'v›w' => 
	`¬¿y
(

2519 'run wh’' => 
	`t
('When content is viewed by‡n‡uthenticated user')

2524 
	}
}

2529 
funùiÚ
 
	$node_aùiÚ_šfo
() {

2530  
	`¬¿y
(

2531 'node_publish_aùiÚ' => 
	`¬¿y
(

2533 'desütiÚ' => 
	`t
('Publish…ost'),

2534 'cÚfigu¿bË' => 
FALSE
,

2535 'behaviÜ' => 
	`¬¿y
('changes_node_property'),

2536 'hooks' => 
	`¬¿y
(

2537 'nod—pi' => 
	`¬¿y
('presave'),

2538 'comm’t' => 
	`¬¿y
('insert', 'update'),

2541 'node_uÅublish_aùiÚ' => 
	`¬¿y
(

2543 'desütiÚ' => 
	`t
('Unpublish…ost'),

2544 'cÚfigu¿bË' => 
FALSE
,

2545 'behaviÜ' => 
	`¬¿y
('changes_node_property'),

2546 'hooks' => 
	`¬¿y
(

2547 'nod—pi' => 
	`¬¿y
('presave'),

2548 'comm’t' => 
	`¬¿y
('delete', 'insert', 'update'),

2551 'node_make_¡icky_aùiÚ' => 
	`¬¿y
(

2553 'desütiÚ' => 
	`t
('Make…ost sticky'),

2554 'cÚfigu¿bË' => 
FALSE
,

2555 'behaviÜ' => 
	`¬¿y
('changes_node_property'),

2556 'hooks' => 
	`¬¿y
(

2557 'nod—pi' => 
	`¬¿y
('presave'),

2558 'comm’t' => 
	`¬¿y
('insert', 'update'),

2561 'node_make_un¡icky_aùiÚ' => 
	`¬¿y
(

2563 'desütiÚ' => 
	`t
('Make…ost unsticky'),

2564 'cÚfigu¿bË' => 
FALSE
,

2565 'behaviÜ' => 
	`¬¿y
('changes_node_property'),

2566 'hooks' => 
	`¬¿y
(

2567 'nod—pi' => 
	`¬¿y
('presave'),

2568 'comm’t' => 
	`¬¿y
('delete', 'insert', 'update'),

2571 'node_´omÙe_aùiÚ' => 
	`¬¿y
(

2573 'desütiÚ' => 
	`t
('Promote…osto front…age'),

2574 'cÚfigu¿bË' => 
FALSE
,

2575 'behaviÜ' => 
	`¬¿y
('changes_node_property'),

2576 'hooks' => 
	`¬¿y
(

2577 'nod—pi' => 
	`¬¿y
('presave'),

2578 'comm’t' => 
	`¬¿y
('insert', 'update'),

2581 'node_uÅromÙe_aùiÚ' => 
	`¬¿y
(

2583 'desütiÚ' => 
	`t
('Remove…ost from front…age'),

2584 'cÚfigu¿bË' => 
FALSE
,

2585 'behaviÜ' => 
	`¬¿y
('changes_node_property'),

2586 'hooks' => 
	`¬¿y
(

2587 'nod—pi' => 
	`¬¿y
('presave'),

2588 'comm’t' => 
	`¬¿y
('delete', 'insert', 'update'),

2591 'node_assign_owÃr_aùiÚ' => 
	`¬¿y
(

2593 'desütiÚ' => 
	`t
('Changehe‡uthor of‡…ost'),

2594 'cÚfigu¿bË' => 
TRUE
,

2595 'behaviÜ' => 
	`¬¿y
('changes_node_property'),

2596 'hooks' => 
	`¬¿y
(

2597 'ªy' => 
TRUE
,

2598 'nod—pi' => 
	`¬¿y
('presave'),

2599 'comm’t' => 
	`¬¿y
('delete', 'insert', 'update'),

2602 'node_§ve_aùiÚ' => 
	`¬¿y
(

2604 'desütiÚ' => 
	`t
('Save…ost'),

2605 'cÚfigu¿bË' => 
FALSE
,

2606 'hooks' => 
	`¬¿y
(

2607 'comm’t' => 
	`¬¿y
('delete', 'insert', 'update'),

2610 'node_uÅublish_by_keywÜd_aùiÚ' => 
	`¬¿y
(

2612 'desütiÚ' => 
	`t
('Unpublish…ost containing keyword(s)'),

2613 'cÚfigu¿bË' => 
TRUE
,

2614 'hooks' => 
	`¬¿y
(

2615 'nod—pi' => 
	`¬¿y
('presave', 'insert', 'update'),

2619 
	}
}

2625 
funùiÚ
 
node_publish_aùiÚ
(&
$node
, 
$cÚ‹xt
 = 
	$¬¿y
()) {

2626 
$node
->
¡©us
 = 1;

2627 
	`w©chdog
('aùiÚ', 'S‘ @ty³ %t™ËØpublished.', 
	`¬¿y
('@ty³' => 
	`node_g‘_ty³s
('Çme', 
$node
), '%t™Ë' => $node->
t™Ë
));

2628 
	}
}

2634 
funùiÚ
 
node_uÅublish_aùiÚ
(&
$node
, 
$cÚ‹xt
 = 
	$¬¿y
()) {

2635 
$node
->
¡©us
 = 0;

2636 
	`w©chdog
('aùiÚ', 'S‘ @ty³ %t™ËØuÅublished.', 
	`¬¿y
('@ty³' => 
	`node_g‘_ty³s
('Çme', 
$node
), '%t™Ë' => $node->
t™Ë
));

2637 
	}
}

2643 
funùiÚ
 
node_make_¡icky_aùiÚ
(&
$node
, 
$cÚ‹xt
 = 
	$¬¿y
()) {

2644 
$node
->
¡icky
 = 1;

2645 
	`w©chdog
('aùiÚ', 'S‘ @ty³ %t™ËØ¡icky.', 
	`¬¿y
('@ty³' => 
	`node_g‘_ty³s
('Çme', 
$node
), '%t™Ë' => $node->
t™Ë
));

2646 
	}
}

2652 
funùiÚ
 
node_make_un¡icky_aùiÚ
(&
$node
, 
$cÚ‹xt
 = 
	$¬¿y
()) {

2653 
$node
->
¡icky
 = 0;

2654 
	`w©chdog
('aùiÚ', 'S‘ @ty³ %t™ËØun¡icky.', 
	`¬¿y
('@ty³' => 
	`node_g‘_ty³s
('Çme', 
$node
), '%t™Ë' => $node->
t™Ë
));

2655 
	}
}

2661 
funùiÚ
 
node_´omÙe_aùiÚ
(&
$node
, 
$cÚ‹xt
 = 
	$¬¿y
()) {

2662 
$node
->
´omÙe
 = 1;

2663 
	`w©chdog
('aùiÚ', 'PromÙed @ty³ %t™ËØäÚˆ·ge.', 
	`¬¿y
('@ty³' => 
	`node_g‘_ty³s
('Çme', 
$node
), '%t™Ë' => $node->
t™Ë
));

2664 
	}
}

2670 
funùiÚ
 
node_uÅromÙe_aùiÚ
(&
$node
, 
$cÚ‹xt
 = 
	$¬¿y
()) {

2671 
$node
->
´omÙe
 = 0;

2672 
	`w©chdog
('aùiÚ', 'Removed @ty³ %t™Ë from frÚˆ·ge.', 
	`¬¿y
('@ty³' => 
	`node_g‘_ty³s
('Çme', 
$node
), '%t™Ë' => $node->
t™Ë
));

2673 
	}
}

2679 
funùiÚ
 
	$node_§ve_aùiÚ
(
$node
) {

2680 
	`node_§ve
(
$node
);

2681 
	`w©chdog
('aùiÚ', 'Saved @ty³ %t™Ë', 
	`¬¿y
('@ty³' => 
	`node_g‘_ty³s
('Çme', 
$node
), '%t™Ë' => $node->
t™Ë
));

2682 
	}
}

2688 
funùiÚ
 
	$node_assign_owÃr_aùiÚ
(&
$node
, 
$cÚ‹xt
) {

2689 
$node
->
uid
 = 
$cÚ‹xt
['owner_uid'];

2690 
$owÃr_Çme
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT‚amFROM {u£rs} WHERE uid = %d", 
$cÚ‹xt
['owner_uid']));

2691 
	`w©chdog
('aùiÚ', 'Chªged owÃ¸oà@ty³ %t™ËØuid %Çme.', 
	`¬¿y
('@ty³' => 
	`node_g‘_ty³s
('ty³', 
$node
), '%t™Ë' => $node->
t™Ë
, '%Çme' => 
$owÃr_Çme
));

2692 
	}
}

2694 
funùiÚ
 
	$node_assign_owÃr_aùiÚ_fÜm
(
$cÚ‹xt
) {

2695 
$desütiÚ
 = 
	`t
('The username ofhe usero which you would†ikeo‡ssign ownership.');

2696 
$couÁ
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*) FROM {users}"));

2697 
$owÃr_Çme
 = '';

2698 ià(
	`is£t
(
$cÚ‹xt
['owner_uid'])) {

2699 
$owÃr_Çme
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT‚amFROM {u£rs} WHERE uid = %d", 
$cÚ‹xt
['owner_uid']));

2703 ià(
	`štv®
(
$couÁ
) < 200) {

2704 
$İtiÚs
 = 
	`¬¿y
();

2705 
$»suÉ
 = 
	`db_qu”y
("SELECT uid,‚ame FROM {users} WHERE uid > 0 ORDER BY‚ame");

2706 
$d©a
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

2707 
$İtiÚs
[
$d©a
->
Çme
] = $data->name;

2709 
$fÜm
['owÃr_Çme'] = 
	`¬¿y
(

2711 '#t™Ë' => 
	`t
('Username'),

2712 '#deçuÉ_v®ue' => 
$owÃr_Çme
,

2713 '#İtiÚs' => 
$İtiÚs
,

2714 '#desütiÚ' => 
$desütiÚ
,

2718 
$fÜm
['owÃr_Çme'] = 
	`¬¿y
(

2720 '#t™Ë' => 
	`t
('Username'),

2721 '#deçuÉ_v®ue' => 
$owÃr_Çme
,

2725 '#desütiÚ' => 
$desütiÚ
,

2728  
$fÜm
;

2729 
	}
}

2731 
funùiÚ
 
	$node_assign_owÃr_aùiÚ_v®id©e
(
$fÜm
, 
$fÜm_¡©e
) {

2732 
$couÁ
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {u£rs} WHERE‚amğ'%s'", 
$fÜm_¡©e
['values']['owner_name']));

2733 ià(
	`štv®
(
$couÁ
) != 1) {

2734 
	`fÜm_£t_”rÜ
('owÃr_Çme', 
	`t
('Pleaseƒnter‡ valid username.'));

2736 
	}
}

2738 
funùiÚ
 
	$node_assign_owÃr_aùiÚ_subm™
(
$fÜm
, 
$fÜm_¡©e
) {

2740 
$uid
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT uid from {u£rs} WHERE‚amğ'%s'", 
$fÜm_¡©e
['values']['owner_name']));

2741  
	`¬¿y
('owÃr_uid' => 
$uid
);

2742 
	}
}

2744 
funùiÚ
 
	$node_uÅublish_by_keywÜd_aùiÚ_fÜm
(
$cÚ‹xt
) {

2745 
$fÜm
['keywÜds'] = 
	`¬¿y
(

2746 '#t™Ë' => 
	`t
('Keywords'),

2748 '#desütiÚ' => 
	`t
('The…ost will be unpublished if it contains‡ny ofhe character sequences‡bove. Use‡ comma-separated†ist of character sequences. Example: funny, bungee jumping, "Company, Inc.". Character sequences‡re case-sensitive.'),

2749 '#deçuÉ_v®ue' => 
	`is£t
(
$cÚ‹xt
['keywÜds']è? 
	`dru·l_im¶ode_gs
($context['keywords']) : '',

2751  
$fÜm
;

2752 
	}
}

2754 
funùiÚ
 
	$node_uÅublish_by_keywÜd_aùiÚ_subm™
(
$fÜm
, 
$fÜm_¡©e
) {

2755  
	`¬¿y
('keywÜds' => 
	`dru·l_ex¶ode_gs
(
$fÜm_¡©e
['values']['keywords']));

2756 
	}
}

2767 
funùiÚ
 
	$node_uÅublish_by_keywÜd_aùiÚ
(
$node
, 
$cÚ‹xt
) {

2768 
	`fÜ—ch
 (
$cÚ‹xt
['keywÜds'] 
as
 
$keywÜd
) {

2769 ià(
	`¡r¡r
(
	`node_v›w
(
	`dru·l_şÚe
(
$node
)), 
$keywÜd
è|| sŒ¡r($node->
t™Ë
, $keyword)) {

2770 
$node
->
¡©us
 = 0;

2771 
	`w©chdog
('aùiÚ', 'S‘ @ty³ %t™ËØuÅublished.', 
	`¬¿y
('@ty³' => 
	`node_g‘_ty³s
('Çme', 
$node
), '%t™Ë' => $node->
t™Ë
));

2775 
	}
}

	@/srv/http/subs/notes/www/modules/node/node.pages.inc

1 <?
php


13 
funùiÚ
 
	$node_·ge_ed™
(
$node
) {

14 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$node
->
t™Ë
));

15  
	`dru·l_g‘_fÜm
(
$node
->
ty³
 .'_node_form', $node);

16 
	}
}

18 
funùiÚ
 
	$node_add_·ge
() {

19 
$™em
 = 
	`m’u_g‘_™em
();

20 
$cÚ‹Á
 = 
	`sy¡em_admš_m’u_block
(
$™em
);

21  
	`theme
('node_add_li¡', 
$cÚ‹Á
);

22 
	}
}

29 
funùiÚ
 
	$theme_node_add_li¡
(
$cÚ‹Á
) {

30 
$ouut
 = '';

32 ià(
$cÚ‹Á
) {

33 
$ouut
 = '<dl class="node-type-list">';

34 
	`fÜ—ch
 (
$cÚ‹Á
 
as
 
$™em
) {

35 
$ouut
 .ğ'<dt>'. 
	`l
(
$™em
['title'], $item['href'], $item['localized_options']) .'</dt>';

36 
$ouut
 .ğ'<dd>'. 
	`f‹r_xss_admš
(
$™em
['description']) .'</dd>';

38 
$ouut
 .= '</dl>';

40  
$ouut
;

41 
	}
}

47 
funùiÚ
 
	$node_add
(
$ty³
) {

48 
glob®
 
$u£r
;

50 
$ty³s
 = 
	`node_g‘_ty³s
();

51 
$ty³
 = 
	`is£t
($ty³è? 
	`¡r_»¶aû
('-', '_', $ty³è: 
NULL
;

53 ià(
	`is£t
(
$ty³s
[
$ty³
]è&& 
	`node_acûss
('create', $type)) {

55 
$node
 = 
	`¬¿y
('uid' => 
$u£r
->
uid
, 'Çme' => (
	`is£t
($u£r->
Çme
è? $u£r->Çm: ''), 'ty³' => 
$ty³
, 'language' => '');

57 
	`dru·l_£t_t™Ë
(
	`t
('C»©@Çme', 
	`¬¿y
('@Çme' => 
$ty³s
[
$ty³
]->
Çme
)));

58 
$ouut
 = 
	`dru·l_g‘_fÜm
(
$ty³
 .'_node_fÜm', 
$node
);

61  
$ouut
;

62 
	}
}

64 
funùiÚ
 
	$node_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

65 
	`node_v®id©e
(
$fÜm_¡©e
['v®ues'], 
$fÜm
);

66 
	}
}

68 
funùiÚ
 
	$node_objeù_´•¬e
(&
$node
) {

70 
$node_İtiÚs
 = 
	`v¬ŸbË_g‘
('node_İtiÚs_'. 
$node
->
ty³
, 
	`¬¿y
('status', 'promote'));

72 ià(!
	`is£t
(
$node
->
nid
)) {

73 
	`fÜ—ch
 (
	`¬¿y
('¡©us', '´omÙe', '¡icky'è
as
 
$key
) {

74 
$node
->
$key
 = 
	`š_¬¿y
($key, 
$node_İtiÚs
);

76 
glob®
 
$u£r
;

77 
$node
->
uid
 = 
$u£r
->uid;

78 
$node
->
ü—‹d
 = 
	`time
();

81 
$node
->
d©e
 = 
	`fÜm©_d©e
($node->
ü—‹d
, 'custom', 'Y-m-d H:i:s O');

83 
$node
->
log
 = 
NULL
;

86 
$node
->
»visiÚ
 = 
	`š_¬¿y
('»visiÚ', 
$node_İtiÚs
);

88 
	`node_švoke
(
$node
, 'prepare');

89 
	`node_švoke_nod—pi
(
$node
, 'prepare');

90 
	}
}

95 
funùiÚ
 
	$node_fÜm
(&
$fÜm_¡©e
, 
$node
) {

96 
glob®
 
$u£r
;

98 ià(
	`is£t
(
$fÜm_¡©e
['node'])) {

99 
$node
 = 
$fÜm_¡©e
['node'] + (
¬¿y
)$node;

101 ià(
	`is£t
(
$fÜm_¡©e
['node_preview'])) {

102 
$fÜm
['#´efix'] = 
$fÜm_¡©e
['node_preview'];

104 
$node
 = (
objeù
)$node;

105 
	`fÜ—ch
 (
	`¬¿y
('body', 't™Ë', 'fÜm©'è
as
 
$key
) {

106 ià(!
	`is£t
(
$node
->
$key
)) {

107 
$node
->
$key
 = 
NULL
;

110 ià(!
	`is£t
(
$fÜm_¡©e
['node_preview'])) {

111 
	`node_objeù_´•¬e
(
$node
);

114 
$node
->
bud_mode
 = 
NODE_BUILD_PREVIEW
;

118 
$fÜm
['#id'] = 'node-form';

122 
	`fÜ—ch
 (
	`¬¿y
('nid', 'vid', 'uid', 'ü—‹d', 'ty³', 'Ïnguage'è
as
 
$key
) {

123 
$fÜm
[
$key
] = 
	`¬¿y
(

125 '#v®ue' => 
	`is£t
(
$node
->
$key
è? $node->$key : 
NULL
,

130 
$fÜm
['chªged'] = 
	`¬¿y
(

132 '#deçuÉ_v®ue' => 
	`is£t
(
$node
->
chªged
è? $node->chªged : 
NULL
,

135 ià(
$exŒa
 = 
	`node_švoke
(
$node
, 'fÜm', 
$fÜm_¡©e
)) {

136 
$fÜm
 = 
	`¬¿y_m”ge_»cursive
($fÜm, 
$exŒa
);

138 ià(!
	`is£t
(
$fÜm
['title']['#weight'])) {

139 
$fÜm
['title']['#weight'] = -5;

142 
$fÜm
['#node'] = 
$node
;

146 ià(!
	`em±y
(
$node
->
»visiÚ
è|| 
	`u£r_acûss
('administer‚odes')) {

147 
$fÜm
['»visiÚ_šfÜm©iÚ'] = 
	`¬¿y
(

149 '#t™Ë' => 
	`t
('Revision information'),

150 '#cŞÏpsibË' => 
TRUE
,

152 '#cŞÏp£d' => !
$node
->
»visiÚ
,

155 
$fÜm
['»visiÚ_šfÜm©iÚ']['»visiÚ'] = 
	`¬¿y
(

156 '#acûss' => 
	`u£r_acûss
('administer‚odes'),

158 '#t™Ë' => 
	`t
('Create‚ew„evision'),

159 '#deçuÉ_v®ue' => 
$node
->
»visiÚ
,

161 
$fÜm
['»visiÚ_šfÜm©iÚ']['log'] = 
	`¬¿y
(

163 '#t™Ë' => 
	`t
('Log message'),

164 '#deçuÉ_v®ue' => (
	`is£t
(
$node
->
log
) ? $node->log : ''),

166 '#desütiÚ' => 
	`t
('Anƒxplanation ofhe‡dditions or updates being madeo help other‡uthors understand your motivations.'),

171 
$fÜm
['authÜ'] = 
	`¬¿y
(

173 '#acûss' => 
	`u£r_acûss
('administer‚odes'),

174 '#t™Ë' => 
	`t
('Authoring information'),

175 '#cŞÏpsibË' => 
TRUE
,

176 '#cŞÏp£d' => 
TRUE
,

179 
$fÜm
['authÜ']['Çme'] = 
	`¬¿y
(

181 '#t™Ë' => 
	`t
('Authored by'),

184 '#deçuÉ_v®ue' => 
$node
->
Çme
 ? $node->name : '',

186 '#desütiÚ' => 
	`t
('L—vbÏnk fÜ %ªÚymous.', 
	`¬¿y
('%ªÚymous' => 
	`v¬ŸbË_g‘
('anonymous',('Anonymous')))),

188 
$fÜm
['authÜ']['d©e'] = 
	`¬¿y
(

190 '#t™Ë' => 
	`t
('Authored on'),

192 '#desütiÚ' => 
	`t
('FÜm©: %time. L—vbÏnkØu£htimoàfÜm submissiÚ.', 
	`¬¿y
('%time' => !
	`em±y
(
$node
->
d©e
è? $node->d©: 
	`fÜm©_d©e
($node->
ü—‹d
, 'custom', 'Y-m-d H:i:s O'))),

195 ià(
	`is£t
(
$node
->
d©e
)) {

196 
$fÜm
['authÜ']['d©e']['#deçuÉ_v®ue'] = 
$node
->
d©e
;

200 
$fÜm
['İtiÚs'] = 
	`¬¿y
(

202 '#acûss' => 
	`u£r_acûss
('administer‚odes'),

203 '#t™Ë' => 
	`t
('Publishing options'),

204 '#cŞÏpsibË' => 
TRUE
,

205 '#cŞÏp£d' => 
TRUE
,

208 
$fÜm
['İtiÚs']['¡©us'] = 
	`¬¿y
(

210 '#t™Ë' => 
	`t
('Published'),

211 '#deçuÉ_v®ue' => 
$node
->
¡©us
,

213 
$fÜm
['İtiÚs']['´omÙe'] = 
	`¬¿y
(

215 '#t™Ë' => 
	`t
('Promotedo front…age'),

216 '#deçuÉ_v®ue' => 
$node
->
´omÙe
,

218 
$fÜm
['İtiÚs']['¡icky'] = 
	`¬¿y
(

220 '#t™Ë' => 
	`t
('Sticky‡top of†ists'),

221 '#deçuÉ_v®ue' => 
$node
->
¡icky
,

225 
	`fÜ—ch
 (
	`¬¿y
('uid', 'ü—‹d'è
as
 
$key
) {

226 
$fÜm
[
$key
] = 
	`¬¿y
(

228 '#v®ue' => 
$node
->
$key
,

233 
$fÜm
['bu‰Ús'] = 
	`¬¿y
();

234 
$fÜm
['bu‰Ús']['subm™'] = 
	`¬¿y
(

236 '#acûss' => !
	`v¬ŸbË_g‘
('node_´ev›w', 0è|| (!
	`fÜm_g‘_”rÜs
(è&& 
	`is£t
(
$fÜm_¡©e
['node_preview'])),

237 '#v®ue' => 
	`t
('Save'),

239 '#subm™' => 
	`¬¿y
('node_form_submit'),

241 
$fÜm
['bu‰Ús']['´ev›w'] = 
	`¬¿y
(

243 '#v®ue' => 
	`t
('Preview'),

245 '#subm™' => 
	`¬¿y
('node_form_build_preview'),

247 ià(!
	`em±y
(
$node
->
nid
è&& 
	`node_acûss
('delete', $node)) {

248 
$fÜm
['bu‰Ús']['d–‘e'] = 
	`¬¿y
(

250 '#v®ue' => 
	`t
('Delete'),

252 '#subm™' => 
	`¬¿y
('node_form_delete_submit'),

255 
$fÜm
['#validate'][] = 'node_form_validate';

256 
$fÜm
['#theme'] = 
	`¬¿y
(
$node
->
ty³
 .'_node_form', 'node_form');

257  
$fÜm
;

258 
	}
}

263 
funùiÚ
 
	$node_body_f›ld
(&
$node
, 
$Ïb–
, 
$wÜd_couÁ
) {

266 
$šşude
 = !
	`is£t
(
$node
->
‹a£r
è|| ($node->‹a£¸=ğ
	`sub¡r
($node->
body
, 0, 
	`¡¾’
($node->teaser)));

268 
$fÜm
 = 
	`¬¿y
(

269 '#aá”_bud' => 
	`¬¿y
('node_teaser_js', 'node_teaser_include_verify'));

271 
$fÜm
['#prefix'] = '<div class="body-field-wrapper">';

272 
$fÜm
['#suffix'] = '</div>';

274 
$fÜm
['‹a£r_js'] = 
	`¬¿y
(

279 '#di§bËd' => 
TRUE
,

282 
$fÜm
['‹a£r_šşude'] = 
	`¬¿y
(

284 '#t™Ë' => 
	`t
('Show summary in full view'),

285 '#deçuÉ_v®ue' => 
$šşude
,

290 
$fÜm
['body'] = 
	`¬¿y
(

292 '#t™Ë' => 
	`check_¶aš
(
$Ïb–
),

293 '#deçuÉ_v®ue' => 
$šşude
 ? 
$node
->
body
 : ($node->
‹a£r
 . $node->body),

295 '#»quœed' => (
$wÜd_couÁ
 > 0),

298 
$fÜm
['fÜm©'] = 
	`f‹r_fÜm
(
$node
->
fÜm©
);

300  
$fÜm
;

301 
	}
}

306 
funùiÚ
 
	$node_fÜm_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

307 
$de¡š©iÚ
 = '';

308 ià(
	`is£t
(
$_REQUEST
['destination'])) {

309 
$de¡š©iÚ
 = 
	`dru·l_g‘_de¡š©iÚ
();

310 
	`un£t
(
$_REQUEST
['destination']);

312 
$node
 = 
$fÜm
['#node'];

313 
$fÜm_¡©e
['»dœeù'] = 
	`¬¿y
('node/'. 
$node
->
nid
 .'/d–‘e', 
$de¡š©iÚ
);

314 
	}
}

317 
funùiÚ
 
	$node_fÜm_bud_´ev›w
(
$fÜm
, &
$fÜm_¡©e
) {

318 
$node
 = 
	`node_fÜm_subm™_bud_node
(
$fÜm
, 
$fÜm_¡©e
);

319 
$fÜm_¡©e
['node_´ev›w'] = 
	`node_´ev›w
(
$node
);

320 
	}
}

327 
funùiÚ
 
	$theme_node_fÜm
(
$fÜm
) {

328 
$ouut
 = "\n<div class=\"node-form\">\n";

333 
$admš
 = '';

334 ià(
	`is£t
(
$fÜm
['author'])) {

335 
$admš
 .= " <div class=\"authored\">\n";

336 
$admš
 .ğ
	`dru·l_»nd”
(
$fÜm
['author']);

337 
$admš
 .= " </div>\n";

339 ià(
	`is£t
(
$fÜm
['options'])) {

340 
$admš
 .= " <div class=\"options\">\n";

341 
$admš
 .ğ
	`dru·l_»nd”
(
$fÜm
['options']);

342 
$admš
 .= " </div>\n";

344 
$bu‰Ús
 = 
	`dru·l_»nd”
(
$fÜm
['buttons']);

348 
$ouut
 .= " <div class=\"standard\">\n";

349 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

350 
$ouut
 .= " </div>\n";

352 ià(!
	`em±y
(
$admš
)) {

353 
$ouut
 .= " <div class=\"admin\">\n";

354 
$ouut
 .ğ
$admš
;

355 
$ouut
 .= " </div>\n";

357 
$ouut
 .ğ
$bu‰Ús
;

358 
$ouut
 .= "</div>\n";

360  
$ouut
;

361 
	}
}

366 
funùiÚ
 
	$node_´ev›w
(
$node
) {

367 ià(
	`node_acûss
('ü—‹', 
$node
) ||‚ode_access('update', $node)) {

369 ià(
	`is£t
(
$node
->
Çme
)) {

372 ià(
$u£r
 = 
	`u£r_lßd
(
	`¬¿y
('Çme' => 
$node
->
Çme
))) {

373 
$node
->
uid
 = 
$u£r
->uid;

374 
$node
->
piùu»
 = 
$u£r
->picture;

377 
$node
->
uid
 = 0;

380 ià(
$node
->
uid
) {

381 
$u£r
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => 
$node
->
uid
));

382 
$node
->
Çme
 = 
$u£r
->name;

383 
$node
->
piùu»
 = 
$u£r
->picture;

386 
$node
->
chªged
 = 
	`time
();

390 ià(!
	`is£t
(
$node
->
‹a£r
)) {

391 
$node
->
‹a£r
 = 
	`em±y
($node->
body
è? '' : 
	`node_‹a£r
($node->body, $node->
fÜm©
);

393 ià(!
$node
->
‹a£r_šşude
 && $node->
‹a£r
 =ğ
	`sub¡r
($node->
body
, 0, 
	`¡¾’
($node->teaser))) {

394 
$node
->
body
 = 
	`sub¡r
($node->body, 
	`¡¾’
($node->
‹a£r
));

400 ià(!
	`fÜm_g‘_”rÜs
()) {

401 
$şÚed_node
 = 
	`dru·l_şÚe
(
$node
);

402 
$şÚed_node
->
bud_mode
 = 
NODE_BUILD_PREVIEW
;

403 
$ouut
 = 
	`theme
('node_´ev›w', 
$şÚed_node
);

405 
	`dru·l_£t_t™Ë
(
	`t
('Preview'));

407  
$ouut
;

409 
	}
}

419 
funùiÚ
 
	$theme_node_´ev›w
(
$node
) {

420 
$ouut
 = '<div class="preview">';

422 
$´ev›w_Œimmed_v”siÚ
 = 
FALSE
;

424 ià(
	`is£t
(
$node
->
‹a£r
è&& is£t($node->
body
)) {

425 
$‹a£r
 = 
	`Œim
(
$node
->
‹a£r
);

426 
$body
 = 
	`Œim
(
	`¡r_»¶aû
('<!--b»ak-->', '', 
$node
->
body
));

431 ià(
$‹a£r
 !ğ
$body
 || ($body && 
	`¡½os
(
$node
->
body
, '<!--break-->') === 0)) {

432 
$´ev›w_Œimmed_v”siÚ
 = 
TRUE
;

436 ià(
$´ev›w_Œimmed_v”siÚ
) {

437 
	`dru·l_£t_mes§ge
(
	`t
('Therimmed version of your…ost shows what your…ost†ooks†ike when…romotedohe main…age or whenƒxported for syndication.<span class="no-js"> You can inserthe delimiter "&lt;!--break--&gt;" (withouthe quotes)o fine-tune where your…ost gets split.</span>'));

438 
$ouut
 .ğ'<h3>'. 
	`t
('Previewrimmed version') .'</h3>';

439 
$ouut
 .ğ
	`node_v›w
(
	`dru·l_şÚe
(
$node
), 1, 
FALSE
, 0);

440 
$ouut
 .ğ'<h3>'. 
	`t
('Preview full version') .'</h3>';

441 
$ouut
 .ğ
	`node_v›w
(
$node
, 0, 
FALSE
, 0);

444 
$ouut
 .ğ
	`node_v›w
(
$node
, 0, 
FALSE
, 0);

446 
$ouut
 .= "</div>\n";

448  
$ouut
;

449 
	}
}

451 
funùiÚ
 
	$node_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

452 
glob®
 
$u£r
;

454 
$node
 = 
	`node_fÜm_subm™_bud_node
(
$fÜm
, 
$fÜm_¡©e
);

455 
$š£¹
 = 
	`em±y
(
$node
->
nid
);

456 
	`node_§ve
(
$node
);

457 
$node_lšk
 = 
	`l
(
	`t
('v›w'), 'node/'. 
$node
->
nid
);

458 
$w©chdog_¬gs
 = 
	`¬¿y
('@ty³' => 
$node
->
ty³
, '%t™Ë' => $node->
t™Ë
);

459 
$t_¬gs
 = 
	`¬¿y
('@ty³' => 
	`node_g‘_ty³s
('Çme', 
$node
), '%t™Ë' => $node->
t™Ë
);

461 ià(
$š£¹
) {

462 
	`w©chdog
('cÚ‹Á', '@ty³:‡dded %t™Ë.', 
$w©chdog_¬gs
, 
WATCHDOG_NOTICE
, 
$node_lšk
);

463 
	`dru·l_£t_mes§ge
(
	`t
('@ty³ %t™Ë ha b“Àü—‹d.', 
$t_¬gs
));

466 
	`w©chdog
('cÚ‹Á', '@ty³: upd©ed %t™Ë.', 
$w©chdog_¬gs
, 
WATCHDOG_NOTICE
, 
$node_lšk
);

467 
	`dru·l_£t_mes§ge
(
	`t
('@ty³ %t™Ë ha b“Àupd©ed.', 
$t_¬gs
));

469 ià(
$node
->
nid
) {

470 
	`un£t
(
$fÜm_¡©e
['rebuild']);

471 
$fÜm_¡©e
['nid'] = 
$node
->
nid
;

472 
$fÜm_¡©e
['»dœeù'] = 'node/'. 
$node
->
nid
;

477 
	`dru·l_£t_mes§ge
(
	`t
('The…ost could‚ot be saved.'), 'error');

479 
	}
}

484 
funùiÚ
 
	$node_fÜm_subm™_bud_node
(
$fÜm
, &
$fÜm_¡©e
) {

487 
	`un£t
(
$fÜm_¡©e
['submit_handlers']);

488 
	`fÜm_execu‹_hªdËrs
('subm™', 
$fÜm
, 
$fÜm_¡©e
);

489 
$node
 = 
	`node_subm™
(
$fÜm_¡©e
['values']);

490 
$fÜm_¡©e
['node'] = (
¬¿y
)
$node
;

491 
$fÜm_¡©e
['»bud'] = 
TRUE
;

492  
$node
;

493 
	}
}

498 
funùiÚ
 
	$node_d–‘e_cÚfœm
(&
$fÜm_¡©e
, 
$node
) {

499 
$fÜm
['nid'] = 
	`¬¿y
(

501 '#v®ue' => 
$node
->
nid
,

504  
	`cÚfœm_fÜm
(
$fÜm
,

505 
	`t
('A» you su» you wªˆtØd–‘%t™Ë?', 
	`¬¿y
('%t™Ë' => 
$node
->
t™Ë
)),

506 
	`is£t
(
$_GET
['de¡š©iÚ']è? $_GET['de¡š©iÚ'] : 'node/'. 
$node
->
nid
,

507 
	`t
('This‡ction cannot be undone.'),

508 
	`t
('Delete'),

509 
	`t
('Cancel')

511 
	}
}

516 
funùiÚ
 
	$node_d–‘e_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

517 ià(
$fÜm_¡©e
['values']['confirm']) {

518 
	`node_d–‘e
(
$fÜm_¡©e
['values']['nid']);

521 
$fÜm_¡©e
['redirect'] = '<front>';

522 
	}
}

527 
funùiÚ
 
	$node_»visiÚ_ov”v›w
(
$node
) {

528 
	`dru·l_£t_t™Ë
(
	`t
('RevisiÚ fÜ %t™Ë', 
	`¬¿y
('%t™Ë' => 
$node
->
t™Ë
)));

530 
$h—d”
 = 
	`¬¿y
(
	`t
('Revision'),‡rray('data' =>('Operations'), 'colspan' => 2));

532 
$»visiÚs
 = 
	`node_»visiÚ_li¡
(
$node
);

534 
$rows
 = 
	`¬¿y
();

535 
$»v”t_³rmissiÚ
 = 
FALSE
;

536 ià((
	`u£r_acûss
('»v”ˆ»visiÚs'è|| u£r_acûss('admši¡”‚odes')è&& 
	`node_acûss
('upd©e', 
$node
)) {

537 
$»v”t_³rmissiÚ
 = 
TRUE
;

539 
$d–‘e_³rmissiÚ
 = 
FALSE
;

540 ià((
	`u£r_acûss
('d–‘»visiÚs'è|| u£r_acûss('admši¡”‚odes')è&& 
	`node_acûss
('d–‘e', 
$node
)) {

541 
$d–‘e_³rmissiÚ
 = 
TRUE
;

543 
	`fÜ—ch
 (
$»visiÚs
 
as
 
$»visiÚ
) {

544 
$row
 = 
	`¬¿y
();

545 
$İ”©iÚs
 = 
	`¬¿y
();

547 ià(
$»visiÚ
->
cu¼’t_vid
 > 0) {

548 
$row
[] = 
	`¬¿y
('d©a' => 
	`t
('!d©by !u£ºame',‡¼ay('!d©e' => 
	`l
(
	`fÜm©_d©e
(
$»visiÚ
->
time¡amp
, 'sm®l'), "node/$node->nid"), '!u£ºame' => 
	`theme
('username', $revision)))

549 . ((
$»visiÚ
->
log
 !ğ''è? '<°şass="»visiÚ-log">'. 
	`f‹r_xss
($revision->log) .'</p>' : ''),

551 
$İ”©iÚs
[] = 
	`¬¿y
('d©a' => 
	`theme
('¶aûhŞd”', 
	`t
('current„evision')), 'class' => 'revision-current', 'colspan' => 2);

554 
$row
[] = 
	`t
('!d©by !u£ºame', 
	`¬¿y
('!d©e' => 
	`l
(
	`fÜm©_d©e
(
$»visiÚ
->
time¡amp
, 'sm®l'), "node/$node->nid/»visiÚs/$»visiÚ->vid/v›w"), '!u£ºame' => 
	`theme
('username', $revision)))

555 . ((
$»visiÚ
->
log
 !ğ''è? '<°şass="»visiÚ-log">'. 
	`f‹r_xss
($revision->log) .'</p>' : '');

556 ià(
$»v”t_³rmissiÚ
) {

557 
$İ”©iÚs
[] = 
	`l
(
	`t
('revert'), "node/$node->nid/revisions/$revision->vid/revert");

559 ià(
$d–‘e_³rmissiÚ
) {

560 
$İ”©iÚs
[] = 
	`l
(
	`t
('delete'), "node/$node->nid/revisions/$revision->vid/delete");

563 
$rows
[] = 
	`¬¿y_m”ge
(
$row
, 
$İ”©iÚs
);

566  
	`theme
('bË', 
$h—d”
, 
$rows
);

567 
	}
}

572 
funùiÚ
 
	$node_»visiÚ_»v”t_cÚfœm
(
$fÜm_¡©e
, 
$node_»visiÚ
) {

573 
$fÜm
['#node_»visiÚ'] = 
$node_»visiÚ
;

574  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØ»v”ˆtØth»visiÚ from %»visiÚ-d©e?', 
	`¬¿y
('%»visiÚ-d©e' => 
	`fÜm©_d©e
(
$node_»visiÚ
->
»visiÚ_time¡amp
))), 'node/'. $node_»visiÚ->
nid
 .'/revisions', '',('Revert'),('Cancel'));

575 
	}
}

577 
funùiÚ
 
	$node_»visiÚ_»v”t_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

578 
$node_»visiÚ
 = 
$fÜm
['#node_revision'];

579 
$node_»visiÚ
->
»visiÚ
 = 1;

580 
$node_»visiÚ
->
log
 = 
	`t
('Cİy oàth»visiÚ from %d©e.', 
	`¬¿y
('%d©e' => 
	`fÜm©_d©e
($node_»visiÚ->
»visiÚ_time¡amp
)));

581 ià(
	`moduË_exi¡s
('taxonomy')) {

582 
$node_»visiÚ
->
xÚomy
 = 
	`¬¿y_keys
($node_revision->taxonomy);

585 
	`node_§ve
(
$node_»visiÚ
);

587 
	`w©chdog
('cÚ‹Á', '@ty³:„ev”‹d %t™Ë„evisiÚ %»visiÚ.', 
	`¬¿y
('@ty³' => 
$node_»visiÚ
->
ty³
, '%t™Ë' => $node_»visiÚ->
t™Ë
, '%»visiÚ' => $node_»visiÚ->
vid
));

588 
	`dru·l_£t_mes§ge
(
	`t
('@ty³ %t™Ë ha b“À»v”‹d backØth»visiÚ from %»visiÚ-d©e.', 
	`¬¿y
('@ty³' => 
	`node_g‘_ty³s
('Çme', 
$node_»visiÚ
), '%t™Ë' => $node_»visiÚ->
t™Ë
, '%»visiÚ-d©e' => 
	`fÜm©_d©e
($node_»visiÚ->
»visiÚ_time¡amp
))));

589 
$fÜm_¡©e
['»dœeù'] = 'node/'. 
$node_»visiÚ
->
nid
 .'/revisions';

590 
	}
}

592 
funùiÚ
 
	$node_»visiÚ_d–‘e_cÚfœm
(
$fÜm_¡©e
, 
$node_»visiÚ
) {

593 
$fÜm
['#node_»visiÚ'] = 
$node_»visiÚ
;

594  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØd–‘th»visiÚ from %»visiÚ-d©e?', 
	`¬¿y
('%»visiÚ-d©e' => 
	`fÜm©_d©e
(
$node_»visiÚ
->
»visiÚ_time¡amp
))), 'node/'. $node_»visiÚ->
nid
 .'/revisions',('This‡ction cannot be undone.'),('Delete'),('Cancel'));

595 
	}
}

597 
funùiÚ
 
	$node_»visiÚ_d–‘e_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

598 
$node_»visiÚ
 = 
$fÜm
['#node_revision'];

599 
	`db_qu”y
("DELETE FROM {node_»visiÚs} WHERE‚id = %d AND vid = %d", 
$node_»visiÚ
->
nid
, $node_»visiÚ->
vid
);

600 
	`node_švoke_nod—pi
(
$node_»visiÚ
, 'delete„evision');

601 
	`w©chdog
('cÚ‹Á', '@ty³: d–‘ed %t™Ë„evisiÚ %»visiÚ.', 
	`¬¿y
('@ty³' => 
$node_»visiÚ
->
ty³
, '%t™Ë' => $node_»visiÚ->
t™Ë
, '%»visiÚ' => $node_»visiÚ->
vid
));

602 
	`dru·l_£t_mes§ge
(
	`t
('RevisiÚ from %»visiÚ-d©oà@ty³ %t™Ë ha b“Àd–‘ed.', 
	`¬¿y
('%»visiÚ-d©e' => 
	`fÜm©_d©e
(
$node_»visiÚ
->
»visiÚ_time¡amp
), '@ty³' => 
	`node_g‘_ty³s
('Çme', $node_»visiÚ), '%t™Ë' => $node_»visiÚ->
t™Ë
)));

603 
$fÜm_¡©e
['»dœeù'] = 'node/'. 
$node_»visiÚ
->
nid
;

604 ià(
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(vidèFROM {node_»visiÚs} WHERE‚id = %d', 
$node_»visiÚ
->
nid
)) > 1) {

605 
$fÜm_¡©e
['redirect'] .= '/revisions';

607 
	}
}

	@/srv/http/subs/notes/www/modules/node/node.tpl.php

1 <?
	gphp


51 <
div
 
	gid
="node-<?ph°´šˆ$node->nid; ?>" 
şass
="node<?php if ($sticky) {…rint ' sticky'; } ?><?php if (!$status) {…rint '‚ode-unpublished'; } ?> clear-block">

53 <?
php
 
´št
 
$piùu»
 ?>

55 <?
php
 ià(!
$·ge
): ?>

56 <
h2
><
a
 
h»f
="<?ph°´šˆ$node_u¾ ?>" 
t™Ë
="<?ph°´šˆ$t™Ë ?>"><?
php
 
´št
 
$t™Ë
 ?></a></h2>

57 <?
php
 
’dif
; ?>

59 <
div
 
	gşass
="meta">

60 <?
php
 ià(
$subm™‹d
): ?>

61 <
¥ª
 
şass
="subm™‹d"><?
php
 
´št
 
$subm™‹d
 ?></span>

62 <?
php
 
’dif
; ?>

64 <?
php
 ià(
	g$‹rms
): ?>

65 <
div
 
şass
="‹rm ‹rms-šlše"><?
php
 
´št
 
$‹rms
 ?></div>

66 <?
php
 
’dif
;?>

67 </
	gdiv
>

69 <
div
 
	gşass
="content">

70 <?
php
 
´št
 
$cÚ‹Á
 ?>

71 </
div
>

73 <?
php
 
´št
 
$lšks
; ?>

74 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/openid/openid.inc

1 <?
php


10 
defše
('OPENID_DH_DEFAULT_MOD', '155172898181473697471232257763715539915724801'.

17 
defše
('OPENID_DH_DEFAULT_GEN', '2');

18 
defše
('OPENID_SHA1_BLOCKSIZE', 64);

19 
defše
('OPENID_RAND_SOURCE', '/dev/urandom');

22 
defše
('OPENID_NS_2_0', 'http://specs.openid.net/auth/2.0');

23 
defše
('OPENID_NS_1_1', 'http://openid.net/signon/1.1');

24 
defše
('OPENID_NS_1_0', 'http://openid.net/signon/1.0');

29 
funùiÚ
 
	$İ’id_»dœeù_h‰p
(
$u¾
, 
$mes§ge
) {

30 
$qu”y
 = 
	`¬¿y
();

31 
	`fÜ—ch
 (
$mes§ge
 
as
 
$key
 => 
$v®
) {

32 
$qu”y
[] = 
$key
 .'='. 
	`u¾’code
(
$v®
);

35 
$£p
 = (
	`¡½os
(
$u¾
, '?'è==ğ
FALSE
) ? '?' : '&';

36 
	`h—d”
('LoÿtiÚ: '. 
$u¾
 . 
$£p
 . 
	`im¶ode
('&', 
$qu”y
), 
TRUE
, 302);

37 
ex™
;

38 
	}
}

43 
funùiÚ
 
	$İ’id_»dœeù
(
$u¾
, 
$mes§ge
) {

44 
$ouut
 = '<html><h—d><t™Ë>'. 
	`t
('OpenID„edirect') ."</title></head>\n<body>";

45 
$ouut
 .ğ
	`dru·l_g‘_fÜm
('İ’id_»dœeù_fÜm', 
$u¾
, 
$mes§ge
);

46 
$ouut
 .= '<scriptype="text/javascript">document.getElementById("openid-redirect-form").submit();</script>';

47 
$ouut
 .= "</body></html>\n";

48 
´št
 
$ouut
;

49 
ex™
;

50 
	}
}

52 
funùiÚ
 
	$İ’id_»dœeù_fÜm
(&
$fÜm_¡©e
, 
$u¾
, 
$mes§ge
) {

53 
$fÜm
 = 
	`¬¿y
();

54 
$fÜm
['#aùiÚ'] = 
$u¾
;

55 
$fÜm
['#method'] = "post";

56 
	`fÜ—ch
 (
$mes§ge
 
as
 
$key
 => 
$v®ue
) {

57 
$fÜm
[
$key
] = 
	`¬¿y
(

59 '#Çme' => 
$key
,

60 '#v®ue' => 
$v®ue
,

63 
$fÜm
['subm™'] = 
	`¬¿y
(

67 '#v®ue' => 
	`t
('Send'),

70  
$fÜm
;

71 
	}
}

76 
funùiÚ
 
	$_İ’id_is_xri
(
$id’tif›r
) {

78 ià(
	`¡½os
(
	`¡¹Şow”
(
$id’tif›r
), 'xri://'è!=ğ
FALSE
) {

79 
$id’tif›r
 = 
	`sub¡r
($identifier, 6);

83 
$fœ¡ch¬
 = 
	`sub¡r
(
$id’tif›r
, 0, 1);

84 ià(
	`¡½os
("=@+$!(", 
$fœ¡ch¬
è!=ğ
FALSE
) {

85  
TRUE
;

88  
FALSE
;

89 
	}
}

94 
funùiÚ
 
	$_İ’id_nÜm®ize
(
$id’tif›r
) {

95 ià(
	`_İ’id_is_xri
(
$id’tif›r
)) {

96  
	`_İ’id_nÜm®ize_xri
(
$id’tif›r
);

99  
	`_İ’id_nÜm®ize_u¾
(
$id’tif›r
);

101 
	}
}

103 
funùiÚ
 
	$_İ’id_nÜm®ize_xri
(
$xri
) {

104 
$nÜm®ized_xri
 = 
$xri
;

105 ià(
	`¡ri¡r
(
$xri
, 'xri://'è!=ğ
FALSE
) {

106 
$nÜm®ized_xri
 = 
	`sub¡r
(
$xri
, 6);

108  
$nÜm®ized_xri
;

109 
	}
}

111 
funùiÚ
 
	$_İ’id_nÜm®ize_u¾
(
$u¾
) {

112 
$nÜm®ized_u¾
 = 
$u¾
;

114 ià(
	`¡ri¡r
(
$u¾
, '://'è==ğ
FALSE
) {

115 
$nÜm®ized_u¾
 = 'h‰p://'. 
$u¾
;

119 
$nÜm®ized_u¾
 = 
	`¡¹ok
($normalized_url, '#');

121 ià(
	`sub¡r_couÁ
(
$nÜm®ized_u¾
, '/') < 3) {

122 
$nÜm®ized_u¾
 .= '/';

125  
$nÜm®ized_u¾
;

126 
	}
}

131 
funùiÚ
 
	$_İ’id_ü—‹_mes§ge
(
$d©a
) {

132 
$£rŸlized
 = '';

134 
	`fÜ—ch
 (
$d©a
 
as
 
$key
 => 
$v®ue
) {

135 ià((
	`¡½os
(
$key
, ':'è!=ğ
FALSE
è|| (¡½os($key, "\n"è!=ğFALSEè|| (¡½os(
$v®ue
, "\n") !== FALSE)) {

136  
nuÎ
;

138 
$£rŸlized
 .= "$key:$value\n";

140  
$£rŸlized
;

141 
	}
}

146 
funùiÚ
 
	$_İ’id_’code_mes§ge
(
$mes§ge
) {

147 
$’coded_mes§ge
 = '';

149 
$™ems
 = 
	`ex¶ode
("\n", 
$mes§ge
);

150 
	`fÜ—ch
 (
$™ems
 
as
 
$™em
) {

151 
$·¹s
 = 
	`ex¶ode
(':', 
$™em
, 2);

153 ià(
	`couÁ
(
$·¹s
) == 2) {

154 ià(
$’coded_mes§ge
 != '') {

155 
$’coded_mes§ge
 .= '&';

157 
$’coded_mes§ge
 .ğ
	`¿wu¾’code
(
	`Œim
(
$·¹s
[0])) .'='.„awurlencode(trim($parts[1]));

161  
$’coded_mes§ge
;

162 
	}
}

168 
funùiÚ
 
	$_İ’id_·r£_mes§ge
(
$mes§ge
) {

169 
$·r£d_mes§ge
 = 
	`¬¿y
();

171 
$™ems
 = 
	`ex¶ode
("\n", 
$mes§ge
);

172 
	`fÜ—ch
 (
$™ems
 
as
 
$™em
) {

173 
$·¹s
 = 
	`ex¶ode
(':', 
$™em
, 2);

175 ià(
	`couÁ
(
$·¹s
) == 2) {

176 
$·r£d_mes§ge
[
$·¹s
[0]] = $parts[1];

180  
$·r£d_mes§ge
;

181 
	}
}

186 
funùiÚ
 
	$_İ’id_nÚû
() {

188  
	`gm¡ráime
('%Y-%m-%dT%H:%M:%S%Z') .

189 
	`chr
(
	`mt_¿nd
(0, 25) + 65) .

190 
	`chr
(
	`mt_¿nd
(0, 25) + 65) .

191 
	`chr
(
	`mt_¿nd
(0, 25) + 65) .

192 
	`chr
(
	`mt_¿nd
(0, 25) + 65);

193 
	}
}

198 
funùiÚ
 
	$_İ’id_lšk_h»f
(
$»l
, 
$html
) {

199 
$»l
 = 
	`´eg_quÙe
($rel);

200 
	`´eg_m©ch
('|<lšk\s+»l=["\'](.*)'. 
$»l
 .'(.*)["\'](.*)/?>|iUs', 
$html
, 
$m©ches
);

201 ià(
	`is£t
(
$m©ches
[3])) {

202 
	`´eg_m©ch
('|h»f=["\']([^"]+)["\']|iU', 
$m©ches
[3], 
$h»f
);

203  
	`Œim
(
$h»f
[1]);

205  
FALSE
;

206 
	}
}

211 
funùiÚ
 
	$_İ’id_m‘a_h‰³quiv
(
$equiv
, 
$html
) {

212 
	`´eg_m©ch
('|<m‘a\s+h‰p-equiv=["\']'. 
$equiv
 .'["\'](.*)/?>|iUs', 
$html
, 
$m©ches
);

213 ià(
	`is£t
(
$m©ches
[1])) {

214 
	`´eg_m©ch
('|cÚ‹Á=["\']([^"]+)["\']|iUs', 
$m©ches
[1], 
$cÚ‹Á
);

215 ià(
	`is£t
(
$cÚ‹Á
[1])) {

216  
$cÚ‹Á
[1];

219  
FALSE
;

220 
	}
}

230 
funùiÚ
 
	$_İ’id_sigÇtu»
(
$assocŸtiÚ
, 
$mes§ge_¬¿y
, 
$keys_to_sign
) {

231 
$sigÇtu»
 = '';

232 
$sign_d©a
 = 
	`¬¿y
();

234 
	`fÜ—ch
 (
$keys_to_sign
 
as
 
$key
) {

235 ià(
	`is£t
(
$mes§ge_¬¿y
['İ’id.'. 
$key
])) {

236 
$sign_d©a
[
$key
] = 
$mes§ge_¬¿y
['openid.'. $key];

240 
$mes§ge
 = 
	`_İ’id_ü—‹_mes§ge
(
$sign_d©a
);

241 
$£ü‘
 = 
	`ba£64_decode
(
$assocŸtiÚ
->
mac_key
);

242 
$sigÇtu»
 = 
	`_İ’id_hmac
(
$£ü‘
, 
$mes§ge
);

244  
	`ba£64_’code
(
$sigÇtu»
);

245 
	}
}

247 
funùiÚ
 
	$_İ’id_hmac
(
$key
, 
$‹xt
) {

248 ià(
	`¡¾’
(
$key
è> 
OPENID_SHA1_BLOCKSIZE
) {

249 
$key
 = 
	`_İ’id_sha1
($key, 
Œue
);

252 
$key
 = 
	`¡r_·d
($key, 
OPENID_SHA1_BLOCKSIZE
, 
	`chr
(0x00));

253 
$ad
 = 
	`¡r_»³©
(
	`chr
(0x36), 
OPENID_SHA1_BLOCKSIZE
);

254 
$İad
 = 
	`¡r_»³©
(
	`chr
(0x5c), 
OPENID_SHA1_BLOCKSIZE
);

255 
$hash1
 = 
	`_İ’id_sha1
((
$key
 ^ 
$ad
è. 
$‹xt
, 
Œue
);

256 
$hmac
 = 
	`_İ’id_sha1
((
$key
 ^ 
$İad
è. 
$hash1
, 
Œue
);

258  
$hmac
;

259 
	}
}

261 
funùiÚ
 
	$_İ’id_sha1
(
$‹xt
) {

262 
$hex
 = 
	`sha1
(
$‹xt
);

263 
$¿w
 = '';

264 
$i
 = 0; $i < 40; $i += 2) {

265 
$hexcode
 = 
	`sub¡r
(
$hex
, 
$i
, 2);

266 
$ch¬code
 = ()
	`ba£_cÚv”t
(
$hexcode
, 16, 10);

267 
$¿w
 .ğ
	`chr
(
$ch¬code
);

269  
$¿w
;

270 
	}
}

272 
funùiÚ
 
	$_İ’id_dh_ba£64_to_lÚg
(
$¡r
) {

273 
$b64
 = 
	`ba£64_decode
(
$¡r
);

275  
	`_İ’id_dh_bš¬y_to_lÚg
(
$b64
);

276 
	}
}

278 
funùiÚ
 
	$_İ’id_dh_lÚg_to_ba£64
(
$¡r
) {

279  
	`ba£64_’code
(
	`_İ’id_dh_lÚg_to_bš¬y
(
$¡r
));

280 
	}
}

282 
funùiÚ
 
	$_İ’id_dh_bš¬y_to_lÚg
(
$¡r
) {

283 
$by‹s
 = 
	`¬¿y_m”ge
(
	`uÅack
('C*', 
$¡r
));

285 
$n
 = 0;

286 
	`fÜ—ch
 (
$by‹s
 
as
 
$by‹
) {

287 
$n
 = 
	`bcmul
($n, 
	`pow
(2, 8));

288 
$n
 = 
	`bÿdd
($n, 
$by‹
);

291  
$n
;

292 
	}
}

294 
funùiÚ
 
	$_İ’id_dh_lÚg_to_bš¬y
(
$lÚg
) {

295 
$cmp
 = 
	`bccomp
(
$lÚg
, 0);

296 ià(
$cmp
 < 0) {

297  
FALSE
;

300 ià(
$cmp
 == 0) {

304 
$by‹s
 = 
	`¬¿y
();

306 
	`bccomp
(
$lÚg
, 0) > 0) {

307 
	`¬¿y_unshiá
(
$by‹s
, 
	`bcmod
(
$lÚg
, 256));

308 
$lÚg
 = 
	`bcdiv
($lÚg, 
	`pow
(2, 8));

311 ià(
$by‹s
 && ($bytes[0] > 127)) {

312 
	`¬¿y_unshiá
(
$by‹s
, 0);

315 
$¡ršg
 = '';

316 
	`fÜ—ch
 (
$by‹s
 
as
 
$by‹
) {

317 
$¡ršg
 .ğ
	`·ck
('C', 
$by‹
);

320  
$¡ršg
;

321 
	}
}

323 
funùiÚ
 
	$_İ’id_dh_xÜ£ü‘
(
$sh¬ed
, 
$£ü‘
) {

324 
$dh_sh¬ed_¡r
 = 
	`_İ’id_dh_lÚg_to_bš¬y
(
$sh¬ed
);

325 
$sha1_dh_sh¬ed
 = 
	`_İ’id_sha1
(
$dh_sh¬ed_¡r
);

326 
$x£ü‘
 = "";

327 
$i
 = 0; $˜< 
	`¡¾’
(
$£ü‘
); $i++) {

328 
$x£ü‘
 .ğ
	`chr
(
	`Üd
(
$£ü‘
[
$i
]è^ ord(
$sha1_dh_sh¬ed
[$i]));

331  
$x£ü‘
;

332 
	}
}

334 
funùiÚ
 
	$_İ’id_dh_¿nd
(
$¡İ
) {

335 
$du¶iÿ‹_ÿche
 = 
	`¬¿y
();

338 
$rby‹s
 = 
	`_İ’id_dh_lÚg_to_bš¬y
(
$¡İ
);

340 ià(
	`¬¿y_key_exi¡s
(
$rby‹s
, 
$du¶iÿ‹_ÿche
)) {

341 
	`li¡
(
$du¶iÿ‹
, 
$nby‹s
èğ
$du¶iÿ‹_ÿche
[
$rby‹s
];

344 ià(
$rby‹s
[0] == "\x00") {

345 
$nby‹s
 = 
	`¡¾’
(
$rby‹s
) - 1;

348 
$nby‹s
 = 
	`¡¾’
(
$rby‹s
);

351 
$mx¿nd
 = 
	`bıow
(256, 
$nby‹s
);

355 
$du¶iÿ‹
 = 
	`bcmod
(
$mx¿nd
, 
$¡İ
);

357 ià(
	`couÁ
(
$du¶iÿ‹_ÿche
) > 10) {

358 
$du¶iÿ‹_ÿche
 = 
	`¬¿y
();

361 
$du¶iÿ‹_ÿche
[
$rby‹s
] = 
	`¬¿y
(
$du¶iÿ‹
, 
$nby‹s
);

365 
$by‹s
 = "\x00". 
	`_İ’id_g‘_by‹s
(
$nby‹s
);

366 
$n
 = 
	`_İ’id_dh_bš¬y_to_lÚg
(
$by‹s
);

368 } 
	`bccomp
(
$n
, 
$du¶iÿ‹
) < 0);

370  
	`bcmod
(
$n
, 
$¡İ
);

371 
	}
}

373 
funùiÚ
 
	$_İ’id_g‘_by‹s
(
$num_by‹s
) {

374 
$f
 = 
nuÎ
;

375 
$by‹s
 = '';

376 ià(!
	`is£t
(
$f
)) {

377 
$f
 = @
	`fİ’
(
OPENID_RAND_SOURCE
, "r");

379 ià(!
$f
) {

381 
$by‹s
 = '';

382 
$i
 = 0; $˜< 
$num_by‹s
; $i += 4) {

383 
$by‹s
 .ğ
	`·ck
('L', 
	`mt_¿nd
());

385 
$by‹s
 = 
	`sub¡r
($by‹s, 0, 
$num_by‹s
);

388 
$by‹s
 = 
	`ä—d
(
$f
, 
$num_by‹s
);

390  
$by‹s
;

391 
	}
}

393 
funùiÚ
 
	$_İ’id_»¥Ú£
(
$¡r
 = 
NULL
) {

394 
$d©a
 = 
	`¬¿y
();

396 ià(
	`is£t
(
$_SERVER
['REQUEST_METHOD'])) {

397 
$d©a
 = 
	`_İ’id_g‘_·¿ms
(
$_SERVER
['QUERY_STRING']);

399 ià(
$_SERVER
['REQUEST_METHOD'] == 'POST') {

400 
$¡r
 = 
	`fe_g‘_cÚ‹Ás
('php://input');

402 
$po¡
 = 
	`¬¿y
();

403 ià(
$¡r
 !=ğ
çl£
) {

404 
$po¡
 = 
	`_İ’id_g‘_·¿ms
(
$¡r
);

407 
$d©a
 = 
	`¬¿y_m”ge
($d©a, 
$po¡
);

411  
$d©a
;

412 
	}
}

414 
funùiÚ
 
	$_İ’id_g‘_·¿ms
(
$¡r
) {

415 
$chunks
 = 
	`ex¶ode
("&", 
$¡r
);

417 
$d©a
 = 
	`¬¿y
();

418 
	`fÜ—ch
 (
$chunks
 
as
 
$chunk
) {

419 
$·¹s
 = 
	`ex¶ode
("=", 
$chunk
, 2);

421 ià(
	`couÁ
(
$·¹s
) == 2) {

422 
	`li¡
(
$k
, 
$v
èğ
$·¹s
;

423 
$d©a
[
$k
] = 
	`u¾decode
(
$v
);

426  
$d©a
;

427 
	}
}

432 ià(!
funùiÚ_exi¡s
('bcpowmod')) {

433 
funùiÚ
 
bıowmod
(
$ba£
, 
$exp
, 
$mod
) {

434 
	g$squ¬e
 = 
bcmod
(
$ba£
, 
$mod
);

435 
	g$»suÉ
 = 1;

436 
bccomp
(
$exp
, 0) > 0) {

437 ià(
bcmod
(
$exp
, 2)) {

438 
	g$»suÉ
 = 
bcmod
(
bcmul
(
$»suÉ
, 
$squ¬e
), 
$mod
);

440 
	g$squ¬e
 = 
bcmod
(
bcmul
(
$squ¬e
, $squ¬e), 
$mod
);

441 
	g$exp
 = 
bcdiv
(
$exp
, 2);

443  
	g$»suÉ
;

	@/srv/http/subs/notes/www/modules/openid/openid.module

1 <?
php


12 
funùiÚ
 
	$İ’id_m’u
() {

13 
$™ems
['İ’id/auth’tiÿ‹'] = 
	`¬¿y
(

17 'ty³' => 
MENU_CALLBACK
,

20 
$™ems
['u£r/%u£r/İ’id'] = 
	`¬¿y
(

23 '·g¬gum’ts' => 
	`¬¿y
(1),

25 'acûs ¬gum’ts' => 
	`¬¿y
(1),

26 'ty³' => 
MENU_LOCAL_TASK
,

29 
$™ems
['u£r/%u£r/İ’id/d–‘e'] = 
	`¬¿y
(

32 '·g¬gum’ts' => 
	`¬¿y
('openid_user_delete_form', 1),

34 'acûs ¬gum’ts' => 
	`¬¿y
(1),

35 'ty³' => 
MENU_CALLBACK
,

38  
$™ems
;

39 
	}
}

44 
funùiÚ
 
	$İ’id_h–p
(
$·th
, 
$¬g
) {

45 
$·th
) {

47 
$ouut
 = '<p>'. 
	`t
('Thi s™suµÜt <¨h»f="@İ’id-Ãt">O³nID</a>,‡ secu» wayØlog iÁØmªy webs™e usšg‡ sšgË u£ºamªd…asswÜd. O³nID cª„eduûhÃûss™y oàmªagšg mªy u£ºame ªd…asswÜd fÜ mªy webs™es.', 
	`¬¿y
('@openid-net' => 'http://openid.net')) .'</p>';

48 
$ouut
 .ğ'<p>'. 
	`t
('TØu£ O³nID you mu¡ fœ¡ƒ¡ablish‡Àid’t™y oÀ¨publiøÜ…riv©O³nID s”v”. Iàyou dØnÙ havª O³nID‡nd would†ikÚe,†ook iÁØÚoàth<¨h»f="@İ’id-´ovid”s">ä“…ubliø´ovid”s</a>. You cª fšd ouˆmÜabouˆO³nID‡ˆ<¨h»f="@İ’id-Ãt">thi webs™e</a>.', 
	`¬¿y
('@openid-providers' => 'http://openid.net/get/', '@openid-net' => 'http://openid.net')) .'</p>';

49 
$ouut
 .ğ'<p>'. 
	`t
('If you‡lready have‡n OpenID,ƒnterhe URLo your OpenID server below (e.g. myusername.openidprovider.com). Nextime you†ogin, you will be‡bleo usehis URL instead of‡„egular username‡nd…assword. You can have multiple OpenID servers if you†ike; just keep‡ddinghem here.') .'</p>';

50  
$ouut
;

53 
$ouut
 = '<p>'. 
	`t
('OpenID is‡ secure method for†ogging into many websites with‡ single username‡nd…assword. It does‚ot„equire special software,‡nd it does‚ot share…asswords with‡ny siteo which it is‡ssociated; including your site.') .'</p>';

54 
$ouut
 .ğ'<p>'. 
	`t
('Users can create‡ccounts usingheir OpenID,‡ssign one or more OpenIDso‡nƒxisting‡ccount,‡nd†og in using‡n OpenID. This†owershe barriero„egistration, which is good forhe site,‡nd offers convenience‡nd securityohe users. OpenID is‚ot‡rust system, soƒmail verification is still‚ecessary. The benefit stems fromhe facthat users can have‡ single…asswordhathey can use on many websites. This meanshey canƒasily updateheir single…assword from‡ centralized†ocation,„atherhan havingo change dozens of…asswords individually.') .'</p>';

55 
$ouut
 .ğ'<p>'. 
	`t
('The basic concept is‡s follows: A user has‡n‡ccount on‡n OpenID server. This‡ccount…rovideshem with‡ unique URL (such‡s myusername.openidprovider.com). Whenhe user comeso your site,hey‡re…resented withhe option ofƒnteringhis URL. Your sitehen communicates withhe OpenID server,‡sking ito verifyhe identity ofhe user. Ifhe user is†ogged intoheir OpenID server,he server communicates backo your site, verifyinghe user. Ifhey‡re‚ot†ogged in,he OpenID server will‡skhe user forheir…assword. At‚o…oint does your site„ecord, or‚eedo„ecordhe user\'s…assword.') .'</p>';

56 
$ouut
 .ğ'<p>'. 
	`t
('MÜšfÜm©iÚ oÀO³nID i avaabË‡ˆ<¨h»f="@İ’id-Ãt">O³nID.Ãt</a>.', 
	`¬¿y
('@İ’id-Ãt' => 
	`u¾
('http://openid.net'))) .'</p>';

57 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@hªdbook">O³nID moduË</a>.', 
	`¬¿y
('@handbook' => 'http://drupal.org/handbook/modules/openid')) .'</p>';

58  
$ouut
;

60 
	}
}

65 
funùiÚ
 
	$İ’id_u£r
(
$İ
, &
$ed™
, &
$accouÁ
, 
$ÿ‹gÜy
 = 
NULL
) {

66 ià(
$İ
 =ğ'š£¹' && 
	`is£t
(
$_SESSION
['openid']['values'])) {

68 ià(
	`v¬ŸbË_g‘
('u£r_ema_v”ifiÿtiÚ', 
TRUE
)) {

69 
	`dru·l_£t_mes§ge
(
	`t
('Once you have verified yourƒmail‡ddress, you may†og in via OpenID.'));

71 
	`un£t
(
$_SESSION
['openid']);

73 
	}
}

78 
funùiÚ
 
	$İ’id_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

79 ià(
$fÜm_id
 == 'user_login_block' || $form_id == 'user_login') {

80 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'openid') .'/openid.css', 'module');

81 
	`dru·l_add_js
(
	`dru·l_g‘_·th
('module', 'openid') .'/openid.js');

82 ià(!
	`em±y
(
$fÜm_¡©e
['post']['openid_identifier'])) {

83 
$fÜm
['Çme']['#»quœed'] = 
FALSE
;

84 
$fÜm
['·ss']['#»quœed'] = 
FALSE
;

85 
	`un£t
(
$fÜm
['#submit']);

86 
$fÜm
['#v®id©e'] = 
	`¬¿y
('openid_login_validate');

89 
$™ems
 = 
	`¬¿y
();

90 
$™ems
[] = 
	`¬¿y
(

91 'd©a' => 
	`l
(
	`t
('Log in using OpenID'), '#'),

94 
$™ems
[] = 
	`¬¿y
(

95 'd©a' => 
	`l
(
	`t
('Cancel OpenID†ogin'), '#'),

99 
$fÜm
['İ’id_lšks'] = 
	`¬¿y
(

100 '#v®ue' => 
	`theme
('™em_li¡', 
$™ems
),

104 
$fÜm
['links']['#weight'] = 2;

106 
$fÜm
['İ’id_id’tif›r'] = 
	`¬¿y
(

108 '#t™Ë' => 
	`t
('Log in using OpenID'),

109 '#size' => (
$fÜm_id
 == 'user_login') ? 58 : 13,

112 '#desütiÚ' => 
	`l
(
	`t
('Wh© i O³nID?'), 'h‰p://İ’id.Ãt/', 
	`¬¿y
('ex‹º®' => 
TRUE
)),

114 
$fÜm
['İ’id.»tuº_to'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
	`u¾
('İ’id/auth’tiÿ‹',‡¼ay('absŞu‹' => 
TRUE
, 'qu”y' => 
	`u£r_logš_de¡š©iÚ
())));

116 
	`–£if
 (
$fÜm_id
 =ğ'u£r_»gi¡”' && 
	`is£t
(
$_SESSION
['openid']['values'])) {

119 
$fÜm
['Çme']['#deçuÉ_v®ue'] = 
$_SESSION
['openid']['values']['name'];

120 
$fÜm
['ma']['#deçuÉ_v®ue'] = 
$_SESSION
['openid']['values']['mail'];

123 ià(!
	`v¬ŸbË_g‘
('u£r_ema_v”ifiÿtiÚ', 
TRUE
)) {

124 
$fÜm
['pass']['#type'] = 'hidden';

125 
$fÜm
['·ss']['#v®ue'] = 
	`u£r_·sswÜd
();

127 
$fÜm
['auth_İ’id'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$_SESSION
['openid']['values']['auth_openid']);

128 
$fÜm
['İ’id_di¥Ïy'] = 
	`¬¿y
(

130 '#t™Ë' => 
	`t
('Your OpenID'),

131 '#desütiÚ' => 
	`t
('This OpenID will be‡ttachedo your‡ccount‡fter„egistration.'),

132 '#v®ue' => 
	`check_¶aš
(
$_SESSION
['openid']['values']['auth_openid']),

135  
$fÜm
;

136 
	}
}

141 
funùiÚ
 
	$İ’id_logš_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

142 
$»tuº_to
 = 
$fÜm_¡©e
['values']['openid.return_to'];

143 ià(
	`em±y
(
$»tuº_to
)) {

144 
$»tuº_to
 = 
	`u¾
('', 
	`¬¿y
('absŞu‹' => 
TRUE
));

147 
	`İ’id_begš
(
$fÜm_¡©e
['v®ues']['İ’id_id’tif›r'], 
$»tuº_to
, $form_state['values']);

148 
	}
}

160 
funùiÚ
 
İ’id_begš
(
$şaimed_id
, 
$»tuº_to
 = '', 
$fÜm_v®ues
 = 
	$¬¿y
()) {

161 
	`moduË_lßd_šşude
('inc', 'openid');

163 
$şaimed_id
 = 
	`_İ’id_nÜm®ize
($claimed_id);

165 
$£rviûs
 = 
	`İ’id_discov”y
(
$şaimed_id
);

166 ià(
	`couÁ
(
$£rviûs
) == 0) {

167 
	`fÜm_£t_”rÜ
('İ’id_id’tif›r', 
	`t
('Sorry,hat is‚ot‡ valid OpenID. Pleaseƒnsure you have spelled your ID correctly.'));

172 
$_SESSION
['İ’id']['£rviû'] = 
$£rviûs
[0];

174 
$_SESSION
['İ’id']['şaimed_id'] = 
$şaimed_id
;

177 
$_SESSION
['İ’id']['u£r_logš_v®ues'] = 
$fÜm_v®ues
;

179 
$İ_’dpošt
 = 
$£rviûs
[0]['uri'];

181 
$assoc_hªdË
 = '';

182 ià(
	`funùiÚ_exi¡s
('bcadd')) {

183 
$assoc_hªdË
 = 
	`İ’id_assocŸtiÚ
(
$İ_’dpošt
);

190 ià(!
	`em±y
(
$£rviûs
[0]['localid'])) {

191 
$id’t™y
 = 
$£rviûs
[0]['localid'];

193 ià(!
	`em±y
(
$£rviûs
[0]['delegate'])) {

194 
$id’t™y
 = 
$£rviûs
[0]['delegate'];

197 
$id’t™y
 = 
$şaimed_id
;

200 ià(
	`is£t
(
$£rviûs
[0]['ty³s']è&& 
	`is_¬¿y
($£rviûs[0]['ty³s']è&& 
	`š_¬¿y
(
OPENID_NS_2_0
 .'/server', $services[0]['types'])) {

201 
$şaimed_id
 = 
$id’t™y
 = 'http://specs.openid.net/auth/2.0/identifier_select';

203 
$authn_»que¡
 = 
	`İ’id_auth’tiÿtiÚ_»que¡
(
$şaimed_id
, 
$id’t™y
, 
$»tuº_to
, 
$assoc_hªdË
, 
$£rviûs
[0]['version']);

205 ià(
$£rviûs
[0]['version'] == 2) {

206 
	`İ’id_»dœeù
(
$İ_’dpošt
, 
$authn_»que¡
);

209 
	`İ’id_»dœeù_h‰p
(
$İ_’dpošt
, 
$authn_»que¡
);

211 
	}
}

222 
funùiÚ
 
İ’id_com¶‘e
(
$»¥Ú£
 = 
	$¬¿y
()) {

223 
glob®
 
$ba£_u¾
;

224 
	`moduË_lßd_šşude
('inc', 'openid');

226 ià(
	`couÁ
(
$»¥Ú£
) == 0) {

227 
$»¥Ú£
 = 
	`_İ’id_»¥Ú£
();

231 
$»¥Ú£
['status'] = 'failed';

232 ià(
	`is£t
(
$_SESSION
['openid']['service']['uri']) && isset($_SESSION['openid']['claimed_id'])) {

233 
$£rviû
 = 
$_SESSION
['openid']['service'];

234 
$şaimed_id
 = 
$_SESSION
['openid']['claimed_id'];

235 
	`un£t
(
$_SESSION
['openid']['service']);

236 
	`un£t
(
$_SESSION
['openid']['claimed_id']);

237 ià(
	`is£t
(
$»¥Ú£
['openid.mode'])) {

238 ià(
$»¥Ú£
['openid.mode'] == 'cancel') {

239 
$»¥Ú£
['status'] = 'cancel';

242 ià(
	`İ’id_v”ify_as£¹iÚ
(
$£rviû
, 
$»¥Ú£
)) {

245 ià(
$£rviû
['v”siÚ'] =ğ2 && 
$»¥Ú£
['İ’id.şaimed_id'] !ğ
$şaimed_id
) {

246 
$disco
 = 
	`İ’id_discov”y
(
$»¥Ú£
['openid.claimed_id']);

247 ià(
$disco
[0]['uri'] !ğ
$£rviû
['uri']) {

248  
$»¥Ú£
;

252 
$»¥Ú£
['İ’id.şaimed_id'] = 
$şaimed_id
;

259 
$»tuº_to_·¹s
 = 
	`·r£_u¾
(
$»¥Ú£
['openid.return_to']);

261 
$ba£_u¾_·¹s
 = 
	`·r£_u¾
(
$ba£_u¾
);

262 
$cu¼’t_·¹s
 = 
	`·r£_u¾
(
$ba£_u¾_·¹s
['scheme'] .'://'. $ba£_u¾_·¹s['ho¡'] . 
	`»que¡_uri
());

264 ià(
$»tuº_to_·¹s
['scheme'] !ğ
$cu¼’t_·¹s
['scheme'] ||

265 
$»tuº_to_·¹s
['ho¡'] !ğ
$cu¼’t_·¹s
['host'] ||

266 
$»tuº_to_·¹s
['·th'] !ğ
$cu¼’t_·¹s
['path']) {

268  
$»¥Ú£
;

273 
	`·r£_¡r
(
	`is£t
(
$»tuº_to_·¹s
['qu”y']è? $»tuº_to_·¹s['qu”y'] : '', 
$»tuº_to_qu”y_·¿m‘”s
);

274 
	`fÜ—ch
 (
$»tuº_to_qu”y_·¿m‘”s
 
as
 
$Çme
 => 
$v®ue
) {

275 ià(!
	`¬¿y_key_exi¡s
(
$Çme
, 
$_GET
è|| $_GET[$Çme] !ğ
$v®ue
) {

276  
$»¥Ú£
;

279 
$»¥Ú£
['status'] = 'success';

284  
$»¥Ú£
;

285 
	}
}

295 
funùiÚ
 
	$İ’id_discov”y
(
$şaimed_id
) {

296 
	`moduË_lßd_šşude
('inc', 'openid');

297 
	`moduË_lßd_šşude
('inc', 'openid', 'xrds');

299 
$£rviûs
 = 
	`¬¿y
();

301 
$xrds_u¾
 = 
$şaimed_id
;

302 ià(
	`_İ’id_is_xri
(
$şaimed_id
)) {

303 
$xrds_u¾
 = 'h‰p://xri.Ãt/'. 
$şaimed_id
;

305 
$u¾
 = @
	`·r£_u¾
(
$xrds_u¾
);

306 ià(
$u¾
['scheme'] == 'http' || $url['scheme'] == 'https') {

308 
$h—d”s
 = 
	`¬¿y
('Accept' => 'application/xrds+xml');

309 
$»suÉ
 = 
	`dru·l_h‰p_»que¡
(
$xrds_u¾
, 
$h—d”s
);

311 ià(!
	`is£t
(
$»suÉ
->
”rÜ
)) {

312 ià(
	`is£t
(
$»suÉ
->
h—d”s
['CÚ‹Á-Ty³']è&& 
	`´eg_m©ch
("/application\/xrds\+xml/", $result->headers['Content-Type'])) {

314 
$£rviûs
 = 
	`xrds_·r£
(
$»suÉ
->
d©a
);

317 
$xrds_u¾
 = 
NULL
;

318 ià(
	`is£t
(
$»suÉ
->
h—d”s
['X-XRDS-Location'])) {

319 
$xrds_u¾
 = 
$»suÉ
->
h—d”s
['X-XRDS-Location'];

323 
$xrds_u¾
 = 
	`_İ’id_m‘a_h‰³quiv
('X-XRDS-LoÿtiÚ', 
$»suÉ
->
d©a
);

325 ià(!
	`em±y
(
$xrds_u¾
)) {

326 
$h—d”s
 = 
	`¬¿y
('Accept' => 'application/xrds+xml');

327 
$xrds_»suÉ
 = 
	`dru·l_h‰p_»que¡
(
$xrds_u¾
, 
$h—d”s
);

328 ià(!
	`is£t
(
$xrds_»suÉ
->
”rÜ
)) {

329 
$£rviûs
 = 
	`xrds_·r£
(
$xrds_»suÉ
->
d©a
);

335 ià(
	`couÁ
(
$£rviûs
) == 0) {

337 
$uri
 = 
	`_İ’id_lšk_h»f
('İ’id2.´ovid”', 
$»suÉ
->
d©a
);

338 
$d–eg©e
 = 
	`_İ’id_lšk_h»f
('İ’id2.loÿl_id', 
$»suÉ
->
d©a
);

339 
$v”siÚ
 = 2;

342 ià(
	`em±y
(
$uri
)) {

343 
$uri
 = 
	`_İ’id_lšk_h»f
('İ’id.£rv”', 
$»suÉ
->
d©a
);

344 
$d–eg©e
 = 
	`_İ’id_lšk_h»f
('İ’id.d–eg©e', 
$»suÉ
->
d©a
);

345 
$v”siÚ
 = 1;

347 ià(!
	`em±y
(
$uri
)) {

348 
$£rviûs
[] = 
	`¬¿y
('uri' => 
$uri
, 'd–eg©e' => 
$d–eg©e
, 'v”siÚ' => 
$v”siÚ
);

353  
$£rviûs
;

354 
	}
}

363 
funùiÚ
 
	$İ’id_assocŸtiÚ
(
$İ_’dpošt
) {

364 
	`moduË_lßd_šşude
('inc', 'openid');

367 
	`db_qu”y
("DELETE FROM {İ’id_assocŸtiÚ} WHERE c»©ed +ƒxpœes_š < %d", 
	`time
());

370 
$assoc_hªdË
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT‡ssoc_hªdË FROM {İ’id_assocŸtiÚ} WHERE idp_’dpošt_ur˜ğ'%s'", 
$İ_’dpošt
));

371 ià(
	`em±y
(
$assoc_hªdË
)) {

372 
$mod
 = 
OPENID_DH_DEFAULT_MOD
;

373 
$g’
 = 
OPENID_DH_DEFAULT_GEN
;

374 
$r
 = 
	`_İ’id_dh_¿nd
(
$mod
);

375 
$´iv©e
 = 
	`bÿdd
(
$r
, 1);

376 
$public
 = 
	`bıowmod
(
$g’
, 
$´iv©e
, 
$mod
);

379 
$assoc_»que¡
 = 
	`İ’id_assocŸtiÚ_»que¡
(
$public
);

380 
$assoc_mes§ge
 = 
	`_İ’id_’code_mes§ge
(
	`_İ’id_ü—‹_mes§ge
(
$assoc_»que¡
));

381 
$assoc_h—d”s
 = 
	`¬¿y
('Content-Type' => 'application/x-www-form-urlencoded; charset=utf-8');

382 
$assoc_»suÉ
 = 
	`dru·l_h‰p_»que¡
(
$İ_’dpošt
, 
$assoc_h—d”s
, 'POST', 
$assoc_mes§ge
);

383 ià(
	`is£t
(
$assoc_»suÉ
->
”rÜ
)) {

384  
FALSE
;

387 
$assoc_»¥Ú£
 = 
	`_İ’id_·r£_mes§ge
(
$assoc_»suÉ
->
d©a
);

388 ià(
	`is£t
(
$assoc_»¥Ú£
['mode']) && $assoc_response['mode'] == 'error') {

389  
FALSE
;

392 ià(
$assoc_»¥Ú£
['session_type'] == 'DH-SHA1') {

393 
$¥ub
 = 
	`_İ’id_dh_ba£64_to_lÚg
(
$assoc_»¥Ú£
['dh_server_public']);

394 
$’c_mac_key
 = 
	`ba£64_decode
(
$assoc_»¥Ú£
['enc_mac_key']);

395 
$sh¬ed
 = 
	`bıowmod
(
$¥ub
, 
$´iv©e
, 
$mod
);

396 
$assoc_»¥Ú£
['mac_key'] = 
	`ba£64_’code
(
	`_İ’id_dh_xÜ£ü‘
(
$sh¬ed
, 
$’c_mac_key
));

398 
	`db_qu”y
("INSERT INTO {openid_association} (idp_endpoint_uri, session_type,‡ssoc_handle,‡ssoc_type,ƒxpires_in, mac_key, created) VALUES('%s', '%s', '%s', '%s', %d, '%s', %d)",

399 
$İ_’dpošt
, 
$assoc_»¥Ú£
['£ssiÚ_ty³'], $assoc_»¥Ú£['assoc_hªdË'], $assoc_»¥Ú£['assoc_ty³'], $assoc_»¥Ú£['expœes_š'], $assoc_»¥Ú£['mac_key'], 
	`time
());

401 
$assoc_hªdË
 = 
$assoc_»¥Ú£
['assoc_handle'];

404  
$assoc_hªdË
;

405 
	}
}

412 
funùiÚ
 
	$İ’id_auth’tiÿtiÚ
(
$»¥Ú£
) {

413 
	`moduË_lßd_šşude
('inc', 'openid');

415 
$id’t™y
 = 
$»¥Ú£
['openid.claimed_id'];

417 
$accouÁ
 = 
	`u£r_ex‹º®_lßd
(
$id’t™y
);

418 ià(
	`is£t
(
$accouÁ
->
uid
)) {

419 ià(!
	`v¬ŸbË_g‘
('u£r_ema_v”ifiÿtiÚ', 
TRUE
è|| 
$accouÁ
->
logš
) {

420 
	`u£r_ex‹º®_logš
(
$accouÁ
, 
$_SESSION
['openid']['user_login_values']);

423 
	`dru·l_£t_mes§ge
(
	`t
('You must validate yourƒmail‡ddress forhis‡ccount before†ogging in via OpenID'));

426 
	`–£if
 (
	`v¬ŸbË_g‘
('user_register', 1)) {

428 
$fÜm_¡©e
['»dœeù'] = 
NULL
;

429 
$fÜm_¡©e
['v®ues']['Çme'] = (
	`em±y
(
$»¥Ú£
['openid.sreg.nickname'])) ? '' : $response['openid.sreg.nickname'];

430 
$fÜm_¡©e
['v®ues']['ma'] = (
	`em±y
(
$»¥Ú£
['openid.sreg.email'])) ? '' : $response['openid.sreg.email'];

431 
$fÜm_¡©e
['v®ues']['·ss'] = 
	`u£r_·sswÜd
();

432 
$fÜm_¡©e
['v®ues']['¡©us'] = 
	`v¬ŸbË_g‘
('user_register', 1) == 1;

433 
$fÜm_¡©e
['v®ues']['»¥Ú£'] = 
$»¥Ú£
;

434 
$fÜm_¡©e
['v®ues']['auth_İ’id'] = 
$id’t™y
;

436 ià(
	`em±y
(
$»¥Ú£
['openid.sreg.email']) &&ƒmpty($response['openid.sreg.nickname'])) {

437 
	`dru·l_£t_mes§ge
(
	`t
('PËa£ com¶‘th»gi¡¿tiÚ by flšg ouˆthfÜm b–ow. Iàyou‡Ì—dy havª‡ccouÁ, you cª <¨h»f="@logš">log in</a>‚ow‡nd‡dd you¸O³nID und” "My‡ccouÁ".', 
	`¬¿y
('@logš' => 
	`u¾
('user/login'))), 'warning');

438 
$sucûss
 = 
FALSE
;

441 
$fÜm
 = 
	`dru·l_»Œ›ve_fÜm
('u£r_»gi¡”', 
$fÜm_¡©e
);

442 
	`dru·l_´•¬e_fÜm
('u£r_»gi¡”', 
$fÜm
, 
$fÜm_¡©e
);

443 
	`dru·l_v®id©e_fÜm
('u£r_»gi¡”', 
$fÜm
, 
$fÜm_¡©e
);

444 
$sucûss
 = !
	`fÜm_g‘_”rÜs
();

445 ià(!
$sucûss
) {

446 
	`dru·l_£t_mes§ge
(
	`t
('AccouÁ„egi¡¿tiÚ usšghšfÜm©iÚ…rovided by you¸O³nID…rovid” faed dutØth»asÚ li¡ed b–ow. PËa£ com¶‘th»gi¡¿tiÚ by flšg ouˆthfÜm b–ow. Iàyou‡Ì—dy havª‡ccouÁ, you cª <¨h»f="@logš">log in</a>‚ow‡nd‡dd you¸O³nID und” "My‡ccouÁ".', 
	`¬¿y
('@logš' => 
	`u¾
('user/login'))), 'warning');

448 
$mes§ges
 = 
	`dru·l_g‘_mes§ges
('error');

449 
	`fÜ—ch
 (
$mes§ges
['”rÜ'] 
as
 
$mes§ge
) {

450 
	`dru·l_£t_mes§ge
Ğ
$mes§ge
, 'error');

454 ià(!
$sucûss
) {

457 
$_SESSION
['İ’id']['v®ues'] = 
$fÜm_¡©e
['values'];

459 
$de¡š©iÚ
 = 
	`dru·l_g‘_de¡š©iÚ
();

460 
	`un£t
(
$_REQUEST
['destination']);

461 
	`dru·l_gÙo
('u£r/»gi¡”', 
$de¡š©iÚ
);

464 
	`un£t
(
$fÜm_¡©e
['values']['response']);

465 
$accouÁ
 = 
	`u£r_§ve
('', 
$fÜm_¡©e
['values']);

467 ià(!
$accouÁ
) {

468 
	`dru·l_£t_mes§ge
(
	`t
("Error saving user‡ccount."), 'error');

469 
	`dru·l_gÙo
();

471 
	`u£r_ex‹º®_logš
(
$accouÁ
);

473 
	`dru·l_»dœeù_fÜm
(
$fÜm
, 
$fÜm_¡©e
['redirect']);

476 
	`dru·l_£t_mes§ge
(
	`t
('Only site‡dministrators can create‚ew user‡ccounts.'), 'error');

478 
	`dru·l_gÙo
();

479 
	}
}

481 
funùiÚ
 
	$İ’id_assocŸtiÚ_»que¡
(
$public
) {

482 
	`moduË_lßd_šşude
('inc', 'openid');

484 
$»que¡
 = 
	`¬¿y
(

485 'İ’id.ns' => 
OPENID_NS_2_0
,

491 ià(
$»que¡
['openid.session_type'] == 'DH-SHA1' || $request['openid.session_type'] == 'DH-SHA256') {

492 
$ıub
 = 
	`_İ’id_dh_lÚg_to_ba£64
(
$public
);

493 
$»que¡
['İ’id.dh_cÚsum”_public'] = 
$ıub
;

496  
$»que¡
;

497 
	}
}

499 
funùiÚ
 
İ’id_auth’tiÿtiÚ_»que¡
(
$şaimed_id
, 
$id’t™y
, 
$»tuº_to
 = '', 
$assoc_hªdË
 = '', 
$v”siÚ
 = 2) {

500 
moduË_lßd_šşude
('inc', 'openid');

502 
	g$ns
 = (
$v”siÚ
 =ğ2è? 
OPENID_NS_2_0
 : 
OPENID_NS_1_0
;

503 
	g$»que¡
 = 
¬¿y
(

504 'İ’id.ns' => 
$ns
,

506 'İ’id.id’t™y' => 
$id’t™y
,

507 'İ’id.şaimed_id' => 
$şaimed_id
,

508 'İ’id.assoc_hªdË' => 
$assoc_hªdË
,

509 'İ’id.»tuº_to' => 
$»tuº_to
,

512 ià(
	g$v”siÚ
 == 2) {

513 
$»que¡
['İ’id.»®m'] = 
u¾
('', 
¬¿y
('absŞu‹' => 
TRUE
));

516 
	g$»que¡
['İ’id.Œu¡_roÙ'] = 
u¾
('', 
¬¿y
('absŞu‹' => 
TRUE
));

520 
	g$»que¡
['openid.sreg.required'] = 'nickname,email';

521 
	g$»que¡
['openid.ns.sreg'] = "http://openid.net/extensions/sreg/1.1";

523 
	g$»que¡
 = 
¬¿y_m”ge
(
$»que¡
, 
moduË_švoke_®l
('openid', 'request', $request));

525  
	g$»que¡
;

538 
funùiÚ
 
	$İ’id_v”ify_as£¹iÚ
(
$£rviû
, 
$»¥Ú£
) {

539 
	`moduË_lßd_šşude
('inc', 'openid');

543 ià(!
	`İ’id_v”ify_as£¹iÚ_nÚû
(
$£rviû
, 
$»¥Ú£
)) {

544  
FALSE
;

549 
$v®id
 = 
FALSE
;

550 
$assocŸtiÚ
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT * FROM {İ’id_assocŸtiÚ} WHERE‡ssoc_hªdË = '%s'", 
$»¥Ú£
['openid.assoc_handle']));

551 ià(
$assocŸtiÚ
 && 
	`is£t
($assocŸtiÚ->
£ssiÚ_ty³
)) {

554 
$v®id
 = 
	`İ’id_v”ify_as£¹iÚ_sigÇtu»
(
$£rviû
, 
$assocŸtiÚ
, 
$»¥Ú£
);

559 
$»que¡
 = 
$»¥Ú£
;

560 
$»que¡
['openid.mode'] = 'check_authentication';

561 
$mes§ge
 = 
	`_İ’id_ü—‹_mes§ge
(
$»que¡
);

562 
$h—d”s
 = 
	`¬¿y
('Content-Type' => 'application/x-www-form-urlencoded; charset=utf-8');

563 
$»suÉ
 = 
	`dru·l_h‰p_»que¡
(
$£rviû
['uri'], 
$h—d”s
, 'POST', 
	`_İ’id_’code_mes§ge
(
$mes§ge
));

564 ià(!
	`is£t
(
$»suÉ
->
”rÜ
)) {

565 
$»¥Ú£
 = 
	`_İ’id_·r£_mes§ge
(
$»suÉ
->
d©a
);

566 ià(
	`¡¹Şow”
(
	`Œim
(
$»¥Ú£
['is_valid'])) == 'true') {

567 
$v®id
 = 
TRUE
;

570 
$v®id
 = 
FALSE
;

574  
$v®id
;

575 
	}
}

591 
funùiÚ
 
	$İ’id_v”ify_as£¹iÚ_sigÇtu»
(
$£rviû
, 
$assocŸtiÚ
, 
$»¥Ú£
) {

592 ià(
$£rviû
['version'] == 2) {

595 
$mªd©Üy_keys
 = 
	`¬¿y
('op_endpoint', 'return_to', 'response_nonce', 'assoc_handle');

596 ià(
	`is£t
(
$»¥Ú£
['openid.claimed_id'])) {

599 
$mªd©Üy_keys
[] = 'claimed_id';

600 
$mªd©Üy_keys
[] = 'identity';

605 
$mªd©Üy_keys
 = 
	`¬¿y
('identity', 'return_to');

608 
$keys_to_sign
 = 
	`ex¶ode
(',', 
$»¥Ú£
['openid.signed']);

610 ià(
	`couÁ
(
	`¬¿y_diff
(
$mªd©Üy_keys
, 
$keys_to_sign
)) > 0) {

611  
FALSE
;

614  
	`_İ’id_sigÇtu»
(
$assocŸtiÚ
, 
$»¥Ú£
, 
$keys_to_sign
) == $response['openid.sig'];

615 
	}
}

628 
funùiÚ
 
	$İ’id_v”ify_as£¹iÚ_nÚû
(
$£rviû
, 
$»¥Ú£
) {

629 ià(
$£rviû
['version'] != 2) {

630  
TRUE
;

633 ià(
	`´eg_m©ch
('/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})Z/', 
$»¥Ú£
['İ’id.»¥Ú£_nÚû'], 
$m©ches
)) {

634 
	`li¡
(, 
$y—r
, 
$mÚth
, 
$day
, 
$hour
, 
$mšu‹s
, 
$£cÚds
èğ
$m©ches
;

635 
$nÚû_time¡amp
 = 
	`gmmktime
(
$hour
, 
$mšu‹s
, 
$£cÚds
, 
$mÚth
, 
$day
, 
$y—r
);

638 
	`w©chdog
('İ’id', 'NÚû from @’dpošˆ»jeùed beÿu£ iˆi nÙ cÜ»ùly fÜm©‹d,‚Úû: @nÚû.', 
	`¬¿y
('@’dpošt' => 
$£rviû
['uri'], '@nÚû' => 
$»¥Ú£
['İ’id.»¥Ú£_nÚû']), 
WATCHDOG_WARNING
);

639  
FALSE
;

644 
$time
 = 
	`time
();

645 
$expœy
 = 900;

646 ià(
$nÚû_time¡amp
 <ğ
$time
 - 
$expœy
 || $nonce_timestamp >= $time + $expiry) {

647 
	`w©chdog
('İ’id', 'NÚû„eûived from @’dpošˆi ouˆoà¿ngÑimdifã»nû: @š‹rv®s). Check…ossibË clock skew.', 
	`¬¿y
('@’dpošt' => 
$£rviû
['uri'], '@š‹rv®' => 
$time
 - 
$nÚû_time¡amp
), 
WATCHDOG_WARNING
);

648  
FALSE
;

652 
	`db_qu”y
("INSERT INTO {İ’id_nÚû} (idp_’dpošt_uri,‚Úû,ƒxpœesèVALUES ('%s', '%s', %d)", 
$£rviû
['uri'], 
$»¥Ú£
['İ’id.»¥Ú£_nÚû'], 
$nÚû_time¡amp
 + 
$expœy
);

655 
$couÁ_u£d
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {İ’id_nÚû} WHERE‚Úû = '%s' AND idp_’dpošt_ur˜ğ'%s'", 
$»¥Ú£
['İ’id.»¥Ú£_nÚû'], 
$£rviû
['uri']));

657 ià(
$couÁ_u£d
 == 1) {

658  
TRUE
;

661 
	`w©chdog
('İ’id', 'NÚû„•Ïy‡‰em± blocked from @,‚Úû: @nÚû.', 
	`¬¿y
('@' => 
	`_add»ss
(), '@nÚû' => 
$»¥Ú£
['İ’id.»¥Ú£_nÚû']), 
WATCHDOG_CRITICAL
);

662  
FALSE
;

664 
	}
}

671 
funùiÚ
 
	$İ’id_üÚ
() {

672 
	`db_qu”y
("DELETE FROM {İ’id_nÚû} WHEREƒxpœe < %d", 
	`time
());

673 
	}
}

	@/srv/http/subs/notes/www/modules/openid/openid.pages.inc

1 <?
php


12 
funùiÚ
 
	$İ’id_auth’tiÿtiÚ_·ge
() {

13 
$»suÉ
 = 
	`İ’id_com¶‘e
();

14 
$»suÉ
['status']) {

16  
	`İ’id_auth’tiÿtiÚ
(
$»suÉ
);

18 
	`dru·l_£t_mes§ge
(
	`t
('OpenID†ogin failed.'), 'error');

21 
	`dru·l_£t_mes§ge
(
	`t
('OpenID†ogin cancelled.'));

24 
	`dru·l_gÙo
();

25 
	}
}

30 
funùiÚ
 
	$İ’id_u£r_id’t™›s
(
$accouÁ
) {

31 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$accouÁ
->
Çme
));

32 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'openid') .'/openid.css', 'module');

35 
$»suÉ
 = 
	`İ’id_com¶‘e
();

36 ià(
$»suÉ
['status'] == 'success') {

37 
$id’t™y
 = 
$»suÉ
['openid.claimed_id'];

38 
	`db_qu”y
("INSERT INTO {authm­} (uid,‡uthÇme, moduËèVALUES (%d, '%s','İ’id')", 
$accouÁ
->
uid
, 
$id’t™y
);

39 
	`dru·l_£t_mes§ge
(
	`t
('SucûssfuÎy‡dded %id’t™y', 
	`¬¿y
('%id’t™y' => 
$id’t™y
)));

42 
$h—d”
 = 
	`¬¿y
(
	`t
('OpenID'),('Operations'));

43 
$rows
 = 
	`¬¿y
();

45 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {authm­} WHERE moduË='İ’id' AND uid=%d", 
$accouÁ
->
uid
);

46 
$id’t™y
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

47 
$rows
[] = 
	`¬¿y
(
	`check_¶aš
(
$id’t™y
->
authÇme
), 
	`l
(
	`t
('D–‘e'), 'u£r/'. 
$accouÁ
->
uid
 .'/İ’id/d–‘e/'. $id’t™y->
aid
));

50 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

51 
$ouut
 .ğ
	`dru·l_g‘_fÜm
('openid_user_add');

52  
$ouut
;

53 
	}
}

61 
funùiÚ
 
	$İ’id_u£r_add
() {

62 
$fÜm
['İ’id_id’tif›r'] = 
	`¬¿y
(

64 '#t™Ë' => 
	`t
('OpenID'),

66 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Add‡n OpenID'));

67  
$fÜm
;

68 
	}
}

70 
funùiÚ
 
	$İ’id_u£r_add_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

72 
$şaimed_id
 = 
	`_İ’id_nÜm®ize
(
$fÜm_¡©e
['values']['openid_identifier']);

73 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT‡uthÇmFROM {authm­} WHERE‡uthÇme='%s'", 
$şaimed_id
))) {

74 
	`fÜm_£t_”rÜ
('İ’id_id’tif›r', 
	`t
('That OpenID is‡lready in use onhis site.'));

76 
	}
}

78 
funùiÚ
 
	$İ’id_u£r_add_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

79 
$»tuº_to
 = 
	`u¾
('u£r/'. 
	`¬g
(1è.'/İ’id', 
	`¬¿y
('absŞu‹' => 
TRUE
));

80 
	`İ’id_begš
(
$fÜm_¡©e
['v®ues']['İ’id_id’tif›r'], 
$»tuº_to
);

81 
	}
}

90 
funùiÚ
 
	$İ’id_u£r_d–‘e_fÜm
(
$fÜm_¡©e
, 
$accouÁ
, 
$aid
 = 0) {

91 
$authÇme
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT‡uthÇmFROM {authm­} WHERE uid = %d AND‡id = %d', 
$accouÁ
->
uid
, 
$aid
));

93 
$fÜm
 = 
	`¬¿y
();

95 
$fÜm
['uid'] = 
	`¬¿y
(

97 '#v®ue' => 
$accouÁ
->
uid
,

100 
$fÜm
['aid'] = 
	`¬¿y
(

102 '#v®ue' => 
$aid
,

105  
	`cÚfœm_fÜm
(
$fÜm
, 
	`t
('A» you su» you wªˆtØd–‘thO³nID %authÇmfÜ %u£r?', 
	`¬¿y
('%authÇme' => 
$authÇme
, '%u£r' => 
$accouÁ
->
Çme
)), 'u£r/'. $accouÁ->
uid
 .'/openid');

106 
	}
}

108 
funùiÚ
 
	$İ’id_u£r_d–‘e_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

109 
	`db_qu”y
("DELETE FROM {authm­} WHERE uid = %d AND‡id = %d AND moduË = 'İ’id'", 
$fÜm_¡©e
['values']['uid'], $form_state['values']['aid']);

110 ià(
	`db_afãùed_rows
()) {

111 
	`dru·l_£t_mes§ge
(
	`t
('OpenID deleted.'));

113 
$fÜm_¡©e
['redirect'] = 'user/'. $form_state['values']['uid'] .'/openid';

114 
	}
}

	@/srv/http/subs/notes/www/modules/openid/xrds.inc

1 <?
php


5 
	g$xrds_İ’_–em’ts
 = 
¬¿y
();

6 
	g$xrds_£rviûs
 = 
¬¿y
();

7 
	g$xrds_cu¼’t_£rviû
 = 
¬¿y
();

12 
funùiÚ
 
	$xrds_·r£
(
$xml
) {

13 
glob®
 
$xrds_£rviûs
;

15 
$·r£r
 = 
	`xml_·r£r_ü—‹_ns
();

16 
	`xml_£t_–em’t_hªdËr
(
$·r£r
, '_xrds_element_start', '_xrds_element_end');

17 
	`xml_£t_ch¬aù”_d©a_hªdËr
(
$·r£r
, '_xrds_cdata');

19 
	`xml_·r£
(
$·r£r
, 
$xml
);

20 
	`xml_·r£r_ä“
(
$·r£r
);

22  
$xrds_£rviûs
;

23 
	}
}

28 
funùiÚ
 
	$_xrds_–em’t_¡¬t
(&
$·r£r
, 
$Çme
, 
$©Œibs
) {

29 
glob®
 
$xrds_İ’_–em’ts
;

31 
$xrds_İ’_–em’ts
[] = 
	`_xrds_¡r_Çme¥aû
(
$Çme
);

32 
	}
}

34 
funùiÚ
 
	$_xrds_–em’t_’d
(&
$·r£r
, 
$Çme
) {

35 
glob®
 
$xrds_İ’_–em’ts
, 
$xrds_£rviûs
, 
$xrds_cu¼’t_£rviû
;

37 
$Çme
 = 
	`_xrds_¡r_Çme¥aû
($name);

38 ià(
$Çme
 == 'SERVICE') {

39 ià(
	`š_¬¿y
(
OPENID_NS_2_0
 .'/signÚ', 
$xrds_cu¼’t_£rviû
['types']) ||

40 
	`š_¬¿y
(
OPENID_NS_2_0
 .'/£rv”', 
$xrds_cu¼’t_£rviû
['types'])) {

41 
$xrds_cu¼’t_£rviû
['version'] = 2;

43 
	`–£if
 (
	`š_¬¿y
(
OPENID_NS_1_1
, 
$xrds_cu¼’t_£rviû
['types']) ||

44 
	`š_¬¿y
(
OPENID_NS_1_0
, 
$xrds_cu¼’t_£rviû
['types'])) {

45 
$xrds_cu¼’t_£rviû
['version'] = 1;

47 ià(!
	`em±y
(
$xrds_cu¼’t_£rviû
['version'])) {

48 
$xrds_£rviûs
[] = 
$xrds_cu¼’t_£rviû
;

50 
$xrds_cu¼’t_£rviû
 = 
	`¬¿y
();

52 
	`¬¿y_pİ
(
$xrds_İ’_–em’ts
);

53 
	}
}

55 
funùiÚ
 
	$_xrds_cd©a
(&
$·r£r
, 
$d©a
) {

56 
glob®
 
$xrds_İ’_–em’ts
, 
$xrds_£rviûs
, 
$xrds_cu¼’t_£rviû
;

57 
$·th
 = 
	`¡¹ouµ”
(
	`im¶ode
('/', 
$xrds_İ’_–em’ts
));

58 
$·th
) {

60 
$xrds_cu¼’t_£rviû
['ty³s'][] = 
$d©a
;

63 
$xrds_cu¼’t_£rviû
['uri'] = 
$d©a
;

66 
$xrds_cu¼’t_£rviû
['d–eg©e'] = 
$d©a
;

69 
$xrds_cu¼’t_£rviû
['loÿlid'] = 
$d©a
;

72 
	}
}

74 
funùiÚ
 
	$_xrds_¡r_Çme¥aû
(
$Çme
) {

76 
$pos
 = 
	`¡¼pos
(
$Çme
, ':');

77 ià(
$pos
 !=ğ
FALSE
) {

78 
$Çme
 = 
	`sub¡r
($Çme, 
$pos
 + 1, 
	`¡¾’
($name));

81  
$Çme
;

82 
	}
}

	@/srv/http/subs/notes/www/modules/path/path.admin.inc

1 <?
php


14 
funùiÚ
 
	$·th_admš_ov”v›w
(
$keys
 = 
NULL
) {

16 
$ouut
 = 
	`dru·l_g‘_fÜm
('·th_admš_f‹r_fÜm', 
$keys
);

18 
$couÁ
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*) FROM {url_alias} WHERE†anguage != ''"));

19 
$muÉªguage
 = (
	`moduË_exi¡s
('loÿË'è|| 
$couÁ
);

21 ià(
$keys
) {

23 
$keys
 = 
	`´eg_»¶aû
('!\*+!', '%', $keys);

24 
$sql
 = "SELECT * FROM {url_alias} WHERE dst LIKE '%%%s%%'";

27 
$sql
 = 'SELECT * FROM {url_alias}';

29 
$h—d”
 = 
	`¬¿y
(

30 
	`¬¿y
('d©a' => 
	`t
('Alias'), 'field' => 'dst', 'sort' => 'asc'),

31 
	`¬¿y
('d©a' => 
	`t
('System'), 'field' => 'src'),

32 
	`¬¿y
('d©a' => 
	`t
('Operations'), 'colspan' => '2')

34 ià(
$muÉªguage
) {

35 
$h—d”
[3] = $header[2];

36 
$h—d”
[2] = 
	`¬¿y
('d©a' => 
	`t
('Language'), 'field' => 'language');

38 
$sql
 .ğ
	`bËsÜt_sql
(
$h—d”
);

39 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
, 50, 0 , 
NULL
, 
$keys
);

41 
$rows
 = 
	`¬¿y
();

42 
$de¡š©iÚ
 = 
	`dru·l_g‘_de¡š©iÚ
();

43 
$d©a
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

44 
$row
 = 
	`¬¿y
(
	`check_¶aš
(
$d©a
->
d¡
), check_¶aš($d©a->
¤c
), 
	`l
(
	`t
('ed™'), "admš/bud/·th/ed™/$d©a->pid",‡¼ay('qu”y' => 
$de¡š©iÚ
)),†(t('delete'), "admin/build/path/delete/$data->pid",‡rray('query' => $destination)));

45 ià(
$muÉªguage
) {

46 
$row
[4] = $row[3];

47 
$row
[3] = $row[2];

48 
$row
[2] = 
	`moduË_švoke
('loÿË', 'Ïnguage_Çme', 
$d©a
->
Ïnguage
);

50 
$rows
[] = 
$row
;

53 ià(
	`em±y
(
$rows
)) {

54 
$em±y_mes§ge
 = 
$keys
 ? 
	`t
('No URL‡liases found.') :('No URL‡liases‡vailable.') ;

55 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
$em±y_mes§ge
, 'cŞ¥ª' => (
$muÉªguage
 ? 5 : 4)));

58 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

59 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 50, 0);

61  
$ouut
;

62 
	}
}

67 
funùiÚ
 
	$·th_admš_ed™
(
$pid
 = 0) {

68 ià(
$pid
) {

69 
$®Ÿs
 = 
	`·th_lßd
(
$pid
);

70 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$®Ÿs
['dst']));

71 
$ouut
 = 
	`dru·l_g‘_fÜm
('·th_admš_fÜm', 
$®Ÿs
);

74 
$ouut
 = 
	`dru·l_g‘_fÜm
('path_admin_form');

77  
$ouut
;

78 
	}
}

87 
funùiÚ
 
·th_admš_fÜm
(&
$fÜm_¡©e
, 
$ed™
 = 
¬¿y
('¤c' => '', 'd¡' => '', 'Ïnguage' => '', 'pid' => 
NULL
)) {

89 
$fÜm
['#®Ÿs'] = 
$ed™
;

91 
	g$fÜm
['¤c'] = 
¬¿y
(

93 '#t™Ë' => 
t
('Existing system…ath'),

94 '#deçuÉ_v®ue' => 
$ed™
['src'],

97 '#desütiÚ' => 
t
('Specifyheƒxisting…ath you wisho‡lias. Forƒxample:‚ode/28, forum/1,axonomy/term/1+2.'),

98 '#f›ld_´efix' => 
u¾
(
NULL
, 
¬¿y
('absŞu‹' => 
TRUE
)è. (
v¬ŸbË_g‘
('clean_url', 0) ? '' : '?q='),

99 '#»quœed' => 
TRUE
,

101 
	g$fÜm
['d¡'] = 
¬¿y
(

103 '#t™Ë' => 
t
('Path‡lias'),

104 '#deçuÉ_v®ue' => 
$ed™
['dst'],

107 '#desütiÚ' => 
t
('Specify‡n‡lternative…ath by whichhis data can be‡ccessed. Forƒxample,ype "about" when writing‡n‡bout…age. Use‡„elative…ath‡nd don\'t‡dd‡railing slash orhe URL‡lias won\'t work.'),

108 '#f›ld_´efix' => 
u¾
(
NULL
, 
¬¿y
('absŞu‹' => 
TRUE
)è. (
v¬ŸbË_g‘
('clean_url', 0) ? '' : '?q='),

109 '#»quœed' => 
TRUE
,

112 
	g$fÜm
['Ïnguage'] = 
¬¿y
(

114 '#v®ue' => 
$ed™
['language']

116 ià(
	g$ed™
['pid']) {

117 
	g$fÜm
['pid'] = 
¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$ed™
['pid']);

118 
	g$fÜm
['subm™'] = 
¬¿y
('#ty³' => 'subm™', '#v®ue' => 
t
('Update‡lias'));

121 
	g$fÜm
['subm™'] = 
¬¿y
('#ty³' => 'subm™', '#v®ue' => 
t
('Create‚ew‡lias'));

124  
	g$fÜm
;

131 
funùiÚ
 
	$·th_admš_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

132 
$¤c
 = 
$fÜm_¡©e
['values']['src'];

133 
$d¡
 = 
$fÜm_¡©e
['values']['dst'];

134 
$pid
 = 
	`is£t
(
$fÜm_¡©e
['values']['pid']) ? $form_state['values']['pid'] : 0;

136 
$Ïnguage
 = 
	`is£t
(
$fÜm_¡©e
['values']['language']) ? $form_state['values']['language'] : '';

138 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(d¡èFROM {u¾_®Ÿs} WHERE…id !ğ%d AND d¡ = '%s' AND†ªguagğ'%s'", 
$pid
, 
$d¡
, 
$Ïnguage
))) {

139 
	`fÜm_£t_”rÜ
('d¡', 
	`t
('Th®Ÿ %®Ÿ i ®»ady iÀu£ iÀthi Ïnguage.', 
	`¬¿y
('%®Ÿs' => 
$d¡
)));

141 
$™em
 = 
	`m’u_g‘_™em
(
$¤c
);

142 ià(!
$™em
 || !$item['access']) {

143 
	`fÜm_£t_”rÜ
('¤c', 
	`t
("Th·th '@lšk_·th' i e™h” inv®id o¸you dØnÙ havacûs tØ™.", 
	`¬¿y
('@lšk_·th' => 
$¤c
)));

145 
	}
}

150 
funùiÚ
 
	$·th_admš_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

152 
	`·th_£t_®Ÿs
(
$fÜm_¡©e
['v®ues']['¤c'], $fÜm_¡©e['v®ues']['d¡'], 
	`is£t
($form_state['values']['pid']) ? $form_state['values']['pid'] : 0, isset($form_state['values']['language']) ? $form_state['values']['language'] : '');

154 
	`dru·l_£t_mes§ge
(
	`t
('The‡lias has been saved.'));

155 
$fÜm_¡©e
['redirect'] = 'admin/build/path';

157 
	}
}

162 
funùiÚ
 
	$·th_admš_d–‘e_cÚfœm
(
$fÜm_¡©e
, 
$pid
) {

163 
$·th
 = 
	`·th_lßd
(
$pid
);

164 ià(
	`u£r_acûss
('administer url‡liases')) {

165 
$fÜm
['pid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$pid
);

166 
$ouut
 = 
	`cÚfœm_fÜm
(
$fÜm
,

167 
	`t
('A» you su» you wªˆtØd–‘·th‡lŸ %t™Ë?', 
	`¬¿y
('%t™Ë' => 
$·th
['dst'])),

168 
	`is£t
(
$_GET
['destination']) ? $_GET['destination'] : 'admin/build/path');

170  
$ouut
;

171 
	}
}

176 
funùiÚ
 
	$·th_admš_d–‘e_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

177 ià(
$fÜm_¡©e
['values']['confirm']) {

178 
	`·th_admš_d–‘e
(
$fÜm_¡©e
['values']['pid']);

179 
$fÜm_¡©e
['redirect'] = 'admin/build/path';

182 
	}
}

191 
funùiÚ
 
·th_admš_f‹r_fÜm
(&
$fÜm_¡©e
, 
$keys
 = '') {

192 
$fÜm
['#©Œibu‹s'] = 
¬¿y
('class' => 'search-form');

193 
	g$fÜm
['basic'] = 
¬¿y
('#type' => 'fieldset',

194 '#t™Ë' => 
t
('Filter‡liases')

196 
	g$fÜm
['basic']['šlše'] = 
¬¿y
('#prefix' => '<div class="container-inline">', '#suffix' => '</div>');

197 
	g$fÜm
['basic']['šlše']['f‹r'] = 
¬¿y
(

200 '#deçuÉ_v®ue' => 
$keys
,

204 
	g$fÜm
['basic']['šlše']['subm™'] = 
¬¿y
(

206 '#v®ue' => 
t
('Filter'),

207 '#subm™' => 
¬¿y
('path_admin_filter_form_submit_filter'),

209 ià(
	g$keys
) {

210 
	g$fÜm
['basic']['šlše']['»£t'] = 
¬¿y
(

212 '#v®ue' => 
t
('Reset'),

213 '#subm™' => 
¬¿y
('path_admin_filter_form_submit_reset'),

216  
	g$fÜm
;

222 
funùiÚ
 
	$·th_admš_f‹r_fÜm_subm™_f‹r
(
$fÜm
, &
$fÜm_¡©e
) {

223 
$fÜm_¡©e
['»dœeù'] = 'admš/bud/·th/li¡/'. 
	`Œim
($form_state['values']['filter']);

224 
	}
}

229 
funùiÚ
 
	$·th_admš_f‹r_fÜm_subm™_»£t
(
$fÜm
, &
$fÜm_¡©e
) {

230 
$fÜm_¡©e
['redirect'] = 'admin/build/path/list';

231 
	}
}

237 
funùiÚ
 
	$·th_admš_f‹r_g‘_keys
() {

239 
$·th
 = 
	`ex¶ode
('/', 
$_GET
['q'], 5);

240  
	`couÁ
(
$·th
) == 5 ? $path[4] : '';

241 
	}
}

	@/srv/http/subs/notes/www/modules/path/path.module

1 <?
php


12 
funùiÚ
 
	$·th_h–p
(
$·th
, 
$¬g
) {

13 
$·th
) {

15 
$ouut
 = '<p>'. 
	`t
('The…ath module‡llows youo specify‡liases for Drupal URLs. Such‡liases improve„eadability of URLs for your users‡nd may help internet searchƒngineso index your content moreƒffectively. Morehan one‡lias may be created for‡ given…age.') .'</p>';

16 
$ouut
 .ğ
	`t
('<p>Someƒxamples of URL‡liases‡re:</p>

17 <
ul
>

18 <
li
>
u£r
/
logš
 =&
gt
;†ogin</li>

19 <
li
>
image
/
tid
/16 =&
gt
; 
¡Üe
</li>

20 <
li
>
xÚomy
/
‹rm
/7+19+20+21 =&
gt
; 
¡Üe
/
´oduùs
/
whœlygigs
</li>

21 <
li
>
node
/3 =&
gt
; 
cÚù
</li>

22 </
ul
>

24 
$ouut
 .ğ'<p>'. 
	`t
('The…ath moduleƒnables‡ppropriately…ermissioned userso specify‡n optional‡lias in‡ll‚ode input‡ndƒditing forms,‡nd…rovides‡n interfaceo view‡ndƒdit‡ll URL‡liases. Thewo…ermissions„elatedo URL‡liasing‡re <em>administer url‡liases</em>‡nd <em>create url‡liases</em>. ') .'</p>';

25 
$ouut
 .ğ'<p>'. 
	`t
('This module‡lso…rovides user-defined mass URL‡liasing capabilities, which is useful if you wisho uniformly use URLs different fromhe default. Forƒxample, you may wanto have your URLs…resented in‡ different†anguage. Accessohe Drupal source code onhe web server is„equiredo set up mass URL‡liasing. ') .'</p>';

26 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@·th">P©h moduË</a>.', 
	`¬¿y
('@path' => 'http://drupal.org/handbook/modules/path/')) .'</p>';

27  
$ouut
;

29  '<p>'. 
	`t
("Drupal…rovides complete control over URLshrough‡liasing, which is often usedo make URLs more„eadable orƒasyo„emember. Forƒxample,he‡lias 'about' may be mapped ontohe…ost‡the system…ath 'node/1', creating‡ more meaningful URL. Each system…ath can have multiple‡liases.") .'</p>';

31  '<p>'. 
	`t
('Enterhe…ath you wisho createhe‡lias for, followed byhe‚ame ofhe‚ew‡lias.') .'</p>';

33 
	}
}

38 
funùiÚ
 
	$·th_m’u
() {

39 
$™ems
['admš/bud/·th'] = 
	`¬¿y
(

43 'acûs ¬gum’ts' => 
	`¬¿y
('administer url‡liases'),

46 
$™ems
['admš/bud/·th/ed™'] = 
	`¬¿y
(

49 'acûs ¬gum’ts' => 
	`¬¿y
('administer url‡liases'),

50 'ty³' => 
MENU_CALLBACK
,

53 
$™ems
['admš/bud/·th/d–‘e'] = 
	`¬¿y
(

56 '·g¬gum’ts' => 
	`¬¿y
('path_admin_delete_confirm'),

57 'acûs ¬gum’ts' => 
	`¬¿y
('administer url‡liases'),

58 'ty³' => 
MENU_CALLBACK
,

61 
$™ems
['admš/bud/·th/li¡'] = 
	`¬¿y
(

63 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

66 
$™ems
['admš/bud/·th/add'] = 
	`¬¿y
(

69 'acûs ¬gum’ts' => 
	`¬¿y
('administer url‡liases'),

70 'ty³' => 
MENU_LOCAL_TASK
,

74  
$™ems
;

75 
	}
}

80 
funùiÚ
 
	$·th_admš_d–‘e
(
$pid
 = 0) {

81 
	`db_qu”y
('DELETE FROM {u¾_®Ÿs} WHERE…id = %d', 
$pid
);

82 
	`dru·l_£t_mes§ge
(
	`t
('The‡lias has been deleted.'));

83 
	}
}

88 
funùiÚ
 
·th_£t_®Ÿs
(
$·th
 = 
NULL
, 
$®Ÿs
 = NULL, 
$pid
 = NULL, 
$Ïnguage
 = '') {

89 
$·th
 = 
u¾decode
($path);

90 
	g$®Ÿs
 = 
u¾decode
(
$®Ÿs
);

92 ià(
	g$pid
) {

94 ià(!
	g$·th
 || !
	g$®Ÿs
) {

96 
db_qu”y
('DELETE FROM {u¾_®Ÿs} WHERE…id = %d', 
$pid
);

100 
db_qu”y
("UPDATE {u¾_®Ÿs} SET srøğ'%s', d¡ = '%s',†ªguagğ'%s' WHERE…id = %d", 
$·th
, 
$®Ÿs
, 
$Ïnguage
, 
$pid
);

103 ià(
	g$·th
 && 
	g$®Ÿs
) {

105 ià(
	g$®Ÿs
 =ğ
dru·l_g‘_·th_®Ÿs
(
$·th
, 
$Ïnguage
)) {

108 
db_qu”y
("UPDATE {u¾_®Ÿs} SET srøğ'%s', d¡ = '%s',†ªguagğ'%s' WHERE d¡ = '%s'", 
$·th
, 
$®Ÿs
, 
$Ïnguage
, $alias);

112 
db_qu”y
("INSERT INTO {u¾_®Ÿs} (¤c, d¡,†ªguageèVALUES ('%s', '%s', '%s')", 
$·th
, 
$®Ÿs
, 
$Ïnguage
);

117 ià(
	g$®Ÿs
) {

118 
db_qu”y
("DELETE FROM {u¾_®Ÿs} WHERE d¡ = '%s'", 
$®Ÿs
);

121 
db_qu”y
("DELETE FROM {u¾_®Ÿs} WHERE srøğ'%s'", 
$·th
);

124 
dru·l_ş—r_·th_ÿche
();

134 
funùiÚ
 
	$·th_nod—pi
(&
$node
, 
$İ
, 
$¬g
) {

136 ià(
	`u£r_acûss
('ü—‹ u¾‡lŸ£s'è|| u£r_acûss('admši¡” u¾‡lŸ£s'è|| (
$İ
 == 'load')) {

137 
$Ïnguage
 = 
	`is£t
(
$node
->
Ïnguage
) ? $node->language : '';

138 
$İ
) {

140 ià(
	`is£t
(
$node
->
·th
)) {

141 
$node
->
·th
 = 
	`Œim
($node->path);

142 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(d¡èFROM {u¾_®Ÿs} WHERE d¡ = '%s' AND srø!ğ'%s' AND†ªguagğ'%s'", 
$node
->
·th
, "node/$node->nid", 
$Ïnguage
))) {

143 
	`fÜm_£t_”rÜ
('·th', 
	`t
('The…ath is‡lready in use.'));

149 
$·th
 = 'node/'. 
$node
->
nid
;

150 
$®Ÿs
 = 
	`dru·l_g‘_·th_®Ÿs
(
$·th
, 
$Ïnguage
);

151 ià(
$·th
 !ğ
$®Ÿs
) {

152 
$node
->
·th
 = 
$®Ÿs
;

159 ià(
	`is£t
(
$node
->
·th
)) {

160 
	`·th_£t_®Ÿs
('node/'. 
$node
->
nid
, $node->
·th
, 
NULL
, 
$Ïnguage
);

165 
	`·th_£t_®Ÿs
('node/'. 
$node
->
nid
, 
	`is£t
($node->
·th
è? $node->·th : 
NULL
, is£t($node->
pid
è? $node->pid : NULL, 
$Ïnguage
);

169 
$·th
 = 'node/'. 
$node
->
nid
;

170 ià(
	`dru·l_g‘_·th_®Ÿs
(
$·th
) != $path) {

171 
	`·th_£t_®Ÿs
(
$·th
);

176 
	}
}

181 
funùiÚ
 
	$·th_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

182 ià(
	`is£t
(
$fÜm
['ty³']è&& is£t($fÜm['#node']è&& $fÜm['ty³']['#v®ue'] .'_node_fÜm' =ğ
$fÜm_id
) {

183 
$·th
 = 
	`is£t
(
$fÜm
['#node']->
·th
è? $fÜm['#node']->·th : 
NULL
;

184 
$fÜm
['·th'] = 
	`¬¿y
(

186 '#t™Ë' => 
	`t
('URL…ath settings'),

187 '#cŞÏpsibË' => 
TRUE
,

188 '#cŞÏp£d' => 
	`em±y
(
$·th
),

189 '#acûss' => 
	`u£r_acûss
('create url‡liases'),

192 
$fÜm
['·th']['·th'] = 
	`¬¿y
(

194 '#deçuÉ_v®ue' => 
$·th
,

196 '#cŞÏpsibË' => 
TRUE
,

197 '#cŞÏp£d' => 
TRUE
,

198 '#desütiÚ' => 
	`t
('Optionally specify‡n‡lternative URL by whichhis‚ode can be‡ccessed. Forƒxample,ype "about" when writing‡n‡bout…age. Use‡„elative…ath‡nd don\'t‡dd‡railing slash orhe URL‡lias won\'t work.'),

200 ià(
$·th
) {

201 
$fÜm
['·th']['pid'] = 
	`¬¿y
(

203 '#v®ue' => 
	`db_»suÉ
(
	`db_qu”y
("SELECT…id FROM {u¾_®Ÿs} WHERE d¡ = '%s' AND†ªguagğ'%s'", 
$·th
, 
$fÜm
['#node']->
Ïnguage
))

207 
	}
}

212 
funùiÚ
 
	$·th_³rm
() {

213  
	`¬¿y
('create url‡liases', 'administer url‡liases');

214 
	}
}

219 
funùiÚ
 
	$·th_lßd
(
$pid
) {

220  
	`db_ãtch_¬¿y
(
	`db_qu”y
('SELECT * FROM {u¾_®Ÿs} WHERE…id = %d', 
$pid
));

221 
	}
}

	@/srv/http/subs/notes/www/modules/php/php.module

1 <?
php


13 
funùiÚ
 
	$php_h–p
(
$·th
, 
$¬g
) {

14 
$·th
) {

16 
$ouut
 = '<p>'. 
	`t
('The PHP filter‡ddshe‡bilityo include PHP code in…osts. PHP is‡ general-purpose scripting†anguage widely-used for web development;he content management system used byhis website has been developed using PHP.') .'</p>';

17 
$ouut
 .ğ'<p>'. 
	`t
('Throughhe PHP filter, users withhe…roper…ermission may include custom PHP code within‡…age ofhe site. Whilehis is‡…owerful‡nd flexible feature if used by‡rusted user with PHPƒxperience, it is‡ significant‡nd dangerous security„isk inhe hands of‡ malicious user. Even‡rusted user may‡ccidentally compromisehe site byƒntering malformed or incorrect PHP code. Onlyhe mostrusted users should be granted…ermissiono usehe PHP filter,‡nd‡ll PHP code‡ddedhroughhe PHP filter should be carefullyƒxamined before use.') .'</p>';

18 
$ouut
 .ğ'<p>'. 
	`t
('<¨h»f="@dru·l">Dru·l.Üg</a> ofãr <¨h»f="@php-¢³ts">somexam¶PHP sn³ts</a>, o¸you cª c»©you¸owÀw™h somPHPƒx³r›nû‡nd knowËdgoàthDru·Èsy¡em.', 
	`¬¿y
('@dru·l' => 
	`u¾
('http://drupal.org'), '@php-snippets' => url('http://drupal.org/handbook/customization/php-snippets'))) .'</p>';

19 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@php">PHP moduË</a>.', 
	`¬¿y
('@php' => 'http://drupal.org/handbook/modules/php/')) .'</p>';

20  
$ouut
;

22 
	}
}

27 
funùiÚ
 
	$php_f‹r_ts
(
$d–
, 
$fÜm©
, 
$lÚg
 = 
çl£
) {

28 
glob®
 
$ba£_u¾
;

29 ià(
$d–
 == 0) {

30 
$lÚg
) {

32  
	`t
('You may…ost PHP code. You should include &lt;?php ?&gt;ags.');

34 
$ouut
 = '<h4>'. 
	`t
('Using custom PHP code') .'</h4>';

35 
$ouut
 .ğ'<p>'. 
	`t
('Custom PHP code may beƒmbedded in someypes of site content, including…osts‡nd blocks. Whileƒmbedding PHP code inside‡…ost or block is‡…owerful‡nd flexible feature when used by‡rusted user with PHPƒxperience, it is‡ significant‡nd dangerous security„isk when used improperly. Even‡ small mistake when…osting PHP code may‡ccidentally compromise your site.') .'</p>';

36 
$ouut
 .ğ'<p>'. 
	`t
('If you‡re unfamiliar with PHP, SQL, or Drupal,‡void using custom PHP code within…osts. Experimenting with PHP may corrupt your database,„ender your site inoperable, or significantly compromise security.') .'</p>';

37 
$ouut
 .ğ'<p>'. 
	`t
('Notes:') .'</p>';

38 
$ouut
 .ğ'<ul><li>'. 
	`t
('Remembero double-checkƒach†ine for syntax‡nd†ogicƒrrors <strong>before</strong> saving.') .'</li>';

39 
$ouut
 .ğ'<li>'. 
	`t
('Statements must be correctlyerminated with semicolons.') .'</li>';

40 
$ouut
 .ğ'<li>'. 
	`t
('Global variables used within your PHP code„etainheir values‡fter your scriptƒxecutes.') .'</li>';

41 
$ouut
 .ğ'<li>'. 
	`t
('<code>»gi¡”_glob®s</code> i <¡rÚg>tuºed off</¡rÚg>. Iàyou‚“dØu£ fÜms, und”¡ªd‡nd u£hfunùiÚ š <¨h»f="@fÜm­i">thDru·ÈFÜm API</a>.', 
	`¬¿y
('@fÜm­i' => 
	`u¾
('http://api.drupal.org/api/group/form_api/6'))) .'</li>';

42 
$ouut
 .ğ'<li>'. 
	`t
('Use‡ <code>print</code> or <code>return</code> statement in your codeo output content.') .'</li>';

43 
$ouut
 .ğ'<li>'. 
	`t
('Develop‡ndest your PHP code using‡ separateest script‡nd sample database before deploying on‡…roduction site.') .'</li>';

44 
$ouut
 .ğ'<li>'. 
	`t
('Consider including your custom PHP code within‡ site-specific module or <code>template.php</code> file„atherhanƒmbedding it directly into‡…ost or block.') .'</li>';

45 
$ouut
 .ğ'<li>'. 
	`t
('Be‡warehathe‡bilityoƒmbed PHP code within content is…rovided byhe PHP Filter module. Ifhis module is disabled or deleted,hen blocks‡nd…osts withƒmbedded PHP may display,„atherhanƒxecute,he PHP code.') .'</li></ul>';

46 
$ouut
 .ğ'<p>'. 
	`t
('A basicƒxample: <em>Creating‡ "Welcome" blockhat greets visitors with‡ simple message.</em>') .'</p>';

47 
$ouut
 .ğ'<ul><li>'. 
	`t
('<p>Add‡ custom blocko your site,‚amed "Welcome". With its input format seto "PHP code" (or‡nother format supporting PHP input),‡ddhe following inhe Block body:</p>

48 <
´e
>

49 
´št
 
	`t
(\'Welcome visitor! Thank you for visiting.\');

50 </
´e
>'è.'</
li
>';

51 
$ouut
 .ğ'<li>'. 
	`t
('<p>To displayhe‚ame of‡„egistered user, usehis instead:</p>

52 <
´e
>

53 
glob®
 
$u£r
;

54 ià(
$u£r
->
uid
) {

55 
´št
 
	`t
(\'Welcome @name! Thank you for visiting.\',‡rray(\'@name\' => $user->name));

58 
´št
 
	`t
(\'Welcome visitor! Thank you for visiting.\');

60 </
´e
>'è.'</
li
></
ul
>';

61 
$ouut
 .ğ'<p>'. 
	`t
('<¨h»f="@dru·l">Dru·l.Üg</a> ofãr <¨h»f="@php-¢³ts">somexam¶PHP sn³ts</a>, o¸you cª c»©you¸owÀw™h somPHPƒx³r›nû‡nd knowËdgoàthDru·Èsy¡em.', 
	`¬¿y
('@dru·l' => 
	`u¾
('http://drupal.org'), '@php-snippets' => url('http://drupal.org/handbook/customization/php-snippets'))) .'</p>';

62  
$ouut
;

65 
	}
}

72 
funùiÚ
 
php_f‹r
(
$İ
, 
$d–
 = 0, 
$fÜm©
 = -1, 
$‹xt
 = '') {

73 
$İ
) {

75  
¬¿y
(0 => 
t
('PHPƒvaluator'));

78  
$d–
 == 0;

80  
t
('Executes‡…iece of PHP code. The usage ofhis filter should be„estrictedo‡dministrators only!');

82  
dru·l_ev®
(
$‹xt
);

84  
$‹xt
;

	@/srv/http/subs/notes/www/modules/ping/ping.module

1 <?
php


12 
funùiÚ
 
	$pšg_h–p
(
$·th
, 
$¬g
) {

13 
$·th
) {

15 
$ouut
 = '<p>'. 
	`t
('Thpšg moduË i u£fuÈfÜ‚Ùifyšg iÁ”e¡ed s™e th© you¸s™ha chªged. Iˆautom©iÿÎy s’d nÙifiÿtiÚs, o¸"pšgs",Øth<¨h»f="@ex‹º®-h‰p-pšgom©ic-com">pšgom©ic</a> s”viû‡bouˆÃw o¸upd©ed cÚ‹Á. IÀtuº, <¨h»f="@ex‹º®-h‰p-pšgom©ic-com">pšgom©ic</a>‚Ùif› Ùh”…İuÏ¸£rviûs, inşudšg weblogs.com, TechnÜ©i, blo.gs, BlogRŞlšg, F“d¡”.com,‡nd MÜeov”.', 
	`¬¿y
('@external-http-pingomatic-com' => 'http://pingomatic.com/')) .'</p>';

16 
$ouut
 .ğ'<p>'. 
	`t
('Thpšg moduË„equœe ¨cÜ»ùly cÚfigu»d <¨h»f="@üÚ">üÚ maš‹Çnûask</a>.', 
	`¬¿y
('@üÚ' => 
	`u¾
('admin/reports/status'))) .'</p>';

17 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@pšg">Pšg moduË</a>.', 
	`¬¿y
('@ping' => 'http://drupal.org/handbook/modules/ping/')) .'</p>';

18  
$ouut
;

20 
	}
}

27 
funùiÚ
 
	$pšg_üÚ
() {

28 
glob®
 
$ba£_u¾
;

30 ià(
	`v¬ŸbË_g‘
('site_name', 0)) {

31 
$üÚ_Ï¡
 = 
	`v¬ŸbË_g‘
('üÚ_Ï¡', 
	`time
());

33 ià(
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(*èFROM {node} WHERE stu ğ1 AND chªged > %d', 
$üÚ_Ï¡
)) || db_result(db_query('SELECT COUNT(*) FROM {node} WHERE status = 1 AND created > %d', $cron_last))) {

34 
	`_pšg_nÙify
(
	`v¬ŸbË_g‘
('s™e_Çme', ''), 
$ba£_u¾
);

37 
	}
}

43 
funùiÚ
 
	$_pšg_nÙify
(
$Çme
, 
$u¾
) {

44 
	`moduË_švoke_®l
('pšg', 
$Çme
, 
$u¾
);

45 
	}
}

52 
funùiÚ
 
pšg_pšg
(
$Çme
 = '', 
$u¾
 = '') {

54 
$»suÉ
 = 
xmÌpc
('h‰p://½c.pšgom©ic.com', 'weblogUpd©es.pšg', 
$Çme
, 
$u¾
);

56 ià(
	g$»suÉ
 ==ğ
FALSE
) {

57 
w©chdog
('dœeùÜy…šg', 'FaedØnÙify…šgom©ic.com (s™e).', 
¬¿y
(), 
WATCHDOG_WARNING
);

	@/srv/http/subs/notes/www/modules/poll/poll-bar-block.tpl.php

1 <?
	gphp


20 <
div
 
	gşass
="‹xt"><?
php
 
´št
 
$t™Ë
; ?></
	gdiv
>

21 <
div
 
	gşass
="bar">

22 <
div
 
¡yË
="width: <?ph°´šˆ$³rûÁage; ?>%;" 
şass
="foreground"></div>

23 </
div
>

24 <
div
 
şass
="percent">

25 <?
php
 
´št
 
$³rûÁage
; ?>%

26 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/poll/poll-bar.tpl.php

1 <?
	gphp


20 <
div
 
	gşass
="‹xt"><?
php
 
´št
 
$t™Ë
; ?></
	gdiv
>

21 <
div
 
	gşass
="bar">

22 <
div
 
¡yË
="width: <?ph°´šˆ$³rûÁage; ?>%;" 
şass
="foreground"></div>

23 </
div
>

24 <
div
 
şass
="percent">

25 <?
php
 
´št
 
$³rûÁage
; ?>% (<?ph°´šˆ
fÜm©_¶u¿l
(
$vÙes
, '1 vote', '@count votes'); ?>)

26 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/poll/poll-results-block.tpl.php

1 <?
	gphp


22 <
div
 
	gşass
="poll">

23 <
div
 
şass
="t™Ë"><?
php
 
´št
 
$t™Ë
 ?></div>

24 <?
php
 
´št
 
$»suÉs
 ?>

25 <
div
 
şass
="total">

26 <?
php
 
´št
 
t
('TÙ® vÙes: @vÙes', 
¬¿y
('@vÙes' => 
$vÙes
)); ?>

27 </
	gdiv
>

28 </
	gdiv
>

29 <
div
 
	gşass
="lšks"><?
php
 
´št
 
$lšks
; ?></
	gdiv
>

	@/srv/http/subs/notes/www/modules/poll/poll-results.tpl.php

1 <?
	gphp


21 <
div
 
	gşass
="poll">

22 <?
php
 
´št
 
$»suÉs
; ?>

23 <
div
 
	gşass
="total">

24 <?
php
 
´št
 
t
('TÙ® vÙes: @vÙes', 
¬¿y
('@vÙes' => 
$vÙes
)); ?>

25 </
	gdiv
>

26 <?
php
 ià(!
	$em±y
(
$ÿnûl_fÜm
)): ?>

27 <?
php
 
´št
 
$ÿnûl_fÜm
; ?>

28 <?
php
 
’dif
; ?>

29 </
div
>

	@/srv/http/subs/notes/www/modules/poll/poll-vote.tpl.php

1 <?
	gphp


18 <
div
 
	gşass
="poll">

19 <
div
 
şass
="vote-form">

20 <
div
 
şass
="choices">

21 <?
php
 ià(
$block
): ?>

22 <
div
 
şass
="t™Ë"><?
php
 
´št
 
$t™Ë
; ?>:</div>

23 <?
php
 
’dif
; ?>

24 <?
php
 
´št
 
	g$choiû
; ?>

25 </
	gdiv
>

26 <?
php
 
´št
 
	g$vÙe
; ?>

27 </
	gdiv
>

28 <?
	gphp


29 <?
php
 
´št
 
	g$»¡
 ?>

30 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/poll/poll.module

1 <?
php


13 
funùiÚ
 
	$pŞl_h–p
(
$·th
, 
$¬g
) {

14 
$·th
) {

16 
$ouut
 = '<p>'. 
	`t
('The…oll module can be usedo create simple…olls for site users. A…oll is‡ simple, multiple choice questionnaire which displayshe cumulative„esults ofhe‡nswersohe…oll. Having…olls onhe site is‡ good wayo„eceive feedback from community members.') .'</p>';

17 
$ouut
 .ğ'<p>'. 
	`t
('Wh’ c»©šg‡…Şl,ƒÁ”hque¡iÚ bešg…o£d,‡ w–Èa thpÙ’tŸÈchoiû ×nd begšnšg vÙcouÁ fÜƒach choiû). Th¡©u ªd du¿tiÚ (Ëngth oàtimthpŞÈ»maš aùivfÜ‚ew vÙesèÿÀ®sØb¥ecif›d. U£h<¨h»f="@pŞl">pŞl</a> m’u i‹mØv›w‡Î cu¼’ˆpŞls. TØvÙš o¸v›wh»suÉ oà¨¥ecifiøpŞl, click oÀthpŞÈ™£lf.', 
	`¬¿y
('@pŞl' => 
	`u¾
('poll'))) .'</p>';

18 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@pŞl">PŞÈmoduË</a>.', 
	`¬¿y
('@poll' => 'http://drupal.org/handbook/modules/poll/')) .'</p>';

19  
$ouut
;

21 
	}
}

26 
funùiÚ
 
	$pŞl_š™
() {

27 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'poll') .'/poll.css');

28 
	}
}

33 
funùiÚ
 
	$pŞl_theme
() {

34  
	`¬¿y
(

35 'pŞl_vÙe' => 
	`¬¿y
(

37 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

39 'pŞl_choiûs' => 
	`¬¿y
(

40 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

42 'pŞl_»suÉs' => 
	`¬¿y
(

44 '¬gum’ts' => 
	`¬¿y
('¿w_t™Ë' => 
NULL
, 'results' => NULL, 'votes' => NULL, 'raw_links' => NULL, 'block' => NULL, 'nid' => NULL, 'vote' => NULL),

46 'pŞl_b¬' => 
	`¬¿y
(

48 '¬gum’ts' => 
	`¬¿y
('t™Ë' => 
NULL
, 'votes' => NULL, 'total_votes' => NULL, 'vote' => NULL, 'block' => NULL),

51 
	}
}

56 
funùiÚ
 
	$pŞl_³rm
() {

57  
	`¬¿y
('create…oll content', 'delete own…oll content', 'delete‡ny…oll content', 'edit‡ny…oll content', 'edit own…oll content', 'vote on…olls', 'cancel own vote', 'inspect‡ll votes');

58 
	}
}

63 
funùiÚ
 
	$pŞl_acûss
(
$İ
, 
$node
, 
$accouÁ
) {

64 
$İ
) {

66  
	`u£r_acûss
('ü—‹…ŞÈcÚ‹Á', 
$accouÁ
è? 
TRUE
 : 
NULL
;

68  
	`u£r_acûss
('ed™‡ny…ŞÈcÚ‹Á', 
$accouÁ
è|| (u£r_acûss('ed™ owÀpŞÈcÚ‹Á', $accouÁè&& (
$node
->
uid
 =ğ$accouÁ->uid)è? 
TRUE
 : 
NULL
;

70  
	`u£r_acûss
('d–‘ªy…ŞÈcÚ‹Á', 
$accouÁ
è|| (u£r_acûss('d–‘owÀpŞÈcÚ‹Á', $accouÁè&& (
$node
->
uid
 =ğ$accouÁ->uid)è? 
TRUE
 : 
NULL
;

72 
	}
}

77 
funùiÚ
 
	$pŞl_m’u
() {

78 
$™ems
['pŞl'] = 
	`¬¿y
(

81 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

82 'ty³' => 
MENU_SUGGESTED_ITEM
,

86 
$™ems
['node/%node/vÙes'] = 
	`¬¿y
(

89 '·g¬gum’ts' => 
	`¬¿y
(1),

91 'acûs ¬gum’ts' => 
	`¬¿y
(1, 'š¥eù‡Î vÙes', 
FALSE
),

93 'ty³' => 
MENU_LOCAL_TASK
,

97 
$™ems
['node/%node/»suÉs'] = 
	`¬¿y
(

100 '·g¬gum’ts' => 
	`¬¿y
(1),

102 'acûs ¬gum’ts' => 
	`¬¿y
(1, 'acûs cÚ‹Á', 
TRUE
),

104 'ty³' => 
MENU_LOCAL_TASK
,

108 
$™ems
['pŞl/js'] = 
	`¬¿y
(

111 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

112 'ty³' => 
MENU_CALLBACK
,

115  
$™ems
;

116 
	}
}

121 
funùiÚ
 
	$_pŞl_m’u_acûss
(
$node
, 
$³rm
, 
$š¥eù_®lowvÙes
) {

122  
	`u£r_acûss
(
$³rm
è&& (
$node
->
ty³
 =ğ'pŞl'è&& ($node->
®lowvÙes
 || !
$š¥eù_®lowvÙes
);

123 
	}
}

130 
funùiÚ
 
pŞl_block
(
$İ
 = 'li¡', 
$d–
 = 0) {

131 ià(
u£r_acûss
('access content')) {

132 ià(
$İ
 == 'list') {

133 
$blocks
[0]['šfo'] = 
t
('Most„ecent…oll');

134  
	g$blocks
;

136 ià(
	g$İ
 == 'view') {

138 
$sql
 = 
db_»wr™e_sql
("SELECT MAX(n.created) FROM {node}‚ INNER JOIN {poll}… ON….nid =‚.nid WHERE‚.status = 1 AND….active = 1");

139 
	g$time¡amp
 = 
db_»suÉ
(
db_qu”y
(
$sql
));

140 ià(
	g$time¡amp
) {

141 
	g$pŞl
 = 
node_lßd
(
¬¿y
('ty³' => 'pŞl', 'ü—‹d' => 
$time¡amp
, 'status' => 1));

143 ià(
	g$pŞl
->
	gnid
) {

144 
	g$pŞl
 = 
pŞl_v›w
(
$pŞl
, 
TRUE
, 
FALSE
, TRUE);

147 
	g$block
['subjeù'] = 
t
('Poll');

148 
	g$block
['cÚ‹Á'] = 
dru·l_»nd”
(
$pŞl
->
cÚ‹Á
);

149  
	g$block
;

159 
funùiÚ
 
	$pŞl_üÚ
() {

160 
$»suÉ
 = 
	`db_qu”y
('SELECT….nid FROM {pŞl}… INNER JOIN {node}‚ ON….nid =‚.nid WHERE (n.ü—‹d +….ruÁimeè< '. 
	`time
() .' AND….active = 1 AND….runtime != 0');

161 
$pŞl
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

162 
	`db_qu”y
("UPDATE {pŞl} SET‡ùivğ0 WHERE‚id = %d", 
$pŞl
->
nid
);

164 
	}
}

169 
funùiÚ
 
	$pŞl_node_šfo
() {

170  
	`¬¿y
(

171 'pŞl' => 
	`¬¿y
(

172 'Çme' => 
	`t
('Poll'),

174 'desütiÚ' => 
	`t
('A <em>poll</em> is‡ question with‡ set of…ossible„esponses. A <em>poll</em>, once created,‡utomatically…rovides‡ simple„unning count ofhe‚umber of votes„eceived forƒach„esponse.'),

175 't™Ë_Ïb–' => 
	`t
('Question'),

176 'has_body' => 
FALSE
,

179 
	}
}

184 
funùiÚ
 
	$pŞl_fÜm
(&
$node
, 
$fÜm_¡©e
) {

185 
glob®
 
$u£r
;

187 
$admš
 = 
	`u£r_acûss
('admši¡”‚odes'è|| u£r_acûss('ed™‡ny…ŞÈcÚ‹Á'è|| (u£r_acûss('ed™ owÀpŞÈcÚ‹Á'è&& 
$u£r
->
uid
 =ğ
$node
->uid);

189 
$ty³
 = 
	`node_g‘_ty³s
('ty³', 
$node
);

191 
$fÜm
 = 
	`¬¿y
(

192 '#ÿche' => 
TRUE
,

195 
$fÜm
['t™Ë'] = 
	`¬¿y
(

197 '#t™Ë' => 
	`check_¶aš
(
$ty³
->
t™Ë_Ïb–
),

198 '#»quœed' => 
TRUE
,

199 '#deçuÉ_v®ue' => 
$node
->
t™Ë
,

203 ià(
	`is£t
(
$fÜm_¡©e
['choice_count'])) {

204 
$choiû_couÁ
 = 
$fÜm_¡©e
['choice_count'];

207 
$choiû_couÁ
 = 
	`max
(2, 
	`em±y
(
$node
->
choiû
è? 2 : 
	`couÁ
($node->choice));

211 
$fÜm
['choiû_w¿µ”'] = 
	`¬¿y
(

212 '#Œ“' => 
FALSE
,

219 
$fÜm
['choiû_w¿µ”']['choiû'] = 
	`¬¿y
(

226 
$d–
 = 0; $d– < 
$choiû_couÁ
; $delta++) {

227 
$‹xt
 = 
	`is£t
(
$node
->
choiû
[
$d–
]['chtext']) ? $node->choice[$delta]['chtext'] : '';

228 
$vÙes
 = 
	`is£t
(
$node
->
choiû
[
$d–
]['chvotes']) ? $node->choice[$delta]['chvotes'] : 0;

230 
$fÜm
['choiû_w¿µ”']['choiû'][
$d–
] = 
	`_pŞl_choiû_fÜm
($d–, 
$‹xt
, 
$vÙes
);

235 
$fÜm
['choiû_w¿µ”']['pŞl_mÜe'] = 
	`¬¿y
(

237 '#v®ue' => 
	`t
('More choices'),

238 '#desütiÚ' => 
	`t
("Ifhe‡mount of boxes‡bove isn'tƒnough, click hereo‡dd more choices."),

240 '#subm™' => 
	`¬¿y
('poll_more_choices_submit'),

241 '#ahah' => 
	`¬¿y
(

250 
$_du¿tiÚ
 = 
	`¬¿y
(0 => 
	`t
('UÆim™ed')è+ 
	`dru·l_m­_assoc
(array(86400, 172800, 345600, 604800, 1209600, 2419200, 4838400, 9676800, 31536000), "format_interval");

251 
$_aùive
 = 
	`¬¿y
(0 => 
	`t
('Closed'), 1 =>('Active'));

253 ià(
$admš
) {

254 
$fÜm
['£‰šgs'] = 
	`¬¿y
(

256 '#cŞÏpsibË' => 
TRUE
,

257 '#t™Ë' => 
	`t
('Poll settings'),

261 
$fÜm
['£‰šgs']['aùive'] = 
	`¬¿y
(

263 '#t™Ë' => 
	`t
('Poll status'),

264 '#deçuÉ_v®ue' => 
	`is£t
(
$node
->
aùive
) ? $node->active : 1,

265 '#İtiÚs' => 
$_aùive
,

266 '#desütiÚ' => 
	`t
('When‡…oll is closed, visitors can‚o†onger vote for it.')

269 
$fÜm
['£‰šgs']['ruÁime'] = 
	`¬¿y
(

271 '#t™Ë' => 
	`t
('Poll duration'),

272 '#deçuÉ_v®ue' => 
	`is£t
(
$node
->
ruÁime
) ? $node->runtime : 0,

273 '#İtiÚs' => 
$_du¿tiÚ
,

274 '#desütiÚ' => 
	`t
('Afterhis…eriod,he…oll will be closed‡utomatically.'),

277  
$fÜm
;

278 
	}
}

285 
funùiÚ
 
	$pŞl_mÜe_choiûs_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

287 
	`node_fÜm_subm™_bud_node
(
$fÜm
, 
$fÜm_¡©e
);

290 ià(
$fÜm_¡©e
['values']['poll_more']) {

291 
$n
 = 
$_GET
['q'] == 'poll/js' ? 1 : 5;

292 
$fÜm_¡©e
['choiû_couÁ'] = 
	`couÁ
($fÜm_¡©e['v®ues']['choiû']è+ 
$n
;

294 
	}
}

296 
funùiÚ
 
_pŞl_choiû_fÜm
(
$d–
, 
$v®ue
 = '', 
$vÙes
 = 0) {

297 
$fÜm
 = 
¬¿y
(

298 '#Œ“' => 
TRUE
,

303 
	g$fÜm
['ch‹xt'] = 
¬¿y
(

305 '#t™Ë' => 
t
('Choiû @n', 
¬¿y
('@n' => (
$d–
 + 1))),

306 '#deçuÉ_v®ue' => 
$v®ue
,

307 '#·»Ás' => 
¬¿y
('choiû', 
$d–
, 'chtext'),

309 
	g$fÜm
['chvÙes'] = 
¬¿y
(

311 '#t™Ë' => 
t
('VÙe fÜ choiû @n', 
¬¿y
('@n' => (
$d–
 + 1))),

312 '#deçuÉ_v®ue' => 
$vÙes
,

315 '#·»Ás' => 
¬¿y
('choiû', 
$d–
, 'chvotes'),

316 '#acûss' => 
u£r_acûss
('administer‚odes'),

319  
	g$fÜm
;

325 
funùiÚ
 
	$pŞl_choiû_js
() {

326 
šşude_Úû
 'modules/node/node.pages.inc';

327 
$fÜm_¡©e
 = 
	`¬¿y
('¡Üage' => 
NULL
, 'subm™‹d' => 
FALSE
);

328 
$fÜm_bud_id
 = 
$_POST
['form_build_id'];

330 
$fÜm
 = 
	`fÜm_g‘_ÿche
(
$fÜm_bud_id
, 
$fÜm_¡©e
);

331 
$¬gs
 = 
$fÜm
['#parameters'];

332 
$fÜm_id
 = 
	`¬¿y_shiá
(
$¬gs
);

334 
$fÜm
['#»dœeù'] = 
FALSE
;

337 
$fÜm
['#po¡'] = 
$_POST
;

338 
$fÜm
['#´og¿mmed'] = 
FALSE
;

339 
$fÜm_¡©e
['po¡'] = 
$_POST
;

341 
	`dru·l_´oûss_fÜm
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
);

344 
$fÜm
 = 
	`dru·l_»bud_fÜm
(
$fÜm_id
, 
$fÜm_¡©e
, 
$¬gs
, 
$fÜm_bud_id
);

346 
$choiû_fÜm
 = 
$fÜm
['choice_wrapper']['choice'];

347 
	`un£t
(
$choiû_fÜm
['#prefix'], $choice_form['#suffix']);

348 
$ouut
 = 
	`theme
('¡©us_mes§ges'è. 
	`dru·l_»nd”
(
$choiû_fÜm
);

350 
	`dru·l_jsÚ
(
	`¬¿y
('¡©us' => 
TRUE
, 'd©a' => 
$ouut
));

351 
	}
}

356 
funùiÚ
 
	$pŞl_node_fÜm_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

358 
$fÜm_¡©e
['v®ues']['choiû'] = 
	`¬¿y_v®ues
($form_state['values']['choice']);

359 
$fÜm_¡©e
['v®ues']['‹a£r'] = 
	`pŞl_‹a£r
((
objeù
)$form_state['values']);

360 
	}
}

365 
funùiÚ
 
	$pŞl_v®id©e
(
$node
) {

366 ià(
	`is£t
(
$node
->
t™Ë
)) {

368 
$»®choiûs
 = 0;

370 
$node
->
choiû
 = 
	`¬¿y_v®ues
($node->choice);

371 
	`fÜ—ch
 (
$node
->
choiû
 
as
 
$i
 => 
$choiû
) {

372 ià(
$choiû
['chtext'] != '') {

373 
$»®choiûs
++;

375 ià(
	`is£t
(
$choiû
['chvotes']) && $choice['chvotes'] < 0) {

376 
	`fÜm_£t_”rÜ
("choiû][$i][chvÙes", 
	`t
('Negative values‡re‚ot‡llowed.'));

380 ià(
$»®choiûs
 < 2) {

381 
	`fÜm_£t_”rÜ
("choiû][$»®choiûs][ch‹xt", 
	`t
('You must fill in‡t†eastwo choices.'));

384 
	}
}

389 
funùiÚ
 
	$pŞl_lßd
(
$node
) {

390 
glob®
 
$u£r
;

392 
$pŞl
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT„uÁime,‡ùivFROM {pŞl} WHERE‚id = %d", 
$node
->
nid
));

395 
$»suÉ
 = 
	`db_qu”y
("SELECT ch‹xt, chvÙes, chÜd” FROM {pŞl_choiûs} WHERE‚id = %d ORDER BY chÜd”", 
$node
->
nid
);

396 
$choiû
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

397 
$pŞl
->
choiû
[
$choiû
['chorder']] = $choice;

401 
$pŞl
->
®lowvÙes
 = 
FALSE
;

402 ià(
	`u£r_acûss
('vÙÚ…Şls'è&& 
$pŞl
->
aùive
) {

403 ià(
$u£r
->
uid
) {

404 
$»suÉ
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT chÜd” FROM {pŞl_vÙes} WHERE‚id = %d AND uid = %d', 
$node
->
nid
, 
$u£r
->
uid
));

407 
$»suÉ
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT chÜd” FROM {pŞl_vÙes} WHERE‚id = %d AND ho¡Çmğ'%s'", 
$node
->
nid
, 
	`_add»ss
()));

409 ià(
	`is£t
(
$»suÉ
->
chÜd”
)) {

410 
$pŞl
->
vÙe
 = 
$»suÉ
->
chÜd”
;

413 
$pŞl
->
vÙe
 = -1;

414 
$pŞl
->
®lowvÙes
 = 
TRUE
;

417  
$pŞl
;

418 
	}
}

423 
funùiÚ
 
	$pŞl_š£¹
(
$node
) {

424 ià(!
	`u£r_acûss
('administer‚odes')) {

426 
	`fÜ—ch
 (
$node
->
choiû
 
as
 
$i
 => 
$choiû
) {

427 
$node
->
choiû
[
$i
]['chvotes'] = 0;

429 
$node
->
aùive
 = 1;

432 
	`db_qu”y
("INSERT INTO {pŞl} (nid,„uÁime,‡ùiveèVALUES (%d, %d, %d)", 
$node
->
nid
, $node->
ruÁime
, $node->
aùive
);

434 
$i
 = 0;

435 
	`fÜ—ch
 (
$node
->
choiû
 
as
 
$choiû
) {

436 ià(
$choiû
['chtext'] != '') {

437 
	`db_qu”y
("INSERT INTO {pŞl_choiûs} (nid, ch‹xt, chvÙes, chÜd”èVALUES (%d, '%s', %d, %d)", 
$node
->
nid
, 
$choiû
['ch‹xt'], $choiû['chvÙes'], 
$i
++);

440 
	}
}

445 
funùiÚ
 
	$pŞl_upd©e
(
$node
) {

447 
	`db_qu”y
('UPDATE {pŞl} SET„uÁimğ%d,‡ùivğ%d WHERE‚id = %d', 
$node
->
ruÁime
, $node->
aùive
, $node->
nid
);

450 
	`db_qu”y
('DELETE FROM {pŞl_choiûs} WHERE‚id = %d', 
$node
->
nid
);

456 
$Ãw_chÜd”
 = 0;

457 
	`fÜ—ch
 (
$node
->
choiû
 
as
 
$Şd_chÜd”
 => 
$choiû
) {

458 
$chvÙes
 = 
	`is£t
(
$choiû
['chvotes']) ? ()$choice['chvotes'] : 0;

459 
$ch‹xt
 = 
$choiû
['chtext'];

461 ià(!
	`em±y
(
$ch‹xt
)) {

462 
	`db_qu”y
("INSERT INTO {pŞl_choiûs} (nid, ch‹xt, chvÙes, chÜd”èVALUES (%d, '%s', %d, %d)", 
$node
->
nid
, 
$ch‹xt
, 
$chvÙes
, 
$Ãw_chÜd”
);

463 ià(
$Ãw_chÜd”
 !ğ
$Şd_chÜd”
) {

466 
	`db_qu”y
("UPDATE {pŞl_vÙes} SET chÜd” = %d WHERE‚id = %d AND chÜd” = %d", 
$Ãw_chÜd”
, 
$node
->
nid
, 
$Şd_chÜd”
);

468 
$Ãw_chÜd”
++;

471 
	`db_qu”y
("DELETE FROM {pŞl_vÙes} WHERE‚id = %d AND chÜd” = %d", 
$node
->
nid
, 
$Şd_chÜd”
);

474 
	}
}

479 
funùiÚ
 
	$pŞl_d–‘e
(
$node
) {

480 
	`db_qu”y
("DELETE FROM {pŞl} WHERE‚id = %d", 
$node
->
nid
);

481 
	`db_qu”y
("DELETE FROM {pŞl_choiûs} WHERE‚id = %d", 
$node
->
nid
);

482 
	`db_qu”y
("DELETE FROM {pŞl_vÙes} WHERE‚id = %d", 
$node
->
nid
);

483 
	}
}

492 
funùiÚ
 
	$pŞl_v›w
(
$node
, 
$‹a£r
 = 
FALSE
, 
$·ge
 = FALSE, 
$block
 = FALSE) {

493 
glob®
 
$u£r
;

494 
$ouut
 = '';

497 ià(
$block
) {

499 
$node
->
»admÜe
 = 
FALSE
;

501 
$lšks
 = 
	`moduË_švoke_®l
('lšk', 'node', 
$node
, 1);

502 
$lšks
[] = 
	`¬¿y
('t™Ë' => 
	`t
('Older…olls'), 'href' => 'poll', 'attributes' =>‡rray('title' =>('Viewhe†ist of…olls onhis site.')));

503 ià(
$node
->
®lowvÙes
 && 
$block
) {

504 
$lšks
[] = 
	`¬¿y
('t™Ë' => 
	`t
('ResuÉs'), 'h»f' => 'node/'. 
$node
->
nid
 .'/results', 'attributes' =>‡rray('title' =>('Viewhe current…oll„esults.')));

507 
$node
->
lšks
 = 
$lšks
;

510 ià(!
	`em±y
(
$node
->
®lowvÙes
è&& (
$block
 ||ƒm±y($node->
show_»suÉs
))) {

511 
$node
->
cÚ‹Á
['body'] = 
	`¬¿y
(

512 '#v®ue' => 
	`dru·l_g‘_fÜm
('pŞl_v›w_vÙšg', 
$node
, 
$block
),

516 
$node
->
cÚ‹Á
['body'] = 
	`¬¿y
(

517 '#v®ue' => 
	`pŞl_v›w_»suÉs
(
$node
, 
$‹a£r
, 
$·ge
, 
$block
),

520  
$node
;

521 
	}
}

528 
funùiÚ
 
	$pŞl_‹a£r
(
$node
) {

529 
$‹a£r
 = 
NULL
;

530 ià(
	`is_¬¿y
(
$node
->
choiû
)) {

531 
	`fÜ—ch
 (
$node
->
choiû
 
as
 
$k
 => 
$choiû
) {

532 ià(
$choiû
['chtext'] != '') {

533 
$‹a£r
 .ğ'* '. 
	`check_¶aš
(
$choiû
['chtext']) ."\n";

537  
$‹a£r
;

538 
	}
}

547 
funùiÚ
 
	$pŞl_v›w_vÙšg
(&
$fÜm_¡©e
, 
$node
, 
$block
) {

548 ià(
$node
->
choiû
) {

549 
$li¡
 = 
	`¬¿y
();

550 
	`fÜ—ch
 (
$node
->
choiû
 
as
 
$i
 => 
$choiû
) {

551 
$li¡
[
$i
] = 
	`check_¶aš
(
$choiû
['chtext']);

553 
$fÜm
['choiû'] = 
	`¬¿y
(

556 '#İtiÚs' => 
$li¡
,

560 
$fÜm
['vÙe'] = 
	`¬¿y
(

562 '#v®ue' => 
	`t
('Vote'),

563 '#subm™' => 
	`¬¿y
('poll_vote'),

567 
$fÜm
['#node'] = 
$node
;

568 
$fÜm
['#block'] = 
$block
;

572 
$fÜm
['#ÿche'] = 
TRUE
;

575 
$fÜm
['#theme'] = 'poll_vote';

576  
$fÜm
;

577 
	}
}

582 
funùiÚ
 
	$pŞl_v›w_vÙšg_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

583 ià(
$fÜm_¡©e
['values']['choice'] == -1) {

584 
	`fÜm_£t_”rÜ
Ğ'choiû', 
	`t
('Your vote could‚ot be„ecorded because you did‚ot select‡ny ofhe choices.'));

586 
	}
}

591 
funùiÚ
 
	$pŞl_vÙe
(
$fÜm
, &
$fÜm_¡©e
) {

592 
$node
 = 
$fÜm
['#node'];

593 
$choiû
 = 
$fÜm_¡©e
['values']['choice'];

595 
glob®
 
$u£r
;

596 ià(
$u£r
->
uid
) {

597 
	`db_qu”y
('INSERT INTO {pŞl_vÙes} (nid, chÜd”, uidèVALUES (%d, %d, %d)', 
$node
->
nid
, 
$choiû
, 
$u£r
->
uid
);

600 
	`db_qu”y
("INSERT INTO {pŞl_vÙes} (nid, chÜd”, ho¡ÇmeèVALUES (%d, %d, '%s')", 
$node
->
nid
, 
$choiû
, 
	`_add»ss
());

604 
	`db_qu”y
("UPDATE {pŞl_choiûs} SET chvÙe ğchvÙe + 1 WHERE‚id = %d AND chÜd” = %d", 
$node
->
nid
, 
$choiû
);

606 
	`ÿche_ş—r_®l
();

607 
	`dru·l_£t_mes§ge
(
	`t
('Your vote was„ecorded.'));

610 
	}
}

617 
funùiÚ
 
	$‹m¶©e_´•roûss_pŞl_vÙe
(&
$v¬ŸbËs
) {

618 
$fÜm
 = 
$v¬ŸbËs
['form'];

619 
$v¬ŸbËs
['choiû'] = 
	`dru·l_»nd”
(
$fÜm
['choice']);

620 
$v¬ŸbËs
['t™Ë'] = 
	`check_¶aš
(
$fÜm
['#node']->
t™Ë
);

621 
$v¬ŸbËs
['vÙe'] = 
	`dru·l_»nd”
(
$fÜm
['vote']);

622 
$v¬ŸbËs
['»¡'] = 
	`dru·l_»nd”
(
$fÜm
);

623 
$v¬ŸbËs
['block'] = 
$fÜm
['#block'];

625 ià(
$v¬ŸbËs
['block']) {

626 
$v¬ŸbËs
['template_files'][] = 'poll-vote-block';

628 
	}
}

633 
funùiÚ
 
	$pŞl_v›w_»suÉs
(&
$node
, 
$‹a£r
, 
$·ge
, 
$block
) {

635 
$tÙ®_vÙes
 = 0;

636 
$max_vÙes
 = 0;

637 
	`fÜ—ch
 (
$node
->
choiû
 
as
 
$choiû
) {

638 ià(
	`is£t
(
$choiû
['chvotes'])) {

639 
$tÙ®_vÙes
 +ğ
$choiû
['chvotes'];

640 
$max_vÙes
 = 
	`max
($max_vÙes, 
$choiû
['chvotes']);

644 
$pŞl_»suÉs
 = '';

645 
	`fÜ—ch
 (
$node
->
choiû
 
as
 
$i
 => 
$choiû
) {

646 ià(!
	`em±y
(
$choiû
['chtext'])) {

647 
$chvÙes
 = 
	`is£t
(
$choiû
['chvÙes']è? $choiû['chvÙes'] : 
NULL
;

648 
$pŞl_»suÉs
 .ğ
	`theme
('pŞl_b¬', 
$choiû
['ch‹xt'], 
$chvÙes
, 
$tÙ®_vÙes
, 
	`is£t
(
$node
->
vÙe
è&& $node->vÙ=ğ
$i
, 
$block
);

652  
	`theme
('pŞl_»suÉs', 
$node
->
t™Ë
, 
$pŞl_»suÉs
, 
$tÙ®_vÙes
, 
	`is£t
($node->
lšks
è? $node->lšk : 
	`¬¿y
(), 
$block
, $node->
nid
, is£t($node->
vÙe
è? $node->vÙ: 
NULL
);

653 
	}
}

661 
funùiÚ
 
	$theme_pŞl_choiûs
(
$fÜm
) {

663 
	`dru·l_add_js
('ià(Dru·l.jsEÇbËdè{ $(docum’t).»ady(funùiÚ(è{ $("#ed™-pŞl-mÜe").v®("'. 
	`t
('Add‡nother choice') .'"); }); }', 'inline');

665 
$rows
 = 
	`¬¿y
();

666 
$h—d”s
 = 
	`¬¿y
(

667 
	`t
('Choice'),

668 
	`t
('Vote count'),

671 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$key
) {

673 
	`un£t
(
$fÜm
[
$key
]['chtext']['#title'], $form[$key]['chvotes']['#title']);

676 
$row
 = 
	`¬¿y
(

677 'd©a' => 
	`¬¿y
(

678 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
[
$key
]['chtext']), 'class' => 'poll-chtext'),

679 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
[
$key
]['chvotes']), 'class' => 'poll-chvotes'),

684 ià(
	`is£t
(
$fÜm
[
$key
]['#attributes'])) {

685 
$row
 = 
	`¬¿y_m”ge
($row, 
$fÜm
[
$key
]['#attributes']);

687 
$rows
[] = 
$row
;

690 
$ouut
 = 
	`theme
('bË', 
$h—d”s
, 
$rows
);

691 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

692  
$ouut
;

693 
	}
}

708 
funùiÚ
 
	$‹m¶©e_´•roûss_pŞl_»suÉs
(&
$v¬ŸbËs
) {

709 
$v¬ŸbËs
['lšks'] = 
	`theme
('links', $variables['raw_links']);

710 ià(
	`is£t
(
$v¬ŸbËs
['vÙe']è&& $v¬ŸbËs['vÙe'] > -1 && 
	`u£r_acûss
('cancel own vote')) {

711 
$v¬ŸbËs
['ÿnûl_fÜm'] = 
	`dru·l_g‘_fÜm
('poll_cancel_form', $variables['nid']);

713 
$v¬ŸbËs
['t™Ë'] = 
	`check_¶aš
($variables['raw_title']);

716 ià(
$v¬ŸbËs
['block']) {

717 
$v¬ŸbËs
['template_files'][] = 'poll-results-block';

719 
	}
}

730 
funùiÚ
 
	$‹m¶©e_´•roûss_pŞl_b¬
(&
$v¬ŸbËs
) {

731 ià(
$v¬ŸbËs
['block']) {

732 
$v¬ŸbËs
['template_files'][] = 'poll-bar-block';

734 
$v¬ŸbËs
['t™Ë'] = 
	`check_¶aš
($variables['title']);

735 
$v¬ŸbËs
['³rûÁage'] = 
	`round
($v¬ŸbËs['vÙes'] * 100 / 
	`max
($variables['total_votes'], 1));

736 
	}
}

744 
funùiÚ
 
	$pŞl_ÿnûl_fÜm
(&
$fÜm_¡©e
, 
$nid
) {

746 
$fÜm
['#nid'] = 
$nid
;

748 
$fÜm
['subm™'] = 
	`¬¿y
(

750 '#v®ue' => 
	`t
('Cancel your vote'),

751 '#subm™' => 
	`¬¿y
('poll_cancel')

754 
$fÜm
['#ÿche'] = 
TRUE
;

756  
$fÜm
;

757 
	}
}

762 
funùiÚ
 
	$pŞl_ÿnûl
(
$fÜm
, &
$fÜm_¡©e
) {

763 
$node
 = 
	`node_lßd
(
$fÜm
['#nid']);

764 
glob®
 
$u£r
;

766 ià(
$u£r
->
uid
) {

767 
	`db_qu”y
('DELETE FROM {pŞl_vÙes} WHERE‚id = %d‡nd uid = %d', 
$node
->
nid
, 
$u£r
->
uid
);

770 
	`db_qu”y
("DELETE FROM {pŞl_vÙes} WHERE‚id = %d‡nd ho¡Çmğ'%s'", 
$node
->
nid
, 
	`_add»ss
());

774 
	`db_qu”y
("UPDATE {pŞl_choiûs} SET chvÙe ğchvÙe - 1 WHERE‚id = %d AND chÜd” = %d", 
$node
->
nid
, $node->
vÙe
);

775 
	}
}

780 
funùiÚ
 
	$pŞl_u£r
(
$İ
, &
$ed™
, &
$u£r
) {

781 ià(
$İ
 == 'delete') {

782 
	`db_qu”y
('UPDATE {pŞl_vÙes} SET uid = 0 WHERE uid = %d', 
$u£r
->
uid
);

784 
	}
}

	@/srv/http/subs/notes/www/modules/poll/poll.pages.inc

1 <?
php


12 
funùiÚ
 
	$pŞl_·ge
() {

14 
$sql
 = 
	`db_»wr™e_sql
("SELECT‚.nid,‚.title,….active,‚.created, SUM(c.chvotes) AS votes FROM {node}‚ INNER JOIN {poll}… ON‚.nid =….nid INNER JOIN {poll_choices} c ON‚.nid = c.nid WHERE‚.status = 1 GROUP BY‚.nid,‚.title,….active,‚.created ORDER BY‚.created DESC");

16 
$couÁ_sql
 = 
	`db_»wr™e_sql
('SELECT COUNT(*) FROM {node}‚ INNER JOIN {poll}… ON‚.nid =….nid WHERE‚.status = 1');

17 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
, 15, 0, 
$couÁ_sql
);

18 
$ouut
 = '<ul>';

19 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

20 
$ouut
 .ğ'<li>'. 
	`l
(
$node
->
t™Ë
, "node/$node->nid"è.' - '. 
	`fÜm©_¶u¿l
($node->
vÙes
, '1 vÙe', '@couÁ vÙes'è.' - '. ($node->
aùive
 ? 
	`t
('open') :('closed')) .'</li>';

22 
$ouut
 .= '</ul>';

23 
$ouut
 .ğ
	`theme
("·g”", 
NULL
, 15);

24  
$ouut
;

25 
	}
}

30 
funùiÚ
 
	$pŞl_vÙes
(
$node
) {

31 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$node
->
t™Ë
));

32 
$ouut
 = 
	`t
('Thisable†ists‡llhe„ecorded votes forhis…oll. If‡nonymous users‡re‡llowedo vote,hey will be identified byhe IP‡ddress ofhe computerhey used whenhey voted.');

34 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Visitor'), 'field' => 'u.name');

35 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Vote'), 'field' => 'pv.chorder');

37 
$»suÉ
 = 
	`·g”_qu”y
("SELECT…v.chÜd”,…v.uid,…v.ho¡Çme, u.ÇmFROM {pŞl_vÙes}…v LEFT JOIN {u£rs} u ON…v.uid = u.uid WHERE…v.nid = %d". 
	`bËsÜt_sql
(
$h—d”
), 20, 0, 
NULL
, 
$node
->
nid
);

38 
$rows
 = 
	`¬¿y
();

39 
$vÙe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

40 
$rows
[] = 
	`¬¿y
(

41 
$vÙe
->
Çme
 ? 
	`theme
('u£ºame', $vÙeè: 
	`check_¶aš
($vÙe->
ho¡Çme
),

42 
	`check_¶aš
(
$node
->
choiû
[
$vÙe
->
chÜd”
]['chtext']));

44 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

45 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 20, 0);

46  
$ouut
;

47 
	}
}

52 
funùiÚ
 
	$pŞl_»suÉs
(
$node
) {

53 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$node
->
t™Ë
));

54 
$node
->
show_»suÉs
 = 
TRUE
;

55  
	`node_show
(
$node
, 0);

56 
	}
}

	@/srv/http/subs/notes/www/modules/profile/profile-block.tpl.php

1 <?
	gphp


33 <?
php
 
´št
 
	g$piùu»
; ?>

35 <?
php
 
	$fÜ—ch
 (
$´ofe
 
as
 
$f›ld
) : ?>

36 <
p
>

37 <?
php
 ià(
$f›ld
->
ty³
 != 'checkbox') : ?>

38 <
¡rÚg
><?
php
 
´št
 
$f›ld
->
t™Ë
; ?></¡rÚg><
br
 />

39 <?
php
 
’dif
; ?>

40 <?
php
 
´št
 
$f›ld
->
v®ue
; ?>

41 </
p
>

42 <?
php
 
’dfÜ—ch
; ?>

	@/srv/http/subs/notes/www/modules/profile/profile-listing.tpl.php

1 <?
	gphp


39 <
div
 
	gşass
="profile">

40 <?
php
 
´št
 
$piùu»
; ?>

42 <
div
 
	gşass
="name">

43 <?
php
 
´št
 
$Çme
; ?>

44 </
	gdiv
>

46 <?
php
 
	$fÜ—ch
 (
$´ofe
 
as
 
$f›ld
) : ?>

47 <
div
 
şass
="field">

48 <?
php
 
´št
 
$f›ld
->
v®ue
; ?>

49 </
div
>

50 <?
php
 
’dfÜ—ch
; ?>

52 </
div
>

	@/srv/http/subs/notes/www/modules/profile/profile-wrapper.tpl.php

1 <?
	gphp


23 <
div
 
	gid
="profile">

24 <?
php
 
´št
 
$cÚ‹Á
; ?>

25 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/profile/profile.admin.inc

1 <?
php


15 
funùiÚ
 
	$´ofe_admš_ov”v›w
() {

16 
$»suÉ
 = 
	`db_qu”y
('SELECTitle,‚ame,ype, category, fid, weight FROM {profile_fields} ORDER BY category, weight');

18 
$fÜm
 = 
	`¬¿y
();

19 
$ÿ‹gÜ›s
 = 
	`¬¿y
();

20 
$f›ld
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

22 
$ÿ‹gÜ›s
[] = 
$f›ld
->
ÿ‹gÜy
;

25 
$fÜm
[
$f›ld
->
fid
]['Çme'] = 
	`¬¿y
('#v®ue' => 
	`check_¶aš
($f›ld->
Çme
));

26 
$fÜm
[
$f›ld
->
fid
]['t™Ë'] = 
	`¬¿y
('#v®ue' => 
	`check_¶aš
($f›ld->
t™Ë
));

27 
$fÜm
[
$f›ld
->
fid
]['ty³'] = 
	`¬¿y
('#v®ue' => $f›ld->
ty³
);

28 
$fÜm
[
$f›ld
->
fid
]['ÿ‹gÜy'] = 
	`¬¿y
('#ty³' => '£Ëù', '#deçuÉ_v®ue' => $f›ld->
ÿ‹gÜy
, '#options' =>‡rray());

29 
$fÜm
[
$f›ld
->
fid
]['weight'] = 
	`¬¿y
('#ty³' => 'weight', '#deçuÉ_v®ue' => $f›ld->
weight
);

30 
$fÜm
[
$f›ld
->
fid
]['ed™'] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('edit'), "admin/user/profile/edit/$field->fid"));

31 
$fÜm
[
$f›ld
->
fid
]['d–‘e'] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('delete'), "admin/user/profile/delete/$field->fid"));

35 
$ÿ‹gÜ›s
 = 
	`¬¿y_unique
($categories);

36 
	`fÜ—ch
 (
$fÜm
 
as
 
$fid
 => 
$f›ld
) {

37 
	`fÜ—ch
 (
$ÿ‹gÜ›s
 
as
 
$ÿt
 => 
$ÿ‹gÜy
) {

38 
$fÜm
[
$fid
]['ÿ‹gÜy']['#İtiÚs'][
$ÿ‹gÜy
] = $category;

43 ià(
	`couÁ
(
$fÜm
) > 1) {

44 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save configuration'));

48 
	`fÜ—ch
 (
$fÜm
 
as
 
$fid
 => 
$f›ld
) {

49 
	`un£t
(
$fÜm
[
$fid
]['weight']);

50 
$fÜm
[
$fid
]['category']['#type'] = 'value';

53 
$fÜm
['#Œ“'] = 
TRUE
;

55 
$addÃwf›lds
 = '<h2>'. 
	`t
('Add‚ew field') .'</h2>';

56 
$addÃwf›lds
 .= '<ul>';

57 
	`fÜ—ch
 (
	`_´ofe_f›ld_ty³s
(è
as
 
$key
 => 
$v®ue
) {

58 
$addÃwf›lds
 .ğ'<li>'. 
	`l
(
$v®ue
, "admin/user/profile/add/$key") .'</li>';

60 
$addÃwf›lds
 .= '</ul>';

61 
$fÜm
['addÃwf›lds'] = 
	`¬¿y
('#v®ue' => 
$addÃwf›lds
);

63  
$fÜm
;

64 
	}
}

71 
funùiÚ
 
	$´ofe_admš_ov”v›w_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

72 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm_¡©e
['v®ues']è
as
 
$fid
) {

73 ià(
	`is_num”ic
(
$fid
)) {

74 
$weight
 = 
$fÜm_¡©e
['v®ues'][
$fid
]['weight'];

75 
$ÿ‹gÜy
 = 
$fÜm_¡©e
['v®ues'][
$fid
]['category'];

76 ià(
$weight
 !ğ
$fÜm
[
$fid
]['weight']['#deçuÉ_v®ue'] || 
$ÿ‹gÜy
 != $form[$fid]['category']['#default_value']) {

77 
	`db_qu”y
("UPDATE {´ofe_f›lds} SET weighˆğ%d, c©egÜy = '%s' WHERE fid = %d", 
$weight
, 
$ÿ‹gÜy
, 
$fid
);

82 
	`dru·l_£t_mes§ge
(
	`t
('Profile fields have been updated.'));

83 
	`ÿche_ş—r_®l
();

84 
	`m’u_»bud
();

85 
	}
}

93 
funùiÚ
 
	$theme_´ofe_admš_ov”v›w
(
$fÜm
) {

94 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'profile') .'/profile.css');

96 ià(
	`is£t
(
$fÜm
['submit'])) {

97 
	`dru·l_add_js
(
	`dru·l_g‘_·th
('module', 'profile') .'/profile.js');

100 
$rows
 = 
	`¬¿y
();

101 
$ÿ‹gÜ›s
 = 
	`¬¿y
();

102 
$ÿ‹gÜy_numb”
 = 0;

103 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$key
) {

105 ià(
	`¬¿y_key_exi¡s
('ÿ‹gÜy', 
$fÜm
[
$key
])) {

106 
$f›ld
 = &
$fÜm
[
$key
];

107 
$ÿ‹gÜy
 = 
$f›ld
['category']['#default_value'];

109 ià(!
	`is£t
(
$ÿ‹gÜ›s
[
$ÿ‹gÜy
])) {

112 
$ÿ‹gÜ›s
[
$ÿ‹gÜy
] = 
$ÿ‹gÜy_numb”
;

113 
$ÿ‹gÜy_f›ld
['#©Œibu‹s']['şass'] = '´ofe-ÿ‹gÜy…rofe-ÿ‹gÜy-'. 
$ÿ‹gÜy_numb”
;

114 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
$ÿ‹gÜy
, 'colspan' => 7, 'class' => 'category'));

115 
$rows
[] = 
	`¬¿y
('d©a' =>‡¼ay×¼ay('d©a' => '<em>'. 
	`t
('NØf›ld šhi ÿ‹gÜy. Iàthi ÿ‹gÜy„emaš em±y wh’ saved, iˆwÈb»moved.'è.'</em>', 'cŞ¥ª' => 7)), 'şass' => 'ÿ‹gÜy-'. 
$ÿ‹gÜy_numb”
 .'-message category-message category-populated');

118 ià(
	`is£t
(
$fÜm
['submit'])) {

119 
	`dru·l_add_bËd¿g
('´ofe-f›lds', 'Üd”', 'siblšg', '´ofe-weight', '´ofe-weight-'. 
$ÿ‹gÜy_numb”
);

120 
	`dru·l_add_bËd¿g
('´ofe-f›lds', 'm©ch', 'siblšg', '´ofe-ÿ‹gÜy', '´ofe-ÿ‹gÜy-'. 
$ÿ‹gÜy_numb”
);

122 
$ÿ‹gÜy_numb”
++;

126 
$f›ld
['weight']['#©Œibu‹s']['şass'] = '´ofe-weighˆ´ofe-weight-'. 
$ÿ‹gÜ›s
[
$ÿ‹gÜy
];

127 
$f›ld
['ÿ‹gÜy']['#©Œibu‹s']['şass'] = '´ofe-ÿ‹gÜy…rofe-ÿ‹gÜy-'. 
$ÿ‹gÜ›s
[
$ÿ‹gÜy
];

130 
$row
 = 
	`¬¿y
();

131 
$row
[] = 
	`dru·l_»nd”
(
$f›ld
['title']);

132 
$row
[] = 
	`dru·l_»nd”
(
$f›ld
['name']);

133 
$row
[] = 
	`dru·l_»nd”
(
$f›ld
['type']);

134 ià(
	`is£t
(
$fÜm
['submit'])) {

135 
$row
[] = 
	`dru·l_»nd”
(
$f›ld
['category']);

136 
$row
[] = 
	`dru·l_»nd”
(
$f›ld
['weight']);

138 
$row
[] = 
	`dru·l_»nd”
(
$f›ld
['edit']);

139 
$row
[] = 
	`dru·l_»nd”
(
$f›ld
['delete']);

140 
$rows
[] = 
	`¬¿y
('d©a' => 
$row
, 'class' => 'draggable');

143 ià(
	`em±y
(
$rows
)) {

144 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No fields‡vailable.'), 'colspan' => 7));

147 
$h—d”
 = 
	`¬¿y
(
	`t
('Title'),('Name'),('Type'));

148 ià(
	`is£t
(
$fÜm
['submit'])) {

149 
$h—d”
[] = 
	`t
('Category');

150 
$h—d”
[] = 
	`t
('Weight');

152 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Operations'), 'colspan' => 2);

154 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('id' => 'profile-fields'));

155 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

157  
$ouut
;

158 
	}
}

167 
funùiÚ
 
	$´ofe_f›ld_fÜm
(&
$fÜm_¡©e
, 
$¬g
 = 
NULL
) {

168 ià(
	`¬g
(3) == 'edit') {

169 ià(
	`is_num”ic
(
$¬g
)) {

170 
$fid
 = 
$¬g
;

172 
$ed™
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
('SELECT * FROM {´ofe_f›lds} WHERE fid = %d', 
$fid
));

174 ià(!
$ed™
) {

175 
	`dru·l_nÙ_found
();

178 
	`dru·l_£t_t™Ë
(
	`t
('ed™ %t™Ë', 
	`¬¿y
('%t™Ë' => 
$ed™
['title'])));

179 
$fÜm
['fid'] = 
	`¬¿y
('#type' => 'value',

180 '#v®ue' => 
$fid
,

182 
$ty³
 = 
$ed™
['type'];

185 
	`dru·l_nÙ_found
();

190 
$ty³s
 = 
	`_´ofe_f›ld_ty³s
();

191 ià(!
	`is£t
(
$ty³s
[
$¬g
])) {

192 
	`dru·l_nÙ_found
();

195 
$ty³
 = 
$¬g
;

196 
	`dru·l_£t_t™Ë
(
	`t
('add‚ew %ty³', 
	`¬¿y
('%ty³' => 
$ty³s
[
$ty³
])));

197 
$ed™
 = 
	`¬¿y
('name' => 'profile_');

198 
$fÜm
['ty³'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$ty³
);

200 
$ed™
 +ğ
	`¬¿y
(

210 
$fÜm
['f›lds'] = 
	`¬¿y
('#type' => 'fieldset',

211 '#t™Ë' => 
	`t
('Field settings'),

213 
$fÜm
['f›lds']['ÿ‹gÜy'] = 
	`¬¿y
('#type' => 'textfield',

214 '#t™Ë' => 
	`t
('Category'),

215 '#deçuÉ_v®ue' => 
$ed™
['category'],

217 '#desütiÚ' => 
	`t
('The categoryhe‚ew field should be…art of. Categories‡re usedo group fields†ogically. Anƒxample category is "Personal information".'),

218 '#»quœed' => 
TRUE
,

220 
$fÜm
['f›lds']['t™Ë'] = 
	`¬¿y
('#type' => 'textfield',

221 '#t™Ë' => 
	`t
('Title'),

222 '#deçuÉ_v®ue' => 
$ed™
['title'],

223 '#desütiÚ' => 
	`t
('Theitle ofhe‚ew field. Theitle will be shownohe user. Anƒxampleitle is "Favorite color".'),

224 '#»quœed' => 
TRUE
,

226 
$fÜm
['f›lds']['Çme'] = 
	`¬¿y
('#type' => 'textfield',

227 '#t™Ë' => 
	`t
('Form‚ame'),

228 '#deçuÉ_v®ue' => 
$ed™
['name'],

229 '#desütiÚ' => 
	`t
('The‚ame ofhe field. The form‚ame is‚ot shownohe user but used internally inhe HTML code‡nd URLs.

230 
UÆess
 
you
 
know
 
wh©
 you 
¬e
 
došg
, 
™
 
is
 
highly
 
»comm’ded
 
th©
 you 
´efix
 
the
 
fÜm
 
Çme
 
w™h
 <
code
>
´ofe_
</code> 
to
 
avoid
‚am
şashes
 w™h 
Ùh”
 
f›lds
. 
S·ûs
 
Ü
 
ªy
 oth” 
¥ecŸl
 
ch¬aù”s
 
exû±
 
	`dash
 (-è
ªd
 
	`und”scÜe
 (
_
è¬
nÙ
 
®lowed
. 
An
 
exam¶e
‚ami "´ofe_çvÜ™e_cŞÜ" o¸
³rh­s
 
ju¡
 "profile_color".'),

231 '#»quœed' => 
TRUE
,

233 
$fÜm
['f›lds']['ex¶ª©iÚ'] = 
	`¬¿y
('#type' => 'textarea',

234 '#t™Ë' => 
	`t
('Explanation'),

235 '#deçuÉ_v®ue' => 
$ed™
['explanation'],

236 '#desütiÚ' => 
	`t
('An optionalƒxplanationo go withhe‚ew field. Theƒxplanation will be shownohe user.'),

238 ià(
$ty³
 == 'selection') {

239 
$fÜm
['f›lds']['İtiÚs'] = 
	`¬¿y
('#type' => 'textarea',

240 '#t™Ë' => 
	`t
('Selection options'),

241 '#deçuÉ_v®ue' => 
	`is£t
(
$ed™
['options']) ? $edit['options'] : '',

242 '#desütiÚ' => 
	`t
('A†ist of‡ll options. Putƒach option on‡ separate†ine. Example options‡re "red", "blue", "green",ƒtc.'),

245 
$fÜm
['f›lds']['visib™y'] = 
	`¬¿y
('#type' => 'radios',

246 '#t™Ë' => 
	`t
('Visibility'),

247 '#deçuÉ_v®ue' => 
	`is£t
(
$ed™
['visib™y']è? $ed™['visib™y'] : 
PROFILE_PUBLIC
,

248 '#İtiÚs' => 
	`¬¿y
(
PROFILE_HIDDEN
 => 
	`t
('Hidd’…roff›ld, oÆy‡cûssibË by‡dmši¡¿tÜs, moduË ªdhemes.'), 
PROFILE_PRIVATE
 =>('Priv©f›ld, cÚ‹Á oÆy‡vaabËØ´iveged u£rs.'), 
PROFILE_PUBLIC
 =>('Publiøf›ld, cÚ‹Á showÀÚ…rof·gbuˆnÙ u£d oÀmemb”†i¡…ages.'), 
PROFILE_PUBLIC_LISTINGS
 =>('Public field, content shown on…rofile…age‡nd on member†ist…ages.')),

250 ià(
$ty³
 == 'selection' || $type == 'list' || $type == 'textfield') {

251 
$fÜm
['f›lds']['·ge'] = 
	`¬¿y
('#type' => 'textfield',

252 '#t™Ë' => 
	`t
('Pageitle'),

253 '#deçuÉ_v®ue' => 
$ed™
['page'],

254 '#desütiÚ' => 
	`t
('Toƒnable browsinghis field by value,ƒnter‡itle forhe„esulting…age. The word <code>%value</code> will be substituted withhe corresponding value. Anƒxample…ageitle is "People whose favorite color is %value". This is only‡pplicable for‡…ublic field.'),

257 ià(
$ty³
 == 'checkbox') {

258 
$fÜm
['f›lds']['·ge'] = 
	`¬¿y
('#type' => 'textfield',

259 '#t™Ë' => 
	`t
('Pageitle'),

260 '#deçuÉ_v®ue' => 
$ed™
['page'],

261 '#desütiÚ' => 
	`t
('Toƒnable browsinghis field by value,ƒnter‡itle forhe„esulting…age. Anƒxample…ageitle is "People who‡reƒmployed". This is only‡pplicable for‡…ublic field.'),

264 
$fÜm
['f›lds']['weight'] = 
	`¬¿y
('#type' => 'weight',

265 '#t™Ë' => 
	`t
('Weight'),

266 '#deçuÉ_v®ue' => 
$ed™
['weight'],

267 '#desütiÚ' => 
	`t
('The weights definehe order in whichhe form fields‡re shown. Lighter fields "float up"owardsheop ofhe category.'),

269 
$fÜm
['f›lds']['autocom¶‘e'] = 
	`¬¿y
('#type' => 'checkbox',

270 '#t™Ë' => 
	`t
('Form will‡uto-complete while user isyping.'),

271 '#deçuÉ_v®ue' => 
$ed™
['autocomplete'],

272 '#desütiÚ' => 
	`t
('For security,‡uto-complete will be disabled ifhe user does‚ot have‡ccesso user…rofiles.'),

274 
$fÜm
['f›lds']['»quœed'] = 
	`¬¿y
('#type' => 'checkbox',

275 '#t™Ë' => 
	`t
('The user mustƒnter‡ value.'),

276 '#deçuÉ_v®ue' => 
$ed™
['required'],

278 
$fÜm
['f›lds']['»gi¡”'] = 
	`¬¿y
('#type' => 'checkbox',

279 '#t™Ë' => 
	`t
('Visible in user„egistration form.'),

280 '#deçuÉ_v®ue' => 
$ed™
['register'],

282 
$fÜm
['subm™'] = 
	`¬¿y
('#type' => 'submit',

283 '#v®ue' => 
	`t
('Save field'),

285  
$fÜm
;

286 
	}
}

291 
funùiÚ
 
	$´ofe_f›ld_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

293 ià(
	`´eg_m©ch
('/[^a-zA-Z0-9_-]/', 
$fÜm_¡©e
['values']['name'])) {

294 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('The specified form‚ame contains one or more illegal characters. Spaces or‡ny other special charactersƒxcept dash (-)‡nd underscore (_)‡re‚ot‡llowed.'));

297 ià(
	`š_¬¿y
(
$fÜm_¡©e
['v®ues']['Çme'], 
	`u£r_f›lds
())) {

298 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('The specified form‚ame is„eserved for use by Drupal.'));

301 ià(!
$fÜm_¡©e
['values']['category']) {

302 
	`fÜm_£t_”rÜ
('ÿ‹gÜy', 
	`t
('You mustƒnter‡ category.'));

304 ià(
	`¡¹Şow”
(
$fÜm_¡©e
['values']['category']) == 'account') {

305 
	`fÜm_£t_”rÜ
('ÿ‹gÜy', 
	`t
('The specified category‚ame is„eserved for use by Drupal.'));

307 
$¬gs1
 = 
	`¬¿y
(
$fÜm_¡©e
['values']['title'], $form_state['values']['category']);

308 
$¬gs2
 = 
	`¬¿y
(
$fÜm_¡©e
['values']['name']);

309 
$qu”y_suffix
 = '';

311 ià(
	`is£t
(
$fÜm_¡©e
['values']['fid'])) {

312 
$¬gs1
[] = 
$¬gs2
[] = 
$fÜm_¡©e
['values']['fid'];

313 
$qu”y_suffix
 = ' AND fid != %d';

316 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT fid FROM {´ofe_f›lds} WHERE™Ë = '%s' AND c©egÜy = '%s'". 
$qu”y_suffix
, 
$¬gs1
))) {

317 
	`fÜm_£t_”rÜ
('t™Ë', 
	`t
('The specifieditle is‡lready in use.'));

319 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT fid FROM {´ofe_f›lds} WHERE‚amğ'%s'". 
$qu”y_suffix
, 
$¬gs2
))) {

320 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('The specified‚ame is‡lready in use.'));

322 ià(
$fÜm_¡©e
['v®ues']['visib™y'] =ğ
PROFILE_HIDDEN
) {

323 ià(
$fÜm_¡©e
['values']['required']) {

324 
	`fÜm_£t_”rÜ
('»quœed', 
	`t
('A hidden field cannot be„equired.'));

326 ià(
$fÜm_¡©e
['values']['register']) {

327 
	`fÜm_£t_”rÜ
('»gi¡”', 
	`t
('A hidden field cannot be seto visible onhe user„egistration form.'));

330 
	}
}

335 
funùiÚ
 
	$´ofe_f›ld_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

336 ià(!
	`is£t
(
$fÜm_¡©e
['values']['options'])) {

337 
$fÜm_¡©e
['values']['options'] = '';

339 ià(!
	`is£t
(
$fÜm_¡©e
['values']['page'])) {

340 
$fÜm_¡©e
['values']['page'] = '';

342 ià(!
	`is£t
(
$fÜm_¡©e
['values']['fid'])) {

343 
	`db_qu”y
("INSERT INTO {´ofe_f›lds} (t™Ë,‚ame,ƒx¶ª©iÚ, c©egÜy,y³, weight,„equœed,„egi¡”, visib™y,‡utocom¶‘e, o±iÚs,…ageèVALUES ('%s', '%s', '%s', '%s', '%s', %d, %d, %d, %d, %d, '%s', '%s')", 
$fÜm_¡©e
['values']['title'], $form_state['values']['name'], $form_state['values']['explanation'], $form_state['values']['category'], $form_state['values']['type'], $form_state['values']['weight'], $form_state['values']['required'], $form_state['values']['register'], $form_state['values']['visibility'], $form_state['values']['autocomplete'], $form_state['values']['options'], $form_state['values']['page']);

345 
	`dru·l_£t_mes§ge
(
	`t
('The field has been created.'));

346 
	`w©chdog
('´ofe', 'Proff›ld %f›ld‡dded und” c©egÜy %ÿ‹gÜy.', 
	`¬¿y
('%f›ld' => 
$fÜm_¡©e
['v®ues']['t™Ë'], '%ÿ‹gÜy' => $fÜm_¡©e['v®ues']['ÿ‹gÜy']), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('view'), 'admin/user/profile'));

349 
	`db_qu”y
("UPDATE {´ofe_f›lds} SET™Ë = '%s',‚amğ'%s',ƒx¶ª©iÚ = '%s', c©egÜy = '%s', weighˆğ%d,„equœed = %d,„egi¡” = %d, visib™y = %d,‡utocom¶‘ğ%d, o±iÚ ğ'%s',…agğ'%s' WHERE fid = %d", 
$fÜm_¡©e
['values']['title'], $form_state['values']['name'], $form_state['values']['explanation'], $form_state['values']['category'], $form_state['values']['weight'], $form_state['values']['required'], $form_state['values']['register'], $form_state['values']['visibility'], $form_state['values']['autocomplete'], $form_state['values']['options'], $form_state['values']['page'], $form_state['values']['fid']);

351 
	`dru·l_£t_mes§ge
(
	`t
('The field has been updated.'));

353 
	`ÿche_ş—r_®l
();

354 
	`m’u_»bud
();

356 
$fÜm_¡©e
['redirect'] = 'admin/user/profile';

358 
	}
}

363 
funùiÚ
 
	$´ofe_f›ld_d–‘e
(&
$fÜm_¡©e
, 
$fid
) {

364 
$f›ld
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT™Ë FROM {´ofe_f›lds} WHERE fid = %d", 
$fid
));

365 ià(!
$f›ld
) {

366 
	`dru·l_nÙ_found
();

369 
$fÜm
['fid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$fid
);

370 
$fÜm
['t™Ë'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$f›ld
->
t™Ë
);

372  
	`cÚfœm_fÜm
(
$fÜm
,

373 
	`t
('A» you su» you wªˆtØd–‘thf›ld %f›ld?', 
	`¬¿y
('%f›ld' => 
$f›ld
->
t™Ë
)), 'admin/user/profile',

374 
	`t
('Thi aùiÚ cªnÙ bundÚe. Iàu£r hav’‹»d v®ue štØthi f›ld iÀtheœ…rofe,he£ƒÁr› wÈ®sØbd–‘ed. Iàyou wªˆtØk“°thu£r-’‹»d d©a, in¡—d oàd–‘šghf›ld you may wishØ<¨h»f="@ed™-f›ld">ed™hi f›ld</a>‡nd chªg™Ø¨hidd’…roff›ld sØth© iˆmay oÆy bacûs£d by‡dmši¡¿tÜs.', 
	`¬¿y
('@ed™-f›ld' => 
	`u¾
('admš/u£r/´ofe/ed™/'. 
$fid
))),

375 
	`t
('Delete'),('Cancel'));

376 
	}
}

381 
funùiÚ
 
	$´ofe_f›ld_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

382 
	`db_qu”y
('DELETE FROM {´ofe_f›lds} WHERE fid = %d', 
$fÜm_¡©e
['values']['fid']);

383 
	`db_qu”y
('DELETE FROM {´ofe_v®ues} WHERE fid = %d', 
$fÜm_¡©e
['values']['fid']);

385 
	`ÿche_ş—r_®l
();

387 
	`dru·l_£t_mes§ge
(
	`t
('Thf›ld %f›ld ha b“Àd–‘ed.', 
	`¬¿y
('%f›ld' => 
$fÜm_¡©e
['values']['title'])));

388 
	`w©chdog
('´ofe', 'Proff›ld %f›ld d–‘ed.', 
	`¬¿y
('%f›ld' => 
$fÜm_¡©e
['v®ues']['t™Ë']), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('view'), 'admin/user/profile'));

390 
$fÜm_¡©e
['redirect'] = 'admin/user/profile';

392 
	}
}

397 
funùiÚ
 
	$´ofe_admš_£‰šgs_autocom¶‘e
(
$¡ršg
) {

398 
$m©ches
 = 
	`¬¿y
();

399 
$»suÉ
 = 
	`db_qu”y_¿nge
("SELECT c©egÜy FROM {´ofe_f›lds} WHERE LOWER(ÿ‹gÜyèLIKE LOWER('%s%%')", 
$¡ršg
, 0, 10);

400 
$d©a
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

401 
$m©ches
[
$d©a
->
ÿ‹gÜy
] = 
	`check_¶aš
($data->category);

403 
	`dru·l_jsÚ
(
$m©ches
);

404 
	}
}

	@/srv/http/subs/notes/www/modules/profile/profile.module

1 <?
php


12 
defše
('PROFILE_PRIVATE', 1);

17 
defše
('PROFILE_PUBLIC', 2);

22 
defše
('PROFILE_PUBLIC_LISTINGS', 3);

27 
defše
('PROFILE_HIDDEN', 4);

32 
funùiÚ
 
	$´ofe_h–p
(
$·th
, 
$¬g
) {

33 
$·th
) {

35 
$ouut
 = '<p>'. 
	`t
('The…rofile module‡llows custom fields (such‡s country, full‚ame, or‡ge)o be defined‡nd displayed inhe <em>My Account</em> section. This…ermits users of‡ siteo share more information‡bouthemselves,‡nd can help community-based sites organize users‡round specific information.') .'</p>';

36 
$ouut
 .ğ'<p>'. 
	`t
('The followingypes of fields can be‡ddedo‡ user…rofile:') .'</p>';

37 
$ouut
 .ğ'<ul><li>'. 
	`t
('single-lineextfield') .'</li>';

38 
$ouut
 .ğ'<li>'. 
	`t
('multi-lineextfield') .'</li>';

39 
$ouut
 .ğ'<li>'. 
	`t
('checkbox') .'</li>';

40 
$ouut
 .ğ'<li>'. 
	`t
('list selection') .'</li>';

41 
$ouut
 .ğ'<li>'. 
	`t
('freeform†ist') .'</li>';

42 
$ouut
 .ğ'<li>'. 
	`t
('URL') .'</li>';

43 
$ouut
 .ğ'<li>'. 
	`t
('date') .'</li></ul>';

44 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@´ofe">ProfmoduË</a>.', 
	`¬¿y
('@profile' => 'http://drupal.org/handbook/modules/profile/')) .'</p>';

45  
$ouut
;

47  '<p>'. 
	`t
("This…age displays‡†ist ofheƒxisting custom…rofile fieldso be displayed on‡ user's <em>My Account</em>…age. To…rovide structure, similar or„elated fields may be…laced inside‡ category. To‡dd‡‚ew category (orƒdit‡nƒxisting one),ƒdit‡…rofile field‡nd…rovide‡‚ew category‚ame. To changehe category of‡ field orhe order of fields within‡ category, grab‡ drag-and-drop handle underhe Title column‡nd draghe fieldo‡‚ew†ocation inhe†ist. (Grab‡ handle by clicking‡nd holdinghe mouse while hovering over‡ handle icon.) Rememberhat your changes will‚ot be saved until you clickhe <em>Save configuration</em> button‡the bottom ofhe…age.") .'</p>';

49 
	}
}

54 
funùiÚ
 
	$´ofe_theme
() {

55  
	`¬¿y
(

56 '´ofe_block' => 
	`¬¿y
(

57 '¬gum’ts' => 
	`¬¿y
('accouÁ' => 
NULL
, 'fields' =>‡rray()),

60 '´ofe_li¡šg' => 
	`¬¿y
(

61 '¬gum’ts' => 
	`¬¿y
('accouÁ' => 
NULL
, 'fields' =>‡rray()),

64 '´ofe_w¿µ”' => 
	`¬¿y
(

65 '¬gum’ts' => 
	`¬¿y
('cÚ‹Á' => 
NULL
),

68 '´ofe_admš_ov”v›w' => 
	`¬¿y
(

69 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

73 
	}
}

78 
funùiÚ
 
	$´ofe_m’u
() {

79 
$™ems
['´ofe'] = 
	`¬¿y
(

82 'acûs ¬gum’ts' => 
	`¬¿y
('access user…rofiles'),

83 'ty³' => 
MENU_SUGGESTED_ITEM
,

86 
$™ems
['admš/u£r/´ofe'] = 
	`¬¿y
(

90 '·g¬gum’ts' => 
	`¬¿y
('profile_admin_overview'),

91 'acûs ¬gum’ts' => 
	`¬¿y
('administer users'),

94 
$™ems
['admš/u£r/´ofe/add'] = 
	`¬¿y
(

97 '·g¬gum’ts' => 
	`¬¿y
('profile_field_form'),

98 'acûs ¬gum’ts' => 
	`¬¿y
('administer users'),

99 'ty³' => 
MENU_CALLBACK
,

102 
$™ems
['admš/u£r/´ofe/autocom¶‘e'] = 
	`¬¿y
(

105 'acûs ¬gum’ts' => 
	`¬¿y
('administer users'),

106 'ty³' => 
MENU_CALLBACK
,

109 
$™ems
['admš/u£r/´ofe/ed™'] = 
	`¬¿y
(

112 '·g¬gum’ts' => 
	`¬¿y
('profile_field_form'),

113 'acûs ¬gum’ts' => 
	`¬¿y
('administer users'),

114 'ty³' => 
MENU_CALLBACK
,

117 
$™ems
['admš/u£r/´ofe/d–‘e'] = 
	`¬¿y
(

120 '·g¬gum’ts' => 
	`¬¿y
('profile_field_delete'),

121 'acûs ¬gum’ts' => 
	`¬¿y
('administer users'),

122 'ty³' => 
MENU_CALLBACK
,

125 
$™ems
['´ofe/autocom¶‘e'] = 
	`¬¿y
(

128 'acûs ¬gum’ts' => 
	`¬¿y
('access user…rofiles'),

129 'ty³' => 
MENU_CALLBACK
,

132  
$™ems
;

133 
	}
}

138 
funùiÚ
 
´ofe_block
(
$İ
 = 'li¡', 
$d–
 = 0, 
$ed™
 = 
	$¬¿y
()) {

140 ià(
$İ
 == 'list') {

141 
$blocks
[0]['šfo'] = 
	`t
('Author information');

142 
$blocks
[0]['ÿche'] = 
BLOCK_CACHE_PER_PAGE
 | 
BLOCK_CACHE_PER_ROLE
;

143  
$blocks
;

145 ià(
$İ
 =ğ'cÚfigu»' && 
$d–
 == 0) {

147 
$f›lds
 = 
	`¬¿y
();

148 
$»suÉ
 = 
	`db_qu”y
('SELECT‚ame,™Ë, weight, visib™y FROM {´ofe_f›lds} WHERE visib™y IN (%d, %dèORDER BY weight', 
PROFILE_PUBLIC
, 
PROFILE_PUBLIC_LISTINGS
);

149 
$»cÜd
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

150 
$f›lds
[
$»cÜd
->
Çme
] = 
	`check_¶aš
($»cÜd->
t™Ë
);

152 
$f›lds
['u£r_´ofe'] = 
	`t
('Linko full user…rofile');

153 
$fÜm
['´ofe_block_authÜ_f›lds'] = 
	`¬¿y
('#type' => 'checkboxes',

154 '#t™Ë' => 
	`t
('Profile fieldso display'),

155 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('´ofe_block_authÜ_f›lds', 
	`¬¿y
()),

156 '#İtiÚs' => 
$f›lds
,

157 '#desütiÚ' => 
	`t
('S–eù which…roff›ld you wishØdi¥Ïy iÀthblock. OÆy f›ld desigÇ‹d‡ publiøšh<¨h»f="@´ofe-admš">´off›ld cÚfigu¿tiÚ</a>‡»‡vaabË.', 
	`¬¿y
('@´ofe-admš' => 
	`u¾
('admin/user/profile'))),

159  
$fÜm
;

161 ià(
$İ
 =ğ'§ve' && 
$d–
 == 0) {

162 
	`v¬ŸbË_£t
('´ofe_block_authÜ_f›lds', 
$ed™
['profile_block_author_fields']);

164 ià(
$İ
 == 'view') {

165 ià(
	`u£r_acûss
('access user…rofiles')) {

166 
$ouut
 = '';

167 ià((
	`¬g
(0è=ğ'node'è&& 
	`is_num”ic
×rg(1)è&& (¬g(2è=ğ
NULL
)) {

168 
$node
 = 
	`node_lßd
(
	`¬g
(1));

169 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => 
$node
->
uid
));

171 ià(
$u£_f›lds
 = 
	`v¬ŸbË_g‘
('´ofe_block_authÜ_f›lds', 
	`¬¿y
())) {

173 
$f›lds
 = 
	`¬¿y
();

174 
$»suÉ
 = 
	`db_qu”y
('SELECT‚ame,™Ë,y³, visib™y, weighˆFROM {´ofe_f›lds} WHERE visib™y IN (%d, %dèORDER BY weight', 
PROFILE_PUBLIC
, 
PROFILE_PUBLIC_LISTINGS
);

175 
$»cÜd
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

177 ià(
	`is£t
(
$u£_f›lds
[
$»cÜd
->
Çme
]) && $use_fields[$record->name]) {

178 
$f›lds
[] = 
$»cÜd
;

183 ià(!
	`em±y
(
$f›lds
)) {

184 
$´ofe
 = 
	`_´ofe_upd©e_u£r_f›lds
(
$f›lds
, 
$accouÁ
);

185 
$ouut
 .ğ
	`theme
('´ofe_block', 
$accouÁ
, 
$´ofe
, 
TRUE
);

188 ià(
	`is£t
(
$u£_f›lds
['user_profile']) && $use_fields['user_profile']) {

189 
$ouut
 .ğ'<div>'. 
	`l
(
	`t
('V›w fuÎ u£¸´ofe'), 'u£r/'. 
$accouÁ
->
uid
) .'</div>';

193 ià(
$ouut
) {

194 
$block
['subjeù'] = 
	`t
('Abouˆ%Çme', 
	`¬¿y
('%Çme' => 
$accouÁ
->
Çme
));

195 
$block
['cÚ‹Á'] = 
$ouut
;

196  
$block
;

200 
	}
}

205 
funùiÚ
 
	$´ofe_u£r
(
$ty³
, &
$ed™
, &
$u£r
, 
$ÿ‹gÜy
 = 
NULL
) {

206 
$ty³
) {

208  
	`´ofe_lßd_´ofe
(
$u£r
);

210  
	`´ofe_fÜm_´ofe
(
$ed™
, 
$u£r
, 
$ÿ‹gÜy
, 
TRUE
);

212  
	`´ofe_§ve_´ofe
(
$ed™
, 
$u£r
, 
$ÿ‹gÜy
);

214  
	`´ofe_§ve_´ofe
(
$ed™
, 
$u£r
, 
$ÿ‹gÜy
, 
TRUE
);

216  
	`´ofe_v›w_´ofe
(
$u£r
);

218  
	`´ofe_fÜm_´ofe
(
$ed™
, 
$u£r
, 
$ÿ‹gÜy
);

220  
	`´ofe_v®id©e_´ofe
(
$ed™
, 
$ÿ‹gÜy
);

222  
	`´ofe_ÿ‹gÜ›s
();

224 
	`db_qu”y
('DELETE FROM {´ofe_v®ues} WHERE uid = %d', 
$u£r
->
uid
);

226 
	}
}

228 
funùiÚ
 
	$´ofe_lßd_´ofe
(&
$u£r
) {

229 
$»suÉ
 = 
	`db_qu”y
('SELECT f.Çme, f.ty³, v.v®uFROM {´ofe_f›lds} f INNER JOIN {´ofe_v®ues} v ON f.fid = v.fid WHERE uid = %d', 
$u£r
->
uid
);

230 
$f›ld
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

231 ià(
	`em±y
(
$u£r
->{
$f›ld
->
Çme
})) {

232 
$u£r
->{
$f›ld
->
Çme
} = 
	`_´ofe_f›ld_£rŸlize
($f›ld->
ty³
è? 
	`un£rŸlize
($f›ld->
v®ue
) : $field->value;

235 
	}
}

237 
funùiÚ
 
	$´ofe_§ve_´ofe
(&
$ed™
, &
$u£r
, 
$ÿ‹gÜy
, 
$»gi¡”
 = 
FALSE
) {

238 
$»suÉ
 = 
	`_´ofe_g‘_f›lds
(
$ÿ‹gÜy
, 
$»gi¡”
);

239 
$f›ld
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

240 ià(
	`_´ofe_f›ld_£rŸlize
(
$f›ld
->
ty³
)) {

241 
$ed™
[
$f›ld
->
Çme
] = 
	`£rŸlize
($edit[$field->name]);

243 
	`db_qu”y
("DELETE FROM {´ofe_v®ues} WHERE fid = %d AND uid = %d", 
$f›ld
->
fid
, 
$u£r
->
uid
);

244 
	`db_qu”y
("INSERT INTO {´ofe_v®ues} (fid, uid, v®ueèVALUES (%d, %d, '%s')", 
$f›ld
->
fid
, 
$u£r
->
uid
, 
$ed™
[$f›ld->
Çme
]);

246 
$ed™
[
$f›ld
->
Çme
] = 
NULL
;

248 
	}
}

250 
funùiÚ
 
	$´ofe_v›w_f›ld
(
$u£r
, 
$f›ld
) {

254 
$brow£
 = 
	`u£r_acûss
('access user…rofiles')

255 && (
	`u£r_acûss
('admši¡” u£rs'è|| 
$f›ld
->
visib™y
 !ğ
PROFILE_PRIVATE
)

256 && !
	`em±y
(
$f›ld
->
·ge
);

258 ià(
	`is£t
(
$u£r
->{
$f›ld
->
Çme
}è&& 
$v®ue
 = $user->{$field->name}) {

259 
$f›ld
->
ty³
) {

261  
	`check_m¬kup
(
$v®ue
);

264  
$brow£
 ? 
	`l
(
$v®ue
, '´ofe/'. 
$f›ld
->
Çme
 .'/'. $v®ueè: 
	`check_¶aš
($value);

266  
$brow£
 ? 
	`l
(
$f›ld
->
t™Ë
, '´ofe/'. $f›ld->
Çme
è: 
	`check_¶aš
($field->title);

268  '<¨h»f="'. 
	`check_u¾
(
$v®ue
è.'">'. 
	`check_¶aš
($value) .'</a>';

270 
$fÜm©
 = 
	`sub¡r
(
	`v¬ŸbË_g‘
('date_format_short', 'm/d/Y - H:i'), 0, 5);

274 
$»¶aû
 = 
	`¬¿y
(

275 'd' => 
	`¥rštf
('%02d', 
$v®ue
['day']),

276 'j' => 
$v®ue
['day'],

277 'm' => 
	`¥rštf
('%02d', 
$v®ue
['month']),

278 'M' => 
	`m­_mÚth
(
$v®ue
['month']),

279 'Y' => 
$v®ue
['year'],

280 'H:i' => 
NULL
,

281 'g:Ÿ' => 
NULL
,

283  
	`¡¹r
(
$fÜm©
, 
$»¶aû
);

285 
$v®ues
 = 
	`¥l™
("[,\n\r]", 
$v®ue
);

286 
$f›lds
 = 
	`¬¿y
();

287 
	`fÜ—ch
 (
$v®ues
 
as
 
$v®ue
) {

288 ià(
$v®ue
 = 
	`Œim
($value)) {

289 
$f›lds
[] = 
$brow£
 ? 
	`l
(
$v®ue
, '´ofe/'. 
$f›ld
->
Çme
 .'/'. $v®ueè: 
	`check_¶aš
($value);

292  
	`im¶ode
(', ', 
$f›lds
);

295 
	}
}

297 
funùiÚ
 
	$´ofe_v›w_´ofe
(&
$u£r
) {

299 
	`´ofe_lßd_´ofe
(
$u£r
);

302 ià(
	`u£r_acûss
('admši¡” u£rs'è|| 
$GLOBALS
['u£r']->
uid
 =ğ
$u£r
->uid) {

303 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {´ofe_f›lds} WHERE visib™y !ğ%d ORDER BY c©egÜy, weight', 
PROFILE_HIDDEN
);

306 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {´ofe_f›lds} WHERE visib™y !ğ%d AND visib™y !ğ%d ORDER BY c©egÜy, weight', 
PROFILE_PRIVATE
, 
PROFILE_HIDDEN
);

309 
$f›lds
 = 
	`¬¿y
();

310 
$f›ld
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

311 ià(
$v®ue
 = 
	`´ofe_v›w_f›ld
(
$u£r
, 
$f›ld
)) {

312 
$t™Ë
 = (
$f›ld
->
ty³
 !ğ'checkbox'è? 
	`check_¶aš
($f›ld->
t™Ë
è: 
NULL
;

315 ià(!
	`is£t
(
$u£r
->
cÚ‹Á
[
$f›ld
->
ÿ‹gÜy
])) {

316 
$u£r
->
cÚ‹Á
[
$f›ld
->
ÿ‹gÜy
] = 
	`¬¿y
(

318 '#t™Ë' => 
$f›ld
->
ÿ‹gÜy
,

322 
$u£r
->
cÚ‹Á
[
$f›ld
->
ÿ‹gÜy
][$f›ld->
Çme
] = 
	`¬¿y
(

324 '#t™Ë' => 
$t™Ë
,

325 '#v®ue' => 
$v®ue
,

326 '#weight' => 
$f›ld
->
weight
,

327 '#©Œibu‹s' => 
	`¬¿y
('şass' => '´ofe-'. 
$f›ld
->
Çme
),

331 
	}
}

333 
funùiÚ
 
	$_´ofe_fÜm_ex¶ª©iÚ
(
$f›ld
) {

334 
$ouut
 = 
$f›ld
->
ex¶ª©iÚ
;

336 ià(
$f›ld
->
ty³
 == 'list') {

337 
$ouut
 .ğ' '. 
	`t
('Putƒach item on‡ separate†ine or separatehem by commas. No HTML‡llowed.');

340 ià(
$f›ld
->
visib™y
 =ğ
PROFILE_PRIVATE
) {

341 
$ouut
 .ğ' '. 
	`t
('The content ofhis field is kept…rivate‡nd will‚ot be shown…ublicly.');

344  
$ouut
;

345 
	}
}

347 
funùiÚ
 
	$´ofe_fÜm_´ofe
(
$ed™
, 
$u£r
, 
$ÿ‹gÜy
, 
$»gi¡”
 = 
FALSE
) {

348 
$»suÉ
 = 
	`_´ofe_g‘_f›lds
(
$ÿ‹gÜy
, 
$»gi¡”
);

349 
$weight
 = 1;

350 
$f›lds
 = 
	`¬¿y
();

351 
$f›ld
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

352 
$ÿ‹gÜy
 = 
$f›ld
->
ÿ‹gÜy
;

353 ià(!
	`is£t
(
$f›lds
[
$ÿ‹gÜy
])) {

354 
$f›lds
[
$ÿ‹gÜy
] = 
	`¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
	`check_¶aš
($ÿ‹gÜy), '#weight' => 
$weight
++);

356 
$f›ld
->
ty³
) {

359 
$f›lds
[
$ÿ‹gÜy
][
$f›ld
->
Çme
] = 
	`¬¿y
('#type' => 'textfield',

360 '#t™Ë' => 
	`check_¶aš
(
$f›ld
->
t™Ë
),

361 '#deçuÉ_v®ue' => 
	`is£t
(
$ed™
[
$f›ld
->
Çme
]) ? $edit[$field->name] : '',

363 '#desütiÚ' => 
	`_´ofe_fÜm_ex¶ª©iÚ
(
$f›ld
),

364 '#»quœed' => 
$f›ld
->
»quœed
,

366 ià(
$f›ld
->
autocom¶‘e
) {

367 
$f›lds
[
$ÿ‹gÜy
][
$f›ld
->
Çme
]['#autocom¶‘e_·th'] = "´ofe/autocom¶‘e/". $f›ld->
fid
;

371 
$f›lds
[
$ÿ‹gÜy
][
$f›ld
->
Çme
] = 
	`¬¿y
('#type' => 'textarea',

372 '#t™Ë' => 
	`check_¶aš
(
$f›ld
->
t™Ë
),

373 '#deçuÉ_v®ue' => 
	`is£t
(
$ed™
[
$f›ld
->
Çme
]) ? $edit[$field->name] : '',

374 '#desütiÚ' => 
	`_´ofe_fÜm_ex¶ª©iÚ
(
$f›ld
),

375 '#»quœed' => 
$f›ld
->
»quœed
,

379 
$f›lds
[
$ÿ‹gÜy
][
$f›ld
->
Çme
] = 
	`¬¿y
('#type' => 'textarea',

380 '#t™Ë' => 
	`check_¶aš
(
$f›ld
->
t™Ë
),

381 '#deçuÉ_v®ue' => 
	`is£t
(
$ed™
[
$f›ld
->
Çme
]) ? $edit[$field->name] : '',

382 '#desütiÚ' => 
	`_´ofe_fÜm_ex¶ª©iÚ
(
$f›ld
),

383 '#»quœed' => 
$f›ld
->
»quœed
,

387 
$f›lds
[
$ÿ‹gÜy
][
$f›ld
->
Çme
] = 
	`¬¿y
('#type' => 'checkbox',

388 '#t™Ë' => 
	`check_¶aš
(
$f›ld
->
t™Ë
),

389 '#deçuÉ_v®ue' => 
	`is£t
(
$ed™
[
$f›ld
->
Çme
]) ? $edit[$field->name] : '',

390 '#desütiÚ' => 
	`_´ofe_fÜm_ex¶ª©iÚ
(
$f›ld
),

391 '#»quœed' => 
$f›ld
->
»quœed
,

395 
$İtiÚs
 = 
$f›ld
->
»quœed
 ? 
	`¬¿y
() :‡rray('--');

396 
$lšes
 = 
	`¥l™
("[\n\r]", 
$f›ld
->
İtiÚs
);

397 
	`fÜ—ch
 (
$lšes
 
as
 
$lše
) {

398 ià(
$lše
 = 
	`Œim
($line)) {

399 
$İtiÚs
[
$lše
] = $line;

402 
$f›lds
[
$ÿ‹gÜy
][
$f›ld
->
Çme
] = 
	`¬¿y
('#type' => 'select',

403 '#t™Ë' => 
	`check_¶aš
(
$f›ld
->
t™Ë
),

404 '#deçuÉ_v®ue' => 
	`is£t
(
$ed™
[
$f›ld
->
Çme
]) ? $edit[$field->name] : '',

405 '#İtiÚs' => 
$İtiÚs
,

406 '#desütiÚ' => 
	`_´ofe_fÜm_ex¶ª©iÚ
(
$f›ld
),

407 '#»quœed' => 
$f›ld
->
»quœed
,

411 
$f›lds
[
$ÿ‹gÜy
][
$f›ld
->
Çme
] = 
	`¬¿y
('#type' => 'date',

412 '#t™Ë' => 
	`check_¶aš
(
$f›ld
->
t™Ë
),

413 '#deçuÉ_v®ue' => 
	`is£t
(
$ed™
[
$f›ld
->
Çme
]) ? $edit[$field->name] : '',

414 '#desütiÚ' => 
	`_´ofe_fÜm_ex¶ª©iÚ
(
$f›ld
),

415 '#»quœed' => 
$f›ld
->
»quœed
,

420  
$f›lds
;

421 
	}
}

426 
funùiÚ
 
	$_´ofe_upd©e_u£r_f›lds
(
$f›lds
, 
$accouÁ
) {

427 
	`fÜ—ch
 (
$f›lds
 
as
 
$key
 => 
$f›ld
) {

428 
$f›lds
[
$key
]->
v®ue
 = 
	`´ofe_v›w_f›ld
(
$accouÁ
, 
$f›ld
);

430  
$f›lds
;

431 
	}
}

433 
funùiÚ
 
	$´ofe_v®id©e_´ofe
(
$ed™
, 
$ÿ‹gÜy
) {

434 
$»suÉ
 = 
	`_´ofe_g‘_f›lds
(
$ÿ‹gÜy
);

435 
$f›ld
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

436 ià(
$ed™
[
$f›ld
->
Çme
]) {

437 ià(
$f›ld
->
ty³
 == 'url') {

438 ià(!
	`v®id_u¾
(
$ed™
[
$f›ld
->
Çme
], 
TRUE
)) {

439 
	`fÜm_£t_”rÜ
(
$f›ld
->
Çme
, 
	`t
('Thv®u´ovided fÜ %f›ld i nÙ‡ v®id URL.', 
	`¬¿y
('%f›ld' => $f›ld->
t™Ë
)));

443 ià(
$f›ld
->
»quœed
 && !
	`u£r_acûss
('administer users')) {

444 
	`fÜm_£t_”rÜ
(
$f›ld
->
Çme
, 
	`t
('Thf›ld %f›ld i »quœed.', 
	`¬¿y
('%f›ld' => $f›ld->
t™Ë
)));

448  
$ed™
;

449 
	}
}

451 
funùiÚ
 
	$´ofe_ÿ‹gÜ›s
() {

452 
$»suÉ
 = 
	`db_qu”y
("SELECT DISTINCT(category) FROM {profile_fields}");

453 
$d©a
 = 
	`¬¿y
();

454 
$ÿ‹gÜy
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

455 
$d©a
[] = 
	`¬¿y
(

456 'Çme' => 
$ÿ‹gÜy
->
ÿ‹gÜy
,

457 't™Ë' => 
$ÿ‹gÜy
->
ÿ‹gÜy
,

460 'acûs ¬gum’ts' => 
	`¬¿y
(1, 
$ÿ‹gÜy
->
ÿ‹gÜy
)

463  
$d©a
;

464 
	}
}

469 
funùiÚ
 
	$´ofe_ÿ‹gÜy_acûss
(
$accouÁ
, 
$ÿ‹gÜy
) {

470 ià(
	`u£r_acûss
('admši¡” u£rs'è&& 
$accouÁ
->
uid
 > 0) {

471  
TRUE
;

474  
	`u£r_ed™_acûss
(
$accouÁ
è&& 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {´ofe_f›lds} WHERE c©egÜy = '%s' AND visib™y <> %d", 
$ÿ‹gÜy
, 
PROFILE_HIDDEN
));

476 
	}
}

487 
funùiÚ
 
	$‹m¶©e_´•roûss_´ofe_block
(&
$v¬ŸbËs
) {

489 
$v¬ŸbËs
['piùu»'] = 
	`theme
('user_picture', $variables['account']);

490 
$v¬ŸbËs
['´ofe'] = 
	`¬¿y
();

492 
	`fÜ—ch
 (
$v¬ŸbËs
['f›lds'] 
as
 
$f›ld
) {

493 ià(
$f›ld
->
v®ue
) {

494 
$v¬ŸbËs
['´ofe'][
$f›ld
->
Çme
]->
t™Ë
 = 
	`check_¶aš
($field->title);

495 
$v¬ŸbËs
['´ofe'][
$f›ld
->
Çme
]->
v®ue
 = $field->value;

496 
$v¬ŸbËs
['´ofe'][
$f›ld
->
Çme
]->
ty³
 = $field->type;

500 
	}
}

511 
funùiÚ
 
	$‹m¶©e_´•roûss_´ofe_li¡šg
(&
$v¬ŸbËs
) {

513 
$v¬ŸbËs
['piùu»'] = 
	`theme
('user_picture', $variables['account']);

514 
$v¬ŸbËs
['Çme'] = 
	`theme
('username', $variables['account']);

515 
$v¬ŸbËs
['´ofe'] = 
	`¬¿y
();

517 
	`fÜ—ch
 (
$v¬ŸbËs
['f›lds'] 
as
 
$f›ld
) {

518 ià(
$f›ld
->
v®ue
) {

519 
$v¬ŸbËs
['´ofe'][
$f›ld
->
Çme
]->
t™Ë
 = $field->title;

520 
$v¬ŸbËs
['´ofe'][
$f›ld
->
Çme
]->
v®ue
 = $field->value;

521 
$v¬ŸbËs
['´ofe'][
$f›ld
->
Çme
]->
ty³
 = $field->type;

525 
	}
}

535 
funùiÚ
 
	$‹m¶©e_´•roûss_´ofe_w¿µ”
(&
$v¬ŸbËs
) {

536 
$v¬ŸbËs
['current_field'] = '';

537 ià(
$f›ld
 = 
	`¬g
(1)) {

538 
$v¬ŸbËs
['cu¼’t_f›ld'] = 
$f›ld
;

540 
$v¬ŸbËs
['‹m¶©e_fes'][] = '´ofe-w¿µ”-'. 
$f›ld
;

542 
	}
}

544 
funùiÚ
 
	$_´ofe_f›ld_ty³s
(
$ty³
 = 
NULL
) {

545 
$ty³s
 = 
	`¬¿y
('‹xtf›ld' => 
	`t
('single-lineextfield'),

546 '‹x»a' => 
	`t
('multi-lineextfield'),

547 'checkbox' => 
	`t
('checkbox'),

548 '£ËùiÚ' => 
	`t
('list selection'),

549 'li¡' => 
	`t
('freeform†ist'),

550 'u¾' => 
	`t
('URL'),

551 'd©e' => 
	`t
('date'));

552  
	`is£t
(
$ty³
è? 
$ty³s
[$type] : $types;

553 
	}
}

555 
funùiÚ
 
	$_´ofe_f›ld_£rŸlize
(
$ty³
 = 
NULL
) {

556  
$ty³
 == 'date';

557 
	}
}

559 
funùiÚ
 
	$_´ofe_g‘_f›lds
(
$ÿ‹gÜy
, 
$»gi¡”
 = 
FALSE
) {

560 
$¬gs
 = 
	`¬¿y
();

561 
$sql
 = 'SELECT * FROM {profile_fields} WHERE ';

562 
$f‹rs
 = 
	`¬¿y
();

563 ià(
$»gi¡”
) {

564 
$f‹rs
[] = 'register = 1';

568 
$f‹rs
[] = "LOWER(category) = LOWER('%s')";

569 
$¬gs
[] = 
$ÿ‹gÜy
;

571 ià(!
	`u£r_acûss
('administer users')) {

572 
$f‹rs
[] = 'visibility != %d';

573 
$¬gs
[] = 
PROFILE_HIDDEN
;

575 
$sql
 .ğ
	`im¶ode
(' AND ', 
$f‹rs
);

576 
$sql
 .= ' ORDER BY category, weight';

577  
	`db_qu”y
(
$sql
, 
$¬gs
);

578 
	}
}

	@/srv/http/subs/notes/www/modules/profile/profile.pages.inc

1 <?
php


12 
funùiÚ
 
	$´ofe_brow£
() {

14 
	`li¡
(, 
$Çme
, 
$v®ue
èğ
	`¬¿y_·d
(
	`ex¶ode
('/', 
$_GET
['q'], 3), 3, '');

16 
$f›ld
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT DISTINCT(fid),y³,™Ë,…age, visib™y FROM {´ofe_f›lds} WHERE‚amğ'%s'", 
$Çme
));

18 ià(
$Çme
 && 
$f›ld
->
fid
) {

20 ià(
	`em±y
(
$f›ld
->
·ge
)) {

21 
	`dru·l_nÙ_found
();

25 ià(!
	`u£r_acûss
('admši¡” u£rs'è&& (
$f›ld
->
visib™y
 =ğ
PROFILE_PRIVATE
 || $f›ld->visib™y =ğ
PROFILE_HIDDEN
)) {

26 
	`dru·l_acûss_d’›d
();

31 
$f›lds
 = 
	`¬¿y
();

32 
$»suÉ
 = 
	`db_qu”y
('SELECT‚ame,™Ë,y³, weight,…agFROM {´ofe_f›lds} WHERE fid !ğ%d AND visib™y = %d ORDER BY weight', 
$f›ld
->
fid
, 
PROFILE_PUBLIC_LISTINGS
);

33 
$»cÜd
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

34 
$f›lds
[] = 
$»cÜd
;

38 
$¬gum’ts
 = 
	`¬¿y
(
$f›ld
->
fid
);

39 
$f›ld
->
ty³
) {

41 
$qu”y
 = 'v.value = 1';

45 
$qu”y
 = "v.value = '%s'";

46 
$¬gum’ts
[] = 
$v®ue
;

49 
$qu”y
 = "v.value LIKE '%%%s%%'";

50 
$¬gum’ts
[] = 
$v®ue
;

53 
	`dru·l_nÙ_found
();

58 
$»suÉ
 = 
	`·g”_qu”y
("SELECT u.uid, u.acûs FROM {u£rs} u INNER JOIN {´ofe_v®ues} v ON u.uid = v.uid WHERE v.fid = %d AND $qu”y AND u.acûs !ğ0 AND u.¡©u !ğ0 ORDER BY u.acûs DESC", 20, 0, 
NULL
, 
$¬gum’ts
);

60 
$cÚ‹Á
 = '';

61 
$accouÁ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

62 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => $accouÁ->
uid
));

63 
$´ofe
 = 
	`_´ofe_upd©e_u£r_f›lds
(
$f›lds
, 
$accouÁ
);

64 
$cÚ‹Á
 .ğ
	`theme
('´ofe_li¡šg', 
$accouÁ
, 
$´ofe
);

66 
$ouut
 = 
	`theme
('´ofe_w¿µ”', 
$cÚ‹Á
);

67 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 20);

69 ià(
$f›ld
->
ty³
 == 'selection' || $field->type == 'list' || $field->type == 'textfield') {

70 
$t™Ë
 = 
	`¡¹r
(
	`check_¶aš
(
$f›ld
->
·ge
), 
	`¬¿y
('%v®ue' => 
	`theme
('¶aûhŞd”', 
$v®ue
)));

73 
$t™Ë
 = 
	`check_¶aš
(
$f›ld
->
·ge
);

76 
	`dru·l_£t_t™Ë
(
$t™Ë
);

77  
$ouut
;

79 ià(
$Çme
 && !
$f›ld
->
fid
) {

80 
	`dru·l_nÙ_found
();

84 
$f›lds
 = 
	`¬¿y
();

85 
$»suÉ
 = 
	`db_qu”y
('SELECT‚ame,™Ë,y³, weight,…agFROM {´ofe_f›lds} WHERE visib™y = %d ORDER BY c©egÜy, weight', 
PROFILE_PUBLIC_LISTINGS
);

86 
$»cÜd
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

87 
$f›lds
[] = 
$»cÜd
;

91 
$»suÉ
 = 
	`·g”_qu”y
('SELECT uid,‡cûs FROM {u£rs} WHERE uid > 0 AND stu !ğ0 AND‡cûs !ğ0 ORDER BY‡cûs DESC', 20, 0, 
NULL
);

93 
$cÚ‹Á
 = '';

94 
$accouÁ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

95 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => $accouÁ->
uid
));

96 
$´ofe
 = 
	`_´ofe_upd©e_u£r_f›lds
(
$f›lds
, 
$accouÁ
);

97 
$cÚ‹Á
 .ğ
	`theme
('´ofe_li¡šg', 
$accouÁ
, 
$´ofe
);

99 
$ouut
 = 
	`theme
('´ofe_w¿µ”', 
$cÚ‹Á
);

100 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 20);

102 
	`dru·l_£t_t™Ë
(
	`t
('User†ist'));

103  
$ouut
;

105 
	}
}

110 
funùiÚ
 
	$´ofe_autocom¶‘e
(
$f›ld
, 
$¡ršg
) {

111 
$m©ches
 = 
	`¬¿y
();

112 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {´ofe_f›lds} WHERE fid = %d AND‡utocom¶‘ğ1", 
$f›ld
))) {

113 
$»suÉ
 = 
	`db_qu”y_¿nge
("SELECT v®uFROM {´ofe_v®ues} WHERE fid = %d AND LOWER(v®ueèLIKE LOWER('%s%%'èGROUP BY v®uORDER BY v®uASC", 
$f›ld
, 
$¡ršg
, 0, 10);

114 
$d©a
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

115 
$m©ches
[
$d©a
->
v®ue
] = 
	`check_¶aš
($data->value);

119 
	`dru·l_jsÚ
(
$m©ches
);

120 
	}
}

	@/srv/http/subs/notes/www/modules/search/search-block-form.tpl.php

1 <?
	gphp


35 <
div
 
	gşass
="container-inline">

36 <?
php
 
´št
 
$£¬ch_fÜm
; ?>

37 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/search/search-result.tpl.php

1 <?
	gphp


49 <
dt
 
	gşass
="title">

50 <
a
 
h»f
="<?ph°´šˆ$u¾; ?>"><?
php
 
´št
 
$t™Ë
; ?></
	ga
>

51 </
	gdt
>

52 <
	gdd
>

53 <?
php
 ià(
	g$¢³t
) : ?>

54 <
p
 
şass
="£¬ch-¢³t"><?
php
 
´št
 
$¢³t
; ?></
	gp
>

55 <?
php
 
	g’dif
; ?>

56 <?
php
 ià(
	g$šfo
) : ?>

57 <
p
 
şass
="£¬ch-šfo"><?
php
 
´št
 
$šfo
; ?></
	gp
>

58 <?
php
 
	g’dif
; ?>

59 </
	gdd
>

	@/srv/http/subs/notes/www/modules/search/search-results.tpl.php

1 <?
	gphp


24 <
dl
 
	gşass
="search-results <?php…rint $type; ?>-results">

25 <?
php
 
´št
 
$£¬ch_»suÉs
; ?>

26 </
	gdl
>

27 <?
php
 
´št
 
	g$·g”
; ?>

	@/srv/http/subs/notes/www/modules/search/search-theme-form.tpl.php

1 <?
	gphp


36 <
div
 
	gid
="£¬ch" 
şass
="container-inline">

37 <?
php
 
´št
 
$£¬ch_fÜm
; ?>

38 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/search/search.admin.inc

1 <?
php


12 
funùiÚ
 
	$£¬ch_we_cÚfœm
() {

13  
	`cÚfœm_fÜm
(
	`¬¿y
(), 
	`t
('Are you sure you wanto„e-indexhe site?'),

14 'admš/£‰šgs/£¬ch', 
	`t
(' The search index is‚ot cleared but systematically updatedo„eflecthe‚ew settings. Searching will continueo work but‚ew content won\'t be indexed until‡llƒxisting content has been„e-indexed. This‡ction cannot be undone.'),('Re-index site'),('Cancel'));

15 
	}
}

20 
funùiÚ
 
	$£¬ch_we_cÚfœm_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

21 ià(
$fÜm
['confirm']) {

22 
	`£¬ch_we
();

23 
	`dru·l_£t_mes§ge
(
	`t
('The index will be„ebuilt.'));

24 
$fÜm_¡©e
['redirect'] = 'admin/settings/search';

27 
	}
}

36 
funùiÚ
 
	$£¬ch_admš_£‰šgs
() {

38 
$»maššg
 = 0;

39 
$tÙ®
 = 0;

40 
	`fÜ—ch
 (
	`moduË_li¡
(è
as
 
$moduË
) {

41 ià(
	`moduË_hook
(
$moduË
, 'search')) {

42 
$¡©us
 = 
	`moduË_švoke
(
$moduË
, 'search', 'status');

43 
$»maššg
 +ğ
$¡©us
['remaining'];

44 
$tÙ®
 +ğ
$¡©us
['total'];

47 
$couÁ
 = 
	`fÜm©_¶u¿l
(
$»maššg
, 'There is 1 item†efto index.', 'There‡re @count items†efto index.');

48 
$³rûÁage
 = (()
	`mš
(100, 100 * (
$tÙ®
 - 
$»maššg
è/ 
	`max
(1, $total))) .'%';

49 
$¡©us
 = '<p><¡rÚg>'. 
	`t
('%³rûÁagoàths™ha b“Àšdexed.', 
	`¬¿y
('%³rûÁage' => 
$³rûÁage
)è.' '. 
$couÁ
 .'</strong></p>';

50 
$fÜm
['¡©us'] = 
	`¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
	`t
('Indexing status'));

51 
$fÜm
['¡©us']['¡©us'] = 
	`¬¿y
('#v®ue' => 
$¡©us
);

52 
$fÜm
['¡©us']['we'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Re-index site'));

54 
$™ems
 = 
	`dru·l_m­_assoc
(
	`¬¿y
(10, 20, 50, 100, 200, 500));

57 
$fÜm
['šdexšg_thrÙe'] = 
	`¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
	`t
('Indexinghrottle'));

58 
$fÜm
['šdexšg_thrÙe']['£¬ch_üÚ_lim™'] = 
	`¬¿y
('#ty³' => '£Ëù', '#t™Ë' => 
	`t
('Numb” oà™em tØšdex…” crÚ„un'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('£¬ch_üÚ_lim™', 100), '#İtiÚs' => 
$™ems
, '#desütiÚ' =>('Thmaximum‚umb” oà™em šdexed iÀ—ch…as oà¨<¨h»f="@üÚ">üÚ maš‹Çnûask</a>. IàÃûs§ry,„eduûhnumb” oà™em tØ´ev’ˆtimeout ªd memÜyƒ¼Ü whšdexšg.',‡¼ay('@üÚ' => 
	`u¾
('admin/reports/status'))));

60 
$fÜm
['šdexšg_£‰šgs'] = 
	`¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
	`t
('Indexing settings'));

61 
$fÜm
['šdexšg_£‰šgs']['šfo'] = 
	`¬¿y
('#v®ue' => 
	`t
('<p><em>Changinghe settings below will causehe site indexo be„ebuilt. The search index is‚ot cleared but systematically updatedo„eflecthe‚ew settings. Searching will continueo work but‚ew content won\'t be indexed until‡llƒxisting content has been„e-indexed.</em></p><p><em>The default settings should be‡ppropriate forhe majority of sites.</em></p>'));

62 
$fÜm
['šdexšg_£‰šgs']['mšimum_wÜd_size'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => 
	`t
('Mšimum wÜd†’gthØšdex'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('minimum_word_size', 3), '#size' => 5, '#maxlength' => 3, '#description' =>('The‚umber of characters‡ word haso beo be indexed. A†ower setting means better search„esult„anking, but‡lso‡†arger database. Each search query must contain‡t†east one keywordhat ishis size (or†onger).'));

63 
$fÜm
['šdexšg_£‰šgs']['ov”Ïp_cjk'] = 
	`¬¿y
('#ty³' => 'checkbox', '#t™Ë' => 
	`t
('Sim¶CJK hªdlšg'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('ov”Ïp_cjk', 
TRUE
), '#description' =>('Whethero‡pply‡ simple Chinese/Japanese/Koreanokenizer based on overlapping sequences. Turnhis off if you wanto use‡nƒxternal…reprocessor forhis instead. Does‚ot‡ffect other†anguages.'));

65 
$fÜm
['#v®id©e'] = 
	`¬¿y
('search_admin_settings_validate');

68 
$fÜm
 = 
	`¬¿y_m”ge
($fÜm, 
	`moduË_švoke_®l
('search', 'admin'));

69  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

70 
	}
}

75 
funùiÚ
 
	$£¬ch_admš_£‰šgs_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

76 ià(
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('Re-index site')) {

77 
	`dru·l_gÙo
('admin/settings/search/wipe');

80 ià((
	`v¬ŸbË_g‘
('mšimum_wÜd_size', 3è!ğ
$fÜm_¡©e
['values']['minimum_word_size']) ||

81 (
	`v¬ŸbË_g‘
('ov”Ïp_cjk', 
TRUE
è!ğ
$fÜm_¡©e
['values']['overlap_cjk'])) {

82 
	`dru·l_£t_mes§ge
(
	`t
('The index will be„ebuilt.'));

83 
	`£¬ch_we
();

85 
	}
}

	@/srv/http/subs/notes/www/modules/search/search.module

1 <?
php


22 
defše
('PREG_CLASS_SEARCH_EXCLUDE',

54 
defše
('PREG_CLASS_NUMBERS',

68 
defše
('PREG_CLASS_PUNCTUATION',

90 
defše
('PREG_CLASS_CJK', '\x{3041}-\x{30ff}\x{31f0}-\x{31ff}\x{3400}-\x{4db5}'.

96 
funùiÚ
 
	$£¬ch_h–p
(
$·th
, 
$¬g
) {

97 
$·th
) {

99 
$ouut
 = '<p>'. 
	`t
('The search module‡ddshe‡bilityo search for content by keywords. Search is oftenhe only…ractical wayo find content on‡†arge site,‡nd is useful for finding both users‡nd…osts.') .'</p>';

100 
$ouut
 .ğ'<p>'. 
	`t
('TØ´ovidkeywÜd s—rchšg,h£¬chƒngšmašš ª index oàwÜd found iÀyou¸s™e\' cÚ‹Á. TØbud‡nd maššhi šdex,‡ cÜ»ùly cÚfigu»d <¨h»f="@üÚ">üÚ maš‹Çnûask</a> i »quœed. Indexšg behaviÜ cª badju¡ed usšgh<¨h»f="@£¬ch£‰šgs">£¬ch s‘tšg ·ge</a>; fÜƒxam¶e,h<em>Numb” oà™em tØšdex…” crÚ„un</em> s‘ thmaximum‚umb” oà™em šdexed iÀ—ch…as oà¨<¨h»f="@üÚ">üÚ maš‹Çnûask</a>. IàÃûs§ry,„eduûhi numb”Ø´ev’ˆtimeout ªd memÜyƒ¼Ü wh’ indexšg.', 
	`¬¿y
('@üÚ' => 
	`u¾
('admin/reports/status'), '@searchsettings' => url('admin/settings/search'))) .'</p>';

101 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@£¬ch">S—rch moduË</a>.', 
	`¬¿y
('@search' => 'http://drupal.org/handbook/modules/search/')) .'</p>';

102  
$ouut
;

104  '<p>'. 
	`t
('Th£¬chƒngšmašš ª index oàwÜd found iÀyou¸s™e\' cÚ‹Á. TØbud‡nd maššhi šdex,‡ cÜ»ùly cÚfigu»d <¨h»f="@üÚ">üÚ maš‹Çnûask</a> i »quœed. Indexšg behaviÜ cª badju¡ed usšgh£‰šg b–ow.', 
	`¬¿y
('@üÚ' => 
	`u¾
('admin/reports/status'))) .'</p>';

106  
	`t
('<ul>

107 <
li
>
Check
 
your
 
¥–lšg
 
is
 
cÜ»ù
.</li>

108 <
li
>
Remove
 
quÙes
 
¬ound
 
ph¿£s
 
to
 
m©ch
 
—ch
 
wÜd
 
šdividu®ly
: <
em
>"blusmurf"</em> 
wl
 m©ch 
Ëss
 
thª
 <em>
blue
 
smurf
</em>.</li>

109 <
li
>
CÚsid”
 
loo£nšg
 
your
 
qu”y
 
w™h
 <
em
>
OR
</em>: <em>
blue
 
smurf
</em> 
wl
 
m©ch
 
Ëss
 
thª
 <em>blue OR smurf</em>.</li>

110 </
ul
>');

112 
	}
}

117 
funùiÚ
 
	$£¬ch_theme
() {

118  
	`¬¿y
(

119 '£¬ch_theme_fÜm' => 
	`¬¿y
(

120 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

123 '£¬ch_block_fÜm' => 
	`¬¿y
(

124 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

127 '£¬ch_»suÉ' => 
	`¬¿y
(

128 '¬gum’ts' => 
	`¬¿y
('»suÉ' => 
NULL
, 'type' => NULL),

132 '£¬ch_»suÉs' => 
	`¬¿y
(

133 '¬gum’ts' => 
	`¬¿y
('»suÉs' => 
NULL
, 'type' => NULL),

138 
	}
}

143 
funùiÚ
 
	$£¬ch_³rm
() {

144  
	`¬¿y
('search content', 'use‡dvanced search', 'administer search');

145 
	}
}

150 
funùiÚ
 
£¬ch_block
(
$İ
 = 'li¡', 
$d–
 = 0) {

151 ià(
$İ
 == 'list') {

152 
$blocks
[0]['šfo'] = 
t
('Search form');

154 
	g$blocks
[0]['ÿche'] = 
BLOCK_NO_CACHE
;

155  
	g$blocks
;

157 ià(
	g$İ
 =ğ'v›w' && 
u£r_acûss
('search content')) {

158 
$block
['cÚ‹Á'] = 
dru·l_g‘_fÜm
('search_block_form');

159 
	g$block
['subjeù'] = 
t
('Search');

160  
	g$block
;

167 
funùiÚ
 
	$£¬ch_m’u
() {

168 
$™ems
['£¬ch'] = 
	`¬¿y
(

171 'acûs ¬gum’ts' => 
	`¬¿y
('search content'),

172 'ty³' => 
MENU_SUGGESTED_ITEM
,

175 
$™ems
['admš/£‰šgs/£¬ch'] = 
	`¬¿y
(

179 '·g¬gum’ts' => 
	`¬¿y
('search_admin_settings'),

180 'acûs ¬gum’ts' => 
	`¬¿y
('administer search'),

181 'ty³' => 
MENU_NORMAL_ITEM
,

184 
$™ems
['admš/£‰šgs/£¬ch/we'] = 
	`¬¿y
(

187 '·g¬gum’ts' => 
	`¬¿y
('search_wipe_confirm'),

188 'acûs ¬gum’ts' => 
	`¬¿y
('administer search'),

189 'ty³' => 
MENU_CALLBACK
,

192 
$™ems
['admš/»pÜts/£¬ch'] = 
	`¬¿y
(

196 '·g¬gum’ts' => 
	`¬¿y
('search'),

197 'acûs ¬gum’ts' => 
	`¬¿y
('access site„eports'),

199 'f·th' => 
	`dru·l_g‘_·th
('module', 'dblog'),

202 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('£¬ch'è
as
 
$Çme
) {

203 
$™ems
['£¬ch/'. 
$Çme
 .'/%m’u_'] = 
	`¬¿y
(

205 't™Ë‡rgum’ts' => 
	`¬¿y
(
$Çme
, '£¬ch', 'Çme', 
TRUE
),

207 '·g¬gum’ts' => 
	`¬¿y
(
$Çme
),

209 'acûs ¬gum’ts' => 
	`¬¿y
(
$Çme
),

210 'ty³' => 
MENU_LOCAL_TASK
,

215  
$™ems
;

216 
	}
}

218 
funùiÚ
 
	$_£¬ch_m’u
(
$Çme
) {

219  
	`u£r_acûss
('£¬ch cÚ‹Á'è&& 
	`moduË_švoke
(
$Çme
, 'search', 'name');

220 
	}
}

231 
funùiÚ
 
	$£¬ch_we
(
$sid
 = 
NULL
, 
$ty³
 = NULL, 
$»šdex
 = 
FALSE
) {

232 ià(
$ty³
 =ğ
NULL
 && 
$sid
 == NULL) {

233 
	`moduË_švoke_®l
('search', 'reset');

236 
	`db_qu”y
("DELETE FROM {£¬ch_d©a£t} WHERE sid = %d ANDy³ = '%s'", 
$sid
, 
$ty³
);

237 
	`db_qu”y
("DELETE FROM {£¬ch_šdex} WHERE sid = %d ANDy³ = '%s'", 
$sid
, 
$ty³
);

239 ià(!
$»šdex
) {

240 
	`db_qu”y
("DELETE FROM {£¬ch_node_lšks} WHERE sid = %d ANDy³ = '%s'", 
$sid
, 
$ty³
);

243 
	}
}

250 
funùiÚ
 
	$£¬ch_dœty
(
$wÜd
 = 
NULL
) {

251 
$dœty
 = 
	`¬¿y
();

252 ià(
$wÜd
 !=ğ
NULL
) {

253 
$dœty
[
$wÜd
] = 
TRUE
;

256  
$dœty
;

258 
	}
}

266 
funùiÚ
 
	$£¬ch_üÚ
() {

269 
	`»gi¡”_shutdown_funùiÚ
('search_update_totals');

272 
	`fÜ—ch
 (
	`moduË_li¡
(è
as
 
$moduË
) {

273 
	`moduË_švoke
(
$moduË
, 'update_index');

275 
	}
}

281 
funùiÚ
 
	$£¬ch_upd©e_tÙ®s
() {

283 
	`fÜ—ch
 (
	`£¬ch_dœty
(è
as
 
$wÜd
 => 
$dummy
) {

285 
$tÙ®
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT SUM(scÜeèFROM {£¬ch_šdex} WHERE wÜd = '%s'", 
$wÜd
));

287 
$tÙ®
 = 
	`log10
(1 + 1/(
	`max
(1, $total)));

288 
	`db_qu”y
("UPDATE {£¬ch_tÙ®} SET couÁ = %àWHERE wÜd = '%s'", 
$tÙ®
, 
$wÜd
);

289 ià(!
	`db_afãùed_rows
()) {

290 @
	`db_qu”y
("INSERT INTO {£¬ch_tÙ®} (wÜd, couÁèVALUES ('%s', %f)", 
$wÜd
, 
$tÙ®
);

296 
$»suÉ
 = 
	`db_qu”y
("SELECT.word AS„ealword, i.word FROM {search_total} LEFT JOIN {search_index} i ON.word = i.word WHERE i.word IS NULL");

297 
$wÜd
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

298 
	`db_qu”y
("DELETE FROM {£¬ch_tÙ®} WHERE wÜd = '%s'", 
$wÜd
->
»®wÜd
);

300 
	}
}

305 
funùiÚ
 
	$£¬ch_sim¶ify
(
$‹xt
) {

307 
$‹xt
 = 
	`decode_’t™›s
($text);

310 
$‹xt
 = 
	`dru·l_¡¹Şow”
($text);

313 
	`£¬ch_švoke_´•roûss
(
$‹xt
);

316 ià(
	`v¬ŸbË_g‘
('ov”Ïp_cjk', 
TRUE
)) {

317 
$‹xt
 = 
	`´eg_»¶aû_ÿÎback
('/['. 
PREG_CLASS_CJK
 .']+/u', 'search_expand_cjk', $text);

326 
$‹xt
 = 
	`´eg_»¶aû
('/(['. 
PREG_CLASS_NUMBERS
 .']+)['. 
PREG_CLASS_PUNCTUATION
 .']+(?=['. PREG_CLASS_NUMBERS .'])/u', '\1', $text);

330 
$‹xt
 = 
	`´eg_»¶aû
('/[._-]+/', '', $text);

334 
$‹xt
 = 
	`´eg_»¶aû
('/['. 
PREG_CLASS_SEARCH_EXCLUDE
 .']+/u', ' ', $text);

336  
$‹xt
;

337 
	}
}

343 
funùiÚ
 
	$£¬ch_ex·nd_cjk
(
$m©ches
) {

344 
$mš
 = 
	`v¬ŸbË_g‘
('minimum_word_size', 3);

345 
$¡r
 = 
$m©ches
[0];

346 
$l
 = 
	`dru·l_¡¾’
(
$¡r
);

348 ià(
$l
 <ğ
$mš
) {

349  ' '. 
$¡r
 .' ';

351 
$tok’s
 = ' ';

353 
$ch¬s
 = 
	`¬¿y
();

355 
$i
 = 0; $˜< 
$l
; ++$i) {

357 
$cu¼’t
 = 
	`dru·l_sub¡r
(
$¡r
, 0, 1);

358 
$¡r
 = 
	`sub¡r
($¡r, 
	`¡¾’
(
$cu¼’t
));

359 
$ch¬s
[] = 
$cu¼’t
;

360 ià(
$i
 >ğ
$mš
 - 1) {

361 
$tok’s
 .ğ
	`im¶ode
('', 
$ch¬s
) .' ';

362 
	`¬¿y_shiá
(
$ch¬s
);

365  
$tok’s
;

366 
	}
}

371 
funùiÚ
 
	$£¬ch_šdex_¥l™
(
$‹xt
) {

372 
$Ï¡
 = 
NULL
;

373 
$Ï¡¥l™
 = 
NULL
;

375 ià(
$Ï¡
 =ğ
$‹xt
) {

376  
$Ï¡¥l™
;

379 
$‹xt
 = 
	`£¬ch_sim¶ify
($text);

380 
$wÜds
 = 
	`ex¶ode
(' ', 
$‹xt
);

381 
	`¬¿y_w®k
(
$wÜds
, '_search_index_truncate');

384 
$Ï¡
 = 
$‹xt
;

385 
$Ï¡¥l™
 = 
$wÜds
;

387  
$wÜds
;

388 
	}
}

393 
funùiÚ
 
	$_£¬ch_šdex_Œunÿ‹
(&
$‹xt
) {

394 
$‹xt
 = 
	`Œunÿ‹_utf8
($text, 50);

395 
	}
}

400 
funùiÚ
 
	$£¬ch_švoke_´•roûss
(&
$‹xt
) {

401 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('£¬ch_´•roûss'è
as
 
$moduË
) {

402 
$‹xt
 = 
	`moduË_švoke
(
$moduË
, 'search_preprocess', $text);

404 
	}
}

420 
funùiÚ
 
	$£¬ch_šdex
(
$sid
, 
$ty³
, 
$‹xt
) {

421 
$mšimum_wÜd_size
 = 
	`v¬ŸbË_g‘
('minimum_word_size', 3);

424 
glob®
 
$ba£_u¾
;

425 
$node_»gexp
 = '@h»f=[\'"]?(?:'. 
	`´eg_quÙe
(
$ba£_u¾
, '@'è.'/|'.…»g_quÙe(
	`ba£_·th
(), '@') .')(?:\?q=)?/?((?![a-z]+:)[^\'">]+)[\'">]@i';

429 
$gs
 = 
	`¬¿y
('h1' => 25,

444 
$‹xt
 = 
	`¡r_»¶aû
(
	`¬¿y
('<', '>'),‡rray(' <', '> '), $text);

445 
$‹xt
 = 
	`¡r_gs
($‹xt, '<'. 
	`im¶ode
('><', 
	`¬¿y_keys
(
$gs
)) .'>');

448 
$¥l™
 = 
	`´eg_¥l™
('/\s*<([^>]+?)>\s*/', 
$‹xt
, -1, 
PREG_SPLIT_DELIM_CAPTURE
);

452 
$g
 = 
FALSE
;

453 
$lšk
 = 
FALSE
;

454 
$scÜe
 = 1;

455 
$accum
 = ' ';

456 
$g¡ack
 = 
	`¬¿y
();

457 
$gwÜds
 = 0;

458 
$focus
 = 1;

460 
$»suÉs
 = 
	`¬¿y
(0 =>‡rray());

462 
	`fÜ—ch
 (
$¥l™
 
as
 
$v®ue
) {

463 ià(
$g
) {

465 
	`li¡
(
$gÇme
èğ
	`ex¶ode
(' ', 
$v®ue
, 2);

466 
$gÇme
 = 
	`dru·l_¡¹Şow”
($tagname);

468 ià(
$gÇme
[0] == '/') {

469 
$gÇme
 = 
	`sub¡r
($tagname, 1);

471 ià(!
	`couÁ
(
$g¡ack
è|| $g¡ack[0] !ğ
$gÇme
) {

472 
$g¡ack
 = 
	`¬¿y
();

473 
$scÜe
 = 1;

477 
$scÜe
 = 
	`max
(1, $scÜ- 
$gs
[
	`¬¿y_shiá
(
$g¡ack
)]);

479 ià(
$gÇme
 == 'a') {

480 
$lšk
 = 
FALSE
;

484 ià(
	`is£t
(
$g¡ack
[0]è&& $g¡ack[0] =ğ
$gÇme
) {

487 
$g¡ack
 = 
	`¬¿y
();

488 
$scÜe
 = 1;

492 
	`¬¿y_unshiá
(
$g¡ack
, 
$gÇme
);

493 
$scÜe
 +ğ
$gs
[
$gÇme
];

495 ià(
$gÇme
 == 'a') {

497 ià(
	`´eg_m©ch
(
$node_»gexp
, 
$v®ue
, 
$m©ch
)) {

498 
$·th
 = 
	`dru·l_g‘_nÜm®_·th
(
$m©ch
[1]);

499 ià(
	`´eg_m©ch
('!(?:node|book)/(?:v›w/)?([0-9]+)!i', 
$·th
, 
$m©ch
)) {

500 
$lšknid
 = 
$m©ch
[1];

501 ià(
$lšknid
 > 0) {

503 
$node
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT‚.t™Ë,‚.nid,‚.vid,„.fÜm© FROM {node}‚ INNER JOIN {node_»visiÚs}„ ON‚.vid =„.vid WHERE‚.nid = %d', 
$lšknid
));

504 ià(
	`f‹r_fÜm©_®lowÿche
(
$node
->
fÜm©
)) {

505 
$lšk
 = 
TRUE
;

506 
$lškt™Ë
 = 
$node
->
t™Ë
;

514 
$gwÜds
 = 0;

518 ià(
$v®ue
 != '') {

519 ià(
$lšk
) {

521 ià(
	`´eg_m©ch
('!^h‰ps?://!i', 
$v®ue
)) {

522 
$v®ue
 = 
$lškt™Ë
;

525 
$wÜds
 = 
	`£¬ch_šdex_¥l™
(
$v®ue
);

526 
	`fÜ—ch
 (
$wÜds
 
as
 
$wÜd
) {

528 
$accum
 .ğ
$wÜd
 .' ';

529 
$num
 = 
	`is_num”ic
(
$wÜd
);

531 ià(
$num
 || 
	`dru·l_¡¾’
(
$wÜd
è>ğ
$mšimum_wÜd_size
) {

533 ià(
$num
) {

534 
$wÜd
 = ()
	`Érim
($word, '-0');

538 ià(
$lšk
) {

539 ià(!
	`is£t
(
$»suÉs
[
$lšknid
])) {

540 
$»suÉs
[
$lšknid
] = 
	`¬¿y
();

542 
$»suÉs
[
$lšknid
][] = 
$wÜd
;

544 
$focus
 *= 0.2;

547 ià(!
	`is£t
(
$»suÉs
[0][
$wÜd
])) {

548 
$»suÉs
[0][
$wÜd
] = 0;

550 
$»suÉs
[0][
$wÜd
] +ğ
$scÜe
 * 
$focus
;

554 
$focus
 = 
	`mš
(1, .01 + 3.5 / (2 + 
	`couÁ
(
$»suÉs
[0]) * .015));

556 
$gwÜds
++;

558 ià(
	`couÁ
(
$g¡ack
è&& 
$gwÜds
 >= 15) {

559 
$g¡ack
 = 
	`¬¿y
();

560 
$scÜe
 = 1;

565 
$g
 = !$tag;

568 
	`£¬ch_we
(
$sid
, 
$ty³
, 
TRUE
);

571 
	`db_qu”y
("INSERT INTO {£¬ch_d©a£t} (sid,y³, d©a,„ešdexèVALUES (%d, '%s', '%s', %d)", 
$sid
, 
$ty³
, 
$accum
, 0);

574 
	`fÜ—ch
 (
$»suÉs
[0] 
as
 
$wÜd
 => 
$scÜe
) {

578 @
	`db_qu”y
("INSERT INTO {£¬ch_šdex} (wÜd, sid,y³, scÜeèVALUES ('%s', %d, '%s', %f)", 
$wÜd
, 
$sid
, 
$ty³
, 
$scÜe
);

579 ià(!
	`db_afãùed_rows
()) {

580 
	`db_qu”y
("UPDATE {£¬ch_šdex} SET scÜğscÜ+ %àWHERE wÜd = '%s' AND sid = %d ANDy³ = '%s'", 
$scÜe
, 
$wÜd
, 
$sid
, 
$ty³
);

582 
	`£¬ch_dœty
(
$wÜd
);

584 
	`un£t
(
$»suÉs
[0]);

587 
$»suÉ
 = 
	`db_qu”y
("SELECT‚id, c­tiÚ FROM {£¬ch_node_lšks} WHERE sid = %d ANDy³ = '%s'", 
$sid
, 
$ty³
);

588 
$lšks
 = 
	`¬¿y
();

589 
$lšk
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

590 
$lšks
[
$lšk
->
nid
] = $lšk->
ÿ±iÚ
;

594 
	`fÜ—ch
 (
$»suÉs
 
as
 
$nid
 => 
$wÜds
) {

595 
$ÿ±iÚ
 = 
	`im¶ode
(' ', 
$wÜds
);

596 ià(
	`is£t
(
$lšks
[
$nid
])) {

597 ià(
$lšks
[
$nid
] !ğ
$ÿ±iÚ
) {

599 
	`db_qu”y
("UPDATE {£¬ch_node_lšks} SET c­tiÚ = '%s' WHERE sid = %d ANDy³ = '%s' AND‚id = %d", 
$ÿ±iÚ
, 
$sid
, 
$ty³
, 
$nid
);

600 
	`£¬ch_touch_node
(
$nid
);

603 
	`un£t
(
$lšks
[
$nid
]);

607 
	`db_qu”y
("INSERT INTO {£¬ch_node_lšks} (ÿ±iÚ, sid,y³,‚idèVALUES ('%s', %d, '%s', %d)", 
$ÿ±iÚ
, 
$sid
, 
$ty³
, 
$nid
);

608 
	`£¬ch_touch_node
(
$nid
);

612 
	`fÜ—ch
 (
$lšks
 
as
 
$nid
 => 
$ÿ±iÚ
) {

613 
	`db_qu”y
("DELETE FROM {£¬ch_node_lšks} WHERE sid = %d ANDy³ = '%s' AND‚id = %d", 
$sid
, 
$ty³
, 
$nid
);

614 
	`£¬ch_touch_node
(
$nid
);

616 
	}
}

624 
funùiÚ
 
	$£¬ch_touch_node
(
$nid
) {

625 
	`db_qu”y
("UPDATE {£¬ch_d©a£t} SET„ešdex = %d WHERE sid = %d ANDy³ = 'node'", 
	`time
(), 
$nid
);

626 
	}
}

631 
funùiÚ
 
	$£¬ch_nod—pi
(&
$node
, 
$İ
, 
$‹a£r
 = 
NULL
, 
$·ge
 = NULL) {

632 
$İ
) {

635 
$»suÉ
 = 
	`db_qu”y
("SELECT c­tiÚ FROM {£¬ch_node_lšks} WHERE‚id = %d", 
$node
->
nid
);

636 
$ouut
 = 
	`¬¿y
();

637 
$lšk
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

638 
$ouut
[] = 
$lšk
->
ÿ±iÚ
;

640 ià(
	`couÁ
(
$ouut
)) {

641  '<a>('. 
	`im¶ode
(', ', 
$ouut
) .')</a>';

647 
	`£¬ch_touch_node
(
$node
->
nid
);

650 
	}
}

655 
funùiÚ
 
	$£¬ch_comm’t
(
$a1
, 
$İ
) {

656 
$İ
) {

663 
	`£¬ch_touch_node
(
	`is_¬¿y
(
$a1
è? $a1['nid'] : $a1->
nid
);

666 
	}
}

671 
funùiÚ
 
	$£¬ch_qu”y_exŒaù
(
$keys
, 
$İtiÚ
) {

672 ià(
	`´eg_m©ch
('/(^| )'. 
$İtiÚ
 .':([^ ]*)Ğ|$)/i', 
$keys
, 
$m©ches
)) {

673  
$m©ches
[2];

675 
	}
}

681 
funùiÚ
 
£¬ch_qu”y_š£¹
(
$keys
, 
$İtiÚ
, 
$v®ue
 = '') {

682 ià(
£¬ch_qu”y_exŒaù
(
$keys
, 
$İtiÚ
)) {

683 
$keys
 = 
Œim
(
´eg_»¶aû
('/(^| )'. 
$İtiÚ
 .':[^ ]*/i', '', $keys));

685 ià(
	g$v®ue
 != '') {

686 
$keys
 .ğ' '. 
$İtiÚ
 .':'. 
$v®ue
;

688  
	g$keys
;

711 
funùiÚ
 
	$£¬ch_·r£_qu”y
(
$‹xt
) {

712 
$keys
 = 
	`¬¿y
('positive' =>‡rray(), 'negative' =>‡rray());

715 
	`´eg_m©ch_®l
('/ (-?)("[^"]+"|[^" ]+)/i', ' '. 
$‹xt
, 
$m©ches
, 
PREG_SET_ORDER
);

717 ià(
	`couÁ
(
$m©ches
) < 1) {

718  
NULL
;

722 
$Ü
 = 
FALSE
;

723 
$w¬nšg
 = '';

724 
$sim¶e
 = 
TRUE
;

725 
	`fÜ—ch
 (
$m©ches
 
as
 
$m©ch
) {

726 
$ph¿£
 = 
FALSE
;

728 ià(
$m©ch
[2]{0} == '"') {

729 
$m©ch
[2] = 
	`sub¡r
($match[2], 1, -1);

730 
$ph¿£
 = 
TRUE
;

731 
$sim¶e
 = 
FALSE
;

734 
$wÜds
 = 
	`£¬ch_sim¶ify
(
$m©ch
[2]);

736 
$wÜds
 = 
$ph¿£
 ? 
	`¬¿y
($wÜdsè: 
	`´eg_¥l™
('/ /', $wÜds, -1, 
PREG_SPLIT_NO_EMPTY
);

738 ià(
$m©ch
[1] == '-') {

739 
$keys
['Ãg©ive'] = 
	`¬¿y_m”ge
($keys['Ãg©ive'], 
$wÜds
);

743 
	`–£if
 (
$m©ch
[2] =ğ'OR' && 
	`couÁ
(
$keys
['positive'])) {

744 
$Ï¡
 = 
	`¬¿y_pİ
(
$keys
['positive']);

746 ià(!
	`is_¬¿y
(
$Ï¡
)) {

747 
$Ï¡
 = 
	`¬¿y
($last);

749 
$keys
['pos™ive'][] = 
$Ï¡
;

750 
$Ü
 = 
TRUE
;

754 
	`–£if
 (
$m©ch
[2] == 'AND' || $match[2] == 'and') {

755 
$w¬nšg
 = 
$m©ch
[2];

761 ià(
$m©ch
[2] == 'or') {

762 
$w¬nšg
 = 
$m©ch
[2];

764 ià(
$Ü
) {

766 
$keys
['pos™ive'][
	`couÁ
($keys['pos™ive']è- 1] = 
	`¬¿y_m”ge
($keys['pos™ive'][couÁ($keys['pos™ive']è- 1], 
$wÜds
);

769 
$keys
['pos™ive'] = 
	`¬¿y_m”ge
($keys['pos™ive'], 
$wÜds
);

772 
$Ü
 = 
FALSE
;

776 
$qu”y
 = 
	`¬¿y
();

777 
$qu”y2
 = 
	`¬¿y
();

778 
$¬gum’ts
 = 
	`¬¿y
();

779 
$¬gum’ts2
 = 
	`¬¿y
();

780 
$m©ches
 = 0;

781 
$sim¶e_ªd
 = 
FALSE
;

782 
$sim¶e_Ü
 = 
FALSE
;

784 
	`fÜ—ch
 (
$keys
['pos™ive'] 
as
 
$key
) {

786 ià(
	`is_¬¿y
(
$key
è&& 
	`couÁ
($key)) {

787 
$sim¶e_Ü
 = 
TRUE
;

788 
$qu”yÜ
 = 
	`¬¿y
();

789 
$ªy
 = 
FALSE
;

790 
	`fÜ—ch
 (
$key
 
as
 
$Ü
) {

791 
	`li¡
(
$q
, 
$num_Ãw_scÜes
èğ
	`_£¬ch_·r£_qu”y
(
$Ü
, 
$¬gum’ts2
);

792 
$ªy
 |ğ
$num_Ãw_scÜes
;

793 ià(
$q
) {

794 
$qu”yÜ
[] = 
$q
;

795 
$¬gum’ts
[] = 
$Ü
;

798 ià(
	`couÁ
(
$qu”yÜ
)) {

799 
$qu”y
[] = '('. 
	`im¶ode
(' OR ', 
$qu”yÜ
) .')';

801 
$m©ches
 +ğ(
$ªy
 > 0);

806 
$sim¶e_ªd
 = 
TRUE
;

807 
	`li¡
(
$q
, 
$num_Ãw_scÜes
, 
$num_v®id_wÜds
èğ
	`_£¬ch_·r£_qu”y
(
$key
, 
$¬gum’ts2
);

808 ià(
$q
) {

809 
$qu”y
[] = 
$q
;

810 
$¬gum’ts
[] = 
$key
;

811 ià(!
$num_v®id_wÜds
) {

812 
$sim¶e
 = 
FALSE
;

815 
$m©ches
 +ğ
$num_Ãw_scÜes
;

819 ià(
$sim¶e_ªd
 && 
$sim¶e_Ü
) {

820 
$sim¶e
 = 
FALSE
;

823 
	`fÜ—ch
 (
$keys
['Ãg©ive'] 
as
 
$key
) {

824 
	`li¡
(
$q
èğ
	`_£¬ch_·r£_qu”y
(
$key
, 
$¬gum’ts2
, 
TRUE
);

825 ià(
$q
) {

826 
$qu”y
[] = 
$q
;

827 
$¬gum’ts
[] = 
$key
;

828 
$sim¶e
 = 
FALSE
;

831 
$qu”y
 = 
	`im¶ode
(' AND ', $query);

834 
$qu”y2
 = 
	`sub¡r
(
	`¡r_»³©
("i.wÜd = '%s' OR ", 
	`couÁ
(
$¬gum’ts2
)), 0, -4);

836  
	`¬¿y
(
$qu”y
, 
$¬gum’ts
, 
$qu”y2
, 
$¬gum’ts2
, 
$m©ches
, 
$sim¶e
, 
$w¬nšg
);

837 
	}
}

842 
funùiÚ
 
	$_£¬ch_·r£_qu”y
(&
$wÜd
, &
$scÜes
, 
$nÙ
 = 
FALSE
) {

843 
$num_Ãw_scÜes
 = 0;

844 
$num_v®id_wÜds
 = 0;

846 ià(!
$nÙ
) {

847 
$¥l™
 = 
	`ex¶ode
(' ', 
$wÜd
);

848 
	`fÜ—ch
 (
$¥l™
 
as
 
$s
) {

849 
$num
 = 
	`is_num”ic
(
$s
);

850 ià(
$num
 || 
	`dru·l_¡¾’
(
$s
è>ğ
	`v¬ŸbË_g‘
('minimum_word_size', 3)) {

851 
$s
 = 
$num
 ? (()
	`Érim
($s, '-0')) : $s;

852 ià(!
	`is£t
(
$scÜes
[
$s
])) {

853 
$scÜes
[
$s
] = $s;

854 
$num_Ãw_scÜes
++;

856 
$num_v®id_wÜds
++;

861  
	`¬¿y
("d.d©¨". (
$nÙ
 ? 'NOT ' : ''è."LIKE '%% % %%'", 
$num_Ãw_scÜes
, 
$num_v®id_wÜds
);

862 
	}
}

918 
funùiÚ
 
do_£¬ch
(
$keywÜds
, 
$ty³
, 
$još1
 = '', 
$wh”e1
 = '1 = 1', 
$¬gum’ts1
 = 
¬¿y
(), 
$cŞumns2
 = 'i.»Ëvªû AS scÜe', 
$još2
 = '', 
$¬gum’ts2
 =‡¼ay(), 
$sÜt_·¿m‘”s
 = 'ORDER BY score DESC') {

919 
$qu”y
 = 
£¬ch_·r£_qu”y
(
$keywÜds
);

921 ià(
	g$qu”y
[2] == '') {

922 
fÜm_£t_”rÜ
('keys', 
t
('You mu¡ inşud©†—¡ oÃ…os™ivkeywÜd w™h @couÁ ch¬aù” Ü mÜe.', 
¬¿y
('@couÁ' => 
v¬ŸbË_g‘
('minimum_word_size', 3))));

924 ià(
	g$qu”y
[6]) {

925 ià(
	g$qu”y
[6] == 'or') {

926 
dru·l_£t_mes§ge
(
t
('Search forƒither ofhewoerms with uppercase <strong>OR</strong>. Forƒxample, <strong>cats OR dogs</strong>.'));

929 ià(
	g$qu”y
 ==ğ
NULL
 || 
$qu”y
[0] == '' || $query[2] == '') {

930  
¬¿y
();

934 
	g$cÚd™iÚs
 = "$where1 AND ($query[2]) AND i.type = '%s'";

935 
	g$¬gum’ts1
 = 
¬¿y_m”ge
(
$¬gum’ts1
, 
$qu”y
[3], 
¬¿y
(
$ty³
));

936 
	g$još
 = "INNER JOIN {search_total} ON i.word =.word $join1";

937 ià(!
	g$qu”y
[5]) {

938 
	g$cÚd™iÚs
 .= " AND ($query[0])";

939 
	g$¬gum’ts1
 = 
¬¿y_m”ge
(
$¬gum’ts1
, 
$qu”y
[1]);

940 
	g$još
 .= " INNER JOIN {search_dataset} d ON i.sid = d.sid AND i.type = d.type";

944 
	g$£Ëù
 = "SELECT SUM(i.score *.count) AS score FROM {search_index} i $join WHERE $conditions GROUP BY i.type, i.sid HAVING COUNT(*) >= %d ORDER BY score DESC";

945 
	g$¬gum’ts
 = 
¬¿y_m”ge
(
$¬gum’ts1
, 
¬¿y
(
$qu”y
[4]));

946 
	g$nÜm®ize
 = 
db_»suÉ
(
db_qu”y_¿nge
(
$£Ëù
, 
$¬gum’ts
, 0, 1));

947 ià(!
	g$nÜm®ize
) {

948  
¬¿y
();

950 
	g$cŞumns2
 = 
¡r_»¶aû
('i.»Ëvªû', '('. (1.0 / 
$nÜm®ize
è.' * SUM(i.scÜ*.couÁ))', 
$cŞumns2
);

953 
	g$£Ëù
 = "SELECT i.type, i.sid, $columns2 FROM {search_index} i $join $join2 WHERE $conditions GROUP BY i.type, i.sid HAVING COUNT(*) >= %d";

954 
	g$couÁ_£Ëù
 = "SELECT COUNT(*) FROM ($select)‚1";

955 
	g$¬gum’ts
 = 
¬¿y_m”ge
(
$¬gum’ts2
, 
$¬gum’ts1
, 
¬¿y
(
$qu”y
[4]));

958 
	g$»suÉ
 = 
·g”_qu”y
("$£Ëù $sÜt_·¿m‘”s", 10, 0, 
$couÁ_£Ëù
, 
$¬gum’ts
);

959 
	g$»suÉs
 = 
¬¿y
();

960 
	g$™em
 = 
db_ãtch_objeù
(
$»suÉ
)) {

961 
$»suÉs
[] = 
$™em
;

963  
	g$»suÉs
;

969 
funùiÚ
 
	$£¬ch_g‘_keys
() {

970 
$»tuº
;

971 ià(!
	`is£t
(
$»tuº
)) {

974 
$·th
 = 
	`ex¶ode
('/', 
$_GET
['q'], 3);

975 
$keys
 = 
	`em±y
(
$_REQUEST
['keys']) ? '' : $_REQUEST['keys'];

976 
$»tuº
 = 
	`couÁ
(
$·th
è=ğ3 ? $·th[2] : 
$keys
;

978  
$»tuº
;

979 
	}
}

1023 
funùiÚ
 
£¬ch_fÜm
(&
$fÜm_¡©e
, 
$aùiÚ
 = '', 
$keys
 = '', 
$ty³
 = 
NULL
, 
$´om±
 = NULL) {

1026 
dru·l_add_css
(
dru·l_g‘_·th
('moduË', '£¬ch'è.'/£¬ch.css', 'moduË', '®l', 
FALSE
);

1028 ià(!
	g$aùiÚ
) {

1029 
	g$aùiÚ
 = 
u¾
('£¬ch/'. 
$ty³
);

1031 ià(
is_nuÎ
(
$´om±
)) {

1032 
	g$´om±
 = 
t
('Enter your keywords');

1035 
	g$fÜm
 = 
¬¿y
(

1036 '#aùiÚ' => 
$aùiÚ
,

1037 '#©Œibu‹s' => 
¬¿y
('class' => 'search-form'),

1039 
	g$fÜm
['moduË'] = 
¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$ty³
);

1040 
	g$fÜm
['basic'] = 
¬¿y
('#ty³' => '™em', '#t™Ë' => 
$´om±
);

1041 
	g$fÜm
['basic']['šlše'] = 
¬¿y
('#prefix' => '<div class="container-inline">', '#suffix' => '</div>');

1042 
	g$fÜm
['basic']['šlše']['keys'] = 
¬¿y
(

1045 '#deçuÉ_v®ue' => 
$keys
,

1046 '#size' => 
$´om±
 ? 40 : 20,

1051 
	g$fÜm
['basic']['šlše']['´oûs£d_keys'] = 
¬¿y
('#type' => 'value', '#value' =>‡rray());

1052 
	g$fÜm
['basic']['šlše']['subm™'] = 
¬¿y
('#ty³' => 'subm™', '#v®ue' => 
t
('Search'));

1054  
	g$fÜm
;

1064 
funùiÚ
 
	$£¬ch_box
(&
$fÜm_¡©e
, 
$fÜm_id
) {

1065 
$fÜm
[
$fÜm_id
] = 
	`¬¿y
(

1066 '#t™Ë' => 
	`t
('Searchhis site'),

1070 '#©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
	`t
('Enterheerms you wisho search for.')),

1072 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Search'));

1073 
$fÜm
['#submit'][] = 'search_box_form_submit';

1075  
$fÜm
;

1076 
	}
}

1081 
funùiÚ
 
	$£¬ch_box_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1086 ià(
	`is£t
(
$_REQUEST
['destination'])) {

1087 
	`un£t
(
$_REQUEST
['destination']);

1089 ià(
	`is£t
(
$_REQUEST
['edit']['destination'])) {

1090 
	`un£t
(
$_REQUEST
['edit']['destination']);

1093 
$fÜm_id
 = 
$fÜm
['form_id']['#value'];

1094 
$fÜm_¡©e
['»dœeù'] = '£¬ch/node/'. 
	`Œim
($fÜm_¡©e['v®ues'][
$fÜm_id
]);

1095 
	}
}

1105 
funùiÚ
 
	$‹m¶©e_´•roûss_£¬ch_theme_fÜm
(&
$v¬ŸbËs
) {

1106 
$v¬ŸbËs
['£¬ch'] = 
	`¬¿y
();

1107 
$hidd’
 = 
	`¬¿y
();

1109 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$v¬ŸbËs
['fÜm']è
as
 
$key
) {

1110 
$ty³
 = 
$v¬ŸbËs
['fÜm'][
$key
]['#type'];

1111 ià(
$ty³
 == 'hidden' || $type == 'token') {

1112 
$hidd’
[] = 
	`dru·l_»nd”
(
$v¬ŸbËs
['fÜm'][
$key
]);

1115 
$v¬ŸbËs
['£¬ch'][
$key
] = 
	`dru·l_»nd”
($variables['form'][$key]);

1119 
$v¬ŸbËs
['£¬ch']['hidd’'] = 
	`im¶ode
(
$hidd’
);

1121 
$v¬ŸbËs
['£¬ch_fÜm'] = 
	`im¶ode
($variables['search']);

1122 
	}
}

1132 
funùiÚ
 
	$‹m¶©e_´•roûss_£¬ch_block_fÜm
(&
$v¬ŸbËs
) {

1133 
$v¬ŸbËs
['£¬ch'] = 
	`¬¿y
();

1134 
$hidd’
 = 
	`¬¿y
();

1136 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$v¬ŸbËs
['fÜm']è
as
 
$key
) {

1137 
$ty³
 = 
$v¬ŸbËs
['fÜm'][
$key
]['#type'];

1138 ià(
$ty³
 == 'hidden' || $type == 'token') {

1139 
$hidd’
[] = 
	`dru·l_»nd”
(
$v¬ŸbËs
['fÜm'][
$key
]);

1142 
$v¬ŸbËs
['£¬ch'][
$key
] = 
	`dru·l_»nd”
($variables['form'][$key]);

1146 
$v¬ŸbËs
['£¬ch']['hidd’'] = 
	`im¶ode
(
$hidd’
);

1148 
$v¬ŸbËs
['£¬ch_fÜm'] = 
	`im¶ode
($variables['search']);

1149 
	}
}

1154 
funùiÚ
 
£¬ch_d©a
(
$keys
 = 
NULL
, 
$ty³
 = 'node') {

1156 ià(
is£t
(
$keys
)) {

1157 ià(
moduË_hook
(
$ty³
, 'search')) {

1158 
$»suÉs
 = 
moduË_švoke
(
$ty³
, '£¬ch', '£¬ch', 
$keys
);

1159 ià(
is£t
(
$»suÉs
è&& 
is_¬¿y
($»suÉsè&& 
couÁ
($results)) {

1160 ià(
moduË_hook
(
$ty³
, 'search_page')) {

1161  
moduË_švoke
(
$ty³
, '£¬ch_·ge', 
$»suÉs
);

1164  
theme
('£¬ch_»suÉs', 
$»suÉs
, 
$ty³
);

1184 
funùiÚ
 
	$£¬ch_exû½t
(
$keys
, 
$‹xt
) {

1186 
$bound¬y
 = '(?:(?<=['. 
PREG_CLASS_SEARCH_EXCLUDE
 . 
PREG_CLASS_CJK
 .'])|(?=['. PREG_CLASS_SEARCH_EXCLUDE . PREG_CLASS_CJK .']))';

1189 
	`´eg_m©ch_®l
('/ ("([^"]+)"|(?!OR)([^" ]+))/', ' '. 
$keys
, 
$m©ches
);

1190 
$keys
 = 
	`¬¿y_m”ge
(
$m©ches
[2], $matches[3]);

1193 
$‹xt
 = ' '. 
	`¡r_gs
(
	`¡r_»¶aû
(
	`¬¿y
('<', '>'),‡rray(' <', '> '), $text)) .' ';

1194 
	`¬¿y_w®k
(
$keys
, '_search_excerpt_replace');

1195 
$wÜkkeys
 = 
$keys
;

1201 
$¿nges
 = 
	`¬¿y
();

1202 
$šşuded
 = 
	`¬¿y
();

1203 
$Ëngth
 = 0;

1204 
$Ëngth
 < 256 && 
	`couÁ
(
$wÜkkeys
)) {

1205 
	`fÜ—ch
 (
$wÜkkeys
 
as
 
$k
 => 
$key
) {

1206 ià(
	`¡¾’
(
$key
) == 0) {

1207 
	`un£t
(
$wÜkkeys
[
$k
]);

1208 
	`un£t
(
$keys
[
$k
]);

1211 ià(
$Ëngth
 >= 256) {

1216 ià(!
	`is£t
(
$šşuded
[
$key
])) {

1217 
$šşuded
[
$key
] = 0;

1221 ià(
	`´eg_m©ch
('/'. 
$bound¬y
 . 
$key
 . $bound¬y .'/iu', 
$‹xt
, 
$m©ch
, 
PREG_OFFSET_CAPTURE
, 
$šşuded
[$key])) {

1222 
$p
 = 
$m©ch
[0][1];

1223 ià((
$q
 = 
	`¡½os
(
$‹xt
, ' ', 
	`max
(0, 
$p
 - 60))è!=ğ
FALSE
) {

1224 
$’d
 = 
	`sub¡r
(
$‹xt
, 
$p
, 80);

1225 ià((
$s
 = 
	`¡¼pos
(
$’d
, ' ')è!=ğ
FALSE
) {

1226 
$¿nges
[
$q
] = 
$p
 + 
$s
;

1227 
$Ëngth
 +ğ
$p
 + 
$s
 - 
$q
;

1228 
$šşuded
[
$key
] = 
$p
 + 1;

1231 
	`un£t
(
$wÜkkeys
[
$k
]);

1235 
	`un£t
(
$wÜkkeys
[
$k
]);

1239 
	`un£t
(
$wÜkkeys
[
$k
]);

1245 ià(
	`couÁ
(
$¿nges
) == 0) {

1246  
	`Œunÿ‹_utf8
(
$‹xt
, 256) .' ...';

1250 
	`ksÜt
(
$¿nges
);

1253 
$Ãw¿nges
 = 
	`¬¿y
();

1254 
	`fÜ—ch
 (
$¿nges
 
as
 
$äom2
 => 
$to2
) {

1255 ià(!
	`is£t
(
$äom1
)) {

1256 
$äom1
 = 
$äom2
;

1257 
$to1
 = 
$to2
;

1260 ià(
$äom2
 <ğ
$to1
) {

1261 
$to1
 = 
	`max
($to1, 
$to2
);

1264 
$Ãw¿nges
[
$äom1
] = 
$to1
;

1265 
$äom1
 = 
$äom2
;

1266 
$to1
 = 
$to2
;

1269 
$Ãw¿nges
[
$äom1
] = 
$to1
;

1272 
$out
 = 
	`¬¿y
();

1273 
	`fÜ—ch
 (
$Ãw¿nges
 
as
 
$äom
 => 
$to
) {

1274 
$out
[] = 
	`sub¡r
(
$‹xt
, 
$äom
, 
$to
 - $from);

1276 
$‹xt
 = (
	`is£t
(
$Ãw¿nges
[0]è? '' : '... 'è. 
	`im¶ode
(' ... ', 
$out
) .' ...';

1279 
$‹xt
 = 
	`´eg_»¶aû
('/'. 
$bound¬y
 .'('. 
	`im¶ode
('|', 
$keys
) .')'. $boundary .'/iu', '<strong>\0</strong>', $text);

1280  
$‹xt
;

1281 
	}
}

1290 
funùiÚ
 
	$_£¬ch_exû½t_»¶aû
(&
$‹xt
) {

1291 
$‹xt
 = 
	`´eg_quÙe
($text, '/');

1292 
	}
}

1294 
funùiÚ
 
	$£¬ch_fÜms
() {

1295 
$fÜms
['£¬ch_theme_fÜm']ğ
	`¬¿y
(

1297 'ÿÎback‡rgum’ts' => 
	`¬¿y
('search_theme_form'),

1299 
$fÜms
['£¬ch_block_fÜm']ğ
	`¬¿y
(

1301 'ÿÎback‡rgum’ts' => 
	`¬¿y
('search_block_form'),

1303  
$fÜms
;

1304 
	}
}

	@/srv/http/subs/notes/www/modules/search/search.pages.inc

1 <?
php


12 
funùiÚ
 
£¬ch_v›w
(
$ty³
 = 'node') {

16 ià(!
is£t
(
$_POST
['form_id'])) {

17 ià(
$ty³
 == '') {

21 
dru·l_gÙo
('search/node');

24 
	g$keys
 = 
£¬ch_g‘_keys
();

26 
	g$»suÉs
 = '';

27 ià(
Œim
(
$keys
)) {

29 
w©chdog
('£¬ch', '%key (@ty³).', 
¬¿y
('%keys' => 
$keys
, '@ty³' => 
moduË_švoke
(
$ty³
, '£¬ch', 'Çme')), 
WATCHDOG_NOTICE
, 
l
(
t
('results'), 'search/'. $type .'/'. $keys));

32 
	g$»suÉs
 = 
£¬ch_d©a
(
$keys
, 
$ty³
);

34 ià(
	g$»suÉs
) {

35 
	g$»suÉs
 = 
theme
('box', 
t
('S—rch„esuÉs'), 
$»suÉs
);

38 
	g$»suÉs
 = 
theme
('box', 
t
('You¸£¬ch y›lded‚Ø»suÉs'), 
£¬ch_h–p
('£¬ch#nÜesuÉs', 
dru·l_h–p_¬g
()));

43 
	g$ouut
 = 
dru·l_g‘_fÜm
('£¬ch_fÜm', 
NULL
, 
$keys
, 
$ty³
);

44 
	g$ouut
 .ğ
$»suÉs
;

46  
	g$ouut
;

49  
dru·l_g‘_fÜm
('£¬ch_fÜm', 
NULL
, 
em±y
(
$keys
è? '' : $keys, 
$ty³
);

61 
funùiÚ
 
	$‹m¶©e_´•roûss_£¬ch_»suÉs
(&
$v¬ŸbËs
) {

62 
$v¬ŸbËs
['search_results'] = '';

63 
	`fÜ—ch
 (
$v¬ŸbËs
['»suÉs'] 
as
 
$»suÉ
) {

64 
$v¬ŸbËs
['£¬ch_»suÉs'] .ğ
	`theme
('£¬ch_»suÉ', 
$»suÉ
, $variables['type']);

66 
$v¬ŸbËs
['·g”'] = 
	`theme
('·g”', 
NULL
, 10, 0);

68 
$v¬ŸbËs
['template_files'][] = 'search-results-'. $variables['type'];

69 
	}
}

80 
funùiÚ
 
	$‹m¶©e_´•roûss_£¬ch_»suÉ
(&
$v¬ŸbËs
) {

81 
$»suÉ
 = 
$v¬ŸbËs
['result'];

82 
$v¬ŸbËs
['u¾'] = 
	`check_u¾
(
$»suÉ
['link']);

83 
$v¬ŸbËs
['t™Ë'] = 
	`check_¶aš
(
$»suÉ
['title']);

85 
$šfo
 = 
	`¬¿y
();

86 ià(!
	`em±y
(
$»suÉ
['type'])) {

87 
$šfo
['ty³'] = 
	`check_¶aš
(
$»suÉ
['type']);

89 ià(!
	`em±y
(
$»suÉ
['user'])) {

90 
$šfo
['u£r'] = 
$»suÉ
['user'];

92 ià(!
	`em±y
(
$»suÉ
['date'])) {

93 
$šfo
['d©e'] = 
	`fÜm©_d©e
(
$»suÉ
['date'], 'small');

95 ià(
	`is£t
(
$»suÉ
['exŒa']è&& 
	`is_¬¿y
($result['extra'])) {

96 
$šfo
 = 
	`¬¿y_m”ge
($šfo, 
$»suÉ
['extra']);

99 
$v¬ŸbËs
['¢³t'] = 
	`is£t
(
$»suÉ
['snippet']) ? $result['snippet'] : '';

101 
$v¬ŸbËs
['šfo_¥l™'] = 
$šfo
;

102 
$v¬ŸbËs
['šfo'] = 
	`im¶ode
(' - ', 
$šfo
);

104 
$v¬ŸbËs
['template_files'][] = 'search-result-'. $variables['type'];

105 
	}
}

113 
funùiÚ
 
	$£¬ch_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

114 
	`fÜm_£t_v®ue
(
$fÜm
['basic']['šlše']['´oûs£d_keys'], 
	`Œim
(
$fÜm_¡©e
['values']['keys']), $form_state);

115 
	}
}

120 
funùiÚ
 
	$£¬ch_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

121 
$keys
 = 
$fÜm_¡©e
['values']['processed_keys'];

122 ià(
$keys
 == '') {

123 
	`fÜm_£t_”rÜ
('keys', 
	`t
('Pleaseƒnter some keywords.'));

127 
$ty³
 = 
$fÜm_¡©e
['values']['module'] ? $form_state['values']['module'] : 'node';

128 
$fÜm_¡©e
['»dœeù'] = '£¬ch/'. 
$ty³
 .'/'. 
$keys
;

130 
	}
}

	@/srv/http/subs/notes/www/modules/statistics/statistics.admin.inc

1 <?
php


12 
funùiÚ
 
	$¡©i¡ics_»ûÁ_h™s
() {

13 
$h—d”
 = 
	`¬¿y
(

14 
	`¬¿y
('d©a' => 
	`t
('Timestamp'), 'field' => 'a.timestamp', 'sort' => 'desc'),

15 
	`¬¿y
('d©a' => 
	`t
('Page'), 'field' => 'a.path'),

16 
	`¬¿y
('d©a' => 
	`t
('User'), 'field' => 'u.name'),

17 
	`¬¿y
('d©a' => 
	`t
('Operations'))

20 
$sql
 = 'SELECT‡.aid,‡.·th,‡.t™Ë,‡.uid, u.Çme,‡.time¡am°FROM {acûs¦og}‡ LEFT JOIN {u£rs} u ON u.uid =‡.uid'. 
	`bËsÜt_sql
(
$h—d”
);

22 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
, 30);

23 
$rows
 = 
	`¬¿y
();

24 
$log
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

25 
$rows
[] = 
	`¬¿y
(

26 
	`¬¿y
('d©a' => 
	`fÜm©_d©e
(
$log
->
time¡amp
, 'small'), 'class' => 'nowrap'),

27 
	`_¡©i¡ics_fÜm©_™em
(
$log
->
t™Ë
, $log->
·th
),

28 
	`theme
('u£ºame', 
$log
),

29 
	`l
(
	`t
('details'), "admin/reports/access/$log->aid"));

32 ià(
	`em±y
(
$rows
)) {

33 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No statistics‡vailable.'), 'colspan' => 4));

36 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

37 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 30, 0);

38  
$ouut
;

39 
	}
}

44 
funùiÚ
 
	$¡©i¡ics_tİ_·ges
() {

46 
$sql
 = "SELECT COUNT(path) AS hits,…ath, MAX(title) ASitle, AVG(timer) AS‡verage_time, SUM(timer) ASotal_time FROM {accesslog} GROUP BY…ath";

47 
$sql_út
 = "SELECT COUNT(DISTINCT(path)) FROM {accesslog}";

49 
$h—d”
 = 
	`¬¿y
(

50 
	`¬¿y
('d©a' => 
	`t
('Hits'), 'field' => 'hits', 'sort' => 'desc'),

51 
	`¬¿y
('d©a' => 
	`t
('Page'), 'field' => 'path'),

52 
	`¬¿y
('d©a' => 
	`t
('Average…age generationime'), 'field' => 'average_time'),

53 
	`¬¿y
('d©a' => 
	`t
('Total…age generationime'), 'field' => 'total_time')

55 
$sql
 .ğ
	`bËsÜt_sql
(
$h—d”
);

56 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
, 30, 0, 
$sql_út
);

58 
$rows
 = 
	`¬¿y
();

59 
$·ge
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

60 
$rows
[] = 
	`¬¿y
(
$·ge
->
h™s
, 
	`_¡©i¡ics_fÜm©_™em
($·ge->
t™Ë
, $·ge->
·th
), 
	`t
('%timms',‡¼ay('%time' => 
	`round
($·ge->
av”age_time
))), 
	`fÜm©_š‹rv®
Ôound($·ge->
tÙ®_time
 / 1000)));

63 ià(
	`em±y
(
$rows
)) {

64 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No statistics‡vailable.'), 'colspan' => 4));

67 
	`dru·l_£t_t™Ë
(
	`t
('Tİ…age šh·¡ %š‹rv®', 
	`¬¿y
('%š‹rv®' => 
	`fÜm©_š‹rv®
(
	`v¬ŸbË_g‘
('statistics_flush_accesslog_timer', 259200)))));

68 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

69 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 30, 0);

70  
$ouut
;

71 
	}
}

76 
funùiÚ
 
	$¡©i¡ics_tİ_vis™Üs
() {

78 
$h—d”
 = 
	`¬¿y
(

79 
	`¬¿y
('d©a' => 
	`t
('Hits'), 'field' => 'hits', 'sort' => 'desc'),

80 
	`¬¿y
('d©a' => 
	`t
('Visitor'), 'field' => 'u.name'),

81 
	`¬¿y
('d©a' => 
	`t
('Total…age generationime'), 'field' => 'total'),

82 
	`¬¿y
('d©a' => 
	`t
('Operations'))

85 
$sql
 = "SELECT COUNT×.uidèAS h™s,‡.uid, u.Çme,‡.ho¡Çme, SUM×.tim”èASÙ®,‡c.aid FROM {acûs¦og}‡ LEFT JOIN {acûss}‡øON‡c.ty³ = 'ho¡' AND LOWER×.ho¡ÇmeèLIKE (ac.maskèLEFT JOIN {u£rs} u ON‡.uid = u.uid GROUP BY‡.ho¡Çme,‡.uid, u.Çme,‡c.aid". 
	`bËsÜt_sql
(
$h—d”
);

86 
$sql_út
 = "SELECT COUNT(*) FROM (SELECT DISTINCT uid, hostname FROM {accesslog}) AS unique_visits";

87 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
, 30, 0, 
$sql_út
);

89 
$rows
 = 
	`¬¿y
();

90 
$accouÁ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

91 
$qs
 = 
	`dru·l_g‘_de¡š©iÚ
();

92 
$bª_lšk
 = 
$accouÁ
->
aid
 ? 
	`l
(
	`t
('unbª'), "admš/u£r/ruËs/d–‘e/$accouÁ->aid", 
	`¬¿y
('qu”y' => 
$qs
)) :†(t('ban'), "admin/user/rules/add/$account->hostname/host",‡rray('query' => $qs));

93 
$rows
[] = 
	`¬¿y
(
$accouÁ
->
h™s
, ($accouÁ->
uid
 ? 
	`theme
('u£ºame', $accouÁè: $accouÁ->
ho¡Çme
), 
	`fÜm©_š‹rv®
(
	`round
($accouÁ->
tÙ®
 / 1000)), 
$bª_lšk
);

96 ià(
	`em±y
(
$rows
)) {

97 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No statistics‡vailable.'), 'colspan' => 4));

100 
	`dru·l_£t_t™Ë
(
	`t
('Tİ vis™Ü šh·¡ %š‹rv®', 
	`¬¿y
('%š‹rv®' => 
	`fÜm©_š‹rv®
(
	`v¬ŸbË_g‘
('statistics_flush_accesslog_timer', 259200)))));

101 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

102 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 30, 0);

103  
$ouut
;

104 
	}
}

109 
funùiÚ
 
	$¡©i¡ics_tİ_»ã¼”s
() {

110 
$qu”y
 = "SELECT url, COUNT(url) AS hits, MAX(timestamp) AS†ast FROM {accesslog} WHERE url NOT LIKE '%%%s%%' AND url <> '' GROUP BY url";

111 
$qu”y_út
 = "SELECT COUNT(DISTINCT(url)) FROM {accesslog} WHERE url <> '' AND url NOT LIKE '%%%s%%'";

112 
	`dru·l_£t_t™Ë
(
	`t
('Tİ„eã¼” šh·¡ %š‹rv®', 
	`¬¿y
('%š‹rv®' => 
	`fÜm©_š‹rv®
(
	`v¬ŸbË_g‘
('statistics_flush_accesslog_timer', 259200)))));

114 
$h—d”
 = 
	`¬¿y
(

115 
	`¬¿y
('d©a' => 
	`t
('Hits'), 'field' => 'hits', 'sort' => 'desc'),

116 
	`¬¿y
('d©a' => 
	`t
('Url'), 'field' => 'url'),

117 
	`¬¿y
('d©a' => 
	`t
('Last visit'), 'field' => 'last'),

120 
$qu”y
 .ğ
	`bËsÜt_sql
(
$h—d”
);

121 
$»suÉ
 = 
	`·g”_qu”y
(
$qu”y
, 30, 0, 
$qu”y_út
, 
$_SERVER
['HTTP_HOST']);

123 
$rows
 = 
	`¬¿y
();

124 
$»ã¼”
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

125 
$rows
[] = 
	`¬¿y
(
$»ã¼”
->
h™s
, 
	`_¡©i¡ics_lšk
($»ã¼”->
u¾
), 
	`t
('@timago',‡¼ay('@time' => 
	`fÜm©_š‹rv®
(
	`time
(è- $»ã¼”->
Ï¡
))));

128 ià(
	`em±y
(
$rows
)) {

129 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No statistics‡vailable.'), 'colspan' => 3));

132 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

133 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 30, 0);

134  
$ouut
;

135 
	}
}

140 
funùiÚ
 
	$¡©i¡ics_acûss_log
(
$aid
) {

141 
$»suÉ
 = 
	`db_qu”y
('SELECT‡.*, u.ÇmFROM {acûs¦og}‡ LEFT JOIN {u£rs} u ON‡.uid = u.uid WHERE‡id = %d', 
$aid
);

142 ià(
$acûss
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

143 
$rows
[] = 
	`¬¿y
(

144 
	`¬¿y
('d©a' => 
	`t
('URL'), 'h—d”' => 
TRUE
),

145 
	`l
(
	`u¾
(
$acûss
->
·th
, 
	`¬¿y
('absŞu‹' => 
TRUE
)), $access->path)

149 
$rows
[] = 
	`¬¿y
(

150 
	`¬¿y
('d©a' => 
	`t
('T™Ë'), 'h—d”' => 
TRUE
),

151 
$acûss
->
t™Ë


153 
$rows
[] = 
	`¬¿y
(

154 
	`¬¿y
('d©a' => 
	`t
('Reã¼”'), 'h—d”' => 
TRUE
),

155 (
$acûss
->
u¾
 ? 
	`l
($access->url, $access->url) : '')

157 
$rows
[] = 
	`¬¿y
(

158 
	`¬¿y
('d©a' => 
	`t
('D©e'), 'h—d”' => 
TRUE
),

159 
	`fÜm©_d©e
(
$acûss
->
time¡amp
, 'large')

161 
$rows
[] = 
	`¬¿y
(

162 
	`¬¿y
('d©a' => 
	`t
('U£r'), 'h—d”' => 
TRUE
),

163 
	`theme
('u£ºame', 
$acûss
)

165 
$rows
[] = 
	`¬¿y
(

166 
	`¬¿y
('d©a' => 
	`t
('Ho¡Çme'), 'h—d”' => 
TRUE
),

167 
	`check_¶aš
(
$acûss
->
ho¡Çme
)

170  
	`theme
('bË', 
	`¬¿y
(), 
$rows
);

173 
	`dru·l_nÙ_found
();

175 
	}
}

183 
funùiÚ
 
	$¡©i¡ics_acûss_loggšg_£‰šgs
() {

185 
$İtiÚs
 = 
	`¬¿y
('1' => 
	`t
('Enabled'), '0' =>('Disabled'));

186 
$fÜm
['acûss'] = 
	`¬¿y
(

188 '#t™Ë' => 
	`t
('Access†og settings'));

189 
$fÜm
['acûss']['¡©i¡ics_’abË_acûss_log'] = 
	`¬¿y
(

191 '#t™Ë' => 
	`t
('Enable‡ccess†og'),

192 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('statistics_enable_access_log', 0),

193 '#İtiÚs' => 
$İtiÚs
,

194 '#desütiÚ' => 
	`t
('Logƒach…age‡ccess. Required for„eferrer statistics.'));

195 
$³riod
 = 
	`¬¿y
('0' => 
	`t
('Nev”')è+ 
	`dru·l_m­_assoc
(array(3600, 10800, 21600, 32400, 43200, 86400, 172800, 259200, 604800, 1209600, 2419200, 4838400, 9676800), 'format_interval');

196 
$fÜm
['acûss']['¡©i¡ics_æush_acûs¦og_tim”'] = 
	`¬¿y
(

198 '#t™Ë' => 
	`t
('Discard‡ccess†ogs olderhan'),

199 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('statistics_flush_accesslog_timer', 259200),

200 '#İtiÚs' => 
$³riod
,

201 '#desütiÚ' => 
	`t
('Old”‡cûs logƒÁr› (šşudšg„eã¼” sti¡icsèwÈbautom©iÿÎy disÿrded. (Requœe ¨cÜ»ùly cÚfigu»d <¨h»f="@üÚ">üÚ maš‹Çnûask</a>.)', 
	`¬¿y
('@üÚ' => 
	`u¾
('admin/reports/status'))));

204 
$fÜm
['cÚ‹Á'] = 
	`¬¿y
(

206 '#t™Ë' => 
	`t
('Content viewing counter settings'));

207 
$fÜm
['cÚ‹Á']['¡©i¡ics_couÁ_cÚ‹Á_v›ws'] = 
	`¬¿y
(

209 '#t™Ë' => 
	`t
('Count content views'),

210 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('statistics_count_content_views', 0),

211 '#İtiÚs' => 
$İtiÚs
,

212 '#desütiÚ' => 
	`t
('Increment‡ counterƒachime content is viewed.'));

214  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

215 
	}
}

	@/srv/http/subs/notes/www/modules/statistics/statistics.module

1 <?
php


12 
funùiÚ
 
	$¡©i¡ics_h–p
(
$·th
, 
$¬g
) {

13 
$·th
) {

15 
$ouut
 = '<p>'. 
	`t
('The statistics module keepsrack of‚umerous site usage statistics, includinghe‚umber ofimes,‡nd from where,ƒach of your…osts is viewed. These statistics‡re useful in determining how users‡re interacting withƒach other‡nd with your site,‡nd‡re„equired forhe display of some Drupal blocks.') .'</p>';

16 
$ouut
 .ğ'<p>'. 
	`t
('The statistics module…rovides:') .'</p>';

17 
$ouut
 .ğ'<ul><li>'. 
	`t
('¨couÁ” fÜƒach…o¡ oÀyou¸s™th© inüem’t —chimthpo¡ i v›wed. (EÇbË <em>CouÁ cÚ‹Á v›ws</em> oÀth<¨h»f="@acûs¦og">acûs log s‘tšg ·ge</a>,‡nd d‘”mšiàthpo¡‡cûs couÁ” should bvisibËØªy u£¸rŞe Úh<¨h»f="@³rmissiÚs">³rmissiÚ ·ge</a>.)', 
	`¬¿y
('@acûs¦og' => 
	`u¾
('admin/reports/settings'), '@permissions' => url('admin/user/permissions'))) .'</li>';

18 
$ouut
 .ğ'<li>'. 
	`t
('¨<¨h»f="@»ûÁ-h™s">»ûÁ h™s</a>†ogh© di¥Ïy šfÜm©iÚ‡bouˆthÏ‹¡‡ùiv™y oÀyou¸s™e, inşudšghURL‡nd™Ë oàth·gacûs£d,hu£¸Çm(iàavaabËèªd IP‡dd»s oàthacûssšg…¬ty.', 
	`¬¿y
('@»ûÁ-h™s' => 
	`u¾
('admin/reports/hits'))) .'</li>';

19 
$ouut
 .ğ'<li>'. 
	`t
('¨<¨h»f="@tİ-»ã¼”s">tİ„eã¼”s</a>†ogh© di¥Ïy th»ã¼šg…¬t› fÜ you¸s™vis™ (wh”you¸vis™Ü ÿmäom).', 
	`¬¿y
('@tİ-»ã¼”s' => 
	`u¾
('admin/reports/referrers'))) .'</li>';

20 
$ouut
 .ğ'<li>'. 
	`t
('¨<¨h»f="@tİ-·ges">tİ…ages</a>†ogh© di¥Ïy s™cÚ‹Á iÀdesûndšg ord” by‚umb” oàv›ws.', 
	`¬¿y
('@tİ-·ges' => 
	`u¾
('admin/reports/pages'))) .'</li>';

21 
$ouut
 .ğ'<li>'. 
	`t
('¨<¨h»f="@tİ-vis™Üs">tİ vis™Üs</a>†ogh© di¥Ïy thmo¡‡ùivu£r Ú you¸s™e.', 
	`¬¿y
('@tİ-vis™Üs' => 
	`u¾
('admin/reports/visitors'))) .'</li>';

22 
$ouut
 .ğ'<li>'. 
	`t
('¨<em>PİuÏ¸cÚ‹Á</em> blockh© di¥Ïy thday\' mo¡ v›wed cÚ‹Á,h®l-timmo¡ v›wed cÚ‹Á,‡ndhÏ¡ cÚ‹Á v›wed. (EÇbËh<em>PİuÏ¸cÚ‹Á</em> block oÀth<¨h»f="@blocks">block admši¡¿tiÚ…age</a>.)', 
	`¬¿y
('@blocks' => 
	`u¾
('admin/build/block'))) .'</li></ul>';

23 
$ouut
 .ğ'<p>'. 
	`t
('Configuringhe statistics module') .'</p>';

24 
$ouut
 .ğ'<ul><li>'. 
	`t
('Wh’h<em>EÇbË‡cûs log</em> s‘tšg oÀth<¨h»f="@acûs¦og">acûs log s‘tšg ·ge</a> i ’abËd, d©¨abouˆev”y…agacûs£d (šşudšgh»mÙho¡\' IP‡dd»ss,„eã¼”,‚odacûs£d,‡nd u£¸Çmeèi ¡Üed iÀthacûs log. Thacûs log mu¡ b’abËd fÜh<¨h»f="@»ûÁ-h™s">»ûÁ h™s</a>, <¨h»f="@tİ-»ã¼”s">tİ„eã¼”s</a>, <¨h»f="@tİ-·ges">tİ…ages</a>,‡nd <¨h»f="@tİ-vis™Üs">tİ vis™Üs</a>†og…age tØfunùiÚ. EÇblšghacûs log‡dd Úadd™iÚ® d©aba£ c®È³¸·gdi¥Ïyed by Dru·l.', 
	`¬¿y
('@acûs¦og' => 
	`u¾
('admin/reports/settings'), '@recent-hits' => url('admin/reports/hits'), '@top-referrers' => url('admin/reports/referrers'), '@top-pages' => url('admin/reports/pages'), '@top-visitors' => url('admin/reports/visitors'))) .'</li>';

25 
$ouut
 .ğ'<li>'. 
	`t
('Th<em>Disÿrd‡cûs log Şd”hª</em> s‘tšg oÀth<¨h»f="@acûs¦og">acûs log s‘tšg ·ge</a> s³cif› thËngth oàtim’Œ› ¬»šed iÀthacûs log befÜthey‡» d–‘ed. Autom©iøacûs logƒÁry d–‘iÚ„equœe ¨cÜ»ùly cÚfigu»d <¨h»f="@üÚ">üÚ maš‹Çnûask</a>.', 
	`¬¿y
('@acûs¦og' => 
	`u¾
('admin/reports/settings'), '@cron' => url('admin/reports/status'))) .'</li>';

26 
$ouut
 .ğ'<li>'. 
	`t
('Th<em>CouÁ cÚ‹Á v›ws</em> s‘tšg oÀth<¨h»f="@acûs¦og">acûs log s‘tšg ·ge</a>ƒÇbË ¨couÁ” fÜƒach…o¡ oÀyou¸s™th© inüem’t —chimthpo¡ i v›wed. Thi İtiÚ mu¡ b’abËdØ´ovidpo¡-¥ecifiøacûs couÁs. EÇblšghi İtiÚ‡dd Úadd™iÚ® d©aba£ c®È³¸—ch…o¡ di¥Ïyed by Dru·l.', 
	`¬¿y
('@acûs¦og' => 
	`u¾
('admin/reports/settings'))) .'</li></ul>';

27 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@¡©i¡ics">Sti¡ic moduË</a>.', 
	`¬¿y
('@statistics' => 'http://drupal.org/handbook/modules/statistics/')) .'</p>';

28  
$ouut
;

30  '<p>'. 
	`t
('S‘tšg fÜh¡©i¡iÿÈšfÜm©iÚh© Dru·ÈwÈk“°abouˆths™e. S“ <¨h»f="@¡©i¡ics">s™¡©i¡ics</a> fÜhaùu® infÜm©iÚ.', 
	`¬¿y
('@¡©i¡ics' => 
	`u¾
('admin/reports/hits'))) .'</p>';

32  '<p>'. 
	`t
("This…age displayshe site's most„ecent hits.") .'</p>';

34  '<p>'. 
	`t
('This…age displays‡llƒxternal„eferrers, orƒxternal„eferenceso your website.') .'</p>';

36  '<p>'. 
	`t
("When you ban‡ visitor, you…reventhe visitor's IP‡ddress from‡ccessing your site. Unlike blocking‡ user, banning‡ visitor worksƒven for‡nonymous users. This is most commonly usedo block„esource-intensive bots or web crawlers.") .'</p>';

38 
	}
}

45 
funùiÚ
 
	$¡©i¡ics_ex™
() {

46 
glob®
 
$u£r
, 
$»ûÁ_aùiv™y
;

48 
	`dru·l_boÙ¡¿p
(
DRUPAL_BOOTSTRAP_PATH
);

50 ià(
	`v¬ŸbË_g‘
('statistics_count_content_views', 0)) {

52 ià((
	`¬g
(0è=ğ'node'è&& 
	`is_num”ic
(arg(1)) &&‡rg(2) == '') {

54 
	`db_qu”y
('UPDATE {node_couÁ”} SET daycouÁ = daycouÁ + 1,Ù®couÁ =Ù®couÁ + 1,ime¡am°ğ%d WHERE‚id = %d', 
	`time
(), 
	`¬g
(1));

56 ià(!
	`db_afãùed_rows
()) {

58 
	`db_qu”y
('INSERT INTO {node_couÁ”} (nid, daycouÁ,Ù®couÁ,ime¡ampèVALUES (%d, 1, 1, %d)', 
	`¬g
(1), 
	`time
());

62 ià((
	`v¬ŸbË_g‘
('¡©i¡ics_’abË_acûss_log', 0)è&& (
	`moduË_švoke
('throttle', 'status') == 0)) {

64 
	`db_qu”y
("INSERT INTO {acûs¦og} (t™Ë,…©h, u¾, ho¡Çme, uid, sid,im”,ime¡ampèv®ues('%s', '%s', '%s', '%s', %d, '%s', %d, %d)", 
	`¡r_gs
(
	`dru·l_g‘_t™Ë
()), 
$_GET
['q'], 
	`»ã»r_uri
(), 
	`_add»ss
(), 
$u£r
->
uid
, 
	`£ssiÚ_id
(), 
	`tim”_»ad
('·ge'), 
	`time
());

66 
	}
}

71 
funùiÚ
 
	$¡©i¡ics_³rm
() {

72  
	`¬¿y
('access statistics', 'view…ost‡ccess counter');

73 
	}
}

78 
funùiÚ
 
	$¡©i¡ics_lšk
(
$ty³
, 
$node
 = 
NULL
, 
$‹a£r
 = 
FALSE
) {

79 
glob®
 
$id
;

80 
$lšks
 = 
	`¬¿y
();

82 ià(
$ty³
 =ğ'node' && 
	`u£r_acûss
('view…ost‡ccess counter')) {

83 
$¡©i¡ics
 = 
	`¡©i¡ics_g‘
(
$node
->
nid
);

84 ià(
$¡©i¡ics
) {

85 
$lšks
['¡©i¡ics_couÁ”']['t™Ë'] = 
	`fÜm©_¶u¿l
(
$¡©i¡ics
['totalcount'], '1„ead', '@count„eads');

89  
$lšks
;

90 
	}
}

95 
funùiÚ
 
	$¡©i¡ics_m’u
() {

96 
$™ems
['admš/»pÜts/h™s'] = 
	`¬¿y
(

100 'acûs ¬gum’ts' => 
	`¬¿y
('access statistics'),

103 
$™ems
['admš/»pÜts/·ges'] = 
	`¬¿y
(

107 'acûs ¬gum’ts' => 
	`¬¿y
('access statistics'),

111 
$™ems
['admš/»pÜts/vis™Üs'] = 
	`¬¿y
(

115 'acûs ¬gum’ts' => 
	`¬¿y
('access statistics'),

119 
$™ems
['admš/»pÜts/»ã¼”s'] = 
	`¬¿y
(

123 'acûs ¬gum’ts' => 
	`¬¿y
('access statistics'),

126 
$™ems
['admš/»pÜts/acûss/%'] = 
	`¬¿y
(

130 '·g¬gum’ts' => 
	`¬¿y
(3),

131 'acûs ¬gum’ts' => 
	`¬¿y
('access statistics'),

132 'ty³' => 
MENU_CALLBACK
,

135 
$™ems
['admš/»pÜts/£‰šgs'] = 
	`¬¿y
(

139 '·g¬gum’ts' => 
	`¬¿y
('statistics_access_logging_settings'),

140 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

141 'ty³' => 
MENU_NORMAL_ITEM
,

145 
$™ems
['u£r/%u£r/Œack/Çvig©iÚ'] = 
	`¬¿y
(

149 'acûs ¬gum’ts' => 
	`¬¿y
('access statistics'),

150 'ty³' => 
MENU_LOCAL_TASK
,

154 
$™ems
['node/%node/Œack'] = 
	`¬¿y
(

158 'acûs ¬gum’ts' => 
	`¬¿y
('access statistics'),

159 'ty³' => 
MENU_LOCAL_TASK
,

164  
$™ems
;

165 
	}
}

170 
funùiÚ
 
	$¡©i¡ics_u£r
(
$İ
, &
$ed™
, &
$u£r
) {

171 ià(
$İ
 == 'delete') {

172 
	`db_qu”y
('UPDATE {acûs¦og} SET uid = 0 WHERE uid = %d', 
$u£r
->
uid
);

174 
	}
}

179 
funùiÚ
 
	$¡©i¡ics_üÚ
() {

180 
$¡©i¡ics_time¡amp
 = 
	`v¬ŸbË_g‘
('statistics_day_timestamp', '');

182 ià((
	`time
(è- 
$¡©i¡ics_time¡amp
) >= 86400) {

184 
	`db_qu”y
('UPDATE {node_counter} SET daycount = 0');

185 
	`v¬ŸbË_£t
('¡©i¡ics_day_time¡amp', 
	`time
());

189 ià(
	`v¬ŸbË_g‘
('statistics_flush_accesslog_timer', 259200) > 0) {

190 
	`db_qu”y
('DELETE FROM {acûs¦og} WHEREime¡am°< %d', 
	`time
(è- 
	`v¬ŸbË_g‘
('statistics_flush_accesslog_timer', 259200));

192 
	}
}

210 
funùiÚ
 
	$¡©i¡ics_t™Ë_li¡
(
$dbf›ld
, 
$dbrows
) {

211 ià(
	`š_¬¿y
(
$dbf›ld
, 
	`¬¿y
('totalcount', 'daycount', 'timestamp'))) {

212  
	`db_qu”y_¿nge
(
	`db_»wr™e_sql
("SELECT‚.nid,‚.t™Ë, u.uid, u.ÇmFROM {node}‚ INNER JOIN {node_couÁ”} s ON‚.nid = s.nid INNER JOIN {u£rs} u ON‚.uid = u.uid WHERE s.". 
$dbf›ld
 ." !ğ0 AND‚.¡©u ğ1 ORDER BY s.". $dbf›ld ." DESC"), 0, 
$dbrows
);

214  
FALSE
;

215 
	}
}

231 
funùiÚ
 
	$¡©i¡ics_g‘
(
$nid
) {

233 ià(
$nid
 > 0) {

235 
$¡©i¡ics
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
('SELECTÙ®couÁ, daycouÁ,ime¡am°FROM {node_couÁ”} WHERE‚id = %d', 
$nid
));

238  
$¡©i¡ics
;

239 
	}
}

244 
funùiÚ
 
¡©i¡ics_block
(
$İ
 = 'li¡', 
$d–
 = 0, 
$ed™
 = 
	$¬¿y
()) {

245 
$İ
) {

247 ià(
	`v¬ŸbË_g‘
('statistics_count_content_views', 0)) {

248 
$blocks
[0]['šfo'] = 
	`t
('Popular content');

250 
$blocks
[0]['ÿche'] = 
BLOCK_NO_CACHE
;

251  
$blocks
;

257 
$numb”s
 = 
	`¬¿y
('0' => 
	`t
('Di§bËd')è+ 
	`dru·l_m­_assoc
(array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 20, 25, 30, 40));

258 
$fÜm
['¡©i¡ics_block_tİ_day_num'] = 
	`¬¿y
('#ty³' => '£Ëù', '#t™Ë' => 
	`t
("Numb” oàday' tİ v›w tØdi¥Ïy"), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('¡©i¡ics_block_tİ_day_num', 0), '#İtiÚs' => 
$numb”s
, '#description' =>('How many content itemso display in "day"†ist.'));

259 
$fÜm
['¡©i¡ics_block_tİ_®l_num'] = 
	`¬¿y
('#ty³' => '£Ëù', '#t™Ë' => 
	`t
('Numb” oà®Ètimv›w tØdi¥Ïy'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('¡©i¡ics_block_tİ_®l_num', 0), '#İtiÚs' => 
$numb”s
, '#description' =>('How many content itemso display in "allime"†ist.'));

260 
$fÜm
['¡©i¡ics_block_tİ_Ï¡_num'] = 
	`¬¿y
('#ty³' => '£Ëù', '#t™Ë' => 
	`t
('Numb” oàmo¡„eûÁ v›w tØdi¥Ïy'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('¡©i¡ics_block_tİ_Ï¡_num', 0), '#İtiÚs' => 
$numb”s
, '#description' =>('How many content itemso display in "recently viewed"†ist.'));

261  
$fÜm
;

264 
	`v¬ŸbË_£t
('¡©i¡ics_block_tİ_day_num', 
$ed™
['statistics_block_top_day_num']);

265 
	`v¬ŸbË_£t
('¡©i¡ics_block_tİ_®l_num', 
$ed™
['statistics_block_top_all_num']);

266 
	`v¬ŸbË_£t
('¡©i¡ics_block_tİ_Ï¡_num', 
$ed™
['statistics_block_top_last_num']);

270 ià(
	`u£r_acûss
('access content')) {

271 
$cÚ‹Á
 = 
	`¬¿y
();

273 
$daytİ
 = 
	`v¬ŸbË_g‘
('statistics_block_top_day_num', 0);

274 ià(
$daytİ
 && (
$»suÉ
 = 
	`¡©i¡ics_t™Ë_li¡
('daycouÁ', $daytİ)è&& (
$node_t™Ë_li¡
 = 
	`node_t™Ë_li¡
($»suÉ, 
	`t
("Today's:")))) {

275 
$cÚ‹Á
[] = 
$node_t™Ë_li¡
;

278 
$®Éim‘İ
 = 
	`v¬ŸbË_g‘
('statistics_block_top_all_num', 0);

279 ià(
$®Éim‘İ
 && (
$»suÉ
 = 
	`¡©i¡ics_t™Ë_li¡
('tÙ®couÁ', $®Éim‘İ)è&& (
$node_t™Ë_li¡
 = 
	`node_t™Ë_li¡
($»suÉ, 
	`t
('Allime:')))) {

280 
$cÚ‹Á
[] = 
$node_t™Ë_li¡
;

283 
$Ï¡tİ
 = 
	`v¬ŸbË_g‘
('statistics_block_top_last_num', 0);

284 ià(
$Ï¡tİ
 && (
$»suÉ
 = 
	`¡©i¡ics_t™Ë_li¡
('time¡amp', $Ï¡tİ)è&& (
$node_t™Ë_li¡
 = 
	`node_t™Ë_li¡
($»suÉ, 
	`t
('Last viewed:')))) {

285 
$cÚ‹Á
[] = 
$node_t™Ë_li¡
;

288 ià(
	`couÁ
(
$cÚ‹Á
)) {

289 
$block
['cÚ‹Á'] = 
	`im¶ode
('<b¸/>', 
$cÚ‹Á
);

290 
$block
['subjeù'] = 
	`t
('Popular content');

291  
$block
;

295 
	}
}

301 
funùiÚ
 
	$_¡©i¡ics_lšk
(
$·th
, 
$width
 = 35) {

302 
$t™Ë
 = 
	`dru·l_g‘_·th_®Ÿs
(
$·th
);

303 
$t™Ë
 = 
	`Œunÿ‹_utf8
($t™Ë, 
$width
, 
FALSE
, 
TRUE
);

304  
	`l
(
$t™Ë
, 
$·th
);

305 
	}
}

307 
funùiÚ
 
	$_¡©i¡ics_fÜm©_™em
(
$t™Ë
, 
$·th
) {

308 
$·th
 = ($path ? $path : '/');

309 
$ouut
 = (
$t™Ë
 ? "$title<br />" : '');

310 
$ouut
 .ğ
	`_¡©i¡ics_lšk
(
$·th
);

311  
$ouut
;

312 
	}
}

317 
funùiÚ
 
	$¡©i¡ics_nod—pi
(&
$node
, 
$İ
, 
$¬g
 = 0) {

318 
$İ
) {

321 
	`db_qu”y
('DELETE FROM {node_couÁ”} WHERE‚id = %d', 
$node
->
nid
);

323 
	}
}

	@/srv/http/subs/notes/www/modules/statistics/statistics.pages.inc

1 <?
php


9 
funùiÚ
 
	$¡©i¡ics_node_Œack”
() {

10 ià(
$node
 = 
	`node_lßd
(
	`¬g
(1))) {

12 
$h—d”
 = 
	`¬¿y
(

13 
	`¬¿y
('d©a' => 
	`t
('Time'), 'field' => 'a.timestamp', 'sort' => 'desc'),

14 
	`¬¿y
('d©a' => 
	`t
('Referrer'), 'field' => 'a.url'),

15 
	`¬¿y
('d©a' => 
	`t
('User'), 'field' => 'u.name'),

16 
	`¬¿y
('d©a' => 
	`t
('Operations')));

18 
$»suÉ
 = 
	`·g”_qu”y
("SELECT‡.aid,‡.time¡amp,‡.u¾,‡.uid, u.ÇmFROM {acûs¦og}‡ LEFT JOIN {u£rs} u ON‡.uid = u.uid WHERE‡.·th = 'node/%d' OR‡.·th LIKE 'node/%d/%%'". 
	`bËsÜt_sql
(
$h—d”
), 30, 0, 
NULL
, 
$node
->
nid
, $node->nid);

19 
$rows
 = 
	`¬¿y
();

20 
$log
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

21 
$rows
[] = 
	`¬¿y
(

22 
	`¬¿y
('d©a' => 
	`fÜm©_d©e
(
$log
->
time¡amp
, 'small'), 'class' => 'nowrap'),

23 
	`_¡©i¡ics_lšk
(
$log
->
u¾
),

24 
	`theme
('u£ºame', 
$log
),

25 
	`l
(
	`t
('details'), "admin/reports/access/$log->aid"));

28 ià(
	`em±y
(
$rows
)) {

29 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No statistics‡vailable.'), 'colspan' => 4));

32 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$node
->
t™Ë
));

33 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

34 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 30, 0);

35  
$ouut
;

38 
	`dru·l_nÙ_found
();

40 
	}
}

42 
funùiÚ
 
	$¡©i¡ics_u£r_Œack”
() {

43 ià(
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => 
	`¬g
(1)))) {

45 
$h—d”
 = 
	`¬¿y
(

46 
	`¬¿y
('d©a' => 
	`t
('Timestamp'), 'field' => 'timestamp', 'sort' => 'desc'),

47 
	`¬¿y
('d©a' => 
	`t
('Page'), 'field' => 'path'),

48 
	`¬¿y
('d©a' => 
	`t
('Operations')));

50 
$»suÉ
 = 
	`·g”_qu”y
('SELECT‡id,ime¡amp,…©h,™Ë FROM {acûs¦og} WHERE uid = %d'. 
	`bËsÜt_sql
(
$h—d”
), 30, 0, 
NULL
, 
$accouÁ
->
uid
);

51 
$rows
 = 
	`¬¿y
();

52 
$log
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

53 
$rows
[] = 
	`¬¿y
(

54 
	`¬¿y
('d©a' => 
	`fÜm©_d©e
(
$log
->
time¡amp
, 'small'), 'class' => 'nowrap'),

55 
	`_¡©i¡ics_fÜm©_™em
(
$log
->
t™Ë
, $log->
·th
),

56 
	`l
(
	`t
('details'), "admin/reports/access/$log->aid"));

59 ià(
	`em±y
(
$rows
)) {

60 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No statistics‡vailable.'), 'colspan' => 3));

63 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$accouÁ
->
Çme
));

64 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

65 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 30, 0);

66  
$ouut
;

69 
	`dru·l_nÙ_found
();

71 
	}
}

	@/srv/http/subs/notes/www/modules/syslog/syslog.module

1 <?
php


9 ià(
defšed
('LOG_LOCAL0')) {

10 
defše
('DEFAULT_SYSLOG_FACILITY', 
LOG_LOCAL0
);

13 
defše
('DEFAULT_SYSLOG_FACILITY', 
LOG_USER
);

19 
funùiÚ
 
	$sy¦og_h–p
(
$·th
, 
$¬g
) {

20 
$·th
) {

22 
$ouut
 = '<p>'. 
	`t
("The syslog moduleƒnables Drupalo send messagesohe operating system's†ogging facility.") .'</p>';

23 
$ouut
 .ğ'<p>'. 
	`t
('Sy¦og i ª o³¿tšg sy¡em‡dmši¡¿tivloggšgoŞ,‡nd…rovide v®uabË infÜm©iÚ fÜ u£ iÀsy¡em mªagem’ˆªd secur™y‡ud™šg. Mo¡ su™edØmedium‡nd†¬gs™es, sy¦og…rovide f‹ršgoŞ th©‡Îow mes§ge tØbrou‹d byy³‡nd sev”™y. OÀUNIX/Lšux sy¡ems,hf/‘c/sy¦og.cÚàdefše thi routšg cÚfigu¿tiÚ; oÀMiüosoá Wšdows,‡Î mes§ge ¬£ÁØthEv’ˆLog. FÜ mÜšfÜm©iÚ oÀsy¦og fac™›s, sev”™y†ev–s,‡nd howØ£ˆu°¨sy¦og.cÚàfe, s“ <¨h»f="@sy¦og_cÚf">UNIX/Lšux sy¦og.cÚf</a>‡nd PHP\' <¨h»f="@php_İ’log">İ’log</a>‡nd <¨h»f="@php_sy¦og">sy¦og</a> funùiÚs.', 
	`¬¿y
('@sy¦og_cÚf' => 
	`u¾
('http://www.rt.com/man/syslog.5.html'), '@php_openlog' => url('http://www.php.net/manual/en/function.openlog.php'), '@php_syslog' => url('http://www.php.net/manual/en/function.syslog.php'))) .'</p>';

24 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@sy¦og">Sy¦og moduË</a>.', 
	`¬¿y
('@syslog' => 'http://drupal.org/handbook/modules/syslog')) .'</p>';

25  
$ouut
;

27 
	}
}

29 
funùiÚ
 
	$sy¦og_m’u
() {

30 
$™ems
['admš/£‰šgs/loggšg/sy¦og'] = 
	`¬¿y
(

34 '·g¬gum’ts' => 
	`¬¿y
('syslog_admin_settings'),

35 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

37  
$™ems
;

38 
	}
}

40 
funùiÚ
 
	$sy¦og_admš_£‰šgs
() {

41 
$fÜm
['sy¦og_çc™y'] = 
	`¬¿y
(

43 '#t™Ë' => 
	`t
('Sendƒventsohis syslog facility'),

44 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('sy¦og_çc™y', 
DEFAULT_SYSLOG_FACILITY
),

45 '#İtiÚs' => 
	`sy¦og_çc™y_li¡
(),

46 '#desütiÚ' => 
	`t
('S–eùhsy¦og fac™y codund” which Dru·l\' mes§ge should b£Á. OÀUNIX/Lšux sy¡ems, Dru·ÈÿÀæag it mes§ge w™hhcodLOG_LOCAL0hrough LOG_LOCAL7; fÜ Miüosoá Wšdows,‡Î mes§ge ¬æagged w™hhcodLOG_USER. D•’dšg oÀthsy¡em cÚfigu¿tiÚ, sy¦og‡nd oth”†oggšgoŞ u£hi codtØid’tify o¸f‹¸Dru·Èmes§ge äom w™hšh’tœsy¡em†og. FÜ mÜšfÜm©iÚ oÀsy¦og, s“ <¨h»f="@sy¦og_h–p">Sy¦og h–p</a>.', 
	`¬¿y
(

47 '@sy¦og_h–p' => 
	`u¾
('admin/help/syslog'))),

49  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

50 
	}
}

52 
funùiÚ
 
	$sy¦og_çc™y_li¡
() {

53 
$çc™y_li¡
 = 
	`¬¿y
(

54 
LOG_USER
 => 
	`t
('LOG_USER - User†evel messages. Usehis for Windows.'),

56 ià(
	`defšed
('LOG_LOCAL0')) {

57 
$çc™y_li¡
 +ğ
	`¬¿y
(

58 
LOG_LOCAL0
 => 
	`t
('LOG_LOCAL0 - Local 0'),

59 
LOG_LOCAL1
 => 
	`t
('LOG_LOCAL1 - Local 1'),

60 
LOG_LOCAL2
 => 
	`t
('LOG_LOCAL2 - Local 2'),

61 
LOG_LOCAL3
 => 
	`t
('LOG_LOCAL3 - Local 3'),

62 
LOG_LOCAL4
 => 
	`t
('LOG_LOCAL4 - Local 4'),

63 
LOG_LOCAL5
 => 
	`t
('LOG_LOCAL5 - Local 5'),

64 
LOG_LOCAL6
 => 
	`t
('LOG_LOCAL6 - Local 6'),

65 
LOG_LOCAL7
 => 
	`t
('LOG_LOCAL7 - Local 7'),

68  
$çc™y_li¡
;

69 
	}
}

71 
funùiÚ
 
	$sy¦og_w©chdog
(
$’Œy
) {

72 
$log_š™
 = 
FALSE
;

74 ià(!
$log_š™
) {

75 
$log_š™
 = 
TRUE
;

76 
	`İ’log
('dru·l', 
LOG_NDELAY
, 
	`v¬ŸbË_g‘
('sy¦og_çc™y', 
DEFAULT_SYSLOG_FACILITY
));

79 
	`sy¦og
(
$’Œy
['£v”™y'], 
	`theme
('syslog_format', $entry));

80 
	}
}

82 
funùiÚ
 
	$sy¦og_theme
() {

83  
	`¬¿y
(

84 'sy¦og_fÜm©' => 
	`¬¿y
(

85 '¬gum’ts' => 
	`¬¿y
('’Œy' => 
NULL
),

88 
	}
}

95 
funùiÚ
 
	$theme_sy¦og_fÜm©
(
$’Œy
) {

96 
glob®
 
$ba£_u¾
;

98 
$mes§ge
 = 
$ba£_u¾
;

99 
$mes§ge
 .ğ'|'. 
$’Œy
['timestamp'];

100 
$mes§ge
 .ğ'|'. 
$’Œy
['type'];

101 
$mes§ge
 .ğ'|'. 
$’Œy
['ip'];

102 
$mes§ge
 .ğ'|'. 
$’Œy
['request_uri'];

103 
$mes§ge
 .ğ'|'. 
$’Œy
['referer'];

104 
$mes§ge
 .ğ'|'. 
$’Œy
['u£r']->
uid
;

105 
$mes§ge
 .ğ'|'. 
	`¡r_gs
(
$’Œy
['link']);

106 
$mes§ge
 .ğ'|'. 
	`¡r_gs
(
	`is_nuÎ
(
$’Œy
['v¬ŸbËs']è? $’Œy['mes§ge'] : 
	`¡¹r
($entry['message'], $entry['variables']));

108  
$mes§ge
;

109 
	}
}

	@/srv/http/subs/notes/www/modules/system/block.tpl.php

1 <?
	gphp


29 <
div
 
	gid
="block-<?ph°´šˆ$block->moduË .'-'. $block->d–; ?>" 
şass
="block block-<?php…rint $block->module ?>">

30 <?
php
 ià(
$block
->
subjeù
): ?>

31 <
h2
><?
php
 
´št
 
$block
->
subjeù
 ?></h2>

32 <?
php
 
’dif
;?>

34 <
div
 
	gşass
="content">

35 <?
php
 
´št
 
$block
->
cÚ‹Á
 ?>

36 </
div
>

37 </
div
>

	@/srv/http/subs/notes/www/modules/system/box.tpl.php

1 <?
	gphp


16 <
div
 
	gşass
="box">

18 <?
php
 ià(
$t™Ë
): ?>

19 <
h2
><?
php
 
´št
 
$t™Ë
 ?></h2>

20 <?
php
 
’dif
; ?>

22 <
div
 
	gşass
="cÚ‹Á"><?
php
 
´št
 
$cÚ‹Á
 ?></div>

23 </
div
>

	@/srv/http/subs/notes/www/modules/system/maintenance-page.tpl.php

1 <?
	gphp


17 <!
DOCTYPE
 
html
 
	gPUBLIC
 "-//W3C//DTD XHTML 1.0 Strict//EN"

19 <
html
 
	gxmÊs
="h‰p://www.w3.Üg/1999/xhtml" 
xml
:
Ïng
="<?ph°´šˆ$Ïnguage->Ïnguag?>"†ªg="<?ph°´šˆ$Ïnguage->Ïnguag?>" 
dœ
="<?php…rint $language->dir ?>">

21 <
h—d
>

22 <?
php
 
´št
 
$h—d
; ?>

23 <
	gt™Ë
><?
php
 
´št
 
	g$h—d_t™Ë
; ?></title>

24 <?
php
 
´št
 
	g$¡yËs
; ?>

25 <?
php
 
´št
 
	g$süts
; ?>

26 <
süt
 
	gty³
="‹xt/javasüt"><?
php
 ?> </script>

27 </
h—d
>

28 <
body
 
şass
="<?php…rint $body_classes; ?>">

29 <
div
 
id
="page">

30 <
div
 
id
="header">

31 <
div
 
id
="logo-title">

33 <?
php
 ià(!
	$em±y
(
$logo
)): ?>

34 <
a
 
h»f
="<?ph°´šˆ$ba£_·th; ?>" 
t™Ë
="<?ph°´šˆt('Home'); ?>" 
»l
="home" 
id
="logo">

35 <
img
 
¤c
="<?ph°´šˆ$logo; ?>" 
®t
="<?php…rint('Home'); ?>" />

36 </
a
>

37 <?
php
 
’dif
; ?>

39 <
div
 
id
="name-and-slogan">

40 <?
php
 ià(!
	$em±y
(
$s™e_Çme
)): ?>

41 <
h1
 
id
="site-name">

42 <
a
 
h»f
="<?ph°´šˆ$ba£_·th ?>" 
t™Ë
="<?ph°´šˆt('Home'); ?>" 
»l
="home"><
¥ª
><?
php
 
´št
 
$s™e_Çme
; ?></span></a>

43 </
h1
>

44 <?
php
 
’dif
; ?>

46 <?
php
 ià(!
	$em±y
(
$s™e_¦ogª
)): ?>

47 <
div
 
id
="s™e-¦ogª"><?
php
 
´št
 
$s™e_¦ogª
; ?></div>

48 <?
php
 
’dif
; ?>

49 </
div
> <!-- /
Çme
-
ªd
-
¦ogª
 -->

50 </
div
> <!-- /
logo
-
t™Ë
 -->

52 <?
php
 ià(!
	$em±y
(
$h—d”
)): ?>

53 <
div
 
id
="header-region">

54 <?
php
 
´št
 
$h—d”
; ?>

55 </
div
>

56 <?
php
 
’dif
; ?>

58 </
div
> <!-- /
h—d”
 -->

60 <
div
 
id
="cÚš”" 
şass
="clear-block">

62 <?
php
 ià(!
	$em±y
(
$Ëá
)): ?>

63 <
div
 
id
="sideb¬-Ëá" 
şass
="column sidebar">

64 <?
php
 
´št
 
$Ëá
; ?>

65 </
div
> <!-- /
sideb¬
-
Ëá
 -->

66 <?
php
 
’dif
; ?>

68 <
div
 
id
="maš" 
şass
="column"><div id="main-squeeze">

70 <
div
 
id
="content">

71 <?
php
 ià(!
	$em±y
(
$t™Ë
)): ?><
h1
 
şass
="t™Ë" 
id
="·ge-t™Ë"><?
php
 
´št
 $t™Ë; ?></h1><?ph°
’dif
; ?>

72 <?
php
 ià(!
	$em±y
(
$mes§ges
)): 
´št
 $mes§ges; 
’dif
; ?>

73 <
div
 
id
="cÚ‹Á-cÚ‹Á" 
şass
="clear-block">

74 <?
php
 
´št
 
$cÚ‹Á
; ?>

75 </
div
> <!-- /
cÚ‹Á
-content -->

76 </
div
> <!-- /
cÚ‹Á
 -->

78 </
div
></div> <!-- /
maš
-
squ“ze
 /main -->

80 <?
php
 ià(!
	$em±y
(
$right
)): ?>

81 <
div
 
id
="sideb¬-right" 
şass
="column sidebar">

82 <?
php
 
´št
 
$right
; ?>

83 </
div
> <!-- /
sideb¬
-
right
 -->

84 <?
php
 
’dif
; ?>

86 </
div
> <!-- /
cÚš”
 -->

88 <
div
 
id
="footer-wrapper">

89 <
div
 
id
="footer">

90 <?
php
 
´št
 
$foÙ”_mes§ge
; ?>

91 <?
php
 ià(!
	$em±y
(
$foÙ”
)): 
´št
 $foÙ”; 
’dif
; ?>

92 </
div
> <!-- /
foÙ”
 -->

93 </
div
> <!-- /
foÙ”
-
w¿µ”
 -->

95 </
div
> <!-- /
·ge
 -->

97 </
body
>

98 </
html
>

	@/srv/http/subs/notes/www/modules/system/page.tpl.php

1 <?
	gphp


83 <!
DOCTYPE
 
html
 
	gPUBLIC
 "-//W3C//DTD XHTML 1.0 Strict//EN"

85 <
html
 
	gxmÊs
="h‰p://www.w3.Üg/1999/xhtml" 
xml
:
Ïng
="<?ph°´šˆ$Ïnguage->Ïnguag?>"†ªg="<?ph°´šˆ$Ïnguage->Ïnguag?>" 
dœ
="<?php…rint $language->dir ?>">

87 <
h—d
>

88 <?
php
 
´št
 
$h—d
; ?>

89 <
	gt™Ë
><?
php
 
´št
 
	g$h—d_t™Ë
; ?></title>

90 <?
php
 
´št
 
	g$¡yËs
; ?>

91 <?
php
 
´št
 
	g$süts
; ?>

92 <
süt
 
	gty³
="‹xt/javasüt"><?
php
 ?> </script>

93 </
h—d
>

94 <
body
 
şass
="<?php…rint $body_classes; ?>">

95 <
div
 
id
="page">

96 <
div
 
id
="header">

97 <
div
 
id
="logo-title">

99 <?
php
 ià(!
	$em±y
(
$logo
)): ?>

100 <
a
 
h»f
="<?ph°´šˆ$äÚt_·ge; ?>" 
t™Ë
="<?ph°´šˆt('Home'); ?>" 
»l
="home" 
id
="logo">

101 <
img
 
¤c
="<?ph°´šˆ$logo; ?>" 
®t
="<?php…rint('Home'); ?>" />

102 </
a
>

103 <?
php
 
’dif
; ?>

105 <
div
 
id
="name-and-slogan">

106 <?
php
 ià(!
	$em±y
(
$s™e_Çme
)): ?>

107 <
h1
 
id
="site-name">

108 <
a
 
h»f
="<?ph°´šˆ$äÚt_·g?>" 
t™Ë
="<?ph°´šˆt('Home'); ?>" 
»l
="home"><
¥ª
><?
php
 
´št
 
$s™e_Çme
; ?></span></a>

109 </
h1
>

110 <?
php
 
’dif
; ?>

112 <?
php
 ià(!
	$em±y
(
$s™e_¦ogª
)): ?>

113 <
div
 
id
="s™e-¦ogª"><?
php
 
´št
 
$s™e_¦ogª
; ?></div>

114 <?
php
 
’dif
; ?>

115 </
div
> <!-- /
Çme
-
ªd
-
¦ogª
 -->

116 </
div
> <!-- /
logo
-
t™Ë
 -->

118 <?
php
 ià(!
	$em±y
(
$£¬ch_box
)): ?>

119 <
div
 
id
="£¬ch-box"><?
php
 
´št
 
$£¬ch_box
; ?></div>

120 <?
php
 
’dif
; ?>

122 <?
php
 ià(!
	$em±y
(
$h—d”
)): ?>

123 <
div
 
id
="header-region">

124 <?
php
 
´št
 
$h—d”
; ?>

125 </
div
>

126 <?
php
 
’dif
; ?>

128 </
div
> <!-- /
h—d”
 -->

130 <
div
 
id
="cÚš”" 
şass
="clear-block">

132 <
div
 
id
="Çvig©iÚ" 
şass
="m’u <?ph°ià(!em±y($´im¬y_lšks)è{…ršˆ"
w™h´im¬y
"; } ià(!em±y($£cÚd¬y_lšks)è{…ršˆ" 
w™h£cÚd¬y
"; } ?> ">

133 <?
php
 ià(!
	$em±y
(
$´im¬y_lšks
)): ?>

134 <
div
 
id
="´im¬y" 
şass
="clear-block">

135 <?
php
 
´št
 
	`theme
('lšks', 
$´im¬y_lšks
, 
	`¬¿y
('class' => 'links…rimary-links')); ?>

136 </
div
>

137 <?
php
 
’dif
; ?>

139 <?
php
 ià(!
	$em±y
(
$£cÚd¬y_lšks
)): ?>

140 <
div
 
id
="£cÚd¬y" 
şass
="clear-block">

141 <?
php
 
´št
 
	`theme
('lšks', 
$£cÚd¬y_lšks
, 
	`¬¿y
('class' => 'links secondary-links')); ?>

142 </
div
>

143 <?
php
 
’dif
; ?>

144 </
div
> <!-- /
Çvig©iÚ
 -->

146 <?
php
 ià(!
	$em±y
(
$Ëá
)): ?>

147 <
div
 
id
="sideb¬-Ëá" 
şass
="column sidebar">

148 <?
php
 
´št
 
$Ëá
; ?>

149 </
div
> <!-- /
sideb¬
-
Ëá
 -->

150 <?
php
 
’dif
; ?>

152 <
div
 
id
="maš" 
şass
="column"><div id="main-squeeze">

153 <?
php
 ià(!
	$em±y
(
$b»adüumb
)): ?><
div
 
id
="b»adüumb"><?
php
 
´št
 $b»adüumb; ?></div><?ph°
’dif
; ?>

154 <?
php
 ià(!
	$em±y
(
$missiÚ
)): ?><
div
 
id
="missiÚ"><?
php
 
´št
 $missiÚ; ?></div><?ph°
’dif
; ?>

156 <
div
 
id
="content">

157 <?
php
 ià(!
	$em±y
(
$t™Ë
)): ?><
h1
 
şass
="t™Ë" 
id
="·ge-t™Ë"><?
php
 
´št
 $t™Ë; ?></h1><?ph°
’dif
; ?>

158 <?
php
 ià(!
	$em±y
(
$bs
)): ?><
div
 
şass
="bs"><?
php
 
´št
 $bs; ?></div><?ph°
’dif
; ?>

159 <?
php
 ià(!
	$em±y
(
$mes§ges
)): 
´št
 $mes§ges; 
’dif
; ?>

160 <?
php
 ià(!
	$em±y
(
$h–p
)): 
´št
 $h–p; 
’dif
; ?>

161 <
div
 
id
="cÚ‹Á-cÚ‹Á" 
şass
="clear-block">

162 <?
php
 
´št
 
$cÚ‹Á
; ?>

163 </
div
> <!-- /
cÚ‹Á
-content -->

164 <?
php
 
´št
 
$ãed_icÚs
; ?>

165 </
div
> <!-- /
cÚ‹Á
 -->

167 </
div
></div> <!-- /
maš
-
squ“ze
 /main -->

169 <?
php
 ià(!
	$em±y
(
$right
)): ?>

170 <
div
 
id
="sideb¬-right" 
şass
="column sidebar">

171 <?
php
 
´št
 
$right
; ?>

172 </
div
> <!-- /
sideb¬
-
right
 -->

173 <?
php
 
’dif
; ?>

175 </
div
> <!-- /
cÚš”
 -->

177 <
div
 
id
="footer-wrapper">

178 <
div
 
id
="footer">

179 <?
php
 
´št
 
$foÙ”_mes§ge
; ?>

180 <?
php
 ià(!
	$em±y
(
$foÙ”
)): 
´št
 $foÙ”; 
’dif
; ?>

181 </
div
> <!-- /
foÙ”
 -->

182 </
div
> <!-- /
foÙ”
-
w¿µ”
 -->

184 <?
php
 
´št
 
$şosu»
; ?>

186 </
div
> <!-- /
·ge
 -->

188 </
body
>

189 </
html
>

	@/srv/http/subs/notes/www/modules/system/system.admin.inc

1 <?
php


12 
funùiÚ
 
	$sy¡em_maš_admš_·ge
(
$¬g
 = 
NULL
) {

16 ià(
	`is£t
(
$¬g
è&& 
	`sub¡r
($arg, 0, 3) != 'by-') {

17  
	`dru·l_nÙ_found
();

21 ià(
	`sy¡em_¡©us
(
TRUE
è&& 
	`u£r_acûss
('administer site configuration')) {

22 
	`dru·l_£t_mes§ge
(
	`t
('OÃ o¸mÜ´obËm w”d‘eùed w™h you¸Dru·Èš¡®ÏtiÚ. Checkh<¨h»f="@¡©us">¡©u »pÜt</a> fÜ mÜšfÜm©iÚ.', 
	`¬¿y
('@¡©us' => 
	`u¾
('admin/reports/status'))), 'error');

24 
$blocks
 = 
	`¬¿y
();

25 ià(
$admš
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT menu_name, mlid FROM {menu_links} WHERE†ink_path = 'admin' AND module = 'system'"))) {

26 
$»suÉ
 = 
	`db_qu”y
("

27 
SELECT
 
m
.*, 
ml
.*

28 
FROM
 {
m’u_lšks
} 
ml


29 
INNER
 
JOIN
 {
m’u_rou‹r
} 
m
 
ON
 
ml
.
rou‹r_·th
 = m.
·th


30 
WHERE
 
ml
.
lšk_·th
 !ğ'admš/h–p' 
AND
 
m’u_Çme
 = '%s' AND ml.
¶id
 = %
d
 AND 
hidd’
 = 0", $admin);

31 
$™em
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

32 
	`_m’u_lšk_Œª¦©e
(
$™em
);

33 ià(!
$™em
['access']) {

38 ià(!
	`em±y
(
$™em
['localized_options']['attributes']['title'])) {

39 
$™em
['description'] = $item['localized_options']['attributes']['title'];

41 
$block
 = 
$™em
;

42 
$block
['content'] = '';

43 ià(
$™em
['block_ÿÎback'] && 
	`funùiÚ_exi¡s
($item['block_callback'])) {

44 
$funùiÚ
 = 
$™em
['block_callback'];

45 
$block
['cÚ‹Á'] .ğ
	`$funùiÚ
();

47 
$block
['cÚ‹Á'] .ğ
	`theme
('admš_block_cÚ‹Á', 
	`sy¡em_admš_m’u_block
(
$™em
));

50 
$blocks
[(50000 + 
$™em
['weight']è.' '. $™em['t™Ë'] .' '. $™em['mlid']] = 
$block
;

53 ià(
$blocks
) {

54 
	`ksÜt
(
$blocks
);

55  
	`theme
('admš_·ge', 
$blocks
);

58  
	`t
('You do‚ot have‡ny‡dministrative items.');

60 
	}
}

73 
funùiÚ
 
	$sy¡em_admš_m’u_block_·ge
() {

74 
$™em
 = 
	`m’u_g‘_™em
();

75 ià(
$cÚ‹Á
 = 
	`sy¡em_admš_m’u_block
(
$™em
)) {

76 
$ouut
 = 
	`theme
('admš_block_cÚ‹Á', 
$cÚ‹Á
);

79 
$ouut
 = 
	`t
('You do‚ot have‡ny‡dministrative items.');

81  
$ouut
;

82 
	}
}

90 
funùiÚ
 
sy¡em_admš_com·ù_·ge
(
$mode
 = 'off') {

91 
glob®
 
$u£r
;

92 
u£r_§ve
(
$u£r
, 
¬¿y
('admš_com·ù_mode' => (
$mode
 == 'on')));

93 
dru·l_gÙo
('admin');

99 
funùiÚ
 
	$sy¡em_admš_by_moduË
() {

101 
$moduËs
 = 
	`moduË_»bud_ÿche
();

102 
$m’u_™ems
 = 
	`¬¿y
();

103 
$h–p_¬g
 = 
	`moduË_exi¡s
('h–p'è? 
	`dru·l_h–p_¬g
(è: 
FALSE
;

105 
	`fÜ—ch
 (
$moduËs
 
as
 
$fe
) {

106 
$moduË
 = 
$fe
->
Çme
;

107 ià(
$moduË
 == 'help') {

111 
$admš_sks
 = 
	`sy¡em_g‘_moduË_admš_sks
(
$moduË
);

114 ià(
	`couÁ
(
$admš_sks
)) {

117 ià(
$h–p_¬g
 && 
	`moduË_švoke
(
$moduË
, 'help', "admin/help#$module", $help_arg)) {

118 
$admš_sks
[100] = 
	`l
(
	`t
('Get help'), "admin/help/$module");

122 
	`ksÜt
(
$admš_sks
);

124 
$m’u_™ems
[
$fe
->
šfo
['Çme']] = 
	`¬¿y
($fe->šfo['desütiÚ'], 
$admš_sks
);

127  
	`theme
('sy¡em_admš_by_moduË', 
$m’u_™ems
);

128 
	}
}

133 
funùiÚ
 
	$sy¡em_£‰šgs_ov”v›w
() {

135 ià(
	`funùiÚ_exi¡s
('db_check_£tup'è&& 
	`em±y
(
$_POST
)) {

136 
	`db_check_£tup
();

139 
$™em
 = 
	`m’u_g‘_™em
('admin/settings');

140 
$cÚ‹Á
 = 
	`sy¡em_admš_m’u_block
(
$™em
);

142 
$ouut
 = 
	`theme
('admš_block_cÚ‹Á', 
$cÚ‹Á
);

144  
$ouut
;

145 
	}
}

153 
funùiÚ
 
	$sy¡em_admš_theme_£‰šgs
() {

154 
$themes
 = 
	`sy¡em_theme_d©a
();

156 
	`uasÜt
(
$themes
, 'system_sort_modules_by_info_name');

158 
$İtiÚs
[0] = '<'. 
	`t
('System default') .'>';

159 
	`fÜ—ch
 (
$themes
 
as
 
$theme
) {

160 
$İtiÚs
[
$theme
->
Çme
] = $theme->
šfo
['name'];

163 
$fÜm
['admš_theme'] = 
	`¬¿y
(

165 '#İtiÚs' => 
$İtiÚs
,

166 '#t™Ë' => 
	`t
('Administrationheme'),

167 '#desütiÚ' => 
	`t
('Choose whichhemehe‡dministration…ages should display in. If you choose "System default"he‡dministration…ages will usehe sameheme‡she„est ofhe site.'),

168 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('admin_theme', '0'),

171 
$fÜm
['node_admš_theme'] = 
	`¬¿y
(

173 '#t™Ë' => 
	`t
('Use‡dministrationheme for contentƒditing'),

174 '#desütiÚ' => 
	`t
('Usehe‡dministrationheme whenƒditingƒxisting…osts or creating‚ew ones.'),

175 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('node_admin_theme', '0'),

178 
$fÜm
['#submit'][] = 'system_admin_theme_submit';

179  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

180 
	}
}

188 
funùiÚ
 
	$sy¡em_themes_fÜm
() {

190 
$themes
 = 
	`sy¡em_theme_d©a
();

192 
	`uasÜt
(
$themes
, 'system_sort_modules_by_info_name');

194 
$¡©us
 = 
	`¬¿y
();

195 
$šcom·tibË_cÜe
 = 
	`¬¿y
();

196 
$šcom·tibË_php
 = 
	`¬¿y
();

198 
	`fÜ—ch
 (
$themes
 
as
 
$theme
) {

199 
$sü“nshÙ
 = 
NULL
;

201 ià(
	`is£t
(
$themes
[
$theme
->
Çme
]->
ba£_themes
)) {

202 
$theme_keys
 = 
	`¬¿y_keys
(
$themes
[
$theme
->
Çme
]->
ba£_themes
);

203 
$theme_keys
[] = 
$theme
->
Çme
;

206 
$theme_keys
 = 
	`¬¿y
(
$theme
->
Çme
);

209 
	`fÜ—ch
 (
	`¬¿y_»v”£
(
$theme_keys
è
as
 
$theme_key
) {

210 ià(
	`is£t
(
$themes
[
$theme_key
]è&& 
	`fe_exi¡s
($themes[$theme_key]->
šfo
['screenshot'])) {

211 
$sü“nshÙ
 = 
$themes
[
$theme_key
]->
šfo
['screenshot'];

215 
$sü“nshÙ
 = $sü“nshÙ ? 
	`theme
('image', $sü“nshÙ, 
	`t
('Sü“nshÙ fÜ %themtheme', 
	`¬¿y
('%theme' => 
$theme
->
šfo
['Çme'])), '',‡¼ay('şass' => 'sü“nshÙ'), 
FALSE
) :('no screenshot');

217 
$fÜm
[
$theme
->
Çme
]['sü“nshÙ'] = 
	`¬¿y
('#v®ue' => 
$sü“nshÙ
);

218 
$fÜm
[
$theme
->
Çme
]['šfo'] = 
	`¬¿y
(

220 '#v®ue' => 
$theme
->
šfo
,

222 
$İtiÚs
[
$theme
->
Çme
] = '';

224 ià(!
	`em±y
(
$theme
->
¡©us
è|| $theme->
Çme
 =ğ
	`v¬ŸbË_g‘
('admin_theme', '0')) {

225 
$fÜm
[
$theme
->
Çme
]['İ”©iÚs'] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('configure'), 'admin/build/themes/settings/'. $theme->name) );

229 
$fÜm
[
$theme
->
Çme
]['İ”©iÚs'] = 
	`¬¿y
();

231 ià(!
	`em±y
(
$theme
->
¡©us
)) {

232 
$¡©us
[] = 
$theme
->
Çme
;

236 ià(!
	`is£t
(
$theme
->
šfo
['cÜe']è|| $theme->šfo['cÜe'] !ğ
DRUPAL_CORE_COMPATIBILITY
) {

237 
$šcom·tibË_cÜe
[] = 
$theme
->
Çme
;

239 ià(
	`v”siÚ_com·»
(
	`phpv”siÚ
(), 
$theme
->
šfo
['php']) < 0) {

240 
$šcom·tibË_php
[
$theme
->
Çme
] = $theme->
šfo
['php'];

245 
$fÜm
['¡©us'] = 
	`¬¿y
(

247 '#İtiÚs' => 
$İtiÚs
,

248 '#deçuÉ_v®ue' => 
$¡©us
,

249 '#šcom·tibË_themes_cÜe' => 
	`dru·l_m­_assoc
(
$šcom·tibË_cÜe
),

250 '#šcom·tibË_themes_php' => 
$šcom·tibË_php
,

252 
$fÜm
['theme_deçuÉ'] = 
	`¬¿y
(

254 '#İtiÚs' => 
$İtiÚs
,

255 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('theme_default', 'garland'),

257 
$fÜm
['bu‰Ús']['subm™'] = 
	`¬¿y
(

259 '#v®ue' => 
	`t
('Save configuration'),

261 
$fÜm
['bu‰Ús']['»£t'] = 
	`¬¿y
(

263 '#v®ue' => 
	`t
('Reseto defaults'),

265  
$fÜm
;

266 
	}
}

271 
funùiÚ
 
	$sy¡em_themes_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

272 
	`dru·l_ş—r_css_ÿche
();

275 
$Şd_theme_li¡
 = 
$Ãw_theme_li¡
 = 
	`¬¿y
();

276 
	`fÜ—ch
 (
	`li¡_themes
(è
as
 
$theme
) {

277 ià(
$theme
->
¡©us
) {

278 
$Şd_theme_li¡
[] = 
$theme
->
Çme
;

281 
	`db_qu”y
("UPDATE {system} SET status = 0 WHEREype = 'theme'");

283 ià(
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('Save configuration')) {

284 ià(
	`is_¬¿y
(
$fÜm_¡©e
['values']['status'])) {

285 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['¡©us'] 
as
 
$key
 => 
$choiû
) {

287 ià(
$choiû
 || 
$fÜm_¡©e
['v®ues']['theme_deçuÉ'] =ğ
$key
) {

288 
	`sy¡em_š™Ÿlize_theme_blocks
(
$key
);

289 
$Ãw_theme_li¡
[] = 
$key
;

290 
	`db_qu”y
("UPDATE {sy¡em} SET stu ğ1 WHEREy³ = 'theme'‡nd‚amğ'%s'", 
$key
);

294 ià((
$admš_theme
 = 
	`v¬ŸbË_g‘
('admš_theme', '0')è!ğ'0' && $admš_them!ğ
$fÜm_¡©e
['values']['theme_default']) {

295 
	`dru·l_£t_mes§ge
(
	`t
('PËa£‚Ùth©h<¨h»f="!admš_theme_·ge">admši¡¿tiÚheme</a> i ¡È£ˆtØth%admš_themtheme; cÚ£qu’y,hthemÚhi ·g»maš unchªged. AÎ‚Ú-admši¡¿tiv£ùiÚ oàths™e, howev”, wÈshowh£Ëùed %£Ëùed_themthemby deçuÉ.', 
	`¬¿y
(

296 '!admš_theme_·ge' => 
	`u¾
('admin/settings/admin'),

297 '%admš_theme' => 
$admš_theme
,

298 '%£Ëùed_theme' => 
$fÜm_¡©e
['values']['theme_default'],

301 
	`v¬ŸbË_£t
('theme_deçuÉ', 
$fÜm_¡©e
['values']['theme_default']);

305 
	`v¬ŸbË_d–
('theme_default');

306 
	`db_qu”y
("UPDATE {system} SET status = 1 WHEREype = 'theme' AND‚ame = 'garland'");

307 
$Ãw_theme_li¡
 = 
	`¬¿y
('garland');

310 
	`li¡_themes
(
TRUE
);

311 
	`m’u_»bud
();

312 
	`dru·l_»bud_theme_»gi¡ry
();

313 
	`dru·l_£t_mes§ge
(
	`t
('The configuration options have been saved.'));

314 
$fÜm_¡©e
['redirect'] = 'admin/build/themes';

319 
	`moduË_švoke
('loÿË', 'sy¡em_upd©e', 
	`¬¿y_diff
(
$Ãw_theme_li¡
, 
$Şd_theme_li¡
));

322 
	}
}

334 
funùiÚ
 
sy¡em_theme_£‰šgs
(&
$fÜm_¡©e
, 
$key
 = '') {

335 
$dœeùÜy_·th
 = 
fe_dœeùÜy_·th
();

336 
fe_check_dœeùÜy
(
$dœeùÜy_·th
, 
FILE_CREATE_DIRECTORY
, 'file_directory_path');

339 ià(
	g$key
) {

340 
	g$£‰šgs
 = 
theme_g‘_£‰šgs
(
$key
);

341 
	g$v¬
 = 
¡r_»¶aû
('/', '_', 'theme_'. 
$key
 .'_settings');

342 
	g$themes
 = 
sy¡em_theme_d©a
();

343 
	g$ã©u»s
 = 
$themes
[
$key
]->
šfo
['features'];

346 
	g$£‰šgs
 = 
theme_g‘_£‰šgs
('');

347 
	g$v¬
 = 'theme_settings';

350 
	g$fÜm
['v¬'] = 
¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$v¬
);

353 ià(
	g$fe
 = 
fe_§ve_u¶ßd
('logo_u¶ßd', 
¬¿y
('file_validate_is_image' =>‡rray()))) {

354 
$·¹s
 = 
·thšfo
(
$fe
->
f’ame
);

355 
	g$f’ame
 = (
$key
è? 
¡r_»¶aû
('/', '_', $keyè.'_logo.'. 
	g$·¹s
['ex‹nsiÚ'] : 'logo.'. 
$·¹s
['extension'];

360 ià(
fe_cİy
(
$fe
, 
$f’ame
, 
FILE_EXISTS_REPLACE
)) {

361 
	g$_POST
['default_logo'] = 0;

362 
	g$_POST
['logo_·th'] = 
$fe
->
f•©h
;

363 
	g$_POST
['toggle_logo'] = 1;

368 ià(
	g$fe
 = 
fe_§ve_u¶ßd
('favicon_upload')) {

369 
$·¹s
 = 
·thšfo
(
$fe
->
f’ame
);

370 
	g$f’ame
 = (
$key
è? 
¡r_»¶aû
('/', '_', $keyè.'_çvicÚ.'. 
	g$·¹s
['ex‹nsiÚ'] : 'çvicÚ.'. 
$·¹s
['extension'];

375 ià(
fe_cİy
(
$fe
, 
$f’ame
)) {

376 
	g$_POST
['default_favicon'] = 0;

377 
	g$_POST
['çvicÚ_·th'] = 
$fe
->
f•©h
;

378 
	g$_POST
['toggle_favicon'] = 1;

383 
	g$toggËs
 = 
¬¿y
(

384 'logo' => 
t
('Logo'),

385 'Çme' => 
t
('Site‚ame'),

386 '¦ogª' => 
t
('Site slogan'),

387 'missiÚ' => 
t
('Mission statement'),

388 'node_u£r_piùu»' => 
t
('User…ictures in…osts'),

389 'comm’t_u£r_piùu»' => 
t
('User…ictures in comments'),

390 '£¬ch' => 
t
('Search box'),

391 'çvicÚ' => 
t
('Shortcut icon'),

392 '´im¬y_lšks' => 
t
('Primary†inks'),

393 '£cÚd¬y_lšks' => 
t
('Secondary†inks'),

397 
	g$di§bËd
 = 
¬¿y
();

398 ià(!
v¬ŸbË_g‘
('user_pictures', 0)) {

399 
	g$di§bËd
['toggË_node_u£r_piùu»'] = 
TRUE
;

400 
	g$di§bËd
['toggË_comm’t_u£r_piùu»'] = 
TRUE
;

402 ià(!
moduË_exi¡s
('search')) {

403 
	g$di§bËd
['toggË_£¬ch'] = 
TRUE
;

406 
	g$fÜm
['theme_£‰šgs'] = 
¬¿y
(

408 '#t™Ë' => 
t
('Toggle display'),

409 '#desütiÚ' => 
t
('Enable or disablehe display of certain…ageƒlements.'),

411 
fÜ—ch
 (
$toggËs
 
as
 
$Çme
 => 
$t™Ë
) {

412 ià((!
$key
è|| 
š_¬¿y
(
$Çme
, 
$ã©u»s
)) {

413 
$fÜm
['theme_£‰šgs']['toggË_'. 
$Çme
] = 
¬¿y
('#ty³' => 'checkbox', '#t™Ë' => 
$t™Ë
, '#deçuÉ_v®ue' => 
$£‰šgs
['toggle_'. $name]);

415 ià(
is£t
(
$di§bËd
['toggË_'. 
$Çme
])) {

416 
	g$fÜm
['theme_£‰šgs']['toggË_'. 
$Çme
]['#di§bËd'] = 
TRUE
;

422 ià(!
	g$key
) {

424 
	g$fÜm
['theme_£‰šgs'] +ğ
¬¿y
(

430 
	g$node_ty³s
 = 
node_g‘_ty³s
('names');

431 ià(
	g$node_ty³s
) {

432 
	g$fÜm
['node_šfo'] = 
¬¿y
(

434 '#t™Ë' => 
t
('Display…ost information on'),

435 '#desütiÚ' => 
t
('Enable or disablehe <em>submitted by Username on date</em>ext when displaying…osts ofhe followingype.'),

439 
fÜ—ch
 (
$node_ty³s
 
as
 
$ty³
 => 
$Çme
) {

440 
$fÜm
['node_šfo']["toggË_node_šfo_$ty³"] = 
¬¿y
('#ty³' => 'checkbox', '#t™Ë' => 
check_¶aš
(
$Çme
), '#deçuÉ_v®ue' => 
$£‰šgs
["toggle_node_info_$type"]);

444 
–£if
 (!
–em’t_chd»n
(
$fÜm
['theme_settings'])) {

447 
	g$fÜm
['theme_£‰šgs']['#acûss'] = 
FALSE
;

451 ià((!
	g$key
è|| 
š_¬¿y
('logo', 
$ã©u»s
)) {

452 
	g$fÜm
['logo'] = 
¬¿y
(

454 '#t™Ë' => 
t
('Logo image settings'),

455 '#desütiÚ' => 
t
('Ifoggled on,he following†ogo will be displayed.'),

456 '#©Œibu‹s' => 
¬¿y
('class' => 'theme-settings-bottom'),

458 
	g$fÜm
['logo']["deçuÉ_logo"] = 
¬¿y
(

460 '#t™Ë' => 
t
('Usehe default†ogo'),

461 '#deçuÉ_v®ue' => 
$£‰šgs
['default_logo'],

462 '#Œ“' => 
FALSE
,

463 '#desütiÚ' => 
t
('Check here if you wanthehemeo usehe†ogo supplied with it.')

465 
	g$fÜm
['logo']['logo_·th'] = 
¬¿y
(

467 '#t™Ë' => 
t
('Patho custom†ogo'),

468 '#deçuÉ_v®ue' => 
$£‰šgs
['logo_path'],

469 '#desütiÚ' => 
t
('The…athohe file you would†ikeo use‡s your†ogo file instead ofhe default†ogo.'));

471 
	g$fÜm
['logo']['logo_u¶ßd'] = 
¬¿y
(

473 '#t™Ë' => 
t
('Upload†ogo image'),

475 '#desütiÚ' => 
t
("If you don't have direct file‡ccessohe server, usehis fieldo upload your†ogo.")

479 ià((!
	g$key
è|| 
š_¬¿y
('çvicÚ', 
$ã©u»s
)) {

480 
	g$fÜm
['çvicÚ'] = 
¬¿y
(

482 '#t™Ë' => 
t
('Shortcut icon settings'),

483 '#desütiÚ' => 
t
("Your shortcut icon, or 'favicon', is displayed inhe‡ddress bar‡nd bookmarks of most browsers.")

485 
	g$fÜm
['çvicÚ']['deçuÉ_çvicÚ'] = 
¬¿y
(

487 '#t™Ë' => 
t
('Usehe default shortcut icon.'),

488 '#deçuÉ_v®ue' => 
$£‰šgs
['default_favicon'],

489 '#desütiÚ' => 
t
('Check here if you wanthehemeo usehe default shortcut icon.')

491 
	g$fÜm
['çvicÚ']['çvicÚ_·th'] = 
¬¿y
(

493 '#t™Ë' => 
t
('Patho custom icon'),

494 '#deçuÉ_v®ue' => 
$£‰šgs
['favicon_path'],

495 '#desütiÚ' => 
t
('The…athohe image file you would†ikeo use‡s your custom shortcut icon.')

498 
	g$fÜm
['çvicÚ']['çvicÚ_u¶ßd'] = 
¬¿y
(

500 '#t™Ë' => 
t
('Upload icon image'),

501 '#desütiÚ' => 
t
("If you don't have direct file‡ccessohe server, usehis fieldo upload your shortcut icon.")

505 ià(
	g$key
) {

507 
	g$f’ame
 = './'. 
¡r_»¶aû
("/$key.šfo", '', 
$themes
[
$key
]->
f’ame
) .'/theme-settings.php';

508 ià(!
fe_exi¡s
(
$f’ame
è
	gªd
 !
em±y
(
$themes
[
$key
]->
šfo
['baseheme'])) {

510 
	g$ba£
 = 
$themes
[
$key
]->
šfo
['baseheme'];

511 
	g$f’ame
 = './'. 
¡r_»¶aû
("/$ba£.šfo", '', 
$themes
[
$ba£
]->
f’ame
) .'/theme-settings.php';

513 ià(
fe_exi¡s
(
$f’ame
)) {

514 
»quœe_Úû
 
	g$f’ame
;

518 
	g$funùiÚ
 = 
$themes
[
$key
]->
´efix
 .'_engine_settings';

519 ià(
funùiÚ_exi¡s
(
$funùiÚ
)) {

520 
	g$group
 = 
$funùiÚ
(
$£‰šgs
);

521 ià(!
em±y
(
$group
)) {

522 
	g$fÜm
['’gše_¥ecific'] = 
¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
t
('Theme-’gše-¥ecifiø£‰šgs'), '#desütiÚ' =>('The£ s‘tšg Úlyƒxi¡ fÜ‡Îh‹m¶©e ªd styË ba£d oÀth%’gšthem’gše.',‡¼ay('%’gše' => 
$themes
[
$key
]->
´efix
)));

523 
	g$fÜm
['’gše_¥ecific'] = 
¬¿y_m”ge
(
$fÜm
['’gše_¥ecific'], 
$group
);

527 
	g$funùiÚ
 = 
$key
 .'_settings';

528 ià(!
funùiÚ_exi¡s
(
$funùiÚ
)) {

529 
	g$funùiÚ
 = 
$themes
[
$key
]->
´efix
 .'_settings';

531 ià(
funùiÚ_exi¡s
(
$funùiÚ
)) {

532 
	g$group
 = 
$funùiÚ
(
$£‰šgs
);

533 ià(!
em±y
(
$group
)) {

534 
	g$fÜm
['theme_¥ecific'] = 
¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
t
('Theme-¥ecifiø£‰šgs'), '#desütiÚ' =>('The£ s‘tšg Úlyƒxi¡ fÜh%themthemªd‡Îh¡yË ba£d oÀ™.',‡¼ay('%theme' => 
$themes
[
$key
]->
šfo
['name'])));

535 
	g$fÜm
['theme_¥ecific'] = 
¬¿y_m”ge
(
$fÜm
['theme_¥ecific'], 
$group
);

539 
	g$fÜm
['#©Œibu‹s'] = 
¬¿y
('enctype' => 'multipart/form-data');

541 
	g$fÜm
 = 
sy¡em_£‰šgs_fÜm
(
$fÜm
);

543 
	g$fÜm
['#subm™'] = 
¬¿y
('system_theme_settings_submit');

544  
	g$fÜm
;

550 
funùiÚ
 
	$sy¡em_theme_£‰šgs_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

551 
$v®ues
 = 
$fÜm_¡©e
['values'];

552 
$key
 = 
$v®ues
['var'];

554 ià(
$v®ues
['İ'] =ğ
	`t
('Reseto defaults')) {

555 
	`v¬ŸbË_d–
(
$key
);

556 
	`dru·l_£t_mes§ge
(
	`t
('The configuration options have been„esetoheir default values.'));

560 
	`un£t
(
$v®ues
['var'], $values['submit'], $values['reset'], $values['form_id'], $values['op'], $values['form_build_id'], $values['form_token']);

561 
	`v¬ŸbË_£t
(
$key
, 
$v®ues
);

562 
	`dru·l_£t_mes§ge
(
	`t
('The configuration options have been saved.'));

565 
	`ÿche_ş—r_®l
();

566 
	}
}

580 
funùiÚ
 
	$_sy¡em_is_šcom·tibË
(&
$šcom·tibË
, 
$fes
, 
$fe
) {

581 
$£’
;

583 ià(
	`is£t
(
$£’
[
$fe
->
Çme
])) {

584  
	`is£t
(
$šcom·tibË
[
$fe
->
Çme
]);

586 
$£’
[
$fe
->
Çme
] = 
TRUE
;

587 ià(
	`is£t
(
$šcom·tibË
[
$fe
->
Çme
])) {

588  
TRUE
;

593 ià(!
	`is_¬¿y
(
$fe
->
šfo
['dependencies'])) {

594 
$fe
->
šfo
['d•’d’c›s'] = 
	`¬¿y
();

595 
$šcom·tibË
[
$fe
->
Çme
] = 
TRUE
;

596  
TRUE
;

599 
	`fÜ—ch
 (
$fe
->
šfo
['d•’d’c›s'] 
as
 
$d•’d’cy
) {

600 ià(
	`is£t
(
$fes
[
$d•’d’cy
]è&& 
	`_sy¡em_is_šcom·tibË
(
$šcom·tibË
, $files, $files[$dependency])) {

601 
$šcom·tibË
[
$fe
->
Çme
] = 
TRUE
;

602  
TRUE
;

605 
	}
}

627 
funùiÚ
 
sy¡em_moduËs
(
$fÜm_¡©e
 = 
	$¬¿y
()) {

629 
$fes
 = 
	`moduË_»bud_ÿche
();

631 
	`uasÜt
(
$fes
, 'system_sort_modules_by_info_name');

633 ià(!
	`em±y
(
$fÜm_¡©e
['storage'])) {

634  
	`sy¡em_moduËs_cÚfœm_fÜm
(
$fes
, 
$fÜm_¡©e
['storage']);

636 
$d•’d’c›s
 = 
	`¬¿y
();

639 
$fÜm
['v®id©iÚ_moduËs'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$fes
);

642 
$fÜm
['di§bËd_moduËs'] = 
	`¬¿y
('#type' => 'value', '#value' =>‡rray());

645 
$šcom·tibË_cÜe
 = 
	`¬¿y
();

646 
$šcom·tibË_php
 = 
	`¬¿y
();

647 
	`fÜ—ch
 (
$fes
 
as
 
$f’ame
 => 
$fe
) {

649 ià(!
	`is£t
(
$fe
->
šfo
['cÜe']è|| $fe->šfo['cÜe'] !ğ
DRUPAL_CORE_COMPATIBILITY
) {

650 
$šcom·tibË_cÜe
[
$fe
->
Çme
] = $file->name;

653 ià(
	`v”siÚ_com·»
(
	`phpv”siÚ
(), 
$fe
->
šfo
['php']) < 0) {

654 
$šcom·tibË_php
[
$fe
->
Çme
] = $fe->
šfo
['php'];

659 
$di§bËd
 = 
	`¬¿y
();

660 
$thrÙe
 = 
	`¬¿y
();

662 
	`fÜ—ch
 (
$fes
 
as
 
$f’ame
 => 
$fe
) {

663 
$fÜm
['Çme'][
$f’ame
] = 
	`¬¿y
('#v®ue' => 
$fe
->
šfo
['name']);

664 
$fÜm
['v”siÚ'][
$f’ame
] = 
	`¬¿y
('#v®ue' => 
$fe
->
šfo
['version']);

665 
$fÜm
['desütiÚ'][
$f’ame
] = 
	`¬¿y
('#v®ue' => 
	`t
(
$fe
->
šfo
['description']));

666 
$İtiÚs
[
$f’ame
] = '';

668 ià(
	`_sy¡em_is_šcom·tibË
(
$šcom·tibË_cÜe
, 
$fes
, 
$fe
è|| _sy¡em_is_šcom·tibË(
$šcom·tibË_php
, $files, $file)) {

669 
$di§bËd
[] = 
$fe
->
Çme
;

673 ià(
$fe
->
¡©us
) {

674 
$¡©us
[] = 
$fe
->
Çme
;

676 ià(
$fe
->
thrÙe
) {

677 
$thrÙe
[] = 
$fe
->
Çme
;

680 
$d•’d’c›s
 = 
	`¬¿y
();

682 ià(
	`is_¬¿y
(
$fe
->
šfo
['dependencies'])) {

683 
	`fÜ—ch
 (
$fe
->
šfo
['d•’d’c›s'] 
as
 
$d•’d’cy
) {

684 ià(!
	`is£t
(
$fes
[
$d•’d’cy
]è|| !$fes[$d•’d’cy]->
¡©us
) {

685 ià(
	`is£t
(
$fes
[
$d•’d’cy
])) {

686 
$d•’d’c›s
[] = 
	`t
('@moduË (<¥ª cÏss="admš-di§bËd">di§bËd</¥ª>)', 
	`¬¿y
('@moduË' => 
$fes
[
$d•’d’cy
]->
šfo
['name']));

689 
$d•’d’c›s
[] = 
	`t
('@moduË (<¥ª cÏss="admš-missšg">missšg</¥ª>)', 
	`¬¿y
('@moduË' => 
	`dru·l_ucfœ¡
(
$d•’d’cy
)));

690 
$di§bËd
[] = 
$f’ame
;

691 
$fÜm
['di§bËd_moduËs']['#v®ue'][
$f’ame
] = 
FALSE
;

695 
$d•’d’c›s
[] = 
	`t
('@moduË (<¥ª cÏss="admš-’abËd">’abËd</¥ª>)', 
	`¬¿y
('@moduË' => 
$fes
[
$d•’d’cy
]->
šfo
['name']));

700 ià(!
	`em±y
(
$d•’d’c›s
)) {

701 
$fÜm
['desütiÚ'][
$f’ame
]['d•’d’c›s'] = 
	`¬¿y
(

702 '#v®ue' => 
	`t
('D•’d Ú: !d•’d’c›s', 
	`¬¿y
('!d•’d’c›s' => 
	`im¶ode
(', ', 
$d•’d’c›s
))),

710 
$d•’d’ts
 = 
	`¬¿y
();

711 
	`fÜ—ch
 (
$fe
->
šfo
['d•’d’ts'] 
as
 
$d•’d’t
) {

712 ià(
$fes
[
$d•’d’t
]->
¡©us
 == 1) {

713 
$d•’d’ts
[] = 
	`t
('@moduË (<¥ª cÏss="admš-’abËd">’abËd</¥ª>)', 
	`¬¿y
('@moduË' => 
$fes
[
$d•’d’t
]->
šfo
['name']));

714 
$di§bËd
[] = 
$f’ame
;

715 
$fÜm
['di§bËd_moduËs']['#v®ue'][
$f’ame
] = 
TRUE
;

718 
$d•’d’ts
[] = 
	`t
('@moduË (<¥ª cÏss="admš-di§bËd">di§bËd</¥ª>)', 
	`¬¿y
('@moduË' => 
$fes
[
$d•’d’t
]->
šfo
['name']));

723 ià(!
	`em±y
(
$d•’d’ts
)) {

724 
$fÜm
['desütiÚ'][
$f’ame
]['»quœed'] = 
	`¬¿y
(

725 '#v®ue' => 
	`t
('Requœed by: !»quœed', 
	`¬¿y
('!»quœed' => 
	`im¶ode
(', ', 
$d•’d’ts
))),

732 
$moduËs_»quœed
 = 
	`dru·l_»quœed_moduËs
();

734 
	`fÜ—ch
 (
$moduËs_»quœed
 
as
 
$»quœed
) {

735 
$di§bËd
[] = 
$»quœed
;

736 
$fÜm
['di§bËd_moduËs']['#v®ue'][
$»quœed
] = 
TRUE
;

741 
$fÜm
['¡©us'] = 
	`¬¿y
(

743 '#deçuÉ_v®ue' => 
$¡©us
,

744 '#İtiÚs' => 
$İtiÚs
,

745 '#´oûss' => 
	`¬¿y
(

749 '#di§bËd_moduËs' => 
$di§bËd
,

750 '#šcom·tibË_moduËs_cÜe' => 
$šcom·tibË_cÜe
,

751 '#šcom·tibË_moduËs_php' => 
$šcom·tibË_php
,

756 ià(
	`moduË_exi¡s
('throttle')) {

757 
$fÜm
['thrÙe'] = 
	`¬¿y
(

759 '#deçuÉ_v®ue' => 
$thrÙe
,

760 '#İtiÚs' => 
$İtiÚs
,

761 '#´oûss' => 
	`¬¿y
(

765 '#di§bËd_moduËs' => 
	`¬¿y_m”ge
(
$moduËs_»quœed
, 
	`¬¿y
('throttle')),

769 
$fÜm
['bu‰Ús']['subm™'] = 
	`¬¿y
(

771 '#v®ue' => 
	`t
('Save configuration'),

773 
$fÜm
['#aùiÚ'] = 
	`u¾
('admin/build/modules/list/confirm');

775  
$fÜm
;

776 
	}
}

781 
funùiÚ
 
	$sy¡em_sÜt_moduËs_by_šfo_Çme
(
$a
, 
$b
) {

782  
	`¡rÿ£cmp
(
$a
->
šfo
['Çme'], 
$b
->info['name']);

783 
	}
}

796 
funùiÚ
 
	$sy¡em_moduËs_di§bË
(
$fÜm
, 
$ed™
) {

797 
	`fÜ—ch
 (
$fÜm
['#di§bËd_moduËs'] 
as
 
$key
) {

798 
$fÜm
[
$key
]['#attributes']['disabled'] = 'disabled';

800  
$fÜm
;

801 
	}
}

814 
funùiÚ
 
	$sy¡em_moduËs_cÚfœm_fÜm
(
$moduËs
, 
$¡Üage
) {

815 
$fÜm
 = 
	`¬¿y
();

816 
$™ems
 = 
	`¬¿y
();

818 
	`li¡
(
$d•’d’c›s
, 
$¡©us
èğ
$¡Üage
;

819 
$fÜm
['v®id©iÚ_moduËs'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$moduËs
);

820 
$fÜm
['¡©us']['#Œ“'] = 
TRUE
;

822 
	`fÜ—ch
 (
$¡©us
 
as
 
$key
 => 
$choiû
) {

823 
$fÜm
['¡©us'][
$key
] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$choiû
);

825 
	`fÜ—ch
 (
$d•’d’c›s
 
as
 
$Çme
 => 
$missšg_d•’d’c›s
) {

826 
$fÜm
['¡©us'][
$Çme
] = 
	`¬¿y
('#type' => 'hidden', '#value' => 1);

827 
	`fÜ—ch
 (
$missšg_d•’d’c›s
 
as
 
$k
 => 
$d•’d’cy
) {

828 
$fÜm
['¡©us'][
$d•’d’cy
] = 
	`¬¿y
('#type' => 'hidden', '#value' => 1);

829 
$šfo
 = 
$moduËs
[
$d•’d’cy
]->
šfo
;

830 
$missšg_d•’d’c›s
[
$k
] = 
$šfo
['Çme'] ? $šfo['Çme'] : 
	`dru·l_ucfœ¡
(
$d•’d’cy
);

832 
$t_¬gum’t
 = 
	`¬¿y
(

833 '@moduË' => 
$moduËs
[
$Çme
]->
šfo
['name'],

834 '@d•’d’c›s' => 
	`im¶ode
(', ', 
$missšg_d•’d’c›s
),

836 
$™ems
[] = 
	`fÜm©_¶u¿l
(
	`couÁ
(
$missšg_d•’d’c›s
), 'You mu¡ƒÇbËh@d•’d’c› moduËØš¡®È@moduË.', 'You mu¡ƒÇbËh@d•’d’c› moduË tØš¡®È@moduË.', 
$t_¬gum’t
);

838 
$fÜm
['‹xt'] = 
	`¬¿y
('#v®ue' => 
	`theme
('™em_li¡', 
$™ems
));

840 ià(
$fÜm
) {

842 
$fÜm
 = 
	`cÚfœm_fÜm
(

843 
$fÜm
,

844 
	`t
('Some„equired modules must beƒnabled'),

846 
	`t
('Would you†ikeo continue withƒnablinghe‡bove?'),

847 
	`t
('Continue'),

848 
	`t
('Cancel'));

849  
$fÜm
;

851 
	}
}

856 
funùiÚ
 
	$sy¡em_moduËs_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

857 
šşude_Úû
 './includes/install.inc';

858 
$Ãw_moduËs
 = 
	`¬¿y
();

861 ià(!
	`is£t
(
$fÜm_¡©e
['storage'])) {

865 
$fÜm_¡©e
['v®ues']['¡©us'] = 
	`¬¿y_m”ge
($form_state['values']['status'], $form_state['values']['disabled_modules']);

868 ià(
$d•’d’c›s
 = 
	`sy¡em_moduË_bud_d•’d’c›s
(
$fÜm_¡©e
['values']['validation_modules'], $form_state['values'])) {

870 
	`fÜ—ch
 (
	`¬¿y_keys
(
$d•’d’c›s
è
as
 
$Çme
) {

871 
$fÜm_¡©e
['v®ues']['¡©us'][
$Çme
] = 0;

876 
$d•’d’c›s
 = 
NULL
;

880 ià(
	`is£t
(
$fÜm_¡©e
['values']['throttle'])) {

881 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['thrÙe'] 
as
 
$key
 => 
$choiû
) {

882 
	`db_qu”y
("UPDATE {sy¡em} SEThrÙğ%d WHEREy³ = 'moduË'‡nd‚amğ'%s'", 
$choiû
 ? 1 : 0, 
$key
);

888 ià(
$d•’d’c›s
) {

889 ià(!
	`is£t
(
$fÜm_¡©e
['values']['confirm'])) {

890 
$fÜm_¡©e
['¡Üage'] = 
	`¬¿y
(
$d•’d’c›s
, $form_state['values']['status']);

894 
$fÜm_¡©e
['v®ues']['¡©us'] = 
	`¬¿y_m”ge
($fÜm_¡©e['v®ues']['¡©us'], 
$fÜm_¡Üage
[1]);

899 
	`un£t
(
$fÜm_¡©e
['storage']);

901 
$’abË_moduËs
 = 
	`¬¿y
();

902 
$di§bË_moduËs
 = 
	`¬¿y
();

903 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['¡©us'] 
as
 
$key
 => 
$choiû
) {

904 ià(
$choiû
) {

905 ià(
	`dru·l_g‘_š¡®Ëd_schema_v”siÚ
(
$key
è=ğ
SCHEMA_UNINSTALLED
) {

906 
$Ãw_moduËs
[] = 
$key
;

909 
$’abË_moduËs
[] = 
$key
;

913 
$di§bË_moduËs
[] = 
$key
;

917 
$Şd_moduË_li¡
 = 
	`moduË_li¡
();

919 ià(!
	`em±y
(
$’abË_moduËs
)) {

920 
	`moduË_’abË
(
$’abË_moduËs
);

922 ià(!
	`em±y
(
$di§bË_moduËs
)) {

923 
	`moduË_di§bË
(
$di§bË_moduËs
);

927 
	`fÜ—ch
 (
$Ãw_moduËs
 
as
 
$key
 => 
$moduË
) {

928 ià(!
	`dru·l_check_moduË
(
$moduË
)) {

929 
	`un£t
(
$Ãw_moduËs
[
$key
]);

932 
	`dru·l_š¡®l_moduËs
(
$Ãw_moduËs
);

934 
$cu¼’t_moduË_li¡
 = 
	`moduË_li¡
(
TRUE
, 
FALSE
);

935 ià(
$Şd_moduË_li¡
 !ğ
$cu¼’t_moduË_li¡
) {

936 
	`dru·l_£t_mes§ge
(
	`t
('The configuration options have been saved.'));

939 
	`dru·l_»bud_theme_»gi¡ry
();

940 
	`node_ty³s_»bud
();

941 
	`m’u_»bud
();

942 
	`ÿche_ş—r_®l
('schema', 'cache');

943 
	`dru·l_ş—r_css_ÿche
();

944 
	`dru·l_ş—r_js_ÿche
();

946 
$fÜm_¡©e
['redirect'] = 'admin/build/modules';

951 
	`moduË_švoke
('loÿË', 'sy¡em_upd©e', 
$Ãw_moduËs
);

954 
	`aùiÚs_synchrÚize
();

957 
	}
}

970 
funùiÚ
 
	$sy¡em_moduË_bud_d•’d’c›s
(
$moduËs
, 
$fÜm_v®ues
) {

971 
$d•’d’c›s
;

973 ià(!
	`is£t
(
$d•’d’c›s
è&& is£t(
$fÜm_v®ues
)) {

974 
$d•’d’c›s
 = 
	`¬¿y
();

975 
	`fÜ—ch
 (
$moduËs
 
as
 
$Çme
 => 
$moduË
) {

977 ià(!
$moduË
->
¡©us
 && 
$fÜm_v®ues
['¡©us'][
$Çme
] && 
	`is£t
($moduË->
šfo
['dependencies'])) {

978 
	`fÜ—ch
 (
$moduË
->
šfo
['d•’d’c›s'] 
as
 
$d•’d’cy
) {

979 ià(!
$fÜm_v®ues
['¡©us'][
$d•’d’cy
] && 
	`is£t
(
$moduËs
[$dependency])) {

980 ià(!
	`is£t
(
$d•’d’c›s
[
$Çme
])) {

981 
$d•’d’c›s
[
$Çme
] = 
	`¬¿y
();

983 
$d•’d’c›s
[
$Çme
][] = 
$d•’d’cy
;

989  
$d•’d’c›s
;

990 
	}
}

1007 
funùiÚ
 
	$sy¡em_moduËs_unš¡®l
(
$fÜm_¡©e
 = 
NULL
) {

1009 
šşude_Úû
 './includes/install.inc';

1012 ià(
	`is£t
(
$fÜm_¡©e
è&& 
$cÚfœm_fÜm
 = 
	`sy¡em_moduËs_unš¡®l_cÚfœm_fÜm
($form_state['storage'])) {

1013  
$cÚfœm_fÜm
;

1016 
$fÜm
 = 
	`¬¿y
();

1019 
$di§bËd_moduËs
 = 
	`db_qu”y
("SELECT‚ame, f’ame, infØFROM {sy¡em} WHEREy³ = 'moduË' AND stu ğ0 AND schema_v”siÚ > %d ORDER BY‚ame", 
SCHEMA_UNINSTALLED
);

1020 
$moduË
 = 
	`db_ãtch_objeù
(
$di§bËd_moduËs
)) {

1023 
$šfo
 = 
	`un£rŸlize
(
$moduË
->
šfo
);

1027 
	`moduË_lßd_š¡®l
(
$moduË
->
Çme
);

1028 ià(
	`moduË_hook
(
$moduË
->
Çme
, 'uninstall')) {

1029 
$fÜm
['moduËs'][
$moduË
->
Çme
]['Çme'] = 
	`¬¿y
('#v®ue' => 
$šfo
['name'] ? $info['name'] : $module->name);

1030 
$fÜm
['moduËs'][
$moduË
->
Çme
]['desütiÚ'] = 
	`¬¿y
('#v®ue' => 
	`t
(
$šfo
['description']));

1031 
$İtiÚs
[
$moduË
->
Çme
] = '';

1036 ià(!
	`em±y
(
$İtiÚs
)) {

1037 
$fÜm
['unš¡®l'] = 
	`¬¿y
(

1039 '#İtiÚs' => 
$İtiÚs
,

1041 
$fÜm
['bu‰Ús']['subm™'] = 
	`¬¿y
(

1043 '#v®ue' => 
	`t
('Uninstall'),

1045 
$fÜm
['#aùiÚ'] = 
	`u¾
('admin/build/modules/uninstall/confirm');

1048 
$fÜm
['moduËs'] = 
	`¬¿y
();

1051  
$fÜm
;

1052 
	}
}

1063 
funùiÚ
 
	$sy¡em_moduËs_unš¡®l_cÚfœm_fÜm
(
$¡Üage
) {

1065 ià(!
	`is£t
(
$¡Üage
)) {

1070 
	`fÜ—ch
 (
	`¬¿y_f‹r
(
$¡Üage
['unš¡®l']è
as
 
$moduË
 => 
$v®ue
) {

1071 
$šfo
 = 
	`dru·l_·r£_šfo_fe
(
	`dœÇme
(
	`dru·l_g‘_f’ame
('moduË', 
$moduË
)) .'/'. $module .'.info');

1072 
$unš¡®l
[] = 
$šfo
['name'];

1073 
$fÜm
['unš¡®l'][
$moduË
] = 
	`¬¿y
('#type' => 'hidden',

1079 ià(
	`is£t
(
$unš¡®l
)) {

1080 
$fÜm
['#cÚfœmed'] = 
TRUE
;

1081 
$fÜm
['unš¡®l']['#Œ“'] = 
TRUE
;

1082 
$fÜm
['moduËs'] = 
	`¬¿y
('#v®ue' => '<p>'. 
	`t
('ThfŞlowšg moduË wÈbcom¶‘–y unš¡®Ëd from you¸s™e,‡nd <em>®Èd©¨äomhe£ moduË wÈblo¡</em>!'è.'</p>'. 
	`theme
('™em_li¡', 
$unš¡®l
));

1083 
$fÜm
 = 
	`cÚfœm_fÜm
(

1084 
$fÜm
,

1085 
	`t
('Confirm uninstall'),

1087 
	`t
('Would you†ikeo continue with uninstallinghe‡bove?'),

1088 
	`t
('Uninstall'),

1089 
	`t
('Cancel'));

1090  
$fÜm
;

1092 
	}
}

1097 
funùiÚ
 
	$sy¡em_moduËs_unš¡®l_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

1099 ià(!
	`couÁ
(
	`¬¿y_f‹r
(
$fÜm_¡©e
['values']['uninstall']))) {

1100 
	`dru·l_£t_mes§ge
(
	`t
('No modules selected.'), 'error');

1101 
	`dru·l_gÙo
('admin/build/modules/uninstall');

1103 
	}
}

1108 
funùiÚ
 
	$sy¡em_moduËs_unš¡®l_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1110 
šşude_Úû
 './includes/install.inc';

1112 ià(!
	`em±y
(
$fÜm
['#confirmed'])) {

1114 
	`fÜ—ch
 (
	`¬¿y_f‹r
(
$fÜm_¡©e
['v®ues']['unš¡®l']è
as
 
$moduË
 => 
$v®ue
) {

1115 
	`dru·l_unš¡®l_moduË
(
$moduË
);

1117 
	`dru·l_£t_mes§ge
(
	`t
('The selected modules have been uninstalled.'));

1119 
	`un£t
(
$fÜm_¡©e
['storage']);

1120 
$fÜm_¡©e
['redirect'] = 'admin/build/modules/uninstall';

1123 
$fÜm_¡©e
['storage'] = $form_state['values'];

1125 
	}
}

1133 
funùiÚ
 
	$sy¡em_s™e_šfÜm©iÚ_£‰šgs
() {

1134 
$fÜm
['s™e_Çme'] = 
	`¬¿y
(

1136 '#t™Ë' => 
	`t
('Name'),

1137 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('site_name', 'Drupal'),

1138 '#desütiÚ' => 
	`t
('The‚ame ofhis website.'),

1139 '#»quœed' => 
TRUE


1141 
$fÜm
['s™e_ma'] = 
	`¬¿y
(

1143 '#t™Ë' => 
	`t
('E-mail‡ddress'),

1144 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('s™e_ma', 
	`ši_g‘
('sendmail_from')),

1145 '#desütiÚ' => 
	`t
("The <em>From</em>‡ddress in‡utomatedƒ-mails sent during„egistration‡nd‚ew…assword„equests,‡nd other‚otifications. (Use‡n‡ddressƒnding in your site's domaino help…reventhisƒ-mail being flagged‡s spam.)"),

1146 '#»quœed' => 
TRUE
,

1148 
$fÜm
['s™e_¦ogª'] = 
	`¬¿y
(

1150 '#t™Ë' => 
	`t
('Slogan'),

1151 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('site_slogan', ''),

1152 '#desütiÚ' => 
	`t
("Your site's motto,ag†ine, or catchphrase (often displayed‡longsideheitle ofhe site).")

1154 
$fÜm
['s™e_missiÚ'] = 
	`¬¿y
(

1156 '#t™Ë' => 
	`t
('Mission'),

1157 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('site_mission', ''),

1158 '#desütiÚ' => 
	`t
("Your site's mission or focus statement (often…rominently displayed onhe front…age).")

1160 
$fÜm
['s™e_foÙ”'] = 
	`¬¿y
(

1162 '#t™Ë' => 
	`t
('Footer message'),

1163 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('site_footer', ''),

1164 '#desütiÚ' => 
	`t
('Thisext will be displayed‡the bottom ofƒach…age. Useful for‡dding‡ copyright‚oticeo your…ages.')

1166 
$fÜm
['ªÚymous'] = 
	`¬¿y
(

1168 '#t™Ë' => 
	`t
('Anonymous user'),

1169 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('ªÚymous', 
	`t
('Anonymous')),

1170 '#desütiÚ' => 
	`t
('The‚ame usedo indicate‡nonymous users.'),

1171 '#»quœed' => 
TRUE
,

1173 
$fÜm
['s™e_äÚage'] = 
	`¬¿y
(

1175 '#t™Ë' => 
	`t
('Default front…age'),

1176 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('site_frontpage', 'node'),

1178 '#desütiÚ' => 
	`t
('The home…age displays content fromhis„elative URL. If unsure, specify "node".'),

1179 '#f›ld_´efix' => 
	`u¾
(
NULL
, 
	`¬¿y
('absŞu‹' => 
TRUE
)è. (
	`v¬ŸbË_g‘
('clean_url', 0) ? '' : '?q='),

1180 '#»quœed' => 
TRUE
,

1182 
$fÜm
['#validate'][] = 'system_site_information_settings_validate';

1184  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

1185 
	}
}

1190 
funùiÚ
 
	$sy¡em_s™e_šfÜm©iÚ_£‰šgs_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

1192 ià(
$”rÜ
 = 
	`u£r_v®id©e_ma
(
$fÜm_¡©e
['values']['site_mail'])) {

1193 
	`fÜm_£t_”rÜ
('s™e_ma', 
$”rÜ
);

1196 
$™em
 = 
	`¬¿y
('lšk_·th' => 
$fÜm_¡©e
['values']['site_frontpage']);

1197 
$nÜm®_·th
 = 
	`dru·l_g‘_nÜm®_·th
(
$™em
['link_path']);

1198 ià(
$™em
['lšk_·th'] !ğ
$nÜm®_·th
) {

1199 
	`dru·l_£t_mes§ge
(
	`t
('Thm’u sy¡em stÜe sy¡em…©h Úly, buˆwÈu£hURL‡lŸ fÜ di¥Ïy. %lšk_·th ha b“À¡Üed‡ %nÜm®_·th', 
	`¬¿y
('%lšk_·th' => 
$™em
['lšk_·th'], '%nÜm®_·th' => 
$nÜm®_·th
)));

1200 
$™em
['lšk_·th'] = 
$nÜm®_·th
;

1202 ià(!
	`em±y
(
$™em
è&& !
	`m’u_v®id_·th
($item)) {

1203 
	`fÜm_£t_”rÜ
('s™e_äÚage', 
	`t
("Th·th '@·th' i e™h” inv®id o¸you dØnÙ havacûs tØ™.", 
	`¬¿y
('@·th' => 
$™em
['link_path'])));

1205 
	}
}

1213 
funùiÚ
 
	$sy¡em_”rÜ_»pÜtšg_£‰šgs
() {

1215 
$fÜm
['s™e_403'] = 
	`¬¿y
(

1217 '#t™Ë' => 
	`t
('Default 403 (access denied)…age'),

1218 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('site_403', ''),

1220 '#desütiÚ' => 
	`t
('This…age is displayed whenhe„equested document is deniedohe current user. If unsure, specify‚othing.'),

1221 '#f›ld_´efix' => 
	`u¾
(
NULL
, 
	`¬¿y
('absŞu‹' => 
TRUE
)è. (
	`v¬ŸbË_g‘
('clean_url', 0) ? '' : '?q=')

1224 
$fÜm
['s™e_404'] = 
	`¬¿y
(

1226 '#t™Ë' => 
	`t
('Default 404 (not found)…age'),

1227 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('site_404', ''),

1229 '#desütiÚ' => 
	`t
('This…age is displayed when‚o other content matcheshe„equested document. If unsure, specify‚othing.'),

1230 '#f›ld_´efix' => 
	`u¾
(
NULL
, 
	`¬¿y
('absŞu‹' => 
TRUE
)è. (
	`v¬ŸbË_g‘
('clean_url', 0) ? '' : '?q=')

1233 
$fÜm
['”rÜ_Ëv–'] = 
	`¬¿y
(

1234 '#ty³' => '£Ëù', '#t™Ë' => 
	`t
('E¼Ü„•Ütšg'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('error_level', 1),

1235 '#İtiÚs' => 
	`¬¿y
(
	`t
('Writeƒrrorsohe†og'),('Writeƒrrorsohe†og‡ndohe screen')),

1236 '#desütiÚ' => 
	`t
('Specify where Drupal, PHP‡nd SQLƒrrors‡re†ogged. While it is„ecommendedhat‡ site„unning in‡…roductionƒnvironment writeƒrrorsohe†og only, in‡ development orestingƒnvironment it may be helpfulo writeƒrrors bothohe†og‡ndohe screen.')

1239  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

1240 
	}
}

1245 
funùiÚ
 
	$sy¡em_loggšg_ov”v›w
() {

1246 
$™em
 = 
	`m’u_g‘_™em
('admin/settings/logging');

1247 
$cÚ‹Á
 = 
	`sy¡em_admš_m’u_block
(
$™em
);

1249 
$ouut
 = 
	`theme
('admš_block_cÚ‹Á', 
$cÚ‹Á
);

1251  
$ouut
;

1252 
	}
}

1260 
funùiÚ
 
	$sy¡em_³rfÜmªû_£‰šgs
() {

1262 
$desütiÚ
 = '<p>'. 
	`t
("The‚ormal cache mode is suitable for most sites‡nd does‚ot cause‡ny sideƒffects. The‡ggressive cache mode causes Drupalo skiphe†oading (boot)‡nd unloading (exit) ofƒnabled modules when serving‡ cached…age. This„esults in‡n‡dditional…erformance boost but can cause unwanted sideƒffects.") .'</p>';

1264 
$´obËm_moduËs
 = 
	`¬¿y_unique
(
	`¬¿y_m”ge
(
	`moduË_im¶em’ts
('boot'), module_implements('exit')));

1265 
	`sÜt
(
$´obËm_moduËs
);

1267 ià(
	`couÁ
(
$´obËm_moduËs
) > 0) {

1268 
$desütiÚ
 .ğ'<p>'. 
	`t
('<¡rÚg cÏss="”rÜ">ThfŞlowšgƒÇbËd moduË ¬šcom·tibË w™h‡gg»ssivmodÿchšg‡nd wÈnÙ funùiÚ…rİ”ly: %moduËs</¡rÚg>', 
	`¬¿y
('%moduËs' => 
	`im¶ode
(', ', 
$´obËm_moduËs
))) .'.</p>';

1271 
$desütiÚ
 .ğ'<p>'. 
	`t
('<strong class="ok">Currently,‡llƒnabled modules‡re compatible withhe‡ggressive caching…olicy.</strong> Please‚ote, if you use‡ggressive caching‡ndƒnable‚ew modules, you will‚eedo checkhis…age‡gainoƒnsure compatibility.') .'</p>';

1273 
$fÜm
['·ge_ÿche'] = 
	`¬¿y
(

1275 '#t™Ë' => 
	`t
('Page cache'),

1276 '#desütiÚ' => 
	`t
('Enablinghe…age cache will offer‡ significant…erformance boost. Drupal can store‡nd send compressed cached…ages„equested by <em>anonymous</em> users. By caching‡ web…age, Drupal does‚ot haveo constructhe…ageƒachime it is viewed.'),

1279 
$fÜm
['·ge_ÿche']['ÿche'] = 
	`¬¿y
(

1281 '#t™Ë' => 
	`t
('Caching mode'),

1282 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('ÿche', 
CACHE_DISABLED
),

1283 '#İtiÚs' => 
	`¬¿y
(
CACHE_DISABLED
 => 
	`t
('Di§bËd'), 
CACHE_NORMAL
 =>('NÜm® (»comm’ded fÜ…roduùiÚ s™es,‚Øsidefãùs)'), 
CACHE_AGGRESSIVE
 =>('Aggressive (experts only,…ossible sideƒffects)')),

1284 '#desütiÚ' => 
$desütiÚ


1287 
$³riod
 = 
	`dru·l_m­_assoc
(
	`¬¿y
(0, 60, 180, 300, 600, 900, 1800, 2700, 3600, 10800, 21600, 32400, 43200, 86400), 'format_interval');

1288 
$³riod
[0] = '<'. 
	`t
('none') .'>';

1289 
$fÜm
['·ge_ÿche']['ÿche_liãtime'] = 
	`¬¿y
(

1291 '#t™Ë' => 
	`t
('Minimum cache†ifetime'),

1292 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('cache_lifetime', 0),

1293 '#İtiÚs' => 
$³riod
,

1294 '#desütiÚ' => 
	`t
('On high-traffic sites, it may be‚ecessaryoƒnforce‡ minimum cache†ifetime. The minimum cache†ifetime ishe minimum‡mount ofimehat willƒlapse beforehe cache isƒmptied‡nd„ecreated,‡nd is‡ppliedo both…age‡nd block caches. A†arger minimum cache†ifetime offers better…erformance, but users will‚ot see‚ew content for‡†onger…eriod ofime.')

1296 
$fÜm
['·ge_ÿche']['·ge_com´essiÚ'] = 
	`¬¿y
(

1298 '#t™Ë' => 
	`t
('Page compression'),

1299 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('·ge_com´essiÚ', 
TRUE
),

1300 '#İtiÚs' => 
	`¬¿y
(
	`t
('Disabled'),('Enabled')),

1301 '#desütiÚ' => 
	`t
("By default, Drupal compresseshe…ages it caches in ordero save bandwidth‡nd improve downloadimes. This option should be disabled when using‡ webserverhat…erforms compression."),

1304 
$fÜm
['block_ÿche'] = 
	`¬¿y
(

1306 '#t™Ë' => 
	`t
('Block cache'),

1307 '#desütiÚ' => 
	`t
('Enablinghe block cache can offer‡…erformance increase for‡ll users by…reventing blocks from being„econstructed onƒach…age†oad. Ifhe…age cache is‡lsoƒnabled,…erformance increases fromƒnablinghe block cache will mainly benefit‡uthenticated users.'),

1310 
$fÜm
['block_ÿche']['block_ÿche'] = 
	`¬¿y
(

1312 '#t™Ë' => 
	`t
('Block cache'),

1313 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('block_ÿche', 
CACHE_DISABLED
),

1314 '#İtiÚs' => 
	`¬¿y
(
CACHE_DISABLED
 => 
	`t
('Di§bËd'), 
CACHE_NORMAL
 =>('Enabled (recommended)')),

1315 '#di§bËd' => 
	`couÁ
(
	`moduË_im¶em’ts
('node_grants')),

1316 '#desütiÚ' => 
	`t
('Notehat block caching is inactive when modules defining content‡ccess„estrictions‡reƒnabled.'),

1319 
$fÜm
['bªdwidth_İtimiz©iÚs'] = 
	`¬¿y
(

1321 '#t™Ë' => 
	`t
('Bandwidth optimizations'),

1322 '#desütiÚ' => 
	`t
('<p>Drupal can‡utomatically optimizeƒxternal„esources†ike CSS‡nd JavaScript, which can„educe bothhe size‡nd‚umber of„equests madeo your website. CSS files can be‡ggregated‡nd compressed into‡ single file, while JavaScript files‡re‡ggregated (but‚ot compressed). These optional optimizations may„educe server†oad, bandwidth„equirements,‡nd…age†oadingimes.</p><p>These options‡re disabled if you have‚ot set up your files directory, or if your download method is seto…rivate.</p>')

1325 
$dœeùÜy
 = 
	`fe_dœeùÜy_·th
();

1326 
$is_wr™abË
 = 
	`is_dœ
(
$dœeùÜy
è&& 
	`is_wr™abË
($dœeùÜyè&& (
	`v¬ŸbË_g‘
('fe_dowÆßds', 
FILE_DOWNLOADS_PUBLIC
) == FILE_DOWNLOADS_PUBLIC);

1327 
$fÜm
['bªdwidth_İtimiz©iÚs']['´•roûss_css'] = 
	`¬¿y
(

1329 '#t™Ë' => 
	`t
('Optimize CSS files'),

1330 '#deçuÉ_v®ue' => 
	`štv®
(
	`v¬ŸbË_g‘
('´•roûss_css', 0è&& 
$is_wr™abË
),

1331 '#di§bËd' => !
$is_wr™abË
,

1332 '#İtiÚs' => 
	`¬¿y
(
	`t
('Disabled'),('Enabled')),

1333 '#desütiÚ' => 
	`t
('This option can interfere withheme development‡nd should only beƒnabled in‡…roductionƒnvironment.'),

1335 
$fÜm
['bªdwidth_İtimiz©iÚs']['´•roûss_js'] = 
	`¬¿y
(

1337 '#t™Ë' => 
	`t
('Optimize JavaScript files'),

1338 '#deçuÉ_v®ue' => 
	`štv®
(
	`v¬ŸbË_g‘
('´•roûss_js', 0è&& 
$is_wr™abË
),

1339 '#di§bËd' => !
$is_wr™abË
,

1340 '#İtiÚs' => 
	`¬¿y
(
	`t
('Disabled'),('Enabled')),

1341 '#desütiÚ' => 
	`t
('This option can interfere with module development‡nd should only beƒnabled in‡…roductionƒnvironment.'),

1344 
$fÜm
['ş—r_ÿche'] = 
	`¬¿y
(

1346 '#t™Ë' => 
	`t
('Clear cached data'),

1347 '#desütiÚ' => 
	`t
('Caching data improves…erformance, but may cause…roblems whileroubleshooting‚ew modules,hemes, orranslations, if outdated information has been cached. To„efresh‡ll cached data on your site, clickhe button below. <em>Warning: high-traffic sites willƒxperience…erformance slowdowns while cached data is„ebuilt.</em>'),

1350 
$fÜm
['ş—r_ÿche']['ş—r'] = 
	`¬¿y
(

1352 '#v®ue' => 
	`t
('Clear cached data'),

1353 '#subm™' => 
	`¬¿y
('system_clear_cache_submit'),

1356 
$fÜm
['#submit'][] = 'drupal_clear_css_cache';

1357 
$fÜm
['#submit'][] = 'drupal_clear_js_cache';

1359  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

1360 
	}
}

1367 
funùiÚ
 
	$sy¡em_ş—r_ÿche_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1368 
	`dru·l_æush_®l_ÿches
();

1369 
	`dru·l_£t_mes§ge
(
	`t
('Caches cleared.'));

1370 
	}
}

1378 
funùiÚ
 
	$sy¡em_fe_sy¡em_£‰šgs
() {

1380 
$fÜm
['fe_dœeùÜy_·th'] = 
	`¬¿y
(

1382 '#t™Ë' => 
	`t
('File system…ath'),

1383 '#deçuÉ_v®ue' => 
	`fe_dœeùÜy_·th
(),

1385 '#desütiÚ' => 
	`t
('A file system…ath wherehe files will be stored. This directory mustƒxist‡nd be writable by Drupal. Ifhe download method is seto…ublic,his directory must be„elativeohe Drupal installation directory‡nd be‡ccessible overhe web. Ifhe download method is seto…rivate,his directory should‚ot be‡ccessible overhe web. Changinghis†ocation will modify‡ll download…aths‡nd may cause unexpected…roblems on‡nƒxisting site.'),

1386 '#aá”_bud' => 
	`¬¿y
('system_check_directory'),

1389 
$fÜm
['fe_dœeùÜy_‹mp'] = 
	`¬¿y
(

1391 '#t™Ë' => 
	`t
('Temporary directory'),

1392 '#deçuÉ_v®ue' => 
	`fe_dœeùÜy_‹mp
(),

1394 '#desütiÚ' => 
	`t
('A file system…ath where uploaded files will be stored during…reviews.'),

1395 '#aá”_bud' => 
	`¬¿y
('system_check_directory'),

1398 
$fÜm
['fe_dowÆßds'] = 
	`¬¿y
(

1400 '#t™Ë' => 
	`t
('Download method'),

1401 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('fe_dowÆßds', 
FILE_DOWNLOADS_PUBLIC
),

1402 '#İtiÚs' => 
	`¬¿y
(
FILE_DOWNLOADS_PUBLIC
 => 
	`t
('Publiø- fe ¬avaabË usšg HTTP dœeùly.'), 
FILE_DOWNLOADS_PRIVATE
 =>('Private - files‡reransferred by Drupal.')),

1403 '#desütiÚ' => 
	`t
('Choosehe <em>Public download</em> method unless you wishoƒnforce fine-grained‡ccess controls over file downloads. Changinghe download method will modify‡ll download…aths‡nd may cause unexpected…roblems on‡nƒxisting site.')

1406  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

1407 
	}
}

1415 
funùiÚ
 
	$sy¡em_image_toŞk™_£‰šgs
() {

1416 
$toŞk™s_avaabË
 = 
	`image_g‘_avaabË_toŞk™s
();

1417 ià(
	`couÁ
(
$toŞk™s_avaabË
) > 1) {

1418 
$fÜm
['image_toŞk™'] = 
	`¬¿y
(

1420 '#t™Ë' => 
	`t
('Select‡n image…rocessingoolkit'),

1421 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('image_toŞk™', 
	`image_g‘_toŞk™
()),

1422 '#İtiÚs' => 
$toŞk™s_avaabË


1425 
	`–£if
 (
	`couÁ
(
$toŞk™s_avaabË
) == 1) {

1426 
	`v¬ŸbË_£t
('image_toŞk™', 
	`key
(
$toŞk™s_avaabË
));

1429 
$fÜm
['image_toŞk™_£‰šgs'] = 
	`image_toŞk™_švoke
('settings');

1431  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

1432 
	}
}

1440 
funùiÚ
 
	$sy¡em_rss_ãeds_£‰šgs
() {

1442 
$fÜm
['ãed_deçuÉ_™ems'] = 
	`¬¿y
(

1444 '#t™Ë' => 
	`t
('Number of items inƒach feed'),

1445 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('feed_default_items', 10),

1446 '#İtiÚs' => 
	`dru·l_m­_assoc
(
	`¬¿y
(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 20, 25, 30)),

1447 '#desütiÚ' => 
	`t
('Default‚umber of itemso include inƒach feed.')

1449 
$fÜm
['ãed_™em_Ëngth'] = 
	`¬¿y
(

1451 '#t™Ë' => 
	`t
('Feed content'),

1452 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('feed_item_length', 'teaser'),

1453 '#İtiÚs' => 
	`¬¿y
('t™Ë' => 
	`t
('Titles only'), 'teaser' =>('Titles…luseaser'), 'fulltext' =>('Fullext')),

1454 '#desütiÚ' => 
	`t
('Global setting forhe default display of content items inƒach feed.')

1457  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

1458 
	}
}

1467 
funùiÚ
 
	$sy¡em_d©e_time_£‰šgs
() {

1468 
	`dru·l_add_js
(
	`dru·l_g‘_·th
('module', 'system') .'/system.js', 'module');

1469 
	`dru·l_add_js
(
	`¬¿y
('d©eTime' =>‡¼ay('lookup' => 
	`u¾
('admin/settings/date-time/lookup'))), 'setting');

1472 
$zÚes
 = 
	`_sy¡em_zÚ–i¡
();

1475 
$d©e_shÜt
 = 
	`¬¿y
('Y-m-d H:i', 'm/d/Y - H:i', 'd/m/Y - H:i', 'Y/m/d - H:i',

1479 
$d©e_medium
 = 
	`¬¿y
('D, Y-m-d H:i', 'D, m/d/Y - H:i', 'D, d/m/Y - H:i',

1483 
$d©e_lÚg
 = 
	`¬¿y
('l, F j, Y - H:i', 'l, j F, Y - H:i', 'l, Y, F j - H:i',

1487 
	`fÜ—ch
 (
$d©e_shÜt
 
as
 
$f
) {

1488 
$d©e_shÜt_choiûs
[
$f
] = 
	`fÜm©_d©e
(
	`time
(), 'custom', $f);

1490 
	`fÜ—ch
 (
$d©e_medium
 
as
 
$f
) {

1491 
$d©e_medium_choiûs
[
$f
] = 
	`fÜm©_d©e
(
	`time
(), 'custom', $f);

1493 
	`fÜ—ch
 (
$d©e_lÚg
 
as
 
$f
) {

1494 
$d©e_lÚg_choiûs
[
$f
] = 
	`fÜm©_d©e
(
	`time
(), 'custom', $f);

1497 
$d©e_lÚg_choiûs
['cu¡om'] = 
$d©e_medium_choiûs
['cu¡om'] = 
$d©e_shÜt_choiûs
['cu¡om'] = 
	`t
('Custom format');

1499 
$fÜm
['loÿË'] = 
	`¬¿y
(

1501 '#t™Ë' => 
	`t
('Locale settings'),

1504 
$fÜm
['loÿË']['d©e_deçuÉ_timezÚe'] = 
	`¬¿y
(

1506 '#t™Ë' => 
	`t
('Defaultime zone'),

1507 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('date_default_timezone', 0),

1508 '#İtiÚs' => 
$zÚes
,

1509 '#desütiÚ' => 
	`t
('Selecthe default siteime zone.')

1512 
$fÜm
['loÿË']['cÚfigu¿bË_timezÚes'] = 
	`¬¿y
(

1514 '#t™Ë' => 
	`t
('User-configurableime zones'),

1515 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('configurable_timezones', 1),

1516 '#İtiÚs' => 
	`¬¿y
(
	`t
('Disabled'),('Enabled')),

1517 '#desütiÚ' => 
	`t
('Whenƒnabled, users can setheir ownime zone‡nd dates will be displayed‡ccordingly.')

1520 
$fÜm
['loÿË']['d©e_fœ¡_day'] = 
	`¬¿y
(

1522 '#t™Ë' => 
	`t
('First day of week'),

1523 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('date_first_day', 0),

1524 '#İtiÚs' => 
	`¬¿y
(0 => 
	`t
('Sunday'), 1 =>('Monday'), 2 =>('Tuesday'), 3 =>('Wednesday'), 4 =>('Thursday'), 5 =>('Friday'), 6 =>('Saturday')),

1525 '#desütiÚ' => 
	`t
('The first day ofhe week for calendar views.')

1528 
$fÜm
['d©e_fÜm©s'] = 
	`¬¿y
(

1530 '#t™Ë' => 
	`t
('Formatting'),

1533 
$d©e_fÜm©_shÜt
 = 
	`v¬ŸbË_g‘
('d©e_fÜm©_shÜt', 
$d©e_shÜt
[1]);

1534 
$fÜm
['d©e_fÜm©s']['d©e_fÜm©_shÜt'] = 
	`¬¿y
(

1538 '#t™Ë' => 
	`t
('Short date format'),

1539 '#©Œibu‹s' => 
	`¬¿y
('class' => 'date-format'),

1540 '#deçuÉ_v®ue' => (
	`is£t
(
$d©e_shÜt_choiûs
[
$d©e_fÜm©_shÜt
]) ? $date_format_short : 'custom'),

1541 '#İtiÚs' => 
$d©e_shÜt_choiûs
,

1542 '#desütiÚ' => 
	`t
('The short format of date display.'),

1545 
$deçuÉ_shÜt_cu¡om
 = 
	`v¬ŸbË_g‘
('d©e_fÜm©_shÜt_cu¡om', (
	`is£t
(
$d©e_shÜt_choiûs
[
$d©e_fÜm©_shÜt
]) ? $date_format_short : ''));

1546 
$fÜm
['d©e_fÜm©s']['d©e_fÜm©_shÜt_cu¡om'] = 
	`¬¿y
(

1550 '#t™Ë' => 
	`t
('Custom short date format'),

1551 '#©Œibu‹s' => 
	`¬¿y
('class' => 'custom-format'),

1552 '#deçuÉ_v®ue' => 
$deçuÉ_shÜt_cu¡om
,

1553 '#desütiÚ' => 
	`t
('A u£r-defšed shÜˆd©fÜm©. S“h<¨h»f="@u¾">PHP mªu®</a> fÜ‡vaabË o±iÚs. Thi fÜm© i cu¼’y s‘Ødi¥Ïy‡ <¥ª>%d©e</¥ª>.', 
	`¬¿y
('@u¾' => 'h‰p://php.Ãt/mªu®/funùiÚ.d©e.php', '%d©e' => 
	`fÜm©_d©e
(
	`time
(), 'cu¡om', 
$deçuÉ_shÜt_cu¡om
))),

1556 
$d©e_fÜm©_medium
 = 
	`v¬ŸbË_g‘
('d©e_fÜm©_medium', 
$d©e_medium
[1]);

1557 
$fÜm
['d©e_fÜm©s']['d©e_fÜm©_medium'] = 
	`¬¿y
(

1561 '#t™Ë' => 
	`t
('Medium date format'),

1562 '#©Œibu‹s' => 
	`¬¿y
('class' => 'date-format'),

1563 '#deçuÉ_v®ue' => (
	`is£t
(
$d©e_medium_choiûs
[
$d©e_fÜm©_medium
]) ? $date_format_medium : 'custom'),

1564 '#İtiÚs' => 
$d©e_medium_choiûs
,

1565 '#desütiÚ' => 
	`t
('The medium sized date display.'),

1568 
$deçuÉ_medium_cu¡om
 = 
	`v¬ŸbË_g‘
('d©e_fÜm©_medium_cu¡om', (
	`is£t
(
$d©e_medium_choiûs
[
$d©e_fÜm©_medium
]) ? $date_format_medium : ''));

1569 
$fÜm
['d©e_fÜm©s']['d©e_fÜm©_medium_cu¡om'] = 
	`¬¿y
(

1573 '#t™Ë' => 
	`t
('Custom medium date format'),

1574 '#©Œibu‹s' => 
	`¬¿y
('class' => 'custom-format'),

1575 '#deçuÉ_v®ue' => 
$deçuÉ_medium_cu¡om
,

1576 '#desütiÚ' => 
	`t
('A u£r-defšed medium d©fÜm©. S“h<¨h»f="@u¾">PHP mªu®</a> fÜ‡vaabË o±iÚs. Thi fÜm© i cu¼’y s‘Ødi¥Ïy‡ <¥ª>%d©e</¥ª>.', 
	`¬¿y
('@u¾' => 'h‰p://php.Ãt/mªu®/funùiÚ.d©e.php', '%d©e' => 
	`fÜm©_d©e
(
	`time
(), 'cu¡om', 
$deçuÉ_medium_cu¡om
))),

1579 
$d©e_fÜm©_lÚg
 = 
	`v¬ŸbË_g‘
('d©e_fÜm©_lÚg', 
$d©e_lÚg
[0]);

1580 
$fÜm
['d©e_fÜm©s']['d©e_fÜm©_lÚg'] = 
	`¬¿y
(

1584 '#t™Ë' => 
	`t
('Long date format'),

1585 '#©Œibu‹s' => 
	`¬¿y
('class' => 'date-format'),

1586 '#deçuÉ_v®ue' => (
	`is£t
(
$d©e_lÚg_choiûs
[
$d©e_fÜm©_lÚg
]) ? $date_format_long : 'custom'),

1587 '#İtiÚs' => 
$d©e_lÚg_choiûs
,

1588 '#desütiÚ' => 
	`t
('Longer date format used for detailed display.')

1591 
$deçuÉ_lÚg_cu¡om
 = 
	`v¬ŸbË_g‘
('d©e_fÜm©_lÚg_cu¡om', (
	`is£t
(
$d©e_lÚg_choiûs
[
$d©e_fÜm©_lÚg
]) ? $date_format_long : ''));

1592 
$fÜm
['d©e_fÜm©s']['d©e_fÜm©_lÚg_cu¡om'] = 
	`¬¿y
(

1596 '#t™Ë' => 
	`t
('Custom†ong date format'),

1597 '#©Œibu‹s' => 
	`¬¿y
('class' => 'custom-format'),

1598 '#deçuÉ_v®ue' => 
$deçuÉ_lÚg_cu¡om
,

1599 '#desütiÚ' => 
	`t
('A u£r-defšed†Úg d©fÜm©. S“h<¨h»f="@u¾">PHP mªu®</a> fÜ‡vaabË o±iÚs. Thi fÜm© i cu¼’y s‘Ødi¥Ïy‡ <¥ª>%d©e</¥ª>.', 
	`¬¿y
('@u¾' => 'h‰p://php.Ãt/mªu®/funùiÚ.d©e.php', '%d©e' => 
	`fÜm©_d©e
(
	`time
(), 'cu¡om', 
$deçuÉ_lÚg_cu¡om
))),

1602 
$fÜm
 = 
	`sy¡em_£‰šgs_fÜm
($form);

1604 
	`un£t
(
$fÜm
['#submit']);

1605  
$fÜm
;

1606 
	}
}

1611 
funùiÚ
 
	$sy¡em_d©e_time_£‰šgs_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1612 ià(
$fÜm_¡©e
['values']['date_format_short'] == 'custom') {

1613 
$fÜm_¡©e
['values']['date_format_short'] = $form_state['values']['date_format_short_custom'];

1615 ià(
$fÜm_¡©e
['values']['date_format_medium'] == 'custom') {

1616 
$fÜm_¡©e
['values']['date_format_medium'] = $form_state['values']['date_format_medium_custom'];

1618 ià(
$fÜm_¡©e
['values']['date_format_long'] == 'custom') {

1619 
$fÜm_¡©e
['values']['date_format_long'] = $form_state['values']['date_format_long_custom'];

1621  
	`sy¡em_£‰šgs_fÜm_subm™
(
$fÜm
, 
$fÜm_¡©e
);

1622 
	}
}

1627 
funùiÚ
 
	$sy¡em_d©e_time_lookup
() {

1628 
$»suÉ
 = 
	`fÜm©_d©e
(
	`time
(), 'cu¡om', 
$_GET
['format']);

1629 
	`dru·l_jsÚ
(
$»suÉ
);

1630 
	}
}

1638 
funùiÚ
 
	$sy¡em_s™e_maš‹Çnû_£‰šgs
() {

1640 
$fÜm
['s™e_ofæše'] = 
	`¬¿y
(

1642 '#t™Ë' => 
	`t
('Site status'),

1643 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('site_offline', 0),

1644 '#İtiÚs' => 
	`¬¿y
(
	`t
('Online'),('Off-line')),

1645 '#desütiÚ' => 
	`t
('Wh’ s‘Ø"OÆše",‡Î vis™Ü wÈbabËØbrow£ you¸s™nÜm®ly. Wh’ s‘Ø"Off-lše", oÆy u£r w™hh"admši¡” s™cÚfigu¿tiÚ"…”missiÚ wÈbabËØacûs you¸s™tØ³rfÜm maš‹Çnû;‡Î oth” vis™Ü wÈ£ths™off-lšmes§gcÚfigu»d b–ow. AuthÜized u£r ÿÀlog iÀduršg "Off-lše" moddœeùly vŸh<¨h»f="@u£r-logš">u£¸logš</a>…age.', 
	`¬¿y
('@u£r-logš' => 
	`u¾
('user'))),

1648 
$fÜm
['s™e_ofæše_mes§ge'] = 
	`¬¿y
(

1650 '#t™Ë' => 
	`t
('Site off-line message'),

1651 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('s™e_ofæše_mes§ge', 
	`t
('@s™i cu¼’y und” maš‹Çnû. Wshould bback shÜy. Thªk you fÜ you¸·t›nû.', 
	`¬¿y
('@site' => variable_get('site_name', 'Drupal')))),

1652 '#desütiÚ' => 
	`t
('Messageo show visitors whenhe site is in off-line mode.')

1655  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

1656 
	}
}

1664 
funùiÚ
 
	$sy¡em_ş—n_u¾_£‰šgs
() {

1665 
$fÜm
['ş—n_u¾'] = 
	`¬¿y
(

1667 '#t™Ë' => 
	`t
('Clean URLs'),

1668 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('clean_url', 0),

1669 '#İtiÚs' => 
	`¬¿y
(
	`t
('Disabled'),('Enabled')),

1670 '#desütiÚ' => 
	`t
('This option makes Drupalƒmit "clean" URLs (i.e. without <code>?q=</code> inhe URL).'),

1673 ià(!
	`v¬ŸbË_g‘
('clean_url', 0)) {

1674 ià(
	`¡½os
(
	`»que¡_uri
(), '?q='è!=ğ
FALSE
) {

1675 
	`dru·l_add_js
(
	`dru·l_g‘_·th
('module', 'system') .'/system.js', 'module');

1677 
$fÜm
['ş—n_u¾']['#desütiÚ'] .ğ' <¥ª>'. 
	`t
('BefÜ’ablšg cËª URLs, you mu¡…”fÜm‡e¡Ød‘”mšiàyou¸£rv” i ´İ”ly cÚfigu»d. Iàyou‡»‡bËØ£thi ·gagaš‡á” clickšgh"RuÀthş—ÀURLe¡"†šk,h‹¡ ha sucûeded‡ndh¿diØbu‰Ú abovwÈbavaabË. Iàš¡—d you‡» dœeùedØ¨"PagnÙ found"ƒ¼Ü, you wÈÃedØchªgthcÚfigu¿tiÚ oàyou¸£rv”. Th<¨h»f="@hªdbook">hªdbook…agÚ CËª URLs</a> ha add™iÚ®roubËshoÙšg infÜm©iÚ.', 
	`¬¿y
('@handbook' => 'http://drupal.org/node/15365')) .'</span>';

1679 
$fÜm
['ş—n_u¾']['#di§bËd'] = 
TRUE
;

1680 
$fÜm
['clean_url']['#prefix'] = '<div id="clean-url">';

1681 
$fÜm
['ş—n_u¾']['#suffix'] = '<p>'. 
	`t
('<¨h»f="@ş—n_u¾">RuÀthş—Àu¾e¡</a>.', 
	`¬¿y
('@ş—n_u¾' => 
	`ba£_·th
() .'admin/settings/clean-urls')) .'</p></div>';

1684 
$fÜm
['ş—n_u¾']['#desütiÚ'] .ğ' <div cÏss="ok">'. 
	`t
('Your server has been successfullyestedo supporthis feature.') .'</div>';

1688  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

1689 
	}
}

1697 
funùiÚ
 
	$sy¡em_¡©us
(
$check
 = 
FALSE
) {

1699 
šşude_Úû
 './includes/install.inc';

1700 
	`dru·l_lßd_upd©es
();

1703 
$»quœem’ts
 = 
	`moduË_švoke_®l
('requirements', 'runtime');

1704 
	`usÜt
(
$»quœem’ts
, '_system_sort_requirements');

1706 ià(
$check
) {

1707  
	`dru·l_»quœem’ts_£v”™y
(
$»quœem’ts
è=ğ
REQUIREMENT_ERROR
;

1711 
	`db_qu”y
("UPDATE {users} SET uid = uid - uid WHERE‚ame = '' AND…ass = '' AND status = 0");

1713  
	`theme
('¡©us_»pÜt', 
$»quœem’ts
);

1714 
	}
}

1719 
funùiÚ
 
	$sy¡em_run_üÚ
() {

1721 ià(
	`dru·l_üÚ_run
()) {

1722 
	`dru·l_£t_mes§ge
(
	`t
('Cron„an successfully.'));

1725 
	`dru·l_£t_mes§ge
(
	`t
('Cron„un failed.'), 'error');

1728 
	`dru·l_gÙo
('admin/reports/status');

1729 
	}
}

1734 
funùiÚ
 
	$sy¡em_php
() {

1735 
	`phpšfo
();

1736 
	`ex™
();

1737 
	}
}

1749 
funùiÚ
 
	$_sy¡em_sql
(
$d©a
, 
$keys
) {

1750 
$rows
 = 
	`¬¿y
();

1751 
	`fÜ—ch
 (
$keys
 
as
 
$key
 => 
$ex¶ª©iÚ
) {

1752 ià(
	`is£t
(
$d©a
[
$key
])) {

1753 
$rows
[] = 
	`¬¿y
(
	`check_¶aš
(
$key
), check_¶aš(
$d©a
[$key]), 
$ex¶ª©iÚ
);

1757  
	`theme
('bË', 
	`¬¿y
(
	`t
('V¬ŸbË'),('V®ue'),('DesütiÚ')), 
$rows
);

1758 
	}
}

1763 
funùiÚ
 
	$sy¡em_sql
() {

1765 
$»suÉ
 = 
	`db_qu”y
("SHOW STATUS");

1766 
$’Œy
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1769 
$d©a
[
$’Œy
->
V¬ŸbË_Çme
] = $’Œy->
V®ue
;

1772 
$ouut
 = '<h2>'. 
	`t
('Command counters') .'</h2>';

1773 
$ouut
 .ğ
	`_sy¡em_sql
(
$d©a
, 
	`¬¿y
(

1774 'Com_£Ëù' => 
	`t
('The‚umber of <code>SELECT</code>-statements.'),

1775 'Com_š£¹' => 
	`t
('The‚umber of <code>INSERT</code>-statements.'),

1776 'Com_upd©e' => 
	`t
('The‚umber of <code>UPDATE</code>-statements.'),

1777 'Com_d–‘e' => 
	`t
('The‚umber of <code>DELETE</code>-statements.'),

1778 'Com_lock_bËs' => 
	`t
('The‚umber ofable†ocks.'),

1779 'Com_uÆock_bËs' => 
	`t
('The‚umber ofable unlocks.')

1782 
$ouut
 .ğ'<h2>'. 
	`t
('Query…erformance') .'</h2>';

1783 
$ouut
 .ğ
	`_sy¡em_sql
(
$d©a
, 
	`¬¿y
(

1784 'S–eù_fuÎ_još' => 
	`t
('The‚umber of joins without‡n index; should be zero.'),

1785 'S–eù_¿nge_check' => 
	`t
('The‚umber of joins without keyshat check for key usage‡fterƒach„ow; should be zero.'),

1786 'SÜt_sÿn' => 
	`t
('The‚umber of sorts done without using‡n index; should be zero.'),

1787 'TabË_locks_immedŸ‹' => 
	`t
('The‚umber ofimes‡†ock could be‡cquired immediately.'),

1788 'TabË_locks_wa™ed' => 
	`t
('The‚umber ofimeshe server hado wait for‡†ock.')

1791 
$ouut
 .ğ'<h2>'. 
	`t
('Query cache information') .'</h2>';

1792 
$ouut
 .ğ'<p>'. 
	`t
('The MySQL query cache can improve…erformance of your site by storinghe„esult of queries. Then, if‡n identical query is„eceived†ater,he MySQL server„etrieveshe„esult fromhe query cache„atherhan…arsing‡ndƒxecutinghe statement‡gain.') .'</p>';

1793 
$ouut
 .ğ
	`_sy¡em_sql
(
$d©a
, 
	`¬¿y
(

1794 'Qÿche_qu”›s_š_ÿche' => 
	`t
('The‚umber of queries inhe query cache.'),

1795 'Qÿche_h™s' => 
	`t
('The‚umber ofimes MySQL found…revious„esults inhe cache.'),

1796 'Qÿche_š£¹s' => 
	`t
('The‚umber ofimes MySQL‡dded‡ queryohe cache (misses).'),

1797 'Qÿche_lowmem_´uÃs' => 
	`t
('The‚umber ofimes MySQL hado„emove queries fromhe cache because it„an out of memory. Ideally should be zero.')

1800  
$ouut
;

1801 
	}
}

1806 
funùiÚ
 
	$sy¡em_b©ch_·ge
() {

1807 
»quœe_Úû
 './includes/batch.inc';

1808 
$ouut
 = 
	`_b©ch_·ge
();

1809 ià(
$ouut
 ==ğ
FALSE
) {

1810 
	`dru·l_acûss_d’›d
();

1812 
	`–£if
 (
	`is£t
(
$ouut
)) {

1815 
´št
 
	`theme
('·ge', 
$ouut
, 
FALSE
, FALSE);

1817 
	}
}

1827 
funùiÚ
 
	$theme_admš_block
(
$block
) {

1829 ià(
	`em±y
(
$block
['content'])) {

1833 
$ouut
 = <<< 
EOT


1834 <
div
 
şass
="admin-panel">

1835 <
h3
>

1836 
$block
[
t™Ë
]

1837 </
h3
>

1838 <
div
 
şass
="body">

1839 <
p
 
şass
="description">

1840 
$block
[
desütiÚ
]

1841 </
p
>

1842 
$block
[
cÚ‹Á
]

1843 </
div
>

1844 </
div
>

1845 
EOT
;

1846  
$ouut
;

1847 
	}
}

1857 
funùiÚ
 
	$theme_admš_block_cÚ‹Á
(
$cÚ‹Á
) {

1858 ià(!
$cÚ‹Á
) {

1862 ià(
	`sy¡em_admš_com·ù_mode
()) {

1863 
$ouut
 = '<ul class="menu">';

1864 
	`fÜ—ch
 (
$cÚ‹Á
 
as
 
$™em
) {

1865 
$ouut
 .ğ'<l˜şass="Ëaf">'. 
	`l
(
$™em
['title'], $item['href'], $item['localized_options']) .'</li>';

1867 
$ouut
 .= '</ul>';

1870 
$ouut
 = '<dl class="admin-list">';

1871 
	`fÜ—ch
 (
$cÚ‹Á
 
as
 
$™em
) {

1872 
$ouut
 .ğ'<dt>'. 
	`l
(
$™em
['title'], $item['href'], $item['localized_options']) .'</dt>';

1873 
$ouut
 .ğ'<dd>'. 
$™em
['description'] .'</dd>';

1875 
$ouut
 .= '</dl>';

1877  
$ouut
;

1878 
	}
}

1890 
funùiÚ
 
	$theme_admš_·ge
(
$blocks
) {

1891 
$¡re
 = 0;

1892 
$cÚš”
 = 
	`¬¿y
();

1894 
	`fÜ—ch
 (
$blocks
 
as
 
$block
) {

1895 ià(
$block_ouut
 = 
	`theme
('admš_block', 
$block
)) {

1896 ià(
	`em±y
(
$block
['position'])) {

1898 
$block
['pos™iÚ'] = ++
$¡re
 % 2 ? 'left' : 'right';

1900 ià(!
	`is£t
(
$cÚš”
[
$block
['position']])) {

1901 
$cÚš”
[
$block
['position']] = '';

1903 
$cÚš”
[
$block
['pos™iÚ']] .ğ
$block_ouut
;

1907 
$ouut
 = '<div class="admin clear-block">';

1908 
$ouut
 .= '<div class="compact-link">';

1909 ià(
	`sy¡em_admš_com·ù_mode
()) {

1910 
$ouut
 .ğ
	`l
(
	`t
('Show desütiÚs'), 'admš/com·ù/off', 
	`¬¿y
('attributes' =>‡rray('title' =>('Expand†ayouto include descriptions.'))));

1913 
$ouut
 .ğ
	`l
(
	`t
('HiddesütiÚs'), 'admš/com·ù/Ú', 
	`¬¿y
('attributes' =>‡rray('title' =>('Compress†ayout by hiding descriptions.'))));

1915 
$ouut
 .= '</div>';

1917 
	`fÜ—ch
 (
$cÚš”
 
as
 
$id
 => 
$d©a
) {

1918 
$ouut
 .ğ'<div cÏss="'. 
$id
 .' clear-block">';

1919 
$ouut
 .ğ
$d©a
;

1920 
$ouut
 .= '</div>';

1922 
$ouut
 .= '</div>';

1923  
$ouut
;

1924 
	}
}

1933 
funùiÚ
 
	$theme_sy¡em_admš_by_moduË
(
$m’u_™ems
) {

1934 
$¡re
 = 0;

1935 
$ouut
 = '';

1936 
$cÚš”
 = 
	`¬¿y
('left' => '', 'right' => '');

1937 
$æ
 = 
	`¬¿y
('left' => 'right', 'right' => 'left');

1938 
$pos™iÚ
 = 'left';

1941 
	`fÜ—ch
 (
$m’u_™ems
 
as
 
$moduË
 => 
$block
) {

1942 
	`li¡
(
$desütiÚ
, 
$™ems
èğ
$block
;

1945 ià(
	`couÁ
(
$™ems
)) {

1946 
$block
 = 
	`¬¿y
();

1947 
$block
['t™Ë'] = 
$moduË
;

1948 
$block
['cÚ‹Á'] = 
	`theme
('™em_li¡', 
$™ems
);

1949 
$block
['desütiÚ'] = 
	`t
(
$desütiÚ
);

1951 ià(
$block_ouut
 = 
	`theme
('admš_block', 
$block
)) {

1952 ià(!
	`is£t
(
$block
['position'])) {

1954 
$block
['pos™iÚ'] = 
$pos™iÚ
;

1955 
$pos™iÚ
 = 
$æ
[$position];

1957 
$cÚš”
[
$block
['pos™iÚ']] .ğ
$block_ouut
;

1962 
$ouut
 = '<div class="admin clear-block">';

1963 
	`fÜ—ch
 (
$cÚš”
 
as
 
$id
 => 
$d©a
) {

1964 
$ouut
 .ğ'<div cÏss="'. 
$id
 .' clear-block">';

1965 
$ouut
 .ğ
$d©a
;

1966 
$ouut
 .= '</div>';

1968 
$ouut
 .= '</div>';

1970  
$ouut
;

1971 
	}
}

1980 
funùiÚ
 
	$theme_¡©us_»pÜt
(
$»quœem’ts
) {

1981 
$i
 = 0;

1982 
$ouut
 = '<table class="system-status-report">';

1983 
	`fÜ—ch
 (
$»quœem’ts
 
as
 
$»quœem’t
) {

1984 ià(
	`em±y
(
$»quœem’t
['#type'])) {

1985 
$şass
 = ++
$i
 % 2 == 0 ? 'even' : 'odd';

1987 
$şas£s
 = 
	`¬¿y
(

1988 
REQUIREMENT_INFO
 => 'info',

1989 
REQUIREMENT_OK
 => 'ok',

1990 
REQUIREMENT_WARNING
 => 'warning',

1991 
REQUIREMENT_ERROR
 => 'error',

1993 
$şass
 = 
$şas£s
[
	`is£t
(
$»quœem’t
['severity']) ? ()$requirement['severity'] : 0] .' '. $class;

1996 ià(!
	`em±y
(
$»quœem’t
['description'])) {

1997 
$ouut
 .ğ'<Œ cÏss="'. 
$şass
 .' m”ge-down"><th>'. 
$»quœem’t
['title'] .'</th><td>'. $requirement['value'] .'</td></tr>';

1998 
$ouut
 .ğ'<Œ cÏss="'. 
$şass
 .' m”ge-up"><td cŞ¥ª="2">'. 
$»quœem’t
['description'] .'</td></tr>';

2001 
$ouut
 .ğ'<Œ cÏss="'. 
$şass
 .'"><th>'. 
$»quœem’t
['title'] .'</th><td>'. $requirement['value'] .'</td></tr>';

2006 
$ouut
 .= '</table>';

2007  
$ouut
;

2008 
	}
}

2017 
funùiÚ
 
	$theme_sy¡em_moduËs
(
$fÜm
) {

2018 ià(
	`is£t
(
$fÜm
['confirm'])) {

2019  
	`dru·l_»nd”
(
$fÜm
);

2023 
$h—d”
 = 
	`¬¿y
();

2024 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Enabled'), 'class' => 'checkbox');

2025 ià(
	`moduË_exi¡s
('throttle')) {

2026 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Throttle'), 'class' => 'checkbox');

2028 
$h—d”
[] = 
	`t
('Name');

2029 
$h—d”
[] = 
	`t
('Version');

2030 
$h—d”
[] = 
	`t
('Description');

2033 
$moduËs
 = 
$fÜm
['validation_modules']['#value'];

2034 
	`fÜ—ch
 (
$moduËs
 
as
 
$moduË
) {

2035 ià(!
	`is£t
(
$moduË
->
šfo
['package']) || !$module->info['package']) {

2036 
$moduË
->
šfo
['·ckage'] = 
	`t
('Other');

2038 
$·ckages
[
$moduË
->
šfo
['·ckage']][$moduË->
Çme
] = $module->info;

2040 
	`ksÜt
(
$·ckages
);

2043 
$ouut
 = '';

2044 
	`fÜ—ch
 (
$·ckages
 
as
 
$·ckage
 => 
$moduËs
) {

2045 
$rows
 = 
	`¬¿y
();

2046 
	`fÜ—ch
 (
$moduËs
 
as
 
$key
 => 
$moduË
) {

2047 
$row
 = 
	`¬¿y
();

2048 
$desütiÚ
 = 
	`dru·l_»nd”
(
$fÜm
['desütiÚ'][
$key
]);

2049 ià(
	`is£t
(
$fÜm
['¡©us']['#šcom·tibË_moduËs_cÜe'][
$key
])) {

2050 
	`un£t
(
$fÜm
['¡©us'][
$key
]);

2051 
$¡©us
 = 
	`theme
('image', 'misc/w©chdog-”rÜ.²g', 
	`t
('incompatible'),('Incompatible withhis version of Drupal core'));

2052 
$desütiÚ
 .ğ'<div cÏss="šcom·tibË">'. 
	`t
('Thi v”siÚ i šcom·tibË w™hh!cÜe_v”siÚ v”siÚ oàDru·ÈcÜe.', 
	`¬¿y
('!cÜe_v”siÚ' => 
VERSION
)) .'</div>';

2054 
	`–£if
 (
	`is£t
(
$fÜm
['¡©us']['#šcom·tibË_moduËs_php'][
$key
])) {

2055 
	`un£t
(
$fÜm
['¡©us'][
$key
]);

2056 
$¡©us
 = 
	`theme
('image', 'misc/w©chdog-”rÜ.²g', 
	`t
('incompatible'),('Incompatible withhis version of PHP'));

2057 
$php_»quœed
 = 
$fÜm
['¡©us']['#šcom·tibË_moduËs_php'][
$key
];

2058 ià(
	`sub¡r_couÁ
(
$php_»quœed
, '.') < 2) {

2059 
$php_»quœed
 .= '.*';

2061 
$desütiÚ
 .ğ'<div cÏss="šcom·tibË">'. 
	`t
('Thi moduË„equœe PHP v”siÚ @php_»quœed‡nd i šcom·tibË w™h PHP v”siÚ !php_v”siÚ.', 
	`¬¿y
('@php_»quœed' => 
$php_»quœed
, '!php_v”siÚ' => 
	`phpv”siÚ
())) .'</div>';

2064 
$¡©us
 = 
	`dru·l_»nd”
(
$fÜm
['¡©us'][
$key
]);

2066 
$row
[] = 
	`¬¿y
('d©a' => 
$¡©us
, 'class' => 'checkbox');

2067 ià(
	`moduË_exi¡s
('throttle')) {

2068 
$row
[] = 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
['thrÙe'][
$key
]), 'class' => 'checkbox');

2072 ià(
	`is£t
(
$fÜm
['¡©us'][
$key
])) {

2073 
$row
[] = '<¡rÚg><Ïb– fÜ="'. 
$fÜm
['¡©us'][
$key
]['#id'] .'">'. 
	`dru·l_»nd”
($form['name'][$key]) .'</label></strong>';

2076 
$row
[] = '<¡rÚg>'. 
	`dru·l_»nd”
(
$fÜm
['Çme'][
$key
]) .'</strong>';

2079 
$row
[] = 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
['v”siÚ'][
$key
]), 'class' => 'version');

2080 
$row
[] = 
	`¬¿y
('d©a' => 
$desütiÚ
, 'class' => 'description');

2081 
$rows
[] = 
$row
;

2083 
$f›ld£t
 = 
	`¬¿y
(

2084 '#t™Ë' => 
	`t
(
$·ckage
),

2085 '#cŞÏpsibË' => 
TRUE
,

2086 '#cŞÏp£d' => (
$·ckage
 == 'Core -„equired'),

2087 '#v®ue' => 
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('class' => 'package')),

2089 
$ouut
 .ğ
	`theme
('f›ld£t', 
$f›ld£t
);

2092 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

2093  
$ouut
;

2094 
	}
}

2105 
funùiÚ
 
	$theme_sy¡em_moduËs_unš¡®l
(
$fÜm
) {

2107 ià(
	`is£t
(
$fÜm
['confirm'])) {

2108  
	`dru·l_»nd”
(
$fÜm
);

2112 
$h—d”
 = 
	`¬¿y
(
	`t
('Uninstall'),

2113 
	`t
('Name'),

2114 
	`t
('Description'),

2118 
$rows
 = 
	`¬¿y
();

2119 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['moduËs']è
as
 
$moduË
) {

2120 
$rows
[] = 
	`¬¿y
(

2121 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
['unš¡®l'][
$moduË
]), 'align' => 'center'),

2122 '<¡rÚg>'. 
	`dru·l_»nd”
(
$fÜm
['moduËs'][
$moduË
]['name']) .'</strong>',

2123 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
['moduËs'][
$moduË
]['description']), 'class' => 'description'),

2128 ià(
	`em±y
(
$rows
)) {

2129 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No modules‡re‡vailableo uninstall.'), 'colspan' => '3', 'align' => 'center', 'class' => 'message'));

2132 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

2133 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

2135  
$ouut
;

2136 
	}
}

2144 
funùiÚ
 
	$theme_sy¡em_theme_£Ëù_fÜm
(
$fÜm
) {

2145 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$key
) {

2146 
$row
 = 
	`¬¿y
();

2147 ià(
	`is£t
(
$fÜm
[
$key
]['desütiÚ']è&& 
	`is_¬¿y
($form[$key]['description'])) {

2148 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
[
$key
]['screenshot']);

2149 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
[
$key
]['description']);

2150 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['theme'][
$key
]);

2152 
$rows
[] = 
$row
;

2155 
$h—d”
 = 
	`¬¿y
(
	`t
('Screenshot'),('Name'),('Selected'));

2156 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

2157  
$ouut
;

2158 
	}
}

2167 
funùiÚ
 
	$theme_sy¡em_themes_fÜm
(
$fÜm
) {

2168 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$key
) {

2170 ià(!
	`is£t
(
$fÜm
[
$key
]['info'])) {

2175 
$šfo
 = 
$fÜm
[
$key
]['info']['#value'];

2177 
$desütiÚ
 = 
	`t
(
$šfo
['description']);

2179 ià(
	`is£t
(
$fÜm
['¡©us']['#šcom·tibË_themes_cÜe'][
$key
])) {

2180 
	`un£t
(
$fÜm
['¡©us'][
$key
]);

2181 
$¡©us
 = 
	`theme
('image', 'misc/w©chdog-”rÜ.²g', 
	`t
('incompatible'),('Incompatible withhis version of Drupal core'));

2182 
$desütiÚ
 .ğ'<div cÏss="šcom·tibË">'. 
	`t
('Thi v”siÚ i šcom·tibË w™hh!cÜe_v”siÚ v”siÚ oàDru·ÈcÜe.', 
	`¬¿y
('!cÜe_v”siÚ' => 
VERSION
)) .'</div>';

2184 
	`–£if
 (
	`is£t
(
$fÜm
['¡©us']['#šcom·tibË_themes_php'][
$key
])) {

2185 
	`un£t
(
$fÜm
['¡©us'][
$key
]);

2186 
$¡©us
 = 
	`theme
('image', 'misc/w©chdog-”rÜ.²g', 
	`t
('incompatible'),('Incompatible withhis version of PHP'));

2187 
$php_»quœed
 = 
$fÜm
['¡©us']['#šcom·tibË_themes_php'][
$key
];

2188 ià(
	`sub¡r_couÁ
(
$php_»quœed
, '.') < 2) {

2189 
$php_»quœed
 .= '.*';

2191 
$desütiÚ
 .ğ'<div cÏss="šcom·tibË">'. 
	`t
('Thi them»quœe PHP v”siÚ @php_»quœed‡nd i šcom·tibË w™h PHP v”siÚ !php_v”siÚ.', 
	`¬¿y
('@php_»quœed' => 
$php_»quœed
, '!php_v”siÚ' => 
	`phpv”siÚ
())) .'</div>';

2194 
$¡©us
 = 
	`dru·l_»nd”
(
$fÜm
['¡©us'][
$key
]);

2198 
$theme
 = '<div cÏss="theme-šfo"><h2>'. 
$šfo
['Çme'] .'</h2><div cÏss="desütiÚ">'. 
$desütiÚ
 .'</div></div>';

2201 
$row
 = 
	`¬¿y
();

2202 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
[
$key
]['screenshot']);

2203 
$row
[] = 
$theme
;

2204 
$row
[] = 
	`is£t
(
$šfo
['version']) ? $info['version'] : '';

2205 
$row
[] = 
	`¬¿y
('d©a' => 
$¡©us
, 'align' => 'center');

2206 ià(
$fÜm
['theme_default']) {

2207 
$row
[] = 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
['theme_deçuÉ'][
$key
]), 'align' => 'center');

2208 
$row
[] = 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
[
$key
]['operations']), 'align' => 'center');

2210 
$rows
[] = 
$row
;

2213 
$h—d”
 = 
	`¬¿y
(
	`t
('Screenshot'),('Name'),('Version'),('Enabled'),('Default'),('Operations'));

2214 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

2215 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

2216  
$ouut
;

2217 
	}
}

	@/srv/http/subs/notes/www/modules/system/system.module

1 <?
php


12 
defše
('VERSION', '6.19');

17 
defše
('DRUPAL_CORE_COMPATIBILITY', '6.x');

22 
defše
('DRUPAL_MINIMUM_PHP', '4.3.5');

27 
defše
('DRUPAL_MINIMUM_PHP_MEMORY_LIMIT', '16M');

32 
defše
('DRUPAL_MINIMUM_MYSQL', '4.1.1');

37 
defše
('DRUPAL_MINIMUM_PGSQL', '7.4');

42 
defše
('DRUPAL_MAXIMUM_TEMP_FILE_AGE', 21600);

47 
funùiÚ
 
	$sy¡em_h–p
(
$·th
, 
$¬g
) {

48 
glob®
 
$ba£_u¾
;

50 
$·th
) {

52 
$ouut
 = '<p>'. 
	`t
('The system module is‡the foundation of your Drupal website,‡nd…rovides basic butƒxtensible functionality for use by other modules‡ndhemes. Some integralƒlements of Drupal‡re contained in‡nd managed byhe system module, including caching,ƒnabling or disabling of modules‡ndhemes,…reparing‡nd displayinghe‡dministrative…age,‡nd configuring fundamental site settings. A‚umber of key system maintenance operations‡re‡lso…art ofhe system module.') .'</p>';

53 
$ouut
 .ğ'<p>'. 
	`t
('The system module…rovides:') .'</p>';

54 
$ouut
 .ğ'<ul><li>'. 
	`t
('suµÜˆfÜƒÇblšg‡nd di§blšg <¨h»f="@moduËs">moduËs</a>. Dru·Ècome ·ckaged w™h‡‚umb” oàcÜmoduËs;ƒach moduË…rovide ¨disü‘£ˆoàã©u» ªd may b’abËd d•’dšg oÀthÃed oàyou¸s™e. A wid¬¿y oàadd™iÚ® moduË cÚŒibu‹d by memb” oàthDru·Ècommun™y‡»‡vaabË fÜ dowÆßd‡ˆth<¨h»f="@dru·l-moduËs">Dru·l.Üg moduË…age</a>.', 
	`¬¿y
('@moduËs' => 
	`u¾
('admin/build/modules'), '@drupal-modules' => 'http://drupal.org/project/modules')) .'</li>';

55 
$ouut
 .ğ'<li>'. 
	`t
('suµÜˆfÜƒÇblšg‡nd di§blšg <¨h»f="@themes">themes</a>, which d‘”mšthdesigÀªd…»£Á©iÚ oàyou¸s™e. Dru·Ècome ·ckaged w™h sev”® cÜtheme ªd‡dd™iÚ® cÚŒibu‹dheme ¬avaabË‡ˆth<¨h»f="@dru·l-themes">Dru·l.Üghem·ge</a>.', 
	`¬¿y
('@themes' => 
	`u¾
('admin/build/themes'), '@drupal-themes' => 'http://drupal.org/project/themes')) .'</li>';

56 
$ouut
 .ğ'<li>'. 
	`t
('¨robu¡ <¨h»f="@ÿche-£‰šgs">ÿchšg sy¡em</a>h©‡Îow theffic›Á„e-u£ oà´eviou¦y-cÚ¡ruùed web…age ªd web…agcompÚ’ts. Dru·È¡Üe th·ge »que¡ed by‡nÚymou u£r š‡ com´es£d fÜm©; d•’dšg oÀyou¸s™cÚfigu¿tiÚ‡ndhamouÁ oàyou¸web¿ffiøt›dØªÚymou vis™Üs, Dru·l\' ÿchšg sy¡em may signifiÿÁly inü—£h¥“d oàyou¸s™e.', 
	`¬¿y
('@ÿche-£‰šgs' => 
	`u¾
('admin/settings/performance'))) .'</li>';

57 
$ouut
 .ğ'<li>'. 
	`t
('¨£ˆoàroutšadmši¡¿tivİ”©iÚ th©„–y oÀ¨cÜ»ùly-cÚfigu»d <¨h»f="@üÚ">üÚ maš‹Çnûask</a>ØruÀautom©iÿÎy. A‚umb” oàÙh” moduËs, inşudšghãed‡gg»g©Ü,…šg moduË‡nd s—rch‡lsØ»ly oÀ<¨h»f="@üÚ">üÚ maš‹Çnûasks</a>. FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@hªdbook">cÚfiguršg crÚ jobs</a>.', 
	`¬¿y
('@üÚ' => 
	`u¾
('admin/reports/status'), '@handbook' => 'http://drupal.org/cron')) .'</li>';

58 
$ouut
 .ğ'<li>'. 
	`t
('basiøcÚfigu¿tiÚ o±iÚ fÜ you¸s™e, inşudšg <¨h»f="@d©e-£‰šgs">d©ªdim£‰šgs</a>, <¨h»f="@fe-sy¡em">fsy¡em s‘tšgs</a>, <¨h»f="@ş—n-u¾">ş—ÀURL suµÜt</a>, <¨h»f="@s™e-šfo">s™Çmªd oth” infÜm©iÚ</a>,‡nd‡ <¨h»f="@s™e-maš‹Çnû">s™maš‹Çnû</a> funùiÚ fÜakšg you¸s™‹mpÜ¬y off-lše.', 
	`¬¿y
('@d©e-£‰šgs' => 
	`u¾
('admin/settings/date-time'), '@file-system' => url('admin/settings/file-system'), '@clean-url' => url('admin/settings/clean-urls'), '@site-info' => url('admin/settings/site-information'), '@site-maintenance' => url('admin/settings/site-maintenance'))) .'</li></ul>';

59 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@sy¡em">Sy¡em moduË</a>.', 
	`¬¿y
('@system' => 'http://drupal.org/handbook/modules/system/')) .'</p>';

60  
$ouut
;

62  '<p>'. 
	`t
('Welcomeohe‡dministration section. Here you may control how your site functions.') .'</p>';

64  '<p>'. 
	`t
('This…age shows you‡ll‡vailable‡dministrationasks forƒach module.') .'</p>';

66 
$ouut
 = '<p>'. 
	`t
('Select whichhemes‡re‡vailableo your users‡nd specifyhe defaultheme. To configure site-wide display settings, clickhe "configure"ask‡bove. Alternatively,o overridehese settings in‡ specificheme, clickhe "configure"†ink forhatheme. Notehat differenthemes may have different„egions‡vailable for displaying content; for consistency in…resentation, you may wishoƒnable only oneheme.') .'</p>';

67 
$ouut
 .ğ'<p>'. 
	`t
('TØchªgth­³¬ªû oàyou¸s™e,‡‚umb” oà<¨h»f="@themes">cÚŒibu‹dhemes</a>‡»‡vaabË.', 
	`¬¿y
('@themes' => 'http://drupal.org/project/themes')) .'</p>';

68  
$ouut
;

69 'admš/bud/themes/£‰šgs/'. 
$¬g
[4]:

70 
$»ã»nû
 = 
	`ex¶ode
('.', 
$¬g
[4], 2);

71 
$theme
 = 
	`¬¿y_pİ
(
$»ã»nû
);

72  '<p>'. 
	`t
('The£ o±iÚ cÚŒŞhdi¥Ïy s‘tšg fÜh<code>%‹m¶©e</code>heme. Wh’ you¸s™i di¥Ïyed usšghi theme,he£ s‘tšg wÈbu£d. By clickšg "Re£ˆtØdeçuÉs," you cª choo£Øu£h<¨h»f="@glob®">glob® s‘tšgs</a> fÜhi theme.', 
	`¬¿y
('%‹m¶©e' => 
$theme
, '@glob®' => 
	`u¾
('admin/build/themes/settings'))) .'</p>';

74  '<p>'. 
	`t
('These options controlhe default display settings for yourƒntire site,‡cross‡llhemes. Unlesshey have been overridden by‡ specificheme,hese settings will be used.') .'</p>';

76 
$ouut
 = '<p>'. 
	`t
('ModuË ¬¶ugš th©ƒx‹nd Dru·l\' cÜfunùiÚ®™y. EÇbË moduË by s–eùšgh<em>EÇbËd</em> checkboxe b–ow‡nd clickšgh<em>SavcÚfigu¿tiÚ</em> bu‰Ú. Onû‡ moduË i ’abËd,‚ew <¨h»f="@³rmissiÚs">³rmissiÚs</a> may bavaabË. TØ»duû s”v”†ßd, moduË w™hheœ <em>ThrÙe</em> checkbox s–eùed‡»empÜ¬y di§bËd wh’ you¸s™become exŒem–y busy. (NÙth©h<em>ThrÙe</em> checkbox i Úly‡vaabË iàthThrÙmoduË i ’abËd.)', 
	`¬¿y
('@³rmissiÚs' => 
	`u¾
('admin/user/permissions')));

77 ià(
	`moduË_exi¡s
('throttle')) {

78 
$ouut
 .ğ' '. 
	`t
('Thauto-thrÙfunùiÚ®™y mu¡ b’abËd oÀth<¨h»f="@thrÙe">thrÙcÚfigu¿tiÚ…age</a>‡á” havšgƒÇbËdhthrÙmoduË.', 
	`¬¿y
('@thrÙe' => 
	`u¾
('admin/settings/throttle')));

80 
$ouut
 .= '</p>';

81 
$ouut
 .ğ'<p>'. 
	`t
('Iˆi impÜÁh© <¨h»f="@upd©e-php">upd©e.php</a> i ruÀev”yim¨moduË i upd©edØ¨Ãw” v”siÚ.', 
	`¬¿y
('@upd©e-php' => 
$ba£_u¾
 .'/update.php')) .'</p>';

82 
$ouut
 .ğ'<p>'. 
	`t
('You cª fšd‡Î‡dmši¡¿tiÚask b–ÚgšgØ¨·¹icuÏ¸moduË oÀth<¨h»f="@by-moduË">admši¡¿tiÚ by moduË…age</a>.', 
	`¬¿y
('@by-moduË' => 
	`u¾
('admin/by-module'))) .'</p>';

83 
$ouut
 .ğ'<p>'. 
	`t
('TØex‹ndhfunùiÚ®™y oàyou¸s™e,‡‚umb” oà<¨h»f="@moduËs">cÚŒibu‹d moduËs</a>‡»‡vaabË.', 
	`¬¿y
('@modules' => 'http://drupal.org/project/modules')) .'</p>';

84 
$ouut
 .ğ'<p>'. 
	`t
('TØş—¸®Èÿches, clickhbu‰Ú oÀth<¨h»f="@³rfÜmªû">P”fÜmªû…age</a>.', 
	`¬¿y
('@³rfÜmªû' => 
	`u¾
('admin/settings/performance',‡rray('fragment' => 'edit-clear')))) .'</p>';

85  
$ouut
;

87  '<p>'. 
	`t
('The uninstall…rocess„emoves‡ll data„elatedo‡ module. To uninstall‡ module, you must first disable it. Not‡ll modules supporthis feature.') .'</p>';

89 ià(
$¬g
[4] == 'system' && $arg[5] == 0) {

90  '<p>'. 
	`t
('The <em>Powered by Drupal</em> block is‡n optional†inkohe home…age ofhe Drupal…roject. Whilehere is‡bsolutely‚o„equirementhat sites featurehis†ink, it may be usedo show support for Drupal.') .'</p>';

95 
$ouut
 = '<p>'. 
	`t
('Actions‡re individualaskshathe system can do, such‡s unpublishing‡…iece of content or banning‡ user. Modules, such‡sherigger module, can firehese‡ctions when certain systemƒvents happen; forƒxample, when‡‚ew…ost is‡dded or when‡ user†ogs in. Modules may‡lso…rovide‡dditional‡ctions.') .'</p>';

96 
$ouut
 .ğ'<p>'. 
	`t
('There‡rewoypes of‡ctions: simple‡nd‡dvanced. Simple‡ctions do‚ot„equire‡ny‡dditional configuration,‡nd‡re†isted here‡utomatically. Advanced‡ctions can do morehan simple‡ctions; forƒxample, send‡nƒ-mailo‡ specified‡ddress, or check for certain words within‡…iece of content. These‡ctions‚eedo be created‡nd configured first beforehey may be used. To create‡n‡dvanced‡ction, selecthe‡ction fromhe drop-down below‡nd clickhe <em>Create</em> button.') .'</p>';

97 ià(
	`moduË_exi¡s
('trigger')) {

98 
$ouut
 .ğ'<p>'. 
	`t
('You may…roûedØth<¨h»f="@u¾">Trigg”s</a>…agtØassigÀthe£‡ùiÚ tØsy¡emƒv’ts.', 
	`¬¿y
('@u¾' => 
	`u¾
('admin/build/trigger'))) .'</p>';

100  
$ouut
;

102  
	`t
('An‡dvanced‡ction offers‡dditional configuration options which may be filled out below. Changinghe <em>Description</em> field is„ecommended, in ordero better identifyhe…recise‡ctionaking…lace. This description will be displayed in modules such‡sherigger module when‡ssigning‡ctionso systemƒvents, so it is best if it is‡s descriptive‡s…ossible (forƒxample, "Sendƒ-mailo Moderation Team"„atherhan simply "Sendƒ-mail").');

104  '<p>'. 
	`t
("Here you can find‡ short overview of your site's…arameters‡s well‡s‡ny…roblems detected with your installation. It may be usefulo copy‡nd…astehis information into support„equests filed on drupal.org's support forums‡nd…roject issue queues.") .'</p>';

106 
	}
}

111 
funùiÚ
 
	$sy¡em_theme
() {

112  
	`¬¿y_m”ge
(
	`dru·l_commÚ_theme
(), 
	`¬¿y
(

113 'sy¡em_theme_£Ëù_fÜm' => 
	`¬¿y
(

114 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

117 'sy¡em_themes_fÜm' => 
	`¬¿y
(

118 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

121 'sy¡em_moduËs' => 
	`¬¿y
(

122 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

125 'sy¡em_moduËs_unš¡®l' => 
	`¬¿y
(

126 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

129 '¡©us_»pÜt' => 
	`¬¿y
(

130 '¬gum’ts' => 
	`¬¿y
('»quœem’ts' => 
NULL
),

133 'admš_·ge' => 
	`¬¿y
(

134 '¬gum’ts' => 
	`¬¿y
('blocks' => 
NULL
),

137 'admš_block' => 
	`¬¿y
(

138 '¬gum’ts' => 
	`¬¿y
('block' => 
NULL
),

141 'admš_block_cÚ‹Á' => 
	`¬¿y
(

142 '¬gum’ts' => 
	`¬¿y
('cÚ‹Á' => 
NULL
),

145 'sy¡em_admš_by_moduË' => 
	`¬¿y
(

146 '¬gum’ts' => 
	`¬¿y
('m’u_™ems' => 
NULL
),

149 'sy¡em_pow”ed_by' => 
	`¬¿y
(

150 '¬gum’ts' => 
	`¬¿y
('image_·th' => 
NULL
),

153 
	}
}

158 
funùiÚ
 
	$sy¡em_³rm
() {

159  
	`¬¿y
('administer site configuration', 'access‡dministration…ages', 'administer‡ctions', 'access site„eports', 'select differentheme', 'administer files');

160 
	}
}

165 
funùiÚ
 
	$sy¡em_–em’ts
() {

167 
$ty³
['fÜm'] = 
	`¬¿y
('#m‘hod' => 'po¡', '#aùiÚ' => 
	`»que¡_uri
());

170 
$ty³
['subm™'] = 
	`¬¿y
('#šput' => 
TRUE
, '#name' => 'op', '#button_type' => 'submit', '#executes_submit_callback' => TRUE, '#process' =>‡rray('form_expand_ahah'));

171 
$ty³
['bu‰Ú'] = 
	`¬¿y
('#šput' => 
TRUE
, '#Çme' => 'İ', '#bu‰Ú_ty³' => 'subm™', '#execu‹s_subm™_ÿÎback' => 
FALSE
, '#process' =>‡rray('form_expand_ahah'));

172 
$ty³
['image_bu‰Ú'] = 
	`¬¿y
('#šput' => 
TRUE
, '#bu‰Ú_ty³' => 'subm™', '#execu‹s_subm™_ÿÎback' => TRUE, '#´oûss' =>‡¼ay('fÜm_ex·nd_ahah'), '#»tuº_v®ue' => TRUE, '#has_g¬bage_v®ue' => TRUE, '#¤c' => 
NULL
);

173 
$ty³
['‹xtf›ld'] = 
	`¬¿y
('#šput' => 
TRUE
, '#size' => 60, '#maxËngth' => 128, '#autocom¶‘e_·th' => 
FALSE
, '#process' =>‡rray('form_expand_ahah'));

174 
$ty³
['·sswÜd'] = 
	`¬¿y
('#šput' => 
TRUE
, '#size' => 60, '#maxlength' => 128, '#process' =>‡rray('form_expand_ahah'));

175 
$ty³
['·sswÜd_cÚfœm'] = 
	`¬¿y
('#šput' => 
TRUE
, '#process' =>‡rray('expand_password_confirm'));

176 
$ty³
['‹x»a'] = 
	`¬¿y
('#šput' => 
TRUE
, '#cols' => 60, '#rows' => 5, '#resizable' => TRUE, '#process' =>‡rray('form_expand_ahah'));

177 
$ty³
['¿dios'] = 
	`¬¿y
('#šput' => 
TRUE
, '#process' =>‡rray('expand_radios'));

178 
$ty³
['¿dio'] = 
	`¬¿y
('#šput' => 
TRUE
, '#deçuÉ_v®ue' => 
NULL
, '#process' =>‡rray('form_expand_ahah'));

179 
$ty³
['checkboxes'] = 
	`¬¿y
('#šput' => 
TRUE
, '#process' =>‡rray('expand_checkboxes'), '#tree' => TRUE);

180 
$ty³
['checkbox'] = 
	`¬¿y
('#šput' => 
TRUE
, '#return_value' => 1, '#process' =>‡rray('form_expand_ahah'));

181 
$ty³
['£Ëù'] = 
	`¬¿y
('#šput' => 
TRUE
, '#size' => 0, '#muÉË' => 
FALSE
, '#process' =>‡rray('form_expand_ahah'));

182 
$ty³
['weight'] = 
	`¬¿y
('#šput' => 
TRUE
, '#delta' => 10, '#default_value' => 0, '#process' =>‡rray('process_weight', 'form_expand_ahah'));

183 
$ty³
['d©e'] = 
	`¬¿y
('#šput' => 
TRUE
, '#process' =>‡rray('expand_date'), '#element_validate' =>‡rray('date_validate'));

184 
$ty³
['fe'] = 
	`¬¿y
('#šput' => 
TRUE
, '#size' => 60);

187 
$ty³
['™em'] = 
	`¬¿y
('#value' => '');

188 
$ty³
['hidd’'] = 
	`¬¿y
('#šput' => 
TRUE
, '#process' =>‡rray('form_expand_ahah'));

189 
$ty³
['v®ue'] = 
	`¬¿y
('#šput' => 
TRUE
);

190 
$ty³
['m¬kup'] = 
	`¬¿y
('#prefix' => '', '#suffix' => '');

191 
$ty³
['f›ld£t'] = 
	`¬¿y
('#cŞÏpsibË' => 
FALSE
, '#cŞÏp£d' => FALSE, '#v®ue' => 
NULL
, '#process' =>‡rray('form_expand_ahah'));

192 
$ty³
['tok’'] = 
	`¬¿y
('#šput' => 
TRUE
);

193  
$ty³
;

194 
	}
}

199 
funùiÚ
 
	$sy¡em_m’u
() {

200 
$™ems
['sy¡em/fes'] = 
	`¬¿y
(

203 'acûs ÿÎback' => 
TRUE
,

204 'ty³' => 
MENU_CALLBACK
,

206 
$™ems
['admš'] = 
	`¬¿y
(

208 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

213 
$™ems
['admš/com·ù'] = 
	`¬¿y
(

216 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

217 'ty³' => 
MENU_CALLBACK
,

220 
$™ems
['admš/by-sk'] = 
	`¬¿y
(

223 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

225 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

227 
$™ems
['admš/by-moduË'] = 
	`¬¿y
(

230 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

232 'ty³' => 
MENU_LOCAL_TASK
,

235 
$™ems
['admš/cÚ‹Á'] = 
	`¬¿y
(

241 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

246 
$™ems
['admš/£‰šgs'] = 
	`¬¿y
(

252 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

255 
$™ems
['admš/bud'] = 
	`¬¿y
(

261 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

264 
$™ems
['admš/£‰šgs/admš'] = 
	`¬¿y
(

269 '·g¬gum’ts' => 
	`¬¿y
('system_admin_theme_settings'),

270 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

275 
$™ems
['admš/bud/themes'] = 
	`¬¿y
(

279 '·g¬gum’ts' => 
	`¬¿y
('sy¡em_themes_fÜm', 
NULL
),

280 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

283 
$™ems
['admš/bud/themes/£Ëù'] = 
	`¬¿y
(

286 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

289 
$™ems
['admš/bud/themes/£‰šgs'] = 
	`¬¿y
(

291 '·g¬gum’ts' => 
	`¬¿y
('system_theme_settings'),

292 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

293 'ty³' => 
MENU_LOCAL_TASK
,

296 
$™ems
['admš/bud/themes/£‰šgs/glob®'] = 
	`¬¿y
(

298 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

302 
	`fÜ—ch
 (
	`li¡_themes
(è
as
 
$theme
) {

303 
$™ems
['admš/bud/themes/£‰šgs/'. 
$theme
->
Çme
] = 
	`¬¿y
(

304 't™Ë' => 
$theme
->
šfo
['name'],

305 '·g¬gum’ts' => 
	`¬¿y
('sy¡em_theme_£‰šgs', 
$theme
->
Çme
),

306 'ty³' => 
MENU_LOCAL_TASK
,

308 'acûs ¬gum’ts' => 
	`¬¿y
(
$theme
),

313 
$™ems
['admš/bud/moduËs'] = 
	`¬¿y
(

317 '·g¬gum’ts' => 
	`¬¿y
('system_modules'),

318 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

321 
$™ems
['admš/bud/moduËs/li¡'] = 
	`¬¿y
(

323 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

325 
$™ems
['admš/bud/moduËs/li¡/cÚfœm'] = 
	`¬¿y
(

327 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

328 'ty³' => 
MENU_CALLBACK
,

330 
$™ems
['admš/bud/moduËs/unš¡®l'] = 
	`¬¿y
(

332 '·g¬gum’ts' => 
	`¬¿y
('system_modules_uninstall'),

333 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

334 'ty³' => 
MENU_LOCAL_TASK
,

336 
$™ems
['admš/bud/moduËs/unš¡®l/cÚfœm'] = 
	`¬¿y
(

338 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

339 'ty³' => 
MENU_CALLBACK
,

343 
$™ems
['admš/£‰šgs/aùiÚs'] = 
	`¬¿y
(

346 'acûs ¬gum’ts' => 
	`¬¿y
('administer‡ctions'),

349 
$™ems
['admš/£‰šgs/aùiÚs/mªage'] = 
	`¬¿y
(

353 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

356 
$™ems
['admš/£‰šgs/aùiÚs/cÚfigu»'] = 
	`¬¿y
(

359 '·g¬gum’ts' => 
	`¬¿y
('system_actions_configure'),

360 'acûs ¬gum’ts' => 
	`¬¿y
('administer‡ctions'),

361 'ty³' => 
MENU_CALLBACK
,

363 
$™ems
['admš/£‰šgs/aùiÚs/d–‘e/%aùiÚs'] = 
	`¬¿y
(

367 '·g¬gum’ts' => 
	`¬¿y
('system_actions_delete_form', 4),

368 'acûs ¬gum’ts' => 
	`¬¿y
('administer‡ctions'),

369 'ty³' => 
MENU_CALLBACK
,

371 
$™ems
['admš/£‰šgs/aùiÚs/Üphª'] = 
	`¬¿y
(

374 'acûs ¬gum’ts' => 
	`¬¿y
('administer‡ctions'),

375 'ty³' => 
MENU_CALLBACK
,

379 
$™ems
['admš/£‰šgs/s™e-šfÜm©iÚ'] = 
	`¬¿y
(

383 '·g¬gum’ts' => 
	`¬¿y
('system_site_information_settings'),

384 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

387 
$™ems
['admš/£‰šgs/”rÜ-»pÜtšg'] = 
	`¬¿y
(

391 '·g¬gum’ts' => 
	`¬¿y
('system_error_reporting_settings'),

392 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

395 
$™ems
['admš/£‰šgs/loggšg'] = 
	`¬¿y
(

399 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

402 
$™ems
['admš/£‰šgs/³rfÜmªû'] = 
	`¬¿y
(

406 '·g¬gum’ts' => 
	`¬¿y
('system_performance_settings'),

407 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

410 
$™ems
['admš/£‰šgs/fe-sy¡em'] = 
	`¬¿y
(

414 '·g¬gum’ts' => 
	`¬¿y
('system_file_system_settings'),

415 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

418 
$™ems
['admš/£‰šgs/image-toŞk™'] = 
	`¬¿y
(

422 '·g¬gum’ts' => 
	`¬¿y
('system_image_toolkit_settings'),

423 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

426 
$™ems
['admš/cÚ‹Á/rss-publishšg'] = 
	`¬¿y
(

430 '·g¬gum’ts' => 
	`¬¿y
('system_rss_feeds_settings'),

431 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

434 
$™ems
['admš/£‰šgs/d©e-time'] = 
	`¬¿y
(

438 '·g¬gum’ts' => 
	`¬¿y
('system_date_time_settings'),

439 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

442 
$™ems
['admš/£‰šgs/d©e-time/lookup'] = 
	`¬¿y
(

444 'ty³' => 
MENU_CALLBACK
,

446 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

449 
$™ems
['admš/£‰šgs/s™e-maš‹Çnû'] = 
	`¬¿y
(

453 '·g¬gum’ts' => 
	`¬¿y
('system_site_maintenance_settings'),

454 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

457 
$™ems
['admš/£‰šgs/ş—n-u¾s'] = 
	`¬¿y
(

461 '·g¬gum’ts' => 
	`¬¿y
('system_clean_url_settings'),

462 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

465 
$™ems
['admš/£‰šgs/ş—n-u¾s/check'] = 
	`¬¿y
(

468 '·g¬gum’ts' => 
	`¬¿y
×¼ay('¡©us' => 
TRUE
)),

469 'acûs ÿÎback' => 
TRUE
,

470 'ty³' => 
MENU_CALLBACK
,

474 
$™ems
['admš/»pÜts'] = 
	`¬¿y
(

478 'acûs ¬gum’ts' => 
	`¬¿y
('access site„eports'),

483 
$™ems
['admš/»pÜts/¡©us'] = 
	`¬¿y
(

488 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

491 
$™ems
['admš/»pÜts/¡©us/run-üÚ'] = 
	`¬¿y
(

494 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

495 'ty³' => 
MENU_CALLBACK
,

498 
$™ems
['admš/»pÜts/¡©us/php'] = 
	`¬¿y
(

501 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

502 'ty³' => 
MENU_CALLBACK
,

505 
$™ems
['admš/»pÜts/¡©us/sql'] = 
	`¬¿y
(

508 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

509 'ty³' => 
MENU_CALLBACK
,

513 
$™ems
['b©ch'] = 
	`¬¿y
(

515 'acûs ÿÎback' => 
TRUE
,

516 'ty³' => 
MENU_CALLBACK
,

519  
$™ems
;

520 
	}
}

525 
funùiÚ
 
	$_sy¡em_themes_acûss
(
$theme
) {

526  
	`u£r_acûss
('admši¡” s™cÚfigu¿tiÚ'è&& (
$theme
->
¡©us
 || $theme->
Çme
 =ğ
	`v¬ŸbË_g‘
('admin_theme', '0'));

527 
	}
}

532 
funùiÚ
 
	$sy¡em_š™
() {

534 ià(
	`¬g
(0è=ğ'admš' || (
	`v¬ŸbË_g‘
('node_admin_theme', '0') &&‡rg(0) == 'node' && (arg(1) == 'add' ||‡rg(2) == 'edit'))) {

535 
glob®
 
$cu¡om_theme
;

536 
$cu¡om_theme
 = 
	`v¬ŸbË_g‘
('admin_theme', '0');

537 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'system') .'/admin.css', 'module');

541 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'system') .'/defaults.css', 'module');

542 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'system') .'/system.css', 'module');

543 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'system') .'/system-menus.css', 'module');

544 
	}
}

551 
funùiÚ
 
	$sy¡em_u£r
(
$ty³
, 
$ed™
, &
$u£r
, 
$ÿ‹gÜy
 = 
NULL
) {

552 ià(
$ty³
 =ğ'fÜm' && 
$ÿ‹gÜy
 == 'account') {

553 
$fÜm
['theme_£Ëù'] = 
	`sy¡em_theme_£Ëù_fÜm
(
	`t
('S–eùšg‡ difã»ÁhemwÈchªgthlook‡nd f“Èoàths™e.'), 
	`is£t
(
$ed™
['theme']è? $ed™['theme'] : 
NULL
, 2);

555 ià(
	`v¬ŸbË_g‘
('configurable_timezones', 1)) {

556 
$zÚes
 = 
	`_sy¡em_zÚ–i¡
();

557 
$fÜm
['timezÚe'] = 
	`¬¿y
(

559 '#t™Ë' => 
	`t
('Locale settings'),

561 '#cŞÏpsibË' => 
TRUE
,

563 
$fÜm
['timezÚe']['timezÚe'] = 
	`¬¿y
(

565 '#t™Ë' => 
	`t
('Time zone'),

566 '#deçuÉ_v®ue' => 
	`¡¾’
(
$ed™
['timezÚe']è? $ed™['timezÚe'] : 
	`v¬ŸbË_g‘
('date_default_timezone', 0),

567 '#İtiÚs' => 
$zÚes
,

568 '#desütiÚ' => 
	`t
('Select your current†ocalime. Dates‡ndimeshroughouthis site will be displayed usinghisime zone.'),

572  
$fÜm
;

574 
	}
}

581 
funùiÚ
 
sy¡em_block
(
$İ
 = 'li¡', 
$d–
 = 0, 
$ed™
 = 
NULL
) {

582 
$İ
) {

584 
$blocks
[0] = 
¬¿y
(

585 'šfo' => 
t
('Powered by Drupal'),

588 'ÿche' => 
BLOCK_NO_CACHE
,

590  
	g$blocks
;

593 
$fÜm
['w¿µ”']['cŞÜ'] = 
¬¿y
(

595 '#t™Ë' => 
t
('Badge color'),

596 '#deçuÉ_v®ue' => 
v¬ŸbË_g‘
('drupal_badge_color', 'powered-blue'),

597 '#İtiÚs' => 
¬¿y
('pow”ed-bÏck' => 
t
('Black'), 'powered-blue' =>('Blue'), 'powered-gray' =>('Gray')),

599 
	g$fÜm
['w¿µ”']['size'] = 
¬¿y
(

601 '#t™Ë' => 
t
('Badge size'),

602 '#deçuÉ_v®ue' => 
v¬ŸbË_g‘
('drupal_badge_size', '80x15'),

603 '#İtiÚs' => 
¬¿y
('80x15' => 
t
('Small'), '88x31' =>('Medium'), '135x42' =>('Large')),

605  
	g$fÜm
;

607 
v¬ŸbË_£t
('dru·l_badge_cŞÜ', 
$ed™
['color']);

608 
v¬ŸbË_£t
('dru·l_badge_size', 
$ed™
['size']);

611 
$image_·th
 = 'misc/'. 
v¬ŸbË_g‘
('drupal_badge_color', 'powered-blue') .'-'. variable_get('drupal_badge_size', '80x15') .'.png';

612 
	g$block
['subjeù'] = 
NULL
;

613 
	g$block
['cÚ‹Á'] = 
theme
('sy¡em_pow”ed_by', 
$image_·th
);

614  
	g$block
;

624 
funùiÚ
 
	$sy¡em_admš_m’u_block
(
$™em
) {

625 
$cÚ‹Á
 = 
	`¬¿y
();

626 ià(!
	`is£t
(
$™em
['mlid'])) {

627 
$™em
 +ğ
	`db_ãtch_¬¿y
(
	`db_qu”y
("SELECT mlid, menu_name FROM {menu_links} ml WHERE ml.router_path = '%s' AND module = 'system'", $item['path']));

629 
$»suÉ
 = 
	`db_qu”y
("

630 
SELECT
 
m
.
lßd_funùiÚs
, m.
to_¬g_funùiÚs
, m.
acûss_ÿÎback
, m.
acûss_¬gum’ts
, m.
·ge_ÿÎback
, m.
·ge_¬gum’ts
, m.
t™Ë
, m.
t™Ë_ÿÎback
, m.
t™Ë_¬gum’ts
, m.
ty³
, m.
desütiÚ
, 
ml
.*

631 
FROM
 {
m’u_lšks
} 
ml


632 
LEFT
 
JOIN
 {
m’u_rou‹r
} 
m
 
ON
 
ml
.
rou‹r_·th
 = m.
·th


633 
WHERE
 
ml
.
¶id
 = %
d
 
AND
 ml.
m’u_Çme
 = '%s' AND 
hidd’
 = 0", $item['mlid'], $item['menu_name']);

634 
$™em
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

635 
	`_m’u_lšk_Œª¦©e
(
$™em
);

636 ià(!
$™em
['access']) {

641 ià(!
	`em±y
(
$™em
['localized_options']['attributes']['title'])) {

642 
$™em
['description'] = $item['localized_options']['attributes']['title'];

646 
$cÚ‹Á
[(50000 + 
$™em
['weight']è.' '. 
	`dru·l_¡¹Şow”
($item['title']) .' '. $item['mlid']] = $item;

648 
	`ksÜt
(
$cÚ‹Á
);

649  
$cÚ‹Á
;

650 
	}
}

655 
funùiÚ
 
	$sy¡em_admš_theme_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

657 ià(
$fÜm_¡©e
['v®ues']['admš_theme'] && $fÜm_¡©e['v®ues']['admš_theme'] !ğ
	`v¬ŸbË_g‘
('admin_theme', '0')) {

658 
$»suÉ
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {blocks} WHEREhemğ'%s'", 
$fÜm_¡©e
['values']['admin_theme']));

659 ià(!
$»suÉ
) {

660 
	`sy¡em_š™Ÿlize_theme_blocks
(
$fÜm_¡©e
['values']['admin_theme']);

663 
	}
}

677 
funùiÚ
 
sy¡em_theme_£Ëù_fÜm
(
$desütiÚ
 = '', 
$deçuÉ_v®ue
 = '', 
$weight
 = 0) {

678 ià(
u£r_acûss
('select differentheme')) {

679 
$’abËd
 = 
¬¿y
();

680 
	g$themes
 = 
li¡_themes
();

682 
fÜ—ch
 (
$themes
 
as
 
$theme
) {

683 ià(
	g$theme
->
	g¡©us
) {

684 
	g$’abËd
[] = 
$theme
;

688 ià(
couÁ
(
$’abËd
) > 1) {

689 
ksÜt
(
$’abËd
);

691 
	g$fÜm
['themes'] = 
¬¿y
(

693 '#t™Ë' => 
t
('Theme configuration'),

694 '#desütiÚ' => 
$desütiÚ
,

695 '#cŞÏpsibË' => 
TRUE
,

699 
fÜ—ch
 (
$’abËd
 
as
 
$šfo
) {

701 
	g$šfo
->
	gkey
 = 
$šfo
->
Çme
 =ğ
v¬ŸbË_g‘
('theme_default', 'garland') ? '' : $info->name;

703 
	g$sü“nshÙ
 = 
NULL
;

704 
	g$theme_key
 = 
$šfo
->
Çme
;

705 
	g$theme_key
) {

706 ià(
fe_exi¡s
(
$themes
[
$theme_key
]->
šfo
['screenshot'])) {

707 
	g$sü“nshÙ
 = 
$themes
[
$theme_key
]->
šfo
['screenshot'];

710 
	g$theme_key
 = 
is£t
(
$themes
[
$theme_key
]->
šfo
['ba£heme']è? $themes[$theme_key]->šfo['ba£heme'] : 
NULL
;

713 
	g$sü“nshÙ
 = 
$sü“nshÙ
 ? 
theme
('image', $sü“nshÙ, 
t
('Sü“nshÙ fÜ %themtheme', 
¬¿y
('%theme' => 
$šfo
->
Çme
)), '',‡¼ay('şass' => 'sü“nshÙ'), 
FALSE
) :('no screenshot');

715 
	g$fÜm
['themes'][
$šfo
->
key
]['sü“nshÙ'] = 
¬¿y
('#v®ue' => 
$sü“nshÙ
);

716 
	g$fÜm
['themes'][
$šfo
->
key
]['desütiÚ'] = 
¬¿y
('#ty³' => '™em', '#t™Ë' => $šfo->
Çme
, '#v®ue' => 
dœÇme
($šfo->
f’ame
è. ($šfo->Çm=ğ
v¬ŸbË_g‘
('theme_deçuÉ', 'g¬Ïnd'è? '<b¸/> <em>'. 
t
('(site defaultheme)') .'</em>' : ''));

717 
	g$İtiÚs
[
$šfo
->
key
] = '';

720 
	g$fÜm
['themes']['theme'] = 
¬¿y
('#ty³' => '¿dios', '#İtiÚs' => 
$İtiÚs
, '#deçuÉ_v®ue' => 
$deçuÉ_v®ue
 ? $default_value : '');

721 
	g$fÜm
['#weight'] = 
$weight
;

722  
	g$fÜm
;

737 
funùiÚ
 
	$sy¡em_check_dœeùÜy
(
$fÜm_–em’t
) {

738 
	`fe_check_dœeùÜy
(
$fÜm_–em’t
['#v®ue'], 
FILE_CREATE_DIRECTORY
, $form_element['#parents'][0]);

739  
$fÜm_–em’t
;

740 
	}
}

750 
funùiÚ
 
	$sy¡em_g‘_fes_d©aba£
(&
$fes
, 
$ty³
) {

752 
$»suÉ
 = 
	`db_qu”y
("SELECT f’ame,‚ame,y³, stus,hrÙe, schema_v”siÚ FROM {sy¡em} WHEREy³ = '%s'", 
$ty³
);

753 
$fe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

754 ià(
	`is£t
(
$fes
[
$fe
->
Çme
]è&& 
	`is_objeù
($files[$file->name])) {

755 
$fe
->
Şd_f’ame
 = $fe->
f’ame
;

756 
	`fÜ—ch
 (
$fe
 
as
 
$key
 => 
$v®ue
) {

757 ià(!
	`is£t
(
$fes
[
$fe
->
Çme
]è|| !is£t($fes[$fe->Çme]->
$key
)) {

758 
$fes
[
$fe
->
Çme
]->
$key
 = 
$v®ue
;

763 
	}
}

771 
funùiÚ
 
	$sy¡em_theme_deçuÉ
() {

772  
	`¬¿y
(

773 '»giÚs' => 
	`¬¿y
(

781 'ã©u»s' => 
	`¬¿y
(

793 '¡yËsh“ts' => 
	`¬¿y
(

794 '®l' => 
	`¬¿y
('style.css')

796 'süts' => 
	`¬¿y
('script.js'),

798 'php' => 
DRUPAL_MINIMUM_PHP
,

800 
	}
}

808 
funùiÚ
 
	$sy¡em_theme_d©a
() {

810 
$themes
 = 
	`_sy¡em_theme_d©a
();

813 
	`sy¡em_g‘_fes_d©aba£
(
$themes
, 'theme');

815 
	`db_qu”y
("DELETE FROM {system} WHEREype = 'theme'");

817 
	`fÜ—ch
 (
$themes
 
as
 
$theme
) {

818 ià(!
	`is£t
(
$theme
->
owÃr
)) {

819 
$theme
->
owÃr
 = '';

822 
	`db_qu”y
("INSERT INTO {sy¡em} (Çme, owÃr, info,y³, f’ame, stus,hrÙe, boÙ¡¿pèVALUES ('%s', '%s', '%s', '%s', '%s', %d, %d, %d)", 
$theme
->
Çme
, $theme->
owÃr
, 
	`£rŸlize
($theme->
šfo
), 'theme', $theme->
f’ame
, 
	`is£t
($theme->
¡©us
) ? $theme->status : 0, 0, 0);

825  
$themes
;

826 
	}
}

834 
funùiÚ
 
	$_sy¡em_theme_d©a
() {

835 
$themes_šfo
 = 
	`¬¿y
();

837 ià(
	`em±y
(
$themes_šfo
)) {

839 
$themes
 = 
	`dru·l_sy¡em_li¡šg
('\.info$', 'themes');

841 
$’gšes
 = 
	`dru·l_sy¡em_li¡šg
('\.engine$', 'themes/engines');

843 
$deçuÉs
 = 
	`sy¡em_theme_deçuÉ
();

845 
$sub_themes
 = 
	`¬¿y
();

847 
	`fÜ—ch
 (
$themes
 
as
 
$key
 => 
$theme
) {

848 
$themes
[
$key
]->
šfo
 = 
	`dru·l_·r£_šfo_fe
(
$theme
->
f’ame
è+ 
$deçuÉs
;

852 
	`dru·l_®‹r
('sy¡em_šfo', 
$themes
[
$key
]->
šfo
, $themes[$key]);

854 ià(!
	`em±y
(
$themes
[
$key
]->
šfo
['baseheme'])) {

855 
$sub_themes
[] = 
$key
;

857 ià(
	`em±y
(
$themes
[
$key
]->
šfo
['engine'])) {

858 
$f’ame
 = 
	`dœÇme
(
$themes
[
$key
]->
f’ame
è.'/'. $themes[$key]->
Çme
 .'.theme';

859 ià(
	`fe_exi¡s
(
$f’ame
)) {

860 
$themes
[
$key
]->
owÃr
 = 
$f’ame
;

861 
$themes
[
$key
]->
´efix
 = $key;

865 
$’gše
 = 
$themes
[
$key
]->
šfo
['engine'];

866 ià(
	`is£t
(
$’gšes
[
$’gše
])) {

867 
$themes
[
$key
]->
owÃr
 = 
$’gšes
[
$’gše
]->
f’ame
;

868 
$themes
[
$key
]->
´efix
 = 
$’gšes
[
$’gše
]->
Çme
;

869 
$themes
[
$key
]->
‹m¶©e
 = 
TRUE
;

874 
$·thed_¡yËsh“ts
 = 
	`¬¿y
();

875 
	`fÜ—ch
 (
$themes
[
$key
]->
šfo
['¡yËsh“ts'] 
as
 
$medŸ
 => 
$¡yËsh“ts
) {

876 
	`fÜ—ch
 (
$¡yËsh“ts
 
as
 
$¡yËsh“t
) {

877 
$·thed_¡yËsh“ts
[
$medŸ
][
$¡yËsh“t
] = 
	`dœÇme
(
$themes
[
$key
]->
f’ame
) .'/'. $stylesheet;

880 
$themes
[
$key
]->
šfo
['¡yËsh“ts'] = 
$·thed_¡yËsh“ts
;

883 
$süts
 = 
	`¬¿y
();

884 
	`fÜ—ch
 (
$themes
[
$key
]->
šfo
['süts'] 
as
 
$süt
) {

885 
$süts
[
$süt
] = 
	`dœÇme
(
$themes
[
$key
]->
f’ame
) .'/'. $script;

887 
$themes
[
$key
]->
šfo
['süts'] = 
$süts
;

889 ià(!
	`em±y
(
$themes
[
$key
]->
šfo
['screenshot'])) {

890 
$themes
[
$key
]->
šfo
['sü“nshÙ'] = 
	`dœÇme
($themes[$key]->
f’ame
) .'/'. $themes[$key]->info['screenshot'];

896 
	`fÜ—ch
 (
$sub_themes
 
as
 
$key
) {

897 
$themes
[
$key
]->
ba£_themes
 = 
	`sy¡em_fšd_ba£_themes
($themes, $key);

899 ià(!
	`cu¼’t
(
$themes
[
$key
]->
ba£_themes
)) {

902 
$ba£_key
 = 
	`key
(
$themes
[
$key
]->
ba£_themes
);

903 
	`fÜ—ch
 (
	`¬¿y_keys
(
$themes
[
$key
]->
ba£_themes
è
as
 
$ba£_theme
) {

904 
$themes
[
$ba£_theme
]->
sub_themes
[
$key
] = $themes[$key]->
šfo
['name'];

908 ià(
	`is£t
(
$themes
[
$ba£_key
]->
owÃr
)) {

909 ià(
	`is£t
(
$themes
[
$ba£_key
]->
šfo
['engine'])) {

910 
$themes
[
$key
]->
šfo
['’gše'] = $themes[
$ba£_key
]->info['engine'];

911 
$themes
[
$key
]->
owÃr
 = $themes[
$ba£_key
]->owner;

912 
$themes
[
$key
]->
´efix
 = $themes[
$ba£_key
]->prefix;

915 
$themes
[
$key
]->
´efix
 = $key;

920 
$themes_šfo
 = 
$themes
;

923  
$themes_šfo
;

924 
	}
}

941 
funùiÚ
 
sy¡em_fšd_ba£_themes
(
$themes
, 
$key
, 
$u£d_keys
 = 
	$¬¿y
()) {

942 
$ba£_key
 = 
$themes
[
$key
]->
šfo
['baseheme'];

944 ià(!
	`is£t
(
$themes
[
$ba£_key
])) {

945  
	`¬¿y
(
$ba£_key
 => 
NULL
);

948 
$cu¼’t_ba£_theme
 = 
	`¬¿y
(
$ba£_key
 => 
$themes
[$ba£_key]->
šfo
['name']);

951 ià(
	`is£t
(
$themes
[
$ba£_key
]->
šfo
['baseheme'])) {

953 ià(
	`is£t
(
$themes
[
$ba£_key
]->
ba£_themes
)) {

954  
$themes
[
$ba£_key
]->
ba£_themes
 + 
$cu¼’t_ba£_theme
;

957 ià(!
	`em±y
(
$u£d_keys
[
$ba£_key
])) {

958  
	`¬¿y
(
$ba£_key
 => 
NULL
);

960 
$u£d_keys
[
$ba£_key
] = 
TRUE
;

961  
	`sy¡em_fšd_ba£_themes
(
$themes
, 
$ba£_key
, 
$u£d_keys
è+ 
$cu¼’t_ba£_theme
;

964  
$cu¼’t_ba£_theme
;

965 
	}
}

982 
funùiÚ
 
sy¡em_fšd_ba£_theme
(
$themes
, 
$key
, 
$u£d_keys
 = 
	$¬¿y
()) {

983 
$ba£_key
 = 
$themes
[
$key
]->
šfo
['baseheme'];

985 ià(!
	`is£t
(
$themes
[
$ba£_key
])) {

986  
NULL
;

990 ià(
	`is£t
(
$themes
[
$ba£_key
]->
šfo
['baseheme'])) {

992 ià(!
	`em±y
(
$u£d_keys
[
$ba£_key
])) {

993  
NULL
;

995 
$u£d_keys
[
$ba£_key
] = 
TRUE
;

996  
	`sy¡em_fšd_ba£_theme
(
$themes
, 
$ba£_key
, 
$u£d_keys
);

999  
$ba£_key
;

1000 
	}
}

1010 
funùiÚ
 
	$sy¡em_»giÚ_li¡
(
$theme_key
) {

1011 
$li¡
 = 
	`¬¿y
();

1013 ià(!
	`¬¿y_key_exi¡s
(
$theme_key
, 
$li¡
)) {

1014 
$šfo
 = 
	`un£rŸlize
(
	`db_»suÉ
(
	`db_qu”y
("SELECT infØFROM {sy¡em} WHEREy³ = 'theme' AND‚amğ'%s'", 
$theme_key
)));

1015 
$li¡
[
$theme_key
] = 
	`¬¿y_m­
('t', 
$šfo
['regions']);

1018  
$li¡
[
$theme_key
];

1019 
	}
}

1029 
funùiÚ
 
	$sy¡em_deçuÉ_»giÚ
(
$theme
) {

1030 
$»giÚs
 = 
	`¬¿y_keys
(
	`sy¡em_»giÚ_li¡
(
$theme
));

1031  
	`is£t
(
$»giÚs
[0]) ? $regions[0] : '';

1032 
	}
}

1045 
funùiÚ
 
	$sy¡em_š™Ÿlize_theme_blocks
(
$theme
) {

1047 ià(!(
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {blocks} WHEREhemğ'%s'", 
$theme
)))) {

1048 
$deçuÉ_theme
 = 
	`v¬ŸbË_g‘
('theme_default', 'garland');

1049 
$»giÚs
 = 
	`sy¡em_»giÚ_li¡
(
$theme
);

1050 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {blocks} WHEREhemğ'%s'", 
$deçuÉ_theme
);

1051 
$block
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

1053 ià(!
	`¬¿y_key_exi¡s
(
$block
['»giÚ'], 
$»giÚs
)) {

1054 
$block
['»giÚ'] = 
	`sy¡em_deçuÉ_»giÚ
(
$theme
);

1056 
	`db_qu”y
("INSERT INTO {blocks} (module, delta,heme, status, weight,„egion, visibility,…ages, custom,hrottle, cache) VALUES ('%s', '%s', '%s', %d, %d, '%s', %d, '%s', %d, %d, %d)",

1057 
$block
['moduË'], $block['d–'], 
$theme
, $block['status'], $block['weight'], $block['region'], $block['visibility'], $block['pages'], $block['custom'], $block['throttle'], $block['cache']);

1060 
	}
}

1072 
funùiÚ
 
	$sy¡em_£‰šgs_fÜm
(
$fÜm
) {

1073 
$fÜm
['bu‰Ús']['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save configuration') );

1074 
$fÜm
['bu‰Ús']['»£t'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Reseto defaults') );

1076 ià(!
	`em±y
(
$_POST
è&& 
	`fÜm_g‘_”rÜs
()) {

1077 
	`dru·l_£t_mes§ge
(
	`t
('The settings have‚ot been saved because ofheƒrrors.'), 'error');

1079 
$fÜm
['#submit'][] = 'system_settings_form_submit';

1080 
$fÜm
['#theme'] = 'system_settings_form';

1081  
$fÜm
;

1082 
	}
}

1090 
funùiÚ
 
	$sy¡em_£‰šgs_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1091 
$İ
 = 
	`is£t
(
$fÜm_¡©e
['values']['op']) ? $form_state['values']['op'] : '';

1094 
	`un£t
(
$fÜm_¡©e
['values']['submit'], $form_state['values']['reset'], $form_state['values']['form_id'], $form_state['values']['op'], $form_state['values']['form_token'], $form_state['values']['form_build_id']);

1096 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues'] 
as
 
$key
 => 
$v®ue
) {

1097 ià(
$İ
 =ğ
	`t
('Reseto defaults')) {

1098 
	`v¬ŸbË_d–
(
$key
);

1101 ià(
	`is_¬¿y
(
$v®ue
è&& 
	`is£t
(
$fÜm_¡©e
['values']['array_filter'])) {

1102 
$v®ue
 = 
	`¬¿y_keys
(
	`¬¿y_f‹r
($value));

1104 
	`v¬ŸbË_£t
(
$key
, 
$v®ue
);

1107 ià(
$İ
 =ğ
	`t
('Reseto defaults')) {

1108 
	`dru·l_£t_mes§ge
(
	`t
('The configuration options have been„esetoheir default values.'));

1111 
	`dru·l_£t_mes§ge
(
	`t
('The configuration options have been saved.'));

1114 
	`ÿche_ş—r_®l
();

1115 
	`dru·l_»bud_theme_»gi¡ry
();

1116 
	}
}

1121 
funùiÚ
 
	$_sy¡em_sÜt_»quœem’ts
(
$a
, 
$b
) {

1122 ià(!
	`is£t
(
$a
['weight'])) {

1123 ià(!
	`is£t
(
$b
['weight'])) {

1124  
	`¡rcmp
(
$a
['t™Ë'], 
$b
['title']);

1126  -
$b
['weight'];

1128  
	`is£t
(
$b
['weight']è? 
$a
['weight'] - $b['weight'] : $a['weight'];

1129 
	}
}

1136 
funùiÚ
 
	$sy¡em_node_ty³
(
$İ
, 
$šfo
) {

1137 ià(
$İ
 =ğ'upd©e' && !
	`em±y
(
$šfo
->
Şd_ty³
è&& $šfo->
ty³
 != $info->old_type) {

1138 
$Şd
 = 'toggË_node_šfo_'. 
$šfo
->
Şd_ty³
;

1139 
$Ãw
 = 'toggË_node_šfo_'. 
$šfo
->
ty³
;

1141 
$theme_£‰šgs
 = 
	`v¬ŸbË_g‘
('theme_£‰šgs', 
	`¬¿y
());

1142 ià(
	`is£t
(
$theme_£‰šgs
[
$Şd
])) {

1143 
$theme_£‰šgs
[
$Ãw
] = $theme_£‰šgs[
$Şd
];

1144 
	`un£t
(
$theme_£‰šgs
[
$Şd
]);

1145 
	`v¬ŸbË_£t
('theme_£‰šgs', 
$theme_£‰šgs
);

1148 
	}
}

1192 
funùiÚ
 
cÚfœm_fÜm
(
$fÜm
, 
$que¡iÚ
, 
$·th
, 
$desütiÚ
 = 
NULL
, 
$yes
 = NULL, 
$no
 = NULL, 
$Çme
 = 'confirm') {

1193 
$desütiÚ
 = 
is£t
($desütiÚè? $desütiÚ : 
t
('This‡ction cannot be undone.');

1196 
	g$qu”y
 = 
$äagm’t
 = 
NULL
;

1197 ià(
is_¬¿y
(
$·th
)) {

1198 
	g$qu”y
 = 
is£t
(
$·th
['qu”y']è? $·th['qu”y'] : 
NULL
;

1199 
	g$äagm’t
 = 
is£t
(
$·th
['äagm’t']è? $·th['äagm’t'] : 
NULL
;

1200 
	g$·th
 = 
is£t
(
$·th
['·th']è? $·th['·th'] : 
NULL
;

1202 
	g$ÿnûl
 = 
l
(
$no
 ? $nØ: 
t
('Cªûl'), 
$·th
, 
¬¿y
('qu”y' => 
$qu”y
, 'äagm’t' => 
$äagm’t
));

1204 
dru·l_£t_t™Ë
(
$que¡iÚ
);

1207 
	g$fÜm
['#sk_du¶iÿ‹_check'] = 
TRUE
;

1209 
	g$fÜm
['#©Œibu‹s'] = 
¬¿y
('class' => 'confirmation');

1210 
	g$fÜm
['desütiÚ'] = 
¬¿y
('#v®ue' => 
$desütiÚ
);

1211 
	g$fÜm
[
$Çme
] = 
¬¿y
('#type' => 'hidden', '#value' => 1);

1213 
	g$fÜm
['aùiÚs'] = 
¬¿y
('#prefix' => '<div class="container-inline">', '#suffix' => '</div>');

1214 
	g$fÜm
['aùiÚs']['subm™'] = 
¬¿y
('#ty³' => 'subm™', '#v®ue' => 
$yes
 ? $ye : 
t
('Confirm'));

1215 
	g$fÜm
['aùiÚs']['ÿnûl'] = 
¬¿y
('#v®ue' => 
$ÿnûl
);

1216 
	g$fÜm
['#theme'] = 'confirm_form';

1217  
	g$fÜm
;

1223 
funùiÚ
 
	$sy¡em_admš_com·ù_mode
() {

1224 
glob®
 
$u£r
;

1225  (
	`is£t
(
$u£r
->
admš_com·ù_mode
)è? $u£r->admš_com·ù_mod: 
	`v¬ŸbË_g‘
('admš_com·ù_mode', 
FALSE
);

1226 
	}
}

1236 
funùiÚ
 
	$sy¡em_g‘_moduË_admš_sks
(
$moduË
) {

1237 
$™ems
;

1239 
$admš_acûss
 = 
	`u£r_acûss
('administer…ermissions');

1240 
$admš_sks
 = 
	`¬¿y
();

1242 ià(!
	`is£t
(
$™ems
)) {

1243 
$»suÉ
 = 
	`db_qu”y
("

1244 
SELECT
 
m
.
lßd_funùiÚs
, m.
to_¬g_funùiÚs
, m.
acûss_ÿÎback
, m.
acûss_¬gum’ts
, m.
·ge_ÿÎback
, m.
·ge_¬gum’ts
, m.
t™Ë
, m.
t™Ë_ÿÎback
, m.
t™Ë_¬gum’ts
, m.
ty³
, 
ml
.*

1245 
FROM
 {
m’u_lšks
} 
ml
 
INNER
 
JOIN
 {
m’u_rou‹r
} 
m
 
ON
 ml.
rou‹r_·th
 = m.
·th
 
WHERE
 ml.
lšk_·th
 
LIKE
 'admš/%' 
AND
 
hidd’
 >ğ0 AND 
moduË
 = 'sy¡em' AND m.
numb”_·¹s
 > 2");

1246 
$™ems
 = 
	`¬¿y
();

1247 
$™em
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

1248 
	`_m’u_lšk_Œª¦©e
(
$™em
);

1249 ià(
$™em
['access']) {

1250 
$™ems
[
$™em
['router_path']] = $item;

1254 
$admš_sks
 = 
	`¬¿y
();

1255 
$admš_sk_couÁ
 = 0;

1257 ià(
	`moduË_hook
(
$moduË
, '³rm'è&& 
$admš_acûss
) {

1258 
$admš_sks
[-1] = 
	`l
(
	`t
('CÚfigu»…”missiÚs'), 'admš/u£r/³rmissiÚs', 
	`¬¿y
('äagm’t' => 'moduË-'. 
$moduË
));

1262 ià(
$m’u
 = 
	`moduË_švoke
(
$moduË
, 'menu')) {

1263 
	`fÜ—ch
 (
	`¬¿y_keys
(
$m’u
è
as
 
$·th
) {

1264 ià(
	`is£t
(
$™ems
[
$·th
])) {

1265 
$admš_sks
[
$™ems
[
$·th
]['t™Ë'] . 
$admš_sk_couÁ
 ++] = 
	`l
($items[$path]['title'], $path);

1270  
$admš_sks
;

1271 
	}
}

1278 
funùiÚ
 
	$sy¡em_üÚ
() {

1280 
	`db_qu”y
('DELETE FROM {æood} WHEREime¡am°< %d', 
	`time
() - 3600);

1282 
	`db_qu”y
('DELETE FROM {b©ch} WHEREime¡am°< %d', 
	`time
() - 864000);

1285 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {fes} WHERE stu ğ%d‡ndime¡am°< %d', 
FILE_STATUS_TEMPORARY
, 
	`time
(è- 
DRUPAL_MAXIMUM_TEMP_FILE_AGE
);

1286 
$fe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1287 ià(
	`fe_exi¡s
(
$fe
->
f•©h
)) {

1290 ià(!
	`fe_d–‘e
(
$fe
->
f•©h
)) {

1291 
	`w©chdog
('fsy¡em', 'Could‚Ù d–‘‹mpÜ¬y f"%·th" duršg g¬bagcŞËùiÚ', 
	`¬¿y
('%·th' => 
$fe
->
f•©h
), 'error');

1295 
	`db_qu”y
('DELETE FROM {fes} WHERE fid = %d', 
$fe
->
fid
);

1297 
$cÜe
 = 
	`¬¿y
('cache', 'cache_block', 'cache_filter', 'cache_page', 'cache_form', 'cache_menu');

1298 
$ÿche_bËs
 = 
	`¬¿y_m”ge
(
	`moduË_švoke_®l
('æush_ÿches'), 
$cÜe
);

1299 
	`fÜ—ch
 (
$ÿche_bËs
 
as
 
$bË
) {

1300 
	`ÿche_ş—r_®l
(
NULL
, 
$bË
);

1302 
	}
}

1307 
funùiÚ
 
	$sy¡em_hook_šfo
() {

1308  
	`¬¿y
(

1309 'sy¡em' => 
	`¬¿y
(

1310 'üÚ' => 
	`¬¿y
(

1311 'run' => 
	`¬¿y
(

1312 'run wh’' => 
	`t
('When cron„uns'),

1317 
	}
}

1322 
funùiÚ
 
	$sy¡em_aùiÚ_šfo
() {

1323  
	`¬¿y
(

1324 'sy¡em_mes§ge_aùiÚ' => 
	`¬¿y
(

1326 'desütiÚ' => 
	`t
('Display‡ messageohe user'),

1327 'cÚfigu¿bË' => 
TRUE
,

1328 'hooks' => 
	`¬¿y
(

1329 'nod—pi' => 
	`¬¿y
('view', 'insert', 'update', 'delete'),

1330 'comm’t' => 
	`¬¿y
('view', 'insert', 'update', 'delete'),

1331 'u£r' => 
	`¬¿y
('view', 'insert', 'update', 'delete', 'login'),

1332 'xÚomy' => 
	`¬¿y
('insert', 'update', 'delete'),

1335 'sy¡em_£nd_ema_aùiÚ' => 
	`¬¿y
(

1336 'desütiÚ' => 
	`t
('Sendƒ-mail'),

1338 'cÚfigu¿bË' => 
TRUE
,

1339 'hooks' => 
	`¬¿y
(

1340 'nod—pi' => 
	`¬¿y
('view', 'insert', 'update', 'delete'),

1341 'comm’t' => 
	`¬¿y
('view', 'insert', 'update', 'delete'),

1342 'u£r' => 
	`¬¿y
('view', 'insert', 'update', 'delete', 'login'),

1343 'xÚomy' => 
	`¬¿y
('insert', 'update', 'delete'),

1346 'sy¡em_gÙo_aùiÚ' => 
	`¬¿y
(

1347 'desütiÚ' => 
	`t
('Redirecto URL'),

1349 'cÚfigu¿bË' => 
TRUE
,

1350 'hooks' => 
	`¬¿y
(

1351 'nod—pi' => 
	`¬¿y
('view', 'insert', 'update', 'delete'),

1352 'comm’t' => 
	`¬¿y
('view', 'insert', 'update', 'delete'),

1353 'u£r' => 
	`¬¿y
('view', 'insert', 'update', 'delete', 'login'),

1357 
	}
}

1362 
funùiÚ
 
	$sy¡em_aùiÚs_mªage
() {

1363 
$ouut
 = '';

1364 
$aùiÚs
 = 
	`aùiÚs_li¡
();

1365 
	`aùiÚs_synchrÚize
(
$aùiÚs
);

1366 
$aùiÚs_m­
 = 
	`aùiÚs_aùiÚs_m­
(
$aùiÚs
);

1367 
$İtiÚs
 = 
	`¬¿y
(
	`t
('Choose‡n‡dvanced‡ction'));

1368 
$uncÚfigu¿bË
 = 
	`¬¿y
();

1370 
	`fÜ—ch
 (
$aùiÚs_m­
 
as
 
$key
 => 
$¬¿y
) {

1371 ià(
$¬¿y
['configurable']) {

1372 
$İtiÚs
[
$key
] = 
$¬¿y
['description'] .'...';

1375 
$uncÚfigu¿bË
[] = 
$¬¿y
;

1379 
$row
 = 
	`¬¿y
();

1380 
$š¡ªûs_´e£Á
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT‡id FROM {actions} WHERE…arameters <> ''"));

1381 
$h—d”
 = 
	`¬¿y
(

1382 
	`¬¿y
('d©a' => 
	`t
('Actionype'), 'field' => 'type'),

1383 
	`¬¿y
('d©a' => 
	`t
('Description'), 'field' => 'description'),

1384 
	`¬¿y
('d©a' => 
$š¡ªûs_´e£Á
 ? 
	`t
('Operations') : '', 'colspan' => '2')

1386 
$sql
 = 'SELECT * FROM {actions}';

1387 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
 . 
	`bËsÜt_sql
(
$h—d”
), 50);

1388 
$aùiÚ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1389 
$row
[] = 
	`¬¿y
(

1390 
	`¬¿y
('d©a' => 
$aùiÚ
->
ty³
),

1391 
	`¬¿y
('d©a' => 
	`f‹r_xss_admš
(
$aùiÚ
->
desütiÚ
)),

1392 
	`¬¿y
('d©a' => 
$aùiÚ
->
·¿m‘”s
 ? 
	`l
(
	`t
('configure'), "admin/settings/actions/configure/$action->aid") : ''),

1393 
	`¬¿y
('d©a' => 
$aùiÚ
->
·¿m‘”s
 ? 
	`l
(
	`t
('delete'), "admin/settings/actions/delete/$action->aid") : '')

1397 ià(
$row
) {

1398 
$·g”
 = 
	`theme
('·g”', 
NULL
, 50, 0);

1399 ià(!
	`em±y
(
$·g”
)) {

1400 
$row
[] = 
	`¬¿y
×¼ay('d©a' => 
$·g”
, 'colspan' => '3'));

1402 
$ouut
 .ğ'<h3>'. 
	`t
('Actions‡vailableo Drupal:') .'</h3>';

1403 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$row
);

1406 ià(
$aùiÚs_m­
) {

1407 
$ouut
 .ğ
	`dru·l_g‘_fÜm
('sy¡em_aùiÚs_mªage_fÜm', 
$İtiÚs
);

1410  
$ouut
;

1411 
	}
}

1425 
funùiÚ
 
sy¡em_aùiÚs_mªage_fÜm
(
$fÜm_¡©e
, 
$İtiÚs
 = 
	$¬¿y
()) {

1426 
$fÜm
['·»Á'] = 
	`¬¿y
(

1428 '#t™Ë' => 
	`t
('Make‡‚ew‡dvanced‡ction‡vailable'),

1432 
$fÜm
['·»Á']['aùiÚ'] = 
	`¬¿y
(

1435 '#İtiÚs' => 
$İtiÚs
,

1438 
$fÜm
['·»Á']['bu‰Ús']['subm™'] = 
	`¬¿y
(

1440 '#v®ue' => 
	`t
('Create'),

1442  
$fÜm
;

1443 
	}
}

1448 
funùiÚ
 
	$sy¡em_aùiÚs_mªage_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1449 ià(
$fÜm_¡©e
['values']['action']) {

1450 
$fÜm_¡©e
['redirect'] = 'admin/settings/actions/configure/'. $form_state['values']['action'];

1452 
	}
}

1471 
funùiÚ
 
	$sy¡em_aùiÚs_cÚfigu»
(
$fÜm_¡©e
, 
$aùiÚ
 = 
NULL
) {

1472 ià(
$aùiÚ
 ==ğ
NULL
) {

1473 
	`dru·l_gÙo
('admin/settings/actions');

1476 
$aùiÚs_m­
 = 
	`aùiÚs_aùiÚs_m­
(
	`aùiÚs_li¡
());

1477 
$ed™
 = 
	`¬¿y
();

1481 ià(
	`is_num”ic
(
$aùiÚ
)) {

1482 
$aid
 = 
$aùiÚ
;

1484 
$d©a
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT * FROM {aùiÚs} WHERE‡id = '%s'", 
$aid
));

1485 
$ed™
['aùiÚs_desütiÚ'] = 
$d©a
->
desütiÚ
;

1486 
$ed™
['aùiÚs_ty³'] = 
$d©a
->
ty³
;

1487 
$funùiÚ
 = 
$d©a
->
ÿÎback
;

1488 
$aùiÚ
 = 
	`md5
(
$d©a
->
ÿÎback
);

1489 
$·¿ms
 = 
	`un£rŸlize
(
$d©a
->
·¿m‘”s
);

1490 ià(
$·¿ms
) {

1491 
	`fÜ—ch
 (
$·¿ms
 
as
 
$Çme
 => 
$v®
) {

1492 
$ed™
[
$Çme
] = 
$v®
;

1497 
$funùiÚ
 = 
$aùiÚs_m­
[
$aùiÚ
]['callback'];

1498 
$ed™
['aùiÚs_desütiÚ'] = 
$aùiÚs_m­
[
$aùiÚ
]['description'];

1499 
$ed™
['aùiÚs_ty³'] = 
$aùiÚs_m­
[
$aùiÚ
]['type'];

1502 
$fÜm
['aùiÚs_desütiÚ'] = 
	`¬¿y
(

1504 '#t™Ë' => 
	`t
('Description'),

1505 '#deçuÉ_v®ue' => 
$ed™
['actions_description'],

1507 '#desütiÚ' => 
	`t
('A unique description forhis‡dvanced‡ction. This description will be displayed inhe interface of moduleshat integrate with‡ctions, such‡s Trigger module.'),

1510 
$aùiÚ_fÜm
 = 
$funùiÚ
 .'_form';

1511 
$fÜm
 = 
	`¬¿y_m”ge
($fÜm, 
	`$aùiÚ_fÜm
(
$ed™
));

1512 
$fÜm
['aùiÚs_ty³'] = 
	`¬¿y
(

1514 '#v®ue' => 
$ed™
['actions_type'],

1516 
$fÜm
['aùiÚs_aùiÚ'] = 
	`¬¿y
(

1518 '#v®ue' => 
$aùiÚ
,

1521 ià(
	`is£t
(
$aid
)) {

1522 
$fÜm
['aùiÚs_aid'] = 
	`¬¿y
(

1524 '#v®ue' => 
$aid
,

1527 
$fÜm
['aùiÚs_cÚfigu»d'] = 
	`¬¿y
(

1531 
$fÜm
['bu‰Ús']['subm™'] = 
	`¬¿y
(

1533 '#v®ue' => 
	`t
('Save'),

1537  
$fÜm
;

1538 
	}
}

1543 
funùiÚ
 
	$sy¡em_aùiÚs_cÚfigu»_v®id©e
(
$fÜm
, 
$fÜm_¡©e
) {

1544 
$funùiÚ
 = 
	`aùiÚs_funùiÚ_lookup
(
$fÜm_¡©e
['values']['actions_action']) .'_validate';

1546 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

1547 
	`$funùiÚ
(
$fÜm
, 
$fÜm_¡©e
);

1549 
	}
}

1554 
funùiÚ
 
	$sy¡em_aùiÚs_cÚfigu»_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1555 
$funùiÚ
 = 
	`aùiÚs_funùiÚ_lookup
(
$fÜm_¡©e
['values']['actions_action']);

1556 
$subm™_funùiÚ
 = 
$funùiÚ
 .'_submit';

1559 
$·¿ms
 = 
	`$subm™_funùiÚ
(
$fÜm
, 
$fÜm_¡©e
);

1560 
$aid
 = 
	`is£t
(
$fÜm_¡©e
['v®ues']['aùiÚs_aid']è? $fÜm_¡©e['v®ues']['aùiÚs_aid'] : 
NULL
;

1562 
	`aùiÚs_§ve
(
$funùiÚ
, 
$fÜm_¡©e
['v®ues']['aùiÚs_ty³'], 
$·¿ms
, $fÜm_¡©e['v®ues']['aùiÚs_desütiÚ'], 
$aid
);

1563 
	`dru·l_£t_mes§ge
(
	`t
('The‡ction has been successfully saved.'));

1565 
$fÜm_¡©e
['redirect'] = 'admin/settings/actions/manage';

1566 
	}
}

1574 
funùiÚ
 
	$sy¡em_aùiÚs_d–‘e_fÜm
(
$fÜm_¡©e
, 
$aùiÚ
) {

1576 
$fÜm
['aid'] = 
	`¬¿y
(

1578 '#v®ue' => 
$aùiÚ
->
aid
,

1580  
	`cÚfœm_fÜm
(
$fÜm
,

1581 
	`t
('A» you su» you wªˆtØd–‘thaùiÚ %aùiÚ?', 
	`¬¿y
('%aùiÚ' => 
$aùiÚ
->
desütiÚ
)),

1583 
	`t
('This cannot be undone.'),

1584 
	`t
('Delete'),('Cancel')

1586 
	}
}

1593 
funùiÚ
 
	$sy¡em_aùiÚs_d–‘e_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1594 
$aid
 = 
$fÜm_¡©e
['values']['aid'];

1595 
$aùiÚ
 = 
	`aùiÚs_lßd
(
$aid
);

1596 
	`aùiÚs_d–‘e
(
$aid
);

1597 
	`w©chdog
('u£r', 'D–‘ed‡ùiÚ %aid (%aùiÚ)', 
	`¬¿y
('%aid' => 
$aid
, '%aùiÚ' => 
$aùiÚ
->
desütiÚ
));

1598 
	`dru·l_£t_mes§ge
(
	`t
('AùiÚ %aùiÚ wa d–‘ed', 
	`¬¿y
('%aùiÚ' => 
$aùiÚ
->
desütiÚ
)));

1599 
$fÜm_¡©e
['redirect'] = 'admin/settings/actions/manage';

1600 
	}
}

1608 
funùiÚ
 
	$sy¡em_aùiÚ_d–‘e_Üphªs_po¡
(
$Üphªed
) {

1609 
	`fÜ—ch
 (
$Üphªed
 
as
 
$ÿÎback
) {

1610 
	`dru·l_£t_mes§ge
(
	`t
("D–‘ed o½hªed‡ùiÚ (%aùiÚ).", 
	`¬¿y
('%aùiÚ' => 
$ÿÎback
)));

1612 
	}
}

1617 
funùiÚ
 
	$sy¡em_aùiÚs_»move_Üphªs
() {

1618 
	`aùiÚs_synchrÚize
(
	`aùiÚs_li¡
(), 
TRUE
);

1619 
	`dru·l_gÙo
('admin/settings/actions/manage');

1620 
	}
}

1632 
funùiÚ
 
	$sy¡em_£nd_ema_aùiÚ_fÜm
(
$cÚ‹xt
) {

1634 ià(!
	`is£t
(
$cÚ‹xt
['recipient'])) {

1635 
$cÚ‹xt
['recipient'] = '';

1637 ià(!
	`is£t
(
$cÚ‹xt
['subject'])) {

1638 
$cÚ‹xt
['subject'] = '';

1640 ià(!
	`is£t
(
$cÚ‹xt
['message'])) {

1641 
$cÚ‹xt
['message'] = '';

1644 
$fÜm
['»c›Á'] = 
	`¬¿y
(

1646 '#t™Ë' => 
	`t
('Recipient'),

1647 '#deçuÉ_v®ue' => 
$cÚ‹xt
['recipient'],

1649 '#desütiÚ' => 
	`t
('Thema‡dd»s tØwhichhmes§gshould b£Á ORƒÁ” %authÜ iàyou would†iktØ£nd‡Àe-maØthauthÜ oàthÜigš®…o¡.', 
	`¬¿y
('%author' => '%author')),

1651 
$fÜm
['subjeù'] = 
	`¬¿y
(

1653 '#t™Ë' => 
	`t
('Subject'),

1654 '#deçuÉ_v®ue' => 
$cÚ‹xt
['subject'],

1656 '#desütiÚ' => 
	`t
('The subject ofhe message.'),

1658 
$fÜm
['mes§ge'] = 
	`¬¿y
(

1660 '#t™Ë' => 
	`t
('Message'),

1661 '#deçuÉ_v®ue' => 
$cÚ‹xt
['message'],

1664 '#desütiÚ' => 
	`t
('The messagehat should be sent. You may includehe following variables: %site_name, %username, %node_url, %node_type, %title, %teaser, %body. Not‡ll variables will be‡vailable in‡ll contexts.'),

1666  
$fÜm
;

1667 
	}
}

1672 
funùiÚ
 
	$sy¡em_£nd_ema_aùiÚ_v®id©e
(
$fÜm
, 
$fÜm_¡©e
) {

1673 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

1675 ià(!
	`v®id_ema_add»ss
(
$fÜm_v®ues
['recipient']) && $form_values['recipient'] != '%author') {

1677 
	`fÜm_£t_”rÜ
('»c›Á', 
	`t
('PËa£ƒÁ”‡ v®idƒma‡dd»s Ü %authÜ.', 
	`¬¿y
('%author' => '%author')));

1679 
	}
}

1684 
funùiÚ
 
	$sy¡em_£nd_ema_aùiÚ_subm™
(
$fÜm
, 
$fÜm_¡©e
) {

1685 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

1688 
$·¿ms
 = 
	`¬¿y
(

1689 '»c›Á' => 
$fÜm_v®ues
['recipient'],

1690 'subjeù' => 
$fÜm_v®ues
['subject'],

1691 'mes§ge' => 
$fÜm_v®ues
['message'],

1693  
$·¿ms
;

1694 
	}
}

1699 
funùiÚ
 
	$sy¡em_£nd_ema_aùiÚ
(
$objeù
, 
$cÚ‹xt
) {

1700 
glob®
 
$u£r
;

1702 
$cÚ‹xt
['hook']) {

1707 
$node
 = 
$cÚ‹xt
['node'];

1711 
$comm’t
 = 
$cÚ‹xt
['comment'];

1712 
$node
 = 
	`node_lßd
(
$comm’t
->
nid
);

1718 
$accouÁ
 = 
$cÚ‹xt
['account'];

1719 ià(
	`is£t
(
$cÚ‹xt
['node'])) {

1720 
$node
 = 
$cÚ‹xt
['node'];

1722 
	`–£if
 (
$cÚ‹xt
['recipient'] == '%author') {

1724 
	`w©chdog
('error', 'Cannot use %authoroken inhis context.');

1730 
$node
 = 
$objeù
;

1733 
$»c›Á
 = 
$cÚ‹xt
['recipient'];

1735 ià(
	`is£t
(
$node
)) {

1736 ià(!
	`is£t
(
$accouÁ
)) {

1737 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => 
$node
->
uid
));

1739 ià(
$»c›Á
 == '%author') {

1740 
$»c›Á
 = 
$accouÁ
->
ma
;

1744 ià(!
	`is£t
(
$accouÁ
)) {

1745 
$accouÁ
 = 
$u£r
;

1748 
$Ïnguage
 = 
	`u£r_´eã¼ed_Ïnguage
(
$accouÁ
);

1749 
$·¿ms
 = 
	`¬¿y
('accouÁ' => 
$accouÁ
, 'objeù' => 
$objeù
, 'cÚ‹xt' => 
$cÚ‹xt
);

1750 ià(
	`is£t
(
$node
)) {

1751 
$·¿ms
['node'] = 
$node
;

1754 ià(
	`dru·l_ma
('sy¡em', 'aùiÚ_£nd_ema', 
$»c›Á
, 
$Ïnguage
, 
$·¿ms
)) {

1755 
	`w©chdog
('aùiÚ', 'S’ˆemaØ%»c›Á', 
	`¬¿y
('%»c›Á' => 
$»c›Á
));

1758 
	`w©chdog
('”rÜ', 'UÇbËØ£ndƒmaØ%»c›Á', 
	`¬¿y
('%»c›Á' => 
$»c›Á
));

1760 
	}
}

1765 
funùiÚ
 
	$sy¡em_ma
(
$key
, &
$mes§ge
, 
$·¿ms
) {

1766 
$accouÁ
 = 
$·¿ms
['account'];

1767 
$cÚ‹xt
 = 
$·¿ms
['context'];

1768 
$v¬ŸbËs
 = 
	`¬¿y
(

1769 '%s™e_Çme' => 
	`v¬ŸbË_g‘
('site_name', 'Drupal'),

1770 '%u£ºame' => 
$accouÁ
->
Çme
,

1772 ià(
$cÚ‹xt
['hook'] == 'taxonomy') {

1773 
$objeù
 = 
$·¿ms
['object'];

1774 
$voÿbuÏry
 = 
	`xÚomy_voÿbuÏry_lßd
(
$objeù
->
vid
);

1775 
$v¬ŸbËs
 +ğ
	`¬¿y
(

1776 '%‹rm_Çme' => 
$objeù
->
Çme
,

1777 '%‹rm_desütiÚ' => 
$objeù
->
desütiÚ
,

1778 '%‹rm_id' => 
$objeù
->
tid
,

1779 '%voÿbuÏry_Çme' => 
$voÿbuÏry
->
Çme
,

1780 '%voÿbuÏry_desütiÚ' => 
$voÿbuÏry
->
desütiÚ
,

1781 '%voÿbuÏry_id' => 
$voÿbuÏry
->
vid
,

1786 ià(
	`is£t
(
$·¿ms
['node'])) {

1787 
$node
 = 
$·¿ms
['node'];

1788 
$v¬ŸbËs
 +ğ
	`¬¿y
(

1789 '%uid' => 
$node
->
uid
,

1790 '%node_u¾' => 
	`u¾
('node/'. 
$node
->
nid
, 
	`¬¿y
('absŞu‹' => 
TRUE
)),

1791 '%node_ty³' => 
	`node_g‘_ty³s
('Çme', 
$node
),

1792 '%t™Ë' => 
$node
->
t™Ë
,

1793 '%‹a£r' => 
$node
->
‹a£r
,

1794 '%body' => 
$node
->
body
,

1797 
$subjeù
 = 
	`¡¹r
(
$cÚ‹xt
['subjeù'], 
$v¬ŸbËs
);

1798 
$body
 = 
	`¡¹r
(
	`f‹r_xss_admš
(
$cÚ‹xt
['mes§ge']), 
$v¬ŸbËs
);

1799 
$mes§ge
['subjeù'] .ğ
	`¡r_»¶aû
(
	`¬¿y
("\r", "\n"), '', 
$subjeù
);

1800 
$mes§ge
['body'][] = 
	`dru·l_html_to_‹xt
(
$body
);

1801 
	}
}

1803 
funùiÚ
 
	$sy¡em_mes§ge_aùiÚ_fÜm
(
$cÚ‹xt
) {

1804 
$fÜm
['mes§ge'] = 
	`¬¿y
(

1806 '#t™Ë' => 
	`t
('Message'),

1807 '#deçuÉ_v®ue' => 
	`is£t
(
$cÚ‹xt
['message']) ? $context['message'] : '',

1808 '#»quœed' => 
TRUE
,

1810 '#desütiÚ' => 
	`t
('The messageo be displayedohe current user. You may includehe following variables: %site_name, %username, %node_url, %node_type, %title, %teaser, %body. Not‡ll variables will be‡vailable in‡ll contexts.'),

1812  
$fÜm
;

1813 
	}
}

1815 
funùiÚ
 
	$sy¡em_mes§ge_aùiÚ_subm™
(
$fÜm
, 
$fÜm_¡©e
) {

1816  
	`¬¿y
('mes§ge' => 
$fÜm_¡©e
['values']['message']);

1817 
	}
}

1822 
funùiÚ
 
sy¡em_mes§ge_aùiÚ
(&
$objeù
, 
$cÚ‹xt
 = 
	$¬¿y
()) {

1823 
glob®
 
$u£r
;

1824 
$v¬ŸbËs
 = 
	`¬¿y
(

1825 '%s™e_Çme' => 
	`v¬ŸbË_g‘
('site_name', 'Drupal'),

1826 '%u£ºame' => 
$u£r
->
Çme
 ? $u£r->Çm: 
	`v¬ŸbË_g‘
('ªÚymous', 
	`t
('Anonymous')),

1832 
$cÚ‹xt
['hook']) {

1837 
$node
 = 
$cÚ‹xt
['node'];

1841 
$comm’t
 = 
$cÚ‹xt
['comment'];

1842 
$node
 = 
	`node_lßd
(
$comm’t
->
nid
);

1845 
$voÿbuÏry
 = 
	`xÚomy_voÿbuÏry_lßd
(
$objeù
->
vid
);

1846 
$v¬ŸbËs
 = 
	`¬¿y_m”ge
($v¬ŸbËs, 
	`¬¿y
(

1847 '%‹rm_Çme' => 
	`check_¶aš
(
$objeù
->
Çme
),

1848 '%‹rm_desütiÚ' => 
	`f‹r_xss_admš
(
$objeù
->
desütiÚ
),

1849 '%‹rm_id' => 
$objeù
->
tid
,

1850 '%voÿbuÏry_Çme' => 
	`check_¶aš
(
$voÿbuÏry
->
Çme
),

1851 '%voÿbuÏry_desütiÚ' => 
	`f‹r_xss_admš
(
$voÿbuÏry
->
desütiÚ
),

1852 '%voÿbuÏry_id' => 
$voÿbuÏry
->
vid
,

1858 
$node
 = 
$objeù
;

1861 ià(
	`is£t
(
$node
è&& 
	`is_objeù
($node)) {

1862 
$v¬ŸbËs
 = 
	`¬¿y_m”ge
($v¬ŸbËs, 
	`¬¿y
(

1863 '%uid' => 
$node
->
uid
,

1864 '%node_u¾' => 
	`u¾
('node/'. 
$node
->
nid
, 
	`¬¿y
('absŞu‹' => 
TRUE
)),

1865 '%node_ty³' => 
	`check_¶aš
(
	`node_g‘_ty³s
('Çme', 
$node
)),

1866 '%t™Ë' => 
	`check_¶aš
(
$node
->
t™Ë
),

1867 '%‹a£r' => 
	`check_m¬kup
(
$node
->
‹a£r
, $node->
fÜm©
, 
FALSE
),

1868 '%body' => 
	`check_m¬kup
(
$node
->
body
, $node->
fÜm©
, 
FALSE
),

1872 
$cÚ‹xt
['mes§ge'] = 
	`¡¹r
(
	`f‹r_xss_admš
($cÚ‹xt['mes§ge']), 
$v¬ŸbËs
);

1873 
	`dru·l_£t_mes§ge
(
$cÚ‹xt
['message']);

1874 
	}
}

1879 
funùiÚ
 
	$sy¡em_gÙo_aùiÚ_fÜm
(
$cÚ‹xt
) {

1880 
$fÜm
['u¾'] = 
	`¬¿y
(

1882 '#t™Ë' => 
	`t
('URL'),

1883 '#desütiÚ' => 
	`t
('The URLo whichhe user should be„edirected. This can be‡n internal URL†ike‚ode/1234 or‡nƒxternal URL†ike http://drupal.org.'),

1884 '#deçuÉ_v®ue' => 
	`is£t
(
$cÚ‹xt
['url']) ? $context['url'] : '',

1885 '#»quœed' => 
TRUE
,

1887  
$fÜm
;

1888 
	}
}

1890 
funùiÚ
 
	$sy¡em_gÙo_aùiÚ_subm™
(
$fÜm
, 
$fÜm_¡©e
) {

1891  
	`¬¿y
(

1892 'u¾' => 
$fÜm_¡©e
['values']['url']

1894 
	}
}

1896 
funùiÚ
 
	$sy¡em_gÙo_aùiÚ
(
$objeù
, 
$cÚ‹xt
) {

1897 
	`dru·l_gÙo
(
$cÚ‹xt
['url']);

1898 
	}
}

1903 
funùiÚ
 
	$_sy¡em_zÚ–i¡
() {

1904 
$time¡amp
 = 
	`time
();

1905 
$zÚ–i¡
 = 
	`¬¿y
(-11, -10, -9.5, -9, -8, -7, -6, -5, -4.5, -4, -3.5, -3, -2.5, -2, -1, 0, 1, 2, 3, 3.5, 4, 5, 5.5, 5.75, 6, 6.5, 7, 8, 9, 9.5, 10, 10.5, 11, 11.5, 12, 12.75, 13, 14);

1906 
$zÚes
 = 
	`¬¿y
();

1907 
	`fÜ—ch
 (
$zÚ–i¡
 
as
 
$off£t
) {

1908 
$zÚe
 = 
$off£t
 * 3600;

1909 
$zÚes
[
$zÚe
] = 
	`fÜm©_d©e
(
$time¡amp
, 'cu¡om', 
	`v¬ŸbË_g‘
('date_format_long', 'l, F j, Y - H:i') .' O', $zone);

1911  
$zÚes
;

1912 
	}
}

1924 
funùiÚ
 
	$sy¡em_check_h‰p_»que¡
() {

1926 
$»suÉ
 = 
	`dru·l_h‰p_»que¡
(
	`u¾
('', 
	`¬¿y
('absŞu‹' => 
TRUE
)));

1929 
$wÜks
 = 
	`is£t
(
$»suÉ
->
code
) && ($result->code >= 100) && ($result->code < 600);

1930 
	`v¬ŸbË_£t
('dru·l_h‰p_»que¡_çs', !
$wÜks
);

1931  
$wÜks
;

1932 
	}
}

1939 
funùiÚ
 
	$theme_sy¡em_pow”ed_by
(
$image_·th
) {

1940 
$image
 = 
	`theme
('image', 
$image_·th
, 
	`t
('Powered by Drupal,‡n open source content management system'),('Powered by Drupal,‡n open source content management system'));

1941  
	`l
(
$image
, 'h‰p://dru·l.Üg', 
	`¬¿y
('html' => 
TRUE
, 'absolute' => TRUE, 'external' => TRUE));

1942 
	}
}

	@/srv/http/subs/notes/www/modules/taxonomy/taxonomy.admin.inc

1 <?
php


16 
funùiÚ
 
	$xÚomy_ov”v›w_voÿbuÏr›s
() {

17 
$voÿbuÏr›s
 = 
	`xÚomy_g‘_voÿbuÏr›s
();

18 
$fÜm
 = 
	`¬¿y
('#Œ“' => 
TRUE
);

19 
	`fÜ—ch
 (
$voÿbuÏr›s
 
as
 
$voÿbuÏry
) {

20 
$ty³s
 = 
	`¬¿y
();

21 
	`fÜ—ch
 (
$voÿbuÏry
->
nodes
 
as
 
$ty³
) {

22 
$node_ty³
 = 
	`node_g‘_ty³s
('Çme', 
$ty³
);

23 
$ty³s
[] = 
$node_ty³
 ? 
	`check_¶aš
($node_ty³è: check_¶aš(
$ty³
);

25 
$fÜm
[
$voÿbuÏry
->
vid
]['#voÿbuÏry'] = (
¬¿y
)$vocabulary;

26 
$fÜm
[
$voÿbuÏry
->
vid
]['Çme'] = 
	`¬¿y
('#v®ue' => 
	`check_¶aš
($voÿbuÏry->
Çme
));

27 
$fÜm
[
$voÿbuÏry
->
vid
]['ty³s'] = 
	`¬¿y
('#v®ue' => 
	`im¶ode
(', ', 
$ty³s
));

28 
$fÜm
[
$voÿbuÏry
->
vid
]['weight'] = 
	`¬¿y
('#ty³' => 'weight', '#d–' => 10, '#deçuÉ_v®ue' => $voÿbuÏry->
weight
);

29 
$fÜm
[
$voÿbuÏry
->
vid
]['ed™'] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('edit vocabulary'), "admin/content/taxonomy/edit/vocabulary/$vocabulary->vid"));

30 
$fÜm
[
$voÿbuÏry
->
vid
]['li¡'] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('listerms'), "admin/content/taxonomy/$vocabulary->vid"));

31 
$fÜm
[
$voÿbuÏry
->
vid
]['add'] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('adderms'), "admin/content/taxonomy/$vocabulary->vid/add/term"));

36 ià(
	`couÁ
(
$voÿbuÏr›s
) > 1) {

37 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save'));

39 
	`–£if
 (
	`is£t
(
$voÿbuÏry
)) {

40 
	`un£t
(
$fÜm
[
$voÿbuÏry
->
vid
]['weight']);

42  
$fÜm
;

43 
	}
}

50 
funùiÚ
 
	$xÚomy_ov”v›w_voÿbuÏr›s_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

51 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues'] 
as
 
$vid
 => 
$voÿbuÏry
) {

52 ià(
	`is_num”ic
(
$vid
è&& 
$fÜm
[$vid]['#voÿbuÏry']['weight'] !ğ
$fÜm_¡©e
['values'][$vid]['weight']) {

53 
$fÜm
[
$vid
]['#voÿbuÏry']['weight'] = 
$fÜm_¡©e
['values'][$vid]['weight'];

54 
	`xÚomy_§ve_voÿbuÏry
(
$fÜm
[
$vid
]['#vocabulary']);

57 
	}
}

65 
funùiÚ
 
	$theme_xÚomy_ov”v›w_voÿbuÏr›s
(
$fÜm
) {

66 
$rows
 = 
	`¬¿y
();

67 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$key
) {

68 ià(
	`is£t
(
$fÜm
[
$key
]['name'])) {

69 
$voÿbuÏry
 = &
$fÜm
[
$key
];

71 
$row
 = 
	`¬¿y
();

72 
$row
[] = 
	`dru·l_»nd”
(
$voÿbuÏry
['name']);

73 
$row
[] = 
	`dru·l_»nd”
(
$voÿbuÏry
['types']);

74 ià(
	`is£t
(
$voÿbuÏry
['weight'])) {

75 
$voÿbuÏry
['weight']['#attributes']['class'] = 'vocabulary-weight';

76 
$row
[] = 
	`dru·l_»nd”
(
$voÿbuÏry
['weight']);

78 
$row
[] = 
	`dru·l_»nd”
(
$voÿbuÏry
['edit']);

79 
$row
[] = 
	`dru·l_»nd”
(
$voÿbuÏry
['list']);

80 
$row
[] = 
	`dru·l_»nd”
(
$voÿbuÏry
['add']);

81 
$rows
[] = 
	`¬¿y
('d©a' => 
$row
, 'class' => 'draggable');

84 ià(
	`em±y
(
$rows
)) {

85 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No vocabularies‡vailable.'), 'colspan' => '5'));

88 
$h—d”
 = 
	`¬¿y
(
	`t
('Name'),('Type'));

89 ià(
	`is£t
(
$fÜm
['submit'])) {

90 
$h—d”
[] = 
	`t
('Weight');

91 
	`dru·l_add_bËd¿g
('taxonomy', 'order', 'sibling', 'vocabulary-weight');

93 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Operations'), 'colspan' => '3');

94  
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('id' => 'xÚomy')è. 
	`dru·l_»nd”
(
$fÜm
);

95 
	}
}

103 
funùiÚ
 
xÚomy_fÜm_voÿbuÏry
(&
$fÜm_¡©e
, 
$ed™
 = 
	$¬¿y
()) {

104 
$ed™
 +ğ
	`¬¿y
(

108 'nodes' => 
	`¬¿y
(),

116 
$fÜm
['id’tifiÿtiÚ'] = 
	`¬¿y
(

118 '#t™Ë' => 
	`t
('Identification'),

119 '#cŞÏpsibË' => 
TRUE
,

121 
$fÜm
['id’tifiÿtiÚ']['Çme'] = 
	`¬¿y
('#type' => 'textfield',

122 '#t™Ë' => 
	`t
('Vocabulary‚ame'),

123 '#deçuÉ_v®ue' => 
$ed™
['name'],

125 '#desütiÚ' => 
	`t
('The‚ame forhis vocabulary,ƒ.g., <em>"Tags"</em>.'),

126 '#»quœed' => 
TRUE
,

128 
$fÜm
['id’tifiÿtiÚ']['desütiÚ'] = 
	`¬¿y
('#type' => 'textarea',

129 '#t™Ë' => 
	`t
('Description'),

130 '#deçuÉ_v®ue' => 
$ed™
['description'],

131 '#desütiÚ' => 
	`t
('Description ofhe vocabulary; can be used by modules.'),

133 
$fÜm
['id’tifiÿtiÚ']['h–p'] = 
	`¬¿y
('#type' => 'textfield',

134 '#t™Ë' => 
	`t
('Helpext'),

136 '#deçuÉ_v®ue' => 
$ed™
['help'],

137 '#desütiÚ' => 
	`t
('Instructionso…resentohe user when selectingerms,ƒ.g., <em>"Enter‡ comma separated†ist of words"</em>.'),

139 
$fÜm
['cÚ‹Á_ty³s'] = 
	`¬¿y
(

141 '#t™Ë' => 
	`t
('Contentypes'),

142 '#cŞÏpsibË' => 
TRUE
,

144 
$fÜm
['cÚ‹Á_ty³s']['nodes'] = 
	`¬¿y
('#type' => 'checkboxes',

145 '#t™Ë' => 
	`t
('Contentypes'),

146 '#deçuÉ_v®ue' => 
$ed™
['nodes'],

147 '#İtiÚs' => 
	`¬¿y_m­
('check_¶aš', 
	`node_g‘_ty³s
('names')),

148 '#desütiÚ' => 
	`t
('Select contentypeso categorize usinghis vocabulary.'),

150 
$fÜm
['£‰šgs'] = 
	`¬¿y
(

152 '#t™Ë' => 
	`t
('Settings'),

153 '#cŞÏpsibË' => 
TRUE
,

155 
$fÜm
['£‰šgs']['gs'] = 
	`¬¿y
('#type' => 'checkbox',

156 '#t™Ë' => 
	`t
('Tags'),

157 '#deçuÉ_v®ue' => 
$ed™
['tags'],

158 '#desütiÚ' => 
	`t
('Terms‡re created by users when submitting…osts byyping‡ comma separated†ist.'),

160 
$fÜm
['£‰šgs']['muÉË'] = 
	`¬¿y
('#type' => 'checkbox',

161 '#t™Ë' => 
	`t
('Multiple select'),

162 '#deçuÉ_v®ue' => 
$ed™
['multiple'],

163 '#desütiÚ' => 
	`t
('Allows…ostso have morehan oneerm fromhis vocabulary (alwaysrue forags).'),

165 
$fÜm
['£‰šgs']['»quœed'] = 
	`¬¿y
('#type' => 'checkbox',

166 '#t™Ë' => 
	`t
('Required'),

167 '#deçuÉ_v®ue' => 
$ed™
['required'],

168 '#desütiÚ' => 
	`t
('At†east oneerm inhis vocabulary must be selected when submitting‡…ost.'),

170 
$fÜm
['£‰šgs']['weight'] = 
	`¬¿y
('#type' => 'weight',

171 '#t™Ë' => 
	`t
('Weight'),

172 '#deçuÉ_v®ue' => 
$ed™
['weight'],

173 '#desütiÚ' => 
	`t
('Vocabularies‡re displayed in‡scending order by weight.'),

177 
$fÜm
['h›¿rchy'] = 
	`¬¿y
('#type' => 'value',

181 
$fÜm
['»ÏtiÚs'] = 
	`¬¿y
('#type' => 'value',

185 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save'));

186 ià(
	`is£t
(
$ed™
['vid'])) {

187 
$fÜm
['d–‘e'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Delete'));

188 
$fÜm
['vid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$ed™
['vid']);

189 
$fÜm
['moduË'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$ed™
['module']);

191  
$fÜm
;

192 
	}
}

197 
funùiÚ
 
	$xÚomy_fÜm_voÿbuÏry_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

199 
$fÜm_¡©e
['v®ues']['nodes'] = 
	`¬¿y_f‹r
($form_state['values']['nodes']);

200 
	`xÚomy_§ve_voÿbuÏry
(
$fÜm_¡©e
['values'])) {

201 
SAVED_NEW
:

202 
	`dru·l_£t_mes§ge
(
	`t
('C»©ed‚ew voÿbuÏry %Çme.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['name'])));

203 
	`w©chdog
('xÚomy', 'C»©ed‚ew voÿbuÏry %Çme.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['v®ues']['Çme']), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('edit'), 'admin/content/taxonomy/edit/vocabulary/'. $form_state['values']['vid']));

205 
SAVED_UPDATED
:

206 
	`dru·l_£t_mes§ge
(
	`t
('Upd©ed voÿbuÏry %Çme.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['name'])));

207 
	`w©chdog
('xÚomy', 'Upd©ed voÿbuÏry %Çme.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['v®ues']['Çme']), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('edit'), 'admin/content/taxonomy/edit/vocabulary/'. $form_state['values']['vid']));

211 
$fÜm_¡©e
['vid'] = $form_state['values']['vid'];

212 
$fÜm_¡©e
['redirect'] = 'admin/content/taxonomy';

214 
	}
}

219 
funùiÚ
 
	$xÚomy_admš_voÿbuÏry_ed™
(
$voÿbuÏry
) {

220 ià((
	`is£t
(
$_POST
['İ']è&& $_POST['İ'] =ğ
	`t
('Delete')) || isset($_POST['confirm'])) {

221  
	`dru·l_g‘_fÜm
('xÚomy_voÿbuÏry_cÚfœm_d–‘e', 
$voÿbuÏry
->
vid
);

223  
	`dru·l_g‘_fÜm
('xÚomy_fÜm_voÿbuÏry', (
¬¿y
)
$voÿbuÏry
);

224 
	}
}

229 
funùiÚ
 
	$xÚomy_admš_‹rm_ed™
(
$tid
) {

230 ià(
$‹rm
 = (
¬¿y
)
	`xÚomy_g‘_‹rm
(
$tid
)) {

231  
	`dru·l_g‘_fÜm
('xÚomy_fÜm_‹rm', 
	`xÚomy_voÿbuÏry_lßd
(
$‹rm
['vid']), $term);

233  
	`dru·l_nÙ_found
();

234 
	}
}

246 
funùiÚ
 
	$xÚomy_ov”v›w_‹rms
(&
$fÜm_¡©e
, 
$voÿbuÏry
) {

247 
glob®
 
$·g”_·ge_¬¿y
, 
$·g”_tÙ®
, 
$·g”_tÙ®_™ems
;

250 ià(
	`is£t
(
$fÜm_¡©e
['confirm_reset_alphabetical'])) {

251  
	`xÚomy_voÿbuÏry_cÚfœm_»£t_®phab‘iÿl
(
$fÜm_¡©e
, 
$voÿbuÏry
->
vid
);

254 
	`dru·l_£t_t™Ë
(
	`t
('T”m š %voÿbuÏry', 
	`¬¿y
('%voÿbuÏry' => 
$voÿbuÏry
->
Çme
)));

255 
$fÜm
 = 
	`¬¿y
(

256 '#voÿbuÏry' => (
¬¿y
)
$voÿbuÏry
,

257 '#Œ“' => 
TRUE
,

258 '#·»Á_f›lds' => 
FALSE
,

261 
$·ge
 = 
	`is£t
(
$_GET
['page']) ? $_GET['page'] : 0;

262 
$·ge_šüem’t
 = 
	`v¬ŸbË_g‘
('taxonomy_terms_per_page_admin', 100);

263 
$·ge_’Œ›s
 = 0;

264 
$befÜe_’Œ›s
 = 0;

265 
$aá”_’Œ›s
 = 0;

266 
$roÙ_’Œ›s
 = 0;

271 
$back_³ddË
 = 
NULL
;

272 
$fÜw¬d_³ddË
 = 0;

275 
$cu¼’t_·ge
 = 
	`¬¿y
();

278 ià(
$voÿbuÏry
->
gs
) {

281 
$»suÉs
 = 
	`·g”_qu”y
(
	`db_»wr™e_sql
('SELECT.*, h.·»Á FROM {‹rm_d©a} INNER JOIN {‹rm_h›¿rchy} h ON.tid = h.tid WHERE.vid = %d ORDER BY weight,‚ame', 't', 'tid'), 
$·ge_šüem’t
, 0, 
NULL
, 
$voÿbuÏry
->
vid
);

282 
$tÙ®_’Œ›s
 = 
	`db_qu”y
(
	`db_»wr™e_sql
('SELECT couÁ(*èFROM {‹rm_d©a} INNER JOIN {‹rm_h›¿rchy} h ON.tid = h.tid WHERE.vid = %d', 't', 'tid'), 
$·ge_šüem’t
, 0, 
NULL
, 
$voÿbuÏry
->
vid
);

283 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉs
)) {

284 
$key
 = 'tid:'. 
$‹rm
->
tid
 .':0';

285 
$cu¼’t_·ge
[
$key
] = 
$‹rm
;

286 
$·ge_’Œ›s
++;

291 
$‹rm_d–s
 = 
	`¬¿y
();

292 
$Œ“
 = 
	`xÚomy_g‘_Œ“
(
$voÿbuÏry
->
vid
);

293 
$‹rm
 = 
	`cu¼’t
(
$Œ“
);

296 ià(
	`em±y
(
$‹rm
)) {

300 ià(
$·ge
 && ($·g* 
$·ge_šüem’t
è> 
$befÜe_’Œ›s
 && !
	`is£t
(
$back_³ddË
)) {

301 
$befÜe_’Œ›s
++;

305 
	`–£if
 (
$·ge_’Œ›s
 > 
$·ge_šüem’t
 && 
	`is£t
(
$com¶‘e_Œ“
)) {

306 
$aá”_’Œ›s
++;

311 ià(
	`is£t
(
$‹rm
->
d•th
è&& ($‹rm->d•th > 0è&& !is£t(
$back_³ddË
)) {

312 
$back_³ddË
 = 0;

313 
$±”m
 = 
	`´ev
(
$Œ“
)) {

314 
$befÜe_’Œ›s
--;

315 
$back_³ddË
++;

316 ià(
$±”m
->
d•th
 == 0) {

317 
	`´ev
(
$Œ“
);

322 
$back_³ddË
 = 
	`is£t
($back_peddle) ? $back_peddle : 0;

325 ià(
$·ge_’Œ›s
 >ğ
$·ge_šüem’t
 + 
$back_³ddË
 + 1 && 
$‹rm
->
d•th
 =ğ0 && 
$roÙ_’Œ›s
 > 1) {

326 
$com¶‘e_Œ“
 = 
TRUE
;

328 
$aá”_’Œ›s
++;

331 ià(
$·ge_’Œ›s
 >ğ
$·ge_šüem’t
 + 
$back_³ddË
) {

332 
$fÜw¬d_³ddË
++;

336 
$·ge_’Œ›s
++;

337 
$‹rm_d–s
[
$‹rm
->
tid
] = 
	`is£t
($term_deltas[$term->tid]) ? $term_deltas[$term->tid] + 1 : 0;

338 
$key
 = 'tid:'. 
$‹rm
->
tid
 .':'. 
$‹rm_d–s
[$term->tid];

341 ià(
$·ge_’Œ›s
 == 1) {

342 
$fÜm
['#fœ¡_tid'] = 
$‹rm
->
tid
;

345 ià(
$‹rm
->
·»Ás
[0] == 0) {

346 
$roÙ_’Œ›s
++;

348 
$cu¼’t_·ge
[
$key
] = 
$‹rm
;

349 } 
$‹rm
 = 
	`Ãxt
(
$Œ“
));

352 
$tÙ®_’Œ›s
 = 
$befÜe_’Œ›s
 + 
$·ge_’Œ›s
 + 
$aá”_’Œ›s
;

353 
$·g”_tÙ®_™ems
[0] = 
$tÙ®_’Œ›s
;

354 
$·g”_·ge_¬¿y
[0] = 
$·ge
;

355 
$·g”_tÙ®
[0] = 
	`û
(
$tÙ®_’Œ›s
 / 
$·ge_šüem’t
);

360 ià(!
	`em±y
(
$fÜm_¡©e
['post'])) {

361 
$Üd”
 = 
	`¬¿y_æ
(
	`¬¿y_keys
(
$fÜm_¡©e
['post']));

362 
$cu¼’t_·ge
 = 
	`¬¿y_m”ge
(
$Üd”
, $current_page);

363 
	`fÜ—ch
 (
$cu¼’t_·ge
 
as
 
$key
 => 
$‹rm
) {

365 ià(
	`is_¬¿y
(
$fÜm_¡©e
['po¡'][
$key
]è&& 
	`is_num”ic
($form_state['post'][$key]['tid'])) {

366 
$cu¼’t_·ge
[
$key
]->
d•th
 = 
$fÜm_¡©e
['post'][$key]['depth'];

369 
	`un£t
(
$cu¼’t_·ge
[
$key
]);

375 
	`fÜ—ch
 (
$cu¼’t_·ge
 
as
 
$key
 => 
$‹rm
) {

377 
$fÜm
[
$key
]['#‹rm'] = (
¬¿y
)
$‹rm
;

378 ià(
	`is£t
(
$‹rm
->
·»Ás
)) {

379 
$fÜm
[
$key
]['#‹rm']['·»Á'] = 
$‹rm
->
·»Á
 = $‹rm->
·»Ás
[0];

380 
	`un£t
(
$fÜm
[
$key
]['#‹rm']['·»Ás'], 
$‹rm
->
·»Ás
);

383 
$fÜm
[
$key
]['v›w'] = 
	`¬¿y
('#v®ue' => 
	`l
(
$‹rm
->
Çme
, "taxonomy/term/$term->tid"));

384 ià(!
$voÿbuÏry
->
gs
 && $voÿbuÏry->
h›¿rchy
 < 2 && 
	`couÁ
(
$Œ“
) > 1) {

385 
$fÜm
['#·»Á_f›lds'] = 
TRUE
;

386 
$fÜm
[
$key
]['tid'] = 
	`¬¿y
(

388 '#v®ue' => 
$‹rm
->
tid


390 
$fÜm
[
$key
]['·»Á'] = 
	`¬¿y
(

393 '#deçuÉ_v®ue' => 
$‹rm
->
·»Á
,

395 
$fÜm
[
$key
]['d•th'] = 
	`¬¿y
(

398 '#deçuÉ_v®ue' => 
$‹rm
->
d•th
,

401 
$fÜm
[
$key
]['ed™'] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('ed™'), "admš/cÚ‹Á/xÚomy/ed™/‹rm/$‹rm->tid",‡¼ay('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
())));

404 
$fÜm
['#tÙ®_’Œ›s'] = 
$tÙ®_’Œ›s
;

405 
$fÜm
['#·ge_šüem’t'] = 
$·ge_šüem’t
;

406 
$fÜm
['#·ge_’Œ›s'] = 
$·ge_’Œ›s
;

407 
$fÜm
['#back_³ddË'] = 
$back_³ddË
;

408 
$fÜm
['#fÜw¬d_³ddË'] = 
$fÜw¬d_³ddË
;

409 
$fÜm
['#em±y_‹xt'] = 
	`t
('Noerms‡vailable.');

411 ià(!
$voÿbuÏry
->
gs
 && $voÿbuÏry->
h›¿rchy
 < 2 && 
	`couÁ
(
$Œ“
) > 1) {

412 
$fÜm
['subm™'] = 
	`¬¿y
(

414 '#v®ue' => 
	`t
('Save')

416 
$fÜm
['»£t_®phab‘iÿl'] = 
	`¬¿y
(

418 '#v®ue' => 
	`t
('Reseto‡lphabetical')

420 
$fÜm
['de¡š©iÚ'] = 
	`¬¿y
(

422 '#v®ue' => 
$_GET
['q'] . (
	`is£t
($_GET['page']) ? '?page='. $_GET['page'] : '')

426  
$fÜm
;

427 
	}
}

444 
funùiÚ
 
	$xÚomy_ov”v›w_‹rms_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

445 ià(
$fÜm_¡©e
['şicked_bu‰Ú']['#v®ue'] =ğ
	`t
('Reseto‡lphabetical')) {

447 ià(
$fÜm_¡©e
['v®ues']['»£t_®phab‘iÿl'] ==ğ
TRUE
) {

448  
	`xÚomy_voÿbuÏry_cÚfœm_»£t_®phab‘iÿl_subm™
(
$fÜm
, 
$fÜm_¡©e
);

451 
$fÜm_¡©e
['»bud'] = 
TRUE
;

452 
$fÜm_¡©e
['cÚfœm_»£t_®phab‘iÿl'] = 
TRUE
;

456 
$Üd”
 = 
	`¬¿y_æ
(
	`¬¿y_keys
(
$fÜm
['#post']));

457 
$fÜm_¡©e
['v®ues'] = 
	`¬¿y_m”ge
(
$Üd”
, $form_state['values']);

459 
$voÿbuÏry
 = 
$fÜm
['#vocabulary'];

460 
$h›¿rchy
 = 0;

462 
$chªged_‹rms
 = 
	`¬¿y
();

463 
$Œ“
 = 
	`xÚomy_g‘_Œ“
(
$voÿbuÏry
['vid']);

465 ià(
	`em±y
(
$Œ“
)) {

470 
$weight
 = 0;

471 
$‹rm
 = (
¬¿y
)
$Œ“
[0];

472 
$‹rm
['tid'] !ğ
$fÜm
['#first_tid']) {

473 ià(
$‹rm
['·»Ás'][0] =ğ0 && $‹rm['weight'] !ğ
$weight
) {

474 
$‹rm
['parent'] = $term['parents'][0];

475 
$‹rm
['weight'] = 
$weight
;

476 
$chªged_‹rms
[
$‹rm
['tid']] = $term;

478 
$weight
++;

479 
$h›¿rchy
 = 
$‹rm
['parents'][0] != 0 ? 1 : $hierarchy;

480 
$‹rm
 = (
¬¿y
)
$Œ“
[
$weight
];

484 
$Ëv–_weights
 = 
	`¬¿y
();

485 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues'] 
as
 
$tid
 => 
$v®ues
) {

486 ià(
	`is£t
(
$fÜm
[
$tid
]['#term'])) {

487 
$‹rm
 = 
$fÜm
[
$tid
]['#term'];

489 ià(
$v®ues
['·»Á'] =ğ0 && 
$‹rm
['weight'] !ğ
$weight
) {

490 
$‹rm
['weight'] = 
$weight
;

491 
$chªged_‹rms
[
$‹rm
['tid']] = $term;

494 
	`–£if
 (
$v®ues
['parent'] > 0) {

495 
$Ëv–_weights
[
$v®ues
['·»Á']] = 
	`is£t
($level_weights[$values['parent']]) ? $level_weights[$values['parent']] + 1 : 0;

496 ià(
$Ëv–_weights
[
$v®ues
['·»Á']] !ğ
$‹rm
['weight']) {

497 
$‹rm
['weight'] = 
$Ëv–_weights
[
$v®ues
['parent']];

498 
$chªged_‹rms
[
$‹rm
['tid']] = $term;

502 ià(
$v®ues
['·»Á'] !ğ
$‹rm
['parent']) {

503 
$‹rm
['·»Á'] = 
$v®ues
['parent'];

504 
$chªged_‹rms
[
$‹rm
['tid']] = $term;

506 
$h›¿rchy
 = 
$‹rm
['parent'] != 0 ? 1 : $hierarchy;

507 
$weight
++;

512 
$weight
; $weighˆ< 
	`couÁ
(
$Œ“
); $weight++) {

513 
$‹rm
 = (
¬¿y
)
$Œ“
[
$weight
];

514 ià(
$‹rm
['·»Ás'][0] =ğ0 && $‹rm['weight'] !ğ
$weight
) {

515 
$‹rm
['parent'] = $term['parents'][0];

516 
$‹rm
['weight'] = 
$weight
;

517 
$chªged_‹rms
[
$‹rm
['tid']] = $term;

519 
$h›¿rchy
 = 
$‹rm
['parents'][0] != 0 ? 1 : $hierarchy;

523 
	`fÜ—ch
 (
$chªged_‹rms
 
as
 
$‹rm
) {

524 
	`xÚomy_§ve_‹rm
(
$‹rm
);

528 ià(
$voÿbuÏry
['h›¿rchy'] !ğ
$h›¿rchy
) {

529 
$voÿbuÏry
['h›¿rchy'] = 
$h›¿rchy
;

530 
	`xÚomy_§ve_voÿbuÏry
(
$voÿbuÏry
);

532 
	}
}

540 
funùiÚ
 
	$theme_xÚomy_ov”v›w_‹rms
(
$fÜm
) {

541 
$·ge_šüem’t
 = 
$fÜm
['#page_increment'];

542 
$·ge_’Œ›s
 = 
$fÜm
['#page_entries'];

543 
$back_³ddË
 = 
$fÜm
['#back_peddle'];

544 
$fÜw¬d_³ddË
 = 
$fÜm
['#forward_peddle'];

547 ià(
$fÜm
['#parent_fields']) {

548 
	`dru·l_add_bËd¿g
('xÚomy', 'm©ch', '·»Á', '‹rm-·»Á', '‹rm-·»Á', '‹rm-id', 
FALSE
);

549 
	`dru·l_add_bËd¿g
('xÚomy', 'd•th', 'group', '‹rm-d•th', 
NULL
, NULL, 
FALSE
);

550 
	`dru·l_add_js
(
	`dru·l_g‘_·th
('module', 'taxonomy') .'/taxonomy.js');

551 
	`dru·l_add_js
(
	`¬¿y
('xÚomy' =>‡¼ay('backPeddË' => 
$back_³ddË
, 'fÜw¬dPeddË' => 
$fÜw¬d_³ddË
)), 'setting');

552 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'taxonomy') .'/taxonomy.css');

555 
$”rÜs
 = 
	`fÜm_g‘_”rÜs
(è!ğ
FALSE
 ? fÜm_g‘_”rÜs(è: 
	`¬¿y
();

556 
$rows
 = 
	`¬¿y
();

557 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$key
) {

558 ià(
	`is£t
(
$fÜm
[
$key
]['#term'])) {

559 
$‹rm
 = &
$fÜm
[
$key
];

561 
$row
 = 
	`¬¿y
();

562 
$row
[] = (
	`is£t
(
$‹rm
['#‹rm']['d•th']è&& $‹rm['#‹rm']['d•th'] > 0 ? 
	`theme
('šd’tiÚ', $‹rm['#‹rm']['d•th']è: ''è. 
	`dru·l_»nd”
($term['view']);

563 ià(
$fÜm
['#parent_fields']) {

564 
$‹rm
['tid']['#attributes']['class'] = 'term-id';

565 
$‹rm
['parent']['#attributes']['class'] = 'term-parent';

566 
$‹rm
['depth']['#attributes']['class'] = 'term-depth';

567 
$row
[0] .ğ
	`dru·l_»nd”
(
$‹rm
['parent']) . drupal_render($term['tid']) . drupal_render($term['depth']);

569 
$row
[] = 
	`dru·l_»nd”
(
$‹rm
['edit']);

571 
$row
 = 
	`¬¿y
('data' => $row);

572 
$rows
[
$key
] = 
$row
;

577 
$row_pos™iÚ
 = 0;

578 
	`fÜ—ch
 (
$rows
 
as
 
$key
 => 
$row
) {

579 
$şas£s
 = 
	`¬¿y
();

580 ià(
	`is£t
(
$fÜm
['#parent_fields'])) {

581 
$şas£s
[] = 'draggable';

585 ià(
$row_pos™iÚ
 < 
$back_³ddË
 || $row_pos™iÚ >ğ
$·ge_’Œ›s
 - 
$fÜw¬d_³ddË
) {

586 
$şas£s
[] = 'taxonomy-term-preview';

589 ià(
$row_pos™iÚ
 !=ğ0 && $row_pos™iÚ !=ğ
	`couÁ
(
$rows
) - 1) {

590 ià(
$row_pos™iÚ
 =ğ
$back_³ddË
 - 1 || $row_pos™iÚ =ğ
$·ge_’Œ›s
 - 
$fÜw¬d_³ddË
 - 1) {

591 
$şas£s
[] = 'taxonomy-term-divider-top';

593 
	`–£if
 (
$row_pos™iÚ
 =ğ
$back_³ddË
 || $row_pos™iÚ =ğ
$·ge_’Œ›s
 - 
$fÜw¬d_³ddË
) {

594 
$şas£s
[] = 'taxonomy-term-divider-bottom';

599 
	`fÜ—ch
 (
$”rÜs
 
as
 
$”rÜ_key
 => 
$”rÜ
) {

600 ià(
	`¡½os
(
$”rÜ_key
, 
$key
) === 0) {

601 
$şas£s
[] = 'error';

604 
$rows
[
$key
]['şass'] = 
	`im¶ode
(' ', 
$şas£s
);

605 
$row_pos™iÚ
++;

608 ià(
	`em±y
(
$rows
)) {

609 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
$fÜm
['#empty_text'], 'colspan' => '2'));

612 
$h—d”
 = 
	`¬¿y
(
	`t
('Name'),('Operations'));

613 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('id' => 'taxonomy'));

614 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

615 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 
$·ge_šüem’t
);

617  
$ouut
;

618 
	}
}

623 
funùiÚ
 
	$xÚomy_add_‹rm_·ge
(
$voÿbuÏry
) {

624 
	`dru·l_£t_t™Ë
(
	`t
('Add”mØ%voÿbuÏry', 
	`¬¿y
('%voÿbuÏry' => 
$voÿbuÏry
->
Çme
)));

625  
	`dru·l_g‘_fÜm
('xÚomy_fÜm_‹rm' , 
$voÿbuÏry
);

626 
	}
}

634 
funùiÚ
 
xÚomy_fÜm_‹rm
(&
$fÜm_¡©e
, 
$voÿbuÏry
, 
$ed™
 = 
	$¬¿y
()) {

635 
$ed™
 +ğ
	`¬¿y
(

638 'tid' => 
NULL
,

642 
$·»Á
 = 
	`¬¿y_keys
(
	`xÚomy_g‘_·»Ás
(
$ed™
['tid']));

643 
$fÜm
['#‹rm'] = 
$ed™
;

644 
$fÜm
['#‹rm']['·»Á'] = 
$·»Á
;

645 
$fÜm
['#voÿbuÏry'] = (
¬¿y
)
$voÿbuÏry
;

646 
$fÜm
['#voÿbuÏry']['nodes'] = 
	`dru·l_m­_assoc
(
$voÿbuÏry
->
nodes
);;

649 ià(
	`is£t
(
$fÜm_¡©e
['confirm_delete'])) {

650  
	`¬¿y_m”ge
(
$fÜm
, 
	`xÚomy_‹rm_cÚfœm_d–‘e
(
$fÜm_¡©e
, 
$ed™
['tid']));

652 
	`–£if
 (
	`is£t
(
$fÜm_¡©e
['confirm_parents'])) {

653  
	`¬¿y_m”ge
(
$fÜm
, 
	`xÚomy_‹rm_cÚfœm_·»Ás
(
$fÜm_¡©e
, 
$voÿbuÏry
));

656 
$fÜm
['id’tifiÿtiÚ'] = 
	`¬¿y
(

658 '#t™Ë' => 
	`t
('Identification'),

659 '#cŞÏpsibË' => 
TRUE
,

661 
$fÜm
['id’tifiÿtiÚ']['Çme'] = 
	`¬¿y
(

663 '#t™Ë' => 
	`t
('Term‚ame'),

664 '#deçuÉ_v®ue' => 
$ed™
['name'],

666 '#desütiÚ' => 
	`t
('The‚ame ofhiserm.'),

667 '#»quœed' => 
TRUE
);

668 
$fÜm
['id’tifiÿtiÚ']['desütiÚ'] = 
	`¬¿y
(

670 '#t™Ë' => 
	`t
('Description'),

671 '#deçuÉ_v®ue' => 
$ed™
['description'],

672 '#desütiÚ' => 
	`t
('A description ofheerm. To be displayed onaxonomy/term…ages‡nd RSS feeds.'));

674 
$fÜm
['advªûd'] = 
	`¬¿y
(

676 '#t™Ë' => 
	`t
('Advanced options'),

677 '#cŞÏpsibË' => 
TRUE
,

678 '#cŞÏp£d' => 
$voÿbuÏry
->
h›¿rchy
 > 1 ? 
FALSE
 : 
TRUE
,

685 ià(!
	`v¬ŸbË_g‘
('xÚomy_ov”ride_£ËùÜ', 
FALSE
)) {

686 
$·»Á
 = 
	`¬¿y_keys
(
	`xÚomy_g‘_·»Ás
(
$ed™
['tid']));

687 
$chd»n
 = 
	`xÚomy_g‘_Œ“
(
$voÿbuÏry
->
vid
, 
$ed™
['tid']);

690 
	`fÜ—ch
 (
$chd»n
 
as
 
$chd
) {

691 
$exşude
[] = 
$chd
->
tid
;

693 
$exşude
[] = 
$ed™
['tid'];

695 
$fÜm
['advªûd']['·»Á'] = 
	`_xÚomy_‹rm_£Ëù
(
	`t
('P¬’ts'), '·»Á', 
$·»Á
, 
$voÿbuÏry
->
vid
,('P¬’ˆ‹rms'è.'.', 1, '<'.('roÙ'è.'>', 
$exşude
);

696 
$fÜm
['advªûd']['»ÏtiÚs'] = 
	`_xÚomy_‹rm_£Ëù
(
	`t
('R–©ed”ms'), '»ÏtiÚs', 
	`¬¿y_keys
(
	`xÚomy_g‘_»Ï‹d
(
$ed™
['tid'])), 
$voÿbuÏry
->
vid
, 
NULL
, 1, '<'.('nÚe'è.'>', 
	`¬¿y
($edit['tid']));

698 
$fÜm
['advªûd']['synÚyms'] = 
	`¬¿y
(

700 '#t™Ë' => 
	`t
('Synonyms'),

701 '#deçuÉ_v®ue' => 
	`im¶ode
("\n", 
	`xÚomy_g‘_synÚyms
(
$ed™
['tid'])),

702 '#desütiÚ' => 
	`t
('Synonyms ofhiserm, one synonym…er†ine.'));

703 
$fÜm
['advªûd']['weight'] = 
	`¬¿y
(

705 '#t™Ë' => 
	`t
('Weight'),

707 '#deçuÉ_v®ue' => 
$ed™
['weight'],

708 '#desütiÚ' => 
	`t
('Terms‡re displayed in‡scending order by weight.'),

709 '#»quœed' => 
TRUE
);

710 
$fÜm
['vid'] = 
	`¬¿y
(

712 '#v®ue' => 
$voÿbuÏry
->
vid
);

713 
$fÜm
['subm™'] = 
	`¬¿y
(

715 '#v®ue' => 
	`t
('Save'));

717 ià(
$ed™
['tid']) {

718 
$fÜm
['d–‘e'] = 
	`¬¿y
(

720 '#v®ue' => 
	`t
('Delete'));

721 
$fÜm
['tid'] = 
	`¬¿y
(

723 '#v®ue' => 
$ed™
['tid']);

726 
$fÜm
['de¡š©iÚ'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$_GET
['q']);

729  
$fÜm
;

730 
	}
}

737 
funùiÚ
 
	$xÚomy_fÜm_‹rm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

738 ià(
	`is£t
(
$fÜm_¡©e
['v®ues']['weight']è&& !
	`is_num”ic
($form_state['values']['weight'])) {

739 
	`fÜm_£t_”rÜ
('weight', 
	`t
('Weight value must be‚umeric.'));

741 
	}
}

748 
funùiÚ
 
	$xÚomy_fÜm_‹rm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

749 ià(
$fÜm_¡©e
['şicked_bu‰Ú']['#v®ue'] =ğ
	`t
('Delete')) {

751 ià(
$fÜm_¡©e
['v®ues']['d–‘e'] ==ğ
TRUE
) {

752  
	`xÚomy_‹rm_cÚfœm_d–‘e_subm™
(
$fÜm
, 
$fÜm_¡©e
);

755 
$fÜm_¡©e
['»bud'] = 
TRUE
;

756 
$fÜm_¡©e
['cÚfœm_d–‘e'] = 
TRUE
;

760 
	`–£if
 (
$fÜm_¡©e
['şicked_bu‰Ú']['#v®ue'] =ğ
	`t
('Save'è&& !
$fÜm
['#voÿbuÏry']['gs'] && 
	`couÁ
($form_state['values']['parent']) > 1 && $form['#vocabulary']['hierarchy'] < 2) {

761 
$fÜm_¡©e
['»bud'] = 
TRUE
;

762 
$fÜm_¡©e
['cÚfœm_·»Ás'] = 
TRUE
;

766 
	`xÚomy_§ve_‹rm
(
$fÜm_¡©e
['values'])) {

767 
SAVED_NEW
:

768 
	`dru·l_£t_mes§ge
(
	`t
('C»©ed‚ew”m %‹rm.', 
	`¬¿y
('%‹rm' => 
$fÜm_¡©e
['values']['name'])));

769 
	`w©chdog
('xÚomy', 'C»©ed‚ew”m %‹rm.', 
	`¬¿y
('%‹rm' => 
$fÜm_¡©e
['v®ues']['Çme']), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('edit'), 'admin/content/taxonomy/edit/term/'. $form_state['values']['tid']));

771 
SAVED_UPDATED
:

772 
	`dru·l_£t_mes§ge
(
	`t
('Upd©ed”m %‹rm.', 
	`¬¿y
('%‹rm' => 
$fÜm_¡©e
['values']['name'])));

773 
	`w©chdog
('xÚomy', 'Upd©ed”m %‹rm.', 
	`¬¿y
('%‹rm' => 
$fÜm_¡©e
['v®ues']['Çme']), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('edit'), 'admin/content/taxonomy/edit/term/'. $form_state['values']['tid']));

777 ià(!
$fÜm
['#vocabulary']['tags']) {

778 
$cu¼’t_·»Á_couÁ
 = 
	`couÁ
(
$fÜm_¡©e
['values']['parent']);

779 
$´evious_·»Á_couÁ
 = 
	`couÁ
(
$fÜm
['#term']['parent']);

781 ià(
$cu¼’t_·»Á_couÁ
 =ğ1 && 
	`is£t
(
$fÜm_¡©e
['values']['parent'][''])) {

782 
$cu¼’t_·»Á_couÁ
 = 0;

783 
$fÜm_¡©e
['v®ues']['·»Á'] = 
	`¬¿y
();

788 ià(
$cu¼’t_·»Á_couÁ
 < 
$´evious_·»Á_couÁ
 && $current_parent_count < 2) {

789 
	`xÚomy_check_voÿbuÏry_h›¿rchy
(
$fÜm
['#voÿbuÏry'], 
$fÜm_¡©e
['values']);

793 
	`–£if
 (
$cu¼’t_·»Á_couÁ
 > 
$´evious_·»Á_couÁ
 && 
$fÜm
['#vocabulary']['hierarchy'] < 2) {

794 
$fÜm
['#voÿbuÏry']['h›¿rchy'] = 
$cu¼’t_·»Á_couÁ
 == 1 ? 1 : 2;

795 
	`xÚomy_§ve_voÿbuÏry
(
$fÜm
['#vocabulary']);

799 
$fÜm_¡©e
['tid'] = $form_state['values']['tid'];

800 
$fÜm_¡©e
['redirect'] = 'admin/content/taxonomy';

802 
	}
}

810 
funùiÚ
 
	$xÚomy_‹rm_cÚfœm_·»Ás
(&
$fÜm_¡©e
, 
$voÿbuÏry
) {

811 
$fÜm
 = 
	`¬¿y
();

812 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm_¡©e
['v®ues']è
as
 
$key
) {

813 
$fÜm
[
$key
] = 
	`¬¿y
(

815 '#v®ue' => 
$fÜm_¡©e
['v®ues'][
$key
],

818 
$que¡iÚ
 = 
	`t
('Set multipleerm…arents?');

819 
$desütiÚ
 = '<p>'. 
	`t
("Addšg muÉË…¬’t tØ¨‹rm wÈÿu£h%voÿbuÏry voÿbuÏryØlook fÜ muÉË…¬’t Úƒv”y”m. Beÿu£ muÉË…¬’t ¬nÙ suµÜ‹d wh’ usšghd¿g‡nd drİ oušš‹rçû, d¿g‡nd drİ wÈbdi§bËd iàyouƒÇbËhi İtiÚ. Iàyou choo£ØhavmuÉË…¬’ts, you wÈÚly babËØ£ˆ·»Á by usšgh‹rmƒd™ fÜm.", 
	`¬¿y
('%voÿbuÏry' => 
$voÿbuÏry
->
Çme
)) .'</p>';

820 
$desütiÚ
 .ğ'<p>'. 
	`t
("You may„e-enablehe drag‡nd drop interface‡t‡nyime by„educing multiple…arentso‡ single…arent forheerms inhis vocabulary.") .'</p>';

821  
	`cÚfœm_fÜm
(
$fÜm
, 
$que¡iÚ
, 
	`dru·l_g‘_de¡š©iÚ
(), 
$desütiÚ
, 
	`t
('Set multiple…arents'));

822 
	}
}

830 
funùiÚ
 
	$xÚomy_‹rm_cÚfœm_d–‘e
(&
$fÜm_¡©e
, 
$tid
) {

831 
$‹rm
 = 
	`xÚomy_g‘_‹rm
(
$tid
);

833 
$fÜm
['ty³'] = 
	`¬¿y
('#type' => 'value', '#value' => 'term');

834 
$fÜm
['Çme'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$‹rm
->
Çme
);

835 
$fÜm
['tid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$tid
);

836 
$fÜm
['d–‘e'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
TRUE
);

837  
	`cÚfœm_fÜm
(
$fÜm
,

838 
	`t
('Are you sure you wanto deleteheerm %title?',

839 
	`¬¿y
('%t™Ë' => 
$‹rm
->
Çme
)),

841 
	`t
('Deleting‡erm will delete‡ll its children ifhere‡re‡ny. This‡ction cannot be undone.'),

842 
	`t
('Delete'),

843 
	`t
('Cancel'));

844 
	}
}

851 
funùiÚ
 
	$xÚomy_‹rm_cÚfœm_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

852 
	`xÚomy_d–_‹rm
(
$fÜm_¡©e
['values']['tid']);

853 
	`xÚomy_check_voÿbuÏry_h›¿rchy
(
$fÜm
['#voÿbuÏry'], 
$fÜm_¡©e
['values']);

854 
	`dru·l_£t_mes§ge
(
	`t
('D–‘ed”m %Çme.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['name'])));

855 
	`w©chdog
('xÚomy', 'D–‘ed”m %Çme.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['v®ues']['Çme']), 
WATCHDOG_NOTICE
);

856 
$fÜm_¡©e
['redirect'] = 'admin/content/taxonomy';

858 
	}
}

866 
funùiÚ
 
	$xÚomy_voÿbuÏry_cÚfœm_d–‘e
(&
$fÜm_¡©e
, 
$vid
) {

867 
$voÿbuÏry
 = 
	`xÚomy_voÿbuÏry_lßd
(
$vid
);

869 
$fÜm
['ty³'] = 
	`¬¿y
('#type' => 'value', '#value' => 'vocabulary');

870 
$fÜm
['vid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$vid
);

871 
$fÜm
['Çme'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$voÿbuÏry
->
Çme
);

872  
	`cÚfœm_fÜm
(
$fÜm
,

873 
	`t
('Are you sure you wanto deletehe vocabulary %title?',

874 
	`¬¿y
('%t™Ë' => 
$voÿbuÏry
->
Çme
)),

876 
	`t
('Deleting‡ vocabulary will delete‡llheerms in it. This‡ction cannot be undone.'),

877 
	`t
('Delete'),

878 
	`t
('Cancel'));

879 
	}
}

886 
funùiÚ
 
	$xÚomy_voÿbuÏry_cÚfœm_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

887 
$¡©us
 = 
	`xÚomy_d–_voÿbuÏry
(
$fÜm_¡©e
['values']['vid']);

888 
	`dru·l_£t_mes§ge
(
	`t
('D–‘ed voÿbuÏry %Çme.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['name'])));

889 
	`w©chdog
('xÚomy', 'D–‘ed voÿbuÏry %Çme.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['v®ues']['Çme']), 
WATCHDOG_NOTICE
);

890 
$fÜm_¡©e
['redirect'] = 'admin/content/taxonomy';

892 
	}
}

900 
funùiÚ
 
	$xÚomy_voÿbuÏry_cÚfœm_»£t_®phab‘iÿl
(&
$fÜm_¡©e
, 
$vid
) {

901 
$voÿbuÏry
 = 
	`xÚomy_voÿbuÏry_lßd
(
$vid
);

903 
$fÜm
['ty³'] = 
	`¬¿y
('#type' => 'value', '#value' => 'vocabulary');

904 
$fÜm
['vid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$vid
);

905 
$fÜm
['Çme'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$voÿbuÏry
->
Çme
);

906 
$fÜm
['»£t_®phab‘iÿl'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
TRUE
);

907  
	`cÚfœm_fÜm
(
$fÜm
,

908 
	`t
('Are you sure you wanto„esethe vocabulary %titleo‡lphabetical order?',

909 
	`¬¿y
('%t™Ë' => 
$voÿbuÏry
->
Çme
)),

910 'admš/cÚ‹Á/xÚomy/'. 
$vid
,

911 
	`t
('Resetting‡ vocabulary will discard‡ll custom ordering‡nd sort items‡lphabetically.'),

912 
	`t
('Reseto‡lphabetical'),

913 
	`t
('Cancel'));

914 
	}
}

921 
funùiÚ
 
	$xÚomy_voÿbuÏry_cÚfœm_»£t_®phab‘iÿl_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

922 
	`db_qu”y
('UPDATE {‹rm_d©a} SET weighˆğ0 WHERE vid = %d', 
$fÜm_¡©e
['values']['vid']);

923 
	`dru·l_£t_mes§ge
(
	`t
('Re£ˆvoÿbuÏry %ÇmtØ®phab‘iÿÈÜd”.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['name'])));

924 
	`w©chdog
('xÚomy', 'Re£ˆvoÿbuÏry %ÇmtØ®phab‘iÿÈÜd”.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['v®ues']['Çme']), 
WATCHDOG_NOTICE
);

925 
$fÜm_¡©e
['redirect'] = 'admin/content/taxonomy/'. $form_state['values']['vid'];

926 
	}
}

	@/srv/http/subs/notes/www/modules/taxonomy/taxonomy.module

1 <?
php


12 
funùiÚ
 
	$xÚomy_³rm
() {

13  
	`¬¿y
('administeraxonomy');

14 
	}
}

19 
funùiÚ
 
	$xÚomy_theme
() {

20  
	`¬¿y
(

21 'xÚomy_‹rm_£Ëù' => 
	`¬¿y
(

22 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

24 'xÚomy_‹rm_·ge' => 
	`¬¿y
(

25 '¬gum’ts' => 
	`¬¿y
('tids' =>‡¼ay(), '»suÉ' => 
NULL
),

27 'xÚomy_ov”v›w_voÿbuÏr›s' => 
	`¬¿y
(

28 '¬gum’ts' => 
	`¬¿y
('form' =>‡rray()),

30 'xÚomy_ov”v›w_‹rms' => 
	`¬¿y
(

31 '¬gum’ts' => 
	`¬¿y
('form' =>‡rray()),

34 
	}
}

48 
funùiÚ
 
	$xÚomy_lšk
(
$ty³
, 
$node
 = 
NULL
) {

49 ià(
$ty³
 =ğ'xÚomy”ms' && 
$node
 !ğ
NULL
) {

50 
$lšks
 = 
	`¬¿y
();

52 ià(
	`is£t
(
$node
->
bud_mode
è&& $node->bud_mod=ğ
NODE_BUILD_PREVIEW
) {

53 
$node
->
xÚomy
 = 
	`xÚomy_´ev›w_‹rms
($node);

55 ià(!
	`em±y
(
$node
->
xÚomy
)) {

56 
	`fÜ—ch
 (
$node
->
xÚomy
 
as
 
$‹rm
) {

60 ià(
	`is_objeù
(
$‹rm
)) {

61 
$lšks
['xÚomy_‹rm_'. 
$‹rm
->
tid
] = 
	`¬¿y
(

62 't™Ë' => 
$‹rm
->
Çme
,

63 'h»f' => 
	`xÚomy_‹rm_·th
(
$‹rm
),

64 '©Œibu‹s' => 
	`¬¿y
('»l' => 'g', 't™Ë' => 
	`¡r_gs
(
$‹rm
->
desütiÚ
))

70 
	`fÜ—ch
 (
$‹rm
 
as
 
$ä“_ty³d
) {

71 
$ty³d_‹rms
 = 
	`dru·l_ex¶ode_gs
(
$ä“_ty³d
);

72 
	`fÜ—ch
 (
$ty³d_‹rms
 
as
 
$ty³d_‹rm
) {

73 
$lšks
['xÚomy_´ev›w_‹rm_'. 
$ty³d_‹rm
] = 
	`¬¿y
(

74 't™Ë' => 
$ty³d_‹rm
,

84 
	`dru·l_®‹r
('lšk', 
$lšks
, 
$node
);

86  
$lšks
;

88 
	}
}

99 
funùiÚ
 
	$xÚomy_‹rm_·th
(
$‹rm
) {

100 
$voÿbuÏry
 = 
	`xÚomy_voÿbuÏry_lßd
(
$‹rm
->
vid
);

101 ià(
$voÿbuÏry
->
moduË
 !ğ'xÚomy' && 
$·th
 = 
	`moduË_švoke
($voÿbuÏry->moduË, '‹rm_·th', 
$‹rm
)) {

102  
$·th
;

104  'xÚomy/‹rm/'. 
$‹rm
->
tid
;

105 
	}
}

110 
funùiÚ
 
	$xÚomy_m’u
() {

111 
$™ems
['admš/cÚ‹Á/xÚomy'] = 
	`¬¿y
(

115 '·g¬gum’ts' => 
	`¬¿y
('taxonomy_overview_vocabularies'),

116 'acûs ¬gum’ts' => 
	`¬¿y
('administeraxonomy'),

120 
$™ems
['admš/cÚ‹Á/xÚomy/li¡'] = 
	`¬¿y
(

122 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

126 
$™ems
['admš/cÚ‹Á/xÚomy/add/voÿbuÏry'] = 
	`¬¿y
(

129 '·g¬gum’ts' => 
	`¬¿y
('taxonomy_form_vocabulary'),

130 'acûs ¬gum’ts' => 
	`¬¿y
('administeraxonomy'),

131 'ty³' => 
MENU_LOCAL_TASK
,

136 
$™ems
['admš/cÚ‹Á/xÚomy/ed™/voÿbuÏry/%xÚomy_voÿbuÏry'] = 
	`¬¿y
(

139 '·g¬gum’ts' => 
	`¬¿y
(5),

140 'acûs ¬gum’ts' => 
	`¬¿y
('administeraxonomy'),

141 'ty³' => 
MENU_CALLBACK
,

145 
$™ems
['admš/cÚ‹Á/xÚomy/ed™/‹rm'] = 
	`¬¿y
(

148 'acûs ¬gum’ts' => 
	`¬¿y
('administeraxonomy'),

149 'ty³' => 
MENU_CALLBACK
,

153 
$™ems
['xÚomy/‹rm/%'] = 
	`¬¿y
(

156 '·g¬gum’ts' => 
	`¬¿y
(2),

157 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

158 'ty³' => 
MENU_CALLBACK
,

162 
$™ems
['xÚomy/autocom¶‘e'] = 
	`¬¿y
(

165 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

166 'ty³' => 
MENU_CALLBACK
,

169 
$™ems
['admš/cÚ‹Á/xÚomy/%xÚomy_voÿbuÏry'] = 
	`¬¿y
(

172 '·g¬gum’ts' => 
	`¬¿y
('taxonomy_overview_terms', 3),

173 'acûs ¬gum’ts' => 
	`¬¿y
('administeraxonomy'),

174 'ty³' => 
MENU_CALLBACK
,

178 
$™ems
['admš/cÚ‹Á/xÚomy/%xÚomy_voÿbuÏry/li¡'] = 
	`¬¿y
(

180 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

184 
$™ems
['admš/cÚ‹Á/xÚomy/%xÚomy_voÿbuÏry/add/‹rm'] = 
	`¬¿y
(

187 '·g¬gum’ts' => 
	`¬¿y
(3),

188 'acûs ¬gum’ts' => 
	`¬¿y
('administeraxonomy'),

189 'ty³' => 
MENU_LOCAL_TASK
,

194  
$™ems
;

195 
	}
}

197 
funùiÚ
 
	$xÚomy_§ve_voÿbuÏry
(&
$ed™
) {

198 
$ed™
['nodes'] = 
	`em±y
($ed™['nodes']è? 
	`¬¿y
() : $edit['nodes'];

200 ià(!
	`is£t
(
$ed™
['module'])) {

201 
$ed™
['module'] = 'taxonomy';

204 ià(!
	`em±y
(
$ed™
['vid']) && !empty($edit['name'])) {

205 
	`dru·l_wr™e_»cÜd
('voÿbuÏry', 
$ed™
, 'vid');

206 
	`db_qu”y
("DELETE FROM {voÿbuÏry_node_ty³s} WHERE vid = %d", 
$ed™
['vid']);

207 
	`fÜ—ch
 (
$ed™
['nodes'] 
as
 
$ty³
 => 
$£Ëùed
) {

208 
	`db_qu”y
("INSERT INTO {voÿbuÏry_node_ty³s} (vid,y³èVALUES (%d, '%s')", 
$ed™
['vid'], 
$ty³
);

210 
	`moduË_švoke_®l
('xÚomy', 'upd©e', 'voÿbuÏry', 
$ed™
);

211 
$¡©us
 = 
SAVED_UPDATED
;

213 ià(!
	`em±y
(
$ed™
['vid'])) {

214 
$¡©us
 = 
	`xÚomy_d–_voÿbuÏry
(
$ed™
['vid']);

217 
	`dru·l_wr™e_»cÜd
('voÿbuÏry', 
$ed™
);

218 
	`fÜ—ch
 (
$ed™
['nodes'] 
as
 
$ty³
 => 
$£Ëùed
) {

219 
	`db_qu”y
("INSERT INTO {voÿbuÏry_node_ty³s} (vid,y³èVALUES (%d, '%s')", 
$ed™
['vid'], 
$ty³
);

221 
	`moduË_švoke_®l
('xÚomy', 'š£¹', 'voÿbuÏry', 
$ed™
);

222 
$¡©us
 = 
SAVED_NEW
;

225 
	`ÿche_ş—r_®l
();

227  
$¡©us
;

228 
	}
}

238 
funùiÚ
 
	$xÚomy_d–_voÿbuÏry
(
$vid
) {

239 
$voÿbuÏry
 = (
¬¿y
è
	`xÚomy_voÿbuÏry_lßd
(
$vid
);

241 
	`db_qu”y
('DELETE FROM {voÿbuÏry} WHERE vid = %d', 
$vid
);

242 
	`db_qu”y
('DELETE FROM {voÿbuÏry_node_ty³s} WHERE vid = %d', 
$vid
);

243 
$»suÉ
 = 
	`db_qu”y
('SELECTid FROM {‹rm_d©a} WHERE vid = %d', 
$vid
);

244 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

245 
	`xÚomy_d–_‹rm
(
$‹rm
->
tid
);

248 
	`moduË_švoke_®l
('xÚomy', 'd–‘e', 'voÿbuÏry', 
$voÿbuÏry
);

250 
	`ÿche_ş—r_®l
();

252  
SAVED_DELETED
;

253 
	}
}

270 
funùiÚ
 
	$xÚomy_check_voÿbuÏry_h›¿rchy
(
$voÿbuÏry
, 
$chªged_‹rm
) {

271 
$Œ“
 = 
	`xÚomy_g‘_Œ“
(
$voÿbuÏry
['vid']);

272 
$h›¿rchy
 = 0;

273 
	`fÜ—ch
 (
$Œ“
 
as
 
$‹rm
) {

275 ià(
$‹rm
->
tid
 =ğ
$chªged_‹rm
['tid']) {

276 
$‹rm
 = (
objeù
)
$chªged_‹rm
;

277 
$‹rm
->
·»Ás
 = $‹rm->
·»Á
;

280 ià(
	`couÁ
(
$‹rm
->
·»Ás
) > 1) {

281 
$h›¿rchy
 = 2;

284 
	`–£if
 (
	`couÁ
(
$‹rm
->
·»Ás
è=ğ1 && 0 !=ğ
	`¬¿y_shiá
($term->parents)) {

285 
$h›¿rchy
 = 1;

288 ià(
$h›¿rchy
 !ğ
$voÿbuÏry
['hierarchy']) {

289 
$voÿbuÏry
['h›¿rchy'] = 
$h›¿rchy
;

290 
	`xÚomy_§ve_voÿbuÏry
(
$voÿbuÏry
);

293  
$h›¿rchy
;

294 
	}
}

303 
funùiÚ
 
	$xÚomy_§ve_‹rm
(&
$fÜm_v®ues
) {

304 
$fÜm_v®ues
 +ğ
	`¬¿y
(

309 ià(!
	`em±y
(
$fÜm_v®ues
['tid']) && $form_values['name']) {

310 
	`dru·l_wr™e_»cÜd
('‹rm_d©a', 
$fÜm_v®ues
, 'tid');

311 
$hook
 = 'update';

312 
$¡©us
 = 
SAVED_UPDATED
;

314 ià(!
	`em±y
(
$fÜm_v®ues
['tid'])) {

315  
	`xÚomy_d–_‹rm
(
$fÜm_v®ues
['tid']);

318 
	`dru·l_wr™e_»cÜd
('‹rm_d©a', 
$fÜm_v®ues
);

319 
$hook
 = 'insert';

320 
$¡©us
 = 
SAVED_NEW
;

323 
	`db_qu”y
('DELETE FROM {‹rm_»ÏtiÚ} WHEREid1 = %d ORid2 = %d', 
$fÜm_v®ues
['tid'], $form_values['tid']);

324 ià(!
	`em±y
(
$fÜm_v®ues
['relations'])) {

325 
	`fÜ—ch
 (
$fÜm_v®ues
['»ÏtiÚs'] 
as
 
$»Ï‹d_id
) {

326 ià(
$»Ï‹d_id
 != 0) {

327 
	`db_qu”y
('INSERT INTO {‹rm_»ÏtiÚ} (tid1,id2èVALUES (%d, %d)', 
$fÜm_v®ues
['tid'], 
$»Ï‹d_id
);

332 
	`db_qu”y
('DELETE FROM {‹rm_h›¿rchy} WHEREid = %d', 
$fÜm_v®ues
['tid']);

333 ià(!
	`is£t
(
$fÜm_v®ues
['·»Á']è|| 
	`em±y
($form_values['parent'])) {

334 
$fÜm_v®ues
['·»Á'] = 
	`¬¿y
(0);

336 ià(
	`is_¬¿y
(
$fÜm_v®ues
['parent'])) {

337 
	`fÜ—ch
 (
$fÜm_v®ues
['·»Á'] 
as
 
$·»Á
) {

338 ià(
	`is_¬¿y
(
$·»Á
)) {

339 
	`fÜ—ch
 (
$·»Á
 
as
 
$tid
) {

340 
	`db_qu”y
('INSERT INTO {‹rm_h›¿rchy} (tid,…¬’tèVALUES (%d, %d)', 
$fÜm_v®ues
['tid'], 
$tid
);

344 
	`db_qu”y
('INSERT INTO {‹rm_h›¿rchy} (tid,…¬’tèVALUES (%d, %d)', 
$fÜm_v®ues
['tid'], 
$·»Á
);

349 
	`db_qu”y
('INSERT INTO {‹rm_h›¿rchy} (tid,…¬’tèVALUES (%d, %d)', 
$fÜm_v®ues
['tid'], $form_values['parent']);

352 
	`db_qu”y
('DELETE FROM {‹rm_synÚym} WHEREid = %d', 
$fÜm_v®ues
['tid']);

353 ià(!
	`em±y
(
$fÜm_v®ues
['synonyms'])) {

354 
	`fÜ—ch
 (
	`ex¶ode
 ("\n", 
	`¡r_»¶aû
("\r", '', 
$fÜm_v®ues
['synÚyms'])è
as
 
$synÚym
) {

355 ià(
$synÚym
) {

356 
	`db_qu”y
("INSERT INTO {‹rm_synÚym} (tid,‚ameèVALUES (%d, '%s')", 
$fÜm_v®ues
['tid'], 
	`chİ
(
$synÚym
));

361 ià(
	`is£t
(
$hook
)) {

362 
	`moduË_švoke_®l
('xÚomy', 
$hook
, '‹rm', 
$fÜm_v®ues
);

365 
	`ÿche_ş—r_®l
();

367  
$¡©us
;

368 
	}
}

378 
funùiÚ
 
	$xÚomy_d–_‹rm
(
$tid
) {

379 
$tids
 = 
	`¬¿y
(
$tid
);

380 
$tids
) {

381 
$chd»n_tids
 = 
$Üphªs
 = 
	`¬¿y
();

382 
	`fÜ—ch
 (
$tids
 
as
 
$tid
) {

384 ià(
$chd»n
 = 
	`xÚomy_g‘_chd»n
(
$tid
)) {

385 
	`fÜ—ch
 (
$chd»n
 
as
 
$chd
) {

387 
$·»Ás
 = 
	`xÚomy_g‘_·»Ás
(
$chd
->
tid
);

388 ià(
	`couÁ
(
$·»Ás
) == 1) {

389 
$Üphªs
[] = 
$chd
->
tid
;

394 
$‹rm
 = (
¬¿y
è
	`xÚomy_g‘_‹rm
(
$tid
);

396 
	`db_qu”y
('DELETE FROM {‹rm_d©a} WHEREid = %d', 
$tid
);

397 
	`db_qu”y
('DELETE FROM {‹rm_h›¿rchy} WHEREid = %d', 
$tid
);

398 
	`db_qu”y
('DELETE FROM {‹rm_»ÏtiÚ} WHEREid1 = %d ORid2 = %d', 
$tid
, $tid);

399 
	`db_qu”y
('DELETE FROM {‹rm_synÚym} WHEREid = %d', 
$tid
);

400 
	`db_qu”y
('DELETE FROM {‹rm_node} WHEREid = %d', 
$tid
);

402 
	`moduË_švoke_®l
('xÚomy', 'd–‘e', '‹rm', 
$‹rm
);

405 
$tids
 = 
$Üphªs
;

408 
	`ÿche_ş—r_®l
();

410  
SAVED_DELETED
;

411 
	}
}

431 
funùiÚ
 
xÚomy_fÜm
(
$vid
, 
$v®ue
 = 0, 
$h–p
 = 
NULL
, 
$Çme
 = 'taxonomy') {

432 
$voÿbuÏry
 = 
xÚomy_voÿbuÏry_lßd
(
$vid
);

433 
	g$h–p
 = (
$h–p
è? $h–°: 
f‹r_xss_admš
(
$voÿbuÏry
->
h–p
);

435 ià(!
	g$voÿbuÏry
->
	gmuÉË
) {

436 
	g$bÏnk
 = (
$voÿbuÏry
->
»quœed
è? 
t
('- Please choose -') :('- None selected -');

439 
	g$bÏnk
 = (
$voÿbuÏry
->
»quœed
è? 0 : 
t
('- None -');

442  
_xÚomy_‹rm_£Ëù
(
check_¶aš
(
$voÿbuÏry
->
Çme
), 
$Çme
, 
$v®ue
, 
$vid
, 
$h–p
, 
štv®
($voÿbuÏry->
muÉË
), 
$bÏnk
);

448 
funùiÚ
 
	$xÚomy_fÜm_®l
(
$ä“_gs
 = 0) {

449 
$voÿbuÏr›s
 = 
	`xÚomy_g‘_voÿbuÏr›s
();

450 
$İtiÚs
 = 
	`¬¿y
();

451 
	`fÜ—ch
 (
$voÿbuÏr›s
 
as
 
$vid
 => 
$voÿbuÏry
) {

452 ià(
$voÿbuÏry
->
gs
 && !
$ä“_gs
) { ; }

453 
$Œ“
 = 
	`xÚomy_g‘_Œ“
(
$vid
);

454 ià(
$Œ“
 && (
	`couÁ
($tree) > 0)) {

455 
$İtiÚs
[
$voÿbuÏry
->
Çme
] = 
	`¬¿y
();

456 
	`fÜ—ch
 (
$Œ“
 
as
 
$‹rm
) {

457 
$İtiÚs
[
$voÿbuÏry
->
Çme
][
$‹rm
->
tid
] = 
	`¡r_»³©
('-', $‹rm->
d•th
) . $term->name;

461  
$İtiÚs
;

462 
	}
}

470 
funùiÚ
 
	$xÚomy_g‘_voÿbuÏr›s
(
$ty³
 = 
NULL
) {

471 ià(
$ty³
) {

472 
$»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
("SELECT v.vid, v.*,‚.ty³ FROM {voÿbuÏry} v LEFT JOIN {voÿbuÏry_node_ty³s}‚ ON v.vid =‚.vid WHERE‚.ty³ = '%s' ORDER BY v.weight, v.Çme", 'v', 'vid'), 
$ty³
);

475 
$»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
('SELECT v.*,‚.type FROM {vocabulary} v LEFT JOIN {vocabulary_node_types}‚ ON v.vid =‚.vid ORDER BY v.weight, v.name', 'v', 'vid'));

478 
$voÿbuÏr›s
 = 
	`¬¿y
();

479 
$node_ty³s
 = 
	`¬¿y
();

480 
$voc
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

483 ià(
	`is£t
(
$voc
->
ty³
)) {

484 
$node_ty³s
[
$voc
->
vid
][$voc->
ty³
] = $voc->type;

485 
	`un£t
(
$voc
->
ty³
);

486 
$voc
->
nodes
 = 
$node_ty³s
[$voc->
vid
];

488 
	`–£if
 (!
	`is£t
(
$voc
->
nodes
)) {

489 
$voc
->
nodes
 = 
	`¬¿y
();

491 
$voÿbuÏr›s
[
$voc
->
vid
] = $voc;

494  
$voÿbuÏr›s
;

495 
	}
}

504 
funùiÚ
 
	$xÚomy_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

505 ià(
	`is£t
(
$fÜm
['ty³']è&& is£t($fÜm['#node']è&& (!
	`v¬ŸbË_g‘
('xÚomy_ov”ride_£ËùÜ', 
FALSE
)è&& $fÜm['ty³']['#v®ue'] .'_node_fÜm' =ğ
$fÜm_id
) {

506 
$node
 = 
$fÜm
['#node'];

508 ià(!
	`is£t
(
$node
->
xÚomy
)) {

509 
$‹rms
 = 
	`em±y
(
$node
->
nid
è? 
	`¬¿y
(è: 
	`xÚomy_node_g‘_‹rms
($node);

513 
	`»£t
(
$node
->
xÚomy
);

514 ià(!
	`is_objeù
(
	`cu¼’t
(
$node
->
xÚomy
))) {

515 
$node
->
xÚomy
 = 
	`xÚomy_´ev›w_‹rms
($node);

517 
$‹rms
 = 
$node
->
xÚomy
;

520 
$c
 = 
	`db_qu”y
(
	`db_»wr™e_sql
("SELECT v.* FROM {voÿbuÏry} v INNER JOIN {voÿbuÏry_node_ty³s}‚ ON v.vid =‚.vid WHERE‚.ty³ = '%s' ORDER BY v.weight, v.Çme", 'v', 'vid'), 
$node
->
ty³
);

522 
$voÿbuÏry
 = 
	`db_ãtch_objeù
(
$c
)) {

523 ià(
$voÿbuÏry
->
gs
) {

524 ià(
	`is£t
(
$fÜm_¡©e
['node_preview'])) {

527 
$ty³d_¡ršg
 = 
$node
->
xÚomy
['gs'][
$voÿbuÏry
->
vid
];

530 
$ty³d_¡ršg
 = 
	`xÚomy_im¶ode_gs
(
$‹rms
, 
$voÿbuÏry
->
vid
è. (
	`¬¿y_key_exi¡s
('gs', $‹rmsè? $‹rms['gs'][$voÿbuÏry->vid] : 
NULL
);

532 ià(
$voÿbuÏry
->
h–p
) {

533 
$h–p
 = 
	`f‹r_xss_admš
(
$voÿbuÏry
->
h–p
);

536 
$h–p
 = 
	`t
('A comma-separated†ist oferms describinghis content. Example: funny, bungee jumping, "Company, Inc.".');

538 
$fÜm
['xÚomy']['gs'][
$voÿbuÏry
->
vid
] = 
	`¬¿y
('#type' => 'textfield',

539 '#t™Ë' => 
$voÿbuÏry
->
Çme
,

540 '#desütiÚ' => 
$h–p
,

541 '#»quœed' => 
$voÿbuÏry
->
»quœed
,

542 '#deçuÉ_v®ue' => 
$ty³d_¡ršg
,

543 '#autocom¶‘e_·th' => 'xÚomy/autocom¶‘e/'. 
$voÿbuÏry
->
vid
,

544 '#weight' => 
$voÿbuÏry
->
weight
,

550 
$deçuÉ_‹rms
 = 
	`¬¿y
();

551 
	`fÜ—ch
 (
$‹rms
 
as
 
$‹rm
) {

553 ià(
	`is£t
(
$‹rm
->
vid
è&& $‹rm->vid =ğ
$voÿbuÏry
->vid) {

554 
$deçuÉ_‹rms
[
$‹rm
->
tid
] = $term;

557 
$fÜm
['xÚomy'][
$voÿbuÏry
->
vid
] = 
	`xÚomy_fÜm
($voÿbuÏry->vid, 
	`¬¿y_keys
(
$deçuÉ_‹rms
), 
	`f‹r_xss_admš
($voÿbuÏry->
h–p
));

558 
$fÜm
['xÚomy'][
$voÿbuÏry
->
vid
]['#weight'] = $voÿbuÏry->
weight
;

559 
$fÜm
['xÚomy'][
$voÿbuÏry
->
vid
]['#»quœed'] = $voÿbuÏry->
»quœed
;

562 ià(!
	`em±y
(
$fÜm
['xÚomy']è&& 
	`is_¬¿y
($form['taxonomy'])) {

563 ià(
	`couÁ
(
$fÜm
['taxonomy']) > 1) {

565 
$fÜm
['xÚomy'] +ğ
	`¬¿y
(

567 '#t™Ë' => 
	`t
('Vocabularies'),

568 '#cŞÏpsibË' => 
TRUE
,

569 '#cŞÏp£d' => 
FALSE
,

572 
$fÜm
['taxonomy']['#weight'] = -3;

573 
$fÜm
['xÚomy']['#Œ“'] = 
TRUE
;

576 
	}
}

587 
funùiÚ
 
	$xÚomy_´ev›w_‹rms
(
$node
) {

588 
$xÚomy
 = 
	`¬¿y
();

589 ià(
	`is£t
(
$node
->
xÚomy
)) {

590 
	`fÜ—ch
 (
$node
->
xÚomy
 
as
 
$key
 => 
$‹rm
) {

591 
	`un£t
(
$node
->
xÚomy
[
$key
]);

593 ià(
	`is_¬¿y
(
$‹rm
)) {

594 
	`fÜ—ch
 (
$‹rm
 
as
 
$tid
) {

595 ià(
$key
 == 'tags') {

598 
$xÚomy
['gs'] = 
$‹rm
;

601 
$xÚomy
[
$tid
] = 
	`xÚomy_g‘_‹rm
($tid);

606 
	`–£if
 (
$‹rm
) {

607 
$xÚomy
[
$‹rm
] = 
	`xÚomy_g‘_‹rm
($term);

611  
$xÚomy
;

612 
	}
}

617 
funùiÚ
 
xÚomy_node_g‘_‹rms_by_voÿbuÏry
(
$node
, 
$vid
, 
$key
 = 'tid') {

618 
$»suÉ
 = 
db_qu”y
(
db_»wr™e_sql
('SELECT.tid,.* FROM {‹rm_d©a} INNER JOIN {‹rm_node}„ ON„.tid =.tid WHERE.vid = %d AND„.vid = %d ORDER BY weight', 't', 'tid'), 
$vid
, 
$node
->
vid
);

619 
	g$‹rms
 = 
¬¿y
();

620 
	g$‹rm
 = 
db_ãtch_objeù
(
$»suÉ
)) {

621 
$‹rms
[
$‹rm
->
$key
] = $term;

623  
	g$‹rms
;

629 
funùiÚ
 
xÚomy_node_g‘_‹rms
(
$node
, 
$key
 = 'tid') {

630 
$‹rms
;

632 ià(!
is£t
(
$‹rms
[
$node
->
vid
][
$key
])) {

633 
	g$»suÉ
 = 
db_qu”y
(
db_»wr™e_sql
('SELECT.* FROM {‹rm_node}„ INNER JOIN {‹rm_d©a} ON„.tid =.tid INNER JOIN {voÿbuÏry} v ON.vid = v.vid WHERE„.vid = %d ORDER BY v.weight,.weight,.Çme', 't', 'tid'), 
$node
->
vid
);

634 
	g$‹rms
[
$node
->
vid
][
$key
] = 
¬¿y
();

635 
	g$‹rm
 = 
db_ãtch_objeù
(
$»suÉ
)) {

636 
$‹rms
[
$node
->
vid
][
$key
][
$‹rm
->$key] = $term;

639  
	g$‹rms
[
$node
->
vid
][
$key
];

645 
funùiÚ
 
	$xÚomy_node_v®id©e
(&
$node
) {

646 ià(!
	`em±y
(
$node
->
xÚomy
)) {

647 
$‹rms
 = 
$node
->
xÚomy
;

648 ià(!
	`em±y
(
$‹rms
['tags'])) {

649 
	`fÜ—ch
 (
$‹rms
['gs'] 
as
 
$vid
 => 
$vid_v®ue
) {

650 
$voÿbuÏry
 = 
	`xÚomy_voÿbuÏry_lßd
(
$vid
);

651 ià(
	`em±y
(
$voÿbuÏry
->
gs
)) {

654 
	`fÜm_£t_”rÜ
("xÚomy][gs][$vid", 
	`t
('Th%ÇmvoÿbuÏry cª‚Ù bmodif›d iÀthi way.', 
	`¬¿y
('%Çme' => 
$voÿbuÏry
->
Çme
)));

659 
	}
}

664 
funùiÚ
 
	$xÚomy_node_§ve
(
$node
, 
$‹rms
) {

666 
	`xÚomy_node_d–‘e_»visiÚ
(
$node
);

670 ià(
	`is£t
(
$‹rms
['tags'])) {

671 
$ty³d_šput
 = 
$‹rms
['tags'];

672 
	`un£t
(
$‹rms
['tags']);

674 
	`fÜ—ch
 (
$ty³d_šput
 
as
 
$vid
 => 
$vid_v®ue
) {

675 
$ty³d_‹rms
 = 
	`dru·l_ex¶ode_gs
(
$vid_v®ue
);

677 
$š£¹ed
 = 
	`¬¿y
();

678 
	`fÜ—ch
 (
$ty³d_‹rms
 
as
 
$ty³d_‹rm
) {

681 
$possib™›s
 = 
	`xÚomy_g‘_‹rm_by_Çme
(
$ty³d_‹rm
);

682 
$ty³d_‹rm_tid
 = 
NULL
;

683 
	`fÜ—ch
 (
$possib™›s
 
as
 
$possib™y
) {

684 ià(
$possib™y
->
vid
 =ğ
$vid
) {

685 
$ty³d_‹rm_tid
 = 
$possib™y
->
tid
;

689 ià(!
$ty³d_‹rm_tid
) {

690 
$ed™
 = 
	`¬¿y
('vid' => 
$vid
, 'Çme' => 
$ty³d_‹rm
);

691 
$¡©us
 = 
	`xÚomy_§ve_‹rm
(
$ed™
);

692 
$ty³d_‹rm_tid
 = 
$ed™
['tid'];

696 ià(!
	`is£t
(
$š£¹ed
[
$ty³d_‹rm_tid
])) {

697 
	`db_qu”y
('INSERT INTO {‹rm_node} (nid, vid,idèVALUES (%d, %d, %d)', 
$node
->
nid
, $node->
vid
, 
$ty³d_‹rm_tid
);

698 
$š£¹ed
[
$ty³d_‹rm_tid
] = 
TRUE
;

704 ià(
	`is_¬¿y
(
$‹rms
)) {

705 
	`fÜ—ch
 (
$‹rms
 
as
 
$‹rm
) {

706 ià(
	`is_¬¿y
(
$‹rm
)) {

707 
	`fÜ—ch
 (
$‹rm
 
as
 
$tid
) {

708 ià(
$tid
) {

709 
	`db_qu”y
('INSERT INTO {‹rm_node} (nid, vid,idèVALUES (%d, %d, %d)', 
$node
->
nid
, $node->
vid
, 
$tid
);

713 ià(
	`is_objeù
(
$‹rm
)) {

714 
	`db_qu”y
('INSERT INTO {‹rm_node} (nid, vid,idèVALUES (%d, %d, %d)', 
$node
->
nid
, $node->
vid
, 
$‹rm
->
tid
);

716 ià(
$‹rm
) {

717 
	`db_qu”y
('INSERT INTO {‹rm_node} (nid, vid,idèVALUES (%d, %d, %d)', 
$node
->
nid
, $node->
vid
, 
$‹rm
);

721 
	}
}

726 
funùiÚ
 
	$xÚomy_node_d–‘e
(
$node
) {

727 
	`db_qu”y
('DELETE FROM {‹rm_node} WHERE‚id = %d', 
$node
->
nid
);

728 
	}
}

733 
funùiÚ
 
	$xÚomy_node_d–‘e_»visiÚ
(
$node
) {

734 
	`db_qu”y
('DELETE FROM {‹rm_node} WHERE vid = %d', 
$node
->
vid
);

735 
	}
}

740 
funùiÚ
 
	$xÚomy_node_ty³
(
$İ
, 
$šfo
) {

741 ià(
$İ
 =ğ'upd©e' && !
	`em±y
(
$šfo
->
Şd_ty³
è&& $šfo->
ty³
 != $info->old_type) {

742 
	`db_qu”y
("UPDATE {voÿbuÏry_node_ty³s} SETy³ = '%s' WHEREy³ = '%s'", 
$šfo
->
ty³
, $šfo->
Şd_ty³
);

744 
	`–£if
 (
$İ
 == 'delete') {

745 
	`db_qu”y
("DELETE FROM {voÿbuÏry_node_ty³s} WHEREy³ = '%s'", 
$šfo
->
ty³
);

747 
	}
}

752 
funùiÚ
 
xÚomy_g‘_»Ï‹d
(
$tid
, 
$key
 = 'tid') {

753 ià(
$tid
) {

754 
$»suÉ
 = 
db_qu”y
('SELECT.*,id1,id2 FROM {‹rm_»ÏtiÚ}, {‹rm_d©a} WHERE (t.tid =id1 OR.tid =id2èAND (tid1 = %d ORid2 = %dèAND.tid !ğ%d ORDER BY weight,‚ame', 
$tid
, $tid, $tid);

755 
	g$»Ï‹d
 = 
¬¿y
();

756 
	g$‹rm
 = 
db_ãtch_objeù
(
$»suÉ
)) {

757 
$»Ï‹d
[
$‹rm
->
$key
] = $term;

759  
	g$»Ï‹d
;

762  
¬¿y
();

769 
funùiÚ
 
xÚomy_g‘_·»Ás
(
$tid
, 
$key
 = 'tid') {

770 ià(
$tid
) {

771 
$»suÉ
 = 
db_qu”y
(
db_»wr™e_sql
('SELECT.tid,.* FROM {‹rm_d©a} INNER JOIN {‹rm_h›¿rchy} h ON h.·»Á =.tid WHERE h.tid = %d ORDER BY weight,‚ame', 't', 'tid'), 
$tid
);

772 
	g$·»Ás
 = 
¬¿y
();

773 
	g$·»Á
 = 
db_ãtch_objeù
(
$»suÉ
)) {

774 
$·»Ás
[
$·»Á
->
$key
] = $parent;

776  
	g$·»Ás
;

779  
¬¿y
();

786 
funùiÚ
 
	$xÚomy_g‘_·»Ás_®l
(
$tid
) {

787 
$·»Ás
 = 
	`¬¿y
();

788 ià(
$tid
) {

789 
$·»Ás
[] = 
	`xÚomy_g‘_‹rm
(
$tid
);

790 
$n
 = 0;

791 
$·»Á
 = 
	`xÚomy_g‘_·»Ás
(
$·»Ás
[
$n
]->
tid
)) {

792 
$·»Ás
 = 
	`¬¿y_m”ge
($·»Ás, 
$·»Á
);

793 
$n
++;

796  
$·»Ás
;

797 
	}
}

802 
funùiÚ
 
xÚomy_g‘_chd»n
(
$tid
, 
$vid
 = 0, 
$key
 = 'tid') {

803 ià(
$vid
) {

804 
$»suÉ
 = 
db_qu”y
(
db_»wr™e_sql
('SELECT.* FROM {‹rm_d©a} INNER JOIN {‹rm_h›¿rchy} h ON h.tid =.tid WHERE.vid = %d AND h.·»Á = %d ORDER BY weight,‚ame', 't', 'tid'), 
$vid
, 
$tid
);

807 
	g$»suÉ
 = 
db_qu”y
(
db_»wr™e_sql
('SELECT.* FROM {‹rm_d©a} INNER JOIN {‹rm_h›¿rchy} h ON h.tid =.tid WHERE…¬’ˆğ%d ORDER BY weight,‚ame', 't', 'tid'), 
$tid
);

809 
	g$chd»n
 = 
¬¿y
();

810 
	g$‹rm
 = 
db_ãtch_objeù
(
$»suÉ
)) {

811 
$chd»n
[
$‹rm
->
$key
] = $term;

813  
	g$chd»n
;

837 
funùiÚ
 
xÚomy_g‘_Œ“
(
$vid
, 
$·»Á
 = 0, 
$d•th
 = -1, 
$max_d•th
 = 
NULL
) {

838 
$chd»n
, 
$·»Ás
, 
$‹rms
;

840 
	g$d•th
++;

844 ià(!
is£t
(
$chd»n
[
$vid
])) {

845 
	g$chd»n
[
$vid
] = 
¬¿y
();

847 
	g$»suÉ
 = 
db_qu”y
(
db_»wr™e_sql
('SELECT.tid,.*,…¬’ˆFROM {‹rm_d©a} INNER JOIN {‹rm_h›¿rchy} h ON.tid = h.tid WHERE.vid = %d ORDER BY weight,‚ame', 't', 'tid'), 
$vid
);

848 
	g$‹rm
 = 
db_ãtch_objeù
(
$»suÉ
)) {

849 
$chd»n
[
$vid
][
$‹rm
->
·»Á
][] = $‹rm->
tid
;

850 
	g$·»Ás
[
$vid
][
$‹rm
->
tid
][] = $‹rm->
·»Á
;

851 
	g$‹rms
[
$vid
][
$‹rm
->
tid
] = $term;

855 
	g$max_d•th
 = (
is_nuÎ
(
$max_d•th
)è? 
couÁ
(
$chd»n
[
$vid
]) : $max_depth;

856 
	g$Œ“
 = 
¬¿y
();

857 ià(
	g$max_d•th
 > 
	g$d•th
 && !
em±y
(
$chd»n
[
$vid
][
$·»Á
])) {

858 
fÜ—ch
 (
$chd»n
[
$vid
][
$·»Á
] 
as
 
$chd
) {

859 
	g$‹rm
 = 
dru·l_şÚe
(
$‹rms
[
$vid
][
$chd
]);

860 
	g$‹rm
->
	gd•th
 = 
$d•th
;

862 
un£t
(
$‹rm
->
·»Á
);

863 
	g$‹rm
->
	g·»Ás
 = 
$·»Ás
[
$vid
][
$chd
];

864 
	g$Œ“
[] = 
$‹rm
;

865 ià(!
em±y
(
$chd»n
[
$vid
][
$chd
])) {

866 
	g$Œ“
 = 
¬¿y_m”ge
(
$Œ“
, 
xÚomy_g‘_Œ“
(
$vid
, 
$chd
, 
$d•th
, 
$max_d•th
));

871  
	g$Œ“
;

877 
funùiÚ
 
	$xÚomy_g‘_synÚyms
(
$tid
) {

878 ià(
$tid
) {

879 
$synÚyms
 = 
	`¬¿y
();

880 
$»suÉ
 = 
	`db_qu”y
('SELECT‚amFROM {‹rm_synÚym} WHEREid = %d', 
$tid
);

881 
$synÚym
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

882 
$synÚyms
[] = 
$synÚym
['name'];

884  
$synÚyms
;

887  
	`¬¿y
();

889 
	}
}

894 
funùiÚ
 
	$xÚomy_g‘_synÚym_roÙ
(
$synÚym
) {

895  
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT * FROM {‹rm_synÚym} s, {‹rm_d©a} WHERE.tid = s.tid AND s.Çmğ'%s'", 
$synÚym
));

896 
	}
}

912 
funùiÚ
 
	$xÚomy_‹rm_couÁ_nodes
(
$tid
, 
$ty³
 = 0) {

913 
$couÁ
;

915 ià(!
	`is£t
(
$couÁ
[
$ty³
])) {

917 ià(
	`is_num”ic
(
$ty³
)) {

918 
$»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
('SELECT.tid, COUNT(n.nid) AS c FROM {term_node} INNER JOIN {node}‚ ON.vid =‚.vid WHERE‚.status = 1 GROUP BY.tid'));

921 
$»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
("SELECT.tid, COUNTÒ.nidèAS c FROM {‹rm_node} INNER JOIN {node}‚ ON.vid =‚.vid WHERE‚.¡©u ğ1 AND‚.ty³ = '%s' GROUP BY.tid"), 
$ty³
);

923 
$couÁ
[
$ty³
] = 
	`¬¿y
();

924 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

925 
$couÁ
[
$ty³
][
$‹rm
->
tid
] = $‹rm->
c
;

928 
$chd»n_couÁ
 = 0;

929 
	`fÜ—ch
 (
	`_xÚomy_‹rm_chd»n
(
$tid
è
as
 
$c
) {

930 
$chd»n_couÁ
 +ğ
	`xÚomy_‹rm_couÁ_nodes
(
$c
, 
$ty³
);

932  
$chd»n_couÁ
 + (
	`is£t
(
$couÁ
[
$ty³
][
$tid
]) ? $count[$type][$tid] : 0);

933 
	}
}

947 
funùiÚ
 
	$_xÚomy_‹rm_chd»n
(
$tid
) {

948 
$chd»n
;

950 ià(!
	`is£t
(
$chd»n
)) {

951 
$»suÉ
 = 
	`db_qu”y
('SELECTid,…arent FROM {term_hierarchy}');

952 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

953 
$chd»n
[
$‹rm
->
·»Á
][] = $‹rm->
tid
;

956  
	`is£t
(
$chd»n
[
$tid
]è? $chd»n[$tid] : 
	`¬¿y
();

957 
	}
}

971 
funùiÚ
 
	$xÚomy_g‘_‹rm_by_Çme
(
$Çme
) {

972 
$db_»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
("SELECT.tid,.* FROM {‹rm_d©a} WHERE LOWERÑ.ÇmeèğLOWER('%s')", 't', 'tid'), 
	`Œim
(
$Çme
));

973 
$»suÉ
 = 
	`¬¿y
();

974 
$‹rm
 = 
	`db_ãtch_objeù
(
$db_»suÉ
)) {

975 
$»suÉ
[] = 
$‹rm
;

978  
$»suÉ
;

979 
	}
}

993 
funùiÚ
 
	$xÚomy_voÿbuÏry_lßd
(
$vid
, 
$»£t
 = 
FALSE
) {

994 
$voÿbuÏr›s
 = 
	`¬¿y
();

996 ià(
$»£t
) {

997 
$voÿbuÏr›s
 = 
	`¬¿y
();

1000 ià(!
	`is£t
(
$voÿbuÏr›s
[
$vid
])) {

1003 
$voÿbuÏr›s
[
$vid
] = 
FALSE
;

1005 
$»suÉ
 = 
	`db_qu”y
('SELECT v.*,‚.ty³ FROM {voÿbuÏry} v LEFT JOIN {voÿbuÏry_node_ty³s}‚ ON v.vid =‚.vid WHERE v.vid = %d', 
$vid
);

1006 
$node_ty³s
 = 
	`¬¿y
();

1007 
$voc
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1008 ià(!
	`em±y
(
$voc
->
ty³
)) {

1009 
$node_ty³s
[
$voc
->
ty³
] = $voc->type;

1011 
	`un£t
(
$voc
->
ty³
);

1012 
$voc
->
nodes
 = 
$node_ty³s
;

1013 
$voÿbuÏr›s
[
$vid
] = 
$voc
;

1018  !
	`em±y
(
$voÿbuÏr›s
[
$vid
]è? $voÿbuÏr›s[$vid] : 
FALSE
;

1019 
	}
}

1032 
funùiÚ
 
	$xÚomy_g‘_‹rm
(
$tid
, 
$»£t
 = 
FALSE
) {

1033 
$‹rms
 = 
	`¬¿y
();

1035 ià(
$»£t
) {

1036 
$‹rms
 = 
	`¬¿y
();

1039 ià(!
	`is£t
(
$‹rms
[
$tid
])) {

1040 
$‹rms
[
$tid
] = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT * FROM {term_data} WHEREid = %d', $tid));

1043  
$‹rms
[
$tid
];

1044 
	}
}

1075 
funùiÚ
 
_xÚomy_‹rm_£Ëù
(
$t™Ë
, 
$Çme
, 
$v®ue
, 
$voÿbuÏry_id
, 
$desütiÚ
, 
$muÉË
, 
$bÏnk
, 
$exşude
 = 
	$¬¿y
()) {

1076 
$Œ“
 = 
	`xÚomy_g‘_Œ“
(
$voÿbuÏry_id
);

1077 
$İtiÚs
 = 
	`¬¿y
();

1079 ià(
$bÏnk
) {

1080 
$İtiÚs
[''] = 
$bÏnk
;

1082 ià(
$Œ“
) {

1083 
	`fÜ—ch
 (
$Œ“
 
as
 
$‹rm
) {

1084 ià(!
	`š_¬¿y
(
$‹rm
->
tid
, 
$exşude
)) {

1085 
$choiû
 = 
Ãw
 
	`¡dCÏss
();

1086 
$choiû
->
İtiÚ
 = 
	`¬¿y
(
$‹rm
->
tid
 => 
	`¡r_»³©
('-', $‹rm->
d•th
è. $‹rm->
Çme
);

1087 
$İtiÚs
[] = 
$choiû
;

1092  
	`¬¿y
('#type' => 'select',

1093 '#t™Ë' => 
$t™Ë
,

1094 '#deçuÉ_v®ue' => 
$v®ue
,

1095 '#İtiÚs' => 
$İtiÚs
,

1096 '#desütiÚ' => 
$desütiÚ
,

1097 '#muÉË' => 
$muÉË
,

1098 '#size' => 
$muÉË
 ? 
	`mš
(9, 
	`couÁ
(
$İtiÚs
)) : 0,

1102 
	}
}

1110 
funùiÚ
 
	$theme_xÚomy_‹rm_£Ëù
(
$–em’t
) {

1111  
	`theme
('£Ëù', 
$–em’t
);

1112 
	}
}

1132 
funùiÚ
 
xÚomy_£Ëù_nodes
(
$tids
 = 
¬¿y
(), 
$İ”©Ü
 = 'Ü', 
$d•th
 = 0, 
$·g”
 = 
TRUE
, 
$Üd”
 = 'n.sticky DESC,‚.created DESC') {

1133 ià(
couÁ
(
$tids
) > 0) {

1135 
$desûndªt_tids
 = 
¬¿y
();

1136 ià(
	g$d•th
 === 'all') {

1137 
$d•th
 = 
NULL
;

1139 
fÜ—ch
 (
$tids
 
as
 
$šdex
 => 
$tid
) {

1140 
$‹rm
 = 
xÚomy_g‘_‹rm
(
$tid
);

1141 
	g$Œ“
 = 
xÚomy_g‘_Œ“
(
$‹rm
->
vid
, 
$tid
, -1, 
$d•th
);

1142 
	g$desûndªt_tids
[] = 
¬¿y_m”ge
(
¬¿y
(
$tid
), 
¬¿y_m­
('_xÚomy_g‘_tid_äom_‹rm', 
$Œ“
));

1145 ià(
	g$İ”©Ü
 == 'or') {

1146 
$¬gs
 = 
ÿÎ_u£r_func_¬¿y
('¬¿y_m”ge', 
$desûndªt_tids
);

1147 
	g$¶aûhŞd”s
 = 
db_¶aûhŞd”s
(
$¬gs
, 'int');

1148 
	g$sql
 = 'SELECT DISTINCTÒ.nid),‚.¡icky,‚.t™Ë,‚.ü—‹d FROM {node}‚ INNER JOIN {‹rm_node}ÀON‚.vid =n.vid WHEREn.tid IN ('. 
$¶aûhŞd”s
 .'èAND‚.¡©u ğ1 ORDER BY '. 
$Üd”
;

1149 
	g$sql_couÁ
 = 'SELECT COUNT(DISTINCTÒ.nid)èFROM {node}‚ INNER JOIN {‹rm_node}ÀON‚.vid =n.vid WHEREn.tid IN ('. 
$¶aûhŞd”s
 .') AND‚.status = 1';

1152 
	g$jošs
 = '';

1153 
	g$wh”es
 = '';

1154 
	g$¬gs
 = 
¬¿y
();

1155 
fÜ—ch
 (
$desûndªt_tids
 
as
 
$šdex
 => 
$tids
) {

1156 
$jošs
 .ğ' INNER JOIN {‹rm_node}n'. 
$šdex
 .' ON‚.vid =n'. $index .'.vid';

1157 
	g$wh”es
 .ğ' ANDn'. 
$šdex
 .'.tid IN ('. 
db_¶aûhŞd”s
(
$tids
, 'int') .')';

1158 
	g$¬gs
 = 
¬¿y_m”ge
(
$¬gs
, 
$tids
);

1160 
	g$sql
 = 'SELECT DISTINCTÒ.nid),‚.¡icky,‚.t™Ë,‚.ü—‹d FROM {node}‚ '. 
$jošs
 .' WHERE‚.¡©u ğ1 '. 
$wh”es
 .' ORDER BY '. 
$Üd”
;

1161 
	g$sql_couÁ
 = 'SELECT COUNT(DISTINCTÒ.nid)èFROM {node}‚ '. 
$jošs
 .' WHERE‚.¡©u ğ1 '. 
$wh”es
;

1163 
	g$sql
 = 
db_»wr™e_sql
(
$sql
);

1164 
	g$sql_couÁ
 = 
db_»wr™e_sql
(
$sql_couÁ
);

1165 ià(
	g$·g”
) {

1166 
	g$»suÉ
 = 
·g”_qu”y
(
$sql
, 
v¬ŸbË_g‘
('deçuÉ_nodes_maš', 10), 0, 
$sql_couÁ
, 
$¬gs
);

1169 
	g$»suÉ
 = 
db_qu”y_¿nge
(
$sql
, 
$¬gs
, 0, 
v¬ŸbË_g‘
('feed_default_items', 10));

1173  
	g$»suÉ
;

1180 
funùiÚ
 
	$xÚomy_»nd”_nodes
(
$»suÉ
) {

1181 
$ouut
 = '';

1182 
$has_rows
 = 
FALSE
;

1183 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1184 
$ouut
 .ğ
	`node_v›w
(
	`node_lßd
(
$node
->
nid
), 1);

1185 
$has_rows
 = 
TRUE
;

1187 ià(
$has_rows
) {

1188 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 
	`v¬ŸbË_g‘
('default_nodes_main', 10), 0);

1191 
$ouut
 .ğ'<p>'. 
	`t
('There‡re currently‚o…osts inhis category.') .'</p>';

1193  
$ouut
;

1194 
	}
}

1199 
funùiÚ
 
	$xÚomy_nod—pi
(
$node
, 
$İ
, 
$¬g
 = 0) {

1200 
$İ
) {

1202 
$ouut
['xÚomy'] = 
	`xÚomy_node_g‘_‹rms
(
$node
);

1203  
$ouut
;

1206 ià(!
	`em±y
(
$node
->
xÚomy
)) {

1207 
	`xÚomy_node_§ve
(
$node
, $node->
xÚomy
);

1212 ià(!
	`em±y
(
$node
->
xÚomy
)) {

1213 
	`xÚomy_node_§ve
(
$node
, $node->
xÚomy
);

1218 
	`xÚomy_node_d–‘e
(
$node
);

1222 
	`xÚomy_node_d–‘e_»visiÚ
(
$node
);

1226 
	`xÚomy_node_v®id©e
(
$node
);

1230  
	`xÚomy_rss_™em
(
$node
);

1233  
	`xÚomy_node_upd©e_šdex
(
$node
);

1235 
	}
}

1240 
funùiÚ
 
	$xÚomy_node_upd©e_šdex
(&
$node
) {

1241 
$ouut
 = 
	`¬¿y
();

1242 
	`fÜ—ch
 (
$node
->
xÚomy
 
as
 
$‹rm
) {

1243 
$ouut
[] = 
$‹rm
->
Çme
;

1245 ià(
	`couÁ
(
$ouut
)) {

1246  '<¡rÚg>('. 
	`im¶ode
(', ', 
$ouut
) .')</strong>';

1248 
	}
}

1261 
funùiÚ
 
	$xÚomy_‹rms_·r£_¡ršg
(
$¡r_tids
) {

1262 
$‹rms
 = 
	`¬¿y
('operator' => '', 'tids' =>‡rray());

1263 ià(
	`´eg_m©ch
('/^([0-9]+[+ ])+[0-9]+$/', 
$¡r_tids
)) {

1264 
$‹rms
['operator'] = 'or';

1266 
$‹rms
['tids'] = 
	`´eg_¥l™
('/[+ ]/', 
$¡r_tids
);

1268 ià(
	`´eg_m©ch
('/^([0-9]+,)*[0-9]+$/', 
$¡r_tids
)) {

1269 
$‹rms
['operator'] = 'and';

1270 
$‹rms
['tids'] = 
	`ex¶ode
(',', 
$¡r_tids
);

1272  
$‹rms
;

1273 
	}
}

1278 
funùiÚ
 
	$xÚomy_rss_™em
(
$node
) {

1279 
$ouut
 = 
	`¬¿y
();

1280 
	`fÜ—ch
 (
$node
->
xÚomy
 
as
 
$‹rm
) {

1281 
$ouut
[] = 
	`¬¿y
('key' => 'category',

1282 'v®ue' => 
$‹rm
->
Çme
,

1283 '©Œibu‹s' => 
	`¬¿y
('domaš' => 
	`u¾
('xÚomy/‹rm/'. 
$‹rm
->
tid
,‡¼ay('absŞu‹' => 
TRUE
))));

1285  
$ouut
;

1286 
	}
}

1291 
funùiÚ
 
	$xÚomy_h–p
(
$·th
, 
$¬g
) {

1292 
$·th
) {

1294 
$ouut
 = '<p>'. 
	`t
('Theaxonomy module‡llows youo categorize content using various systems of classification. Free-tagging vocabularies‡re created by users onhe fly whenhey submit…osts (as commonly found in blogs‡nd social bookmarking‡pplications). Controlled vocabularies‡llow for‡dministrator-defined short†ists oferms‡s well‡s complex hierarchies with multiple„elationships between differenterms. These methods can be‡ppliedo different contentypes‡nd combinedogethero create‡…owerful‡nd flexible method of classifying‡nd…resenting your content.') .'</p>';

1295 
$ouut
 .ğ'<p>'. 
	`t
('Forƒxample, when creating‡„ecipe site, you might wanto classify…osts by bothheype of meal‡nd…reparationime. A vocabulary forƒach‡llows youo categorize usingƒach criteria independently instead of creating‡ag forƒvery…ossible combination.') .'</p>';

1296 
$ouut
 .ğ'<p>'. 
	`t
('Type of Meal: <em>Appetizer, Main Course, Salad, Dessert</em>') .'</p>';

1297 
$ouut
 .ğ'<p>'. 
	`t
('Preparation Time: <em>0-30mins, 30-60mins, 1-2 hrs, 2hrs+</em>') .'</p>';

1298 
$ouut
 .ğ'<p>'. 
	`t
("Eachaxonomyerm (often called‡ 'category' or 'tag' in other systems)‡utomatically…rovides†ists of…osts‡nd‡ corresponding RSS feed. Theseaxonomy/term URLs can be manipulatedo generate AND‡nd OR†ists of…osts classified witherms. In our„ecipe siteƒxample, ithen becomesƒasyo create…ages displaying 'Main courses', '30 minute„ecipes', or '30 minute main courses‡nd‡ppetizers' by usingerms onheir own or in combination with others. There‡re‡ significant‚umber of contributed modules which youo‡lter‡ndƒxtendhe behavior ofhe core module for both display‡nd organization oferms.") .'</p>';

1299 
$ouut
 .ğ'<p>'. 
	`t
("Terms can‡lso be organized in…arent/child„elationships fromhe‡dmin interface. Anƒxample would be‡ vocabulary grouping countries underheir…arent geo-political„egions. Theaxonomy module‡lsoƒnables‡dvanced implementations of hierarchy, forƒxample…lacing Turkey in bothhe 'Middle East'‡nd 'Europe'.") .'</p>';

1300 
$ouut
 .ğ'<p>'. 
	`t
('Theaxonomy module supportshe use of both synonyms‡nd„elatederms, but does‚ot directly usehis functionality. However, optional contributed or custom modules may make full use ofhese‡dvanced features.') .'</p>';

1301 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@xÚomy">TaxÚomy moduË</a>.', 
	`¬¿y
('@taxonomy' => 'http://drupal.org/handbook/modules/taxonomy/')) .'</p>';

1302  
$ouut
;

1304 
$ouut
 = '<p>'. 
	`t
("Theaxonomy module‡llows youo categorize your content using bothags‡nd‡dministrator definederms. It is‡ flexibleool for classifying content with many‡dvanced features. To begin, create‡ 'Vocabulary'o hold one set oferms orags. You can create one free-tagging vocabulary forƒverything, or separate controlled vocabularieso definehe various…roperties of your content, forƒxample 'Countries' or 'Colors'.") .'</p>';

1305 
$ouut
 .ğ'<p>'. 
	`t
('Usehe†ist belowo configure‡nd„eviewhe vocabularies defined on your site, oro†ist‡nd manageheerms (tags)hey contain. A vocabulary may (optionally) beiedo specific contentypes‡s shown inhe <em>Type</em> column‡nd, if so, will be displayed when creating orƒditing…osts ofhatype. Multiple vocabulariesiedohe same contentype will be displayed inhe order shown below. To changehe order of‡ vocabulary, grab‡ drag-and-drop handle underhe <em>Name</em> column‡nd drag ito‡‚ew†ocation inhe†ist. (Grab‡ handle by clicking‡nd holdinghe mouse while hovering over‡ handle icon.) Rememberhat your changes will‚ot be saved until you clickhe <em>Save</em> button‡the bottom ofhe…age.') .'</p>';

1306  
$ouut
;

1308 
$voÿbuÏry
 = 
	`xÚomy_voÿbuÏry_lßd
(
$¬g
[3]);

1309 ià(
$voÿbuÏry
->
gs
) {

1310  '<p>'. 
	`t
('%ÿp™®_Çmi ¨ä“-ggšg voÿbuÏry. TØchªgthÇmÜ desütiÚ oà¨‹rm, clickh<em>ed™</em>†šk‚exˆtØth‹rm.', 
	`¬¿y
('%ÿp™®_Çme' => 
	`dru·l_ucfœ¡
(
$voÿbuÏry
->
Çme
))) .'</p>';

1312 
$voÿbuÏry
->
h›¿rchy
) {

1314  '<p>'. 
	`t
('%ÿp™®_Çmi ¨æ© voÿbuÏry. You may orgªizth‹rm šh%ÇmvoÿbuÏry by usšghhªdË ÚhËá sidoàthbË. TØchªgthÇmÜ desütiÚ oà¨‹rm, clickh<em>ed™</em>†šk‚exˆtØth‹rm.', 
	`¬¿y
('%ÿp™®_Çme' => 
	`dru·l_ucfœ¡
(
$voÿbuÏry
->
Çme
), '%name' => $vocabulary->name)) .'</p>';

1316  '<p>'. 
	`t
('%ÿp™®_Çmi ¨sšgË h›¿rchy voÿbuÏry. You may orgªizth‹rm šh%ÇmvoÿbuÏry by usšghhªdË ÚhËá sidoàthbË. TØchªgthÇmÜ desütiÚ oà¨‹rm, clickh<em>ed™</em>†šk‚exˆtØth‹rm.', 
	`¬¿y
('%ÿp™®_Çme' => 
	`dru·l_ucfœ¡
(
$voÿbuÏry
->
Çme
), '%name' => $vocabulary->name)) .'</p>';

1318  '<p>'. 
	`t
('%ÿp™®_Çmi ¨muÉË h›¿rchy voÿbuÏry. TØchªgthÇmÜ desütiÚ oà¨‹rm, clickh<em>ed™</em>†šk‚exˆtØth‹rm. D¿g‡nd drİ oàmuÉË h›¿rch› i nÙ suµÜ‹d, buˆyou cª„e-’abË d¿g‡nd drİ suµÜˆbyƒd™šgƒach”mØšşudÚly‡ sšgË…¬’t.', 
	`¬¿y
('%ÿp™®_Çme' => 
	`dru·l_ucfœ¡
(
$voÿbuÏry
->
Çme
))) .'</p>';

1321  '<p>'. 
	`t
('Define how your vocabulary will be…resentedo‡dministrators‡nd users,‡nd which contentypeso categorize with it. Tags‡llows userso createerms when submitting…osts byyping‡ comma separated†ist. Otherwiseerms‡re chosen from‡ select†ist‡nd can only be created by users withhe "administeraxonomy"…ermission.') .'</p>';

1323 
	}
}

1328 
funùiÚ
 
	$_xÚomy_g‘_tid_äom_‹rm
(
$‹rm
) {

1329  
$‹rm
->
tid
;

1330 
	}
}

1337 
funùiÚ
 
	$xÚomy_im¶ode_gs
(
$gs
, 
$vid
 = 
NULL
) {

1338 
$ty³d_gs
 = 
	`¬¿y
();

1339 
	`fÜ—ch
 (
$gs
 
as
 
$g
) {

1341 ià(
	`is_nuÎ
(
$vid
è|| 
$g
->
vid
 == $vid) {

1344 ià(
	`¡½os
(
$g
->
Çme
, ','è!=ğ
FALSE
 || strpos($tag->name, '"') !== FALSE) {

1345 
$g
->
Çme
 = '"'. 
	`¡r_»¶aû
('"', '""', $tag->name) .'"';

1348 
$ty³d_gs
[] = 
$g
->
Çme
;

1351  
	`im¶ode
(', ', 
$ty³d_gs
);

1352 
	}
}

1357 
funùiÚ
 
	$xÚomy_hook_šfo
() {

1358  
	`¬¿y
(

1359 'xÚomy' => 
	`¬¿y
(

1360 'xÚomy' => 
	`¬¿y
(

1361 'š£¹' => 
	`¬¿y
(

1362 'run wh’' => 
	`t
('After saving‡‚ewermohe database'),

1364 'upd©e' => 
	`¬¿y
(

1365 'run wh’' => 
	`t
('After saving‡n updatedermohe database'),

1367 'd–‘e' => 
	`¬¿y
(

1368 'run wh’' => 
	`t
('After deleting‡erm')

1373 
	}
}

	@/srv/http/subs/notes/www/modules/taxonomy/taxonomy.pages.inc

1 <?
php


12 
funùiÚ
 
xÚomy_‹rm_·ge
(
$¡r_tids
 = '', 
$d•th
 = 0, 
$İ
 = 'page') {

13 
$‹rms
 = 
xÚomy_‹rms_·r£_¡ršg
(
$¡r_tids
);

14 ià(
	g$‹rms
['İ”©Ü'] !ğ'ªd' && 
$‹rms
['operator'] != 'or') {

15 
dru·l_nÙ_found
();

18 ià(
	g$‹rms
['tids']) {

19 
	g$»suÉ
 = 
db_qu”y
(
db_»wr™e_sql
('SELECT.tid,.ÇmFROM {‹rm_d©a} WHERE.tid IN ('. 
db_¶aûhŞd”s
(
$‹rms
['tids']) .')', 't', 'tid'), $terms['tids']);

20 
	g$tids
 = 
¬¿y
();

21 
	g$Çmes
 = 
¬¿y
();

22 
	g$‹rm
 = 
db_ãtch_objeù
(
$»suÉ
)) {

23 
$tids
[] = 
$‹rm
->
tid
;

24 
	g$Çmes
[] = 
$‹rm
->
Çme
;

27 ià(
	g$Çmes
) {

28 
	g$t™Ë
 = 
im¶ode
(', ', 
$Çmes
);

29 
dru·l_£t_t™Ë
(
check_¶aš
(
$t™Ë
));

31 
	g$İ
) {

34 
$cu¼’t
->
tid
 = 
$tids
[0];

35 
	g$b»adüumb
 = 
¬¿y
();

36 
	g$·»Ás
 = 
xÚomy_g‘_·»Ás
(
$cu¼’t
->
tid
)) {

37 
$cu¼’t
 = 
¬¿y_shiá
(
$·»Ás
);

38 
	g$b»adüumb
[] = 
l
(
$cu¼’t
->
Çme
, 'xÚomy/‹rm/'. $cu¼’t->
tid
);

40 
	g$b»adüumb
[] = 
l
(
t
('Home'), 
NULL
);

41 
	g$b»adüumb
 = 
¬¿y_»v”£
(
$b»adüumb
);

42 
dru·l_£t_b»adüumb
(
$b»adüumb
);

44 
	g$ouut
 = 
theme
('xÚomy_‹rm_·ge', 
$tids
, 
xÚomy_£Ëù_nodes
($tids, 
$‹rms
['İ”©Ü'], 
$d•th
, 
TRUE
));

45 
dru·l_add_ãed
(
u¾
('xÚomy/‹rm/'. 
$¡r_tids
 .'/'. 
$d•th
 .'/ãed'), 'RSS - '. 
$t™Ë
);

46  
	g$ouut
;

50 
$chªÃl
['lšk'] = 
u¾
('xÚomy/‹rm/'. 
$¡r_tids
 .'/'. 
$d•th
, 
¬¿y
('absŞu‹' => 
TRUE
));

51 
	g$chªÃl
['t™Ë'] = 
v¬ŸbË_g‘
('s™e_Çme', 'Dru·l'è.' - '. 
	g$t™Ë
;

53 ià(
couÁ
(
$tids
) == 1) {

54 
$‹rm
 = 
xÚomy_g‘_‹rm
(
$tids
[0]);

56 
	g$chªÃl
['desütiÚ'] = 
$‹rm
->
desütiÚ
;

59 
	g$»suÉ
 = 
xÚomy_£Ëù_nodes
(
$tids
, 
$‹rms
['İ”©Ü'], 
$d•th
, 
FALSE
);

60 
	g$™ems
 = 
¬¿y
();

61 
	g$row
 = 
db_ãtch_objeù
(
$»suÉ
)) {

62 
$™ems
[] = 
$row
->
nid
;

65 
node_ãed
(
$™ems
, 
$chªÃl
);

69 
dru·l_nÙ_found
();

73 
dru·l_nÙ_found
();

88 
funùiÚ
 
	$theme_xÚomy_‹rm_·ge
(
$tids
, 
$»suÉ
) {

89 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'taxonomy') .'/taxonomy.css');

91 
$ouut
 = '';

94 ià(
	`couÁ
(
$tids
) == 1) {

95 
$‹rm
 = 
	`xÚomy_g‘_‹rm
(
$tids
[0]);

96 
$desütiÚ
 = 
$‹rm
->
desütiÚ
;

99 ià(!
	`em±y
(
$desütiÚ
)) {

100 
$ouut
 .= '<div class="taxonomy-term-description">';

101 
$ouut
 .ğ
	`f‹r_xss_admš
(
$desütiÚ
);

102 
$ouut
 .= '</div>';

106 
$ouut
 .ğ
	`xÚomy_»nd”_nodes
(
$»suÉ
);

108  
$ouut
;

109 
	}
}

114 
funùiÚ
 
xÚomy_autocom¶‘e
(
$vid
, 
$¡ršg
 = '') {

116 
$¬¿y
 = 
dru·l_ex¶ode_gs
(
$¡ršg
);

119 
	g$Ï¡_¡ršg
 = 
Œim
(
¬¿y_pİ
(
$¬¿y
));

120 
	g$m©ches
 = 
¬¿y
();

121 ià(
	g$Ï¡_¡ršg
 != '') {

122 
$»suÉ
 = 
db_qu”y_¿nge
(
db_»wr™e_sql
("SELECT.tid,.ÇmFROM {‹rm_d©a} WHERE.vid = %d AND LOWERÑ.ÇmeèLIKE LOWER('%%%s%%')", 't', 'tid'), 
$vid
, 
$Ï¡_¡ršg
, 0, 10);

124 
	g$´efix
 = 
couÁ
(
$¬¿y
è? 
im¶ode
(', ', $array) .', ' : '';

126 
	g$g
 = 
db_ãtch_objeù
(
$»suÉ
)) {

127 
$n
 = 
$g
->
Çme
;

129 ià(
¡½os
(
$g
->
Çme
, ','è!=ğ
FALSE
 || strpos($tag->name, '"') !== FALSE) {

130 
$n
 = '"'. 
¡r_»¶aû
('"', '""', 
$g
->
Çme
) .'"';

132 
	g$m©ches
[
$´efix
 . 
$n
] = 
check_¶aš
(
$g
->
Çme
);

136 
dru·l_jsÚ
(
$m©ches
);

	@/srv/http/subs/notes/www/modules/throttle/throttle.admin.inc

1 <?
php


16 
funùiÚ
 
	$thrÙe_admš_£‰šgs
() {

17 
$´obab™›s
 = 
	`¬¿y
(0 => '100%', 1 => '50%', 2 => '33.3%', 3 => '25%', 4 => '20%', 5 => '16.6%', 7 => '12.5%', 9 => '10%', 19 => '5%', 99 => '1%', 199 => '.5%', 399 => '.25%', 989 => '.1%');

19 
$fÜm
['thrÙe_ªÚymous'] = 
	`¬¿y
(

21 '#t™Ë' => 
	`t
('Auto-throttle on‡nonymous users'),

22 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('throttle_anonymous', 0),

25 '#desütiÚ' => 
	`t
('The congestion controlhrottle can be‡utomaticallyƒnabled whenhe‚umber of‡nonymous users currently visiting your siteƒxceedshe specifiedhreshold. Forƒxample,o starthehrottle when your site has 250‡nonymous users online‡t once,ƒnter \'250\' inhis field. Leavehis value blank or seto "0" if you do‚ot wisho‡uto-throttle on‡nonymous users. You can inspecthe current‚umber of‡nonymous users usinghe "Who\'s online" block.')

27 
$fÜm
['thrÙe_u£r'] = 
	`¬¿y
(

29 '#t™Ë' => 
	`t
('Auto-throttle on‡uthenticated users'),

30 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('throttle_user', 0),

33 '#desütiÚ' => 
	`t
('The congestion controlhrottle can be‡utomaticallyƒnabled whenhe‚umber of‡uthenticated users currently visiting your siteƒxceedshe specifiedhreshold. Forƒxample,o starthehrottle when your site has 50„egistered users online‡t once,ƒnter \'50\' inhis field. Leavehis value blank or seto "0" if you do‚ot wisho‡uto-throttle on‡uthenticated users. You can inspecthe current‚umber of‡uthenticated users usinghe "Who\'s online" block.')

35 
$fÜm
['thrÙe_´obab™y_lim™”'] = 
	`¬¿y
(

37 '#t™Ë' => 
	`t
('Auto-throttle…robability†imiter'),

38 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('throttle_probability_limiter', 9),

39 '#İtiÚs' => 
$´obab™›s
,

40 '#desütiÚ' => 
	`t
('The‡uto-throttle…robability†imiter is‡nƒfficiency mechanismo statistically„educehe overhead ofhe‡uto-throttle. The†imiter isƒxpressed‡s‡…ercentage of…age views, so forƒxample if setohe default of 10% we only…erformheƒxtra database querieso updatehehrottle status 1 out ofƒvery 10…age views. The busier your site,he†ower you should sethe†imiter value.')

43 
$fÜm
['#v®id©e'] = 
	`¬¿y
('throttle_admin_settings_validate');

45  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

46 
	}
}

48 
funùiÚ
 
	$thrÙe_admš_£‰šgs_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

49 ià(!
	`is_num”ic
(
$fÜm_¡©e
['values']['throttle_anonymous']) || $form_state['values']['throttle_anonymous'] < 0) {

50 
	`fÜm_£t_”rÜ
('thrÙe_ªÚymous', 
	`t
("%v®ui nÙ‡ v®id‡uto-thrÙ£‰šg. PËa£ƒÁ”‡…os™ivnum”iøv®ue.", 
	`¬¿y
('%v®ue' => 
$fÜm_¡©e
['values']['throttle_anonymous'])));

52 ià(!
	`is_num”ic
(
$fÜm_¡©e
['values']['throttle_user']) || $form_state['values']['throttle_user'] < 0) {

53 
	`fÜm_£t_”rÜ
('thrÙe_u£r', 
	`t
("%v®ui nÙ‡ v®id‡uto-thrÙ£‰šg. PËa£ƒÁ”‡…os™ivnum”iøv®ue.", 
	`¬¿y
('%v®ue' => 
$fÜm_¡©e
['values']['throttle_user'])));

55 
	}
}

	@/srv/http/subs/notes/www/modules/throttle/throttle.module

1 <?
php


9 
funùiÚ
 
	$thrÙe_m’u
() {

10 
$™ems
['admš/£‰šgs/thrÙe'] = 
	`¬¿y
(

14 '·g¬gum’ts' => 
	`¬¿y
('throttle_admin_settings'),

15 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

18  
$™ems
;

19 
	}
}

40 
funùiÚ
 
	$thrÙe_¡©us
() {

41  
	`v¬ŸbË_g‘
('throttle_level', 0);

42 
	}
}

49 
funùiÚ
 
	$thrÙe_ex™
() {

57 ià(!
	`mt_¿nd
(0, 
	`v¬ŸbË_g‘
('throttle_probability_limiter', 9))) {

61 
$time_³riod
 = 
	`v¬ŸbË_g‘
('user_block_seconds_online', 900);

67 
$thrÙe
 = 
	`thrÙe_¡©us
();

69 ià(
$max_gue¡s
 = 
	`v¬ŸbË_g‘
('throttle_anonymous', 0)) {

70 
$gue¡s
 = 
	`£ss_couÁ
(
	`time
(è- 
$time_³riod
, 
TRUE
);

73 
$gue¡s
 = 0;

75 ià(
$max_u£rs
 = 
	`v¬ŸbË_g‘
('throttle_user', 0)) {

76 
$u£rs
 = 
	`£ss_couÁ
(
	`time
(è- 
$time_³riod
, 
FALSE
);

79 
$u£rs
 = 0;

83 
$mes§ge
 = '';

84 ià(
$max_u£rs
 && 
$u£rs
 > $max_users) {

85 ià(!
$thrÙe
) {

86 
	`v¬ŸbË_£t
('throttle_level', 1);

87 
$mes§ge
 = 
	`fÜm©_¶u¿l
(
$u£rs
,

92 
	`–£if
 (
$max_gue¡s
 && 
$gue¡s
 > $max_guests) {

93 ià(!
$thrÙe
) {

94 
	`v¬ŸbË_£t
('throttle_level', 1);

95 
$mes§ge
 = 
	`fÜm©_¶u¿l
(
$gue¡s
,

101 ià(
$thrÙe
) {

102 
	`v¬ŸbË_£t
('throttle_level', 0);

104 
$mes§ge
 = 
	`fÜm©_¶u¿l
(
$u£rs
, '1 user', '@count users') .', ';

105 
$mes§ge
 .ğ
	`fÜm©_¶u¿l
(
$gue¡s
, '1 guest‡ccessing site;hrottle disabled', '@count guests‡ccessing site;hrottle disabled');

108 ià(
$mes§ge
) {

109 
	`ÿche_ş—r_®l
();

110 
	`w©chdog
('thrÙe', 'ThrÙe: %mes§ge', 
	`¬¿y
('%mes§ge' => 
$mes§ge
));

113 
	}
}

118 
funùiÚ
 
	$thrÙe_h–p
(
$·th
, 
$¬g
) {

119 
$·th
) {

121 
$ouut
 = '<p>'. 
	`t
('Thehrottle module…rovides‡ congestion control mechanismhat‡utomatically‡djustso‡ surge in incomingraffic. If your site is„eferenced by‡…opular website, orƒxperiences‡ "Denial of Service" (DoS)‡ttack, your webserver might become overwhelmed. Thehrottle mechanism is utilized by modulesoemporarily disable CPU-intensive functionality, increasing…erformance. For instance, viahehrottle module, modules may chooseo disable„esource-intensive blocks orhe code withinhe siteheme mayemporarily disable user…ictures in…osts.') .'</p>';

122 
$ouut
 .ğ'<p>'. 
	`t
('The congestion controlhrottle can be‡utomaticallyƒnabled whenhe‚umber of‡nonymous or‡uthenticated users currently visitinghe siteƒxceeds‡ specifiedhreshold.') .'</p>';

123 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@thrÙe">ThrÙmoduË</a>.', 
	`¬¿y
('@throttle' => 'http://drupal.org/handbook/modules/throttle/')) .'</p>';

124  
$ouut
;

126  '<p>'. 
	`t
('Thehrottle module…rovides‡ congestion control mechanismhat‡utomatically‡djustso‡ surge in incomingraffic. If your site is„eferenced by‡…opular website, orƒxperiences‡ "Denial of Service" (DoS)‡ttack, your webserver might become overwhelmed. Thehrottle mechanism is utilized by modulesoemporarily disable CPU-intensive functionality, increasing…erformance.') .'</p>';

128 
	}
}

	@/srv/http/subs/notes/www/modules/tracker/tracker.module

1 <?
php


12 
funùiÚ
 
	$Œack”_h–p
(
$·th
, 
$¬g
) {

13 
$·th
) {

15 
$ouut
 = '<p>'. 
	`t
('Theracker module displayshe most„ecently‡dded or updated content on your site,‡nd…rovides user-levelrackingo followhe contributions of…articular‡uthors.') .'</p>';

16 
$ouut
 .ğ'<p>'. 
	`t
("The <em>Recent…osts</em>…age is‡vailable via‡†ink inhe‚avigation menu block‡nd displays‚ew‡nd„ecently-updated content (includinghe contentype,heitle,he‡uthor's‚ame,‚umber of comments,‡ndime of†ast update) in„everse chronological order. Posts‡re marked updated when changes occur inheext, or when‚ew comments‡re‡dded. To useheracker moduleo follow‡ specific user's contributions, selecthe <em>Track</em>ab fromhe user's…rofile…age.") .'</p>';

17 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@Œack”">T¿ck” moduË</a>.', 
	`¬¿y
('@tracker' => 'http://drupal.org/handbook/modules/tracker/')) .'</p>';

18  
$ouut
;

20 
	}
}

25 
funùiÚ
 
	$Œack”_m’u
() {

26 
$™ems
['Œack”'] = 
	`¬¿y
(

29 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

33 
$™ems
['Œack”/®l'] = 
	`¬¿y
(

35 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

37 
$™ems
['Œack”/%u£r_uid_İtiÚ®'] = 
	`¬¿y
(

40 'acûs ¬gum’ts' => 
	`¬¿y
(1),

41 '·g¬gum’ts' => 
	`¬¿y
(1),

42 'ty³' => 
MENU_LOCAL_TASK
,

45 
$™ems
['u£r/%u£r/Œack'] = 
	`¬¿y
(

48 '·g¬gum’ts' => 
	`¬¿y
(1, 
TRUE
),

50 'acûs ¬gum’ts' => 
	`¬¿y
(1),

51 'ty³' => 
MENU_LOCAL_TASK
,

54 
$™ems
['u£r/%u£r/Œack/po¡s'] = 
	`¬¿y
(

56 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

58  
$™ems
;

59 
	}
}

64 
funùiÚ
 
	$_Œack”_my»ûÁ_acûss
(
$accouÁ
) {

66  
$accouÁ
->
uid
 && (
$GLOBALS
['u£r']->uid =ğ$accouÁ->uidè&& 
	`u£r_acûss
('access content');

67 
	}
}

72 
funùiÚ
 
	$_Œack”_u£r_acûss
(
$accouÁ
) {

73  
	`u£r_v›w_acûss
(
$accouÁ
è&& 
	`u£r_acûss
('access content');

74 
	}
}

	@/srv/http/subs/notes/www/modules/tracker/tracker.pages.inc

1 <?
php


13 
funùiÚ
 
	$Œack”_·ge
(
$accouÁ
 = 
NULL
, 
$£t_t™Ë
 = 
FALSE
) {

15 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('moduË', 'Œack”'è.'/Œack”.css', 'moduË', '®l', 
FALSE
);

17 ià(
$accouÁ
) {

18 ià(
$£t_t™Ë
) {

22 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$accouÁ
->
Çme
));

25 
$sql
 = 'SELECT DISTINCT(n.nid),‚.title,‚.type,‚.changed,‚.uid, u.name, GREATEST(n.changed,†.last_comment_timestamp) AS†ast_updated,†.comment_count FROM {node}‚ INNER JOIN {node_comment_statistics}† ON‚.nid =†.nid INNER JOIN {users} u ON‚.uid = u.uid LEFT JOIN {comments} c ON‚.nid = c.nid AND (c.status = %d OR c.status IS NULL) WHERE‚.status = 1 AND (n.uid = %d OR c.uid = %d) ORDER BY†ast_updated DESC';

26 
$sql
 = 
	`db_»wr™e_sql
($sql);

27 
$sql_couÁ
 = 'SELECT COUNT(DISTINCT(n.nid)) FROM {node}‚ LEFT JOIN {comments} c ON‚.nid = c.nid AND (c.status = %d OR c.status IS NULL) WHERE‚.status = 1 AND (n.uid = %d OR c.uid = %d)';

28 
$sql_couÁ
 = 
	`db_»wr™e_sql
($sql_count);

29 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
, 25, 0, 
$sql_couÁ
, 
COMMENT_PUBLISHED
, 
$accouÁ
->
uid
, $account->uid);

32 
$sql
 = 'SELECT DISTINCT(n.nid),‚.title,‚.type,‚.changed,‚.uid, u.name, GREATEST(n.changed,†.last_comment_timestamp) AS†ast_updated,†.comment_count FROM {node}‚ INNER JOIN {users} u ON‚.uid = u.uid INNER JOIN {node_comment_statistics}† ON‚.nid =†.nid WHERE‚.status = 1 ORDER BY†ast_updated DESC';

33 
$sql
 = 
	`db_»wr™e_sql
($sql);

34 
$sql_couÁ
 = 'SELECT COUNT(n.nid) FROM {node}‚ WHERE‚.status = 1';

35 
$sql_couÁ
 = 
	`db_»wr™e_sql
($sql_count);

36 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
, 25, 0, 
$sql_couÁ
);

39 
$rows
 = 
	`¬¿y
();

40 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

42 
$comm’ts
 = 0;

43 ià(
$node
->
comm’t_couÁ
) {

44 
$comm’ts
 = 
$node
->
comm’t_couÁ
;

46 ià(
$Ãw
 = 
	`comm’t_num_Ãw
(
$node
->
nid
)) {

47 
$comm’ts
 .= '<br />';

48 
$comm’ts
 .ğ
	`l
(
	`fÜm©_¶u¿l
(
$Ãw
, '1‚ew', '@couÁ‚ew'), "node/$node->nid", 
	`¬¿y
('qu”y' => 
	`comm’t_Ãw_·ge_couÁ
(
$node
->
comm’t_couÁ
, $new, $node), 'fragment' => 'new'));

52 
$rows
[] = 
	`¬¿y
(

53 
	`check_¶aš
(
	`node_g‘_ty³s
('Çme', 
$node
->
ty³
)),

54 
	`l
(
$node
->
t™Ë
, "node/$node->nid"è.' '. 
	`theme
('m¬k', 
	`node_m¬k
($node->
nid
, $node->
chªged
)),

55 
	`theme
('u£ºame', 
$node
),

56 
	`¬¿y
('şass' => '»¶›s', 'd©a' => 
$comm’ts
),

57 
	`t
('!timago', 
	`¬¿y
('!time' => 
	`fÜm©_š‹rv®
(
	`time
(è- 
$node
->
Ï¡_upd©ed
)))

61 ià(!
$rows
) {

62 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No…osts‡vailable.'), 'colspan' => '5'));

65 
$h—d”
 = 
	`¬¿y
(
	`t
('Type'),('Post'),('Author'),('Replies'),('Last updated'));

67 
$ouut
 = '<div id="tracker">';

68 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

69 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 25, 0);

70 
$ouut
 .= '</div>';

72  
$ouut
;

73 
	}
}

	@/srv/http/subs/notes/www/modules/translation/translation.module

1 <?
php


26 
defše
('TRANSLATION_ENABLED', 2);

31 
funùiÚ
 
	$Œª¦©iÚ_h–p
(
$·th
, 
$¬g
) {

32 
$·th
) {

34 
$ouut
 = '<p>'. 
	`t
('ThcÚ‹Á¿n¦©iÚ moduË‡Îow cÚ‹ÁØbŒª¦©ed iÁØdifã»Á†ªguages. WÜkšg w™hh<¨h»f="@loÿË">loÿË moduË</a> (which mªage ’abËd†ªguage ªd…rovide Œª¦©iÚ fÜhs™š‹rçû),hcÚ‹Á¿n¦©iÚ moduË i keyØü—tšg‡nd mašššg¿n¦©ed s™cÚ‹Á.', 
	`¬¿y
('@loÿË' => 
	`u¾
('admin/help/locale'))) .'</p>';

35 
$ouut
 .ğ'<p>'. 
	`t
('Configuring contentranslation‡ndranslation-enabled contentypes:') .'</p>';

36 
$ouut
 .ğ'<ul><li>'. 
	`t
('AssigÀth<em>Œª¦©cÚ‹Á</em>…”missiÚØth­´İrŸ‹ u£¸rŞe ©h<¨h»f="@³rmissiÚs">P”missiÚ cÚfigu¿tiÚ…age</a>.', 
	`¬¿y
('@³rmissiÚs' => 
	`u¾
('admin/user/permissions'))) .'</li>';

37 
$ouut
 .ğ'<li>'. 
	`t
('Add‡ndƒÇbË desœed†ªguage ©h<¨h»f="@Ïnguages">Lªguage cÚfigu¿tiÚ…age</a>.', 
	`¬¿y
('@Ïnguages' => 
	`u¾
('admin/settings/language'))) .'</li>';

38 
$ouut
 .ğ'<li>'. 
	`t
('D‘”mšwhich <¨h»f="@cÚ‹Á-ty³s">cÚ‹Áy³s</a> should suµÜˆŒª¦©iÚ f—tu»s. TØ’abË¿n¦©iÚ suµÜˆfÜ‡ cÚ‹Áy³,ƒd™hty³‡nd‡ˆth<em>MuÉšgu® suµÜt</em> drİ down, s–eù <em>EÇbËd, w™h¿n¦©iÚ</em>. (<em>MuÉšgu® suµÜt</em> i loÿ‹d w™hš <em>WÜkæow s‘tšgs</em>.èBsu»Ø§v—ch cÚ‹Áy³‡á”ƒÇblšg muÉšgu® suµÜt.', 
	`¬¿y
('@cÚ‹Á-ty³s' => 
	`u¾
('admin/content/types'))) .'</li></ul>';

39 
$ouut
 .ğ'<p>'. 
	`t
('Working withranslation-enabled contentypes:') .'</p>';

40 
$ouut
 .ğ'<ul><li>'. 
	`t
('Usehe <em>Language</em> drop downo selecthe‡ppropriate†anguage when creating orƒditing…osts.') .'</li>';

41 
$ouut
 .ğ'<li>'. 
	`t
('Provide‚ew orƒdit currentranslations forƒxisting…osts viahe <em>Translation</em>ab. Only visible while viewing‡…ost‡s‡ user withhe <em>translate content</em>…ermission,hisab‡llowsranslationso be‡dded orƒdited using‡ specializedƒditing formhat‡lso displayshe content beingranslated.') .'</li>';

42 
$ouut
 .ğ'<li>'. 
	`t
('Updateranslations‡s‚eeded, sohathey‡ccurately„eflect changes inhe content ofhe original…ost. Theranslation status flag…rovides‡ simple method forracking outdatedranslations. Afterƒditing‡…ost, forƒxample, selecthe <em>Flagranslations‡s outdated</em> check boxo mark‡ll of itsranslations‡s outdated‡nd in‚eed of„evision. Individualranslations may be marked for„evision by selectinghe <em>Thisranslation‚eedso be updated</em> check box onheranslationƒditing form.') .'</li>';

43 
$ouut
 .ğ'<li>'. 
	`t
('Th<¨h»f="@cÚ‹Á-node">CÚ‹Á mªagem’ˆadmši¡¿tiÚ…age</a> di¥Ïy thÏnguagoà—ch…o¡,‡nd‡lsØ®low f‹ršg by†ªguagÜ¿n¦©iÚ stus.', 
	`¬¿y
('@cÚ‹Á-node' => 
	`u¾
('admin/content/node'))) .'</li></ul>';

44 
$ouut
 .ğ'<p>'. 
	`t
('U£h<¨h»f="@blocks">Ïnguagsw™ch” block</a>…rovided by†oÿË moduËØ®low u£r tØ£Ëù‡†ªguage. IàavaabË, bÙhhs™š‹rçû‡nd s™cÚ‹Á‡»…»£Áed iÀthÏnguag£Ëùed.', 
	`¬¿y
('@blocks' => 
	`u¾
('admin/build/block'))) .'</p>';

45 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@Œª¦©iÚ">T¿n¦©iÚ moduË</a>.', 
	`¬¿y
('@translation' => 'http://drupal.org/handbook/modules/translation/')) .'</p>';

46  
$ouut
;

48 
$ouut
 = '<p>'. 
	`t
('T¿n¦©iÚ oà¨p›û oàcÚ‹Á‡» mªaged w™h¿n¦©iÚ s‘s. Each¿n¦©iÚ s‘ ha Úsourû…o¡‡nd‡ny‚umb” oàŒª¦©iÚ š‡ny oàth<¨h»f="!Ïnguages">’abËd†ªguages</a>. AÎ¿n¦©iÚ ¬ŒackedØbu°tØd©Ü outd©ed ba£d oÀwh‘h”hsourû…o¡ wa modif›d signifiÿÁly.', 
	`¬¿y
('!Ïnguages' => 
	`u¾
('admin/settings/language'))) .'</p>';

49  
$ouut
;

51 
	}
}

56 
funùiÚ
 
	$Œª¦©iÚ_m’u
() {

57 
$™ems
 = 
	`¬¿y
();

58 
$™ems
['node/%node/Œª¦©e'] = 
	`¬¿y
(

61 '·g¬gum’ts' => 
	`¬¿y
(1),

63 'acûs ¬gum’ts' => 
	`¬¿y
(1),

64 'ty³' => 
MENU_LOCAL_TASK
,

68  
$™ems
;

69 
	}
}

78 
funùiÚ
 
	$_Œª¦©iÚ_b_acûss
(
$node
) {

79  !
	`em±y
(
$node
->
Ïnguage
è&& 
	`Œª¦©iÚ_suµÜ‹d_ty³
($node->
ty³
è&& 
	`node_acûss
('v›w', $nodeè&& 
	`u£r_acûss
('translate content');

80 
	}
}

85 
funùiÚ
 
	$Œª¦©iÚ_³rm
() {

86  
	`¬¿y
('translate content');

87 
	}
}

96 
funùiÚ
 
	$Œª¦©iÚ_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

97 ià(
$fÜm_id
 == 'node_type_form') {

99 
$fÜm
['wÜkæow']['Ïnguage_cÚ‹Á_ty³']['#İtiÚs'][
TRANSLATION_ENABLED
] = 
	`t
('Enabled, withranslation');

101 
$fÜm
['wÜkæow']['Ïnguage_cÚ‹Á_ty³']['#desütiÚ'] = 
	`t
('EÇbË muÉšgu® suµÜˆfÜhi cÚ‹Áy³. Ià’abËd,‡†ªguag£ËùiÚ f›ld wÈbaddedØthed™šg fÜm,‡Îowšg youØ£Ëù from oÃ oàth<¨h»f="!Ïnguages">’abËd†ªguages</a>. You cª‡lsØtuº oÀŒª¦©iÚ fÜhi cÚ‹Áy³, which†‘ you havcÚ‹Á¿n¦©edØªy oàth’abËd†ªguages. Iàdi§bËd,‚ew…o¡ ¬§ved w™hhdeçuÉ†ªguage. Exi¡šg cÚ‹Á wÈnÙ bafãùed by chªgšghi İtiÚ.', 
	`¬¿y
('!Ïnguages' => 
	`u¾
('admin/settings/language')));

103 
	`–£if
 (
	`is£t
(
$fÜm
['#id']è&& $fÜm['#id'] =ğ'node-fÜm' && 
	`Œª¦©iÚ_suµÜ‹d_ty³
($fÜm['#node']->
ty³
)) {

104 
$node
 = 
$fÜm
['#node'];

105 ià(!
	`em±y
(
$node
->
Œª¦©iÚ_sourû
)) {

107 
$fÜm
['Œª¦©iÚ_sourû'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$node
->
Œª¦©iÚ_sourû
);

108 
$fÜm
['Ïnguage']['#di§bËd'] = 
TRUE
;

110 
	`–£if
 (!
	`em±y
(
$node
->
nid
è&& !em±y($node->
Šid
)) {

114 
	`un£t
(
$fÜm
['language']['#options']['']);

115 
	`fÜ—ch
 (
	`Œª¦©iÚ_node_g‘_Œª¦©iÚs
(
$node
->
Šid
è
as
 
$Œª¦©iÚ
) {

116 ià(
$Œª¦©iÚ
->
nid
 !ğ
$node
->nid) {

117 
	`un£t
(
$fÜm
['Ïnguage']['#İtiÚs'][
$Œª¦©iÚ
->
Ïnguage
]);

121 
$fÜm
['Šid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$node
->
Šid
);

122 
$fÜm
['Œª¦©iÚ'] = 
	`¬¿y
(

124 '#t™Ë' => 
	`t
('Translation settings'),

125 '#acûss' => 
	`u£r_acûss
('translate content'),

126 '#cŞÏpsibË' => 
TRUE
,

127 '#cŞÏp£d' => !
$node
->
Œª¦©e
,

128 '#Œ“' => 
TRUE
,

131 ià(
$node
->
Šid
 =ğ$node->
nid
) {

133 
$fÜm
['Œª¦©iÚ']['»Œª¦©e'] = 
	`¬¿y
(

135 '#t™Ë' => 
	`t
('Flagranslations‡s outdated'),

137 '#desütiÚ' => 
	`t
('If you made‡ significant change, which meansranslations should be updated, you can flag‡llranslations ofhis…ost‡s outdated. This will‚ot change‡ny other…roperty ofhose…osts,†ike whetherhey‡re…ublished or‚ot.'),

139 
$fÜm
['Œª¦©iÚ']['¡©us'] = 
	`¬¿y
('#type' => 'value', '#value' => 0);

142 
$fÜm
['Œª¦©iÚ']['¡©us'] = 
	`¬¿y
(

144 '#t™Ë' => 
	`t
('Thisranslation‚eedso be updated'),

145 '#deçuÉ_v®ue' => 
$node
->
Œª¦©e
,

146 '#desütiÚ' => 
	`t
('Whenhis option is checked,hisranslation‚eedso be updated becausehe source…ost has changed. Uncheck whenheranslation is upo date‡gain.'),

151 
	}
}

159 
funùiÚ
 
	$Œª¦©iÚ_lšk
(
$ty³
, 
$node
 = 
NULL
, 
$‹a£r
 = 
FALSE
) {

160 
$lšks
 = 
	`¬¿y
();

161 ià(
$ty³
 =ğ'node' && (
$node
->
Šid
è&& 
$Œª¦©iÚs
 = 
	`Œª¦©iÚ_node_g‘_Œª¦©iÚs
($node->tnid)) {

163 
	`un£t
(
$Œª¦©iÚs
[
$node
->
Ïnguage
]);

164 
$Ïnguages
 = 
	`Ïnguage_li¡
();

165 
	`fÜ—ch
 (
$Ïnguages
 
as
 
$Ïngcode
 => 
$Ïnguage
) {

166 ià(
	`is£t
(
$Œª¦©iÚs
[
$Ïngcode
])) {

167 
$lšks
["node_Œª¦©iÚ_$Ïngcode"] = 
	`¬¿y
(

168 't™Ë' => 
$Ïnguage
->
Çtive
,

169 'h»f' => 'node/'. 
$Œª¦©iÚs
[
$Ïngcode
]->
nid
,

170 'Ïnguage' => 
$Ïnguage
,

171 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
$Œª¦©iÚs
[
$Ïngcode
]->
t™Ë
, 'class' => 'translation-link')

176  
$lšks
;

177 
	}
}

184 
funùiÚ
 
	$Œª¦©iÚ_nod—pi
(&
$node
, 
$İ
, 
$‹a£r
, 
$·ge
) {

186 ià(!
	`Œª¦©iÚ_suµÜ‹d_ty³
(
$node
->
ty³
)) {

190 
$İ
) {

192 ià(
	`em±y
(
$node
->
nid
è&& 
	`u£r_acûss
('Œª¦©cÚ‹Á'è&& 
	`is£t
(
$_GET
['Œª¦©iÚ']è&& is£t($_GET['Ïnguage']è&& 
	`is_num”ic
($_GET['translation'])) {

193 
$Œª¦©iÚ_sourû
 = 
	`node_lßd
(
$_GET
['translation']);

194 ià(
	`em±y
(
$Œª¦©iÚ_sourû
è|| !
	`node_acûss
('view', $translation_source)) {

200 
$Ïnguage_li¡
 = 
	`Ïnguage_li¡
();

201 ià(!
	`is£t
(
$Ïnguage_li¡
[
$_GET
['Ïnguage']]è|| (
$Œª¦©iÚ_sourû
->
Ïnguage
 == $_GET['language'])) {

206 
$node
->
Ïnguage
 = 
$_GET
['language'];

207 
$node
->
Œª¦©iÚ_sourû
 = 
$Œª¦©iÚ_sourû
;

208 
$node
->
t™Ë
 = 
$Œª¦©iÚ_sourû
->title;

212 
$node
->
body
 = 
	`f‹r_acûss
(
$Œª¦©iÚ_sourû
->
fÜm©
) ? $translation_source->body : '';

214 
	`node_švoke_nod—pi
(
$node
, 'prepareranslation');

219 ià(!
	`em±y
(
$node
->
Œª¦©iÚ_sourû
)) {

220 ià(
$node
->
Œª¦©iÚ_sourû
->
Šid
) {

222 
$Šid
 = 
$node
->
Œª¦©iÚ_sourû
->
Šid
;

226 
$Šid
 = 
$node
->
Œª¦©iÚ_sourû
->
nid
;

227 
	`db_qu”y
("UPDATE {node} SETnid = %d,¿n¦©ğ%d WHERE‚id = %d", 
$Šid
, 0, 
$node
->
Œª¦©iÚ_sourû
->
nid
);

229 
	`db_qu”y
("UPDATE {node} SETnid = %d,¿n¦©ğ%d WHERE‚id = %d", 
$Šid
, 0, 
$node
->
nid
);

234 ià(
	`is£t
(
$node
->
Œª¦©iÚ
è&& $node->Œª¦©iÚ && !
	`em±y
($node->
Ïnguage
è&& $node->
Šid
) {

236 
	`db_qu”y
("UPDATE {node} SETnid = %d,¿n¦©ğ%d WHERE‚id = %d", 
$node
->
Šid
, $node->
Œª¦©iÚ
['¡©us'], $node->
nid
);

237 ià(!
	`em±y
(
$node
->
Œª¦©iÚ
['retranslate'])) {

239 
	`db_qu”y
("UPDATE {node} SET¿n¦©ğ1 WHEREnid = %d AND‚id !ğ%d", 
$node
->
Šid
, $node->
nid
);

245 
	`Œª¦©iÚ_»move_äom_£t
(
$node
);

248 
	}
}

254 
funùiÚ
 
	$Œª¦©iÚ_»move_äom_£t
(
$node
) {

255 ià(
	`is£t
(
$node
->
Šid
)) {

256 ià(
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(*èFROM {node} WHEREnid = %d', 
$node
->
Šid
)) == 1) {

258 
	`db_qu”y
('UPDATE {node} SETnid = 0,¿n¦©ğ0 WHEREnid = %d', 
$node
->
Šid
);

261 
	`db_qu”y
('UPDATE {node} SETnid = 0,¿n¦©ğ0 WHERE‚id = %d', 
$node
->
nid
);

265 ià(
$node
->
Šid
 =ğ$node->
nid
) {

266 
$Ãw_Šid
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT‚id FROM {node} WHEREnid = %d ORDER BY¿n¦©ASC,‚id ASC', 
$node
->
Šid
));

267 
	`db_qu”y
('UPDATE {node} SETnid = %d WHEREnid = %d', 
$Ãw_Šid
, 
$node
->
Šid
);

271 
	}
}

286 
funùiÚ
 
	$Œª¦©iÚ_node_g‘_Œª¦©iÚs
(
$Šid
) {

287 
$Œª¦©iÚs
 = 
	`¬¿y
();

289 ià(
	`is_num”ic
(
$Šid
) && $tnid) {

290 ià(!
	`is£t
(
$Œª¦©iÚs
[
$Šid
])) {

291 
$Œª¦©iÚs
[
$Šid
] = 
	`¬¿y
();

292 
$»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
('SELECT‚.nid,‚.t™Ë,‚.ÏnguagFROM {node}‚ WHERE‚.Šid = %d'), 
$Šid
);

293 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

294 
$Œª¦©iÚs
[
$Šid
][
$node
->
Ïnguage
] = $node;

297  
$Œª¦©iÚs
[
$Šid
];

299 
	}
}

307 
funùiÚ
 
	$Œª¦©iÚ_suµÜ‹d_ty³
(
$ty³
) {

308  
	`v¬ŸbË_g‘
('Ïnguage_cÚ‹Á_ty³_'. 
$ty³
, 0è=ğ
TRANSLATION_ENABLED
;

309 
	}
}

321 
funùiÚ
 
	$Œª¦©iÚ_·th_g‘_Œª¦©iÚs
(
$·th
) {

322 
$·ths
 = 
	`¬¿y
();

324 ià((
	`´eg_m©ch
("!^node/([0-9]+)(/.+|)$!", 
$·th
, 
$m©ches
)è&& (
$node
 = 
	`node_lßd
(()$m©ches[1])è&& !
	`em±y
($node->
Šid
)) {

325 
	`fÜ—ch
 (
	`Œª¦©iÚ_node_g‘_Œª¦©iÚs
(
$node
->
Šid
è
as
 
$Ïnguage
 => 
$Œª¦©iÚ_node
) {

326 
$·ths
[
$Ïnguage
] = 'node/'. 
$Œª¦©iÚ_node
->
nid
 . 
$m©ches
[2];

329  
$·ths
;

330 
	}
}

337 
funùiÚ
 
	$Œª¦©iÚ_Œª¦©iÚ_lšk_®‹r
(&
$lšks
, 
$·th
) {

338 ià(
$·ths
 = 
	`Œª¦©iÚ_·th_g‘_Œª¦©iÚs
(
$·th
)) {

339 
	`fÜ—ch
 (
$lšks
 
as
 
$Ïngcode
 => 
$lšk
) {

340 ià(
	`is£t
(
$·ths
[
$Ïngcode
])) {

342 
$lšks
[
$Ïngcode
]['h»f'] = 
$·ths
[$langcode];

346 
	`un£t
(
$lšks
[
$Ïngcode
]);

350 
	}
}

	@/srv/http/subs/notes/www/modules/translation/translation.pages.inc

1 <?
php


15 
funùiÚ
 
	$Œª¦©iÚ_node_ov”v›w
(
$node
) {

16 ià(
$node
->
Šid
) {

18 
$Šid
 = 
$node
->
Šid
;

19 
$Œª¦©iÚs
 = 
	`Œª¦©iÚ_node_g‘_Œª¦©iÚs
(
$node
->
Šid
);

23 
$Šid
 = 
$node
->
nid
;

24 
$Œª¦©iÚs
 = 
	`¬¿y
(
$node
->
Ïnguage
 => $node);

27 
$h—d”
 = 
	`¬¿y
(
	`t
('Language'),('Title'),('Status'),('Operations'));

29 
	`fÜ—ch
 (
	`Ïnguage_li¡
(è
as
 
$Ïnguage
) {

30 
$İtiÚs
 = 
	`¬¿y
();

31 
$Ïnguage_Çme
 = 
$Ïnguage
->
Çme
;

32 ià(
	`is£t
(
$Œª¦©iÚs
[
$Ïnguage
->
Ïnguage
])) {

35 
$Œª¦©iÚ_node
 = 
	`node_lßd
(
$Œª¦©iÚs
[
$Ïnguage
->
Ïnguage
]->
nid
);

36 
$t™Ë
 = 
	`l
(
$Œª¦©iÚ_node
->
t™Ë
, 'node/'. $Œª¦©iÚ_node->
nid
);

37 ià(
	`node_acûss
('upd©e', 
$Œª¦©iÚ_node
)) {

38 
$İtiÚs
[] = 
	`l
(
	`t
('edit'), "node/$translation_node->nid/edit");

40 
$¡©us
 = 
$Œª¦©iÚ_node
->
¡©us
 ? 
	`t
('Published') :('Not…ublished');

41 
$¡©us
 .ğ
$Œª¦©iÚ_node
->
Œª¦©e
 ? ' - <¥ª cÏss="m¬k”">'. 
	`t
('outdated') .'</span>' : '';

42 ià(
$Œª¦©iÚ_node
->
nid
 =ğ
$Šid
) {

43 
$Ïnguage_Çme
 = 
	`t
('<¡rÚg>@Ïnguage_Çme</¡rÚg> (sourû)', 
	`¬¿y
('@language_name' => $language_name));

48 
$t™Ë
 = 
	`t
('n/a');

49 ià(
	`node_acûss
('ü—‹', 
$node
)) {

50 
$İtiÚs
[] = 
	`l
(
	`t
('add¿n¦©iÚ'), 'node/add/'. 
	`¡r_»¶aû
('_', '-', 
$node
->
ty³
), 
	`¬¿y
('query' => "translation=$node->nid&language=$language->language"));

52 
$¡©us
 = 
	`t
('Notranslated');

54 
$rows
[] = 
	`¬¿y
(
$Ïnguage_Çme
, 
$t™Ë
, 
$¡©us
, 
	`im¶ode
(" | ", 
$İtiÚs
));

57 
	`dru·l_£t_t™Ë
(
	`t
('T¿n¦©iÚ oà%t™Ë', 
	`¬¿y
('%t™Ë' => 
$node
->
t™Ë
)));

58  
	`theme
('bË', 
$h—d”
, 
$rows
);

59 
	}
}

	@/srv/http/subs/notes/www/modules/trigger/trigger.admin.inc

1 <?
php


17 
funùiÚ
 
	$Œigg”_assign
(
$ty³
 = 
NULL
) {

20 ià(!
	`is£t
(
$ty³
)) {

21 
	`dru·l_gÙo
('admin/build/trigger/node');

23 ià(
$ty³
 == 'node') {

24 
$ty³
 = 'nodeapi';

27 
$ouut
 = '';

28 
$hooks
 = 
	`moduË_švoke_®l
('hook_info');

29 
	`fÜ—ch
 (
$hooks
 
as
 
$moduË
 => 
$hook
) {

30 ià(
	`is£t
(
$hook
[
$ty³
])) {

31 
	`fÜ—ch
 (
$hook
[
$ty³
] 
as
 
$İ
 => 
$desütiÚ
) {

32 
$fÜm_id
 = 'Œigg”_'. 
$ty³
 .'_'. 
$İ
 .'_assign_form';

33 
$ouut
 .ğ
	`dru·l_g‘_fÜm
(
$fÜm_id
, 
$ty³
, 
$İ
, 
$desütiÚ
['runs when']);

37  
$ouut
;

38 
	}
}

50 
funùiÚ
 
	$Œigg”_uÇssign
(
$fÜm_¡©e
, 
$hook
 = 
NULL
, 
$İ
 = NULL, 
$aid
 = NULL) {

51 ià(!(
$hook
 && 
$İ
 && 
$aid
)) {

52 
	`dru·l_gÙo
('admin/build/trigger/assign');

55 
$fÜm
['hook'] = 
	`¬¿y
(

57 '#v®ue' => 
$hook
,

59 
$fÜm
['İ”©iÚ'] = 
	`¬¿y
(

61 '#v®ue' => 
$İ
,

63 
$fÜm
['aid'] = 
	`¬¿y
(

65 '#v®ue' => 
$aid
,

68 
$aùiÚ
 = 
	`aùiÚs_funùiÚ_lookup
(
$aid
);

69 
$aùiÚs
 = 
	`aùiÚs_g‘_®l_aùiÚs
();

71 
$de¡š©iÚ
 = 'admš/bud/Œigg”/'. (
$hook
 == 'nodeapi' ? 'node' : $hook);

73  
	`cÚfœm_fÜm
(
$fÜm
,

74 
	`t
('A» you su» you wªˆtØuÇssigÀthaùiÚ %t™Ë?', 
	`¬¿y
('%t™Ë' => 
$aùiÚs
[
$aùiÚ
]['description'])),

75 
$de¡š©iÚ
,

76 
	`t
('You can‡ssign it‡gain†ater if you wish.'),

77 
	`t
('Unassign'),('Cancel')

79 
	}
}

81 
funùiÚ
 
	$Œigg”_uÇssign_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

82 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

83 ià(
$fÜm_v®ues
['confirm'] == 1) {

84 
$aid
 = 
	`aùiÚs_funùiÚ_lookup
(
$fÜm_v®ues
['aid']);

85 
	`db_qu”y
("DELETE FROM {Œigg”_assignm’ts} WHERE hook = '%s' AND o°ğ'%s' AND‡id = '%s'", 
$fÜm_v®ues
['hook'], $fÜm_v®ues['İ”©iÚ'], 
$aid
);

86 
$aùiÚs
 = 
	`aùiÚs_g‘_®l_aùiÚs
();

87 
	`w©chdog
('aùiÚs', 'AùiÚ %aùiÚ ha b“ÀuÇssigÃd.', 
	`¬¿y
('%aùiÚ' => 
$aùiÚs
[
$aid
]['description']));

88 
	`dru·l_£t_mes§ge
(
	`t
('AùiÚ %aùiÚ ha b“ÀuÇssigÃd.', 
	`¬¿y
('%aùiÚ' => 
$aùiÚs
[
$aid
]['description'])));

89 
$hook
 = 
$fÜm_v®ues
['hook'] == 'nodeapi' ? 'node' : $form_values['hook'];

90 
$fÜm_¡©e
['»dœeù'] = 'admš/bud/Œigg”/'. 
$hook
;

93 
	`dru·l_gÙo
('admin/build/trigger');

95 
	}
}

114 
funùiÚ
 
	$Œigg”_assign_fÜm
(
$fÜm_¡©e
, 
$hook
, 
$İ
, 
$desütiÚ
) {

115 
$fÜm
['hook'] = 
	`¬¿y
(

117 '#v®ue' => 
$hook
,

119 
$fÜm
['İ”©iÚ'] = 
	`¬¿y
(

121 '#v®ue' => 
$İ
,

124 
$fÜm
['#validate'][] = 'trigger_assign_form_validate';

125 
$fÜm
['#submit'][] = 'trigger_assign_form_submit';

127 
$İtiÚs
 = 
	`¬¿y
();

128 
$funùiÚs
 = 
	`¬¿y
();

131 
	`fÜ—ch
 (
	`aùiÚs_li¡
(è
as
 
$func
 => 
$m‘ad©a
) {

132 ià(
	`is£t
(
$m‘ad©a
['hooks']['ªy']è|| (is£t($m‘ad©a['hooks'][
$hook
]è&& 
	`is_¬¿y
($m‘ad©a['hooks'][$hook]è&& (
	`š_¬¿y
(
$İ
, $metadata['hooks'][$hook])))) {

133 
$funùiÚs
[] = 
$func
;

136 
	`fÜ—ch
 (
	`aùiÚs_aùiÚs_m­
(
	`aùiÚs_g‘_®l_aùiÚs
()è
as
 
$aid
 => 
$aùiÚ
) {

137 ià(
	`š_¬¿y
(
$aùiÚ
['ÿÎback'], 
$funùiÚs
)) {

138 
$İtiÚs
[
$aùiÚ
['ty³']][
$aid
] = $action['description'];

142 
$fÜm
[
$İ
] = 
	`¬¿y
(

144 '#t™Ë' => 
	`t
('Trigg”: 'è. 
$desütiÚ
,

148 
$aùiÚs
 = 
	`_Œigg”_g‘_hook_aùiÚs
(
$hook
, 
$İ
);

149 
$fÜm
[
$İ
]['assigned']['#type'] = 'value';

150 
$fÜm
[
$İ
]['assigÃd']['#v®ue'] = 
	`¬¿y
();

151 
	`fÜ—ch
 (
$aùiÚs
 
as
 
$aid
 => 
$desütiÚ
) {

152 
$fÜm
[
$İ
]['assigÃd']['#v®ue'][
$aid
] = 
	`¬¿y
(

153 'desütiÚ' => 
$desütiÚ
,

154 'lšk' => 
	`l
(
	`t
('uÇssign'), "admš/bud/Œigg”/uÇssign/$hook/$İ/". 
	`md5
(
$aid
))

158 
$fÜm
[
$İ
]['·»Á'] = 
	`¬¿y
(

163 ià(
	`couÁ
(
$İtiÚs
) != 0) {

164 
	`¬¿y_unshiá
(
$İtiÚs
, 
	`t
('Choose‡n‡ction'));

165 
$fÜm
[
$İ
]['·»Á']['aid'] = 
	`¬¿y
(

167 '#İtiÚs' => 
$İtiÚs
,

169 
$fÜm
[
$İ
]['·»Á']['subm™'] = 
	`¬¿y
(

171 '#v®ue' => 
	`t
('Assign')

175 
$fÜm
[
$İ
]['nÚe'] = 
	`¬¿y
(

176 '#v®ue' => 
	`t
('No‡vailable‡ctions forhisrigger.')

179  
$fÜm
;

180 
	}
}

187 
funùiÚ
 
	$Œigg”_assign_fÜm_v®id©e
(
$fÜm
, 
$fÜm_¡©e
) {

188 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

189 ià(!
	`em±y
(
$fÜm_v®ues
['aid'])) {

190 
$aid
 = 
	`aùiÚs_funùiÚ_lookup
(
$fÜm_v®ues
['aid']);

191 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT‡id FROM {Œigg”_assignm’ts} WHERE hook = '%s' AND o°ğ'%s' AND‡id = '%s'", 
$fÜm_v®ues
['hook'], $fÜm_v®ues['İ”©iÚ'], 
$aid
))) {

192 
	`fÜm_£t_”rÜ
(
$fÜm_v®ues
['İ”©iÚ'], 
	`t
('The‡ction you chose is‡lready‡ssignedohatrigger.'));

195 
	}
}

200 
funùiÚ
 
	$Œigg”_assign_fÜm_subm™
(
$fÜm
, 
$fÜm_¡©e
) {

201 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

203 ià(!
	`em±y
(
$fÜm_v®ues
['aid'])) {

204 
$aid
 = 
	`aùiÚs_funùiÚ_lookup
(
$fÜm_v®ues
['aid']);

205 
$weight
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT MAX(weightèFROM {Œigg”_assignm’ts} WHERE hook = '%s' AND o°ğ'%s'", 
$fÜm_v®ues
['hook'], $form_values['operation']));

206 
	`db_qu”y
("INSERT INTO {Œigg”_assignm’ts} v®ue ('%s', '%s', '%s', %d)", 
$fÜm_v®ues
['hook'], $fÜm_v®ues['İ”©iÚ'], 
$aid
, 
$weight
 + 1);

209 
$aùiÚs
 = 
	`aùiÚs_li¡
();

210 ià(
	`is£t
(
$aùiÚs
[
$aid
]['behaviÜ']è&& 
	`š_¬¿y
('chªges_node_´İ”ty', $aùiÚs[$aid]['behaviÜ']è&& (
$fÜm_v®ues
['operation'] != 'presave')) {

212 
$§ve_po¡_aùiÚ_assigÃd
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT‡id FROM {Œigg”_assignm’ts} WHERE hook = '%s' AND o°ğ'%s' AND‡id = 'node_§ve_aùiÚ'", 
$fÜm_v®ues
['hook'], $form_values['operation']));

213 ià(
$§ve_po¡_aùiÚ_assigÃd
) {

214 
	`db_qu”y
("DELETE FROM {Œigg”_assignm’ts} WHERE hook = '%s' AND o°ğ'%s' AND‡id = 'node_§ve_aùiÚ'", 
$fÜm_v®ues
['hook'], $form_values['operation']);

216 
	`db_qu”y
("INSERT INTO {Œigg”_assignm’ts} VALUES ('%s', '%s', '%s', %d)", 
$fÜm_v®ues
['hook'], $fÜm_v®ues['İ”©iÚ'], 'node_§ve_aùiÚ', 
$weight
 + 2);

217 ià(!
$§ve_po¡_aùiÚ_assigÃd
) {

218 
	`dru·l_£t_mes§ge
(
	`t
('You have‡dded‡n‡ctionhat changes‡he…roperty of‡…ost. A Save…ost‡ction has been‡dded sohathe…roperty change will be saved.'));

222 
	}
}

234 
funùiÚ
 
	$theme_Œigg”_di¥Ïy
(
$–em’t
) {

235 
$h—d”
 = 
	`¬¿y
();

236 
$rows
 = 
	`¬¿y
();

237 ià(
	`couÁ
(
$–em’t
['assigned']['#value'])) {

238 
$h—d”
 = 
	`¬¿y
×¼ay('d©a' => 
	`t
('Name')),‡rray('data' =>('Operation')));

239 
$rows
 = 
	`¬¿y
();

240 
	`fÜ—ch
 (
$–em’t
['assigÃd']['#v®ue'] 
as
 
$aid
 => 
$šfo
) {

241 
$rows
[] = 
	`¬¿y
(

242 
	`f‹r_xss_admš
(
$šfo
['description']),

243 
$šfo
['link']

248 ià(
	`couÁ
(
$rows
)) {

249 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
è. 
	`dru·l_»nd”
(
$–em’t
);

252 
$ouut
 = 
	`dru·l_»nd”
(
$–em’t
);

254  
$ouut
;

255 
	}
}

273 
funùiÚ
 
	$_Œigg”_g‘_hook_aùiÚs
(
$hook
, 
$İ
, 
$ty³
 = 
NULL
) {

274 
$aùiÚs
 = 
	`¬¿y
();

275 ià(
$ty³
) {

276 
$»suÉ
 = 
	`db_qu”y
("SELECT h.aid,‡.desütiÚ FROM {Œigg”_assignm’ts} h LEFT JOIN {aùiÚs}‡ oÀa.aid = h.aid WHERE‡.ty³ = '%s' AND h.hook = '%s' AND h.İ = '%s' ORDER BY h.weight", 
$ty³
, 
$hook
, 
$İ
);

279 
$»suÉ
 = 
	`db_qu”y
("SELECT h.aid,‡.desütiÚ FROM {Œigg”_assignm’ts} h LEFT JOIN {aùiÚs}‡ oÀa.aid = h.aid WHERE h.hook = '%s' AND h.İ = '%s' ORDER BY h.weight", 
$hook
, 
$İ
);

281 
$aùiÚ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

282 
$aùiÚs
[
$aùiÚ
->
aid
] = $aùiÚ->
desütiÚ
;

284  
$aùiÚs
;

285 
	}
}

	@/srv/http/subs/notes/www/modules/trigger/trigger.module

1 <?
php


13 
funùiÚ
 
	$Œigg”_h–p
(
$·th
, 
$¬g
) {

14 
$ex¶ª©iÚ
 = '<p>'. 
	`t
('Trigg” ¬sy¡emƒv’ts, such‡ wh’‚ew cÚ‹Á i added o¸wh’‡ u£¸log š. Trigg” moduË combše the£rigg” w™h‡ùiÚ (funùiÚ®asks), such‡ uÅublishšg cÚ‹Á o¸e-mašg‡Àadmši¡¿tÜ. Th<¨h»f="@u¾">AùiÚ £‰šg ·ge</a> cÚš ¨li¡ oàexi¡šg‡ùiÚ ªd…rovide thab™yØü—‹‡nd cÚfigu»‡dd™iÚ®‡ùiÚs.', 
	`¬¿y
('@u¾' => 
	`u¾
('admin/settings/actions'))) .'</p>';

15 
$·th
) {

17  
$ex¶ª©iÚ
 .'<p>'. 
	`t
('Below you can‡ssign‡ctionso„un when certain comment-relatedriggers happen. Forƒxample, you could…romote‡…ostohe front…age when‡ comment is‡dded.') .'</p>';

19  
$ex¶ª©iÚ
 .'<p>'. 
	`t
('Below you can‡ssign‡ctionso„un when certain content-relatedriggers happen. Forƒxample, you could send‡nƒ-mailo‡n‡dministrator when‡…ost is created or updated.') .'</p>';

21  
$ex¶ª©iÚ
 .'<p>'. 
	`t
('B–ow you cª‡ssigÀaùiÚ tØruÀduršgƒach…as oà¨<¨h»f="@üÚ">üÚ maš‹Çnûask</a>.', 
	`¬¿y
('@üÚ' => 
	`u¾
('admin/reports/status'))) .'</p>';

23  
$ex¶ª©iÚ
 .'<p>'. 
	`t
('Below you can‡ssign‡ctionso„un when certainaxonomy-relatedriggers happen. Forƒxample, you could send‡nƒ-mailo‡n‡dministrator when‡erm is deleted.') .'</p>';

25  
$ex¶ª©iÚ
 .'<p>'. 
	`t
("Below you can‡ssign‡ctionso„un when certain user-relatedriggers happen. Forƒxample, you could send‡nƒ-mailo‡n‡dministrator when‡ user‡ccount is deleted.") .'</p>';

27 
$ouut
 = '<p>'. 
	`t
('ThTrigg” moduË…rovide thab™yØŒigg” <¨h»f="@aùiÚs">aùiÚs</a> upÚ sy¡emƒv’ts, such‡ wh’‚ew cÚ‹Á i added o¸wh’‡ u£¸log š.', 
	`¬¿y
('@aùiÚs' => 
	`u¾
('admin/settings/actions'))) .'</p>';

28 
$ouut
 .ğ'<p>'. 
	`t
('The combination of‡ctions‡ndriggers can…erform many usefulasks, such‡sƒ-mailing‡n‡dministrator if‡ user‡ccount is deleted, or‡utomatically unpublishing commentshat contain certain words. By default,here‡re five "contexts" ofƒvents (Comments, Content, Cron, Taxonomy,‡nd Users), but more may be‡dded by‡dditional modules.') .'</p>';

29 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@Œigg”">Trigg” moduË</a>.', 
	`¬¿y
('@trigger' => 'http://drupal.org/handbook/modules/trigger/')) .'</p>';

30  
$ouut
;

32 
	}
}

37 
funùiÚ
 
	$Œigg”_m’u
() {

38 
$™ems
['admš/bud/Œigg”'] = 
	`¬¿y
(

43 'acûs ¬gum’ts' => 
	`¬¿y
('node'),

48 
$™ems
['admš/bud/Œigg”/node'] = 
	`¬¿y
(

51 '·g¬gum’ts' => 
	`¬¿y
('node'),

53 'acûs ¬gum’ts' => 
	`¬¿y
('node'),

54 'ty³' => 
MENU_LOCAL_TASK
,

57 
$™ems
['admš/bud/Œigg”/u£r'] = 
	`¬¿y
(

60 '·g¬gum’ts' => 
	`¬¿y
('user'),

62 'acûs ¬gum’ts' => 
	`¬¿y
('user'),

63 'ty³' => 
MENU_LOCAL_TASK
,

66 
$™ems
['admš/bud/Œigg”/comm’t'] = 
	`¬¿y
(

69 '·g¬gum’ts' => 
	`¬¿y
('comment'),

71 'acûs ¬gum’ts' => 
	`¬¿y
('comment'),

72 'ty³' => 
MENU_LOCAL_TASK
,

75 
$™ems
['admš/bud/Œigg”/xÚomy'] = 
	`¬¿y
(

78 '·g¬gum’ts' => 
	`¬¿y
('taxonomy'),

80 'acûs ¬gum’ts' => 
	`¬¿y
('taxonomy'),

81 'ty³' => 
MENU_LOCAL_TASK
,

84 
$™ems
['admš/bud/Œigg”/üÚ'] = 
	`¬¿y
(

87 '·g¬gum’ts' => 
	`¬¿y
('cron'),

88 'acûs ¬gum’ts' => 
	`¬¿y
('administer‡ctions'),

89 'ty³' => 
MENU_LOCAL_TASK
,

95 
$hooks
 = 
	`moduË_švoke_®l
('hook_info');

96 
	`fÜ—ch
 (
$hooks
 
as
 
$moduË
 => 
$hook
) {

98 ià(
	`š_¬¿y
(
$moduË
, 
	`¬¿y
('node', 'comment', 'user', 'system', 'taxonomy'))) {

101 
$šfo
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT infØFROM {sy¡em} WHERE‚amğ'%s'", 
$moduË
));

102 
$šfo
 = 
	`un£rŸlize
($info);

103 
$niû_Çme
 = 
$šfo
['name'];

104 
$™ems
["admš/bud/Œigg”/$moduË"] = 
	`¬¿y
(

105 't™Ë' => 
$niû_Çme
,

107 '·g¬gum’ts' => 
	`¬¿y
(
$moduË
),

109 'acûs ¬gum’ts' => 
	`¬¿y
(
$moduË
),

110 'ty³' => 
MENU_LOCAL_TASK
,

114 
$™ems
['admš/bud/Œigg”/uÇssign'] = 
	`¬¿y
(

118 '·g¬gum’ts' => 
	`¬¿y
('trigger_unassign'),

119 'acûs ¬gum’ts' => 
	`¬¿y
('administer‡ctions'),

120 'ty³' => 
MENU_CALLBACK
,

124  
$™ems
;

125 
	}
}

130 
funùiÚ
 
	$Œigg”_acûss_check
(
$moduË
) {

131  (
	`moduË_exi¡s
(
$moduË
è&& 
	`u£r_acûss
('administer‡ctions'));

132 
	}
}

145 
funùiÚ
 
_Œigg”_g‘_hook_aids
(
$hook
, 
$İ
 = '') {

146 
$aids
 = 
¬¿y
();

147 
	g$»suÉ
 = 
db_qu”y
("SELECT‡a.aid,‡.ty³ FROM {Œigg”_assignm’ts}‡¨LEFT JOIN {aùiÚs}‡ ON‡a.aid =‡.aid WHERE‡a.hook = '%s' AND‡a.İ = '%s' ORDER BY weight", 
$hook
, 
$İ
);

148 
	g$aùiÚ
 = 
db_ãtch_objeù
(
$»suÉ
)) {

149 
$aids
[
$aùiÚ
->
aid
]['ty³'] = $aùiÚ->
ty³
;

151  
	g$aids
;

157 
funùiÚ
 
	$Œigg”_theme
() {

158  
	`¬¿y
(

159 'Œigg”_di¥Ïy' => 
	`¬¿y
(

160 '¬gum’ts' => 
	`¬¿y
('element'),

164 
	}
}

170 
funùiÚ
 
	$Œigg”_fÜms
() {

171 
$hooks
 = 
	`moduË_švoke_®l
('hook_info');

172 
	`fÜ—ch
 (
$hooks
 
as
 
$moduË
 => 
$šfo
) {

173 
	`fÜ—ch
 (
$hooks
[
$moduË
] 
as
 
$hook
 => 
$İs
) {

174 
	`fÜ—ch
 (
$İs
 
as
 
$İ
 => 
$desütiÚ
) {

175 
$fÜms
['Œigg”_'. 
$hook
 .'_'. 
$İ
 .'_assign_fÜm'] = 
	`¬¿y
('callback' => 'trigger_assign_form');

180  
$fÜms
;

181 
	}
}

197 
funùiÚ
 
	$_Œigg”_nÜm®ize_node_cÚ‹xt
(
$ty³
, 
$node
) {

198 
$ty³
) {

207  
	`u£r_lßd
(
	`¬¿y
('uid' => 
$node
->
uid
));

209 
	}
}

214 
funùiÚ
 
	$Œigg”_nod—pi
(&
$node
, 
$İ
, 
$a3
, 
$a4
) {

216 
$objeùs
;

218 
$»cursiÚ
;

220 ià(!
	`š_¬¿y
(
$İ
, 
	`¬¿y
('v›w', 'upd©e', '´e§ve', 'š£¹', 'd–‘e')è|| 
	`is£t
(
$»cursiÚ
[$op])) {

223 
$»cursiÚ
[
$İ
] = 
TRUE
;

225 
$aids
 = 
	`_Œigg”_g‘_hook_aids
('nod—pi', 
$İ
);

226 ià(!
$aids
) {

229 
$cÚ‹xt
 = 
	`¬¿y
(

231 'İ' => 
$İ
,

237 
	`fÜ—ch
 (
$aids
 
as
 
$aid
 => 
$aùiÚ_šfo
) {

238 ià(
$aùiÚ_šfo
['type'] != 'node') {

239 ià(!
	`is£t
(
$objeùs
[
$aùiÚ_šfo
['type']])) {

240 
$objeùs
[
$aùiÚ_šfo
['ty³']] = 
	`_Œigg”_nÜm®ize_node_cÚ‹xt
($aùiÚ_šfo['ty³'], 
$node
);

243 
$cÚ‹xt
['node'] = 
$node
;

244 
$»suÉ
 = 
	`aùiÚs_do
(
$aid
, 
$objeùs
[
$aùiÚ_šfo
['ty³']], 
$cÚ‹xt
, 
$a3
, 
$a4
);

247 
	`aùiÚs_do
(
$aid
, 
$node
, 
$cÚ‹xt
, 
$a3
, 
$a4
);

250 
	}
}

266 
funùiÚ
 
	$_Œigg”_nÜm®ize_comm’t_cÚ‹xt
(
$ty³
, 
$comm’t
) {

267 
$ty³
) {

270  
	`node_lßd
(
	`is_¬¿y
(
$comm’t
è? $comm’t['nid'] : $comm’t->
nid
);

274  
	`u£r_lßd
(
	`¬¿y
('uid' => 
	`is_¬¿y
(
$comm’t
è? $comm’t['uid'] : $comm’t->
uid
));

276 
	}
}

281 
funùiÚ
 
	$Œigg”_comm’t
(
$a1
, 
$İ
) {

283 
$objeùs
;

285 ià(!
	`š_¬¿y
(
$İ
, 
	`¬¿y
('insert', 'update', 'delete', 'view'))) {

288 
$aids
 = 
	`_Œigg”_g‘_hook_aids
('comm’t', 
$İ
);

289 
$cÚ‹xt
 = 
	`¬¿y
(

291 'İ' => 
$İ
,

296 
	`fÜ—ch
 (
$aids
 
as
 
$aid
 => 
$aùiÚ_šfo
) {

297 ià(
$aùiÚ_šfo
['type'] != 'comment') {

298 ià(!
	`is£t
(
$objeùs
[
$aùiÚ_šfo
['type']])) {

299 
$objeùs
[
$aùiÚ_šfo
['ty³']] = 
	`_Œigg”_nÜm®ize_comm’t_cÚ‹xt
($aùiÚ_šfo['ty³'], 
$a1
);

303 
$cÚ‹xt
['comm’t'] = (
objeù
è
$a1
;

304 
	`aùiÚs_do
(
$aid
, 
$objeùs
[
$aùiÚ_šfo
['ty³']], 
$cÚ‹xt
);

307 
$comm’t
 = (
objeù
è
$a1
;

308 
	`aùiÚs_do
(
$aid
, 
$comm’t
, 
$cÚ‹xt
);

311 
	}
}

316 
funùiÚ
 
	$Œigg”_üÚ
() {

317 
$aids
 = 
	`_Œigg”_g‘_hook_aids
('cron', 'run');

318 
$cÚ‹xt
 = 
	`¬¿y
(

323 
$objeù
 = 
NULL
;

324 
	`aùiÚs_do
(
	`¬¿y_keys
(
$aids
), 
$objeù
, 
$cÚ‹xt
);

325 
	}
}

341 
funùiÚ
 
	$_Œigg”_nÜm®ize_u£r_cÚ‹xt
(
$ty³
, 
$accouÁ
) {

342 
$ty³
) {

352 ià((
	`¬g
(0è=ğ'node'è&& 
	`is_num”ic
×rg(1)è&& (¬g(2è=ğ
NULL
)) {

353  
	`node_lßd
(
	`¬¿y
('nid' => 
	`¬g
(1)));

356 
	}
}

361 
funùiÚ
 
	$Œigg”_u£r
(
$İ
, &
$ed™
, &
$accouÁ
, 
$ÿ‹gÜy
 = 
NULL
) {

363 
$objeùs
;

365 ià(!
	`š_¬¿y
(
$İ
, 
	`¬¿y
('login', 'logout', 'insert', 'update', 'delete', 'view'))) {

368 
$aids
 = 
	`_Œigg”_g‘_hook_aids
('u£r', 
$İ
);

369 
$cÚ‹xt
 = 
	`¬¿y
(

371 'İ' => 
$İ
,

372 'fÜm_v®ues' => &
$ed™
,

374 
	`fÜ—ch
 (
$aids
 
as
 
$aid
 => 
$aùiÚ_šfo
) {

375 ià(
$aùiÚ_šfo
['type'] != 'user') {

376 ià(!
	`is£t
(
$objeùs
[
$aùiÚ_šfo
['type']])) {

377 
$objeùs
[
$aùiÚ_šfo
['ty³']] = 
	`_Œigg”_nÜm®ize_u£r_cÚ‹xt
($aùiÚ_šfo['ty³'], 
$accouÁ
);

379 
$cÚ‹xt
['accouÁ'] = 
$accouÁ
;

380 
	`aùiÚs_do
(
$aid
, 
$objeùs
[
$aùiÚ_šfo
['ty³']], 
$cÚ‹xt
);

383 
	`aùiÚs_do
(
$aid
, 
$accouÁ
, 
$cÚ‹xt
, 
$ÿ‹gÜy
);

386 
	}
}

391 
funùiÚ
 
	$Œigg”_xÚomy
(
$İ
, 
$ty³
, 
$¬¿y
) {

392 ià(
$ty³
 != 'term') {

395 
$aids
 = 
	`_Œigg”_g‘_hook_aids
('xÚomy', 
$İ
);

396 
$cÚ‹xt
 = 
	`¬¿y
(

398 'İ' => 
$İ


400 
	`fÜ—ch
 (
$aids
 
as
 
$aid
 => 
$aùiÚ_šfo
) {

401 
$xÚomy_objeù
 = (
objeù
è
$¬¿y
;

402 
	`aùiÚs_do
(
$aid
, 
$xÚomy_objeù
, 
$cÚ‹xt
);

404 
	}
}

415 
funùiÚ
 
Œigg”_İtiÚs
(
$ty³
 = 'all') {

416 
$İtiÚs
 = 
¬¿y
(
t
('Choose‡n‡ction'));

417 
fÜ—ch
 (
aùiÚs_aùiÚs_m­
(
aùiÚs_g‘_®l_aùiÚs
()è
as
 
$aid
 => 
$aùiÚ
) {

418 
$İtiÚs
[
$aùiÚ
['ty³']][
$aid
] = $action['description'];

421 ià(
	g$ty³
 == 'all') {

422  
$İtiÚs
;

425  
	g$İtiÚs
[
$ty³
];

434 
funùiÚ
 
	$Œigg”_aùiÚs_d–‘e
(
$aid
) {

435 
	`db_qu”y
("DELETE FROM {Œigg”_assignm’ts} WHERE‡id = '%s'", 
$aid
);

436 
	}
}

	@/srv/http/subs/notes/www/modules/update/update.compare.inc

1 <?
php


32 
funùiÚ
 
	$upd©e_g‘_´ojeùs
() {

33 
$´ojeùs
 = 
	`¬¿y
();

34 ià(
	`em±y
(
$´ojeùs
)) {

36 
$´ojeùs
 = 
	`upd©e_´ojeù_ÿche
('update_project_projects');

37 ià(
	`em±y
(
$´ojeùs
)) {

39 
	`_upd©e_´oûss_šfo_li¡
(
$´ojeùs
, 
	`moduË_»bud_ÿche
(), 'module');

40 
	`_upd©e_´oûss_šfo_li¡
(
$´ojeùs
, 
	`sy¡em_theme_d©a
(), 'theme');

42 
	`dru·l_®‹r
('upd©e_´ojeùs', 
$´ojeùs
);

44 
	`_upd©e_ÿche_£t
('upd©e_´ojeù_´ojeùs', 
$´ojeùs
, 
	`time
() + 3600);

47  
$´ojeùs
;

48 
	}
}

53 
funùiÚ
 
	$_upd©e_´oûss_šfo_li¡
(&
$´ojeùs
, 
$li¡
, 
$´ojeù_ty³
) {

54 
	`fÜ—ch
 (
$li¡
 
as
 
$fe
) {

57 ià(!
$fe
->
¡©us
 && !
	`em±y
($fe->
sub_themes
)) {

58 
	`fÜ—ch
 (
$fe
->
sub_themes
 
as
 
$key
 => 
$Çme
) {

60 ià(
$li¡
[
$key
]->
¡©us
) {

61 
$fe
->
’abËd_sub_themes
[
$key
] = 
$Çme
;

66 ià(
	`em±y
(
$fe
->
’abËd_sub_themes
)) {

70 
	`–£if
 (
	`em±y
(
$fe
->
¡©us
)) {

76 ià(
	`em±y
(
$fe
->
šfo
)) {

81 ià(!
	`is£t
(
$fe
->
šfo
['project'])) {

82 
$fe
->
šfo
['´ojeù'] = 
	`upd©e_g‘_´ojeù_Çme
($file);

86 ià(
	`em±y
(
$fe
->
šfo
['project'])) {

97 ià(!
	`is£t
(
$fe
->
šfo
['_info_file_ctime'])) {

98 
$šfo_f’ame
 = 
	`dœÇme
(
$fe
->
f’ame
è.'/'. $fe->
Çme
 .'.info';

99 
$fe
->
šfo
['_šfo_fe_ùime'] = 
	`feùime
(
$šfo_f’ame
);

102 ià(!
	`is£t
(
$fe
->
šfo
['datestamp'])) {

103 
$fe
->
šfo
['datestamp'] = 0;

106 
$´ojeù_Çme
 = 
$fe
->
šfo
['project'];

110 ià(
$´ojeù_Çme
 == 'drupal') {

112 
$sub_themes
 = 
	`¬¿y
();

113 
$ba£_themes
 = 
	`¬¿y
();

117 
$sub_themes
 = !
	`em±y
(
$fe
->
’abËd_sub_themes
è? $fe->’abËd_sub_theme : 
	`¬¿y
();

119 
$ba£_themes
 = !
	`em±y
(
$fe
->
ba£_themes
è? $fe->ba£_theme : 
	`¬¿y
();

122 ià(!
	`is£t
(
$´ojeùs
[
$´ojeù_Çme
])) {

125 
$´ojeùs
[
$´ojeù_Çme
] = 
	`¬¿y
(

126 'Çme' => 
$´ojeù_Çme
,

129 'šfo' => 
	`upd©e_f‹r_´ojeù_šfo
(
$fe
->
šfo
),

130 'd©e¡amp' => 
$fe
->
šfo
['datestamp'],

131 'šşudes' => 
	`¬¿y
(
$fe
->
Çme
 => $fe->
šfo
['name']),

132 '´ojeù_ty³' => 
$´ojeù_Çme
 =ğ'dru·l' ? 'cÜe' : 
$´ojeù_ty³
,

133 'sub_themes' => 
$sub_themes
,

134 'ba£_themes' => 
$ba£_themes
,

138 
$´ojeùs
[
$´ojeù_Çme
]['šşudes'][
$fe
->
Çme
] = $fe->
šfo
['name'];

139 
$´ojeùs
[
$´ojeù_Çme
]['šfo']['_šfo_fe_ùime'] = 
	`max
($´ojeùs[$´ojeù_Çme]['šfo']['_šfo_fe_ùime'], 
$fe
->
šfo
['_info_file_ctime']);

140 
$´ojeùs
[
$´ojeù_Çme
]['d©e¡amp'] = 
	`max
($´ojeùs[$´ojeù_Çme]['d©e¡amp'], 
$fe
->
šfo
['datestamp']);

141 
$´ojeùs
[
$´ojeù_Çme
]['sub_themes'] = 
	`¬¿y_m”ge
($´ojeùs[$´ojeù_Çme]['sub_themes'], 
$sub_themes
);

142 
$´ojeùs
[
$´ojeù_Çme
]['ba£_themes'] = 
	`¬¿y_m”ge
($´ojeùs[$´ojeù_Çme]['ba£_themes'], 
$ba£_themes
);

145 
	}
}

153 
funùiÚ
 
	$upd©e_g‘_´ojeù_Çme
(
$fe
) {

154 
$´ojeù_Çme
 = '';

155 ià(
	`is£t
(
$fe
->
šfo
['project'])) {

156 
$´ojeù_Çme
 = 
$fe
->
šfo
['project'];

158 
	`–£if
 (
	`is£t
(
$fe
->
šfo
['·ckage']è&& (
	`¡½os
($fe->šfo['·ckage'], 'CÜ-'è!=ğ
FALSE
)) {

159 
$´ojeù_Çme
 = 'drupal';

161 
	`–£if
 (
	`š_¬¿y
(
$fe
->
Çme
, 
	`¬¿y
('bluemarine', 'chameleon', 'garland', 'marvin', 'minnelli', 'pushbutton'))) {

164 
$´ojeù_Çme
 = 'drupal';

166  
$´ojeù_Çme
;

167 
	}
}

177 
funùiÚ
 
	$upd©e_´oûss_´ojeù_šfo
(&
$´ojeùs
) {

178 
	`fÜ—ch
 (
$´ojeùs
 
as
 
$key
 => 
$´ojeù
) {

180 
$š¡®l_ty³
 = 'official';

182 
$šfo
 = 
$´ojeù
['info'];

184 ià(
	`is£t
(
$šfo
['version'])) {

186 ià(
	`´eg_m©ch
('@(dev|HEAD)@', 
$šfo
['version'])) {

187 
$š¡®l_ty³
 = 'dev';

193 
$m©ches
 = 
	`¬¿y
();

194 ià(
	`´eg_m©ch
('/^(\d+\.x-)?(\d+)\..*$/', 
$šfo
['v”siÚ'], 
$m©ches
)) {

195 
$šfo
['majÜ'] = 
$m©ches
[2];

197 
	`–£if
 (!
	`is£t
(
$šfo
['major'])) {

201 
$šfo
['major'] = -1;

206 
$š¡®l_ty³
 = 'unknown';

207 
$šfo
['v”siÚ'] = 
	`t
('Unknown');

208 
$šfo
['major'] = -1;

212 
$´ojeùs
[
$key
]['exi¡šg_v”siÚ'] = 
$šfo
['version'];

213 
$´ojeùs
[
$key
]['exi¡šg_majÜ'] = 
$šfo
['major'];

214 
$´ojeùs
[
$key
]['š¡®l_ty³'] = 
$š¡®l_ty³
;

216 
	}
}

296 
funùiÚ
 
	$upd©e_ÿlcuÏ‹_´ojeù_d©a
(
$avaabË
) {

298 
$´ojeùs
 = 
	`upd©e_´ojeù_ÿche
('update_project_data');

301 ià(!
	`em±y
(
$´ojeùs
)) {

302  
$´ojeùs
;

304 
$´ojeùs
 = 
	`upd©e_g‘_´ojeùs
();

305 
	`upd©e_´oûss_´ojeù_šfo
(
$´ojeùs
);

306 
	`fÜ—ch
 (
$´ojeùs
 
as
 
$´ojeù
 => 
$´ojeù_šfo
) {

307 ià(
	`is£t
(
$avaabË
[
$´ojeù
])) {

311 ià(
	`is£t
(
$avaabË
[
$´ojeù
]['project_status'])) {

312 
$avaabË
[
$´ojeù
]['project_status']) {

314 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_NOT_SECURE
;

315 ià(
	`em±y
(
$´ojeùs
[
$´ojeù
]['extra'])) {

316 
$´ojeùs
[
$´ojeù
]['exŒa'] = 
	`¬¿y
();

318 
$´ojeùs
[
$´ojeù
]['exŒa'][] = 
	`¬¿y
(

320 'Ïb–' => 
	`t
('Project‚ot secure'),

321 'd©a' => 
	`t
('This…roject has been†abeled insecure byhe Drupal securityeam,‡nd is‚o†onger‡vailable for download. Immediately disablingƒverything included byhis…roject is strongly„ecommended!'),

326 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_REVOKED
;

327 ià(
	`em±y
(
$´ojeùs
[
$´ojeù
]['extra'])) {

328 
$´ojeùs
[
$´ojeù
]['exŒa'] = 
	`¬¿y
();

330 
$´ojeùs
[
$´ojeù
]['exŒa'][] = 
	`¬¿y
(

332 'Ïb–' => 
	`t
('Project„evoked'),

333 'd©a' => 
	`t
('This…roject has been„evoked,‡nd is‚o†onger‡vailable for download. Disablingƒverything included byhis…roject is strongly„ecommended!'),

337 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_NOT_SUPPORTED
;

338 ià(
	`em±y
(
$´ojeùs
[
$´ojeù
]['extra'])) {

339 
$´ojeùs
[
$´ojeù
]['exŒa'] = 
	`¬¿y
();

341 
$´ojeùs
[
$´ojeù
]['exŒa'][] = 
	`¬¿y
(

343 'Ïb–' => 
	`t
('Project‚ot supported'),

344 'd©a' => 
	`t
('This…roject is‚o†onger supported,‡nd is‚o†onger‡vailable for download. Disablingƒverything included byhis…roject is strongly„ecommended!'),

348 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_NOT_FETCHED
;

349 
$´ojeùs
[
$´ojeù
]['»asÚ'] = 
	`t
('Failedo fetch‡vailable update data');

359 ià(!
	`em±y
(
$´ojeùs
[
$´ojeù
]['status'])) {

363 
$´ojeùs
[
$´ojeù
] +ğ
$avaabË
[$project];

368 
$exi¡šg_majÜ
 = 
$´ojeù_šfo
['existing_major'];

369 
$suµÜ‹d_majÜs
 = 
	`¬¿y
();

370 ià(
	`is£t
(
$avaabË
[
$´ojeù
]['supported_majors'])) {

371 
$suµÜ‹d_majÜs
 = 
	`ex¶ode
(',', 
$avaabË
[
$´ojeù
]['supported_majors']);

373 
	`–£if
 (
	`is£t
(
$avaabË
[
$´ojeù
]['default_major'])) {

375 
$suµÜ‹d_majÜs
[] = 
$avaabË
[
$´ojeù
]['default_major'];

378 ià(
	`š_¬¿y
(
$exi¡šg_majÜ
, 
$suµÜ‹d_majÜs
)) {

380 
$rg‘_majÜ
 = 
$exi¡šg_majÜ
;

382 
	`–£if
 (
	`is£t
(
$avaabË
[
$´ojeù
]['recommended_major'])) {

387 
$rg‘_majÜ
 = 
$avaabË
[
$´ojeù
]['recommended_major'];

388 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_NOT_SUPPORTED
;

390 
	`–£if
 (
	`is£t
(
$avaabË
[
$´ojeù
]['default_major'])) {

393 
$rg‘_majÜ
 = 
$avaabË
[
$´ojeù
]['default_major'];

397 
$rg‘_majÜ
 = 
$exi¡šg_majÜ
;

407 
$rg‘_majÜ
 = 
	`max
(
$exi¡šg_majÜ
, $target_major);

409 
$v”siÚ_·tch_chªged
 = '';

410 
$·tch
 = '';

413 ià(
	`em±y
(
$avaabË
[
$´ojeù
]['releases'])) {

414 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_UNKNOWN
;

415 
$´ojeùs
[
$´ojeù
]['»asÚ'] = 
	`t
('No‡vailable„eleases found');

418 
	`fÜ—ch
 (
$avaabË
[
$´ojeù
]['»Ëa£s'] 
as
 
$v”siÚ
 => 
$»Ëa£
) {

420 ià(
$´ojeùs
[
$´ojeù
]['exi¡šg_v”siÚ'] ==ğ
$v”siÚ
) {

421 ià(
	`is£t
(
$»Ëa£
['terms']['Releaseype']) &&

422 
	`š_¬¿y
('In£cu»', 
$»Ëa£
['terms']['Releaseype'])) {

423 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_NOT_SECURE
;

425 
	`–£if
 (
$»Ëa£
['status'] == 'unpublished') {

426 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_REVOKED
;

427 ià(
	`em±y
(
$´ojeùs
[
$´ojeù
]['extra'])) {

428 
$´ojeùs
[
$´ojeù
]['exŒa'] = 
	`¬¿y
();

430 
$´ojeùs
[
$´ojeù
]['exŒa'][] = 
	`¬¿y
(

432 'Ïb–' => 
	`t
('Release„evoked'),

433 'd©a' => 
	`t
('Your currently installed„elease has been„evoked,‡nd is‚o†onger‡vailable for download. Disablingƒverything included inhis„elease or upgrading is strongly„ecommended!'),

436 
	`–£if
 (
	`is£t
(
$»Ëa£
['terms']['Releaseype']) &&

437 
	`š_¬¿y
('UnsuµÜ‹d', 
$»Ëa£
['terms']['Releaseype'])) {

438 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_NOT_SUPPORTED
;

439 ià(
	`em±y
(
$´ojeùs
[
$´ojeù
]['extra'])) {

440 
$´ojeùs
[
$´ojeù
]['exŒa'] = 
	`¬¿y
();

442 
$´ojeùs
[
$´ojeù
]['exŒa'][] = 
	`¬¿y
(

444 'Ïb–' => 
	`t
('Release‚ot supported'),

445 'd©a' => 
	`t
('Your currently installed„elease is‚ow unsupported,‡nd is‚o†onger‡vailable for download. Disablingƒverything included inhis„elease or upgrading is strongly„ecommended!'),

451 ià(
$»Ëa£
['status'] == 'unpublished' ||

452 (
	`is£t
(
$»Ëa£
['terms']['Releaseype']) &&

453 (
	`š_¬¿y
('In£cu»', 
$»Ëa£
['terms']['Releaseype']) ||

454 
	`š_¬¿y
('UnsuµÜ‹d', 
$»Ëa£
['terms']['Releaseype'])))) {

460 ià(
$»Ëa£
['v”siÚ_majÜ'] > 
$rg‘_majÜ
) {

461 ià(
	`š_¬¿y
(
$»Ëa£
['v”siÚ_majÜ'], 
$suµÜ‹d_majÜs
)) {

462 ià(!
	`is£t
(
$avaabË
[
$´ojeù
]['also'])) {

463 
$avaabË
[
$´ojeù
]['®so'] = 
	`¬¿y
();

465 ià(!
	`is£t
(
$avaabË
[
$´ojeù
]['®so'][
$»Ëa£
['version_major']])) {

466 
$avaabË
[
$´ojeù
]['®so'][
$»Ëa£
['v”siÚ_majÜ']] = 
$v”siÚ
;

481 ià(!
	`is£t
(
$avaabË
[
$´ojeù
]['latest_version'])

482 && 
$»Ëa£
['v”siÚ_majÜ'] =ğ
$rg‘_majÜ
) {

483 
$avaabË
[
$´ojeù
]['Ï‹¡_v”siÚ'] = 
$v”siÚ
;

487 ià(!
	`is£t
(
$avaabË
[
$´ojeù
]['dev_version'])

488 && 
$»Ëa£
['v”siÚ_majÜ'] =ğ
$rg‘_majÜ


489 && 
	`is£t
(
$»Ëa£
['version_extra'])

490 && 
$»Ëa£
['version_extra'] == 'dev') {

491 
$avaabË
[
$´ojeù
]['dev_v”siÚ'] = 
$v”siÚ
;

496 ià(!
	`is£t
(
$avaabË
[
$´ojeù
]['recommended'])

497 && 
$»Ëa£
['v”siÚ_majÜ'] =ğ
$rg‘_majÜ


498 && 
	`is£t
(
$»Ëa£
['version_patch'])) {

499 ià(
$·tch
 !ğ
$»Ëa£
['version_patch']) {

500 
$·tch
 = 
$»Ëa£
['version_patch'];

501 
$v”siÚ_·tch_chªged
 = 
$»Ëa£
['version'];

503 ià(
	`em±y
(
$»Ëa£
['v”siÚ_exŒa']è&& 
$·tch
 == $release['version_patch']) {

504 
$avaabË
[
$´ojeù
]['»comm’ded'] = 
$v”siÚ_·tch_chªged
;

509 ià(
$´ojeùs
[
$´ojeù
]['exi¡šg_v”siÚ'] ==ğ
$v”siÚ
) {

519 ià(
$´ojeùs
[
$´ojeù
]['install_type'] == 'dev') {

520 ià(
	`em±y
(
$´ojeùs
[
$´ojeù
]['datestamp'])) {

524 
	`–£if
 (
	`is£t
(
$»Ëa£
['d©e']è&& (
$´ojeùs
[
$´ojeù
]['datestamp'] + 100 > $release['date'])) {

531 ià(
	`is£t
(
$»Ëa£
['terms']['Releaseype'])

532 && 
	`š_¬¿y
('Secur™y upd©e', 
$»Ëa£
['terms']['Releaseype'])) {

533 
$´ojeùs
[
$´ojeù
]['£cur™y upd©es'][] = 
$»Ëa£
;

539 ià(!
	`is£t
(
$avaabË
[
$´ojeù
]['recommended']) && isset($available[$project]['latest_version'])) {

540 
$avaabË
[
$´ojeù
]['recommended'] = $available[$project]['latest_version'];

544 
$´ojeùs
[
$´ojeù
] +ğ
$avaabË
[$project];

550 ià(!
	`em±y
(
$´ojeùs
[
$´ojeù
]['security updates'])) {

552 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_NOT_SECURE
;

555 ià(
	`is£t
(
$´ojeùs
[
$´ojeù
]['status'])) {

562 ià(!
	`is£t
(
$´ojeùs
[
$´ojeù
]['recommended'])) {

563 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_UNKNOWN
;

564 
$´ojeùs
[
$´ojeù
]['»asÚ'] = 
	`t
('No‡vailable„eleases found');

572 ià(
$´ojeùs
[
$´ojeù
]['install_type'] == 'dev') {

573 ià(
	`is£t
(
$avaabË
[
$´ojeù
]['dev_version']) && $available[$project]['releases'][$available[$project]['dev_version']]['date'] > $available[$project]['releases'][$available[$project]['latest_version']]['date']) {

574 
$´ojeùs
[
$´ojeù
]['Ï‹¡_dev'] = 
$avaabË
[$project]['dev_version'];

577 
$´ojeùs
[
$´ojeù
]['Ï‹¡_dev'] = 
$avaabË
[$project]['latest_version'];

582 
$´ojeùs
[
$´ojeù
]['install_type']) {

584 ià(
$´ojeùs
[
$´ojeù
]['existing_version'] === $projects[$project]['recommended'] || $projects[$project]['existing_version'] === $projects[$project]['latest_version']) {

585 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_CURRENT
;

588 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_NOT_CURRENT
;

593 
$Ï‹¡
 = 
$avaabË
[
$´ojeù
]['»Ëa£s'][
$´ojeùs
[$project]['latest_dev']];

594 ià(
	`em±y
(
$´ojeùs
[
$´ojeù
]['datestamp'])) {

595 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_NOT_CHECKED
;

596 
$´ojeùs
[
$´ojeù
]['»asÚ'] = 
	`t
('Unknown„elease date');

598 
	`–£if
 ((
$´ojeùs
[
$´ojeù
]['d©e¡amp'] + 100 > 
$Ï‹¡
['date'])) {

599 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_CURRENT
;

602 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_NOT_CURRENT
;

607 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_UNKNOWN
;

608 
$´ojeùs
[
$´ojeù
]['»asÚ'] = 
	`t
('Invalid info');

612 
$´ojeùs
[
$´ojeù
]['¡©us'] = 
UPDATE_UNKNOWN
;

613 
$´ojeùs
[
$´ojeù
]['»asÚ'] = 
	`t
('No‡vailable„eleases found');

619 
	`dru·l_®‹r
('upd©e_¡©us', 
$´ojeùs
);

622 
	`_upd©e_ÿche_£t
('upd©e_´ojeù_d©a', 
$´ojeùs
, 
	`time
() + 3600);

623  
$´ojeùs
;

624 
	}
}

654 
funùiÚ
 
	$upd©e_´ojeù_ÿche
(
$cid
) {

655 
$´ojeùs
 = 
	`¬¿y
();

659 
$q
 = 
$_GET
['q'];

660 
$·ths
 = 
	`¬¿y
('admin/build/modules', 'admin/build/themes', 'admin/reports', 'admin/reports/updates', 'admin/reports/status', 'admin/reports/updates/check');

661 ià(
	`š_¬¿y
(
$q
, 
$·ths
)) {

662 
	`_upd©e_ÿche_ş—r
(
$cid
);

665 
$ÿche
 = 
	`_upd©e_ÿche_g‘
(
$cid
);

666 ià(!
	`em±y
(
$ÿche
->
d©a
è&& $ÿche->
expœe
 > 
	`time
()) {

667 
$´ojeùs
 = 
$ÿche
->
d©a
;

670  
$´ojeùs
;

671 
	}
}

684 
funùiÚ
 
	$upd©e_f‹r_´ojeù_šfo
(
$šfo
) {

685 
$wh™–i¡
 = 
	`¬¿y
(

695 
$wh™–i¡
 = 
	`¬¿y_æ
($whitelist);

696 
	`fÜ—ch
 (
$šfo
 
as
 
$key
 => 
$v®ue
) {

697 ià(!
	`is£t
(
$wh™–i¡
[
$key
])) {

698 
	`un£t
(
$šfo
[
$key
]);

701  
$šfo
;

702 
	}
}

	@/srv/http/subs/notes/www/modules/update/update.fetch.inc

1 <?
php


12 
funùiÚ
 
	$upd©e_mªu®_¡©us
() {

13 ià(
	`_upd©e_»äesh
()) {

14 
	`dru·l_£t_mes§ge
(
	`t
('Attemptedo fetch information‡bout‡ll‡vailable‚ew„eleases‡nd updates.'));

17 
	`dru·l_£t_mes§ge
(
	`t
('Unableo fetch‡ny information‡bout‡vailable‚ew„eleases‡nd updates.'), 'error');

19 
	`dru·l_gÙo
('admin/reports/updates');

20 
	}
}

25 
funùiÚ
 
	$_upd©e_»äesh
() {

26 
$ç
 = 
	`¬¿y
();

27 
glob®
 
$ba£_u¾
;

28 
	`moduË_lßd_šşude
('inc', 'update', 'update.compare');

36 
	`_upd©e_ÿche_ş—r
('update_project_projects');

37 
	`_upd©e_ÿche_ş—r
('update_project_data');

39 
$avaabË
 = 
	`¬¿y
();

40 
$d©a
 = 
	`¬¿y
();

41 
$s™e_key
 = 
	`md5
(
$ba£_u¾
 . 
	`dru·l_g‘_´iv©e_key
());

42 
$´ojeùs
 = 
	`upd©e_g‘_´ojeùs
();

47 
	`_upd©e_ÿche_ş—r
('update_available_releases');

48 
$max_ãtch_©‹m±s
 = 
	`v¬ŸbË_g‘
('upd©e_max_ãtch_©‹m±s', 
UPDATE_MAX_FETCH_ATTEMPTS
);

50 
	`fÜ—ch
 (
$´ojeùs
 
as
 
$key
 => 
$´ojeù
) {

51 
$u¾
 = 
	`_upd©e_bud_ãtch_u¾
(
$´ojeù
, 
$s™e_key
);

52 
$ãtch_u¾_ba£
 = 
	`_upd©e_g‘_ãtch_u¾_ba£
(
$´ojeù
);

53 ià(
	`em±y
(
$ç
[
$ãtch_u¾_ba£
]è|| 
	`couÁ
($ç[$ãtch_u¾_ba£]è< 
$max_ãtch_©‹m±s
) {

54 
$xml
 = 
	`dru·l_h‰p_»que¡
(
$u¾
);

55 ià(
	`is£t
(
$xml
->
d©a
)) {

56 
$d©a
[] = 
$xml
->
d©a
;

60 
$ç
[
$ãtch_u¾_ba£
][
$key
] = 1;

65 
$ç
[
$ãtch_u¾_ba£
][
$key
] = 1;

69 ià(
$d©a
) {

70 
$·r£r
 = 
Ãw
 
upd©e_xml_·r£r
;

71 
$avaabË
 = 
$·r£r
->
	`·r£
(
$d©a
);

73 ià(!
	`em±y
(
$avaabË
è&& 
	`is_¬¿y
($available)) {

75 
	`fÜ—ch
 (
$ç
 
as
 
$ãtch_u¾_ba£
 => 
$çu»s
) {

76 
	`fÜ—ch
 (
$çu»s
 
as
 
$key
 => 
$v®ue
) {

77 
$avaabË
[
$key
]['project_status'] = 'not-fetched';

80 
$äequ’cy
 = 
	`v¬ŸbË_g‘
('update_check_frequency', 1);

81 
	`_upd©e_ÿche_£t
('upd©e_avaabË_»Ëa£s', 
$avaabË
, 
	`time
(è+ (60 * 60 * 24 * 
$äequ’cy
));

82 
	`w©chdog
('upd©e', 'A‰em±edØãtch infÜm©iÚ‡bouˆ®ÈavaabË‚ew„–—£ ªd upd©es.', 
	`¬¿y
(), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('view'), 'admin/reports/updates'));

85 
	`w©chdog
('upd©e', 'UÇbËØãtch‡ny infÜm©iÚ‡bouˆavaabË‚ew„–—£ ªd upd©es.', 
	`¬¿y
(), 
WATCHDOG_ERROR
, 
	`l
(
	`t
('view'), 'admin/reports/updates'));

88 
	`v¬ŸbË_£t
('upd©e_Ï¡_check', 
	`time
());

89  
$avaabË
;

90 
	}
}

107 
funùiÚ
 
_upd©e_bud_ãtch_u¾
(
$´ojeù
, 
$s™e_key
 = '') {

108 
$Çme
 = 
$´ojeù
['name'];

109 
	g$u¾
 = 
_upd©e_g‘_ãtch_u¾_ba£
(
$´ojeù
);

110 
	g$u¾
 .ğ'/'. 
$Çme
 .'/'. 
DRUPAL_CORE_COMPATIBILITY
;

114 ià(!
em±y
(
$s™e_key
è&& (
¡½os
(
$´ojeù
['´ojeù_ty³'], 'di§bËd'è==ğ
FALSE
)) {

115 
$u¾
 .ğ(
¡½os
($u¾, '?'è==ğ
TRUE
) ? '&' : '?';

116 
	g$u¾
 .= 'site_key=';

117 
	g$u¾
 .ğ
¿wu¾’code
(
$s™e_key
);

118 ià(!
em±y
(
$´ojeù
['info']['version'])) {

119 
	g$u¾
 .= '&version=';

120 
	g$u¾
 .ğ
¿wu¾’code
(
$´ojeù
['info']['version']);

123  
	g$u¾
;

138 
funùiÚ
 
	$_upd©e_g‘_ãtch_u¾_ba£
(
$´ojeù
) {

139  
	`is£t
(
$´ojeù
['šfo']['´ojeù stu u¾']è? $´ojeù['šfo']['´ojeù stu u¾'] : 
	`v¬ŸbË_g‘
('upd©e_ãtch_u¾', 
UPDATE_DEFAULT_URL
);

140 
	}
}

151 
funùiÚ
 
	$_upd©e_üÚ_nÙify
() {

152 
šşude_Úû
 './includes/install.inc';

153 
$¡©us
 = 
	`upd©e_»quœem’ts
('runtime');

154 
$·¿ms
 = 
	`¬¿y
();

155 
$nÙify_®l
 = (
	`v¬ŸbË_g‘
('update_notification_threshold', 'all') == 'all');

156 
	`fÜ—ch
 (
	`¬¿y
('cÜe', 'cÚŒib'è
as
 
$»pÜt_ty³
) {

157 
$ty³
 = 'upd©e_'. 
$»pÜt_ty³
;

158 ià(
	`is£t
(
$¡©us
[
$ty³
]['severity'])

159 && (
$¡©us
[
$ty³
]['£v”™y'] =ğ
REQUIREMENT_ERROR
 || (
$nÙify_®l
 && $¡©us[$ty³]['»asÚ'] =ğ
UPDATE_NOT_CURRENT
))) {

160 
$·¿ms
[
$»pÜt_ty³
] = 
$¡©us
[
$ty³
]['reason'];

163 ià(!
	`em±y
(
$·¿ms
)) {

164 
$nÙify_li¡
 = 
	`v¬ŸbË_g‘
('update_notify_emails', '');

165 ià(!
	`em±y
(
$nÙify_li¡
)) {

166 
$deçuÉ_Ïnguage
 = 
	`Ïnguage_deçuÉ
();

167 
	`fÜ—ch
 (
$nÙify_li¡
 
as
 
$rg‘
) {

168 ià(
$rg‘_u£r
 = 
	`u£r_lßd
(
	`¬¿y
('ma' => 
$rg‘
))) {

169 
$rg‘_Ïnguage
 = 
	`u£r_´eã¼ed_Ïnguage
(
$rg‘_u£r
);

172 
$rg‘_Ïnguage
 = 
$deçuÉ_Ïnguage
;

174 
	`dru·l_ma
('upd©e', '¡©us_nÙify', 
$rg‘
, 
$rg‘_Ïnguage
, 
$·¿ms
);

178 
	}
}

184 şas 
	cupd©e_xml_·r£r
 {

185 
v¬
 
	m$´ojeùs
 = 
¬¿y
();

186 
v¬
 
	m$cu¼’t_´ojeù
;

187 
v¬
 
	m$cu¼’t_»Ëa£
;

188 
v¬
 
	m$cu¼’t_‹rm
;

189 
v¬
 
	m$cu¼’t_g
;

190 
v¬
 
	m$cu¼’t_objeù
;

195 
funùiÚ
 
	$·r£
(
$d©a
) {

196 
	`fÜ—ch
 (
$d©a
 
as
 
$d©um
) {

197 
$·r£r
 = 
	`xml_·r£r_ü—‹
();

198 
	`xml_£t_objeù
(
$·r£r
, 
$this
);

199 
	`xml_£t_–em’t_hªdËr
(
$·r£r
, 'start', 'end');

200 
	`xml_£t_ch¬aù”_d©a_hªdËr
(
$·r£r
, "data");

201 
	`xml_·r£
(
$·r£r
, 
$d©um
);

202 
	`xml_·r£r_ä“
(
$·r£r
);

204  
$this
->
´ojeùs
;

207 
funùiÚ
 
	$¡¬t
(
$·r£r
, 
$Çme
, 
$©Œ
) {

208 
$this
->
cu¼’t_g
 = 
$Çme
;

209 
$Çme
) {

211 
	`un£t
(
$this
->
cu¼’t_objeù
);

212 
$this
->
cu¼’t_´ojeù
 = 
	`¬¿y
();

213 
$this
->
cu¼’t_objeù
 = &$this->
cu¼’t_´ojeù
;

216 
	`un£t
(
$this
->
cu¼’t_objeù
);

217 
$this
->
cu¼’t_»Ëa£
 = 
	`¬¿y
();

218 
$this
->
cu¼’t_objeù
 = &$this->
cu¼’t_»Ëa£
;

221 
	`un£t
(
$this
->
cu¼’t_objeù
);

222 
$this
->
cu¼’t_‹rm
 = 
	`¬¿y
();

223 
$this
->
cu¼’t_objeù
 = &$this->
cu¼’t_‹rm
;

226 
	}
}

228 
funùiÚ
 
	$’d
(
$·r£r
, 
$Çme
) {

229 
$Çme
) {

231 
	`un£t
(
$this
->
cu¼’t_objeù
);

232 
$this
->
´ojeùs
[$this->
cu¼’t_´ojeù
['short_name']] = $this->current_project;

233 
$this
->
cu¼’t_´ojeù
 = 
	`¬¿y
();

236 
	`un£t
(
$this
->
cu¼’t_objeù
);

237 
$this
->
cu¼’t_´ojeù
['»Ëa£s'][$this->
cu¼’t_»Ëa£
['version']] = $this->current_release;

240 
$this
->
cu¼’t_objeù
 = &$this->
cu¼’t_´ojeù
;

243 
	`un£t
(
$this
->
cu¼’t_objeù
);

244 
$‹rm_Çme
 = 
$this
->
cu¼’t_‹rm
['name'];

245 ià(!
	`is£t
(
$this
->
cu¼’t_»Ëa£
['terms'])) {

246 
$this
->
cu¼’t_»Ëa£
['‹rms'] = 
	`¬¿y
();

248 ià(!
	`is£t
(
$this
->
cu¼’t_»Ëa£
['‹rms'][
$‹rm_Çme
])) {

249 
$this
->
cu¼’t_»Ëa£
['‹rms'][
$‹rm_Çme
] = 
	`¬¿y
();

251 
$this
->
cu¼’t_»Ëa£
['‹rms'][
$‹rm_Çme
][] = $this->
cu¼’t_‹rm
['value'];

254 
$this
->
cu¼’t_objeù
 = &$this->
cu¼’t_»Ëa£
;

257 
$this
->
cu¼’t_objeù
[
	`¡¹Şow”
($this->
cu¼’t_g
)] = 
	`Œim
($this->current_object[strtolower($this->current_tag)]);

258 
$this
->
cu¼’t_g
 = '';

260 
	}
}

262 
funùiÚ
 
	$d©a
(
$·r£r
, 
$d©a
) {

263 ià(
$this
->
cu¼’t_g
 && !
	`š_¬¿y
($this->cu¼’t_g, 
	`¬¿y
('PROJECT', 'RELEASE', 'RELEASES', 'TERM', 'TERMS'))) {

264 
$g
 = 
	`¡¹Şow”
(
$this
->
cu¼’t_g
);

265 ià(
	`is£t
(
$this
->
cu¼’t_objeù
[
$g
])) {

266 
$this
->
cu¼’t_objeù
[
$g
] .ğ
$d©a
;

269 
$this
->
cu¼’t_objeù
[
$g
] = 
$d©a
;

272 
	}
}

	@/srv/http/subs/notes/www/modules/update/update.module

1 <?
php


15 
defše
('UPDATE_DEFAULT_URL', 'http://updates.drupal.org/release-history');

22 
defše
('UPDATE_NOT_SECURE', 1);

27 
defše
('UPDATE_REVOKED', 2);

32 
defše
('UPDATE_NOT_SUPPORTED', 3);

37 
defše
('UPDATE_NOT_CURRENT', 4);

42 
defše
('UPDATE_CURRENT', 5);

47 
defše
('UPDATE_NOT_CHECKED', -1);

52 
defše
('UPDATE_UNKNOWN', -2);

57 
defše
('UPDATE_NOT_FETCHED', -3);

62 
defše
('UPDATE_MAX_FETCH_ATTEMPTS', 2);

67 
funùiÚ
 
	$upd©e_h–p
(
$·th
, 
$¬g
) {

68 
$·th
) {

70 
$ouut
 = '<p>'. 
	`t
('Here you can find information‡bout‡vailable updates for your installed modules‡ndhemes. Notehatƒach module orheme is…art of‡ "project", which may or may‚ot havehe same‚ame,‡nd might include multiple modules orhemes within it.') .'</p>';

71 
$ouut
 .ğ'<p>'. 
	`t
('TØex‹ndhfunùiÚ®™y o¸tØchªgthlook oàyou¸s™e,‡‚umb” oàcÚŒibu‹d <¨h»f="@moduËs">moduËs</a>‡nd <¨h»f="@themes">themes</a>‡»‡vaabË.', 
	`¬¿y
('@modules' => 'http://drupal.org/project/modules', '@themes' => 'http://drupal.org/project/themes')) .'</p>';

72  
$ouut
;

75 
šşude_Úû
 './includes/install.inc';

76 
$¡©us
 = 
	`upd©e_»quœem’ts
('runtime');

77 
	`fÜ—ch
 (
	`¬¿y
('cÜe', 'cÚŒib'è
as
 
$»pÜt_ty³
) {

78 
$ty³
 = 'upd©e_'. 
$»pÜt_ty³
;

79 ià(
	`is£t
(
$¡©us
[
$ty³
]['severity'])) {

80 ià(
$¡©us
[
$ty³
]['£v”™y'] =ğ
REQUIREMENT_ERROR
) {

81 
	`dru·l_£t_mes§ge
(
$¡©us
[
$ty³
]['description'], 'error');

83 
	`–£if
 (
$¡©us
[
$ty³
]['£v”™y'] =ğ
REQUIREMENT_WARNING
) {

84 
	`dru·l_£t_mes§ge
(
$¡©us
[
$ty³
]['description'], 'warning');

88  '<p>'. 
	`t
('S“h<¨h»f="@avaabË_upd©es">avaabË upd©es</a>…agfÜ infÜm©iÚ oÀš¡®Ëd moduË ªdheme w™h‚ew v”siÚ »Ëa£d.', 
	`¬¿y
('@avaabË_upd©es' => 
	`u¾
('admin/reports/updates'))) .'</p>';

96 
$ouut
 = '<p>'. 
	`t
("The Update status module…eriodically checks for‚ew versions of your site's software (including contributed modules‡ndhemes),‡nd‡lerts youo‡vailable updates.") .'</p>';

97 
$ouut
 .ğ'<p>'. 
	`t
('Th<¨h»f="@upd©e-»pÜt">»pÜˆoàavaabË upd©es</a> wÈ®”ˆyou wh’‚ew„–—£ ¬avaabË fÜ dowÆßd. You may cÚfigu» o±iÚ fÜ upd©checkšg f»qu’cy‡nd‚ÙifiÿtiÚ ©h<¨h»f="@upd©e-£‰šgs">Upd©¡©u moduË s‘tšg ·ge</a>.', 
	`¬¿y
('@upd©e-»pÜt' => 
	`u¾
('admin/reports/updates'), '@update-settings' => url('admin/reports/updates/settings'))) .'</p>';

98 
$ouut
 .ğ'<p>'. 
	`t
('PËa£‚Ùth© iÀÜd”Ø´ovidthi šfÜm©iÚ,‡nÚymou u§g¡©i¡ic ¬£ÁØdru·l.Üg. Iàdesœed, you may di§bËhUpd©¡©u moduË fromh<¨h»f="@moduËs">moduË‡dmši¡¿tiÚ…age</a>.', 
	`¬¿y
('@moduËs' => 
	`u¾
('admin/build/modules'))) .'</p>';

99 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@upd©e">Upd©¡©u moduË</a>.', 
	`¬¿y
('@update' => 'http://drupal.org/handbook/modules/update')) .'</p>';

100  
$ouut
;

105 ià(
	`¬g
(0è=ğ'admš' && 
	`¡½os
(
$·th
, '#'è==ğ
FALSE


106 && 
	`u£r_acûss
('administer site configuration')) {

107 
šşude_Úû
 './includes/install.inc';

108 
$¡©us
 = 
	`upd©e_»quœem’ts
('runtime');

109 
	`fÜ—ch
 (
	`¬¿y
('cÜe', 'cÚŒib'è
as
 
$»pÜt_ty³
) {

110 
$ty³
 = 'upd©e_'. 
$»pÜt_ty³
;

111 ià(
	`is£t
(
$¡©us
[
$ty³
])

112 && 
	`is£t
(
$¡©us
[
$ty³
]['reason'])

113 && 
$¡©us
[
$ty³
]['»asÚ'] ==ğ
UPDATE_NOT_SECURE
) {

114 
	`dru·l_£t_mes§ge
(
$¡©us
[
$ty³
]['description'], 'error');

120 
	}
}

125 
funùiÚ
 
	$upd©e_m’u
() {

126 
$™ems
 = 
	`¬¿y
();

128 
$™ems
['admš/»pÜts/upd©es'] = 
	`¬¿y
(

132 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

136 
$™ems
['admš/»pÜts/upd©es/li¡'] = 
	`¬¿y
(

139 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

141 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

143 
$™ems
['admš/»pÜts/upd©es/£‰šgs'] = 
	`¬¿y
(

146 '·g¬gum’ts' => 
	`¬¿y
('update_settings'),

147 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

149 'ty³' => 
MENU_LOCAL_TASK
,

151 
$™ems
['admš/»pÜts/upd©es/check'] = 
	`¬¿y
(

154 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

156 'ty³' => 
MENU_CALLBACK
,

159  
$™ems
;

160 
	}
}

165 
funùiÚ
 
	$upd©e_theme
() {

166  
	`¬¿y
(

167 'upd©e_£‰šgs' => 
	`¬¿y
(

168 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

170 'upd©e_»pÜt' => 
	`¬¿y
(

171 '¬gum’ts' => 
	`¬¿y
('d©a' => 
NULL
),

173 'upd©e_v”siÚ' => 
	`¬¿y
(

174 '¬gum’ts' => 
	`¬¿y
('v”siÚ' => 
NULL
, 'tag' => NULL, 'class' => NULL),

177 
	}
}

200 
funùiÚ
 
	$upd©e_»quœem’ts
(
$pha£
) {

201 ià(
$pha£
 == 'runtime') {

202 ià(
$avaabË
 = 
	`upd©e_g‘_avaabË
(
FALSE
)) {

203 
	`moduË_lßd_šşude
('inc', 'update', 'update.compare');

204 
$d©a
 = 
	`upd©e_ÿlcuÏ‹_´ojeù_d©a
(
$avaabË
);

206 
$»quœem’ts
['upd©e_cÜe'] = 
	`_upd©e_»quœem’t_check
(
$d©a
['drupal'], 'core');

208 
	`un£t
(
$d©a
['drupal']);

209 ià(!
	`em±y
(
$d©a
)) {

214 
	`uasÜt
(
$d©a
, '_update_project_status_sort');

215 
$fœ¡_´ojeù
 = 
	`»£t
(
$d©a
);

216 
$»quœem’ts
['upd©e_cÚŒib'] = 
	`_upd©e_»quœem’t_check
(
$fœ¡_´ojeù
, 'contrib');

220 
$»quœem’ts
['upd©e_cÜe']['t™Ë'] = 
	`t
('Drupal core update status');

221 
$»quœem’ts
['upd©e_cÜe']['v®ue'] = 
	`t
('No update data‡vailable');

222 
$»quœem’ts
['upd©e_cÜe']['£v”™y'] = 
REQUIREMENT_WARNING
;

223 
$»quœem’ts
['upd©e_cÜe']['»asÚ'] = 
UPDATE_UNKNOWN
;

224 
$»quœem’ts
['upd©e_cÜe']['desütiÚ'] = 
	`_upd©e_no_d©a
();

226  
$»quœem’ts
;

228 
	}
}

249 
funùiÚ
 
	$_upd©e_»quœem’t_check
(
$´ojeù
, 
$ty³
) {

250 
$»quœem’t
 = 
	`¬¿y
();

251 ià(
$ty³
 == 'core') {

252 
$»quœem’t
['t™Ë'] = 
	`t
('Drupal core update status');

255 
$»quœem’t
['t™Ë'] = 
	`t
('Module‡ndheme update status');

257 
$¡©us
 = 
$´ojeù
['status'];

258 ià(
$¡©us
 !ğ
UPDATE_CURRENT
) {

259 
$»quœem’t
['»asÚ'] = 
$¡©us
;

260 
$»quœem’t
['desütiÚ'] = 
	`_upd©e_mes§ge_‹xt
(
$ty³
, 
$¡©us
, 
TRUE
);

261 
$»quœem’t
['£v”™y'] = 
REQUIREMENT_ERROR
;

263 
$¡©us
) {

264 
UPDATE_NOT_SECURE
:

265 
$»quœem’t_Ïb–
 = 
	`t
('Not secure!');

267 
UPDATE_REVOKED
:

268 
$»quœem’t_Ïb–
 = 
	`t
('Revoked!');

270 
UPDATE_NOT_SUPPORTED
:

271 
$»quœem’t_Ïb–
 = 
	`t
('Unsupported„elease');

273 
UPDATE_NOT_CURRENT
:

274 
$»quœem’t_Ïb–
 = 
	`t
('Out of date');

275 
$»quœem’t
['£v”™y'] = 
REQUIREMENT_WARNING
;

277 
UPDATE_UNKNOWN
:

278 
UPDATE_NOT_CHECKED
:

279 
UPDATE_NOT_FETCHED
:

280 
$»quœem’t_Ïb–
 = 
	`is£t
(
$´ojeù
['»asÚ']è? $´ojeù['»asÚ'] : 
	`t
('Can‚ot determine status');

281 
$»quœem’t
['£v”™y'] = 
REQUIREMENT_WARNING
;

284 
$»quœem’t_Ïb–
 = 
	`t
('Upo date');

286 ià(
$¡©us
 !ğ
UPDATE_CURRENT
 && 
$ty³
 =ğ'cÜe' && 
	`is£t
(
$´ojeù
['recommended'])) {

287 
$»quœem’t_Ïb–
 .ğ' '. 
	`t
('(v”siÚ @v”siÚ‡vaabË)', 
	`¬¿y
('@v”siÚ' => 
$´ojeù
['recommended']));

289 
$»quœem’t
['v®ue'] = 
	`l
(
$»quœem’t_Ïb–
, 'admin/reports/updates');

290  
$»quœem’t
;

291 
	}
}

296 
funùiÚ
 
	$upd©e_üÚ
() {

297 
$äequ’cy
 = 
	`v¬ŸbË_g‘
('update_check_frequency', 1);

298 
$š‹rv®
 = 60 * 60 * 24 * 
$äequ’cy
;

301 ià(!
	`_upd©e_ÿche_g‘
('upd©e_avaabË_»Ëa£s'è|| ((
	`time
(è- 
	`v¬ŸbË_g‘
('upd©e_Ï¡_check', 0)è> 
$š‹rv®
)) {

302 
	`upd©e_»äesh
();

303 
	`_upd©e_üÚ_nÙify
();

305 
	}
}

315 
funùiÚ
 
	$upd©e_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

316 ià(
$fÜm_id
 == 'system_modules' || $form_id == 'system_themes_form' ) {

317 
$fÜm
['#submit'][] = 'update_invalidate_cache';

319 
	}
}

324 
funùiÚ
 
	$_upd©e_no_d©a
() {

325 
$de¡š©iÚ
 = 
	`dru·l_g‘_de¡š©iÚ
();

326  
	`t
('NØšfÜm©iÚ i avaabË‡bouˆpÙ’tŸÈÃw„–—£ fÜ cu¼’y in¡®Ëd moduË ªdhemes. TØcheck fÜ upd©es, you may‚“dØ<¨h»f="@run_üÚ">ruÀüÚ</a> o¸you cª <¨h»f="@check_mªu®ly">check mªu®ly</a>. PËa£‚Ùth© checkšg fÜ‡vaabË upd©e ÿÀk¨lÚgime, sØ¶—£ b·t›Á.', 
	`¬¿y
(

327 '@run_üÚ' => 
	`u¾
('admš/»pÜts/¡©us/run-üÚ', 
	`¬¿y
('qu”y' => 
$de¡š©iÚ
)),

328 '@check_mªu®ly' => 
	`u¾
('admš/»pÜts/upd©es/check', 
	`¬¿y
('qu”y' => 
$de¡š©iÚ
)),

330 
	}
}

351 
funùiÚ
 
	$upd©e_g‘_avaabË
(
$»äesh
 = 
FALSE
) {

352 
	`moduË_lßd_šşude
('inc', 'update', 'update.compare');

353 
$avaabË
 = 
	`¬¿y
();

357 
$Ãeds_»äesh
 = 
FALSE
;

358 
$Ï¡_check
 = 
	`v¬ŸbË_g‘
('update_last_check', 0);

359 
$´ojeùs
 = 
	`upd©e_g‘_´ojeùs
();

360 
	`fÜ—ch
 (
$´ojeùs
 
as
 
$key
 => 
$´ojeù
) {

361 ià(
$´ojeù
['šfo']['_šfo_fe_ùime'] > 
$Ï¡_check
) {

362 
$Ãeds_»äesh
 = 
TRUE
;

366 ià(!
$Ãeds_»äesh
 && (
$ÿche
 = 
	`_upd©e_ÿche_g‘
('upd©e_avaabË_»Ëa£s')è&& $ÿche->
expœe
 > 
	`time
()) {

367 
$avaabË
 = 
$ÿche
->
d©a
;

369 
	`–£if
 (
$Ãeds_»äesh
 || 
$»äesh
) {

373 
$avaabË
 = 
	`upd©e_»äesh
();

375  
$avaabË
;

376 
	}
}

381 
funùiÚ
 
	$upd©e_»äesh
() {

382 
	`moduË_lßd_šşude
('inc', 'update', 'update.fetch');

383  
	`_upd©e_»äesh
();

384 
	}
}

405 
funùiÚ
 
	$upd©e_ma
(
$key
, &
$mes§ge
, 
$·¿ms
) {

406 
$Ïnguage
 = 
$mes§ge
['language'];

407 
$Ïngcode
 = 
$Ïnguage
->
Ïnguage
;

408 
$mes§ge
['subjeù'] .ğ
	`t
('New„–—£(sèavaabË fÜ !s™e_Çme', 
	`¬¿y
('!s™e_Çme' => 
	`v¬ŸbË_g‘
('s™e_Çme', 'Dru·l')), 
$Ïngcode
);

409 
	`fÜ—ch
 (
$·¿ms
 
as
 
$msg_ty³
 => 
$msg_»asÚ
) {

410 
$mes§ge
['body'][] = 
	`_upd©e_mes§ge_‹xt
(
$msg_ty³
, 
$msg_»asÚ
, 
FALSE
, 
$Ïnguage
);

412 
$mes§ge
['body'][] = 
	`t
('S“havaabË upd©e ·gfÜ mÜšfÜm©iÚ:', 
	`¬¿y
(), 
$Ïngcode
è."\n". 
	`u¾
('admš/»pÜts/upd©es',‡¼ay('absŞu‹' => 
TRUE
, 'Ïnguage' => 
$Ïnguage
));

413 
	}
}

435 
funùiÚ
 
	$_upd©e_mes§ge_‹xt
(
$msg_ty³
, 
$msg_»asÚ
, 
$»pÜt_lšk
 = 
FALSE
, 
$Ïnguage
 = 
NULL
) {

436 
$Ïngcode
 = 
	`is£t
(
$Ïnguage
è? $Ïnguage->
Ïnguage
 : 
NULL
;

437 
$‹xt
 = '';

438 
$msg_»asÚ
) {

439 
UPDATE_NOT_SECURE
:

440 ià(
$msg_ty³
 == 'core') {

441 
$‹xt
 = 
	`t
('Th”i ¨£cur™y upd©avaabË fÜ you¸v”siÚ oàDru·l. TØ’su»h£cur™y oàyou¸£rv”, you should upd©immedŸ‹ly!', 
	`¬¿y
(), 
$Ïngcode
);

444 
$‹xt
 = 
	`t
('Th”¬£cur™y upd©e avaabË fÜ oÃ o¸mÜoàyou¸moduË Ühemes. TØ’su»h£cur™y oàyou¸£rv”, you should upd©immedŸ‹ly!', 
	`¬¿y
(), 
$Ïngcode
);

448 
UPDATE_REVOKED
:

449 ià(
$msg_ty³
 == 'core') {

450 
$‹xt
 = 
	`t
('You¸v”siÚ oàDru·Èha b“À»voked‡nd i nØlÚg”‡vaabË fÜ dowÆßd. Upg¿dšg i ¡rÚgly„ecomm’ded!', 
	`¬¿y
(), 
$Ïngcode
);

453 
$‹xt
 = 
	`t
('Thš¡®Ëd v”siÚ oà©†—¡ oÃ oàyou¸moduË Üheme ha b“À»voked‡nd i nØlÚg”‡vaabË fÜ dowÆßd. Upg¿dšg o¸di§blšg i ¡rÚgly„ecomm’ded!', 
	`¬¿y
(), 
$Ïngcode
);

457 
UPDATE_NOT_SUPPORTED
:

458 ià(
$msg_ty³
 == 'core') {

459 
$‹xt
 = 
	`t
('You¸v”siÚ oàDru·Èi nØlÚg” suµÜ‹d. Upg¿dšg i ¡rÚgly„ecomm’ded!', 
	`¬¿y
(), 
$Ïngcode
);

462 
$‹xt
 = 
	`t
('Thš¡®Ëd v”siÚ oà©†—¡ oÃ oàyou¸moduË Üheme i nØlÚg” suµÜ‹d. Upg¿dšg o¸di§blšg i ¡rÚgly„ecomm’ded! PËa£ s“h´ojeù hom•agfÜ mÜd‘as.', 
	`¬¿y
(), 
$Ïngcode
);

466 
UPDATE_NOT_CURRENT
:

467 ià(
$msg_ty³
 == 'core') {

468 
$‹xt
 = 
	`t
('Th”¬upd©e avaabË fÜ you¸v”siÚ oàDru·l. TØ’su»h´İ” funùiÚšg oàyou¸s™e, you should upd©a soÚ‡ possibË.', 
	`¬¿y
(), 
$Ïngcode
);

471 
$‹xt
 = 
	`t
('Th”¬upd©e avaabË fÜ oÃ o¸mÜoàyou¸moduË Ühemes. TØ’su»h´İ” funùiÚšg oàyou¸s™e, you should upd©a soÚ‡ possibË.', 
	`¬¿y
(), 
$Ïngcode
);

475 
UPDATE_UNKNOWN
:

476 
UPDATE_NOT_CHECKED
:

477 
UPDATE_NOT_FETCHED
:

478 ià(
$msg_ty³
 == 'core') {

479 
$‹xt
 = 
	`t
('Th”wa ¨´obËm d‘”mššgh¡©u oàavaabË upd©e fÜ you¸v”siÚ oàDru·l.', 
	`¬¿y
(), 
$Ïngcode
);

482 
$‹xt
 = 
	`t
('Th”wa ¨´obËm d‘”mššgh¡©u oàavaabË upd©e fÜ oÃ o¸mÜoàyou¸moduË Ühemes.', 
	`¬¿y
(), 
$Ïngcode
);

487 ià(
$»pÜt_lšk
) {

488 
$‹xt
 .ğ' '. 
	`t
('S“h<¨h»f="@avaabË_upd©es">avaabË upd©es</a>…agfÜ mÜšfÜm©iÚ.', 
	`¬¿y
('@avaabË_upd©es' => 
	`u¾
('admš/»pÜts/upd©es',‡¼ay('Ïnguage' => 
$Ïnguage
))), 
$Ïngcode
);

491  
$‹xt
;

492 
	}
}

500 
funùiÚ
 
	$_upd©e_´ojeù_¡©us_sÜt
(
$a
, 
$b
) {

505 
$a_¡©us
 = 
$a
['status'] > 0 ? $a['status'] : (-10 * $a['status']);

506 
$b_¡©us
 = 
$b
['status'] > 0 ? $b['status'] : (-10 * $b['status']);

507  
$a_¡©us
 - 
$b_¡©us
;

508 
	}
}

547 
funùiÚ
 
	$_upd©e_ÿche_£t
(
$cid
, 
$d©a
, 
$expœe
) {

548 
$£rŸlized
 = 0;

549 ià(
	`is_objeù
(
$d©a
è|| 
	`is_¬¿y
($data)) {

550 
$d©a
 = 
	`£rŸlize
($data);

551 
$£rŸlized
 = 1;

553 
$ü—‹d
 = 
	`time
();

554 
	`db_qu”y
("UPDATE {ÿche_upd©e} SET d©¨ğ%b, c»©ed = %d,ƒxpœğ%d, s”Ÿlized = %d WHERE cid = '%s'", 
$d©a
, 
$ü—‹d
, 
$expœe
, 
$£rŸlized
, 
$cid
);

555 ià(!
	`db_afãùed_rows
()) {

556 @
	`db_qu”y
("INSERT INTO {ÿche_upd©e} (cid, d©a, c»©ed,ƒxpœe, s”ŸlizedèVALUES ('%s', %b, %d, %d, %d)", 
$cid
, 
$d©a
, 
$ü—‹d
, 
$expœe
, 
$£rŸlized
);

558 
	}
}

568 
funùiÚ
 
	$_upd©e_ÿche_g‘
(
$cid
) {

569 
$ÿche
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT d©a, c»©ed,ƒxpœe, s”Ÿlized FROM {ÿche_upd©e} WHERE cid = '%s'", 
$cid
));

570 ià(
	`is£t
(
$ÿche
->
d©a
)) {

571 
$ÿche
->
d©a
 = 
	`db_decode_blob
($cache->data);

572 ià(
$ÿche
->
£rŸlized
) {

573 
$ÿche
->
d©a
 = 
	`un£rŸlize
($cache->data);

576  
$ÿche
;

577 
	}
}

586 
funùiÚ
 
	$_upd©e_ÿche_ş—r
(
$cid
 = 
NULL
) {

587 ià(
	`em±y
(
$cid
)) {

588 
	`db_qu”y
("TRUNCATE TABLE {cache_update}");

591 
	`db_qu”y
("DELETE FROM {ÿche_upd©e} WHERE cid = '%s'", 
$cid
);

593 
	}
}

611 
funùiÚ
 
	$upd©e_æush_ÿches
() {

612 ià(
	`defšed
('MAINTENANCE_MODE'è&& 
MAINTENANCE_MODE
 == 'update') {

613 
	`_upd©e_ÿche_ş—r
();

615  
	`¬¿y
();

616 
	}
}

621 
funùiÚ
 
	$upd©e_šv®id©e_ÿche
() {

622 
	`_upd©e_ÿche_ş—r
();

623 
	}
}

	@/srv/http/subs/notes/www/modules/update/update.report.inc

1 <?
php


12 
funùiÚ
 
	$upd©e_¡©us
() {

13 ià(
$avaabË
 = 
	`upd©e_g‘_avaabË
(
TRUE
)) {

14 
	`moduË_lßd_šşude
('inc', 'update', 'update.compare');

15 
$d©a
 = 
	`upd©e_ÿlcuÏ‹_´ojeù_d©a
(
$avaabË
);

16  
	`theme
('upd©e_»pÜt', 
$d©a
);

19  
	`theme
('upd©e_»pÜt', 
	`_upd©e_no_d©a
());

21 
	}
}

28 
funùiÚ
 
	$theme_upd©e_»pÜt
(
$d©a
) {

29 
$Ï¡
 = 
	`v¬ŸbË_g‘
('update_last_check', 0);

30 
$ouut
 = '<div cÏss="upd©checked">'. (
$Ï¡
 ? 
	`t
('La¡ checked: @timago', 
	`¬¿y
('@time' => 
	`fÜm©_š‹rv®
(
	`time
() - $last))) :('Last checked:‚ever'));

31 
$ouut
 .ğ' <¥ª cÏss="check-mªu®ly">('. 
	`l
(
	`t
('Check manually'), 'admin/reports/updates/check') .')</span>';

32 
$ouut
 .= "</div>\n";

34 ià(!
	`is_¬¿y
(
$d©a
)) {

35 
$ouut
 .ğ'<p>'. 
$d©a
 .'</p>';

36  
$ouut
;

39 
$h—d”
 = 
	`¬¿y
();

40 
$rows
 = 
	`¬¿y
();

42 
$nÙifiÿtiÚ_Ëv–
 = 
	`v¬ŸbË_g‘
('update_notification_threshold', 'all');

44 
	`fÜ—ch
 (
$d©a
 
as
 
$´ojeù
) {

45 
$´ojeù
['status']) {

46 
UPDATE_CURRENT
:

47 
$şass
 = 'ok';

48 
$icÚ
 = 
	`theme
('image', 'misc/w©chdog-ok.²g', 
	`t
('ok'),('ok'));

50 
UPDATE_UNKNOWN
:

51 
UPDATE_NOT_FETCHED
:

52 
$şass
 = 'unknown';

53 
$icÚ
 = 
	`theme
('image', 'misc/w©chdog-w¬nšg.²g', 
	`t
('warning'),('warning'));

55 
UPDATE_NOT_SECURE
:

56 
UPDATE_REVOKED
:

57 
UPDATE_NOT_SUPPORTED
:

58 
$şass
 = 'error';

59 
$icÚ
 = 
	`theme
('image', 'misc/w©chdog-”rÜ.²g', 
	`t
('error'),('error'));

61 
UPDATE_NOT_CHECKED
:

62 
UPDATE_NOT_CURRENT
:

64 
$şass
 = 'warning';

65 
$icÚ
 = 
	`theme
('image', 'misc/w©chdog-w¬nšg.²g', 
	`t
('warning'),('warning'));

69 
$row
 = '<div class="version-status">';

70 
$´ojeù
['status']) {

71 
UPDATE_NOT_SECURE
:

72 
$row
 .ğ'<¥ª cÏss="£cur™y-”rÜ">'. 
	`t
('Security update„equired!') .'</span>';

74 
UPDATE_REVOKED
:

75 
$row
 .ğ'<¥ª cÏss="»voked">'. 
	`t
('Revoked!') .'</span>';

77 
UPDATE_NOT_SUPPORTED
:

78 
$row
 .ğ'<¥ª cÏss="nÙ-suµÜ‹d">'. 
	`t
('Not supported!') .'</span>';

80 
UPDATE_NOT_CURRENT
:

81 
$row
 .ğ'<¥ª cÏss="nÙ-cu¼’t">'. 
	`t
('Update‡vailable') .'</span>';

83 
UPDATE_CURRENT
:

84 
$row
 .ğ'<¥ª cÏss="cu¼’t">'. 
	`t
('Upo date') .'</span>';

87 
$row
 .ğ
	`check_¶aš
(
$´ojeù
['reason']);

90 
$row
 .ğ'<¥ª cÏss="icÚ">'. 
$icÚ
 .'</span>';

91 
$row
 .= "</div>\n";

93 
$row
 .= '<div class="project">';

94 ià(
	`is£t
(
$´ojeù
['title'])) {

95 ià(
	`is£t
(
$´ojeù
['link'])) {

96 
$row
 .ğ
	`l
(
$´ojeù
['title'], $project['link']);

99 
$row
 .ğ
	`check_¶aš
(
$´ojeù
['title']);

103 
$row
 .ğ
	`check_¶aš
(
$´ojeù
['name']);

105 
$row
 .ğ' '. 
	`check_¶aš
(
$´ojeù
['existing_version']);

106 ià(
$´ojeù
['š¡®l_ty³'] =ğ'dev' && !
	`em±y
($project['datestamp'])) {

107 
$row
 .ğ' <¥ª cÏss="v”siÚ-d©e">('. 
	`fÜm©_d©e
(
$´ojeù
['datestamp'], 'custom', 'Y-M-d') .')</span>';

109 
$row
 .= "</div>\n";

111 
$row
 .= "<div class=\"versions\">\n";

113 ià(
	`is£t
(
$´ojeù
['recommended'])) {

114 ià(
$´ojeù
['¡©us'] !ğ
UPDATE_CURRENT
 || $project['existing_version'] !== $project['recommended']) {

120 ià(!
	`em±y
(
$´ojeù
['£cur™y upd©es']è&& 
	`couÁ
($project['security updates']) == 1 && $project['security updates'][0]['version'] === $project['recommended']) {

121 
$£cur™y_şass
 = ' version-recommended version-recommended-strong';

124 
$£cur™y_şass
 = '';

125 
$v”siÚ_şass
 = 'version-recommended';

128 ià(
$´ojeù
['recommended'] !== $project['latest_version']

129 || !
	`em±y
(
$´ojeù
['also'])

130 || (
$´ojeù
['install_type'] == 'dev'

131 && 
	`is£t
(
$´ojeù
['dev_version'])

132 && 
$´ojeù
['latest_version'] !== $project['dev_version']

133 && 
$´ojeù
['recommended'] !== $project['dev_version'])

134 || (
	`is£t
(
$´ojeù
['security updates'][0])

135 && 
$´ojeù
['recommended'] !== $project['security updates'][0])

137 
$v”siÚ_şass
 .= ' version-recommended-strong';

139 
$row
 .ğ
	`theme
('upd©e_v”siÚ', 
$´ojeù
['»Ëa£s'][$´ojeù['»comm’ded']], 
	`t
('Recomm’ded v”siÚ:'), 
$v”siÚ_şass
);

143 ià(!
	`em±y
(
$´ojeù
['security updates'])) {

144 
	`fÜ—ch
 (
$´ojeù
['£cur™y upd©es'] 
as
 
$£cur™y_upd©e
) {

145 
$row
 .ğ
	`theme
('upd©e_v”siÚ', 
$£cur™y_upd©e
, 
	`t
('Secur™y upd©e:'), 'v”siÚ-£cur™y'. 
$£cur™y_şass
);

150 ià(
$´ojeù
['recommended'] !== $project['latest_version']) {

151 
$row
 .ğ
	`theme
('upd©e_v”siÚ', 
$´ojeù
['»Ëa£s'][$´ojeù['Ï‹¡_v”siÚ']], 
	`t
('Latest version:'), 'version-latest');

153 ià(
$´ojeù
['install_type'] == 'dev'

154 && 
$´ojeù
['¡©us'] !ğ
UPDATE_CURRENT


155 && 
	`is£t
(
$´ojeù
['dev_version'])

156 && 
$´ojeù
['recommended'] !== $project['dev_version']) {

157 
$row
 .ğ
	`theme
('upd©e_v”siÚ', 
$´ojeù
['»Ëa£s'][$´ojeù['dev_v”siÚ']], 
	`t
('Development version:'), 'version-latest');

161 ià(
	`is£t
(
$´ojeù
['also'])) {

162 
	`fÜ—ch
 (
$´ojeù
['®so'] 
as
 
$®so
) {

163 
$row
 .ğ
	`theme
('upd©e_v”siÚ', 
$´ojeù
['»Ëa£s'][
$®so
], 
	`t
('Also‡vailable:'), 'version-also-available');

167 
$row
 .= "</div>\n";

169 
$row
 .= "<div class=\"info\">\n";

170 ià(!
	`em±y
(
$´ojeù
['extra'])) {

171 
$row
 .= '<div class="extra">'."\n";

172 
	`fÜ—ch
 (
$´ojeù
['exŒa'] 
as
 
$key
 => 
$v®ue
) {

173 
$row
 .ğ'<div cÏss="'. 
$v®ue
['class'] .'">';

174 
$row
 .ğ
	`check_¶aš
(
$v®ue
['label']) .': ';

175 
$row
 .ğ
	`theme
('¶aûhŞd”', 
$v®ue
['data']);

176 
$row
 .= "</div>\n";

178 
$row
 .= "</div>\n";

181 
$row
 .= '<div class="includes">';

182 
	`sÜt
(
$´ojeù
['includes']);

183 
$row
 .ğ
	`t
('Inşudes: %šşudes', 
	`¬¿y
('%šşudes' => 
	`im¶ode
(', ', 
$´ojeù
['includes'])));

184 
$row
 .= "</div>\n";

186 ià(!
	`em±y
(
$´ojeù
['base_themes'])) {

187 
$row
 .= '<div class="basethemes">';

188 
	`sÜt
(
$´ojeù
['base_themes']);

192 
$row
 .ğ
	`t
('D•’d Ú: !d•’d’c›s', 
	`¬¿y
('!d•’d’c›s' => 
	`theme
('¶aûhŞd”', 
	`im¶ode
(', ', 
$´ojeù
['base_themes']))));

193 
$row
 .= "</div>\n";

196 ià(!
	`em±y
(
$´ojeù
['sub_themes'])) {

197 
$row
 .= '<div class="subthemes">';

198 
	`sÜt
(
$´ojeù
['sub_themes']);

202 
$row
 .ğ
	`t
('Requœed by: !»quœed', 
	`¬¿y
('!»quœed' => 
	`theme
('¶aûhŞd”', 
	`im¶ode
(', ', 
$´ojeù
['sub_themes']))));

203 
$row
 .= "</div>\n";

206 
$row
 .= "</div>\n";

208 ià(!
	`is£t
(
$rows
[
$´ojeù
['project_type']])) {

209 
$rows
[
$´ojeù
['´ojeù_ty³']] = 
	`¬¿y
();

211 
$row_key
 = 
	`is£t
(
$´ojeù
['t™Ë']è? 
	`dru·l_¡¹Şow”
($project['title']) : drupal_strtolower($project['name']);

212 
$rows
[
$´ojeù
['´ojeù_ty³']][
$row_key
] = 
	`¬¿y
(

213 'şass' => 
$şass
,

214 'd©a' => 
	`¬¿y
(
$row
),

218 
$´ojeù_ty³s
 = 
	`¬¿y
(

219 'cÜe' => 
	`t
('Drupal core'),

220 'moduË' => 
	`t
('Modules'),

221 'theme' => 
	`t
('Themes'),

222 'di§bËd-moduË' => 
	`t
('Disabled modules'),

223 'di§bËd-theme' => 
	`t
('Disabledhemes'),

225 
	`fÜ—ch
 (
$´ojeù_ty³s
 
as
 
$ty³_Çme
 => 
$ty³_Ïb–
) {

226 ià(!
	`em±y
(
$rows
[
$ty³_Çme
])) {

227 
	`ksÜt
(
$rows
[
$ty³_Çme
]);

228 
$ouut
 .ğ"\n<h3>". 
$ty³_Ïb–
 ."</h3>\n";

229 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
[
$ty³_Çme
], 
	`¬¿y
('class' => 'update'));

232 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'update') .'/update.css');

233  
$ouut
;

234 
	}
}

241 
funùiÚ
 
	$theme_upd©e_v”siÚ
(
$v”siÚ
, 
$g
, 
$şass
) {

242 
$ouut
 = '';

243 
$ouut
 .ğ'<bË cÏss="v”siÚ '. 
$şass
 .'">';

244 
$ouut
 .= '<tr>';

245 
$ouut
 .ğ'<td cÏss="v”siÚ-t™Ë">'. 
$g
 ."</td>\n";

246 
$ouut
 .= '<td class="version-details">';

247 
$ouut
 .ğ
	`l
(
$v”siÚ
['version'], $version['release_link']);

248 
$ouut
 .ğ' <¥ª cÏss="v”siÚ-d©e">('. 
	`fÜm©_d©e
(
$v”siÚ
['date'], 'custom', 'Y-M-d') .')</span>';

249 
$ouut
 .= "</td>\n";

250 
$ouut
 .= '<td class="version-links">';

251 
$lšks
 = 
	`¬¿y
();

252 
$lšks
['upd©e-dowÆßd'] = 
	`¬¿y
(

253 't™Ë' => 
	`t
('Download'),

254 'h»f' => 
$v”siÚ
['download_link'],

256 
$lšks
['upd©e-»Ëa£-nÙes'] = 
	`¬¿y
(

257 't™Ë' => 
	`t
('Release‚otes'),

258 'h»f' => 
$v”siÚ
['release_link'],

260 
$ouut
 .ğ
	`theme
('lšks', 
$lšks
);

261 
$ouut
 .= '</td>';

262 
$ouut
 .= '</tr>';

263 
$ouut
 .= "</table>\n";

264  
$ouut
;

265 
	}
}

	@/srv/http/subs/notes/www/modules/update/update.settings.inc

1 <?
php


12 
funùiÚ
 
	$upd©e_£‰šgs
() {

13 
$fÜm
 = 
	`¬¿y
();

15 
$nÙify_emas
 = 
	`v¬ŸbË_g‘
('upd©e_nÙify_emas', 
	`¬¿y
());

16 
$fÜm
['upd©e_nÙify_emas'] = 
	`¬¿y
(

18 '#t™Ë' => 
	`t
('E-mail‡ddresseso‚otify when updates‡re‡vailable'),

20 '#deçuÉ_v®ue' => 
	`im¶ode
("\n", 
$nÙify_emas
),

21 '#desütiÚ' => 
	`t
('Whenever your site checks for‡vailable updates‡nd finds‚ew„eleases, it can‚otify‡†ist of users viaƒ-mail. Putƒach‡ddress on‡ separate†ine. If blank,‚oƒ-mails will be sent.'),

24 
$fÜm
['upd©e_check_äequ’cy'] = 
	`¬¿y
(

26 '#t™Ë' => 
	`t
('Check for updates'),

27 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('update_check_frequency', 1),

28 '#İtiÚs' => 
	`¬¿y
(

29 '1' => 
	`t
('Daily'),

30 '7' => 
	`t
('Weekly'),

32 '#desütiÚ' => 
	`t
('Select how frequently you wanto‡utomatically check for‚ew„eleases of your currently installed modules‡ndhemes.'),

35 
$fÜm
['upd©e_nÙifiÿtiÚ_th»shŞd'] = 
	`¬¿y
(

37 '#t™Ë' => 
	`t
('E-mail‚otificationhreshold'),

38 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('update_notification_threshold', 'all'),

39 '#İtiÚs' => 
	`¬¿y
(

40 '®l' => 
	`t
('All‚ewer versions'),

41 '£cur™y' => 
	`t
('Only security updates'),

43 '#desütiÚ' => 
	`t
('You cª choo£Ø£ndƒ-ma oÆy ià¨£cur™y upd©i avaabË, o¸tØbnÙif›d‡bouˆ®ÈÃw” v”siÚs. Iàth”¬upd©e avaabË oàDru·ÈcÜÜ‡ny oàyou¸š¡®Ëd moduË ªdhemes, you¸s™wÈ®way ´šˆ¨mes§gÚh<¨h»f="@¡©us_»pÜt">¡©u »pÜt</a>…age,‡nd wÈ®sØdi¥Ïy‡À”rÜ mes§gÚ‡dmši¡¿tiÚ…age iàth”i ¨£cur™y upd©e.', 
	`¬¿y
('@¡©us_»pÜt' => 
	`u¾
('admin/reports/status')))

46 
$fÜm
 = 
	`sy¡em_£‰šgs_fÜm
($form);

48 
$fÜm
['#validate'][] = 'update_settings_validate';

51 
	`un£t
(
$fÜm
['#submit']);

53  
$fÜm
;

54 
	}
}

61 
funùiÚ
 
	$upd©e_£‰šgs_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

62 ià(!
	`em±y
(
$fÜm_¡©e
['values']['update_notify_emails'])) {

63 
$v®id
 = 
	`¬¿y
();

64 
$šv®id
 = 
	`¬¿y
();

65 
	`fÜ—ch
 (
	`ex¶ode
("\n", 
	`Œim
(
$fÜm_¡©e
['v®ues']['upd©e_nÙify_emas'])è
as
 
$ema
) {

66 
$ema
 = 
	`Œim
($email);

67 ià(!
	`em±y
(
$ema
)) {

68 ià(
	`v®id_ema_add»ss
(
$ema
)) {

69 
$v®id
[] = 
$ema
;

72 
$šv®id
[] = 
$ema
;

76 ià(
	`em±y
(
$šv®id
)) {

77 
$fÜm_¡©e
['nÙify_emas'] = 
$v®id
;

79 
	`–£if
 (
	`couÁ
(
$šv®id
) == 1) {

80 
	`fÜm_£t_”rÜ
('upd©e_nÙify_emas', 
	`t
('%ema i nÙ‡ v®idƒ-ma‡dd»ss.', 
	`¬¿y
('%ema' => 
	`»£t
(
$šv®id
))));

83 
	`fÜm_£t_”rÜ
('upd©e_nÙify_emas', 
	`t
('%ema ¬nÙ v®idƒ-ma‡dd»s£s.', 
	`¬¿y
('%emas' => 
	`im¶ode
(', ', 
$šv®id
))));

86 
	}
}

91 
funùiÚ
 
	$upd©e_£‰šgs_subm™
(
$fÜm
, 
$fÜm_¡©e
) {

92 
$İ
 = 
$fÜm_¡©e
['values']['op'];

94 ià(
$İ
 =ğ
	`t
('Reseto defaults')) {

95 
	`un£t
(
$fÜm_¡©e
['notify_emails']);

98 ià(
	`em±y
(
$fÜm_¡©e
['notify_emails'])) {

99 
	`v¬ŸbË_d–
('update_notify_emails');

102 
	`v¬ŸbË_£t
('upd©e_nÙify_emas', 
$fÜm_¡©e
['notify_emails']);

104 
	`un£t
(
$fÜm_¡©e
['notify_emails']);

105 
	`un£t
(
$fÜm_¡©e
['values']['update_notify_emails']);

107 
	`sy¡em_£‰šgs_fÜm_subm™
(
$fÜm
, 
$fÜm_¡©e
);

108 
	}
}

	@/srv/http/subs/notes/www/modules/upload/upload.admin.inc

1 <?
php


7 
funùiÚ
 
	$u¶ßd_admš_£‰šgs_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

8 ià((
$fÜm_¡©e
['values']['upload_max_resolution'] != '0')) {

9 ià(!
	`´eg_m©ch
('/^[0-9]+x[0-9]+$/', 
$fÜm_¡©e
['values']['upload_max_resolution'])) {

10 
	`fÜm_£t_”rÜ
('u¶ßd_max_»sŞutiÚ', 
	`t
('The maximum‡llowed image sizeƒxpressed‡s WIDTHxHEIGHT (e.g. 640x480). Seto 0 for‚o„estriction.'));

14 
$deçuÉ_u¶ßdsize
 = 
$fÜm_¡©e
['values']['upload_uploadsize_default'];

15 
$deçuÉ_u£rsize
 = 
$fÜm_¡©e
['values']['upload_usersize_default'];

17 
$exûed_max_msg
 = 
	`t
('You¸PHP s‘tšg lim™hmaximum fsiz³¸u¶ßdØ%size.', 
	`¬¿y
('%size' => 
	`fÜm©_size
(
	`fe_u¶ßd_max_size
()))) .'<br/>';

18 
$mÜe_šfo
 = 
	`t
("Depending on your serverƒnvironment,hese settings may be changed inhe system-wide…hp.ini file,‡…hp.ini file in your Drupal„oot directory, in your Drupal site's settings.php file, or inhe .htaccess file in your Drupal„oot directory.");

20 ià(!
	`is_num”ic
(
$deçuÉ_u¶ßdsize
) || ($default_uploadsize <= 0)) {

21 
	`fÜm_£t_”rÜ
('u¶ßd_u¶ßdsize_deçuÉ', 
	`t
('Th%rŞfsizlim™ mu¡ b¨numb”‡nd g»©”hª z”o.', 
	`¬¿y
('%role' =>('default'))));

23 ià(!
	`is_num”ic
(
$deçuÉ_u£rsize
) || ($default_usersize <= 0)) {

24 
	`fÜm_£t_”rÜ
('u¶ßd_u£rsize_deçuÉ', 
	`t
('Th%rŞfsizlim™ mu¡ b¨numb”‡nd g»©”hª z”o.', 
	`¬¿y
('%role' =>('default'))));

26 ià(
$deçuÉ_u¶ßdsize
 * 1024 * 1024 > 
	`fe_u¶ßd_max_size
()) {

27 
	`fÜm_£t_”rÜ
('u¶ßd_u¶ßdsize_deçuÉ', 
$exûed_max_msg
 . 
$mÜe_šfo
);

28 
$mÜe_šfo
 = '';

30 ià(
$deçuÉ_u¶ßdsize
 > 
$deçuÉ_u£rsize
) {

31 
	`fÜm_£t_”rÜ
('u¶ßd_u¶ßdsize_deçuÉ', 
	`t
('Th%rŞmaximum fsiz³¸u¶ßd i g»©”hªhtÙ® fsiz®lowed…” u£r', 
	`¬¿y
('%role' =>('default'))));

34 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['rŞes'] 
as
 
$rid
 => 
$rŞe
) {

35 
$u¶ßdsize
 = 
$fÜm_¡©e
['v®ues']['u¶ßd_u¶ßdsize_'. 
$rid
];

36 
$u£rsize
 = 
$fÜm_¡©e
['v®ues']['u¶ßd_u£rsize_'. 
$rid
];

38 ià(!
	`is_num”ic
(
$u¶ßdsize
) || ($uploadsize <= 0)) {

39 
	`fÜm_£t_”rÜ
('u¶ßd_u¶ßdsize_'. 
$rid
, 
	`t
('Th%rŞfsizlim™ mu¡ b¨numb”‡nd g»©”hª z”o.', 
	`¬¿y
('%rŞe' => 
$rŞe
)));

41 ià(!
	`is_num”ic
(
$u£rsize
) || ($usersize <= 0)) {

42 
	`fÜm_£t_”rÜ
('u¶ßd_u£rsize_'. 
$rid
, 
	`t
('Th%rŞfsizlim™ mu¡ b¨numb”‡nd g»©”hª z”o.', 
	`¬¿y
('%rŞe' => 
$rŞe
)));

44 ià(
$u¶ßdsize
 * 1024 * 1024 > 
	`fe_u¶ßd_max_size
()) {

45 
	`fÜm_£t_”rÜ
('u¶ßd_u¶ßdsize_'. 
$rid
, 
$exûed_max_msg
 . 
$mÜe_šfo
);

46 
$mÜe_šfo
 = '';

48 ià(
$u¶ßdsize
 > 
$u£rsize
) {

49 
	`fÜm_£t_”rÜ
('u¶ßd_u¶ßdsize_'. 
$rid
, 
	`t
('Th%rŞmaximum fsiz³¸u¶ßd i g»©”hªhtÙ® fsiz®lowed…” u£r', 
	`¬¿y
('%rŞe' => 
$rŞe
)));

52 
	}
}

57 
funùiÚ
 
	$u¶ßd_admš_£‰šgs
() {

58 
$u¶ßd_ex‹nsiÚs_deçuÉ
 = 
	`v¬ŸbË_g‘
('upload_extensions_default', 'jpg jpeg gif…ngxt doc xls…df…pt…ps odt ods odp');

59 
$u¶ßd_u¶ßdsize_deçuÉ
 = 
	`v¬ŸbË_g‘
('upload_uploadsize_default', 1);

60 
$u¶ßd_u£rsize_deçuÉ
 = 
	`v¬ŸbË_g‘
('upload_usersize_default', 1);

62 
$fÜm
['£‰šgs_g’”®'] = 
	`¬¿y
(

64 '#t™Ë' => 
	`t
('General settings'),

65 '#cŞÏpsibË' => 
TRUE
,

67 
$fÜm
['£‰šgs_g’”®']['u¶ßd_max_»sŞutiÚ'] = 
	`¬¿y
(

69 '#t™Ë' => 
	`t
('Maximum„esolution for uploaded images'),

70 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('upload_max_resolution', 0),

73 '#desütiÚ' => 
	`t
('Thmaximum‡Îowed imagsizÓ.g. 640x480). S‘Ø0 fÜ‚Ø»¡riùiÚ. Iàª <¨h»f="!image-toŞk™-lšk">imagtoŞk™</a> i š¡®Ëd, fe exûedšghi v®uwÈbsÿËd dowÀtØf™.', 
	`¬¿y
('!image-toŞk™-lšk' => 
	`u¾
('admin/settings/image-toolkit'))),

74 '#f›ld_suffix' => '<kbd>'. 
	`t
('WIDTHxHEIGHT') .'</kbd>'

76 
$fÜm
['£‰šgs_g’”®']['u¶ßd_li¡_deçuÉ'] = 
	`¬¿y
(

78 '#t™Ë' => 
	`t
('List files by default'),

79 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('upload_list_default', 1),

80 '#İtiÚs' => 
	`¬¿y
(0 => 
	`t
('No'), 1 =>('Yes')),

81 '#desütiÚ' => 
	`t
('Display‡ttached files when viewing‡…ost.'),

84 
$fÜm
['£‰šgs_g’”®']['u¶ßd_ex‹nsiÚs_deçuÉ'] = 
	`¬¿y
(

86 '#t™Ë' => 
	`t
('Default…ermitted fileƒxtensions'),

87 '#deçuÉ_v®ue' => 
$u¶ßd_ex‹nsiÚs_deçuÉ
,

89 '#desütiÚ' => 
	`t
('Defaultƒxtensionshat users can upload. Separateƒxtensions with‡ space‡nd do‚ot includehe†eading dot.'),

91 
$fÜm
['£‰šgs_g’”®']['u¶ßd_u¶ßdsize_deçuÉ'] = 
	`¬¿y
(

93 '#t™Ë' => 
	`t
('Default maximum file size…er upload'),

94 '#deçuÉ_v®ue' => 
$u¶ßd_u¶ßdsize_deçuÉ
,

97 '#desütiÚ' => 
	`t
('The default maximum file size‡ user can upload. If‡n image is uploaded‡nd‡ maximum„esolution is set,he size will be checked‡fterhe file has been„esized.'),

98 '#f›ld_suffix' => 
	`t
('MB'),

100 
$fÜm
['£‰šgs_g’”®']['u¶ßd_u£rsize_deçuÉ'] = 
	`¬¿y
(

102 '#t™Ë' => 
	`t
('Defaultotal file size…er user'),

103 '#deçuÉ_v®ue' => 
$u¶ßd_u£rsize_deçuÉ
,

106 '#desütiÚ' => 
	`t
('The default maximum size of‡ll files‡ user can have onhe site.'),

107 '#f›ld_suffix' => 
	`t
('MB'),

110 
$fÜm
['£‰šgs_g’”®']['u¶ßd_max_size'] = 
	`¬¿y
('#v®ue' => '<p>'. 
	`t
('You¸PHP s‘tšg lim™hmaximum fsiz³¸u¶ßdØ%size.',‡¼ay('%size' => 
	`fÜm©_size
(
	`fe_u¶ßd_max_size
()))) .'</p>');

112 
$rŞes
 = 
	`u£r_rŞes
(
FALSE
, 'upload files');

113 
$fÜm
['rŞes'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$rŞes
);

115 
	`fÜ—ch
 (
$rŞes
 
as
 
$rid
 => 
$rŞe
) {

116 
$fÜm
['£‰šgs_rŞe_'. 
$rid
] = 
	`¬¿y
(

118 '#t™Ë' => 
	`t
('S‘tšg fÜ @rŞe', 
	`¬¿y
('@rŞe' => 
$rŞe
)),

119 '#cŞÏpsibË' => 
TRUE
,

120 '#cŞÏp£d' => 
TRUE
,

122 
$fÜm
['£‰šgs_rŞe_'. 
$rid
]['u¶ßd_ex‹nsiÚs_'. $rid] = 
	`¬¿y
(

124 '#t™Ë' => 
	`t
('Permitted fileƒxtensions'),

125 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('u¶ßd_ex‹nsiÚs_'. 
$rid
, 
$u¶ßd_ex‹nsiÚs_deçuÉ
),

127 '#desütiÚ' => 
	`t
('Extensionshat users inhis„ole can upload. Separateƒxtensions with‡ space‡nd do‚ot includehe†eading dot.'),

129 
$fÜm
['£‰šgs_rŞe_'. 
$rid
]['u¶ßd_u¶ßdsize_'. $rid] = 
	`¬¿y
(

131 '#t™Ë' => 
	`t
('Maximum file size…er upload'),

132 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('u¶ßd_u¶ßdsize_'. 
$rid
, 
$u¶ßd_u¶ßdsize_deçuÉ
),

135 '#desütiÚ' => 
	`t
('The maximum size of‡ file‡ user can upload. If‡n image is uploaded‡nd‡ maximum„esolution is set,he size will be checked‡fterhe file has been„esized.'),

136 '#f›ld_suffix' => 
	`t
('MB'),

138 
$fÜm
['£‰šgs_rŞe_'. 
$rid
]['u¶ßd_u£rsize_'. $rid] = 
	`¬¿y
(

140 '#t™Ë' => 
	`t
('Total file size…er user'),

141 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('u¶ßd_u£rsize_'. 
$rid
, 
$u¶ßd_u£rsize_deçuÉ
),

144 '#desütiÚ' => 
	`t
('The maximum size of‡ll files‡ user can have onhe site.'),

145 '#f›ld_suffix' => 
	`t
('MB'),

149 
$fÜm
['#v®id©e'] = 
	`¬¿y
('upload_admin_settings_validate');

151  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

152 
	}
}

	@/srv/http/subs/notes/www/modules/upload/upload.module

1 <?
php


13 
funùiÚ
 
	$u¶ßd_h–p
(
$·th
, 
$¬g
) {

14 
$·th
) {

16 
$ouut
 = '<p>'. 
	`t
('The upload module‡llows userso upload filesohe site. The‡bilityo upload files is important for members of‡ community who wanto share work. It is‡lso usefulo‡dministrators who wanto keep uploaded files connectedo…osts.') .'</p>';

17 
$ouut
 .ğ'<p>'. 
	`t
('Users withhe upload files…ermission can upload‡ttachmentso…osts. Uploads may beƒnabled for specific contentypes onhe contentypes settings…age. Each user„ole can be customizedo†imit or controlhe file size of uploads, orhe maximum dimension of image files.') .'</p>';

18 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@u¶ßd">U¶ßd moduË</a>.', 
	`¬¿y
('@upload' => 'http://drupal.org/handbook/modules/upload/')) .'</p>';

19  
$ouut
;

21  '<p>'. 
	`t
('U£r w™hh<¨h»f="@³rmissiÚs">u¶ßd fe ³rmissiÚ</a> cª u¶ßd‡‰achm’ts. U£r w™hh<¨h»f="@³rmissiÚs">v›w u¶ßded fe ³rmissiÚ</a> cª v›w u¶ßded‡‰achm’ts. You cª choo£ which…o¡y³ ÿÀk©chm’t Úh<¨h»f="@ty³s">cÚ‹Áy³ £‰šgs</a>…age.', 
	`¬¿y
('@³rmissiÚs' => 
	`u¾
('admin/user/permissions'), '@types' => url('admin/settings/types'))) .'</p>';

23 
	}
}

28 
funùiÚ
 
	$u¶ßd_theme
() {

29  
	`¬¿y
(

30 'u¶ßd_©chm’ts' => 
	`¬¿y
(

31 '¬gum’ts' => 
	`¬¿y
('fes' => 
NULL
),

33 'u¶ßd_fÜm_cu¼’t' => 
	`¬¿y
(

34 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

36 'u¶ßd_fÜm_Ãw' => 
	`¬¿y
(

37 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

40 
	}
}

45 
funùiÚ
 
	$u¶ßd_³rm
() {

46  
	`¬¿y
('upload files', 'view uploaded files');

47 
	}
}

52 
funùiÚ
 
	$u¶ßd_lšk
(
$ty³
, 
$node
 = 
NULL
, 
$‹a£r
 = 
FALSE
) {

53 
$lšks
 = 
	`¬¿y
();

56 ià(
$‹a£r
 && 
$ty³
 =ğ'node' && 
	`is£t
(
$node
->
fes
è&& 
	`u£r_acûss
('view uploaded files')) {

57 
$num_fes
 = 0;

58 
	`fÜ—ch
 (
$node
->
fes
 
as
 
$fe
) {

59 ià(
$fe
->
li¡
) {

60 
$num_fes
++;

63 ià(
$num_fes
) {

64 
$lšks
['u¶ßd_©chm’ts'] = 
	`¬¿y
(

65 't™Ë' => 
	`fÜm©_¶u¿l
(
$num_fes
, '1‡ttachment', '@count‡ttachments'),

67 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
	`t
('Read full‡rticleo view‡ttachments.')),

73  
$lšks
;

74 
	}
}

79 
funùiÚ
 
	$u¶ßd_m’u
() {

80 
$™ems
['u¶ßd/js'] = 
	`¬¿y
(

82 'acûs ¬gum’ts' => 
	`¬¿y
('upload files'),

83 'ty³' => 
MENU_CALLBACK
,

85 
$™ems
['admš/£‰šgs/u¶ßds'] = 
	`¬¿y
(

89 '·g¬gum’ts' => 
	`¬¿y
('upload_admin_settings'),

90 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

91 'ty³' => 
MENU_NORMAL_ITEM
,

94  
$™ems
;

95 
	}
}

97 
funùiÚ
 
	$u¶ßd_m’u_®‹r
(&
$™ems
) {

98 
$™ems
['sy¡em/fes']['acûs ¬gum’ts'] = 
	`¬¿y
('view uploaded files');

99 
	}
}

120 
funùiÚ
 
	$_u¶ßd_fe_lim™s
(
$u£r
) {

121 
$fe_lim™
 = 
	`v¬ŸbË_g‘
('upload_uploadsize_default', 1);

122 
$u£r_lim™
 = 
	`v¬ŸbË_g‘
('upload_usersize_default', 1);

123 
$®l_ex‹nsiÚs
 = 
	`ex¶ode
(' ', 
	`v¬ŸbË_g‘
('upload_extensions_default', 'jpg jpeg gif…ngxt doc xls…df…pt…ps odt ods odp'));

124 
	`fÜ—ch
 (
$u£r
->
rŞes
 
as
 
$rid
 => 
$Çme
) {

125 
$ex‹nsiÚs
 = 
	`v¬ŸbË_g‘
("upload_extensions_$rid", variable_get('upload_extensions_default', 'jpg jpeg gif…ngxt doc xls…df…pt…ps odt ods odp'));

126 
$®l_ex‹nsiÚs
 = 
	`¬¿y_m”ge
($®l_ex‹nsiÚs, 
	`ex¶ode
(' ', 
$ex‹nsiÚs
));

129 
$fe_size
 = 
	`v¬ŸbË_g‘
("upload_uploadsize_$rid", variable_get('upload_uploadsize_default', 1)) * 1024 * 1024;

130 
$fe_lim™
 = ($fe_lim™ && 
$fe_size
è? 
	`max
($file_limit, $file_size) : 0;

132 
$u£r_size
 = 
	`v¬ŸbË_g‘
("upload_usersize_$rid", variable_get('upload_usersize_default', 1)) * 1024 * 1024;

133 
$u£r_lim™
 = ($u£r_lim™ && 
$u£r_size
è? 
	`max
($user_limit, $user_size) : 0;

135 
$®l_ex‹nsiÚs
 = 
	`im¶ode
(' ', 
	`¬¿y_unique
($all_extensions));

136  
	`¬¿y
(

137 'ex‹nsiÚs' => 
$®l_ex‹nsiÚs
,

138 'fe_size' => 
$fe_lim™
,

139 'u£r_size' => 
$u£r_lim™
,

140 '»sŞutiÚ' => 
	`v¬ŸbË_g‘
('upload_max_resolution', 0),

142 
	}
}

147 
funùiÚ
 
	$u¶ßd_fe_dowÆßd
(
$f•©h
) {

148 
$f•©h
 = 
	`fe_ü—‹_·th
($filepath);

149 
$»suÉ
 = 
	`db_qu”y
("SELECT f.*, u.nid FROM {fes} f INNER JOIN {u¶ßd} u ON f.fid = u.fid WHERE f•©h = '%s'", 
$f•©h
);

150 
$fe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

151 ià(
$f•©h
 !=ğ
$fe
->
f•©h
) {

157 ià(
	`u£r_acûss
('v›w u¶ßded fes'è&& (
$node
 = 
	`node_lßd
(
$fe
->
nid
)è&& 
	`node_acûss
('view', $node)) {

158  
	`¬¿y
(

159 'CÚ‹Á-Ty³: ' . 
$fe
->
femime
,

160 'CÚ‹Á-L’gth: ' . 
$fe
->
fesize
,

167 
	}
}

176 
funùiÚ
 
	$u¶ßd_node_fÜm_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

177 
glob®
 
$u£r
;

179 
$lim™s
 = 
	`_u¶ßd_fe_lim™s
(
$u£r
);

180 
$v®id©Üs
 = 
	`¬¿y
(

181 'fe_v®id©e_ex‹nsiÚs' => 
	`¬¿y
(
$lim™s
['extensions']),

182 'fe_v®id©e_image_»sŞutiÚ' => 
	`¬¿y
(
$lim™s
['resolution']),

183 'fe_v®id©e_size' => 
	`¬¿y
(
$lim™s
['file_size'], $limits['user_size']),

187 ià(
	`u£r_acûss
('u¶ßd fes'è&& (
$fe
 = 
	`fe_§ve_u¶ßd
('u¶ßd', 
$v®id©Üs
, 
	`fe_dœeùÜy_·th
()))) {

188 
$fe
->
li¡
 = 
	`v¬ŸbË_g‘
('upload_list_default', 1);

189 
$fe
->
desütiÚ
 = $fe->
f’ame
;

190 
$fe
->
weight
 = 0;

191 
$fe
->
Ãw
 = 
TRUE
;

192 
$fÜm
['#node']->
fes
[
$fe
->
fid
] = $file;

193 
$fÜm_¡©e
['v®ues']['fes'][
$fe
->
fid
] = (
¬¿y
)$file;

196 ià(
	`is£t
(
$fÜm_¡©e
['values']['files'])) {

197 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['fes'] 
as
 
$fid
 => 
$fe
) {

200 
$fÜm
['#node']->
fes
[
$fid
] = (
objeù
) $form['#node']->files[$fid];

201 
$fÜm_¡©e
['v®ues']['fes'][
$fid
]['Ãw'] = !
	`em±y
(
$fÜm
['#node']->
fes
[$fid]->
Ãw
);

206 ià(!
	`em±y
(
$fÜm_¡©e
['values']['files'])) {

207 
$miüoweight
 = 0.001;

208 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['fes'] 
as
 
$fid
 => 
$fe
) {

209 ià(
	`is_num”ic
(
$fid
)) {

210 
$fÜm_¡©e
['v®ues']['fes'][
$fid
]['#weight'] = 
$fe
['weight'] + 
$miüoweight
;

211 
$miüoweight
 += 0.001;

214 
	`uasÜt
(
$fÜm_¡©e
['values']['files'], 'element_sort');

216 
	}
}

218 
funùiÚ
 
	$u¶ßd_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

219 ià(
$fÜm_id
 =ğ'node_ty³_fÜm' && 
	`is£t
(
$fÜm
['identity']['type'])) {

220 
$fÜm
['wÜkæow']['u¶ßd'] = 
	`¬¿y
(

222 '#t™Ë' => 
	`t
('Attachments'),

223 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('u¶ßd_'. 
$fÜm
['#node_ty³']->
ty³
, 1),

224 '#İtiÚs' => 
	`¬¿y
(
	`t
('Disabled'),('Enabled')),

228 ià(
	`is£t
(
$fÜm
['type']) && isset($form['#node'])) {

229 
$node
 = 
$fÜm
['#node'];

230 ià(
$fÜm
['ty³']['#v®ue'] .'_node_fÜm' =ğ
$fÜm_id
 && 
	`v¬ŸbË_g‘
("u¶ßd_$node->ty³", 
TRUE
)) {

232 
$fÜm
['©chm’ts'] = 
	`¬¿y
(

234 '#acûss' => 
	`u£r_acûss
('upload files'),

235 '#t™Ë' => 
	`t
('File‡ttachments'),

236 '#cŞÏpsibË' => 
TRUE
,

237 '#cŞÏp£d' => 
	`em±y
(
$node
->
fes
),

238 '#desütiÚ' => 
	`t
('Changes madeohe‡ttachments‡re‚ot…ermanent until you savehis…ost. The first "listed" file will be included in RSS feeds.'),

245 
$fÜm
['©chm’ts']['w¿µ”'] = 
	`¬¿y
(

252 
$·th
 = 
	`fe_dœeùÜy_·th
();

253 
$‹mp
 = 
	`fe_dœeùÜy_‹mp
();

255 ià(!
	`fe_check_dœeùÜy
(
$·th
, 
FILE_CREATE_DIRECTORY
è|| !fe_check_dœeùÜy(
$‹mp
, FILE_CREATE_DIRECTORY)) {

256 
$fÜm
['©chm’ts']['#desütiÚ'] = 
	`t
('File‡ttachments‡re disabled. The file directories have‚ot been…roperly configured.');

257 ià(
	`u£r_acûss
('administer site configuration')) {

258 
$fÜm
['©chm’ts']['#desütiÚ'] .ğ' '. 
	`t
('PËa£ vis™h<¨h»f="@admš-fe-sy¡em">fsy¡em cÚfigu¿tiÚ…age</a>.', 
	`¬¿y
('@admš-fe-sy¡em' => 
	`u¾
('admin/settings/file-system')));

261 
$fÜm
['©chm’ts']['#desütiÚ'] .ğ' '. 
	`t
('Please contacthe site‡dministrator.');

265 
$fÜm
['©chm’ts']['w¿µ”'] +ğ
	`_u¶ßd_fÜm
(
$node
);

266 
$fÜm
['#attributes']['enctype'] = 'multipart/form-data';

268 
$fÜm
['#submit'][] = 'upload_node_form_submit';

271 
	}
}

276 
funùiÚ
 
	$u¶ßd_nod—pi
(&
$node
, 
$İ
, 
$‹a£r
) {

277 
$İ
) {

280 
$ouut
 = '';

281 ià(
	`v¬ŸbË_g‘
("upload_$node->type", 1) == 1) {

282 
$ouut
['fes'] = 
	`u¶ßd_lßd
(
$node
);

283  
$ouut
;

288 ià(
	`is£t
(
$node
->
fes
è&& 
	`u£r_acûss
('view uploaded files')) {

291 ià(
	`couÁ
(
$node
->
fes
)) {

292 ià(!
$‹a£r
 && 
	`u£r_acûss
('view uploaded files')) {

293 
$node
->
cÚ‹Á
['fes'] = 
	`¬¿y
(

294 '#v®ue' => 
	`theme
('u¶ßd_©chm’ts', 
$node
->
fes
),

304 ià(
	`u£r_acûss
('upload files')) {

305 
	`u¶ßd_§ve
(
$node
);

310 
	`u¶ßd_d–‘e
(
$node
);

314 
	`u¶ßd_d–‘e_»visiÚ
(
$node
);

318  
	`is£t
(
$node
->
fes
è&& 
	`is_¬¿y
($node->fesè? 
	`fÜm©_¶u¿l
(
	`couÁ
($node->fes), '1‡‰achm’t', '@couÁ‡‰achm’ts'è: 
NULL
;

321 ià(
	`is_¬¿y
(
$node
->
fes
)) {

322 
$fes
 = 
	`¬¿y
();

323 
	`fÜ—ch
 (
$node
->
fes
 
as
 
$fe
) {

324 ià(
$fe
->
li¡
) {

325 
$fes
[] = 
$fe
;

328 ià(
	`couÁ
(
$fes
) > 0) {

330 
$fe
 = 
	`¬¿y_shiá
(
$fes
);

331  
	`¬¿y
(

332 
	`¬¿y
(

334 '©Œibu‹s' => 
	`¬¿y
(

335 'u¾' => 
	`fe_ü—‹_u¾
(
$fe
->
f•©h
),

336 'Ëngth' => 
$fe
->
fesize
,

337 'ty³' => 
$fe
->
femime


343  
	`¬¿y
();

345 
	}
}

352 
funùiÚ
 
	$theme_u¶ßd_©chm’ts
(
$fes
) {

353 
$h—d”
 = 
	`¬¿y
(
	`t
('Attachment'),('Size'));

354 
$rows
 = 
	`¬¿y
();

355 
	`fÜ—ch
 (
$fes
 
as
 
$fe
) {

356 
$fe
 = (
objeù
)$file;

357 ià(
$fe
->
li¡
 && 
	`em±y
($fe->
»move
)) {

358 
$h»f
 = 
	`fe_ü—‹_u¾
(
$fe
->
f•©h
);

359 
$‹xt
 = 
$fe
->
desütiÚ
 ? $fe->desütiÚ : $fe->
f’ame
;

360 
$rows
[] = 
	`¬¿y
(
	`l
(
$‹xt
, 
$h»f
), 
	`fÜm©_size
(
$fe
->
fesize
));

363 ià(
	`couÁ
(
$rows
)) {

364  
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('id' => 'attachments'));

366 
	}
}

376 
funùiÚ
 
	$u¶ßd_¥aû_u£d
(
$uid
) {

377  
	`fe_¥aû_u£d
(
$uid
);

378 
	}
}

386 
funùiÚ
 
	$u¶ßd_tÙ®_¥aû_u£d
() {

387  
	`db_»suÉ
(
	`db_qu”y
('SELECT SUM(f.filesize) FROM {files} f INNER JOIN {upload} u ON f.fid = u.fid'));

388 
	}
}

390 
funùiÚ
 
	$u¶ßd_§ve
(&
$node
) {

391 ià(
	`em±y
(
$node
->
fes
è|| !
	`is_¬¿y
($node->files)) {

395 
	`fÜ—ch
 (
$node
->
fes
 
as
 
$fid
 => 
$fe
) {

397 
$fe
 = (
objeù
)$file;

401 ià(!
	`em±y
(
$fe
->
»move
)) {

402 
	`db_qu”y
('DELETE FROM {u¶ßd} WHERE fid = %d AND vid = %d', 
$fid
, 
$node
->
vid
);

405 
$couÁ
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(fidèFROM {u¶ßd} WHERE fid = %d', 
$fid
));

406 ià(
$couÁ
 < 1) {

407 
	`fe_d–‘e
(
$fe
->
f•©h
);

408 
	`db_qu”y
('DELETE FROM {fes} WHERE fid = %d', 
$fid
);

413 
	`un£t
(
$node
->
fes
[
$fid
]);

419 ià(!
	`em±y
(
$node
->
Şd_vid
è|| 
$fe
->
Ãw
) {

420 
	`db_qu”y
("INSERT INTO {u¶ßd} (fid,‚id, vid,†i¡, desütiÚ, weightèVALUES (%d, %d, %d, %d, '%s', %d)", 
$fe
->
fid
, 
$node
->
nid
, $node->
vid
, $fe->
li¡
, $fe->
desütiÚ
, $fe->
weight
);

421 
	`fe_£t_¡©us
(
$fe
, 
FILE_STATUS_PERMANENT
);

425 
	`db_qu”y
("UPDATE {u¶ßd} SET†i¡ = %d, desütiÚ = '%s', weighˆğ%d WHERE fid = %d AND vid = %d", 
$fe
->
li¡
, $fe->
desütiÚ
, $fe->
weight
, $fe->
fid
, 
$node
->
vid
);

426 
	`fe_£t_¡©us
(
$fe
, 
FILE_STATUS_PERMANENT
);

429 
	}
}

431 
funùiÚ
 
	$u¶ßd_d–‘e
(
$node
) {

432 
$fes
 = 
	`¬¿y
();

433 
$»suÉ
 = 
	`db_qu”y
('SELECT DISTINCT f.* FROM {u¶ßd} u INNER JOIN {fes} f ON u.fid = f.fid WHERE u.nid = %d', 
$node
->
nid
);

434 
$fe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

435 
$fes
[
$fe
->
fid
] = $file;

438 
	`fÜ—ch
 (
$fes
 
as
 
$fid
 => 
$fe
) {

440 
	`db_qu”y
('DELETE FROM {fes} WHERE fid = %d', 
$fid
);

441 
	`fe_d–‘e
(
$fe
->
f•©h
);

445 
	`db_qu”y
('DELETE FROM {u¶ßd} WHERE‚id = %d', 
$node
->
nid
);

446 
	}
}

448 
funùiÚ
 
	$u¶ßd_d–‘e_»visiÚ
(
$node
) {

449 ià(
	`is_¬¿y
(
$node
->
fes
)) {

450 
	`fÜ—ch
 (
$node
->
fes
 
as
 
$fe
) {

452 
$couÁ
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(fidèFROM {u¶ßd} WHERE fid = %d', 
$fe
->
fid
));

455 ià(
$couÁ
 < 2) {

456 
	`db_qu”y
('DELETE FROM {fes} WHERE fid = %d', 
$fe
->
fid
);

457 
	`fe_d–‘e
(
$fe
->
f•©h
);

463 
	`db_qu”y
('DELETE FROM {u¶ßd} WHERE vid = %d', 
$node
->
vid
);

464 
	}
}

466 
funùiÚ
 
	$_u¶ßd_fÜm
(
$node
) {

467 
glob®
 
$u£r
;

469 
$fÜm
 = 
	`¬¿y
(

471 '#ÿche' => 
TRUE
,

474 ià(!
	`em±y
(
$node
->
fes
è&& 
	`is_¬¿y
($node->files)) {

475 
$fÜm
['files']['#theme'] = 'upload_form_current';

476 
$fÜm
['fes']['#Œ“'] = 
TRUE
;

477 
	`fÜ—ch
 (
$node
->
fes
 
as
 
$key
 => 
$fe
) {

478 
$fe
 = (
objeù
)$file;

479 
$desütiÚ
 = 
	`fe_ü—‹_u¾
(
$fe
->
f•©h
);

480 
$desütiÚ
 = "<sm®l>". 
	`check_¶aš
($description) ."</small>";

481 
$fÜm
['fes'][
$key
]['desütiÚ'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#deçuÉ_v®ue' => !
	`em±y
(
$fe
->
desütiÚ
è? $fe->desütiÚ : $fe->
f’ame
, '#maxËngth' => 256, '#desütiÚ' => 
$desütiÚ
 );

482 
$fÜm
['fes'][
$key
]['size'] = 
	`¬¿y
('#v®ue' => 
	`fÜm©_size
(
$fe
->
fesize
));

483 
$fÜm
['fes'][
$key
]['»move'] = 
	`¬¿y
('#ty³' => 'checkbox', '#deçuÉ_v®ue' => !
	`em±y
(
$fe
->
»move
));

484 
$fÜm
['fes'][
$key
]['li¡'] = 
	`¬¿y
('#ty³' => 'checkbox', '#deçuÉ_v®ue' => 
$fe
->
li¡
);

485 
$fÜm
['fes'][
$key
]['weight'] = 
	`¬¿y
('#ty³' => 'weight', '#d–' => 
	`couÁ
(
$node
->
fes
), '#deçuÉ_v®ue' => 
$fe
->
weight
);

486 
$fÜm
['fes'][
$key
]['f’ame'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$fe
->
f’ame
);

487 
$fÜm
['fes'][
$key
]['f•©h'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$fe
->
f•©h
);

488 
$fÜm
['fes'][
$key
]['femime'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$fe
->
femime
);

489 
$fÜm
['fes'][
$key
]['fesize'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$fe
->
fesize
);

490 
$fÜm
['fes'][
$key
]['fid'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$fe
->
fid
);

491 
$fÜm
['fes'][
$key
]['Ãw'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
FALSE
);

495 ià(
	`u£r_acûss
('upload files')) {

496 
$lim™s
 = 
	`_u¶ßd_fe_lim™s
(
$u£r
);

497 
$fÜm
['new']['#weight'] = 10;

498 
$fÜm
['Ãw']['u¶ßd'] = 
	`¬¿y
(

500 '#t™Ë' => 
	`t
('Attach‚ew file'),

502 '#desütiÚ' => (
$lim™s
['»sŞutiÚ'] ? 
	`t
('Image ¬Ïrg”hª %»sŞutiÚ wÈb»sized. ', 
	`¬¿y
('%»sŞutiÚ' => $lim™s['»sŞutiÚ'])è: ''è.('Thmaximum u¶ßd sizi %fesize. OÆy fe w™hhfŞlowšgƒx‹nsiÚ may bu¶ßded: %ex‹nsiÚs. ',‡¼ay('%ex‹nsiÚs' => $lim™s['ex‹nsiÚs'], '%fesize' => 
	`fÜm©_size
($limits['file_size']))),

504 
$fÜm
['Ãw']['©ch'] = 
	`¬¿y
(

506 '#v®ue' => 
	`t
('Attach'),

508 '#ahah' => 
	`¬¿y
(

511 '´og»ss' => 
	`¬¿y
('ty³' => 'b¬', 'mes§ge' => 
	`t
('Please wait...')),

513 '#subm™' => 
	`¬¿y
('node_form_submit_build_node'),

517  
$fÜm
;

518 
	}
}

525 
funùiÚ
 
	$theme_u¶ßd_fÜm_cu¼’t
(
$fÜm
) {

526 
$h—d”
 = 
	`¬¿y
('', 
	`t
('Delete'),('List'),('Description'),('Weight'),('Size'));

527 
	`dru·l_add_bËd¿g
('upload-attachments', 'order', 'sibling', 'upload-weight');

529 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$key
) {

531 
$fÜm
[
$key
]['weight']['#attributes']['class'] = 'upload-weight';

533 
$row
 = 
	`¬¿y
('');

534 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
[
$key
]['remove']);

535 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
[
$key
]['list']);

536 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
[
$key
]['description']);

537 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
[
$key
]['weight']);

538 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
[
$key
]['size']);

539 
$rows
[] = 
	`¬¿y
('d©a' => 
$row
, 'class' => 'draggable');

541 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('id' => 'upload-attachments'));

542 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

543  
$ouut
;

544 
	}
}

552 
funùiÚ
 
	$theme_u¶ßd_fÜm_Ãw
(
$fÜm
) {

553 
	`dru·l_add_bËd¿g
('upload-attachments', 'order', 'sibling', 'upload-weight');

554 
$ouut
 = 
	`dru·l_»nd”
(
$fÜm
);

555  
$ouut
;

556 
	}
}

558 
funùiÚ
 
	$u¶ßd_lßd
(
$node
) {

559 
$fes
 = 
	`¬¿y
();

561 ià(
$node
->
vid
) {

562 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {fes} f INNER JOIN {u¶ßd}„ ON f.fid =„.fid WHERE„.vid = %d ORDER BY„.weight, f.fid', 
$node
->
vid
);

563 
$fe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

564 
$fes
[
$fe
->
fid
] = $file;

568  
$fes
;

569 
	}
}

574 
funùiÚ
 
	$u¶ßd_js
() {

575 
$ÿched_fÜm_¡©e
 = 
	`¬¿y
();

576 
$fes
 = 
	`¬¿y
();

579 ià(!(
$ÿched_fÜm
 = 
	`fÜm_g‘_ÿche
(
$_POST
['fÜm_bud_id'], 
$ÿched_fÜm_¡©e
)è|| !
	`is£t
($cached_form['#node']) || !isset($cached_form['attachments'])) {

580 
	`fÜm_£t_”rÜ
('fÜm_tok’', 
	`t
('Validationƒrror,…leasery‡gain. Ifhisƒrror…ersists,…lease contacthe site‡dministrator.'));

581 
$ouut
 = 
	`theme
('status_messages');

582 
´št
 
	`dru·l_to_js
(
	`¬¿y
('¡©us' => 
TRUE
, 'd©a' => 
$ouut
));

583 
	`ex™
();

586 
$fÜm_¡©e
 = 
	`¬¿y
('v®ues' => 
$_POST
);

589 
	`u¶ßd_node_fÜm_subm™
(
$ÿched_fÜm
, 
$fÜm_¡©e
);

591 if(!
	`em±y
(
$fÜm_¡©e
['values']['files'])) {

592 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['fes'] 
as
 
$fid
 => 
$fe
) {

593 ià(
	`is£t
(
$ÿched_fÜm
['#node']->
fes
[
$fid
])) {

594 
$fes
[
$fid
] = 
$ÿched_fÜm
['#node']->
fes
[$fid];

599 
$node
 = 
$ÿched_fÜm
['#node'];

601 
$node
->
fes
 = 
$fes
;

603 
$fÜm
 = 
	`_u¶ßd_fÜm
(
$node
);

605 
	`un£t
(
$ÿched_fÜm
['attachments']['wrapper']['new']);

606 
$ÿched_fÜm
['©chm’ts']['w¿µ”'] = 
	`¬¿y_m”ge
($ÿched_fÜm['©chm’ts']['w¿µ”'], 
$fÜm
);

608 
$ÿched_fÜm
['©chm’ts']['#cŞÏp£d'] = 
FALSE
;

610 
	`fÜm_£t_ÿche
(
$_POST
['fÜm_bud_id'], 
$ÿched_fÜm
, 
$ÿched_fÜm_¡©e
);

612 
	`fÜ—ch
 (
$fes
 
as
 
$fid
 => 
$fe
) {

613 ià(
	`is_num”ic
(
$fid
)) {

614 
$fÜm
['fes'][
$fid
]['desütiÚ']['#deçuÉ_v®ue'] = 
$fÜm_¡©e
['values']['files'][$fid]['description'];

615 
$fÜm
['fes'][
$fid
]['li¡']['#deçuÉ_v®ue'] = !
	`em±y
(
$fÜm_¡©e
['values']['files'][$fid]['list']);

616 
$fÜm
['fes'][
$fid
]['»move']['#deçuÉ_v®ue'] = !
	`em±y
(
$fÜm_¡©e
['values']['files'][$fid]['remove']);

617 
$fÜm
['fes'][
$fid
]['weight']['#deçuÉ_v®ue'] = 
$fÜm_¡©e
['values']['files'][$fid]['weight'];

622 
$fÜm
 +ğ
	`¬¿y
(

623 '#po¡' => 
$_POST
,

624 '#´og¿mmed' => 
FALSE
,

625 '#Œ“' => 
FALSE
,

626 '#·»Ás' => 
	`¬¿y
(),

628 
	`dru·l_®‹r
('fÜm', 
$fÜm
, 
	`¬¿y
(), 'upload_js');

629 
$fÜm_¡©e
 = 
	`¬¿y
('subm™‹d' => 
FALSE
);

630 
$fÜm
 = 
	`fÜm_bud”
('u¶ßd_js', $fÜm, 
$fÜm_¡©e
);

631 
$ouut
 = 
	`theme
('¡©us_mes§ges'è. 
	`dru·l_»nd”
(
$fÜm
);

636 
´št
 
	`dru·l_to_js
(
	`¬¿y
('¡©us' => 
TRUE
, 'd©a' => 
$ouut
));

637 
ex™
;

638 
	}
}

	@/srv/http/subs/notes/www/modules/user/user-picture.tpl.php

1 <?
	gphp


18 <
div
 
	gşass
="picture">

19 <?
php
 
´št
 
$piùu»
; ?>

20 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/user/user-profile-category.tpl.php

1 <?
	gphp


28 <?
php
 ià(
	g$t™Ë
) : ?>

29 <
h3
><?
php
 
´št
 
$t™Ë
; ?></
	gh3
>

30 <?
php
 
	g’dif
; ?>

32 <
	gdl
<?
php
 
´št
 
	g$©Œibu‹s
; ?>>

33 <?
php
 
´št
 
	g$´ofe_™ems
; ?>

34 </
	gdl
>

	@/srv/http/subs/notes/www/modules/user/user-profile-item.tpl.php

1 <?
	gphp


26 <
	gdt
<?
php
 
´št
 
	g$©Œibu‹s
; ?>><?ph°´šˆ
	g$t™Ë
; ?></dt>

27 <
	gdd
<?
php
 
´št
 
	g$©Œibu‹s
; ?>><?ph°´šˆ
	g$v®ue
; ?></dd>

	@/srv/http/subs/notes/www/modules/user/user-profile.tpl.php

1 <?
	gphp


44 <
div
 
	gşass
="profile">

45 <?
php
 
´št
 
$u£r_´ofe
; ?>

46 </
	gdiv
>

	@/srv/http/subs/notes/www/modules/user/user.admin.inc

1 <?
php


9 
funùiÚ
 
u£r_admš
(
$ÿÎback_¬g
 = '') {

10 
$İ
 = 
is£t
(
$_POST
['İ']è? $_POST['İ'] : 
$ÿÎback_¬g
;

12 
	g$İ
) {

13 
t
('Create‚ew‡ccount'):

15 
$ouut
 = 
dru·l_g‘_fÜm
('user_register');

18 ià(!
em±y
(
$_POST
['accouÁs']è&& 
is£t
($_POST['operation']) && ($_POST['operation'] == 'delete')) {

19 
$ouut
 = 
dru·l_g‘_fÜm
('user_multiple_delete_confirm');

22 
	g$ouut
 = 
dru·l_g‘_fÜm
('user_filter_form');

23 
	g$ouut
 .ğ
dru·l_g‘_fÜm
('user_admin_account');

26  
	g$ouut
;

35 
funùiÚ
 
	$u£r_f‹r_fÜm
() {

36 
$£ssiÚ
 = &
$_SESSION
['user_overview_filter'];

37 
$£ssiÚ
 = 
	`is_¬¿y
($£ssiÚè? $£ssiÚ : 
	`¬¿y
();

38 
$f‹rs
 = 
	`u£r_f‹rs
();

40 
$i
 = 0;

41 
$fÜm
['f‹rs'] = 
	`¬¿y
(

43 '#t™Ë' => 
	`t
('Show only users where'),

46 
	`fÜ—ch
 (
$£ssiÚ
 
as
 
$f‹r
) {

47 
	`li¡
(
$ty³
, 
$v®ue
èğ
$f‹r
;

49 
$İtiÚs
 = 
$ty³
 =ğ'³rmissiÚ' ? 
	`ÿÎ_u£r_func_¬¿y
('¬¿y_m”ge', 
$f‹rs
[$type]['options']) : $filters[$type]['options'];

50 
$·¿ms
 = 
	`¬¿y
('%´İ”ty' => 
$f‹rs
[
$ty³
]['t™Ë'] , '%v®ue' => 
$İtiÚs
[
$v®ue
]);

51 ià(
$i
++ > 0) {

52 
$fÜm
['f‹rs']['cu¼’t'][] = 
	`¬¿y
('#v®ue' => 
	`t
('<em>ªd</em> wh”<¡rÚg>%´İ”ty</¡rÚg> i <¡rÚg>%v®ue</¡rÚg>', 
$·¿ms
));

55 
$fÜm
['f‹rs']['cu¼’t'][] = 
	`¬¿y
('#v®ue' => 
	`t
('<¡rÚg>%´İ”ty</¡rÚg> i <¡rÚg>%v®ue</¡rÚg>', 
$·¿ms
));

59 
	`fÜ—ch
 (
$f‹rs
 
as
 
$key
 => 
$f‹r
) {

60 
$Çmes
[
$key
] = 
$f‹r
['title'];

61 
$fÜm
['f‹rs']['¡©us'][
$key
] = 
	`¬¿y
(

63 '#İtiÚs' => 
$f‹r
['options'],

67 
$fÜm
['f‹rs']['f‹r'] = 
	`¬¿y
(

69 '#İtiÚs' => 
$Çmes
,

71 
$fÜm
['f‹rs']['bu‰Ús']['subm™'] = 
	`¬¿y
(

73 '#v®ue' => (
	`couÁ
(
$£ssiÚ
è? 
	`t
('Refine') :('Filter')),

75 ià(
	`couÁ
(
$£ssiÚ
)) {

76 
$fÜm
['f‹rs']['bu‰Ús']['undo'] = 
	`¬¿y
(

78 '#v®ue' => 
	`t
('Undo'),

80 
$fÜm
['f‹rs']['bu‰Ús']['»£t'] = 
	`¬¿y
(

82 '#v®ue' => 
	`t
('Reset'),

86 
	`dru·l_add_js
('misc/form.js', 'core');

88  
$fÜm
;

89 
	}
}

94 
funùiÚ
 
	$u£r_f‹r_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

95 
$İ
 = 
$fÜm_¡©e
['values']['op'];

96 
$f‹rs
 = 
	`u£r_f‹rs
();

97 
$İ
) {

98 
	`t
('Filter'): t('Refine'):

99 ià(
	`is£t
(
$fÜm_¡©e
['values']['filter'])) {

100 
$f‹r
 = 
$fÜm_¡©e
['values']['filter'];

102 
$İtiÚs
 = 
$f‹r
 =ğ'³rmissiÚ' ? 
	`ÿÎ_u£r_func_¬¿y
('¬¿y_m”ge', 
$f‹rs
[$filter]['options']) : $filters[$filter]['options'];

103 ià(
	`is£t
(
$İtiÚs
[
$fÜm_¡©e
['v®ues'][
$f‹r
]])) {

104 
$_SESSION
['u£r_ov”v›w_f‹r'][] = 
	`¬¿y
(
$f‹r
, 
$fÜm_¡©e
['values'][$filter]);

108 
	`t
('Undo'):

109 
	`¬¿y_pİ
(
$_SESSION
['user_overview_filter']);

111 
	`t
('Reset'):

112 
$_SESSION
['u£r_ov”v›w_f‹r'] = 
	`¬¿y
();

114 
	`t
('Update'):

118 
$fÜm_¡©e
['redirect'] = 'admin/user/user';

120 
	}
}

129 
funùiÚ
 
	$u£r_admš_accouÁ
() {

130 
$f‹r
 = 
	`u£r_bud_f‹r_qu”y
();

132 
$h—d”
 = 
	`¬¿y
(

133 
	`¬¿y
(),

134 
	`¬¿y
('d©a' => 
	`t
('Username'), 'field' => 'u.name'),

135 
	`¬¿y
('d©a' => 
	`t
('Status'), 'field' => 'u.status'),

136 
	`t
('Roles'),

137 
	`¬¿y
('d©a' => 
	`t
('Member for'), 'field' => 'u.created', 'sort' => 'desc'),

138 
	`¬¿y
('d©a' => 
	`t
('Last‡ccess'), 'field' => 'u.access'),

139 
	`t
('Operations')

142 ià(
$f‹r
['join'] != "") {

143 
$sql
 = 'SELECT DISTINCT u.uid, u.Çme, u.¡©us, u.ü—‹d, u.acûs FROM {u£rs} u LEFT JOIN {u£rs_rŞes} u¸ON u.uid = ur.uid '. 
$f‹r
['join'] .' WHERE u.uid != 0 '. $filter['where'];

144 
$qu”y_couÁ
 = 'SELECT COUNT(DISTINCT u.uidèFROM {u£rs} u LEFT JOIN {u£rs_rŞes} u¸ON u.uid = ur.uid '. 
$f‹r
['join'] .' WHERE u.uid != 0 '. $filter['where'];

147 
$sql
 = 'SELECT u.uid, u.Çme, u.¡©us, u.ü—‹d, u.acûs FROM {u£rs} u WHERE u.uid !ğ0 '. 
$f‹r
['where'];

148 
$qu”y_couÁ
 = 'SELECT COUNT(u.uidèFROM {u£rs} u WHERE u.uid !ğ0 '. 
$f‹r
['where'];

152 
$sql
 .ğ
	`bËsÜt_sql
(
$h—d”
);

154 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
, 50, 0, 
$qu”y_couÁ
, 
$f‹r
['args']);

156 
$fÜm
['İtiÚs'] = 
	`¬¿y
(

158 '#t™Ë' => 
	`t
('Update options'),

162 
$İtiÚs
 = 
	`¬¿y
();

163 
	`fÜ—ch
 (
	`moduË_švoke_®l
('u£r_İ”©iÚs'è
as
 
$İ”©iÚ
 => 
$¬¿y
) {

164 
$İtiÚs
[
$İ”©iÚ
] = 
$¬¿y
['label'];

166 
$fÜm
['İtiÚs']['İ”©iÚ'] = 
	`¬¿y
(

168 '#İtiÚs' => 
$İtiÚs
,

171 
$fÜm
['İtiÚs']['subm™'] = 
	`¬¿y
(

173 '#v®ue' => 
	`t
('Update'),

176 
$de¡š©iÚ
 = 
	`dru·l_g‘_de¡š©iÚ
();

178 
$¡©us
 = 
	`¬¿y
(
	`t
('blocked'),('active'));

179 
$rŞes
 = 
	`u£r_rŞes
(
TRUE
);

180 
$accouÁs
 = 
	`¬¿y
();

181 
$accouÁ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

182 
$accouÁs
[
$accouÁ
->
uid
] = '';

183 
$fÜm
['Çme'][
$accouÁ
->
uid
] = 
	`¬¿y
('#v®ue' => 
	`theme
('username', $account));

184 
$fÜm
['¡©us'][
$accouÁ
->
uid
] = 
	`¬¿y
('#v®ue' => 
$¡©us
[$accouÁ->
¡©us
]);

185 
$u£rs_rŞes
 = 
	`¬¿y
();

186 
$rŞes_»suÉ
 = 
	`db_qu”y
('SELECT„id FROM {u£rs_rŞes} WHERE uid = %d', 
$accouÁ
->
uid
);

187 
$u£r_rŞe
 = 
	`db_ãtch_objeù
(
$rŞes_»suÉ
)) {

188 
$u£rs_rŞes
[] = 
$rŞes
[
$u£r_rŞe
->
rid
];

190 
	`asÜt
(
$u£rs_rŞes
);

191 
$fÜm
['rŞes'][
$accouÁ
->
uid
][0] = 
	`¬¿y
('#v®ue' => 
	`theme
('™em_li¡', 
$u£rs_rŞes
));

192 
$fÜm
['memb”_fÜ'][
$accouÁ
->
uid
] = 
	`¬¿y
('#v®ue' => 
	`fÜm©_š‹rv®
(
	`time
(è- $accouÁ->
ü—‹d
));

193 
$fÜm
['Ï¡_acûss'][
$accouÁ
->
uid
] = 
	`¬¿y
('#v®ue' => $accouÁ->
acûss
 ? 
	`t
('@timago',‡¼ay('@time' => 
	`fÜm©_š‹rv®
(
	`time
() - $account->access))) :('never'));

194 
$fÜm
['İ”©iÚs'][
$accouÁ
->
uid
] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('ed™'), "u£r/$accouÁ->uid/ed™",‡¼ay('qu”y' => 
$de¡š©iÚ
)));

196 
$fÜm
['accouÁs'] = 
	`¬¿y
(

198 '#İtiÚs' => 
$accouÁs


200 
$fÜm
['·g”'] = 
	`¬¿y
('#v®ue' => 
	`theme
('·g”', 
NULL
, 50, 0));

202  
$fÜm
;

203 
	}
}

208 
funùiÚ
 
	$u£r_admš_accouÁ_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

209 
$İ”©iÚs
 = 
	`moduË_švoke_®l
('u£r_İ”©iÚs', 
$fÜm_¡©e
);

210 
$İ”©iÚ
 = 
$İ”©iÚs
[
$fÜm_¡©e
['values']['operation']];

212 
$accouÁs
 = 
	`¬¿y_f‹r
(
$fÜm_¡©e
['values']['accounts']);

213 ià(
$funùiÚ
 = 
$İ”©iÚ
['callback']) {

215 ià(
	`is£t
(
$İ”©iÚ
['callback‡rguments'])) {

216 
$¬gs
 = 
	`¬¿y_m”ge
(
	`¬¿y
(
$accouÁs
), 
$İ”©iÚ
['callback‡rguments']);

219 
$¬gs
 = 
	`¬¿y
(
$accouÁs
);

221 
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
$¬gs
);

223 
	`dru·l_£t_mes§ge
(
	`t
('The update has been…erformed.'));

225 
	}
}

227 
funùiÚ
 
	$u£r_admš_accouÁ_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

228 
$fÜm_¡©e
['v®ues']['accouÁs'] = 
	`¬¿y_f‹r
($form_state['values']['accounts']);

229 ià(
	`couÁ
(
$fÜm_¡©e
['values']['accounts']) == 0) {

230 
	`fÜm_£t_”rÜ
('', 
	`t
('No users selected.'));

232 
	}
}

240 
funùiÚ
 
	$u£r_admš_£‰šgs
() {

242 
$fÜm
['»gi¡¿tiÚ'] = 
	`¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
	`t
('User„egistration settings'));

243 
$fÜm
['»gi¡¿tiÚ']['u£r_»gi¡”'] = 
	`¬¿y
('#ty³' => '¿dios', '#t™Ë' => 
	`t
('Publiø»gi¡¿tiÚs'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('user_register', 1), '#options' =>‡rray(t('Only site‡dministrators can create‚ew user‡ccounts.'),('Visitors can create‡ccounts‡nd‚o‡dministrator‡pproval is„equired.'),('Visitors can create‡ccounts but‡dministrator‡pproval is„equired.')));

244 
$fÜm
['»gi¡¿tiÚ']['u£r_ema_v”ifiÿtiÚ'] = 
	`¬¿y
('#ty³' => 'checkbox', '#t™Ë' => 
	`t
('Requœe-ma v”ifiÿtiÚ wh’‡ vis™Ü c»©e ª‡ccouÁ'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('u£r_ema_v”ifiÿtiÚ', 
TRUE
), '#description' =>('Ifhis box is checked,‚ew users will be„equiredo validateheirƒ-mail‡ddress…rioro†ogging intohe site,‡nd will be‡ssigned‡ system-generated…assword. With it unchecked, users will be†ogged in immediately upon„egistering,‡nd may selectheir own…asswords during„egistration.'));

245 
$fÜm
['»gi¡¿tiÚ']['u£r_»gi¡¿tiÚ_h–p'] = 
	`¬¿y
('#ty³' => '‹x»a', '#t™Ë' => 
	`t
('U£¸»gi¡¿tiÚ guid–šes'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('user_registration_help', ''), '#description' =>('Thisext is displayed‡theop ofhe user„egistration form‡nd is useful for helping or instructing your users.'));

248 
$fÜm
['ema'] = 
	`¬¿y
(

250 '#t™Ë' => 
	`t
('Userƒ-mail settings'),

251 '#desütiÚ' => 
	`t
('Drupal sendsƒmails whenever‚ew users„egister on your site,‡nd optionally, may‡lso‚otify users‡fter other‡ccount‡ctions. Using‡ simple set of contentemplates,‚otificationƒ-mails can be customizedo fithe specific‚eeds of your site.'),

255 
$ema_tok’_h–p
 = 
	`t
('Available variables‡re:') .' !username, !site, !password, !uri, !uri_brief, !mailto, !date, !login_uri, !edit_uri, !login_url.';

257 
$fÜm
['ema']['admš_ü—‹d'] = 
	`¬¿y
(

259 '#t™Ë' => 
	`t
('Welcome,‚ew user created by‡dministrator'),

260 '#cŞÏpsibË' => 
TRUE
,

261 '#cŞÏp£d' => (
	`v¬ŸbË_g‘
('user_register', 1) != 0),

262 '#desütiÚ' => 
	`t
('Cu¡omizw–come-ma mes§ge £ÁØÃw memb”‡ccouÁ ü—‹d by‡Àadmši¡¿tÜ.'è.' '. 
$ema_tok’_h–p
,

264 
$fÜm
['ema']['admš_ü—‹d']['u£r_ma_»gi¡”_admš_ü—‹d_subjeù'] = 
	`¬¿y
(

266 '#t™Ë' => 
	`t
('Subject'),

267 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('register_admin_created_subject'),

270 
$fÜm
['ema']['admš_ü—‹d']['u£r_ma_»gi¡”_admš_ü—‹d_body'] = 
	`¬¿y
(

272 '#t™Ë' => 
	`t
('Body'),

273 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('register_admin_created_body'),

277 
$fÜm
['ema']['no_­´ov®_»quœed'] = 
	`¬¿y
(

279 '#t™Ë' => 
	`t
('Welcome,‚o‡pproval„equired'),

280 '#cŞÏpsibË' => 
TRUE
,

281 '#cŞÏp£d' => (
	`v¬ŸbË_g‘
('user_register', 1) != 1),

282 '#desütiÚ' => 
	`t
('Cu¡omizw–come-ma mes§ge £ÁØÃw memb” upÚ„egi¡”šg, wh’‚Øadmši¡¿tÜ‡µrov® i »quœed.'è.' '. 
$ema_tok’_h–p


284 
$fÜm
['ema']['no_­´ov®_»quœed']['u£r_ma_»gi¡”_no_­´ov®_»quœed_subjeù'] = 
	`¬¿y
(

286 '#t™Ë' => 
	`t
('Subject'),

287 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('register_no_approval_required_subject'),

290 
$fÜm
['ema']['no_­´ov®_»quœed']['u£r_ma_»gi¡”_no_­´ov®_»quœed_body'] = 
	`¬¿y
(

292 '#t™Ë' => 
	`t
('Body'),

293 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('register_no_approval_required_body'),

297 
$fÜm
['ema']['³ndšg_­´ov®'] = 
	`¬¿y
(

299 '#t™Ë' => 
	`t
('Welcome,‡waiting‡dministrator‡pproval'),

300 '#cŞÏpsibË' => 
TRUE
,

301 '#cŞÏp£d' => (
	`v¬ŸbË_g‘
('user_register', 1) != 2),

302 '#desütiÚ' => 
	`t
('Cu¡omizw–come-ma mes§ge £ÁØÃw memb” upÚ„egi¡”šg, wh’‡dmši¡¿tiv­´ov® i »quœed.'è.' '. 
$ema_tok’_h–p
,

304 
$fÜm
['ema']['³ndšg_­´ov®']['u£r_ma_»gi¡”_³ndšg_­´ov®_subjeù'] = 
	`¬¿y
(

306 '#t™Ë' => 
	`t
('Subject'),

307 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('register_pending_approval_subject'),

310 
$fÜm
['ema']['³ndšg_­´ov®']['u£r_ma_»gi¡”_³ndšg_­´ov®_body'] = 
	`¬¿y
(

312 '#t™Ë' => 
	`t
('Body'),

313 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('register_pending_approval_body'),

317 
$fÜm
['ema']['·sswÜd_»£t'] = 
	`¬¿y
(

319 '#t™Ë' => 
	`t
('Password„ecoveryƒmail'),

320 '#cŞÏpsibË' => 
TRUE
,

321 '#cŞÏp£d' => 
TRUE
,

322 '#desütiÚ' => 
	`t
('Cu¡omize-ma mes§ge £ÁØu£r whØ»que¡‡‚ew…asswÜd.'è.' '. 
$ema_tok’_h–p
,

324 
$fÜm
['ema']['·sswÜd_»£t']['u£r_ma_·sswÜd_»£t_subjeù'] = 
	`¬¿y
(

326 '#t™Ë' => 
	`t
('Subject'),

327 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('password_reset_subject'),

330 
$fÜm
['ema']['·sswÜd_»£t']['u£r_ma_·sswÜd_»£t_body'] = 
	`¬¿y
(

332 '#t™Ë' => 
	`t
('Body'),

333 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('password_reset_body'),

337 
$fÜm
['ema']['aùiv©ed'] = 
	`¬¿y
(

339 '#t™Ë' => 
	`t
('Account‡ctivationƒmail'),

340 '#cŞÏpsibË' => 
TRUE
,

341 '#cŞÏp£d' => 
TRUE
,

342 '#desütiÚ' => 
	`t
('EÇbË‡nd cu¡omize-ma mes§ge £ÁØu£r upÚ‡ccouÁ‡ùiv©iÚ (wh’‡Àadmši¡¿tÜ‡ùiv©e ª‡ccouÁ oà¨u£¸whØha ®»ady„egi¡”ed, oÀ¨s™wh”admši¡¿tiv­´ov® i »quœed).'è.' '. 
$ema_tok’_h–p
,

344 
$fÜm
['ema']['aùiv©ed']['u£r_ma_¡©us_aùiv©ed_nÙify'] = 
	`¬¿y
(

346 '#t™Ë' => 
	`t
('Notify user when‡ccount is‡ctivated.'),

347 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('u£r_ma_¡©us_aùiv©ed_nÙify', 
TRUE
),

349 
$fÜm
['ema']['aùiv©ed']['u£r_ma_¡©us_aùiv©ed_subjeù'] = 
	`¬¿y
(

351 '#t™Ë' => 
	`t
('Subject'),

352 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('status_activated_subject'),

355 
$fÜm
['ema']['aùiv©ed']['u£r_ma_¡©us_aùiv©ed_body'] = 
	`¬¿y
(

357 '#t™Ë' => 
	`t
('Body'),

358 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('status_activated_body'),

362 
$fÜm
['ema']['blocked'] = 
	`¬¿y
(

364 '#t™Ë' => 
	`t
('Account blockedƒmail'),

365 '#cŞÏpsibË' => 
TRUE
,

366 '#cŞÏp£d' => 
TRUE
,

367 '#desütiÚ' => 
	`t
('EÇbË‡nd cu¡omize-ma mes§ge £ÁØu£r wh’heœ‡ccouÁ ¬blocked.'è.' '. 
$ema_tok’_h–p
,

369 
$fÜm
['ema']['blocked']['u£r_ma_¡©us_blocked_nÙify'] = 
	`¬¿y
(

371 '#t™Ë' => 
	`t
('Notify user when‡ccount is blocked.'),

372 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('u£r_ma_¡©us_blocked_nÙify', 
FALSE
),

374 
$fÜm
['ema']['blocked']['u£r_ma_¡©us_blocked_subjeù'] = 
	`¬¿y
(

376 '#t™Ë' => 
	`t
('Subject'),

377 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('status_blocked_subject'),

380 
$fÜm
['ema']['blocked']['u£r_ma_¡©us_blocked_body'] = 
	`¬¿y
(

382 '#t™Ë' => 
	`t
('Body'),

383 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('status_blocked_body'),

387 
$fÜm
['ema']['d–‘ed'] = 
	`¬¿y
(

389 '#t™Ë' => 
	`t
('Account deletedƒmail'),

390 '#cŞÏpsibË' => 
TRUE
,

391 '#cŞÏp£d' => 
TRUE
,

392 '#desütiÚ' => 
	`t
('EÇbË‡nd cu¡omize-ma mes§ge £ÁØu£r wh’heœ‡ccouÁ ¬d–‘ed.'è.' '. 
$ema_tok’_h–p
,

394 
$fÜm
['ema']['d–‘ed']['u£r_ma_¡©us_d–‘ed_nÙify'] = 
	`¬¿y
(

396 '#t™Ë' => 
	`t
('Notify user when‡ccount is deleted.'),

397 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('u£r_ma_¡©us_d–‘ed_nÙify', 
FALSE
),

399 
$fÜm
['ema']['d–‘ed']['u£r_ma_¡©us_d–‘ed_subjeù'] = 
	`¬¿y
(

401 '#t™Ë' => 
	`t
('Subject'),

402 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('status_deleted_subject'),

405 
$fÜm
['ema']['d–‘ed']['u£r_ma_¡©us_d–‘ed_body'] = 
	`¬¿y
(

407 '#t™Ë' => 
	`t
('Body'),

408 '#deçuÉ_v®ue' => 
	`_u£r_ma_‹xt
('status_deleted_body'),

413 
$fÜm
['sigÇtu»s'] = 
	`¬¿y
(

415 '#t™Ë' => 
	`t
('Signatures'),

417 
$fÜm
['sigÇtu»s']['u£r_sigÇtu»s'] = 
	`¬¿y
(

419 '#t™Ë' => 
	`t
('Signature support'),

420 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('user_signatures', 0),

421 '#İtiÚs' => 
	`¬¿y
(
	`t
('Disabled'),('Enabled')),

425 ià(
	`v¬ŸbË_g‘
('user_pictures', 0)) {

426 
$piùu»_·th
 = 
	`fe_ü—‹_·th
(
	`v¬ŸbË_g‘
('user_picture_path', 'pictures'));

427 
	`fe_check_dœeùÜy
(
$piùu»_·th
, 1, 'user_picture_path');

430 
$fÜm
['piùu»s'] = 
	`¬¿y
(

432 '#t™Ë' => 
	`t
('Pictures'),

434 
$piùu»_suµÜt
 = 
	`v¬ŸbË_g‘
('user_pictures', 0);

435 
$fÜm
['piùu»s']['u£r_piùu»s'] = 
	`¬¿y
(

437 '#t™Ë' => 
	`t
('Picture support'),

438 '#deçuÉ_v®ue' => 
$piùu»_suµÜt
,

439 '#İtiÚs' => 
	`¬¿y
(
	`t
('Disabled'),('Enabled')),

443 
	`dru·l_add_js
(
	`dru·l_g‘_·th
('module', 'user') .'/user.js');

447 
$css_şass
 = 'user-admin-picture-settings';

448 ià(!
$piùu»_suµÜt
) {

449 
$css_şass
 .= ' js-hide';

451 
$fÜm
['piùu»s']['£‰šgs'] = 
	`¬¿y
(

452 '#´efix' => '<div cÏss="'. 
$css_şass
 .'">',

455 
$fÜm
['piùu»s']['£‰šgs']['u£r_piùu»_·th'] = 
	`¬¿y
(

457 '#t™Ë' => 
	`t
('Picture image…ath'),

458 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('user_picture_path', 'pictures'),

461 '#desütiÚ' => 
	`t
('SubdœeùÜy iÀthdœeùÜy %dœ wh”piùu» wÈb¡Üed.', 
	`¬¿y
('%dœ' => 
	`fe_dœeùÜy_·th
() .'/')),

463 
$fÜm
['piùu»s']['£‰šgs']['u£r_piùu»_deçuÉ'] = 
	`¬¿y
(

465 '#t™Ë' => 
	`t
('Default…icture'),

466 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('user_picture_default', ''),

469 '#desütiÚ' => 
	`t
('URL of…ictureo display for users with‚o custom…icture selected. Leave blank for‚one.'),

471 
$fÜm
['piùu»s']['£‰šgs']['u£r_piùu»_dim’siÚs'] = 
	`¬¿y
(

473 '#t™Ë' => 
	`t
('Picture maximum dimensions'),

474 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('user_picture_dimensions', '85x85'),

477 '#desütiÚ' => 
	`t
('Maximum dimensions for…ictures, in…ixels.'),

479 
$fÜm
['piùu»s']['£‰šgs']['u£r_piùu»_fe_size'] = 
	`¬¿y
(

481 '#t™Ë' => 
	`t
('Picture maximum file size'),

482 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('user_picture_file_size', '30'),

485 '#desütiÚ' => 
	`t
('Maximum file size for…ictures, in kB.'),

487 
$fÜm
['piùu»s']['£‰šgs']['u£r_piùu»_guid–šes'] = 
	`¬¿y
(

489 '#t™Ë' => 
	`t
('Picture guidelines'),

490 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('user_picture_guidelines', ''),

491 '#desütiÚ' => 
	`t
("Thisext is displayed‡the…icture upload form in‡dditionohe default guidelines. It's useful for helping or instructing your users."),

494  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

495 
	}
}

504 
funùiÚ
 
	$u£r_admš_³rm
(
$fÜm_¡©e
, 
$rid
 = 
NULL
) {

505 ià(
	`is_num”ic
(
$rid
)) {

506 
$»suÉ
 = 
	`db_qu”y
('SELECT„.rid,….³rm FROM {rŞe}„ LEFT JOIN {³rmissiÚ}… ON„.rid =….rid WHERE„.rid = %d', 
$rid
);

509 
$»suÉ
 = 
	`db_qu”y
('SELECT„.rid,….perm FROM {role}„ LEFT JOIN {permission}… ON„.rid =….rid ORDER BY‚ame');

516 
$rŞe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

517 
$rŞe_³rmissiÚs
[
$rŞe
->
rid
] = $rŞe->
³rm
 .',';

521 
$rŞe_Çmes
 = 
	`u£r_rŞes
();

522 ià(
	`is_num”ic
(
$rid
)) {

523 
$rŞe_Çmes
 = 
	`¬¿y
(
$rid
 => $role_names[$rid]);

527 
$İtiÚs
 = 
	`¬¿y
();

528 
	`fÜ—ch
 (
	`moduË_li¡
(
FALSE
, FALSE, 
TRUE
è
as
 
$moduË
) {

529 ià(
$³rmissiÚs
 = 
	`moduË_švoke
(
$moduË
, 'perm')) {

530 
$fÜm
['³rmissiÚ'][] = 
	`¬¿y
(

531 '#v®ue' => 
$moduË
,

533 
	`asÜt
(
$³rmissiÚs
);

534 
	`fÜ—ch
 (
$³rmissiÚs
 
as
 
$³rm
) {

535 
$İtiÚs
[
$³rm
] = '';

536 
$fÜm
['³rmissiÚ'][
$³rm
] = 
	`¬¿y
('#v®ue' => 
	`t
($perm));

537 
	`fÜ—ch
 (
$rŞe_Çmes
 
as
 
$rid
 => 
$Çme
) {

539 ià(
	`¡½os
(
$rŞe_³rmissiÚs
[
$rid
], 
$³rm
 .','è!=ğ
FALSE
) {

540 
$¡©us
[
$rid
][] = 
$³rm
;

548 
	`fÜ—ch
 (
$rŞe_Çmes
 
as
 
$rid
 => 
$Çme
) {

549 
$fÜm
['checkboxes'][
$rid
] = 
	`¬¿y
('#ty³' => 'checkboxes', '#İtiÚs' => 
$İtiÚs
, '#deçuÉ_v®ue' => 
	`is£t
(
$¡©us
[$rid]) ? $status[$rid] :‡rray());

550 
$fÜm
['rŞe_Çmes'][
$rid
] = 
	`¬¿y
('#v®ue' => 
$Çme
, '#Œ“' => 
TRUE
);

552 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save…ermissions'));

554  
$fÜm
;

555 
	}
}

557 
funùiÚ
 
	$u£r_admš_³rm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

559 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {role}');

560 
$rŞe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

561 ià(
	`is£t
(
$fÜm_¡©e
['v®ues'][
$rŞe
->
rid
])) {

564 
	`db_qu”y
('DELETE FROM {³rmissiÚ} WHERE„id = %d', 
$rŞe
->
rid
);

565 
$fÜm_¡©e
['v®ues'][
$rŞe
->
rid
] = 
	`¬¿y_f‹r
($form_state['values'][$role->rid]);

566 ià(
	`couÁ
(
$fÜm_¡©e
['v®ues'][
$rŞe
->
rid
])) {

567 
	`db_qu”y
("INSERT INTO {³rmissiÚ} (rid,…”mèVALUES (%d, '%s')", 
$rŞe
->
rid
, 
	`im¶ode
(', ', 
	`¬¿y_keys
(
$fÜm_¡©e
['values'][$role->rid])));

572 
	`dru·l_£t_mes§ge
(
	`t
('The changes have been saved.'));

575 
	`ÿche_ş—r_®l
();

576 
	}
}

583 
funùiÚ
 
	$theme_u£r_admš_³rm
(
$fÜm
) {

584 
$rŞes
 = 
	`u£r_rŞes
();

585 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['³rmissiÚ']è
as
 
$key
) {

587 ià(
	`is_¬¿y
(
$fÜm
['³rmissiÚ'][
$key
])) {

588 
$row
 = 
	`¬¿y
();

590 ià(
	`is_num”ic
(
$key
)) {

591 
$row
[] = 
	`¬¿y
('d©a' => 
	`t
('@moduË moduË',‡¼ay('@moduË' => 
	`dru·l_»nd”
(
$fÜm
['³rmissiÚ'][
$key
]))), 'şass' => 'moduË', 'id' => 'moduË-'. $fÜm['³rmissiÚ'][$key]['#v®ue'], 'cŞ¥ª' => 
	`couÁ
($form['role_names']) + 1);

594 
$row
[] = 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
['³rmissiÚ'][
$key
]), 'class' => 'permission');

595 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['checkboxes']è
as
 
$rid
) {

596 ià(
	`is_¬¿y
(
$fÜm
['checkboxes'][
$rid
])) {

597 
$row
[] = 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
['checkboxes'][
$rid
][
$key
]), 'şass' => 'checkbox', 't™Ë' => 
$rŞes
[$rid] .' : '. 
	`t
($key));

601 
$rows
[] = 
$row
;

604 
$h—d”
[] = (
	`t
('Permission'));

605 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['rŞe_Çmes']è
as
 
$rid
) {

606 ià(
	`is_¬¿y
(
$fÜm
['rŞe_Çmes'][
$rid
])) {

607 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`dru·l_»nd”
(
$fÜm
['rŞe_Çmes'][
$rid
]), 'class' => 'checkbox');

610 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('id' => 'permissions'));

611 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

612  
$ouut
;

613 
	}
}

623 
funùiÚ
 
	$u£r_admš_rŞe
() {

624 
$rid
 = 
	`¬g
(4);

625 ià(
$rid
) {

626 ià(
$rid
 =ğ
DRUPAL_ANONYMOUS_RID
 || $rid =ğ
DRUPAL_AUTHENTICATED_RID
) {

627 
	`dru·l_gÙo
('admin/user/roles');

630 
$rŞe
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT * FROM {rŞe} WHERE„id = %d', 
$rid
));

631 
$fÜm
['Çme'] = 
	`¬¿y
(

633 '#t™Ë' => 
	`t
('Role‚ame'),

634 '#deçuÉ_v®ue' => 
$rŞe
->
Çme
,

636 '#»quœed' => 
TRUE
,

638 '#desütiÚ' => 
	`t
('The‚ame forhis„ole. Example: "moderator", "editorial board", "site‡rchitect".'),

640 
$fÜm
['rid'] = 
	`¬¿y
(

642 '#v®ue' => 
$rid
,

644 
$fÜm
['subm™'] = 
	`¬¿y
(

646 '#v®ue' => 
	`t
('Save„ole'),

648 
$fÜm
['d–‘e'] = 
	`¬¿y
(

650 '#v®ue' => 
	`t
('Delete„ole'),

654 
$fÜm
['Çme'] = 
	`¬¿y
(

659 
$fÜm
['subm™'] = 
	`¬¿y
(

661 '#v®ue' => 
	`t
('Add„ole'),

663 
$fÜm
['#submit'][] = 'user_admin_role_submit';

664 
$fÜm
['#validate'][] = 'user_admin_role_validate';

666  
$fÜm
;

667 
	}
}

669 
funùiÚ
 
	$u£r_admš_rŞe_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

670 ià(
$fÜm_¡©e
['values']['name']) {

671 ià(
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('Save„ole')) {

672 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {rŞe} WHERE‚amğ'%s' AND„id !ğ%d", 
$fÜm_¡©e
['values']['name'], $form_state['values']['rid']))) {

673 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('ThrŞÇm%Çm®»adyƒxi¡s. PËa£ choo£‡nÙh”„ŞÇme.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['name'])));

676 ià(
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('Add„ole')) {

677 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {rŞe} WHERE‚amğ'%s'", 
$fÜm_¡©e
['values']['name']))) {

678 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('ThrŞÇm%Çm®»adyƒxi¡s. PËa£ choo£‡nÙh”„ŞÇme.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['name'])));

683 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('You must specify‡ valid„ole‚ame.'));

685 
	}
}

687 
funùiÚ
 
	$u£r_admš_rŞe_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

688 ià(
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('Save„ole')) {

689 
	`db_qu”y
("UPDATE {rŞe} SET‚amğ'%s' WHERE„id = %d", 
$fÜm_¡©e
['values']['name'], $form_state['values']['rid']);

690 
	`dru·l_£t_mes§ge
(
	`t
('The„ole has been„enamed.'));

692 ià(
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('Delete„ole')) {

693 
	`db_qu”y
('DELETE FROM {rŞe} WHERE„id = %d', 
$fÜm_¡©e
['values']['rid']);

694 
	`db_qu”y
('DELETE FROM {³rmissiÚ} WHERE„id = %d', 
$fÜm_¡©e
['values']['rid']);

696 
	`db_qu”y
('DELETE FROM {u£rs_rŞes} WHERE„id = %d', 
$fÜm_¡©e
['values']['rid']);

698 
	`dru·l_£t_mes§ge
(
	`t
('The„ole has been deleted.'));

700 ià(
$fÜm_¡©e
['v®ues']['İ'] =ğ
	`t
('Add„ole')) {

701 
	`db_qu”y
("INSERT INTO {rŞe} (ÇmeèVALUES ('%s')", 
$fÜm_¡©e
['values']['name']);

702 
	`dru·l_£t_mes§ge
(
	`t
('The„ole has been‡dded.'));

704 
$fÜm_¡©e
['redirect'] = 'admin/user/roles';

706 
	}
}

711 
funùiÚ
 
	$u£r_admš_acûss_check
() {

712 
$ouut
 = 
	`dru·l_g‘_fÜm
('user_admin_check_user');

713 
$ouut
 .ğ
	`dru·l_g‘_fÜm
('user_admin_check_mail');

714 
$ouut
 .ğ
	`dru·l_g‘_fÜm
('user_admin_check_host');

715  
$ouut
;

716 
	}
}

721 
funùiÚ
 
	$u£r_admš_acûss_add
(
$mask
 = 
NULL
, 
$ty³
 = NULL) {

722 
$ed™
 = 
	`¬¿y
();

723 
$ed™
['aid'] = 0;

724 
$ed™
['mask'] = 
$mask
;

725 
$ed™
['ty³'] = 
$ty³
;

726  
	`dru·l_g‘_fÜm
('u£r_admš_acûss_add_fÜm', 
$ed™
, 
	`t
('Add„ule'));

727 
	}
}

732 
funùiÚ
 
	$u£r_admš_acûss_ed™
(
$aid
 = 0) {

733 
$ed™
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
('SELECT‡id,y³, stus, mask FROM {acûss} WHERE‡id = %d', 
$aid
));

734  
	`dru·l_g‘_fÜm
('u£r_admš_acûss_ed™_fÜm', 
$ed™
, 
	`t
('Save„ule'));

735 
	}
}

742 
funùiÚ
 
	$u£r_admš_acûss_fÜm
(&
$fÜm_¡©e
, 
$ed™
, 
$subm™
) {

743 
$fÜm
 = 
	`¬¿y
();

744 
$fÜm
['aid'] = 
	`¬¿y
(

746 '#v®ue' => 
$ed™
['aid'],

748 
$fÜm
['¡©us'] = 
	`¬¿y
(

750 '#t™Ë' => 
	`t
('Accessype'),

751 '#deçuÉ_v®ue' => 
	`is£t
(
$ed™
['status']) ? $edit['status'] : 0,

752 '#İtiÚs' => 
	`¬¿y
('1' => 
	`t
('Allow'), '0' =>('Deny')),

754 
$ty³_İtiÚs
 = 
	`¬¿y
('u£r' => 
	`t
('Username'), 'mail' =>('E-mail'), 'host' =>('Host'));

755 
$fÜm
['ty³'] = 
	`¬¿y
(

757 '#t™Ë' => 
	`t
('Ruleype'),

758 '#deçuÉ_v®ue' => (
	`is£t
(
$ty³_İtiÚs
[
$ed™
['type']]) ? $edit['type'] : 'user'),

759 '#İtiÚs' => 
$ty³_İtiÚs
,

761 
$fÜm
['mask'] = 
	`¬¿y
(

763 '#t™Ë' => 
	`t
('Mask'),

766 '#deçuÉ_v®ue' => 
$ed™
['mask'],

767 '#desütiÚ' => '%: '. 
	`t
('Matches‡ny‚umber of characters,ƒven zero characters') .'.<br />_: '.('Matchesƒxactly one character.'),

768 '#»quœed' => 
TRUE
,

770 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
$subm™
);

771 
$fÜm
['#subm™'] = 
	`¬¿y
('user_admin_access_form_submit');

773  
$fÜm
;

774 
	}
}

779 
funùiÚ
 
	$u£r_admš_acûss_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

780 
$ed™
 = 
$fÜm_¡©e
['values'];

781 ià(
$ed™
['aid']) {

782 
	`db_qu”y
("UPDATE {acûss} SET mask = '%s',y³ = '%s', stu ğ'%s' WHERE‡id = %d", 
$ed™
['mask'], $edit['type'], $edit['status'], $edit['aid']);

783 
	`dru·l_£t_mes§ge
(
	`t
('The‡ccess„ule has been saved.'));

786 
	`db_qu”y
("INSERT INTO {acûss} (mask,y³, stusèVALUES ('%s', '%s', %d)", 
$ed™
['mask'], $edit['type'], $edit['status']);

787 
	`dru·l_£t_mes§ge
(
	`t
('The‡ccess„ule has been‡dded.'));

789 
$fÜm_¡©e
['redirect'] = 'admin/user/rules';

790 
	}
}

792 
funùiÚ
 
	$u£r_admš_acûss_check_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

793 ià(
	`em±y
(
$fÜm_¡©e
['values']['test'])) {

794 
	`fÜm_£t_”rÜ
(
$fÜm_¡©e
['v®ues']['ty³'], 
	`t
('No valueƒntered. Pleaseƒnter‡est string‡ndry‡gain.'));

796 
	}
}

798 
funùiÚ
 
	$u£r_admš_check_u£r
() {

799 
$fÜm
['u£r'] = 
	`¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
	`t
('Username'));

800 
$fÜm
['u£r']['‹¡'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => '', '#desütiÚ' => 
	`t
('EÁ”‡ u£ºamtØcheck ià™ wÈbd’›d o¸®lowed.'), '#size' => 30, '#maxËngth' => 
USERNAME_MAX_LENGTH
);

801 
$fÜm
['u£r']['ty³'] = 
	`¬¿y
('#type' => 'hidden', '#value' => 'user');

802 
$fÜm
['u£r']['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Check username'));

803 
$fÜm
['#submit'][] = 'user_admin_access_check_submit';

804 
$fÜm
['#validate'][] = 'user_admin_access_check_validate';

805 
$fÜm
['#theme'] = 'user_admin_access_check';

806  
$fÜm
;

807 
	}
}

809 
funùiÚ
 
	$u£r_admš_check_ma
() {

810 
$fÜm
['ma'] = 
	`¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
	`t
('E-mail'));

811 
$fÜm
['ma']['‹¡'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => '', '#desütiÚ' => 
	`t
('EÁ”‡Àe-ma‡dd»s tØcheck ià™ wÈbd’›d o¸®lowed.'), '#size' => 30, '#maxËngth' => 
EMAIL_MAX_LENGTH
);

812 
$fÜm
['ma']['ty³'] = 
	`¬¿y
('#type' => 'hidden', '#value' => 'mail');

813 
$fÜm
['ma']['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Checkƒ-mail'));

814 
$fÜm
['#submit'][] = 'user_admin_access_check_submit';

815 
$fÜm
['#validate'][] = 'user_admin_access_check_validate';

816 
$fÜm
['#theme'] = 'user_admin_access_check';

817  
$fÜm
;

818 
	}
}

820 
funùiÚ
 
	$u£r_admš_check_ho¡
() {

821 
$fÜm
['ho¡'] = 
	`¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
	`t
('Hostname'));

822 
$fÜm
['ho¡']['‹¡'] = 
	`¬¿y
('#ty³' => '‹xtf›ld', '#t™Ë' => '', '#desütiÚ' => 
	`t
('Enter‡ hostname or IP‡ddresso check if it will be denied or‡llowed.'), '#size' => 30, '#maxlength' => 64);

823 
$fÜm
['ho¡']['ty³'] = 
	`¬¿y
('#type' => 'hidden', '#value' => 'host');

824 
$fÜm
['ho¡']['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Check hostname'));

825 
$fÜm
['#submit'][] = 'user_admin_access_check_submit';

826 
$fÜm
['#validate'][] = 'user_admin_access_check_validate';

827 
$fÜm
['#theme'] = 'user_admin_access_check';

828  
$fÜm
;

829 
	}
}

831 
funùiÚ
 
	$u£r_admš_acûss_check_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

832 
$fÜm_¡©e
['values']['type']) {

834 ià(
	`dru·l_is_d’›d
('u£r', 
$fÜm_¡©e
['values']['test'])) {

835 
	`dru·l_£t_mes§ge
(
	`t
('Thu£ºam%Çmi nÙ‡Îowed.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['test'])));

838 
	`dru·l_£t_mes§ge
(
	`t
('Thu£ºam%Çmi ®lowed.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['test'])));

842 ià(
	`dru·l_is_d’›d
('ma', 
$fÜm_¡©e
['values']['test'])) {

843 
	`dru·l_£t_mes§ge
(
	`t
('The-ma‡dd»s %ma i nÙ‡Îowed.', 
	`¬¿y
('%ma' => 
$fÜm_¡©e
['values']['test'])));

846 
	`dru·l_£t_mes§ge
(
	`t
('The-ma‡dd»s %ma i ®lowed.', 
	`¬¿y
('%ma' => 
$fÜm_¡©e
['values']['test'])));

850 ià(
	`dru·l_is_d’›d
('ho¡', 
$fÜm_¡©e
['values']['test'])) {

851 
	`dru·l_£t_mes§ge
(
	`t
('Thho¡Çm%ho¡ i nÙ‡Îowed.', 
	`¬¿y
('%ho¡' => 
$fÜm_¡©e
['values']['test'])));

854 
	`dru·l_£t_mes§ge
(
	`t
('Thho¡Çm%ho¡ i ®lowed.', 
	`¬¿y
('%ho¡' => 
$fÜm_¡©e
['values']['test'])));

860 
	}
}

868 
funùiÚ
 
	$u£r_admš_acûss_d–‘e_cÚfœm
(
$fÜm_¡©e
, 
$aid
 = 0) {

869 
$acûss_ty³s
 = 
	`¬¿y
('u£r' => 
	`t
('username'), 'mail' =>('e-mail'), 'host' =>('host'));

870 
$ed™
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT‡id,y³, stus, mask FROM {acûss} WHERE‡id = %d', 
$aid
));

872 
$fÜm
 = 
	`¬¿y
();

873 
$fÜm
['aid'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$aid
);

874 
$ouut
 = 
	`cÚfœm_fÜm
(
$fÜm
,

875 
	`t
('A» you su» you wªˆtØd–‘th@ty³„uË fÜ %ruË?', 
	`¬¿y
('@ty³' => 
$acûss_ty³s
[
$ed™
->
ty³
], '%ruË' => $ed™->
mask
)),

877 
	`t
('This‡ction cannot be undone.'),

878 
	`t
('Delete'),

879 
	`t
('Cancel'));

880  
$ouut
;

881 
	}
}

883 
funùiÚ
 
	$u£r_admš_acûss_d–‘e_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

884 
	`db_qu”y
('DELETE FROM {acûss} WHERE‡id = %d', 
$fÜm_¡©e
['values']['aid']);

885 
	`dru·l_£t_mes§ge
(
	`t
('The‡ccess„ule has been deleted.'));

886 
$fÜm_¡©e
['redirect'] = 'admin/user/rules';

888 
	}
}

893 
funùiÚ
 
	$u£r_admš_acûss
() {

894 
$h—d”
 = 
	`¬¿y
×¼ay('d©a' => 
	`t
('Accessype'), 'field' => 'status'),‡rray('data' =>('Ruleype'), 'field' => 'type'),‡rray('data' =>('Mask'), 'field' => 'mask'),‡rray('data' =>('Operations'), 'colspan' => 2));

895 
$»suÉ
 = 
	`db_qu”y
("SELECT‡id,y³, stus, mask FROM {acûss}". 
	`bËsÜt_sql
(
$h—d”
));

896 
$acûss_ty³s
 = 
	`¬¿y
('u£r' => 
	`t
('username'), 'mail' =>('e-mail'), 'host' =>('host'));

897 
$rows
 = 
	`¬¿y
();

898 
$ruË
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

899 
$rows
[] = 
	`¬¿y
(
$ruË
->
¡©us
 ? 
	`t
('®low'è:('d’y'), 
$acûss_ty³s
[$ruË->
ty³
], $ruË->
mask
, 
	`l
Ñ('ed™'), 'admš/u£r/ruËs/ed™/'. $ruË->
aid
),†(t('delete'), 'admin/user/rules/delete/'. $rule->aid));

901 ià(
	`em±y
(
$rows
)) {

902 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => '<em>'. 
	`t
('There‡re currently‚o‡ccess„ules.') .'</em>', 'colspan' => 5));

904  
	`theme
('bË', 
$h—d”
, 
$rows
);

905 
	}
}

912 
funùiÚ
 
	$theme_u£r_admš_accouÁ
(
$fÜm
) {

914 
$h—d”
 = 
	`¬¿y
(

915 
	`theme
('table_select_header_cell'),

916 
	`¬¿y
('d©a' => 
	`t
('Username'), 'field' => 'u.name'),

917 
	`¬¿y
('d©a' => 
	`t
('Status'), 'field' => 'u.status'),

918 
	`t
('Roles'),

919 
	`¬¿y
('d©a' => 
	`t
('Member for'), 'field' => 'u.created', 'sort' => 'desc'),

920 
	`¬¿y
('d©a' => 
	`t
('Last‡ccess'), 'field' => 'u.access'),

921 
	`t
('Operations')

924 
$ouut
 = 
	`dru·l_»nd”
(
$fÜm
['options']);

925 ià(
	`is£t
(
$fÜm
['Çme']è&& 
	`is_¬¿y
($form['name'])) {

926 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['Çme']è
as
 
$key
) {

927 
$rows
[] = 
	`¬¿y
(

928 
	`dru·l_»nd”
(
$fÜm
['accouÁs'][
$key
]),

929 
	`dru·l_»nd”
(
$fÜm
['Çme'][
$key
]),

930 
	`dru·l_»nd”
(
$fÜm
['¡©us'][
$key
]),

931 
	`dru·l_»nd”
(
$fÜm
['rŞes'][
$key
]),

932 
	`dru·l_»nd”
(
$fÜm
['memb”_fÜ'][
$key
]),

933 
	`dru·l_»nd”
(
$fÜm
['Ï¡_acûss'][
$key
]),

934 
	`dru·l_»nd”
(
$fÜm
['İ”©iÚs'][
$key
]),

939 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No users‡vailable.'), 'colspan' => '7'));

942 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

943 ià(
$fÜm
['pager']['#value']) {

944 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['pager']);

947 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

949  
$ouut
;

950 
	}
}

957 
funùiÚ
 
	$theme_u£r_admš_Ãw_rŞe
(
$fÜm
) {

958 
$h—d”
 = 
	`¬¿y
(
	`t
('Name'),‡rray('data' =>('Operations'), 'colspan' => 2));

959 
	`fÜ—ch
 (
	`u£r_rŞes
(è
as
 
$rid
 => 
$Çme
) {

960 
$ed™_³rmissiÚs
 = 
	`l
(
	`t
('ed™…”missiÚs'), 'admš/u£r/³rmissiÚs/'. 
$rid
);

961 ià(!
	`š_¬¿y
(
$rid
, 
	`¬¿y
(
DRUPAL_ANONYMOUS_RID
, 
DRUPAL_AUTHENTICATED_RID
))) {

962 
$rows
[] = 
	`¬¿y
(
$Çme
, 
	`l
(
	`t
('ed™„Şe'), 'admš/u£r/rŞes/ed™/'. 
$rid
), 
$ed™_³rmissiÚs
);

965 
$rows
[] = 
	`¬¿y
(
$Çme
, 
	`t
('locked'), 
$ed™_³rmissiÚs
);

968 
$rows
[] = 
	`¬¿y
(
	`dru·l_»nd”
(
$fÜm
['name']),‡rray('data' => drupal_render($form['submit']), 'colspan' => 2));

970 
$ouut
 = 
	`dru·l_»nd”
(
$fÜm
);

971 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

973  
$ouut
;

974 
	}
}

981 
funùiÚ
 
	$theme_u£r_f‹r_fÜm
(
$fÜm
) {

982 
$ouut
 = '<div id="user-admin-filter">';

983 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['filters']);

984 
$ouut
 .= '</div>';

985 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

986  
$ouut
;

987 
	}
}

994 
funùiÚ
 
	$theme_u£r_f‹rs
(
$fÜm
) {

995 
$ouut
 = '<ul class="clear-block">';

996 ià(!
	`em±y
(
$fÜm
['current'])) {

997 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['cu¼’t']è
as
 
$key
) {

998 
$ouut
 .ğ'<li>'. 
	`dru·l_»nd”
(
$fÜm
['cu¼’t'][
$key
]) .'</li>';

1002 
$ouut
 .ğ'<li><dÈşass="muÉi£Ëù">'. (!
	`em±y
(
$fÜm
['cu¼’t']è? '<dt><em>'. 
	`t
('and') .'</em> '.('where') .'</dt>' : '') .'<dd class="a">';

1003 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['f‹r']è
as
 
$key
) {

1004 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['f‹r'][
$key
]);

1006 
$ouut
 .= '</dd>';

1008 
$ouut
 .ğ'<dt>'. 
	`t
('is') .'</dt><dd class="b">';

1010 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['¡©us']è
as
 
$key
) {

1011 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['¡©us'][
$key
]);

1013 
$ouut
 .= '</dd>';

1015 
$ouut
 .= '</dl>';

1016 
$ouut
 .ğ'<div cÏss="cÚš”-šlše" id="u£r-admš-bu‰Ús">'. 
	`dru·l_»nd”
(
$fÜm
['buttons']) .'</div>';

1017 
$ouut
 .= '</li></ul>';

1019  
$ouut
;

1020 
	}
}

	@/srv/http/subs/notes/www/modules/user/user.module

1 <?
php


9 
defše
('USERNAME_MAX_LENGTH', 60);

10 
defše
('EMAIL_MAX_LENGTH', 64);

18 
funùiÚ
 
	$u£r_moduË_švoke
(
$ty³
, &
$¬¿y
, &
$u£r
, 
$ÿ‹gÜy
 = 
NULL
) {

19 
	`fÜ—ch
 (
	`moduË_li¡
(è
as
 
$moduË
) {

20 
$funùiÚ
 = 
$moduË
 .'_user';

21 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

22 
	`$funùiÚ
(
$ty³
, 
$¬¿y
, 
$u£r
, 
$ÿ‹gÜy
);

25 
	}
}

30 
funùiÚ
 
	$u£r_theme
() {

31  
	`¬¿y
(

32 'u£r_piùu»' => 
	`¬¿y
(

33 '¬gum’ts' => 
	`¬¿y
('accouÁ' => 
NULL
),

36 'u£r_´ofe' => 
	`¬¿y
(

37 '¬gum’ts' => 
	`¬¿y
('accouÁ' => 
NULL
),

41 'u£r_´ofe_ÿ‹gÜy' => 
	`¬¿y
(

42 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

46 'u£r_´ofe_™em' => 
	`¬¿y
(

47 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

51 'u£r_li¡' => 
	`¬¿y
(

52 '¬gum’ts' => 
	`¬¿y
('u£rs' => 
NULL
, 'title' => NULL),

54 'u£r_admš_³rm' => 
	`¬¿y
(

55 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

58 'u£r_admš_Ãw_rŞe' => 
	`¬¿y
(

59 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

62 'u£r_admš_accouÁ' => 
	`¬¿y
(

63 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

66 'u£r_f‹r_fÜm' => 
	`¬¿y
(

67 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

70 'u£r_f‹rs' => 
	`¬¿y
(

71 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

74 'u£r_sigÇtu»' => 
	`¬¿y
(

75 '¬gum’ts' => 
	`¬¿y
('sigÇtu»' => 
NULL
),

78 
	}
}

80 
funùiÚ
 
	$u£r_ex‹º®_lßd
(
$authÇme
) {

81 
$»suÉ
 = 
	`db_qu”y
("SELECT uid FROM {authm­} WHERE‡uthÇmğ'%s'", 
$authÇme
);

83 ià(
$u£r
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

84  
	`u£r_lßd
(
$u£r
);

89 
	}
}

108 
funùiÚ
 
u£r_ex‹º®_logš
(
$accouÁ
, 
$ed™
 = 
	$¬¿y
()) {

109 
$fÜm
 = 
	`dru·l_g‘_fÜm
('user_login');

111 
$¡©e
['v®ues'] = 
$ed™
;

112 ià(
	`em±y
(
$¡©e
['values']['name'])) {

113 
$¡©e
['v®ues']['Çme'] = 
$accouÁ
->
Çme
;

117 
	`u£r_logš_Çme_v®id©e
(
$fÜm
, 
$¡©e
, (
¬¿y
)
$accouÁ
);

118 ià(
	`fÜm_g‘_”rÜs
()) {

120  
FALSE
;

124 
glob®
 
$u£r
;

125 
$u£r
 = 
$accouÁ
;

126 
	`u£r_auth’tiÿ‹_fš®ize
(
$¡©e
['values']);

127  
TRUE
;

128 
	}
}

141 
funùiÚ
 
u£r_lßd
(
$¬¿y
 = 
	$¬¿y
()) {

143 
$qu”y
 = 
	`¬¿y
();

144 
$·¿ms
 = 
	`¬¿y
();

146 ià(
	`is_num”ic
(
$¬¿y
)) {

147 
$¬¿y
 = 
	`¬¿y
('uid' => $array);

149 
	`–£if
 (!
	`is_¬¿y
(
$¬¿y
)) {

150  
FALSE
;

153 
	`fÜ—ch
 (
$¬¿y
 
as
 
$key
 => 
$v®ue
) {

154 ià(
$key
 == 'uid' || $key == 'status') {

155 
$qu”y
[] = "$key = %d";

156 
$·¿ms
[] = 
$v®ue
;

158 ià(
$key
 == 'pass') {

159 
$qu”y
[] = "pass = '%s'";

160 
$·¿ms
[] = 
	`md5
(
$v®ue
);

163 
$qu”y
[]= "LOWER($key) = LOWER('%s')";

164 
$·¿ms
[] = 
$v®ue
;

167 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {u£rs} u WHERE '. 
	`im¶ode
(' AND ', 
$qu”y
), 
$·¿ms
);

169 ià(
$u£r
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

170 
$u£r
 = 
	`dru·l_uÅack
($user);

172 
$u£r
->
rŞes
 = 
	`¬¿y
();

173 ià(
$u£r
->
uid
) {

174 
$u£r
->
rŞes
[
DRUPAL_AUTHENTICATED_RID
] = 'authenticated user';

177 
$u£r
->
rŞes
[
DRUPAL_ANONYMOUS_RID
] = 'anonymous user';

179 
$»suÉ
 = 
	`db_qu”y
('SELECT„.rid,„.ÇmFROM {rŞe}„ INNER JOIN {u£rs_rŞes} u¸ON ur.rid =„.rid WHERE ur.uid = %d', 
$u£r
->
uid
);

180 
$rŞe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

181 
$u£r
->
rŞes
[
$rŞe
->
rid
] = $rŞe->
Çme
;

183 
	`u£r_moduË_švoke
('lßd', 
$¬¿y
, 
$u£r
);

186 
$u£r
 = 
FALSE
;

189  
$u£r
;

190 
	}
}

210 
funùiÚ
 
u£r_§ve
(
$accouÁ
, 
$¬¿y
 = 
¬¿y
(), 
$ÿ‹gÜy
 = 'account') {

212 
$u£r_f›lds
 = 
u£r_f›lds
();

213 ià(
is_objeù
(
$accouÁ
è&& 
	g$accouÁ
->
	guid
) {

214 
u£r_moduË_švoke
('upd©e', 
$¬¿y
, 
$accouÁ
, 
$ÿ‹gÜy
);

215 
	g$qu”y
 = '';

216 
	g$d©a
 = 
un£rŸlize
(
db_»suÉ
(
db_qu”y
('SELECT d©¨FROM {u£rs} WHERE uid = %d', 
$accouÁ
->
uid
)));

219 ià(
em±y
(
$¬¿y
['acûss']è&&ƒm±y(
$accouÁ
->
acûss
è&& 
u£r_acûss
('administer users')) {

220 
	g$¬¿y
['acûss'] = 
time
();

222 
fÜ—ch
 (
$¬¿y
 
as
 
$key
 => 
$v®ue
) {

223 ià(
$key
 =ğ'·ss' && !
em±y
(
$v®ue
)) {

224 
$qu”y
 .= "$key = '%s', ";

225 
	g$v
[] = 
md5
(
$v®ue
);

227 ià((
sub¡r
(
$key
, 0, 4) !== 'auth') && ($key != 'pass')) {

228 ià(
š_¬¿y
(
$key
, 
$u£r_f›lds
)) {

230 
$qu”y
 .= "$key = '%s', ";

231 
	g$v
[] = 
$v®ue
;

233 ià(
	g$key
 != 'roles') {

235 ià(
$v®ue
 ==ğ
NULL
) {

236 
un£t
(
$d©a
[
$key
]);

238 
–£if
 (!
em±y
(
$key
)) {

239 
	g$d©a
[
$key
] = 
$v®ue
;

244 
	g$qu”y
 .= "data = '%s' ";

245 
	g$v
[] = 
£rŸlize
(
$d©a
);

247 
	g$sucûss
 = 
db_qu”y
("UPDATE {u£rs} SET $qu”y WHERE uid = %d", 
¬¿y_m”ge
(
$v
, 
¬¿y
(
$accouÁ
->
uid
)));

248 ià(!
	g$sucûss
) {

250  
	gFALSE
;

254 ià(
is£t
(
$¬¿y
['rŞes']è&& 
is_¬¿y
($array['roles'])) {

255 
db_qu”y
('DELETE FROM {u£rs_rŞes} WHERE uid = %d', 
$accouÁ
->
uid
);

257 
fÜ—ch
 (
¬¿y_keys
(
$¬¿y
['rŞes']è
as
 
$rid
) {

258 ià(!
š_¬¿y
(
$rid
, 
¬¿y
(
DRUPAL_ANONYMOUS_RID
, 
DRUPAL_AUTHENTICATED_RID
))) {

259 
db_qu”y
('INSERT INTO {u£rs_rŞes} (uid,„idèVALUES (%d, %d)', 
$accouÁ
->
uid
, 
$rid
);

265 ià(
is£t
(
$¬¿y
['¡©us']è&& 
	g$¬¿y
['status'] == 0) {

266 
£ss_de¡roy_uid
(
$accouÁ
->
uid
);

271 ià(!
em±y
(
$¬¿y
['pass'])) {

272 
£ss_de¡roy_uid
(
$accouÁ
->
uid
);

273 ià(
	g$accouÁ
->
	guid
 =ğ
$GLOBALS
['u£r']->
uid
) {

274 
£ss_»g’”©e
();

279 
	g$u£r
 = 
u£r_lßd
(
¬¿y
('uid' => 
$accouÁ
->
uid
));

282 ià(
is£t
(
$¬¿y
['¡©us']è&& 
	g$¬¿y
['¡©us'] !ğ
$accouÁ
->
¡©us
) {

284 
$İ
 = 
$¬¿y
['status'] == 1 ? 'status_activated' : 'status_blocked';

285 
_u£r_ma_nÙify
(
$İ
, 
$u£r
);

288 
u£r_moduË_švoke
('aá”_upd©e', 
$¬¿y
, 
$u£r
, 
$ÿ‹gÜy
);

292 ià(!
is£t
(
$¬¿y
['created'])) {

293 
	g$¬¿y
['ü—‹d'] = 
time
();

297 ià(
em±y
(
$¬¿y
['acûss']è&& 
u£r_acûss
('administer users')) {

298 
	g$¬¿y
['acûss'] = 
time
();

304 
fÜ—ch
 (
$¬¿y
 
as
 
$key
 => 
$v®ue
) {

305 
$key
) {

307 
$f›lds
[] = 
$key
;

308 
	g$v®ues
[] = 
md5
(
$v®ue
);

309 
	g$s
[] = "'%s'";

314 
$f›lds
[] = 
$key
;

315 
	g$v®ues
[] = 
$v®ue
;

316 
	g$s
[] = "%d";

319 ià(
sub¡r
(
$key
, 0, 4è!=ğ'auth' && 
š_¬¿y
($key, 
$u£r_f›lds
)) {

320 
	g$f›lds
[] = 
$key
;

321 
	g$v®ues
[] = 
$v®ue
;

322 
	g$s
[] = "'%s'";

327 
	g$sucûss
 = 
db_qu”y
('INSERT INTO {u£rs} ('. 
im¶ode
(', ', 
$f›lds
è.'èVALUES ('. im¶ode(', ', 
$s
è.')', 
$v®ues
);

328 ià(!
	g$sucûss
) {

331  
	gFALSE
;

335 
	g$¬¿y
['uid'] = 
db_Ï¡_š£¹_id
('users', 'uid');

336 
	g$u£r
 = 
u£r_lßd
(
¬¿y
('uid' => 
$¬¿y
['uid']));

338 
u£r_moduË_švoke
('š£¹', 
$¬¿y
, 
$u£r
, 
$ÿ‹gÜy
);

341 
	g$d©a
 = 
¬¿y
();

342 
fÜ—ch
 (
$¬¿y
 
as
 
$key
 => 
$v®ue
) {

343 ià((
sub¡r
(
$key
, 0, 4è!=ğ'auth'è&& ($key !ğ'rŞes'è&& (!
š_¬¿y
($key, 
$u£r_f›lds
)è&& (
	g$v®ue
 !=ğ
NULL
)) {

344 
$d©a
[
$key
] = 
$v®ue
;

347 
db_qu”y
("UPDATE {u£rs} SET d©¨ğ'%s' WHERE uid = %d", 
£rŸlize
(
$d©a
), 
$u£r
->
uid
);

350 ià(
is£t
(
$¬¿y
['rŞes']è&& 
is_¬¿y
($array['roles'])) {

351 
db_qu”y
('DELETE FROM {u£rs_rŞes} WHERE uid = %d', 
$¬¿y
['uid']);

352 
fÜ—ch
 (
¬¿y_keys
(
$¬¿y
['rŞes']è
as
 
$rid
) {

353 ià(!
š_¬¿y
(
$rid
, 
¬¿y
(
DRUPAL_ANONYMOUS_RID
, 
DRUPAL_AUTHENTICATED_RID
))) {

354 
db_qu”y
('INSERT INTO {u£rs_rŞes} (uid,„idèVALUES (%d, %d)', 
$¬¿y
['uid'], 
$rid
);

360 
	g$u£r
 = 
u£r_lßd
(
¬¿y
('uid' => 
$¬¿y
['uid']));

364 
	g$authm­s
 = 
¬¿y
();

365 
fÜ—ch
 (
$¬¿y
 
as
 
$key
 => 
$v®ue
) {

366 ià(
sub¡r
(
$key
, 0, 4) == 'auth') {

367 
$authm­s
[
$key
] = 
$v®ue
;

370 ià((
	g$authm­s
) > 0) {

371 
u£r_£t_authm­s
(
$u£r
, 
$authm­s
);

374  
	g$u£r
;

380 
funùiÚ
 
	$u£r_v®id©e_Çme
(
$Çme
) {

381 ià(!
	`¡¾’
(
$Çme
)) {

382  
	`t
('You mustƒnter‡ username.');

384 ià(
	`sub¡r
(
$Çme
, 0, 1) == ' ') {

385  
	`t
('The username cannot begin with‡ space.');

387 ià(
	`sub¡r
(
$Çme
, -1) == ' ') {

388  
	`t
('The username cannotƒnd with‡ space.');

390 ià(
	`¡½os
(
$Çme
, ' 'è!=ğ
FALSE
) {

391  
	`t
('The username cannot contain multiple spaces in‡„ow.');

393 ià(
	`´eg_m©ch
('/[^\x{80}-\x{F7}‡-z0-9@_.\'-]/i', 
$Çme
)) {

394  
	`t
('The username contains‡n illegal character.');

396 ià(
	`´eg_m©ch
('/[\x{80}-\x{A0}'.

405 
$Çme
)) {

406  
	`t
('The username contains‡n illegal character.');

408 ià(
	`dru·l_¡¾’
(
$Çme
è> 
USERNAME_MAX_LENGTH
) {

409  
	`t
('Thu£ºam%Çmi toØlÚg: iˆmu¡ b%max ch¬aù” Ü†ess.', 
	`¬¿y
('%Çme' => 
$Çme
, '%max' => 
USERNAME_MAX_LENGTH
));

411 
	}
}

413 
funùiÚ
 
	$u£r_v®id©e_ma
(
$ma
) {

414 ià(!
$ma
è 
	`t
('You mustƒnter‡nƒ-mail‡ddress.');

415 ià(!
	`v®id_ema_add»ss
(
$ma
)) {

416  
	`t
('The-ma‡dd»s %ma i nÙ v®id.', 
	`¬¿y
('%ma' => 
$ma
));

418 
	}
}

420 
funùiÚ
 
	$u£r_v®id©e_piùu»
(&
$fÜm
, &
$fÜm_¡©e
) {

422 
$v®id©Üs
 = 
	`¬¿y
(

423 'fe_v®id©e_is_image' => 
	`¬¿y
(),

424 'fe_v®id©e_image_»sŞutiÚ' => 
	`¬¿y
(
	`v¬ŸbË_g‘
('user_picture_dimensions', '85x85')),

425 'fe_v®id©e_size' => 
	`¬¿y
(
	`v¬ŸbË_g‘
('user_picture_file_size', '30') * 1024),

427 ià(
$fe
 = 
	`fe_§ve_u¶ßd
('piùu»_u¶ßd', 
$v®id©Üs
)) {

429 ià(
	`is£t
(
$fÜm_¡©e
['v®ues']['_accouÁ']->
piùu»
è&& 
	`fe_exi¡s
($form_state['values']['_account']->picture)) {

430 
	`fe_d–‘e
(
$fÜm_¡©e
['v®ues']['_accouÁ']->
piùu»
);

436 
$šfo
 = 
	`image_g‘_šfo
(
$fe
->
f•©h
);

437 
$de¡š©iÚ
 = 
	`v¬ŸbË_g‘
('u£r_piùu»_·th', 'piùu»s'è.'/piùu»-'. 
$fÜm
['#uid'] .'.'. 
$šfo
['extension'];

438 ià(
	`fe_cİy
(
$fe
, 
$de¡š©iÚ
, 
FILE_EXISTS_REPLACE
)) {

439 
$fÜm_¡©e
['v®ues']['piùu»'] = 
$fe
->
f•©h
;

442 
	`fÜm_£t_”rÜ
('piùu»_u¶ßd', 
	`t
("FaedØu¶ßdhpiùu» image;h%dœeùÜy dœeùÜy dÛ¢'ˆexi¡ o¸i nÙ wr™abË.", 
	`¬¿y
('%dœeùÜy' => 
	`v¬ŸbË_g‘
('user_picture_path', 'pictures'))));

445 
	}
}

450 
funùiÚ
 
	$u£r_·sswÜd
(
$Ëngth
 = 10) {

455 
$®lowabË_ch¬aù”s
 = 'abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ23456789';

458 
$Ën
 = 
	`¡¾’
(
$®lowabË_ch¬aù”s
) - 1;

461 
$·ss
 = '';

464 
$i
 = 0; $˜< 
$Ëngth
; $i++) {

468 
$·ss
 .ğ
$®lowabË_ch¬aù”s
[
	`mt_¿nd
(0, 
$Ën
)];

471  
$·ss
;

472 
	}
}

493 
funùiÚ
 
	$u£r_acûss
(
$¡ršg
, 
$accouÁ
 = 
NULL
, 
$»£t
 = 
FALSE
) {

494 
glob®
 
$u£r
;

495 
$³rm
 = 
	`¬¿y
();

497 ià(
$»£t
) {

498 
$³rm
 = 
	`¬¿y
();

501 ià(!
	`is£t
(
$accouÁ
)) {

502 
$accouÁ
 = 
$u£r
;

506 ià(
$accouÁ
->
uid
 == 1) {

507  
TRUE
;

512 ià(!
	`is£t
(
$³rm
[
$accouÁ
->
uid
])) {

513 
$»suÉ
 = 
	`db_qu”y
("SELECT….³rm FROM {rŞe}„ INNER JOIN {³rmissiÚ}… ON….rid =„.rid WHERE„.rid IN (". 
	`db_¶aûhŞd”s
(
$accouÁ
->
rŞes
è.")", 
	`¬¿y_keys
($account->roles));

515 
$³rms
 = 
	`¬¿y
();

516 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

517 
$³rms
 +ğ
	`¬¿y_æ
(
	`ex¶ode
(', ', 
$row
->
³rm
));

519 
$³rm
[
$accouÁ
->
uid
] = 
$³rms
;

522  
	`is£t
(
$³rm
[
$accouÁ
->
uid
][
$¡ršg
]);

523 
	}
}

530 
funùiÚ
 
	$u£r_is_blocked
(
$Çme
) {

531 
$d’y
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT‚amFROM {u£rs} WHERE stu ğ0 AND‚amğLOWER('%s')", 
$Çme
));

533  
$d’y
;

534 
	}
}

536 
funùiÚ
 
	$u£r_f›lds
() {

537 
$f›lds
;

539 ià(!
$f›lds
) {

540 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {users} WHERE uid = 1');

541 ià(
$f›ld
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

542 
$f›lds
 = 
	`¬¿y_keys
(
$f›ld
);

546 
$f›lds
 = 
	`¬¿y
('uid', 'name', 'pass', 'mail', 'picture', 'mode', 'sort', 'threshold', 'theme', 'signature', 'signature_format', 'created', 'access', 'login', 'status', 'timezone', 'language', 'init', 'data');

550  
$f›lds
;

551 
	}
}

556 
funùiÚ
 
	$u£r_³rm
() {

557  
	`¬¿y
('administer…ermissions', 'administer users', 'access user…rofiles', 'change own username');

558 
	}
}

565 
funùiÚ
 
	$u£r_fe_dowÆßd
(
$fe
) {

566 ià(
	`¡½os
(
$fe
, 
	`v¬ŸbË_g‘
('user_picture_path', 'pictures') .'/picture-') === 0) {

567 
$šfo
 = 
	`image_g‘_šfo
(
	`fe_ü—‹_·th
(
$fe
));

568  
	`¬¿y
('CÚ‹Á-ty³: '. 
$šfo
['mime_type']);

570 
	}
}

575 
funùiÚ
 
u£r_£¬ch
(
$İ
 = '£¬ch', 
$keys
 = 
NULL
, 
$sk_acûss_check
 = 
FALSE
) {

576 
$İ
) {

578 ià(
$sk_acûss_check
 || 
u£r_acûss
('access user…rofiles')) {

579  
t
('Users');

582 ià(
u£r_acûss
('access user…rofiles')) {

583 
$fšd
 = 
¬¿y
();

585 
	g$keys
 = 
´eg_»¶aû
('!\*+!', '%', 
$keys
);

586 ià(
u£r_acûss
('administer users')) {

588 
	g$»suÉ
 = 
·g”_qu”y
("SELECT‚ame, uid, ma FROM {u£rs} WHERE LOWERÒameèLIKE LOWER('%%%s%%'èOR LOWER(maèLIKE LOWER('%%%s%%')", 15, 0, 
NULL
, 
$keys
, $keys);

589 
	g$accouÁ
 = 
db_ãtch_objeù
(
$»suÉ
)) {

590 
$fšd
[] = 
¬¿y
('t™Ë' => 
$accouÁ
->
Çme
 .' ('. $accouÁ->
ma
 .')', 'lšk' => 
u¾
('u£r/'. $accouÁ->
uid
,‡¼ay('absŞu‹' => 
TRUE
)));

594 
	g$»suÉ
 = 
·g”_qu”y
("SELECT‚ame, uid FROM {u£rs} WHERE LOWERÒameèLIKE LOWER('%%%s%%')", 15, 0, 
NULL
, 
$keys
);

595 
	g$accouÁ
 = 
db_ãtch_objeù
(
$»suÉ
)) {

596 
$fšd
[] = 
¬¿y
('t™Ë' => 
$accouÁ
->
Çme
, 'lšk' => 
u¾
('u£r/'. $accouÁ->
uid
,‡¼ay('absŞu‹' => 
TRUE
)));

599  
	g$fšd
;

607 
funùiÚ
 
	$u£r_–em’ts
() {

608  
	`¬¿y
(

609 'u£r_´ofe_ÿ‹gÜy' => 
	`¬¿y
(),

610 'u£r_´ofe_™em' => 
	`¬¿y
(),

612 
	}
}

617 
funùiÚ
 
	$u£r_u£r
(
$ty³
, &
$ed™
, &
$accouÁ
, 
$ÿ‹gÜy
 = 
NULL
) {

618 ià(
$ty³
 == 'view') {

619 
$accouÁ
->
cÚ‹Á
['u£r_piùu»'] = 
	`¬¿y
(

620 '#v®ue' => 
	`theme
('u£r_piùu»', 
$accouÁ
),

623 ià(!
	`is£t
(
$accouÁ
->
cÚ‹Á
['summary'])) {

624 
$accouÁ
->
cÚ‹Á
['summ¬y'] = 
	`¬¿y
();

626 
$accouÁ
->
cÚ‹Á
['summ¬y'] +ğ
	`¬¿y
(

628 '#©Œibu‹s' => 
	`¬¿y
('class' => 'user-member'),

630 '#t™Ë' => 
	`t
('History'),

632 
$accouÁ
->
cÚ‹Á
['summ¬y']['memb”_fÜ'] = 
	`¬¿y
(

634 '#t™Ë' => 
	`t
('Member for'),

635 '#v®ue' => 
	`fÜm©_š‹rv®
(
	`time
(è- 
$accouÁ
->
ü—‹d
),

638 ià(
$ty³
 =ğ'fÜm' && 
$ÿ‹gÜy
 == 'account') {

639 
$fÜm_¡©e
 = 
	`¬¿y
();

640  
	`u£r_ed™_fÜm
(
$fÜm_¡©e
, (
	`is£t
(
$accouÁ
->
uid
è? $accouÁ->uid : 
FALSE
), 
$ed™
);

643 ià(
$ty³
 =ğ'v®id©e' && 
$ÿ‹gÜy
 == 'account') {

644  
	`_u£r_ed™_v®id©e
((
	`is£t
(
$accouÁ
->
uid
è? $accouÁ->uid : 
FALSE
), 
$ed™
);

647 ià(
$ty³
 =ğ'subm™' && 
$ÿ‹gÜy
 == 'account') {

648  
	`_u£r_ed™_subm™
((
	`is£t
(
$accouÁ
->
uid
è? $accouÁ->uid : 
FALSE
), 
$ed™
);

651 ià(
$ty³
 == 'categories') {

652  
	`¬¿y
×¼ay('Çme' => 'accouÁ', 't™Ë' => 
	`t
('Account settings'), 'weight' => 1));

654 
	}
}

656 
funùiÚ
 
	$u£r_logš_block
() {

657 
$fÜm
 = 
	`¬¿y
(

658 '#aùiÚ' => 
	`u¾
(
$_GET
['q'], 
	`¬¿y
('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
())),

660 '#v®id©e' => 
	`u£r_logš_deçuÉ_v®id©Üs
(),

661 '#subm™' => 
	`¬¿y
('user_login_submit'),

663 
$fÜm
['Çme'] = 
	`¬¿y
('#type' => 'textfield',

664 '#t™Ë' => 
	`t
('Username'),

665 '#maxËngth' => 
USERNAME_MAX_LENGTH
,

667 '#»quœed' => 
TRUE
,

669 
$fÜm
['·ss'] = 
	`¬¿y
('#type' => 'password',

670 '#t™Ë' => 
	`t
('Password'),

673 '#»quœed' => 
TRUE
,

675 
$fÜm
['subm™'] = 
	`¬¿y
('#type' => 'submit',

676 '#v®ue' => 
	`t
('Log in'),

678 
$™ems
 = 
	`¬¿y
();

679 ià(
	`v¬ŸbË_g‘
('user_register', 1)) {

680 
$™ems
[] = 
	`l
(
	`t
('C»©Ãw‡ccouÁ'), 'u£r/»gi¡”', 
	`¬¿y
('attributes' =>‡rray('title' =>('Create‡‚ew user‡ccount.'))));

682 
$™ems
[] = 
	`l
(
	`t
('Reque¡‚ew…asswÜd'), 'u£r/·sswÜd', 
	`¬¿y
('attributes' =>‡rray('title' =>('Request‚ew…assword viaƒ-mail.'))));

683 
$fÜm
['lšks'] = 
	`¬¿y
('#v®ue' => 
	`theme
('™em_li¡', 
$™ems
));

684  
$fÜm
;

685 
	}
}

690 
funùiÚ
 
u£r_block
(
$İ
 = 'li¡', 
$d–
 = 0, 
$ed™
 = 
	$¬¿y
()) {

691 
glob®
 
$u£r
;

693 ià(
$İ
 == 'list') {

694 
$blocks
[0]['šfo'] = 
	`t
('User†ogin');

696 
$blocks
[0]['ÿche'] = 
BLOCK_NO_CACHE
;

698 
$blocks
[1]['šfo'] = 
	`t
('Navigation');

701 
$blocks
[1]['ÿche'] = 
BLOCK_NO_CACHE
;

703 
$blocks
[2]['šfo'] = 
	`t
('Who\'s‚ew');

706 
$blocks
[3]['šfo'] = 
	`t
('Who\'s online');

707 
$blocks
[3]['ÿche'] = 
BLOCK_NO_CACHE
;

708  
$blocks
;

710 ià(
$İ
 =ğ'cÚfigu»' && 
$d–
 == 2) {

711 
$fÜm
['u£r_block_whois_Ãw_couÁ'] = 
	`¬¿y
(

713 '#t™Ë' => 
	`t
('Number of userso display'),

714 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('user_block_whois_new_count', 5),

715 '#İtiÚs' => 
	`dru·l_m­_assoc
(
	`¬¿y
(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)),

717  
$fÜm
;

719 ià(
$İ
 =ğ'cÚfigu»' && 
$d–
 == 3) {

720 
$³riod
 = 
	`dru·l_m­_assoc
(
	`¬¿y
(30, 60, 120, 180, 300, 600, 900, 1800, 2700, 3600, 5400, 7200, 10800, 21600, 43200, 86400), 'format_interval');

721 
$fÜm
['u£r_block_£cÚds_Úlše'] = 
	`¬¿y
('#ty³' => '£Ëù', '#t™Ë' => 
	`t
('U£¸aùiv™y'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('u£r_block_£cÚds_Úlše', 900), '#İtiÚs' => 
$³riod
, '#description' =>('A user is considered online forhis†ong‡fterhey have†ast viewed‡…age.'));

722 
$fÜm
['u£r_block_max_li¡_couÁ'] = 
	`¬¿y
('#ty³' => '£Ëù', '#t™Ë' => 
	`t
('U£¸li¡†’gth'), '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('u£r_block_max_li¡_couÁ', 10), '#İtiÚs' => 
	`dru·l_m­_assoc
(array(0, 5, 10, 15, 20, 25, 30, 40, 50, 75, 100)), '#description' =>('Maximum‚umber of currently online userso display.'));

724  
$fÜm
;

726 ià(
$İ
 =ğ'§ve' && 
$d–
 == 2) {

727 
	`v¬ŸbË_£t
('u£r_block_whois_Ãw_couÁ', 
$ed™
['user_block_whois_new_count']);

729 ià(
$İ
 =ğ'§ve' && 
$d–
 == 3) {

730 
	`v¬ŸbË_£t
('u£r_block_£cÚds_Úlše', 
$ed™
['user_block_seconds_online']);

731 
	`v¬ŸbË_£t
('u£r_block_max_li¡_couÁ', 
$ed™
['user_block_max_list_count']);

733 ià(
$İ
 == 'view') {

734 
$block
 = 
	`¬¿y
();

736 
$d–
) {

739 ià(!
$u£r
->
uid
 && !(
	`¬g
(0è=ğ'u£r' && !
	`is_num”ic
(arg(1)))) {

741 
$block
['subjeù'] = 
	`t
('User†ogin');

742 
$block
['cÚ‹Á'] = 
	`dru·l_g‘_fÜm
('user_login_block');

744  
$block
;

747 ià(
$m’u
 = 
	`m’u_Œ“
()) {

748 
$block
['subjeù'] = 
$u£r
->
uid
 ? 
	`check_¶aš
($u£r->
Çme
è: 
	`t
('Navigation');

749 
$block
['cÚ‹Á'] = 
$m’u
;

751  
$block
;

754 ià(
	`u£r_acûss
('access content')) {

756 
$»suÉ
 = 
	`db_qu”y_¿nge
('SELECT uid,‚amFROM {u£rs} WHERE stu !ğ0 AND‡cûs !ğ0 ORDER BY c»©ed DESC', 0, 
	`v¬ŸbË_g‘
('user_block_whois_new_count', 5));

757 
$accouÁ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

758 
$™ems
[] = 
$accouÁ
;

760 
$ouut
 = 
	`theme
('u£r_li¡', 
$™ems
);

762 
$block
['subjeù'] = 
	`t
('Who\'s‚ew');

763 
$block
['cÚ‹Á'] = 
$ouut
;

765  
$block
;

768 ià(
	`u£r_acûss
('access content')) {

770 
$š‹rv®
 = 
	`time
(è- 
	`v¬ŸbË_g‘
('user_block_seconds_online', 900);

774 
$ªÚymous_couÁ
 = 
	`£ss_couÁ
(
$š‹rv®
);

775 
$auth’tiÿ‹d_u£rs
 = 
	`db_qu”y
('SELECT DISTINCT u.uid, u.Çme, s.time¡am°FROM {u£rs} u INNER JOIN {£ssiÚs} s ON u.uid = s.uid WHERE s.time¡am°>ğ%d AND s.uid > 0 ORDER BY s.time¡am°DESC', 
$š‹rv®
);

776 
$auth’tiÿ‹d_couÁ
 = 0;

777 
$max_u£rs
 = 
	`v¬ŸbË_g‘
('user_block_max_list_count', 10);

778 
$™ems
 = 
	`¬¿y
();

779 
$accouÁ
 = 
	`db_ãtch_objeù
(
$auth’tiÿ‹d_u£rs
)) {

780 ià(
$max_u£rs
 > 0) {

781 
$™ems
[] = 
$accouÁ
;

782 
$max_u£rs
--;

784 
$auth’tiÿ‹d_couÁ
++;

788 ià(
$ªÚymous_couÁ
 =ğ1 && 
$auth’tiÿ‹d_couÁ
 == 1) {

789 
$ouut
 = 
	`t
('Th”i cu¼’y %memb” ªd %vis™Ü Úlše.', 
	`¬¿y
('%memb”s' => 
	`fÜm©_¶u¿l
(
$auth’tiÿ‹d_couÁ
, '1 u£r', '@couÁ u£rs'), '%vis™Üs' => fÜm©_¶u¿l(
$ªÚymous_couÁ
, '1 guest', '@count guests')));

792 
$ouut
 = 
	`t
('Th”¬cu¼’y %memb” ªd %vis™Ü Úlše.', 
	`¬¿y
('%memb”s' => 
	`fÜm©_¶u¿l
(
$auth’tiÿ‹d_couÁ
, '1 u£r', '@couÁ u£rs'), '%vis™Üs' => fÜm©_¶u¿l(
$ªÚymous_couÁ
, '1 guest', '@count guests')));

796 
$max_u£rs
 = 
	`v¬ŸbË_g‘
('user_block_max_list_count', 10);

797 ià(
$auth’tiÿ‹d_couÁ
 && 
$max_u£rs
) {

798 
$ouut
 .ğ
	`theme
('u£r_li¡', 
$™ems
, 
	`t
('Online users'));

801 
$block
['subjeù'] = 
	`t
('Who\'s online');

802 
$block
['cÚ‹Á'] = 
$ouut
;

804  
$block
;

807 
	}
}

817 
funùiÚ
 
	$‹m¶©e_´•roûss_u£r_piùu»
(&
$v¬ŸbËs
) {

818 
$v¬ŸbËs
['picture'] = '';

819 ià(
	`v¬ŸbË_g‘
('user_pictures', 0)) {

820 
$accouÁ
 = 
$v¬ŸbËs
['account'];

821 ià(!
	`em±y
(
$accouÁ
->
piùu»
è&& 
	`fe_exi¡s
($account->picture)) {

822 
$piùu»
 = 
	`fe_ü—‹_u¾
(
$accouÁ
->
piùu»
);

824 ià(
	`v¬ŸbË_g‘
('user_picture_default', '')) {

825 
$piùu»
 = 
	`v¬ŸbË_g‘
('user_picture_default', '');

828 ià(
	`is£t
(
$piùu»
)) {

829 
$®t
 = 
	`t
("@u£r' piùu»", 
	`¬¿y
('@u£r' => 
$accouÁ
->
Çme
 ? $accouÁ->Çm: 
	`v¬ŸbË_g‘
('anonymous',('Anonymous'))));

830 
$v¬ŸbËs
['piùu»'] = 
	`theme
('image', 
$piùu»
, 
$®t
, $®t, '', 
FALSE
);

831 ià(!
	`em±y
(
$accouÁ
->
uid
è&& 
	`u£r_acûss
('access user…rofiles')) {

832 
$©Œibu‹s
 = 
	`¬¿y
('©Œibu‹s' =>‡¼ay('t™Ë' => 
	`t
('V›w u£¸´ofe.')), 'html' => 
TRUE
);

833 
$v¬ŸbËs
['piùu»'] = 
	`l
($v¬ŸbËs['piùu»'], "u£r/$accouÁ->uid", 
$©Œibu‹s
);

837 
	}
}

849 
funùiÚ
 
	$theme_u£r_li¡
(
$u£rs
, 
$t™Ë
 = 
NULL
) {

850 ià(!
	`em±y
(
$u£rs
)) {

851 
	`fÜ—ch
 (
$u£rs
 
as
 
$u£r
) {

852 
$™ems
[] = 
	`theme
('u£ºame', 
$u£r
);

855  
	`theme
('™em_li¡', 
$™ems
, 
$t™Ë
);

856 
	}
}

858 
funùiÚ
 
	$u£r_is_ªÚymous
() {

860  !
$GLOBALS
['u£r']->
uid
 || !
	`em±y
($GLOBALS['menu_admin']);

861 
	}
}

863 
funùiÚ
 
	$u£r_is_logged_š
() {

864  (
boŞ
)
$GLOBALS
['u£r']->
uid
;

865 
	}
}

867 
funùiÚ
 
	$u£r_»gi¡”_acûss
() {

868  
	`u£r_is_ªÚymous
(è&& 
	`v¬ŸbË_g‘
('user_register', 1);

869 
	}
}

871 
funùiÚ
 
	$u£r_v›w_acûss
(
$accouÁ
) {

872  
$accouÁ
 && $accouÁ->
uid
 &&

875 (
$GLOBALS
['u£r']->
uid
 =ğ
$accouÁ
->uid) ||

877 
	`u£r_acûss
('administer users') ||

879 (
$accouÁ
->
acûss
 && $accouÁ->
¡©us
 && 
	`u£r_acûss
('access user…rofiles'))

881 
	}
}

886 
funùiÚ
 
	$u£r_ed™_acûss
(
$accouÁ
) {

887  ((
$GLOBALS
['u£r']->
uid
 =ğ
$accouÁ
->uidè|| 
	`u£r_acûss
('administer users')) && $account->uid > 0;

888 
	}
}

890 
funùiÚ
 
	$u£r_lßd_£lf
(
$¬g
) {

891 
$¬g
[1] = 
	`u£r_lßd
(
$GLOBALS
['u£r']->
uid
);

892  
$¬g
;

893 
	}
}

898 
funùiÚ
 
	$u£r_m’u
() {

899 
$™ems
['u£r/autocom¶‘e'] = 
	`¬¿y
(

903 'acûs ¬gum’ts' => 
	`¬¿y
('access user…rofiles'),

904 'ty³' => 
MENU_CALLBACK
,

909 
$™ems
['u£r'] = 
	`¬¿y
(

912 'acûs ÿÎback' => 
TRUE
,

913 'ty³' => 
MENU_CALLBACK
,

917 
$™ems
['u£r/logš'] = 
	`¬¿y
(

920 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

923 
$™ems
['u£r/»gi¡”'] = 
	`¬¿y
(

926 '·g¬gum’ts' => 
	`¬¿y
('user_register'),

928 'ty³' => 
MENU_LOCAL_TASK
,

932 
$™ems
['u£r/·sswÜd'] = 
	`¬¿y
(

935 '·g¬gum’ts' => 
	`¬¿y
('user_pass'),

937 'ty³' => 
MENU_LOCAL_TASK
,

940 
$™ems
['u£r/»£t/%/%/%'] = 
	`¬¿y
(

943 '·g¬gum’ts' => 
	`¬¿y
('user_pass_reset', 2, 3, 4),

944 'acûs ÿÎback' => 
TRUE
,

945 'ty³' => 
MENU_CALLBACK
,

950 
$™ems
['admš/u£r'] = 
	`¬¿y
(

955 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

957 'f·th' => 
	`dru·l_g‘_·th
('module', 'system'),

959 
$™ems
['admš/u£r/u£r'] = 
	`¬¿y
(

963 '·g¬gum’ts' => 
	`¬¿y
('list'),

964 'acûs ¬gum’ts' => 
	`¬¿y
('administer users'),

967 
$™ems
['admš/u£r/u£r/li¡'] = 
	`¬¿y
(

969 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

972 
$™ems
['admš/u£r/u£r/ü—‹'] = 
	`¬¿y
(

974 '·g¬gum’ts' => 
	`¬¿y
('create'),

975 'acûs ¬gum’ts' => 
	`¬¿y
('administer users'),

976 'ty³' => 
MENU_LOCAL_TASK
,

979 
$™ems
['admš/u£r/£‰šgs'] = 
	`¬¿y
(

983 '·g¬gum’ts' => 
	`¬¿y
('user_admin_settings'),

984 'acûs ¬gum’ts' => 
	`¬¿y
('administer users'),

989 
$™ems
['admš/u£r/³rmissiÚs'] = 
	`¬¿y
(

993 '·g¬gum’ts' => 
	`¬¿y
('user_admin_perm'),

994 'acûs ¬gum’ts' => 
	`¬¿y
('administer…ermissions'),

997 
$™ems
['admš/u£r/rŞes'] = 
	`¬¿y
(

1001 '·g¬gum’ts' => 
	`¬¿y
('user_admin_new_role'),

1002 'acûs ¬gum’ts' => 
	`¬¿y
('administer…ermissions'),

1005 
$™ems
['admš/u£r/rŞes/ed™'] = 
	`¬¿y
(

1007 '·g¬gum’ts' => 
	`¬¿y
('user_admin_role'),

1008 'acûs ¬gum’ts' => 
	`¬¿y
('administer…ermissions'),

1009 'ty³' => 
MENU_CALLBACK
,

1012 
$™ems
['admš/u£r/ruËs'] = 
	`¬¿y
(

1016 'acûs ¬gum’ts' => 
	`¬¿y
('administer…ermissions'),

1019 
$™ems
['admš/u£r/ruËs/li¡'] = 
	`¬¿y
(

1021 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

1024 
$™ems
['admš/u£r/ruËs/add'] = 
	`¬¿y
(

1027 'acûs ¬gum’ts' => 
	`¬¿y
('administer…ermissions'),

1028 'ty³' => 
MENU_LOCAL_TASK
,

1031 
$™ems
['admš/u£r/ruËs/check'] = 
	`¬¿y
(

1034 'acûs ¬gum’ts' => 
	`¬¿y
('administer…ermissions'),

1035 'ty³' => 
MENU_LOCAL_TASK
,

1038 
$™ems
['admš/u£r/ruËs/ed™'] = 
	`¬¿y
(

1041 'acûs ¬gum’ts' => 
	`¬¿y
('administer…ermissions'),

1042 'ty³' => 
MENU_CALLBACK
,

1045 
$™ems
['admš/u£r/ruËs/d–‘e'] = 
	`¬¿y
(

1048 '·g¬gum’ts' => 
	`¬¿y
('user_admin_access_delete_confirm'),

1049 'acûs ¬gum’ts' => 
	`¬¿y
('administer…ermissions'),

1050 'ty³' => 
MENU_CALLBACK
,

1054 
$™ems
['logout'] = 
	`¬¿y
(

1062 
$™ems
['u£r/%u£r_uid_İtiÚ®'] = 
	`¬¿y
(

1065 't™Ë‡rgum’ts' => 
	`¬¿y
(1),

1067 '·g¬gum’ts' => 
	`¬¿y
(1),

1069 'acûs ¬gum’ts' => 
	`¬¿y
(1),

1074 
$™ems
['u£r/%u£r/v›w'] = 
	`¬¿y
(

1076 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

1080 
$™ems
['u£r/%u£r/d–‘e'] = 
	`¬¿y
(

1083 '·g¬gum’ts' => 
	`¬¿y
('user_confirm_delete', 1),

1085 'acûs ¬gum’ts' => 
	`¬¿y
('administer users'),

1086 'ty³' => 
MENU_CALLBACK
,

1090 
$™ems
['u£r/%u£r_ÿ‹gÜy/ed™'] = 
	`¬¿y
(

1093 '·g¬gum’ts' => 
	`¬¿y
(1),

1095 'acûs ¬gum’ts' => 
	`¬¿y
(1),

1096 'ty³' => 
MENU_LOCAL_TASK
,

1097 'lßd‡rgum’ts' => 
	`¬¿y
('%map', '%index'),

1101 
$™ems
['u£r/%u£r_ÿ‹gÜy/ed™/accouÁ'] = 
	`¬¿y
(

1103 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

1104 'lßd‡rgum’ts' => 
	`¬¿y
('%map', '%index'),

1107 
$em±y_accouÁ
 = 
Ãw
 
	`¡dCÏss
();

1108 ià((
$ÿ‹gÜ›s
 = 
	`_u£r_ÿ‹gÜ›s
(
$em±y_accouÁ
)è&& (
	`couÁ
($categories) > 1)) {

1109 
	`fÜ—ch
 (
$ÿ‹gÜ›s
 
as
 
$key
 => 
$ÿ‹gÜy
) {

1111 ià(
$ÿ‹gÜy
['name'] != 'account') {

1112 
$™ems
['u£r/%u£r_ÿ‹gÜy/ed™/'. 
$ÿ‹gÜy
['Çme']] = 
	`¬¿y
(

1114 't™Ë‡rgum’ts' => 
	`¬¿y
(
$ÿ‹gÜy
['title']),

1116 '·g¬gum’ts' => 
	`¬¿y
(1, 3),

1117 'acûs ÿÎback' => 
	`is£t
(
$ÿ‹gÜy
['access callback']) ? $category['access callback'] : 'user_edit_access',

1118 'acûs ¬gum’ts' => 
	`is£t
(
$ÿ‹gÜy
['acûs ¬gum’ts']è? $ÿ‹gÜy['acûs ¬gum’ts'] : 
	`¬¿y
(1),

1119 'ty³' => 
MENU_LOCAL_TASK
,

1120 'weight' => 
$ÿ‹gÜy
['weight'],

1121 'lßd‡rgum’ts' => 
	`¬¿y
('%map', '%index'),

1128  
$™ems
;

1129 
	}
}

1134 
funùiÚ
 
	$u£r_š™
() {

1135 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'user') .'/user.css', 'module');

1136 
	}
}

1150 
funùiÚ
 
	$u£r_uid_İtiÚ®_lßd
(
$uid
 = 
NULL
) {

1151 ià(!
	`is£t
(
$uid
)) {

1152 
$uid
 = 
$GLOBALS
['u£r']->
uid
;

1154  
	`u£r_lßd
(
$uid
);

1155 
	}
}

1160 
funùiÚ
 
	$u£r_ÿ‹gÜy_lßd
(
$uid
, &
$m­
, 
$šdex
) {

1161 
$u£r_ÿ‹gÜ›s
, 
$accouÁs
;

1164 ià(!
	`is£t
(
$accouÁs
[
$uid
])) {

1165 
$accouÁs
[
$uid
] = 
	`u£r_lßd
($uid);

1167 
$v®id
 = 
TRUE
;

1168 ià((
$accouÁ
 = 
$accouÁs
[
$uid
]è&& 
	`is£t
(
$m­
[
$šdex
 + 1]) && $map[$index + 1] == 'edit') {

1171 
$ÿ‹gÜy_šdex
 = 
$šdex
 + 2;

1173 
$ÿ‹gÜy_·th
 = 
	`im¶ode
('/', 
	`¬¿y_¦iû
(
$m­
, 
$ÿ‹gÜy_šdex
));

1174 ià(
$ÿ‹gÜy_·th
) {

1176 
$v®id
 = 
FALSE
;

1177 ià(!
	`is£t
(
$u£r_ÿ‹gÜ›s
)) {

1178 
$em±y_accouÁ
 = 
Ãw
 
	`¡dCÏss
();

1179 
$u£r_ÿ‹gÜ›s
 = 
	`_u£r_ÿ‹gÜ›s
(
$em±y_accouÁ
);

1181 
	`fÜ—ch
 (
$u£r_ÿ‹gÜ›s
 
as
 
$ÿ‹gÜy
) {

1182 ià(
$ÿ‹gÜy
['Çme'] =ğ
$ÿ‹gÜy_·th
) {

1183 
$v®id
 = 
TRUE
;

1185 
$m­
 = 
	`¬¿y_¦iû
($m­, 0, 
$ÿ‹gÜy_šdex
);

1187 
$m­
[
$ÿ‹gÜy_šdex
] = 
$ÿ‹gÜy_·th
;

1193  
$v®id
 ? 
$accouÁ
 : 
FALSE
;

1194 
	}
}

1199 
funùiÚ
 
	$u£r_uid_İtiÚ®_to_¬g
(
$¬g
) {

1203  
	`em±y
(
$¬g
è|| $¬g =ğ'%' ? 
$GLOBALS
['u£r']->
uid
 : $arg;

1204 
	}
}

1209 
funùiÚ
 
	$u£r_·ge_t™Ë
(
$accouÁ
) {

1210 ià(
$accouÁ
->
uid
 =ğ
$GLOBALS
['user']->uid) {

1211  
	`t
('My‡ccount');

1213  
$accouÁ
->
Çme
;

1214 
	}
}

1224 
funùiÚ
 
	$u£r_g‘_authm­s
(
$authÇme
 = 
NULL
) {

1225 
$»suÉ
 = 
	`db_qu”y
("SELECT‡uthÇme, moduË FROM {authm­} WHERE‡uthÇmğ'%s'", 
$authÇme
);

1226 
$authm­s
 = 
	`¬¿y
();

1227 
$has_rows
 = 
FALSE
;

1228 
$authm­
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1229 
$authm­s
[
$authm­
->
moduË
] = $authm­->
authÇme
;

1230 
$has_rows
 = 
TRUE
;

1232  
$has_rows
 ? 
$authm­s
 : 0;

1233 
	}
}

1247 
funùiÚ
 
	$u£r_£t_authm­s
(
$accouÁ
, 
$authm­s
) {

1248 
	`fÜ—ch
 (
$authm­s
 
as
 
$key
 => 
$v®ue
) {

1249 
$moduË
 = 
	`ex¶ode
('_', 
$key
, 2);

1250 ià(
$v®ue
) {

1251 
	`db_qu”y
("UPDATE {authm­} SET‡uthÇmğ'%s' WHERE uid = %d AND moduË = '%s'", 
$v®ue
, 
$accouÁ
->
uid
, 
$moduË
[1]);

1252 ià(!
	`db_afãùed_rows
()) {

1253 @
	`db_qu”y
("INSERT INTO {authm­} (authÇme, uid, moduËèVALUES ('%s', %d, '%s')", 
$v®ue
, 
$accouÁ
->
uid
, 
$moduË
[1]);

1257 
	`db_qu”y
("DELETE FROM {authm­} WHERE uid = %d AND moduË = '%s'", 
$accouÁ
->
uid
, 
$moduË
[1]);

1260 
	}
}

1267 
funùiÚ
 
	$u£r_logš
(&
$fÜm_¡©e
) {

1268 
glob®
 
$u£r
;

1271 ià(
$u£r
->
uid
) {

1272 
	`dru·l_gÙo
('u£r/'. 
$u£r
->
uid
);

1276 
$fÜm
['Çme'] = 
	`¬¿y
('#type' => 'textfield',

1277 '#t™Ë' => 
	`t
('Username'),

1279 '#maxËngth' => 
USERNAME_MAX_LENGTH
,

1280 '#»quœed' => 
TRUE
,

1283 
$fÜm
['Çme']['#desütiÚ'] = 
	`t
('EÁ” you¸@ u£ºame.', 
	`¬¿y
('@s' => 
	`v¬ŸbË_g‘
('site_name', 'Drupal')));

1284 
$fÜm
['·ss'] = 
	`¬¿y
('#type' => 'password',

1285 '#t™Ë' => 
	`t
('Password'),

1286 '#desütiÚ' => 
	`t
('Enterhe…asswordhat‡ccompanies your username.'),

1287 '#»quœed' => 
TRUE
,

1289 
$fÜm
['#v®id©e'] = 
	`u£r_logš_deçuÉ_v®id©Üs
();

1290 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Log in'), '#weight' => 2);

1292  
$fÜm
;

1293 
	}
}

1312 
funùiÚ
 
	$u£r_logš_deçuÉ_v®id©Üs
() {

1313  
	`¬¿y
('user_login_name_validate', 'user_login_authenticate_validate', 'user_login_final_validate');

1314 
	}
}

1320 
funùiÚ
 
	$u£r_logš_Çme_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

1321 ià(
	`is£t
(
$fÜm_¡©e
['values']['name'])) {

1322 ià(
	`u£r_is_blocked
(
$fÜm_¡©e
['values']['name'])) {

1324 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('Thu£ºam%Çmha nÙ b“Àaùiv©ed o¸i blocked.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['name'])));

1326 ià(
	`dru·l_is_d’›d
('u£r', 
$fÜm_¡©e
['values']['name'])) {

1328 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('ThÇm%Çmi ¨»£rved u£ºame.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['name'])));

1331 
	}
}

1337 
funùiÚ
 
	$u£r_logš_auth’tiÿ‹_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

1338 
	`u£r_auth’tiÿ‹
(
$fÜm_¡©e
['values']);

1339 
	}
}

1345 
funùiÚ
 
	$u£r_logš_fš®_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

1346 
glob®
 
$u£r
;

1347 ià(!
$u£r
->
uid
) {

1348 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('SÜry, uÄecognized u£ºamÜ…asswÜd. <¨h»f="@·sswÜd">Havyou fÜgÙ‹Àyou¸·sswÜd?</a>', 
	`¬¿y
('@·sswÜd' => 
	`u¾
('user/password'))));

1350 
	}
}

1362 
funùiÚ
 
u£r_auth’tiÿ‹
(
$fÜm_v®ues
 = 
	$¬¿y
()) {

1363 
glob®
 
$u£r
;

1368 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('Çme' => 
$fÜm_v®ues
['Çme'], '·ss' => 
	`Œim
($form_values['pass']), 'status' => 1));

1369 ià(
$accouÁ
 && 
	`dru·l_is_d’›d
('ma', $accouÁ->
ma
)) {

1370 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('ThÇm%Çmi »gi¡”ed usšg‡„e£rvedƒ-ma‡dd»s ªdh”efÜcould‚Ù blogged in.', 
	`¬¿y
('%Çme' => 
$accouÁ
->
Çme
)));

1376 ià(!
	`fÜm_g‘_”rÜs
(è&& !
	`em±y
(
$fÜm_v®ues
['Çme']è&& !em±y($fÜm_v®ues['·ss']è&& 
$accouÁ
) {

1377 
$u£r
 = 
$accouÁ
;

1378 
	`u£r_auth’tiÿ‹_fš®ize
(
$fÜm_v®ues
);

1379  
$u£r
;

1382 
	`w©chdog
('u£r', 'Logš‡‰em± faed fÜ %u£r.', 
	`¬¿y
('%u£r' => 
$fÜm_v®ues
['name']));

1384 
	}
}

1395 
funùiÚ
 
	$u£r_auth’tiÿ‹_fš®ize
(&
$ed™
) {

1396 
glob®
 
$u£r
;

1397 
	`w©chdog
('u£r', 'SessiÚ o³Ãd fÜ %Çme.', 
	`¬¿y
('%Çme' => 
$u£r
->
Çme
));

1400 
$u£r
->
logš
 = 
	`time
();

1401 
	`db_qu”y
("UPDATE {u£rs} SET†ogš = %d WHERE uid = %d", 
$u£r
->
logš
, $u£r->
uid
);

1404 
	`£ss_»g’”©e
();

1405 
	`u£r_moduË_švoke
('logš', 
$ed™
, 
$u£r
);

1406 
	}
}

1414 
funùiÚ
 
	$u£r_logš_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1415 
glob®
 
$u£r
;

1416 ià(
$u£r
->
uid
) {

1417 
$fÜm_¡©e
['»dœeù'] = 'u£r/'. 
$u£r
->
uid
;

1420 
	}
}

1427 
funùiÚ
 
	$u£r_ex‹º®_logš_»gi¡”
(
$Çme
, 
$moduË
) {

1428 
glob®
 
$u£r
;

1430 
$exi¡šg_u£r
 = 
	`u£r_lßd
(
	`¬¿y
('Çme' => 
$Çme
));

1431 ià(
	`is£t
(
$exi¡šg_u£r
->
uid
)) {

1432 
$u£r
 = 
$exi¡šg_u£r
;

1436 
$u£ršfo
 = 
	`¬¿y
(

1437 'Çme' => 
$Çme
,

1438 '·ss' => 
	`u£r_·sswÜd
(),

1439 'š™' => 
$Çme
,

1441 "authÇme_$moduË" => 
$Çme
,

1442 'acûss' => 
	`time
()

1444 
$accouÁ
 = 
	`u£r_§ve
('', 
$u£ršfo
);

1446 ià(!
$accouÁ
) {

1447 
	`dru·l_£t_mes§ge
(
	`t
("Error saving user‡ccount."), 'error');

1450 
$u£r
 = 
$accouÁ
;

1451 
	`w©chdog
('u£r', 'Newƒx‹º® u£r: %Çmusšg moduË %moduË.', 
	`¬¿y
('%Çme' => 
$Çme
, '%moduË' => 
$moduË
), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('ed™'), 'u£r/'. 
$u£r
->
uid
 .'/edit'));

1453 
	}
}

1465 
funùiÚ
 
	$u£r_·ss_»£t_u¾
(
$accouÁ
) {

1466 
$time¡amp
 = 
	`time
();

1467  
	`u¾
("u£r/»£t/$accouÁ->uid/$time¡amp/". 
	`u£r_·ss_»hash
(
$accouÁ
->
·ss
, 
$time¡amp
, $accouÁ->
logš
), 
	`¬¿y
('absŞu‹' => 
TRUE
));

1468 
	}
}

1470 
funùiÚ
 
	$u£r_·ss_»hash
(
$·sswÜd
, 
$time¡amp
, 
$logš
) {

1471  
	`md5
(
$time¡amp
 . 
$·sswÜd
 . 
$logš
);

1472 
	}
}

1474 
funùiÚ
 
	$u£r_ed™_fÜm
(&
$fÜm_¡©e
, 
$uid
, 
$ed™
, 
$»gi¡”
 = 
FALSE
) {

1475 
	`_u£r_·sswÜd_dyÇmic_v®id©iÚ
();

1476 
$admš
 = 
	`u£r_acûss
('administer users');

1479 
$fÜm
['accouÁ'] = 
	`¬¿y
('#type' => 'fieldset',

1480 '#t™Ë' => 
	`t
('Account information'),

1484 ià(
$»gi¡”
 || (
$GLOBALS
['u£r']->
uid
 =ğ
$uid
 && 
	`u£r_acûss
('chªgowÀu£ºame')è|| 
$admš
) {

1485 
$fÜm
['accouÁ']['Çme'] = 
	`¬¿y
('#type' => 'textfield',

1486 '#t™Ë' => 
	`t
('Username'),

1487 '#deçuÉ_v®ue' => 
$ed™
['name'],

1488 '#maxËngth' => 
USERNAME_MAX_LENGTH
,

1489 '#desütiÚ' => 
	`t
('Spaces‡re‡llowed;…unctuation is‚ot‡llowedƒxcept for…eriods, hyphens,‡nd underscores.'),

1490 '#»quœed' => 
TRUE
,

1493 
$fÜm
['accouÁ']['ma'] = 
	`¬¿y
('#type' => 'textfield',

1494 '#t™Ë' => 
	`t
('E-mail‡ddress'),

1495 '#deçuÉ_v®ue' => 
$ed™
['mail'],

1496 '#maxËngth' => 
EMAIL_MAX_LENGTH
,

1497 '#desütiÚ' => 
	`t
('A validƒ-mail‡ddress. Allƒ-mails fromhe system will be sentohis‡ddress. Theƒ-mail‡ddress is‚ot made…ublic‡nd will only be used if you wisho„eceive‡‚ew…assword or wisho„eceive certain‚ews or‚otifications byƒ-mail.'),

1498 '#»quœed' => 
TRUE
,

1500 ià(!
$»gi¡”
) {

1501 
$fÜm
['accouÁ']['·ss'] = 
	`¬¿y
('#type' => 'password_confirm',

1502 '#desütiÚ' => 
	`t
('To changehe current user…assword,ƒnterhe‚ew…assword in both fields.'),

1506 
	`–£if
 (!
	`v¬ŸbË_g‘
('u£r_ema_v”ifiÿtiÚ', 
TRUE
è|| 
$admš
) {

1507 
$fÜm
['accouÁ']['·ss'] = 
	`¬¿y
(

1509 '#desütiÚ' => 
	`t
('Provide‡…assword forhe‚ew‡ccount in both fields.'),

1510 '#»quœed' => 
TRUE
,

1514 ià(
$admš
) {

1515 
$fÜm
['accouÁ']['¡©us'] = 
	`¬¿y
(

1517 '#t™Ë' => 
	`t
('Status'),

1518 '#deçuÉ_v®ue' => 
	`is£t
(
$ed™
['status']) ? $edit['status'] : 1,

1519 '#İtiÚs' => 
	`¬¿y
(
	`t
('Blocked'),('Active'))

1522 ià(
	`u£r_acûss
('administer…ermissions')) {

1523 
$rŞes
 = 
	`u£r_rŞes
(
TRUE
);

1530 
$checkbox_auth’tiÿ‹d
 = 
	`¬¿y
(

1532 '#t™Ë' => 
$rŞes
[
DRUPAL_AUTHENTICATED_RID
],

1533 '#deçuÉ_v®ue' => 
TRUE
,

1534 '#di§bËd' => 
TRUE
,

1537 
	`un£t
(
$rŞes
[
DRUPAL_AUTHENTICATED_RID
]);

1538 ià(
$rŞes
) {

1539 
$deçuÉ
 = 
	`em±y
(
$ed™
['rŞes']è? 
	`¬¿y
(è: 
	`¬¿y_keys
($edit['roles']);

1540 
$fÜm
['accouÁ']['rŞes'] = 
	`¬¿y
(

1542 '#t™Ë' => 
	`t
('Roles'),

1543 '#deçuÉ_v®ue' => 
$deçuÉ
,

1544 '#İtiÚs' => 
$rŞes
,

1545 
DRUPAL_AUTHENTICATED_RID
 => 
$checkbox_auth’tiÿ‹d
,

1551 ià(
	`v¬ŸbË_g‘
('u£r_sigÇtu»s', 0è&& 
	`moduË_exi¡s
('comm’t'è&& !
$»gi¡”
) {

1552 
$fÜm
['sigÇtu»_£‰šgs'] = 
	`¬¿y
(

1554 '#t™Ë' => 
	`t
('Signature settings'),

1557 
$fÜm
['sigÇtu»_£‰šgs']['sigÇtu»'] = 
	`¬¿y
(

1559 '#t™Ë' => 
	`t
('Signature'),

1560 '#deçuÉ_v®ue' => 
$ed™
['signature'],

1561 '#desütiÚ' => 
	`t
('Your signature will be…ublicly displayed‡theƒnd of your comments.'),

1566 ià(!
	`f‹r_acûss
(
$ed™
['sigÇtu»_fÜm©']è&& 
	`em±y
(
$_POST
)) {

1567 
	`dru·l_£t_mes§ge
(
	`t
("The signature input format has been seto‡ format you don't have‡ccesso. It will be changedo‡ format you have‡ccesso when you savehis…age."));

1568 
$ed™
['sigÇtu»_fÜm©'] = 
FILTER_FORMAT_DEFAULT
;

1571 
$fÜm
['sigÇtu»_£‰šgs']['sigÇtu»_fÜm©'] = 
	`f‹r_fÜm
(
$ed™
['sigÇtu»_fÜm©'], 
NULL
, 
	`¬¿y
('signature_format'));

1575 ià(
	`v¬ŸbË_g‘
('u£r_piùu»s', 0è&& !
$»gi¡”
) {

1576 
$fÜm
['piùu»'] = 
	`¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
	`t
('Picture'), '#weight' => 1);

1577 
$piùu»
 = 
	`theme
('u£r_piùu»', (
objeù
)
$ed™
);

1578 ià(
$ed™
['picture']) {

1579 
$fÜm
['piùu»']['cu¼’t_piùu»'] = 
	`¬¿y
('#v®ue' => 
$piùu»
);

1580 
$fÜm
['piùu»']['piùu»_d–‘e'] = 
	`¬¿y
('#ty³' => 'checkbox', '#t™Ë' => 
	`t
('Delete…icture'), '#description' =>('Checkhis boxo delete your current…icture.'));

1583 
$fÜm
['piùu»']['piùu»_d–‘e'] = 
	`¬¿y
('#type' => 'hidden');

1585 
$fÜm
['piùu»']['piùu»_u¶ßd'] = 
	`¬¿y
('#ty³' => 'fe', '#t™Ë' => 
	`t
('U¶ßd…iùu»'), '#size' => 48, '#desütiÚ' =>('You¸vœtu® faû o¸piùu». Maximum dim’siÚ ¬%dim’siÚ ªdhmaximum sizi %sizkB.',‡¼ay('%dim’siÚs' => 
	`v¬ŸbË_g‘
('user_picture_dimensions', '85x85'), '%size' => variable_get('user_picture_file_size', '30'))) .' '. variable_get('user_picture_guidelines', ''));

1586 
$fÜm
['#validate'][] = 'user_profile_form_validate';

1587 
$fÜm
['#validate'][] = 'user_validate_picture';

1589 
$fÜm
['#uid'] = 
$uid
;

1591  
$fÜm
;

1592 
	}
}

1594 
funùiÚ
 
	$_u£r_ed™_v®id©e
(
$uid
, &
$ed™
) {

1596 ià(!
$uid
 || (
$GLOBALS
['u£r']->
uid
 =ğ$uid && 
	`u£r_acûss
('change own username')) || user_access('administer users')) {

1597 ià(
$”rÜ
 = 
	`u£r_v®id©e_Çme
(
$ed™
['name'])) {

1598 
	`fÜm_£t_”rÜ
('Çme', 
$”rÜ
);

1600 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {u£rs} WHERE uid !ğ%d AND LOWERÒameèğLOWER('%s')", 
$uid
, 
$ed™
['name'])) > 0) {

1601 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('ThÇm%Çmi ®»adyak’.', 
	`¬¿y
('%Çme' => 
$ed™
['name'])));

1603 ià(
	`dru·l_is_d’›d
('u£r', 
$ed™
['name'])) {

1604 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('ThÇm%Çmha b“Àd’›d‡cûss.', 
	`¬¿y
('%Çme' => 
$ed™
['name'])));

1609 ià(
$”rÜ
 = 
	`u£r_v®id©e_ma
(
$ed™
['mail'])) {

1610 
	`fÜm_£t_”rÜ
('ma', 
$”rÜ
);

1612 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {u£rs} WHERE uid !ğ%d AND LOWER(maèğLOWER('%s')", 
$uid
, 
$ed™
['mail'])) > 0) {

1613 
	`fÜm_£t_”rÜ
('ma', 
	`t
('The-ma‡dd»s %ema i ®»ady„egi¡”ed. <¨h»f="@·sswÜd">Havyou fÜgÙ‹Àyou¸·sswÜd?</a>', 
	`¬¿y
('%ema' => 
$ed™
['ma'], '@·sswÜd' => 
	`u¾
('user/password'))));

1615 ià(
	`dru·l_is_d’›d
('ma', 
$ed™
['mail'])) {

1616 
	`fÜm_£t_”rÜ
('ma', 
	`t
('The-ma‡dd»s %ema ha b“Àd’›d‡cûss.', 
	`¬¿y
('%ema' => 
$ed™
['mail'])));

1618 
	}
}

1620 
funùiÚ
 
	$_u£r_ed™_subm™
(
$uid
, &
$ed™
) {

1621 
$accouÁ
 = 
	`u£r_lßd
(
$uid
);

1623 ià(!
	`em±y
(
$ed™
['picture_delete'])) {

1624 ià(
$accouÁ
->
piùu»
 && 
	`fe_exi¡s
($account->picture)) {

1625 
	`fe_d–‘e
(
$accouÁ
->
piùu»
);

1627 
$ed™
['picture'] = '';

1629 ià(
	`is£t
(
$ed™
['roles'])) {

1630 
$ed™
['rŞes'] = 
	`¬¿y_f‹r
($edit['roles']);

1632 
	}
}

1640 
funùiÚ
 
	$u£r_d–‘e
(
$ed™
, 
$uid
) {

1641 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => 
$uid
));

1642 
	`£ss_de¡roy_uid
(
$uid
);

1643 
	`_u£r_ma_nÙify
('¡©us_d–‘ed', 
$accouÁ
);

1644 
	`db_qu”y
('DELETE FROM {u£rs} WHERE uid = %d', 
$uid
);

1645 
	`db_qu”y
('DELETE FROM {u£rs_rŞes} WHERE uid = %d', 
$uid
);

1646 
	`db_qu”y
('DELETE FROM {authm­} WHERE uid = %d', 
$uid
);

1647 
$v¬ŸbËs
 = 
	`¬¿y
('%Çme' => 
$accouÁ
->
Çme
, '%ema' => '<'. $accouÁ->
ma
 .'>');

1648 
	`w©chdog
('u£r', 'D–‘ed u£r: %Çm%ema.', 
$v¬ŸbËs
, 
WATCHDOG_NOTICE
);

1649 
	`u£r_moduË_švoke
('d–‘e', 
$ed™
, 
$accouÁ
);

1650 
	}
}

1661 
funùiÚ
 
	$u£r_bud_cÚ‹Á
(&
$accouÁ
) {

1662 
$ed™
 = 
NULL
;

1663 
	`u£r_moduË_švoke
('v›w', 
$ed™
, 
$accouÁ
);

1665 
	`dru·l_®‹r
('´ofe', 
$accouÁ
);

1667  
$accouÁ
->
cÚ‹Á
;

1668 
	}
}

1673 
funùiÚ
 
	$u£r_ma
(
$key
, &
$mes§ge
, 
$·¿ms
) {

1674 
$Ïnguage
 = 
$mes§ge
['language'];

1675 
$v¬ŸbËs
 = 
	`u£r_ma_tok’s
(
$·¿ms
['accouÁ'], 
$Ïnguage
);

1676 
$mes§ge
['subjeù'] .ğ
	`_u£r_ma_‹xt
(
$key
 .'_subjeù', 
$Ïnguage
, 
$v¬ŸbËs
);

1677 
$mes§ge
['body'][] = 
	`_u£r_ma_‹xt
(
$key
 .'_body', 
$Ïnguage
, 
$v¬ŸbËs
);

1678 
	}
}

1685 
funùiÚ
 
_u£r_ma_‹xt
(
$key
, 
$Ïnguage
 = 
NULL
, 
$v¬ŸbËs
 = 
	$¬¿y
()) {

1686 
$Ïngcode
 = 
	`is£t
(
$Ïnguage
è? $Ïnguage->
Ïnguage
 : 
NULL
;

1688 ià(
$admš_£‰šg
 = 
	`v¬ŸbË_g‘
('u£r_ma_'. 
$key
, 
FALSE
)) {

1690  
	`¡¹r
(
$admš_£‰šg
, 
$v¬ŸbËs
);

1694 
$key
) {

1696  
	`t
('AccouÁ d‘a fÜ !u£ºam© !s™e', 
$v¬ŸbËs
, 
$Ïngcode
);

1698  
	`t
("!u£ºame,\n\nThªk you fÜ„egi¡”šg‡ˆ!s™e. You may‚ow†og iÀtØ!logš_ur˜usšghfŞlowšg u£ºamªd…asswÜd:\n\nu£ºame: !u£ºame\ÅasswÜd: !·sswÜd\n\nYou may‡lsØlog iÀby clickšg oÀthi lšk o¸cİyšg‡nd…a¡šg iˆš you¸brow£r:\n\n!logš_u¾\n\nThi i ¨Úe-timlogš, sØ™ cª bu£d oÆy onû.\n\nAá”†oggšg in, you wÈb»dœeùedØ!ed™_ur˜sØyou cª chªgyou¸·sswÜd.\n\n\n-- !s™‹am", 
$v¬ŸbËs
, 
$Ïngcode
);

1700  
	`t
('AÀadmši¡¿tÜ c»©ed‡ÀaccouÁ fÜ you‡ˆ!s™e', 
$v¬ŸbËs
, 
$Ïngcode
);

1702  
	`t
("!u£ºame,\n\nA s™admši¡¿tÜ‡ˆ!s™ha ü—‹d‡ÀaccouÁ fÜ you. You may‚ow†og iÀtØ!logš_ur˜usšghfŞlowšg u£ºamªd…asswÜd:\n\nu£ºame: !u£ºame\ÅasswÜd: !·sswÜd\n\nYou may‡lsØlog iÀby clickšg oÀthi lšk o¸cİyšg‡nd…a¡šg iˆš you¸brow£r:\n\n!logš_u¾\n\nThi i ¨Úe-timlogš, sØ™ cª bu£d oÆy onû.\n\nAá”†oggšg in, you wÈb»dœeùedØ!ed™_ur˜sØyou cª chªgyou¸·sswÜd.\n\n\n-- !s™‹am", 
$v¬ŸbËs
, 
$Ïngcode
);

1705  
	`t
('AccouÁ d‘a fÜ !u£ºam© !s™Õ’dšg‡dmš‡µrov®)', 
$v¬ŸbËs
, 
$Ïngcode
);

1707  
	`t
("!u£ºame,\n\nThªk you fÜ„egi¡”šg‡ˆ!s™e. You¸­¶iÿtiÚ fÜ‡ÀaccouÁ i cu¼’y…’dšg‡µrov®. Onû iˆha b“À­´oved, you wÈ»ûivªÙh”ƒ-ma cÚššg infÜm©iÚ‡bouˆhowØlog in, s‘ you¸·sswÜd,‡nd oth” d‘as.\n\n\n-- !s™‹am", 
$v¬ŸbËs
, 
$Ïngcode
);

1709  
	`t
("!u£ºamha ­¶›d fÜ‡ÀaccouÁ.\n\n!ed™_uri", 
$v¬ŸbËs
, 
$Ïngcode
);

1711  
	`t
('R•Ïûm’ˆlogš infÜm©iÚ fÜ !u£ºam© !s™e', 
$v¬ŸbËs
, 
$Ïngcode
);

1713  
	`t
("!u£ºame,\n\nA„eque¡Ø»£ˆth·sswÜd fÜ you¸accouÁ ha b“Àmad© !s™e.\n\nYou may‚ow†og iÀtØ!uri_br›àby clickšg oÀthi lšk o¸cİyšg‡nd…a¡šg iˆš you¸brow£r:\n\n!logš_u¾\n\nThi i ¨Úe-timlogš, sØ™ cª bu£d oÆy onû. Iˆexpœe aá” oÃ day‡nd‚Ùhšg wÈh­³Àià™' nÙ u£d.\n\nAá”†oggšg in, you wÈb»dœeùedØ!ed™_ur˜sØyou cª chªgyou¸·sswÜd.", 
$v¬ŸbËs
, 
$Ïngcode
);

1715  
	`t
('AccouÁ d‘a fÜ !u£ºam© !s™×µroved)', 
$v¬ŸbËs
, 
$Ïngcode
);

1717  
	`t
("!u£ºame,\n\nYou¸accouÁ‡ˆ!s™ha b“Àaùiv©ed.\n\nYou may‚ow†og iÀby clickšg oÀthi lšk o¸cİyšg‡nd…a¡šg iˆš you¸brow£r:\n\n!logš_u¾\n\nThi i ¨Úe-timlogš, sØ™ cª bu£d oÆy onû.\n\nAá”†oggšg in, you wÈb»dœeùedØ!ed™_ur˜sØyou cª chªgyou¸·sswÜd.\n\nOnû you hav£ˆyou¸owÀ·sswÜd, you wÈbabËØlog iÀtØ!logš_ur˜šhfutu» usšg:\n\nu£ºame: !u£ºame\n", 
$v¬ŸbËs
, 
$Ïngcode
);

1719  
	`t
('AccouÁ d‘a fÜ !u£ºam© !s™(blocked)', 
$v¬ŸbËs
, 
$Ïngcode
);

1721  
	`t
("!u£ºame,\n\nYou¸accouÁ oÀ!s™ha b“Àblocked.", 
$v¬ŸbËs
, 
$Ïngcode
);

1723  
	`t
('AccouÁ d‘a fÜ !u£ºam© !s™(d–‘ed)', 
$v¬ŸbËs
, 
$Ïngcode
);

1725  
	`t
("!u£ºame,\n\nYou¸accouÁ oÀ!s™ha b“Àd–‘ed.", 
$v¬ŸbËs
, 
$Ïngcode
);

1728 
	}
}

1745 
funùiÚ
 
	$u£r_rŞes
(
$memb”sÚly
 = 
FALSE
, 
$³rmissiÚ
 = 
NULL
) {

1747 
$rŞes
 = 
	`¬¿y
(

1748 
DRUPAL_ANONYMOUS_RID
 => 
NULL
,

1749 
DRUPAL_AUTHENTICATED_RID
 => 
NULL
,

1752 ià(!
	`em±y
(
$³rmissiÚ
)) {

1753 
$»suÉ
 = 
	`db_qu”y
("SELECT„.* FROM {rŞe}„ INNER JOIN {³rmissiÚ}… ON„.rid =….rid WHERE….³rm LIKE '%%%s%%' ORDER BY„.Çme", 
$³rmissiÚ
);

1756 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {role} ORDER BY‚ame');

1759 
$rŞe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1760 
$rŞe
->
rid
) {

1762 
DRUPAL_ANONYMOUS_RID
:

1763 ià(!
$memb”sÚly
) {

1764 
$rŞes
[
$rŞe
->
rid
] = 
	`t
($rŞe->
Çme
);

1767 
DRUPAL_AUTHENTICATED_RID
:

1768 
$rŞes
[
$rŞe
->
rid
] = 
	`t
($rŞe->
Çme
);

1771 
$rŞes
[
$rŞe
->
rid
] = $rŞe->
Çme
;

1776  
	`¬¿y_f‹r
(
$rŞes
);

1777 
	}
}

1782 
funùiÚ
 
u£r_u£r_İ”©iÚs
(
$fÜm_¡©e
 = 
	$¬¿y
()) {

1783 
$İ”©iÚs
 = 
	`¬¿y
(

1784 'unblock' => 
	`¬¿y
(

1785 'Ïb–' => 
	`t
('Unblockhe selected users'),

1788 'block' => 
	`¬¿y
(

1789 'Ïb–' => 
	`t
('Blockhe selected users'),

1792 'd–‘e' => 
	`¬¿y
(

1793 'Ïb–' => 
	`t
('Deletehe selected users'),

1797 ià(
	`u£r_acûss
('administer…ermissions')) {

1798 
$rŞes
 = 
	`u£r_rŞes
(
TRUE
);

1799 
	`un£t
(
$rŞes
[
DRUPAL_AUTHENTICATED_RID
]);

1801 
$add_rŞes
 = 
	`¬¿y
();

1802 
	`fÜ—ch
 (
$rŞes
 
as
 
$key
 => 
$v®ue
) {

1803 
$add_rŞes
['add_rŞe-'. 
$key
] = 
$v®ue
;

1806 
$»move_rŞes
 = 
	`¬¿y
();

1807 
	`fÜ—ch
 (
$rŞes
 
as
 
$key
 => 
$v®ue
) {

1808 
$»move_rŞes
['»move_rŞe-'. 
$key
] = 
$v®ue
;

1811 ià(
	`couÁ
(
$rŞes
)) {

1812 
$rŞe_İ”©iÚs
 = 
	`¬¿y
(

1813 
	`t
('Add‡„ŞtØth£Ëùed u£rs'è=> 
	`¬¿y
(

1814 'Ïb–' => 
$add_rŞes
,

1816 
	`t
('Remov¨rŞäomh£Ëùed u£rs'è=> 
	`¬¿y
(

1817 'Ïb–' => 
$»move_rŞes
,

1821 
$İ”©iÚs
 +ğ
$rŞe_İ”©iÚs
;

1827 ià(!
	`em±y
(
$fÜm_¡©e
['submitted'])) {

1828 
$İ”©iÚ_rid
 = 
	`ex¶ode
('-', 
$fÜm_¡©e
['values']['operation']);

1829 
$İ”©iÚ
 = 
$İ”©iÚ_rid
[0];

1830 ià(
$İ”©iÚ
 == 'add_role' || $operation == 'remove_role') {

1831 
$rid
 = 
$İ”©iÚ_rid
[1];

1832 ià(
	`u£r_acûss
('administer…ermissions')) {

1833 
$İ”©iÚs
[
$fÜm_¡©e
['v®ues']['İ”©iÚ']] = 
	`¬¿y
(

1835 'ÿÎback‡rgum’ts' => 
	`¬¿y
(
$İ”©iÚ
, 
$rid
),

1839 
	`w©chdog
('£cur™y', 'D‘eùed m®iciou ©‹m±Ø®‹¸´Ùeùed u£¸f›lds.', 
	`¬¿y
(), 
WATCHDOG_WARNING
);

1845  
$İ”©iÚs
;

1846 
	}
}

1851 
funùiÚ
 
	$u£r_u£r_İ”©iÚs_unblock
(
$accouÁs
) {

1852 
	`fÜ—ch
 (
$accouÁs
 
as
 
$uid
) {

1853 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => ()
$uid
));

1855 ià(
$accouÁ
 !=ğ
FALSE
 && $accouÁ->
¡©us
 == 0) {

1856 
	`u£r_§ve
(
$accouÁ
, 
	`¬¿y
('status' => 1));

1859 
	}
}

1864 
funùiÚ
 
	$u£r_u£r_İ”©iÚs_block
(
$accouÁs
) {

1865 
	`fÜ—ch
 (
$accouÁs
 
as
 
$uid
) {

1866 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => ()
$uid
));

1868 ià(
$accouÁ
 !=ğ
FALSE
 && $accouÁ->
¡©us
 == 1) {

1869 
	`u£r_§ve
(
$accouÁ
, 
	`¬¿y
('status' => 0));

1872 
	}
}

1877 
funùiÚ
 
	$u£r_muÉË_rŞe_ed™
(
$accouÁs
, 
$İ”©iÚ
, 
$rid
) {

1880 
$rŞe_Çme
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT‚amFROM {rŞe} WHERE„id = %d', 
$rid
));

1882 
$İ”©iÚ
) {

1884 
	`fÜ—ch
 (
$accouÁs
 
as
 
$uid
) {

1885 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => ()
$uid
));

1887 ià(
$accouÁ
 !=ğ
FALSE
 && !
	`is£t
($accouÁ->
rŞes
[
$rid
])) {

1888 
$rŞes
 = 
$accouÁ
->
rŞes
 + 
	`¬¿y
(
$rid
 => 
$rŞe_Çme
);

1889 
	`u£r_§ve
(
$accouÁ
, 
	`¬¿y
('rŞes' => 
$rŞes
));

1894 
	`fÜ—ch
 (
$accouÁs
 
as
 
$uid
) {

1895 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => ()
$uid
));

1897 ià(
$accouÁ
 !=ğ
FALSE
 && 
	`is£t
($accouÁ->
rŞes
[
$rid
])) {

1898 
$rŞes
 = 
	`¬¿y_diff
(
$accouÁ
->
rŞes
, 
	`¬¿y
(
$rid
 => 
$rŞe_Çme
));

1899 
	`u£r_§ve
(
$accouÁ
, 
	`¬¿y
('rŞes' => 
$rŞes
));

1904 
	}
}

1906 
funùiÚ
 
	$u£r_muÉË_d–‘e_cÚfœm
(&
$fÜm_¡©e
) {

1907 
$ed™
 = 
$fÜm_¡©e
['post'];

1909 
$fÜm
['accouÁs'] = 
	`¬¿y
('#´efix' => '<ul>', '#suffix' => '</ul>', '#Œ“' => 
TRUE
);

1911 
	`fÜ—ch
 (
	`¬¿y_f‹r
(
$ed™
['accouÁs']è
as
 
$uid
 => 
$v®ue
) {

1912 
$u£r
 = 
	`db_»suÉ
(
	`db_qu”y
('SELECT‚amFROM {u£rs} WHERE uid = %d', 
$uid
));

1913 
$fÜm
['accouÁs'][
$uid
] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => $uid, '#´efix' => '<li>', '#suffix' => 
	`check_¶aš
(
$u£r
) ."</li>\n");

1915 
$fÜm
['İ”©iÚ'] = 
	`¬¿y
('#type' => 'hidden', '#value' => 'delete');

1917  
	`cÚfœm_fÜm
(
$fÜm
,

1918 
	`t
('Are you sure you wanto deletehese users?'),

1919 'admš/u£r/u£r', 
	`t
('This‡ction cannot be undone.'),

1920 
	`t
('Delete‡ll'),('Cancel'));

1921 
	}
}

1923 
funùiÚ
 
	$u£r_muÉË_d–‘e_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1924 ià(
$fÜm_¡©e
['values']['confirm']) {

1925 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['accouÁs'] 
as
 
$uid
 => 
$v®ue
) {

1926 
	`u£r_d–‘e
(
$fÜm_¡©e
['v®ues'], 
$uid
);

1928 
	`dru·l_£t_mes§ge
(
	`t
('The users have been deleted.'));

1930 
$fÜm_¡©e
['redirect'] = 'admin/user/user';

1932 
	}
}

1937 
funùiÚ
 
	$u£r_h–p
(
$·th
, 
$¬g
) {

1938 
glob®
 
$u£r
;

1940 
$·th
) {

1942 
$ouut
 = '<p>'. 
	`t
('The user module‡llows userso„egister,†ogin,‡nd†og out. Users benefit from being‡bleo sign on because it‡ssociates contenthey create withheir‡ccount‡nd‡llows various…ermissionso be set forheir„oles. The user module supports user„oles whichƒstablish fine grained…ermissions‡llowingƒach„oleo do only whathe‡dministrator wantshemo. Each user is‡ssignedo one or more„oles. By defaulthere‡rewo„oles <em>anonymous</em> -‡ user who has‚ot†ogged in,‡nd <em>authenticated</em>‡ user who has signed up‡nd who has been‡uthorized.') .'</p>';

1943 
$ouut
 .ğ'<p>'. 
	`t
("Users can useheir own‚ame or handle‡nd can specify…ersonal configuration settingshroughheir individual <em>My‡ccount</em>…age. Users must‡uthenticate by supplying‡†ocal username‡nd…assword orhroughheir OpenID,‡n optional‡nd secure method for†ogging into many websites with‡ single username‡nd…assword. In some configurations, users may‡uthenticate using‡ username‡nd…assword from‡nother Drupal site, orhrough some other site-specific mechanism.") .'</p>';

1944 
$ouut
 .ğ'<p>'. 
	`t
('A visitor‡ccessing your website is‡ssigned‡ unique ID, or session ID, which is stored in‡ cookie. The cookie does‚ot contain…ersonal information, but‡cts‡s‡ keyo„etrieve information from your site. Users should have cookiesƒnabled inheir web browser when using your site.') .'</p>';

1945 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@u£r">U£¸moduË</a>.', 
	`¬¿y
('@user' => 'http://drupal.org/handbook/modules/user/')) .'</p>';

1946  
$ouut
;

1948  '<p>'. 
	`t
('Drupal‡llows userso„egister,†ogin,†og out, maintain user…rofiles,ƒtc. Users ofhe site may‚ot useheir own‚ameso…ost content untilhey have signed up for‡ user‡ccount.') .'</p>';

1951  '<p>'. 
	`t
("This web…age‡llows‡dministratorso„egister‚ew users. Users'ƒ-mail‡ddresses‡nd usernames must be unique.") .'</p>';

1953  '<p>'. 
	`t
('Set up username‡ndƒ-mail‡ddress‡ccess„ules for‚ew <em>and</em>ƒxisting‡ccounts (currently†ogged in‡ccounts will‚ot be†ogged out). If‡ username orƒ-mail‡ddress for‡n‡ccount matches‡ny deny„ule, but‚ot‡n‡llow„ule,henhe‡ccount will‚ot be‡llowedo be created oro†og in. A host„ule isƒffective forƒvery…age view,‚ot just„egistrations.') .'</p>';

1955  '<p>'. 
	`t
('P”missiÚ Ëˆyou cÚŒŞ wh© u£r ÿÀdØÚ you¸s™e. Each u£¸rŞ(defšed oÀth<¨h»f="@rŞe">u£¸rŞe ·ge</a>èha ™ owÀ£ˆoà³rmissiÚs. FÜƒxam¶e, you could givu£r şassif›d‡ "Admši¡¿tÜs"…”missiÚØ"admši¡”‚odes" buˆd’yhi pow”ØÜdš¬y, "auth’tiÿ‹d" u£rs. You cª u£…”missiÚ tØ»v—ÈÃw f—tu» tØ´iveged u£r Ñho£ w™h subsütiÚs, fÜƒxam¶e). P”missiÚ ®sØ®lowru¡ed u£r tØsh¬thadmši¡¿tivburd’ oàruÂšg‡ busy s™e.', 
	`¬¿y
('@rŞe' => 
	`u¾
('admin/user/roles'))) .'</p>';

1957  
	`t
('<p>Roles‡llow youo fineunehe security‡nd‡dministration of Drupal. A„ole defines‡ group of usershat have certain…rivileges‡s defined in <a href="@permissions">user…ermissions</a>. Examples of„oles include:‡nonymous user,‡uthenticated user, moderator,‡dministrator‡nd so on. Inhis‡rea you will definehe <em>role‚ames</em> ofhe various„oles. To delete‡„ole choose "edit".</p><p>By default, Drupal comes withwo user„oles:</p>

1958 <
ul
>

1959 <
li
>
AnÚymous
 
u£r
: 
this
 
rŞe
 
is
 
u£d
 
u£rs
 
th©
 
dÚ
\'t have‡ user‡ccount orhat‡re‚ot‡uthenticated.</li>

1960 <
li
>
Auth’tiÿ‹d
 
u£r
: 
this
 
rŞe
 
is
 
autom©iÿÎy
 
g¿Áed
 
to
 
®l
 
logged
 
š
 
u£rs
.</li>

1961 </
ul
>',‡¼ay('@
³rmissiÚs
' => u¾('
admš
/
u£r
/permissions')));

1963  '<p>'. 
	`t
('Enter‡ simple…attern ("*" may be used‡s‡ wildcard match)o search for‡ username orƒ-mail‡ddress. Forƒxample, one may search for "br"‡nd Drupal might„eturn "brian", "brad",‡nd "brenda@example.com".') .'</p>';

1965 
	}
}

1970 
funùiÚ
 
	$_u£r_ÿ‹gÜ›s
(
$accouÁ
) {

1971 
$ÿ‹gÜ›s
 = 
	`¬¿y
();

1974 
$nuÎ
 = 
NULL
;

1975 
	`fÜ—ch
 (
	`moduË_li¡
(è
as
 
$moduË
) {

1976 
$funùiÚ
 = 
$moduË
 .'_user';

1978 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
è&& (
$d©a
 = 
	`$funùiÚ
('ÿ‹gÜ›s', 
$nuÎ
, 
$accouÁ
, ''))) {

1979 
$ÿ‹gÜ›s
 = 
	`¬¿y_m”ge
(
$d©a
, $categories);

1983 
	`usÜt
(
$ÿ‹gÜ›s
, '_user_sort');

1985  
$ÿ‹gÜ›s
;

1986 
	}
}

1988 
funùiÚ
 
	$_u£r_sÜt
(
$a
, 
$b
) {

1989 
$a
 = (
¬¿y
)$¨+ 
	`¬¿y
('weight' => 0, 'title' => '');

1990 
$b
 = (
¬¿y
)$b + 
	`¬¿y
('weight' => 0, 'title' => '');

1991  
$a
['weight'] < 
$b
['weight'] ? -1 : ($a['weight'] > $b['weight'] ? 1 : ($a['title'] < $b['title'] ? -1 : 1));

1992 
	}
}

1997 
funùiÚ
 
	$u£r_f‹rs
() {

1999 
$f‹rs
 = 
	`¬¿y
();

2000 
$rŞes
 = 
	`u£r_rŞes
(
TRUE
);

2001 
	`un£t
(
$rŞes
[
DRUPAL_AUTHENTICATED_RID
]);

2002 ià(
	`couÁ
(
$rŞes
)) {

2003 
$f‹rs
['rŞe'] = 
	`¬¿y
(

2004 't™Ë' => 
	`t
('role'),

2006 'İtiÚs' => 
$rŞes
,

2011 
$İtiÚs
 = 
	`¬¿y
();

2012 
	`fÜ—ch
 (
	`moduË_li¡
(è
as
 
$moduË
) {

2013 ià(
$³rmissiÚs
 = 
	`moduË_švoke
(
$moduË
, 'perm')) {

2014 
	`asÜt
(
$³rmissiÚs
);

2015 
	`fÜ—ch
 (
$³rmissiÚs
 
as
 
$³rmissiÚ
) {

2016 
$İtiÚs
[
	`t
('@moduË moduË', 
	`¬¿y
('@moduË' => 
$moduË
))][
$³rmissiÚ
] =($permission);

2020 
	`ksÜt
(
$İtiÚs
);

2021 
$f‹rs
['³rmissiÚ'] = 
	`¬¿y
(

2022 't™Ë' => 
	`t
('permission'),

2025 'İtiÚs' => 
$İtiÚs
,

2028 
$f‹rs
['¡©us'] = 
	`¬¿y
(

2029 't™Ë' => 
	`t
('status'),

2032 'İtiÚs' => 
	`¬¿y
(1 => 
	`t
('active'), 0 =>('blocked')),

2034  
$f‹rs
;

2035 
	}
}

2040 
funùiÚ
 
	$u£r_bud_f‹r_qu”y
() {

2041 
$f‹rs
 = 
	`u£r_f‹rs
();

2044 
$wh”e
 = 
$¬gs
 = 
$još
 = 
	`¬¿y
();

2045 
	`fÜ—ch
 (
$_SESSION
['u£r_ov”v›w_f‹r'] 
as
 
$f‹r
) {

2046 
	`li¡
(
$key
, 
$v®ue
èğ
$f‹r
;

2050 ià(
$key
 == 'permission') {

2051 
$accouÁ
 = 
Ãw
 
	`¡dCÏss
();

2052 
$accouÁ
->
uid
 = 'user_filter';

2053 
$accouÁ
->
rŞes
 = 
	`¬¿y
(
DRUPAL_AUTHENTICATED_RID
 => 1);

2054 ià(
	`u£r_acûss
(
$v®ue
, 
$accouÁ
)) {

2058 
$wh”e
[] = 
$f‹rs
[
$key
]['where'];

2059 
$¬gs
[] = 
$v®ue
;

2060 
$još
[] = 
$f‹rs
[
$key
]['join'];

2062 
$wh”e
 = !
	`em±y
($wh”eè? 'AND '. 
	`im¶ode
(' AND ', $where) : '';

2063 
$još
 = !
	`em±y
($jošè? ' '. 
	`im¶ode
(' ', 
	`¬¿y_unique
($join)) : '';

2065  
	`¬¿y
('wh”e' => 
$wh”e
,

2066 'još' => 
$još
,

2067 '¬gs' => 
$¬gs
,

2069 
	}
}

2074 
funùiÚ
 
	$u£r_fÜms
() {

2075 
$fÜms
['user_admin_access_add_form']['callback'] = 'user_admin_access_form';

2076 
$fÜms
['user_admin_access_edit_form']['callback'] = 'user_admin_access_form';

2077 
$fÜms
['user_admin_new_role']['callback'] = 'user_admin_role';

2078  
$fÜms
;

2079 
	}
}

2084 
funùiÚ
 
	$u£r_comm’t
(&
$comm’t
, 
$İ
) {

2086 ià(
$İ
 == 'view') {

2087 ià(
	`v¬ŸbË_g‘
('u£r_sigÇtu»s', 0è&& !
	`em±y
(
$comm’t
->
sigÇtu»
)) {

2088 
$comm’t
->
sigÇtu»
 = 
	`check_m¬kup
($comm’t->sigÇtu», $comm’t->
sigÇtu»_fÜm©
, 
FALSE
);

2091 
$comm’t
->
sigÇtu»
 = '';

2094 
	}
}

2101 
funùiÚ
 
	$theme_u£r_sigÇtu»
(
$sigÇtu»
) {

2102 
$ouut
 = '';

2103 ià(
$sigÇtu»
) {

2104 
$ouut
 .= '<div class="clear">';

2105 
$ouut
 .= '<div>â€”</div>';

2106 
$ouut
 .ğ
$sigÇtu»
;

2107 
$ouut
 .= '</div>';

2110  
$ouut
;

2111 
	}
}

2124 
funùiÚ
 
	$u£r_ma_tok’s
(
$accouÁ
, 
$Ïnguage
) {

2125 
glob®
 
$ba£_u¾
;

2126 
$tok’s
 = 
	`¬¿y
(

2127 '!u£ºame' => 
$accouÁ
->
Çme
,

2128 '!s™e' => 
	`v¬ŸbË_g‘
('site_name', 'Drupal'),

2129 '!logš_u¾' => 
	`u£r_·ss_»£t_u¾
(
$accouÁ
),

2130 '!uri' => 
$ba£_u¾
,

2131 '!uri_br›f' => 
	`´eg_»¶aû
('!^h‰ps?://!', '', 
$ba£_u¾
),

2132 '!mato' => 
$accouÁ
->
ma
,

2133 '!d©e' => 
	`fÜm©_d©e
(
	`time
(), 'medium', '', 
NULL
, 
$Ïnguage
->
Ïnguage
),

2134 '!logš_uri' => 
	`u¾
('u£r', 
	`¬¿y
('absŞu‹' => 
TRUE
, 'Ïnguage' => 
$Ïnguage
)),

2135 '!ed™_uri' => 
	`u¾
('u£r/'. 
$accouÁ
->
uid
 .'/ed™', 
	`¬¿y
('absŞu‹' => 
TRUE
, 'Ïnguage' => 
$Ïnguage
)),

2137 ià(!
	`em±y
(
$accouÁ
->
·sswÜd
)) {

2138 
$tok’s
['!·sswÜd'] = 
$accouÁ
->
·sswÜd
;

2140  
$tok’s
;

2141 
	}
}

2156 
funùiÚ
 
	$u£r_´eã¼ed_Ïnguage
(
$accouÁ
, 
$deçuÉ
 = 
NULL
) {

2157 
$Ïnguage_li¡
 = 
	`Ïnguage_li¡
();

2158 ià(!
	`em±y
(
$accouÁ
->
Ïnguage
è&& 
	`is£t
(
$Ïnguage_li¡
[$account->language])) {

2159  
$Ïnguage_li¡
[
$accouÁ
->
Ïnguage
];

2162  
$deçuÉ
 ? $deçuÉ : 
	`Ïnguage_deçuÉ
();

2164 
	}
}

2191 
funùiÚ
 
	$_u£r_ma_nÙify
(
$İ
, 
$accouÁ
, 
$Ïnguage
 = 
NULL
) {

2193 
$deçuÉ_nÙify
 = (
$İ
 != 'status_deleted' && $op != 'status_blocked');

2194 
$nÙify
 = 
	`v¬ŸbË_g‘
('u£r_ma_'. 
$İ
 .'_nÙify', 
$deçuÉ_nÙify
);

2195 ià(
$nÙify
) {

2196 
$·¿ms
['accouÁ'] = 
$accouÁ
;

2197 
$Ïnguage
 = $Ïnguag? $Ïnguag: 
	`u£r_´eã¼ed_Ïnguage
(
$accouÁ
);

2198 
$ma
 = 
	`dru·l_ma
('u£r', 
$İ
, 
$accouÁ
->
ma
, 
$Ïnguage
, 
$·¿ms
);

2199 ià(
$İ
 == 'register_pending_approval') {

2202 
	`dru·l_ma
('u£r', '»gi¡”_³ndšg_­´ov®_admš', 
	`v¬ŸbË_g‘
('s™e_ma', 
	`ši_g‘
('£ndma_äom')), 
	`Ïnguage_deçuÉ
(), 
$·¿ms
);

2205  
	`em±y
(
$ma
è? 
NULL
 : $mail['result'];

2206 
	}
}

2215 
funùiÚ
 
	$_u£r_·sswÜd_dyÇmic_v®id©iÚ
() {

2216 
$com¶‘e
 = 
FALSE
;

2217 
glob®
 
$u£r
;

2219 ià(!
$com¶‘e
) {

2220 
	`dru·l_add_js
(
	`dru·l_g‘_·th
('module', 'user') .'/user.js', 'module');

2222 
	`dru·l_add_js
(
	`¬¿y
(

2223 '·sswÜd' => 
	`¬¿y
(

2224 '¡»ngthT™Ë' => 
	`t
('Password strength:'),

2225 'lowSŒ’gth' => 
	`t
('Low'),

2226 'mediumSŒ’gth' => 
	`t
('Medium'),

2227 'highSŒ’gth' => 
	`t
('High'),

2228 'tooShÜt' => 
	`t
('It is„ecommendedo choose‡…asswordhat contains‡t†east six characters. It should include‚umbers,…unctuation,‡nd both upper‡nd†owercase†etters.'),

2229 'ÃedsMÜeV¬ŸtiÚ' => 
	`t
('The…assword does‚ot includeƒnough variationo be secure. Try:'),

2230 'addL‘‹rs' => 
	`t
('Adding both upper‡nd†owercase†etters.'),

2231 'addNumb”s' => 
	`t
('Adding‚umbers.'),

2232 'addPunùu©iÚ' => 
	`t
('Adding…unctuation.'),

2233 '§meAsU£ºame' => 
	`t
('It is„ecommendedo choose‡…assword different fromhe username.'),

2234 'cÚfœmSucûss' => 
	`t
('Yes'),

2235 'cÚfœmFau»' => 
	`t
('No'),

2236 'cÚfœmT™Ë' => 
	`t
('Passwords match:'),

2237 'u£ºame' => (
	`is£t
(
$u£r
->
Çme
) ? $user->name : ''))),

2239 
$com¶‘e
 = 
TRUE
;

2241 
	}
}

2246 
funùiÚ
 
	$u£r_hook_šfo
() {

2247  
	`¬¿y
(

2248 'u£r' => 
	`¬¿y
(

2249 'u£r' => 
	`¬¿y
(

2250 'š£¹' => 
	`¬¿y
(

2251 'run wh’' => 
	`t
('After‡ user‡ccount has been created'),

2253 'upd©e' => 
	`¬¿y
(

2254 'run wh’' => 
	`t
("After‡ user's…rofile has been updated"),

2256 'd–‘e' => 
	`¬¿y
(

2257 'run wh’' => 
	`t
('After‡ user has been deleted')

2259 'logš' => 
	`¬¿y
(

2260 'run wh’' => 
	`t
('After‡ user has†ogged in')

2262 'logout' => 
	`¬¿y
(

2263 'run wh’' => 
	`t
('After‡ user has†ogged out')

2265 'v›w' => 
	`¬¿y
(

2266 'run wh’' => 
	`t
("When‡ user's…rofile is being viewed")

2271 
	}
}

2276 
funùiÚ
 
	$u£r_aùiÚ_šfo
() {

2277  
	`¬¿y
(

2278 'u£r_block_u£r_aùiÚ' => 
	`¬¿y
(

2279 'desütiÚ' => 
	`t
('Block current user'),

2281 'cÚfigu¿bË' => 
FALSE
,

2282 'hooks' => 
	`¬¿y
(),

2284 'u£r_block__aùiÚ' => 
	`¬¿y
(

2285 'desütiÚ' => 
	`t
('Ban IP‡ddress of current user'),

2287 'cÚfigu¿bË' => 
FALSE
,

2288 'hooks' => 
	`¬¿y
(),

2291 
	}
}

2297 
funùiÚ
 
u£r_block_u£r_aùiÚ
(&
$objeù
, 
$cÚ‹xt
 = 
	$¬¿y
()) {

2298 ià(
	`is£t
(
$objeù
->
uid
)) {

2299 
$uid
 = 
$objeù
->
uid
;

2301 
	`–£if
 (
	`is£t
(
$cÚ‹xt
['uid'])) {

2302 
$uid
 = 
$cÚ‹xt
['uid'];

2305 
glob®
 
$u£r
;

2306 
$uid
 = 
$u£r
->
uid
;

2308 
	`db_qu”y
("UPDATE {u£rs} SET stu ğ0 WHERE uid = %d", 
$uid
);

2309 
	`£ss_de¡roy_uid
(
$uid
);

2310 
	`w©chdog
('aùiÚ', 'Blocked u£¸%Çme.', 
	`¬¿y
('%Çme' => 
	`check_¶aš
(
$u£r
->
Çme
)));

2311 
	}
}

2317 
funùiÚ
 
	$u£r_block__aùiÚ
() {

2318 
$
 = 
	`_add»ss
();

2319 
	`db_qu”y
("INSERT INTO {acûss} (mask,y³, stusèVALUES ('%s', '%s', %d)", 
$
, 'host', 0);

2320 
	`w©chdog
('aùiÚ', 'BªÃd IP‡dd»s %', 
	`¬¿y
('%' => 
$
));

2321 
	}
}

2329 
funùiÚ
 
	$u£r_»gi¡”_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

2330 
glob®
 
$ba£_u¾
;

2331 
$admš
 = 
	`u£r_acûss
('administer users');

2333 
$ma
 = 
$fÜm_¡©e
['values']['mail'];

2334 
$Çme
 = 
$fÜm_¡©e
['values']['name'];

2335 ià(!
	`v¬ŸbË_g‘
('u£r_ema_v”ifiÿtiÚ', 
TRUE
è|| 
$admš
) {

2336 
$·ss
 = 
$fÜm_¡©e
['values']['pass'];

2339 
$·ss
 = 
	`u£r_·sswÜd
();

2341 
$nÙify
 = 
	`is£t
(
$fÜm_¡©e
['v®ues']['nÙify']è? $fÜm_¡©e['v®ues']['nÙify'] : 
NULL
;

2342 
$äom
 = 
	`v¬ŸbË_g‘
('s™e_ma', 
	`ši_g‘
('sendmail_from'));

2343 ià(
	`is£t
(
$fÜm_¡©e
['values']['roles'])) {

2345 
$rŞes
 = 
	`¬¿y_f‹r
(
$fÜm_¡©e
['values']['roles']);

2348 
$rŞes
 = 
	`¬¿y
();

2351 ià(!
$admš
 && 
	`¬¿y_š‹r£ù
(
	`¬¿y_keys
(
$fÜm_¡©e
['v®ues']), 
	`¬¿y
('uid', 'roles', 'init', 'session', 'status'))) {

2352 
	`w©chdog
('£cur™y', 'D‘eùed m®iciou ©‹m±Ø®‹¸´Ùeùed u£¸f›lds.', 
	`¬¿y
(), 
WATCHDOG_WARNING
);

2353 
$fÜm_¡©e
['redirect'] = 'user/register';

2358 
	`un£t
(
$fÜm_¡©e
['values']['form_token'], $form_state['values']['submit'], $form_state['values']['op'], $form_state['values']['notify'], $form_state['values']['form_id'], $form_state['values']['affiliates'], $form_state['values']['destination']);

2360 
$m”ge_d©a
 = 
	`¬¿y
('·ss' => 
$·ss
, 'š™' => 
$ma
, 'rŞes' => 
$rŞes
);

2361 ià(!
$admš
) {

2363 
$m”ge_d©a
['¡©us'] = 
	`v¬ŸbË_g‘
('user_register', 1) == 1;

2365 
$accouÁ
 = 
	`u£r_§ve
('', 
	`¬¿y_m”ge
(
$fÜm_¡©e
['v®ues'], 
$m”ge_d©a
));

2367 ià(!
$accouÁ
) {

2368 
	`dru·l_£t_mes§ge
(
	`t
("Error saving user‡ccount."), 'error');

2369 
$fÜm_¡©e
['redirect'] = '';

2372 
$fÜm_¡©e
['u£r'] = 
$accouÁ
;

2374 
	`w©chdog
('u£r', 'New u£r: %Çm(%ema).', 
	`¬¿y
('%Çme' => 
$Çme
, '%ema' => 
$ma
), 
WATCHDOG_NOTICE
, 
	`l
(
	`t
('ed™'), 'u£r/'. 
$accouÁ
->
uid
 .'/edit'));

2377 ià(
$accouÁ
->
uid
 == 1) {

2378 
	`dru·l_£t_mes§ge
(
	`t
('Welcomeo Drupal. You‡re‚ow†ogged in‡s user #1, which gives you full control over your website.'));

2379 ià(
	`v¬ŸbË_g‘
('u£r_ema_v”ifiÿtiÚ', 
TRUE
)) {

2380 
	`dru·l_£t_mes§ge
(
	`t
('</p><p> You¸·sswÜd i <¡rÚg>%·ss</¡rÚg>. You may chªgyou¸·sswÜd b–ow.</p>', 
	`¬¿y
('%·ss' => 
$·ss
)));

2383 
	`u£r_auth’tiÿ‹
(
	`¬¿y_m”ge
(
$fÜm_¡©e
['v®ues'], 
$m”ge_d©a
));

2385 
$fÜm_¡©e
['redirect'] = 'user/1/edit';

2390 
$accouÁ
->
·sswÜd
 = 
$·ss
;

2391 ià(
$admš
 && !
$nÙify
) {

2392 
	`dru·l_£t_mes§ge
(
	`t
('C»©ed‡‚ew u£¸accouÁ fÜ <¨h»f="@u¾">%Çme</a>. NØe-ma ha b“À£Á.', 
	`¬¿y
('@u¾' => 
	`u¾
("u£r/$accouÁ->uid"), '%Çme' => 
$accouÁ
->
Çme
)));

2394 ià(!
	`v¬ŸbË_g‘
('u£r_ema_v”ifiÿtiÚ', 
TRUE
è&& 
$accouÁ
->
¡©us
 && !
$admš
) {

2397 
	`_u£r_ma_nÙify
('»gi¡”_no_­´ov®_»quœed', 
$accouÁ
);

2398 ià(
	`u£r_auth’tiÿ‹
(
	`¬¿y_m”ge
(
$fÜm_¡©e
['v®ues'], 
$m”ge_d©a
))) {

2399 
	`dru·l_£t_mes§ge
(
	`t
('Registration successful. You‡re‚ow†ogged in.'));

2401 
$fÜm_¡©e
['redirect'] = '';

2404 ià(
$accouÁ
->
¡©us
 || 
$nÙify
) {

2406 
$İ
 = 
$nÙify
 ? 'register_admin_created' : 'register_no_approval_required';

2407 
	`_u£r_ma_nÙify
(
$İ
, 
$accouÁ
);

2408 ià(
$nÙify
) {

2409 
	`dru·l_£t_mes§ge
(
	`t
('PasswÜd‡nd fu¹h” in¡ruùiÚ havb“Àe-maedØthÃw u£¸<¨h»f="@u¾">%Çme</a>.', 
	`¬¿y
('@u¾' => 
	`u¾
("u£r/$accouÁ->uid"), '%Çme' => 
$accouÁ
->
Çme
)));

2412 
	`dru·l_£t_mes§ge
(
	`t
('Your…assword‡nd further instructions have been sento yourƒ-mail‡ddress.'));

2413 
$fÜm_¡©e
['redirect'] = '';

2419 
	`_u£r_ma_nÙify
('»gi¡”_³ndšg_­´ov®', 
$accouÁ
);

2420 
	`dru·l_£t_mes§ge
(
	`t
('Thank you for‡pplying for‡n‡ccount. Your‡ccount is currently…ending‡pproval byhe site‡dministrator.<br />Inhe meantime,‡ welcome message with further instructions has been sento yourƒ-mail‡ddress.'));

2421 
$fÜm_¡©e
['redirect'] = '';

2426 
	}
}

2435 
funùiÚ
 
	$u£r_»gi¡”
() {

2436 
glob®
 
$u£r
;

2438 
$admš
 = 
	`u£r_acûss
('administer users');

2441 ià(!
$admš
 && 
$u£r
->
uid
) {

2442 
	`dru·l_gÙo
('u£r/'. 
$u£r
->
uid
);

2445 
$fÜm
 = 
	`¬¿y
();

2448 ià(!
$admš
) {

2449 
$fÜm
['u£r_»gi¡¿tiÚ_h–p'] = 
	`¬¿y
(

2450 '#v®ue' => 
	`f‹r_xss_admš
(
	`v¬ŸbË_g‘
('user_registration_help', '')),

2457 
$fÜm
 = 
	`¬¿y_m”ge
($fÜm, 
	`u£r_ed™_fÜm
(
$fÜm_¡©e
, 
NULL
, NULL, 
TRUE
));

2458 ià(
$admš
) {

2459 
$fÜm
['accouÁ']['nÙify'] = 
	`¬¿y
(

2461 '#t™Ë' => 
	`t
('Notify user of‚ew‡ccount')

2465 
$fÜm
['de¡š©iÚ'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$_GET
['q']);

2469 
$nuÎ
 = 
NULL
;

2470 
$exŒa
 = 
	`_u£r_fÜms
(
$nuÎ
, 
NULL
, NULL, 'register');

2473 ià(!
$exŒa
) {

2474 
	`fÜ—ch
 (
	`¬¿y
('Çme', 'ma', '·ss', '¡©us', 'rŞes', 'nÙify'è
as
 
$key
) {

2475 ià(
	`is£t
(
$fÜm
['accouÁ'][
$key
])) {

2476 
$fÜm
[
$key
] = $form['account'][$key];

2479 
	`un£t
(
$fÜm
['account']);

2482 
$fÜm
 = 
	`¬¿y_m”ge
($fÜm, 
$exŒa
);

2485 ià(
	`v¬ŸbË_g‘
('configurable_timezones', 1)) {

2488 
$fÜm
['timezÚe'] = 
	`¬¿y
(

2490 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('d©e_deçuÉ_timezÚe', 
NULL
),

2495 
	`dru·l_add_js
('

2497 ià(
Dru·l
.
jsEÇbËd
) {

2498 
	`$
(
docum’t
).
	`»ady
(
	`funùiÚ
() {

2499 
Dru·l
.
	`£tDeçuÉTimezÚe
();

2501 }', '
šlše
');

2504 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Create‚ew‡ccount'), '#weight' => 30);

2505 
$fÜm
['#validate'][] = 'user_register_validate';

2507  
$fÜm
;

2508 
	}
}

2510 
funùiÚ
 
	$u£r_»gi¡”_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

2511 
	`u£r_moduË_švoke
('v®id©e', 
$fÜm_¡©e
['values'], $form_state['values'], 'account');

2512 
	}
}

2517 
funùiÚ
 
_u£r_fÜms
(&
$ed™
, 
$accouÁ
, 
$ÿ‹gÜy
, 
$hook
 = 'form') {

2518 
$groups
 = 
¬¿y
();

2519 
fÜ—ch
 (
moduË_li¡
(è
as
 
$moduË
) {

2520 
	g$funùiÚ
 = 
$moduË
 .'_user';

2522 ià(
funùiÚ_exi¡s
(
$funùiÚ
è&& (
	g$d©a
 = $funùiÚ(
$hook
, 
$ed™
, 
$accouÁ
, 
$ÿ‹gÜy
))) {

2523 
	g$groups
 = 
¬¿y_m”ge_»cursive
(
$d©a
, 
$groups
);

2526 
uasÜt
(
$groups
, '_user_sort');

2528  
em±y
(
$groups
è? 
	gFALSE
 : $groups;

2541 
funùiÚ
 
	$u£r_logš_de¡š©iÚ
() {

2542 
$de¡š©iÚ
 = 
	`dru·l_g‘_de¡š©iÚ
();

2543  
$de¡š©iÚ
 == 'destination=user%2Flogin' ? 'destination=user' : $destination;

2544 
	}
}

	@/srv/http/subs/notes/www/modules/user/user.pages.inc

1 <?
php


12 
funùiÚ
 
u£r_autocom¶‘e
(
$¡ršg
 = '') {

13 
$m©ches
 = 
¬¿y
();

14 ià(
	g$¡ršg
) {

15 
	g$»suÉ
 = 
db_qu”y_¿nge
("SELECT‚amFROM {u£rs} WHERE LOWERÒameèLIKE LOWER('%s%%')", 
$¡ršg
, 0, 10);

16 
	g$u£r
 = 
db_ãtch_objeù
(
$»suÉ
)) {

17 
$m©ches
[
$u£r
->
Çme
] = 
check_¶aš
($user->name);

21 
dru·l_jsÚ
(
$m©ches
);

31 
funùiÚ
 
	$u£r_·ss
() {

32 
$fÜm
['Çme'] = 
	`¬¿y
(

34 '#t™Ë' => 
	`t
('Username orƒ-mail‡ddress'),

36 '#maxËngth' => 
	`max
(
USERNAME_MAX_LENGTH
, 
EMAIL_MAX_LENGTH
),

37 '#»quœed' => 
TRUE
,

39 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('E-mail‚ew…assword'));

41  
$fÜm
;

42 
	}
}

44 
funùiÚ
 
	$u£r_·ss_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

45 
$Çme
 = 
	`Œim
(
$fÜm_¡©e
['values']['name']);

49 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('ma' => 
$Çme
, 'status' => 1));

50 ià(!
$accouÁ
) {

52 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('Çme' => 
$Çme
, 'status' => 1));

54 ià(
$accouÁ
) {

57 ià(
	`dru·l_is_d’›d
('u£r', 
$accouÁ
->
Çme
è|| dru·l_is_d’›d('ma', $accouÁ->
ma
)) {

58 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('%Çmi nÙ‡ÎowedØ»que¡‡‚ew…asswÜd.', 
	`¬¿y
('%Çme' => 
$Çme
)));

61 ià(
	`is£t
(
$accouÁ
->
uid
)) {

62 
	`fÜm_£t_v®ue
(
	`¬¿y
('#·»Ás' =>‡¼ay('accouÁ')), 
$accouÁ
, 
$fÜm_¡©e
);

65 
	`fÜm_£t_”rÜ
('Çme', 
	`t
('SÜry, %Çmi nÙ„ecognized‡ ¨u£¸ÇmÜ‡Àe-ma‡dd»ss.', 
	`¬¿y
('%Çme' => 
$Çme
)));

67 
	}
}

69 
funùiÚ
 
	$u£r_·ss_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

70 
glob®
 
$Ïnguage
;

72 
$accouÁ
 = 
$fÜm_¡©e
['values']['account'];

74 
	`_u£r_ma_nÙify
('·sswÜd_»£t', 
$accouÁ
, 
$Ïnguage
);

75 
	`w©chdog
('u£r', 'PasswÜd„e£ˆš¡ruùiÚ maedØ%Çm© %ema.', 
	`¬¿y
('%Çme' => 
$accouÁ
->
Çme
, '%ema' => $accouÁ->
ma
));

76 
	`dru·l_£t_mes§ge
(
	`t
('Further instructions have been sento yourƒ-mail‡ddress.'));

78 
$fÜm_¡©e
['redirect'] = 'user';

80 
	}
}

85 
funùiÚ
 
	$u£r_·ss_»£t
(&
$fÜm_¡©e
, 
$uid
, 
$time¡amp
, 
$hashed_·ss
, 
$aùiÚ
 = 
NULL
) {

86 
glob®
 
$u£r
;

89 ià(
$u£r
->
uid
) {

90 
	`dru·l_£t_mes§ge
(
	`t
('You have‡lready usedhis one-time†ogin†ink. It is‚ot‚ecessaryo usehis†inko†ogin‡nymore. You‡re‡lready†ogged in.'));

91 
	`dru·l_gÙo
();

95 
$timeout
 = 86400;

96 
$cu¼’t
 = 
	`time
();

98 ià(
$time¡amp
 < 
$cu¼’t
 && 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => 
$uid
, 'status' => 1)) ) {

100 ià(
	`dru·l_is_d’›d
('u£r', 
$accouÁ
->
Çme
è|| dru·l_is_d’›d('ma', $accouÁ->
ma
)) {

101 
	`dru·l_£t_mes§ge
(
	`t
('You haveriedo use‡ one-time†ogin for‡n‡ccount which has been blocked.'), 'error');

102 
	`dru·l_gÙo
();

106 ià(
$accouÁ
->
logš
 && 
$cu¼’t
 - 
$time¡amp
 > 
$timeout
) {

107 
	`dru·l_£t_mes§ge
(
	`t
('You haveriedo use‡ one-time†ogin†inkhat hasƒxpired. Please„equest‡‚ew one usinghe form below.'));

108 
	`dru·l_gÙo
('user/password');

110 ià(
$accouÁ
->
uid
 && 
$time¡amp
 > $accouÁ->
logš
 && $time¡am°< 
$cu¼’t
 && 
$hashed_·ss
 =ğ
	`u£r_·ss_»hash
($accouÁ->
·ss
, $timestamp, $account->login)) {

112 ià(
$aùiÚ
 == 'login') {

113 
	`w©chdog
('u£r', 'U£¸%Çmu£d oÃ-timlogš†šk‡ˆtim%time¡amp.', 
	`¬¿y
('%Çme' => 
$accouÁ
->
Çme
, '%time¡amp' => 
$time¡amp
));

115 
$u£r
 = 
$accouÁ
;

118 
	`u£r_auth’tiÿ‹_fš®ize
(
$fÜm_¡©e
['values']);

119 
	`dru·l_£t_mes§ge
(
	`t
('You have just used your one-time†ogin†ink. It is‚o†onger‚ecessaryo usehis†inko†ogin. Please change your…assword.'));

120 
	`dru·l_gÙo
('u£r/'. 
$u£r
->
uid
 .'/edit');

123 
$fÜm
['mes§ge'] = 
	`¬¿y
('#v®ue' => 
	`t
('<p>Thi i ¨Úe-timlogš fÜ %u£r_Çmªd wÈexpœÚ %expœ©iÚ_d©e.</p><p>Click oÀthi bu‰ÚØlogšØths™ªd chªgyou¸·sswÜd.</p>',‡¼ay('%u£r_Çme' => 
$accouÁ
->
Çme
, '%expœ©iÚ_d©e' => 
	`fÜm©_d©e
(
$time¡amp
 + 
$timeout
))));

124 
$fÜm
['h–p'] = 
	`¬¿y
('#v®ue' => '<p>'. 
	`t
('This†ogin can be used only once.') .'</p>');

125 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Log in'));

126 
$fÜm
['#aùiÚ'] = 
	`u¾
("user/reset/$uid/$timestamp/$hashed_pass/login");

127  
$fÜm
;

131 
	`dru·l_£t_mes§ge
(
	`t
('You haveriedo use‡ one-time†ogin†ink which hasƒither been used or is‚o†onger valid. Please„equest‡‚ew one usinghe form below.'));

132 
	`dru·l_gÙo
('user/password');

138 
	`dru·l_acûss_d’›d
();

141 
	}
}

146 
funùiÚ
 
	$u£r_logout
() {

147 
glob®
 
$u£r
;

149 
	`w©chdog
('u£r', 'SessiÚ clo£d fÜ %Çme.', 
	`¬¿y
('%Çme' => 
$u£r
->
Çme
));

152 
	`£ssiÚ_de¡roy
();

154 
$nuÎ
 = 
NULL
;

155 
	`u£r_moduË_švoke
('logout', 
$nuÎ
, 
$u£r
);

158 
$u£r
 = 
	`dru·l_ªÚymous_u£r
();

160 
	`dru·l_gÙo
();

161 
	}
}

166 
funùiÚ
 
	$u£r_v›w
(
$accouÁ
) {

167 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$accouÁ
->
Çme
));

169 
	`u£r_bud_cÚ‹Á
(
$accouÁ
);

173  
	`theme
('u£r_´ofe', 
$accouÁ
);

174 
	}
}

184 
funùiÚ
 
	$‹m¶©e_´•roûss_u£r_´ofe
(&
$v¬ŸbËs
) {

185 
$v¬ŸbËs
['´ofe'] = 
	`¬¿y
();

187 
	`uasÜt
(
$v¬ŸbËs
['accouÁ']->
cÚ‹Á
, 'element_sort');

189 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$v¬ŸbËs
['accouÁ']->
cÚ‹Á
è
as
 
$key
) {

190 
$v¬ŸbËs
['´ofe'][
$key
] = 
	`dru·l_»nd”
($v¬ŸbËs['accouÁ']->
cÚ‹Á
[$key]);

193 
$v¬ŸbËs
['u£r_´ofe'] = 
	`im¶ode
($variables['profile']);

194 
	}
}

204 
funùiÚ
 
	$‹m¶©e_´•roûss_u£r_´ofe_™em
(&
$v¬ŸbËs
) {

205 
$v¬ŸbËs
['title'] = $variables['element']['#title'];

206 
$v¬ŸbËs
['value'] = $variables['element']['#value'];

207 
$v¬ŸbËs
['attributes'] = '';

208 ià(
	`is£t
(
$v¬ŸbËs
['element']['#attributes'])) {

209 
$v¬ŸbËs
['©Œibu‹s'] = 
	`dru·l_©Œibu‹s
($variables['element']['#attributes']);

211 
	}
}

221 
funùiÚ
 
	$‹m¶©e_´•roûss_u£r_´ofe_ÿ‹gÜy
(&
$v¬ŸbËs
) {

222 
$v¬ŸbËs
['t™Ë'] = 
	`check_¶aš
($variables['element']['#title']);

223 
$v¬ŸbËs
['profile_items'] = $variables['element']['#children'];

224 
$v¬ŸbËs
['attributes'] = '';

225 ià(
	`is£t
(
$v¬ŸbËs
['element']['#attributes'])) {

226 
$v¬ŸbËs
['©Œibu‹s'] = 
	`dru·l_©Œibu‹s
($variables['element']['#attributes']);

228 
	}
}

237 
funùiÚ
 
u£r_ed™
(
$accouÁ
, 
$ÿ‹gÜy
 = 'account') {

238 
dru·l_£t_t™Ë
(
check_¶aš
(
$accouÁ
->
Çme
));

239  
dru·l_g‘_fÜm
('u£r_´ofe_fÜm', 
$accouÁ
, 
$ÿ‹gÜy
);

250 
funùiÚ
 
u£r_´ofe_fÜm
(
$fÜm_¡©e
, 
$accouÁ
, 
$ÿ‹gÜy
 = 'account') {

252 
$ed™
 = (
em±y
(
$fÜm_¡©e
['v®ues'])è? (
¬¿y
)
$accouÁ
 : $form_state['values'];

254 
	g$fÜm
 = 
_u£r_fÜms
(
$ed™
, 
$accouÁ
, 
$ÿ‹gÜy
);

255 
	g$fÜm
['_ÿ‹gÜy'] = 
¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$ÿ‹gÜy
);

256 
	g$fÜm
['_accouÁ'] = 
¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$accouÁ
);

257 
	g$fÜm
['subm™'] = 
¬¿y
('#ty³' => 'subm™', '#v®ue' => 
t
('Save'), '#weight' => 30);

258 ià(
u£r_acûss
('administer users')) {

259 
	g$fÜm
['d–‘e'] = 
¬¿y
(

261 '#v®ue' => 
t
('Delete'),

263 '#subm™' => 
¬¿y
('user_edit_delete_submit'),

266 
	g$fÜm
['#attributes']['enctype'] = 'multipart/form-data';

268  
	g$fÜm
;

274 
funùiÚ
 
	$u£r_´ofe_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

275 
	`u£r_moduË_švoke
('v®id©e', 
$fÜm_¡©e
['values'], $form_state['values']['_account'], $form_state['values']['_category']);

277 ià((!
	`u£r_acûss
('admši¡” u£rs'è&& 
	`¬¿y_š‹r£ù
(
	`¬¿y_keys
(
$fÜm_¡©e
['v®ues']), 
	`¬¿y
('uid', 'š™', '£ssiÚ'))è|| (!u£r_acûss('admši¡”…”missiÚs'è&& 
	`is£t
($form_state['values']['roles']))) {

278 
	`w©chdog
('£cur™y', 'D‘eùed m®iciou ©‹m±Ø®‹¸´Ùeùed u£¸f›lds.', 
	`¬¿y
(), 
WATCHDOG_WARNING
);

280 
	`fÜm_£t_”rÜ
('ÿ‹gÜy', 
	`t
('Detected malicious‡ttempto‡lter…rotected user fields.'));

282 
	}
}

287 
funùiÚ
 
	$u£r_´ofe_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

288 
$accouÁ
 = 
$fÜm_¡©e
['values']['_account'];

289 
$ÿ‹gÜy
 = 
$fÜm_¡©e
['values']['_category'];

290 
	`un£t
(
$fÜm_¡©e
['values']['_account'], $form_state['values']['op'], $form_state['values']['submit'], $form_state['values']['delete'], $form_state['values']['form_token'], $form_state['values']['form_id'], $form_state['values']['_category']);

291 
	`u£r_moduË_švoke
('subm™', 
$fÜm_¡©e
['v®ues'], 
$accouÁ
, 
$ÿ‹gÜy
);

292 
	`u£r_§ve
(
$accouÁ
, 
$fÜm_¡©e
['v®ues'], 
$ÿ‹gÜy
);

295 
	`ÿche_ş—r_®l
();

297 
	`dru·l_£t_mes§ge
(
	`t
('The changes have been saved.'));

299 
	}
}

304 
funùiÚ
 
	$u£r_ed™_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

305 
$de¡š©iÚ
 = '';

306 ià(
	`is£t
(
$_REQUEST
['destination'])) {

307 
$de¡š©iÚ
 = 
	`dru·l_g‘_de¡š©iÚ
();

308 
	`un£t
(
$_REQUEST
['destination']);

311 
$fÜm_¡©e
['»dœeù'] = 
	`¬¿y
("u£r/". $fÜm_¡©e['v®ues']['_accouÁ']->
uid
 ."/d–‘e", 
$de¡š©iÚ
);

312 
	}
}

320 
funùiÚ
 
	$u£r_cÚfœm_d–‘e
(&
$fÜm_¡©e
, 
$accouÁ
) {

322 
$fÜm
['_accouÁ'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$accouÁ
);

324  
	`cÚfœm_fÜm
(
$fÜm
,

325 
	`t
('A» you su» you wªˆtØd–‘thaccouÁ %Çme?', 
	`¬¿y
('%Çme' => 
$accouÁ
->
Çme
)),

326 'u£r/'. 
$accouÁ
->
uid
,

327 
	`t
('All submissions made byhis user will be‡ttributedohe‡nonymous‡ccount. This‡ction cannot be undone.'),

328 
	`t
('Delete'),('Cancel'));

329 
	}
}

334 
funùiÚ
 
	$u£r_cÚfœm_d–‘e_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

335 
	`u£r_d–‘e
(
$fÜm_¡©e
['v®ues'], $fÜm_¡©e['v®ues']['_accouÁ']->
uid
);

336 
	`dru·l_£t_mes§ge
(
	`t
('%Çmha b“Àd–‘ed.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['v®ues']['_accouÁ']->
Çme
)));

338 ià(!
	`is£t
(
$_REQUEST
['destination'])) {

339 
$fÜm_¡©e
['redirect'] = 'admin/user/user';

341 
	}
}

343 
funùiÚ
 
	$u£r_ed™_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

344 
	`u£r_moduË_švoke
('v®id©e', 
$fÜm_¡©e
['values'], $form_state['values']['_account'], $form_state['values']['_category']);

346 ià((!
	`u£r_acûss
('admši¡” u£rs'è&& 
	`¬¿y_š‹r£ù
(
	`¬¿y_keys
(
$fÜm_¡©e
['v®ues']), 
	`¬¿y
('uid', 'š™', '£ssiÚ'))è|| (!u£r_acûss('admši¡”…”missiÚs'è&& 
	`is£t
($form_state['values']['roles']))) {

347 
	`w©chdog
('£cur™y', 'D‘eùed m®iciou ©‹m±Ø®‹¸´Ùeùed u£¸f›lds.', 
	`¬¿y
(), 
WATCHDOG_WARNING
);

349 
	`fÜm_£t_”rÜ
('ÿ‹gÜy', 
	`t
('Detected malicious‡ttempto‡lter…rotected user fields.'));

351 
	}
}

353 
funùiÚ
 
	$u£r_ed™_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

354 
$accouÁ
 = 
$fÜm_¡©e
['values']['_account'];

355 
$ÿ‹gÜy
 = 
$fÜm_¡©e
['values']['_category'];

356 
	`un£t
(
$fÜm_¡©e
['values']['_account'], $form_state['values']['op'], $form_state['values']['submit'], $form_state['values']['delete'], $form_state['values']['form_token'], $form_state['values']['form_id'], $form_state['values']['_category']);

357 
	`u£r_moduË_švoke
('subm™', 
$fÜm_¡©e
['v®ues'], 
$accouÁ
, 
$ÿ‹gÜy
);

358 
	`u£r_§ve
(
$accouÁ
, 
$fÜm_¡©e
['v®ues'], 
$ÿ‹gÜy
);

361 
	`ÿche_ş—r_®l
();

363 
	`dru·l_£t_mes§ge
(
	`t
('The changes have been saved.'));

365 
	}
}

373 
funùiÚ
 
	$u£r_·ge
() {

374 
glob®
 
$u£r
;

375 ià(
$u£r
->
uid
) {

376 
	`m’u_£t_aùive_™em
('u£r/'. 
$u£r
->
uid
);

377  
	`m’u_execu‹_aùive_hªdËr
();

380  
	`dru·l_g‘_fÜm
('user_login');

382 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/content.module

1 <?
php


8 
defše
('CONTENT_DB_STORAGE_PER_FIELD', 0);

9 
defše
('CONTENT_DB_STORAGE_PER_CONTENT_TYPE', 1);

11 
defše
('CONTENT_CALLBACK_NONE', 0x0001);

12 
defše
('CONTENT_CALLBACK_DEFAULT', 0x0002);

13 
defše
('CONTENT_CALLBACK_CUSTOM', 0x0004);

15 
defše
('CONTENT_HANDLE_CORE', 0x0001);

16 
defše
('CONTENT_HANDLE_MODULE', 0x0002);

18 
funùiÚ
 
	$cÚ‹Á_h–p
(
$·th
, 
$¬g
) {

19 
$·th
) {

21 
$ouut
 = '<p>'. 
	`t
('ThcÚ‹Á moduË,‡„equœed compÚ’ˆoàthCÚ‹Á CÚ¡ruùiÚ K™ (CCK),‡Îow admši¡¿tÜ tØassocŸ‹ cu¡om f›ld w™h cÚ‹Áy³s. IÀDru·l, cÚ‹Áy³ ¬u£dØdefšthch¬aù”i¡ic oà¨po¡, inşudšght™Ë‡nd desütiÚ oàthf›ld di¥Ïyed oÀ™ add‡ndƒd™…ages. UsšghcÚ‹Á moduË (ªdhÙh” h–³¸moduË šşuded iÀCCK), cu¡om f›ld beyÚdhdeçuÉ "T™Ë"‡nd "Body" may badded. CCK f—tu» ¬acûssibËhroughab Úh<¨h»f="@cÚ‹Á-ty³s">cÚ‹Áy³ admši¡¿tiÚ…age</a>. (S“h<¨h»f="@node-h–p">nodmoduË h–°·ge</a> fÜ mÜšfÜm©iÚ‡bouˆcÚ‹Áy³s.)', 
	`¬¿y
('@cÚ‹Á-ty³s' => 
	`u¾
('admin/content/types'), '@node-help' => url('admin/help/node'))) .'</p>';

22 
$ouut
 .ğ'<p>'. 
	`t
('When‡dding‡ custom fieldo‡ contentype, you determine itsype (whether it will containext,‚umbers, or„eferenceso other objects)‡nd how it will be displayed (either‡s‡ext field or‡rea,‡ select box, checkbox,„adio button, or‡utocompleting field). A field may have multiple values (i.e.,‡ "person" may have multipleƒ-mail‡ddresses) or‡ single value (i.e.,‡n "employee" has‡ singleƒmployee identification‚umber). As you‡dd‡ndƒdit fields, CCK‡utomatically‡djustshe structure ofhe database‡s‚ecessary. CCK‡lso…rovides‡‚umber of other features, including intelligent caching for your custom data,‡n import‡ndƒxport facility for contentype definitions,‡nd integration with other contributed modules.') .'</p>';

23 
$ouut
 .ğ'<p>'. 
	`t
('Cu¡om f›ldy³ ¬´ovided by‡ s‘ oàİtiÚ® moduË šşuded w™h CCK (—ch moduË…rovide ¨difã»Áy³). Th<¨h»f="@moduËs">moduË ·ge</a>‡Îow youØ’abË o¸di§bË CCK compÚ’ts. A deçuÉ in¡®ÏtiÚ oàCCK inşudes:', 
	`¬¿y
('@moduËs' => 
	`u¾
('admin/build/modules'))) .'</p>';

24 
$ouut
 .= '<ul>';

25 
$ouut
 .ğ'<li>'. 
	`t
('<em>number</em>, which‡dds‚umeric fieldypes, in integer, decimal or floating…oint form. You may define‡ set of‡llowed inputs, or specify‡n‡llowable„ange of values. A variety of common formats for displaying‚umeric data‡re‡vailable.') .'</li>';

26 
$ouut
 .ğ'<li>'. 
	`t
("<em>text</em>, which‡ddsext fieldypes. Aext field may contain…lainext only, or optionally, may use Drupal's input format filterso securely manage„ichext input. Text input fields may beƒither‡ single†ine (text field), multiple†ines (text‡rea), or for greater input control,‡ select box, checkbox, or„adio buttons. If desired, CCK can validatehe inputo‡ set of‡llowed values.") .'</li>';

27 
$ouut
 .ğ'<li>'. 
	`t
('<em>nodereference</em>, which creates custom„eferences between Drupal‚odes. By‡dding‡ <em>nodereference</em> field‡ndwo different contentypes, for instance, you canƒasily create complex…arent/child„elationships between data (multiple "employee"‚odes may contain‡ <em>nodereference</em> field†inkingo‡n "employer"‚ode).') .'</li>';

28 
$ouut
 .ğ'<li>'. 
	`t
('<em>userreference</em>, which creates custom„eferenceso your sites\' user‡ccounts. By‡dding‡ <em>userreference</em> field, you can create complex„elationships between your site\'s users‡nd…osts. Torack user involvement in‡…ost beyond Drupal\'s standard <em>Authored by</em> field, for instance,‡dd‡ <em>userreference</em> field‚amed "Edited by"o‡ contentypeo store‡†inko‡nƒditor\'s user‡ccount…age.') .'</li>';

29 
$ouut
 .ğ'<li>'. 
	`t
('<em>fieldgroup</em>, which creates collapsible fieldsetso hold‡ group of„elated fields. A fieldset mayƒither be open or closed by default. The order of your fieldsets,‡ndhe order of fields within‡ fieldset, is managed via‡ drag-and-drop interface…rovided by content module.') .'</li>';

30 
$ouut
 .= '</ul>';

31 
$ouut
 .ğ'<p>'. 
	`t
('FÜ mÜšfÜm©iÚ, s“hÚlšhªdbookƒÁry fÜ <¨h»f="@hªdbook-cck">CCK</a> o¸th<¨h»f="@´ojeù-cck">CCK…rojeù…age</a>.', 
	`¬¿y
('@handbook-cck' => 'http://drupal.org/handbook/modules/cck', '@project-cck' => 'http://drupal.org/project/cck')) .'</p>';

32  
$ouut
;

34 
	}
}

39 
funùiÚ
 
	$cÚ‹Á_æush_ÿches
() {

40  
	`¬¿y
(
	`cÚ‹Á_ÿche_bËÇme
());

41 
	}
}

46 
funùiÚ
 
	$cÚ‹Á_š™
() {

47 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'content') .'/theme/content-module.css');

48 ià(
	`moduË_exi¡s
('tok’'è&& !
	`funùiÚ_exi¡s
('content_token_values')) {

49 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.token');

51 ià(
	`moduË_exi¡s
('diff'è&& !
	`funùiÚ_exi¡s
('content_diff')) {

52 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.diff');

54 
	}
}

59 
funùiÚ
 
	$cÚ‹Á_³rm
() {

60  
	`¬¿y
('Use PHP input for field settings (dangerous - grant with care)');

61 
	}
}

66 
funùiÚ
 
	$cÚ‹Á_m’u_®‹r
(&
$™ems
) {

68 
$™ems
['admin/content/types']['page callback'] = 'content_types_overview';

69 
$™ems
['admin/content/types']['file'] = 'content.admin.inc';

70 
$™ems
['admš/cÚ‹Á/ty³s']['f·th'] = 
	`dru·l_g‘_·th
('module', 'content') .'/includes';

71 
	}
}

76 
funùiÚ
 
	$cÚ‹Á_m’u
() {

77 
$™ems
 = 
	`¬¿y
();

78 
$™ems
['admš/cÚ‹Á/ty³s/f›lds'] = 
	`¬¿y
(

81 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

83 'ty³' => 
MENU_LOCAL_TASK
,

86 
$™ems
['cÚ‹Á/js_add_mÜe'] = 
	`¬¿y
(

88 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

90 'ty³' => 
MENU_CALLBACK
,

95 ià(!
	`defšed
('MAINTENANCE_MODE'è&& 
	`v¬ŸbË_g‘
('content_schema_version', -1) >= 6007) {

96 
	`fÜ—ch
 (
	`node_g‘_ty³s
(è
as
 
$ty³
) {

97 
$ty³_Çme
 = 
$ty³
->
ty³
;

98 
$cÚ‹Á_ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

99 
$ty³_u¾_¡r
 = 
$cÚ‹Á_ty³
['url_str'];

100 
$™ems
['admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
 .'/f›lds'] = 
	`¬¿y
(

103 '·g¬gum’ts' => 
	`¬¿y
('cÚ‹Á_f›ld_ov”v›w_fÜm', 
$ty³_Çme
),

104 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

106 'ty³' => 
MENU_LOCAL_TASK
,

109 
$™ems
['admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
 .'/di¥Ïy'] = 
	`¬¿y
(

112 '·g¬gum’ts' => 
	`¬¿y
('cÚ‹Á_di¥Ïy_ov”v›w_fÜm', 
$ty³_Çme
),

113 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

115 'ty³' => 
MENU_LOCAL_TASK
,

118 
$cÚ‹xts
 = 
	`cÚ‹Á_bud_modes
('_tabs');

119 
	`fÜ—ch
 (
$cÚ‹xts
 
as
 
$key
 => 
$b
) {

120 
$™ems
['admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
 .'/di¥Ïy/'. 
$key
] = 
	`¬¿y
(

121 't™Ë' => 
$b
['title'],

122 '·g¬gum’ts' => 
	`¬¿y
('cÚ‹Á_di¥Ïy_ov”v›w_fÜm', 
$ty³_Çme
, 
$key
),

123 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

124 'ty³' => 
$key
 =ğ'basic' ? 
MENU_DEFAULT_LOCAL_TASK
 : 
MENU_LOCAL_TASK
,

125 'weight' => 
$key
 == 'basic' ? 0 : 1,

130 
	`fÜ—ch
 ((
¬¿y
è
$cÚ‹Á_ty³
['f›lds'] 
as
 
$f›ld
) {

131 
$f›ld_Çme
 = 
$f›ld
['field_name'];

132 
$™ems
['admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
 .'/f›lds/'. 
$f›ld_Çme
] = 
	`¬¿y
(

133 't™Ë' => 
$f›ld
['widget']['label'],

135 '·g¬gum’ts' => 
	`¬¿y
('cÚ‹Á_f›ld_ed™_fÜm', 
$ty³_Çme
, 
$f›ld_Çme
),

136 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

138 'ty³' => 
MENU_LOCAL_TASK
,

140 
$™ems
['admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
 .'/f›lds/'. 
$f›ld_Çme
 .'/»move'] = 
	`¬¿y
(

143 '·g¬gum’ts' => 
	`¬¿y
('cÚ‹Á_f›ld_»move_fÜm', 
$ty³_Çme
, 
$f›ld_Çme
),

144 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

146 'ty³' => 
MENU_CALLBACK
,

151  
$™ems
;

152 
	}
}

165 
funùiÚ
 
	$cÚ‹Á_–em’ts
() {

166  
	`¬¿y
(

167 'cÚ‹Á_muÉË_v®ues' => 
	`¬¿y
(),

168 'cÚ‹Á_f›ld' => 
	`¬¿y
(),

170 
	}
}

175 
funùiÚ
 
	$cÚ‹Á_theme
() {

176 
$·th
 = 
	`dru·l_g‘_·th
('module', 'content') .'/theme';

177 
»quœe_Úû
 "./$path/theme.inc";

179  
	`¬¿y
(

180 'cÚ‹Á_f›ld' => 
	`¬¿y
(

182 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

183 '·th' => 
$·th
,

185 'cÚ‹Á_ov”v›w_lšks' => 
	`¬¿y
(

186 '¬gum’ts' => 
	`¬¿y
(),

188 'cÚ‹Á_f›ld_ov”v›w_fÜm' => 
	`¬¿y
(

191 '·th' => 
$·th
,

192 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

194 'cÚ‹Á_di¥Ïy_ov”v›w_fÜm' => 
	`¬¿y
(

197 '·th' => 
$·th
,

198 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

200 'cÚ‹Á_exşude' => 
	`¬¿y
(

201 '¬gum’ts' => 
	`¬¿y
('cÚ‹Á' => 
NULL
, 'object' =>‡rray(), 'context' => NULL),

203 'cÚ‹Á_v›w_muÉË_f›ld' => 
	`¬¿y
(

204 '¬gum’ts' => 
	`¬¿y
('™ems' => 
NULL
, 'field' => NULL, 'data' => NULL),

206 'cÚ‹Á_muÉË_v®ues' => 
	`¬¿y
(

207 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

210 
	}
}

215 
funùiÚ
 
	$cÚ‹Á_v›ws_­i
() {

216  
	`¬¿y
(

218 '·th' => 
	`dru·l_g‘_·th
('module', 'content') . '/includes/views',

220 
	}
}

225 
funùiÚ
 
	$cÚ‹Á_ùoŞs_¶ugš_dœeùÜy
(
$moduË
, 
$¶ugš
) {

226 ià(
$moduË
 =ğ'ùoŞs' && 
$¶ugš
 == 'content_types') {

227  'šşudes/·Ãls/' . 
$¶ugš
;

229 
	}
}

239 
funùiÚ
 
	$cÚ‹Á_lßd
(&
$node
) {

240 
$cid
 = 'cÚ‹Á:'. 
$node
->
nid
 .':'. $node->
vid
;

241 ià(
$ÿched
 = 
	`ÿche_g‘
(
$cid
, 
	`cÚ‹Á_ÿche_bËÇme
())) {

242 
	`fÜ—ch
 (
$ÿched
->
d©a
 
as
 
$key
 => 
$v®ue
) {

243 
$node
->
$key
 = 
$v®ue
;

247 
$deçuÉ_add™iÚs
 = 
	`_cÚ‹Á_f›ld_švoke_deçuÉ
('lßd', 
$node
);

248 ià(
$deçuÉ_add™iÚs
) {

249 
	`fÜ—ch
 (
$deçuÉ_add™iÚs
 
as
 
$key
 => 
$v®ue
) {

250 
$node
->
$key
 = 
$v®ue
;

253 
$add™iÚs
 = 
	`_cÚ‹Á_f›ld_švoke
('lßd', 
$node
);

254 ià(
$add™iÚs
) {

255 
	`fÜ—ch
 (
$add™iÚs
 
as
 
$key
 => 
$v®ue
) {

256 
$node
->
$key
 = 
$v®ue
;

257 
$deçuÉ_add™iÚs
[
$key
] = 
$v®ue
;

260 
	`ÿche_£t
(
$cid
, 
$deçuÉ_add™iÚs
, 
	`cÚ‹Á_ÿche_bËÇme
());

262 
	}
}

268 
funùiÚ
 
	$cÚ‹Á_v®id©e
(&
$node
, 
$fÜm
 = 
NULL
) {

269 
	`_cÚ‹Á_f›ld_švoke
('v®id©e', 
$node
, 
$fÜm
);

270 
	`_cÚ‹Á_f›ld_švoke_deçuÉ
('v®id©e', 
$node
, 
$fÜm
);

271 
	}
}

277 
funùiÚ
 
	$cÚ‹Á_´e§ve
(&
$node
) {

278 
	`_cÚ‹Á_f›ld_švoke
('´e§ve', 
$node
);

279 
	`_cÚ‹Á_f›ld_švoke_deçuÉ
('´e§ve', 
$node
);

280 
	}
}

287 
funùiÚ
 
	$cÚ‹Á_š£¹
(&
$node
) {

288 
	`_cÚ‹Á_f›ld_švoke
('š£¹', 
$node
);

289 
	`_cÚ‹Á_f›ld_švoke_deçuÉ
('š£¹', 
$node
);

290 
	}
}

297 
funùiÚ
 
	$cÚ‹Á_upd©e
(&
$node
) {

298 
	`_cÚ‹Á_f›ld_švoke
('upd©e', 
$node
);

299 
	`_cÚ‹Á_f›ld_švoke_deçuÉ
('upd©e', 
$node
);

300 
	`ÿche_ş—r_®l
('cÚ‹Á:'. 
$node
->
nid
 .':'. $node->
vid
, 
	`cÚ‹Á_ÿche_bËÇme
());

301 
	}
}

308 
funùiÚ
 
	$cÚ‹Á_d–‘e
(&
$node
) {

309 
	`_cÚ‹Á_f›ld_švoke
('d–‘e', 
$node
);

310 
	`_cÚ‹Á_f›ld_švoke_deçuÉ
('d–‘e', 
$node
);

311 
	`ÿche_ş—r_®l
('cÚ‹Á:'. 
$node
->
nid
 .':', 
	`cÚ‹Á_ÿche_bËÇme
(), 
TRUE
);

312 
	}
}

319 
funùiÚ
 
	$cÚ‹Á_d–‘e_»visiÚ
(&
$node
) {

320 
	`_cÚ‹Á_f›ld_švoke
('d–‘»visiÚ', 
$node
);

321 
	`_cÚ‹Á_f›ld_švoke_deçuÉ
('d–‘»visiÚ', 
$node
);

322 
	`ÿche_ş—r_®l
('cÚ‹Á:'. 
$node
->
nid
 .':'. $node->
vid
, 
	`cÚ‹Á_ÿche_bËÇme
());

323 
	}
}

330 
funùiÚ
 
	$cÚ‹Á_v›w
(&
$node
, 
$‹a£r
 = 
FALSE
, 
$·ge
 = FALSE) {

332 
	`_cÚ‹Á_f›ld_švoke
('§n™ize', 
$node
, 
$‹a£r
, 
$·ge
);

335 
$add™iÚs
 = 
	`_cÚ‹Á_f›ld_švoke_deçuÉ
('v›w', 
$node
, 
$‹a£r
, 
$·ge
);

336 
$node
->
cÚ‹Á
 = 
	`¬¿y_m”ge
((
¬¿y
è$node->cÚ‹Á, 
$add™iÚs
);

337 
	}
}

363 
funùiÚ
 
	$cÚ‹Á_v›w_f›ld
(
$f›ld
, 
$node
, 
$‹a£r
 = 
FALSE
, 
$·ge
 = FALSE) {

364 
$ouut
 = '';

365 ià(
	`is£t
(
$node
->
$f›ld
['field_name'])) {

366 
$™ems
 = 
$node
->
$f›ld
['field_name'];

369 
$node
->
bud_mode
 = 
	`is£t
($node->bud_modeè? $node->bud_mod: 
NODE_BUILD_NORMAL
;

372 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

373 
$moduË
 = 
$f›ld_ty³s
[
$f›ld
['type']]['module'];

374 
$funùiÚ
 = 
$moduË
 .'_field';

375 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

376 
	`$funùiÚ
('§n™ize', 
$node
, 
$f›ld
, 
$™ems
, 
$‹a£r
, 
$·ge
);

377 
$node
->
$f›ld
['f›ld_Çme'] = 
$™ems
;

380 
$v›w
 = 
	`cÚ‹Á_f›ld
('v›w', 
$node
, 
$f›ld
, 
$™ems
, 
$‹a£r
, 
$·ge
);

383 
$ouut
 = 
	`dru·l_»nd”
(
$v›w
[
$f›ld
['field_name']]['field']);

385  
$ouut
;

386 
	}
}

394 
funùiÚ
 
	$cÚ‹Á_®‹r
(&
$node
, 
$‹a£r
 = 
FALSE
, 
$·ge
 = FALSE) {

395 
	`_cÚ‹Á_f›ld_švoke_deçuÉ
('®‹r', 
$node
, 
$‹a£r
, 
$·ge
);

396 
	}
}

403 
funùiÚ
 
	$cÚ‹Á_´•¬e_Œª¦©iÚ
(&
$node
) {

404 
$deçuÉ_add™iÚs
 = 
	`_cÚ‹Á_f›ld_švoke_deçuÉ
('´•¬Œª¦©iÚ', 
$node
);

405 
$add™iÚs
 = 
	`_cÚ‹Á_f›ld_švoke
('´•¬Œª¦©iÚ', 
$node
);

408 
$node
 = (
objeù
è
	`¬¿y_m”ge
((
¬¿y
è$node, 
$deçuÉ_add™iÚs
, 
$add™iÚs
);

409 
	}
}

414 
funùiÚ
 
	$cÚ‹Á_nod—pi
(&
$node
, 
$İ
, 
$a3
 = 
NULL
, 
$a4
 = NULL) {

416 ià(
	`is£t
(
$node
->
ty³
)) {

417 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$node
->
ty³
);

419 ià(!
	`em±y
(
$ty³
['fields'])) {

420 
$ÿÎback
 = 'cÚ‹Á_'. 
	`¡r_»¶aû
(' ', '_', 
$İ
);

421 ià(
	`funùiÚ_exi¡s
(
$ÿÎback
)) {

422 
	`$ÿÎback
(
$node
, 
$a3
, 
$a4
);

428 ià(
$İ
 == 'view') {

429 
$node
->
cÚ‹Á
['#pre_render'][] = 'content_alter_extra_weights';

430 
$node
->
cÚ‹Á
['#cÚ‹Á_exŒa_f›lds'] = 
$ty³
['extra'];

433 
	}
}

438 
funùiÚ
 
	$cÚ‹Á_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

439 ià(
	`is£t
(
$fÜm
['ty³']è&& is£t($fÜm['#node']è&& $fÜm['ty³']['#v®ue'] .'_node_fÜm' =ğ
$fÜm_id
) {

440 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$fÜm
['#node']->
ty³
);

441 ià(!
	`em±y
(
$ty³
['fields'])) {

442 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.node_form');

444 
$fÜm
 = 
	`¬¿y_m”ge
($fÜm, 
	`cÚ‹Á_fÜm
($fÜm, 
$fÜm_¡©e
));

446 
$fÜm
['#pre_render'][] = 'content_alter_extra_weights';

447 
$fÜm
['#cÚ‹Á_exŒa_f›lds'] = 
$ty³
['extra'];

449 
	}
}

454 
funùiÚ
 
	$cÚ‹Á_®‹r_exŒa_weights
(
$–em’ts
) {

455 ià(
	`is£t
(
$–em’ts
['#content_extra_fields'])) {

456 
	`fÜ—ch
 (
$–em’ts
['#cÚ‹Á_exŒa_f›lds'] 
as
 
$key
 => 
$v®ue
) {

459 ià(!
	`is£t
(
$–em’ts
['#bud_id']è&& is£t(
$v®ue
['view']) && isset($elements[$value['view']])) {

460 
$–em’ts
[
$v®ue
['view']]['#weight'] = $value['weight'];

462 
	`–£if
 (
	`is£t
(
$–em’ts
[
$key
])) {

463 
$–em’ts
[
$key
]['#weight'] = 
$v®ue
['weight'];

467  
$–em’ts
;

468 
	}
}

474 
funùiÚ
 
	$cÚ‹Á_add_mÜe_subm™_´oxy
(
$fÜm
, &
$fÜm_¡©e
) {

475 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.node_form');

476 
	`cÚ‹Á_add_mÜe_subm™
(
$fÜm
, 
$fÜm_¡©e
);

477 
	}
}

484 
funùiÚ
 
	$theme_cÚ‹Á_muÉË_v®ues
(
$–em’t
) {

485 
$f›ld_Çme
 = 
$–em’t
['#field_name'];

486 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
);

487 
$ouut
 = '';

489 ià(
$f›ld
['multiple'] >= 1) {

490 
$bË_id
 = 
$–em’t
['#field_name'] .'_values';

491 
$Üd”_şass
 = 
$–em’t
['#field_name'] .'-delta-order';

492 
$»quœed
 = !
	`em±y
(
$–em’t
['#»quœed']è? '<¥ª cÏss="fÜm-»quœed"™Ë="'. 
	`t
('This field is„equired.') .'">*</span>' : '';

494 
$h—d”
 = 
	`¬¿y
(

495 
	`¬¿y
(

496 'd©a' => 
	`t
('!t™Ë: !»quœed', 
	`¬¿y
('!t™Ë' => 
$–em’t
['#t™Ë'], '!»quœed' => 
$»quœed
)),

499 
	`t
('Order'),

501 
$rows
 = 
	`¬¿y
();

505 
$™ems
 = 
	`¬¿y
();

506 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$–em’t
è
as
 
$key
) {

507 ià(
$key
 !=ğ
$–em’t
['#field_name'] .'_add_more') {

508 
$™ems
[] = &
$–em’t
[
$key
];

511 
	`usÜt
(
$™ems
, '_content_sort_items_value_helper');

514 
	`fÜ—ch
 (
$™ems
 
as
 
$key
 => 
$™em
) {

515 
$™em
['_weight']['#©Œibu‹s']['şass'] = 
$Üd”_şass
;

516 
$d–_–em’t
 = 
	`dru·l_»nd”
(
$™em
['_weight']);

517 
$ûÎs
 = 
	`¬¿y
(

518 
	`¬¿y
('data' => '', 'class' => 'content-multiple-drag'),

519 
	`dru·l_»nd”
(
$™em
),

520 
	`¬¿y
('d©a' => 
$d–_–em’t
, 'class' => 'delta-order'),

522 
$rows
[] = 
	`¬¿y
(

523 'd©a' => 
$ûÎs
,

528 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('id' => 
$bË_id
, 'class' => 'content-multiple-table'));

529 
$ouut
 .ğ
$–em’t
['#description'] ? '<div class="description">'. $element['#description'] .'</div>' : '';

530 
$ouut
 .ğ
	`dru·l_»nd”
(
$–em’t
[$element['#field_name'] .'_add_more']);

532 
	`dru·l_add_bËd¿g
(
$bË_id
, 'Üd”', 'siblšg', 
$Üd”_şass
);

535 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$–em’t
è
as
 
$key
) {

536 
$ouut
 .ğ
	`dru·l_»nd”
(
$–em’t
[
$key
]);

540  
$ouut
;

541 
	}
}

554 
funùiÚ
 
	$cÚ‹Á_nÙify
(
$İ
, 
$moduË
) {

555 
$İ
) {

557 
	`cÚ‹Á_ş—r_ty³_ÿche
();

560 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

561 
	`cÚ‹Á_moduË_d–‘e
(
$moduË
);

564 
	`cÚ‹Á_assocŸ‹_f›lds
(
$moduË
);

565 
	`cÚ‹Á_ş—r_ty³_ÿche
();

570 ià(
	`v¬ŸbË_g‘
('content_schema_version', -1) < 6007) {

571  
FALSE
;

573 
	`db_qu”y
("UPDATE {". 
	`cÚ‹Á_f›ld_bËÇme
(è."} SET‡ùive=0 WHERE moduË='%s'", 
$moduË
);

574 
	`db_qu”y
("UPDATE {". 
	`cÚ‹Á_š¡ªû_bËÇme
(è."} SET widg‘_aùive=0 WHERE widg‘_moduË='%s'", 
$moduË
);

575 
	`cÚ‹Á_ş—r_ty³_ÿche
(
TRUE
);

578 
	}
}

586 
funùiÚ
 
	$cÚ‹Á_assocŸ‹_f›lds
(
$moduË
) {

589 ià(
	`v¬ŸbË_g‘
('content_schema_version', -1) < 6007) {

590  
FALSE
;

592 
$moduË_f›lds
 = 
	`moduË_švoke
(
$moduË
, 'field_info');

593 ià(
$moduË_f›lds
) {

594 
	`fÜ—ch
 (
$moduË_f›lds
 
as
 
$Çme
 => 
$f›ld_šfo
) {

595 
	`w©chdog
('cÚ‹Á', 'Upd©šg f›ldy³ %ty³ w™h moduË %moduË.', 
	`¬¿y
('%ty³' => 
$Çme
, '%moduË' => 
$moduË
));

596 
	`db_qu”y
("UPDATE {". 
	`cÚ‹Á_f›ld_bËÇme
(è."} SET moduË = '%s',‡ùivğ%d WHEREy³ = '%s'", 
$moduË
, 1, 
$Çme
);

599 
$moduË_widg‘s
 = 
	`moduË_švoke
(
$moduË
, 'widget_info');

600 ià(
$moduË_widg‘s
) {

601 
	`fÜ—ch
 (
$moduË_widg‘s
 
as
 
$Çme
 => 
$widg‘_šfo
) {

602 
	`w©chdog
('cÚ‹Á', 'Upd©šg widg‘y³ %ty³ w™h moduË %moduË.', 
	`¬¿y
('%ty³' => 
$Çme
, '%moduË' => 
$moduË
));

603 
	`db_qu”y
("UPDATE {". 
	`cÚ‹Á_š¡ªû_bËÇme
(è."} SET widg‘_moduË = '%s', widg‘_aùivğ%d WHERE widg‘_ty³ = '%s'", 
$moduË
, 1, 
$Çme
);

608 
$f›lds_£t
 = 
	`¬¿y
();

609 
	`moduË_lßd_šşude
('install', 'content');

610 
$ty³s
 = 
	`cÚ‹Á_ty³s_š¡®l
();

611 
	`fÜ—ch
 (
$ty³s
 
as
 
$ty³_Çme
 => 
$f›lds
) {

612 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
) {

613 ià(
$f›ld
['moduË'] =ğ
$moduË
 && !
	`š_¬¿y
($f›ld['f›ld_Çme'], 
$f›lds_£t
)) {

614 
$cŞumns
 = (
¬¿y
è
	`moduË_švoke
(
$f›ld
['module'], 'field_settings', 'database columns', $field);

615 
	`db_qu”y
("UPDATE {". 
	`cÚ‹Á_f›ld_bËÇme
(è."} SET db_cŞumn ğ'%s' WHERE f›ld_Çmğ'%s'", 
	`£rŸlize
(
$cŞumns
), 
$f›ld
['field_name']);

616 
$f›lds_£t
[] = 
$f›ld
['field_name'];

620 
	}
}

686 
funùiÚ
 
	$cÚ‹Á_f›ld
(
$İ
, &
$node
, 
$f›ld
, &
$™ems
, 
$‹a£r
, 
$·ge
) {

687 
$İ
) {

698 ià(!
	`em±y
(
$node
->
dev–_g’”©e
)) {

699 
	`šşude_Úû
('./'. 
	`dru·l_g‘_·th
('module', 'content') .'/includes/content.devel.inc');

700 
	`cÚ‹Á_g’”©e_f›lds
(
$node
, 
$f›ld
);

701 
$™ems
 = 
$node
->{
$f›ld
['field_name']};

709 ià(
	`em±y
(
$™ems
è&& !
	`is£t
(
$node
->
nid
)) {

710 
	`fÜ—ch
 (
	`¬¿y_keys
(
$f›ld
['cŞumns']è
as
 
$cŞumn
) {

711 
$™ems
[0][
$cŞumn
] = 
NULL
;

713 
$node
->
$f›ld
['f›ld_Çme'] = 
$™ems
;

718 
	`un£t
(
$™ems
[
$f›ld
['field_name'] .'_add_more']);

720 ià(
	`cÚ‹Á_hªdË
('widg‘', 'muÉË v®ues', 
$f›ld
è=ğ
CONTENT_HANDLE_CORE
) {

722 
$™ems
 = 
	`_cÚ‹Á_sÜt_™ems
(
$f›ld
, $items);

726 
$™ems
 = 
	`cÚ‹Á_£t_em±y
(
$f›ld
, $items);

731 
$add™iÚ
 = 
	`¬¿y
();

734 ià(
$node
->
bud_mode
 =ğ
NODE_BUILD_PREVIEW
 && 
	`cÚ‹Á_hªdË
('widg‘', 'muÉË v®ues', 
$f›ld
è=ğ
CONTENT_HANDLE_CORE
) {

735 ià(
	`cÚ‹Á_hªdË
('widg‘', 'muÉË v®ues', 
$f›ld
è=ğ
CONTENT_HANDLE_CORE
) {

737 
$™ems
 = 
	`_cÚ‹Á_sÜt_™ems
(
$f›ld
, $items);

741 
$™ems
 = 
	`cÚ‹Á_£t_em±y
(
$f›ld
, $items);

745 ià(
$node
->
bud_mode
 ==ğ
NODE_BUILD_NORMAL
 || $node->bud_mod=ğ
NODE_BUILD_PREVIEW
) {

746 
$cÚ‹xt
 = 
$‹a£r
 ? 'teaser' : 'full';

749 
$cÚ‹xt
 = 
$node
->
bud_mode
;

753 
$fÜm©‹r_Çme
 = 
	`is£t
(
$f›ld
['di¥Ïy_£‰šgs'][
$cÚ‹xt
]) && isset($field['display_settings'][$context]['format']) ? $field['display_settings'][$context]['format'] : 'default';

754 ià(
$fÜm©‹r
 = 
	`_cÚ‹Á_g‘_fÜm©‹r
(
$fÜm©‹r_Çme
, 
$f›ld
['type'])) {

755 
$theme
 = 
$fÜm©‹r
['moduË'] .'_fÜm©‹r_'. 
$fÜm©‹r_Çme
;

756 
$sšgË
 = (
	`cÚ‹Á_hªdË
('fÜm©‹r', 'muÉË v®ues', 
$fÜm©‹r
è=ğ
CONTENT_HANDLE_CORE
);

758 
$Ïb–_di¥Ïy
 = 
	`is£t
(
$f›ld
['display_settings']['label']['format']) ? $field['display_settings']['label']['format'] : 'above';

760 ià(
$cÚ‹xt
 =ğ
NODE_BUILD_SEARCH_INDEX
) {

761 
$Ïb–_di¥Ïy
 = 'hidden';

764 
$–em’t
 = 
	`¬¿y
(

766 '#t™Ë' => 
	`check_¶aš
(
	`t
(
$f›ld
['widget']['label'])),

767 '#f›ld_Çme' => 
$f›ld
['field_name'],

768 '#acûss' => 
$fÜm©‹r_Çme
 !ğ'hidd’' && 
	`cÚ‹Á_acûss
('v›w', 
$f›ld
, 
NULL
, 
$node
),

769 '#Ïb–_di¥Ïy' => 
$Ïb–_di¥Ïy
,

770 '#node' => 
$node
,

771 '#‹a£r' => 
$‹a£r
,

772 '#·ge' => 
$·ge
,

773 '#cÚ‹xt' => 
$cÚ‹xt
,

774 '#sšgË' => 
$sšgË
,

775 '™ems' => 
	`¬¿y
(),

779 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

780 
$–em’t
['™ems'][
$d–
] = 
	`¬¿y
(

781 '#™em' => 
$™em
,

782 '#weight' => 
$d–
,

788 
$fÜm©_šfo
 = 
	`¬¿y
(

789 '#theme' => 
$theme
,

790 '#f›ld_Çme' => 
$f›ld
['field_name'],

791 '#ty³_Çme' => 
$node
->
ty³
,

792 '#fÜm©‹r' => 
$fÜm©‹r_Çme
,

793 '#node' => 
$node
,

795 ià(
$sšgË
) {

796 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

797 
$–em’t
['™ems'][
$d–
] +ğ
$fÜm©_šfo
;

798 
$–em’t
['™ems'][
$d–
]['#item']['#delta'] = $delta;

802 
$–em’t
['™ems'] +ğ
$fÜm©_šfo
;

809 
$w¿µ”
 = 
	`¬¿y
(

810 'f›ld' => 
$–em’t
,

811 '#weight' => 
$f›ld
['widget']['weight'],

812 '#po¡_»nd”' => 
	`¬¿y
('content_field_wrapper_post_render'),

813 '#f›ld_Çme' => 
$f›ld
['field_name'],

814 '#ty³_Çme' => 
$node
->
ty³
,

815 '#cÚ‹xt' => 
$cÚ‹xt
,

818 
$add™iÚ
 = 
	`¬¿y
(
$f›ld
['f›ld_Çme'] => 
$w¿µ”
);

820  
$add™iÚ
;

829 
$w¿µ”
 = 
NULL
;

830 ià(
	`is£t
(
$node
->
cÚ‹Á
[
$f›ld
['field_name']])) {

831 
$w¿µ”
 = 
$node
->
cÚ‹Á
[
$f›ld
['field_name']];

833 
	`–£if
 (
	`moduË_exi¡s
('f›ldgroup'è&& (
$group_Çme
 = 
	`f›ldgroup_g‘_group
(
$node
->
ty³
, 
$f›ld
['f›ld_Çme'])è&& 
	`is£t
($node->
cÚ‹Á
[$group_name]['group'][$field['field_name']])) {

834 
$w¿µ”
 = 
$node
->
cÚ‹Á
[
$group_Çme
]['group'][
$f›ld
['field_name']];

837 ià(
$w¿µ”
) {

838 
$–em’t
 = 
$w¿µ”
['field'];

840 ià(
	`is£t
(
$–em’t
['#single'])) {

841 ià(!
	`em±y
(
$–em’t
['#single'])) {

843 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$–em’t
['™ems']è
as
 
$d–
) {

845 
$™ems
[
$d–
]['v›w'] = 
	`is£t
(
$–em’t
['items'][$delta]['#children']) ? $element['items'][$delta]['#children'] : '';

848 
	`–£if
 (
	`is£t
(
$–em’t
['items']['#children'])) {

850 
$™ems
[0]['v›w'] = 
$–em’t
['items']['#children'];

855 
$™ems
[0]['view'] = '';

862 
$add™iÚ
 = 
	`¬¿y
();

866 
$w¿µ”
 = 
NULL
;

867 ià(
	`is£t
(
$node
->
cÚ‹Á
[
$f›ld
['field_name']])) {

868 
$w¿µ”
 = 
$node
->
cÚ‹Á
[
$f›ld
['field_name']];

870 
	`–£if
 (
	`moduË_exi¡s
('f›ldgroup'è&& (
$group_Çme
 = 
	`f›ldgroup_g‘_group
(
$node
->
ty³
, 
$f›ld
['f›ld_Çme'])è&& 
	`is£t
($node->
cÚ‹Á
[$group_name]['group'][$field['field_name']])) {

871 
$w¿µ”
 = 
$node
->
cÚ‹Á
[
$group_Çme
]['group'][
$f›ld
['field_name']];

874 ià(
$w¿µ”
) {

876 
$add™iÚ
[
$f›ld
['f›ld_Çme'] .'_»nd”ed'] = 
	`is£t
(
$w¿µ”
['#children']) ? $wrapper['#children'] : '';

879  
$add™iÚ
;

882 
$add™iÚ
 = 
	`¬¿y
();

883 ià(
	`is£t
(
$node
->
Œª¦©iÚ_sourû
->
$f›ld
['field_name'])) {

884 
$add™iÚ
[
$f›ld
['f›ld_Çme']] = 
$node
->
Œª¦©iÚ_sourû
->$field['field_name'];

886  
$add™iÚ
;

888 
	}
}

901 
funùiÚ
 
	$cÚ‹Á_£t_em±y
(
$f›ld
, 
$™ems
) {

903 
$f‹»d
 = 
	`¬¿y
();

904 
$funùiÚ
 = 
$f›ld
['module'] .'_content_is_empty';

905 
	`fÜ—ch
 ((
¬¿y
è
$™ems
 
as
 
$d–
 => 
$™em
) {

906 ià(!
	`$funùiÚ
(
$™em
, 
$f›ld
)) {

907 
$f‹»d
[] = 
$™em
;

912 
$em±y
 = 
	`¬¿y
();

913 
	`fÜ—ch
 (
	`¬¿y_keys
(
$f›ld
['cŞumns']è
as
 
$cŞumn
) {

914 
$em±y
[
$cŞumn
] = 
NULL
;

916 
$·d
 = 
$f›ld
['multiple'] > 1 ? $field['multiple'] : 1;

917 
$f‹»d
 = 
	`¬¿y_·d
($f‹»d, 
$·d
, 
$em±y
);

919  
$f‹»d
;

920 
	}
}

926 
funùiÚ
 
	$_cÚ‹Á_sÜt_™ems
(
$f›ld
, 
$™ems
) {

927 ià(
$f›ld
['muÉË'] >ğ1 && 
	`is£t
(
$™ems
[0]['_weight'])) {

928 
	`usÜt
(
$™ems
, '_content_sort_items_helper');

929 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

930 ià(
	`is_¬¿y
(
$™ems
[
$d–
])) {

931 
	`un£t
(
$™ems
[
$d–
]['_weight']);

935  
$™ems
;

936 
	}
}

942 
funùiÚ
 
	$_cÚ‹Á_sÜt_™ems_h–³r
(
$a
, 
$b
) {

943 
$a_weight
 = (
	`is_¬¿y
(
$a
è&& 
	`is£t
($a['_weight'])) ? $a['_weight'] : 0;

944 
$b_weight
 = (
	`is_¬¿y
(
$b
è&& 
	`is£t
($b['_weight'])) ? $b['_weight'] : 0;

945 ià(
$a_weight
 =ğ
$b_weight
) {

948  (
$a_weight
 < 
$b_weight
) ? -1 : 1;

949 
	}
}

954 
funùiÚ
 
	$_cÚ‹Á_sÜt_™ems_v®ue_h–³r
(
$a
, 
$b
) {

955 
$a_weight
 = (
	`is_¬¿y
(
$a
è&& 
	`is£t
($a['_weight']['#value'])) ? $a['_weight']['#value'] : 0;

956 
$b_weight
 = (
	`is_¬¿y
(
$b
è&& 
	`is£t
($b['_weight']['#value'])) ? $b['_weight']['#value'] : 0;

957 ià(
$a_weight
 =ğ
$b_weight
) {

960  (
$a_weight
 < 
$b_weight
) ? -1 : 1;

961 
	}
}

966 
funùiÚ
 
	$cÚ‹Á_¡Üage
(
$İ
, 
$node
) {

969 ià(
	`v¬ŸbË_g‘
('content_schema_version', -1) < 6007) {

970  
FALSE
;

973 
$ty³_Çme
 = 
$node
->
ty³
;

974 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

976 
$İ
) {

980 
$add™iÚs
 = 
	`¬¿y
();

982 
	`fÜ—ch
 (
$ty³
['bËs'] 
as
 
$bË
) {

983 
$schema
 = 
	`dru·l_g‘_schema
(
$bË
);

985 ià(!
$schema
['content fields']) {

988 
$qu”y
 = 'SELECT * FROM {'. 
$bË
 .'} WHERE vid = %d';

993 
$»suÉ
 = 
	`is£t
(
$schema
['f›lds']['d–']è? 
	`db_qu”y
(
$qu”y
 .' ORDER BY d–', 
$node
->
vid
è: 
	`db_qu”y_¿nge
($query, $node->vid, 0, 1);

996 
$row
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

998 
	`fÜ—ch
 (
$schema
['cÚ‹Á f›lds'] 
as
 
$f›ld_Çme
) {

999 
$™em
 = 
	`¬¿y
();

1000 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
, 
$ty³_Çme
);

1001 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

1003 
	`fÜ—ch
 (
$db_šfo
['cŞumns'] 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

1004 
$™em
[
$cŞumn
] = 
$row
[
$©Œibu‹s
['column']];

1008 ià(!
	`is£t
(
$add™iÚs
[
$f›ld_Çme
])) {

1009 
$add™iÚs
[
$f›ld_Çme
] = 
	`¬¿y
();

1011 
$add™iÚs
[
$f›ld_Çme
][] = 
$™em
;

1015  
$add™iÚs
;

1019 
	`fÜ—ch
 (
$ty³
['bËs'] 
as
 
$bË
) {

1020 
$schema
 = 
	`dru·l_g‘_schema
(
$bË
);

1021 
$»cÜd
 = 
	`¬¿y
();

1022 
	`fÜ—ch
 (
$schema
['cÚ‹Á f›lds'] 
as
 
$f›ld_Çme
) {

1023 ià(
	`is£t
(
$node
->
$f›ld_Çme
)) {

1024 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
, 
$ty³_Çme
);

1026 ià(
$f›ld
['multiple']) {

1029 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

1030 
	`fÜ—ch
 (
$db_šfo
['cŞumns'] 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

1031 
$»cÜd
[
$©Œibu‹s
['cŞumn']] = 
$node
->{
$f›ld_Çme
}[0][
$cŞumn
];

1040 ià(
	`couÁ
(
$»cÜd
è|| 
	`em±y
(
$schema
['content fields'])) {

1041 
$»cÜd
['nid'] = 
$node
->
nid
;

1042 
$»cÜd
['vid'] = 
$node
->
vid
;

1051 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {". 
$bË
 ."} WHERE vid = %d", 
$node
->
vid
))) {

1052 
	`cÚ‹Á_wr™e_»cÜd
(
$bË
, 
$»cÜd
, 
	`¬¿y
('vid'));

1055 
	`cÚ‹Á_wr™e_»cÜd
(
$bË
, 
$»cÜd
);

1061 
	`fÜ—ch
 (
$ty³
['f›lds'] 
as
 
$f›ld
) {

1062 ià(
$f›ld
['muÉË'] && 
	`is£t
(
$node
->$field['field_name'])) {

1063 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

1065 ià(
$İ
 == 'update') {

1066 
	`db_qu”y
('DELETE FROM {'. 
$db_šfo
['bË'] .'} WHERE vid = %d', 
$node
->
vid
);

1068 
	`fÜ—ch
 (
$node
->
$f›ld
['f›ld_Çme'] 
as
 
$d–
 => 
$™em
) {

1069 
$»cÜd
 = 
	`¬¿y
();

1070 
	`fÜ—ch
 (
$db_šfo
['cŞumns'] 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

1071 
$»cÜd
[
$©Œibu‹s
['cŞumn']] = 
$™em
[
$cŞumn
];

1073 
$»cÜd
['nid'] = 
$node
->
nid
;

1074 
$»cÜd
['vid'] = 
$node
->
vid
;

1075 
$»cÜd
['d–'] = 
$d–
;

1076 
	`cÚ‹Á_wr™e_»cÜd
(
$db_šfo
['bË'], 
$»cÜd
);

1083 
	`fÜ—ch
 (
$ty³
['bËs'] 
as
 
$bË
) {

1084 
	`db_qu”y
('DELETE FROM {'. 
$bË
 .'} WHERE‚id = %d', 
$node
->
nid
);

1089 
	`fÜ—ch
 (
$ty³
['bËs'] 
as
 
$bË
) {

1090 
	`db_qu”y
('DELETE FROM {'. 
$bË
 .'} WHERE vid = %d', 
$node
->
vid
);

1094 
	}
}

1127 
funùiÚ
 
cÚ‹Á_wr™e_»cÜd
(
$bË
, &
$objeù
, 
$upd©e
 = 
	$¬¿y
()) {

1129 ià(
	`is_¡ršg
(
$upd©e
)) {

1130 
$upd©e
 = 
	`¬¿y
($update);

1134 ià(
	`is_¬¿y
(
$objeù
)) {

1135 
$objeù
 = (
objeù
) $object;

1136 
$¬¿y
 = 
TRUE
;

1139 
$¬¿y
 = 
FALSE
;

1142 
$schema
 = 
	`dru·l_g‘_schema
(
$bË
);

1143 ià(
	`em±y
(
$schema
)) {

1144  
FALSE
;

1147 
$f›lds
 = 
$defs
 = 
$v®ues
 = 
$£rŸls
 = 
$¶aûhŞd”s
 = 
	`¬¿y
();

1151 
	`fÜ—ch
 (
$schema
['f›lds'] 
as
 
$f›ld
 => 
$šfo
) {

1153 ià(
$šfo
['ty³'] =ğ'£rŸl' && 
	`couÁ
(
$upd©e
)) {

1158 ià(!
	`is£t
(
$objeù
->
$f›ld
è&& !
	`couÁ
(
$upd©e
è&& is£t(
$šfo
['default'])) {

1159 
$objeù
->
$f›ld
 = 
$šfo
['default'];

1163 ià(
$šfo
['type'] == 'serial') {

1164 
$£rŸls
[] = 
$f›ld
;

1166 
	`un£t
(
$objeù
->
$f›ld
);

1170 ià(
	`is£t
(
$objeù
->
$f›ld
è|| 
	`¬¿y_key_exi¡s
($field, $object)) {

1171 
$f›lds
[] = 
$f›ld
;

1172 ià(
	`is£t
(
$objeù
->
$f›ld
)) {

1173 
$¶aûhŞd”s
[] = 
	`db_ty³_¶aûhŞd”
(
$šfo
['type']);

1175 ià(
	`em±y
(
$šfo
['serialize'])) {

1176 
$v®ues
[] = 
$objeù
->
$f›ld
;

1179 
$v®ues
[] = 
	`£rŸlize
(
$objeù
->
$f›ld
);

1183 
$¶aûhŞd”s
[] = 'NULL';

1189 
$qu”y
 = '';

1190 ià(!
	`couÁ
(
$upd©e
)) {

1191 
$qu”y
 = "INSERT INTO {". 
$bË
 ."} (". 
	`im¶ode
(', ', 
$f›lds
è.'èVALUES ('. im¶ode(', ', 
$¶aûhŞd”s
) .')';

1192 
$»tuº
 = 
SAVED_NEW
;

1195 
$qu”y
 = '';

1196 
	`fÜ—ch
 (
$f›lds
 
as
 
$id
 => 
$f›ld
) {

1197 ià(
$qu”y
) {

1198 
$qu”y
 .= ', ';

1200 
$qu”y
 .ğ
$f›ld
 .' = '. 
$¶aûhŞd”s
[
$id
];

1203 
	`fÜ—ch
 (
$upd©e
 
as
 
$key
) {

1204 
$cÚd™iÚs
[] = "$key = ". 
	`db_ty³_¶aûhŞd”
(
$schema
['f›lds'][
$key
]['type']);

1205 
$v®ues
[] = 
$objeù
->
$key
;

1208 
$qu”y
 = "UPDATE {". 
$bË
 ."} SET $qu”y WHERE ". 
	`im¶ode
(' AND ', 
$cÚd™iÚs
);

1209 
$»tuº
 = 
SAVED_UPDATED
;

1213 ià(
	`db_qu”y
(
$qu”y
, 
$v®ues
)) {

1214 ià(
$£rŸls
) {

1216 
	`fÜ—ch
 (
$£rŸls
 
as
 
$f›ld
) {

1217 
$objeù
->
$f›ld
 = 
	`db_Ï¡_š£¹_id
(
$bË
, $field);

1222 ià(
$¬¿y
) {

1223 
$objeù
 = (
¬¿y
) $object;

1226  
$»tuº
;

1229  
FALSE
;

1230 
	}
}

1238 
funùiÚ
 
	$_cÚ‹Á_f›ld_švoke
(
$İ
, &
$node
, 
$‹a£r
 = 
NULL
, 
$·ge
 = NULL) {

1239 
$ty³_Çme
 = 
	`is_¡ršg
(
$node
è? $nod: (
	`is_¬¿y
($nodeè? $node['ty³'] : $node->
ty³
);

1240 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

1241 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

1243 
$»tuº
 = 
	`¬¿y
();

1244 
	`fÜ—ch
 (
$ty³
['f›lds'] 
as
 
$f›ld
) {

1245 
$™ems
 = 
	`is£t
(
$node
->
$f›ld
['f›ld_Çme']è? $node->$f›ld['f›ld_Çme'] : 
	`¬¿y
();

1248 
	`un£t
(
$™ems
[
$f›ld
['field_name'] .'_add_more']);

1250 
$moduË
 = 
$f›ld_ty³s
[
$f›ld
['type']]['module'];

1251 
$funùiÚ
 = 
$moduË
 .'_field';

1252 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

1253 
$»suÉ
 = 
	`$funùiÚ
(
$İ
, 
$node
, 
$f›ld
, 
$™ems
, 
$‹a£r
, 
$·ge
);

1254 ià(
	`is_¬¿y
(
$»suÉ
)) {

1255 
$»tuº
 = 
	`¬¿y_m”ge
($»tuº, 
$»suÉ
);

1257 ià(
	`is£t
(
$»suÉ
)) {

1258 
$»tuº
[] = 
$»suÉ
;

1262 ià(
	`is£t
(
$node
->
$f›ld
['f›ld_Çme']è|| 
	`couÁ
(
$™ems
)) {

1263 
$node
->
$f›ld
['f›ld_Çme'] = 
$™ems
;

1266  
$»tuº
;

1267 
	}
}

1272 
funùiÚ
 
	$_cÚ‹Á_f›ld_švoke_deçuÉ
(
$İ
, &
$node
, 
$‹a£r
 = 
NULL
, 
$·ge
 = NULL) {

1273 
$ty³_Çme
 = 
	`is_¡ršg
(
$node
è? $nod: (
	`is_¬¿y
($nodeè? $node['ty³'] : $node->
ty³
);

1274 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

1275 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

1277 
$»tuº
 = 
	`¬¿y
();

1280 ià(
	`š_¬¿y
(
$İ
, 
	`¬¿y
('load', 'insert', 'update', 'delete', 'delete„evision'))) {

1281  
	`cÚ‹Á_¡Üage
(
$İ
, 
$node
);

1284 
	`fÜ—ch
 (
$ty³
['f›lds'] 
as
 
$f›ld
) {

1285 
$™ems
 = 
	`is£t
(
$node
->
$f›ld
['f›ld_Çme']è? $node->$f›ld['f›ld_Çme'] : 
	`¬¿y
();

1286 
$»suÉ
 = 
	`cÚ‹Á_f›ld
(
$İ
, 
$node
, 
$f›ld
, 
$™ems
, 
$‹a£r
, 
$·ge
);

1287 ià(
	`is_¬¿y
(
$»suÉ
)) {

1288 
$»tuº
 = 
	`¬¿y_m”ge
($»tuº, 
$»suÉ
);

1290 ià(
	`is£t
(
$»suÉ
)) {

1291 
$»tuº
[] = 
$»suÉ
;

1293 ià(
	`is£t
(
$node
->
$f›ld
['field_name'])) {

1294 
$node
->
$f›ld
['f›ld_Çme'] = 
$™ems
;

1298  
$»tuº
;

1299 
	}
}

1310 
funùiÚ
 
	$cÚ‹Á_ty³s
(
$ty³_Çme
 = 
NULL
) {

1312 
$ty³_Çme
 = !
	`em±y
($ty³_Çmeè? 
	`¡r_»¶aû
('-', '_', $ty³_Çmeè: 
NULL
;

1314 
$šfo
 = 
	`_cÚ‹Á_ty³_šfo
();

1315 ià(
	`is£t
(
$šfo
['contentypes'])) {

1316 ià(!
	`is£t
(
$ty³_Çme
)) {

1317  
$šfo
['contentypes'];

1319 ià(
	`is£t
(
$šfo
['cÚ‹Áy³s'][
$ty³_Çme
])) {

1320  
$šfo
['cÚ‹Áy³s'][
$ty³_Çme
];

1323  
	`¬¿y
('tables' =>‡rray(), 'fields' =>‡rray(), 'extra' =>‡rray());

1324 
	}
}

1339 
funùiÚ
 
	$cÚ‹Á_f›lds
(
$f›ld_Çme
 = 
NULL
, 
$cÚ‹Á_ty³_Çme
 = NULL) {

1340 
$šfo
 = 
	`_cÚ‹Á_ty³_šfo
();

1341 ià(
	`is£t
(
$šfo
['fields'])) {

1342 ià(
	`em±y
(
$f›ld_Çme
)) {

1343  
$šfo
['fields'];

1345 ià(
	`is£t
(
$šfo
['f›lds'][
$f›ld_Çme
])) {

1346 ià(
	`em±y
(
$cÚ‹Á_ty³_Çme
)) {

1347  
$šfo
['f›lds'][
$f›ld_Çme
];

1349 ià(
	`is£t
(
$šfo
['cÚ‹Áy³s'][
$cÚ‹Á_ty³_Çme
]['f›lds'][
$f›ld_Çme
])) {

1350  
$šfo
['cÚ‹Áy³s'][
$cÚ‹Á_ty³_Çme
]['f›lds'][
$f›ld_Çme
];

1354 
	}
}

1359 
funùiÚ
 
	$_cÚ‹Á_f›ld_ty³s
() {

1360 
$šfo
 = 
	`_cÚ‹Á_ty³_šfo
();

1361  
	`is£t
(
$šfo
['f›ldy³s']è? $šfo['f›ldy³s'] : 
	`¬¿y
();

1362 
	}
}

1367 
funùiÚ
 
	$_cÚ‹Á_widg‘_ty³s
() {

1368 
$šfo
 = 
	`_cÚ‹Á_ty³_šfo
();

1369  
	`is£t
(
$šfo
['widg‘y³s']è? $šfo['widg‘y³s'] : 
	`¬¿y
();

1370 
	}
}

1376 
funùiÚ
 
	$_cÚ‹Á_g‘_fÜm©‹r
(
$fÜm©‹r_Çme
, 
$f›ld_ty³
) {

1377 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

1378 
$fÜm©‹rs
 = 
$f›ld_ty³s
[
$f›ld_ty³
]['formatters'];

1380 ià(!
	`is£t
(
$fÜm©‹rs
[
$fÜm©‹r_Çme
]) && $formatter_name != 'hidden') {

1383 
$fÜm©‹r_Çme
 = 'default';

1386  
	`is£t
(
$fÜm©‹rs
[
$fÜm©‹r_Çme
]è? $fÜm©‹rs[$fÜm©‹r_Çme] : 
FALSE
;

1387 
	}
}

1395 
funùiÚ
 
	$_cÚ‹Á_ty³_šfo
(
$»£t
 = 
FALSE
) {

1396 
glob®
 
$Ïnguage
;

1397 
$šfo
;

1399 ià(
$»£t
 || !
	`is£t
(
$šfo
)) {

1407 ià(
	`v¬ŸbË_g‘
('content_schema_version', -1) < 6007) {

1408  
	`¬¿y
();

1411 ià(!
$»£t
 && 
$ÿched
 = 
	`ÿche_g‘
('cÚ‹Á_ty³_šfo:'. 
$Ïnguage
->
Ïnguage
, 
	`cÚ‹Á_ÿche_bËÇme
())) {

1412 
$šfo
 = 
$ÿched
->
d©a
;

1415 
$šfo
 = 
	`¬¿y
(

1416 'f›ldy³s' => 
	`¬¿y
(),

1417 'widg‘y³s' => 
	`¬¿y
(),

1418 'f›lds' => 
	`¬¿y
(),

1419 'cÚ‹Áy³s' => 
	`¬¿y
(),

1423 
	`fÜ—ch
 (
	`moduË_li¡
(è
as
 
$moduË
) {

1424 
$moduË_f›ld_ty³s
 = 
	`moduË_švoke
(
$moduË
, 'field_info');

1425 ià(
$moduË_f›ld_ty³s
) {

1426 
	`fÜ—ch
 (
$moduË_f›ld_ty³s
 
as
 
$Çme
 => 
$f›ld_šfo
) {

1428 
$db_Çme
 = 
	`sub¡r
(
$Çme
, 0, 32);

1429 
$šfo
['f›ldy³s'][
$db_Çme
] = 
$f›ld_šfo
;

1430 
$šfo
['f›ldy³s'][
$db_Çme
]['moduË'] = 
$moduË
;

1431 
$šfo
['f›ldy³s'][
$db_Çme
]['fÜm©‹rs'] = 
	`¬¿y
();

1437 
	`fÜ—ch
 (
	`moduË_li¡
(è
as
 
$moduË
) {

1438 ià(
$moduË_widg‘s
 = 
	`moduË_švoke
(
$moduË
, 'widget_info')) {

1439 
	`fÜ—ch
 (
$moduË_widg‘s
 
as
 
$Çme
 => 
$widg‘_šfo
) {

1441 
$db_Çme
 = 
	`sub¡r
(
$Çme
, 0, 32);

1442 
$šfo
['widg‘y³s'][
$db_Çme
] = 
$widg‘_šfo
;

1443 
$šfo
['widg‘y³s'][
$db_Çme
]['moduË'] = 
$moduË
;

1445 
$šfo
['widg‘y³s'][
$db_Çme
]['f›ldy³s'] = 
	`¬¿y
();

1446 
	`fÜ—ch
 (
$widg‘_šfo
['f›ldy³s'] 
as
 
$f›ld_ty³
) {

1447 
$f›ld_ty³_db_Çme
 = 
	`sub¡r
(
$f›ld_ty³
, 0, 32);

1448 ià(
	`is£t
(
$šfo
['f›ldy³s'][
$f›ld_ty³_db_Çme
])) {

1449 
$šfo
['widg‘y³s'][
$db_Çme
]['f›ldy³s'][] = 
$f›ld_ty³_db_Çme
;

1455 ià(
$moduË_fÜm©‹rs
 = 
	`moduË_švoke
(
$moduË
, 'field_formatter_info')) {

1456 
	`fÜ—ch
 (
$moduË_fÜm©‹rs
 
as
 
$Çme
 => 
$fÜm©‹r_šfo
) {

1457 
	`fÜ—ch
 (
$fÜm©‹r_šfo
['f›ldy³s'] 
as
 
$f›ld_ty³
) {

1459 
$db_Çme
 = 
	`sub¡r
(
$f›ld_ty³
, 0, 32);

1460 ià(
	`is£t
(
$šfo
['f›ldy³s'][
$db_Çme
])) {

1461 
$šfo
['f›ldy³s'][
$db_Çme
]['fÜm©‹rs'][
$Çme
] = 
$fÜm©‹r_šfo
;

1462 
$šfo
['f›ldy³s'][
$db_Çme
]['fÜm©‹rs'][
$Çme
]['moduË'] = 
$moduË
;

1470 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

1471 
	`fÜ—ch
 (
	`node_g‘_ty³s
('ty³s', 
NULL
, 
TRUE
è
as
 
$ty³_Çme
 => 
$d©a
) {

1472 
$ty³
 = (
¬¿y
è
$d©a
;

1473 
$ty³
['u¾_¡r'] = 
	`¡r_»¶aû
('_', '-', $type['type']);

1474 
$ty³
['f›lds'] = 
	`¬¿y
();

1475 
$ty³
['bËs'] = 
	`¬¿y
();

1476 ià(
$f›lds
 = 
	`cÚ‹Á_f›ld_š¡ªû_»ad
(
	`¬¿y
('ty³_Çme' => 
$ty³_Çme
))) {

1477 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
) {

1478 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

1479 
$ty³
['bËs'][
$db_šfo
['table']] = $db_info['table'];

1482 
$f›ld_¡ršgs
 = 
	`¬¿y
(

1483 'widg‘_Ïb–' => 
$f›ld
['widget']['label'],

1484 'widg‘_desütiÚ' => 
$f›ld
['widget']['description'],

1486 
	`dru·l_®‹r
('cÚ‹Á_f›ld_¡ršgs', 
$f›ld_¡ršgs
, 
$f›ld
['type_name'], $field['field_name']);

1487 
$f›ld
['widg‘']['Ïb–'] = 
$f›ld_¡ršgs
['widget_label'];

1488 
$f›ld
['widg‘']['desütiÚ'] = 
$f›ld_¡ršgs
['widget_description'];

1490 
$ty³
['f›lds'][
$f›ld
['field_name']] = $field;

1493 
$šfo
['f›lds'][
$f›ld
['field_name']] = $field;

1497 
$bË
 = 
	`_cÚ‹Á_bËÇme
(
$ty³
['ty³'], 
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
);

1498 
$ty³
['bËs'][
$bË
] = $table;

1502 
$exŒa
 = 
	`moduË_švoke_®l
('cÚ‹Á_exŒa_f›lds', 
$ty³_Çme
);

1503 
	`dru·l_®‹r
('cÚ‹Á_exŒa_f›lds', 
$exŒa
, 
$ty³_Çme
);

1505 
	`fÜ—ch
 (
	`v¬ŸbË_g‘
('cÚ‹Á_exŒa_weights_'. 
$ty³_Çme
, 
	`¬¿y
()è
as
 
$key
 => 
$v®ue
) {

1508 ià(
	`is£t
(
$exŒa
[
$key
])) {

1509 
$exŒa
[
$key
]['weight'] = 
$v®ue
;

1512 
$ty³
['exŒa'] = 
$exŒa
;

1514 
$šfo
['cÚ‹Áy³s'][
$ty³_Çme
] = 
$ty³
;

1517 
	`ÿche_£t
('cÚ‹Á_ty³_šfo:'. 
$Ïnguage
->
Ïnguage
, 
$šfo
, 
	`cÚ‹Á_ÿche_bËÇme
());

1520  
$šfo
;

1521 
	}
}

1527 
funùiÚ
 
	$cÚ‹Á_node_ty³
(
$İ
, 
$šfo
) {

1528 
$İ
) {

1530 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

1531 
	`cÚ‹Á_ty³_ü—‹
(
$šfo
);

1534 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

1535 
	`cÚ‹Á_ty³_upd©e
(
$šfo
);

1538 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

1539 
	`cÚ‹Á_ty³_d–‘e
(
$šfo
);

1542 
	}
}

1548 
funùiÚ
 
	$cÚ‹Á_ş—r_ty³_ÿche
(
$»bud_schema
 = 
FALSE
) {

1549 
	`ÿche_ş—r_®l
('*', 
	`cÚ‹Á_ÿche_bËÇme
(), 
TRUE
);

1550 
	`_cÚ‹Á_ty³_šfo
(
TRUE
);

1553 ià(
$»bud_schema
) {

1554 
$schema
 = 
	`dru·l_g‘_schema
(
NULL
, 
TRUE
);

1557 ià(
	`moduË_exi¡s
('views')) {

1559 
	`moduË_lßd_šşude
('module', 'views');

1560 
	`v›ws_šv®id©e_ÿche
();

1562 
	}
}

1579 
funùiÚ
 
	$cÚ‹Á_d©aba£_šfo
(
$f›ld
) {

1580 
$db_šfo
 = 
	`¬¿y
();

1581 ià(
$f›ld
['db_¡Üage'] =ğ
CONTENT_DB_STORAGE_PER_FIELD
) {

1582 
$db_šfo
['bË'] = 
	`_cÚ‹Á_bËÇme
(
$f›ld
['f›ld_Çme'], 
CONTENT_DB_STORAGE_PER_FIELD
);

1585 
$db_šfo
['bË'] = 
	`_cÚ‹Á_bËÇme
(
$f›ld
['ty³_Çme'], 
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
);

1588 
$db_šfo
['cŞumns'] = (
¬¿y
è
$f›ld
['columns'];

1590 
	`fÜ—ch
 (
$db_šfo
['cŞumns'] 
as
 
$cŞumn_Çme
 => 
$©Œibu‹s
) {

1591 
$db_šfo
['cŞumns'][
$cŞumn_Çme
]['cŞumn'] = 
$f›ld
['field_name'] .'_'. $column_name;

1594  
$db_šfo
;

1595 
	}
}

1600 
funùiÚ
 
	$cÚ‹Á_¡Üage_ty³
(
$f›ld
) {

1601 ià(
$f›ld
['multiple'] > 0) {

1602  
CONTENT_DB_STORAGE_PER_FIELD
;

1605 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

1606 
$š¡ªûs
 = 
	`cÚ‹Á_f›ld_š¡ªû_»ad
(
	`¬¿y
('f›ld_Çme' => 
$f›ld
['field_name']));

1607 ià(
	`couÁ
(
$š¡ªûs
) > 1) {

1608  
CONTENT_DB_STORAGE_PER_FIELD
;

1611  
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
;

1612 
	}
}

1627 
funùiÚ
 
	$cÚ‹Á_Œª¥o£_¬¿y_rows_cŞs
(
$¬¿y
) {

1628 
$»suÉ
 = 
	`¬¿y
();

1629 ià(
	`is_¬¿y
(
$¬¿y
)) {

1630 
	`fÜ—ch
 (
$¬¿y
 
as
 
$key1
 => 
$v®ue1
) {

1631 ià(
	`is_¬¿y
(
$v®ue1
)) {

1632 
	`fÜ—ch
 (
$v®ue1
 
as
 
$key2
 => 
$v®ue2
) {

1633 ià(!
	`is£t
(
$»suÉ
[
$key2
])) {

1634 
$»suÉ
[
$key2
] = 
	`¬¿y
();

1636 
$»suÉ
[
$key2
][
$key1
] = 
$v®ue2
;

1641  
$»suÉ
;

1642 
	}
}

1652 
funùiÚ
 
	$cÚ‹Á_¬¿y_æ©‹n
(
$¬¿y
) {

1653 
$»suÉ
 = 
	`¬¿y
();

1654 ià(
	`is_¬¿y
(
$¬¿y
)) {

1655 
	`fÜ—ch
 (
$¬¿y
 
as
 
$key
 => 
$v®ue
) {

1656 ià(
	`is_¬¿y
(
$v®ue
)) {

1657 
$»suÉ
 +ğ
	`cÚ‹Á_¬¿y_æ©‹n
(
$v®ue
);

1660 
$»suÉ
[
$key
] = 
$v®ue
;

1664  
$»suÉ
;

1665 
	}
}

1682 
funùiÚ
 
	$cÚ‹Á_®lowed_v®ues
(
$f›ld
, 
$æ©‹n
 = 
TRUE
) {

1683 
$®lowed_v®ues
;

1685 
$cid
 = 
$f›ld
['f›ld_Çme'] .':'. (
$æ©‹n
 ? '1' : '0');

1686 ià(
	`is£t
(
$®lowed_v®ues
[
$cid
])) {

1687  
$®lowed_v®ues
[
$cid
];

1690 
$®lowed_v®ues
[
$cid
] = 
	`¬¿y
();

1692 ià(
	`is£t
(
$f›ld
['allowed_values_php'])) {

1693 
	`ob_¡¬t
();

1694 
$»suÉ
 = 
	`ev®
(
$f›ld
['allowed_values_php']);

1695 ià(
	`is_¬¿y
(
$»suÉ
)) {

1696 ià(
$æ©‹n
) {

1697 
$»suÉ
 = 
	`cÚ‹Á_¬¿y_æ©‹n
($result);

1699 
$®lowed_v®ues
[
$cid
] = 
$»suÉ
;

1701 
	`ob_’d_ş—n
();

1704 ià(
	`em±y
(
$®lowed_v®ues
[
$cid
]è&& 
	`is£t
(
$f›ld
['allowed_values'])) {

1705 
$li¡
 = 
	`ex¶ode
("\n", 
$f›ld
['allowed_values']);

1706 
$li¡
 = 
	`¬¿y_m­
('trim', $list);

1707 
$li¡
 = 
	`¬¿y_f‹r
($list, 'strlen');

1708 
	`fÜ—ch
 (
$li¡
 
as
 
$İt
) {

1710 
$İt
 = 
	`cÚ‹Á_f‹r_xss
($opt);

1711 ià(
	`¡½os
(
$İt
, '|'è!=ğ
FALSE
) {

1712 
	`li¡
(
$key
, 
$v®ue
èğ
	`ex¶ode
('|', 
$İt
);

1713 
$®lowed_v®ues
[
$cid
][
$key
] = (
	`is£t
(
$v®ue
) && $value !=='') ? $value : $key;

1716 
$®lowed_v®ues
[
$cid
][
$İt
] = $opt;

1720 
	`dru·l_®‹r
('cÚ‹Á_®lowed_v®ues', 
$®lowed_v®ues
[
$cid
], 
$f›ld
);

1722  
$®lowed_v®ues
[
$cid
];

1723 
	}
}

1732 
funùiÚ
 
	$cÚ‹Á_®lowed_v®ues_f‹r_html
(&
$İtiÚs
) {

1733 
	`fÜ—ch
 (
$İtiÚs
 
as
 
$key
 => 
$İt
) {

1734 ià(
	`is_¬¿y
(
$İt
)) {

1735 
	`cÚ‹Á_®lowed_v®ues_f‹r_html
(
$İtiÚs
[
$key
]);

1738 
$İtiÚs
[
$key
] = 
	`html_’t™y_decode
(
	`¡r_gs
(
$İt
), 
ENT_QUOTES
);

1741 
	}
}

1750 
funùiÚ
 
	$cÚ‹Á_f‹r_xss
(
$¡ršg
) {

1751  
	`f‹r_xss
(
$¡ršg
, 
	`_cÚ‹Á_f‹r_xss_®lowed_gs
());

1752 
	}
}

1757 
funùiÚ
 
	$_cÚ‹Á_f‹r_xss_®lowed_gs
() {

1758  
	`¬¿y
('a', 'b', 'big', 'code', 'del', 'em', 'i', 'ins', 'pre', 'q', 'small', 'span', 'strong', 'sub', 'sup', 'tt', 'ol', 'ul', 'li', 'p', 'br', 'img');

1759 
	}
}

1764 
funùiÚ
 
	$_cÚ‹Á_f‹r_xss_di¥Ïy_®lowed_gs
() {

1765  '<'. 
	`im¶ode
('> <', 
	`_cÚ‹Á_f‹r_xss_®lowed_gs
()) .'>';

1766 
	}
}

1792 
funùiÚ
 
cÚ‹Á_fÜm©
(
$f›ld
, 
$™em
, 
$fÜm©‹r_Çme
 = 'deçuÉ', 
$node
 = 
NULL
) {

1793 ià(!
is_¬¿y
(
$f›ld
)) {

1794 
$f›ld
 = 
cÚ‹Á_f›lds
($field);

1797 ià(
cÚ‹Á_acûss
('v›w', 
$f›ld
, 
NULL
, 
$node
è&& 
	g$fÜm©‹r
 = 
_cÚ‹Á_g‘_fÜm©‹r
(
$fÜm©‹r_Çme
, $field['type'])) {

1798 
	g$theme
 = 
$fÜm©‹r
['moduË'] .'_fÜm©‹r_'. 
$fÜm©‹r_Çme
;

1800 
	g$–em’t
 = 
¬¿y
(

1801 '#theme' => 
$theme
,

1802 '#f›ld_Çme' => 
$f›ld
['field_name'],

1803 '#ty³_Çme' => 
is£t
(
$node
->
ty³
) ? $node->type :'',

1804 '#fÜm©‹r' => 
$fÜm©‹r_Çme
,

1805 '#node' => 
$node
,

1806 '#d–' => 
is£t
(
$™em
['#d–']è? $™em['#d–'] : 
NULL
,

1809 ià(
cÚ‹Á_hªdË
('fÜm©‹r', 'muÉË v®ues', 
$fÜm©‹r
è=ğ
CONTENT_HANDLE_CORE
) {

1813 
$™ems
 = 
¬¿y
(
$™em
);

1814 
	g$funùiÚ
 = 
$f›ld
['module'] .'_field';

1815 ià(
funùiÚ_exi¡s
(
$funùiÚ
)) {

1816 
$funùiÚ
('§n™ize', 
$node
, 
$f›ld
, 
$™ems
, 
FALSE
, FALSE);

1819 
	g$–em’t
['#™em'] = 
$™ems
[0];

1823 
	g$™ems
 = 
$™em
;

1824 
	g$funùiÚ
 = 
$f›ld
['module'] .'_field';

1825 ià(
funùiÚ_exi¡s
(
$funùiÚ
)) {

1826 
$funùiÚ
('§n™ize', 
$node
, 
$f›ld
, 
$™ems
, 
FALSE
, FALSE);

1829 
fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

1830 
$–em’t
[
$d–
] = 
¬¿y
(

1831 '#™em' => 
$™em
,

1832 '#weight' => 
$d–
,

1837  
theme
(
$theme
, 
$–em’t
);

1853 
funùiÚ
 
	$cÚ‹Á_bud_modes
(
$£ËùÜ
 = 
NULL
) {

1854 
$šfo
;

1856 ià(!
	`is£t
(
$šfo
)) {

1857 
$d©a
 = 
	`¬¿y
();

1858 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('cÚ‹Á_bud_modes'è
as
 
$moduË
) {

1859 
$funùiÚ
 = 
$moduË
 .'_content_build_modes';

1860 
$d©a
 = 
	`¬¿y_m”ge
($d©a, (
¬¿y
è
	`$funùiÚ
());

1862 
$æ©
 = 
	`¬¿y
();

1863 
	`fÜ—ch
 (
$d©a
 
as
 
$b
) {

1865 
$æ©
 +ğ(
¬¿y
è
$b
['build modes'];

1867 
$šfo
 = 
	`¬¿y
('bs' => 
$d©a
, 'bud modes' => 
$æ©
);

1870 ià(
$£ËùÜ
 === '_tabs') {

1871  
$šfo
['tabs'];

1873 
	`–£if
 (
	`is£t
(
$£ËùÜ
è&& is£t(
$šfo
['tabs'][$selector])) {

1874  
	`is£t
(
$šfo
['bs'][
$£ËùÜ
]è? $šfo['bs'][$£ËùÜ]['bud modes'] : 
	`¬¿y
();

1877  
$šfo
['build modes'];

1879 
	}
}

1916 
funùiÚ
 
	$node_cÚ‹Á_bud_modes
() {

1917  
	`¬¿y
(

1918 'basic' => 
	`¬¿y
(

1919 't™Ë' => 
	`t
('Basic'),

1920 'bud modes' => 
	`¬¿y
(

1921 '‹a£r' => 
	`¬¿y
(

1922 't™Ë' => 
	`t
('Teaser'),

1923 'v›w ¡yË' => 
TRUE
,

1925 'fuÎ' => 
	`¬¿y
(

1926 't™Ë' => 
	`t
('Full‚ode'),

1927 'v›w ¡yË' => 
TRUE
,

1931 'rss' => 
	`¬¿y
(

1932 't™Ë' => 
	`t
('RSS'),

1933 'bud modes' => 
	`¬¿y
(

1934 
NODE_BUILD_RSS
 => 
	`¬¿y
(

1935 't™Ë' => 
	`t
('RSS'),

1936 'v›w ¡yË' => 
FALSE
,

1941 
	}
}

1942 
funùiÚ
 
	$£¬ch_cÚ‹Á_bud_modes
() {

1943  
	`¬¿y
(

1944 '£¬ch' => 
	`¬¿y
(

1945 't™Ë' => 
	`t
('Search'),

1946 'bud modes' => 
	`¬¿y
(

1947 
NODE_BUILD_SEARCH_INDEX
 => 
	`¬¿y
(

1948 't™Ë' => 
	`t
('Search Index'),

1949 'v›w ¡yË' => 
FALSE
,

1951 
NODE_BUILD_SEARCH_RESULT
 => 
	`¬¿y
(

1952 't™Ë' => 
	`t
('Search Result'),

1953 'v›w ¡yË' => 
FALSE
,

1958 
	}
}

1959 
funùiÚ
 
	$book_cÚ‹Á_bud_modes
() {

1960  
	`¬¿y
(

1961 '´št' => 
	`¬¿y
(

1962 't™Ë' => 
	`t
('Print'),

1963 'bud modes' => 
	`¬¿y
(

1964 
NODE_BUILD_PRINT
 => 
	`¬¿y
(

1965 't™Ë' => 
	`t
('Print'),

1966 'v›w ¡yË' => 
TRUE
,

1971 
	}
}

1983 
funùiÚ
 
	$_cÚ‹Á_bËÇme
(
$Çme
, 
$¡Üage
, 
$v”siÚ
 = 
NULL
) {

1984 ià(
	`is_nuÎ
(
$v”siÚ
)) {

1985 
$v”siÚ
 = 
	`v¬ŸbË_g‘
('content_schema_version', 0);

1988 ià(
$v”siÚ
 < 1003) {

1989 
$v”siÚ
 = 0;

1992 
$v”siÚ
 = 1003;

1995 
$Çme
 = 
	`¡r_»¶aû
('-', '_', $name);

1997 '0-'. 
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
 :

1999 '0-'. 
CONTENT_DB_STORAGE_PER_FIELD
 :

2001 '1003-'. 
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
 :

2003 '1003-'. 
CONTENT_DB_STORAGE_PER_FIELD
 :

2006 
	}
}

2016 
funùiÚ
 
	$cÚ‹Á_f›ld_bËÇme
(
$v”siÚ
 = 
NULL
) {

2017 ià(
	`is_nuÎ
(
$v”siÚ
)) {

2018 
$v”siÚ
 = 
	`v¬ŸbË_g‘
('content_schema_version', 0);

2020  
$v”siÚ
 < 6001 ? 'node_field' : 'content_node_field';

2021 
	}
}

2028 
funùiÚ
 
	$cÚ‹Á_š¡ªû_bËÇme
(
$v”siÚ
 = 
NULL
) {

2029 ià(
	`is_nuÎ
(
$v”siÚ
)) {

2030 
$v”siÚ
 = 
	`v¬ŸbË_g‘
('content_schema_version', 0);

2032  
$v”siÚ
 < 6001 ? 'node_field_instance' : 'content_node_field_instance';

2033 
	}
}

2042 
funùiÚ
 
	$cÚ‹Á_ÿche_bËÇme
() {

2043 ià(
	`v¬ŸbË_g‘
('content_schema_version', -1) < 6000) {

2049 
	}
}

2058 
funùiÚ
 
	$cÚ‹Á_bË_schema
(
$f›ld
 = 
NULL
) {

2059 
$schema
 = 
	`¬¿y
(

2060 'f›lds' => 
	`¬¿y
(

2061 'vid' => 
	`¬¿y
('ty³' => 'št', 'unsigÃd' => 
TRUE
, 'not‚ull' => TRUE, 'default' => 0),

2062 'nid' => 
	`¬¿y
('ty³' => 'št', 'unsigÃd' => 
TRUE
, 'not‚ull' => TRUE, 'default' => 0)

2064 '´im¬y key' => 
	`¬¿y
('vid'),

2065 'šdexes' => 
	`¬¿y
(

2066 'nid' => 
	`¬¿y
('nid'),

2071 ià(!
	`em±y
(
$f›ld
['multiple'])) {

2072 
$schema
['f›lds']['d–'] = 
	`¬¿y
('ty³' => 'št', 'unsigÃd' => 
TRUE
, 'not‚ull' => TRUE, 'default' => 0);

2073 
$schema
['primary key'][] = 'delta';

2075 
$schema
['cÚ‹Á f›lds'] = 
	`¬¿y
();

2084 ià(!
	`em±y
(
$f›ld
['columns'])) {

2085 
	`fÜ—ch
 (
$f›ld
['cŞumns'] 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

2086 
$cŞumn_Çme
 = 
$f›ld
['f›ld_Çme'] .'_'. 
$cŞumn
;

2087 ià(
	`is£t
(
$©Œibu‹s
['index']) && $attributes['index']) {

2088 
$schema
['šdexes'][
$cŞumn_Çme
] = 
	`¬¿y
($column_name);

2089 
	`un£t
(
$©Œibu‹s
['index']);

2091 
	`un£t
(
$©Œibu‹s
['column']);

2092 
	`un£t
(
$©Œibu‹s
['sortable']);

2093 
$schema
['f›lds'][
$cŞumn_Çme
] = 
$©Œibu‹s
;

2095 
$schema
['cÚ‹Á f›lds'][] = 
$f›ld
['field_name'];

2097  
$schema
;

2098 
	}
}

2114 
funùiÚ
 
	$cÚ‹Á_db_šdex_exi¡s
(
$bË
, 
$Çme
) {

2115 
glob®
 
$db_ty³
;

2116 ià(
$db_ty³
 == 'mysql' || $db_type == 'mysqli') {

2117 ià(
	`v”siÚ_com·»
(
	`db_v”siÚ
(), '5.0.3') < 0) {

2119 
$»suÉ
 = 
	`db_qu”y
('SHOW INDEX FROM {'. 
$bË
 .'}');

2120 
$row
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

2121 ià(
$row
['Key_Çme'] =ğ
$Çme
) {

2122  
TRUE
;

2125  
FALSE
;

2127  (
boŞ
)
	`db_»suÉ
(
	`db_qu”y
("SHOW INDEX FROM {". 
$bË
 ."} WHERE key_name = '$name'"));

2129 
	`–£if
 (
$db_ty³
 == 'pgsql') {

2132  (
boŞ
)
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(šdexÇmeèFROM…g_šdexe WHERE indexÇmğ'{". 
$bË
 ."}_{$name}_idx'"));

2134  
FALSE
;

2135 
	}
}

2154 
funùiÚ
 
	$cÚ‹Á_ÿÎback
(
$’t™y
, 
$İ
, 
$f›ld
) {

2155 
$’t™y
) {

2157 
$šfo
 = 
	`moduË_švoke
(
$f›ld
['module'], "field_info");

2158  
	`is£t
(
$šfo
[
$f›ld
['ty³']]['ÿÎbacks'][
$İ
]è? $šfo[$f›ld['ty³']]['ÿÎbacks'][$İ] : 
CONTENT_CALLBACK_DEFAULT
;

2161 
$šfo
 = 
	`moduË_švoke
(
$f›ld
['widget']['module'], "widget_info");

2162  
	`is£t
(
$šfo
[
$f›ld
['widg‘']['ty³']]['ÿÎbacks'][
$İ
]è? $šfo[$f›ld['widg‘']['ty³']]['ÿÎbacks'][$İ] : 
CONTENT_CALLBACK_DEFAULT
;

2164 
	}
}

2184 
funùiÚ
 
	$cÚ‹Á_hªdË
(
$’t™y
, 
$İ
, 
$objeù
) {

2185 
$’t™y
) {

2187 
$šfo
 = 
	`moduË_švoke
(
$objeù
['module'], "field_info");

2188  
	`is£t
(
$šfo
[
$objeù
['ty³']][
$İ
]è? $šfo[$objeù['ty³']][$İ] : 
CONTENT_HANDLE_CORE
;

2191 
$šfo
 = 
	`moduË_švoke
(
$objeù
['widget']['module'], "widget_info");

2192  
	`is£t
(
$šfo
[
$objeù
['widg‘']['ty³']][
$İ
]è? $šfo[$objeù['widg‘']['ty³']][$İ] : 
CONTENT_HANDLE_CORE
;

2197  
	`is£t
(
$objeù
[
$İ
]è? $objeù[$İ] : 
CONTENT_HANDLE_CORE
;

2199 
	}
}

2213 
funùiÚ
 
	$cÚ‹Á_deçuÉ_v®ue
(&
$fÜm
, &
$fÜm_¡©e
, 
$f›ld
, 
$d–
) {

2214 
$widg‘_ty³s
 = 
	`_cÚ‹Á_widg‘_ty³s
();

2215 
$moduË
 = 
$widg‘_ty³s
[
$f›ld
['widget']['type']]['module'];

2217 
$deçuÉ_v®ue
 = 
	`¬¿y
();

2218 ià(!
	`em±y
(
$f›ld
['widget']['default_value_php'])) {

2219 
	`ob_¡¬t
();

2220 
$»suÉ
 = 
	`ev®
(
$f›ld
['widget']['default_value_php']);

2221 
	`ob_’d_ş—n
();

2222 ià(
	`is_¬¿y
(
$»suÉ
)) {

2223 
$deçuÉ_v®ue
 = 
$»suÉ
;

2226 
	`–£if
 (!
	`em±y
(
$f›ld
['widget']['default_value'])) {

2227 
$deçuÉ_v®ue
 = 
$f›ld
['widget']['default_value'];

2229  (
¬¿y
è
$deçuÉ_v®ue
;

2230 
	}
}

2249 
funùiÚ
 
	$cÚ‹Á_acûss
(
$İ
, 
$f›ld
, 
$accouÁ
 = 
NULL
, 
$node
 = NULL) {

2250 
glob®
 
$u£r
;

2252 ià(
	`is_nuÎ
(
$accouÁ
)) {

2253 
$accouÁ
 = 
$u£r
;

2256 ià(!
	`is£t
(
$f›ld
['field_name'])) {

2257  
FALSE
;

2259 
$acûss
 = 
	`moduË_švoke_®l
('f›ld_acûss', 
$İ
, 
$f›ld
, 
$accouÁ
, 
$node
);

2260 
	`fÜ—ch
 (
$acûss
 
as
 
$v®ue
) {

2261 ià(
$v®ue
 ==ğ
FALSE
) {

2262  
FALSE
;

2265  
TRUE
;

2266 
	}
}

2271 
funùiÚ
 
	$cÚ‹Á_f›ld_w¿µ”_po¡_»nd”
(
$cÚ‹Á
, 
$–em’t
) {

2272 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$–em’t
['#field_name'], $element['#type_name']);

2273 ià(
	`theme
('cÚ‹Á_exşude', 
$cÚ‹Á
, 
$f›ld
, 
$–em’t
['#context'])) {

2276  
$cÚ‹Á
;

2277 
	}
}

2331 
funùiÚ
 
	$theme_cÚ‹Á_exşude
(
$cÚ‹Á
, 
$objeù
, 
$cÚ‹xt
) {

2334 ià(
	`em±y
(
$objeù
['display_settings'])

2335 || 
	`em±y
(
$objeù
['di¥Ïy_£‰šgs'][
$cÚ‹xt
])

2336 || !
	`is_¬¿y
(
$objeù
['di¥Ïy_£‰šgs'][
$cÚ‹xt
])

2337 || 
	`em±y
(
$objeù
['di¥Ïy_£‰šgs'][
$cÚ‹xt
]['exclude'])) {

2338  
FALSE
;

2341  
TRUE
;

2343 
	}
}

2360 
funùiÚ
 
	$cÚ‹Á_´•roûss_cÚ‹Á_f›ld
(&
$v¬ŸbËs
) {

2361 
$–em’t
 = 
$v¬ŸbËs
['element'];

2362 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$–em’t
['#f›ld_Çme'], $–em’t['#node']->
ty³
);

2364 
$v¬ŸbËs
['node'] = 
$–em’t
['#node'];

2365 
$v¬ŸbËs
['f›ld'] = 
$f›ld
;

2366 
$v¬ŸbËs
['™ems'] = 
	`¬¿y
();

2368 ià(
$–em’t
['#single']) {

2370 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$–em’t
['™ems']è
as
 
$d–
) {

2371 
$v¬ŸbËs
['™ems'][
$d–
] = 
$–em’t
['items'][$delta]['#item'];

2373 
$v¬ŸbËs
['™ems'][
$d–
]['v›w'] = 
	`is£t
(
$–em’t
['items'][$delta]['#children']) ? $element['items'][$delta]['#children'] : '';

2381 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$–em’t
['™ems']è
as
 
$d–
) {

2382 
$v¬ŸbËs
['™ems'][
$d–
] = 
$–em’t
['items'][$delta]['#item'];

2384 
$v¬ŸbËs
['™ems'][0]['v›w'] = 
$–em’t
['items']['#children'];

2387 
$v¬ŸbËs
['‹a£r'] = 
$–em’t
['#teaser'];

2388 
$v¬ŸbËs
['·ge'] = 
$–em’t
['#page'];

2390 
$f›ld_em±y
 = 
TRUE
;

2392 
	`fÜ—ch
 (
$v¬ŸbËs
['™ems'] 
as
 
$d–
 => 
$™em
) {

2393 ià(!
	`is£t
(
$™em
['v›w']è|| (
	`em±y
($™em['v›w']è&& (
¡ršg
)$item['view'] !== '0')) {

2394 
$v¬ŸbËs
['™ems'][
$d–
]['em±y'] = 
TRUE
;

2397 
$f›ld_em±y
 = 
FALSE
;

2398 
$v¬ŸbËs
['™ems'][
$d–
]['em±y'] = 
FALSE
;

2402 
$add™iÚs
 = 
	`¬¿y
(

2403 'f›ld_ty³' => 
$f›ld
['type'],

2404 'f›ld_Çme' => 
$f›ld
['field_name'],

2405 'f›ld_ty³_css' => 
	`¡¹r
(
$f›ld
['type'], '_', '-'),

2406 'f›ld_Çme_css' => 
	`¡¹r
(
$f›ld
['field_name'], '_', '-'),

2407 'Ïb–' => 
	`check_¶aš
(
	`t
(
$f›ld
['widget']['label'])),

2408 'Ïb–_di¥Ïy' => 
$–em’t
['#label_display'],

2409 'f›ld_em±y' => 
$f›ld_em±y
,

2410 '‹m¶©e_fes' => 
	`¬¿y
(

2412 'cÚ‹Á-f›ld-'. 
$–em’t
['#field_name'],

2413 'cÚ‹Á-f›ld-'. 
$–em’t
['#node']->
ty³
,

2414 'cÚ‹Á-f›ld-'. 
$–em’t
['#f›ld_Çme'] .'-'. $–em’t['#node']->
ty³
,

2417 
$v¬ŸbËs
 = 
	`¬¿y_m”ge
($v¬ŸbËs, 
$add™iÚs
);

2418 
	}
}

2427 
funùiÚ
 
	$cÚ‹Á_´•roûss_node
(&
$v¬s
) {

2428 
$add™iÚs
 = 
	`_cÚ‹Á_f›ld_švoke_deçuÉ
('´•roûss_node', 
$v¬s
['node']);

2429 
$v¬s
 = 
	`¬¿y_m”ge
($v¬s, 
$add™iÚs
);

2430 
	}
}

2440 
funùiÚ
 
	$cÚ‹Á_cÚ‹Á_f›ld­i
(
$İ
, 
$f›ld
) {

2441 ià(
	`moduË_exi¡s
('devel')) {

2445 
	}
}

2452 
funùiÚ
 
	$cÚ‹Á_cÚ‹Á_exŒa_f›lds
(
$ty³_Çme
) {

2453 
$ty³
 = 
	`node_g‘_ty³s
('ty³', 
$ty³_Çme
);

2454 
$exŒa
 = 
	`¬¿y
();

2456 ià(
$ty³
->
has_t™Ë
) {

2457 
$exŒa
['t™Ë'] = 
	`¬¿y
(

2458 'Ïb–' => 
$ty³
->
t™Ë_Ïb–
,

2459 'desütiÚ' => 
	`t
('Node module form.'),

2463 ià(
$ty³
->
has_body
) {

2464 
$exŒa
['body_f›ld'] = 
	`¬¿y
(

2465 'Ïb–' => 
$ty³
->
body_Ïb–
,

2466 'desütiÚ' => 
	`t
('Node module form.'),

2471 
$exŒa
['»visiÚ_šfÜm©iÚ'] = 
	`¬¿y
(

2472 'Ïb–' => 
	`t
('Revision information'),

2473 'desütiÚ' => 
	`t
('Node module form.'),

2476 
$exŒa
['authÜ'] = 
	`¬¿y
(

2477 'Ïb–' => 
	`t
('Authoring information'),

2478 'desütiÚ' => 
	`t
('Node module form.'),

2481 
$exŒa
['İtiÚs'] = 
	`¬¿y
(

2482 'Ïb–' => 
	`t
('Publishing options'),

2483 'desütiÚ' => 
	`t
('Node module form.'),

2486 ià(
	`moduË_exi¡s
('comment')) {

2487 
$exŒa
['comm’t_£‰šgs'] = 
	`¬¿y
(

2488 'Ïb–' => 
	`t
('Comment settings'),

2489 'desütiÚ' => 
	`t
('Comment module form.'),

2493 ià(
	`moduË_exi¡s
('loÿË'è&& 
	`v¬ŸbË_g‘
("language_content_type_$type_name", 0)) {

2494 
$exŒa
['Ïnguage'] = 
	`¬¿y
(

2495 'Ïb–' => 
	`t
('Language'),

2496 'desütiÚ' => 
	`t
('Locale module form.'),

2500 ià(
	`moduË_exi¡s
('Œª¦©iÚ'è&& 
	`Œª¦©iÚ_suµÜ‹d_ty³
(
$ty³_Çme
)) {

2501 
$exŒa
['Œª¦©iÚ'] = 
	`¬¿y
(

2502 'Ïb–' => 
	`t
('Translation settings'),

2503 'desütiÚ' => 
	`t
('Translation module form.'),

2507 ià(
	`moduË_exi¡s
('menu')) {

2508 
$exŒa
['m’u'] = 
	`¬¿y
(

2509 'Ïb–' => 
	`t
('Menu settings'),

2510 'desütiÚ' => 
	`t
('Menu module form.'),

2514 ià(
	`moduË_exi¡s
('xÚomy'è&& 
	`xÚomy_g‘_voÿbuÏr›s
(
$ty³_Çme
)) {

2515 
$exŒa
['xÚomy'] = 
	`¬¿y
(

2516 'Ïb–' => 
	`t
('Taxonomy'),

2517 'desütiÚ' => 
	`t
('Taxonomy module form.'),

2521 ià(
	`moduË_exi¡s
('book')) {

2522 
$exŒa
['book'] = 
	`¬¿y
(

2523 'Ïb–' => 
	`t
('Book'),

2524 'desütiÚ' => 
	`t
('Book module form.'),

2528 ià(
	`moduË_exi¡s
('path')) {

2529 
$exŒa
['·th'] = 
	`¬¿y
(

2530 'Ïb–' => 
	`t
('Path settings'),

2531 'desütiÚ' => 
	`t
('Path module form.'),

2535 ià(
$ty³_Çme
 =ğ'pŞl' && 
	`moduË_exi¡s
('poll')) {

2536 
$exŒa
['t™Ë'] = 
	`¬¿y
(

2537 'Ïb–' => 
	`t
('Pollitle'),

2538 'desütiÚ' => 
	`t
('Poll moduleitle.'),

2541 
$exŒa
['choiû_w¿µ”'] = 
	`¬¿y
(

2542 'Ïb–' => 
	`t
('Poll choices'),

2543 'desütiÚ' => 
	`t
('Poll module choices.'),

2546 
$exŒa
['£‰šgs'] = 
	`¬¿y
(

2547 'Ïb–' => 
	`t
('Poll settings'),

2548 'desütiÚ' => 
	`t
('Poll module settings.'),

2552 ià(
	`moduË_exi¡s
('u¶ßd'è&& 
	`v¬ŸbË_g‘
("u¶ßd_$ty³_Çme", 
TRUE
)) {

2553 
$exŒa
['©chm’ts'] = 
	`¬¿y
(

2554 'Ïb–' => 
	`t
('File‡ttachments'),

2555 'desütiÚ' => 
	`t
('Upload module form.'),

2561  
$exŒa
;

2562 
	}
}

2581 
funùiÚ
 
	$cÚ‹Á_exŒa_f›ld_weight
(
$ty³_Çme
, 
$p£udo_f›ld_Çme
) {

2582 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

2586 ià(!
	`is£t
(
$ty³
['exŒa'][
$p£udo_f›ld_Çme
])) {

2587 
	`cÚ‹Á_ş—r_ty³_ÿche
();

2588 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

2591 ià(
	`is£t
(
$ty³
['exŒa'][
$p£udo_f›ld_Çme
])) {

2592  
$ty³
['exŒa'][
$p£udo_f›ld_Çme
]['weight'];

2594 
	}
}

2619 
funùiÚ
 
	$cÚ‹Á_max_d–
(
$f›ld_Çme
, 
$ty³_Çme
 = 
NULL
) {

2620 
$f›lds
 = 
	`cÚ‹Á_f›lds
();

2621 
$f›ld
 = 
$f›lds
[
$f›ld_Çme
];

2626 ià(
	`em±y
(
$f›ld
['multiple'])) {

2627 
$cÚ‹Á_ty³s
 = 
	`cÚ‹Á_ty³s
();

2628 
	`fÜ—ch
 (
$cÚ‹Á_ty³s
 
as
 
$cÚ‹Á_ty³
) {

2629 ià(
	`em±y
(
$ty³_Çme
è|| 
$cÚ‹Á_ty³
['type'] == $type_name) {

2630 
	`fÜ—ch
 (
$cÚ‹Á_ty³
['f›lds'] 
as
 
$f›ld
) {

2631 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

2632 ià(
	`db_»suÉ
(
	`db_qu”y
("SELECT COUNT(*èFROM {". 
$db_šfo
['table'] ."}")) >= 1) {

2643 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

2644 ià(!
	`em±y
(
$ty³_Çme
)) {

2645 
$d–
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT MAX(d–èFROM {". 
$db_šfo
['bË'] ."} f LEFT JOIN {node}‚ ON f.vid =‚.vid WHERE‚.ty³ = '%s'", 
$ty³_Çme
));

2648 
$d–
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT MAX(d–èFROM {". 
$db_šfo
['table'] ."}"));

2650 ià(
$d–
 >= 0) {

2651  
$d–
;

2655  
NULL
;

2656 
	}
}

2661 
funùiÚ
 
	$cÚ‹Á_šaùive_f›lds
(
$ty³_Çme
 = 
NULL
) {

2662 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

2663 ià(!
	`em±y
(
$ty³_Çme
)) {

2664 
$·¿m
 = 
	`¬¿y
('ty³_Çme' => 
$ty³_Çme
);

2665 
$šaùive
 = 
	`¬¿y
(
$ty³_Çme
 =>‡rray());

2668 
$·¿m
 = 
	`¬¿y
();

2669 
$šaùive
 = 
	`¬¿y
();

2671 
$®l
 = 
	`cÚ‹Á_f›ld_š¡ªû_»ad
(
$·¿m
, 
TRUE
);

2672 
$aùive
 = 
	`¬¿y_keys
(
	`cÚ‹Á_f›lds
());

2673 
	`fÜ—ch
 (
$®l
 
as
 
$f›ld
) {

2674 ià(!
	`š_¬¿y
(
$f›ld
['f›ld_Çme'], 
$aùive
)) {

2675 
$šaùive
[
$f›ld
['ty³_Çme']][$f›ld['f›ld_Çme']] = 
	`cÚ‹Á_f›ld_š¡ªû_ex·nd
($field);

2678 ià(!
	`em±y
(
$ty³_Çme
)) {

2679  
$šaùive
[
$ty³_Çme
];

2681  
$šaùive
;

2682 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.admin.inc

1 <?
php


13 
funùiÚ
 
	$cÚ‹Á_ty³s_ov”v›w
() {

14 
$ty³s
 = 
	`node_g‘_ty³s
();

15 
$Çmes
 = 
	`node_g‘_ty³s
('names');

16 
$h—d”
 = 
	`¬¿y
(
	`t
('Name'),('Type'),('Description'),‡rray('data' =>('Operations'), 'colspan' => '4'),);

17 
$rows
 = 
	`¬¿y
();

19 
	`fÜ—ch
 (
$Çmes
 
as
 
$key
 => 
$Çme
) {

20 
$ty³
 = 
$ty³s
[
$key
];

21 ià(
	`node_hook
(
$ty³
, 'form')) {

22 
$ty³_u¾_¡r
 = 
	`¡r_»¶aû
('_', '-', 
$ty³
->
ty³
);

23 
$row
 = 
	`¬¿y
(

24 
	`check_¶aš
(
$Çme
),

25 
	`check_¶aš
(
$ty³
->
ty³
),

28 
$row
[] = 
	`¬¿y
('d©a' => 
	`f‹r_xss_admš
(
$ty³
->
desütiÚ
), 'class' => 'description');

30 
$row
[] = 
	`¬¿y
('d©a' => 
	`l
(
	`t
('ed™'), 'admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
));

33 
$row
[] = 
	`¬¿y
('d©a' => 
	`l
(
	`t
('mªagf›lds'), 'admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
 .'/fields'));

35 ià(
$ty³
->
cu¡om
) {

36 
$row
[] = 
	`¬¿y
('d©a' => 
	`l
(
	`t
('d–‘e'), 'admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
 .'/delete'));

39 
$row
[] = 
	`¬¿y
('data' => '');

42 
$rows
[] = 
$row
;

47 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('cÚ‹Á_ty³s_ov”v›w_®‹r'è
as
 
$moduË
) {

48 
$funùiÚ
 = 
$moduË
 .'_content_types_overview_alter';

49 
	`$funùiÚ
(
$h—d”
, 
$rows
);

52 ià(
	`em±y
(
$rows
)) {

53 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No contentypes‡vailable.'), 'colspan' => '7', 'class' => 'message'));

56  
	`theme
('bË', 
$h—d”
, 
$rows
) .theme('content_overview_links');

57 
	}
}

59 
funùiÚ
 
	$theme_cÚ‹Á_ov”v›w_lšks
() {

60  '<div cÏss="cÚ‹Á-ov”v›w-lšks">'. 
	`l
(
	`t
('Â» Add‡‚ew contentype'), 'admin/content/types/add') .'</div>';

61 
	}
}

66 
funùiÚ
 
	$cÚ‹Á_f›lds_li¡
() {

67 
$f›lds
 = 
	`cÚ‹Á_f›lds
();

68 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

71 
	`ksÜt
(
$f›lds
);

73 
$h—d”
 = 
	`¬¿y
(
	`t
('Field‚ame'),('Fieldype'),('Used in'));

74 
$rows
 = 
	`¬¿y
();

75 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
) {

76 
$row
 = 
	`¬¿y
();

77 
$row
[] = 
$f›ld
['locked'] ? 
	`t
('@f›ld_Çm(Locked)', 
	`¬¿y
('@field_name' => $field['field_name'])) : $field['field_name'];

78 
$row
[] = 
	`t
(
$f›ld_ty³s
[
$f›ld
['type']]['label']);

80 
$ty³s
 = 
	`¬¿y
();

81 
$»suÉ
 = 
	`db_qu”y
("SELECT‚t.Çme,‚t.ty³ FROM {". 
	`cÚ‹Á_š¡ªû_bËÇme
() ."}‚fi ".

86 "ORDER BY‚t.ÇmASC", 
$f›ld
['field_name']);

87 
$ty³
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

88 
$cÚ‹Á_ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³
['type']);

89 
$ty³s
[] = 
	`l
(
$ty³
['Çme'], 'admš/cÚ‹Á/node-ty³/'. 
$cÚ‹Á_ty³
['url_str'] .'/fields');

91 
$row
[] = 
	`im¶ode
(', ', 
$ty³s
);

93 
$rows
[] = 
	`¬¿y
('d©a' => 
$row
, 'şass' => 
$f›ld
['locked'] ? 'menu-disabled' : '');

95 ià(
	`em±y
(
$rows
)) {

96 
$ouut
 = 
	`t
('No fields have been defined for‡ny contentype yet.');

99 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

101  
$ouut
;

102 
	}
}

107 
funùiÚ
 
	$cÚ‹Á_šaùive_mes§ge
(
$ty³_Çme
) {

108 
$šaùive_f›lds
 = 
	`cÚ‹Á_šaùive_f›lds
(
$ty³_Çme
);

109 ià(!
	`em±y
(
$šaùive_f›lds
)) {

110 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

111 
$widg‘_ty³s
 = 
	`_cÚ‹Á_widg‘_ty³s
(
$ty³_Çme
);

112 
	`dru·l_£t_mes§ge
(
	`t
('This contentype has inactive fields. Inactive fields‡re‚ot included in†ists of‡vailable fields untilheir modules‡reƒnabled.'), 'error');

113 
	`fÜ—ch
 (
$šaùive_f›lds
 
as
 
$f›ld_Çme
 => 
$f›ld
) {

114 
	`dru·l_£t_mes§ge
(
	`t
('!f›ld (!f›ld_Çmeèi ª iÇùiv!f›ld_ty³ f›ldh© u£ ¨!widg‘_ty³ widg‘.', 
	`¬¿y
(

115 '!f›ld' => 
$f›ld
['widget']['label'],

116 '!f›ld_Çme' => 
$f›ld
['field_name'],

117 '!f›ld_ty³' => 
	`¬¿y_key_exi¡s
(
$f›ld
['ty³'], 
$f›ld_ty³s
) ? $field_types[$field['type']]['label'] : $field['type'],

118 '!widg‘_ty³' => 
	`¬¿y_key_exi¡s
(
$f›ld
['widg‘']['ty³'], 
$widg‘_ty³s
) ? $widget_types[$field['widget']['type']]['label'] : $field['widget']['type'],

122 
	}
}

130 
funùiÚ
 
	$cÚ‹Á_f›ld_ov”v›w_fÜm
(&
$fÜm_¡©e
, 
$ty³_Çme
) {

132 
	`cÚ‹Á_šaùive_mes§ge
(
$ty³_Çme
);

136 ià(
	`em±y
(
$fÜm_¡©e
['post'])) {

137 
	`cÚ‹Á_ş—r_ty³_ÿche
();

141 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

142 
$f›lds
 = 
$ty³
['fields'];

143 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

145 
$exŒa
 = 
$ty³
['extra'];

146 
$groups
 = 
$group_İtiÚs
 = 
$group_ty³s
 = 
	`¬¿y
();

147 ià(
	`moduË_exi¡s
('fieldgroup')) {

148 
$groups
 = 
	`f›ldgroup_groups
(
$ty³
['type']);

149 
$group_ty³s
 = 
	`f›ldgroup_ty³s
();

150 
$group_İtiÚs
 = 
	`_f›ldgroup_groups_Ïb–
(
$ty³
['type']);

152 
$group_İtiÚs
['_add_new_group'] = '_add_new_group';

157 
$weights
 = 
	`¬¿y
();

159 
$fÜm
 = 
	`¬¿y
(

160 '#Œ“' => 
TRUE
,

161 '#ty³_Çme' => 
$ty³
['type'],

162 '#f›lds' => 
	`¬¿y_keys
(
$f›lds
),

163 '#groups' => 
	`¬¿y_keys
(
$groups
),

164 '#exŒa' => 
	`¬¿y_keys
(
$exŒa
),

165 '#f›ld_rows' => 
	`¬¿y
(),

166 '#group_rows' => 
	`¬¿y
(),

170 
	`fÜ—ch
 (
$f›lds
 
as
 
$Çme
 => 
$f›ld
) {

171 
$weight
 = 
$f›ld
['widget']['weight'];

172 
$fÜm
[
$Çme
] = 
	`¬¿y
(

173 'Ïb–' => 
	`¬¿y
('#v®ue' => 
	`check_¶aš
(
$f›ld
['widget']['label'])),

174 'f›ld_Çme' => 
	`¬¿y
('#v®ue' => 
$f›ld
['field_name']),

175 'ty³' => 
	`¬¿y
('#v®ue' => 
	`t
(
$f›ld_ty³s
[
$f›ld
['type']]['label'])),

176 'cÚfigu»' => 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('CÚfigu»'), 'admš/cÚ‹Á/node-ty³/'. 
$ty³
['u¾_¡r'] .'/f›lds/'. 
$f›ld
['field_name'])),

177 '»move' => 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('Remove'), 'admš/cÚ‹Á/node-ty³/'. 
$ty³
['u¾_¡r'] .'/f›lds/'. 
$f›ld
['field_name'] .'/remove')),

178 'weight' => 
	`¬¿y
('#ty³' => '‹xtf›ld', '#deçuÉ_v®ue' => 
$weight
, '#size' => 3),

179 '·»Á' => 
	`¬¿y
('#ty³' => '£Ëù', '#İtiÚs' => 
$group_İtiÚs
, '#default_value' => ''),

180 '´ev_·»Á' => 
	`¬¿y
('#type' => 'hidden', '#value' => ''),

181 'hidd’_Çme' => 
	`¬¿y
('#ty³' => 'hidd’', '#deçuÉ_v®ue' => 
$f›ld
['field_name']),

182 '#Ëaf' => 
TRUE
,

184 'f›ld' => 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$f›ld
),

186 ià(
$f›ld
['locked']) {

187 
$fÜm
[
$Çme
]['cÚfigu»'] = 
	`¬¿y
('#v®ue' => 
	`t
('Locked'));

188 
$fÜm
[
$Çme
]['»move'] = 
	`¬¿y
();

189 
$fÜm
[
$Çme
]['#di§bËd_row'] = 
TRUE
;

191 
$fÜm
['#f›ld_rows'][] = 
$Çme
;

192 
$weights
[] = 
$weight
;

196 
	`fÜ—ch
 (
$groups
 
as
 
$Çme
 => 
$group
) {

197 
$weight
 = 
$group
['weight'];

198 
$fÜm
[
$Çme
] = 
	`¬¿y
(

199 'Ïb–' => 
	`¬¿y
('#v®ue' => 
	`check_¶aš
(
$group
['label'])),

200 'group_Çme' => 
	`¬¿y
('#v®ue' => 
$group
['group_name']),

201 'group_ty³' => 
	`¬¿y
('#v®ue' => 
	`t
(
$group_ty³s
[
$group
['group_type']])),

202 'cÚfigu»' => 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('CÚfigu»'), 'admš/cÚ‹Á/node-ty³/'. 
$ty³
['u¾_¡r'] .'/groups/'. 
$group
['group_name'])),

203 '»move' => 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('Remove'), 'admš/cÚ‹Á/node-ty³/'. 
$ty³
['u¾_¡r'] .'/groups/'. 
$group
['group_name'] .'/remove')),

204 'weight' => 
	`¬¿y
('#ty³' => '‹xtf›ld', '#deçuÉ_v®ue' => 
$weight
, '#size' => 3),

205 '·»Á' => 
	`¬¿y
('#type' => 'hidden', '#default_value' => ''),

206 'hidd’_Çme' => 
	`¬¿y
('#ty³' => 'hidd’', '#deçuÉ_v®ue' => 
$group
['group_name']),

207 '#roÙ' => 
TRUE
,

209 'group' => 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$group
),

212 
	`fÜ—ch
 (
$group
['f›lds'] 
as
 
$f›ld_Çme
 => 
$f›ld
) {

213 
$fÜm
[
$f›ld_Çme
]['·»Á']['#deçuÉ_v®ue'] = 
$Çme
;

214 
$fÜm
[
$f›ld_Çme
]['´ev_·»Á']['#v®ue'] = 
$Çme
;

216 
$fÜm
['#group_rows'][] = 
$Çme
;

217 
$weights
[] = 
$weight
;

221 
	`fÜ—ch
 (
$exŒa
 
as
 
$Çme
 => 
$Ïb–
) {

222 
$weight
 = 
$exŒa
[
$Çme
]['weight'];

223 
$fÜm
[
$Çme
] = 
	`¬¿y
(

224 'Ïb–' => 
	`¬¿y
('#v®ue' => 
	`check_¶aš
(
	`t
(
$exŒa
[
$Çme
]['label']))),

225 'desütiÚ' => 
	`¬¿y
('#v®ue' => 
	`is£t
(
$exŒa
[
$Çme
]['description']) ? $extra[$name]['description'] : ''),

226 'weight' => 
	`¬¿y
('#ty³' => '‹xtf›ld', '#deçuÉ_v®ue' => 
$weight
, '#size' => 3),

227 '·»Á' => 
	`¬¿y
('#type' => 'hidden', '#default_value' => ''),

228 'cÚfigu»' => 
	`¬¿y
('#v®ue' => 
	`is£t
(
$exŒa
[
$Çme
]['configure']) ? $extra[$name]['configure'] : ''),

229 '»move' => 
	`¬¿y
('#v®ue' => 
	`is£t
(
$exŒa
[
$Çme
]['remove']) ? $extra[$name]['remove'] : ''),

230 'hidd’_Çme' => 
	`¬¿y
('#ty³' => 'hidd’', '#deçuÉ_v®ue' => 
$Çme
),

231 '#Ëaf' => 
TRUE
,

232 '#roÙ' => 
TRUE
,

233 '#di§bËd_row' => 
TRUE
,

236 
$fÜm
['#f›ld_rows'][] = 
$Çme
;

237 
$weights
[] = 
$weight
;

241 
$weight
 = 
	`max
(
$weights
) + 1;

242 
$f›ld_ty³_İtiÚs
 = 
	`cÚ‹Á_f›ld_ty³_İtiÚs
();

243 
$widg‘_ty³_İtiÚs
 = 
	`cÚ‹Á_widg‘_ty³_İtiÚs
(
NULL
, 
TRUE
);

244 ià(
$f›ld_ty³_İtiÚs
 && 
$widg‘_ty³_İtiÚs
) {

245 
	`¬¿y_unshiá
(
$f›ld_ty³_İtiÚs
, 
	`t
('- Select‡ fieldype -'));

246 
	`¬¿y_unshiá
(
$widg‘_ty³_İtiÚs
, 
	`t
('- Select‡ widget -'));

247 
$Çme
 = '_add_new_field';

248 
$fÜm
[
$Çme
] = 
	`¬¿y
(

249 'Ïb–' => 
	`¬¿y
(

252 '#desütiÚ' => 
	`t
('Label'),

254 'f›ld_Çme' => 
	`¬¿y
(

259 '#©Œibu‹s' => 
	`¬¿y
('dir'=>'ltr'),

264 '#desütiÚ' => 
	`t
('Field‚ame (a-z, 0-9, _)'),

266 'ty³' => 
	`¬¿y
(

268 '#İtiÚs' => 
$f›ld_ty³_İtiÚs
,

269 '#desütiÚ' => 
	`theme
('advªûd_h–p_tİic', 'cÚ‹Á', 'f›lds'è. 
	`t
('Type of datao store.'),

271 'widg‘_ty³' => 
	`¬¿y
(

273 '#İtiÚs' => 
$widg‘_ty³_İtiÚs
,

274 '#desütiÚ' => 
	`t
('Formƒlementoƒdithe data.'),

276 'weight' => 
	`¬¿y
('#ty³' => '‹xtf›ld', '#deçuÉ_v®ue' => 
$weight
, '#size' => 3),

277 '·»Á' => 
	`¬¿y
('#ty³' => '£Ëù', '#İtiÚs' => 
$group_İtiÚs
, '#default_value' => ''),

278 'hidd’_Çme' => 
	`¬¿y
('#ty³' => 'hidd’', '#deçuÉ_v®ue' => 
$Çme
),

279 '#Ëaf' => 
TRUE
,

280 '#add_Ãw' => 
TRUE
,

283 
$fÜm
['#f›ld_rows'][] = 
$Çme
;

287 
$exi¡šg_f›ld_İtiÚs
 = 
	`cÚ‹Á_exi¡šg_f›ld_İtiÚs
(
$ty³_Çme
);

288 ià(
$exi¡šg_f›ld_İtiÚs
 && 
$widg‘_ty³_İtiÚs
) {

289 
$weight
++;

290 
	`¬¿y_unshiá
(
$exi¡šg_f›ld_İtiÚs
, 
	`t
('- Select‡nƒxisting field -'));

291 
$Çme
 = '_add_existing_field';

292 
$fÜm
[
$Çme
] = 
	`¬¿y
(

293 'Ïb–' => 
	`¬¿y
(

296 '#desütiÚ' => 
	`t
('Label'),

298 'f›ld_Çme' => 
	`¬¿y
(

300 '#İtiÚs' => 
$exi¡šg_f›ld_İtiÚs
,

301 '#desütiÚ' => 
	`t
('Fieldo share'),

303 'widg‘_ty³' => 
	`¬¿y
(

305 '#İtiÚs' => 
$widg‘_ty³_İtiÚs
,

306 '#desütiÚ' => 
	`t
('Formƒlementoƒdithe data.'),

308 'weight' => 
	`¬¿y
('#ty³' => '‹xtf›ld', '#deçuÉ_v®ue' => 
$weight
, '#size' => 3),

309 '·»Á' => 
	`¬¿y
('#ty³' => '£Ëù', '#İtiÚs' => 
$group_İtiÚs
, '#default_value' => ''),

310 'hidd’_Çme' => 
	`¬¿y
('#ty³' => 'hidd’', '#deçuÉ_v®ue' => 
$Çme
),

311 '#Ëaf' => 
TRUE
,

312 '#add_Ãw' => 
TRUE
,

315 
$fÜm
['#f›ld_rows'][] = 
$Çme
;

319 ià(!
	`em±y
(
$group_ty³s
)) {

320 
$weight
++;

321 
$Çme
 = '_add_new_group';

322 
$fÜm
[
$Çme
] = 
	`¬¿y
(

323 'Ïb–' => 
	`¬¿y
(

326 '#desütiÚ' => 
	`t
('Label'),

328 'group_Çme' => 
	`¬¿y
(

333 '#©Œibu‹s' => 
	`¬¿y
('dir'=>'ltr'),

338 '#desütiÚ' => 
	`t
('Group‚ame (a-z, 0-9, _)'),

340 'group_İtiÚ' => 
	`¬¿y
(

344 'group_ty³' => 
	`¬¿y
(

348 'weight' => 
	`¬¿y
('#ty³' => '‹xtf›ld', '#deçuÉ_v®ue' => 
$weight
, '#size' => 3),

349 '·»Á' => 
	`¬¿y
('#type' => 'hidden', '#default_value' => ''),

350 'hidd’_Çme' => 
	`¬¿y
('#ty³' => 'hidd’', '#deçuÉ_v®ue' => 
$Çme
),

351 '#roÙ' => 
TRUE
,

352 '#add_Ãw' => 
TRUE
,

355 ià(
	`couÁ
(
$group_ty³s
) > 1) {

356 
$fÜm
[
$Çme
]['group_ty³'] = 
	`¬¿y
(

358 '#desütiÚ' => 
	`t
('Type of group.'),

359 '#İtiÚs' => 
$group_ty³s
,

363 
$fÜm
['#group_rows'][] = 
$Çme
;

366 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save'));

367  
$fÜm
;

368 
	}
}

370 
funùiÚ
 
	$cÚ‹Á_f›ld_ov”v›w_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

371 
	`_cÚ‹Á_f›ld_ov”v›w_fÜm_v®id©e_add_Ãw
(
$fÜm
, 
$fÜm_¡©e
);

372 
	`_cÚ‹Á_f›ld_ov”v›w_fÜm_v®id©e_add_exi¡šg
(
$fÜm
, 
$fÜm_¡©e
);

373 
	}
}

380 
funùiÚ
 
	$_cÚ‹Á_f›ld_ov”v›w_fÜm_v®id©e_add_Ãw
(
$fÜm
, &
$fÜm_¡©e
) {

381 
$f›ld
 = 
$fÜm_¡©e
['values']['_add_new_field'];

384 ià(
	`¬¿y_f‹r
(
	`¬¿y
(
$f›ld
['label'], $field['field_name'], $field['type'], $field['widget_type']))) {

386 ià(!
$f›ld
['label']) {

387 
	`fÜm_£t_”rÜ
('_add_Ãw_f›ld][Ïb–', 
	`t
('Add‚ew field: you‚eedo…rovide‡†abel.'));

391 ià(!
$f›ld
['field_name']) {

392 
	`fÜm_£t_”rÜ
('_add_Ãw_f›ld][f›ld_Çme', 
	`t
('Add‚ew field: you‚eedo…rovide‡ field‚ame.'));

396 
$f›ld_Çme
 = 
$f›ld
['field_name'];

399 ià(
	`sub¡r
(
$f›ld_Çme
, 0, 6) != 'field_') {

400 
$f›ld_Çme
 = 'field_'. $field_name;

401 
	`fÜm_£t_v®ue
(
$fÜm
['_add_Ãw_f›ld']['f›ld_Çme'], 
$f›ld_Çme
, 
$fÜm_¡©e
);

405 ià(!
	`´eg_m©ch
('!^f›ld_[a-z0-9_]+$!', 
$f›ld_Çme
)) {

406 
	`fÜm_£t_”rÜ
('_add_Ãw_f›ld][f›ld_Çme', 
	`t
('Add‚ew f›ld:hf›ld‚am%f›ld_Çmi šv®id. ThÇmmu¡ inşudÚly†ow”ÿ£ uÇcûÁu©ed†‘‹rs,‚umb”s,‡nd und”scÜes.', 
	`¬¿y
('%f›ld_Çme' => 
$f›ld_Çme
)));

408 ià(
	`¡¾’
(
$f›ld_Çme
) > 32) {

409 
	`fÜm_£t_”rÜ
('_add_Ãw_f›ld][f›ld_Çme', 
	`t
('Add‚ew f›ld:hf›ld‚am%f›ld_Çmi toØlÚg. ThÇmi lim™edØ32 ch¬aù”s, inşudšgh\'f›ld_\'…»fix.', 
	`¬¿y
('%f›ld_Çme' => 
$f›ld_Çme
)));

412 ià(
$f›ld_Çme
 == 'field_instance') {

413 
	`fÜm_£t_”rÜ
('_add_Ãw_f›ld][f›ld_Çme', 
	`t
("Add‚ew field:he‚ame 'field_instance' is‡„eserved‚ame."));

418 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

419 
$f›lds
 = 
	`cÚ‹Á_f›ld_š¡ªû_»ad
(
	`¬¿y
(), 
TRUE
);

420 
$u£d
 = 
FALSE
;

421 
	`fÜ—ch
 (
$f›lds
 
as
 
$exi¡šg_f›ld
) {

422 
$u£d
 |ğ(
$exi¡šg_f›ld
['f›ld_Çme'] =ğ
$f›ld_Çme
);

424 ià(
$u£d
) {

425 
	`fÜm_£t_”rÜ
('_add_Ãw_f›ld][f›ld_Çme', 
	`t
('Add‚ew f›ld:hf›ld‚am%f›ld_Çm®»adyƒxi¡s.', 
	`¬¿y
('%f›ld_Çme' => 
$f›ld_Çme
)));

430 ià(!
$f›ld
['type']) {

431 
	`fÜm_£t_”rÜ
('_add_Ãw_f›ld][ty³', 
	`t
('Add‚ew field: you‚eedo select‡ fieldype.'));

435 ià(!
$f›ld
['widget_type']) {

436 
	`fÜm_£t_”rÜ
('_add_Ãw_f›ld][widg‘_ty³', 
	`t
('Add‚ew field: you‚eedo select‡ widget.'));

439 
	`–£if
 (
$f›ld
['type']) {

440 
$widg‘_ty³s
 = 
	`cÚ‹Á_widg‘_ty³_İtiÚs
(
$f›ld
['type']);

441 ià(!
	`is£t
(
$widg‘_ty³s
[
$f›ld
['widget_type']])) {

442 
	`fÜm_£t_”rÜ
('_add_Ãw_f›ld][widg‘_ty³', 
	`t
('Add‚ew field: invalid widget.'));

446 
	}
}

453 
funùiÚ
 
	$_cÚ‹Á_f›ld_ov”v›w_fÜm_v®id©e_add_exi¡šg
(
$fÜm
, &
$fÜm_¡©e
) {

456 ià(
	`is£t
(
$fÜm_¡©e
['values']['_add_existing_field'])) {

457 
$f›ld
 = 
$fÜm_¡©e
['values']['_add_existing_field'];

460 ià(
	`¬¿y_f‹r
(
	`¬¿y
(
$f›ld
['label'], $field['field_name'], $field['widget_type']))) {

462 ià(!
$f›ld
['label']) {

463 
	`fÜm_£t_”rÜ
('_add_exi¡šg_f›ld][Ïb–', 
	`t
('Addƒxisting field: you‚eedo…rovide‡†abel.'));

467 ià(!
$f›ld
['field_name']) {

468 
	`fÜm_£t_”rÜ
('_add_exi¡šg_f›ld][f›ld_Çme', 
	`t
('Addƒxisting field: you‚eedo select‡ field.'));

472 ià(!
$f›ld
['widget_type']) {

473 
	`fÜm_£t_”rÜ
('_add_exi¡šg_f›ld][widg‘_ty³', 
	`t
('Addƒxisting field: you‚eedo select‡ widget.'));

476 
	`–£if
 (
$f›ld
['f›ld_Çme'] && (
$exi¡šg_f›ld
 = 
	`cÚ‹Á_f›lds
($field['field_name']))) {

477 
$widg‘_ty³s
 = 
	`cÚ‹Á_widg‘_ty³_İtiÚs
(
$exi¡šg_f›ld
['type']);

478 ià(!
	`is£t
(
$widg‘_ty³s
[
$f›ld
['widget_type']])) {

479 
	`fÜm_£t_”rÜ
('_add_exi¡šg_f›ld][widg‘_ty³', 
	`t
('Addƒxisting field: invalid widget.'));

484 
	}
}

486 
funùiÚ
 
	$cÚ‹Á_f›ld_ov”v›w_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

487 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

489 
$ty³_Çme
 = 
$fÜm
['#type_name'];

490 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

493 
$exŒa
 = 
	`¬¿y
();

494 
	`fÜ—ch
 (
$fÜm_v®ues
 
as
 
$key
 => 
$v®ues
) {

496 ià(
	`š_¬¿y
(
$key
, 
$fÜm
['#fields'])) {

497 
	`db_qu”y
("UPDATE {". 
	`cÚ‹Á_š¡ªû_bËÇme
() ."} SET weight = %d WHEREype_name = '%s' AND field_name = '%s'",

498 
$v®ues
['weight'], 
$ty³_Çme
, 
$key
);

500 
	`–£if
 (
	`š_¬¿y
(
$key
, 
$fÜm
['#extra'])) {

501 
$exŒa
[
$key
] = 
$v®ues
['weight'];

505 ià(
$exŒa
) {

506 
	`v¬ŸbË_£t
('cÚ‹Á_exŒa_weights_'. 
$ty³_Çme
, 
$exŒa
);

509 
	`v¬ŸbË_d–
('cÚ‹Á_exŒa_weights_'. 
$ty³_Çme
);

512 
	`cÚ‹Á_ş—r_ty³_ÿche
();

514 
$de¡š©iÚs
 = 
	`¬¿y
();

517 ià(!
	`em±y
(
$fÜm_v®ues
['_add_new_field']['field_name'])) {

518 
$f›ld
 = 
$fÜm_v®ues
['_add_new_field'];

519 
$f›ld
['ty³_Çme'] = 
$ty³_Çme
;

521 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

522 ià(
	`cÚ‹Á_f›ld_š¡ªû_ü—‹
(
$f›ld
)) {

524 
$fÜm_¡©e
['f›lds_added']['_add_Ãw_f›ld'] = 
$f›ld
['field_name'];

525 
$de¡š©iÚs
[] = 'admš/cÚ‹Á/node-ty³/'. 
$ty³
['u¾_¡r'] .'/f›lds/'. 
$f›ld
['field_name'];

528 
	`dru·l_£t_mes§ge
(
	`t
('Th”wa ¨´obËm c»©šg f›ld %Ïb–.', 
	`¬¿y
(

529 '%Ïb–' => 
$f›ld
['label'])));

534 ià(!
	`em±y
(
$fÜm_v®ues
['_add_existing_field']['field_name'])) {

535 
$f›ld
 = 
$fÜm_v®ues
['_add_existing_field'];

536 
$f›ld
['ty³_Çme'] = 
$ty³_Çme
;

537 
$exi¡šg_f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld
['field_name']);

539 ià(
$exi¡šg_f›ld
['locked']) {

540 
	`dru·l_£t_mes§ge
(
	`t
('Thf›ld %Ïb– cªnÙ baddedØ¨cÚ‹Áy³ beÿu£ iˆi locked.', 
	`¬¿y
('%Ïb–' => 
$f›ld
['field_name'])));

543 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

544 ià(
	`cÚ‹Á_f›ld_š¡ªû_ü—‹
(
$f›ld
)) {

546 
$fÜm_¡©e
['f›lds_added']['_add_exi¡šg_f›ld'] = 
$f›ld
['field_name'];

547 
$de¡š©iÚs
[] = 'admš/cÚ‹Á/node-ty³/'. 
$ty³
['u¾_¡r'] .'/f›lds/'. 
$f›ld
['field_name'];

550 
	`dru·l_£t_mes§ge
(
	`t
('Th”wa ¨´obËm‡ddšg f›ld %Ïb–.', 
	`¬¿y
('%Ïb–' => 
$f›ld
['field_name'])));

555 ià(
$de¡š©iÚs
) {

556 
$de¡š©iÚs
[] = 
	`u¾decode
(
	`sub¡r
(
	`dru·l_g‘_de¡š©iÚ
(), 12));

557 
	`un£t
(
$_REQUEST
['destination']);

558 
$fÜm_¡©e
['»dœeù'] = 
	`cÚ‹Á_g‘_de¡š©iÚs
(
$de¡š©iÚs
);

561 
	}
}

569 
funùiÚ
 
cÚ‹Á_di¥Ïy_ov”v›w_fÜm
(&
$fÜm_¡©e
, 
$ty³_Çme
, 
$cÚ‹xts_£ËùÜ
 = 'basic') {

570 
cÚ‹Á_šaùive_mes§ge
(
$ty³_Çme
);

573 
	g$ty³
 = 
cÚ‹Á_ty³s
(
$ty³_Çme
);

574 
	g$f›ld_ty³s
 = 
_cÚ‹Á_f›ld_ty³s
();

575 
	g$f›lds
 = 
$ty³
['fields'];

577 
	g$groups
 = 
¬¿y
();

578 ià(
moduË_exi¡s
('fieldgroup')) {

579 
	g$groups
 = 
f›ldgroup_groups
(
$ty³
['type']);

581 
	g$cÚ‹xts
 = 
cÚ‹Á_bud_modes
(
$cÚ‹xts_£ËùÜ
);

583 
	g$fÜm
 = 
¬¿y
(

584 '#Œ“' => 
TRUE
,

585 '#ty³_Çme' => 
$ty³
['type'],

586 '#f›lds' => 
¬¿y_keys
(
$f›lds
),

587 '#groups' => 
¬¿y_keys
(
$groups
),

588 '#cÚ‹xts' => 
$cÚ‹xts_£ËùÜ
,

591 ià(
em±y
(
$f›lds
)) {

592 
dru·l_£t_mes§ge
(
t
('Th”¬nØf›ld cÚfigu»d fÜhi cÚ‹Áy³. You cª‡dd‚ew f›ld Úh<¨h»f="@lšk">Mªagf›lds</a>…age.', 
¬¿y
(

593 '@lšk' => 
u¾
('admš/cÚ‹Á/node-ty³/'. 
$ty³
['url_str'] .'/fields'))), 'warning');

594  
	g$fÜm
;

598 
	g$Ïb–_İtiÚs
 = 
¬¿y
(

599 'above' => 
t
('Above'),

600 'šlše' => 
t
('Inline'),

601 'hidd’' => 
t
('<Hidden>'),

603 
fÜ—ch
 (
$f›lds
 
as
 
$Çme
 => 
$f›ld
) {

604 
$f›ld_ty³
 = 
$f›ld_ty³s
[
$f›ld
['type']];

605 
	g$deçuÉs
 = 
$f›ld
['display_settings'];

606 
	g$weight
 = 
$f›ld
['widget']['weight'];

608 
	g$fÜm
[
$Çme
] = 
¬¿y
(

609 'humª_Çme' => 
¬¿y
('#v®ue' => 
check_¶aš
(
$f›ld
['widget']['label'])),

610 'weight' => 
¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$weight
),

611 '·»Á' => 
¬¿y
('#type' => 'value', '#value' => ''),

615 ià(
	g$cÚ‹xts_£ËùÜ
 == 'basic') {

616 
$fÜm
[
$Çme
]['Ïb–']['fÜm©'] = 
¬¿y
(

618 '#İtiÚs' => 
$Ïb–_İtiÚs
,

619 '#deçuÉ_v®ue' => 
is£t
(
$deçuÉs
['label']['format']) ? $defaults['label']['format'] : 'above',

624 
	g$İtiÚs
 = 
¬¿y
();

625 
fÜ—ch
 (
$f›ld_ty³
['fÜm©‹rs'] 
as
 
$fÜm©‹r_Çme
 => 
$fÜm©‹r_šfo
) {

626 
$İtiÚs
[
$fÜm©‹r_Çme
] = 
$fÜm©‹r_šfo
['label'];

628 
	g$İtiÚs
['hidd’'] = 
t
('<Hidden>');

630 
fÜ—ch
 (
$cÚ‹xts
 
as
 
$key
 => 
$v®ue
) {

631 
$fÜm
[
$Çme
][
$key
]['fÜm©'] = 
¬¿y
(

633 '#İtiÚs' => 
$İtiÚs
,

634 '#deçuÉ_v®ue' => 
is£t
(
$deçuÉs
[
$key
]['format']) ? $defaults[$key]['format'] : 'default',

637 
	g$fÜm
[
$Çme
][
$key
]['exşude'] = 
¬¿y
(

639 '#İtiÚs' => 
¬¿y
(0 => 
t
('Include'), 1 =>('Exclude')),

640 '#deçuÉ_v®ue' => 
is£t
(
$deçuÉs
[
$key
]['exclude']) ? $defaults[$key]['exclude'] : 0,

646 
	g$Ïb–_İtiÚs
 = 
¬¿y
(

647 'above' => 
t
('Above'),

648 'hidd’' => 
t
('<Hidden>'),

650 
	g$İtiÚs
 = 
¬¿y
(

651 'no_¡yË' => 
t
('no styling'),

652 'sim¶e' => 
t
('simple'),

653 'f›ld£t' => 
t
('fieldset'),

654 'f›ld£t_cŞÏpsibË' => 
t
('fieldset - collapsible'),

655 'f›ld£t_cŞÏp£d' => 
t
('fieldset - collapsed'),

656 'hidd’' => 
t
('<Hidden>'),

658 
fÜ—ch
 (
$groups
 
as
 
$Çme
 => 
$group
) {

659 
$deçuÉs
 = 
$group
['settings']['display'];

660 
	g$weight
 = 
$group
['weight'];

662 
	g$fÜm
[
$Çme
] = 
¬¿y
(

663 'humª_Çme' => 
¬¿y
('#v®ue' => 
check_¶aš
(
$group
['label'])),

664 'weight' => 
¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$weight
),

666 ià(
	g$cÚ‹xts_£ËùÜ
 == 'basic') {

667 
$fÜm
[
$Çme
]['Ïb–'] = 
¬¿y
(

669 '#İtiÚs' => 
$Ïb–_İtiÚs
,

670 '#deçuÉ_v®ue' => 
is£t
(
$deçuÉs
['label']) ? $defaults['label'] : 'above',

673 
fÜ—ch
 (
$cÚ‹xts
 
as
 
$key
 => 
$t™Ë
) {

674 
$fÜm
[
$Çme
][
$key
]['fÜm©'] = 
¬¿y
(

676 '#İtiÚs' => 
$İtiÚs
,

677 '#deçuÉ_v®ue' => 
is£t
(
$deçuÉs
[
$key
]['format']) ? $defaults[$key]['format'] : 'fieldset',

680 
	g$fÜm
[
$Çme
][
$key
]['exşude'] = 
¬¿y
(

682 '#İtiÚs' => 
¬¿y
(0 => 
t
('Include'), 1 =>('Exclude')),

683 '#deçuÉ_v®ue' => 
is£t
(
$deçuÉs
[
$key
]['exclude']) ? $defaults[$key]['exclude'] : 0,

686 
fÜ—ch
 (
$group
['f›lds'] 
as
 
$f›ld_Çme
 => 
$f›ld
) {

687 
$fÜm
[
$f›ld_Çme
]['·»Á']['#v®ue'] = 
$Çme
;

691 
	g$fÜm
['subm™'] = 
¬¿y
('#ty³' => 'subm™', '#v®ue' => 
t
('Save'));

692  
	g$fÜm
;

698 
funùiÚ
 
	$cÚ‹Á_di¥Ïy_ov”v›w_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

699 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

700 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

701 
	`fÜ—ch
 (
$fÜm_v®ues
 
as
 
$key
 => 
$v®ues
) {

703 ià(
	`š_¬¿y
(
$key
, 
$fÜm
['#fields'])) {

704 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$key
, 
$fÜm
['#type_name']);

706 
$f›ld
['di¥Ïy_£‰šgs'] = 
$v®ues
 + $field['display_settings'];

707 
	`cÚ‹Á_f›ld_š¡ªû_upd©e
(
$f›ld
, 
FALSE
);

712 
	`cÚ‹Á_ş—r_ty³_ÿche
(
TRUE
);

713 
	`m’u_»bud
();

715 
	`dru·l_£t_mes§ge
(
	`t
('Your settings have been saved.'));

716 
	}
}

721 
funùiÚ
 
	$cÚ‹Á_f›ld_ty³_İtiÚs
() {

722 
$İtiÚs
;

724 ià(!
	`is£t
(
$İtiÚs
)) {

725 
$İtiÚs
 = 
	`¬¿y
();

726 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

727 
$f›ld_ty³_İtiÚs
 = 
	`¬¿y
();

728 
	`fÜ—ch
 (
$f›ld_ty³s
 
as
 
$f›ld_ty³_Çme
 => 
$f›ld_ty³
) {

730 ià(
	`cÚ‹Á_widg‘_ty³_İtiÚs
(
$f›ld_ty³_Çme
)) {

731 
$İtiÚs
[
$f›ld_ty³_Çme
] = 
	`t
(
$f›ld_ty³
['label']);

734 
	`asÜt
(
$İtiÚs
);

736  
$İtiÚs
;

737 
	}
}

745 
funùiÚ
 
	$cÚ‹Á_widg‘_ty³_İtiÚs
(
$f›ld_ty³
 = 
NULL
, 
$by_Ïb–
 = 
FALSE
) {

746 
$İtiÚs
;

748 ià(!
	`is£t
(
$İtiÚs
)) {

749 
$İtiÚs
 = 
	`¬¿y
();

750 
	`fÜ—ch
 (
	`_cÚ‹Á_widg‘_ty³s
(è
as
 
$widg‘_ty³_Çme
 => 
$widg‘_ty³
) {

751 
	`fÜ—ch
 (
$widg‘_ty³
['f›ldy³s'] 
as
 
$widg‘_f›ld_ty³
) {

752 
$İtiÚs
[
$widg‘_f›ld_ty³
][
$widg‘_ty³_Çme
] = 
	`t
(
$widg‘_ty³
['label']);

757 ià(
$f›ld_ty³
) {

758  !
	`em±y
(
$İtiÚs
[
$f›ld_ty³
]è? $İtiÚs[$f›ld_ty³] : 
	`¬¿y
();

760 
	`–£if
 (
$by_Ïb–
) {

761 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

762 
$İtiÚs_by_Ïb–
 = 
	`¬¿y
();

763 
	`fÜ—ch
 (
$İtiÚs
 
as
 
$f›ld_ty³
 => 
$widg‘s
) {

764 
$İtiÚs_by_Ïb–
[
	`t
(
$f›ld_ty³s
[
$f›ld_ty³
]['Ïb–'])] = 
$widg‘s
;

766  
$İtiÚs_by_Ïb–
;

769  
$İtiÚs
;

771 
	}
}

776 
funùiÚ
 
	$cÚ‹Á_exi¡šg_f›ld_İtiÚs
(
$ty³_Çme
) {

777 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

778 
$f›lds
 = 
	`cÚ‹Á_f›lds
();

779 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

781 
$İtiÚs
 = 
	`¬¿y
();

782 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
) {

783 ià(!
	`is£t
(
$ty³
['f›lds'][
$f›ld
['field_name']]) && !$field['locked']) {

784 
$f›ld_ty³
 = 
$f›ld_ty³s
[
$f›ld
['type']];

785 
$‹xt
 = 
	`t
('@ty³: @f›ld (@Ïb–)', 
	`¬¿y
('@ty³' =>(
$f›ld_ty³
['Ïb–']), '@Ïb–' =>(
$f›ld
['widget']['label']), '@field' => $field['field_name']));

786 
$İtiÚs
[
$f›ld
['f›ld_Çme']] = (
	`dru·l_¡¾’
(
$‹xt
è> 80è? 
	`Œunÿ‹_utf8
($text, 77) . '...' : $text;

790 
	`asÜt
(
$İtiÚs
);

792  
$İtiÚs
;

793 
	}
}

798 
funùiÚ
 
	$cÚ‹Á_f›ld_basic_fÜm
(&
$fÜm_¡©e
, 
$fÜm_v®ues
) {

799 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

801 
$ty³_Çme
 = 
$fÜm_v®ues
['type_name'];

802 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$fÜm_v®ues
['type_name']);

803 
$f›ld_Çme
 = 
$fÜm_v®ues
['field_name'];

804 
$f›ld_ty³
 = 
$fÜm_v®ues
['type'];

805 
$Ïb–
 = 
$fÜm_v®ues
['label'];

807 
$fÜm
 = 
	`¬¿y
();

809 
$fÜm
['basic'] = 
	`¬¿y
(

811 '#t™Ë' => 
	`t
('Edit basic information'),

813 
$fÜm
['basic']['f›ld_Çme'] = 
	`¬¿y
(

814 '#t™Ë' => 
	`t
('Field‚ame'),

816 '#v®ue' => 
$f›ld_Çme
,

817 '#desütiÚ' => 
	`t
("The machine-readable‚ame ofhe field. This‚ame cannot be changed."),

818 '#di§bËd' => 
TRUE
,

820 
$fÜm
['basic']['Ïb–'] = 
	`¬¿y
(

822 '#t™Ë' => 
	`t
('Label'),

823 '#deçuÉ_v®ue' => 
$Ïb–
,

824 '#»quœed' => 
TRUE
,

825 '#desütiÚ' => 
	`t
('A humª-»adabË‚amtØbu£d‡ thÏb– fÜhi f›ld iÀth%ty³ cÚ‹Áy³.', 
	`¬¿y
('%ty³' => 
$ty³
['name'])),

827 
$fÜm
['basic']['ty³'] = 
	`¬¿y
(

829 '#t™Ë' => 
	`t
('Fieldype'),

830 '#İtiÚs' => 
	`cÚ‹Á_f›ld_ty³_İtiÚs
(),

831 '#deçuÉ_v®ue' => 
$f›ld_ty³
,

832 '#desütiÚ' => 
	`t
('Theype of data you would†ikeo store inhe database withhis field. This option cannot be changed.'),

833 '#di§bËd' => 
TRUE
,

835 
$fÜm
['basic']['widg‘_ty³'] = 
	`¬¿y
(

837 '#t™Ë' => 
	`t
('Widgetype'),

838 '#»quœed' => 
TRUE
,

839 '#İtiÚs' => 
	`cÚ‹Á_widg‘_ty³_İtiÚs
(
$f›ld_ty³
),

840 '#deçuÉ_v®ue' => 
$fÜm_v®ues
['widget_type'],

841 '#desütiÚ' => 
	`t
('Thty³ oàfÜmƒËm’ˆyou would†iktØ´e£ÁØthu£¸wh’ c»©šghi f›ld iÀth%ty³ cÚ‹Áy³.', 
	`¬¿y
('%ty³' => 
$ty³
['name'])),

844 
$fÜm
['ty³_Çme'] = 
	`¬¿y
(

846 '#v®ue' => 
$ty³_Çme
,

849 
$fÜm
['subm™'] = 
	`¬¿y
(

851 '#v®ue' => 
	`t
('Continue'),

854 
$fÜm
['#v®id©e'] = 
	`¬¿y
();

855 
$fÜm
['#subm™'] = 
	`¬¿y
('content_field_basic_form_submit');

857  
$fÜm
;

858 
	}
}

863 
funùiÚ
 
	$cÚ‹Á_f›ld_basic_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

864 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

866 
$Ïb–
 = 
$fÜm_v®ues
['label'];

869 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

870 
$widg‘_ty³s
 = 
	`_cÚ‹Á_widg‘_ty³s
();

871 
$fÜm_v®ues
['moduË'] = 
$f›ld_ty³s
[$form_values['type']]['module'];

872 
$fÜm_v®ues
['widg‘_moduË'] = 
$widg‘_ty³s
[$form_values['widget_type']]['module'];

875 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

876 
$š¡ªûs
 = 
	`cÚ‹Á_f›ld_š¡ªû_»ad
(
	`¬¿y
('f›ld_Çme' => 
$fÜm_v®ues
['field_name'], 'type_name' => $form_values['type_name']));

877 
$f›ld
 = 
	`¬¿y_m”ge
(
	`cÚ‹Á_f›ld_š¡ªû_cŞÏp£
(
$š¡ªûs
[0]), 
$fÜm_v®ues
);

878 ià(
	`cÚ‹Á_f›ld_š¡ªû_upd©e
(
$f›ld
)) {

879 
	`dru·l_£t_mes§ge
(
	`t
('Upd©ed basiø£‰šg fÜ f›ld %Ïb–.', 
	`¬¿y
(

880 '%Ïb–' => 
$Ïb–
)));

883 
	`dru·l_£t_mes§ge
(
	`t
('Th”wa ¨´obËm upd©šghbasiø£‰šg fÜ f›ld %Ïb–.', 
	`¬¿y
(

884 '%Ïb–' => 
$Ïb–
)));

887 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$fÜm_v®ues
['type_name']);

888 
$fÜm_¡©e
['»dœeù'] = 'admš/cÚ‹Á/node-ty³/'. 
$ty³
['u¾_¡r'] .'/f›lds/'. 
$fÜm_v®ues
['field_name'];

889 
$fÜm_¡©e
['»bud'] = 
FALSE
;

890 
	}
}

895 
funùiÚ
 
	$cÚ‹Á_f›ld_»move_fÜm
(&
$fÜm_¡©e
, 
$ty³_Çme
, 
$f›ld_Çme
) {

896 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

897 
$f›ld
 = 
$ty³
['f›lds'][
$f›ld_Çme
];

899 
$fÜm
 = 
	`¬¿y
();

900 
$fÜm
['ty³_Çme'] = 
	`¬¿y
(

902 '#v®ue' => 
$ty³_Çme
,

904 
$fÜm
['f›ld_Çme'] = 
	`¬¿y
(

906 '#v®ue' => 
$f›ld_Çme
,

909 
$ouut
 = 
	`cÚfœm_fÜm
(
$fÜm
,

910 
	`t
('A» you su» you wªˆtØ»movthf›ld %f›ld?', 
	`¬¿y
('%f›ld' => 
$f›ld
['widget']['label'])),

911 'admš/cÚ‹Á/node-ty³/'. 
$ty³
['url_str'] .'/fields',

912 
	`t
('If you have‡ny content†eft inhis field, it will be†ost. This‡ction cannot be undone.'),

913 
	`t
('Remove'),('Cancel'),

917 ià(
$f›ld
['locked']) {

918 
	`un£t
(
$ouut
['actions']['submit']);

919 
$ouut
['desütiÚ']['#v®ue'] = 
	`t
('This field is <strong>locked</strong>‡nd cannot be„emoved.');

922  
$ouut
;

923 
	}
}

928 
funùiÚ
 
	$cÚ‹Á_f›ld_»move_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

929 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

930 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

932 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$fÜm_v®ues
['type_name']);

933 
$f›ld
 = 
$ty³
['f›lds'][
$fÜm_v®ues
['field_name']];

934 ià(
$f›ld
['locked']) {

938 ià(
$ty³
 && 
$f›ld
 && 
$fÜm_v®ues
['confirm']) {

939 ià(
	`cÚ‹Á_f›ld_š¡ªû_d–‘e
(
$fÜm_v®ues
['field_name'], $form_values['type_name'])) {

940 
	`dru·l_£t_mes§ge
(
	`t
('Removed f›ld %f›ld from %ty³.', 
	`¬¿y
(

941 '%f›ld' => 
$f›ld
['widget']['label'],

942 '%ty³' => 
$ty³
['name'])));

945 
	`dru·l_£t_mes§ge
(
	`t
('Th”wa ¨´obËm d–‘šg %f›ld from %ty³.', 
	`¬¿y
(

946 '%f›ld' => 
$f›ld
['widget']['label'],

947 '%ty³' => 
$ty³
['name'])));

949 
$fÜm_¡©e
['»dœeù'] = 'admš/cÚ‹Á/node-ty³/'. 
$ty³
['url_str'] .'/fields';

951 
	}
}

956 
funùiÚ
 
	$cÚ‹Á_f›ld_ed™_fÜm
(&
$fÜm_¡©e
, 
$ty³_Çme
, 
$f›ld_Çme
) {

957 
$ouut
 = '';

958 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

959 
$f›ld
 = 
$ty³
['f›lds'][
$f›ld_Çme
];

961 ià(
$f›ld
['locked']) {

962 
$ouut
 = 
	`¬¿y
();

963 
$ouut
['locked'] = 
	`¬¿y
(

964 '#v®ue' => 
	`t
('Thf›ld %f›ld i locked‡nd cªnÙ bed™ed.', 
	`¬¿y
('%f›ld' => 
$f›ld
['widget']['label'])),

966  
$ouut
;

969 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

970 
$f›ld_ty³
 = 
$f›ld_ty³s
[
$f›ld
['type']];

971 
$widg‘_ty³s
 = 
	`_cÚ‹Á_widg‘_ty³s
();

972 
$widg‘_ty³
 = 
$widg‘_ty³s
[
$f›ld
['widget']['type']];

974 
$t™Ë
 = 
	`is£t
(
$f›ld
['widget']['label']) ? $field['widget']['label'] : $field['field_name'];

975 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$t™Ë
));

978 ià(
	`is£t
(
$fÜm_¡©e
['change_basic'])) {

979 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

980 
$f›ld_v®ues
 = 
	`cÚ‹Á_f›ld_š¡ªû_cŞÏp£
(
$f›ld
);

981  
	`cÚ‹Á_f›ld_basic_fÜm
(
$fÜm_¡©e
, 
$f›ld_v®ues
);

984 
$add_Ãw_£qu’û
 = 
	`is£t
(
$_REQUEST
['destinations']);

987 ià(
$add_Ãw_£qu’û
) {

988 
	`m’u_£t_™em
(
NULL
, 
	`m’u_g‘_™em
('node'));

991 
$fÜm
 = 
	`¬¿y
();

992 
$fÜm
['#f›ld'] = 
$f›ld
;

993 
$fÜm
['#ty³'] = 
$ty³
;

996 
$fÜm
['basic'] = 
	`¬¿y
(

998 '#t™Ë' => 
	`t
('%ty³ basiøšfÜm©iÚ', 
	`¬¿y
('%ty³' => 
$ty³
['name'])),

999 '#acûss' => !
$add_Ãw_£qu’û
,

1001 
$fÜm
['basic']['Ïb–'] = 
	`¬¿y
(

1003 '#t™Ë' => 
	`t
('Label'),

1004 '#v®ue' => 
$f›ld
['widget']['label'],

1005 '#di§bËd' => 
TRUE
,

1007 
$fÜm
['basic']['f›ld_Çme'] = 
	`¬¿y
(

1009 '#t™Ë' => 
	`t
('Field‚ame'),

1010 '#v®ue' => 
$f›ld
['field_name'],

1011 '#di§bËd' => 
TRUE
,

1013 
$fÜm
['basic']['ty³'] = 
	`¬¿y
(

1015 '#t™Ë' => 
	`t
('Fieldype'),

1016 '#v®ue' => 
$f›ld
['type'],

1017 '#di§bËd' => 
TRUE
,

1019 
$widg‘_İtiÚs
 = 
	`cÚ‹Á_widg‘_ty³_İtiÚs
(
$f›ld
['type']);

1020 
$fÜm
['basic']['widg‘_ty³'] = 
	`¬¿y
(

1022 '#t™Ë' => 
	`t
('Widgetype'),

1023 '#İtiÚs' => 
$widg‘_İtiÚs
,

1024 '#deçuÉ_v®ue' => 
$f›ld
['widg‘']['ty³'] ? $f›ld['widg‘']['ty³'] : 
	`key
(
$widg‘_İtiÚs
),

1025 '#di§bËd' => 
TRUE
,

1027 
$fÜm
['basic']['chªge'] = 
	`¬¿y
(

1029 '#v®ue' => 
	`t
('Change basic information'),

1030 '#subm™' => 
	`¬¿y
('content_field_edit_form_submit_update_basic'),

1033 
$fÜm
['widg‘'] = 
	`¬¿y
(

1035 '#t™Ë' => 
	`t
('%ty³ s‘tšgs', 
	`¬¿y
('%ty³' => 
$ty³
['name'])),

1036 '#desütiÚ' => 
	`t
('The£ s‘tšg ­¶y oÆyØth%f›ld f›ld‡ ™‡µ—r šh%ty³ cÚ‹Áy³.', 
	`¬¿y
(

1037 '%f›ld' => 
$f›ld
['widget']['label'],

1038 '%ty³' => 
$ty³
['name'])),

1040 
$fÜm
['widg‘']['weight'] = 
	`¬¿y
(

1042 '#deçuÉ_v®ue' => 
$f›ld
['widget']['weight'],

1045 
$add™iÚs
 = (
¬¿y
è
	`moduË_švoke
(
$widg‘_ty³
['moduË'], 'widg‘_£‰šgs', 'fÜm', 
$f›ld
['widget']);

1046 
	`dru·l_®‹r
('widg‘_£‰šgs', 
$add™iÚs
, 'fÜm', 
$f›ld
['widget']);

1047 
$fÜm
['widg‘'] = 
	`¬¿y_m”ge
($fÜm['widg‘'], 
$add™iÚs
);

1049 
$fÜm
['widg‘']['desütiÚ'] = 
	`¬¿y
(

1051 '#t™Ë' => 
	`t
('Helpext'),

1052 '#deçuÉ_v®ue' => 
$f›ld
['widget']['description'],

1054 '#desütiÚ' => 
	`t
('In¡ruùiÚ tØ´e£ÁØthu£¸b–owhi f›ld oÀthed™šg fÜm.<b¸/>AÎowed HTMLags: @gs', 
	`¬¿y
('@gs' => 
	`_cÚ‹Á_f‹r_xss_di¥Ïy_®lowed_gs
())),

1055 '#»quœed' => 
FALSE
,

1059 ià(
	`cÚ‹Á_ÿÎback
('widg‘', 'deçuÉ v®ue', 
$f›ld
è=ğ
CONTENT_CALLBACK_DEFAULT
) {

1064 
$deçuÉ_v®ue
 = 
	`is£t
(
$f›ld
['widg‘']['deçuÉ_v®ue']è? $f›ld['widg‘']['deçuÉ_v®ue'] : 
	`¬¿y
();

1065 
$deçuÉ_v®ue_php
 = 
	`is£t
(
$f›ld
['widget']['default_value_php']) ? $field['widget']['default_value_php'] : '';

1066 
$fÜm
['widg‘']['deçuÉ_v®ue'] = 
	`¬¿y
(

1068 '#deçuÉ_v®ue' => 
$deçuÉ_v®ue
,

1070 
$fÜm
['widg‘']['deçuÉ_v®ue_php'] = 
	`¬¿y
(

1072 '#deçuÉ_v®ue' => 
$deçuÉ_v®ue_php
,

1078 
$fÜm
['widg‘']['deçuÉ_v®ue_f›ld£t'] = 
	`¬¿y
(

1080 '#t™Ë' => 
	`t
('Default value'),

1081 '#cŞÏpsibË' => 
TRUE
,

1082 '#cŞÏp£d' => 
TRUE
,

1086 
$widg‘_fÜm
 = 
	`¬¿y
('#node' => (
objeù
è¬¿y('ty³' => 
$ty³_Çme
));

1087 
$widg‘_fÜm_¡©e
 = 
	`¬¿y
('v®ues' =>‡¼ay(
$f›ld
['f›ld_Çme'] => 
$deçuÉ_v®ue
));

1089 
$widg‘_f›ld
 = 
$f›ld
;

1090 
$widg‘_f›ld
['»quœed'] = 
FALSE
;

1091 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.node_form');

1092 
$fÜm_–em’t
 = 
	`cÚ‹Á_f›ld_fÜm
(
$widg‘_fÜm
, 
$widg‘_fÜm_¡©e
, 
$widg‘_f›ld
, 0);

1093 
$fÜm
['widg‘']['deçuÉ_v®ue_f›ld£t']['deçuÉ_v®ue_widg‘'] = 
$fÜm_–em’t
;

1094 
$fÜm
['widg‘']['deçuÉ_v®ue_f›ld£t']['deçuÉ_v®ue_widg‘']['#Œ“'] = 
TRUE
;

1096 
$fÜm
['#f›ld_šfo'] = 
	`¬¿y
(
$widg‘_f›ld
['field_name'] => $widget_field);

1099 
$fÜm
['widg‘']['deçuÉ_v®ue_f›ld£t']['advªûd_İtiÚs'] = 
	`¬¿y
(

1101 '#t™Ë' => 
	`t
('PHP code'),

1102 '#cŞÏpsibË' => 
TRUE
,

1103 '#cŞÏp£d' => 
	`em±y
(
$f›ld
['widget']['default_value_php']),

1106 ià(
	`u£r_acûss
('Use PHP input for field settings (dangerous - grant with care)')) {

1107 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

1108 
$cŞumns
 = 
	`¬¿y_keys
(
$db_šfo
['columns']);

1109 
	`fÜ—ch
 (
$cŞumns
 
as
 
$key
 => 
$cŞumn
) {

1110 
$cŞumns
[
$key
] = 
	`t
("'@cŞumn' => v®ufÜ @cŞumn", 
	`¬¿y
('@cŞumn' => 
$cŞumn
));

1112 
$§m¶e
 = 
	`t
("»tuº‡¼ay(\À 0 =>‡¼ay(@cŞumns),\À // You'Î usu®ly wªˆtØ¡İ h”e. ProvidmÜv®ues\À // iàyou wªˆyou¸'deçuÉ v®ue'ØbmuÉi-v®ued:\À 1 =>‡¼ay(@cŞumns),\À 2 => ...\n);", 
	`¬¿y
('@cŞumns' => 
	`im¶ode
(', ', 
$cŞumns
)));

1114 
$fÜm
['widg‘']['deçuÉ_v®ue_f›ld£t']['advªûd_İtiÚs']['deçuÉ_v®ue_php'] = 
	`¬¿y
(

1116 '#t™Ë' => 
	`t
('Code'),

1117 '#deçuÉ_v®ue' => 
	`is£t
(
$f›ld
['widget']['default_value_php']) ? $field['widget']['default_value_php'] : '',

1119 '#Œ“' => 
TRUE
,

1120 '#desütiÚ' => 
	`t
('Advªûd u§gÚly: PHP codth©„‘uº ¨deçuÉ v®ue. Should‚Ù inşud&É;?ph°?&gt; d–im™”s. Iàthi f›ld i fËd out,hv®u»tuºed byhi codwÈov”ridªy v®u¥ecif›d‡bove. Ex³ùed fÜm©: <´e>!§m¶e</´e>TØfigu» ouˆthex³ùed fÜm©, you cª u£h<em>dev–†ßd</em>ab…rovided by <¨h»f="@lšk_dev–">dev– moduË</a> oÀ¨%ty³ cÚ‹Á…age.', 
	`¬¿y
(

1121 '!§m¶e' => 
$§m¶e
,

1123 '%ty³' => 
$ty³_Çme
)),

1127 
$fÜm
['widg‘']['deçuÉ_v®ue_f›ld£t']['advªûd_İtiÚs']['m¬kup_deçuÉ_v®ue_php'] = 
	`¬¿y
(

1129 '#t™Ë' => 
	`t
('Code'),

1130 '#v®ue' => !
	`em±y
(
$f›ld
['widg‘']['deçuÉ_v®ue_php']è? '<code>'. 
	`check_¶aš
($f›ld['widg‘']['deçuÉ_v®ue_php']è.'</code>' : 
	`t
('&lt;none&gt;'),

1131 '#desütiÚ' => 
	`em±y
(
$f›ld
['widg‘']['deçuÉ_v®ue_php']è? 
	`t
("You're‚ot‡llowedo input PHP code.") :('This PHP code was set by‡n‡dministrator‡nd will override‡ny value specified‡bove.'),

1136 
$fÜm
['f›ld'] = 
	`¬¿y
(

1138 '#t™Ë' => 
	`t
('Global settings'),

1139 '#desütiÚ' => 
	`t
('The£ s‘tšg ­¶yØth%f›ld f›ld iÀev”y cÚ‹Áy³ iÀwhich iˆ­³¬s.', 
	`¬¿y
('%f›ld' => 
$f›ld
['widget']['label'])),

1141 
$fÜm
['f›ld']['»quœed'] = 
	`¬¿y
(

1143 '#t™Ë' => 
	`t
('Required'),

1144 '#deçuÉ_v®ue' => 
$f›ld
['required'],

1146 
$desütiÚ
 = 
	`t
('Maximum‚umber of values users canƒnter forhis field.');

1147 ià(
	`cÚ‹Á_hªdË
('widg‘', 'muÉË v®ues', 
$f›ld
è=ğ
CONTENT_HANDLE_CORE
) {

1148 
$desütiÚ
 .ğ'<br/>'. 
	`t
("'Unlimited' will…rovide‡n 'Add more' button sohe users can‡dd‡s many values‡shey†ike.");

1150 
$desütiÚ
 .ğ'<br/><¡rÚg>'. 
	`t
('Warning! Changinghis setting‡fter data has been created could„esult inhe†oss of data!') .'</strong>';

1151 
$fÜm
['f›ld']['muÉË'] = 
	`¬¿y
(

1153 '#t™Ë' => 
	`t
('Number of values'),

1154 '#İtiÚs' => 
	`¬¿y
(1 => 
	`t
('UÆim™ed'), 0 => 1è+ 
	`dru·l_m­_assoc
(
	`¿nge
(2, 10)),

1155 '#deçuÉ_v®ue' => 
$f›ld
['multiple'],

1156 '#desütiÚ' => 
$desütiÚ
,

1159 
$fÜm
['f›ld']['´evious_f›ld'] = 
	`¬¿y
(

1161 '#v®ue' => 
	`£rŸlize
(
$f›ld
),

1164 
$add™iÚs
 = (
¬¿y
è
	`moduË_švoke
(
$f›ld_ty³
['moduË'], 'f›ld_£‰šgs', 'fÜm', 
$f›ld
);

1165 
	`dru·l_®‹r
('f›ld_£‰šgs', 
$add™iÚs
, 'fÜm', 
$f›ld
);

1166 
$fÜm
['f›ld'] = 
	`¬¿y_m”ge
($fÜm['f›ld'], 
$add™iÚs
);

1168 
$fÜm
['subm™'] = 
	`¬¿y
(

1170 '#v®ue' => 
	`t
('Save field settings'),

1172 
$fÜm
['ty³_Çme'] = 
	`¬¿y
(

1174 '#v®ue' => 
$ty³_Çme
,

1176 
$fÜm
['f›ld_Çme'] = 
	`¬¿y
(

1178 '#v®ue' => 
$f›ld_Çme
,

1180 
$fÜm
['ty³'] = 
	`¬¿y
(

1182 '#v®ue' => 
$f›ld
['type'],

1184 
$fÜm
['moduË'] = 
	`¬¿y
(

1186 '#v®ue' => 
$f›ld
['module'],

1188 
$fÜm
['widg‘']['Ïb–'] = 
	`¬¿y
(

1190 '#v®ue' => 
$f›ld
['widget']['label'],

1192 
$fÜm
['widg‘_moduË'] = 
	`¬¿y
(

1194 '#v®ue' => 
$f›ld
['widget']['module'],

1196 
$fÜm
['cŞumns'] = 
	`¬¿y
(

1198 '#v®ue' => 
$f›ld
['columns'],

1200  
$fÜm
;

1201 
	}
}

1206 
funùiÚ
 
	$cÚ‹Á_f›ld_ed™_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

1207 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

1208 ià(
	`is£t
(
$fÜm_¡©e
['chªge_basic']è|| 
$fÜm_v®ues
['İ'] =ğ
	`t
('Change basic information')) {

1212 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

1213 
$´evious_f›ld
 = 
	`un£rŸlize
(
$fÜm_v®ues
['previous_field']);

1214 
$f›ld
 = 
	`cÚ‹Á_f›ld_š¡ªû_ex·nd
(
$fÜm_v®ues
);

1215 
$f›ld
['db_¡Üage'] = 
	`cÚ‹Á_¡Üage_ty³
($field);

1217 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

1218 
$f›ld_ty³
 = 
$f›ld_ty³s
[
$f›ld
['type']];

1219 
$widg‘_ty³s
 = 
	`_cÚ‹Á_widg‘_ty³s
();

1220 
$widg‘_ty³
 = 
$widg‘_ty³s
[
$f›ld
['widget']['type']];

1222 ià(
$drİ³d_d©a
 = 
	`cÚ‹Á_®‹r_db_ª®yze
(
$´evious_f›ld
, 
$f›ld
)) {

1229 
	`moduË_švoke
(
$widg‘_ty³
['moduË'], 'widg‘_£‰šgs', 'v®id©e', 
	`¬¿y_m”ge
(
$f›ld
, 
$fÜm_v®ues
));

1230 
	`moduË_švoke
(
$f›ld_ty³
['moduË'], 'f›ld_£‰šgs', 'v®id©e', 
	`¬¿y_m”ge
(
$f›ld
, 
$fÜm_v®ues
));

1234 ià(
	`cÚ‹Á_ÿÎback
('widg‘', 'deçuÉ v®ue', 
$f›ld
è=ğ
CONTENT_CALLBACK_DEFAULT
) {

1238 ià(
$fÜm
['#programmed']) {

1239 
	`fÜm_£t_v®ue
(
	`¬¿y
('#·»Ás' =>‡¼ay('deçuÉ_v®ue_widg‘')), 
NULL
, 
$fÜm_¡©e
);

1243 ià(
	`is£t
(
$fÜm_v®ues
['default_value_php']) &&

1244 (
$php
 = 
	`Œim
(
$fÜm_v®ues
['default_value_php']))) {

1245 
$”rÜ
 = 
FALSE
;

1246 
	`ob_¡¬t
();

1247 
$»tuº
 = 
	`ev®
(
$php
);

1248 
	`ob_’d_ş—n
();

1249 ià(!
	`is_¬¿y
(
$»tuº
)) {

1250 
$”rÜ
 = 
TRUE
;

1253 
	`fÜ—ch
 (
$»tuº
 
as
 
$™em
) {

1254 ià(!
	`is_¬¿y
(
$™em
)) {

1255 
$”rÜ
 = 
TRUE
;

1260 ià(
$”rÜ
) {

1261 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

1262 
$cŞumns
 = 
	`¬¿y_keys
(
$db_šfo
['columns']);

1263 
	`fÜ—ch
 (
$cŞumns
 
as
 
$key
 => 
$cŞumn
) {

1264 
$cŞumns
[
$key
] = 
	`t
("'@cŞumn' => v®ufÜ @cŞumn", 
	`¬¿y
('@cŞumn' => 
$cŞumn
));

1266 
$§m¶e
 = 
	`t
("»tuº‡¼ay(\À 0 =>‡¼ay(@cŞumns),\À // You'Î usu®ly wªˆtØ¡İ h”e. ProvidmÜv®ues\À // iàyou wªˆyou¸'deçuÉ v®ue'ØbmuÉi-v®ued:\À 1 =>‡¼ay(@cŞumns),\À 2 => ...\n);", 
	`¬¿y
('@cŞumns' => 
	`im¶ode
(', ', 
$cŞumns
)));

1268 
	`fÜm_£t_”rÜ
('deçuÉ_v®ue_php', 
	`t
('ThdeçuÉ v®uPHP cod»tuºed‡ÀšcÜ»ù v®ue.<br/>Ex³ùed fÜm©: <´e>!§m¶e</´e> R‘uºed v®ue: @v®ue', 
	`¬¿y
(

1269 '!§m¶e' => 
$§m¶e
,

1270 '@v®ue' => 
	`´št_r
(
$»tuº
, 
TRUE
))));

1274 
$deçuÉ_v®ue
 = 
$»tuº
;

1275 
$is_code
 = 
TRUE
;

1276 
	`fÜm_£t_v®ue
(
	`¬¿y
('#·»Ás' =>‡¼ay('deçuÉ_v®ue_php')), 
$php
, 
$fÜm_¡©e
);

1277 
	`fÜm_£t_v®ue
(
	`¬¿y
('#·»Ás' =>‡¼ay('deçuÉ_v®ue')),‡¼ay(), 
$fÜm_¡©e
);

1280 
	`–£if
 (!
	`em±y
(
$fÜm_v®ues
['default_value_widget'])) {

1283 
$key
 = 
	`¬¿y_shiá
(
	`¬¿y_keys
(
$fÜm_v®ues
['default_value_widget']));

1284 
$deçuÉ_v®ue
 = 
$fÜm_v®ues
['deçuÉ_v®ue_widg‘'][
$key
];

1285 
$is_code
 = 
FALSE
;

1286 
	`fÜm_£t_v®ue
(
	`¬¿y
('#·»Ás' =>‡¼ay('deçuÉ_v®ue_php')), '', 
$fÜm_¡©e
);

1287 
	`fÜm_£t_v®ue
(
	`¬¿y
('#·»Ás' =>‡¼ay('deçuÉ_v®ue')), 
$deçuÉ_v®ue
, 
$fÜm_¡©e
);

1289 ià(
	`is£t
(
$deçuÉ_v®ue
)) {

1290 
$node
 = 
	`¬¿y
();

1291 
$node
[
$fÜm_v®ues
['f›ld_Çme']] = 
$deçuÉ_v®ue
;

1292 
$f›ld
['»quœed'] = 
FALSE
;

1293 
$f›ld_funùiÚ
 = 
$f›ld_ty³
['module'] .'_field';

1295 
$”rÜs_befÜe
 = 
	`fÜm_g‘_”rÜs
();

1299 ià(
	`funùiÚ_exi¡s
(
$f›ld_funùiÚ
)) {

1300 
	`$f›ld_funùiÚ
('v®id©e', 
$node
, 
$f›ld
, 
$deçuÉ_v®ue
, 
$fÜm
, 
NULL
);

1304 
$”rÜs_aá”
 = 
	`fÜm_g‘_”rÜs
();

1305 ià(
	`couÁ
(
$”rÜs_aá”
è> couÁ(
$”rÜs_befÜe
)) {

1306 ià(
	`Œim
(
$fÜm_v®ues
['default_value_php'])) {

1307 
	`fÜm_£t_”rÜ
('deçuÉ_v®ue_php', 
	`t
("ThPHP codfÜ 'deçuÉ v®ue'„‘uºed @v®ue, which i šv®id.", 
	`¬¿y
(

1308 '@v®ue' => 
	`´št_r
(
$deçuÉ_v®ue
, 
TRUE
))));

1311 
	`fÜm_£t_”rÜ
('deçuÉ_v®ue', 
	`t
('The default value is invalid.'));

1316 
	}
}

1321 
funùiÚ
 
	$cÚ‹Á_f›ld_ed™_fÜm_subm™_upd©e_basic
(
$fÜm
, &
$fÜm_¡©e
) {

1322 
$fÜm_¡©e
['chªge_basic'] = 
TRUE
;

1323 
$fÜm_¡©e
['»bud'] = 
TRUE
;

1324 
	}
}

1329 
funùiÚ
 
	$cÚ‹Á_f›ld_ed™_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1330 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

1331 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

1332 
	`cÚ‹Á_f›ld_š¡ªû_upd©e
(
$fÜm_v®ues
);

1334 ià(
	`is£t
(
$_REQUEST
['destinations'])) {

1335 
	`dru·l_£t_mes§ge
(
	`t
('Added f›ld %Ïb–.', 
	`¬¿y
('%Ïb–' => 
$fÜm_v®ues
['label'])));

1336 
$fÜm_¡©e
['»dœeù'] = 
	`cÚ‹Á_g‘_de¡š©iÚs
(
$_REQUEST
['destinations']);

1339 
	`dru·l_£t_mes§ge
(
	`t
('Saved f›ld %Ïb–.', 
	`¬¿y
('%Ïb–' => 
$fÜm_v®ues
['label'])));

1340 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$fÜm_v®ues
['type_name']);

1341 
$fÜm_¡©e
['»dœeù'] = 'admš/cÚ‹Á/node-ty³/'. 
$ty³
['url_str'] .'/fields';

1343 
	}
}

1348 
funùiÚ
 
	$cÚ‹Á_g‘_de¡š©iÚs
(
$de¡š©iÚs
) {

1349 
$qu”y
 = 
	`¬¿y
();

1350 
$·th
 = 
	`¬¿y_shiá
(
$de¡š©iÚs
);

1351 ià(
$de¡š©iÚs
) {

1352 
$qu”y
['de¡š©iÚs'] = 
$de¡š©iÚs
;

1354  
	`¬¿y
(
$·th
, 
$qu”y
);

1355 
	}
}

1366 
funùiÚ
 
	$cÚ‹Á_®‹r_schema
(
$´evious_f›ld
, 
$Ãw_f›ld
) {

1367 
	`cÚ‹Á_®‹r_db
(
$´evious_f›ld
, 
$Ãw_f›ld
);

1368 
	}
}

1377 
funùiÚ
 
	$cÚ‹Á_®‹r_db_ª®yze
(
$´evious_f›ld
, 
$Ãw_f›ld
) {

1378 
$drİ³d
 = 
	`¬¿y
();

1380 ià(
	`em±y
(
$´evious_f›ld
)) {

1381  
$drİ³d
;

1385 ià(!
	`em±y
(
$´evious_f›ld
è&& !em±y(
$Ãw_f›ld
)) {

1388 ià(
$´evious_f›ld
['db_¡Üage'] =ğ
CONTENT_DB_STORAGE_PER_FIELD
 &&

1389 
$Ãw_f›ld
['db_¡Üage'] =ğ
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
) {

1390 
$drİ³d
['delta'] = 0;

1394 
	`–£if
 (
	`is£t
(
$´evious_f›ld
['muÉË']è&& is£t(
$Ãw_f›ld
['multiple'])) {

1395 ià(
$´evious_f›ld
['muÉË'] > 
$Ãw_f›ld
['multiple'] &&

1396 
$Ãw_f›ld
['multiple'] > 1) {

1397 
$drİ³d
['d–'] = 
$Ãw_f›ld
['multiple'];

1403 
$´evious_schema
 = !
	`em±y
(
$´evious_f›ld
è? 
	`cÚ‹Á_bË_schema
($´evious_f›ldè: 
	`¬¿y
('fields' =>‡rray());

1404 
$Ãw_schema
 = !
	`em±y
(
$Ãw_f›ld
è? 
	`cÚ‹Á_bË_schema
($Ãw_f›ldè: 
	`¬¿y
('fields' =>‡rray());

1405 
$drİ³d_cŞumns
 = 
	`¬¿y_diff
(
	`¬¿y_keys
(
$´evious_schema
['f›lds']),‡¼ay_keys(
$Ãw_schema
['fields']));

1406 ià(
$drİ³d_cŞumns
) {

1407 
$drİ³d
['cŞumns'] = 
$drİ³d_cŞumns
;

1424  
$drİ³d
;

1425 
	}
}

1431 
funùiÚ
 
	$cÚ‹Á_®‹r_db
(
$´evious_f›ld
, 
$Ãw_f›ld
) {

1432 
$»t
 = 
	`¬¿y
();

1435 ià(
	`em±y
(
$´evious_f›ld
è&&ƒm±y(
$Ãw_f›ld
)) {

1436  
$»t
;

1440 
$´evious_schema
 = !
	`em±y
(
$´evious_f›ld
è? 
	`cÚ‹Á_bË_schema
($´evious_f›ldè: 
	`¬¿y
();

1441 
$Ãw_schema
 = !
	`em±y
(
$Ãw_f›ld
è? 
	`cÚ‹Á_bË_schema
($Ãw_f›ldè: 
	`¬¿y
();

1442 ià(!
	`em±y
(
$´evious_f›ld
)) {

1443 
$´evious_db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$´evious_f›ld
);

1444 
$´evious_bË
 = 
$´evious_db_šfo
['table'];

1446 ià(!
	`em±y
(
$Ãw_f›ld
)) {

1447 
$Ãw_db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$Ãw_f›ld
);

1448 
$Ãw_bË
 = 
$Ãw_db_šfo
['table'];

1452 ià(
	`em±y
(
$Ãw_f›ld
)) {

1453 ià(
$´evious_f›ld
['db_¡Üage'] =ğ
CONTENT_DB_STORAGE_PER_FIELD
) {

1454 
	`db_drİ_bË
(
$»t
, 
$´evious_bË
);

1457 
	`fÜ—ch
 (
$´evious_schema
['f›lds'] 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

1458 ià(!
	`š_¬¿y
(
$cŞumn
, 
	`¬¿y
('nid', 'vid', 'delta'))) {

1459 
	`db_drİ_f›ld
(
$»t
, 
$´evious_bË
, 
$cŞumn
);

1463 
	`cÚ‹Á_®‹r_db_ş—nup
();

1464  
$»t
;

1468 ià(!
	`em±y
(
$Ãw_f›ld
)) {

1469 
$ba£_bËÇme
 = 
	`_cÚ‹Á_bËÇme
(
$Ãw_f›ld
['ty³_Çme'], 
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
);

1470 ià(!
	`db_bË_exi¡s
(
$ba£_bËÇme
)) {

1471 
	`db_ü—‹_bË
(
$»t
, 
$ba£_bËÇme
, 
	`cÚ‹Á_bË_schema
());

1476 ià(!
	`db_bË_exi¡s
(
$Ãw_bË
)) {

1477 
	`db_ü—‹_bË
(
$»t
, 
$Ãw_bË
, 
$Ãw_schema
);

1481 
	`fÜ—ch
 (
$Ãw_schema
['f›lds'] 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

1482 ià(!
	`š_¬¿y
(
$cŞumn
, 
	`¬¿y
('nid', 'vid', 'delta'))) {

1484 ià(!
	`db_cŞumn_exi¡s
(
$Ãw_bË
, 
$cŞumn
)) {

1485 
	`db_add_f›ld
(
$»t
, 
$Ãw_bË
, 
$cŞumn
, 
$©Œibu‹s
);

1488 ià(
	`is£t
(
$Ãw_schema
['šdexes'][
$cŞumn
]è&& !
	`cÚ‹Á_db_šdex_exi¡s
(
$Ãw_bË
, $column)) {

1489 
	`db_add_šdex
(
$»t
, 
$Ãw_bË
, 
$cŞumn
, 
$Ãw_schema
['indexes'][$column]);

1496 ià(
	`em±y
(
$´evious_f›ld
)) {

1497 
	`cÚ‹Á_®‹r_db_ş—nup
();

1498  
$»t
;

1504 ià(!
	`db_bË_exi¡s
(
$´evious_bË
)) {

1505 
	`cÚ‹Á_®‹r_db_ş—nup
();

1506  
$»t
;

1511 
$mig¿‹_cŞumns
 = 
	`¬¿y_š‹r£ù_assoc
(
$Ãw_schema
['f›lds'], 
$´evious_schema
['fields']);

1512 
	`un£t
(
$mig¿‹_cŞumns
['nid'], $migrate_columns['vid'], $migrate_columns['delta']);

1517 ià(
$Ãw_bË
 !ğ
$ba£_bËÇme
 && 
$Ãw_f›ld
['muÉË'] < 
$´evious_f›ld
['multiple'] && $new_field['multiple'] != 1) {

1518 
	`db_qu”y
("DELETE FROM {". 
$Ãw_bË
 ."} WHERE d– >ğ". 
	`max
(1, 
$Ãw_f›ld
['multiple']));

1523 ià(
$Ãw_f›ld
['db_¡Üage'] =ğ
CONTENT_DB_STORAGE_PER_FIELD
) {

1524 ià(
$´evious_f›ld
['db_¡Üage'] =ğ
CONTENT_DB_STORAGE_PER_FIELD
 && 
	`couÁ
(
$´evious_schema
['fields'])) {

1526 ià(
$´evious_f›ld
['muÉË'] > 0 && 
$Ãw_f›ld
['multiple'] == 0) {

1527 
	`db_drİ_f›ld
(
$»t
, 
$Ãw_bË
, 'delta');

1528 
	`db_drİ_´im¬y_key
(
$»t
, 
$Ãw_bË
);

1529 
	`db_add_´im¬y_key
(
$»t
, 
$Ãw_bË
, 
	`¬¿y
('vid'));

1531 ià(
$´evious_f›ld
['muÉË'] =ğ0 && 
$Ãw_f›ld
['multiple'] > 0) {

1532 
	`db_add_f›ld
(
$»t
, 
$Ãw_bË
, 'd–', 
	`¬¿y
(

1534 'unsigÃd' => 
TRUE
,

1535 'nÙ‚uÎ' => 
TRUE
,

1537 
	`db_drİ_´im¬y_key
(
$»t
, 
$Ãw_bË
);

1538 
	`db_add_´im¬y_key
(
$»t
, 
$Ãw_bË
, 
	`¬¿y
('vid', 'delta'));

1544 ià(
$´evious_f›ld
['db_¡Üage'] =ğ
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
 &&

1545 
$Ãw_f›ld
['db_¡Üage'] =ğ
CONTENT_DB_STORAGE_PER_FIELD
) {

1546 
$cŞumns
 = 
	`¬¿y_keys
(
$mig¿‹_cŞumns
);

1547 ià(
$Ãw_f›ld
['multiple']) {

1548 
	`db_qu”y
('INSERT INTO {'. 
$Ãw_bË
 .'} (vid,‚id, d–, '. 
	`im¶ode
(', ', 
$cŞumns
) .') '.

1549 ' SELECT vid,‚id, 0, '. 
	`im¶ode
(', ', 
$cŞumns
è.' FROM {'. 
$´evious_bË
 .'}');

1552 
	`db_qu”y
('INSERT INTO {'. 
$Ãw_bË
 .'} (vid,‚id, '. 
	`im¶ode
(', ', 
$cŞumns
) .') '.

1553 ' SELECT vid,‚id, '. 
	`im¶ode
(', ', 
$cŞumns
è.' FROM {'. 
$´evious_bË
 .'}');

1555 
	`fÜ—ch
 (
$cŞumns
 
as
 
$cŞumn_Çme
) {

1556 
	`db_drİ_f›ld
(
$»t
, 
$´evious_bË
, 
$cŞumn_Çme
);

1561 ià(
$´evious_f›ld
['db_¡Üage'] =ğ
CONTENT_DB_STORAGE_PER_FIELD
 &&

1562 
$Ãw_f›ld
['db_¡Üage'] =ğ
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
) {

1565 
	`cÚ‹Á_®‹r_db_ş—nup
();

1566 ià(
$´evious_f›ld
['multiple']) {

1567 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {". 
$´evious_bË
 ."} c JOIN {node}‚ ON c.nid =‚.nid WHERE d– = 0 AND‚.ty³ = '%s'", 
$Ãw_f›ld
['type_name']);

1570 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {". 
$´evious_bË
 ."} c JOIN {node}‚ ON c.nid =‚.nid WHERE‚.ty³ = '%s'", 
$Ãw_f›ld
['type_name']);

1572 
$»cÜd
 = 
	`¬¿y
();

1573 
$d©a
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

1574 
$»cÜd
['nid'] = 
$d©a
['nid'];

1575 
$»cÜd
['vid'] = 
$d©a
['vid'];

1576 ià(
$´evious_f›ld
['multiple']) {

1577 
$»cÜd
['d–'] = 
$d©a
['delta'];

1579 
	`fÜ—ch
 (
$mig¿‹_cŞumns
 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

1580 ià(
	`is_nuÎ
(
$d©a
[
$cŞumn
])) {

1581 
$»cÜd
[
$cŞumn
] = 
NULL
;

1584 
$»cÜd
[
$cŞumn
] = 
$d©a
[$column];

1586 ià(
	`is£t
(
$©Œibu‹s
['serialize']) && $attributes['serialize']) {

1587 
$»cÜd
[
$cŞumn
] = 
	`un£rŸlize
($record[$column]);

1591 ià(
	`db_»suÉ
(
	`db_qu”y
('SELECT COUNT(*èFROM {'. 
$Ãw_bË
 .

1592 '} WHERE vid = %d AND‚id = %d', 
$d©a
['vid'], $data['nid']))) {

1593 
$keys
 = 
$Ãw_f›ld
['muÉË'] ? 
	`¬¿y
('vid', 'delta') :‡rray('vid');

1594 
	`dru·l_wr™e_»cÜd
(
$Ãw_bË
, 
$»cÜd
, 
$keys
);

1597 
	`dru·l_wr™e_»cÜd
(
$Ãw_bË
, 
$»cÜd
);

1600 
	`db_drİ_bË
(
$»t
, 
$´evious_bË
);

1604 
	`fÜ—ch
 (
$Ãw_schema
['f›lds'] 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

1605 ià(
	`is£t
(
$´evious_schema
['f›lds'][
$cŞumn
]) &&

1606 
$´evious_f›ld
['db_¡Üage'] =ğ
$Ãw_f›ld
['db_storage']) {

1607 ià(
$©Œibu‹s
 !ğ
$´evious_schema
['f›lds'][
$cŞumn
]) {

1608 ià(!
	`š_¬¿y
(
$cŞumn
, 
	`¬¿y
('nid', 'vid', 'delta'))) {

1609 
	`db_chªge_f›ld
(
$»t
, 
$Ãw_bË
, 
$cŞumn
, $cŞumn, 
$©Œibu‹s
);

1616 
	`fÜ—ch
 (
$´evious_schema
['f›lds'] 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

1617 ià(!
	`is£t
(
$Ãw_schema
['f›lds'][
$cŞumn
])) {

1618 ià(!
	`š_¬¿y
(
$cŞumn
, 
	`¬¿y
('nid', 'vid', 'delta'))) {

1619 
	`db_drİ_f›ld
(
$»t
, 
$´evious_bË
, 
$cŞumn
);

1625 ià(
	`moduË_exi¡s
('devel')) {

1628  
$»t
;

1629 
	}
}

1634 
funùiÚ
 
	$cÚ‹Á_®‹r_db_ş—nup
() {

1639 
	`cÚ‹Á_ş—r_ty³_ÿche
(
TRUE
);

1640 
	}
}

1649 
funùiÚ
 
	$_cÚ‹Á_ov”v›w_Üd”
(&
$fÜm
, 
$f›ld_rows
, 
$group_rows
) {

1652 
$dummy
 = 
	`¬¿y
();

1654 ià(
	`moduË_exi¡s
('fieldgroup')) {

1655 
	`fÜ—ch
 (
$group_rows
 
as
 
$Çme
) {

1656 
$dummy
[
$Çme
] = 
	`¬¿y
('#weight' => 
$fÜm
[$name]['weight']['#value'], '#value' => $name .' ');

1660 
	`fÜ—ch
 (
$f›ld_rows
 
as
 
$Çme
) {

1661 
$dummy
[
$Çme
] = 
	`¬¿y
('#weight' => 
$fÜm
[$name]['weight']['#value'], '#value' => $name .' ');

1662 ià(
	`moduË_exi¡s
('fieldgroup')) {

1663 ià(
$·»Á
 = 
$fÜm
[
$Çme
]['parent']['#value']) {

1664 
$fÜm
[
$Çme
]['#depth'] = 1;

1665 
$dummy
[
$·»Á
][
$Çme
] = $dummy[$name];

1666 
	`un£t
(
$dummy
[
$Çme
]);

1670  
$dummy
 ? 
	`ex¶ode
(' ', 
	`Œim
(
	`dru·l_»nd”
($dummy))è: 
	`¬¿y
();

1671 
	}
}

1682 
funùiÚ
 
	$cÚ‹Á_®‹r_f›lds
(
$´evious_f›ld
, 
$Ãw_f›ld
) {

1684 
$mask
 = 
	`cÚ‹Á_®‹r_db_mask
(
$´evious_f›ld
, 
$Ãw_f›ld
);

1690 ià(
	`em±y
(
$mask
)) {

1691  
	`cÚ‹Á_®‹r_db
(
$´evious_f›ld
, 
$Ãw_f›ld
);

1693 
$upd©es
 = 
	`¬¿y
(

1694 'mask' => 
$mask
['mask'],

1695 '®t_mask' => 
$mask
['alt_mask'],

1696 'd–' => 
$mask
['delta'],

1698 
$b©ch
 = 
	`¬¿y
(

1699 'İ”©iÚs' => 
	`¬¿y
(

1700 
	`¬¿y
('cÚ‹Á_f›ld_b©ch_upd©e',‡¼ay(
$´evious_f›ld
['f›ld_Çme'] => 
$upd©es
)),

1701 
	`¬¿y
('cÚ‹Á_®‹r_db',‡¼ay(
$´evious_f›ld
, 
$Ãw_f›ld
))

1704 't™Ë' => 
	`t
('Processing'),

1705 '”rÜ_mes§ge' => 
	`t
('The update hasƒncountered‡nƒrror.'),

1706 'fe' => './'. 
	`dru·l_g‘_·th
('module', 'content') .'/includes/content.admin.inc',

1708 
	`b©ch_£t
(
$b©ch
);

1709 ià(!
	`em±y
(
$u¾
)) {

1710 
	`b©ch_´oûss
(
$u¾
, $url);

1712 
	}
}

1717 
funùiÚ
 
	$_cÚ‹Á_®‹r_f›lds_fšished
(
$sucûss
, 
$»suÉs
, 
$İ”©iÚs
) {

1718 ià(
$sucûss
) {

1719 
	`dru·l_£t_mes§ge
(
	`t
('The database has been‡ltered‡nd data has been migrated or deleted.'));

1722 
	`dru·l_£t_mes§ge
(
	`t
('Anƒrror occurred‡nd database‡lteration did‚ot complete.'), 'error');

1723 
$mes§ge
 = 
	`fÜm©_¶u¿l
(
	`couÁ
(
$»suÉs
), '1 item successfully…rocessed:', '@count items successfully…rocessed:');

1724 
$mes§ge
 .ğ
	`theme
('™em_li¡', 
$»suÉs
);

1725 
	`dru·l_£t_mes§ge
(
$mes§ge
);

1727 
	}
}

1740 
funùiÚ
 
	$cÚ‹Á_®‹r_db_mask
(
$´evious_f›ld
, 
$Ãw_f›ld
) {

1744 
$drİ³d
 = 
	`cÚ‹Á_®‹r_db_ª®yze
(
$´evious_f›ld
, 
$Ãw_f›ld
);

1745 ià(
	`em±y
(
$drİ³d
)) {

1746  
	`¬¿y
();

1748 
$mask
 = 
	`¬¿y
('mask' =>‡rray());

1749 
	`fÜ—ch
 (
	`¬¿y_keys
(
$´evious_f›ld
['cŞumns']è
as
 
$cŞumn_Çme
) {

1751 ià(
	`is£t
(
$drİ³d
['cŞumns']è&& 
	`š_¬¿y
(
$cŞumn_Çme
, $dropped['columns'])) {

1752 
$mask
['mask'][
$cŞumn_Çme
] = 
NULL
;

1755 ià(
	`is£t
(
$drİ³d
['delta'])) {

1756 
$mask
['®t_mask'][
$cŞumn_Çme
] = 
NULL
;

1759 ià(
	`is£t
(
$drİ³d
['delta'])) {

1760 
$mask
['d–'] = 
$drİ³d
['delta'];

1762  
$mask
;

1763 
	}
}

1784 
funùiÚ
 
	$cÚ‹Á_f›ld_b©ch_upd©e
(
$upd©es
, &
$cÚ‹xt
) {

1785 ià(
	`em±y
(
$f›ld
)) {

1786 
$cÚ‹xt
['finished'] = 1;

1789 
$f›ld_Çme
 = 
$upd©es
['field_name'];

1790 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
);

1792 ià(!
	`is£t
(
$cÚ‹xt
['sandbox']['progress'])) {

1793 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

1798 ià(!
	`db_bË_exi¡s
(
$db_šfo
['table'])) {

1799  
$cÚ‹xt
['finished'] = 1;

1801 
$nodes
 = 
	`¬¿y
();

1802 
$»suÉ
 = 
	`db_qu”y
("SELECT‚id FROM {". 
$db_šfo
['table'] ."}");

1803 
$node
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

1804 
$nodes
[] = 
$node
['nid'];

1806 
$cÚ‹xt
['sandbox']['progress'] = 0;

1807 
$cÚ‹xt
['§ndbox']['max'] = 
	`couÁ
(
$nodes
);

1808 
$cÚ‹xt
['§ndbox']['nodes'] = 
$nodes
;

1812 
$couÁ
 = 
	`mš
(5, 
	`couÁ
(
$cÚ‹xt
['sandbox']['nodes']));

1814 
$i
 = 1; $˜<ğ
$couÁ
; $i++) {

1817 
$nid
 = 
	`¬¿y_shiá
(
$cÚ‹xt
['sandbox']['nodes']);

1818 
$node
 = 
	`cÚ‹Á_f›ld_»¶aû
(
$nid
, 
	`¬¿y
(
$upd©es
));

1821 
$cÚ‹xt
['»suÉs'][] = 
	`l
(
$node
->
t™Ë
, 'node/'. $node->
nid
);

1824 
$cÚ‹xt
['sandbox']['progress']++;

1825 
$cÚ‹xt
['mes§ge'] = 
	`t
('Proûssšg %t™Ë', 
	`¬¿y
('%t™Ë' => 
$node
->
t™Ë
));

1830 ià(
$cÚ‹xt
['sandbox']['progress'] != $context['sandbox']['max']) {

1831 
$cÚ‹xt
['finished'] = $context['sandbox']['progress'] / $context['sandbox']['max'];

1833 
	}
}

1868 
funùiÚ
 
	$cÚ‹Á_f›ld_»¶aû
(
$nid
, 
$upd©es
) {

1869 
$node
 = 
	`node_lßd
(
$nid
, 
NULL
, 
TRUE
);

1870 
	`fÜ—ch
 (
$upd©es
 
as
 
$f›ld_Çme
 => 
$upd©e
) {

1871 
$™ems
 = 
	`is£t
(
$node
->
$f›ld_Çme
è? $node->$f›ld_Çm: 
	`¬¿y
();

1872 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$v®ue
) {

1873 
$f›ld_mask
 = (
	`is£t
(
$upd©e
['d–']è&& is£t($upd©e['®t_mask']è&& 
$d–
 >ğ$upd©e['d–']è? $upd©e['®t_mask'] : 
$mask
['mask'];

1875 
$™ems
[
$d–
] = 
	`¬¿y_m”ge
($™ems[$d–], 
$f›ld_mask
);

1878 
$™ems
 = 
	`cÚ‹Á_£t_em±y
(
$f›ld
, $items);

1879 
$node
->
$f›ld_Çme
 = 
$™ems
;

1881 
	`node_§ve
(
$node
);

1882  
$node
;

1883 
	}
}

1888 
funùiÚ
 
	$_–em’t_v®id©e_š‹g”
(
$–em’t
, &
$fÜm_¡©e
) {

1889 
$v®ue
 = 
$–em’t
['#value'];

1890 ià(
$v®ue
 !=ğ'' && (!
	`is_num”ic
($v®ueè|| 
	`štv®
($value) != $value)) {

1891 
	`fÜm_”rÜ
(
$–em’t
, 
	`t
('%Çmmu¡ bª iÁeg”.', 
	`¬¿y
('%name' => $element['#title'])));

1893 
	}
}

1898 
funùiÚ
 
	$_–em’t_v®id©e_š‹g”_pos™ive
(
$–em’t
, &
$fÜm_¡©e
) {

1899 
$v®ue
 = 
$–em’t
['#value'];

1900 ià(
$v®ue
 !=ğ'' && (!
	`is_num”ic
($v®ueè|| 
	`štv®
($value) != $value || $value <= 0)) {

1901 
	`fÜm_”rÜ
(
$–em’t
, 
	`t
('%Çmmu¡ b¨pos™ivš‹g”.', 
	`¬¿y
('%name' => $element['#title'])));

1903 
	}
}

1908 
funùiÚ
 
	$_–em’t_v®id©e_numb”
(
$–em’t
, &
$fÜm_¡©e
) {

1909 
$v®ue
 = 
$–em’t
['#value'];

1910 ià(
$v®ue
 !ğ'' && !
	`is_num”ic
($value)) {

1911 
	`fÜm_”rÜ
(
$–em’t
, 
	`t
('%Çmmu¡ b¨numb”.', 
	`¬¿y
('%name' => $element['#title'])));

1913 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.crud.inc

1 <?
php


31 
funùiÚ
 
	$cÚ‹Á_f›ld_deçuÉ_v®ues
(
$f›ld_ty³
) {

32 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

33 
$moduË
 = 
$f›ld_ty³s
[
$f›ld_ty³
]['module'];

35 
$f›ld
 = 
	`¬¿y
(

36 'moduË' => 
$moduË
,

37 'ty³' => 
$f›ld_ty³
,

41 ià(
	`moduË_exi¡s
(
$moduË
)) {

42 
$f›ld
['active'] = 1;

45 
$f›ld
['cŞumns'] = (
¬¿y
è
	`moduË_švoke
(
$moduË
, 'field_settings', 'database columns', $field);

47 
	`fÜ—ch
 (
$f›ld
['cŞumns'] 
as
 
$cŞumn_Çme
 => 
$cŞumn
) {

48 
$f›ld
['cŞumns'][
$cŞumn_Çme
]['nÙ‚uÎ'] = 
FALSE
;

51 
$f›ld
['required'] = 0;

52 
$f›ld
['multiple'] = 0;

53 
$f›ld
['db_¡Üage'] = 
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
;

56 
$£‰šg_Çmes
 = (
¬¿y
è
	`moduË_švoke
(
$moduË
, 'f›ld_£‰šgs', '§ve', 
$f›ld
);

57 
	`dru·l_®‹r
('f›ld_£‰šgs', 
$£‰šg_Çmes
, '§ve', 
$f›ld
);

58 
	`fÜ—ch
 (
$£‰šg_Çmes
 
as
 
$£‰šg
) {

59 
$f›ld
[
$£‰šg
] = 
NULL
;

61  
$f›ld
;

62 
	}
}

67 
funùiÚ
 
	$cÚ‹Á_š¡ªû_deçuÉ_v®ues
(
$f›ld_Çme
, 
$ty³_Çme
, 
$widg‘_ty³
) {

68 
$widg‘_ty³s
 = 
	`_cÚ‹Á_widg‘_ty³s
();

69 
$moduË
 = 
$widg‘_ty³s
[
$widg‘_ty³
]['module'];

71 
$widg‘
 = 
	`¬¿y
(

72 'f›ld_Çme' => 
$f›ld_Çme
,

73 'ty³_Çme' => 
$ty³_Çme
,

75 'Ïb–' => 
$f›ld_Çme
,

77 'widg‘_ty³' => 
$widg‘_ty³
,

78 'widg‘_moduË' => 
$moduË
,

79 'di¥Ïy_£‰šgs' => 
	`¬¿y
(),

80 'widg‘_£‰šgs' => 
	`¬¿y
(),

83 ià(
	`moduË_exi¡s
(
$moduË
)) {

84 
$widg‘
['widget_active'] = 1;

87 
$£‰šgs_Çmes
 = 
	`¬¿y_m”ge
(
	`¬¿y
('Ïb–'), 
	`¬¿y_keys
(
	`cÚ‹Á_bud_modes
()));

88 
$widg‘
['di¥Ïy_£‰šgs'] = 
	`¬¿y
();

89 
	`fÜ—ch
 (
$£‰šgs_Çmes
 
as
 
$Çme
) {

90 
$widg‘
['di¥Ïy_£‰šgs'][
$Çme
]['format'] = ($name == 'label') ? 'above' : 'default';

91 
$widg‘
['di¥Ïy_£‰šgs'][
$Çme
]['exclude'] = 0;

95 
$£‰šgs_Çmes
 = (
¬¿y
è
	`moduË_švoke
(
$moduË
, 'widg‘_£‰šgs', '§ve', 
$widg‘
);

96 
	`dru·l_®‹r
('widg‘_£‰šgs', 
$£‰šgs_Çmes
, '§ve', 
$widg‘
);

97 
$widg‘
['widg‘_£‰šgs'] = 
	`¬¿y
();

98 
	`fÜ—ch
 (
$£‰šgs_Çmes
 
as
 
$Çme
) {

99 
$widg‘
['widg‘_£‰šgs'][
$Çme
] = 
NULL
;

101  
$widg‘
;

102 
	}
}

107 
funùiÚ
 
	$cÚ‹Á_f›ld_š¡ªû_ex·nd
(
$f›ld
) {

108 ià(
	`is£t
(
$f›ld
['widget'])) {

109  
$f›ld
;

111 
$f›ld
['widg‘'] = !
	`em±y
($f›ld['widg‘_£‰šgs']è? $f›ld['widg‘_£‰šgs'] : 
	`¬¿y
();

112 
$f›ld
['widg‘']['Ïb–'] = !
	`em±y
($field['label']) ? $field['label'] : $field['field_name'];

113 
$f›ld
['widg‘']['weight'] = !
	`em±y
($field['weight']) ? $field['weight'] : 0;

114 
$f›ld
['widg‘']['desütiÚ'] = !
	`em±y
($field['description']) ? $field['description'] : '';

116 ià(!
	`em±y
(
$f›ld
['widget_type'])) {

117 
$f›ld
['widget']['type'] = $field['widget_type'];

118 
$widg‘_ty³s
 = 
	`_cÚ‹Á_widg‘_ty³s
();

119 
$f›ld
['widg‘']['moduË'] = 
	`is£t
(
$widg‘_ty³s
[$field['widget_type']]['module']) ? $widget_types[$field['widget_type']]['module'] : $field['widget_module'];

121 
	`–£if
 (!
	`em±y
(
$f›ld
['widget_module'])) {

122 
$f›ld
['widget']['module'] = $field['widget_module'];

125 
	`un£t
(
$f›ld
['widget_type']);

126 
	`un£t
(
$f›ld
['weight']);

127 
	`un£t
(
$f›ld
['label']);

128 
	`un£t
(
$f›ld
['description']);

129 
	`un£t
(
$f›ld
['widget_module']);

130 
	`un£t
(
$f›ld
['widget_settings']);

134 ià(
	`is£t
(
$f›ld
['default_value']) && isset($field['default_value_php']) &&

135 
	`cÚ‹Á_ÿÎback
('widg‘', 'deçuÉ v®ue', 
$f›ld
è=ğ
CONTENT_CALLBACK_DEFAULT
) {

136 
$f›ld
['widg‘']['deçuÉ_v®ue'] = !
	`em±y
($f›ld['deçuÉ_v®ue']è? $f›ld['deçuÉ_v®ue'] : 
NULL
;

137 
$f›ld
['widg‘']['deçuÉ_v®ue_php'] = !
	`em±y
($f›ld['deçuÉ_v®ue_php']è? $f›ld['deçuÉ_v®ue_php'] : 
NULL
;

138 
	`un£t
(
$f›ld
['default_value']);

139 
	`un£t
(
$f›ld
['default_value_php']);

141  
$f›ld
;

142 
	}
}

147 
funùiÚ
 
	$cÚ‹Á_f›ld_š¡ªû_cŞÏp£
(
$f›ld
) {

148 ià(!
	`is£t
(
$f›ld
['widget'])) {

149  
$f›ld
;

151 
$f›ld
['widg‘_£‰šgs'] = !
	`em±y
($f›ld['widg‘']è? $f›ld['widg‘'] : 
	`¬¿y
();

152 
$f›ld
['widg‘_ty³'] = !
	`em±y
($field['widget']['type']) ? $field['widget']['type'] : '';

153 
$f›ld
['weight'] = !
	`em±y
($field['widget']['weight']) ? $field['widget']['weight'] : 0;

154 
$f›ld
['Ïb–'] = !
	`em±y
($field['widget']['label']) ? $field['widget']['label'] : $field['field_name'];

155 
$f›ld
['desütiÚ'] = !
	`em±y
($field['widget']['description']) ? $field['widget']['description'] : '';

156 
$f›ld
['ty³_Çme'] = !
	`em±y
($field['type_name']) ? $field['type_name'] : '';

158 ià(!
	`em±y
(
$f›ld
['widget']['module'])) {

159 
$widg‘_moduË
 = 
$f›ld
['widget']['module'];

161 
	`–£if
 (!
	`em±y
(
$f›ld
['widget']['type'])) {

162 
$widg‘_ty³s
 = 
	`_cÚ‹Á_widg‘_ty³s
();

163 
$widg‘_moduË
 = 
$widg‘_ty³s
[
$f›ld
['widget']['type']]['module'];

166 
$widg‘_moduË
 = '';

168 
$f›ld
['widg‘_moduË'] = 
$widg‘_moduË
;

169 
	`un£t
(
$f›ld
['widget_settings']['type']);

170 
	`un£t
(
$f›ld
['widget_settings']['weight']);

171 
	`un£t
(
$f›ld
['widget_settings']['label']);

172 
	`un£t
(
$f›ld
['widget_settings']['description']);

173 
	`un£t
(
$f›ld
['widget_settings']['module']);

174 
	`un£t
(
$f›ld
['widget']);

175  
$f›ld
;

176 
	}
}

210 
funùiÚ
 
	$cÚ‹Á_f›ld_š¡ªû_ü—‹
(
$f›ld
, 
$»bud
 = 
TRUE
) {

211 
	`šşude_Úû
('./'. 
	`dru·l_g‘_·th
('module', 'content') .'/includes/content.admin.inc');

213 
$fÜm_v®ues
 = 
$f›ld
;

214 
$f›ld
 = 
	`cÚ‹Á_f›ld_š¡ªû_ex·nd
($field);

218 
$´iÜ_š¡ªûs
 = 
	`cÚ‹Á_f›ld_š¡ªû_»ad
(
	`¬¿y
('f›ld_Çme' => 
$f›ld
['field_name']));

219 ià(!
	`em±y
(
$´iÜ_š¡ªûs
è&& 
	`is_¬¿y
($prior_instances)) {

220 
$´ev_f›ld
 = 
	`cÚ‹Á_f›ld_š¡ªû_ex·nd
(
$´iÜ_š¡ªûs
[0]);

226 
$f›ld
['widg‘']['weight'] = 
	`is£t
(
$fÜm_v®ues
['weight']è? $fÜm_v®ues['weight'] : 
$´ev_f›ld
['widget']['weight'];

227 
$f›ld
['widg‘']['Ïb–'] = 
	`is£t
(
$fÜm_v®ues
['Ïb–']è? $fÜm_v®ues['Ïb–'] : 
$´ev_f›ld
['widget']['label'];

228 
$f›ld
['widg‘']['desütiÚ'] = 
	`is£t
(
$fÜm_v®ues
['desütiÚ']è? $fÜm_v®ues['desütiÚ'] : 
$´ev_f›ld
['widget']['description'];

231 
$´ev_f›ld
 = 
	`¬¿y
('widget' =>‡rray());

235 
$deçuÉ_v®ues
 = 
	`¬¿y
('widget' =>‡rray());

236 ià(
	`is£t
(
$f›ld
['type'])) {

237 
$deçuÉ_v®ues
 = 
	`cÚ‹Á_f›ld_deçuÉ_v®ues
(
$f›ld
['type']);

238 
$deçuÉ_š¡ªû_v®ues
 = 
	`cÚ‹Á_š¡ªû_deçuÉ_v®ues
(
$f›ld
['field_name'], $field['type_name'], $field['widget']['type']);

239 
$deçuÉ_v®ues
 = 
	`cÚ‹Á_f›ld_š¡ªû_ex·nd
(
	`¬¿y_m”ge
($deçuÉ_v®ues, 
$deçuÉ_š¡ªû_v®ues
));

244 
$widg‘
 = 
	`¬¿y_m”ge
(
$deçuÉ_v®ues
['widg‘'], 
$´ev_f›ld
['widg‘'], 
$f›ld
['widget']);

245 
$f›ld
 = 
	`¬¿y_m”ge
(
$deçuÉ_v®ues
, 
$´ev_f›ld
, $field);

246 
$f›ld
['widg‘'] = 
$widg‘
;

249 ià(
	`em±y
(
$f›ld
['module']) && !empty($field['type'])) {

250 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

251 
$f›ld
['moduË'] = 
$f›ld_ty³s
[$field['type']]['module'];

255 
$f›ld
['db_¡Üage'] = 
	`cÚ‹Á_¡Üage_ty³
($field);

258 
$f›ld
['cŞumns'] = (
¬¿y
è
	`moduË_švoke
($field['module'], 'field_settings', 'database columns', $field);

260 ià(
	`em±y
(
$´ev_f›ld
['widg‘']è|| 
$´iÜ_š¡ªûs
 < 1) {

262 
$f›ld
['db_¡Üage'] = $f›ld['muÉË'] > 0 ? 
CONTENT_DB_STORAGE_PER_FIELD
 : 
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
;

263 
	`_cÚ‹Á_f›ld_wr™e
(
$f›ld
, 'create');

265 
	`–£if
 (!
	`em±y
(
$´ev_f›ld
['widg‘']è&& $´ev_f›ld['db_¡Üage'] =ğ
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
 && 
	`couÁ
(
$´iÜ_š¡ªûs
) > 0) {

267 
$f›ld
['db_¡Üage'] = 
CONTENT_DB_STORAGE_PER_FIELD
;

269 
	`fÜ—ch
 (
$´iÜ_š¡ªûs
 
as
 
$š¡ªû
) {

270 
$Ãw_š¡ªû
 = 
$š¡ªû
;

271 
$Ãw_š¡ªû
['db_¡Üage'] = 
CONTENT_DB_STORAGE_PER_FIELD
;

274 
	`moduË_švoke_®l
('cÚ‹Á_f›ld­i', 'upd©š¡ªû', 
$Ãw_š¡ªû
);

276 
	`cÚ‹Á_®‹r_schema
(
$š¡ªû
, 
$Ãw_š¡ªû
);

281 
	`moduË_švoke_®l
('cÚ‹Á_f›ld­i', 'ü—‹ in¡ªû', 
$f›ld
);

284 
	`_cÚ‹Á_f›ld_wr™e
(
$f›ld
, 'update');

285 
	`_cÚ‹Á_f›ld_š¡ªû_wr™e
(
$f›ld
, 'create');

287 
	`cÚ‹Á_®‹r_schema
(
	`¬¿y
(), 
$f›ld
);

289 ià(
$»bud
) {

290 
	`cÚ‹Á_ş—r_ty³_ÿche
(
TRUE
);

291 
	`m’u_»bud
();

294  
$f›ld
;

295 
	}
}

321 
funùiÚ
 
	$cÚ‹Á_f›ld_š¡ªû_upd©e
(
$f›ld
, 
$»bud
 = 
TRUE
) {

322 
	`šşude_Úû
('./'. 
	`dru·l_g‘_·th
('module', 'content') .'/includes/content.admin.inc');

325 
$f›ld
 = 
	`cÚ‹Á_f›ld_š¡ªû_ex·nd
($field);

328 
$´evious
 = 
	`cÚ‹Á_f›ld_š¡ªû_»ad
(
	`¬¿y
('f›ld_Çme' => 
$f›ld
['field_name'], 'type_name' => $field['type_name']));

329 
$´ev_f›ld
 = 
	`¬¿y_pİ
(
$´evious
);

333 
$widg‘
 = 
	`¬¿y_m”ge
(
$´ev_f›ld
['widg‘'], 
$f›ld
['widget']);

334 
$f›ld
 = 
	`¬¿y_m”ge
(
$´ev_f›ld
, $field);

335 
$f›ld
['widg‘'] = 
$widg‘
;

338 ià(
	`em±y
(
$f›ld
['module']) && !empty($field['type'])) {

339 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

340 
$f›ld
['moduË'] = 
$f›ld_ty³s
[$field['type']]['module'];

344 
$f›ld
['db_¡Üage'] = 
	`cÚ‹Á_¡Üage_ty³
($field);

348 
$f›ld
['cŞumns'] = (
¬¿y
è
	`moduË_švoke
($field['module'], 'field_settings', 'database columns', $field);

351 
$´iÜ_š¡ªûs
 = 
	`cÚ‹Á_f›ld_š¡ªû_»ad
(
	`¬¿y
('f›ld_Çme' => 
$f›ld
['field_name']));

353 ià(
$´ev_f›ld
['db_¡Üage'] =ğ
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
 && 
	`couÁ
(
$´iÜ_š¡ªûs
) > 1) {

355 
$f›ld
['db_¡Üage'] = 
CONTENT_DB_STORAGE_PER_FIELD
;

358 
	`fÜ—ch
 (
$´iÜ_š¡ªûs
 
as
 
$š¡ªû
) {

359 ià(
$š¡ªû
['ty³_Çme'] !ğ
$f›ld
['type_name']) {

360 
$Ãw_š¡ªû
 = 
$š¡ªû
;

361 
$Ãw_š¡ªû
['db_¡Üage'] = 
CONTENT_DB_STORAGE_PER_FIELD
;

364 
	`moduË_švoke_®l
('cÚ‹Á_f›ld­i', 'upd©š¡ªû', 
$Ãw_š¡ªû
);

366 
	`cÚ‹Á_®‹r_schema
(
$š¡ªû
, 
$Ãw_š¡ªû
);

372 
	`moduË_švoke_®l
('cÚ‹Á_f›ld­i', 'upd©š¡ªû', 
$f›ld
);

375 
	`_cÚ‹Á_f›ld_wr™e
(
$f›ld
, 'update');

376 
	`_cÚ‹Á_f›ld_š¡ªû_wr™e
(
$f›ld
, 'update');

378 
	`cÚ‹Á_®‹r_schema
(
$´ev_f›ld
, 
$f›ld
);

380 ià(
$»bud
) {

381 
	`cÚ‹Á_ş—r_ty³_ÿche
(
TRUE
);

385 ià(
$´ev_f›ld
['widg‘']['Ïb–'] !ğ
$f›ld
['widget']['label']) {

386 
	`m’u_»bud
();

390  
$f›ld
;

391 
	}
}

399 
funùiÚ
 
_cÚ‹Á_f›ld_wr™e
(
$f›ld
, 
$İ
 = 'update') {

401 
$f›ld
['glob®_£‰šgs'] = 
¬¿y
();

402 
	g$£‰šg_Çmes
 = (
¬¿y
è
moduË_švoke
(
$f›ld
['module'], 'field_settings', 'save', $field);

403 
dru·l_®‹r
('f›ld_£‰šgs', 
$£‰šg_Çmes
, '§ve', 
$f›ld
);

405 
fÜ—ch
 (
$£‰šg_Çmes
 
as
 
$£‰šg
) {

408 
	g$f›ld
['glob®_£‰šgs'][
$£‰šg
] = 
is£t
(
$f›ld
[$setting]) ? $field[$setting] : '';

409 
un£t
(
$f›ld
[
$£‰šg
]);

412 
	g$f›ld
['db_cŞumns'] = 
$f›ld
['columns'];

414 
	g$İ
) {

416 
dru·l_wr™e_»cÜd
(
cÚ‹Á_f›ld_bËÇme
(), 
$f›ld
);

419 
dru·l_wr™e_»cÜd
(
cÚ‹Á_f›ld_bËÇme
(), 
$f›ld
, 'field_name');

422 
un£t
(
$f›ld
['db_columns']);

423  
	g$f›ld
;

432 
funùiÚ
 
_cÚ‹Á_f›ld_š¡ªû_wr™e
(
$f›ld
, 
$İ
 = 'update') {

435 
$f›ld
 = 
cÚ‹Á_f›ld_š¡ªû_cŞÏp£
($field);

438 
	g$£‰šg_Çmes
 = (
¬¿y
è
moduË_švoke
(
$f›ld
['widget_module'], 'widget_settings', 'save', $field);

439 
dru·l_®‹r
('widg‘_£‰šgs', 
$£‰šg_Çmes
, '§ve', 
$f›ld
);

440 
fÜ—ch
 (
$£‰šg_Çmes
 
as
 
$£‰šg
) {

444 ià(
is£t
(
$f›ld
[
$£‰šg
])) {

445 
	g$f›ld
['widg‘_£‰šgs'][
$£‰šg
] = 
$f›ld
[$setting];

446 
un£t
(
$f›ld
[
$£‰šg
]);

450 
	g$İ
) {

452 
dru·l_wr™e_»cÜd
(
cÚ‹Á_š¡ªû_bËÇme
(), 
$f›ld
);

455 
dru·l_wr™e_»cÜd
(
cÚ‹Á_š¡ªû_bËÇme
(), 
$f›ld
, 
¬¿y
('field_name', 'type_name'));

458  
	g$f›ld
;

475 
funùiÚ
 
	$cÚ‹Á_f›ld_š¡ªû_»ad
(
$·¿m
 = 
NULL
, 
$šşude_šaùive
 = 
FALSE
) {

476 
$cÚd
 = 
	`¬¿y
();

477 
$¬gs
 = 
	`¬¿y
();

478 ià(
	`is_¬¿y
(
$·¿m
)) {

480 
	`fÜ—ch
 (
$·¿m
 
as
 
$key
 => 
$v®ue
) {

481 
$cÚd
[] = 'nfi.'. 
	`db_esÿ³_¡ršg
(
$key
) ." = '%s'";

482 
$¬gs
[] = 
$v®ue
;

485 ià(!
$šşude_šaùive
) {

486 
$cÚd
[] = 'nf.active = 1';

487 
$cÚd
[] = 'nfi.widget_active = 1';

489 
$wh”e
 = 
$cÚd
 ? ' WHERE '. 
	`im¶ode
(' AND ', $cond) : '';

491 
$db_»suÉ
 = 
	`db_qu”y
("SELECT * FROM {". 
	`cÚ‹Á_š¡ªû_bËÇme
() ."}‚fi ".

492 " JOIN {". 
	`cÚ‹Á_f›ld_bËÇme
() ."}‚f ON‚fi.field_name =‚f.field_name ".

493 "$wh”ORDER BY‚fi.weighˆASC,‚fi.Ïb– ASC", 
$¬gs
);

495 
$f›lds
 = 
	`¬¿y
();

496 
$š¡ªû
 = 
	`db_ãtch_¬¿y
(
$db_»suÉ
)) {

498 
	`fÜ—ch
 (
	`¬¿y
('widg‘_£‰šgs', 'di¥Ïy_£‰šgs', 'glob®_£‰šgs', 'db_cŞumns'è
as
 
$key
) {

499 
$š¡ªû
[
$key
] = (!
	`em±y
($š¡ªû[$key])è? (
¬¿y
è
	`un£rŸlize
($š¡ªû[$key]è: 
	`¬¿y
();

502 
$š¡ªû
['columns'] = $instance['db_columns'];

503 
	`un£t
(
$š¡ªû
['db_columns']);

506 
	`fÜ—ch
 (
$š¡ªû
['glob®_£‰šgs'] 
as
 
$key
 => 
$v®ue
) {

507 
$š¡ªû
[
$key
] = 
$v®ue
;

509 
	`un£t
(
$š¡ªû
['global_settings']);

513 
$f›ld
 = 
	`cÚ‹Á_f›ld_š¡ªû_ex·nd
(
$š¡ªû
);

516 
	`moduË_švoke_®l
('cÚ‹Á_f›ld­i', '»ad in¡ªû', 
$f›ld
);

517 
$f›lds
[] = 
$f›ld
;

519  
$f›lds
;

520 
	}
}

546 
funùiÚ
 
	$cÚ‹Á_f›ld_š¡ªû_d–‘e
(
$f›ld_Çme
, 
$ty³_Çme
, 
$»bud
 = 
TRUE
) {

547 
	`šşude_Úû
('./'. 
	`dru·l_g‘_·th
('module', 'content') .'/includes/content.admin.inc');

550 
$f›ld
 = 
	`¬¿y_pİ
(
	`cÚ‹Á_f›ld_š¡ªû_»ad
(
	`¬¿y
('f›ld_Çme' => 
$f›ld_Çme
, 'ty³_Çme' => 
$ty³_Çme
)));

553 
	`moduË_švoke_®l
('cÚ‹Á_f›ld­i', 'd–‘š¡ªû', 
$f›ld
);

555 
	`db_qu”y
("DELETE FROM {". 
	`cÚ‹Á_š¡ªû_bËÇme
() .

556 "} WHERE f›ld_Çmğ'%s' ANDy³_Çmğ'%s'", 
$f›ld
['field_name'], $field['type_name']);

559 
$š¡ªûs
 = 
	`cÚ‹Á_f›ld_š¡ªû_»ad
(
	`¬¿y
('f›ld_Çme' => 
$f›ld_Çme
));

560 ià((
$š¡ªûs
) < 1) {

561 
	`db_qu”y
("DELETE FROM {". 
	`cÚ‹Á_f›ld_bËÇme
(è."} WHERE f›ld_Çmğ'%s'", 
$f›ld
['field_name']);

562 
	`cÚ‹Á_®‹r_schema
(
$f›ld
, 
	`¬¿y
());

566 
	`–£if
 ((
$š¡ªûs
è=ğ1 && !(
$f›ld
['multiple'])) {

568 
$š¡ªû
 = 
$š¡ªûs
[0];

569 
$Ãw_š¡ªû
 = 
$š¡ªû
;

570 
$Ãw_š¡ªû
['db_¡Üage'] = 
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
;

571 
	`_cÚ‹Á_f›ld_wr™e
(
$Ãw_š¡ªû
, 'update');

573 
	`cÚ‹Á_®‹r_schema
(
$š¡ªû
, 
$Ãw_š¡ªû
);

578 ià(!
	`cÚ‹Á_f›ld_š¡ªû_»ad
(
	`¬¿y
('ty³_Çme' => 
$f›ld
['ty³_Çme']), 
TRUE
)) {

579 
$ba£_bËÇme
 = 
	`_cÚ‹Á_bËÇme
(
$f›ld
['ty³_Çme'], 
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
);

580 ià(
	`db_bË_exi¡s
(
$ba£_bËÇme
)) {

581 
	`db_drİ_bË
(
$»t
, 
$ba£_bËÇme
);

585 ià(
$»bud
) {

586 
	`cÚ‹Á_ş—r_ty³_ÿche
(
TRUE
);

587 
	`m’u_»bud
();

590  
$f›ld
;

591 
	}
}

598 
funùiÚ
 
	$cÚ‹Á_moduË_d–‘e
(
$moduË
) {

602 ià(
	`db_bË_exi¡s
(
	`cÚ‹Á_š¡ªû_bËÇme
())) {

603 
$»suÉs
 = 
	`db_qu”y
("SELECT f›ld_Çme,y³_ÇmFROM {". 
	`cÚ‹Á_š¡ªû_bËÇme
(è."} WHERE widg‘_moduË = '%s'", 
$moduË
);

604 
$f›ld
 = 
	`db_ãtch_¬¿y
(
$»suÉs
)) {

605 
	`cÚ‹Á_f›ld_š¡ªû_d–‘e
(
$f›ld
['f›ld_Çme'], $f›ld['ty³_Çme'], 
FALSE
);

608 
	`cÚ‹Á_ş—r_ty³_ÿche
(
TRUE
);

609 
	`m’u_»bud
();

611 
	}
}

623 
funùiÚ
 
	$cÚ‹Á_ty³_ü—‹
(
$šfo
) {

624 
	`node_g‘_ty³s
(
NULL
, NULL, 
TRUE
);

625 
	`cÚ‹Á_ş—r_ty³_ÿche
(
TRUE
);

626 
	}
}

634 
funùiÚ
 
	$cÚ‹Á_ty³_upd©e
(
$šfo
) {

635 ià(!
	`em±y
(
$šfo
->
Şd_ty³
è&& $šfo->Şd_ty³ !ğ$šfo->
ty³
) {

637 
	`db_qu”y
("UPDATE {". 
	`cÚ‹Á_š¡ªû_bËÇme
(è."} SETy³_Çme='%s' WHEREy³_Çme='%s'", 
	`¬¿y
(
$šfo
->
ty³
, $šfo->
Şd_ty³
));

640 
$Şd_ty³
 = 
	`cÚ‹Á_ty³s
(
$šfo
->
Şd_ty³
);

641 
$Şd_Çme
 = 
	`_cÚ‹Á_bËÇme
(
$Şd_ty³
['ty³'], 
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
);

642 
$Ãw_Çme
 = 
	`_cÚ‹Á_bËÇme
(
$šfo
->
ty³
, 
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
);

643 ià(
	`db_bË_exi¡s
(
$Şd_Çme
)) {

644 
$»t
 = 
	`¬¿y
();

645 
	`db_»Çme_bË
(
$»t
, 
$Şd_Çme
, 
$Ãw_Çme
);

646 
	`w©chdog
('cÚ‹Á', 'CÚ‹Á f›ld bË %Şd_Çmha b“À»ÇmedØ%Ãw_Çmªd f›ld in¡ªû havb“Àupd©ed.', 
	`¬¿y
(

647 '%Şd_Çme' => 
$Şd_Çme
, '%Ãw_Çme' => 
$Ãw_Çme
));

651 ià(
$exŒa
 = 
	`v¬ŸbË_g‘
('cÚ‹Á_exŒa_weights_'. 
$šfo
->
Şd_ty³
, 
	`¬¿y
())) {

652 
	`v¬ŸbË_£t
('cÚ‹Á_exŒa_weights_'. 
$šfo
->
ty³
, 
$exŒa
);

653 
	`v¬ŸbË_d–
('cÚ‹Á_exŒa_weights_'. 
$šfo
->
Şd_ty³
);

660 
	`cÚ‹Á_ş—r_ty³_ÿche
(
TRUE
);

661 
	}
}

674 
funùiÚ
 
	$cÚ‹Á_ty³_d–‘e
(
$šfo
) {

676 ià(!
	`em±y
(
$šfo
->
di§bËd
)) {

682 
$f›lds
 = 
	`cÚ‹Á_f›ld_š¡ªû_»ad
(
	`¬¿y
('ty³_Çme' => 
$šfo
->
ty³
));

683 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
) {

684 
	`cÚ‹Á_f›ld_š¡ªû_d–‘e
(
$f›ld
['f›ld_Çme'], 
$šfo
->
ty³
, 
FALSE
);

686 
$bË
 = 
	`_cÚ‹Á_bËÇme
(
$šfo
->
ty³
, 
CONTENT_DB_STORAGE_PER_CONTENT_TYPE
);

687 ià(
	`db_bË_exi¡s
(
$bË
)) {

688 
$»t
 = 
	`¬¿y
();

689 
	`db_drİ_bË
(
$»t
, 
$bË
);

690 
	`w©chdog
('cÚ‹Á', 'ThcÚ‹Á f›ld bË %Çmha b“Àd–‘ed.', 
	`¬¿y
('%Çme' => 
$bË
));

694 
	`cÚ‹Á_ş—r_ty³_ÿche
(
TRUE
);

695 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.devel.inc

1 <?
php


21 
funùiÚ
 
	$cÚ‹Á_g’”©e_f›lds
(&
$node
, 
$f›ld
) {

22 
$ty³_Çme
 = 
$node
->
ty³
;

23 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

24 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

26 ià(!
	`em±y
(
$ty³
['fields'])) {

27 
	`fÜ—ch
 (
$ty³
['f›lds'] 
as
 
$f›ld
) {

28 
$node_f›ld
 = 
	`¬¿y
();

30 ià(
	`cÚ‹Á_hªdË
('widg‘', 'muÉË v®ues', 
$f›ld
è=ğ
CONTENT_HANDLE_MODULE
) {

31 
$max
 = 0;

34 
$f›ld
['multiple']) {

36 
$max
 = 0;

39 
$max
 = 
	`¿nd
(0, 3);

42 
$max
 = 
$f›ld
['multiple'];

46 
$i
 = 0; $˜<ğ
$max
; $i++) {

47 
$moduË
 = 
$f›ld_ty³s
[
$f›ld
['type']]['module'];

48 
$funùiÚ
 = 
$moduË
 .'_content_generate';

49 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

50 
$»suÉ
 = 
	`$funùiÚ
(
$node
, 
$f›ld
);

51 ià(
	`cÚ‹Á_hªdË
('widg‘', 'muÉË v®ues', 
$f›ld
è=ğ
CONTENT_HANDLE_MODULE
) {

53 
$node_f›ld
 = 
$»suÉ
;

57 
$node_f›ld
[
$i
] = 
$»suÉ
;

61 
$node
->{
$f›ld
['f›ld_Çme']} = 
$node_f›ld
;

64 
	}
}

72 
funùiÚ
 
	$cÚ‹Á_dev–_muÉË
(
$funùiÚ
, 
$node
, 
$f›ld
) {

73 
$node_f›ld
 = 
	`¬¿y
();

74 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

75 
$f›ld
['multiple']) {

77 
$max
 = 0;

80 
$max
 = 
	`¿nd
(0, 3);

83 
$max
 = 
$f›ld
['multiple'];

86 
$i
 = 0; $˜<ğ
$max
; $i++) {

87 
$node_f›ld
[
$i
] = 
	`$funùiÚ
(
$node
, 
$f›ld
);

90  
$node_f›ld
;

91 
	}
}

93 ià(
moduË_exi¡s
('text')) {

94 
funùiÚ
 
‹xt_cÚ‹Á_g’”©e
(
$node
, 
$f›ld
) {

95 ià(
cÚ‹Á_hªdË
('widg‘', 'muÉË v®ues', 
$f›ld
è=ğ
CONTENT_HANDLE_MODULE
) {

96  
cÚ‹Á_dev–_muÉË
('_‹xt_cÚ‹Á_g’”©e', 
$node
, 
$f›ld
);

99  
_‹xt_cÚ‹Á_g’”©e
(
$node
, 
$f›ld
);

103 
funùiÚ
 
_‹xt_cÚ‹Á_g’”©e
(
$node
, 
$f›ld
) {

104 
	g$node_f›ld
 = 
¬¿y
();

105 ià(
	g$f›ld
['widget']['type'] == 'text_textarea') {

106 
$fÜm©
 = 
$f›ld
['‹xt_´oûssšg'] ? 
¿nd
(0, 3) : 0;

107 
	g$node_f›ld
['v®ue'] = 
dev–_ü—‹_cÚ‹Á
(
$fÜm©
);

108 
	g$node_f›ld
['fÜm©'] = 
$fÜm©
;

111 
	g$®lowed_v®ues
 = 
cÚ‹Á_®lowed_v®ues
(
$f›ld
);

112 ià(!
em±y
(
$®lowed_v®ues
)) {

114 
	g$node_f›ld
['v®ue'] = 
¬¿y_¿nd
(
$®lowed_v®ues
);

118 ià(
em±y
(
$f›ld
['max_length'])) {

119 
	g$f›ld
['max_length'] = 12;

121 
	g$node_f›ld
['v®ue'] = 
u£r_·sswÜd
(
$f›ld
['max_length']);

124  
	g$node_f›ld
;

128 ià(
moduË_exi¡s
('number')) {

129 
funùiÚ
 
numb”_cÚ‹Á_g’”©e
(
$node
, 
$f›ld
) {

130 ià(
cÚ‹Á_hªdË
('widg‘', 'muÉË v®ues', 
$f›ld
è=ğ
CONTENT_HANDLE_MODULE
) {

131  
cÚ‹Á_dev–_muÉË
('_numb”_cÚ‹Á_g’”©e', 
$node
, 
$f›ld
);

134  
_numb”_cÚ‹Á_g’”©e
(
$node
, 
$f›ld
);

138 
funùiÚ
 
_numb”_cÚ‹Á_g’”©e
(
$node
, 
$f›ld
) {

139 
	g$node_f›ld
 = 
¬¿y
();

140 
	g$®lowed_v®ues
 = 
cÚ‹Á_®lowed_v®ues
(
$f›ld
);

141 ià(!
em±y
(
$®lowed_v®ues
)) {

143 
	g$node_f›ld
['v®ue'] = 
¬¿y_¿nd
(
$®lowed_v®ues
);

146 
	g$mš
 = 
is_num”ic
(
$f›ld
['min']) ? $field['min'] : 0;

147 
	g$f›ld
['type']) {

149 
$max
 = 
is_num”ic
(
$f›ld
['max']) ? $field['max'] : 10000;

150 
	g$decim®
 = 0;

151 
	g$sÿË
 = 0;

155 
$´ecisiÚ
 = 
is_num”ic
(
$f›ld
['precision']) ? $field['precision'] : 10;

156 
	g$sÿË
 = 
is_num”ic
(
$f›ld
['scale']) ? $field['scale'] : 2;

157 
	g$max
 = 
is_num”ic
(
$f›ld
['max']è? $f›ld['max'] : 
pow
(10, (
$´ecisiÚ
 - 
$sÿË
));

158 
	g$decim®
 = 
¿nd
(0, (10 * 
$sÿË
)) / 100;

162 
$´ecisiÚ
 = 
¿nd
(10, 32);

163 
	g$sÿË
 = 
¿nd
(0, 2);

164 
	g$decim®
 = 
¿nd
(0, (10 * 
$sÿË
)) / 100;

165 
	g$max
 = 
is_num”ic
(
$f›ld
['max']è? $f›ld['max'] : 
pow
(10, (
$´ecisiÚ
 - 
$sÿË
));

168 
	g$node_f›ld
['v®ue'] = 
round
((
¿nd
(
$mš
, 
$max
è+ 
$decim®
), 
$sÿË
);

170  
	g$node_f›ld
;

174 ià(
moduË_exi¡s
('nodereference')) {

175 
funùiÚ
 
nod”eã»nû_cÚ‹Á_g’”©e
(
$node
, 
$f›ld
) {

176 ià(
cÚ‹Á_hªdË
('widg‘', 'muÉË v®ues', 
$f›ld
è=ğ
CONTENT_HANDLE_MODULE
) {

177  
cÚ‹Á_dev–_muÉË
('_nod”eã»nû_cÚ‹Á_g’”©e', 
$node
, 
$f›ld
);

180  
_nod”eã»nû_cÚ‹Á_g’”©e
(
$node
, 
$f›ld
);

184 
funùiÚ
 
_nod”eã»nû_cÚ‹Á_g’”©e
(
$node
, 
$f›ld
) {

185 
	g$node_f›ld
 = 
¬¿y
();

186 
	g$®lowed_v®ues
 = 
nod”eã»nû_®lowed_v®ues
(
$f›ld
);

187 
un£t
(
$®lowed_v®ues
[0]);

188 ià(!
em±y
(
$®lowed_v®ues
)) {

190 
	g$node_f›ld
['nid'] = 
¬¿y_¿nd
(
$®lowed_v®ues
);

192  
	g$node_f›ld
;

196 ià(
moduË_exi¡s
('userreference')) {

197 
funùiÚ
 
u£¼eã»nû_cÚ‹Á_g’”©e
(
$node
, 
$f›ld
) {

198 ià(
cÚ‹Á_hªdË
('widg‘', 'muÉË v®ues', 
$f›ld
è=ğ
CONTENT_HANDLE_MODULE
) {

199  
cÚ‹Á_dev–_muÉË
('_u£¼eã»nû_cÚ‹Á_g’”©e', 
$node
, 
$f›ld
);

202  
_u£¼eã»nû_cÚ‹Á_g’”©e
(
$node
, 
$f›ld
);

206 
funùiÚ
 
_u£¼eã»nû_cÚ‹Á_g’”©e
(
$node
, 
$f›ld
) {

207 
	g$node_f›ld
 = 
¬¿y
();

208 
	g$®lowed_v®ues
 = 
u£¼eã»nû_®lowed_v®ues
(
$f›ld
);

209 ià(
is£t
(
$®lowed_v®ues
['none'])) {

210 
un£t
(
$®lowed_v®ues
['none']);

212 ià(!
em±y
(
$®lowed_v®ues
)) {

214 
	g$node_f›ld
['uid'] = 
¬¿y_¿nd
(
$®lowed_v®ues
);

216  
	g$node_f›ld
;

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.diff.inc

1 <?
php


14 
funùiÚ
 
	$cÚ‹Á_diff
(
$Şd_node
, 
$Ãw_node
) {

15 
$»suÉ
 = 
	`¬¿y
();

17 ià(
	`is£t
(
$Ãw_node
->
ty³
)) {

18 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$Ãw_node
->
ty³
);

19 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

20 
	`fÜ—ch
 (
$ty³
['f›lds'] 
as
 
$f›ld
) {

22 ià(!
	`cÚ‹Á_acûss
('v›w', 
$f›ld
, 
NULL
, 
$Ãw_node
)) {

25 
$funùiÚ
 = 
$f›ld_ty³s
[
$f›ld
['type']]['module'] . '_content_diff_values';

26 
$funùiÚ
 = 
	`funùiÚ_exi¡s
($function) ? $function : 'content_content_diff_values';

27 
$Şd_v®ues
 = 
	`¬¿y
();

28 
$Ãw_v®ues
 = 
	`¬¿y
();

29 ià(
	`is£t
(
$Şd_node
->
$f›ld
['field_name'])) {

30 
$Şd_v®ues
 = 
	`$funùiÚ
(
$Şd_node
, 
$f›ld
, $old_node->$field['field_name']);

32 ià(
	`is£t
(
$Ãw_node
->
$f›ld
['field_name'])) {

33 
$Ãw_v®ues
 = 
	`$funùiÚ
(
$Ãw_node
, 
$f›ld
, $new_node->$field['field_name']);

35 ià(
$Şd_v®ues
 || 
$Ãw_v®ues
) {

36 
$»suÉ
[
$f›ld
['f›ld_Çme']] = 
	`¬¿y
(

37 '#Çme' => 
$f›ld
['widget']['label'],

38 '#Şd' => 
$Şd_v®ues
,

39 '#Ãw' => 
$Ãw_v®ues
,

40 '#weight' => 
$f›ld
['widget']['weight'],

41 '#fÜm©' => 
	`¬¿y
(

42 'show_h—d”' => 
FALSE
,

48  
$»suÉ
;

49 
	}
}

56 
funùiÚ
 
	$cÚ‹Á_cÚ‹Á_diff_v®ues
(
$node
, 
$f›ld
, 
$™ems
) {

57 
$»tuº
 = 
	`¬¿y
();

58 
	`fÜ—ch
 (
$™ems
 
as
 
$™em
) {

59 
	`fÜ—ch
 (
	`ex¶ode
("\n", 
$™em
['v®ue']è
as
 
$i
) {

60 
$»tuº
[] = 
$i
;

63  
$»tuº
;

64 
	}
}

66 ià(
moduË_exi¡s
('userreference')) {

70 
funùiÚ
 
u£¼eã»nû_cÚ‹Á_diff_v®ues
(
$node
, 
$f›ld
, 
$™ems
) {

71 
	g$t™Ës
 = 
¬¿y
();

73 
	g$ids
 = 
¬¿y
();

74 
fÜ—ch
 (
$™ems
 
as
 
$™em
) {

75 ià(
	g$™em
['uid'] && 
is_num”ic
(
$™em
['uid'])) {

76 
	g$ids
[] = 
$™em
['uid'];

80 
	g$qu”›d_ids
 = 
¬¿y_diff
(
$ids
, 
¬¿y_keys
(
$t™Ës
));

81 ià(
	g$qu”›d_ids
) {

82 
	g$»suÉ
 = 
db_qu”y
('SELECT uid,‚amFROM {u£rs} WHERE uid IN ('. 
db_¶aûhŞd”s
(
$qu”›d_ids
) .')', $queried_ids);

83 
	g$row
 = 
db_ãtch_¬¿y
(
$»suÉ
)) {

84 
$t™Ës
[
$row
['uid']] = $row['name'];

88 
	g$»tuº
 = 
¬¿y
();

89 
fÜ—ch
 (
$™ems
 
as
 
$™em
) {

90 ià(
	g$™em
['uid'] && 
is£t
(
$t™Ës
[
$™em
['uid']])) {

91 
	g$»tuº
[] = 
$t™Ës
[
$™em
['uid']];

94  
	g$»tuº
;

98 ià(
moduË_exi¡s
('nodereference')) {

102 
funùiÚ
 
nod”eã»nû_cÚ‹Á_diff_v®ues
(
$node
, 
$f›ld
, 
$™ems
) {

103 
	g$t™Ës
 = 
¬¿y
();

105 
	g$ids
 = 
¬¿y
();

106 
fÜ—ch
 (
$™ems
 
as
 
$™em
) {

107 ià(
	g$™em
['nid'] && 
is_num”ic
(
$™em
['nid'])) {

108 
	g$ids
[] = 
$™em
['nid'];

112 
	g$qu”›d_ids
 = 
¬¿y_diff
(
$ids
, 
¬¿y_keys
(
$t™Ës
));

113 ià(
	g$qu”›d_ids
) {

114 
	g$»suÉ
 = 
db_qu”y
('SELECT‚id,™Ë FROM {node} WHERE‚id IN ('. 
db_¶aûhŞd”s
(
$qu”›d_ids
) .')', $queried_ids);

115 
	g$row
 = 
db_ãtch_¬¿y
(
$»suÉ
)) {

116 
$t™Ës
[
$row
['nid']] = $row['title'];

120 
	g$»tuº
 = 
¬¿y
();

121 
fÜ—ch
 (
$™ems
 
as
 
$™em
) {

122 ià(
	g$™em
['nid'] && 
is£t
(
$t™Ës
[
$™em
['nid']])) {

123 
	g$»tuº
[] = 
$t™Ës
[
$™em
['nid']];

126  
	g$»tuº
;

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.node_form.inc

1 <?
php


11 
funùiÚ
 
	$cÚ‹Á_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

12 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$fÜm
['type']['#value']);

13 
	`fÜ—ch
 (
$ty³
['f›lds'] 
as
 
$f›ld_Çme
 => 
$f›ld
) {

14 
$fÜm
['#f›ld_šfo'][
$f›ld
['field_name']] = $field;

15 
$fÜm
 +ğ(
¬¿y
è
	`cÚ‹Á_f›ld_fÜm
($fÜm, 
$fÜm_¡©e
, 
$f›ld
);

17  
$fÜm
;

18 
	}
}

38 
funùiÚ
 
	$cÚ‹Á_f›ld_fÜm
(&
$fÜm
, &
$fÜm_¡©e
, 
$f›ld
, 
$g‘_d–
 = 
NULL
) {

39 
$fÜm
['#ÿche'] = 
FALSE
;

40 
$node
 = 
$fÜm
['#node'];

41 
$add™iÚ
 = 
	`¬¿y
();

42 
$fÜm_–em’t
 = 
	`¬¿y
();

43 
$f›ld_Çme
 = 
$f›ld
['field_name'];

45 
$™ems
 = 
	`¬¿y
();

49 
$funùiÚ
 = 
$f›ld
['widget']['module'] .'_widget';

50 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

57 ià(!
	`em±y
(
$fÜm_¡©e
['v®ues'][
$f›ld
['field_name']])) {

58 
$™ems
 = 
$fÜm_¡©e
['v®ues'][
$f›ld
['field_name']];

60 
	`un£t
(
$™ems
[
$f›ld
['field_name'] .'_add_more']);

62 
	`–£if
 (!
	`em±y
(
$node
->
$f›ld
['field_name'])) {

63 
$™ems
 = 
$node
->
$f›ld
['field_name'];

65 
	`–£if
 (
	`em±y
(
$node
->
nid
)) {

66 ià(
	`cÚ‹Á_ÿÎback
('widg‘', 'deçuÉ v®ue', 
$f›ld
è!ğ
CONTENT_CALLBACK_NONE
) {

71 
$ÿÎback
 = 
	`cÚ‹Á_ÿÎback
('widg‘', 'deçuÉ v®ue', 
$f›ld
è=ğ
CONTENT_CALLBACK_CUSTOM
 ? $field['widget']['module'] .'_default_value' : 'content_default_value';

72 ià(
	`funùiÚ_exi¡s
(
$ÿÎback
)) {

73 
$™ems
 = 
	`$ÿÎback
(
$fÜm
, 
$fÜm_¡©e
, 
$f›ld
, 0);

80 
$acûss
 = 
	`cÚ‹Á_acûss
('ed™', 
$f›ld
, 
NULL
, 
$node
);

81 ià(!
$acûss
) {

82 
$add™iÚ
[
$f›ld_Çme
] = 
	`¬¿y
(

83 '#acûss' => 
$acûss
,

85 '#v®ue' => 
$™ems
,

87  
$add™iÚ
;

92 ià(!
	`is£t
(
$g‘_d–
è&& 
	`cÚ‹Á_hªdË
('widg‘', 'muÉË v®ues', 
$f›ld
è=ğ
CONTENT_HANDLE_CORE
) {

93 
$fÜm_–em’t
 = 
	`cÚ‹Á_muÉË_v®ue_fÜm
(
$fÜm
, 
$fÜm_¡©e
, 
$f›ld
, 
$™ems
);

99 
$d–
 = 
	`is£t
(
$g‘_d–
) ? $get_delta : 0;

100 ià(
$–em’t
 = 
	`$funùiÚ
(
$fÜm
, 
$fÜm_¡©e
, 
$f›ld
, 
$™ems
, 
$d–
)) {

101 
$t™Ë
 = 
	`check_¶aš
(
	`t
(
$f›ld
['widget']['label']));

102 
$desütiÚ
 = 
	`cÚ‹Á_f‹r_xss
(
	`t
(
$f›ld
['widget']['description']));

103 
$deçuÉs
 = 
	`¬¿y
(

104 '#»quœed' => 
$g‘_d–
 > 0 ? 
FALSE
 : 
$f›ld
['required'],

105 '#cŞumns' => 
	`¬¿y_keys
(
$f›ld
['columns']),

106 '#t™Ë' => 
$t™Ë
,

107 '#desütiÚ' => 
$desütiÚ
,

108 '#d–' => 
$d–
,

109 '#f›ld_Çme' => 
$f›ld
['field_name'],

110 '#ty³_Çme' => 
$f›ld
['type_name'],

116 ià(
	`cÚ‹Á_hªdË
('widg‘', 'muÉË v®ues', 
$f›ld
è=ğ
CONTENT_HANDLE_CORE
) {

117 
$fÜm_–em’t
[
$d–
] = 
	`¬¿y_m”ge
(
$–em’t
, 
$deçuÉs
);

120 
$fÜm_–em’t
 = 
	`¬¿y_m”ge
(
$–em’t
, 
$deçuÉs
);

127 ià(
$fÜm_–em’t
) {

128 
$deçuÉs
 = 
	`¬¿y
(

129 '#f›ld_Çme' => 
$f›ld
['field_name'],

130 '#Œ“' => 
TRUE
,

131 '#weight' => 
$f›ld
['widget']['weight'],

132 '#acûss' => 
$acûss
,

134 '#couÁ' => 
	`couÁ
(
$fÜm_–em’t
),

136 
$add™iÚ
[
$f›ld
['f›ld_Çme']] = 
	`¬¿y_m”ge
(
$fÜm_–em’t
, 
$deçuÉs
);

139  
$add™iÚ
;

140 
	}
}

150 
funùiÚ
 
	$cÚ‹Á_muÉË_v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
, 
$f›ld
, 
$™ems
) {

151 
$f›ld_Çme
 = 
$f›ld
['field_name'];

153 
$f›ld
['multiple']) {

155 
$max
 = 0;

158 
$fËd_™ems
 = 
	`cÚ‹Á_£t_em±y
(
$f›ld
, 
$™ems
);

159 
$cu¼’t_™em_couÁ
 = 
	`is£t
(
$fÜm_¡©e
['™em_couÁ'][
$f›ld_Çme
])

160 ? 
$fÜm_¡©e
['™em_couÁ'][
$f›ld_Çme
]

161 : 
	`couÁ
(
$™ems
);

163 
$max
 = (
$cu¼’t_™em_couÁ
 > 
	`couÁ
(
$fËd_™ems
))

164 ? 
$cu¼’t_™em_couÁ
 - 1

165 : 
$cu¼’t_™em_couÁ
;

169 
$max
 = 
$f›ld
['multiple'] - 1;

173 
$t™Ë
 = 
	`check_¶aš
(
	`t
(
$f›ld
['widget']['label']));

174 
$desütiÚ
 = 
	`cÚ‹Á_f‹r_xss
(
	`t
(
$f›ld
['widget']['description']));

176 
$fÜm_–em’t
 = 
	`¬¿y
(

178 '#t™Ë' => 
$t™Ë
,

179 '#»quœed' => 
$f›ld
['required'],

180 '#desütiÚ' => 
$desütiÚ
,

182 
$funùiÚ
 = 
$f›ld
['widget']['module'] .'_widget';

184 
$d–
 = 0; $d– <ğ
$max
; $delta++) {

185 ià(
$–em’t
 = 
	`$funùiÚ
(
$fÜm
, 
$fÜm_¡©e
, 
$f›ld
, 
$™ems
, 
$d–
)) {

186 
$deçuÉs
 = 
	`¬¿y
(

187 '#t™Ë' => (
$f›ld
['muÉË'] >ğ1è? '' : 
$t™Ë
,

188 '#desütiÚ' => (
$f›ld
['muÉË'] >ğ1è? '' : 
$desütiÚ
,

189 '#»quœed' => 
$d–
 =ğ0 && 
$f›ld
['required'],

190 '#weight' => 
$d–
,

191 '#d–' => 
$d–
,

192 '#cŞumns' => 
	`¬¿y_keys
(
$f›ld
['columns']),

193 '#f›ld_Çme' => 
$f›ld_Çme
,

194 '#ty³_Çme' => 
$f›ld
['type_name'],

199 ià(
$f›ld
['multiple'] >= 1) {

202 
$–em’t
['_weight'] = 
	`¬¿y
(

204 '#d–' => 
$max
,

205 '#deçuÉ_v®ue' => 
	`is£t
(
$™ems
[
$d–
]['_weight']) ? $items[$delta]['_weight'] : $delta,

210 
$fÜm_–em’t
[
$d–
] = 
	`¬¿y_m”ge
(
$–em’t
, 
$deçuÉs
);

215 ià(
$f›ld
['muÉË'] =ğ1 && 
	`em±y
(
$fÜm
['#programmed'])) {

217 
$fÜm
['#ÿche'] = 
TRUE
;

218 
$cÚ‹Á_ty³
 = 
	`cÚ‹Á_ty³s
(
$f›ld
['type_name']);

219 
$f›ld_Çme_css
 = 
	`¡r_»¶aû
('_', '-', 
$f›ld_Çme
);

221 
$fÜm_–em’t
[
$f›ld_Çme
 .'_add_mÜe'] = 
	`¬¿y
(

223 '#Çme' => 
$f›ld_Çme
 .'_add_more',

224 '#v®ue' => 
	`t
('Add‡nother item'),

225 '#weight' => 
$f›ld
['widg‘']['weight'] + 
$max
 + 1,

229 '#subm™' => 
	`¬¿y
('content_add_more_submit_proxy'),

230 '#ahah' => 
	`¬¿y
(

231 '·th' => 'cÚ‹Á/js_add_mÜe/'. 
$cÚ‹Á_ty³
['u¾_¡r'] .'/'. 
$f›ld_Çme
,

232 'w¿µ”' => 
$f›ld_Çme_css
 .'-items',

238 '#f›ld_Çme' => 
$f›ld_Çme
,

239 '#ty³_Çme' => 
$f›ld
['type_name'],

243 
$fÜm_–em’t
['#´efix'] = '<div id="'. 
$f›ld_Çme_css
 .'-items">';

244 
$fÜm_–em’t
['#suffix'] = '</div>';

245 
$fÜm_–em’t
[
$f›ld_Çme
 .'_add_more']['#prefix'] = '<div class="content-add-more clear-block">';

246 
$fÜm_–em’t
[
$f›ld_Çme
 .'_add_more']['#suffix'] = '</div>';

248  
$fÜm_–em’t
;

249 
	}
}

256 
funùiÚ
 
	$cÚ‹Á_add_mÜe_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

258 
	`node_fÜm_subm™_bud_node
(
$fÜm
, 
$fÜm_¡©e
);

259 
$f›ld_Çme
 = 
$fÜm_¡©e
['clicked_button']['#field_name'];

260 
$ty³_Çme
 = 
$fÜm_¡©e
['clicked_button']['#type_name'];

263 ià(
$fÜm_¡©e
['v®ues'][
$f›ld_Çme
][$field_name .'_add_more']) {

264 
$fÜm_¡©e
['™em_couÁ'][
$f›ld_Çme
] = 
	`couÁ
($form_state['values'][$field_name]);

266 
	}
}

272 
funùiÚ
 
	$cÚ‹Á_add_mÜe_js
(
$ty³_Çme_u¾
, 
$f›ld_Çme
) {

273 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme_u¾
);

274 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
, 
$ty³
['type']);

276 ià((
$f›ld
['muÉË'] !ğ1è|| 
	`em±y
(
$_POST
['form_build_id'])) {

278 
	`dru·l_jsÚ
(
	`¬¿y
('data' => ''));

279 
ex™
;

283 
$fÜm_¡©e
 = 
	`¬¿y
('subm™‹d' => 
FALSE
);

284 
$fÜm_bud_id
 = 
$_POST
['form_build_id'];

285 
$fÜm
 = 
	`fÜm_g‘_ÿche
(
$fÜm_bud_id
, 
$fÜm_¡©e
);

286 ià(!
$fÜm
) {

288 
	`dru·l_jsÚ
(
	`¬¿y
('data' => ''));

289 
ex™
;

303 
$fÜm_cİy
 = 
$fÜm
;

304 
$fÜm_¡©e_cİy
 = 
$fÜm_¡©e
;

305 
$fÜm_cİy
['#po¡'] = 
	`¬¿y
();

306 
	`fÜm_bud”
(
$_POST
['fÜm_id'], 
$fÜm_cİy
, 
$fÜm_¡©e_cİy
);

308 
$fÜm_¡©e
['v®ues'] = 
$fÜm_¡©e_cİy
['values'];

310 
	`fÜm_ş—n_id
(
NULL
, 
TRUE
);

314 
	`un£t
(
$fÜm_¡©e
['v®ues'][
$f›ld_Çme
][
$f›ld
['field_name'] .'_add_more']);

315 
	`fÜ—ch
 (
$_POST
[
$f›ld_Çme
] 
as
 
$d–
 => 
$™em
) {

316 
$fÜm_¡©e
['v®ues'][
$f›ld_Çme
][
$d–
]['_weight'] = 
$™em
['_weight'];

318 
$fÜm_¡©e
['v®ues'][
$f›ld_Çme
] = 
	`_cÚ‹Á_sÜt_™ems
(
$f›ld
, $form_state['values'][$field_name]);

319 
$_POST
[
$f›ld_Çme
] = 
	`_cÚ‹Á_sÜt_™ems
(
$f›ld
, $_POST[$field_name]);

322 
$fÜm_¡©e
['™em_couÁ'] = 
	`¬¿y
(
$f›ld_Çme
 => 
	`couÁ
(
$_POST
[$field_name]) + 1);

323 
$fÜm_–em’t
 = 
	`cÚ‹Á_f›ld_fÜm
(
$fÜm
, 
$fÜm_¡©e
, 
$f›ld
);

325 
	`dru·l_®‹r
('fÜm', 
$fÜm_–em’t
, 
	`¬¿y
(), 'content_add_more_js');

328 ià(
	`moduË_exi¡s
('f›ldgroup'è&& (
$group_Çme
 = 
	`_f›ldgroup_f›ld_g‘_group
(
$ty³
['ty³'], 
$f›ld_Çme
))) {

329 
$fÜm
[
$group_Çme
][
$f›ld_Çme
] = 
$fÜm_–em’t
[$field_name];

332 
$fÜm
[
$f›ld_Çme
] = 
$fÜm_–em’t
[$field_name];

336 
$fÜm_¡©e
['v®ues'] = 
	`¬¿y
();

337 
	`fÜm_£t_ÿche
(
$fÜm_bud_id
, 
$fÜm
, 
$fÜm_¡©e
);

341 
$d–
 = 
	`max
(
	`¬¿y_keys
(
$_POST
[
$f›ld_Çme
])) + 1;

342 
$_POST
[
$f›ld_Çme
][
$d–
]['_weight'] = $delta;

343 
$fÜm_¡©e
 = 
	`¬¿y
('subm™‹d' => 
FALSE
);

344 
$fÜm
 +ğ
	`¬¿y
(

345 '#po¡' => 
$_POST
,

346 '#´og¿mmed' => 
FALSE
,

348 
$fÜm
 = 
	`fÜm_bud”
(
$_POST
['fÜm_id'], $fÜm, 
$fÜm_¡©e
);

351 
$f›ld_fÜm
 = (!
	`em±y
(
$group_Çme
)è? 
$fÜm
[$group_Çme][
$f›ld_Çme
] : $form[$field_name];

353 
$f›ld_fÜm
[
$d–
]['#´efix'] = '<div cÏss="ahah-Ãw-cÚ‹Á">'. (
	`is£t
($field_form[$delta]['#prefix']) ? $field_form[$delta]['#prefix'] : '');

354 
$f›ld_fÜm
[
$d–
]['#suffix'] = (
	`is£t
($field_form[$delta]['#suffix']) ? $field_form[$delta]['#suffix'] : '') .'</div>';

356 
	`un£t
(
$f›ld_fÜm
['#prefix'], $field_form['#suffix']);

363 
$javasüt
 = 
	`dru·l_add_js
(
NULL
, NULL);

364 
$ouut_js
 = 
	`is£t
(
$javasüt
['£‰šg']è? '<süˆty³="‹xt/javasüt">jQu”y.ex‹nd(Dru·l.£‰šgs, '. 
	`dru·l_to_js
(
	`ÿÎ_u£r_func_¬¿y
('array_merge_recursive', $javascript['setting'])) .');</script>' : '';

366 
$ouut
 = 
	`theme
('¡©us_mes§ges'è. 
	`dru·l_»nd”
(
$f›ld_fÜm
è. 
$ouut_js
;

371 
$GLOBALS
['dev–_shutdown'] = 
FALSE
;

372 
´št
 
	`dru·l_to_js
(
	`¬¿y
('¡©us' => 
TRUE
, 'd©a' => 
$ouut
));

373 
ex™
;

374 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.rules.inc

1 <?
php


12 
funùiÚ
 
	$cÚ‹Á_ruËs_aùiÚ_šfo
() {

13 
$šfo
 = 
	`¬¿y
();

14 
$šfo
['cÚ‹Á_ruËs_aùiÚ_pİuÏ‹_f›ld'] = 
	`¬¿y
(

15 'Ïb–' => 
	`t
('Populate‡ field'),

16 '¬gum’ts' => 
	`¬¿y
(

17 'node' => 
	`¬¿y
(

19 'Ïb–' => 
	`t
('Content'),

22 'ev® iÅut' => 
	`¬¿y
('code'),

23 'h–p' => 
	`t
('You should make surehathe used fieldƒxists inhe given contentype.'),

26  
$šfo
;

27 
	}
}

32 
funùiÚ
 
	$cÚ‹Á_ruËs_aùiÚ_pİuÏ‹_f›ld
(
$node
, 
$£‰šgs
, 
$–em’t
, &
$¡©e
) {

34 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$£‰šgs
['f›ld_Çme'], 
$node
->
ty³
);

35 
$v®ue
 = 
	`_cÚ‹Á_ruËs_g‘_f›ld_v®ue
(
$£‰šgs
, 
$¡©e
);

37 ià(!
	`em±y
(
$f›ld
è&& 
	`is_¬¿y
(
$v®ue
)) {

38 
$node
->
$£‰šgs
['f›ld_Çme'] = 
$v®ue
;

39  
	`¬¿y
('node' => 
$node
);

41 
	}
}

48 
funùiÚ
 
	$cÚ‹Á_ruËs_aùiÚ_pİuÏ‹_f›ld_fÜm
(
$£‰šgs
, &
$fÜm
, &
$fÜm_¡©e
) {

49 
$£‰šgs
 +ğ
	`¬¿y
('f›ld_Çme' => '', 'code' => '', 'v®ue' => 
NULL
);

50 ià(
	`em±y
(
$£‰šgs
['field_name'])) {

51 
$fÜm
['£‰šgs']['f›ld_Çme'] = 
	`¬¿y
(

53 '#t™Ë' => 
	`t
('Field'),

54 '#İtiÚs' => 
	`cÚ‹Á_ruËs_g‘_f›ld_Çmes_by_ty³
(),

55 '#deçuÉ_v®ue' => 
$£‰šgs
['field_name'],

56 '#desütiÚ' => 
	`t
('Selecthe machine-name ofhe field.'),

57 '#»quœed' => 
TRUE
,

60 
$fÜm
['Ãg©e']['#acûss'] = 
FALSE
;

61 
$fÜm
['šput_h–p']['#acûss'] = 
FALSE
;

62 
$fÜm
['weight']['#acûss'] = 
FALSE
;

65 
$fÜm
['subm™']['#subm™'] = 
	`¬¿y
('content_rules_action_populate_field_form_step_submit');

66 
$fÜm
['subm™']['#v®ue'] = 
	`t
('Continue');

70 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.node_form');

71 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$£‰šgs
['field_name']);

73 
$fÜm
['#node'] = (
objeù
)
	`¬¿y
('ty³' => '', 
$£‰šgs
['field_name'] => $settings['value']);

74 
$fÜm
['#f›ld_šfo'][
$f›ld
['field_name']] = $field;

76 
$fÜm
 +ğ(
¬¿y
è
	`cÚ‹Á_f›ld_fÜm
($fÜm, 
$fÜm_¡©e
, 
$f›ld
);

77 
$fÜm
[ 
$£‰šgs
['field_name'] ]['#weight'] = 4;

79 
	`un£t
(
$fÜm
['#cache']);

82 
$fÜm
['advªûd_İtiÚs'] = 
	`¬¿y
(

84 '#t™Ë' => 
	`t
('Advanced: Specifyhe fields value with PHP code'),

85 '#cŞÏpsibË' => 
TRUE
,

86 '#cŞÏp£d' => 
	`em±y
(
$£‰šgs
['code']),

90 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

91 
$cŞumns
 = 
	`¬¿y_keys
(
$db_šfo
['columns']);

92 
	`fÜ—ch
 (
$cŞumns
 
as
 
$key
 => 
$cŞumn
) {

93 
$cŞumns
[
$key
] = 
	`t
("'@cŞumn' => v®ufÜ @cŞumn", 
	`¬¿y
('@cŞumn' => 
$cŞumn
));

95 
$§m¶e
 = 
	`t
("»tuº‡¼ay(\À 0 =>‡¼ay(@cŞumns),\À // You'Î usu®ly wªˆtØ¡İ h”e. ProvidmÜv®ues\À // iàyou wªˆyou¸'deçuÉ v®ue'ØbmuÉi-v®ued:\À 1 =>‡¼ay(@cŞumns),\À 2 => ...\n);", 
	`¬¿y
('@cŞumns' => 
	`im¶ode
(', ', 
$cŞumns
)));

97 
$fÜm
['advªûd_İtiÚs']['code'] = 
	`¬¿y
(

99 '#t™Ë' => 
	`t
('Code'),

100 '#deçuÉ_v®ue' => 
$£‰šgs
['code'],

102 '#desütiÚ' => 
	`t
('Advªûd u§gÚly: PHP codth©„‘uº thv®utØ£t. Should‚Ù inşud&É;?ph°?&gt; d–im™”s. Iàthi f›ld i fËd out,hv®u»tuºed byhi codwÈov”ridªy v®u¥ecif›d‡bove. Ex³ùed fÜm©: <´e>!§m¶e</´e>Usšg <¨h»f="@lšk_dev–">dev–.moduË\'s</a> \'dev–†ßd\'ab oÀ¨cÚ‹Á…agmighˆh–°you figu» ouˆthex³ùed fÜm©.', 
	`¬¿y
(

103 '!§m¶e' => 
$§m¶e
,

111 
$fÜm
['#šşudes'][] = './'. 
	`dru·l_g‘_·th
('module', 'node') .'/node.pages.inc';

113 
	}
}

115 
funùiÚ
 
	$cÚ‹Á_ruËs_aùiÚ_pİuÏ‹_f›ld_fÜm_¡•_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

116 
$fÜm_¡©e
['element']['#settings']['field_name'] = $form_state['values']['settings']['field_name'];

117 
	}
}

122 
funùiÚ
 
	$cÚ‹Á_ruËs_aùiÚ_pİuÏ‹_f›ld_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

123 ià(!
	`is£t
(
$fÜm_¡©e
['element']['#settings']['field_name'])) {

128 ià(
	`is£t
(
$fÜm_¡©e
['v®ues']['code']è&& (
$php
 = $form_state['values']['code'])) {

129 ià(
	`¡½os
(
$php
, '»tuº'è==ğ
FALSE
) {

130 
	`fÜm_£t_”rÜ
('code', 
	`t
('You haveo„eturnhe default value inheƒxpected format.'));

135 
$£‰šgs
 = 
$fÜm_¡©e
['element']['#settings'];

136 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$£‰šgs
['field_name']);

137 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

138 
$funùiÚ
 = 
$f›ld_ty³s
[
$f›ld
['type']]['module'] .'_field';

139 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

140 
$fÜm
['#node'] = (
objeù
)
	`¬¿y
('ty³' => '', 
$£‰šgs
['f›ld_Çme'] => 
$fÜm_¡©e
['values'][$settings['field_name']]);

141 
$™ems
 = 
	`is£t
(
$fÜm
['#node']->
$f›ld
['f›ld_Çme']è? $fÜm['#node']->$f›ld['f›ld_Çme'] : 
	`¬¿y
();

145 
	`un£t
(
$™ems
[
$f›ld
['field_name'] .'_add_more']);

147 
	`$funùiÚ
('v®id©e', 
$fÜm
['#node'], 
$f›ld
, 
$™ems
, $fÜm, 
NULL
);

148 
	`cÚ‹Á_f›ld
('v®id©e', 
$fÜm
['#node'], 
$f›ld
, 
$™ems
, $fÜm, 
NULL
);

151 
	}
}

153 
funùiÚ
 
	$cÚ‹Á_ruËs_aùiÚ_pİuÏ‹_f›ld_subm™
(&
$£‰šgs
, 
$fÜm
, &
$fÜm_¡©e
) {

155 
$£‰šgs
['v®ue'] = 
	`¬¿y_f‹r
(
$fÜm_¡©e
['values'][$settings['field_name']], 'is_array');

157 
	`fÜ—ch
 (
$£‰šgs
['v®ue'] 
as
 
$key
 => 
$d©a
) {

158 
	`fÜ—ch
 (
	`¬¿y_f‹r
(
	`¬¿y_keys
(
$d©a
)è
as
 
$cŞ
) {

159 ià(
$cŞ
[0] == '_') {

160 
	`un£t
(
$£‰šgs
['v®ue'][
$key
][
$cŞ
]);

163 ià(
$key
 && 
	`couÁ
(
	`¬¿y_f‹r
(
$£‰šgs
['value'][$key])) == 0) {

165 
	`un£t
(
$£‰šgs
['v®ue'][
$key
]);

169 
$£‰šgs
['code'] = 
$fÜm_¡©e
['values']['code'];

171 ià(
	`funùiÚ_exi¡s
('rules_action_custom_php_submit')) {

173 
	`ruËs_aùiÚ_cu¡om_php_subm™
(
$£‰šgs
, 
$fÜm
, 
$fÜm_¡©e
);

178 
$Çmes
 = 
	`¬¿y
('code');

180 
	`fÜ—ch
 (
$£‰šgs
['v®ue'] 
as
 
$key
 => 
$d©a
) {

181 
	`fÜ—ch
 (
	`¬¿y_f‹r
(
$d©a
, 'is_¡ršg'è
as
 
$cŞ
 => 
$v®ue
) {

182 
$Çmes
[] = "value|$key|$col";

185 
$fÜm_¡©e
['–em’t']['#šfo']['ev® iÅut'] = 
$Çmes
;

186 
	}
}

192 
funùiÚ
 
	$cÚ‹Á_ruËs_aùiÚ_pİuÏ‹_f›ld_Ïb–
(
$£‰šgs
, 
$¬gum’t_Ïb–s
) {

193  
	`t
("PİuÏ‹ @node' f›ld '@f›ld'", 
	`¬¿y
('@f›ld' => 
$£‰šgs
['f›ld_Çme']è+ 
$¬gum’t_Ïb–s
);

194 
	}
}

196 
funùiÚ
 
	$wÜkæow_ng_aùiÚ_pİuÏ‹_f›ld_upg¿de
(&
$–em’t
) {

197 
$–em’t
['#name'] = 'content_rules_action_populate_field';

198 
$–em’t
['#settings']['code'] = $element['#settings']['default_value_php'];

199 
$–em’t
['#£‰šgs'][$–em’t['#£‰šgs']['f›ld_Çme']] = 
	`¬¿y
();

200 
	`un£t
(
$–em’t
['#settings']['default_value_php']);

201 
	}
}

207 
funùiÚ
 
	$cÚ‹Á_ruËs_cÚd™iÚ_šfo
() {

208 
$šfo
 = 
	`¬¿y
();

209 
$šfo
['cÚ‹Á_ruËs_f›ld_has_v®ue'] = 
	`¬¿y
(

210 'Ïb–' => 
	`t
('Field has value'),

211 '¬gum’ts' => 
	`¬¿y
(

212 'node' => 
	`¬¿y
('ty³' => 'node', 'Ïb–' => 
	`t
('Content')),

214 'ev® iÅut' => 
	`¬¿y
('code'),

215 'h–p' => 
	`t
('You should make surehathe used fieldƒxists inhe given contentype. The condition„eturns TRUE, ifhe selected field hashe given value.'),

218 
$šfo
['cÚ‹Á_ruËs_f›ld_chªged'] = 
	`¬¿y
(

219 'Ïb–' => 
	`t
('Field has changed'),

220 '¬gum’ts' => 
	`¬¿y
(

221 'node' => 
	`¬¿y
('ty³' => 'node', 'Ïb–' => 
	`t
('Content containing changes')),

222 'node_unchªged' => 
	`¬¿y
('ty³' => 'node', 'Ïb–' => 
	`t
('Content‚ot containing changes')),

224 'h–p' => 
	`t
('You should make surehathe used fieldƒxists inhe given contentype.'),

227  
$šfo
;

228 
	}
}

233 
funùiÚ
 
	$cÚ‹Á_ruËs_f›ld_has_v®ue
(
$node
, 
$£‰šgs
) {

235 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$£‰šgs
['f›ld_Çme'], 
$node
->
ty³
);

236 
$v®ue
 = 
	`_cÚ‹Á_ruËs_g‘_f›ld_v®ue
(
$£‰šgs
, 
$¡©e
);

238 ià(
	`em±y
(
$f›ld
è|| !
	`is_¬¿y
(
$v®ue
)) {

239  
FALSE
;

242  
	`_cÚ‹Á_ruËs_f›ld_has_v®ue
(
$node
->
$£‰šgs
['f›ld_Çme'], 
$v®ue
);

243 
	}
}

248 
funùiÚ
 
	$cÚ‹Á_ruËs_f›ld_has_v®ue_fÜm
(
$£‰šgs
, &
$fÜm
, &
$fÜm_¡©e
) {

249 
	`cÚ‹Á_ruËs_aùiÚ_pİuÏ‹_f›ld_fÜm
(
$£‰šgs
, 
$fÜm
, 
$fÜm_¡©e
);

250 
	}
}

251 
funùiÚ
 
	$cÚ‹Á_ruËs_f›ld_has_v®ue_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

252 
	`cÚ‹Á_ruËs_aùiÚ_pİuÏ‹_f›ld_v®id©e
(
$fÜm
, 
$fÜm_¡©e
);

253 
	}
}

254 
funùiÚ
 
	$cÚ‹Á_ruËs_f›ld_has_v®ue_subm™
(&
$£‰šgs
, 
$fÜm
, &
$fÜm_¡©e
) {

255 
	`cÚ‹Á_ruËs_aùiÚ_pİuÏ‹_f›ld_subm™
(
$£‰šgs
, 
$fÜm
, 
$fÜm_¡©e
);

256 
	}
}

258 
funùiÚ
 
	$cÚ‹Á_ruËs_f›ld_has_v®ue_Ïb–
(
$£‰šgs
, 
$¬gum’t_Ïb–s
) {

259  
	`t
("@node' f›ld '@f›ld' ha v®ue", 
	`¬¿y
('@f›ld' => 
$£‰šgs
['f›ld_Çme']è+ 
$¬gum’t_Ïb–s
);

260 
	}
}

265 
funùiÚ
 
	$cÚ‹Á_ruËs_f›ld_chªged
(
$node1
, 
$node2
, 
$£‰šgs
) {

267 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$£‰šgs
['f›ld_Çme'], 
$node1
->
ty³
);

269  !
	`em±y
(
$f›ld
è&& !
	`_cÚ‹Á_ruËs_f›ld_has_v®ue
(
$node1
->
$£‰šgs
['f›ld_Çme'], 
$node2
->$settings['field_name']);

270 
	}
}

272 
funùiÚ
 
	$cÚ‹Á_ruËs_f›ld_chªged_fÜm
(
$£‰šgs
, &
$fÜm
, &
$fÜm_¡©e
) {

273 
$£‰šgs
 +ğ
	`¬¿y
('field_name' => '');

274 
$fÜm
['£‰šgs']['f›ld_Çme'] = 
	`¬¿y
(

276 '#t™Ë' => 
	`t
('Field'),

277 '#İtiÚs' => 
	`cÚ‹Á_ruËs_g‘_f›ld_Çmes_by_ty³
(),

278 '#deçuÉ_v®ue' => 
$£‰šgs
['field_name'],

279 '#desütiÚ' => 
	`t
('Selecthe machine-name ofhe fieldo†ook‡t.'),

280 '#»quœed' => 
TRUE
,

282 
	}
}

284 
funùiÚ
 
	$cÚ‹Á_ruËs_f›ld_chªged_Ïb–
(
$£‰šgs
, 
$¬gum’t_Ïb–s
) {

285  
	`t
("@node' f›ld '@f›ld' ha b“Àchªged", 
	`¬¿y
('@f›ld' => 
$£‰šgs
['f›ld_Çme']è+ 
$¬gum’t_Ïb–s
);

286 
	}
}

293 
funùiÚ
 
	$cÚ‹Á_ruËs_g‘_f›ld_Çmes_by_ty³
(
$ty³
 = 
NULL
) {

294 
$f›lds
 = 
	`¬¿y
();

295 
	`fÜ—ch
 (
	`cÚ‹Á_f›lds
(è
as
 
$f›ld
) {

296 ià(!
	`is£t
(
$ty³
è|| 
$f›ld
['type'] == $type) {

297 
$f›lds
[
$f›ld
['field_name']] = $field['field_name'];

300 
	`asÜt
(
$f›lds
);

301  
$f›lds
;

302 
	}
}

304 
funùiÚ
 
	$_cÚ‹Á_ruËs_g‘_f›ld_v®ue
(
$£‰šgs
, &
$¡©e
) {

305 ià(
$£‰šgs
['code']) {

306 ià(
	`funùiÚ_exi¡s
('rules_input_evaluator_php_apply')) {

308 
$v®ue
 = 
	`ruËs_šput_ev®u©Ü_php_­¶y
(
$£‰šgs
['code'], $£‰šgs['v¬s'], 
$¡©e
, 
FALSE
);

311 
	`ob_¡¬t
();

312 
$v®ue
 = 
	`ev®
(
$£‰šgs
['code']);

313 
	`ob_’d_ş—n
();

317 
$v®ue
 = 
$£‰šgs
['value'];

319  
$v®ue
;

320 
	}
}

331 
funùiÚ
 
	$_cÚ‹Á_ruËs_f›ld_has_v®ue
(
$node_v®ue
, 
$v®ue
) {

332 ià(
	`couÁ
(
$v®ue
è!ğcouÁ(
$node_v®ue
)) {

333  
FALSE
;

336 
	`fÜ—ch
 (
$v®ue
 
as
 
$d–
 => 
$sub_v®ue
) {

338 ià(
	`is_¬¿y
(
$sub_v®ue
è&& is_¬¿y(
$node_v®ue
[
$d–
])) {

339 ià(
	`couÁ
(
	`¬¿y_diff_assoc
(
$sub_v®ue
, 
$node_v®ue
[
$d–
])) != 0) {

340  
FALSE
;

343 
	`–£if
 (
$sub_v®ue
 !=ğ
$node_v®ue
[
$d–
]) {

344  
FALSE
;

347  
TRUE
;

348 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.token.inc

1 <?
php


9 
funùiÚ
 
	$tok’_cÚ‹Á_bud_modes
() {

10  
	`¬¿y
(

11 'tok’' => 
	`¬¿y
(

12 't™Ë' => 
	`t
('Token'),

13 'bud modes' => 
	`¬¿y
(

14 'tok’' => 
	`¬¿y
(

15 't™Ë' => 
	`t
('Token'),

16 'v›w ¡yË' => 
FALSE
,

21 
	}
}

24 
funùiÚ
 
	$cÚ‹Á_tok’_v®ues
(
$ty³
, 
$objeù
 = 
NULL
) {

25 
$tok’s
 = 
	`¬¿y
();

26 ià(
$ty³
 == 'node') {

27 
$node
 = 
$objeù
;

29 ià(
	`is£t
(
$node
->
ty³
)) {

30 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$node
->
ty³
);

31 
$node
->
bud_mode
 = 'token';

32 
$node
->
cÚ‹Á
 = 
	`¬¿y
();

33 
	`cÚ‹Á_v›w
(
$node
);

35 
	`dru·l_»nd”
(
$node
->
cÚ‹Á
);

36 
	`cÚ‹Á_®‹r
(
$node
);

38 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

39 
	`fÜ—ch
 (
$ty³
['f›lds'] 
as
 
$f›ld
) {

40 
$™ems
 = 
$node
->{
$f›ld
['field_name']};

41 
$funùiÚ
 = 
$f›ld_ty³s
[
$f›ld
['type']]['module'] . '_token_values';

42 ià(!
	`em±y
(
$™ems
è&& 
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

43 
$tok’_v®ues
 = 
	`$funùiÚ
('f›ld', 
$™ems
);

44 
	`fÜ—ch
 (
$tok’_v®ues
 
as
 
$tok’
 => 
$v®ue
) {

45 
$tok’s
[
$f›ld
['f›ld_Çme'] .'-'. 
$tok’
] = 
$v®ue
;

51  
$tok’s
;

52 
	}
}

54 
funùiÚ
 
cÚ‹Á_tok’_li¡
(
$ty³
 = 'all') {

55 ià(
$ty³
 == 'node' || $type == 'all') {

56 
$li¡
 = 
¬¿y
();

57 
	g$f›ld_ty³s
 = 
_cÚ‹Á_f›ld_ty³s
();

59 
fÜ—ch
 (
cÚ‹Á_f›lds
(è
as
 
$f›ld
) {

60 
	g$sub_li¡
 = 
¬¿y
();

61 
	g$funùiÚ
 = 
$f›ld_ty³s
[
$f›ld
['type']]['module'] . '_token_list';

62 ià(
funùiÚ_exi¡s
(
$funùiÚ
)) {

63 
	g$sub_li¡
 = 
$funùiÚ
('field');

64 
fÜ—ch
 (
$sub_li¡
 
as
 
$ÿ‹gÜy
 => 
$tok’_li¡
) {

65 
fÜ—ch
 (
$tok’_li¡
 
as
 
$tok’
 => 
$desütiÚ
) {

66 
$li¡
['CCK '. 
$ÿ‹gÜy
][
$f›ld
['f›ld_Çme'] .'-'. 
$tok’
] = 
$desütiÚ
;

72  
	g$li¡
;

76 ià(
moduË_exi¡s
('nodereference')) {

77 
funùiÚ
 
nod”eã»nû_tok’_li¡
(
$ty³
 = 'all') {

78 ià(
$ty³
 == 'field' || $type == 'all') {

79 
$tok’s
 = 
¬¿y
();

81 
	g$tok’s
['nod»ã»nû']['nid'] = 
t
('Referenced‚ode ID');

82 
	g$tok’s
['nod»ã»nû']['t™Ë'] = 
t
('Referenced‚odeitle');

83 
	g$tok’s
['nod»ã»nû']['t™Ë-¿w'] = 
t
('Referenced‚ode unfiltereditle. WARNING -„aw user input.');

84 
	g$tok’s
['nod»ã»nû']['lšk'] = 
t
("Formatted html†inkohe„eferenced‚ode.");

85 
	g$tok’s
['nod»ã»nû']['·th'] = 
t
("Relative…ath‡liasohe„eferenced‚ode.");

86 
	g$tok’s
['nod»ã»nû']['u¾'] = 
t
("Absolute…ath‡liasohe„eferenced‚ode.");

88  
	g$tok’s
;

92 
funùiÚ
 
nod”eã»nû_tok’_v®ues
(
$ty³
, 
$objeù
 = 
NULL
) {

93 ià(
$ty³
 == 'field') {

94 
$™em
 = 
$objeù
[0];

96 
	g$t™Ë
 = 
is_num”ic
(
$™em
['nid']è? 
_nod”eã»nû_t™Ës
($item['nid']) : '';

97 
	g$tok’s
['nid'] = 
$™em
['nid'];

98 
	g$tok’s
['t™Ë'] = 
$t™Ë
 ? 
check_¶aš
($title) : '';

99 
	g$tok’s
['t™Ë-¿w'] = 
$t™Ë
;

100 
	g$tok’s
['lšk'] = 
is£t
(
$™em
['view']) ? $item['view'] : '';

101 
	g$tok’s
['·th'] = 
is_num”ic
(
$™em
['nid']è? 
u¾
('node/' . $item['nid']) : '';

102 
	g$tok’s
['u¾'] = 
is_num”ic
(
$™em
['nid']è? 
u¾
('node/' . $™em['nid'], 
¬¿y
('absŞu‹' => 
TRUE
)) : '';

104  
	g$tok’s
;

109 ià(
moduË_exi¡s
('number')) {

110 
funùiÚ
 
numb”_tok’_li¡
(
$ty³
 = 'all') {

111 ià(
$ty³
 == 'field' || $type == 'all') {

112 
$tok’s
 = 
¬¿y
();

114 
	g$tok’s
['numb”']['¿w'] = 
t
('Raw‚umber value');

115 
	g$tok’s
['numb”']['fÜm©‹d'] = 
t
('Formatted‚umber value');

117  
	g$tok’s
;

121 
funùiÚ
 
numb”_tok’_v®ues
(
$ty³
, 
$objeù
 = 
NULL
) {

122 ià(
$ty³
 == 'field') {

123 
$™em
 = 
$objeù
[0];

125 
	g$tok’s
['¿w'] = 
$™em
['value'];

126 
	g$tok’s
['fÜm©‹d'] = 
is£t
(
$™em
['view']) ? $item['view'] : '';

128  
	g$tok’s
;

133 ià(
moduË_exi¡s
('text')) {

134 
funùiÚ
 
‹xt_tok’_li¡
(
$ty³
 = 'all') {

135 ià(
$ty³
 == 'field' || $type == 'all') {

136 
$tok’s
 = 
¬¿y
();

138 
	g$tok’s
['‹xt']['¿w'] = 
t
('Raw, unfilteredext');

139 
	g$tok’s
['‹xt']['fÜm©‹d'] = 
t
('Formatted‡nd filteredext');

141  
	g$tok’s
;

145 
funùiÚ
 
‹xt_tok’_v®ues
(
$ty³
, 
$objeù
 = 
NULL
) {

146 ià(
$ty³
 == 'field') {

147 
$™em
 = 
$objeù
[0];

149 
	g$tok’s
['¿w'] = 
$™em
['value'];

150 
	g$tok’s
['fÜm©‹d'] = 
is£t
(
$™em
['view']) ? $item['view'] : '';

151  
	g$tok’s
;

156 ià(
moduË_exi¡s
('userreference')) {

157 
funùiÚ
 
u£¼eã»nû_tok’_li¡
(
$ty³
 = 'all') {

158 ià(
$ty³
 == 'field' || $type == 'all') {

159 
$tok’s
 = 
¬¿y
();

161 
	g$tok’s
['u£¸»ã»nû']['uid'] = 
t
('Referenced user ID');

162 
	g$tok’s
['u£¸»ã»nû']['Çme'] = 
t
('Referenced user‚ame');

163 
	g$tok’s
['u£¸»ã»nû']['lšk'] = 
t
('Formatted HTML†inko„eferenced user');

164 
	g$tok’s
['u£¸»ã»nû']['·th'] = 
t
("Relative…ath‡liasohe„eferenced user.");

165 
	g$tok’s
['u£¸»ã»nû']['u¾'] = 
t
("Absolute…ath‡liasohe„eferenced user.");

167  
	g$tok’s
;

171 
funùiÚ
 
u£¼eã»nû_tok’_v®ues
(
$ty³
, 
$objeù
 = 
NULL
) {

172 ià(
$ty³
 == 'field') {

173 
$™em
 = 
$objeù
[0];

175 
	g$tok’s
['uid'] = 
$™em
['uid'];

176 
	g$tok’s
['Çme'] = 
is£t
(
$™em
['v›w']è? 
¡r_gs
($item['view']) : '';

177 
	g$tok’s
['lšk'] = 
is£t
(
$™em
['view']) ? $item['view'] : '';

178 
	g$tok’s
['·th'] = 
is_num”ic
(
$™em
['uid']è? 
u¾
('user/' . $item['uid']) : '';

179 
	g$tok’s
['u¾'] = 
is_num”ic
(
$™em
['uid']è? 
u¾
('u£r/' . $™em['uid'], 
¬¿y
('absŞu‹' => 
TRUE
)) : '';

181  
	g$tok’s
;

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/panels/content_types/content_field.inc

1 <?
php


12 
funùiÚ
 
	$cÚ‹Á_cÚ‹Á_f›ld_ùoŞs_cÚ‹Á_ty³s
() {

13  
	`¬¿y
(

14 't™Ë' => 
	`t
('Content field'),

15 'deçuÉs' => 
	`¬¿y
('label' => '', 'formatter' => ''),

18 
	}
}

23 
funùiÚ
 
	$cÚ‹Á_cÚ‹Á_f›ld_cÚ‹Á_ty³_cÚ‹Á_ty³s
() {

25 
$ty³s
 = 
	`¬¿y
();

28 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

30 
	`fÜ—ch
 (
	`cÚ‹Á_ty³s
(è
as
 
$ty³_Çme
 => 
$ty³
) {

31 
	`fÜ—ch
 (
$ty³
['f›lds'] 
as
 
$f›ld_Çme
 => 
$f›ld
) {

32 ià(!
	`is£t
(
$ty³s
[
$f›ld_Çme
])) {

33 
$ty³s
[
$f›ld_Çme
] = 
	`¬¿y
(

34 'ÿ‹gÜy' => 
	`t
('Node'),

36 't™Ë' => 
	`t
('F›ld: @widg‘_Ïb– (@f›ld_Çmeè- @f›ld_ty³', 
	`¬¿y
(

37 '@widg‘_Ïb–' => 
	`t
(
$f›ld
['widget']['label']),

38 '@f›ld_Çme' => 
$f›ld_Çme
,

39 '@f›ld_ty³' => 
	`t
(
$f›ld_ty³s
[
$f›ld
['type']]['label']),

41 'desütiÚ' => 
	`t
('Field onhe„eferenced‚ode.'),

42 'ty³s' => 
	`¬¿y
(),

44 ià(
	`is£t
(
$f›ld_ty³s
[
$f›ld
['type']]['content_icon'])) {

45 
$ty³s
[
$f›ld_Çme
]['icÚ'] = 
$f›ld_ty³s
[
$f›ld
['type']]['content_icon'];

48 
$ty³s
[
$f›ld_Çme
]['ty³s'][
$ty³_Çme
] = 
$ty³
['name'];

53 
	`fÜ—ch
 (
$ty³s
 
as
 
$f›ld_Çme
 => 
$f›ld_cÚ‹Á_ty³
) {

54 
$ty³s
[
$f›ld_Çme
]['»quœed cÚ‹xt'] = 
Ãw
 
	`ùoŞs_cÚ‹xt_»quœed
(
	`t
('Node'), 'node', 
	`¬¿y
(

55 'ty³' => 
	`¬¿y_keys
(
$ty³s
[
$f›ld_Çme
]['types']),

57 
	`un£t
(
$ty³s
[
$f›ld_Çme
]['types']);

60  
$ty³s
;

61 
	}
}

70 
funùiÚ
 
	$cÚ‹Á_cÚ‹Á_f›ld_cÚ‹Á_ty³_cÚ‹Á_ty³
(
$subty³
) {

73 ià(
	`¡½os
(
$subty³
, ':'è!=ğ
FALSE
) {

74 
	`li¡
(
$cÚ‹Á_ty³
, 
$subty³
èğ
	`ex¶ode
(':', $subtype, 2);

77 
$ty³s
 = 
	`cÚ‹Á_cÚ‹Á_f›ld_cÚ‹Á_ty³_cÚ‹Á_ty³s
();

78 ià(
	`is£t
(
$ty³s
[
$subty³
])) {

79  
$ty³s
[
$subty³
];

81 
	}
}

86 
funùiÚ
 
	$cÚ‹Á_cÚ‹Á_f›ld_cÚ‹Á_ty³_»nd”
(
$subty³
, 
$cÚf
, 
$·Ãl_¬gs
, 
$cÚ‹xt
) {

89 ià(
	`¡½os
(
$subty³
, ':'è!=ğ
FALSE
) {

90 
	`li¡
(
$cÚ‹Á_ty³
, 
$subty³
èğ
	`ex¶ode
(':', $subtype, 2);

93 ià(
	`is_¬¿y
(
$cÚ‹xt
)) {

94 
$cÚ‹xt
 = 
	`¬¿y_pİ
($context);

97 ià(!
	`is£t
(
$cÚ‹xt
->
d©a
)) {

100 
$node
 = 
	`dru·l_şÚe
(
$cÚ‹xt
->
d©a
);

104 
$f›ld_Çme
 = 
$subty³
;

105 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
, 
$node
->
ty³
);

108 
$fÜm©‹r
 = 
$cÚf
['formatter'];

111 ià(!
	`cÚ‹Á_acûss
('v›w', 
$f›ld
, 
NULL
, 
$node
)) {

116 
$f›ld
['di¥Ïy_£‰šgs']['Ïb–']['fÜm©'] = 
$cÚf
['Ïb–'] =ğ'nÜm®' || !
	`em±y
($conf['override_title']) ? 'hidden' : $conf['label'];

117 
$f›ld
['di¥Ïy_£‰šgs']['fuÎ']['fÜm©'] = 
$fÜm©‹r
;

118 
$node
->
bud_mode
 = 
NODE_BUILD_NORMAL
;

121 
$ouut
 = 
	`cÚ‹Á_v›w_f›ld
(
$f›ld
, 
$node
);

123 
$block
 = 
Ãw
 
	`¡dCÏss
();

124 
$block
->
moduË
 = 'content';

125 
$block
->
d–
 = 
$f›ld_Çme
;

126 ià(
$cÚf
['label'] == 'normal') {

127 
$block
->
t™Ë
 = 
	`t
(
$f›ld
['widget']['label']);

129 
$block
->
cÚ‹Á
 = 
$ouut
;

131  
$block
;

132 
	}
}

137 
funùiÚ
 
	$cÚ‹Á_cÚ‹Á_f›ld_cÚ‹Á_ty³_ed™_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

138 
$cÚf
 = 
$fÜm_¡©e
['conf'];

140 
$fÜm
['Ïb–'] = 
	`¬¿y
(

142 '#t™Ë' => 
	`t
('Field†abel'),

143 '#deçuÉ_v®ue' => 
	`is£t
(
$cÚf
['label']) ? $conf['label'] : '',

144 '#İtiÚs' => 
	`¬¿y
(

145 'nÜm®' => 
	`t
('Blockitle'),

146 'above' => 
	`t
('Above'),

147 'šlše' => 
	`t
('Inline'),

149 '#desütiÚ' => 
	`t
('Configure howhe†abel is goingo be displayed. This optionakes‚oƒffect when "Overrideitle" option isƒnabled,he specified blockitle is displayed instead.'),

153 
$f›ld_Çme
 = 
$fÜm_¡©e
['subtype_name'];

157 ià(
	`¡½os
(
$f›ld_Çme
, ':'è!=ğ
FALSE
) {

158 
	`li¡
(
$cÚ‹Á_ty³
, 
$f›ld_Çme
èğ
	`ex¶ode
(':', $field_name, 2);

162 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
);

165 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

168 
$ty³_šfo
 = 
$f›ld_ty³s
[
$f›ld
['type']];

171 
$İtiÚs
 = 
	`¬¿y
();

172 
	`fÜ—ch
 (
$ty³_šfo
['fÜm©‹rs'] 
as
 
$fÜm©‹r_Çme
 => 
$fÜm©‹r
) {

173 
$İtiÚs
[
$fÜm©‹r_Çme
] = 
$fÜm©‹r
['label'];

176 
$fÜm
['fÜm©‹r'] = 
	`¬¿y
(

178 '#t™Ë' => 
	`t
('Field formatter'),

179 '#deçuÉ_v®ue' => 
	`is£t
(
$cÚf
['formatter']) ? $conf['formatter'] : 'default',

180 '#İtiÚs' => 
$İtiÚs
,

181 '#desütiÚ' => 
	`t
('Select‡ formatter.'),

182 '#»quœed' => 
TRUE
,

184 
	}
}

186 
funùiÚ
 
	$cÚ‹Á_cÚ‹Á_f›ld_cÚ‹Á_ty³_ed™_fÜm_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

188 
	`fÜ—ch
 (
	`¬¿y_keys
(
$fÜm_¡©e
['¶ugš']['deçuÉs']è
as
 
$key
) {

189 
$fÜm_¡©e
['cÚf'][
$key
] = $form_state['values'][$key];

191 
	}
}

196 
funùiÚ
 
	$cÚ‹Á_cÚ‹Á_f›ld_cÚ‹Á_ty³_admš_t™Ë
(
$subty³
, 
$cÚf
, 
$cÚ‹xt
) {

199 ià(
	`¡½os
(
$subty³
, ':'è!=ğ
FALSE
) {

200 
	`li¡
(
$cÚ‹Á_ty³
, 
$subty³
èğ
	`ex¶ode
(':', $subtype, 2);

204 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

207 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$subty³
);

209  
	`t
('"@s" f›ld: @widg‘_Ïb– (@f›ld_Çmeè- @f›ld_ty³', 
	`¬¿y
(

210 '@s' => 
$cÚ‹xt
->
id’tif›r
,

211 '@widg‘_Ïb–' => 
	`t
(
$f›ld
['widget']['label']),

212 '@f›ld_Çme' => 
$subty³
,

213 '@f›ld_ty³' => 
	`t
(
$f›ld_ty³s
[
$f›ld
['type']]['label']),

215 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/content.views.inc

1 <?
php


13 
moduË_lßd_šşude
('inc', 'views', 'modules/node.views');

18 
funùiÚ
 
	$cÚ‹Á_v›ws_hªdËrs
() {

19  
	`¬¿y
(

20 'šfo' => 
	`¬¿y
(

21 '·th' => 
	`dru·l_g‘_·th
('module', 'content') . '/includes/views/handlers',

23 'hªdËrs' => 
	`¬¿y
(

26 'cÚ‹Á_hªdËr_¬gum’t' => 
	`¬¿y
(

29 'cÚ‹Á_hªdËr_¬gum’t_¡ršg' => 
	`¬¿y
(

32 'cÚ‹Á_hªdËr_¬gum’t_num”ic' => 
	`¬¿y
(

35 'cÚ‹Á_hªdËr_¬gum’t_»ã»nû' => 
	`¬¿y
(

38 'cÚ‹Á_hªdËr_¬gum’t_mªy_to_Úe' => 
	`¬¿y
(

43 'cÚ‹Á_hªdËr_f›ld' => 
	`¬¿y
(

46 'cÚ‹Á_hªdËr_f›ld_muÉË' => 
	`¬¿y
(

51 'cÚ‹Á_hªdËr_f‹r_¡ršg' => 
	`¬¿y
(

54 'cÚ‹Á_hªdËr_f‹r_num”ic' => 
	`¬¿y
(

57 'cÚ‹Á_hªdËr_f‹r_æßt' => 
	`¬¿y
(

60 'cÚ‹Á_hªdËr_f‹r_mªy_to_Úe' => 
	`¬¿y
(

65 'cÚ‹Á_hªdËr_»ÏtiÚsh' => 
	`¬¿y
(

70 'cÚ‹Á_hªdËr_sÜt' => 
	`¬¿y
(

75 
	}
}

83 
funùiÚ
 
	$cÚ‹Á_v›ws_¶ugšs
() {

84 
$¶ugšs
 = 
	`¬¿y
(

86 'di¥Ïy' => 
	`¬¿y
(

87 'cÚ‹Á_sim¶e' => 
	`¬¿y
(

88 '·th' => 
	`dru·l_g‘_·th
('module', 'content') . '/includes/views/handlers',

94 'nØui' => 
TRUE
,

95 'u£ hook m’u' => 
FALSE
,

96 'u£‡jax' => 
FALSE
,

97 'u£…ag”' => 
FALSE
,

98 'acû±‡‰achm’ts' => 
FALSE
,

100 'cÚ‹Á_»ã»nûs' => 
	`¬¿y
(

101 '·th' => 
	`dru·l_g‘_·th
('module', 'content') . '/includes/views/handlers',

108 'nØui' => 
TRUE
,

109 'u£ hook m’u' => 
FALSE
,

110 'u£‡jax' => 
FALSE
,

111 'u£…ag”' => 
FALSE
,

112 'acû±‡‰achm’ts' => 
FALSE
,

115 '¡yË' => 
	`¬¿y
(

116 'cÚ‹Á_php_¬¿y_autocom¶‘e' => 
	`¬¿y
(

117 '·th' => 
	`dru·l_g‘_·th
('module', 'content') . '/includes/views/handlers',

123 'nØui' => 
TRUE
,

124 'u£ row…lugš' => 
TRUE
,

125 'u£ f›lds' => 
TRUE
,

127 'ev’ƒm±y' => 
TRUE
,

131  
$¶ugšs
;

132 
	}
}

139 
funùiÚ
 
	$cÚ‹Á_v›ws_d©a
() {

140 
$d©a
 = 
	`¬¿y
();

141 
	`fÜ—ch
 (
	`cÚ‹Á_f›lds
(è
as
 
$f›ld
) {

142 
$moduË
 = 
$f›ld
['module'];

143 
$»suÉ
 = (
¬¿y
è
	`moduË_švoke
(
$moduË
, 'f›ld_£‰šgs', 'v›w d©a', 
$f›ld
);

144 
	`dru·l_®‹r
('f›ld_£‰šgs', 
$»suÉ
, 'v›w d©a', 
$f›ld
);

145 ià(
	`em±y
(
$»suÉ
)) {

146 
$»suÉ
 = 
	`cÚ‹Á_v›ws_f›ld_v›ws_d©a
(
$f›ld
);

148 ià(
	`is_¬¿y
(
$»suÉ
)) {

149 
$d©a
 = 
	`¬¿y_m”ge
($d©a, 
$»suÉ
);

152  
$d©a
;

153 
	}
}

156 
funùiÚ
 
	$cÚ‹Á_v›ws_f›ld_v›ws_d©a
(
$f›ld
) {

157 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

161 ià(
	`is£t
(
$f›ld_ty³s
[
$f›ld
['type']])) {

162 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

166 ià(
	`em±y
(
$db_šfo
['columns'])) {

170 
$bË_®Ÿs
 = 
	`cÚ‹Á_v›ws_bËÇme
(
$f›ld
);

172 
$ty³s
 = 
	`¬¿y
();

173 
	`fÜ—ch
 (
	`cÚ‹Á_ty³s
(è
as
 
$ty³
) {

174 ià(
	`is£t
(
$ty³
['f›lds'][
$f›ld
['field_name']])) {

176 
$ty³s
[] = 
$ty³
['name'];

180 
$d©a
 = 
	`¬¿y
();

181 
$d©a
['bË']['group'] = 
	`t
('Content');

182 
$d©a
['bË']['još']['node'] = 
	`¬¿y
(

183 'bË' => 
$db_šfo
['table'],

187 
$d©a
['bË']['još']['node_»visiÚs'] = 
	`¬¿y
(

188 'bË' => 
$db_šfo
['table'],

194 
$db_cŞumns
 = 
	`¬¿y
();

195 
$add™iÚ®_f›lds
 = 
	`¬¿y
();

196 
	`fÜ—ch
 (
$db_šfo
['cŞumns'] 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

198 ià(!
	`em±y
(
$©Œibu‹s
['views'])) {

199 
$db_cŞumns
[
$cŞumn
] = 
$©Œibu‹s
;

202 
$add™iÚ®_f›lds
[
$©Œibu‹s
['column']] = $attributes['column'];

206 ià(
	`em±y
(
$db_cŞumns
)) {

208 
	`fÜ—ch
 (
$db_šfo
['cŞumns'] 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

209 
$db_cŞumns
[
$cŞumn
] = 
$©Œibu‹s
;

213 
$cŞumns
 = 
	`¬¿y
();

214 
$db_f›lds
 = 
	`¬¿y
();

215 
$¬gum’ts
 = 
	`¬¿y
();

216 
$f‹rs
 = 
	`¬¿y
();

217 
	`fÜ—ch
 (
$db_cŞumns
 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

218 
$cŞumns
[] = 
$cŞumn
;

219 
$db_f›lds
[] = 
$©Œibu‹s
['column'];

220 
$sÜts
[] = !
	`em±y
(
$©Œibu‹s
['sÜbË']è? 
TRUE
 : 
FALSE
;

223 
$©Œibu‹s
['type']) {

229 
$f‹rs
[] = 'content_handler_filter_numeric';

230 
$¬gum’ts
[] = 'content_handler_argument_numeric';

234 
$f‹rs
[] = 'content_handler_filter_float';

235 
$¬gum’ts
[] = 'content_handler_argument_numeric';

242 
$f‹rs
[] = 'content_handler_filter_string';

243 
$¬gum’ts
[] = 'content_handler_argument_string';

249 
$db_f›lds_couÁ
 = 
	`couÁ
(
$db_f›lds
);

250 
	`fÜ—ch
 (
$db_f›lds
 
as
 
$i
 => 
$db_f›ld
) {

251 
$Ïb–_Œunÿ‹d
 = 
	`Œunÿ‹_utf8
(
	`t
(
$f›ld
['widg‘']['Ïb–']), 10, 
TRUE
);

252 ià(
$db_f›lds_couÁ
 == 1) {

253 
$t™Ë
 = 
	`t
('@Ïb– (!Çme)', 
	`¬¿y
('@Ïb–' =>(
$f›ld
['widget']['label']), '!name' => $field['field_name']));

254 
$t™Ë_shÜt
 = 
	`check_¶aš
(
$Ïb–_Œunÿ‹d
);

257 
$t™Ë
 = 
	`t
('@Ïb– (!Çmeè- !cŞumn', 
	`¬¿y
('@Ïb–' =>(
$f›ld
['widg‘']['Ïb–']), '!Çme' => $f›ld['f›ld_Çme'], '!cŞumn' => 
$cŞumns
[
$i
]));

258 
$t™Ë_shÜt
 = 
	`t
('@Ïb–-Œunÿ‹d - !cŞumn', 
	`¬¿y
('@Ïb–-Œunÿ‹d' => 
$Ïb–_Œunÿ‹d
, '!cŞumn' => 
$cŞumns
[
$i
]));

261 
$d©a
[
$db_f›ld
] = 
	`¬¿y
(

262 'group' => 
	`t
('Content'),

263 't™Ë' => 
$t™Ë
,

264 't™Ë shÜt' => 
$t™Ë_shÜt
,

265 'h–p' => 
	`t
(
$f›ld_ty³s
[
$f›ld
['ty³']]['Ïb–']è.' - '.('Aµ—r š: @ty³s', 
	`¬¿y
('@ty³s' => 
	`im¶ode
(', ', 
$ty³s
))),

267 ià(
$i
 == 0) {

268 
$d©a
[
$db_f›ld
]['f›ld'] = 
	`¬¿y
(

269 't™Ë' => 
	`t
('@Ïb– (!Çme)', 
	`¬¿y
('@Ïb–' =>(
$f›ld
['widget']['label']), '!name' => $field['field_name'])),

270 't™Ë shÜt' => 
	`check_¶aš
(
$Ïb–_Œunÿ‹d
),

271 'f›ld' => 
$db_f›ld
,

272 'bË' => 
$db_šfo
['table'],

274 'şick sÜbË' => 
$sÜts
[
$i
],

275 'add™iÚ® f›lds' => 
$add™iÚ®_f›lds
,

276 'cÚ‹Á_f›ld_Çme' => 
$f›ld
['field_name'],

278 'acûs ¬gum’ts' => 
	`¬¿y
('v›w', 
$f›ld
),

281 
$d©a
[
$db_f›ld
]['¬gum’t'] = 
	`¬¿y
(

282 'f›ld' => 
$db_f›ld
,

283 'bË' => 
$db_šfo
['table'],

284 'hªdËr' => 
$¬gum’ts
[
$i
],

285 'add™iÚ® f›lds' => 
$add™iÚ®_f›lds
,

286 'cÚ‹Á_f›ld_Çme' => 
$f›ld
['field_name'],

287 'em±y f›ld‚ame' => 
	`t
('<No value>'),

289 
$d©a
[
$db_f›ld
]['f‹r'] = 
	`¬¿y
(

290 'f›ld' => 
$db_f›ld
,

291 'bË' => 
$db_šfo
['table'],

292 'hªdËr' => 
$f‹rs
[
$i
],

293 'add™iÚ® f›lds' => 
$add™iÚ®_f›lds
,

294 'cÚ‹Á_f›ld_Çme' => 
$f›ld
['field_name'],

295 '®lowƒm±y' => 
TRUE
,

297 ià(!
	`em±y
(
$sÜts
[
$i
])) {

298 
$d©a
[
$db_f›ld
]['sÜt'] = 
	`¬¿y
(

299 'f›ld' => 
$db_f›ld
,

300 'bË' => 
$db_šfo
['table'],

302 'add™iÚ® f›lds' => 
$add™iÚ®_f›lds
,

303 'cÚ‹Á_f›ld_Çme' => 
$f›ld
['field_name'],

309 ià(
$f›ld
['multiple']) {

310 
$t™Ë
 = 
	`t
('@Ïb– (!Çmeè- d–', 
	`¬¿y
('@Ïb–' =>(
$f›ld
['widget']['label']), '!name' => $field['field_name']));

311 
$t™Ë_shÜt
 = 
	`t
('@Ïb–-Œunÿ‹d - d–', 
	`¬¿y
('@Ïb–-Œunÿ‹d' => 
$Ïb–_Œunÿ‹d
));

313 
$db_f›ld
 = 'delta';

314 
$d©a
[
$db_f›ld
] = 
	`¬¿y
(

315 'group' => 
	`t
('Content'),

316 't™Ë' => 
$t™Ë
,

317 't™Ë shÜt' => 
$t™Ë_shÜt
,

318 'h–p' => 
	`t
('D– - Aµ—r š: @ty³s', 
	`¬¿y
('@ty³s' => 
	`im¶ode
(', ', 
$ty³s
))),

320 
$d©a
[
$db_f›ld
]['f›ld'] = 
	`¬¿y
(

321 't™Ë' => 
$t™Ë
,

322 't™Ë shÜt' => 
$t™Ë_shÜt
,

323 'f›ld' => 
$db_f›ld
,

324 'bË' => 
$db_šfo
['table'],

326 'şick sÜbË' => 
TRUE
,

327 'add™iÚ® f›lds' => 
$add™iÚ®_f›lds
,

329 'acûs ¬gum’ts' => 
	`¬¿y
('v›w', 
$f›ld
),

331 
$d©a
[
$db_f›ld
]['¬gum’t'] = 
	`¬¿y
(

332 'f›ld' => 
$db_f›ld
,

333 'bË' => 
$db_šfo
['table'],

335 'add™iÚ® f›lds' => 
$add™iÚ®_f›lds
,

336 'em±y f›ld‚ame' => 
	`t
('<No value>'),

338 
$d©a
[
$db_f›ld
]['f‹r'] = 
	`¬¿y
(

339 'f›ld' => 
$db_f›ld
,

340 'bË' => 
$db_šfo
['table'],

342 'add™iÚ® f›lds' => 
$add™iÚ®_f›lds
,

343 '®lowƒm±y' => 
TRUE
,

345 
$d©a
[
$db_f›ld
]['sÜt'] = 
	`¬¿y
(

346 'f›ld' => 
$db_f›ld
,

347 'bË' => 
$db_šfo
['table'],

349 'add™iÚ® f›lds' => 
$add™iÚ®_f›lds
,

353  
	`¬¿y
(
$bË_®Ÿs
 => 
$d©a
);

355 
	}
}

361 
funùiÚ
 
	$cÚ‹Á_v›ws_bËÇme
(
$f›ld
) {

362  'node_d©a_'. 
$f›ld
['field_name'];

363 
	}
}

365 
funùiÚ
 
	$theme_cÚ‹Á_v›w_muÉË_f›ld
(
$™ems
, 
$f›ld
, 
$v®ues
) {

366 
$ouut
 = '';

367 
$i
 = 0;

368 
	`fÜ—ch
 (
$™ems
 
as
 
$™em
) {

369 ià(!
	`em±y
(
$™em
) || $item == '0') {

370 
$ouut
 .ğ'<div cÏss="f›ld-™em f›ld-™em-'. 
$i
 .'">'. 
$™em
 .'</div>';

371 
$i
++;

374  
$ouut
;

375 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/content.views_convert.inc

1 <?
php


16 
funùiÚ
 
	$cÚ‹Á_v›ws_cÚv”t
(
$di¥Ïy
, 
$ty³
, &
$v›w
, 
$v›ws_f›ld
) {

17 
$v›ws_f›lds
;

19 ià(
	`em±y
(
$v›ws_f›lds
)) {

20 
$v›ws_f›lds
 = 
	`¬¿y
();

21 
$ty³s
 = 
	`cÚ‹Á_ty³s
();

22 
	`fÜ—ch
 (
$ty³s
 
as
 
$ùy³
) {

23 
	`fÜ—ch
 (
$ùy³
['f›lds'] 
as
 
$f›ld
) {

24 
$moduË
 = 
$f›ld
['module'];

25 
$»suÉ
 = (
¬¿y
è
	`moduË_švoke
(
$moduË
, 'f›ld_£‰šgs', 'v›w d©a', 
$f›ld
);

26 
	`dru·l_®‹r
('f›ld_£‰šgs', 
$»suÉ
, 'v›w d©a', 
$f›ld
);

27 ià(
	`em±y
(
$»suÉ
)) {

30 
$cŞumn
 = 
	`¬¿y_shiá
(
	`¬¿y_keys
(
$f›ld
['columns']));

31 
$v›ws_f›lds
[
$f›ld
['f›ld_Çme'] .'_'. 
$cŞumn
] = $field;

38 ià(!
	`š_¬¿y
(
$v›ws_f›ld
['f›ld'], 
	`¬¿y_keys
(
$v›ws_f›lds
))) {

43 
$ty³
) {

45 
$v›w
->
di¥Ïy
[
$di¥Ïy
]->
di¥Ïy_İtiÚs
['f›lds'][
$v›ws_f›ld
['field']]['format'] = $views_field['options'];

46 ià(
$v›ws_f›ld
['handler'] == 'content_views_field_handler_group') {

47 
$v›w
->
di¥Ïy
[
$di¥Ïy
]->
di¥Ïy_İtiÚs
['f›lds'][
$v›ws_f›ld
['field']]['multiple']['group'] = 1;

50 
$v›w
->
di¥Ïy
[
$di¥Ïy
]->
di¥Ïy_İtiÚs
['f›lds'][
$v›ws_f›ld
['field']]['multiple']['group'] = 0;

72 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_argument.inc

1 <?
php


9 şas 
	ccÚ‹Á_hªdËr_¬gum’t
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

10 
v¬
 
	m$cÚ‹Á_f›ld
;

12 
funùiÚ
 
	$cÚ¡ruù
() {

13 
·»Á
::
	`cÚ¡ruù
();

15 
$this
->
cÚ‹Á_f›ld
 = 
	`cÚ‹Á_f›lds
($this->
defš™iÚ
['content_field_name']);

16 
$this
->
add™iÚ®_f›lds
 = $this->
defš™iÚ
['additional fields'];

18 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_argument_many_to_one.inc

1 <?
php


8 şas 
	ccÚ‹Á_hªdËr_¬gum’t_mªy_to_Úe
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_mªy_to_Úe
 {

9 
v¬
 
	m$cÚ‹Á_f›ld
;

11 
funùiÚ
 
	$cÚ¡ruù
() {

12 
·»Á
::
	`cÚ¡ruù
();

14 
$this
->
cÚ‹Á_f›ld
 = 
	`cÚ‹Á_f›lds
($this->
defš™iÚ
['content_field_name']);

15 
$this
->
add™iÚ®_f›lds
 = $this->
defš™iÚ
['additional fields'];

18 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

19 
$İtiÚs
 = 
$this
->
	`®lowed_v®ues
();

20 
$v®ue
 = 
$d©a
->{
$this
->
Çme_®Ÿs
};

21 ià(
	`is£t
(
$İtiÚs
[
$v®ue
])) {

22 
$v®ue
 = 
$İtiÚs
[$value];

25 
$v®ue
 = 
·»Á
::
	`summ¬y_Çme
(
$d©a
);

28  
$v®ue
;

29 
	}
}

31 
funùiÚ
 
	$t™Ë_qu”y
() {

32 
$İtiÚs
 = 
$this
->
	`®lowed_v®ues
();

33 
$v®ues
 = 
$this
->
v®ue
;

34 
	`fÜ—ch
 (
$v®ues
 
as
 
$key
 => 
$v®ue
) {

35 ià(
	`is£t
(
$İtiÚs
[
$v®ue
])) {

36 
$v®ues
[
$key
] = 
$İtiÚs
[
$v®ue
];

39  
$v®ues
;

40 
	}
}

42 
funùiÚ
 
	$®lowed_v®ues
() {

43 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

44 
$funùiÚ
 = 
$f›ld
['module'] .'_allowed_values';

45 
$İtiÚs
 = 
	`funùiÚ_exi¡s
(
$funùiÚ
è? 
	`$funùiÚ
(
$f›ld
è: 
	`cÚ‹Á_®lowed_v®ues
($field);

46  (
¬¿y
è
$İtiÚs
;

47 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_argument_numeric.inc

1 <?
php


9 şas 
	ccÚ‹Á_hªdËr_¬gum’t_num”ic
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_num”ic
 {

10 
v¬
 
	m$cÚ‹Á_f›ld
;

12 
funùiÚ
 
	$cÚ¡ruù
() {

13 
·»Á
::
	`cÚ¡ruù
();

15 
$this
->
cÚ‹Á_f›ld
 = 
	`cÚ‹Á_f›lds
($this->
defš™iÚ
['content_field_name']);

16 
$this
->
add™iÚ®_f›lds
 = $this->
defš™iÚ
['additional fields'];

18 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_argument_reference.inc

1 <?
php


8 şas 
	ccÚ‹Á_hªdËr_¬gum’t_»ã»nû
 
ex‹nds
 
	mcÚ‹Á_hªdËr_¬gum’t_num”ic
 {

12 
funùiÚ
 
	$t™Ë_qu”y
() {

13 
$t™Ës
 = 
	`¬¿y
();

14 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$this
->
v®ue
), '%d'));

16 
$bË_d©a
 = 
	`v›ws_ãtch_d©a
(
$this
->
Çme_bË
);

17 
$bË
 = 
	`¬¿y_shiá
(
$bË_d©a
['table']['join']);

19 
$»suÉ
 = 
	`db_qu”y
("SELECT $this->Çme_f›ld AS™Ë FROM {". 
$bË
['bË'] ."} WHERE ". $bË['f›ld'] ." IN ($¶aûhŞd”s)", 
$this
->
v®ue
);

20 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

21 
$t™Ës
[] = 
	`check_¶aš
(
$row
->
t™Ë
);

23  
$t™Ës
;

25 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_argument_string.inc

1 <?
php


9 şas 
	ccÚ‹Á_hªdËr_¬gum’t_¡ršg
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_¡ršg
 {

10 
v¬
 
	m$cÚ‹Á_f›ld
;

12 
funùiÚ
 
	$cÚ¡ruù
() {

13 
·»Á
::
	`cÚ¡ruù
();

15 
$this
->
cÚ‹Á_f›ld
 = 
	`cÚ‹Á_f›lds
($this->
defš™iÚ
['content_field_name']);

16 
$this
->
add™iÚ®_f›lds
 = $this->
defš™iÚ
['additional fields'];

18 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_field.inc

1 <?
php


13 şas 
	ccÚ‹Á_hªdËr_f›ld
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_node
 {

14 
v¬
 
	m$cÚ‹Á_f›ld
;

16 
funùiÚ
 
	$cÚ¡ruù
() {

17 
·»Á
::
	`cÚ¡ruù
();

18 
$this
->
cÚ‹Á_f›ld
 = 
	`cÚ‹Á_f›lds
($this->
defš™iÚ
['content_field_name']);

21 
funùiÚ
 
	$š™
(&
$v›w
, 
$İtiÚs
) {

22 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

23 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

24 ià(
$f›ld
['multiple']) {

25 
$this
->
add™iÚ®_f›lds
['delta'] = 'delta';

29 
$this
->
add™iÚ®_f›lds
['ty³'] = 
	`¬¿y
('table' => 'node', 'field' => 'type');

30 
$this
->
add™iÚ®_f›lds
['nid'] = 
	`¬¿y
('table' => 'node', 'field' => 'nid');

31 
$this
->
add™iÚ®_f›lds
['vid'] = 
	`¬¿y
('table' => 'node', 'field' => 'vid');

32 
	}
}

34 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

35 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

36 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

39 
$İtiÚs
['Ïb–'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

40 
$İtiÚs
['Ïb–_ty³'] = 
	`¬¿y
('default' => 'widget');

41 
$İtiÚs
['fÜm©'] = 
	`¬¿y
('default' => 'default');

43  
$İtiÚs
;

44 
	}
}

49 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

50 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

54 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

55 
$İtiÚs
 = 
$this
->
İtiÚs
;

57 
$fÜm
['Ïb–_ty³'] = 
	`¬¿y
(

58 '#t™Ë' => 
	`t
('Label'),

60 '#İtiÚs' => 
	`¬¿y
(

61 'nÚe' => 
	`t
('None'),

62 'widg‘' => 
	`t
('Widg‘†ab– (@Ïb–)', 
	`¬¿y
('@Ïb–' => 
$f›ld
['widget']['label'])),

63 'cu¡om' => 
	`t
('Custom'),

65 '#deçuÉ_v®ue' => 
$İtiÚs
['label_type'],

68 
$fÜm
['Ïb–'] = 
	`¬¿y
(

69 '#t™Ë' => 
	`t
('Custom†abel'),

71 '#deçuÉ_v®ue' => 
$İtiÚs
['label'],

72 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

73 '#d•’d’cy' => 
	`¬¿y
('radio:options[label_type]' =>‡rray('custom')),

77 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

78 
$fÜm©‹rs
 = 
	`¬¿y
();

79 ià(
	`is_¬¿y
(
$f›ld_ty³s
[
$f›ld
['type']]['formatters'])) {

80 
	`fÜ—ch
 (
$f›ld_ty³s
[
$f›ld
['ty³']]['fÜm©‹rs'] 
as
 
$Çme
 => 
$šfo
) {

81 
$fÜm©‹rs
[
$Çme
] = 
$šfo
['label'];

84 
$fÜm
['fÜm©'] = 
	`¬¿y
(

85 '#t™Ë' => 
	`t
('Format'),

87 '#İtiÚs' => 
$fÜm©‹rs
,

88 '#»quœed' => 
TRUE
,

89 '#deçuÉ_v®ue' => 
$İtiÚs
['format'],

92 
	}
}

103 
funùiÚ
 
	$İtiÚs_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

104 
$fÜm_¡©e
['values']['options']['label_type']) {

106 
$fÜm_¡©e
['values']['options']['label'] = '';

109 
$fÜm_¡©e
['v®ues']['İtiÚs']['Ïb–'] = 
$this
->
cÚ‹Á_f›ld
['widget']['label'];

112 
	}
}

125 
funùiÚ
 
	$Ïb–
() {

126 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

127 
$this
->
İtiÚs
['label_type']) {

131  
$f›ld
['widget']['label'];

133  
$this
->
İtiÚs
['label'];

135 
	}
}

140 
funùiÚ
 
	$–em’t_ty³
() {

141 ià(
	`is£t
(
$this
->
defš™iÚ
['elementype'])) {

142  
$this
->
defš™iÚ
['elementype'];

149 ià(
$this
->
cÚ‹Á_f›ld
['widget']['type'] == 'text_textarea') {

155 
	}
}

157 
funùiÚ
 
	$İtiÚs_v®id©e
(
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

162 
funùiÚ
 
	$admš_summ¬y
() {

164 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

165 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

166 ià(
	`is£t
(
$f›ld_ty³s
[
$f›ld
['ty³']]['fÜm©‹rs'][
$this
->
İtiÚs
['format']])) {

167  
	`t
(
$f›ld_ty³s
[
$f›ld
['ty³']]['fÜm©‹rs'][
$this
->
İtiÚs
['format']]['label']);

169 
	}
}

171 
funùiÚ
 
	$»nd”
(
$v®ues
) {

174 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$this
->
cÚ‹Á_f›ld
['f›ld_Çme'], 
$v®ues
->{$this->
®Ÿ£s
['type']});

175 
$İtiÚs
 = 
$this
->
İtiÚs
;

176 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

179 
$node
 = 
	`dru·l_şÚe
(
$v®ues
);

180 
$node
->
ty³
 = 
$v®ues
->{
$this
->
®Ÿ£s
['type']};

181 
$node
->
nid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['nid']};

182 
$node
->
vid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['vid']};

185 
$node
->
bud_mode
 = 
NODE_BUILD_NORMAL
;

187 
$™em
 = 
	`¬¿y
();

188 
	`fÜ—ch
 (
$db_šfo
['cŞumns'] 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

189 
$™em
[
$cŞumn
] = 
$v®ues
->{
$this
->
®Ÿ£s
[
$©Œibu‹s
['column']]};

192 
$™em
['#d–'] = 
$f›ld
['muÉË'] ? 
$v®ues
->{
$this
->
®Ÿ£s
['delta']} : 0;

195 
$fÜm©‹r_Çme
 = 
$İtiÚs
['format'];

196 ià(
$fÜm©‹r
 = 
	`_cÚ‹Á_g‘_fÜm©‹r
(
$fÜm©‹r_Çme
, 
$f›ld
['type'])) {

197 ià(
	`cÚ‹Á_hªdË
('fÜm©‹r', 'muÉË v®ues', 
$fÜm©‹r
è=ğ
CONTENT_HANDLE_CORE
) {

199 
$ouut
 = 
	`cÚ‹Á_fÜm©
(
$f›ld
, 
$™em
, 
$fÜm©‹r_Çme
, 
$node
);

203 
$ouut
 = 
	`cÚ‹Á_fÜm©
(
$f›ld
, 
	`¬¿y
(
$™em
), 
$fÜm©‹r_Çme
, 
$node
);

205  
$this
->
	`»nd”_lšk
(
$ouut
, 
$v®ues
);

208 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_field_multiple.inc

1 <?
php


11 şas 
	ccÚ‹Á_hªdËr_f›ld_muÉË
 
ex‹nds
 
	mcÚ‹Á_hªdËr_f›ld
 {

12 
v¬
 
	m$deãr_qu”y
;

14 
funùiÚ
 
	$š™
(&
$v›w
, 
$İtiÚs
) {

15 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

16 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

18 
$this
->
deãr_qu”y
 = !
	`em±y
(
$İtiÚs
['muÉË']['group']è&& 
$f›ld
['multiple'];

20 ià(
$this
->
deãr_qu”y
) {

26 
$this
->
add™iÚ®_f›lds
 = 
	`¬¿y
(

27 'ty³' => 
	`¬¿y
('table' => 'node', 'field' => 'type'),

28 'nid' => 
	`¬¿y
('table' => 'node', 'field' => 'nid'),

30 ià(
$v›w
->
ba£_bË
 == 'node_revisions') {

31 
$this
->
add™iÚ®_f›lds
['vid'] = 
	`¬¿y
('table' => 'node_revisions', 'field' => 'vid');

34 
$this
->
add™iÚ®_f›lds
['vid'] = 
	`¬¿y
('table' => 'node', 'field' => 'vid');

39 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

40 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

42 
$İtiÚs
['muÉË'] = 
	`¬¿y
(

43 'cÚšs' => 
	`¬¿y
(

44 'group' => 
	`¬¿y
('deçuÉ' => 
TRUE
),

45 'muÉË_numb”' => 
	`¬¿y
('default' => ''),

46 'muÉË_äom' => 
	`¬¿y
('default' => ''),

47 'muÉË_»v”£d' => 
	`¬¿y
('deçuÉ' => 
FALSE
),

51  
$İtiÚs
;

52 
	}
}

57 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

58 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

60 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

61 
$İtiÚs
 = 
$this
->
İtiÚs
;

63 
$fÜm
['muÉË'] = 
	`¬¿y
(

64 '#acûss' => 
$f›ld
['multiple'],

67 
$fÜm
['muÉË']['group'] = 
	`¬¿y
(

68 '#t™Ë' => 
	`t
('Group multiple values'),

70 '#deçuÉ_v®ue' => 
$İtiÚs
['multiple']['group'],

71 '#desütiÚ' => 
	`t
('If unchecked,ƒach item inhe field will create‡‚ew„ow, which may‡ppearo cause duplicates. This setting is‚ot compatible with click-sorting inable displays.'),

75 
	`li¡
(
$´efix
, 
$suffix
èğ
	`ex¶ode
('@couÁ', 
	`t
('Show @count value(s)'));

76 
$fÜm
['muÉË']['muÉË_numb”'] = 
	`¬¿y
(

79 '#f›ld_´efix' => 
$´efix
,

80 '#f›ld_suffix' => 
$suffix
,

81 '#deçuÉ_v®ue' => 
$İtiÚs
['multiple']['multiple_number'],

83 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

84 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-muÉË-group' =>‡¼ay(
TRUE
)),

86 
	`li¡
(
$´efix
, 
$suffix
èğ
	`ex¶ode
('@couÁ', 
	`t
('starting from @count'));

87 
$fÜm
['muÉË']['muÉË_äom'] = 
	`¬¿y
(

90 '#f›ld_´efix' => 
$´efix
,

91 '#f›ld_suffix' => 
$suffix
,

92 '#deçuÉ_v®ue' => 
$İtiÚs
['multiple']['multiple_from'],

93 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

94 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-muÉË-group' =>‡¼ay(
TRUE
)),

95 '#desütiÚ' => 
	`t
('(first item is 0)'),

97 
$fÜm
['muÉË']['muÉË_»v”£d'] = 
	`¬¿y
(

98 '#t™Ë' => 
	`t
('Reversed'),

100 '#deçuÉ_v®ue' => 
$İtiÚs
['multiple']['multiple_reversed'],

102 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

103 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-muÉË-group' =>‡¼ay(
TRUE
)),

104 '#desütiÚ' => 
	`t
('(start from†ast values)'),

106 
	}
}

111 
funùiÚ
 
	$şick_sÜbË
() {

112 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

113 
$İtiÚs
 = 
$this
->
İtiÚs
;

116  !
	`em±y
(
$this
->
defš™iÚ
['şick sÜbË']è&& !$this->
deãr_qu”y
;

117 
	}
}

119 
funùiÚ
 
	$qu”y
() {

121 ià(!
$this
->
deãr_qu”y
) {

122  
·»Á
::
	`qu”y
();

126 
$this
->
	`add_add™iÚ®_f›lds
();

127 
$this
->
f›ld_®Ÿs
 = $this->
®Ÿ£s
['vid'];

128 
	}
}

130 
funùiÚ
 
	$´e_»nd”
(
$v®ues
) {

133 ià(
	`is£t
(
$this
->
v›w
->
bud_šfo
['summ¬y']è|| 
	`em±y
(
$v®ues
è|| !$this->
deãr_qu”y
) {

134  
·»Á
::
	`´e_»nd”
(
$v®ues
);

137 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

138 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

139 
$İtiÚs
 = 
$this
->
İtiÚs
;

143 
$vids
 = 
	`¬¿y
();

144 
$this
->
f›ld_v®ues
 = 
	`¬¿y
();

145 
	`fÜ—ch
 (
$v®ues
 
as
 
$»suÉ
) {

146 ià(
	`is£t
(
$»suÉ
->{
$this
->
f›ld_®Ÿs
})) {

147 
$vids
[] = 
$»suÉ
->{
$this
->
f›ld_®Ÿs
};

154 ià(
	`em±y
(
$vids
)) {

155  
·»Á
::
	`´e_»nd”
(
$v®ues
);

159 
$®Ÿs
 = 
	`cÚ‹Á_v›ws_bËÇme
(
$f›ld
);

161 
$qu”y_cŞumns
 = 
	`¬¿y
(

168 
	`fÜ—ch
 (
$db_šfo
['cŞumns'] 
as
 
$cŞumn
 => 
$©Œibu‹s
) {

169 
$qu”y_cŞumns
[] = "$attributes[column] AS $column";

171 
$qu”y
 = 'SELECT '. 
	`im¶ode
(', ', 
$qu”y_cŞumns
) .

172 ' FROM {'. 
$db_šfo
['table'] ."}".

173 " WHERE vid IN (". 
	`im¶ode
(',', 
$vids
) .')'.

174 " ORDER BY _nid ASC, _d– ". (
$İtiÚs
['multiple']['multiple_reversed'] ? 'DESC' : 'ASC');

175 
$»suÉ
 = 
	`db_qu”y
(
$qu”y
);

177 
$™em
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

179 
$vid
 = 
$™em
['_vid'];

180 
	`un£t
(
$™em
['_vid']);

181 
$d–
 = !
	`em±y
(
$™em
['_delta']) ? $item['_delta'] : 0;

182 
$™em
['#delta'] = $item['_delta'];

183 
	`un£t
(
$™em
['_delta']);

184 
$this
->
f›ld_v®ues
[
$vid
][
$d–
] = 
$™em
;

186 
	}
}

194 
funùiÚ
 
	$–em’t_ty³
() {

195 ià(!
$this
->
deãr_qu”y
) {

196  
·»Á
::
	`–em’t_ty³
();

199 ià(
	`is£t
(
$this
->
defš™iÚ
['elementype'])) {

200  
$this
->
defš™iÚ
['elementype'];

203 
	}
}

205 
funùiÚ
 
	$»nd”
(
$v®ues
) {

207 ià(!
$this
->
deãr_qu”y
) {

208  
·»Á
::
	`»nd”
(
$v®ues
);

213 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$this
->
cÚ‹Á_f›ld
['f›ld_Çme'], 
$v®ues
->{$this->
®Ÿ£s
['type']});

214 
$İtiÚs
 = 
$this
->
İtiÚs
;

216 
$vid
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

217 ià(
	`is£t
(
$this
->
f›ld_v®ues
[
$vid
])) {

219 
$couÁ_sk³d
 = 0;

220 
$™ems
 = 
	`¬¿y
();

221 
	`fÜ—ch
 (
$this
->
f›ld_v®ues
[
$vid
] 
as
 
$™em
) {

222 ià(
	`em±y
(
$İtiÚs
['muÉË']['muÉË_äom']è|| (
$couÁ_sk³d
 >= $options['multiple']['multiple_from'])) {

223 ià(
	`em±y
(
$İtiÚs
['muÉË']['muÉË_numb”']è|| (
	`couÁ
(
$™ems
) < $options['multiple']['multiple_number'])) {

225 
$nid
 = 
$™em
['_nid'];

226 
	`un£t
(
$™em
['_nid']);

227 
$™ems
[] = 
$™em
;

233 
$couÁ_sk³d
++;

237 
$node
 = 
	`dru·l_şÚe
(
$v®ues
);

239 
$node
->
ty³
 = 
$v®ues
->{
$this
->
®Ÿ£s
['type']};

240 
$node
->
nid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['nid']};

241 
$node
->
vid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['vid']};

245 
$node
->
bud_mode
 = 
NODE_BUILD_NORMAL
;

248 
$fÜm©‹r_Çme
 = 
$İtiÚs
['format'];

249 ià(
$™ems
 && (
$fÜm©‹r
 = 
	`_cÚ‹Á_g‘_fÜm©‹r
(
$fÜm©‹r_Çme
, 
$f›ld
['type']))) {

250 
$»nd”ed
 = 
	`¬¿y
();

251 ià(
	`cÚ‹Á_hªdË
('fÜm©‹r', 'muÉË v®ues', 
$fÜm©‹r
è=ğ
CONTENT_HANDLE_CORE
) {

253 
	`fÜ—ch
 (
$™ems
 
as
 
$™em
) {

254 
$ouut
 = 
	`cÚ‹Á_fÜm©
(
$f›ld
, 
$™em
, 
$fÜm©‹r_Çme
, 
$node
);

255 ià(!
	`em±y
(
$ouut
)) {

256 
$»nd”ed
[] = 
$this
->
	`»nd”_lšk
(
$ouut
, (
objeù
è
	`¬¿y
('nid' => 
$nid
));

262 
$ouut
 = 
	`cÚ‹Á_fÜm©
(
$f›ld
, 
$™ems
, 
$fÜm©‹r_Çme
, 
$v®ues
);

263 ià(!
	`em±y
(
$ouut
)) {

264 
$»nd”ed
[] = 
$this
->
	`»nd”_lšk
(
$ouut
, (
objeù
è
	`¬¿y
('nid' => 
$nid
));

268 ià(
	`couÁ
(
$»nd”ed
) > 1) {

270  
	`theme
('cÚ‹Á_v›w_muÉË_f›ld', 
$»nd”ed
, 
$f›ld
, 
$v®ues
);

272 
	`–£if
 (
$»nd”ed
) {

273  
$»nd”ed
[0];

279 
	}
}

281 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ues
) {

282 ià(!
$this
->
deãr_qu”y
) {

283  
·»Á
::
	`»nd”_lšk
(
$d©a
, 
$v®ues
);

286 ià(!
	`em±y
(
$this
->
İtiÚs
['lšk_to_node']è&& 
$d©a
 !=ğ
NULL
 && $data !== '') {

287 ià(
	`m‘hod_exi¡s
('render_as_link', 'views_handler_field')) {

289 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
TRUE
;

290 
$this
->
İtiÚs
['®‹r']['·th'] = "node/" . 
$v®ues
->{$this->
®Ÿ£s
['nid']};

294  
	`l
(
$d©a
, "node/" . 
$v®ues
->
nid
, 
	`¬¿y
('html' => 
TRUE
));

298  
$d©a
;

300 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_filter_float.inc

1 <?
php


12 ià(!
şass_exi¡s
('views_handler_filter_float')) {

14 
	g$defš™iÚ
 = 
v›ws_ãtch_hªdËr_d©a
('views_handler_filter_numeric');

15 
v›ws_šşude_hªdËr
(
$defš™iÚ
, 'handler');

18 şas 
	ccÚ‹Á_hªdËr_f‹r_æßt
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_æßt
 {

19 
v¬
 
	m$cÚ‹Á_f›ld
;

21 
funùiÚ
 
	$cÚ¡ruù
() {

22 
·»Á
::
	`cÚ¡ruù
();

23 
$this
->
cÚ‹Á_f›ld
 = 
	`cÚ‹Á_f›lds
($this->
defš™iÚ
['content_field_name']);

24 
$this
->
add™iÚ®_f›lds
 = $this->
defš™iÚ
['additional fields'];

26 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_filter_many_to_one.inc

1 <?
php


9 şas 
	ccÚ‹Á_hªdËr_f‹r_mªy_to_Úe
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_mªy_to_Úe
 {

10 
v¬
 
	m$cÚ‹Á_f›ld
;

12 
funùiÚ
 
	$cÚ¡ruù
() {

13 
·»Á
::
	`cÚ¡ruù
();

14 
$this
->
cÚ‹Á_f›ld
 = 
	`cÚ‹Á_f›lds
($this->
defš™iÚ
['content_field_name']);

15 
$this
->
add™iÚ®_f›lds
 = $this->
defš™iÚ
['additional fields'];

16 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

17 
$this
->
v®ue_t™Ë
 = 
$f›ld
['widget']['label'];

20 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

21 
$this
->
v®ue_İtiÚs
 = $this->
	`®lowed_v®ues
();

22 
	}
}

26 
funùiÚ
 
	$®lowed_v®ues
() {

27 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

28 
$funùiÚ
 = 
$f›ld
['module'] .'_allowed_values';

29 ià(
$this
->
v®ue_fÜm_ty³
 == 'select') {

31 
$İtiÚs
 = 
	`funùiÚ_exi¡s
(
$funùiÚ
è? 
	`$funùiÚ
(
$f›ld
è: 
	`cÚ‹Á_®lowed_v®ues
($f›ld, 
FALSE
);

34 
	`cÚ‹Á_®lowed_v®ues_f‹r_html
(
$İtiÚs
);

37 
$İtiÚs
 = 
	`funùiÚ_exi¡s
(
$funùiÚ
è? 
	`$funùiÚ
(
$f›ld
è: 
	`cÚ‹Á_®lowed_v®ues
($field);

39  (
¬¿y
è
$İtiÚs
;

40 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_filter_numeric.inc

1 <?
php


9 şas 
	ccÚ‹Á_hªdËr_f‹r_num”ic
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_num”ic
 {

10 
v¬
 
	m$cÚ‹Á_f›ld
;

12 
funùiÚ
 
	$cÚ¡ruù
() {

13 
·»Á
::
	`cÚ¡ruù
();

14 
$this
->
cÚ‹Á_f›ld
 = 
	`cÚ‹Á_f›lds
($this->
defš™iÚ
['content_field_name']);

15 
$this
->
add™iÚ®_f›lds
 = $this->
defš™iÚ
['additional fields'];

17 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_filter_string.inc

1 <?
php


9 şas 
	ccÚ‹Á_hªdËr_f‹r_¡ršg
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_¡ršg
 {

10 
v¬
 
	m$cÚ‹Á_f›ld
;

12 
funùiÚ
 
	$cÚ¡ruù
() {

13 
·»Á
::
	`cÚ¡ruù
();

14 
$this
->
cÚ‹Á_f›ld
 = 
	`cÚ‹Á_f›lds
($this->
defš™iÚ
['content_field_name']);

15 
$this
->
add™iÚ®_f›lds
 = $this->
defš™iÚ
['additional fields'];

17 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_relationship.inc

1 <?
php


9 şas 
	ccÚ‹Á_hªdËr_»ÏtiÚsh
 
ex‹nds
 
	mv›ws_hªdËr_»ÏtiÚsh
 {

10 
v¬
 
	m$cÚ‹Á_f›ld
;

12 
funùiÚ
 
	$cÚ¡ruù
() {

13 
·»Á
::
	`cÚ¡ruù
();

15 
$this
->
cÚ‹Á_f›ld
 = 
	`cÚ‹Á_f›lds
($this->
defš™iÚ
['content_field_name']);

18 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

19 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

20 
$İtiÚs
['d–'] = 
	`¬¿y
('default' => -1);

22  
$İtiÚs
;

23 
	}
}

28 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

29 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

30 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

33 ià(
$f›ld
['multiple']) {

34 
$max_d–
 = 
$f›ld
['multiple'];

36 ià(
$max_d–
 == 1) {

37 
$max_d–
 = 10;

40 
$İtiÚs
 = 
	`¬¿y
('-1' => 
	`t
('All'));

41 
$i
 = 0; $˜< 
$max_d–
; $i++) {

42 
$İtiÚs
[
$i
] = $i + 1;

44 
$fÜm
['d–'] = 
	`¬¿y
(

46 '#İtiÚs' => 
$İtiÚs
,

47 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['delta'],

48 '#t™Ë' => 
	`t
('Delta'),

49 '#desütiÚ' => 
	`t
('The delta‡llows youo select which item in‡ multiple value fieldo keyhe„elationship off of. Select "1"o usehe first item, "2" forhe second item,‡nd so on. If you select "All",ƒach item inhe field will create‡‚ew„ow, which may‡ppearo cause duplicates.'),

52 
	}
}

54 
funùiÚ
 
	$’su»_my_bË
() {

55 ià(!
	`is£t
(
$this
->
bË_®Ÿs
)) {

56 
$još
 = 
$this
->
	`g‘_još
();

57 ià(!
	`is£t
(
$još
->
exŒa
)) {

58 
$još
->
exŒa
 = 
	`¬¿y
();

60 
$d–
 = 
	`is£t
(
$this
->
İtiÚs
['delta']) ? $this->options['delta'] : -1;

61 ià(
$d–
 != -1) {

62 
$još
->
exŒa
[] = 
	`¬¿y
(

64 'v®ue' => 
$d–
,

65 'num”ic' => 
TRUE
,

69 
$this
->
bË_®Ÿs
 = $this->
qu”y
->
	`add_bË
($this->
bË
, $this->
»ÏtiÚsh
, 
$još
);

71  
$this
->
bË_®Ÿs
;

72 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_sort.inc

1 <?
php


9 şas 
	ccÚ‹Á_hªdËr_sÜt
 
ex‹nds
 
	mv›ws_hªdËr_sÜt
 {

10 
v¬
 
	m$cÚ‹Á_f›ld
;

12 
funùiÚ
 
	$cÚ¡ruù
() {

13 
·»Á
::
	`cÚ¡ruù
();

15 
$this
->
cÚ‹Á_f›ld
 = 
	`cÚ‹Á_f›lds
($this->
defš™iÚ
['content_field_name']);

16 
$this
->
add™iÚ®_f›lds
 = $this->
defš™iÚ
['additional fields'];

19 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

20 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

21 
$İtiÚs
['d–'] = 
	`¬¿y
('default' => -1);

23  
$İtiÚs
;

24 
	}
}

29 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

30 
$f›ld
 = 
$this
->
cÚ‹Á_f›ld
;

31 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

34 ià(
$f›ld
['multiple']) {

35 
$max_d–
 = 
$f›ld
['multiple'];

37 ià(
$max_d–
 == 1) {

38 
$max_d–
 = 10;

41 
$İtiÚs
 = 
	`¬¿y
('-1' => 
	`t
('All'));

42 
$i
 = 0; $˜< 
$max_d–
; $i++) {

43 
$İtiÚs
[
$i
] = $i + 1;

45 
$fÜm
['d–'] = 
	`¬¿y
(

47 '#İtiÚs' => 
$İtiÚs
,

48 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['delta'],

49 '#t™Ë' => 
	`t
('Delta'),

50 '#desütiÚ' => 
	`t
('The delta‡llows youo select which item in‡ multiple value field will be used for sorting. Select "1"o usehe first item, "2" forhe second item,‡nd so on. If you select "All",ƒach item inhe field will create‡‚ew„ow, which may‡ppearo cause duplicates.'),

53 
	}
}

55 
funùiÚ
 
	$’su»_my_bË
() {

56 ià(!
	`is£t
(
$this
->
bË_®Ÿs
)) {

57 
$još
 = 
$this
->
	`g‘_još
();

58 ià(!
	`is£t
(
$još
->
exŒa
)) {

59 
$još
->
exŒa
 = 
	`¬¿y
();

61 
$d–
 = 
	`is£t
(
$this
->
İtiÚs
['delta']) ? $this->options['delta'] : -1;

62 ià(
$d–
 != -1) {

63 
$još
->
exŒa
[] = 
	`¬¿y
(

65 'v®ue' => 
$d–
,

66 'num”ic' => 
TRUE
,

70 
$this
->
bË_®Ÿs
 = $this->
qu”y
->
	`’su»_bË
($this->
bË
, $this->
»ÏtiÚsh
, 
$još
);

72  
$this
->
bË_®Ÿs
;

73 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_plugin_display_simple.inc

1 <?
php


8 şas 
	ccÚ‹Á_¶ugš_di¥Ïy_sim¶e
 
ex‹nds
 
	mv›ws_¶ugš_di¥Ïy
 {

9 
funùiÚ
 
	$execu‹
() {

10  
$this
->
v›w
->
	`»nd”
($this->
di¥Ïy
->
id
);

13 
funùiÚ
 
	$»nd”
() {

14  !
	`em±y
(
$this
->
v›w
->
»suÉ
è|| !em±y($this->v›w->
¡yË_¶ugš
->
defš™iÚ
['ev’ƒm±y']è? $this->v›w->¡yË_¶ugš->
	`»nd”
($this->view->result) : '';

15 
	}
}

17 
funùiÚ
 
	$u£s_expo£d
() {

18  
FALSE
;

19 
	}
}

22 şas 
	ccÚ‹Á_¶ugš_di¥Ïy_»ã»nûs
 
ex‹nds
 
	mcÚ‹Á_¶ugš_di¥Ïy_sim¶e
 {

23 
funùiÚ
 
	$qu”y
() {

24 
$İtiÚs
 = 
$this
->
	`g‘_İtiÚ
('content_options');

26 ià(
$İtiÚs
['string'] !== '') {

27 
$like
 = 
$GLOBALS
["db_type"] == 'pgsql' ? "ILIKE" : "LIKE";

28 
$m©ch_şau£s
 = 
	`¬¿y
(

33 
$şau£
 = 
	`is£t
(
$m©ch_şau£s
[
$İtiÚs
['match']]) ? $match_clauses[$options['match']] : $match_clauses['contains'];

34 
$®Ÿs
 = 
$this
->
v›w
->
qu”y
->
	`’su»_bË
(
$İtiÚs
['table']);

35 
$this
->
v›w
->
qu”y
->
	`add_wh”e
(
NULL
, "$®Ÿs.$İtiÚs[f›ld_¡ršg] $şau£", 
$İtiÚs
['string']);

37 
	`–£if
 (
$İtiÚs
['ids']) {

38 
$®Ÿs
 = 
$this
->
v›w
->
qu”y
->
	`’su»_bË
(
$İtiÚs
['table']);

39 
$this
->
v›w
->
qu”y
->
	`add_wh”e
(
NULL
, "$®Ÿs.$İtiÚs[f›ld_id] IN (" . 
	`db_¶aûhŞd”s
(
$İtiÚs
['ids']) . ')', $options['ids']);

42 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_plugin_style_php_array_ac.inc

1 <?
php


8 şas 
	ccÚ‹Á_¶ugš_¡yË_php_¬¿y_ac
 
ex‹nds
 
	mv›ws_¶ugš_¡yË
 {

9 
funùiÚ
 
	$»nd”
() {

10 
$»suÉs
 = 
	`¬¿y
();

13 
$£ts
 = 
$this
->
	`»nd”_groupšg
($this->
v›w
->
»suÉ
, $this->
İtiÚs
['grouping']);

15 
$ba£_f›ld
 = 
$this
->
v›w
->
ba£_f›ld
;

16 
$t™Ë_f›ld
 = 
$this
->
di¥Ïy
->
di¥Ïy_İtiÚs
['content_title_field'];

17 
$t™Ë_f›ld_®Ÿs
 = 
$this
->
v›w
->
f›ld
[
$t™Ë_f›ld
]->
f›ld_®Ÿs
;

21 
$this
->
v›w
->
row_šdex
 = 0;

22 
	`fÜ—ch
 (
$£ts
 
as
 
$t™Ë
 => 
$»cÜds
) {

23 
	`fÜ—ch
 (
$»cÜds
 
as
 
$Ïb–
 => 
$row
) {

24 
$»suÉs
[
$row
->{
$ba£_f›ld
}] = 
	`¬¿y
(

25 't™Ë' => 
$row
->{
$t™Ë_f›ld_®Ÿs
},

26 '»nd”ed' => 
$this
->
row_¶ugš
->
	`»nd”
(
$row
),

28 
$this
->
v›w
->
row_šdex
++;

31 
	`un£t
(
$this
->
v›w
->
row_šdex
);

32  
$»suÉs
;

34 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/content_copy/content_copy.module

1 <?
php


34 
funùiÚ
 
	$cÚ‹Á_cİy_m’u
() {

35 
$™ems
 = 
	`¬¿y
();

37 
$™ems
['admš/cÚ‹Á/ty³s/expÜt'] = 
	`¬¿y
(

40 '·g¬gum’ts' => 
	`¬¿y
('content_copy_export_form'),

41 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

42 'ty³' => 
MENU_LOCAL_TASK
,

45 
$™ems
['admš/cÚ‹Á/ty³s/impÜt'] = 
	`¬¿y
(

48 '·g¬gum’ts' => 
	`¬¿y
('content_copy_import_form'),

49 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

50 'ty³' => 
MENU_LOCAL_TASK
,

53  
$™ems
;

54 
	}
}

59 
funùiÚ
 
	$cÚ‹Á_cİy_theme
() {

60  
	`¬¿y
(

61 'cÚ‹Á_cİy_expÜt_fÜm' => 
	`¬¿y
(

63 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

66 
	}
}

71 
funùiÚ
 
	$cÚ‹Á_cİy_expÜt_fÜm
(&
$fÜm_¡©e
) {

72 
	`šşude_Úû
('./'. 
	`dru·l_g‘_·th
('module', 'content') .'/includes/content.admin.inc');

73 
	`šşude_Úû
('./'. 
	`dru·l_g‘_·th
('module', 'node') .'/content_types.inc');

75 
$fÜm_v®ues
 = 
	`is£t
(
$fÜm_¡©e
['v®ues']è? $fÜm_¡©e['v®ues'] : 
	`¬¿y
();

76 
$¡•
 = 
	`is£t
(
$fÜm_¡©e
['storage']['step']) ? $form_state['storage']['step'] + 1 : 1;

78 
$expÜbË_f›lds
 = 
	`¬¿y
();

79 
$groups
 = 
	`¬¿y
();

81 
$ty³_Çme
 = 
	`is£t
(
$fÜm_v®ues
['type_name']) ? $form_values['type_name'] : '';

82 ià(
$ty³_Çme
) {

83 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

84 
$expÜbË_f›lds
 = 
	`cÚ‹Á_cİy_f›lds
(
$ty³_Çme
);

85 ià(
	`moduË_exi¡s
('fieldgroup')) {

86 
$groups
 = 
	`f›ldgroup_groups
(
$ty³_Çme
);

92 ià(
$¡•
 =ğ2 && !(
$groups
è&& !(
$expÜbË_f›lds
)) {

93 
$¡•
 = 3;

96 
$fÜm
['#¡•'] = 
$¡•
;

97 
$fÜm
['#´efix'] = 
	`t
('This form will…rocess‡ contentype‡nd one or more fields fromhatype‡ndƒxporthe settings. Theƒxport created byhis…rocess can be copied‡nd…asted‡s‡n import intohe current or‡ny other database. The import will‡ddhe fieldso‡nƒxisting contentype or create‡‚ew contentypehat includeshe selected fields.');

99 
$¡•
) {

101 
$ty³s
 = 
	`cÚ‹Á_cİy_ty³s
();

102 
$fÜm
['ty³_Çme'] = 
	`¬¿y
(

103 '#t™Ë' => 
	`t
('Types'),

105 '#İtiÚs' => 
$ty³s
,

106 '#desütiÚ' => 
	`t
('Selecthe contentypeoƒxport.'),

111 
$fÜm
['ty³_Çme'] = 
	`¬¿y
(

113 '#v®ue' => 
$ty³_Çme
,

116 
$fÜm
 +ğ
	`¬¿y
(

117 '#f›lds' => 
$expÜbË_f›lds
,

118 '#groups' => 
	`¬¿y_keys
(
$groups
),

121 
$f›lds_İtiÚs
 = 
$groups_İtiÚs
 = 
	`¬¿y
();

124 
	`fÜ—ch
 (
$expÜbË_f›lds
 
as
 
$f›ld_Çme
) {

125 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
, 
$ty³_Çme
);

126 
$f›lds_İtiÚs
[
$f›ld_Çme
] = '';

127 
$weight
 = 
$f›ld
['widget']['weight'];

128 
$fÜm
[
$f›ld_Çme
] = 
	`¬¿y
(

129 'humª_Çme' => 
	`¬¿y
('#v®ue' => 
	`check_¶aš
(
$f›ld
['widget']['label'])),

130 'f›ld_Çme' => 
	`¬¿y
('#v®ue' => 
$f›ld
['field_name']),

131 'ty³' => 
	`¬¿y
('#v®ue' => 
$f›ld
['type']),

132 'weight' => 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$weight
),

133 '·»Á' => 
	`¬¿y
('#type' => 'value', '#value' => ''),

137 
$fÜm
['f›lds'] = 
	`¬¿y
(

139 '#İtiÚs' => 
$f›lds_İtiÚs
,

140 '#deçuÉ_v®ue' => 
	`¬¿y_keys
(
$f›lds_İtiÚs
),

144 
	`fÜ—ch
 (
$groups
 
as
 
$Çme
 => 
$group
) {

145 
$groups_İtiÚs
[
$Çme
] = '';

146 
$weight
 = 
$group
['weight'];

147 
$fÜm
[
$Çme
] = 
	`¬¿y
(

148 'humª_Çme' => 
	`¬¿y
('#v®ue' => 
	`check_¶aš
(
$group
['label'])),

149 'group_Çme' => 
	`¬¿y
('#v®ue' => 
$group
['group_name']),

150 'weight' => 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$weight
),

153 
	`fÜ—ch
 (
$group
['f›lds'] 
as
 
$f›ld_Çme
 => 
$f›ld
) {

155 ià(
	`is£t
(
$fÜm
[
$f›ld_Çme
])) {

156 
$fÜm
[
$f›ld_Çme
]['·»Á']['#v®ue'] = 
$Çme
;

160 ià(
$groups
) {

161 
$fÜm
['groups'] = 
	`¬¿y
(

163 '#İtiÚs' => 
$groups_İtiÚs
,

164 '#deçuÉ_v®ue' => 
	`¬¿y_keys
(
$groups_İtiÚs
),

170 
$GLOBALS
['content_copy']['count'] = 0;

171 
$fÜm
['expÜt'] = 
	`¬¿y
(

172 '#t™Ë' => 
	`t
('Export data'),

175 '#v®ue' => 
	`cÚ‹Á_cİy_expÜt
(
$fÜm_v®ues
),

176 '#rows' => 
	`max
(40, 
$GLOBALS
['content_copy']['count']),

177 '#desütiÚ' => 
	`t
('Copyheƒxportext‡nd…aste it into‡nother contentype usinghe import function.'),

181 
	`dru·l_£t_t™Ë
(
	`t
('Contentypes'));

185 ià(
$¡•
 < 3) {

186 
$fÜm
['subm™'] = 
	`¬¿y
(

188 '#v®ue' => 
	`t
('Export'),

192 
$fÜm
['¡•'] = 
	`¬¿y
(

194 '#v®ue' => 
$¡•
,

197  
$fÜm
;

198 
	}
}

200 
funùiÚ
 
	$cÚ‹Á_cİy_expÜt_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

201 
$fÜm_¡©e
['»bud'] = 
TRUE
;

202 
$fÜm_¡©e
['storage']['step'] = $form_state['values']['step'];

203 
	}
}

210 
funùiÚ
 
	$cÚ‹Á_cİy_expÜt
(
$fÜm_v®ues
) {

212 
$GLOBALS
['content_copy']['status'] = 'export';

215 
$node_¡©e
 = 
	`¬¿y
('v®ues' =>‡¼ay('ty³_Çme' => 
$fÜm_v®ues
['type_name']));

216 
	`moduË_lßd_šşude
('inc', 'node', 'content_types');

217 
	`dru·l_execu‹
('node_ty³_fÜm', 
$node_¡©e
, 
	`node_g‘_ty³s
('ty³', 
$fÜm_v®ues
['type_name']));

219 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.admin');

220 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

224 
$groups
 = 
	`¬¿y
();

225 ià(!
	`em±y
(
$fÜm_v®ues
['groups']è&& 
	`moduË_exi¡s
('fieldgroup')) {

226 
$groups
 = 
	`¬¿y_f‹r
(
$fÜm_v®ues
['groups']);

227 
	`fÜ—ch
 (
$groups
 
as
 
$group
) {

228 
$group_¡©e
 = 
	`¬¿y
('v®ues' =>‡¼ay('group_Çme' => 
$group
));

229 
	`dru·l_execu‹
('f›ldgroup_group_ed™_fÜm', 
$group_¡©e
, 
$fÜm_v®ues
['ty³_Çme'], 
$group
, 'edit');

237 ià(!
	`em±y
(
$fÜm_v®ues
['fields'])) {

238 
$ty³
 = 
	`cÚ‹Á_ty³s
(
$fÜm_v®ues
['type_name']);

239 
$f›lds
 = 
	`¬¿y_f‹r
(
$fÜm_v®ues
['fields']);

240 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld_Çme
) {

241 
$f›ld
 = 
$ty³
['f›lds'][
$f›ld_Çme
];

242 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

243 
$f›ld_moduË
 = 
$f›ld_ty³s
[
$f›ld
['type']]['module'];

244 
$widg‘_ty³s
 = 
	`_cÚ‹Á_widg‘_ty³s
();

245 
$widg‘_moduË
 = 
$widg‘_ty³s
[
$f›ld
['widget']['type']]['module'];

246 ià(!
	`em±y
(
$f›ld_moduË
è&& 
	`moduË_exi¡s
($f›ld_moduËè&& !em±y(
$widg‘_moduË
) && module_exists($widget_module)) {

247 
$f›ld_¡©e
 = 
	`¬¿y
('v®ues' => 
	`cÚ‹Á_f›ld_š¡ªû_cŞÏp£
(
$f›ld
));

248 
$f›ld_¡©e
['v®ues']['İ'] = 
	`t
('Save field settings');

249 ià(
	`moduË_exi¡s
('fieldgroup')) {

251 
$f›ld_¡©e
['values']['group'] = '';

252 
$group_Çme
 = 
	`f›ldgroup_g‘_group
(
$fÜm_v®ues
['ty³_Çme'], 
$f›ld_Çme
);

253 ià(
	`š_¬¿y
(
$group_Çme
, 
$groups
)) {

254 
$f›ld_¡©e
['v®ues']['group'] = 
$group_Çme
;

257 
	`dru·l_execu‹
('cÚ‹Á_f›ld_ed™_fÜm', 
$f›ld_¡©e
, 
$fÜm_v®ues
['ty³_Çme'], 
$f›ld_Çme
);

263 
$ouut
 = 
	`cÚ‹Á_cİy_g‘_maüo
();

266 ià(
$exŒa
 = 
	`v¬ŸbË_g‘
('cÚ‹Á_exŒa_weights_'. 
$fÜm_v®ues
['ty³_Çme'], 
	`¬¿y
())) {

267 
$ouut
 .ğ"\$cÚ‹Á['exŒa'] = ". 
	`v¬_expÜt
((
¬¿y
è
$exŒa
, 
TRUE
) .";\n";

270  
$ouut
;

271 
	}
}

296 
funùiÚ
 
cÚ‹Á_cİy_impÜt_fÜm
(&
$fÜm_¡©e
, 
$ty³_Çme
 = '') {

297 
šşude_Úû
('./'. 
dru·l_g‘_·th
('module', 'content') .'/includes/content.admin.inc');

298 
šşude_Úû
('./'. 
dru·l_g‘_·th
('module', 'node') .'/content_types.inc');

300 
	g$fÜm
['#´efix'] = 
t
('This form will import field definitionsƒxported from‡nother contentype or‡nother database.<br/>Notehat fields cannot be duplicated withinhe same contentype, so imported fields will be‡dded only ifhey do‚ot‡lreadyƒxist inhe selectedype.');

301 
	g$fÜm
['ty³_Çme'] = 
¬¿y
(

303 '#İtiÚs' => 
¬¿y
('<ü—‹>' => 
t
('<C»©e>')è+ 
cÚ‹Á_cİy_ty³s
(),

304 '#deçuÉ_v®ue' => 
$ty³_Çme
,

305 '#t™Ë' => 
t
('Contentype'),

306 '#desütiÚ' => 
t
('Selecthe contentypeo importhese fields into.<br/>Select &lt;Create&gt;o create‡‚ew contentypeo containhe fields.'),

308 
	g$fÜm
['maüo'] = 
¬¿y
(

311 '#t™Ë' => 
t
('Import data'),

312 '#»quœed' => 
TRUE
,

313 '#desütiÚ' => 
t
('Pasteheext created by‡ contentƒxport intohis field.'),

315 
	g$fÜm
['subm™'] = 
¬¿y
(

317 '#v®ue' => 
t
('Import'),

320 ià(
is£t
(
$_REQUEST
['maüo_fe']è&& 
	g$fe
 = 
fe_g‘_cÚ‹Ás
($_REQUEST['macro_file'])) {

321 
$fÜm
['maüo']['#deçuÉ_v®ue'] = 
$fe
;

322 ià(
is£t
(
$_REQUEST
['type_name'])) {

323 
	g$fÜm
['ty³_Çme']['#deçuÉ_v®ue'] = 
$_REQUEST
['type_name'];

325 
	g$fÜm
['#´efix'] .ğ'<°şass="”rÜ">'. 
t
('A file has been…re-loaded for import.') .'</p>';

327  
	g$fÜm
;

336 
funùiÚ
 
	$cÚ‹Á_cİy_impÜt_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

337 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

340 
$ty³_Çme
 = 
$fÜm_v®ues
['type_name'];

341 
$ty³_Ïb–
 = 
	`node_g‘_ty³s
('Çme', 
$ty³_Çme
);

343 
$cÚ‹Á
 = 
NULL
;

347 @
	`ev®
(
$fÜm_v®ues
['macro']);

350 ià(!
	`is£t
(
$cÚ‹Á
è|| !is£t($cÚ‹Á['ty³']è|| !
	`is_¬¿y
($content) || !is_array($content['type'])) {

351 
	`fÜm_£t_”rÜ
('maüo', 
	`t
('The import data is‚ot valid importext.'));

355 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.crud');

358 
$cÚ‹Á_šfo
 = 
	`_cÚ‹Á_ty³_šfo
();

360 
$impÜ‹d_ty³
 = 
$cÚ‹Á
['type'];

361 
$impÜ‹d_ty³_Çme
 = 
$impÜ‹d_ty³
['type'];

362 
$impÜ‹d_ty³_Ïb–
 = 
$impÜ‹d_ty³
['name'];

366 
$impÜ‹d_f›lds
 = 
	`is£t
(
$cÚ‹Á
['f›lds']è? $cÚ‹Á['f›lds'] : 
	`¬¿y
();

370 
$nÙ_’abËd
 = 
	`¬¿y
();

374 
$impÜ‹d_groups
 = 
	`¬¿y
();

375 ià(
	`is£t
(
$cÚ‹Á
['groups']è&& 
	`moduË_exi¡s
('fieldgroup')) {

376 
$impÜ‹d_groups
 = (
¬¿y
è
$cÚ‹Á
['groups'];

378 
	`–£if
 (
	`is£t
(
$cÚ‹Á
['groups']è&& 
	`is_¬¿y
($content['groups'])) {

379 
$nÙ_’abËd
[] = 'fieldgroup';

383 
	`fÜ—ch
 (
$impÜ‹d_f›lds
 
as
 
$impÜt
) {

384 
$f›ld
 = 
	`cÚ‹Á_f›ld_š¡ªû_cŞÏp£
(
$impÜt
);

385 ià(
	`em±y
(
$f›ld
['module']) ||ƒmpty($field['widget_module'])) {

386 
$nÙ_’abËd
[] = 
$f›ld
['field_name'];

389 ià(!
	`moduË_exi¡s
(
$f›ld
['module'])) {

390 
$nÙ_’abËd
[] = 
$f›ld
['module'];

392 ià(!
	`moduË_exi¡s
(
$f›ld
['widget_module'])) {

393 
$nÙ_’abËd
[] = 
$f›ld
['widget_module'];

399 ià(
$nÙ_’abËd
) {

400 
	`fÜm_£t_”rÜ
('maüo', 
	`t
('ThfŞlowšg moduË mu¡ b’abËd fÜhi impÜˆtØwÜk: %moduËs.', 
	`¬¿y
(

401 '%moduËs' => 
	`im¶ode
(', ', 
	`¬¿y_unique
(
$nÙ_’abËd
))

406 ià(
$fÜm_v®ues
['type_name'] == '<create>') {

407 ià(
	`š_¬¿y
(
$impÜ‹d_ty³_Çme
, 
	`¬¿y_keys
(
$cÚ‹Á_šfo
['contentypes']))) {

408 
	`fÜm_£t_”rÜ
('maüo', 
	`t
('ThcÚ‹Áy³ %ty³‡Ì—dyƒxi¡ šhi d©aba£.', 
	`¬¿y
(

409 '%ty³' => 
$impÜ‹d_ty³_Çme


414 ià(
	`fÜm_g‘_”rÜs
()) {

415 
	`dru·l_£t_mes§ge
(
	`t
('Exiting. No import…erformed.'), 'error');

420 ià(
$fÜm_v®ues
['type_name'] == '<create>') {

422 
$ty³
 = (
objeù
è
$impÜ‹d_ty³
;

423 
$v®ues
 = 
$impÜ‹d_ty³
;

425 
$ty³
->
has_t™Ë
 = 
TRUE
;

426 
$ty³_fÜm_¡©e
 = 
	`¬¿y
('v®ues' => 
$v®ues
);

429 
	`dru·l_execu‹
('node_ty³_fÜm', 
$ty³_fÜm_¡©e
, 
$ty³
);

432 
$ty³_Çme
 = 
$impÜ‹d_ty³_Çme
;

433 
$ty³_Ïb–
 = 
	`node_g‘_ty³s
('Çme', 
$ty³_Çme
);

434 
	`cÚ‹Á_ş—r_ty³_ÿche
();

435 
$cÚ‹Á_šfo
 = 
	`_cÚ‹Á_ty³_šfo
();

437 ià(
	`fÜm_g‘_”rÜs
(è|| !
	`is£t
(
$cÚ‹Á_šfo
['cÚ‹Áy³s']è|| !
	`is_¬¿y
($cÚ‹Á_šfo['cÚ‹Áy³s'][
$ty³_Çme
])) {

438 
	`dru·l_£t_mes§ge
(
	`t
('AÀ”rÜ ha occu¼ed‡ddšghcÚ‹Áy³ %ty³.<br/>PËa£ checkh”rÜ di¥Ïyed fÜ mÜd‘as.', 
	`¬¿y
(

439 '%ty³' => 
$impÜ‹d_ty³_Çme


446 ià(
	`moduË_exi¡s
('f›ldgroup'è&& 
$impÜ‹d_groups
) {

447 
	`fÜ—ch
 (
$impÜ‹d_groups
 
as
 
$group
) {

448 
$group_Çme
 = 
$group
['group_name'];

449 
	`f›ldgroup_§ve_group
(
$ty³_Çme
, 
$group
);

452 
	`f›ldgroup_groups
('', 
FALSE
, 
TRUE
);

456 
$»bud
 = 
FALSE
;

457 
	`fÜ—ch
 (
$impÜ‹d_f›lds
 
as
 
$f›ld
) {

461 
$f›ld_Çme
 = 
$f›ld
['field_name'];

464 
$f›ld
['ty³_Çme'] = 
$ty³_Çme
;

466 ià(!
	`em±y
(
$f›ld
['f›ld_Çme']è&& 
	`is£t
(
$cÚ‹Á_šfo
['cÚ‹Áy³s'][
$ty³_Çme
]['f›lds'][
$f›ld_Çme
])) {

467 
	`dru·l_£t_mes§ge
(
	`t
('ThimpÜ‹d f›ld %f›ld_Ïb– (%f›ld_Çmeèwa nÙ‡ddedØ%ty³ beÿu£h© f›ld‡Ì—dyƒxi¡ š %ty³.', 
	`¬¿y
(

468 '%f›ld_Ïb–' => 
$f›ld
['Ïb–'], '%f›ld_Çme' => 
$f›ld_Çme
, '%ty³' => 
$ty³_Ïb–
)));

471 
$f›ld
 = 
	`cÚ‹Á_f›ld_š¡ªû_ü—‹
($f›ld, 
FALSE
);

472 
$»bud
 = 
TRUE
;

473 
	`dru·l_£t_mes§ge
(
	`t
('Thf›ld %f›ld_Ïb– (%f›ld_Çmeèwa addedØthcÚ‹Áy³ %ty³.', 
	`¬¿y
(

474 '%f›ld_Ïb–' => 
$f›ld
['widg‘']['Ïb–'], '%f›ld_Çme' => 
$f›ld_Çme
, '%ty³' => 
$ty³_Ïb–
)));

482 ià(
	`moduË_exi¡s
('f›ldgroup'è&& 
	`is£t
(
$impÜ‹d_groups
)) {

483 
	`f›ldgroup_upd©e_f›lds
(
$f›ld
);

488 ià(
$»bud
) {

489 
	`cÚ‹Á_ş—r_ty³_ÿche
(
TRUE
);

490 
	`m’u_»bud
();

494 ià(
	`is£t
(
$cÚ‹Á
['extra'])) {

495 
	`v¬ŸbË_£t
('cÚ‹Á_exŒa_weights_'. 
$ty³_Çme
, 
$cÚ‹Á
['extra']);

497 
	}
}

503 
funùiÚ
 
	$cÚ‹Á_cİy_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

504 
$®‹r_fÜms
 = 
	`¬¿y
('node_type_form', 'content_field_edit_form', 'fieldgroup_group_edit_form');

505 ià(
	`is£t
(
$GLOBALS
['cÚ‹Á_cİy']è&& is£t($GLOBALS['cÚ‹Á_cİy']['¡©us']è&& $GLOBALS['cÚ‹Á_cİy']['¡©us'] =ğ'expÜt' && 
	`š_¬¿y
(
$fÜm_id
, 
$®‹r_fÜms
)) {

506 
$fÜm
['#submit'][] = 'content_copy_record_macro';

508 
	}
}

513 
funùiÚ
 
	$cÚ‹Á_cİy_f›lds
(
$ty³_Çme
) {

514 
$f›lds
 = 
	`¬¿y
();

515 ià(!
$ty³_Çme
) {

516  
$f›lds
;

518 
$cÚ‹Á_šfo
 = 
	`_cÚ‹Á_ty³_šfo
();

519 
	`fÜ—ch
 (
$cÚ‹Á_šfo
['cÚ‹Áy³s'][
$ty³_Çme
]['f›lds'] 
as
 
$f›ld_Çme
 => 
$f›ld
) {

522 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

523 
$f›ld_moduË
 = 
$f›ld_ty³s
[
$f›ld
['type']]['module'];

524 
$widg‘_ty³s
 = 
	`_cÚ‹Á_widg‘_ty³s
();

525 
$widg‘_moduË
 = 
$widg‘_ty³s
[
$f›ld
['widget']['type']]['module'];

527 ià(!
$f›ld
['locked'] && !
	`em±y
(
$f›ld_moduË
è&& 
	`moduË_exi¡s
($f›ld_moduËè&& !em±y(
$widg‘_moduË
) && module_exists($widget_module)) {

528 
$f›lds
[] = 
$f›ld_Çme
;

531  
$f›lds
;

532 
	}
}

537 
funùiÚ
 
	$cÚ‹Á_cİy_ty³s
() {

538 
$ty³s
 = 
	`¬¿y
();

539 
$cÚ‹Á_šfo
 = 
	`_cÚ‹Á_ty³_šfo
();

540 
	`fÜ—ch
 (
$cÚ‹Á_šfo
['cÚ‹Áy³s'] 
as
 
$ty³_Çme
 => 
$v®
) {

541 
$ty³s
[
$ty³_Çme
] = 
	`check_¶aš
(
$v®
['name']) .' ('. $type_name .')';

543  
$ty³s
;

544 
	}
}

549 
funùiÚ
 
	$cÚ‹Á_cİy_»cÜd_maüo
(
$fÜm
, &
$fÜm_¡©e
) {

550 
$ed™
 = 
$fÜm_¡©e
['values'];

551 
$subs
 = 
	`is£t
(
$GLOBALS
['cÚ‹Á_cİy']['submissiÚs']è? $GLOBALS['cÚ‹Á_cİy']['submissiÚs'] : 
	`¬¿y
();

557 
$fÜm_id
 = 
$fÜm_¡©e
['values']['form_id'];

558 ià(
	`is£t
(
$ed™
['type_name']) || isset($edit['submit']) || isset($edit['delete']) || isset($edit['form_id'])) {

559 
	`un£t
(
$ed™
['type_name'], $edit['submit'], $edit['delete'], $edit['form_id'], $edit['previous_field']);

561 
$fÜm_id
) {

563 
$subs
['ty³'] = 
$ed™
;

564 
$GLOBALS
['cÚ‹Á_cİy']['couÁ'] +ğ(
$ed™
) + 5;

568 
$subs
['groups'][] = 
$ed™
;

569 
$GLOBALS
['cÚ‹Á_cİy']['couÁ'] +ğ(
$ed™
) + 5;

573 ià(
	`is£t
(
$ed™
['field_widget_type'])) {

574 
$tmp
 = 
	`ex¶ode
('-', 
$ed™
['field_widget_type']);

575 
$f›ld_Çme
 = 
$tmp
[0];

578 
$f›ld_Çme
 = 
	`is£t
(
$ed™
['field_name']) ? $edit['field_name'] : '';

584 
$qu”y
 = 'SELECT di¥Ïy_£‰šg FROM {'. 
	`cÚ‹Á_š¡ªû_bËÇme
() .'} WHERE field_name = \'%s\'';

585 
$row_šfo
 = 
	`db_ãtch_¬¿y
(
	`db_qu”y
(
$qu”y
, 
$f›ld_Çme
));

588 ià(
$db_”r
 = 
	`db_”rÜ
()) {

589 
	`dru·l_£t_mes§ge
(
	`t
("AÀ”rÜ occu¼ed wh’ƒxpÜtšgh'di¥Ïy s‘tšgs' d©¨fÜhf›ld %f›ld_Çme.<br/>Thdbƒ¼Ü is: '%db_”r'.", 
	`¬¿y
(

590 '%f›ld_Çme' => 
$f›ld_Çme
,

591 '%db_”r' => 
$db_”r


597 ià(
$di¥Ïy_£‰šgs
 = 
	`un£rŸlize
(
$row_šfo
['display_settings'])) {

598 
$ed™
['di¥Ïy_£‰šgs'] = 
$di¥Ïy_£‰šgs
;

601 
$subs
['f›lds'][] = 
$ed™
;

602 
$GLOBALS
['cÚ‹Á_cİy']['couÁ'] +ğ(
$ed™
) + 5;

606 
$GLOBALS
['cÚ‹Á_cİy']['submissiÚs'] = 
$subs
;

607 
	}
}

612 
funùiÚ
 
	$cÚ‹Á_cİy_g‘_maüo
() {

614 
$¡ršg
 = "";

615 ià(
	`¬¿y_key_exi¡s
('submissiÚs', 
$GLOBALS
['content_copy'])) {

616 
	`fÜ—ch
 (
$GLOBALS
['cÚ‹Á_cİy']['submissiÚs'] 
as
 
$fÜm_ty³
 => 
$fÜm
) {

617 
$¡ršg
 .ğ"\$cÚ‹Á['$fÜm_ty³'] = ". 
	`v¬_expÜt
((
¬¿y
è
$fÜm
, 
TRUE
) .";\n";

619  
$¡ršg
;

621 
	}
}

623 
funùiÚ
 
	$‹m¶©e_´•roûss_cÚ‹Á_cİy_expÜt_fÜm
(
$v¬s
) {

624 
$fÜm
 = &
$v¬s
['form'];

626 ià(
$fÜm
['#step'] == 2) {

627 
$Üd”
 = 
	`_cÚ‹Á_ov”v›w_Üd”
(
$fÜm
, $form['#fields'], $form['#groups']);

629 
$rows
 = 
	`¬¿y
();

630 
	`fÜ—ch
 (
$Üd”
 
as
 
$key
) {

631 
$–em’t
 = &
$fÜm
[
$key
];

632 
$row
 = 
Ãw
 
	`¡dCÏss
();

634 
$row
->
row_ty³
 = 
$–em’t
['#row_type'];

635 
$checkbox_key
 = 
$–em’t
['#row_type'] == 'field' ? 'fields' : 'groups';

636 
$row
->
checkbox
 = 
	`dru·l_»nd”
(
$fÜm
[
$checkbox_key
][
$key
]);

637 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$–em’t
è
as
 
$chd
) {

638 
$row
->{
$chd
} = 
	`dru·l_»nd”
(
$–em’t
[$child]);

640 
$row
->
Ïb–_şass
 = 
	`š_¬¿y
(
$key
, 
$fÜm
['#groups']) ? 'label-group' : 'label-field';

641 
$row
->
šd’tiÚ
 = 
	`theme
('šd’tiÚ', 
	`is£t
(
$–em’t
['#depth']) ? $element['#depth'] : 0);

643 
$rows
[] = 
$row
;

645 
$v¬s
['rows'] = 
$rows
;

648 
$v¬s
['subm™'] = 
	`dru·l_»nd”
(
$fÜm
);

649 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/content_copy/content_copy_export_form.tpl.php

1 <?
php


4 ià(
	g$fÜm
['#step'] == 2):

5 ià(
$rows
): ?>

6 <
bË
 
id
="cÚ‹Á-cİy-expÜt" 
şass
="sticky-enabled">

7 <
th—d
>

8 <
Œ
>

9 <
th
><?
php
 
´št
 
t
('ExpÜt'); ?></
	gth
>

10 <
	gth
><?
php
 
´št
 
t
('Label'); ?></th>

11 <
	gth
><?
php
 
´št
 
t
('Name'); ?></th>

12 <
	gth
><?
php
 
´št
 
t
('Type'); ?></th>

13 </
	gŒ
>

14 </
	gth—d
>

15 <
	gtbody
>

16 <?
php


17 
	g$couÁ
 = 0;

18 
	$fÜ—ch
 (
$rows
 
as
 
$row
): ?>

19 <
Œ
 
şass
="<?php…rint $count % 2 == 0 ? 'odd' : 'even'; ?>">

20 <?
php


21 
$row
->
row_ty³
):

23 <
td
><?
php
 
´št
 
$row
->
checkbox
; ?></td>

24 <
td
><?
php
 
´št
 
$row
->
šd’tiÚ
; ?><
¥ª
 
şass
="<?ph°´šˆ$row->Ïb–_şass; ?>"><?ph°´šˆ$row->
humª_Çme
; ?></span></td>

25 <
td
><?
php
 
´št
 
$row
->
f›ld_Çme
; ?></td>

26 <
td
><?
php
 
´št
 
$row
->
ty³
; ?></td>

27 <?
php
 ;

29 <
td
><?
php
 
´št
 
$row
->
checkbox
; ?></td>

30 <
td
><?
php
 
´št
 
$row
->
šd’tiÚ
; ?><
¥ª
 
şass
="<?ph°´šˆ$row->Ïb–_şass; ?>"><?ph°´šˆ$row->
humª_Çme
; ?></span></td>

31 <
td
 
cŞ¥ª
="2"><?
php
 
´št
 
$row
->
group_Çme
; ?></td>

32 <?
php
 ;

33 
’dsw™ch
; ?>

34 </
Œ
>

35 <?
php
 
$couÁ
++;

36 
’dfÜ—ch
; ?>

37 </
tbody
>

38 </
bË
>

39 <?
php
 
’dif
;

40 
’dif
;

41 
´št
 
$subm™
; ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/content_permissions/content_permissions.module

1 <?
php


7 
funùiÚ
 
	$cÚ‹Á_³rmissiÚs_³rm
() {

8 
$³rms
 = 
	`¬¿y
();

9 
	`fÜ—ch
 (
	`cÚ‹Á_f›lds
(è
as
 
$f›ld
) {

10 
$³rms
[] = 'ed™ '. 
$f›ld
['field_name'];

11 
$³rms
[] = 'v›w '. 
$f›ld
['field_name'];

13  
$³rms
;

14 
	}
}

21 
funùiÚ
 
	$cÚ‹Á_³rmissiÚs_f›ld_acûss
(
$İ
, 
$f›ld
, 
$accouÁ
, 
$node
 = 
NULL
) {

22 
$İ
) {

25  
	`u£r_acûss
(
$İ
 .' '. 
$f›ld
['f›ld_Çme'], 
$accouÁ
);

27  
TRUE
;

28 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/fieldgroup/fieldgroup-simple.tpl.php

1 <?
	gphp


18 <?
php
 ià(
	g$cÚ‹Á
) : ?>

19 <
div
 
şass
="fieldgroup <?php…rint $group_name_css; ?>">

21 <?
php
 ià(
$Ïb–
): ?>

22 <
h2
><?
php
 
´št
 
$Ïb–
; ?></
	gh2
>

24 <?
php
 ià(
	g$desütiÚ
): ?>

25 <
div
 
şass
="desütiÚ"><?
php
 
´št
 
$desütiÚ
; ?></
	gdiv
>

26 <?
php
 
	g’dif
; ?>

28 <?
php
 
	g’dif
; ?>

30 <
div
 
	gşass
="cÚ‹Á"><?
php
 
´št
 
$cÚ‹Á
; ?></
	gdiv
>

32 </
	gdiv
>

33 <?
php
 
	g’dif
; ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/fieldgroup/fieldgroup.module

1 <?
php


18 
funùiÚ
 
	$f›ldgroup_š™
() {

19 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'fieldgroup') .'/fieldgroup.css');

20 
	}
}

25 
funùiÚ
 
	$f›ldgroup_ùoŞs_¶ugš_dœeùÜy
(
$moduË
, 
$¶ugš
) {

26 ià(
$moduË
 =ğ'ùoŞs' && 
$¶ugš
 == 'content_types') {

27  '·Ãls/' . 
$¶ugš
;

29 
	}
}

34 
funùiÚ
 
	$f›ldgroup_m’u
() {

35 
$™ems
 = 
	`¬¿y
();

39 ià(!
	`defšed
('MAINTENANCE_MODE')) {

40 
	`fÜ—ch
 (
	`node_g‘_ty³s
(è
as
 
$ty³
) {

41 
$ty³_Çme
 = 
$ty³
->
ty³
;

42 
$cÚ‹Á_ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

43 
$ty³_u¾_¡r
 = 
$cÚ‹Á_ty³
['url_str'];

44 
$™ems
['admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
 .'/groups/%'] = 
	`¬¿y
(

47 '·g¬gum’ts' => 
	`¬¿y
('f›ldgroup_group_ed™_fÜm', 
$ty³_Çme
, 5),

48 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

49 'ty³' => 
MENU_CALLBACK
,

51 
$™ems
['admš/cÚ‹Á/node-ty³/'. 
$ty³_u¾_¡r
 .'/groups/%/»move'] = 
	`¬¿y
(

54 '·g¬gum’ts' => 
	`¬¿y
('f›ldgroup_»move_group', 
$ty³_Çme
, 5),

55 'acûs ¬gum’ts' => 
	`¬¿y
('administer contentypes'),

56 'ty³' => 
MENU_CALLBACK
,

60  
$™ems
;

61 
	}
}

66 
funùiÚ
 
	$f›ldgroup_theme
() {

67  
	`¬¿y
(

68 'f›ldgroup_sim¶e' => 
	`¬¿y
(

70 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

72 'f›ldgroup_f›ld£t' => 
	`¬¿y
(

73 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

75 'f›ldgroup_di¥Ïy_ov”v›w_fÜm' => 
	`¬¿y
(

76 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

79 
	}
}

84 
funùiÚ
 
	$f›ldgroup_–em’ts
() {

85  
	`¬¿y
(

86 'f›ldgroup_sim¶e' => 
	`¬¿y
(),

87 'f›ldgroup_f›ld£t' => 
	`¬¿y
('#cŞÏpsibË' => 
FALSE
, '#cŞÏp£d' => FALSE, '#v®ue' => 
NULL
,),

89 
	}
}

94 
funùiÚ
 
	$f›ldgroup_cÚ‹Á_f›ld­i
(
$İ
, 
$f›ld
) {

95 
$İ
) {

97 
	`db_qu”y
("DELETE FROM {". 
	`f›ldgroup_f›lds_bËÇme
(è."} WHERE f›ld_Çmğ'%s' ANDy³_Çmğ'%s'", 
$f›ld
['field_name'], $field['type_name']);

98 
	`ÿche_ş—r_®l
('f›ldgroup_d©a:', 
	`cÚ‹Á_ÿche_bËÇme
(), 
TRUE
);

101 
	}
}

103 
funùiÚ
 
	$f›ldgroup_group_ed™_fÜm
(&
$fÜm_¡©e
, 
$ty³_Çme
, 
$group_Çme
) {

104 
$cÚ‹Á_ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

105 
$groups
 = 
	`f›ldgroup_groups
(
$cÚ‹Á_ty³
['type']);

107 ià(!
$group
 = 
$groups
[
$group_Çme
]) {

108 
	`dru·l_nÙ_found
();

109 
ex™
;

112 
$fÜm
['Ïb–'] = 
	`¬¿y
(

114 '#t™Ë' => 
	`t
('Label'),

115 '#deçuÉ_v®ue' => 
$group
['label'],

116 '#»quœed' => 
TRUE
,

121 
$group_ty³
 = !
	`em±y
(
$group
['group_type']) ? $group['group_type'] : 'standard';

122 
$fÜm
['group_ty³'] = 
	`¬¿y
('#ty³' => 'hidd’', '#deçuÉ_v®ue' => 
$group_ty³
);

124 
$fÜm
['£‰šgs']['#Œ“'] = 
TRUE
;

125 
$fÜm
['£‰šgs']['fÜm'] = 
	`¬¿y
(

127 '#t™Ë' => 
	`t
('Form settings'),

128 '#desütiÚ' => 
	`t
('These settings‡pplyohe group inhe‚odeƒditing form.'),

130 
$fÜm
['£‰šgs']['fÜm']['¡yË'] = 
	`¬¿y
(

132 '#t™Ë' => 
	`t
('Style'),

133 '#deçuÉ_v®ue' => 
$group
['settings']['form']['style'],

134 '#İtiÚs' => 
	`¬¿y
(

135 'f›ld£t' => 
	`t
('always open'),

136 'f›ld£t_cŞÏpsibË' => 
	`t
('collapsible'),

137 'f›ld£t_cŞÏp£d' => 
	`t
('collapsed'),

140 
$fÜm
['£‰šgs']['fÜm']['desütiÚ'] = 
	`¬¿y
(

142 '#t™Ë' => 
	`t
('Helpext'),

143 '#deçuÉ_v®ue' => 
$group
['settings']['form']['description'],

145 '#desütiÚ' => 
	`t
('Instructionso…resentohe user onheƒditing form.'),

146 '#»quœed' => 
FALSE
,

148 
$fÜm
['£‰šgs']['di¥Ïy'] = 
	`¬¿y
(

150 '#t™Ë' => 
	`t
('Display settings'),

151 '#desütiÚ' => 
	`t
('These settings‡pplyohe group on‚ode display.'),

153 
$fÜm
['£‰šgs']['di¥Ïy']['desütiÚ'] = 
	`¬¿y
(

155 '#t™Ë' => 
	`t
('Description'),

156 '#deçuÉ_v®ue' => 
$group
['settings']['display']['description'],

158 '#desütiÚ' => 
	`t
('A description ofhe group.'),

159 '#»quœed' => 
FALSE
,

162 
	`fÜ—ch
 (
	`¬¿y_keys
(
	`cÚ‹Á_bud_modes
()è
as
 
$key
) {

163 
$fÜm
['£‰šgs']['di¥Ïy'][
$key
]['fÜm©'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
	`is£t
(
$group
['settings']['display'][$key]['format']) ? $group['settings']['display'][$key]['format'] : 'fieldset');

164 
$fÜm
['£‰šgs']['di¥Ïy'][
$key
]['exşude'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
	`is£t
(
$group
['settings']['display'][$key]['exclude']) ? $group['settings']['display'][$key]['exclude'] : 0);

166 
$fÜm
['£‰šgs']['di¥Ïy']['Ïb–'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$group
['settings']['display']['label']);

167 
$fÜm
['weight'] = 
	`¬¿y
('#ty³' => 'hidd’', '#deçuÉ_v®ue' => 
$group
['weight']);

168 
$fÜm
['group_Çme'] = 
	`¬¿y
('#ty³' => 'hidd’', '#deçuÉ_v®ue' => 
$group_Çme
);

170 
$fÜm
['#cÚ‹Á_ty³'] = 
$cÚ‹Á_ty³
;

172 
$fÜm
['subm™'] = 
	`¬¿y
(

174 '#v®ue' => 
	`t
('Save'),

178  
$fÜm
;

179 
	}
}

181 
funùiÚ
 
	$f›ldgroup_group_ed™_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

182 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

183 
$cÚ‹Á_ty³
 = 
$fÜm
['#content_type'];

184 
	`f›ldgroup_§ve_group
(
$cÚ‹Á_ty³
['ty³'], 
$fÜm_v®ues
);

185 
$fÜm_¡©e
['»dœeù'] = 'admš/cÚ‹Á/node-ty³/'. 
$cÚ‹Á_ty³
['url_str'] .'/fields';

186 
	}
}

188 
funùiÚ
 
	$f›ldgroup_»move_group
(&
$fÜm_¡©e
, 
$ty³_Çme
, 
$group_Çme
) {

189 
$cÚ‹Á_ty³
 = 
	`cÚ‹Á_ty³s
(
$ty³_Çme
);

190 
$groups
 = 
	`f›ldgroup_groups
(
$cÚ‹Á_ty³
['type']);

191 
$group
 = 
	`is£t
(
$groups
[
$group_Çme
]) ? $groups[$group_name] : '';

193 ià(
	`em±y
(
$group
)) {

194 
	`dru·l_nÙ_found
();

195 
ex™
;

198 
$fÜm
['#submit'][] = 'fieldgroup_remove_group_submit';

199 
$fÜm
['#cÚ‹Á_ty³'] = 
$cÚ‹Á_ty³
;

200 
$fÜm
['#group_Çme'] = 
$group_Çme
;

202  
	`cÚfœm_fÜm
(
$fÜm
,

203 
	`t
('Are you sure you wanto„emovehe group %label?',

204 
	`¬¿y
('%Ïb–' => 
	`t
(
$group
['label']))),

205 'admš/cÚ‹Á/node-ty³/'. 
$cÚ‹Á_ty³
['u¾_¡r'] .'/f›lds', 
	`t
('This‡ction cannot be undone.'),

206 
	`t
('Remove'),('Cancel'));

207 
	}
}

209 
funùiÚ
 
	$f›ldgroup_»move_group_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

210 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

211 
$cÚ‹Á_ty³
 = 
$fÜm
['#content_type'];

212 
$group_Çme
 = 
$fÜm
['#group_name'];

213 
	`f›ldgroup_d–‘e
(
$cÚ‹Á_ty³
['ty³'], 
$group_Çme
);

214 
	`dru·l_£t_mes§ge
(
	`t
('Thgrou°%group_Çmha b“À»moved.', 
	`¬¿y
('%group_Çme' => 
$group_Çme
)));

215 
$fÜm_¡©e
['»dœeù'] = 'admš/cÚ‹Á/node-ty³/'. 
$cÚ‹Á_ty³
['url_str'] .'/fields';

216 
	}
}

221 
funùiÚ
 
f›ldgroup_groups
(
$cÚ‹Á_ty³
 = '', 
$sÜ‹d
 = 
FALSE
, 
$»£t
 = FALSE) {

222 
glob®
 
$Ïnguage
;

223 
	g$groups
, 
	g$groups_sÜ‹d
;

224 ià(!
is£t
(
$groups
è|| 
	g$»£t
) {

225 ià(
	g$ÿched
 = 
ÿche_g‘
('f›ldgroup_d©a:'. 
$Ïnguage
->
Ïnguage
, 
cÚ‹Á_ÿche_bËÇme
())) {

226 
	g$d©a
 = 
$ÿched
->
d©a
;

227 
	g$groups
 = 
$d©a
['groups'];

228 
	g$groups_sÜ‹d
 = 
$d©a
['groups_sorted'];

231 
	g$»suÉ
 = 
db_qu”y
("SELECT * FROM {". 
f›ldgroup_bËÇme
() ."} ORDER BY weight, group_name");

232 
	g$groups
 = 
¬¿y
();

233 
	g$groups_sÜ‹d
 = 
¬¿y
();

234 
	g$group
 = 
db_ãtch_¬¿y
(
$»suÉ
)) {

235 
$group
['£‰šgs'] = 
un£rŸlize
($group['settings']);

236 
	g$group
['f›lds'] = 
¬¿y
();

239 
	g$group_¡ršgs
 = 
¬¿y
(

240 'Ïb–' => 
$group
['label'],

241 'fÜm_desütiÚ' => 
$group
['settings']['form']['description'],

242 'di¥Ïy_desütiÚ' => 
$group
['settings']['display']['description'],

244 
dru·l_®‹r
('cÚ‹Á_f›ldgroup_¡ršgs', 
$group_¡ršgs
, 
$group
['type_name'], $group['group_name']);

245 
	g$group
['Ïb–'] = 
$group_¡ršgs
['label'];

246 
	g$group
['£‰šgs']['fÜm']['desütiÚ'] = 
$group_¡ršgs
['form_description'];

247 
	g$group
['£‰šgs']['di¥Ïy']['desütiÚ'] = 
$group_¡ršgs
['display_description'];

249 
	g$groups
[
$group
['type_name']][$group['group_name']] = $group;

250 
	g$groups_sÜ‹d
[
$group
['ty³_Çme']][] = &
$groups
[$group['type_name']][$group['group_name']];

253 
	g$»suÉ
 = 
db_qu”y
("SELECT‚fi.*,‚g.group_ÇmFROM {". 
f›ldgroup_bËÇme
() ."}‚g ".

254 "INNER JOIN {". 
f›ldgroup_f›lds_bËÇme
() ."}‚gf ON‚gf.type_name =‚g.type_name AND‚gf.group_name =‚g.group_name ".

255 "INNER JOIN {". 
cÚ‹Á_š¡ªû_bËÇme
() ."}‚fi ON‚fi.field_name =‚gf.field_name AND‚fi.type_name =‚gf.type_name ".

257 
	g$f›ld
 = 
db_ãtch_¬¿y
(
$»suÉ
)) {

259 
$f›ld_¡ršgs
 = 
¬¿y
(

260 'widg‘_Ïb–' => 
$f›ld
['label'],

261 'widg‘_desütiÚ' => 
$f›ld
['description'],

263 
dru·l_®‹r
('cÚ‹Á_f›ld_¡ršgs', 
$f›ld_¡ršgs
, 
$f›ld
['type_name'], $field['field_name']);

264 
	g$f›ld
['Ïb–'] = 
$f›ld_¡ršgs
['widget_label'];

265 
	g$f›ld
['desütiÚ'] = 
$f›ld_¡ršgs
['widget_description'];

267 
	g$groups
[
$f›ld
['type_name']][$field['group_name']]['fields'][$field['field_name']] = $field;

269 
ÿche_£t
('f›ldgroup_d©a:'. 
$Ïnguage
->
Ïnguage
, 
¬¿y
('groups' => 
$groups
, 'groups_sÜ‹d' => 
$groups_sÜ‹d
), 
cÚ‹Á_ÿche_bËÇme
());

272 ià(
em±y
(
$cÚ‹Á_ty³
)) {

273  
	g$groups
;

275 
–£if
 (
em±y
(
$groups
è||ƒm±y($groups[
$cÚ‹Á_ty³
])) {

276  
¬¿y
();

278  
	g$sÜ‹d
 ? 
	g$groups_sÜ‹d
[
$cÚ‹Á_ty³
] : 
$groups
[$content_type];

282 
funùiÚ
 
	$_f›ldgroup_groups_Ïb–
(
$cÚ‹Á_ty³
) {

283 
$groups
 = 
	`f›ldgroup_groups
(
$cÚ‹Á_ty³
);

285 
$Ïb–s
[''] = '<'. 
	`t
('none') .'>';

286 
	`fÜ—ch
 (
$groups
 
as
 
$group_Çme
 => 
$group
) {

287 
$Ïb–s
[
$group_Çme
] = 
	`t
(
$group
['label']);

289  
$Ïb–s
;

290 
	}
}

292 
funùiÚ
 
	$_f›ldgroup_f›ld_g‘_group
(
$cÚ‹Á_ty³
, 
$f›ld_Çme
) {

293  
	`db_»suÉ
(
	`db_qu”y
("SELECT group_ÇmFROM {". 
	`f›ldgroup_f›lds_bËÇme
(è."} WHEREy³_Çmğ'%s' AND f›ld_Çmğ'%s'", 
$cÚ‹Á_ty³
, 
$f›ld_Çme
));

294 
	}
}

299 
funùiÚ
 
	$f›ldgroup_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

300 ià(
	`is£t
(
$fÜm
['ty³']è&& is£t($fÜm['#node']è&& $fÜm['ty³']['#v®ue'] .'_node_fÜm' =ğ
$fÜm_id
) {

301 
	`fÜ—ch
 (
	`f›ldgroup_groups
(
$fÜm
['ty³']['#v®ue']è
as
 
$group_Çme
 => 
$group
) {

302 
$fÜm
[
$group_Çme
] = 
	`¬¿y
(

304 '#t™Ë' => 
	`check_¶aš
(
	`t
(
$group
['label'])),

305 '#cŞÏp£d' => 
$group
['settings']['form']['style'] == 'fieldset_collapsed',

306 '#cŞÏpsibË' => 
	`š_¬¿y
(
$group
['£‰šgs']['fÜm']['¡yË'], 
	`¬¿y
('fieldset_collapsed', 'fieldset_collapsible')),

307 '#weight' => 
$group
['weight'],

308 '#desütiÚ' => 
	`cÚ‹Á_f‹r_xss
(
	`t
(
$group
['settings']['form']['description'])),

309 '#©Œibu‹s' => 
	`¬¿y
('şass' => 
	`¡¹r
(
$group
['group_name'], '_', '-')),

312 
$has_acûssibË_f›ld
 = 
FALSE
;

313 
	`fÜ—ch
 (
$group
['f›lds'] 
as
 
$f›ld_Çme
 => 
$f›ld
) {

314 ià(
	`is£t
(
$fÜm
[
$f›ld_Çme
])) {

315 
$fÜm
[
$group_Çme
][
$f›ld_Çme
] = $form[$field_name];

317 ià(!
	`is£t
(
$fÜm
[
$f›ld_Çme
]['#acûss']è|| $fÜm[$f›ld_Çme]['#acûss'] !=ğ
FALSE
) {

318 
$has_acûssibË_f›ld
 = 
TRUE
;

320 
	`un£t
(
$fÜm
[
$f›ld_Çme
]);

323 ià(!
	`em±y
(
$group
['f›lds']è&& !
	`–em’t_chd»n
(
$fÜm
[
$group_Çme
])) {

325 
	`un£t
(
$fÜm
[
$group_Çme
]);

328 ià(!
$has_acûssibË_f›ld
) {

330 
$fÜm
[
$group_Çme
]['#acûss'] = 
FALSE
;

336 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('f›ldgroup_fÜm'è
as
 
$moduË
) {

337 
$funùiÚ
 = 
$moduË
 .'_fieldgroup_form';

338 
	`$funùiÚ
(
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
, 
$group
);

346 
	`–£if
 (
$fÜm_id
 =ğ'cÚ‹Á_f›ld_ed™_fÜm' && 
	`is£t
(
$fÜm
['widget'])) {

347 
$cÚ‹Á_ty³
 = 
	`cÚ‹Á_ty³s
(
$fÜm
['type_name']['#value']);

348 
$fÜm
['widg‘']['group'] = 
	`¬¿y
(

350 '#v®ue' => 
	`_f›ldgroup_f›ld_g‘_group
(
$cÚ‹Á_ty³
['ty³'], 
$fÜm
['field_name']['#value']),

353 
	`–£if
 (
$fÜm_id
 == 'content_field_overview_form') {

354 
$fÜm
['#validate'][] = 'fieldgroup_field_overview_form_validate';

355 
$fÜm
['#submit'][] = 'fieldgroup_field_overview_form_submit';

357 
	`–£if
 (
$fÜm_id
 =ğ'cÚ‹Á_di¥Ïy_ov”v›w_fÜm' && !
	`em±y
(
$fÜm
['#groups'])) {

358 
$fÜm
['#submit'][] = 'fieldgroup_display_overview_form_submit';

359 ià(!
	`is£t
(
$fÜm
['submit'])) {

360 
$fÜm
['subm™'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Save'), '#weight' => 10);

363 
	`–£if
 (
$fÜm_id
 == 'content_field_remove_form') {

364 
$fÜm
['#submit'][] = 'fieldgroup_field_remove_form_submit';

366 
	}
}

373 
funùiÚ
 
	$f›ldgroup_v®id©e_Çme
(
$group
, 
$ty³_Çme
) {

374 
$”rÜs
 = 
	`¬¿y
();

377 ià(!
$group
['label']) {

378 
$”rÜs
['Ïb–'][] = 
	`t
('You‚eedo…rovide‡†abel.');

382 ià(!
$group
['group_name']) {

383 
$”rÜs
['group_Çme'][] = 
	`t
('You‚eedo…rovide‡ group‚ame.');

387 
$group_Çme
 = 
$group
['group_name'];

388 
$group
['group_ty³'] = !
	`em±y
($group['group_type']) ? $group['group_type'] : 'standard';

391 ià(
	`sub¡r
(
$group_Çme
, 0, 6) != 'group_') {

392 
$group_Çme
 = 'group_'. $group_name;

396 ià(!
	`´eg_m©ch
('!^group_[a-z0-9_]+$!', 
$group_Çme
)) {

397 
$”rÜs
['group_Çme'][] = 
	`t
('Thgrou°Çm%group_Çmi šv®id. ThÇmmu¡ inşudÚly†ow”ÿ£ uÇcûÁu©ed†‘‹rs,‚umb”s,‡nd und”scÜes.', 
	`¬¿y
('%group_Çme' => 
$group_Çme
));

399 ià(
	`¡¾’
(
$group_Çme
) > 32) {

400 
$”rÜs
['group_Çme'][] = 
	`t
('Thgrou°Çm%group_Çmi toØlÚg. ThÇmi lim™edØ32 ch¬aù”s, inşudšgh\'group_\'…»fix.', 
	`¬¿y
('%group_Çme' => 
$group_Çme
));

404 
$groups
 = 
	`f›ldgroup_groups
(
$ty³_Çme
);

405 ià(
	`is£t
(
$groups
[
$group_Çme
])) {

406 
$”rÜs
['group_Çme'][] = 
	`t
('Thgrou°Çm%group_Çm®»adyƒxi¡s.', 
	`¬¿y
('%group_Çme' => 
$group_Çme
));

408 ià(
	`em±y
(
$”rÜs
['group_name'])) {

409 
$group
['group_Çme'] = 
$group_Çme
;

412  
	`¬¿y
('group_Çme' => 
$group
['group_Çme'], '”rÜs' => 
$”rÜs
);

413 
	}
}

415 
funùiÚ
 
	$f›ldgroup_f›ld_ov”v›w_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

416 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

417 
$group
 = 
$fÜm_v®ues
['_add_new_group'];

419 ià(
	`¬¿y_f‹r
(
	`¬¿y
(
$group
['label'], $group['group_name']))) {

420 
$v®id©iÚ
 = 
	`f›ldgroup_v®id©e_Çme
(
$group
, 
$fÜm
['#type_name']);

421 ià(!
	`em±y
(
$v®id©iÚ
['errors'])) {

422 
	`fÜ—ch
 (
$v®id©iÚ
['”rÜs'] 
as
 
$ty³
 => 
$mes§ges
) {

423 
	`fÜ—ch
 (
$mes§ges
 
as
 
$mes§ge
) {

424 ià(
$ty³
 == 'label') {

425 
	`fÜm_£t_”rÜ
('_add_Ãw_group][Ïb–', 
	`t
('Add‚ew group:'è.' '. 
$mes§ge
);

428 
	`fÜm_£t_”rÜ
('_add_Ãw_group][group_Çme', 
	`t
('Add‚ew group:'è.' '. 
$mes§ge
);

433 
$group_Çme
 = 
$v®id©iÚ
['group_name'];

434 
	`fÜm_£t_v®ue
(
$fÜm
['_add_Ãw_group']['group_Çme'], 
$group_Çme
, 
$fÜm_¡©e
);

441 
	`fÜ—ch
 (
$fÜm_v®ues
 
as
 
$key
 => 
$v®ues
) {

442 ià(
$v®ues
['parent'] == '_add_new_group') {

443 
	`fÜm_£t_”rÜ
('_add_Ãw_group][Ïb–', 
	`t
('Add‚ew group: you‚eedo…rovide‡†abel.'));

444 
	`fÜm_£t_”rÜ
('_add_Ãw_group][group_Çme', 
	`t
('Add‚ew group: you‚eedo…rovide‡ group‚ame.'));

449 
	}
}

451 
funùiÚ
 
	$f›ldgroup_f›ld_ov”v›w_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

452 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

453 
$ty³_Çme
 = 
$fÜm
['#type_name'];

456 ià(!
	`em±y
(
$fÜm_v®ues
['_add_new_group']['label'])) {

457 
$group
 = 
$fÜm_v®ues
['_add_new_group'];

458 
$group
['£‰šgs'] = 
	`f›ld_group_deçuÉ_£‰šgs
($group['group_type']);

459 
	`f›ldgroup_§ve_group
(
$ty³_Çme
, 
$group
);

460 
$Ãw_group_Çme
 = 
$group
['group_name'];

464 
$add_f›ld_rows
 = 
	`¬¿y
('_add_new_field', '_add_existing_field');

465 
$f›ld_rows
 = 
	`¬¿y_m”ge
(
$fÜm
['#f›lds'], 
$add_f›ld_rows
);

466 
	`fÜ—ch
 (
$fÜm_v®ues
 
as
 
$key
 => 
$v®ues
) {

468 ià(
	`š_¬¿y
(
$key
, 
$f›ld_rows
)) {

470 ià(
	`š_¬¿y
(
$key
, 
$add_f›ld_rows
)) {

475 ià(
	`is£t
(
$fÜm_¡©e
['f›lds_added'][
$key
])) {

476 
$key
 = 
$fÜm_¡©e
['fields_added'][$key];

485 
$·»Á
 = (
$v®ues
['·»Á'] =ğ'_add_Ãw_group' && 
	`is£t
(
$Ãw_group_Çme
)) ? $new_group_name : $values['parent'];

487 
	`f›ldgroup_upd©e_f›lds
(
	`¬¿y
('f›ld_Çme' => 
$key
, 'group' => 
$·»Á
, 'ty³_Çme' => 
$ty³_Çme
));

492 
	`–£if
 (
	`š_¬¿y
(
$key
, 
$fÜm
['#groups'])) {

493 
	`db_qu”y
("UPDATE {". 
	`f›ldgroup_bËÇme
() ."} SET weight = %d WHEREype_name = '%s' AND group_name = '%s'",

494 
$v®ues
['weight'], 
$ty³_Çme
, 
$key
);

498 
	`ÿche_ş—r_®l
('f›ldgroup_d©a:', 
	`cÚ‹Á_ÿche_bËÇme
(), 
TRUE
);

499 
	}
}

501 
funùiÚ
 
	$f›ld_group_deçuÉ_£‰šgs
(
$group_ty³
) {

502 
$£‰šgs
 = 
	`¬¿y
(

503 'fÜm' => 
	`¬¿y
('style' => 'fieldset', 'description' => ''),

504 'di¥Ïy' => 
	`¬¿y
('description' => '', 'label' => 'above'),

506 
	`moduË_lßd_šşude
('inc', 'content', 'includes/content.admin');

507 
	`fÜ—ch
 (
	`¬¿y_keys
(
	`cÚ‹Á_bud_modes
()è
as
 
$key
) {

508 
$£‰šgs
['di¥Ïy'][
$key
]['format'] = 'fieldset';

509 
$£‰šgs
['di¥Ïy'][
$key
]['exclude'] = 0;

512 
$£‰šgs
 = 
	`¬¿y_m”ge
($£‰šgs, 
	`moduË_švoke_®l
('f›ldgroup_deçuÉ_£‰šgs', 
$group_ty³
));

513  
$£‰šgs
;

514 
	}
}

516 
funùiÚ
 
	$f›ldgroup_di¥Ïy_ov”v›w_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

517 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

518 
$groups
 = 
	`f›ldgroup_groups
(
$fÜm
['#type_name']);

519 
	`fÜ—ch
 (
$fÜm_v®ues
 
as
 
$key
 => 
$v®ues
) {

520 ià(
	`š_¬¿y
(
$key
, 
$fÜm
['#groups'])) {

521 
$group
 = 
$groups
[
$key
];

523 
$group
['£‰šgs']['di¥Ïy'] = 
$v®ues
 + $group['settings']['display'];

524 
	`f›ldgroup_§ve_group
(
$fÜm
['#ty³_Çme'], 
$group
);

527 
	}
}

529 
funùiÚ
 
	$f›ldgroup_f›ld_»move_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

530 
$fÜm_v®ues
 = 
$fÜm_¡©e
['values'];

535 
	`db_qu”y
("DELETE FROM {". 
	`f›ldgroup_f›lds_bËÇme
(è."} WHEREy³_Çmğ'%s' AND f›ld_Çmğ'%s'", 
$fÜm_v®ues
['type_name'], $form_values['field_name']);

536 
	}
}

541 
funùiÚ
 
	$f›ldgroup_nod—pi
(&
$node
, 
$İ
, 
$‹a£r
 = 
NULL
, 
$·ge
 = NULL) {

542 
$İ
) {

545 ià(
	`is£t
(
$node
->
ty³
)) {

547 
	`fÜ—ch
 (
	`f›ldgroup_groups
(
$node
->
ty³
è
as
 
$group
) {

548 
	`f›ldgroup_bud_cÚ‹Á
(
$group
, 
$node
, 
$‹a£r
, 
$·ge
);

553 
	}
}

571 
funùiÚ
 
	$f›ldgroup_bud_cÚ‹Á
(
$group
, &
$node
, 
$‹a£r
, 
$·ge
) {

573 ià(
$node
->
bud_mode
 ==ğ
NODE_BUILD_NORMAL
 || $node->bud_mod=ğ
NODE_BUILD_PREVIEW
) {

574 
$cÚ‹xt
 = 
$‹a£r
 ? 'teaser' : 'full';

577 
$cÚ‹xt
 = 
$node
->
bud_mode
;

580 
$group_Çme
 = 
$group
['group_name'];

583 ià(
$cÚ‹xt
 =ğ
NODE_BUILD_SEARCH_INDEX
) {

584 
$group
['settings']['display']['label'] = 'hidden';

586 
$Ïb–
 = 
$group
['settings']['display']['label'] == 'above';

587 
$–em’t
 = 
	`¬¿y
(

588 '#t™Ë' => 
$Ïb–
 ? 
	`check_¶aš
(
	`t
(
$group
['label'])) : '',

589 '#desütiÚ' => 
$Ïb–
 ? 
	`cÚ‹Á_f‹r_xss
(
	`t
(
$group
['settings']['display']['description'])) : '',

591 
$fÜm©
 = 
	`is£t
(
$group
['£‰šgs']['di¥Ïy'][
$cÚ‹xt
]['format']) ? $group['settings']['display'][$context]['format'] : 'fieldset';

593 
$fÜm©
) {

595 
$–em’t
['#type'] = 'fieldgroup_simple';

596 
$–em’t
['#group_Çme'] = 
$group_Çme
;

597 
$–em’t
['#node'] = 
$node
;

600 
$–em’t
['#acûss'] = 
FALSE
;

603 
$–em’t
['#cŞÏp£d'] = 
TRUE
;

605 
$–em’t
['#cŞÏpsibË'] = 
TRUE
;

607 
$–em’t
['#type'] = 'fieldgroup_fieldset';

608 
$–em’t
['#©Œibu‹s'] = 
	`¬¿y
('şass' => 'f›ldgrou°'. 
	`¡¹r
(
$group
['group_name'], '_', '-'));

611 
	`fÜ—ch
 (
$group
['f›lds'] 
as
 
$f›ld_Çme
 => 
$f›ld
) {

612 ià(
	`is£t
(
$node
->
cÚ‹Á
[
$f›ld_Çme
])) {

613 
$–em’t
[
$f›ld_Çme
] = 
$node
->
cÚ‹Á
[$field_name];

620 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('f›ldgroup_v›w'è
as
 
$moduË
) {

621 
$funùiÚ
 = 
$moduË
 .'_fieldgroup_view';

622 
	`$funùiÚ
(
$node
, 
$–em’t
, 
$group
, 
$cÚ‹xt
);

626 
	`fÜ—ch
 (
$group
['f›lds'] 
as
 
$f›ld_Çme
 => 
$f›ld
) {

627 ià(
	`is£t
(
$node
->
cÚ‹Á
[
$f›ld_Çme
])) {

628 
	`un£t
(
$node
->
cÚ‹Á
[
$f›ld_Çme
]);

636 
$w¿µ”
 = 
	`¬¿y
(

637 'group' => 
$–em’t
,

638 '#weight' => 
$group
['weight'],

639 '#po¡_»nd”' => 
	`¬¿y
('fieldgroup_wrapper_post_render'),

640 '#group_Çme' => 
$group_Çme
,

641 '#ty³_Çme' => 
$node
->
ty³
,

642 '#cÚ‹xt' => 
$cÚ‹xt
,

645 
$node
->
cÚ‹Á
[
$group_Çme
] = 
$w¿µ”
;

646 
	}
}

676 
funùiÚ
 
	$f›ldgroup_v›w_group
(
$group
, &
$node
, 
$‹a£r
 = 
FALSE
, 
$·ge
 = FALSE) {

677 
$group_Çme
 = 
$group
['group_name'];

678 
$f›ld_ty³s
 = 
	`_cÚ‹Á_f›ld_ty³s
();

681 
$node_cİy
 = 
	`dru·l_şÚe
(
$node
);

684 
$node_cİy
->
bud_mode
 = 
	`is£t
($node_cİy->bud_modeè? $node_cİy->bud_mod: 
NODE_BUILD_NORMAL
;

687 ià(!
	`is£t
(
$node_cİy
->
cÚ‹Á
)) {

688 
$node_cİy
->
cÚ‹Á
 = 
	`¬¿y
();

690 
	`fÜ—ch
 (
	`¬¿y_keys
(
$group
['f›lds']è
as
 
$f›ld_Çme
) {

691 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
, 
$node_cİy
->
ty³
);

693 ià(
	`is£t
(
$node_cİy
->{
$f›ld_Çme
})) {

694 
$™ems
 = 
$node_cİy
->{
$f›ld_Çme
};

697 
$moduË
 = 
$f›ld_ty³s
[
$f›ld
['type']]['module'];

698 
$funùiÚ
 = 
$moduË
 .'_field';

699 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

700 
	`$funùiÚ
('§n™ize', 
$node_cİy
, 
$f›ld
, 
$™ems
, 
$‹a£r
, 
$·ge
);

701 
$node_cİy
->{
$f›ld_Çme
} = 
$™ems
;

704 
$f›ld_v›w
 = 
	`cÚ‹Á_f›ld
('v›w', 
$node_cİy
, 
$f›ld
, 
$™ems
, 
$‹a£r
, 
$·ge
);

707 
$node_cİy
->
cÚ‹Á
[
$f›ld_Çme
] = 
$f›ld_v›w
[$field_name];

712 
	`f›ldgroup_bud_cÚ‹Á
(
$group
, 
$node_cİy
, 
$‹a£r
, 
$·ge
);

716 
$ouut
 = 
	`dru·l_»nd”
(
$node_cİy
->
cÚ‹Á
[
$group_Çme
]['group']);

718  
$ouut
;

719 
	}
}

724 
funùiÚ
 
	$f›ldgroup_w¿µ”_po¡_»nd”
(
$cÚ‹Á
, 
$–em’t
) {

725 
$groups
 = 
	`f›ldgroup_groups
(
$–em’t
['#type_name']);

726 
$group
 = 
$groups
[
$–em’t
['#group_name']];

730 
$group
['display_settings'] = $group['settings']['display'];

731 ià(
	`theme
('cÚ‹Á_exşude', 
$cÚ‹Á
, 
$group
, 
$–em’t
['#context'])) {

734  
$cÚ‹Á
;

735 
	}
}

742 
funùiÚ
 
	$f›ldgroup_g‘_group
(
$cÚ‹Á_ty³
, 
$f›ld_Çme
) {

743 
	`fÜ—ch
 (
	`f›ldgroup_groups
(
$cÚ‹Á_ty³
è
as
 
$group_Çme
 => 
$group
) {

744 ià(
	`š_¬¿y
(
$f›ld_Çme
, 
	`¬¿y_keys
(
$group
['fields']))) {

745  
$group_Çme
;

748  
FALSE
;

749 
	}
}

755 
funùiÚ
 
	$f›ldgroup_node_ty³
(
$İ
, 
$šfo
) {

756 ià(
$İ
 =ğ'upd©e' && !
	`em±y
(
$šfo
->
Şd_ty³
è&& $šfo->
ty³
 != $info->old_type) {

758 
	`db_qu”y
("UPDATE {". 
	`f›ldgroup_bËÇme
(è."} SETy³_Çme='%s' WHEREy³_Çme='%s'", 
	`¬¿y
(
$šfo
->
ty³
, $šfo->
Şd_ty³
));

759 
	`db_qu”y
("UPDATE {". 
	`f›ldgroup_f›lds_bËÇme
(è."} SETy³_Çme='%s' WHEREy³_Çme='%s'", 
	`¬¿y
(
$šfo
->
ty³
, $šfo->
Şd_ty³
));

760 
	`ÿche_ş—r_®l
('f›ldgroup_d©a:', 
	`cÚ‹Á_ÿche_bËÇme
(), 
TRUE
);

762 
	`–£if
 (
$İ
 == 'delete') {

763 
	`db_qu”y
("DELETE FROM {". 
	`f›ldgroup_bËÇme
(è."} WHEREy³_Çmğ'%s'", 
$šfo
->
ty³
);

764 
	`db_qu”y
("DELETE FROM {". 
	`f›ldgroup_f›lds_bËÇme
(è."} WHEREy³_Çmğ'%s'", 
$šfo
->
ty³
);

766 
	}
}

768 
funùiÚ
 
	$f›ldgroup_ty³s
() {

769 
$ty³s
 = 
	`¬¿y
('¡ªd¬d' => 
	`t
('Standard group'));

771 
$ty³s
 = 
	`¬¿y_m”ge
($ty³s, 
	`moduË_švoke_®l
('fieldgroup_types'));

772  
$ty³s
;

773 
	}
}

775 
funùiÚ
 
	$f›ldgroup_bËÇme
(
$v”siÚ
 = 
NULL
) {

776 ià(
	`is_nuÎ
(
$v”siÚ
)) {

777 
$v”siÚ
 = 
	`v¬ŸbË_g‘
('fieldgroup_schema_version', 0);

779  
$v”siÚ
 < 6000 ? 'node_group' : 'content_group';

780 
	}
}

782 
funùiÚ
 
	$f›ldgroup_f›lds_bËÇme
(
$v”siÚ
 = 
NULL
) {

783 ià(
	`is_nuÎ
(
$v”siÚ
)) {

784 
$v”siÚ
 = 
	`v¬ŸbË_g‘
('fieldgroup_schema_version', 0);

786  
$v”siÚ
 < 6000 ? 'node_group_fields' : 'content_group_fields';

787 
	}
}

798 
funùiÚ
 
	$f›ldgroup_§ve_group
(
$ty³_Çme
, 
$group
) {

799 
$groups
 = 
	`f›ldgroup_groups
(
$ty³_Çme
);

802 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('f›ldgroup_§ve_group'è
as
 
$moduË
) {

803 
$funùiÚ
 = 
$moduË
 .'_fieldgroup_save_group';

804 
	`$funùiÚ
(
$group
);

807 ià(!
	`is£t
(
$groups
[
$group
['group_name']])) {

809 
	`db_qu”y
("INSERT INTO {". 
	`f›ldgroup_bËÇme
() ."} (group_type,ype_name, group_name,†abel, settings, weight)".

810 " VALUES ('%s', '%s', '%s', '%s', '%s', %d)", 
$group
['group_ty³'], 
$ty³_Çme
, $group['group_Çme'], $group['Ïb–'], 
	`£rŸlize
($group['settings']), $group['weight']);

811 
	`ÿche_ş—r_®l
('f›ldgroup_d©a:', 
	`cÚ‹Á_ÿche_bËÇme
(), 
TRUE
);

812  
SAVED_NEW
;

815 
	`db_qu”y
("UPDATE {". 
	`f›ldgroup_bËÇme
() ."} SET group_type = '%s',†abel = '%s', settings = '%s', weight = %d ".

817 
$group
['group_ty³'], $group['Ïb–'], 
	`£rŸlize
($group['£‰šgs']), $group['weight'], 
$ty³_Çme
, $group['group_name']);

818 
	`ÿche_ş—r_®l
('f›ldgroup_d©a:', 
	`cÚ‹Á_ÿche_bËÇme
(), 
TRUE
);

819  
SAVED_UPDATED
;

821 
	}
}

823 
funùiÚ
 
	$f›ldgroup_upd©e_f›lds
(
$fÜm_v®ues
) {

824 
$deçuÉ
 = 
	`_f›ldgroup_f›ld_g‘_group
(
$fÜm_v®ues
['type_name'], $form_values['field_name']);

826 ià(
$deçuÉ
 !ğ
$fÜm_v®ues
['group']) {

827 ià(
$fÜm_v®ues
['group'] && !
$deçuÉ
) {

828 
	`db_qu”y
("INSERT INTO {". 
	`f›ldgroup_f›lds_bËÇme
(è."} (ty³_Çme, group_Çme, f›ld_ÇmeèVALUES ('%s', '%s', '%s')", 
$fÜm_v®ues
['type_name'], $form_values['group'], $form_values['field_name']);

830 
	`–£if
 (
$fÜm_v®ues
['group']) {

831 
	`db_qu”y
("UPDATE {". 
	`f›ldgroup_f›lds_bËÇme
(è."} SET group_Çmğ'%s' WHEREy³_Çmğ'%s' AND f›ld_Çmğ'%s'", 
$fÜm_v®ues
['group'], $form_values['type_name'], $form_values['field_name']);

834 
	`db_qu”y
("DELETE FROM {". 
	`f›ldgroup_f›lds_bËÇme
(è."} WHEREy³_Çmğ'%s' AND f›ld_Çmğ'%s'", 
$fÜm_v®ues
['type_name'], $form_values['field_name']);

836 
	`ÿche_ş—r_®l
('f›ldgroup_d©a:', 
	`cÚ‹Á_ÿche_bËÇme
(), 
TRUE
);

838 
	}
}

840 
funùiÚ
 
	$f›ldgroup_d–‘e
(
$cÚ‹Á_ty³
, 
$group_Çme
) {

841 
	`db_qu”y
("DELETE FROM {". 
	`f›ldgroup_bËÇme
(è."} WHEREy³_Çmğ'%s' AND group_Çmğ'%s'", 
$cÚ‹Á_ty³
, 
$group_Çme
);

842 
	`db_qu”y
("DELETE FROM {". 
	`f›ldgroup_f›lds_bËÇme
(è."} WHEREy³_Çmğ'%s' AND group_Çmğ'%s'", 
$cÚ‹Á_ty³
, 
$group_Çme
);

843 
	`ÿche_ş—r_®l
('f›ldgroup_d©a:', 
	`cÚ‹Á_ÿche_bËÇme
(), 
TRUE
);

844 
	}
}

851 
funùiÚ
 
	$theme_f›ldgroup_f›ld£t
(
$–em’t
) {

852 ià(
	`em±y
(
$–em’t
['#children']) &&ƒmpty($element['#value'])) {

856 ià(
$–em’t
['#collapsible']) {

857 
	`dru·l_add_js
('misc/collapse.js');

859 ià(!
	`is£t
(
$–em’t
['#attributes']['class'])) {

860 
$–em’t
['#attributes']['class'] = '';

863 
$–em’t
['#attributes']['class'] .= ' collapsible';

864 ià(
$–em’t
['#collapsed']) {

865 
$–em’t
['#attributes']['class'] .= ' collapsed';

868  '<f›ld£t'. 
	`dru·l_©Œibu‹s
(
$–em’t
['#©Œibu‹s']è.'>'. ($–em’t['#t™Ë'] ? '<Ëg’d>'. $–em’t['#t™Ë'] .'</Ëg’d>' : ''è. (
	`is£t
($–em’t['#desütiÚ']è&& $–em’t['#desütiÚ'] ? '<div cÏss="desütiÚ">'. $–em’t['#desütiÚ'] .'</div>' : ''è. (!
	`em±y
($element['#children']) ? $element['#children'] : '') . (isset($element['#value']) ? $element['#value'] : '') ."</fieldset>\n";

869 
	}
}

884 
funùiÚ
 
	$f›ldgroup_´•roûss_f›ldgroup_sim¶e
(&
$v¬s
) {

885 
$–em’t
 = 
$v¬s
['element'];

887 
$v¬s
['group_Çme'] = 
$–em’t
['#group_name'];

888 
$v¬s
['group_Çme_css'] = 
	`¡¹r
(
$–em’t
['#group_name'], '_', '-');

889 
$v¬s
['Ïb–'] = 
	`is£t
(
$–em’t
['#title']) ? $element['#title'] : '';;

890 
$v¬s
['desütiÚ'] = 
	`is£t
(
$–em’t
['#description']) ? $element['#description'] : '';;

891 
$v¬s
['cÚ‹Á'] = 
	`is£t
(
$–em’t
['#children']) ? $element['#children'] : '';

892 
$v¬s
['‹m¶©e_fes'] = 
	`¬¿y
(

894 'f›ldgroup-sim¶e-'. 
$–em’t
['#group_name'],

895 'f›ldgroup-sim¶e-'. 
$–em’t
['#node']->
ty³
,

896 'f›ldgroup-sim¶e-'. 
$–em’t
['#group_Çme'] .'-'. $–em’t['#node']->
ty³
,

898 
	}
}

906 
funùiÚ
 
	$f›ldgroup_´•roûss_node
(&
$v¬s
) {

907 
$node
 = 
$v¬s
['node'];

909 
	`fÜ—ch
 (
	`f›ldgroup_groups
(
$node
->
ty³
è
as
 
$group_Çme
 => 
$group
) {

911 
$v¬s
[
$group_Çme
 .'_»nd”ed'] = 
	`is£t
(
$node
->
cÚ‹Á
[$group_name]['#children']) ? $node->content[$group_name]['#children'] : '';

913 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/fieldgroup/panels/content_types/content_fieldgroup.inc

1 <?
php


12 
funùiÚ
 
	$f›ldgroup_cÚ‹Á_f›ldgroup_ùoŞs_cÚ‹Á_ty³s
() {

13  
	`¬¿y
(

14 't™Ë' => 
	`t
('Content fieldgroup'),

15 'deçuÉs' => 
	`¬¿y
('label' => 'hidden', 'format' => 'simple', 'empty' => ''),

17 
	}
}

22 
funùiÚ
 
	$f›ldgroup_cÚ‹Á_f›ldgroup_cÚ‹Á_ty³_cÚ‹Á_ty³s
() {

24 
$ty³s
 = 
	`¬¿y
();

27 
	`fÜ—ch
 (
	`f›ldgroup_groups
(è
as
 
$node_ty³_groups
) {

29 
	`fÜ—ch
 (
$node_ty³_groups
 
as
 
$group
) {

31 ià(
$group
['group_type'] != 'standard') {

36 
$cÚ‹Á_ty³_Çme
 = 
$group
['type_name'] . ':' . $group['group_name'];

39 
$šfo
 = 
	`¬¿y
(

40 'ÿ‹gÜy' => 
	`t
('Node'),

42 't™Ë' => 
	`t
('F›ld group: @grou°š @ty³', 
	`¬¿y
(

43 '@group' => 
	`t
(
$group
['label']),

44 '@ty³' => 
	`node_g‘_ty³s
('Çme', 
$group
['type_name']),

46 'desütiÚ' => 
	`t
('All fields fromhis field group onhe„eferenced‚ode.'),

47 '»quœed cÚ‹xt' => 
Ãw
 
	`ùoŞs_cÚ‹xt_»quœed
(
	`t
('Node'), 'node', 
	`¬¿y
('ty³' =>‡¼ay(
$group
['type_name']))),

50 
$ty³s
[
$cÚ‹Á_ty³_Çme
] = 
$šfo
;

54  
$ty³s
;

55 
	}
}

60 
funùiÚ
 
	$f›ldgroup_cÚ‹Á_f›ldgroup_cÚ‹Á_ty³_»nd”
(
$subty³
, 
$cÚf
, 
$·Ãl_¬gs
, 
$cÚ‹xt
) {

61 ià(!
	`is£t
(
$cÚ‹xt
->
d©a
)) {

64 
$node
 = 
	`dru·l_şÚe
(
$cÚ‹xt
->
d©a
);

67 ià(
	`em±y
(
$cÚf
['label'])) {

68 
$cÚf
['label'] = 'hidden';

70 ià(
	`em±y
(
$cÚf
['format'])) {

71 
$cÚf
['format'] = 'simple';

75 
	`li¡
(
$node_ty³
, 
$group_Çme
èğ
	`ex¶ode
(':', 
$subty³
, 2);

78 
$groups
 = 
	`f›ldgroup_groups
(
$node_ty³
);

80 ià(!
	`is£t
(
$groups
[
$group_Çme
])) {

83 
$group
 = 
$groups
[
$group_Çme
];

86 
$node
->
bud_mode
 = 
NODE_BUILD_NORMAL
;

87 
$group
['£‰šgs']['di¥Ïy']['Ïb–'] = 
$cÚf
['Ïb–'] =ğ'nÜm®' || !
	`em±y
($conf['override_title']) ? 'hidden' : $conf['label'];

88 
$group
['£‰šgs']['di¥Ïy']['fuÎ']['fÜm©'] = 
$cÚf
['format'];

89 
$group
['settings']['display']['full']['exclude'] = 0;

90 
$ouut
 = 
	`f›ldgroup_v›w_group
(
$group
, 
$node
);

92 
$block
 = 
Ãw
 
	`¡dCÏss
();

93 ià(
$cÚf
['label'] == 'normal') {

94 
$block
->
t™Ë
 = 
	`t
(
$group
['label']);

96 
$block
->
cÚ‹Á
 = !
	`em±y
(
$ouut
è? $ouuˆ: 
$cÚf
['empty'];

97  
$block
;

98 
	}
}

103 
funùiÚ
 
	$f›ldgroup_cÚ‹Á_f›ldgroup_cÚ‹Á_ty³_ed™_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

104 
$cÚf
 = 
$fÜm_¡©e
['conf'];

106 
$Ïb–_İtiÚs
 = 
	`¬¿y
(

107 'nÜm®' => 
	`t
('Blockitle'),

108 'above' => 
	`t
('Above'),

110 
$fÜm
['Ïb–'] = 
	`¬¿y
(

112 '#t™Ë' => 
	`t
('Field group†abel'),

113 '#deçuÉ_v®ue' => !
	`em±y
(
$cÚf
['Ïb–']è&& 
	`is£t
(
$Ïb–_İtiÚs
[$conf['label']]) ? $conf['label'] : 'hidden',

114 '#İtiÚs' => 
$Ïb–_İtiÚs
,

115 '#desütiÚ' => 
	`t
('Configure howhe field group†abel is goingo be displayed. This optionakes‚oƒffect when "Overrideitle" option isƒnabled,he specified blockitle is displayed instead.'),

118 
$fÜm©_İtiÚs
 = 
	`¬¿y
(

119 'sim¶e' => 
	`t
('Simple'),

120 'f›ld£t' => 
	`t
('Fieldset'),

121 'f›ld£t_cŞÏpsibË' => 
	`t
('Fieldset - Collapsible'),

122 'f›ld£t_cŞÏp£d' => 
	`t
('Fieldset - Collapsed'),

124 
$fÜm
['fÜm©'] = 
	`¬¿y
(

126 '#t™Ë' => 
	`t
('Field group format'),

127 '#deçuÉ_v®ue' => !
	`em±y
(
$cÚf
['fÜm©']è&& 
	`is£t
(
$fÜm©_İtiÚs
[$conf['format']]) ? $conf['format'] : 'simple',

128 '#İtiÚs' => 
$fÜm©_İtiÚs
,

129 '#desütiÚ' => 
	`t
('This option‡llows youo configurehe field group format.'),

132 
$fÜm
['em±y'] = 
	`¬¿y
(

134 '#t™Ë' => 
	`t
('Emptyext'),

135 '#desütiÚ' => 
	`t
('Texto display if group has‚o data. Notehatitle will‚ot display unless overridden.'),

137 '#deçuÉ_v®ue' => 
$cÚf
['empty'],

139 
	}
}

141 
funùiÚ
 
	$f›ldgroup_cÚ‹Á_f›ldgroup_cÚ‹Á_ty³_ed™_fÜm_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

143 
	`fÜ—ch
 (
	`¬¿y_keys
(
$fÜm_¡©e
['¶ugš']['deçuÉs']è
as
 
$key
) {

144 
$fÜm_¡©e
['cÚf'][
$key
] = $form_state['values'][$key];

146 
	}
}

151 
funùiÚ
 
	$f›ldgroup_cÚ‹Á_f›ldgroup_cÚ‹Á_ty³_admš_t™Ë
(
$subty³
, 
$cÚf
, 
$cÚ‹xt
) {

153 
	`li¡
(
$node_ty³
, 
$group_Çme
èğ
	`ex¶ode
(':', 
$subty³
, 2);

156 
$groups
 = 
	`f›ldgroup_groups
(
$node_ty³
);

157 
$group
 = 
$groups
[
$group_Çme
];

159  
	`t
('"@s" f›ld group: @grou°š @ty³', 
	`¬¿y
(

160 '@s' => 
$cÚ‹xt
->
id’tif›r
,

161 '@group' => 
	`t
(
$group
['label']),

162 '@ty³' => 
	`node_g‘_ty³s
('Çme', 
$node_ty³
),

164 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/nodereference/nodereference.module

1 <?
php


12 
funùiÚ
 
	$nod”eã»nû_m’u
() {

13 
$™ems
 = 
	`¬¿y
();

14 
$™ems
['nod”eã»nû/autocom¶‘e'] = 
	`¬¿y
(

18 'acûs ¬gum’ts' => 
	`¬¿y
(2),

19 'ty³' => 
MENU_CALLBACK


21  
$™ems
;

22 
	}
}

27 
funùiÚ
 
	$nod”eã»nû_theme
() {

28  
	`¬¿y
(

29 'nod”eã»nû_£Ëù' => 
	`¬¿y
(

30 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

32 'nod”eã»nû_bu‰Ús' => 
	`¬¿y
(

33 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

35 'nod”eã»nû_autocom¶‘e' => 
	`¬¿y
(

36 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

38 'nod”eã»nû_fÜm©‹r_deçuÉ' => 
	`¬¿y
(

39 '¬gum’ts' => 
	`¬¿y
('element'),

41 'nod”eã»nû_fÜm©‹r_¶aš' => 
	`¬¿y
(

42 '¬gum’ts' => 
	`¬¿y
('element'),

44 'nod”eã»nû_fÜm©‹r_fuÎ' => 
	`¬¿y
(

45 '¬gum’ts' => 
	`¬¿y
('element'),

48 'nod”eã»nû_fÜm©‹r_‹a£r' => 
	`¬¿y
(

49 '¬gum’ts' => 
	`¬¿y
('element'),

53 
	}
}

58 
funùiÚ
 
	$nod”eã»nû_ùoŞs_¶ugš_dœeùÜy
(
$moduË
, 
$¶ugš
) {

59 ià(
$moduË
 =ğ'ùoŞs' && 
$¶ugš
 == 'relationships') {

60  '·Ãls/' . 
$¶ugš
;

62 
	}
}

67 
funùiÚ
 
	$nod”eã»nû_f›ld_šfo
() {

68  
	`¬¿y
(

69 'nod”eã»nû' => 
	`¬¿y
(

70 'Ïb–' => 
	`t
('Node„eference'),

71 'desütiÚ' => 
	`t
('Storehe ID of‡„elated‚ode‡s‡n integer value.'),

75 
	}
}

80 
funùiÚ
 
	$nod”eã»nû_f›ld_£‰šgs
(
$İ
, 
$f›ld
) {

81 
$İ
) {

83 
$fÜm
 = 
	`¬¿y
();

84 
$fÜm
['»ã»nûabË_ty³s'] = 
	`¬¿y
(

86 '#t™Ë' => 
	`t
('Contentypeshat can be„eferenced'),

87 '#muÉË' => 
TRUE
,

88 '#deçuÉ_v®ue' => 
	`is_¬¿y
(
$f›ld
['»ã»nûabË_ty³s']è? $f›ld['»ã»nûabË_ty³s'] : 
	`¬¿y
(),

89 '#İtiÚs' => 
	`¬¿y_m­
('check_¶aš', 
	`node_g‘_ty³s
('names')),

91 ià(
	`moduË_exi¡s
('views')) {

92 
$v›ws
 = 
	`¬¿y
('--' => '--');

93 
$®l_v›ws
 = 
	`v›ws_g‘_®l_v›ws
();

94 
	`fÜ—ch
 (
$®l_v›ws
 
as
 
$v›w
) {

96 ià(
$v›w
->
ba£_bË
 =ğ'node' && !
	`em±y
($v›w->
di¥Ïy
['deçuÉ']->
di¥Ïy_İtiÚs
['fields'])) {

97 ià(
$v›w
->
ty³
 == 'Default') {

98 
$v›ws
[
	`t
('DeçuÉ V›ws')][
$v›w
->
Çme
] = $view->name;

101 
$v›ws
[
	`t
('Exi¡šg V›ws')][
$v›w
->
Çme
] = $view->name;

106 
$fÜm
['advªûd'] = 
	`¬¿y
(

108 '#t™Ë' => 
	`t
('Advanced - Nodeshat can be„eferenced (View)'),

109 '#cŞÏpsibË' => 
TRUE
,

110 '#cŞÏp£d' => !
	`is£t
(
$f›ld
['advanced_view']) || $field['advanced_view'] == '--',

112 ià(
	`couÁ
(
$v›ws
) > 1) {

113 
$fÜm
['advªûd']['advªûd_v›w'] = 
	`¬¿y
(

115 '#t™Ë' => 
	`t
('View usedo selecthe‚odes'),

116 '#İtiÚs' => 
$v›ws
,

117 '#deçuÉ_v®ue' => 
	`is£t
(
$f›ld
['advanced_view']) ? $field['advanced_view'] : '--',

118 '#desütiÚ' => 
	`t
('<p>Choosehe "Views module" viewhat selectshe‚odeshat can be„eferenced.<br />Note:</p>') .

119 
	`t
('<ul><li>Only viewshat have fields will work forhis…urpose.</li><li>This will discardhe "Contentypes" settings‡bove. Usehe view\'s "filters" section instead.</li><li>Usehe view\'s "fields" sectiono display‡dditional informations‡bout candidate‚odes on‚ode creation/edition form.</li><li>Usehe view\'s "sort criteria" sectiono determinehe order in which candidate‚odes will be displayed.</li></ul>'),

121 
$fÜm
['advªûd']['advªûd_v›w_¬gs'] = 
	`¬¿y
(

123 '#t™Ë' => 
	`t
('View‡rguments'),

124 '#deçuÉ_v®ue' => 
	`is£t
(
$f›ld
['advanced_view_args']) ? $field['advanced_view_args'] : '',

125 '#»quœed' => 
FALSE
,

126 '#desütiÚ' => 
	`t
('Provide‡ comma separated†ist of‡rgumentso…assohe view.'),

130 
$fÜm
['advªûd']['no_v›w_h–p'] = 
	`¬¿y
(

131 '#v®ue' => 
	`t
('<p>The†ist of‚odeshat can be„eferenced can be based on‡ "Views module" view but‚o‡ppropriate views were found. <br />Note:</p>') .

132 
	`t
('<ul><li>Only viewshat have fields will work forhis…urpose.</li><li>This will discardhe "Contentypes" settings‡bove. Usehe view\'s "filters" section instead.</li><li>Usehe view\'s "fields" sectiono display‡dditional informations‡bout candidate‚odes on‚ode creation/edition form.</li><li>Usehe view\'s "sort criteria" sectiono determinehe order in which candidate‚odes will be displayed.</li></ul>'),

136  
$fÜm
;

139 
$£‰šgs
 = 
	`¬¿y
('referenceable_types');

140 ià(
	`moduË_exi¡s
('views')) {

141 
$£‰šgs
[] = 'advanced_view';

142 
$£‰šgs
[] = 'advanced_view_args';

144  
$£‰šgs
;

147 
$cŞumns
 = 
	`¬¿y
(

148 'nid' => 
	`¬¿y
('ty³' => 'št', 'unsigÃd' => 
TRUE
, 'nÙ‚uÎ' => 
FALSE
, 'index' => TRUE),

150  
$cŞumns
;

153 
$d©a
 = 
	`cÚ‹Á_v›ws_f›ld_v›ws_d©a
(
$f›ld
);

154 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

155 
$bË_®Ÿs
 = 
	`cÚ‹Á_v›ws_bËÇme
(
$f›ld
);

158 
$d©a
[
$bË_®Ÿs
][
$f›ld
['field_name'] .'_nid']['filter']['handler'] = 'content_handler_filter_many_to_one';

160 
$d©a
["node_$bË_®Ÿs"]['bË']['još']['node'] = 
	`¬¿y
(

163 'Ëá_bË' => 
$bË_®Ÿs
,

164 'Ëá_f›ld' => 
$f›ld
['field_name'] .'_nid',

166 
$d©a
[
$bË_®Ÿs
][
$f›ld
['field_name'] .'_nid']['argument']['handler'] = 'content_handler_argument_reference';

167 
$d©a
[
$bË_®Ÿs
][
$f›ld
['field_name'] .'_nid']['argument']['nameable'] = "node_$table_alias";

168 
$d©a
[
$bË_®Ÿs
][
$f›ld
['field_name'] .'_nid']['argument']['name field'] = 'title';

170 
$d©a
[
$bË_®Ÿs
][
$f›ld
['f›ld_Çme'] .'_nid']['»ÏtiÚsh'] = 
	`¬¿y
(

172 'f›ld' => 
$db_šfo
['columns']['nid']['column'],

174 'Ïb–' => 
	`t
(
$f›ld
['widget']['label']),

175 'cÚ‹Á_f›ld_Çme' => 
$f›ld
['field_name'],

177  
$d©a
;

179 
	}
}

184 
funùiÚ
 
	$nod”eã»nû_f›ld
(
$İ
, &
$node
, 
$f›ld
, &
$™ems
, 
$‹a£r
, 
$·ge
) {

185 
$§n™ized_nodes
 = 
	`¬¿y
();

187 
$İ
) {

190 
$add™iÚ
 = 
	`¬¿y
();

191 
$add™iÚ
[
$f›ld
['f›ld_Çme']] = 
	`¬¿y
();

192 ià(
	`is£t
(
$node
->
Œª¦©iÚ_sourû
->
$f›ld
['f›ld_Çme']è&& 
	`is_¬¿y
($node->translation_source->$field['field_name'])) {

193 
	`fÜ—ch
 (
$node
->
Œª¦©iÚ_sourû
->
$f›ld
['f›ld_Çme'] 
as
 
$key
 => 
$»ã»nû
) {

194 
$»ã»nû_node
 = 
	`node_lßd
(
$»ã»nû
['nid']);

198 ià(
	`Œª¦©iÚ_suµÜ‹d_ty³
(
$»ã»nû_node
->
ty³
è&& !
	`em±y
($»ã»nû_node->
Ïnguage
è&& $»ã»nû_node->Ïnguag!ğ
$node
->Ïnguag&& 
$Œª¦©iÚs
 = 
	`Œª¦©iÚ_node_g‘_Œª¦©iÚs
($»ã»nû_node->
Šid
)) {

200 
$add™iÚ
[
$f›ld
['f›ld_Çme']][] = 
	`¬¿y
(

201 'nid' => 
	`is£t
(
$Œª¦©iÚs
[
$node
->
Ïnguage
]è? $Œª¦©iÚs[$node->Ïnguage]->
nid
 : 
$»ã»nû
['nid'],

206  
$add™iÚ
;

210 
$ids
 = 
	`¬¿y
();

211 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

212 ià(
	`is_¬¿y
(
$™em
è&& !
	`em±y
($item['nid'])) {

213 ià(
	`is_num”ic
(
$™em
['nid'])) {

214 
$ids
[] = 
$™em
['nid'];

217 
$”rÜ_–em’t
 = 
	`is£t
(
$™em
['_error_element']) ? $item['_error_element'] : '';

218 ià(
	`is_¬¿y
(
$™em
è&& 
	`is£t
($™em['_”rÜ_–em’t'])è
	`un£t
($item['_error_element']);

219 
	`fÜm_£t_”rÜ
(
$”rÜ_–em’t
, 
	`t
("%Çme: inv®id iÅut.", 
	`¬¿y
('%Çme' =>(
$f›ld
['widget']['label']))));

224 ià(
$ids
) {

225 
$»fs
 = 
	`_nod”eã»nû_pÙ’tŸl_»ã»nûs
(
$f›ld
, '', 
NULL
, 
$ids
);

226 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

227 ià(
	`is_¬¿y
(
$™em
)) {

228 
$”rÜ_–em’t
 = 
	`is£t
(
$™em
['_error_element']) ? $item['_error_element'] : '';

229 ià(
	`is_¬¿y
(
$™em
è&& 
	`is£t
($™em['_”rÜ_–em’t'])è
	`un£t
($item['_error_element']);

230 ià(!
	`em±y
(
$™em
['nid']è&& !
	`is£t
(
$»fs
[$item['nid']])) {

231 
	`fÜm_£t_”rÜ
(
$”rÜ_–em’t
, 
	`t
("%Çme:hi po¡ cª'ˆb»ã»nûd.", 
	`¬¿y
('%Çme' =>(
$f›ld
['widget']['label']))));

236  
$™ems
;

243 
$ids
 = 
	`¬¿y
();

244 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

245 ià(
	`is_¬¿y
(
$™em
)) {

247 
$™ems
[
$d–
]['§ã'] = 
	`¬¿y
();

248 ià(!
	`em±y
(
$™em
['nid']è&& 
	`is_num”ic
($item['nid'])) {

249 
$ids
[] = 
$™em
['nid'];

253 ià(
$ids
) {

256 
$missšg_ids
 = 
	`¬¿y_diff
(
$ids
, 
	`¬¿y_keys
(
$§n™ized_nodes
));

257 ià(!
	`em±y
(
$missšg_ids
)) {

258 
$wh”e
 = 
	`¬¿y
('n.nid iÀ('. 
	`db_¶aûhŞd”s
(
$missšg_ids
) . ')');

259 ià(!
	`u£r_acûss
('administer‚odes')) {

260 
$wh”e
[] = 'n.status = 1';

262 
$»suÉ
 = 
	`db_qu”y
(
	`db_»wr™e_sql
('SELECT‚.nid,‚.t™Ë,‚.¡©u FROM {node}‚ WHERE '. 
	`im¶ode
(' AND ', 
$wh”e
)), 
$missšg_ids
);

263 
$row
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

264 
$§n™ized_nodes
[
$row
['nid']] = $row;

267 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

268 ià(
	`is_¬¿y
(
$™em
è&& !
	`em±y
($™em['nid']è&& 
	`is£t
(
$§n™ized_nodes
[$item['nid']])) {

269 
$™ems
[
$d–
]['§ã'] = 
$§n™ized_nodes
[
$™em
['nid']];

273  
$™ems
;

275 
	}
}

280 
funùiÚ
 
	$nod”eã»nû_cÚ‹Á_is_em±y
(
$™em
, 
$f›ld
) {

281 ià(
	`em±y
(
$™em
['nid'])) {

282  
TRUE
;

284  
FALSE
;

285 
	}
}

290 
funùiÚ
 
	$nod”eã»nû_f›ld_fÜm©‹r_šfo
() {

291  
	`¬¿y
(

292 'deçuÉ' => 
	`¬¿y
(

293 'Ïb–' => 
	`t
('Title (link)'),

294 'f›ldy³s' => 
	`¬¿y
('nodereference'),

295 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

297 '¶aš' => 
	`¬¿y
(

298 'Ïb–' => 
	`t
('Title (no†ink)'),

299 'f›ldy³s' => 
	`¬¿y
('nodereference'),

300 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

302 'fuÎ' => 
	`¬¿y
(

303 'Ïb–' => 
	`t
('Full‚ode'),

304 'f›ldy³s' => 
	`¬¿y
('nodereference'),

305 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

307 '‹a£r' => 
	`¬¿y
(

308 'Ïb–' => 
	`t
('Teaser'),

309 'f›ldy³s' => 
	`¬¿y
('nodereference'),

310 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

313 
	}
}

318 
funùiÚ
 
	$theme_nod”eã»nû_fÜm©‹r_deçuÉ
(
$–em’t
) {

319 
$ouut
 = '';

320 ià(!
	`em±y
(
$–em’t
['#item']['safe']['nid'])) {

321 
$ouut
 = 
	`l
(
$–em’t
['#item']['safe']['title'], 'node/'. $element['#item']['safe']['nid']);

322 ià(!
$–em’t
['#item']['safe']['status']) {

323 
$ouut
 = '<¥ª cÏss="node-uÅublished"> '. 
	`t
('(Unpublished)') ." $output</span>";

326  
$ouut
;

327 
	}
}

332 
funùiÚ
 
	$theme_nod”eã»nû_fÜm©‹r_¶aš
(
$–em’t
) {

333 
$ouut
 = '';

334 ià(!
	`em±y
(
$–em’t
['#item']['safe']['nid'])) {

335 
$ouut
 = 
	`check_¶aš
(
$–em’t
['#item']['safe']['title']);

336 ià(!
$–em’t
['#item']['safe']['status']) {

337 
$ouut
 = '<¥ª cÏss="node-uÅublished"> '. 
	`t
('(Unpublished)') ." $output</span>";

340  
$ouut
;

341 
	}
}

346 
funùiÚ
 
	$theme_nod”eã»nû_fÜm©‹r_fuÎ_‹a£r
(
$–em’t
) {

347 
$»cursiÚ_queue
 = 
	`¬¿y
();

348 
$ouut
 = '';

349 ià(!
	`em±y
(
$–em’t
['#item']['safe']['nid'])) {

350 
$nid
 = 
$–em’t
['#item']['safe']['nid'];

351 
$node
 = 
$–em’t
['#node'];

352 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$–em’t
['#field_name'], $element['#type_name']);

354 ià(!
	`is£t
(
$node
->
»ã»ncšg_node
)) {

355 
$»cursiÚ_queue
 = 
	`¬¿y
();

357 
$»cursiÚ_queue
[] = 
$node
->
nid
;

358 ià(
	`š_¬¿y
(
$nid
, 
$»cursiÚ_queue
)) {

362  
	`theme
('nod”eã»nû_fÜm©‹r_deçuÉ', 
$–em’t
);

364 ià(
$»ã»nûd_node
 = 
	`node_lßd
(
$nid
)) {

365 
$»ã»nûd_node
->
»ã»ncšg_node
 = 
$node
;

366 
$»ã»nûd_node
->
»ã»ncšg_f›ld
 = 
$f›ld
;

367 
$ouut
 = 
	`node_v›w
(
$»ã»nûd_node
, 
$–em’t
['#formatter'] == 'teaser');

370  
$ouut
;

371 
	}
}

378 
funùiÚ
 
	$_nod”eã»nû_t™Ës
(
$nid
, 
$known_t™Ë
 = 
NULL
) {

379 
$t™Ës
 = 
	`¬¿y
();

380 ià(!
	`is£t
(
$t™Ës
[
$nid
])) {

381 
$t™Ë
 = 
$known_t™Ë
 ? $known_t™Ë : 
	`db_»suÉ
(
	`db_qu”y
(
	`db_»wr™e_sql
("SELECT‚.t™Ë FROM {node}‚ WHERE‚.nid=%d"), 
$nid
));

382 
$t™Ës
[
$nid
] = 
$t™Ë
 ? $title : '';

384  
$t™Ës
[
$nid
];

385 
	}
}

401 
funùiÚ
 
	$nod”eã»nû_widg‘_šfo
() {

402  
	`¬¿y
(

403 'nod”eã»nû_£Ëù' => 
	`¬¿y
(

404 'Ïb–' => 
	`t
('Select†ist'),

405 'f›ldy³s' => 
	`¬¿y
('nodereference'),

406 'muÉË v®ues' => 
CONTENT_HANDLE_MODULE
,

407 'ÿÎbacks' => 
	`¬¿y
(

408 'deçuÉ v®ue' => 
CONTENT_CALLBACK_DEFAULT
,

411 'nod”eã»nû_bu‰Ús' => 
	`¬¿y
(

412 'Ïb–' => 
	`t
('Check boxes/radio buttons'),

413 'f›ldy³s' => 
	`¬¿y
('nodereference'),

414 'muÉË v®ues' => 
CONTENT_HANDLE_MODULE
,

415 'ÿÎbacks' => 
	`¬¿y
(

416 'deçuÉ v®ue' => 
CONTENT_CALLBACK_DEFAULT
,

419 'nod”eã»nû_autocom¶‘e' => 
	`¬¿y
(

420 'Ïb–' => 
	`t
('Autocompleteext field'),

421 'f›ldy³s' => 
	`¬¿y
('nodereference'),

422 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

423 'ÿÎbacks' => 
	`¬¿y
(

424 'deçuÉ v®ue' => 
CONTENT_CALLBACK_DEFAULT
,

428 
	}
}

442 
funùiÚ
 
	$nod”eã»nû_–em’ts
() {

443  
	`¬¿y
(

444 'nod”eã»nû_£Ëù' => 
	`¬¿y
(

445 '#šput' => 
TRUE
,

446 '#cŞumns' => 
	`¬¿y
('uid'), '#delta' => 0,

447 '#´oûss' => 
	`¬¿y
('nodereference_select_process'),

449 'nod”eã»nû_bu‰Ús' => 
	`¬¿y
(

450 '#šput' => 
TRUE
,

451 '#cŞumns' => 
	`¬¿y
('uid'), '#delta' => 0,

452 '#´oûss' => 
	`¬¿y
('nodereference_buttons_process'),

454 'nod”eã»nû_autocom¶‘e' => 
	`¬¿y
(

455 '#šput' => 
TRUE
,

456 '#cŞumns' => 
	`¬¿y
('name'), '#delta' => 0,

457 '#´oûss' => 
	`¬¿y
('nodereference_autocomplete_process'),

458 '#autocom¶‘e_·th' => 
FALSE
,

461 
	}
}

466 
funùiÚ
 
	$nod”eã»nû_widg‘_£‰šgs
(
$İ
, 
$widg‘
) {

467 
$İ
) {

469 
$fÜm
 = 
	`¬¿y
();

470 
$m©ch
 = 
	`is£t
(
$widg‘
['autocomplete_match']) ? $widget['autocomplete_match'] : 'contains';

471 
$size
 = (
	`is£t
(
$widg‘
['size']è&& 
	`is_num”ic
($widget['size'])) ? $widget['size'] : 60;

472 ià(
$widg‘
['type'] == 'nodereference_autocomplete') {

473 
$fÜm
['autocom¶‘e_m©ch'] = 
	`¬¿y
(

475 '#t™Ë' => 
	`t
('Autocomplete matching'),

476 '#deçuÉ_v®ue' => 
$m©ch
,

477 '#İtiÚs' => 
	`¬¿y
(

478 '¡¬ts_w™h' => 
	`t
('Starts with'),

479 'cÚšs' => 
	`t
('Contains'),

481 '#desütiÚ' => 
	`t
('Selecthe method usedo collect‡utocomplete suggestions. Notehat <em>Contains</em> can cause…erformance issues on sites withhousands of‚odes.'),

483 
$fÜm
['size'] = 
	`¬¿y
(

485 '#t™Ë' => 
	`t
('Size ofextfield'),

486 '#deçuÉ_v®ue' => 
$size
,

487 '#–em’t_v®id©e' => 
	`¬¿y
('_element_validate_integer_positive'),

488 '#»quœed' => 
TRUE
,

492 
$fÜm
['autocom¶‘e_m©ch'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$m©ch
);

493 
$fÜm
['size'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$size
);

495  
$fÜm
;

498  
	`¬¿y
('autocomplete_match', 'size');

500 
	}
}

533 
funùiÚ
 
	$nod”eã»nû_widg‘
(&
$fÜm
, &
$fÜm_¡©e
, 
$f›ld
, 
$™ems
, 
$d–
 = 0) {

534 
$f›ld
['widget']['type']) {

536 
$–em’t
 = 
	`¬¿y
(

538 '#deçuÉ_v®ue' => 
$™ems
,

543 
$–em’t
 = 
	`¬¿y
(

545 '#deçuÉ_v®ue' => 
$™ems
,

550 
$–em’t
 = 
	`¬¿y
(

552 '#deçuÉ_v®ue' => 
	`is£t
(
$™ems
[
$d–
]è? $™ems[$d–] : 
NULL
,

557  
$–em’t
;

558 
	}
}

565 
funùiÚ
 
	$nod”eã»nû_autocom¶‘e_v®ue
(
$–em’t
, 
$ed™
 = 
FALSE
) {

566 
$f›ld_key
 = 
$–em’t
['#columns'][0];

567 ià(!
	`em±y
(
$–em’t
['#deçuÉ_v®ue'][
$f›ld_key
])) {

568 
$nid
 = 
$–em’t
['#deçuÉ_v®ue'][
$f›ld_key
];

569 
$v®ue
 = 
	`db_»suÉ
(
	`db_qu”y
(
	`db_»wr™e_sql
('SELECT‚.t™Ë FROM {node}‚ WHERE‚.nid = %d'), 
$nid
));

570 
$v®ue
 .ğ' [nid:'. 
$nid
 .']';

571  
	`¬¿y
(
$f›ld_key
 => 
$v®ue
);

573  
	`¬¿y
(
$f›ld_key
 => 
NULL
);

574 
	}
}

584 
funùiÚ
 
	$nod”eã»nû_£Ëù_´oûss
(
$–em’t
, 
$ed™
, 
$fÜm_¡©e
, 
$fÜm
) {

589 
$f›ld_key
 = 
$–em’t
['#columns'][0];

590 
$–em’t
[
$f›ld_key
] = 
	`¬¿y
(

592 '#deçuÉ_v®ue' => 
	`is£t
(
$–em’t
['#value']) ? $element['#value'] : '',

595 '#t™Ë' => 
$–em’t
['#title'],

596 '#»quœed' => 
$–em’t
['#required'],

597 '#desütiÚ' => 
$–em’t
['#description'],

598 '#f›ld_Çme' => 
$–em’t
['#field_name'],

599 '#ty³_Çme' => 
$–em’t
['#type_name'],

600 '#d–' => 
$–em’t
['#delta'],

601 '#cŞumns' => 
$–em’t
['#columns'],

603 ià(
	`em±y
(
$–em’t
[
$f›ld_key
]['#element_validate'])) {

604 
$–em’t
[
$f›ld_key
]['#–em’t_v®id©e'] = 
	`¬¿y
();

606 
	`¬¿y_unshiá
(
$–em’t
[
$f›ld_key
]['#element_validate'], 'nodereference_optionwidgets_validate');

607  
$–em’t
;

608 
	}
}

618 
funùiÚ
 
	$nod”eã»nû_bu‰Ús_´oûss
(
$–em’t
, 
$ed™
, 
$fÜm_¡©e
, 
$fÜm
) {

623 
$f›ld_key
 = 
$–em’t
['#columns'][0];

624 
$–em’t
[
$f›ld_key
] = 
	`¬¿y
(

626 '#deçuÉ_v®ue' => 
	`is£t
(
$–em’t
['#value']) ? $element['#value'] : '',

629 '#t™Ë' => 
$–em’t
['#title'],

630 '#»quœed' => 
$–em’t
['#required'],

631 '#desütiÚ' => 
$–em’t
['#description'],

632 '#f›ld_Çme' => 
$–em’t
['#field_name'],

633 '#ty³_Çme' => 
$–em’t
['#type_name'],

634 '#d–' => 
$–em’t
['#delta'],

635 '#cŞumns' => 
$–em’t
['#columns'],

637 ià(
	`em±y
(
$–em’t
[
$f›ld_key
]['#element_validate'])) {

638 
$–em’t
[
$f›ld_key
]['#–em’t_v®id©e'] = 
	`¬¿y
();

640 
	`¬¿y_unshiá
(
$–em’t
[
$f›ld_key
]['#element_validate'], 'nodereference_optionwidgets_validate');

641  
$–em’t
;

642 
	}
}

651 
funùiÚ
 
	$nod”eã»nû_autocom¶‘e_´oûss
(
$–em’t
, 
$ed™
, 
$fÜm_¡©e
, 
$fÜm
) {

657 
$f›ld_key
 = 
$–em’t
['#columns'][0];

659 
$–em’t
[
$f›ld_key
] = 
	`¬¿y
(

661 '#deçuÉ_v®ue' => 
	`is£t
(
$–em’t
['#value']) ? $element['#value'] : '',

662 '#autocom¶‘e_·th' => 'nod”eã»nû/autocom¶‘e/'. 
$–em’t
['#field_name'],

665 '#t™Ë' => 
$–em’t
['#title'],

666 '#»quœed' => 
$–em’t
['#required'],

667 '#desütiÚ' => 
$–em’t
['#description'],

668 '#f›ld_Çme' => 
$–em’t
['#field_name'],

669 '#ty³_Çme' => 
$–em’t
['#type_name'],

670 '#d–' => 
$–em’t
['#delta'],

671 '#cŞumns' => 
$–em’t
['#columns'],

673 ià(
	`em±y
(
$–em’t
[
$f›ld_key
]['#element_validate'])) {

674 
$–em’t
[
$f›ld_key
]['#–em’t_v®id©e'] = 
	`¬¿y
();

676 
	`¬¿y_unshiá
(
$–em’t
[
$f›ld_key
]['#element_validate'], 'nodereference_autocomplete_validate');

679 
$–em’t
['_”rÜ_–em’t'] = 
	`¬¿y
(

683 '#v®ue' => 
	`im¶ode
('][', 
	`¬¿y_m”ge
(
$–em’t
['#·»Ás'], 
	`¬¿y
(
$f›ld_key
, $field_key))),

685  
$–em’t
;

686 
	}
}

699 
funùiÚ
 
	$nod”eã»nû_İtiÚwidg‘s_v®id©e
(
$–em’t
, &
$fÜm_¡©e
) {

700 
$f›ld_key
 = 
$–em’t
['#columns'][0];

702 
$v®ue
 = 
$fÜm_¡©e
['values'];

703 
$Ãw_·»Ás
 = 
	`¬¿y
();

704 
	`fÜ—ch
 (
$–em’t
['#·»Ás'] 
as
 
$·»Á
) {

705 
$v®ue
 = $v®ue[
$·»Á
];

707 ià(
$·»Á
 ==ğ
$f›ld_key
) {

708 
$–em’t
['#·»Ás'] = 
$Ãw_·»Ás
;

709 
	`fÜm_£t_v®ue
(
$–em’t
, 
$v®ue
, 
$fÜm_¡©e
);

712 
$Ãw_·»Ás
[] = 
$·»Á
;

714 
	}
}

723 
funùiÚ
 
	$nod”eã»nû_autocom¶‘e_v®id©e
(
$–em’t
, &
$fÜm_¡©e
) {

724 
$f›ld_Çme
 = 
$–em’t
['#field_name'];

725 
$ty³_Çme
 = 
$–em’t
['#type_name'];

726 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
, 
$ty³_Çme
);

727 
$f›ld_key
 = 
$–em’t
['#columns'][0];

728 
$d–
 = 
$–em’t
['#delta'];

729 
$v®ue
 = 
$–em’t
['#v®ue'][
$f›ld_key
];

730 
$nid
 = 
NULL
;

731 ià(!
	`em±y
(
$v®ue
)) {

732 
	`´eg_m©ch
('/^(?:\s*|(.*è)?\[\s*nid\s*:\s*(\d+)\s*\]$/', 
$v®ue
, 
$m©ches
);

733 ià(!
	`em±y
(
$m©ches
)) {

735 
	`li¡
(, 
$t™Ë
, 
$nid
èğ
$m©ches
;

736 ià(!
	`em±y
(
$t™Ë
è&& (
$n
 = 
	`node_lßd
(
$nid
)è&& 
	`Œim
($t™Ëè!ğŒim($n->
t™Ë
)) {

737 
	`fÜm_”rÜ
(
$–em’t
[
$f›ld_key
], 
	`t
('%Çme:™Ë mism©ch. PËa£ check you¸£ËùiÚ.', 
	`¬¿y
('%Çme' =>(
$f›ld
['widget']['label']))));

742 
$»ã»nû
 = 
	`_nod”eã»nû_pÙ’tŸl_»ã»nûs
(
$f›ld
, 
$v®ue
, 'equ®s', 
NULL
, 1);

743 ià(
	`em±y
(
$»ã»nû
)) {

744 
	`fÜm_”rÜ
(
$–em’t
[
$f›ld_key
], 
	`t
('%Çme: found‚Øv®id…o¡ w™hh©™Ë.', 
	`¬¿y
('%Çme' =>(
$f›ld
['widget']['label']))));

751 
$nid
 = 
	`key
(
$»ã»nû
);

755 
	`fÜm_£t_v®ue
(
$–em’t
, 
$nid
, 
$fÜm_¡©e
);

756 
	}
}

761 
funùiÚ
 
	$nod”eã»nû_®lowed_v®ues
(
$f›ld
) {

762 
$»ã»nûs
 = 
	`_nod”eã»nû_pÙ’tŸl_»ã»nûs
(
$f›ld
);

764 
$İtiÚs
 = 
	`¬¿y
();

765 
	`fÜ—ch
 (
$»ã»nûs
 
as
 
$key
 => 
$v®ue
) {

766 
$İtiÚs
[
$key
] = 
$v®ue
['rendered'];

769  
$İtiÚs
;

770 
	}
}

804 
funùiÚ
 
_nod”eã»nû_pÙ’tŸl_»ã»nûs
(
$f›ld
, 
$¡ršg
 = '', 
$m©ch
 = 'cÚšs', 
$ids
 = 
¬¿y
(), 
$lim™
 = 
NULL
) {

805 
$»suÉs
 = 
¬¿y
();

808 
	g$cid
 = 
$f›ld
['f›ld_Çme'] .':'. 
$m©ch
 .':'. (
$¡ršg
 !=ğ'' ? $¡ršg : 
im¶ode
('-', 
$ids
)è.':'. 
	g$lim™
;

809 ià(!
is£t
(
$»suÉs
[
$cid
])) {

810 
	g$»ã»nûs
 = 
FALSE
;

811 ià(
moduË_exi¡s
('v›ws'è&& !
em±y
(
$f›ld
['advªûd_v›w']è&& 
	g$f›ld
['advanced_view'] != '--') {

812 
$»ã»nûs
 = 
_nod”eã»nû_pÙ’tŸl_»ã»nûs_v›ws
(
$f›ld
, 
$¡ršg
, 
$m©ch
, 
$ids
, 
$lim™
);

816 ià(
	g$»ã»nûs
 ==ğ
FALSE
) {

817 
$»ã»nûs
 = 
_nod”eã»nû_pÙ’tŸl_»ã»nûs_¡ªd¬d
(
$f›ld
, 
$¡ršg
, 
$m©ch
, 
$ids
, 
$lim™
);

821 
	g$»suÉs
[
$cid
] = !
em±y
(
$»ã»nûs
è? $»ã»nû : 
¬¿y
();

824  
	g$»suÉs
[
$cid
];

831 
funùiÚ
 
_nod”eã»nû_pÙ’tŸl_»ã»nûs_v›ws
(
$f›ld
, 
$¡ršg
 = '', 
$m©ch
 = 'cÚšs', 
$ids
 = 
¬¿y
(), 
$lim™
 = 
NULL
) {

832 
$v›w_Çme
 = 
$f›ld
['advanced_view'];

834 ià(
	g$v›w
 = 
v›ws_g‘_v›w
(
$v›w_Çme
)) {

837 
$di¥Ïy
 = 
$v›w
->
add_di¥Ïy
('content_references');

838 
	g$v›w
->
£t_di¥Ïy
(
$di¥Ïy
);

842 
	g$v›w
->
	gdi¥Ïy_hªdËr
->
£t_İtiÚ
('style_plugin', 'content_php_array_autocomplete');

843 
	g$v›w
->
	gdi¥Ïy_hªdËr
->
£t_İtiÚ
('row_plugin', 'fields');

846 
	g$v›w
->
	gdi¥Ïy_hªdËr
->
£t_İtiÚ
('content_title_field', 'title');

850 
	g$İtiÚs
 = 
¬¿y
(

853 '¡ršg' => 
$¡ršg
,

854 'm©ch' => 
$m©ch
,

856 'ids' => 
$ids
,

858 
	g$v›w
->
	gdi¥Ïy_hªdËr
->
£t_İtiÚ
('cÚ‹Á_İtiÚs', 
$İtiÚs
);

864 
	g$lim™
 = 
is£t
(
$lim™
) ? $limit : 0;

865 
	g$v›w
->
	gdi¥Ïy_hªdËr
->
£t_İtiÚ
('™ems_³r_·ge', 
$lim™
);

868 ià(!
em±y
(
$f›ld
['advanced_view_args'])) {

870 
	g$v›w_¬gs
 = 
¬¿y_m­
('Œim', 
ex¶ode
(',', 
$f›ld
['advanced_view_args']));

873 
	g$v›w_¬gs
 = 
¬¿y
();

877 
	g$f›lds
 = 
$v›w
->
g‘_™ems
('f›ld', 
$di¥Ïy
);

878 ià(!
is£t
(
$f›lds
['title'])) {

879 
	g$v›w
->
add_™em
(
$di¥Ïy
, 'field', 'node', 'title');

883 
	g$İtiÚs
 = 
$v›w
->
di¥Ïy_hªdËr
->
g‘_İtiÚ
('row_options');

884 ià(
em±y
(
$İtiÚs
['inline'])) {

885 
	g$İtiÚs
['šlše'] = 
dru·l_m­_assoc
(
¬¿y_keys
(
$v›w
->
g‘_™ems
('f›ld', 
$di¥Ïy
)));

887 ià(
em±y
(
$İtiÚs
['separator'])) {

888 
	g$İtiÚs
['separator'] = '-';

890 
	g$v›w
->
	gdi¥Ïy_hªdËr
->
£t_İtiÚ
('row_İtiÚs', 
$İtiÚs
);

893 
	g$v›w
->
	gis_ÿch—bË
 = 
FALSE
;

896 
	g$»suÉ
 = 
$v›w
->
execu‹_di¥Ïy
(
$di¥Ïy
, 
$v›w_¬gs
);

899 
	g$»suÉ
 = 
FALSE
;

902  
	g$»suÉ
;

909 
funùiÚ
 
_nod”eã»nû_pÙ’tŸl_»ã»nûs_¡ªd¬d
(
$f›ld
, 
$¡ršg
 = '', 
$m©ch
 = 'cÚšs', 
$ids
 = 
¬¿y
(), 
$lim™
 = 
NULL
) {

910 
$»Ï‹d_ty³s
 = 
¬¿y
();

911 
	g$wh”e
 = 
¬¿y
();

912 
	g$¬gs
 = 
¬¿y
();

914 ià(
is_¬¿y
(
$f›ld
['referenceable_types'])) {

915 
fÜ—ch
 (
¬¿y_f‹r
(
$f›ld
['»ã»nûabË_ty³s']è
as
 
$»Ï‹d_ty³
) {

916 
	g$»Ï‹d_ty³s
[] = "n.type = '%s'";

917 
	g$¬gs
[] = 
$»Ï‹d_ty³
;

921 
	g$wh”e
[] = 
im¶ode
(' OR ', 
$»Ï‹d_ty³s
);

923 ià(!
couÁ
(
$»Ï‹d_ty³s
)) {

924  
¬¿y
();

927 ià(
	g$¡ršg
 !== '') {

928 
$like
 = 
$GLOBALS
["db_type"] == 'pgsql' ? "ILIKE" : "LIKE";

929 
	g$m©ch_şau£s
 = 
¬¿y
(

934 
	g$wh”e
[] = 'n.t™Ë '. (
is£t
(
$m©ch_şau£s
[
$m©ch
]) ? $match_clauses[$match] : $match_clauses['contains']);

935 
	g$¬gs
[] = 
$¡ršg
;

937 
–£if
 (
$ids
) {

938 
	g$wh”e
[] = 'n.nid IN (' . 
db_¶aûhŞd”s
(
$ids
) . ')';

939 
	g$¬gs
 = 
¬¿y_m”ge
(
$¬gs
, 
$ids
);

942 
	g$wh”e_şau£
 = 
$wh”e
 ? 'WHERE ('. 
im¶ode
(') AND (', $where) .')' : '';

943 
	g$sql
 = 
db_»wr™e_sql
("SELECT‚.nid,‚.title AS‚ode_title,‚.type AS‚ode_type FROM {node}‚ $where_clause ORDER BY‚.title,‚.type");

944 
	g$»suÉ
 = 
$lim™
 ? 
db_qu”y_¿nge
(
$sql
, 
$¬gs
, 0, $lim™è: 
db_qu”y
($sql, $args);

945 
	g$»ã»nûs
 = 
¬¿y
();

946 
	g$node
 = 
db_ãtch_objeù
(
$»suÉ
)) {

947 
$»ã»nûs
[
$node
->
nid
] = 
¬¿y
(

948 't™Ë' => 
$node
->
node_t™Ë
,

949 '»nd”ed' => 
check_¶aš
(
$node
->
node_t™Ë
),

953  
	g$»ã»nûs
;

962 
funùiÚ
 
	$nod”eã»nû_autocom¶‘e_acûss
(
$f›ld_Çme
) {

963  
	`u£r_acûss
('acûs cÚ‹Á'è&& (
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
)è&& 
	`is£t
($f›ld['f›ld_Çme']è&& 
	`cÚ‹Á_acûss
('view', $field) && content_access('edit', $field);

964 
	}
}

969 
funùiÚ
 
nod”eã»nû_autocom¶‘e
(
$f›ld_Çme
, 
$¡ršg
 = '') {

970 
$f›lds
 = 
cÚ‹Á_f›lds
();

971 
	g$f›ld
 = 
$f›lds
[
$f›ld_Çme
];

972 
	g$m©ch
 = 
is£t
(
$f›ld
['widget']['autocomplete_match']) ? $field['widget']['autocomplete_match'] : 'contains';

973 
	g$m©ches
 = 
¬¿y
();

975 
	g$»ã»nûs
 = 
_nod”eã»nû_pÙ’tŸl_»ã»nûs
(
$f›ld
, 
$¡ršg
, 
$m©ch
, 
¬¿y
(), 10);

976 
fÜ—ch
 (
$»ã»nûs
 
as
 
$id
 => 
$row
) {

978 
$m©ches
[
$row
['title'] ." [nid:$id]"] = '<div class="reference-autocomplete">'. $row['rendered'] . '</div>';

980 
dru·l_jsÚ
(
$m©ches
);

986 
funùiÚ
 
	$nod”eã»nû_node_ty³
(
$İ
, 
$šfo
) {

987 
$İ
) {

990 ià(!
	`em±y
(
$šfo
->
Şd_ty³
è&& $šfo->Şd_ty³ !ğ$šfo->
ty³
) {

993 
$f›lds
 = 
	`cÚ‹Á_f›lds
();

994 
$»bud
 = 
FALSE
;

995 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld_Çme
 => 
$f›ld
) {

996 ià(
$f›ld
['ty³'] =ğ'nod”eã»nû' && 
	`is£t
($f›ld['»ã»nûabË_ty³s'][
$šfo
->
Şd_ty³
])) {

997 
$f›ld
['»ã»nûabË_ty³s'][
$šfo
->
ty³
] = 
	`em±y
($f›ld['»ã»nûabË_ty³s'][$šfo->
Şd_ty³
]) ? 0 : $info->type;

998 
	`un£t
(
$f›ld
['»ã»nûabË_ty³s'][
$šfo
->
Şd_ty³
]);

999 
	`cÚ‹Á_f›ld_š¡ªû_upd©e
(
$f›ld
, 
FALSE
);

1000 
$»bud
 = 
TRUE
;

1005 ià(
$»bud
) {

1006 
	`cÚ‹Á_ş—r_ty³_ÿche
(
TRUE
);

1007 
	`m’u_»bud
();

1012 
	}
}

1020 
funùiÚ
 
	$nod”eã»nû_´•roûss_node
(&
$v¬s
) {

1023 ià(!
	`em±y
(
$v¬s
['node']->
»ã»ncšg_f›ld
)) {

1024 
$node
 = 
$v¬s
['node'];

1025 
$f›ld
 = 
$node
->
»ã»ncšg_f›ld
;

1026 
$v¬s
['template_files'][] = 'node-nodereference';

1027 
$v¬s
['‹m¶©e_fes'][] = 'node-nod”eã»nû-'. 
$f›ld
['field_name'];

1028 
$v¬s
['‹m¶©e_fes'][] = 'node-nod”eã»nû-'. 
$node
->
ty³
;

1029 
$v¬s
['‹m¶©e_fes'][] = 'node-nod”eã»nû-'. 
$f›ld
['f›ld_Çme'] .'-'. 
$node
->
ty³
;

1031 
	}
}

1044 
funùiÚ
 
	$theme_nod”eã»nû_£Ëù
(
$–em’t
) {

1045  
$–em’t
['#children'];

1046 
	}
}

1048 
funùiÚ
 
	$theme_nod”eã»nû_bu‰Ús
(
$–em’t
) {

1049  
$–em’t
['#children'];

1050 
	}
}

1052 
funùiÚ
 
	$theme_nod”eã»nû_autocom¶‘e
(
$–em’t
) {

1053  
$–em’t
['#children'];

1054 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/nodereference/nodereference.rules.inc

1 <?
php


12 
funùiÚ
 
	$nod”eã»nû_ruËs_aùiÚ_šfo
() {

13 
$šfo
 = 
	`¬¿y
();

14 
$šfo
['nod”eã»nû_ruËs_aùiÚ_lßd'] = 
	`¬¿y
(

15 'Ïb–' => 
	`t
('Load‡„eferenced‚ode'),

16 '¬gum’ts' => 
	`¬¿y
(

17 'node' => 
	`¬¿y
(

19 'Ïb–' => 
	`t
('Content containinghe‚ode„eference field'),

22 'Ãw v¬ŸbËs' => 
	`¬¿y
(

23 '»ã»nûd_node' => 
	`¬¿y
(

25 'Ïb–' => 
	`t
('Referenced content'),

29 'h–p' => 
	`t
('Notehat ifhe field has multiple values, onlyhe first content‚ode will be†oaded.'),

31  
$šfo
;

32 
	}
}

34 
funùiÚ
 
	$nod”eã»nû_ruËs_aùiÚ_lßd
(
$node
, 
$£‰šgs
) {

35 ià(
$nid
 = 
$node
->{
$£‰šgs
['field']}[0]['nid']) {

36  
	`¬¿y
('»ã»nûd_node' => 
	`node_lßd
×¼ay('nid' => 
$nid
)));

38 
	}
}

40 
funùiÚ
 
	$nod”eã»nû_ruËs_aùiÚ_lßd_fÜm
(
$£‰šgs
, &
$fÜm
) {

41 
$£‰šgs
 +ğ
	`¬¿y
('field' => '');

42 
$İtiÚs
 = 
	`cÚ‹Á_ruËs_g‘_f›ld_Çmes_by_ty³
('nodereference');

43 
$fÜm
['£‰šgs']['f›ld'] = 
	`¬¿y
(

45 '#t™Ë' => 
	`t
('Field'),

46 '#deçuÉ_v®ue' => 
$£‰šgs
['field'],

47 '#İtiÚs' => 
$İtiÚs
,

48 '#»quœed' => 
TRUE
,

49 '#di§bËd' => 
	`em±y
(
$İtiÚs
),

50 '#desütiÚ' => 
	`em±y
(
$İtiÚs
è? 
	`t
('There‡re‚o‚odereference fields defined.') : '',

52 
	}
}

58 
funùiÚ
 
	$wÜkæow_ng_aùiÚ_lßd_»ã»nûd_node_upg¿de
(&
$–em’t
) {

59 
$–em’t
['#name'] = 'nodereference_rules_action_load';

60 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/nodereference/panels/relationships/node_from_noderef.inc

1 <?
php


12 
funùiÚ
 
	$nod”eã»nû_node_äom_nod”ef_ùoŞs_»ÏtiÚshs
() {

13  
	`¬¿y
(

14 't™Ë' => 
	`t
('Node from„eference'),

16 'desütiÚ' => 
	`t
('Adds‡‚ode from‡‚ode„eference in‡‚ode context; if multiple‚odes‡re„eferenced,his will gethe first„eferenced‚ode only.'),

17 '»quœed cÚ‹xt' => 
Ãw
 
	`ùoŞs_cÚ‹xt_»quœed
(
	`t
('Node'), 'node'),

22 
	}
}

27 
funùiÚ
 
	$nod”eã»nû_node_äom_nod”ef_cÚ‹xt
(
$cÚ‹xt
, 
$cÚf
) {

28 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$cÚf
['field_name']);

31 ià(
	`em±y
(
$cÚ‹xt
->
d©a
)) {

32 
$Ãw_cÚ‹xt
 = 
	`ùoŞs_cÚ‹xt_ü—‹_em±y
('node', 
NULL
);

34 ià(
	`is£t
(
$cÚ‹xt
->
d©a
->{
$cÚf
['f›ld_Çme']}[0]['nid']è&& (
$nid
 = $context->data->{$conf['field_name']}[0]['nid'])) {

35 ià(
$node
 = 
	`node_lßd
(
$nid
)) {

36 
$Ãw_cÚ‹xt
 = 
	`ùoŞs_cÚ‹xt_ü—‹
('node', 
$node
);

40 ià(!
	`em±y
(
$Ãw_cÚ‹xt
)) {

42 
$»¡riùiÚs
 = 
	`¬¿y_keys
(
	`¬¿y_f‹r
(
$f›ld
['referenceable_types']));

43 ià(
$»¡riùiÚs
) {

44 ià(
	`is£t
(
$Ãw_cÚ‹xt
->
»¡riùiÚs
['type'])) {

45 
$Ãw_cÚ‹xt
->
»¡riùiÚs
['ty³'] = 
	`¬¿y_unique
(
	`¬¿y_m”ge
($Ãw_cÚ‹xt->»¡riùiÚs['ty³'], 
$»¡riùiÚs
));

48 
$Ãw_cÚ‹xt
->
»¡riùiÚs
['ty³'] = 
$»¡riùiÚs
;

52  
$Ãw_cÚ‹xt
;

54 
	}
}

59 
funùiÚ
 
	$nod”eã»nû_node_äom_nod”ef_£‰šgs_fÜm
(
$cÚf
) {

60 
$İtiÚs
 = 
	`¬¿y
();

61 
	`fÜ—ch
 (
	`cÚ‹Á_f›lds
(è
as
 
$f›ld
) {

62 ià(
$f›ld
['type'] == 'nodereference') {

63 
$İtiÚs
[
$f›ld
['f›ld_Çme']] = 
	`t
($field['widget']['label']);

66 
$fÜm
['f›ld_Çme'] = 
	`¬¿y
(

67 '#t™Ë' => 
	`t
('Node„eference field'),

69 '#İtiÚs' => 
$İtiÚs
,

70 '#deçuÉ_v®ue' => 
	`is£t
(
$cÚf
['field_name']) ? $conf['field_name'] : '',

75  
$fÜm
;

76 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/number/number.module

1 <?
php


12 
funùiÚ
 
	$numb”_theme
() {

13  
	`¬¿y
(

14 'numb”' => 
	`¬¿y
('¬gum’ts' =>‡¼ay('–em’t' => 
NULL
)),

15 'numb”_fÜm©‹r_deçuÉ' => 
	`¬¿y
('¬gum’ts' =>‡¼ay('–em’t' => 
NULL
), 'function' => 'theme_number_formatter_generic'),

16 'numb”_fÜm©‹r_us_0' => 
	`¬¿y
('¬gum’ts' =>‡¼ay('–em’t' => 
NULL
), 'function' => 'theme_number_formatter_generic'),

17 'numb”_fÜm©‹r_us_1' => 
	`¬¿y
('¬gum’ts' =>‡¼ay('–em’t' => 
NULL
), 'function' => 'theme_number_formatter_generic'),

18 'numb”_fÜm©‹r_us_2' => 
	`¬¿y
('¬gum’ts' =>‡¼ay('–em’t' => 
NULL
), 'function' => 'theme_number_formatter_generic'),

19 'numb”_fÜm©‹r_be_0' => 
	`¬¿y
('¬gum’ts' =>‡¼ay('–em’t' => 
NULL
), 'function' => 'theme_number_formatter_generic'),

20 'numb”_fÜm©‹r_be_1' => 
	`¬¿y
('¬gum’ts' =>‡¼ay('–em’t' => 
NULL
), 'function' => 'theme_number_formatter_generic'),

21 'numb”_fÜm©‹r_be_2' => 
	`¬¿y
('¬gum’ts' =>‡¼ay('–em’t' => 
NULL
), 'function' => 'theme_number_formatter_generic'),

22 'numb”_fÜm©‹r_ä_0' => 
	`¬¿y
('¬gum’ts' =>‡¼ay('–em’t' => 
NULL
), 'function' => 'theme_number_formatter_generic'),

23 'numb”_fÜm©‹r_ä_1' => 
	`¬¿y
('¬gum’ts' =>‡¼ay('–em’t' => 
NULL
), 'function' => 'theme_number_formatter_generic'),

24 'numb”_fÜm©‹r_ä_2' => 
	`¬¿y
('¬gum’ts' =>‡¼ay('–em’t' => 
NULL
), 'function' => 'theme_number_formatter_generic'),

25 'numb”_fÜm©‹r_unfÜm©‹d' => 
	`¬¿y
('¬gum’ts' =>‡¼ay('–em’t' => 
NULL
)),

27 
	}
}

32 
funùiÚ
 
	$numb”_f›ld_šfo
() {

33  
	`¬¿y
(

34 'numb”_š‹g”' => 
	`¬¿y
(

35 'Ïb–' => 
	`t
('Integer'),

36 'desütiÚ' => 
	`t
('Store‡‚umber inhe database‡s‡n integer.'),

39 'numb”_decim®' => 
	`¬¿y
(

40 'Ïb–' => 
	`t
('Decimal'),

41 'desütiÚ' => 
	`t
('Store‡‚umber inhe database in‡ fixed decimal format.'),

44 'numb”_æßt' => 
	`¬¿y
(

45 'Ïb–' => 
	`t
('Float'),

46 'desütiÚ' => 
	`t
('Store‡‚umber inhe database in‡ floating…oint format.'),

50 
	}
}

55 
funùiÚ
 
	$numb”_f›ld_£‰šgs
(
$İ
, 
$f›ld
) {

56 
$İ
) {

58 
$fÜm
 = 
	`¬¿y
();

59 
$fÜm
['mš'] = 
	`¬¿y
(

61 '#t™Ë' => 
	`t
('Minimum'),

62 '#–em’t_v®id©e' => 
	`¬¿y
('_element_validate_number'),

63 '#deçuÉ_v®ue' => 
	`is_num”ic
(
$f›ld
['min']) ? $field['min'] : '',

65 
$fÜm
['max'] = 
	`¬¿y
(

67 '#t™Ë' => 
	`t
('Maximum'),

68 '#–em’t_v®id©e' => 
	`¬¿y
('_element_validate_number'),

69 '#deçuÉ_v®ue' => 
	`is_num”ic
(
$f›ld
['max']) ? $field['max'] : '',

71 ià(
$f›ld
['type'] == 'number_decimal') {

72 
$fÜm
['´ecisiÚ'] = 
	`¬¿y
(

74 '#İtiÚs' => 
	`dru·l_m­_assoc
(
	`¿nge
(10, 32)),

75 '#t™Ë' => 
	`t
('Precision'),

76 '#desütiÚ' => 
	`t
('Theotal‚umber of digitso store inhe database, includinghoseohe„ight ofhe decimal.'),

77 '#deçuÉ_v®ue' => 
	`is_num”ic
(
$f›ld
['precision']) ? $field['precision'] : 10,

79 
$fÜm
['sÿË'] = 
	`¬¿y
(

81 '#İtiÚs' => 
	`dru·l_m­_assoc
(
	`¿nge
(0, 10)),

82 '#t™Ë' => 
	`t
('Scale'),

83 '#desütiÚ' => 
	`t
('The‚umber of digitsohe„ight ofhe decimal.'),

84 '#deçuÉ_v®ue' => 
	`is_num”ic
(
$f›ld
['scale']) ? $field['scale'] : 2,

86 
$fÜm
['decim®'] = 
	`¬¿y
(

88 '#İtiÚs' => 
	`¬¿y
('.' => 'decimal…oint', ',' => 'comma', ' ' => 'space'),

89 '#t™Ë' => 
	`t
('Decimal marker'),

90 '#desütiÚ' => 
	`t
('The character users will inputo markhe decimal…oint in forms.'),

91 '#deçuÉ_v®ue' => !
	`em±y
(
$f›ld
['decimal']) ? $field['decimal'] : '.',

94 
$fÜm
['­³nd']['´efix'] = 
	`¬¿y
(

96 '#t™Ë' => 
	`t
('Prefix'),

98 '#deçuÉ_v®ue' => !
	`em±y
(
$f›ld
['prefix']) ? $field['prefix'] : '',

99 '#desütiÚ' => 
	`t
('Define‡ stringhat should be…refixedohe value,†ike $ or â‚¬. Leave blank for‚one. Separate singular‡nd…lural values with‡…ipe (pound|pounds).'),

101 
$fÜm
['­³nd']['suffix'] = 
	`¬¿y
(

103 '#t™Ë' => 
	`t
('Suffix'),

105 '#deçuÉ_v®ue' => !
	`em±y
(
$f›ld
['suffix']) ? $field['suffix'] : '',

106 '#desütiÚ' => 
	`t
('Define‡ stringhat should suffixedohe value,†ike mÂ², m/sÂ², kb/s. Leave blank for‚one. Separate singular‡nd…lural values with‡…ipe (pound|pounds).'),

108 
$fÜm
['®lowed_v®ues_f›ld£t'] = 
	`¬¿y
(

110 '#t™Ë' => 
	`t
('Allowed values'),

111 '#cŞÏpsibË' => 
TRUE
,

112 '#cŞÏp£d' => 
TRUE
,

114 
$fÜm
['®lowed_v®ues_f›ld£t']['®lowed_v®ues'] = 
	`¬¿y
(

116 '#t™Ë' => 
	`t
('Allowed values†ist'),

117 '#deçuÉ_v®ue' => !
	`em±y
(
$f›ld
['allowed_values']) ? $field['allowed_values'] : '',

118 '#»quœed' => 
FALSE
,

120 '#desütiÚ' => 
	`t
('ThpossibË v®ue thi f›ld cª cÚš. EÁ” oÃ v®u³¸lše, iÀthfÜm© key|Ïb–. Thkey i thv®uth© wÈb¡Üed iÀthd©aba£,‡nd iˆmu¡ m©chhf›ld stÜagty³ (%ty³). ThÏb– i İtiÚ®,‡ndhkey wÈbu£d‡ thÏb– iànØÏb– i ¥ecif›d.<b¸/>AÎowed HTMLags: @gs', 
	`¬¿y
('%ty³' => 
$f›ld
['ty³'], '@gs' => 
	`_cÚ‹Á_f‹r_xss_di¥Ïy_®lowed_gs
())),

122 
$fÜm
['®lowed_v®ues_f›ld£t']['advªûd_İtiÚs'] = 
	`¬¿y
(

124 '#t™Ë' => 
	`t
('PHP code'),

125 '#cŞÏpsibË' => 
TRUE
,

126 '#cŞÏp£d' => 
	`em±y
(
$f›ld
['allowed_values_php']),

128 ià(
	`u£r_acûss
('Use PHP input for field settings (dangerous - grant with care)')) {

129 
$fÜm
['®lowed_v®ues_f›ld£t']['advªûd_İtiÚs']['®lowed_v®ues_php'] = 
	`¬¿y
(

131 '#t™Ë' => 
	`t
('Code'),

132 '#deçuÉ_v®ue' => !
	`em±y
(
$f›ld
['allowed_values_php']) ? $field['allowed_values_php'] : '',

134 '#desütiÚ' => 
	`t
('Advanced usage only: PHP codehat„eturns‡ keyed‡rray of‡llowed values. Should‚ot include &lt;?php ?&gt; delimiters. Ifhis field is filled out,he‡rray„eturned byhis code will overridehe‡llowed values†ist‡bove.'),

138 
$fÜm
['®lowed_v®ues_f›ld£t']['advªûd_İtiÚs']['m¬kup_®lowed_v®ues_php'] = 
	`¬¿y
(

140 '#t™Ë' => 
	`t
('Code'),

141 '#v®ue' => !
	`em±y
(
$f›ld
['®lowed_v®ues_php']è? '<code>'. 
	`check_¶aš
($f›ld['®lowed_v®ues_php']è.'</code>' : 
	`t
('&lt;none&gt;'),

142 '#desütiÚ' => 
	`em±y
(
$f›ld
['®lowed_v®ues_php']è? 
	`t
("You're‚ot‡llowedo input PHP code.") :('This PHP code was set by‡n‡dministrator‡nd will overridehe‡llowed values†ist‡bove.'),

145  
$fÜm
;

148 
$v®ues
 = 
	`¬¿y
('prefix', 'suffix', 'min', 'max', 'allowed_values', 'allowed_values_php');

149 ià(
$f›ld
['type'] == 'number_decimal') {

150 
$v®ues
 = 
	`¬¿y_m”ge
($v®ues, 
	`¬¿y
('precision', 'scale', 'decimal'));

152  
$v®ues
;

155 ià(
$f›ld
['type'] == 'number_integer') {

156  
	`¬¿y
(

157 'v®ue' => 
	`¬¿y
('ty³' => 'št', 'nÙ‚uÎ' => 
FALSE
, 'sÜbË' => 
TRUE
),

160 ià(
$f›ld
['type'] == 'number_float') {

161  
	`¬¿y
(

162 'v®ue' => 
	`¬¿y
('ty³' => 'æßt', 'nÙ‚uÎ' => 
FALSE
, 'sÜbË' => 
TRUE
),

165 ià(
$f›ld
['type'] == 'number_decimal') {

166 
$´ecisiÚ
 = 
	`is£t
(
$f›ld
['precision']) ? $field['precision'] : 10;

167 
$sÿË
 = 
	`is£t
(
$f›ld
['scale']) ? $field['scale'] : 2;

168  
	`¬¿y
(

169 'v®ue' => 
	`¬¿y
('ty³' => 'num”ic', '´ecisiÚ' => 
$´ecisiÚ
, 'sÿË' => 
$sÿË
, 'nÙ‚uÎ' => 
FALSE
, 'sÜbË' => 
TRUE
),

174 
$®lowed_v®ues
 = 
	`cÚ‹Á_®lowed_v®ues
(
$f›ld
);

175 ià(
	`couÁ
(
$®lowed_v®ues
)) {

176 
$d©a
 = 
	`cÚ‹Á_v›ws_f›ld_v›ws_d©a
(
$f›ld
);

177 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

178 
$bË_®Ÿs
 = 
	`cÚ‹Á_v›ws_bËÇme
(
$f›ld
);

181 
$cİy
 = 
$d©a
[
$bË_®Ÿs
][
$f›ld
['field_name'] .'_value'];

182 
$cİy
['t™Ë'] = 
	`t
('@Ïb– (!Çmeè- AÎowed v®ues', 
	`¬¿y
('@Ïb–' =>(
$f›ld
['widget']['label']), '!name' => $field['field_name']));

183 
$cİy
['filter']['handler'] = 'content_handler_filter_many_to_one';

184 
$cİy
['f‹r']['num”ic'] = 
TRUE
;

185 
	`un£t
(
$cİy
['field'], $copy['argument'], $copy['sort']);

186 
$d©a
[
$bË_®Ÿs
][
$f›ld
['f›ld_Çme'] .'_v®ue_mªy_to_Úe'] = 
$cİy
;

188 
$d©a
[
$bË_®Ÿs
][
$f›ld
['field_name'] .'_value']['argument']['handler'] = 'content_handler_argument_many_to_one';

189 
$d©a
[
$bË_®Ÿs
][
$f›ld
['f›ld_Çme'] .'_v®ue']['¬gum’t']['num”ic'] = 
TRUE
;

190  
$d©a
;

194 
	}
}

196 
funùiÚ
 
	$_numb”_widg‘_£‰šgs_mš_v®id©e
(
$–em’t
, &
$fÜm_¡©e
) {

197 
$v®ue
 = 
$fÜm_¡©e
['values']['min'];

198 ià(
$v®ue
 && !
	`is_num”ic
($value)) {

199 
	`fÜm_£t_”rÜ
('mš', 
	`t
('"Minimum" must be‡‚umber.'));

201 
	}
}

203 
funùiÚ
 
	$_numb”_widg‘_£‰šgs_max_v®id©e
(
$–em’t
, &
$fÜm_¡©e
) {

204 
$v®ue
 = 
$fÜm_¡©e
['values']['max'];

205 ià(
$v®ue
 && !
	`is_num”ic
($value)) {

206 
	`fÜm_£t_”rÜ
('max', 
	`t
('"Maximum" must be‡‚umber.'));

208 
	}
}

213 
funùiÚ
 
	$numb”_f›ld
(
$İ
, &
$node
, 
$f›ld
, &
$™ems
, 
$‹a£r
, 
$·ge
) {

214 
$İ
) {

216 
$®lowed_v®ues
 = 
	`cÚ‹Á_®lowed_v®ues
(
$f›ld
);

217 ià(
	`is_¬¿y
(
$™ems
)) {

218 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

219 
$”rÜ_–em’t
 = 
	`is£t
(
$™em
['_error_element']) ? $item['_error_element'] : '';

220 ià(
	`is_¬¿y
(
$™em
è&& 
	`is£t
($™em['_”rÜ_–em’t'])è
	`un£t
($item['_error_element']);

221 ià(
$™em
['value'] != '') {

222 ià(
	`is_num”ic
(
$f›ld
['mš']è&& 
$™em
['value'] < $field['min']) {

223 
	`fÜm_£t_”rÜ
(
$”rÜ_–em’t
, 
	`t
('%Çme:hv®umay bnØsm®Ë¸thª %mš.', 
	`¬¿y
('%Çme' =>(
$f›ld
['widget']['label']), '%min' => $field['min'])));

225 ià(
	`is_num”ic
(
$f›ld
['max']è&& 
$™em
['value'] > $field['max']) {

226 
	`fÜm_£t_”rÜ
(
$”rÜ_–em’t
, 
	`t
('%Çme:hv®umay bnØÏrg”hª %max.', 
	`¬¿y
('%Çme' =>(
$f›ld
['widget']['label']), '%max' => $field['max'])));

228 ià(
	`couÁ
(
$®lowed_v®ues
)) {

231 
$v®id
 = 
FALSE
;

232 
	`fÜ—ch
 (
$®lowed_v®ues
 
as
 
$kay
 => 
$v®ue
) {

233 ià((è
$™em
['v®ue'] =ğ(è
$kay
) {

234 
$v®id
 = 
TRUE
;

238 ià(!
$v®id
) {

239 
	`fÜm_£t_”rÜ
(
$”rÜ_–em’t
, 
	`t
('%Çme: iÎeg® v®ue.', 
	`¬¿y
('%Çme' =>(
$f›ld
['widget']['label']))));

245  
$™ems
;

247 
	}
}

252 
funùiÚ
 
	$numb”_cÚ‹Á_is_em±y
(
$™em
, 
$f›ld
) {

253 ià(
	`em±y
(
$™em
['v®ue']è&& (
¡ršg
)$item['value'] !== '0') {

254  
TRUE
;

256  
FALSE
;

257 
	}
}

262 
funùiÚ
 
	$numb”_f›ld_fÜm©‹r_šfo
() {

263  
	`¬¿y
(

264 'deçuÉ' => 
	`¬¿y
('Ïb–' => '9999', 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
, 'fieldypes' =>‡rray('number_integer', 'number_decimal', 'number_float')),

265 'us_0' => 
	`¬¿y
('Ïb–' => '9,999', 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
, 'fieldypes' =>‡rray('number_integer', 'number_decimal', 'number_float')),

266 'us_1' => 
	`¬¿y
('Ïb–' => '9,999.9', 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
, 'fieldypes' =>‡rray('number_decimal', 'number_float')),

267 'us_2' => 
	`¬¿y
('Ïb–' => '9,999.99', 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
, 'fieldypes' =>‡rray('number_decimal', 'number_float')),

268 'be_0' => 
	`¬¿y
('Ïb–' => '9.999', 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
, 'fieldypes' =>‡rray('number_integer', 'number_decimal', 'number_float')),

269 'be_1' => 
	`¬¿y
('Ïb–' => '9.999,9', 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
, 'fieldypes' =>‡rray('number_decimal', 'number_float')),

270 'be_2' => 
	`¬¿y
('Ïb–' => '9.999,99', 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
, 'fieldypes' =>‡rray('number_decimal', 'number_float')),

271 'ä_0' => 
	`¬¿y
('Ïb–' => '9 999', 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
, 'fieldypes' =>‡rray('number_integer', 'number_decimal', 'number_float')),

272 'ä_1' => 
	`¬¿y
('Ïb–' => '9 999, 9', 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
, 'fieldypes' =>‡rray('number_decimal', 'number_float')),

273 'ä_2' => 
	`¬¿y
('Ïb–' => '9 999, 99', 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
, 'fieldypes' =>‡rray('number_decimal', 'number_float')),

274 'unfÜm©‹d' => 
	`¬¿y
('Ïb–' => 
	`t
('unfÜm©‹d'), 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
, 'fieldypes' =>‡rray('number_integer', 'number_decimal', 'number_float')),

276 
	}
}

281 
funùiÚ
 
	$theme_numb”_fÜm©‹r_unfÜm©‹d
(
$–em’t
) {

282  
$–em’t
['#item']['value'];

283 
	}
}

288 
funùiÚ
 
	$theme_numb”_fÜm©‹r_g’”ic
(
$–em’t
) {

289 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$–em’t
['#field_name'], $element['#type_name']);

290 
$v®ue
 = 
$–em’t
['#item']['value'];

292 ià((
$®lowed_v®ues
 = 
	`cÚ‹Á_®lowed_v®ues
(
$f›ld
))) {

293 ià(
	`is£t
(
$®lowed_v®ues
[
$v®ue
]) && $allowed_values[$value] != $value) {

294  
$®lowed_v®ues
[
$v®ue
];

298 ià(
	`em±y
(
$v®ue
) && $value !== '0') {

302 
$–em’t
['#formatter']) {

304 
$ouut
 = 
	`numb”_fÜm©
(
$v®ue
, 0, '.', ',');

307 
$ouut
 = 
	`numb”_fÜm©
(
$v®ue
, 1, '.', ',');

310 
$ouut
 = 
	`numb”_fÜm©
(
$v®ue
, 2, '.', ',');

313 
$ouut
 = 
	`numb”_fÜm©
(
$v®ue
, 0, ',', '.');

316 
$ouut
 = 
	`numb”_fÜm©
(
$v®ue
, 1, ',', '.');

319 
$ouut
 = 
	`numb”_fÜm©
(
$v®ue
, 2, ',', '.');

322 
$ouut
 = 
	`numb”_fÜm©
(
$v®ue
, 0, ', ', ' ');

325 
$ouut
 = 
	`numb”_fÜm©
(
$v®ue
, 1, ', ', ' ');

328 
$ouut
 = 
	`numb”_fÜm©
(
$v®ue
, 2, ', ', ' ');

331 
$ouut
 = 
$v®ue
;

335 
$´efixes
 = 
	`is£t
(
$f›ld
['´efix']è? 
	`¬¿y_m­
('cÚ‹Á_f‹r_xss', 
	`ex¶ode
('|', $f›ld['´efix'])è: 
	`¬¿y
('');

336 
$suffixes
 = 
	`is£t
(
$f›ld
['suffix']è? 
	`¬¿y_m­
('cÚ‹Á_f‹r_xss', 
	`ex¶ode
('|', $f›ld['suffix'])è: 
	`¬¿y
('');

337 
$´efix
 = (
	`couÁ
(
$´efixes
è> 1è? 
	`fÜm©_¶u¿l
(
$v®ue
, $prefixes[0], $prefixes[1]) : $prefixes[0];

338 
$suffix
 = (
	`couÁ
(
$suffixes
è> 1è? 
	`fÜm©_¶u¿l
(
$v®ue
, $suffixes[0], $suffixes[1]) : $suffixes[0];

340  
$´efix
 . 
$ouut
 . 
$suffix
;

341 
	}
}

354 
funùiÚ
 
	$numb”_widg‘_šfo
() {

355  
	`¬¿y
(

356 'numb”' => 
	`¬¿y
(

357 'Ïb–' => 
	`t
('Text field'),

358 'f›ldy³s' => 
	`¬¿y
('number_integer', 'number_decimal', 'number_float'),

359 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

360 'ÿÎbacks' => 
	`¬¿y
(

361 'deçuÉ v®ue' => 
CONTENT_CALLBACK_DEFAULT
,

365 
	}
}

379 
funùiÚ
 
	$numb”_–em’ts
() {

380  
	`¬¿y
(

381 'numb”' => 
	`¬¿y
(

382 '#šput' => 
TRUE
,

383 '#cŞumns' => 
	`¬¿y
('value'), '#delta' => 0,

384 '#´oûss' => 
	`¬¿y
('number_process'),

387 
	}
}

420 
funùiÚ
 
	$numb”_widg‘
(&
$fÜm
, &
$fÜm_¡©e
, 
$f›ld
, 
$™ems
, 
$d–
 = 0) {

421 
$–em’t
 = 
	`¬¿y
(

422 '#ty³' => 
$f›ld
['widget']['type'],

423 '#deçuÉ_v®ue' => 
	`is£t
(
$™ems
[
$d–
]è? $™ems[$d–] : 
NULL
,

425  
$–em’t
;

426 
	}
}

436 
funùiÚ
 
	$numb”_´oûss
(
$–em’t
, 
$ed™
, 
$fÜm_¡©e
, 
$fÜm
) {

437 
$f›ld_Çme
 = 
$–em’t
['#field_name'];

438 
$f›ld
 = 
$fÜm
['#f›ld_šfo'][
$f›ld_Çme
];

439 
$f›ld_key
 = 
$–em’t
['#columns'][0];

441 
$v®ue
 = 
	`is£t
(
$–em’t
['#v®ue'][
$f›ld_key
]) ? $element['#value'][$field_key] : '';

442 
$v®ue
 = 
	`is£t
(
$f›ld
['decim®']è? 
	`¡r_»¶aû
('.', $field['decimal'], $value) : $value;

443 
$–em’t
[
$f›ld_key
] = 
	`¬¿y
(

445 '#deçuÉ_v®ue' => 
$v®ue
,

448 '#size' => 
	`is£t
(
$f›ld
['precision']) ? $field['precision'] + 2 : 12,

449 '#maxËngth' => 
	`is£t
(
$f›ld
['precision']) ? $field['precision'] : 10,

450 '#©Œibu‹s' => 
	`¬¿y
('class' => 'number'),

453 '#t™Ë' => 
$–em’t
['#title'],

454 '#desütiÚ' => 
$–em’t
['#description'],

455 '#»quœed' => 
$–em’t
['#required'],

456 '#f›ld_Çme' => 
$–em’t
['#field_name'],

457 '#ty³_Çme' => 
$–em’t
['#type_name'],

458 '#d–' => 
$–em’t
['#delta'],

459 '#cŞumns' => 
$–em’t
['#columns'],

462 
$´efixes
 = 
	`¬¿y
();

463 
$suffixes
 = 
	`¬¿y
();

466 ià(
	`em±y
(
$–em’t
['#element_validate'])) {

467 
$–em’t
['#–em’t_v®id©e'] = 
	`¬¿y
();

469 ià(!
	`em±y
(
$f›ld
['prefix'])) {

470 
$´efixes
 = 
	`ex¶ode
('|', 
$f›ld
['prefix']);

471 
$–em’t
[
$f›ld_key
]['#f›ld_´efix'] = 
	`cÚ‹Á_f‹r_xss
(
	`¬¿y_pİ
(
$´efixes
));

473 ià(!
	`em±y
(
$f›ld
['suffix'])) {

474 
$suffixes
 = 
	`ex¶ode
('|', 
$f›ld
['suffix']);

475 
$–em’t
[
$f›ld_key
]['#f›ld_suffix'] = 
	`cÚ‹Á_f‹r_xss
(
	`¬¿y_pİ
(
$suffixes
));

477 
$f›ld
['type']) {

479 
$–em’t
['#element_validate'][] = 'number_float_validate';

482 
$–em’t
['#element_validate'][] = 'number_integer_validate';

485 
$–em’t
['#element_validate'][] = 'number_decimal_validate';

486 
$–em’t
['#decim®'] = 
	`is£t
(
$f›ld
['decimal']) ? $field['decimal'] : '.';

487 
$–em’t
['#´ecisiÚ'] = 
	`is£t
(
$f›ld
['precision']) ? $field['precision'] : 10;

488 
$–em’t
['#sÿË'] = 
	`is£t
(
$f›ld
['scale']) ? $field['scale'] : 2;

493 
$–em’t
['_”rÜ_–em’t'] = 
	`¬¿y
(

495 '#v®ue' => 
	`im¶ode
('][', 
	`¬¿y_m”ge
(
$–em’t
['#·»Ás'], 
	`¬¿y
(
$f›ld_key
))),

498  
$–em’t
;

499 
	}
}

504 
funùiÚ
 
	$numb”_æßt_v®id©e
(
$–em’t
, &
$fÜm_¡©e
) {

505 
$f›ld_Çme
 = 
$–em’t
['#field_name'];

506 
$ty³_Çme
 = 
$–em’t
['#type_name'];

507 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
, 
$ty³_Çme
);

508 
$f›ld_key
 = 
$–em’t
['#columns'][0];

509 
$v®ue
 = 
$–em’t
['#v®ue'][
$f›ld_key
];

511 ià((
$–em’t
[
$f›ld_key
]['#»quœed'] || !
	`em±y
(
$v®ue
))) {

512 
$¡¬t
 = 
$v®ue
;

513 
$v®ue
 = 
	`´eg_»¶aû
('@[^-0-9\.]@', '', $value);

514 ià(
$¡¬t
 !ğ
$v®ue
) {

515 
$”rÜ_f›ld
 = 
	`im¶ode
('][', 
$–em’t
['#·»Ás']è.']['. 
$f›ld_key
;

516 
	`fÜm_£t_”rÜ
(
$”rÜ_f›ld
, 
	`t
('OÆy‚umb” ªd decim® ¬®lowed iÀ%f›ld.', 
	`¬¿y
('%f›ld' =>(
$f›ld
['widget']['label']))));

519 
	`fÜm_£t_v®ue
(
$–em’t
[
$f›ld_key
], 
$v®ue
, 
$fÜm_¡©e
);

522 
	}
}

527 
funùiÚ
 
	$numb”_š‹g”_v®id©e
(
$–em’t
, &
$fÜm_¡©e
) {

528 
$f›ld_Çme
 = 
$–em’t
['#field_name'];

529 
$ty³_Çme
 = 
$–em’t
['#type_name'];

530 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
, 
$ty³_Çme
);

531 
$f›ld_key
 = 
$–em’t
['#columns'][0];

532 
$v®ue
 = 
$–em’t
['#v®ue'][
$f›ld_key
];

534 ià((
$–em’t
[
$f›ld_key
]['#»quœed'] || !
	`em±y
(
$v®ue
))) {

535 
$¡¬t
 = 
$v®ue
;

536 
$v®ue
 = 
	`´eg_»¶aû
('@[^-0-9]@', '', $value);

537 ià(
$¡¬t
 !ğ
$v®ue
) {

538 
$”rÜ_f›ld
 = 
	`im¶ode
('][', 
$–em’t
['#·»Ás']è.']['. 
$f›ld_key
;

539 
	`fÜm_£t_”rÜ
(
$”rÜ_f›ld
, 
	`t
('OÆy‚umb” ¬®lowed iÀ%f›ld.', 
	`¬¿y
('%f›ld' =>(
$f›ld
['widget']['label']))));

542 
	`fÜm_£t_v®ue
(
$–em’t
[
$f›ld_key
], 
$v®ue
, 
$fÜm_¡©e
);

545 
	}
}

550 
funùiÚ
 
	$numb”_decim®_v®id©e
(
$–em’t
, &
$fÜm_¡©e
) {

551 
$f›ld_Çme
 = 
$–em’t
['#field_name'];

552 
$ty³_Çme
 = 
$–em’t
['#type_name'];

553 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
, 
$ty³_Çme
);

554 
$f›ld_key
 = 
$–em’t
['#columns'][0];

555 
$v®ue
 = 
$–em’t
['#v®ue'][
$f›ld_key
];

557 ià((
$–em’t
[
$f›ld_key
]['#»quœed'] || !
	`em±y
(
$v®ue
))) {

558 
$decim®
 = 
$–em’t
['#decimal'] ? $element['#decimal'] : '.';

559 
$¡¬t
 = 
$v®ue
;

560 
$v®ue
 = 
	`´eg_»¶aû
('@[^-0-9\\'. 
$decim®
 .']@', '', $value);

561 ià(
$¡¬t
 !ğ
$v®ue
) {

562 
$”rÜ_f›ld
 = 
	`im¶ode
('][', 
$–em’t
['#·»Ás']è.']['. 
$f›ld_key
;

563 
	`fÜm_£t_”rÜ
(
$”rÜ_f›ld
, 
	`t
('OÆy‚umb” ªdhdecim® ch¬aù” (%decim®è¬®lowed iÀ%f›ld.', 
	`¬¿y
('%decim®' => 
$–em’t
['#decim®'], '%f›ld' =>(
$f›ld
['widget']['label']))));

566 
$v®ue
 = 
	`¡r_»¶aû
(
$–em’t
['#decimal'], '.', $value);

567 
$v®ue
 = 
	`round
($v®ue, 
$–em’t
['#scale']);

568 
	`fÜm_£t_v®ue
(
$–em’t
[
$f›ld_key
], 
$v®ue
, 
$fÜm_¡©e
);

571 
	}
}

583 
funùiÚ
 
	$theme_numb”
(
$–em’t
) {

584  
$–em’t
['#children'];

585 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/optionwidgets/optionwidgets.module

1 <?
php


12 
funùiÚ
 
	$İtiÚwidg‘s_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

14 ià(
$fÜm_id
 =ğ'cÚ‹Á_f›ld_ed™_fÜm' && 
	`is£t
(
$fÜm
['widget'])) {

15 
$widg‘_ty³
 = 
$fÜm
['#field']['widget']['type'];

16 
$f›ld_ty³
 = 
$fÜm
['#field']['type'];

17 
$Ïb–
 = 
$fÜm
['#field']['widget']['label'];

19 
$ouut
 = '<p>'. 
	`t
('C»©¨li¡ oàİtiÚ a ¨li¡ iÀ<¡rÚg>AÎowed v®ue li¡</¡rÚg> o¸a ª‡¼ay iÀPHP code. The£ v®ue wÈbth§mfÜ %f›ld iÀ®ÈcÚ‹Áy³s.', 
	`¬¿y
('%f›ld' => 
$Ïb–
)) .'</p>';

21 ià(
$widg‘_ty³
 == 'optionwidgets_onoff') {

22 
$ouut
 .ğ'<p>'. 
	`t
("For‡ 'single on/off checkbox' widget, definehe 'off' value first,henhe 'on' value inhe <strong>Allowed values</strong> section. Notehathe checkbox will be†abeled withhe†abel ofhe 'on' value.") .'</p>';

24 
	`–£if
 (
$widg‘_ty³
 == 'optionwidgets_buttons') {

25 
$ouut
 .ğ'<p>'. 
	`t
("The 'checkboxes/radio buttons' widget will display checkboxes ifhe multiple values option is selected forhis field, otherwise„adios will be displayed.") .'</p>';

28 ià(
	`š_¬¿y
(
$f›ld_ty³
, 
	`¬¿y
('text', 'number_integer', 'number_float', 'number_decimal'))

29 && 
	`š_¬¿y
(
$widg‘_ty³
, 
	`¬¿y
('optionwidgets_onoff', 'optionwidgets_buttons', 'optionwidgets_select'))) {

30 
$fÜm
['f›ld']['®lowed_v®ues_f›ld£t']['#cŞÏp£d'] = 
FALSE
;

31 
$fÜm
['f›ld']['®lowed_v®ues_f›ld£t']['#desütiÚ'] = 
$ouut
;

34 ià(
	`em±y
(
$fÜm_¡©e
['post'])

35 && 
	`em±y
(
$fÜm
['field']['allowed_values_fieldset']['allowed_values']['#default_value'])

36 && 
	`em±y
(
$fÜm
['field']['allowed_values_fieldset']['advanced_options']['allowed_values_php']['#default_value'])) {

37 
	`dru·l_£t_mes§ge
(
	`t
("You‚eedo specifyhe 'allowed values' forhis field."), 'warning');

41 
	}
}

46 
funùiÚ
 
	$İtiÚwidg‘s_theme
() {

47  
	`¬¿y
(

48 'İtiÚwidg‘s_£Ëù' => 
	`¬¿y
(

49 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

51 'İtiÚwidg‘s_bu‰Ús' => 
	`¬¿y
(

52 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

54 'İtiÚwidg‘s_Úoff' => 
	`¬¿y
(

55 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

57 'İtiÚwidg‘s_nÚe' => 
	`¬¿y
(

58 '¬gum’ts' => 
	`¬¿y
('widg‘_ty³' => 
NULL
, 'field_name' => NULL, 'node_type' => NULL),

61 
	}
}

76 
funùiÚ
 
	$İtiÚwidg‘s_widg‘_šfo
() {

78  
	`¬¿y
(

79 'İtiÚwidg‘s_£Ëù' => 
	`¬¿y
(

80 'Ïb–' => 
	`t
('Select†ist'),

81 'f›ldy³s' => 
	`¬¿y
('text', 'number_integer', 'number_decimal', 'number_float'),

82 'muÉË v®ues' => 
CONTENT_HANDLE_MODULE
,

83 'ÿÎbacks' => 
	`¬¿y
(

84 'deçuÉ v®ue' => 
CONTENT_CALLBACK_DEFAULT
,

87 'İtiÚwidg‘s_bu‰Ús' => 
	`¬¿y
(

88 'Ïb–' => 
	`t
('Check boxes/radio buttons'),

89 'f›ldy³s' => 
	`¬¿y
('text', 'number_integer', 'number_decimal', 'number_float'),

90 'muÉË v®ues' => 
CONTENT_HANDLE_MODULE
,

91 'ÿÎbacks' => 
	`¬¿y
(

92 'deçuÉ v®ue' => 
CONTENT_CALLBACK_DEFAULT
,

95 'İtiÚwidg‘s_Úoff' => 
	`¬¿y
(

96 'Ïb–' => 
	`t
('Single on/off checkbox'),

97 'f›ldy³s' => 
	`¬¿y
('text', 'number_integer', 'number_decimal', 'number_float'),

98 'muÉË v®ues' => 
CONTENT_HANDLE_MODULE
,

99 'ÿÎbacks' => 
	`¬¿y
(

100 'deçuÉ v®ue' => 
CONTENT_CALLBACK_DEFAULT
,

104 
	}
}

115 
funùiÚ
 
	$İtiÚwidg‘s_–em’ts
() {

116  
	`¬¿y
(

117 'İtiÚwidg‘s_£Ëù' => 
	`¬¿y
(

118 '#šput' => 
TRUE
,

119 '#cŞumns' => 
	`¬¿y
('value'), '#delta' => 0,

120 '#´oûss' => 
	`¬¿y
('optionwidgets_select_process'),

122 'İtiÚwidg‘s_bu‰Ús' => 
	`¬¿y
(

123 '#šput' => 
TRUE
,

124 '#cŞumns' => 
	`¬¿y
('value'), '#delta' => 0,

125 '#´oûss' => 
	`¬¿y
('optionwidgets_buttons_process'),

127 'İtiÚwidg‘s_Úoff' => 
	`¬¿y
(

128 '#šput' => 
TRUE
,

129 '#cŞumns' => 
	`¬¿y
('value'), '#delta' => 0,

130 '#´oûss' => 
	`¬¿y
('optionwidgets_onoff_process'),

133 
	}
}

166 
funùiÚ
 
	$İtiÚwidg‘s_widg‘
(&
$fÜm
, &
$fÜm_¡©e
, 
$f›ld
, 
$™ems
, 
$d–
 = 
NULL
) {

167 
$–em’t
 = 
	`¬¿y
(

168 '#ty³' => 
$f›ld
['widget']['type'],

169 '#deçuÉ_v®ue' => !
	`em±y
(
$™ems
è? $™em : 
	`¬¿y
(),

171  
$–em’t
;

172 
	}
}

182 
funùiÚ
 
	$İtiÚwidg‘s_bu‰Ús_´oûss
(
$–em’t
, 
$ed™
, &
$fÜm_¡©e
, 
$fÜm
) {

183 
$f›ld_Çme
 = 
$–em’t
['#field_name'];

184 
$f›ld
 = 
$fÜm
['#f›ld_šfo'][
$f›ld_Çme
];

185 
$f›ld_key
 = 
$–em’t
['#columns'][0];

189 ià(
	`is_¬¿y
(
$–em’t
['#v®ue']è&& !
	`¬¿y_key_exi¡s
(
$f›ld_key
, $element['#value'])) {

190 
$–em’t
['#v®ue'] = 
	`İtiÚwidg‘s_d©a2fÜm
($–em’t, $–em’t['#deçuÉ_v®ue'], 
$f›ld
);

192 
$İtiÚs
 = 
	`İtiÚwidg‘s_İtiÚs
(
$f›ld
);

193 
$–em’t
[
$f›ld_key
] = 
	`¬¿y
(

194 '#ty³' => 
$f›ld
['multiple'] ? 'checkboxes' : 'radios',

195 '#t™Ë' => 
$–em’t
['#title'],

196 '#desütiÚ' => 
$–em’t
['#description'],

197 '#»quœed' => 
	`is£t
(
$–em’t
['#»quœed']è? $–em’t['#»quœed'] : 
$f›ld
['required'],

198 '#muÉË' => 
	`is£t
(
$–em’t
['#muÉË']è? $–em’t['#muÉË'] : 
$f›ld
['multiple'],

199 '#İtiÚs' => 
$İtiÚs
,

200 '#deçuÉ_v®ue' => 
	`is£t
(
$–em’t
['#v®ue'][
$f›ld_key
]è? $–em’t['#v®ue'][$f›ld_key] : 
NULL
,

205 ià(
	`em±y
(
$–em’t
['#element_validate'])) {

206 
$–em’t
['#–em’t_v®id©e'] = 
	`¬¿y
();

208 
	`¬¿y_unshiá
(
$–em’t
['#element_validate'], 'optionwidgets_validate');

212 
$fÜm_¡©e
['#f›ld_šfo'][
$f›ld
['field_name']] = $field;

213  
$–em’t
;

214 
	}
}

224 
funùiÚ
 
	$İtiÚwidg‘s_£Ëù_´oûss
(
$–em’t
, 
$ed™
, &
$fÜm_¡©e
, 
$fÜm
) {

225 
$f›ld_Çme
 = 
$–em’t
['#field_name'];

226 
$f›ld
 = 
$fÜm
['#f›ld_šfo'][
$f›ld_Çme
];

227 
$f›ld_key
 = 
$–em’t
['#columns'][0];

231 ià(
	`is_¬¿y
(
$–em’t
['#v®ue']è&& !
	`¬¿y_key_exi¡s
(
$f›ld_key
, $element['#value'])) {

232 
$–em’t
['#v®ue'] = 
	`İtiÚwidg‘s_d©a2fÜm
($–em’t, $–em’t['#deçuÉ_v®ue'], 
$f›ld
);

235 
$İtiÚs
 = 
	`İtiÚwidg‘s_İtiÚs
(
$f›ld
, 
FALSE
);

239 
	`cÚ‹Á_®lowed_v®ues_f‹r_html
(
$İtiÚs
);

241 
$–em’t
[
$f›ld_key
] = 
	`¬¿y
(

243 '#t™Ë' => 
$–em’t
['#title'],

244 '#desütiÚ' => 
$–em’t
['#description'],

245 '#»quœed' => 
	`is£t
(
$–em’t
['#»quœed']è? $–em’t['#»quœed'] : 
$f›ld
['required'],

246 '#muÉË' => 
	`is£t
(
$–em’t
['#muÉË']è? $–em’t['#muÉË'] : 
$f›ld
['multiple'],

247 '#İtiÚs' => 
$İtiÚs
,

248 '#deçuÉ_v®ue' => 
	`is£t
(
$–em’t
['#v®ue'][
$f›ld_key
]è? $–em’t['#v®ue'][$f›ld_key] : 
NULL
,

253 ià(
	`em±y
(
$–em’t
['#element_validate'])) {

254 
$–em’t
['#–em’t_v®id©e'] = 
	`¬¿y
();

256 
	`¬¿y_unshiá
(
$–em’t
['#element_validate'], 'optionwidgets_validate');

265 
$fÜm_¡©e
['#f›ld_šfo'][
$f›ld
['field_name']] = $field;

266  
$–em’t
;

267 
	}
}

277 
funùiÚ
 
	$İtiÚwidg‘s_Úoff_´oûss
(
$–em’t
, 
$ed™
, &
$fÜm_¡©e
, 
$fÜm
) {

278 
$f›ld_Çme
 = 
$–em’t
['#field_name'];

279 
$f›ld
 = 
$fÜm
['#f›ld_šfo'][
$f›ld_Çme
];

280 
$f›ld_key
 = 
$–em’t
['#columns'][0];

284 ià(
	`is_¬¿y
(
$–em’t
['#v®ue']è&& !
	`¬¿y_key_exi¡s
(
$f›ld_key
, $element['#value'])) {

285 
$–em’t
['#v®ue'] = 
	`İtiÚwidg‘s_d©a2fÜm
($–em’t, $–em’t['#deçuÉ_v®ue'], 
$f›ld
);

287 
$İtiÚs
 = 
	`İtiÚwidg‘s_İtiÚs
(
$f›ld
);

288 
$keys
 = 
	`¬¿y_keys
(
$İtiÚs
);

289 
$Ú_v®ue
 = (!
	`em±y
(
$keys
è&& 
	`is£t
($keys[1])è? $keys[1] : 
NULL
;

290 
$–em’t
[
$f›ld_key
] = 
	`¬¿y
(

292 '#t™Ë' => 
	`is£t
(
$İtiÚs
[
$Ú_v®ue
]) ? $options[$on_value] : '',

293 '#desütiÚ' => 
$–em’t
['#description'],

294 '#»quœed' => 
	`is£t
(
$–em’t
['#»quœed']è? $–em’t['#»quœed'] : 
$f›ld
['required'],

295 '#deçuÉ_v®ue' => 
	`is£t
(
$–em’t
['#v®ue'][
$f›ld_key
][0]è? $–em’t['#v®ue'][$f›ld_key][0] =ğ
$Ú_v®ue
 : 
FALSE
,

296 '#»tuº_v®ue' => 
$Ú_v®ue
,

301 ià(
	`em±y
(
$–em’t
['#element_validate'])) {

302 
$–em’t
['#–em’t_v®id©e'] = 
	`¬¿y
();

304 
	`¬¿y_unshiá
(
$–em’t
['#element_validate'], 'optionwidgets_validate');

308 
$fÜm_¡©e
['#f›ld_šfo'][
$f›ld
['field_name']] = $field;

309  
$–em’t
;

310 
	}
}

315 
funùiÚ
 
	$İtiÚwidg‘s_v®id©e
(
$–em’t
, &
$fÜm_¡©e
) {

320 
$f›ld
 = 
$fÜm_¡©e
['#f›ld_šfo'][
$–em’t
['#field_name']];

321 
$™ems
 = 
	`İtiÚwidg‘s_fÜm2d©a
(
$–em’t
, 
$f›ld
);

322 
	`fÜm_£t_v®ue
(
$–em’t
, 
$™ems
, 
$fÜm_¡©e
);

325 ià(
$f›ld
['multiple'] >= 2) {

327 
$f›ld_key
 = 
$–em’t
['#columns'][0];

328 ià(
	`is£t
(
$™ems
[0][
$f›ld_key
]) && $items[0][$field_key] === '') {

329 
	`un£t
(
$™ems
[0]);

331 ià(
	`couÁ
(
$™ems
è> 
$f›ld
['multiple']) {

332 
$f›ld_key
 = 
$–em’t
['#columns'][0];

333 
	`fÜm_”rÜ
(
$–em’t
[
$f›ld_key
], 
	`t
('%Çme:hi f›ld cªnÙ hŞd mÜthª @couÁ v®ues.', 
	`¬¿y
('%Çme' =>(
$f›ld
['widget']['label']), '@count' => $field['multiple'])));

336 
	}
}

343 
funùiÚ
 
	$İtiÚwidg‘s_d©a2fÜm
(
$–em’t
, 
$™ems
, 
$f›ld
) {

344 
$f›ld_key
 = 
$–em’t
['#columns'][0];

345 
$İtiÚs
 = 
	`İtiÚwidg‘s_İtiÚs
(
$f›ld
);

347 
$™ems_Œª¥o£d
 = 
	`cÚ‹Á_Œª¥o£_¬¿y_rows_cŞs
(
$™ems
);

348 
$v®ues
 = (
	`is£t
(
$™ems_Œª¥o£d
[
$f›ld_key
]è&& 
	`is_¬¿y
($™ems_Œª¥o£d[$f›ld_key])è? $™ems_Œª¥o£d[$f›ld_key] : 
	`¬¿y
();

349 
$keys
 = 
	`¬¿y
();

350 
	`fÜ—ch
 (
$v®ues
 
as
 
$v®ue
) {

351 
$key
 = 
	`¬¿y_£¬ch
(
$v®ue
, 
	`¬¿y_keys
(
$İtiÚs
));

352 ià(
	`is£t
(
$key
)) {

353 
$keys
[] = 
$v®ue
;

356 ià(
$f›ld
['muÉË'] || 
$–em’t
['#type'] == 'optionwidgets_onoff') {

357  
	`¬¿y
(
$f›ld_key
 => 
$keys
);

360  !
	`em±y
(
$keys
è? 
	`¬¿y
(
$f›ld_key
 => 
$v®ue
) :‡rray();

362 
	}
}

369 
funùiÚ
 
	$İtiÚwidg‘s_fÜm2d©a
(
$–em’t
, 
$f›ld
) {

370 
$f›ld_key
 = 
$–em’t
['#columns'][0];

371 
$™ems
 = (
¬¿y
è
$–em’t
[
$f›ld_key
]['#value'];

372 
$İtiÚs
 = 
	`İtiÚwidg‘s_İtiÚs
(
$f›ld
);

374 
$v®ues
 = 
	`¬¿y_v®ues
(
$™ems
);

376 ià(
$–em’t
['#ty³'] =ğ'İtiÚwidg‘s_Úoff' && (
$v®ues
[0] === 0)) {

377 
$keys
 = 
	`¬¿y_keys
(
$İtiÚs
);

378 
$v®ues
 = 
	`¬¿y
(
	`¬¿y_key_exi¡s
(0, 
$keys
è? $keys[0] : 
NULL
);

381 ià(
	`em±y
(
$v®ues
)) {

382 
$v®ues
[] = 
NULL
;

384 
$»suÉ
 = 
	`cÚ‹Á_Œª¥o£_¬¿y_rows_cŞs
(
	`¬¿y
(
$f›ld_key
 => 
$v®ues
));

385  
$»suÉ
;

386 
	}
}

401 
funùiÚ
 
	$İtiÚwidg‘s_İtiÚs
(
$f›ld
, 
$æ©‹n
 = 
TRUE
) {

402 
$funùiÚ
 = 
$f›ld
['module'] .'_allowed_values';

403 
$İtiÚs
 = 
	`funùiÚ_exi¡s
(
$funùiÚ
è? 
	`$funùiÚ
(
$f›ld
è: (
¬¿y
è
	`cÚ‹Á_®lowed_v®ues
($f›ld, 
$æ©‹n
);

407 ià(!
$f›ld
['required']) {

408 ià((
	`š_¬¿y
(
$f›ld
['widg‘']['ty³'], 
	`¬¿y
('optionwidgets_buttons', 'nodereference_buttons', 'userreference_buttons')) && !$field['multiple'])

409 || (
	`š_¬¿y
(
$f›ld
['widg‘']['ty³'], 
	`¬¿y
('optionwidgets_select', 'nodereference_select', 'userreference_select')))) {

410 
$İtiÚs
 = 
	`¬¿y
('' => 
	`theme
('İtiÚwidg‘s_nÚe', 
$f›ld
)) + $options;

413  
$İtiÚs
;

414 
	}
}

420 
funùiÚ
 
	$theme_İtiÚwidg‘s_nÚe
(
$f›ld
) {

421 
$f›ld
['widget']['type']) {

425  
	`t
('N/A');

429  
	`t
('- None -');

433 
	}
}

446 
funùiÚ
 
	$theme_İtiÚwidg‘s_£Ëù
(
$–em’t
) {

447  
$–em’t
['#children'];

448 
	}
}

450 
funùiÚ
 
	$theme_İtiÚwidg‘s_Úoff
(
$–em’t
) {

451  
$–em’t
['#children'];

452 
	}
}

454 
funùiÚ
 
	$theme_İtiÚwidg‘s_bu‰Ús
(
$–em’t
) {

455  
$–em’t
['#children'];

456 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/text/text.module

1 <?
php


12 
funùiÚ
 
	$‹xt_theme
() {

13  
	`¬¿y
(

14 '‹xt_‹x»a' => 
	`¬¿y
(

15 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

17 '‹xt_‹xtf›ld' => 
	`¬¿y
(

18 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

20 '‹xt_fÜm©‹r_deçuÉ' => 
	`¬¿y
(

21 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

23 '‹xt_fÜm©‹r_¶aš' => 
	`¬¿y
(

24 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

26 '‹xt_fÜm©‹r_Œimmed' => 
	`¬¿y
(

27 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

29 '‹xt_fÜm©‹r_foo' => 
	`¬¿y
(

30 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

33 
	}
}

38 
funùiÚ
 
	$‹xt_f›ld_šfo
() {

39  
	`¬¿y
(

40 '‹xt' => 
	`¬¿y
(

41 'Ïb–' => 
	`t
('Text'),

42 'desütiÚ' => 
	`t
('Storeext inhe database.'),

46 
	}
}

51 
funùiÚ
 
	$‹xt_f›ld_£‰šgs
(
$İ
, 
$f›ld
) {

52 
$İ
) {

54 
$fÜm
 = 
	`¬¿y
();

55 
$İtiÚs
 = 
	`¬¿y
(0 => 
	`t
('Plainext'), 1 =>('Filteredext (user selects input format)'));

56 
$fÜm
['‹xt_´oûssšg'] = 
	`¬¿y
(

58 '#t™Ë' => 
	`t
('Text…rocessing'),

59 '#deçuÉ_v®ue' => 
	`is_num”ic
(
$f›ld
['text_processing']) ? $field['text_processing'] : 0,

60 '#İtiÚs' => 
$İtiÚs
,

62 
$fÜm
['max_Ëngth'] = 
	`¬¿y
(

64 '#t™Ë' => 
	`t
('Maximum†ength'),

65 '#deçuÉ_v®ue' => 
	`is_num”ic
(
$f›ld
['max_length']) ? $field['max_length'] : '',

66 '#»quœed' => 
FALSE
,

67 '#–em’t_v®id©e' => 
	`¬¿y
('_element_validate_integer_positive'),

68 '#desütiÚ' => 
	`t
('The maximum†ength ofhe field in characters. Leave blank for‡n unlimited size.'),

70 
$fÜm
['®lowed_v®ues_f›ld£t'] = 
	`¬¿y
(

72 '#t™Ë' => 
	`t
('Allowed values'),

73 '#cŞÏpsibË' => 
TRUE
,

74 '#cŞÏp£d' => 
TRUE
,

76 
$fÜm
['®lowed_v®ues_f›ld£t']['®lowed_v®ues'] = 
	`¬¿y
(

78 '#t™Ë' => 
	`t
('Allowed values†ist'),

79 '#deçuÉ_v®ue' => !
	`em±y
(
$f›ld
['allowed_values']) ? $field['allowed_values'] : '',

80 '#»quœed' => 
FALSE
,

82 '#desütiÚ' => 
	`t
('ThpossibË v®ue thi f›ld cª cÚš. EÁ” oÃ v®u³¸lše, iÀthfÜm© key|Ïb–. Thkey i thv®uth© wÈb¡Üed iÀthd©aba£,‡nd iˆmu¡ m©chhf›ld stÜagty³ (%ty³). ThÏb– i İtiÚ®,‡ndhkey wÈbu£d‡ thÏb– iànØÏb– i ¥ecif›d.<b¸/>AÎowed HTMLags: @gs', 
	`¬¿y
('%ty³' => 
$f›ld
['ty³'], '@gs' => 
	`_cÚ‹Á_f‹r_xss_di¥Ïy_®lowed_gs
())),

84 
$fÜm
['®lowed_v®ues_f›ld£t']['advªûd_İtiÚs'] = 
	`¬¿y
(

86 '#t™Ë' => 
	`t
('PHP code'),

87 '#cŞÏpsibË' => 
TRUE
,

88 '#cŞÏp£d' => 
	`em±y
(
$f›ld
['allowed_values_php']),

90 ià(
	`u£r_acûss
('Use PHP input for field settings (dangerous - grant with care)')) {

91 
$fÜm
['®lowed_v®ues_f›ld£t']['advªûd_İtiÚs']['®lowed_v®ues_php'] = 
	`¬¿y
(

93 '#t™Ë' => 
	`t
('Code'),

94 '#deçuÉ_v®ue' => !
	`em±y
(
$f›ld
['allowed_values_php']) ? $field['allowed_values_php'] : '',

96 '#desütiÚ' => 
	`t
('Advanced usage only: PHP codehat„eturns‡ keyed‡rray of‡llowed values. Should‚ot include &lt;?php ?&gt; delimiters. Ifhis field is filled out,he‡rray„eturned byhis code will overridehe‡llowed values†ist‡bove.'),

100 
$fÜm
['®lowed_v®ues_f›ld£t']['advªûd_İtiÚs']['m¬kup_®lowed_v®ues_php'] = 
	`¬¿y
(

102 '#t™Ë' => 
	`t
('Code'),

103 '#v®ue' => !
	`em±y
(
$f›ld
['®lowed_v®ues_php']è? '<code>'. 
	`check_¶aš
($f›ld['®lowed_v®ues_php']è.'</code>' : 
	`t
('&lt;none&gt;'),

104 '#desütiÚ' => 
	`em±y
(
$f›ld
['®lowed_v®ues_php']è? 
	`t
("You're‚ot‡llowedo input PHP code.") :('This PHP code was set by‡n‡dministrator‡nd will overridehe‡llowed values†ist‡bove.'),

107  
$fÜm
;

110  
	`¬¿y
('text_processing', 'max_length', 'allowed_values', 'allowed_values_php');

113 ià(
	`em±y
(
$f›ld
['max_length']) || $field['max_length'] > 255) {

114 
$cŞumns
['v®ue'] = 
	`¬¿y
('ty³' => '‹xt', 'size' => 'big', 'nÙ‚uÎ' => 
FALSE
, 'sÜbË' => 
TRUE
, 'views' => TRUE);

117 
$cŞumns
['v®ue'] = 
	`¬¿y
('ty³' => 'v¬ch¬', 'Ëngth' => 
$f›ld
['max_Ëngth'], 'nÙ‚uÎ' => 
FALSE
, 'sÜbË' => 
TRUE
, 'views' => TRUE);

119 ià(!
	`em±y
(
$f›ld
['text_processing'])) {

120 
$cŞumns
['fÜm©'] = 
	`¬¿y
('ty³' => 'št', 'unsigÃd' => 
TRUE
, 'nÙ‚uÎ' => 
FALSE
, 'views' => FALSE);

122  
$cŞumns
;

125 
$®lowed_v®ues
 = 
	`cÚ‹Á_®lowed_v®ues
(
$f›ld
);

126 ià(
	`couÁ
(
$®lowed_v®ues
)) {

127 
$d©a
 = 
	`cÚ‹Á_v›ws_f›ld_v›ws_d©a
(
$f›ld
);

128 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

129 
$bË_®Ÿs
 = 
	`cÚ‹Á_v›ws_bËÇme
(
$f›ld
);

132 
$cİy
 = 
$d©a
[
$bË_®Ÿs
][
$f›ld
['field_name'] .'_value'];

133 
$cİy
['t™Ë'] = 
	`t
('@Ïb– (!Çmeè- AÎowed v®ues', 
	`¬¿y
('@Ïb–' =>(
$f›ld
['widget']['label']), '!name' => $field['field_name']));

134 
$cİy
['filter']['handler'] = 'content_handler_filter_many_to_one';

135 
	`un£t
(
$cİy
['field'], $copy['argument'], $copy['sort']);

136 
$d©a
[
$bË_®Ÿs
][
$f›ld
['f›ld_Çme'] .'_v®ue_mªy_to_Úe'] = 
$cİy
;

138 
$d©a
[
$bË_®Ÿs
][
$f›ld
['field_name'] .'_value']['argument']['handler'] = 'content_handler_argument_many_to_one';

139  
$d©a
;

142 
	}
}

147 
funùiÚ
 
	$‹xt_f›ld
(
$İ
, &
$node
, 
$f›ld
, &
$™ems
, 
$‹a£r
, 
$·ge
) {

148 
$İ
) {

150 
$®lowed_v®ues
 = 
	`cÚ‹Á_®lowed_v®ues
(
$f›ld
);

151 ià(
	`is_¬¿y
(
$™ems
)) {

152 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

153 
$”rÜ_–em’t
 = 
	`is£t
(
$™em
['_error_element']) ? $item['_error_element'] : '';

154 ià(
	`is_¬¿y
(
$™em
è&& 
	`is£t
($™em['_”rÜ_–em’t'])è
	`un£t
($item['_error_element']);

155 ià(!
	`em±y
(
$™em
['value'])) {

156 ià(
	`couÁ
(
$®lowed_v®ues
è&& !
	`¬¿y_key_exi¡s
(
$™em
['value'], $allowed_values)) {

157 
	`fÜm_£t_”rÜ
(
$”rÜ_–em’t
, 
	`t
('%Çme: iÎeg® v®ue.', 
	`¬¿y
('%Çme' =>(
$f›ld
['widget']['label']))));

159 ià(!
	`em±y
(
$f›ld
['max_Ëngth']è&& 
	`dru·l_¡¾’
(
$™em
['value']) > $field['max_length']) {

160 
	`fÜm_£t_”rÜ
(
$”rÜ_–em’t
, 
	`t
('%Çme:hv®umay‚Ù blÚg”hª %max ch¬aù”s.', 
	`¬¿y
('%Çme' => 
$f›ld
['widget']['label'], '%max' => $field['max_length'])));

165  
$™ems
;

168 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

169 ià(!
	`em±y
(
$f›ld
['text_processing'])) {

170 
$check
 = 
	`is_nuÎ
(
$node
è|| (
	`is£t
($node->
bud_mode
è&& $node->bud_mod=ğ
NODE_BUILD_PREVIEW
);

171 
$‹xt
 = 
	`is£t
(
$™em
['v®ue']è? 
	`check_m¬kup
($™em['v®ue'], $™em['fÜm©'], 
$check
) : '';

174 
$‹xt
 = 
	`check_¶aš
(
$™em
['value']);

176 
$™ems
[
$d–
]['§ã'] = 
$‹xt
;

179 
	}
}

184 
funùiÚ
 
	$‹xt_cÚ‹Á_is_em±y
(
$™em
, 
$f›ld
) {

185 ià(
	`em±y
(
$™em
['v®ue']è&& (
¡ršg
)$item['value'] !== '0') {

186  
TRUE
;

188  
FALSE
;

189 
	}
}

194 
funùiÚ
 
	$‹xt_f›ld_fÜm©‹r_šfo
() {

195  
	`¬¿y
(

196 'deçuÉ' => 
	`¬¿y
(

197 'Ïb–' => 
	`t
('Default'),

198 'f›ldy³s' => 
	`¬¿y
('text'),

199 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

201 '¶aš' => 
	`¬¿y
(

202 'Ïb–' => 
	`t
('Plainext'),

203 'f›ldy³s' => 
	`¬¿y
('text'),

204 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

206 'Œimmed' => 
	`¬¿y
(

207 'Ïb–' => 
	`t
('Trimmed'),

208 'f›ldy³s' => 
	`¬¿y
('text'),

209 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

212 
	}
}

217 
funùiÚ
 
	$theme_‹xt_fÜm©‹r_deçuÉ
(
$–em’t
) {

218  (
$®lowed
 =
	`_‹xt_®lowed_v®ues
(
$–em’t
)) ? $allowed : $element['#item']['safe'];

219 
	}
}

224 
funùiÚ
 
	$theme_‹xt_fÜm©‹r_¶aš
(
$–em’t
) {

225  (
$®lowed
 =
	`_‹xt_®lowed_v®ues
(
$–em’t
)è? $®lowed : 
	`¡r_gs
($element['#item']['safe']);

226 
	}
}

231 
funùiÚ
 
	$theme_‹xt_fÜm©‹r_Œimmed
(
$–em’t
) {

232 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$–em’t
['#field_name'], $element['#type_name']);

233  (
$®lowed
 =
	`_‹xt_®lowed_v®ues
(
$–em’t
)è? $®lowed : 
	`node_‹a£r
($–em’t['#™em']['§ã'], 
$f›ld
['‹xt_´oûssšg'] ? $–em’t['#™em']['fÜm©'] : 
NULL
);

234 
	}
}

236 
funùiÚ
 
	$_‹xt_®lowed_v®ues
(
$–em’t
) {

237 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$–em’t
['#field_name'], $element['#type_name']);

238 ià((
$®lowed_v®ues
 = 
	`cÚ‹Á_®lowed_v®ues
(
$f›ld
)è&& 
	`is£t
($®lowed_v®ues[
$–em’t
['#item']['value']])) {

239  
$®lowed_v®ues
[
$–em’t
['#item']['value']];

241 
	}
}

254 
funùiÚ
 
	$‹xt_widg‘_šfo
() {

255  
	`¬¿y
(

256 '‹xt_‹xtf›ld' => 
	`¬¿y
(

257 'Ïb–' => 
	`t
('Text field'),

258 'f›ldy³s' => 
	`¬¿y
('text'),

259 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

260 'ÿÎbacks' => 
	`¬¿y
(

261 'deçuÉ v®ue' => 
CONTENT_CALLBACK_DEFAULT
,

264 '‹xt_‹x»a' => 
	`¬¿y
(

265 'Ïb–' => 
	`t
('Text‡rea (multiple„ows)'),

266 'f›ldy³s' => 
	`¬¿y
('text'),

267 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

268 'ÿÎbacks' => 
	`¬¿y
(

269 'deçuÉ v®ue' => 
CONTENT_CALLBACK_DEFAULT
,

273 
	}
}

287 
funùiÚ
 
	$‹xt_–em’ts
() {

288  
	`¬¿y
(

289 '‹xt_‹xtf›ld' => 
	`¬¿y
(

290 '#šput' => 
TRUE
,

291 '#cŞumns' => 
	`¬¿y
('value'), '#delta' => 0,

292 '#´oûss' => 
	`¬¿y
('text_textfield_process'),

293 '#autocom¶‘e_·th' => 
FALSE
,

295 '‹xt_‹x»a' => 
	`¬¿y
(

296 '#šput' => 
TRUE
,

297 '#cŞumns' => 
	`¬¿y
('value', 'format'), '#delta' => 0,

298 '#´oûss' => 
	`¬¿y
('text_textarea_process'),

299 '#f‹r_v®ue' => 
FILTER_FORMAT_DEFAULT
,

302 
	}
}

307 
funùiÚ
 
	$‹xt_widg‘_£‰šgs
(
$İ
, 
$widg‘
) {

308 
$İ
) {

310 
$fÜm
 = 
	`¬¿y
();

311 
$rows
 = (
	`is£t
(
$widg‘
['rows']è&& 
	`is_num”ic
($widget['rows'])) ? $widget['rows'] : 5;

312 
$size
 = (
	`is£t
(
$widg‘
['size']è&& 
	`is_num”ic
($widget['size'])) ? $widget['size'] : 60;

313 ià(
$widg‘
['type'] == 'text_textfield') {

314 
$fÜm
['rows'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$rows
);

315 
$fÜm
['size'] = 
	`¬¿y
(

317 '#t™Ë' => 
	`t
('Size ofextfield'),

318 '#deçuÉ_v®ue' => 
$size
,

319 '#–em’t_v®id©e' => 
	`¬¿y
('_element_validate_integer_positive'),

320 '#»quœed' => 
TRUE
,

324 
$fÜm
['rows'] = 
	`¬¿y
(

326 '#t™Ë' => 
	`t
('Rows'),

327 '#deçuÉ_v®ue' => 
$rows
,

328 '#–em’t_v®id©e' => 
	`¬¿y
('_element_validate_integer_positive'),

329 '#»quœed' => 
TRUE
,

331 
$fÜm
['size'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$size
);

333  
$fÜm
;

336  
	`¬¿y
('rows', 'size');

338 
	}
}

371 
funùiÚ
 
	$‹xt_widg‘
(&
$fÜm
, &
$fÜm_¡©e
, 
$f›ld
, 
$™ems
, 
$d–
 = 0) {

372 
$–em’t
 = 
	`¬¿y
(

373 '#ty³' => 
$f›ld
['widget']['type'],

374 '#deçuÉ_v®ue' => 
	`is£t
(
$™ems
[
$d–
]) ? $items[$delta] : '',

376  
$–em’t
;

377 
	}
}

387 
funùiÚ
 
	$‹xt_‹xtf›ld_´oûss
(
$–em’t
, 
$ed™
, 
$fÜm_¡©e
, 
$fÜm
) {

388 
$f›ld
 = 
$fÜm
['#f›ld_šfo'][
$–em’t
['#field_name']];

389 
$f›ld_key
 = 
$–em’t
['#columns'][0];

390 
$d–
 = 
$–em’t
['#delta'];

391 
$–em’t
[
$f›ld_key
] = 
	`¬¿y
(

393 '#deçuÉ_v®ue' => 
	`is£t
(
$–em’t
['#v®ue'][
$f›ld_key
]è? $–em’t['#v®ue'][$f›ld_key] : 
NULL
,

394 '#autocom¶‘e_·th' => 
$–em’t
['#autocomplete_path'],

395 '#size' => !
	`em±y
(
$f›ld
['widget']['size']) ? $field['widget']['size'] : 60,

396 '#©Œibu‹s' => 
	`¬¿y
('class' => 'text'),

399 '#t™Ë' => 
$–em’t
['#title'],

400 '#desütiÚ' => 
$–em’t
['#description'],

401 '#»quœed' => 
$–em’t
['#required'],

402 '#f›ld_Çme' => 
$–em’t
['#field_name'],

403 '#ty³_Çme' => 
$–em’t
['#type_name'],

404 '#d–' => 
$–em’t
['#delta'],

405 '#cŞumns' => 
$–em’t
['#columns'],

408 
$–em’t
[
$f›ld_key
]['#maxËngth'] = !
	`em±y
(
$f›ld
['max_Ëngth']è? $f›ld['max_Ëngth'] : 
NULL
;

410 ià(!
	`em±y
(
$f›ld
['text_processing'])) {

411 
$f‹r_key
 = 
$–em’t
['#columns'][1];

412 
$fÜm©
 = 
	`is£t
(
$–em’t
['#v®ue'][
$f‹r_key
]è? $–em’t['#v®ue'][$f‹r_key] : 
FILTER_FORMAT_DEFAULT
;

413 
$·»Ás
 = 
	`¬¿y_m”ge
(
$–em’t
['#·»Ás'] , 
	`¬¿y
(
$f‹r_key
));

414 
$–em’t
[
$f‹r_key
] = 
	`f‹r_fÜm
(
$fÜm©
, 1, 
$·»Ás
);

418 
$–em’t
['_”rÜ_–em’t'] = 
	`¬¿y
(

420 '#v®ue' => 
	`im¶ode
('][', 
	`¬¿y_m”ge
(
$–em’t
['#·»Ás'], 
	`¬¿y
(
$f›ld_key
))),

423  
$–em’t
;

424 
	}
}

434 
funùiÚ
 
	$‹xt_‹x»a_´oûss
(
$–em’t
, 
$ed™
, 
$fÜm_¡©e
, 
$fÜm
) {

435 
$f›ld
 = 
$fÜm
['#f›ld_šfo'][
$–em’t
['#field_name']];

436 
$f›ld_key
 = 
$–em’t
['#columns'][0];

437 
$–em’t
[
$f›ld_key
] = 
	`¬¿y
(

439 '#deçuÉ_v®ue' => 
	`is£t
(
$–em’t
['#v®ue'][
$f›ld_key
]è? $–em’t['#v®ue'][$f›ld_key] : 
NULL
,

440 '#rows' => !
	`em±y
(
$f›ld
['widget']['rows']) ? $field['widget']['rows'] : 10,

444 '#t™Ë' => 
$–em’t
['#title'],

445 '#desütiÚ' => 
$–em’t
['#description'],

446 '#»quœed' => 
$–em’t
['#required'],

447 '#f›ld_Çme' => 
$–em’t
['#field_name'],

448 '#ty³_Çme' => 
$–em’t
['#type_name'],

449 '#d–' => 
$–em’t
['#delta'],

450 '#cŞumns' => 
$–em’t
['#columns'],

453 ià(!
	`em±y
(
$f›ld
['text_processing'])) {

454 
$f‹r_key
 = (
	`couÁ
(
$–em’t
['#columns']) == 2) ? $element['#columns'][1] : 'format';

455 
$fÜm©
 = 
	`is£t
(
$–em’t
['#v®ue'][
$f‹r_key
]è? $–em’t['#v®ue'][$f‹r_key] : 
FILTER_FORMAT_DEFAULT
;

456 
$·»Ás
 = 
	`¬¿y_m”ge
(
$–em’t
['#·»Ás'] , 
	`¬¿y
(
$f‹r_key
));

457 
$–em’t
[
$f‹r_key
] = 
	`f‹r_fÜm
(
$fÜm©
, 1, 
$·»Ás
);

461 
$–em’t
['_”rÜ_–em’t'] = 
	`¬¿y
(

463 '#v®ue' => 
	`im¶ode
('][', 
	`¬¿y_m”ge
(
$–em’t
['#·»Ás'], 
	`¬¿y
(
$f›ld_key
))),

466  
$–em’t
;

467 
	}
}

480 
funùiÚ
 
	$theme_‹xt_‹xtf›ld
(
$–em’t
) {

481  
$–em’t
['#children'];

482 
	}
}

484 
funùiÚ
 
	$theme_‹xt_‹x»a
(
$–em’t
) {

485  
$–em’t
['#children'];

486 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/userreference/panels/relationships/user_from_userref.inc

1 <?
php


12 
funùiÚ
 
	$u£¼eã»nû_u£r_äom_u£¼ef_ùoŞs_»ÏtiÚshs
() {

13  
	`¬¿y
(

14 't™Ë' => 
	`t
('User from„eference'),

16 'desütiÚ' => 
	`t
('Adds‡ user from‡ user„eference in‡‚ode context; if multiple users‡re„eferenced,his will gethe first„eferenced user only.'),

17 '»quœed cÚ‹xt' => 
Ãw
 
	`ùoŞs_cÚ‹xt_»quœed
(
	`t
('Node'), 'node'),

22 
	}
}

27 
funùiÚ
 
	$u£¼eã»nû_u£r_äom_u£¼ef_cÚ‹xt
(
$cÚ‹xt
, 
$cÚf
) {

29 ià(
	`em±y
(
$cÚ‹xt
->
d©a
)) {

30  
	`ùoŞs_cÚ‹xt_ü—‹_em±y
('u£r', 
NULL
);

34 ià(
	`em±y
(
$cÚf
)) {

35  
	`ùoŞs_cÚ‹xt_ü—‹_em±y
('u£r', 
NULL
);

38 ià(
	`is£t
(
$cÚ‹xt
->
d©a
->{
$cÚf
['f›ld_Çme']}[0]['uid']è&& (
$uid
 = $context->data->{$conf['field_name']}[0]['uid'])) {

39 ià(
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => 
$uid
))) {

40  
	`ùoŞs_cÚ‹xt_ü—‹
('u£r', 
$accouÁ
);

43 
	}
}

48 
funùiÚ
 
	$u£¼eã»nû_u£r_äom_u£¼ef_£‰šgs_fÜm
(
$cÚf
) {

49 
$İtiÚs
 = 
	`¬¿y
();

50 
	`fÜ—ch
 (
	`cÚ‹Á_f›lds
(è
as
 
$f›ld
) {

51 ià(
$f›ld
['type'] == 'userreference') {

52 
$İtiÚs
[
$f›ld
['f›ld_Çme']] = 
	`t
($field['widget']['label']);

55 
$fÜm
['f›ld_Çme'] = 
	`¬¿y
(

56 '#t™Ë' => 
	`t
('User„eference field'),

58 '#İtiÚs' => 
$İtiÚs
,

59 '#deçuÉ_v®ue' => 
	`is£t
(
$cÚf
['field_name']) ? $conf['field_name'] : '',

64  
$fÜm
;

65 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/userreference/userreference.module

1 <?
php


12 
funùiÚ
 
	$u£¼eã»nû_m’u
() {

13 
$™ems
 = 
	`¬¿y
();

14 
$™ems
['u£¼eã»nû/autocom¶‘e'] = 
	`¬¿y
(

17 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

18 'ty³' => 
MENU_CALLBACK


20  
$™ems
;

21 
	}
}

26 
funùiÚ
 
	$u£¼eã»nû_theme
() {

27  
	`¬¿y
(

28 'u£¼eã»nû_£Ëù' => 
	`¬¿y
(

29 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

31 'u£¼eã»nû_bu‰Ús' => 
	`¬¿y
(

32 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

34 'u£¼eã»nû_autocom¶‘e' => 
	`¬¿y
(

35 '¬gum’ts' => 
	`¬¿y
('–em’t' => 
NULL
),

37 'u£¼eã»nû_fÜm©‹r_deçuÉ' => 
	`¬¿y
(

38 '¬gum’ts' => 
	`¬¿y
('element'),

40 'u£¼eã»nû_fÜm©‹r_¶aš' => 
	`¬¿y
(

41 '¬gum’ts' => 
	`¬¿y
('element'),

44 
	}
}

49 
funùiÚ
 
	$u£¼eã»nû_ùoŞs_¶ugš_dœeùÜy
(
$moduË
, 
$¶ugš
) {

50 ià(
$moduË
 =ğ'ùoŞs' && 
$¶ugš
 == 'relationships') {

51  '·Ãls/' . 
$¶ugš
;

53 
	}
}

58 
funùiÚ
 
	$u£¼eã»nû_f›ld_šfo
() {

59  
	`¬¿y
(

60 'u£¼eã»nû' => 
	`¬¿y
(

61 'Ïb–' => 
	`t
('User„eference'),

62 'desütiÚ' => 
	`t
('Storehe ID of‡„elated user‡s‡n integer value.'),

66 
	}
}

71 
funùiÚ
 
	$u£¼eã»nû_f›ld_£‰šgs
(
$İ
, 
$f›ld
) {

72 
$İ
) {

74 
$fÜm
 = 
	`¬¿y
();

75 
$fÜm
['»ã»nûabË_rŞes'] = 
	`¬¿y
(

77 '#t™Ë' => 
	`t
('User„oleshat can be„eferenced'),

78 '#deçuÉ_v®ue' => 
	`is£t
(
$f›ld
['»ã»nûabË_rŞes']è&& 
	`is_¬¿y
($f›ld['»ã»nûabË_rŞes']è? 
	`¬¿y_f‹r
($f›ld['»ã»nûabË_rŞes']è: 
	`¬¿y
(),

79 '#İtiÚs' => 
	`u£r_rŞes
(1),

81 
$fÜm
['»ã»nûabË_¡©us'] = 
	`¬¿y
(

83 '#t™Ë' => 
	`t
('User statushat can be„eferenced'),

84 '#deçuÉ_v®ue' => 
	`is£t
(
$f›ld
['referenceable_status']) ? $field['referenceable_status'] : '',

85 '#İtiÚs' => 
	`¬¿y
('' => 
	`t
('All users'), 1 =>('Active users'), 0 =>('Blocked users')),

87 ià(
	`moduË_exi¡s
('views')) {

88 
$v›ws
 = 
	`¬¿y
('--' => '--');

89 
$®l_v›ws
 = 
	`v›ws_g‘_®l_v›ws
();

90 
	`fÜ—ch
 (
$®l_v›ws
 
as
 
$v›w
) {

92 ià(
$v›w
->
ba£_bË
 =ğ'u£rs' && !
	`em±y
($v›w->
di¥Ïy
['deçuÉ']->
di¥Ïy_İtiÚs
['fields'])) {

93 ià(
$v›w
->
ty³
 == 'Default') {

94 
$v›ws
[
	`t
('DeçuÉ V›ws')][
$v›w
->
Çme
] = $view->name;

97 
$v›ws
[
	`t
('Exi¡šg V›ws')][
$v›w
->
Çme
] = $view->name;

102 
$fÜm
['advªûd'] = 
	`¬¿y
(

104 '#t™Ë' => 
	`t
('Advanced - Usershat can be„eferenced (View)'),

105 '#cŞÏpsibË' => 
TRUE
,

106 '#cŞÏp£d' => !
	`is£t
(
$f›ld
['advanced_view']) || $field['advanced_view'] == '--',

108 ià(
	`couÁ
(
$v›ws
) > 1) {

109 
$fÜm
['advªûd']['advªûd_v›w'] = 
	`¬¿y
(

111 '#t™Ë' => 
	`t
('View usedo selecthe users'),

112 '#İtiÚs' => 
$v›ws
,

113 '#deçuÉ_v®ue' => 
	`is£t
(
$f›ld
['advanced_view']) ? $field['advanced_view'] : '--',

114 '#desütiÚ' => 
	`t
('<p>Choosehe "Views module" viewhat selectshe usershat can be„eferenced.<br />Note:</p>') .

115 
	`t
('<ul><li>Only viewshat have fields will work forhis…urpose.</li><li>This will discardhe "Referenceable Roles"‡nd "Referenceable Status" settings‡bove. Usehe view\'s "filters" section instead.</li><li>Usehe view\'s "fields" sectiono display‡dditional informations‡bout candidate users on user creation/edition form.</li><li>Usehe view\'s "sort criteria" sectiono determinehe order in which candidate users will be displayed.</li></ul>'),

117 
$fÜm
['advªûd']['advªûd_v›w_¬gs'] = 
	`¬¿y
(

119 '#t™Ë' => 
	`t
('View‡rguments'),

120 '#deçuÉ_v®ue' => 
	`is£t
(
$f›ld
['advanced_view_args']) ? $field['advanced_view_args'] : '',

121 '#»quœed' => 
FALSE
,

122 '#desütiÚ' => 
	`t
('Provide‡ comma separated†ist of‡rgumentso…assohe view.'),

126 
$fÜm
['advªûd']['no_v›w_h–p'] = 
	`¬¿y
(

127 '#v®ue' => 
	`t
('<p>The†ist of userhat can be„eferenced can be based on‡ "Views module" view but‚o‡ppropriate views were found. <br />Note:</p>') .

128 
	`t
('<ul><li>Only viewshat have fields will work forhis…urpose.</li><li>This will discardhe "Referenceable Roles"‡nd "Referenceable Status" settings‡bove. Usehe view\'s "filters" section instead.</li><li>Usehe view\'s "fields" sectiono display‡dditional informations‡bout candidate users on user creation/edition form.</li><li>Usehe view\'s "sort criteria" sectiono determinehe order in which candidate users will be displayed.</li></ul>'),

132  
$fÜm
;

135 
$£‰šgs
 = 
	`¬¿y
('referenceable_roles', 'referenceable_status');

136 ià(
	`moduË_exi¡s
('views')) {

137 
$£‰šgs
[] = 'advanced_view';

138 
$£‰šgs
[] = 'advanced_view_args';

140  
$£‰šgs
;

143 
$cŞumns
 = 
	`¬¿y
(

144 'uid' => 
	`¬¿y
('ty³' => 'št', 'unsigÃd' => 
TRUE
, 'nÙ‚uÎ' => 
FALSE
, 'index' => TRUE),

146  
$cŞumns
;

149 
$d©a
 = 
	`cÚ‹Á_v›ws_f›ld_v›ws_d©a
(
$f›ld
);

150 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

151 
$bË_®Ÿs
 = 
	`cÚ‹Á_v›ws_bËÇme
(
$f›ld
);

154 
$d©a
[
$bË_®Ÿs
][
$f›ld
['field_name'] .'_uid']['filter']['handler'] = 'content_handler_filter_many_to_one';

157 
$d©a
["u£rs_$bË_®Ÿs"]['bË']['još']['node'] = 
	`¬¿y
(

160 'Ëá_bË' => 
$bË_®Ÿs
,

161 'Ëá_f›ld' => 
$f›ld
['field_name'] .'_uid',

163 
$d©a
[
$bË_®Ÿs
][
$f›ld
['field_name'] .'_uid']['argument']['handler'] = 'content_handler_argument_reference';

164 
$d©a
[
$bË_®Ÿs
][
$f›ld
['field_name'] .'_uid']['argument']['nameable'] = "users_$table_alias";

165 
$d©a
[
$bË_®Ÿs
][
$f›ld
['field_name'] .'_uid']['argument']['name field'] = 'name';

167 
$d©a
[
$bË_®Ÿs
][
$f›ld
['f›ld_Çme'] .'_uid']['»ÏtiÚsh'] = 
	`¬¿y
(

169 'f›ld' => 
$db_šfo
['columns']['uid']['column'],

171 'Ïb–' => 
	`t
(
$f›ld
['widget']['label']),

172 'cÚ‹Á_f›ld_Çme' => 
$f›ld
['field_name'],

174  
$d©a
;

177 
	}
}

182 
funùiÚ
 
	$u£¼eã»nû_f›ld
(
$İ
, &
$node
, 
$f›ld
, &
$™ems
, 
$‹a£r
, 
$·ge
) {

183 
$İ
) {

186 
$ids
 = 
	`¬¿y
();

187 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

188 ià(
	`is_¬¿y
(
$™em
è&& !
	`em±y
($item['uid'])) {

189 ià(
	`is_num”ic
(
$™em
['uid'])) {

190 
$ids
[] = 
$™em
['uid'];

193 
$”rÜ_–em’t
 = 
	`is£t
(
$™em
['_error_element']) ? $item['_error_element'] : '';

194 ià(
	`is_¬¿y
(
$™em
è&& 
	`is£t
($™em['_”rÜ_–em’t'])è
	`un£t
($item['_error_element']);

195 
	`fÜm_£t_”rÜ
(
$”rÜ_–em’t
, 
	`t
('%Çme: inv®id iÅut.', 
	`¬¿y
('%Çme' =>(
$f›ld
['widget']['label']))));

200 ià(
$ids
) {

201 
$»fs
 = 
	`_u£¼eã»nû_pÙ’tŸl_»ã»nûs
(
$f›ld
, '', 
NULL
, 
$ids
);

202 
	`fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) {

203 ià(
	`is_¬¿y
(
$™em
)) {

204 
$”rÜ_–em’t
 = 
	`is£t
(
$™em
['_error_element']) ? $item['_error_element'] : '';

205 ià(
	`is_¬¿y
(
$™em
è&& 
	`is£t
($™em['_”rÜ_–em’t'])è
	`un£t
($item['_error_element']);

206 ià(!
	`em±y
(
$™em
['uid']è&& !
	`is£t
(
$»fs
[$item['uid']])) {

207 
	`fÜm_£t_”rÜ
(
$”rÜ_–em’t
, 
	`t
('%Çme: inv®id u£r.', 
	`¬¿y
('%Çme' =>(
$f›ld
['widget']['label']))));

212  
$™ems
;

214 
	}
}

219 
funùiÚ
 
	$u£¼eã»nû_cÚ‹Á_is_em±y
(
$™em
, 
$f›ld
) {

220 ià(
	`em±y
(
$™em
['uid'])) {

221  
TRUE
;

223  
FALSE
;

224 
	}
}

229 
funùiÚ
 
	$u£¼eã»nû_f›ld_fÜm©‹r_šfo
() {

230  
	`¬¿y
(

231 'deçuÉ' => 
	`¬¿y
(

232 'Ïb–' => 
	`t
('Default'),

233 'f›ldy³s' => 
	`¬¿y
('userreference'),

234 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

236 '¶aš' => 
	`¬¿y
(

237 'Ïb–' => 
	`t
('Plainext'),

238 'f›ldy³s' => 
	`¬¿y
('userreference'),

239 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

242 
	}
}

247 
funùiÚ
 
	$theme_u£¼eã»nû_fÜm©‹r_deçuÉ
(
$–em’t
) {

248 
$ouut
 = '';

250 ià(
	`is£t
(
$–em’t
['#™em']['uid']è&& 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => $element['#item']['uid']))) {

251 
$ouut
 = 
	`theme
('u£ºame', 
$accouÁ
);

253  
$ouut
;

254 
	}
}

259 
funùiÚ
 
	$theme_u£¼eã»nû_fÜm©‹r_¶aš
(
$–em’t
) {

260 
$ouut
 = '';

261 ià(
	`is£t
(
$–em’t
['#™em']['uid']è&& 
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => $element['#item']['uid']))) {

262 
$ouut
 = 
$accouÁ
->
Çme
;

264  
$ouut
;

265 
	}
}

281 
funùiÚ
 
	$u£¼eã»nû_widg‘_šfo
() {

282  
	`¬¿y
(

283 'u£¼eã»nû_£Ëù' => 
	`¬¿y
(

284 'Ïb–' => 
	`t
('Select†ist'),

285 'f›ldy³s' => 
	`¬¿y
('userreference'),

286 'muÉË v®ues' => 
CONTENT_HANDLE_MODULE
,

287 'ÿÎbacks' => 
	`¬¿y
(

288 'deçuÉ v®ue' => 
CONTENT_CALLBACK_DEFAULT
,

291 'u£¼eã»nû_bu‰Ús' => 
	`¬¿y
(

292 'Ïb–' => 
	`t
('Check boxes/radio buttons'),

293 'f›ldy³s' => 
	`¬¿y
('userreference'),

294 'muÉË v®ues' => 
CONTENT_HANDLE_MODULE
,

295 'ÿÎbacks' => 
	`¬¿y
(

296 'deçuÉ v®ue' => 
CONTENT_CALLBACK_DEFAULT
,

299 'u£¼eã»nû_autocom¶‘e' => 
	`¬¿y
(

300 'Ïb–' => 
	`t
('Autocompleteext field'),

301 'f›ldy³s' => 
	`¬¿y
('userreference'),

302 'muÉË v®ues' => 
CONTENT_HANDLE_CORE
,

303 'ÿÎbacks' => 
	`¬¿y
(

304 'deçuÉ v®ue' => 
CONTENT_CALLBACK_DEFAULT
,

308 
	}
}

322 
funùiÚ
 
	$u£¼eã»nû_–em’ts
() {

323  
	`¬¿y
(

324 'u£¼eã»nû_£Ëù' => 
	`¬¿y
(

325 '#šput' => 
TRUE
,

326 '#cŞumns' => 
	`¬¿y
('uid'), '#delta' => 0,

327 '#´oûss' => 
	`¬¿y
('userreference_select_process'),

329 'u£¼eã»nû_bu‰Ús' => 
	`¬¿y
(

330 '#šput' => 
TRUE
,

331 '#cŞumns' => 
	`¬¿y
('uid'), '#delta' => 0,

332 '#´oûss' => 
	`¬¿y
('userreference_buttons_process'),

334 'u£¼eã»nû_autocom¶‘e' => 
	`¬¿y
(

335 '#šput' => 
TRUE
,

336 '#cŞumns' => 
	`¬¿y
('name'), '#delta' => 0,

337 '#´oûss' => 
	`¬¿y
('userreference_autocomplete_process'),

338 '#autocom¶‘e_·th' => 
FALSE
,

341 
	}
}

346 
funùiÚ
 
	$u£¼eã»nû_widg‘_£‰šgs
(
$İ
, 
$widg‘
) {

347 
$İ
) {

349 
$fÜm
 = 
	`¬¿y
();

350 
$m©ch
 = 
	`is£t
(
$widg‘
['autocomplete_match']) ? $widget['autocomplete_match'] : 'contains';

351 
$size
 = (
	`is£t
(
$widg‘
['size']è&& 
	`is_num”ic
($widget['size'])) ? $widget['size'] : 60;

352 ià(
$widg‘
['type'] == 'userreference_autocomplete') {

353 
$fÜm
['autocom¶‘e_m©ch'] = 
	`¬¿y
(

355 '#t™Ë' => 
	`t
('Autocomplete matching'),

356 '#deçuÉ_v®ue' => 
$m©ch
,

357 '#İtiÚs' => 
	`¬¿y
(

358 '¡¬ts_w™h' => 
	`t
('Starts with'),

359 'cÚšs' => 
	`t
('Contains'),

361 '#desütiÚ' => 
	`t
('Selecthe method usedo collect‡utocomplete suggestions. Notehat <em>Contains</em> can cause…erformance issues on sites withhousands of users.'),

363 
$fÜm
['size'] = 
	`¬¿y
(

365 '#t™Ë' => 
	`t
('Size ofextfield'),

366 '#deçuÉ_v®ue' => 
$size
,

367 '#–em’t_v®id©e' => 
	`¬¿y
('_element_validate_integer_positive'),

368 '#»quœed' => 
TRUE
,

372 
$fÜm
['autocom¶‘e_m©ch'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$m©ch
);

373 
$fÜm
['size'] = 
	`¬¿y
('#ty³' => 'hidd’', '#v®ue' => 
$size
);

375 
$fÜm
['»v”£_lšk'] = 
	`¬¿y
(

377 '#t™Ë' => 
	`t
('Reverse†ink'),

378 '#deçuÉ_v®ue' => 
	`is£t
(
$widg‘
['reverse_link']) ? $widget['reverse_link'] : 0,

379 '#desütiÚ' => 
	`t
('If selected,‡„everse†ink backohe„eferencing‚ode will displayed onhe„eferenced user„ecord.'),

381  
$fÜm
;

384  
	`¬¿y
('autocomplete_match', 'size', 'reverse_link');

386 
	}
}

419 
funùiÚ
 
	$u£¼eã»nû_widg‘
(&
$fÜm
, &
$fÜm_¡©e
, 
$f›ld
, 
$™ems
, 
$d–
 = 0) {

420 
$f›ld
['widget']['type']) {

422 
$–em’t
 = 
	`¬¿y
(

424 '#deçuÉ_v®ue' => 
$™ems
,

429 
$–em’t
 = 
	`¬¿y
(

431 '#deçuÉ_v®ue' => 
$™ems
,

436 
$–em’t
 = 
	`¬¿y
(

438 '#deçuÉ_v®ue' => 
	`is£t
(
$™ems
[
$d–
]è? $™ems[$d–] : 
NULL
,

443  
$–em’t
;

444 
	}
}

451 
funùiÚ
 
	$u£¼eã»nû_autocom¶‘e_v®ue
(
$–em’t
, 
$ed™
 = 
FALSE
) {

452 
$f›ld_key
 = 
$–em’t
['#columns'][0];

453 ià(!
	`em±y
(
$–em’t
['#deçuÉ_v®ue'][
$f›ld_key
])) {

454 
$v®ue
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT‚amFROM {u£rs} WHERE uid = '%d'", 
$–em’t
['#deçuÉ_v®ue'][
$f›ld_key
]));

455  
	`¬¿y
(
$f›ld_key
 => 
$v®ue
);

457  
	`¬¿y
(
$f›ld_key
 => 
NULL
);

458 
	}
}

468 
funùiÚ
 
	$u£¼eã»nû_£Ëù_´oûss
(
$–em’t
, 
$ed™
, 
$fÜm_¡©e
, 
$fÜm
) {

472 
$f›ld_key
 = 
$–em’t
['#columns'][0];

473 
$–em’t
[
$f›ld_key
] = 
	`¬¿y
(

475 '#deçuÉ_v®ue' => 
	`is£t
(
$–em’t
['#value']) ? $element['#value'] : '',

478 '#t™Ë' => 
$–em’t
['#title'],

479 '#»quœed' => 
$–em’t
['#required'],

480 '#desütiÚ' => 
$–em’t
['#description'],

481 '#f›ld_Çme' => 
$–em’t
['#field_name'],

482 '#ty³_Çme' => 
$–em’t
['#type_name'],

483 '#d–' => 
$–em’t
['#delta'],

484 '#cŞumns' => 
$–em’t
['#columns'],

486 ià(
	`em±y
(
$–em’t
[
$f›ld_key
]['#element_validate'])) {

487 
$–em’t
[
$f›ld_key
]['#–em’t_v®id©e'] = 
	`¬¿y
();

489 
	`¬¿y_unshiá
(
$–em’t
[
$f›ld_key
]['#element_validate'], 'userreference_optionwidgets_validate');

490  
$–em’t
;

491 
	}
}

501 
funùiÚ
 
	$u£¼eã»nû_bu‰Ús_´oûss
(
$–em’t
, 
$ed™
, 
$fÜm_¡©e
, 
$fÜm
) {

505 
$f›ld_key
 = 
$–em’t
['#columns'][0];

506 
$–em’t
[
$f›ld_key
] = 
	`¬¿y
(

508 '#deçuÉ_v®ue' => 
	`is£t
(
$–em’t
['#value']) ? $element['#value'] : '',

511 '#t™Ë' => 
$–em’t
['#title'],

512 '#»quœed' => 
$–em’t
['#required'],

513 '#desütiÚ' => 
$–em’t
['#description'],

514 '#f›ld_Çme' => 
$–em’t
['#field_name'],

515 '#ty³_Çme' => 
$–em’t
['#type_name'],

516 '#d–' => 
$–em’t
['#delta'],

517 '#cŞumns' => 
$–em’t
['#columns'],

519 ià(
	`em±y
(
$–em’t
[
$f›ld_key
]['#element_validate'])) {

520 
$–em’t
[
$f›ld_key
]['#–em’t_v®id©e'] = 
	`¬¿y
();

522 
	`¬¿y_unshiá
(
$–em’t
[
$f›ld_key
]['#element_validate'], 'userreference_optionwidgets_validate');

523  
$–em’t
;

524 
	}
}

533 
funùiÚ
 
	$u£¼eã»nû_autocom¶‘e_´oûss
(
$–em’t
, 
$ed™
, 
$fÜm_¡©e
, 
$fÜm
) {

538 
$f›ld_key
 = 
$–em’t
['#columns'][0];

540 
$–em’t
[
$f›ld_key
] = 
	`¬¿y
(

542 '#deçuÉ_v®ue' => 
	`is£t
(
$–em’t
['#value']) ? $element['#value'] : '',

543 '#autocom¶‘e_·th' => 'u£¼eã»nû/autocom¶‘e/'. 
$–em’t
['#field_name'],

546 '#t™Ë' => 
$–em’t
['#title'],

547 '#»quœed' => 
$–em’t
['#required'],

548 '#desütiÚ' => 
$–em’t
['#description'],

549 '#f›ld_Çme' => 
$–em’t
['#field_name'],

550 '#ty³_Çme' => 
$–em’t
['#type_name'],

551 '#d–' => 
$–em’t
['#delta'],

552 '#cŞumns' => 
$–em’t
['#columns'],

554 ià(
	`em±y
(
$–em’t
[
$f›ld_key
]['#element_validate'])) {

555 
$–em’t
[
$f›ld_key
]['#–em’t_v®id©e'] = 
	`¬¿y
();

557 
	`¬¿y_unshiá
(
$–em’t
[
$f›ld_key
]['#element_validate'], 'userreference_autocomplete_validate');

560 
$–em’t
['_”rÜ_–em’t'] = 
	`¬¿y
(

564 '#v®ue' => 
	`im¶ode
('][', 
	`¬¿y_m”ge
(
$–em’t
['#·»Ás'], 
	`¬¿y
(
$f›ld_key
, $field_key))),

566  
$–em’t
;

567 
	}
}

580 
funùiÚ
 
	$u£¼eã»nû_İtiÚwidg‘s_v®id©e
(
$–em’t
, &
$fÜm_¡©e
) {

581 
$f›ld_key
 = 
$–em’t
['#columns'][0];

583 
$v®ue
 = 
$fÜm_¡©e
['values'];

584 
$Ãw_·»Ás
 = 
	`¬¿y
();

585 
	`fÜ—ch
 (
$–em’t
['#·»Ás'] 
as
 
$·»Á
) {

586 
$v®ue
 = $v®ue[
$·»Á
];

588 ià(
$·»Á
 ==ğ
$f›ld_key
) {

589 
$–em’t
['#·»Ás'] = 
$Ãw_·»Ás
;

590 
	`fÜm_£t_v®ue
(
$–em’t
, 
$v®ue
, 
$fÜm_¡©e
);

593 
$Ãw_·»Ás
[] = 
$·»Á
;

595 
	}
}

604 
funùiÚ
 
	$u£¼eã»nû_autocom¶‘e_v®id©e
(
$–em’t
, &
$fÜm_¡©e
) {

605 
$f›ld_Çme
 = 
$–em’t
['#field_name'];

606 
$ty³_Çme
 = 
$–em’t
['#type_name'];

607 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
, 
$ty³_Çme
);

608 
$f›ld_key
 = 
$–em’t
['#columns'][0];

609 
$v®ue
 = 
$–em’t
['#v®ue'][
$f›ld_key
];

610 
$uid
 = 
NULL
;

611 ià(!
	`em±y
(
$v®ue
)) {

612 
$»ã»nû
 = 
	`_u£¼eã»nû_pÙ’tŸl_»ã»nûs
(
$f›ld
, 
$v®ue
, 'equ®s', 
NULL
, 1);

613 ià(
	`em±y
(
$»ã»nû
)) {

614 
	`fÜm_”rÜ
(
$–em’t
[
$f›ld_key
], 
	`t
('%Çme: found‚Øv®id u£¸w™hh©‚ame.', 
	`¬¿y
('%Çme' =>(
$f›ld
['widget']['label']))));

617 
$uid
 = 
	`key
(
$»ã»nû
);

620 
	`fÜm_£t_v®ue
(
$–em’t
, 
$uid
, 
$fÜm_¡©e
);

621 
	}
}

626 
funùiÚ
 
	$u£¼eã»nû_®lowed_v®ues
(
$f›ld
) {

627 
$»ã»nûs
 = 
	`_u£¼eã»nû_pÙ’tŸl_»ã»nûs
(
$f›ld
);

629 
$İtiÚs
 = 
	`¬¿y
();

630 
	`fÜ—ch
 (
$»ã»nûs
 
as
 
$key
 => 
$v®ue
) {

631 
$İtiÚs
[
$key
] = 
$v®ue
['rendered'];

634  
$İtiÚs
;

635 
	}
}

669 
funùiÚ
 
_u£¼eã»nû_pÙ’tŸl_»ã»nûs
(
$f›ld
, 
$¡ršg
 = '', 
$m©ch
 = 'cÚšs', 
$ids
 = 
¬¿y
(), 
$lim™
 = 
NULL
) {

670 
$»suÉs
 = 
¬¿y
();

673 
	g$cid
 = 
$f›ld
['f›ld_Çme'] .':'. 
$m©ch
 .':'. (
$¡ršg
 !=ğ'' ? $¡ršg : 
im¶ode
('-', 
$ids
)è.':'. 
	g$lim™
;

674 ià(!
is£t
(
$»suÉs
[
$cid
])) {

675 
	g$»ã»nûs
 = 
FALSE
;

676 ià(
moduË_exi¡s
('v›ws'è&& !
em±y
(
$f›ld
['advªûd_v›w']è&& 
	g$f›ld
['advanced_view'] != '--') {

677 
$»ã»nûs
 = 
_u£¼eã»nû_pÙ’tŸl_»ã»nûs_v›ws
(
$f›ld
, 
$¡ršg
, 
$m©ch
, 
$ids
, 
$lim™
);

681 ià(
	g$»ã»nûs
 ==ğ
FALSE
) {

682 
$»ã»nûs
 = 
_u£¼eã»nû_pÙ’tŸl_»ã»nûs_¡ªd¬d
(
$f›ld
, 
$¡ršg
, 
$m©ch
, 
$ids
, 
$lim™
);

686 
	g$»suÉs
[
$cid
] = !
em±y
(
$»ã»nûs
è? $»ã»nû : 
¬¿y
();

689  
	g$»suÉs
[
$cid
];

696 
funùiÚ
 
_u£¼eã»nû_pÙ’tŸl_»ã»nûs_v›ws
(
$f›ld
, 
$¡ršg
 = '', 
$m©ch
 = 'cÚšs', 
$ids
 = 
¬¿y
(), 
$lim™
 = 
NULL
) {

697 
$v›w_Çme
 = 
$f›ld
['advanced_view'];

699 ià(
	g$v›w
 = 
v›ws_g‘_v›w
(
$v›w_Çme
)) {

702 
$di¥Ïy
 = 
$v›w
->
add_di¥Ïy
('content_references');

703 
	g$v›w
->
£t_di¥Ïy
(
$di¥Ïy
);

707 
	g$v›w
->
	gdi¥Ïy_hªdËr
->
£t_İtiÚ
('style_plugin', 'content_php_array_autocomplete');

708 
	g$v›w
->
	gdi¥Ïy_hªdËr
->
£t_İtiÚ
('row_plugin', 'fields');

711 
	g$v›w
->
	gdi¥Ïy_hªdËr
->
£t_İtiÚ
('content_title_field', 'name');

715 
	g$İtiÚs
 = 
¬¿y
(

718 '¡ršg' => 
$¡ršg
,

719 'm©ch' => 
$m©ch
,

721 'ids' => 
$ids
,

723 
	g$v›w
->
	gdi¥Ïy_hªdËr
->
£t_İtiÚ
('cÚ‹Á_İtiÚs', 
$İtiÚs
);

729 
	g$lim™
 = 
is£t
(
$lim™
) ? $limit : 0;

730 
	g$v›w
->
	gdi¥Ïy_hªdËr
->
£t_İtiÚ
('™ems_³r_·ge', 
$lim™
);

733 ià(!
em±y
(
$f›ld
['advanced_view_args'])) {

735 
	g$v›w_¬gs
 = 
¬¿y_m­
('Œim', 
ex¶ode
(',', 
$f›ld
['advanced_view_args']));

738 
	g$v›w_¬gs
 = 
¬¿y
();

742 
	g$f›lds
 = 
$v›w
->
g‘_™ems
('f›ld', 
$di¥Ïy
);

743 ià(!
is£t
(
$f›lds
['name'])) {

744 
	g$v›w
->
add_™em
(
$di¥Ïy
, 'field', 'users', 'name');

748 
	g$İtiÚs
 = 
$v›w
->
di¥Ïy_hªdËr
->
g‘_İtiÚ
('row_options');

749 ià(
em±y
(
$İtiÚs
['inline'])) {

750 
	g$İtiÚs
['šlše'] = 
dru·l_m­_assoc
(
¬¿y_keys
(
$v›w
->
g‘_™ems
('f›ld', 
$di¥Ïy
)));

752 ià(
em±y
(
$İtiÚs
['separator'])) {

753 
	g$İtiÚs
['separator'] = '-';

755 
	g$v›w
->
	gdi¥Ïy_hªdËr
->
£t_İtiÚ
('row_İtiÚs', 
$İtiÚs
);

758 
	g$v›w
->
	gis_ÿch—bË
 = 
FALSE
;

761 
	g$»suÉ
 = 
$v›w
->
execu‹_di¥Ïy
(
$di¥Ïy
, 
$v›w_¬gs
);

764 
	g$»suÉ
 = 
FALSE
;

767  
	g$»suÉ
;

774 
funùiÚ
 
_u£¼eã»nû_pÙ’tŸl_»ã»nûs_¡ªd¬d
(
$f›ld
, 
$¡ršg
 = '', 
$m©ch
 = 'cÚšs', 
$ids
 = 
¬¿y
(), 
$lim™
 = 
NULL
) {

775 
$wh”e
 = 
¬¿y
();

776 
	g$¬gs
 = 
¬¿y
();

777 
	g$još
 = 
¬¿y
();

779 ià(
	g$¡ršg
 !== '') {

780 
$like
 = 
$GLOBALS
["db_type"] == 'pgsql' ? "ILIKE" : "LIKE";

781 
	g$m©ch_şau£s
 = 
¬¿y
(

786 
	g$wh”e
[] = 'u.Çm'. (
is£t
(
$m©ch_şau£s
[
$m©ch
]) ? $match_clauses[$match] : $match_clauses['contains']);

787 
	g$¬gs
[] = 
$¡ršg
;

789 
–£if
 (
$ids
) {

790 
	g$wh”e
[] = 'u.uid IN (' . 
db_¶aûhŞd”s
(
$ids
) . ')';

791 
	g$¬gs
 = 
¬¿y_m”ge
(
$¬gs
, 
$ids
);

794 
	g$wh”e
[] = "u.uid > 0";

797 
	g$rŞes
 = 
¬¿y
();

798 ià(
is£t
(
$f›ld
['»ã»nûabË_rŞes']è&& 
is_¬¿y
($field['referenceable_roles'])) {

800 
	g$rŞes
 = 
¬¿y_f‹r
(
$f›ld
['referenceable_roles']);

802 
	g$rŞes
 = 
¬¿y_š‹r£ù
(
¬¿y_keys
(
u£r_rŞes
(1)), 
$rŞes
);

804 ià(!
em±y
(
$rŞes
è&& !
š_¬¿y
(
DRUPAL_AUTHENTICATED_RID
, $roles)) {

805 
	g$wh”e
[] = "r.rid IN (". 
im¶ode
(
$rŞes
, ',') .")";

806 
	g$još
[] = 'LEFT JOIN {users_roles}„ ON u.uid =„.uid';

809 ià(
is£t
(
$f›ld
['»ã»nûabË_¡©us']è&& 
is_num”ic
($field['referenceable_status'])) {

810 
	g$wh”e
[] = 'u.status = %d';

811 
	g$¬gs
[] = 
$f›ld
['referenceable_status'];

814 
	g$u£rs
 = 
¬¿y
();

815 
	g$wh”e_şau£
 = 
$wh”e
 ? 'WHERE ('. 
im¶ode
(') AND (', $where) .')' : '';

816 
	g$»suÉ
 = 
db_qu”y
('SELECT u.Çme, u.uid FROM {u£rs} u '. 
im¶ode
(' ', 
$još
è." $wh”e_şau£ ORDER BY u.ÇmASC", 
$¬gs
);

817 
	g$u£r
 = 
db_ãtch_objeù
(
$»suÉ
)) {

818 
$u£rs
[
$u£r
->
uid
] = 
¬¿y
(

819 't™Ë' => 
$u£r
->
Çme
,

820 '»nd”ed' => 
check_¶aš
(
$u£r
->
Çme
),

823  
	g$u£rs
;

829 
funùiÚ
 
u£¼eã»nû_autocom¶‘e
(
$f›ld_Çme
, 
$¡ršg
 = '') {

830 
$f›lds
 = 
cÚ‹Á_f›lds
();

831 
	g$f›ld
 = 
$f›lds
[
$f›ld_Çme
];

832 
	g$m©ch
 = 
is£t
(
$f›ld
['widget']['autocomplete_match']) ? $field['widget']['autocomplete_match'] : 'contains';

833 
	g$m©ches
 = 
¬¿y
();

835 
	g$»ã»nûs
 = 
_u£¼eã»nû_pÙ’tŸl_»ã»nûs
(
$f›ld
, 
$¡ršg
, 
$m©ch
, 
¬¿y
(), 10);

836 
fÜ—ch
 (
$»ã»nûs
 
as
 
$id
 => 
$row
) {

838 
$m©ches
[
$row
['title']] = '<div class="reference-autocomplete">'. $row['rendered'] . '</div>';

840 
dru·l_jsÚ
(
$m©ches
);

846 
funùiÚ
 
	$u£¼eã»nû_u£r
(
$ty³
, &
$ed™
, &
$accouÁ
) {

847 
$ty³
) {

850 ià(
	`¬g
(0) != 'user' ||‡rg(2)) {

855 
$add™iÚs
 = 
	`¬¿y
();

856 
$ty³s
 = 
	`cÚ‹Á_ty³s
();

861 
$£¬ch_bËs
 = 
	`¬¿y
();

862 
	`fÜ—ch
 (
$ty³s
 
as
 
$ty³_Çme
 => 
$ty³
) {

863 
	`fÜ—ch
 (
$ty³
['f›lds'] 
as
 
$f›ld
) {

865 ià(
$f›ld
['ty³'] =ğ'u£¼eã»nû' && !
	`em±y
($field['widget']['reverse_link'])) {

866 
$db_šfo
 = 
	`cÚ‹Á_d©aba£_šfo
(
$f›ld
);

867 
$£¬ch_bËs
[
$db_šfo
['table']][] = $db_info['columns']['uid']['column'];

871 
	`fÜ—ch
 (
$£¬ch_bËs
 
as
 
$bË
 => 
$cŞumns
) {

872 
	`fÜ—ch
 (
$cŞumns
 
as
 
$cŞumn
) {

873 
$ids
 = 
	`db_qu”y
(
	`db_»wr™e_sql
("SELECT DISTINCTÒ.nid),‚.t™Ë,‚.ty³ FROM {node}‚ LEFT JOIN {". 
$bË
 ."} f ON‚.vid = f.vid WHERE f.". 
$cŞumn
 ."=". 
$accouÁ
->
uid
. " AND‚.status = 1"));

874 
$d©a
 = 
	`db_ãtch_objeù
(
$ids
)) {

875 
$add™iÚs
[
$d©a
->
ty³
][$d©a->
nid
] = $d©a->
t™Ë
;

879 
$accouÁ
->
u£¼eã»nû
 = 
$add™iÚs
;

883 ià(!
	`em±y
(
$accouÁ
->
u£¼eã»nû
)) {

884 
$node_ty³s
 = 
	`cÚ‹Á_ty³s
();

885 
$add™iÚs
 = 
	`¬¿y
();

886 
$v®ues
 = 
	`¬¿y
();

887 
	`fÜ—ch
 (
$accouÁ
->
u£¼eã»nû
 
as
 
$node_ty³
 => 
$nodes
) {

888 
	`fÜ—ch
 (
$nodes
 
as
 
$nid
 => 
$t™Ë
) {

889 
$v®ues
[
$node_ty³
][] = 
	`l
(
$t™Ë
, 'node/'. 
$nid
);

891 ià(
	`is£t
(
$v®ues
[
$node_ty³
])) {

892 
$add™iÚs
[] = 
	`¬¿y
(

894 '#t™Ë' => 
	`check_¶aš
(
$node_ty³s
[
$node_ty³
]['name']),

895 '#v®ue' => 
	`theme
('™em_li¡', 
$v®ues
[
$node_ty³
]),

899 ià(
$add™iÚs
) {

900 
$accouÁ
->
cÚ‹Á
['u£¼eã»nû'] = 
$add™iÚs
 + 
	`¬¿y
(

902 '#©Œibu‹s' => 
	`¬¿y
('class' => 'user-member'),

903 '#t™Ë' => 
	`t
('Related content'),

910 
	}
}

923 
funùiÚ
 
	$theme_u£¼eã»nû_£Ëù
(
$–em’t
) {

924  
$–em’t
['#children'];

925 
	}
}

927 
funùiÚ
 
	$theme_u£¼eã»nû_bu‰Ús
(
$–em’t
) {

928  
$–em’t
['#children'];

929 
	}
}

931 
funùiÚ
 
	$theme_u£¼eã»nû_autocom¶‘e
(
$–em’t
) {

932  
$–em’t
['#children'];

933 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/userreference/userreference.rules.inc

1 <?
php


12 
funùiÚ
 
	$u£¼eã»nû_ruËs_aùiÚ_šfo
() {

13 
$šfo
 = 
	`¬¿y
();

14 
$šfo
['u£¼eã»nû_ruËs_aùiÚ_lßd'] = 
	`¬¿y
(

15 'Ïb–' => 
	`t
('Load‡„eferenced user'),

16 '¬gum’ts' => 
	`¬¿y
(

17 'node' => 
	`¬¿y
(

19 'Ïb–' => 
	`t
('Content containinghe user„eference field'),

22 'Ãw v¬ŸbËs' => 
	`¬¿y
(

23 '»ã»nûd_u£r' => 
	`¬¿y
(

25 'Ïb–' => 
	`t
('Referenced user'),

29 'h–p' => 
	`t
('Notehat ifhe field has multiple values, onlyhe first user will be†oaded.'),

31  
$šfo
;

32 
	}
}

34 
funùiÚ
 
	$u£¼eã»nû_ruËs_aùiÚ_lßd
(
$node
, 
$£‰šgs
) {

35 
$uid
 = 
$node
->{
$£‰šgs
['field']}[0]['uid'];

36 ià(
	`is£t
(
$uid
)) {

37 
$u£r
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => 
$uid
));

38  
	`¬¿y
('»ã»nûd_u£r' => 
$u£r
);

40 
	}
}

42 
funùiÚ
 
	$u£¼eã»nû_ruËs_aùiÚ_lßd_fÜm
(
$£‰šgs
, &
$fÜm
) {

43 
$£‰šgs
 +ğ
	`¬¿y
('field' => '');

44 
$İtiÚs
 = 
	`cÚ‹Á_ruËs_g‘_f›ld_Çmes_by_ty³
('userreference');

45 
$fÜm
['£‰šgs']['f›ld'] = 
	`¬¿y
(

47 '#t™Ë' => 
	`t
('Field'),

48 '#deçuÉ_v®ue' => 
$£‰šgs
['field'],

49 '#İtiÚs' => 
$İtiÚs
,

50 '#»quœed' => 
TRUE
,

51 '#di§bËd' => 
	`em±y
(
$İtiÚs
),

52 '#desütiÚ' => 
	`em±y
(
$İtiÚs
è? 
	`t
('There‡re‚o userreference fields defined.') : '',

54 
	}
}

60 
funùiÚ
 
	$wÜkæow_ng_aùiÚ_lßd_»ã»nûd_u£r_upg¿de
(&
$–em’t
) {

61 
$–em’t
['#name'] = 'userreference_rules_action_load';

62 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/theme/content-admin-display-overview-form.tpl.php

1 <?
	gphp


4 <
	gdiv
>

5 <?
php
 
´št
 
	g$h–p
; ?>

6 </
	gdiv
>

7 <?
php
 ià(
	g$rows
): ?>

8 <
bË
 
id
="cÚ‹Á-di¥Ïy-ov”v›w" 
şass
="sticky-enabled">

9 <
th—d
>

10 <
Œ
>

11 <
th
><?
php
 
´št
 
t
('F›ld'); ?></
	gth
>

12 <?
php
 ià(
	g$basic
): ?>

13 <
th
><?
php
 
´št
 
t
('Lab–'); ?></
	gth
>

14 <?
php
 
	g’dif
; ?>

15 <?
php
 
fÜ—ch
 (
$cÚ‹xts
 
as
 
$key
 => 
$v®ue
): ?>

16 <
th
><?
php
 
´št
 
$v®ue
['t™Ë']; ?></
	gth
>

17 <
	gth
><?
php
 
´št
 
t
('Exclude'); ?></th>

18 <?
php
 
	g’dfÜ—ch
; ?>

19 </
	gŒ
>

20 </
	gth—d
>

21 <
	gtbody
>

22 <?
php


23 
	g$couÁ
 = 0;

24 
	$fÜ—ch
 (
$rows
 
as
 
$row
): ?>

25 <
Œ
 
şass
="<?php…rint $count % 2 == 0 ? 'odd' : 'even'; ?>">

26 <
td
><?
php
 
´št
 
$row
->
šd’tiÚ
; ?><
¥ª
 
şass
="<?ph°´šˆ$row->Ïb–_şass; ?>"><?ph°´šˆ$row->
humª_Çme
; ?></span></td>

27 <?
php
 ià(
$basic
): ?>

28 <
td
><?
php
 
´št
 
$row
->
Ïb–
; ?></td>

29 <?
php
 
’dif
; ?>

30 <?
php
 
	`fÜ—ch
 (
$cÚ‹xts
 
as
 
$cÚ‹xt
 => 
$t™Ë
): ?>

31 <
td
><?
php
 
´št
 
$row
->{
$cÚ‹xt
}->fÜm©; ?></td>

32 <
	gtd
><?
php
 
´št
 
	g$row
->{
	g$cÚ‹xt
}->
	gexşude
; ?></td>

33 <?
php
 
	g’dfÜ—ch
; ?>

34 </
	gŒ
>

35 <?
php
 
	g$couÁ
++;

36 
	g’dfÜ—ch
; ?>

37 </
	gtbody
>

38 </
	gbË
>

39 <?
php
 
´št
 
	g$subm™
; ?>

40 <?
php
 
	g’dif
; ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/theme/content-admin-field-overview-form.tpl.php

1 <?
	gphp


4 <
	gdiv
>

5 <?
php
 
´št
 
	g$h–p
; ?>

6 </
	gdiv
>

7 <
bË
 
	gid
="cÚ‹Á-f›ld-ov”v›w" 
şass
="sticky-enabled">

8 <
th—d
>

9 <
Œ
>

10 <
th
><?
php
 
´št
 
t
('Lab–'); ?></
	gth
>

11 <
	gth
><?
php
 
´št
 
t
('Weight'); ?></th>

12 <
	gth
><?
php
 
´št
 
t
('Name'); ?></th>

13 <
	gth
><?
php
 
´št
 
t
('Type'); ?></th>

14 <
	gth
><?
php
 
´št
 
t
('Operations'); ?></th>

15 </
	gŒ
>

16 </
	gth—d
>

17 <
	gtbody
>

18 <?
php


19 
	g$couÁ
 = 0;

20 
	$fÜ—ch
 (
$rows
 
as
 
$row
): ?>

21 <
Œ
 
şass
="<?php…rint $count % 2 == 0 ? 'odd' : 'even'; ?> <?php…rint $row->class ?>">

22 <?
php


23 
$row
->
row_ty³
):

25 <
td
>

26 <?
php
 
´št
 
$row
->
šd’tiÚ
; ?>

27 <
¥ª
 
şass
="<?ph°´šˆ$row->Ïb–_şass; ?>"><?
php
 
´št
 
$row
->
Ïb–
; ?></span>

28 </
td
>

29 <
td
><?
php
 
´št
 
$row
->
weight
 . $row->
·»Á
 . $row->
hidd’_Çme
; ?></td>

30 <
td
><?
php
 
´št
 
$row
->
f›ld_Çme
; ?></td>

31 <
td
><?
php
 
´št
 
$row
->
ty³
; ?></td>

32 <
td
><?
php
 
´št
 
$row
->
cÚfigu»
; ?>&
nb¥
;&nb¥;<?ph°´šˆ$row->
»move
; ?></td>

33 <?
php
 ;

35 <
td
>

36 <?
php
 
´št
 
$row
->
šd’tiÚ
; ?>

37 <
¥ª
 
şass
="<?ph°´šˆ$row->Ïb–_şass; ?>"><?
php
 
´št
 
$row
->
Ïb–
; ?></span>

38 </
td
>

39 <
td
><?
php
 
´št
 
$row
->
weight
 . $row->
·»Á
 . $row->
hidd’_Çme
; ?></td>

40 <
td
><?
php
 
´št
 
$row
->
group_Çme
; ?></td>

41 <
td
><?
php
 
´št
 
$row
->
group_ty³
; ?></td>

42 <
td
><?
php
 
´št
 
$row
->
cÚfigu»
; ?>&
nb¥
;&nb¥;<?ph°´šˆ$row->
»move
; ?></td>

43 <?
php
 ;

45 <
td
>

46 <?
php
 
´št
 
$row
->
šd’tiÚ
; ?>

47 <
¥ª
 
şass
="<?ph°´šˆ$row->Ïb–_şass; ?>"><?
php
 
´št
 
$row
->
Ïb–
; ?></span>

48 </
td
>

49 <
td
><?
php
 
´št
 
$row
->
weight
 . $row->
·»Á
 . $row->
hidd’_Çme
; ?></td>

50 <
td
 
cŞ¥ª
="2"><?
php
 
´št
 
$row
->
desütiÚ
; ?></td>

51 <
td
><?
php
 
´št
 
$row
->
cÚfigu»
; ?>&
nb¥
;&nb¥;<?ph°´šˆ$row->
»move
; ?></td>

52 <?
php
 ;

54 <
td
 
cŞ¥ª
="5" 
şass
="»giÚ"><?
php
 
´št
 
	`t
('Add'); ?></td>

55 <?
php
 ;

57 <
td
>

58 <?
php
 
´št
 
$row
->
šd’tiÚ
; ?>

59 <
div
 
şass
="<?php…rint $row->label_class; ?>">

60 <
div
 
şass
="cÚ‹Á-Ãw"><?
php
 
´št
 
	`theme
('advªûd_h–p_tİic', 'cÚ‹Á', 'add-Ãw-f›ld'è. 
	`t
('New field'); ?></div>

61 <?
php
 
´št
 
$row
->
Ïb–
; ?>

62 </
div
>

63 </
td
>

64 <
td
><
div
 
şass
="cÚ‹Á-Ãw">&
nb¥
;</div><?
php
 
´št
 
$row
->
weight
 . $row->
·»Á
 . $row->
hidd’_Çme
; ?></td>

65 <
td
><
div
 
şass
="cÚ‹Á-Ãw">&
nb¥
;</div><?
php
 
´št
 
$row
->
f›ld_Çme
; ?></td>

66 <
td
><
div
 
şass
="cÚ‹Á-Ãw">&
nb¥
;</div><?
php
 
´št
 
$row
->
ty³
; ?></td>

67 <
td
><
div
 
şass
="cÚ‹Á-Ãw">&
nb¥
;</div><?
php
 
´št
 
$row
->
widg‘_ty³
; ?></td>

68 <?
php
 ;

70 <
td
>

71 <?
php
 
´št
 
$row
->
šd’tiÚ
; ?>

72 <
div
 
şass
="<?php…rint $row->label_class; ?>">

73 <
div
 
şass
="cÚ‹Á-Ãw"><?
php
 
´št
 
	`theme
('advªûd_h–p_tİic', 'cÚ‹Á', 'add-exi¡šg-f›ld'è. 
	`t
('Existing field'); ?></div>

74 <?
php
 
´št
 
$row
->
Ïb–
; ?>

75 </
div
>

76 </
td
>

77 <
td
><
div
 
şass
="cÚ‹Á-Ãw">&
nb¥
;</div><?
php
 
´št
 
$row
->
weight
 . $row->
·»Á
 . $row->
hidd’_Çme
; ?></td>

78 <
td
 
cŞ¥ª
="2"><
div
 
şass
="cÚ‹Á-Ãw">&
nb¥
;</div><?
php
 
´št
 
$row
->
f›ld_Çme
; ?></td>

79 <
td
><
div
 
şass
="cÚ‹Á-Ãw">&
nb¥
;</div><?
php
 
´št
 
$row
->
widg‘_ty³
; ?></td>

80 <?
php
 ;

82 <
td
>

83 <?
php
 
´št
 
$row
->
šd’tiÚ
; ?>

84 <
div
 
şass
="<?php…rint $row->label_class; ?>">

85 <
div
 
şass
="cÚ‹Á-Ãw"><?
php
 
´št
 
	`theme
('advªûd_h–p_tİic', 'cÚ‹Á', 'add-Ãw-group'è. 
	`t
('New group'); ?></div>

86 <?
php
 
´št
 
$row
->
Ïb–
; ?>

87 </
div
>

88 </
td
>

89 <
td
><
div
 
şass
="cÚ‹Á-Ãw">&
nb¥
;</div><?
php
 
´št
 
$row
->
weight
 . $row->
·»Á
 . $row->
hidd’_Çme
; ?></td>

90 <
td
><
div
 
şass
="cÚ‹Á-Ãw">&
nb¥
;</div><?
php
 
´št
 
$row
->
group_Çme
; ?></td>

91 <
td
><
div
 
şass
="cÚ‹Á-Ãw">&
nb¥
;</div><?
php
 
´št
 
$row
->
group_ty³
; ?></td>

92 <
td
><
div
 
şass
="cÚ‹Á-Ãw">&
nb¥
;</div><?
php
 
´št
 
$row
->
group_İtiÚ
; ?></td>

93 <?
php
 ;

94 
’dsw™ch
; ?>

95 </
Œ
>

96 <?
php
 
$couÁ
++;

97 
’dfÜ—ch
; ?>

98 </
tbody
>

99 </
bË
>

101 <?
php
 
´št
 
$subm™
; ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/theme/content-field.tpl.php

1 <?
	gphp


28 <?
php
 ià(!
	g$f›ld_em±y
) : ?>

29 <
div
 
şass
="field field-type-<?php…rint $field_type_css ?> field-<?php…rint $field_name_css ?>">

30 <?
php
 ià(
$Ïb–_di¥Ïy
 == 'above') : ?>

31 <
div
 
şass
="f›ld-Ïb–"><?
php
 
´št
 
t
(
$Ïb–
è?>:&
nb¥
;</
	gdiv
>

32 <?
php
 
	g’dif
;?>

33 <
div
 
	gşass
="field-items">

34 <?
php
 
$couÁ
 = 1;

35 
fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) :

36 ià(!
$™em
['empty']) : ?>

37 <
div
 
şass
="field-item <?php…rint ($count % 2 ? 'odd' : 'even') ?>">

38 <?
php
 ià(
$Ïb–_di¥Ïy
 == 'inline') { ?>

39 <
div
 
şass
="field-label-inline<?php…rint($delta ? '' : '-first')?>">

40 <?
php
 
´št
 
t
(
$Ïb–
è?>:&
nb¥
;</
	gdiv
>

41 <?
	gphp
 } ?>

42 <?
php
 
´št
 
	g$™em
['view'] ?>

43 </
	gdiv
>

44 <?
php
 
	g$couÁ
++;

45 
	g’dif
;

46 
	g’dfÜ—ch
;?>

47 </
	gdiv
>

48 </
	gdiv
>

49 <?
php
 
	g’dif
; ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/cck/theme/theme.inc

1 <?
php


8 
funùiÚ
 
	$‹m¶©e_´•roûss_cÚ‹Á_f›ld_ov”v›w_fÜm
(&
$v¬s
) {

9 
$fÜm
 = &
$v¬s
['form'];

11 
$v¬s
['h–p'] = 
	`theme
('advªûd_h–p_tİic', 'cÚ‹Á', 'mªage-f›lds'è. 
	`t
('Add fields‡nd groupsohe contentype,‡nd‡rrangehem on content display‡nd input forms.');

12 ià(
	`moduË_exi¡s
('fieldgroup')) {

13 
$v¬s
['h–p'] .ğ'<br/>'. 
	`t
('You can‡dd‡ fieldo‡ group by dragging it below‡ndohe„ight ofhe group.');

15 ià(!
	`moduË_exi¡s
('advanced_help')) {

16 
$v¬s
['h–p'] .ğ'<br/>' . 
	`t
('NÙe: In¡®lšgh<¨h»f="!adv_h–p">Advªûd h–p</a> moduË wÈËˆyou‡cûs mÜªd b‘‹¸h–p.', 
	`¬¿y
('!adv_help' => 'http://drupal.org/project/advanced_help'));

19 
$Üd”
 = 
	`_cÚ‹Á_ov”v›w_Üd”
(
$fÜm
, $form['#field_rows'], $form['#group_rows']);

20 
$rows
 = 
	`¬¿y
();

24 
$keys
 = 
	`¬¿y_keys
(
$fÜm
);

25 
$add_rows
 = 
	`¬¿y
();

26 
	`fÜ—ch
 (
$keys
 
as
 
$key
) {

27 ià(
	`sub¡r
(
$key
, 0, 4) == '_add') {

28 
$add_rows
[] = 
$key
;

31 
$Üd”
) {

32 
$key
 = 
	`»£t
(
$Üd”
);

33 
$–em’t
 = &
$fÜm
[
$key
];

37 ià(!
	`is£t
(
$added_£·¿tÜ
)) {

38 
$»maššg_rows
 = 
	`¬¿y_diff
(
$Üd”
, 
$add_rows
);

39 ià(
	`em±y
(
$»maššg_rows
è&&ƒm±y(
$–em’t
['#depth'])) {

40 
$row
 = 
Ãw
 
	`¡dCÏss
();

41 
$row
->
row_ty³
 = 'separator';

42 
$row
->
şass
 = 'tabledrag-leaf„egion';

43 
$rows
[] = 
$row
;

44 
$added_£·¿tÜ
 = 
TRUE
;

48 
$row
 = 
Ãw
 
	`¡dCÏss
();

51 
$–em’t
['weight']['#attributes']['class'] = 'field-weight';

52 
$–em’t
['parent']['#attributes']['class'] = 'group-parent';

53 
$–em’t
['hidden_name']['#attributes']['class'] = 'field-name';

55 
$–em’t
['#row_type']) {

57 
$–em’t
['type']['#attributes']['class'] = 'content-field-type-select';

58 
$–em’t
['widget_type']['#attributes']['class'] = 'content-widget-type-select';

61 
$–em’t
['field_name']['#attributes']['class'] = 'content-field-select';

62 
$–em’t
['widget_type']['#attributes']['class'] = 'content-widget-type-select';

63 
$–em’t
['label']['#attributes']['class'] = 'content-label-textfield';

66 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$–em’t
è
as
 
$chd
) {

67 
$row
->{
$chd
} = 
	`dru·l_»nd”
(
$–em’t
[$child]);

69 
$row
->
Ïb–_şass
 = 'Ïb–-'. 
	`¡¹r
(
$–em’t
['#row_type'], '_', '-');

70 
$row
->
row_ty³
 = 
$–em’t
['#row_type'];

71 
$row
->
šd’tiÚ
 = 
	`theme
('šd’tiÚ', 
	`is£t
(
$–em’t
['#depth']) ? $element['#depth'] : 0);

72 
$row
->
şass
 = 'draggable';

73 
$row
->
şass
 .ğ
	`is£t
(
$–em’t
['#disabled_row']) ? ' menu-disabled' : '';

74 
$row
->
şass
 .ğ
	`is£t
(
$–em’t
['#add_new']) ? ' content-add-new' : '';

75 
$row
->
şass
 .ğ
	`is£t
(
$–em’t
['#leaf']) ? 'abledrag-leaf' : '';

76 
$row
->
şass
 .ğ
	`is£t
(
$–em’t
['#root']) ? 'abledrag-root' : '';

78 
$rows
[] = 
$row
;

79 
	`¬¿y_shiá
(
$Üd”
);

81 
$v¬s
['rows'] = 
$rows
;

82 
$v¬s
['subm™'] = 
	`dru·l_»nd”
(
$fÜm
);

86 
	`dru·l_add_bËd¿g
('cÚ‹Á-f›ld-ov”v›w', 'm©ch', '·»Á', 'group-·»Á', 'group-·»Á', 'f›ld-Çme', 
TRUE
, 1);

88 
	`dru·l_add_bËd¿g
('content-field-overview', 'order', 'sibling', 'field-weight');

91 
$js_f›lds
 = 
	`¬¿y
();

92 
	`fÜ—ch
 (
	`¬¿y_keys
(
	`cÚ‹Á_exi¡šg_f›ld_İtiÚs
(
$fÜm
['#ty³_Çme'])è
as
 
$f›ld_Çme
) {

93 
$f›ld
 = 
	`cÚ‹Á_f›lds
(
$f›ld_Çme
);

94 
$js_f›lds
[
$f›ld_Çme
] = 
	`¬¿y
('Ïb–' => 
$f›ld
['widget']['label'], 'type' => $field['type'], 'widget' => $field['widget']['type']);

96 
	`dru·l_add_js
(
	`¬¿y
('cÚ‹ÁWidg‘Ty³s' => 
	`cÚ‹Á_widg‘_ty³_İtiÚs
(), 'cÚ‹ÁF›lds' => 
$js_f›lds
), 'setting');

97 
	`dru·l_add_js
(
	`dru·l_g‘_·th
('module', 'content') .'/content.js');

98 
	}
}

103 
funùiÚ
 
	$‹m¶©e_´•roûss_cÚ‹Á_di¥Ïy_ov”v›w_fÜm
(&
$v¬s
) {

104 
$fÜm
 = &
$v¬s
['form'];

106 
$cÚ‹xts_£ËùÜ
 = 
$fÜm
['#contexts'];

107 
$v¬s
['basic'] = 
$cÚ‹xts_£ËùÜ
 == 'basic';

108 
$v¬s
['cÚ‹xts'] = 
	`cÚ‹Á_bud_modes
(
$cÚ‹xts_£ËùÜ
);

110 ià(
$cÚ‹xts_£ËùÜ
 == 'basic') {

111 
$h–p
 = 
	`t
("Configure howhis contentype's fields‡nd field†abels should be displayed when it's viewed ineaser‡nd full-page mode.");

114 
$h–p
 = 
	`t
("Configure howhis contentype's fields should be displayed when it's„endered inhe following contexts.");

116 
$h–p
 .ğ' '. 
	`t
("U£h'Exşude' checkboxØexşudª i‹m fromh!cÚ‹Á v®u·s£dØthnod‹m¶©e.", 
	`¬¿y
('!content' => '$content'));

117 
$v¬s
['h–p'] = 
$h–p
;

119 
$Üd”
 = 
	`_cÚ‹Á_ov”v›w_Üd”
(
$fÜm
, $form['#fields'], $form['#groups']);

120 ià(
	`em±y
(
$Üd”
)) {

121 
$v¬s
['rows'] = 
	`¬¿y
();

122 
$v¬s
['submit'] = '';

126 
$rows
 = 
	`¬¿y
();

127 
	`fÜ—ch
 (
$Üd”
 
as
 
$key
) {

128 
$–em’t
 = &
$fÜm
[
$key
];

129 
$row
 = 
Ãw
 
	`¡dCÏss
();

130 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$–em’t
è
as
 
$chd
) {

131 ià(!
	`¬¿y_key_exi¡s
('exşude', 
$–em’t
[
$chd
])) {

132 
$row
->{
$chd
} = 
	`dru·l_»nd”
(
$–em’t
[$child]);

135 
$row
->{
$chd
}->
fÜm©
 = 
	`dru·l_»nd”
(
$–em’t
[$child]['format']);

136 
$row
->{
$chd
}->
exşude
 = 
	`dru·l_»nd”
(
$–em’t
[$child]['exclude']);

139 
$row
->
Ïb–_şass
 = 
	`š_¬¿y
(
$key
, 
$fÜm
['#groups']) ? 'label-group' : 'label-field';

140 
$row
->
šd’tiÚ
 = 
	`theme
('šd’tiÚ', 
	`is£t
(
$–em’t
['#depth']) ? $element['#depth'] : 0);

141 
$rows
[] = 
$row
;

143 
$v¬s
['rows'] = 
$rows
;

144 
$v¬s
['subm™'] = 
	`dru·l_»nd”
(
$fÜm
);

145 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/devel/devel.module

1 <?
php


9 
defše
('DEVEL_QUERY_SORT_BY_SOURCE', 0);

10 
defše
('DEVEL_QUERY_SORT_BY_DURATION', 1);

12 
defše
('DEVEL_ERROR_HANDLER_NONE', 0);

13 
defše
('DEVEL_ERROR_HANDLER_STANDARD', 1);

14 
defše
('DEVEL_ERROR_HANDLER_BACKTRACE', 2);

16 
defše
('DEVEL_MIN_TEXTAREA', 50);

21 
funùiÚ
 
	$dev–_h–p
(
$£ùiÚ
) {

22 
$£ùiÚ
) {

24  '<p>'. 
	`t
('This is‡†ist of defined user functionshat generatedhis current„equest†ifecycle. Click on‡ function‚ameo view its documention.') .'</p>';

26  '<p>'. 
	`t
('Here‡rehe contents of your <code>$_SESSION</code> variable.') .'</p>';

28 
$­i
 = 
	`v¬ŸbË_g‘
('devel_api_url', 'api.drupal.org');

29  '<p>'. 
	`t
('Thi i ¨li¡ oàthv¬ŸbË ªdheœ v®ue cu¼’y stÜed iÀv¬ŸbË bË‡ndh<code>$cÚf</code>‡¼ay oàyou¸£‰šgs.ph°fe. The£ v¬ŸbË ¬usu®ly‡cûs£d w™h <¨h»f="@v¬ŸbË-g‘-doc">v¬ŸbË_g‘()</a>‡nd <¨h»f="@v¬ŸbË-£t-doc">v¬ŸbË_£t()</a>. V¬ŸbË th©‡»oØlÚg cª slow dowÀyou¸·ges.', 
	`¬¿y
('@variable-get-doc' => "http://$api/api/HEAD/function/variable_get", '@variable-set-doc' => "http://$api/api/HEAD/function/variable_set")) .'</p>';

31 
	}
}

36 
funùiÚ
 
	$dev–_m’u
() {

37 
$™ems
 = 
	`¬¿y
();

39 
$™ems
['dev–/ÿche/ş—r'] = 
	`¬¿y
(

43 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

47 
$™ems
['dev–/qu”›s'] = 
	`¬¿y
(

51 'acûs ¬gum’ts' => 
	`¬¿y
(),

54 
$™ems
['dev–/qu”›s/em±y'] = 
	`¬¿y
(

58 'acûs ¬gum’ts' => 
	`¬¿y
(),

61 
$™ems
['dev–/»ã»nû'] = 
	`¬¿y
(

65 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

68 
$™ems
['dev–/»š¡®l'] = 
	`¬¿y
(

71 '·g¬gum’ts' => 
	`¬¿y
('devel_reinstall'),

73 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

76 
$™ems
['dev–/sourû'] = 
	`¬¿y
(

79 'acûs ¬gum’ts' => 
	`¬¿y
('display source code'),

80 'ty³' => 
MENU_CALLBACK
,

83 
$™ems
['dev–/m’u/»£t'] = 
	`¬¿y
(

87 '·g¬gum’ts' => 
	`¬¿y
('devel_menu_rebuild'),

88 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

91 
$™ems
['dev–/v¬ŸbË'] = 
	`¬¿y
(

95 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

99 
$™ems
['dev–/phpšfo'] = 
	`¬¿y
(

103 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

106 
$™ems
['dev–/php'] = 
	`¬¿y
(

110 '·g¬gum’ts' => 
	`¬¿y
('devel_execute_form'),

111 'acûs ¬gum’ts' => 
	`¬¿y
('execute…hp code'),

114 
$™ems
['dev–/–em’ts'] = 
	`¬¿y
(

118 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

121 
$™ems
['dev–/v¬ŸbË/ed™/%'] = 
	`¬¿y
(

124 '·g¬gum’ts' => 
	`¬¿y
('devel_variable_edit', 3),

125 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

126 'ty³' => 
MENU_CALLBACK
,

129 
$™ems
['dev–/£ssiÚ'] = 
	`¬¿y
(

133 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

136 
$™ems
['dev–/sw™ch'] = 
	`¬¿y
(

139 'acûs ¬gum’ts' => 
	`¬¿y
('switch users'),

140 'ty³' => 
MENU_CALLBACK
,

143 
$™ems
['admš/£‰šgs/dev–'] = 
	`¬¿y
(

147 '·g¬gum’ts' => 
	`¬¿y
('devel_admin_settings'),

148 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

151 
$™ems
['node/%node/dev–'] = 
	`¬¿y
(

154 '·g¬gum’ts' => 
	`¬¿y
(1, 'node'),

156 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

157 'ty³' => 
MENU_LOCAL_TASK
,

160 
$™ems
['node/%node/dev–/lßd'] = 
	`¬¿y
(

163 '·g¬gum’ts' => 
	`¬¿y
(1, 'node'),

165 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

166 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

169 
$™ems
['node/%node/dev–/»nd”'] = 
	`¬¿y
(

172 '·g¬gum’ts' => 
	`¬¿y
('node', 1),

174 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

175 'ty³' => 
MENU_LOCAL_TASK
,

178 
$™ems
['u£r/%u£r/dev–'] = 
	`¬¿y
(

181 '·g¬gum’ts' => 
	`¬¿y
(1, 'user'),

183 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

184 'ty³' => 
MENU_LOCAL_TASK
,

187 
$™ems
['u£r/%u£r/dev–/lßd'] = 
	`¬¿y
(

190 '·g¬gum’ts' => 
	`¬¿y
(1, 'user'),

192 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

193 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

196 
$™ems
['u£r/%u£r/dev–/»nd”'] = 
	`¬¿y
(

199 '·g¬gum’ts' => 
	`¬¿y
('user', 1),

201 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

202 'ty³' => 
MENU_LOCAL_TASK
,

205 
$™ems
['dev–/theme/»gi¡ry'] = 
	`¬¿y
(

209 'acûs ¬gum’ts' => 
	`¬¿y
('access devel information'),

213  
$™ems
;

214 
	}
}

216 
funùiÚ
 
	$dev–_m’u_Ãed_de¡š©iÚ
() {

217  
	`¬¿y
('devel/cache/clear', 'devel/reinstall', 'devel/menu/reset', 'admin/og/og', 'devel/variable', 'admin/reports/status/run-cron');

218 
	}
}

225 
funùiÚ
 
	$dev–_m’u_lšk_®‹r
(&
$™em
, 
$m’u
) {

226 ià(
	`š_¬¿y
(
$™em
['lšk_·th'], 
	`dev–_m’u_Ãed_de¡š©iÚ
())) {

227 
$™em
['İtiÚs']['®‹r'] = 
TRUE
;

229 
	}
}

236 
funùiÚ
 
	$dev–_Œª¦©ed_m’u_lšk_®‹r
(&
$™em
) {

237 ià(
	`š_¬¿y
(
$™em
['h»f'], 
	`dev–_m’u_Ãed_de¡š©iÚ
())) {

238 
$™em
['loÿlized_İtiÚs']['qu”y'] = 
	`dru·l_g‘_de¡š©iÚ
();

240 
	}
}

242 
funùiÚ
 
	$dev–_m’u_acûss_¡Üe_qu”›s
() {

243  
	`u£r_acûss
('acûs dev– infÜm©iÚ'è&& 
	`v¬ŸbË_g‘
('devel_store_queries', 0);

244 
	}
}

249 
funùiÚ
 
	$dev–_theme
() {

250  
	`¬¿y
(

251 'dev–_v¬ŸbË_fÜm' => 
	`¬¿y
(

252 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
)

254 'dev–_qu”ylog' => 
	`¬¿y
(

255 '¬gum’ts' => 
	`¬¿y
('header' =>‡rray(), 'rows' =>‡rray()),

257 'dev–_qu”ylog_row' => 
	`¬¿y
(

258 '¬gum’ts' => 
	`¬¿y
('row' =>‡rray()),

261 
	}
}

272 
funùiÚ
 
	$dev–_di¥Ïy_sourû
(
$¡ªd®Úe
 = 
TRUE
) {

273 
$·th
 = 
$_GET
['file'];

275 
$·th
 = 
	`¡r_»¶aû
('../', '', $path);

276 
$ouut
 = 
	`dev–_highlight_fe
(
$·th
, 
$¡ªd®Úe
);

277 ià(
$ouut
) {

278 ià(
$¡ªd®Úe
) {

279 
´št
 
$ouut
;

280 
	`ex™
();

282  
$ouut
;

285 
	`dru·l_£t_mes§ge
(
	`t
('Invalid file…ath'), 'error');

286 
	`dru·l_nÙ_found
();

288 
	}
}

301 
funùiÚ
 
	$dev–_highlight_fe
(
$·th
 = 
NULL
, 
$¡ªd®Úe
 = 
FALSE
) {

302 ià(
	`fe_exi¡s
(
$·th
)) {

303 
$sourû
 = 
	`highlight_fe
(
$·th
, 
TRUE
);

308 ià(
$¡ªd®Úe
) {

309 
$sourû
 = <<<
EOT


310 <
h—d
><
t™Ë
>
$·th
</title></head>

311 <
body
>
$sourû
</body>

312 
EOT
;

314  
$sourû
;

317  
FALSE
;

319 
	}
}

324 
funùiÚ
 
	$dev–_š™
() {

325 ià(!
	`dev–_s’t
()) {

326 ià(
	`u£r_acûss
('access devel information')) {

327 
	`dev–_£t_hªdËr
(
	`v¬ŸbË_g‘
('dev–_”rÜ_hªdËr', 
DEVEL_ERROR_HANDLER_STANDARD
));

329 
	`has_krumo
();

333 ià(
	`moduË_exi¡s
('libraries')) {

334 
$·th
 = 
	`lib¿r›s_g‘_·th
('FirePHPCore') . '/lib/FirePHPCore/';

337 
$·th
 = './'. 
	`dru·l_g‘_·th
('module', 'devel') .'/FirePHPCore/lib/FirePHPCore/';

339 ià(
	`fe_exi¡s
(
$·th
 .'fb.php')) {

340 
šşude_Úû
 
$·th
 .'fb.php';

341 
šşude_Úû
 
$·th
 .'FirePHP.class.php';

344 ià(
	`v¬ŸbË_g‘
('devel_query_display', 0)) {

345 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'devel') .'/devel.css');

349 ià(
	`v¬ŸbË_g‘
('dev–_»bud_theme_»gi¡ry', 
FALSE
)) {

350 
	`dru·l_»bud_theme_»gi¡ry
();

351 ià(
	`æood_is_®lowed
('devel_rebuild_registry_warning', 1)) {

352 
	`æood_»gi¡”_ev’t
('devel_rebuild_registry_warning');

353 ià(!
	`dev–_s’t
(è&& 
	`u£r_acûss
('access devel information')) {

354 
	`dru·l_£t_mes§ge
(
	`t
('Ththem»gi¡ry i bešg„ebuˆÚƒv”y„eque¡. Rememb”Ø<¨h»f="!u¾">tuº off</a>hi ã©u» oÀ´oduùiÚ webs™es.', 
	`¬¿y
("!u¾" => 
	`u¾
('admin/settings/devel'))));

358 
	}
}

361 
funùiÚ
 
	$has_krumo
() {

363 @
šşude_Úû
 './'. 
	`dru·l_g‘_·th
('module', 'devel') .'/krumo/class.krumo.php';

364 ià(
	`funùiÚ_exi¡s
('krumo'è&& 
	`php_§pi_Çme
() != 'cli') {

365  
TRUE
;

368  
FALSE
;

370 
	}
}

378 
funùiÚ
 
	$m”™s_krumo
(
$šput
) {

379  (
	`is_objeù
(
$šput
è|| 
	`is_¬¿y
($šput)è&& 
	`has_krumo
(è&& 
	`v¬ŸbË_g‘
('devel_krumo_skin', '') != 'disabled';

380 
	}
}

387 
funùiÚ
 
	$dfb
() {

388 ià(
	`funùiÚ_exi¡s
('fb'è&& 
	`u£r_acûss
('access devel information')) {

389 
$¬gs
 = 
	`func_g‘_¬gs
();

390 
	`ÿÎ_u£r_func_¬¿y
('fb', 
$¬gs
);

392 
	}
}

397 
funùiÚ
 
	$dfbt
(
$Ïb–
) {

398 
	`dfb
(
$Ïb–
, 
FœePHP
::
TRACE
);

399 
	}
}

404 
funùiÚ
 
	$dev–_w©chdog
(
¬¿y
 
$log_’Œy
) {

405 ià(
	`şass_exi¡s
('FirePHP')) {

406 
$log_’Œy
['severity']) {

407 
WATCHDOG_EMERG
:

408 
WATCHDOG_ALERT
:

409 
WATCHDOG_CRITICAL
:

410 
WATCHDOG_ERROR
:

411 
$ty³
 = 
FœePHP
::
ERROR
;

413 
WATCHDOG_WARNING
:

414 
$ty³
 = 
FœePHP
::
WARN
;

416 
WATCHDOG_NOTICE
:

417 
WATCHDOG_INFO
:

418 
$ty³
 = 
FœePHP
::
INFO
;

420 
WATCHDOG_DEBUG
:

421 
DEFAULT
:

422 
$ty³
 = 
FœePHP
::
LOG
;

426 
$ty³
 = 'watchdog';

428 
$w©chdog
 = 
	`¬¿y
(

429 'ty³' => 
$log_’Œy
['type'],

430 'mes§ge' => 
	`decode_’t™›s
(
	`¡¹r
(
$log_’Œy
['mes§ge'], (
¬¿y
)$log_entry['variables'])),

432 ià(
	`is£t
(
$log_’Œy
['link'])) {

433 
$w©chdog
['lšk'] = 
$log_’Œy
['link'];

435 
	`dfb
(
$w©chdog
, 
$ty³
);

436 
	}
}

438 
funùiÚ
 
	$dev–_£t_hªdËr
(
$hªdËr
) {

439 
$hªdËr
) {

440 
DEVEL_ERROR_HANDLER_STANDARD
:

443 
DEVEL_ERROR_HANDLER_BACKTRACE
:

444 ià(
	`has_krumo
()) {

445 
	`£t_”rÜ_hªdËr
('backtrace_error_handler');

448 
DEVEL_ERROR_HANDLER_NONE
:

449 
	`»¡Üe_”rÜ_hªdËr
();

452 
	}
}

455 
funùiÚ
 
	$dev–_s’t
() {

459 
	`dev–_v”ify_şi
() ||

460 
	`is£t
(
$GLOBALS
['devel_shutdown']) ||

461 
	`¡r¡r
(
$_SERVER
['PHP_SELF'], 'update.php') ||

462 (
	`is£t
(
$_GET
['q']) && (

463 
	`š_¬¿y
(
$_GET
['q'], 
	`¬¿y
('upload/js', 'admin/content/node-settings/rebuild')) ||

464 
	`sub¡r
(
$_GET
['q'], 0, 
	`¡¾’
('system/files')) == 'system/files' ||

465 
	`sub¡r
(
$_GET
['q'], 0, 
	`¡¾’
('batch')) == 'batch')

467 
	}
}

472 
funùiÚ
 
	$dev–_boÙ
() {

473 ià(!
	`dev–_s’t
()) {

474 
	`dev–_¡¬t
();

476 
	}
}

479 
funùiÚ
 
	$dev–_¡¬t
() {

480 ià(
	`v¬ŸbË_g‘
('dev_mem', 0è&& 
	`funùiÚ_exi¡s
('memory_get_usage')) {

481 
glob®
 
$memÜy_š™
;

482 
$memÜy_š™
 = 
	`memÜy_g‘_u§ge
();

486 
	`dru·l_lßd
('module', 'user');

487 
	`»gi¡”_shutdown_funùiÚ
('devel_shutdown');

488 
	}
}

490 
funùiÚ
 
	$backŒaû_”rÜ_hªdËr
(
$”ºo
, 
$mes§ge
, 
$f’ame
, 
$lše
) {

492 ià(
	`”rÜ_»pÜtšg
() == 0) ;

494 ià(
$”ºo
 & (
E_ALL
 ^ 
E_NOTICE
)) {

497 
$ty³s
 = 
	`¬¿y
(

514 
$’Œy
 = 
$ty³s
[
$”ºo
] .': '. 
$mes§ge
 .' iÀ'. 
$f’ame
 .' oÀlš'. 
$lše
 .'.';

516 ià(
	`v¬ŸbË_g‘
('error_level', 1) == 1) {

517 
$backŒaû
 = 
	`debug_backŒaû
();

518 
	`fÜ—ch
 (
$backŒaû
 
as
 
$ÿÎ
) {

519 
$niûŒaû
[
$ÿÎ
['function']] = $call;

521 
	`krumo
(
$niûŒaû
);

524 
	`w©chdog
('php', '%mes§gš %fÚ†š%lše.', 
	`¬¿y
('%”rÜ' => 
$ty³s
[
$”ºo
], '%mes§ge' => 
$mes§ge
, '%fe' => 
$f’ame
, '%lše' => 
$lše
), 
WATCHDOG_ERROR
);

526 
	}
}

531 
funùiÚ
 
	$dev–_³rm
() {

532  
	`¬¿y
('access devel information', 'execute…hp code', 'switch users', 'display source code');

533 
	}
}

538 
funùiÚ
 
dev–_block
(
$İ
 = 'li¡', 
$d–
 = 0, 
$ed™
 = 
	$¬¿y
()) {

539 ià(
$İ
 == 'list') {

540 
$blocks
[0]['šfo'] = 
	`t
('Switch user');

542 
$blocks
[2] = 
	`¬¿y
(

543 'šfo' => 
	`t
('Execute PHP'),

547  
$blocks
;

549 
	`–£if
 (
$İ
 =ğ'cÚfigu»' && 
$d–
 == 0) {

550 
$fÜm
['dev–_sw™ch_u£r_li¡_size'] = 
	`¬¿y
(

552 '#t™Ë' => 
	`t
('Number of userso display inhe†ist'),

553 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('devel_switch_user_list_size', 10),

557  
$fÜm
;

559 
	`–£if
 (
$İ
 =ğ'§ve' && 
$d–
 == 0) {

560 
	`v¬ŸbË_£t
('dev–_sw™ch_u£r_li¡_size', 
$ed™
['devel_switch_user_list_size']);

562 
	`–£if
 (
$İ
 == 'view') {

563 
$block
 = 
	`¬¿y
();

564 
$d–
) {

566 
$block
 = 
	`dev–_block_sw™ch_u£r
();

572 ià(
	`u£r_acûss
('execute…hp code')) {

573 
$block
['cÚ‹Á'] = 
	`dru·l_g‘_fÜm
('devel_execute_block_form');

577  
$block
;

579 
	}
}

581 
funùiÚ
 
	$dev–_block_sw™ch_u£r
() {

582 
$lšks
 = 
	`dev–_sw™ch_u£r_li¡
();

583 ià(!
	`em±y
(
$lšks
è|| 
	`u£r_acûss
('switch users')) {

584 
$block
['subjeù'] = 
	`t
('Switch user');

585 
$block
['cÚ‹Á'] = 
	`theme
('lšks', 
$lšks
);

586 
$block
['cÚ‹Á'] .ğ
	`dru·l_g‘_fÜm
('devel_switch_user_form');

587  
$block
;

589 
	}
}

591 
funùiÚ
 
	$dev–_sw™ch_u£r_li¡
() {

592 
$lšks
 = 
	`¬¿y
();

593 ià(
	`u£r_acûss
('switch users')) {

594 
$li¡_size
 = 
	`v¬ŸbË_g‘
('devel_switch_user_list_size', 10);

595 
$de¡
 = 
	`dru·l_g‘_de¡š©iÚ
();

597 
$rŞes
 = 
	`u£r_rŞes
(
TRUE
, 'switch users');

598 ià(
	`is£t
(
$rŞes
[
DRUPAL_AUTHENTICATED_RID
])) {

602 
$u£rs
 = 
	`db_qu”y_¿nge
("SELECT DISTINCT u.uid, u.Çme, u.acûs FROM {u£rs} u WHERE u.uid > 0 ORDER BY u.acûs DESC", 0, 
$li¡_size
);

605 
$wh”e
 = 
	`¬¿y
('u.uid = 1');

606 ià(
	`couÁ
(
$rŞes
)) {

607 
$wh”e
[] = 'r.rid IN ('. 
	`im¶ode
(',', 
	`¬¿y_keys
(
$rŞes
)) .')';

609 
$wh”e_sql
 = 
	`im¶ode
(' OR ', 
$wh”e
);

610 
$u£rs
 = 
	`db_qu”y_¿nge
("SELECT DISTINCT u.uid, u.Çme, u.acûs FROM {u£rs} u LEFT JOIN {u£rs_rŞes}„ ON u.uid =„.uid WHERE $wh”e_sqÈORDER BY u.acûs DESC", 0, 
$li¡_size
);

612 
$u£r
 = 
	`db_ãtch_objeù
(
$u£rs
)) {

613 
$lšks
[
$u£r
->
uid
] = 
	`¬¿y
(

614 't™Ë' => 
	`theme
('¶aûhŞd”', 
$u£r
->
Çme
),

615 'h»f' => 'dev–/sw™ch/'. 
$u£r
->
Çme
,

616 'qu”y' => 
$de¡
,

617 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
	`t
('This user can switch back.')),

618 'html' => 
TRUE
,

619 'Ï¡_acûss' => 
$u£r
->
acûss
,

622 
$num_lšks
 = 
	`couÁ
(
$lšks
);

623 ià(
$num_lšks
 < 
$li¡_size
) {

625 
$u£rs
 = 
	`db_qu”y_¿nge
('SELECT uid,‚ame,‡cûs FROM {u£rs} WHERE uid > 0 AND uid NOT IN ('. 
	`im¶ode
(',', 
	`¬¿y_keys
(
$lšks
)è.'èORDER BY‡cûs DESC', 0, 
$li¡_size
 - 
$num_lšks
);

626 
$u£r
 = 
	`db_ãtch_objeù
(
$u£rs
)) {

627 
$lšks
[
$u£r
->
uid
] = 
	`¬¿y
(

628 't™Ë' => 
$u£r
->
Çme
 ? $user->name : 'anon',

629 'h»f' => 'dev–/sw™ch/'. 
$u£r
->
Çme
,

630 'qu”y' => 
$de¡
,

631 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
	`t
('Caution:his user will be unableo switch back.')),

632 'Ï¡_acûss' => 
$u£r
->
acûss
,

635 
	`uasÜt
(
$lšks
, '_devel_switch_user_list_cmp');

638  
$lšks
;

639 
	}
}

646 
funùiÚ
 
	$_dev–_sw™ch_u£r_li¡_cmp
(
$a
, 
$b
) {

647  
$b
['Ï¡_acûss'] - 
$a
['last_access'];

648 
	}
}

650 
funùiÚ
 
	$dev–_phpšfo
() {

651 
´št
 
	`phpšfo
();

652 
ex™
;

653 
	}
}

655 
funùiÚ
 
	$dev–_sw™ch_u£r_fÜm
() {

656 
$fÜm
['u£ºame'] = 
	`¬¿y
(

658 '#desütiÚ' => 
	`t
('Enter username'),

660 '#maxËngth' => 
USERNAME_MAX_LENGTH
,

663 
$fÜm
['subm™'] = 
	`¬¿y
(

665 '#v®ue' => 
	`t
('Switch'),

667  
$fÜm
;

669 
	}
}

671 
funùiÚ
 
	$dev–_doc_funùiÚ_fÜm
() {

672 
$v”siÚ
 = 
	`dev–_g‘_cÜe_v”siÚ
(
VERSION
);

673 
$fÜm
['funùiÚ'] = 
	`¬¿y
(

675 '#desütiÚ' => 
	`t
('Enter function‚ame for‡pi†ookup'),

679 
$fÜm
['v”siÚ'] = 
	`¬¿y
('#ty³' => 'v®ue', '#v®ue' => 
$v”siÚ
);

680 
$fÜm
['subm™_bu‰Ú'] = 
	`¬¿y
(

682 '#v®ue' => 
	`t
('Submit'),

684  
$fÜm
;

685 
	}
}

687 
funùiÚ
 
	$dev–_doc_funùiÚ_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

688 
$v”siÚ
 = 
$fÜm_¡©e
['values']['version'];

689 
$funùiÚ
 = 
$fÜm_¡©e
['values']['function'];

690 
$­i
 = 
	`v¬ŸbË_g‘
('devel_api_url', 'api.drupal.org');

691 
$fÜm_¡©e
['redirect'] = "http://$api/api/function/$function/$version";

692 
	}
}

694 
funùiÚ
 
	$dev–_sw™ch_u£r_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

695 ià(!
$accouÁ
 = 
	`u£r_lßd
(
	`¬¿y
('Çme' => 
$fÜm_¡©e
['values']['username']))) {

696 
	`fÜm_£t_”rÜ
('u£ºame', 
	`t
('Username‚ot found'));

698 
	}
}

700 
funùiÚ
 
	$dev–_sw™ch_u£r_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

701 
$fÜm_¡©e
['redirect'] = 'devel/switch/'. $form_state['values']['username'];

702 
	}
}

704 
funùiÚ
 
	$dev–_ex™
(
$de¡š©iÚ
 = 
NULL
) {

705 
glob®
 
$u£r
;

707 ià(
	`is£t
(
$de¡š©iÚ
è&& !
	`dev–_s’t
()) {

711 ià(
	`is£t
(
$u£r
è&& 
	`funùiÚ_exi¡s
('u£r_acûss'è&& 
	`u£r_acûss
('acûs dev– infÜm©iÚ'è&& 
	`v¬ŸbË_g‘
('devel_redirect_page', 0)) {

712 
$ouut
 = 
	`t_§ã
('<p>Thu£¸i bešg„edœeùedØ<¨h»f="@de¡š©iÚ">@de¡š©iÚ</a>.</p>', 
	`¬¿y
('@de¡š©iÚ' => 
$de¡š©iÚ
));

713 
´št
 
	`theme
('·ge', 
$ouut
);

716 
	`dru·l_·ge_foÙ”
();

717 
	`ex™
();

720 
$GLOBALS
['dev–_»dœeùšg'] = 
TRUE
;

723 
	}
}

726 
funùiÚ
 
	$dev–_v”ify_şi
() {

727 ià(
	`php_§pi_Çme
() == 'cgi') {

728  (
	`is_num”ic
(
$_SERVER
['argc']) && $_SERVER['argc'] > 0);

731  (
	`php_§pi_Çme
() == 'cli');

732 
	}
}

738 
funùiÚ
 
	$dev–_shutdown
() {

740 
	`»gi¡”_shutdown_funùiÚ
('devel_shutdown_real');

741 
	}
}

746 
funùiÚ
 
	$dev–_shutdown_»®
() {

747 
glob®
 
$qu”›s
, 
$memÜy_š™
, 
$u£r
;

748 
$ouut
 = 
$txt
 = '';

754 ià(!
	`is£t
(
$GLOBALS
['devel_shutdown']) && !isset($GLOBALS['devel_redirecting'])) {

756 ià(
	`funùiÚ_exi¡s
('drupal_get_headers')) {

757 
$h—d”s
 = 
	`dru·l_g‘_h—d”s
();

758 
$fÜm©s
 = 
	`¬¿y
('xml', 'javascript', 'json', 'plain', 'image', 'application', 'csv', 'x-comma-separated-values');

759 
	`fÜ—ch
 (
$fÜm©s
 
as
 
$fÜm©
) {

760 ià(
	`¡r¡r
(
$h—d”s
, 
$fÜm©
)) {

766 ià(
	`is£t
(
$u£r
è&& 
	`u£r_acûss
('access devel information')) {

767 
	`li¡
(
$couÁs
, 
$qu”y_summ¬y
èğ
	`dev–_qu”y_summ¬y
();

769 ià(!
	`v¬ŸbË_g‘
('devel_query_display', 0) && variable_get('dev_timer', 0)) {

770 
$ouut
 .ğ'<div cÏss="dev-tim”">'. 
	`dev–_tim”
(è.' '. 
$qu”y_summ¬y
 .'</div>';

774 
$sum
 = 0;

775 ià(
	`v¬ŸbË_g‘
('dev–_qu”y_di¥Ïy', 
FALSE
)) {

776 
$ouut
 .= '<div class="dev-query">';

777 
$ouut
 .ğ
$qu”y_summ¬y
;

780 ià(
	`funùiÚ_exi¡s
('theme_g‘_»gi¡ry'è&& 
	`theme_g‘_»gi¡ry
()) {

781 
$txt
 = 
	`t_§ã
(' Qu”› kšg†Úg”hª @th»shŞd m ªd qu”› execu‹d mÜthª onû,‡» <¥ª cÏss="m¬k”">highligh‹d</¥ª>.', 
	`¬¿y
('@th»shŞd' => 
	`v¬ŸbË_g‘
('devel_execution', 5)));

782 ià(
	`v¬ŸbË_g‘
('dev_timer', 0)) {

783 
$txt
 .ğ
	`dev–_tim”
();

785 
$ouut
 .ğ
$txt
;

786 
$ouut
 .= '</div>';

787 
$ouut
 .ğ
	`dev–_qu”y_bË
(
$qu”›s
, 
$couÁs
);

790 
$ouut
 .ğ
$txt
;

791 
$ouut
 .= '</div>';

792 
	`ob_¡¬t
();

793 
	`d´št_r
(
$qu”›s
);

794 
$ouut
 .ğ
	`ob_g‘_ş—n
();

798 ià(
	`v¬ŸbË_g‘
('dev_mem', 
FALSE
è&& 
	`funùiÚ_exi¡s
('memory_get_usage')) {

799 
$memÜy_shutdown
 = 
	`memÜy_g‘_u§ge
();

800 
$¬gs
 = 
	`¬¿y
('@memÜy_š™' => 
	`round
(
$memÜy_š™
 / 1024 / 1024, 2), '@memÜy_shutdown' =>„ound(
$memÜy_shutdown
 / 1024 / 1024, 2));

801 
$msg
 = '<div class="dev-memory-usage"><h3>Memory usage:</h3> Memory used‡t: devel_init()=<strong>@memory_init</strong> MB, devel_shutdown()=<strong>@memory_shutdown</strong> MB.</div>';

803 
$ouut
 .ğ
	`t_§ã
(
$msg
, 
$¬gs
);

808 ià(
$ouut
) {

809 
´št
 
$ouut
;

812 
	`dev–_¡Üe_qu”›s
();

813 
	}
}

815 
funùiÚ
 
	$dev–_¡Üe_qu”›s
() {

816 ià(
	`v¬ŸbË_g‘
('dev–_¡Üe_qu”›s', 0è&& 
	`¿nd
(1, variable_get('devel_store_random', 1)) == 1) {

817 
glob®
 
$aùive_db
, 
$qu”›s
, 
$db_ty³
;

819 
$qids
 = 
	`¬¿y
();

820 
$v®ues
 = 
	`¬¿y
();

821 
$f›lds
 = 
	`¬¿y
();

823 
	`£oÿË
(
LC_NUMERIC
, 'C');

824 
	`fÜ—ch
 (
$qu”›s
 
as
 
$v®ue
) {

825 
	`li¡
(
$funùiÚ
, 
$qu”y
èğ
	`ex¶ode
("\n", 
$v®ue
[0]);

826 
$qu”y
 = 
	`´eg_»¶aû
(
	`¬¿y
("/'.*'/s", "/\d.*\.\d.*/", "/\d.*/"),‡rray("S", "F", "D"), $query);

827 
$hash
 = 
	`md5
(
$funùiÚ
 . 
$qu”y
);

828 ià(!
	`is£t
(
$qids
[
$hash
])) {

829 
$qids
[
$hash
] = 
	`db_»suÉ
(
	`dev–_db_qu”y
("SELECT qid FROM {devel_queries} WHERE hash = '%s'", $hash));

830 ià(!
$qids
[
$hash
]) {

831 
	`dev–_db_qu”y
("INSERT INTO {dev–_qu”›s} (qu”y, funùiÚ, hashèVALUES ('%s', '%s', '%s')", 
$qu”y
, 
$funùiÚ
, 
$hash
);

832 
$qids
[
$hash
] = 
	`db_Ï¡_š£¹_id
('devel_queries', 'qid');

835 
$f›lds
[] = "(%d, '%f')";

836 
$v®ues
[] = 
$qids
[
$hash
];

837 
$v®ues
[] = 
$v®ue
[1];

839 ià(
	`couÁ
(
$f›lds
)) {

840 
	`dev–_db_qu”y
('INSERT INTO {dev–_times} (qid,imeèVALUES '. 
	`im¶ode
(',', 
$f›lds
), 
$v®ues
);

843 
	}
}

845 
funùiÚ
 
	$dev–_qu”y_summ¬y
() {

846 
glob®
 
$qu”›s
;

847 ià(
	`v¬ŸbË_g‘
('dev_qu”y', 
FALSE
è&& 
	`is_¬¿y
(
$qu”›s
)) {

848 
$sum
 = 0;

849 
	`fÜ—ch
 (
$qu”›s
 
as
 
$qu”y
) {

850 
$‹xt
[] = 
$qu”y
[0];

851 
$sum
 +ğ
$qu”y
[1];

853 
$couÁs
 = 
	`¬¿y_couÁ_v®ues
(
$‹xt
);

854  
	`¬¿y
(
$couÁs
, 
	`t_§ã
('Execu‹d @qu”› qu”› š @timmli£cÚds.',‡¼ay('@qu”›s' => 
	`couÁ
(
$qu”›s
), '@time' => 
	`round
(
$sum
 * 1000, 2))));

856 
	}
}

858 
funùiÚ
 
	$t_§ã
(
$¡ršg
, 
$¬gs
) {

860 ià(
	`funùiÚ_exi¡s
('t') && function_exists('theme_get_registry')) {

861 
	`theme_g‘_»gi¡ry
();

862  
	`t
(
$¡ršg
, 
$¬gs
);

865 
	`¡¹r
(
$¡ršg
, 
$¬gs
);

867 
	}
}

873 
funùiÚ
 
	$dev–_funùiÚ_»ã»nû
() {

874 
$funùiÚs
 = 
	`g‘_defšed_funùiÚs
();

875 
$v”siÚ
 = 
	`dev–_g‘_cÜe_v”siÚ
(
VERSION
);

876 
$ufunùiÚs
 = 
$funùiÚs
['user'];

877 
	`sÜt
(
$ufunùiÚs
);

878 
$­i
 = 
	`v¬ŸbË_g‘
('devel_api_url', 'api.drupal.org');

879 
	`fÜ—ch
 (
$ufunùiÚs
 
as
 
$funùiÚ
) {

880 
$lšks
[] = 
	`l
(
$funùiÚ
, "http://$api/api/function/$function/$version");

882  
	`theme
('™em_li¡', 
$lšks
);

883 
	}
}

885 
funùiÚ
 
	$dev–_g‘_cÜe_v”siÚ
(
$v”siÚ
) {

886 
$v”siÚ_·¹s
 = 
	`ex¶ode
('.', 
$v”siÚ
);

888 ià(
$v”siÚ_·¹s
[0] < 5) {

889  
$v”siÚ_·¹s
[0] .'.'. $version_parts[1];

893  
$v”siÚ_·¹s
[0];

895 
	}
}

897 
funùiÚ
 
	$dev–_db_qu”y
(
$qu”y
) {

898 
glob®
 
$aùive_db
;

899 
$¬gs
 = 
	`func_g‘_¬gs
();

900 
	`¬¿y_shiá
(
$¬gs
);

901 
$qu”y
 = 
	`db_´efix_bËs
($query);

902 ià(
	`is£t
(
$¬gs
[0]è
ªd
 
	`is_¬¿y
($args[0])) {

903 
$¬gs
 = $args[0];

905 
	`_db_qu”y_ÿÎback
(
$¬gs
, 
TRUE
);

906 
$qu”y
 = 
	`´eg_»¶aû_ÿÎback
(
DB_QUERY_REGEXP
, '_db_query_callback', $query);

907  
	`db_qu”y
(
$qu”y
, 
$aùive_db
);

908 
	}
}

911 
funùiÚ
 
	$dev–_is_com·tibË_İtimiz”
() {

912 
	`ob_¡¬t
();

913 
	`phpšfo
();

914 
$šfo
 = 
	`ob_g‘_cÚ‹Ás
();

915 
	`ob_’d_ş—n
();

918 
$found
 = 
	`´eg_m©ch
('/Z’d&nb¥;O±imiz”&nb¥;v([0-9])\.([0-9])\.([0-9])/', 
$šfo
, 
$m©ches
);

920 ià(
$m©ches
) {

921 
$majÜ
 = 
$m©ches
[1];

922 
$mšÜ
 = 
$m©ches
[2];

923 
$bud
 = 
$m©ches
[3];

925 ià(
$majÜ
 >= 3) {

926 ià(
$mšÜ
 >= 3) {

927  
TRUE
;

929 
	`–£if
 (
$mšÜ
 =ğ2 && 
$bud
 >= 8) {

930  
TRUE
;

933  
FALSE
;

937  
FALSE
;

941  
TRUE
;

943 
	}
}

945 
funùiÚ
 
	$dev–_admš_£‰šgs
() {

946 
$fÜm
['qu”›s'] = 
	`¬¿y
('#ty³' => 'f›ld£t', '#t™Ë' => 
	`t
('Query†og'));

948 
$desütiÚ
 = 
	`t
("Collect query info. If disabled,‚o query†og functionality will work.");

949 ià(!
	`dev–_is_com·tibË_İtimiz”
()) {

950 
$desütiÚ
 = 
	`t
('You mu¡ di§bË o¸upg¿dthph°Z’d O±imiz”ƒx‹nsiÚ iÀÜd”Ø’abËhi ã©u». Thmšimum„equœed v”siÚ i 3.2.8. E¬l›¸v”siÚ oàZ’d O±imiz”‡» <¨h»f="!u¾">hÜribly buggy‡nd segçuÉ you¸A·che</a> ... ', 
	`¬¿y
('!u¾' => 
	`u¾
('http://drupal.org/node/126098'))) . $description;

952 
$fÜm
['qu”›s']['dev_qu”y'] = 
	`¬¿y
('#type' => 'checkbox',

953 '#t™Ë' => 
	`t
('Collect query info'),

954 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('dev_query', 0),

955 '#di§bËd' => !
	`dev–_is_com·tibË_İtimiz”
(è? 
TRUE
 : 
FALSE
,

956 '#desütiÚ' => 
$desütiÚ
,

959 
$fÜm
['qu”›s']['dev–_qu”y_di¥Ïy'] = 
	`¬¿y
('#type' => 'checkbox',

960 '#t™Ë' => 
	`t
('Display query†og'),

961 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('devel_query_display', 0),

962 '#desütiÚ' => 
	`t
('Display‡†og ofhe database queries‚eededo generatehe current…age,‡ndheƒxecutionime forƒach. Also, queries which‡re„epeated during‡ single…age view‡re summed inhe # column,‡nd…rinted in„ed sincehey‡re candidates for caching.'));

963 
$fÜm
['qu”›s']['dev–_qu”y_sÜt'] = 
	`¬¿y
('#type' => 'radios',

964 '#t™Ë' => 
	`t
('Sort query†og'),

965 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('dev–_qu”y_sÜt', 
DEVEL_QUERY_SORT_BY_SOURCE
),

966 '#İtiÚs' => 
	`¬¿y
(
	`t
('by source'),('by duration')),

967 '#desütiÚ' => 
	`t
('The queryable can be sorted inhe orderhathe queries wereƒxecuted or by descending duration.'),

969 
$fÜm
['qu”›s']['dev–_executiÚ'] = 
	`¬¿y
('#type' => 'textfield',

970 '#t™Ë' => 
	`t
('Slow query highlighting'),

971 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('devel_execution', 5),

974 '#desütiÚ' => 
	`t
('Enter‡n integer in milliseconds. Any query whichakes†ongerhanhis many milliseconds will be highlighted inhe query†og. This indicates‡…ossibly inefficient query, or‡ candidate for caching.'),

976 
$fÜm
['qu”›s']['dev–_¡Üe_qu”›s'] = 
	`¬¿y
('#type' => 'checkbox',

977 '#t™Ë' => 
	`t
('Storeƒxecuted queries'),

978 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('devel_store_queries', 0),

979 '#desütiÚ' => 
	`t
('Store statistics‡boutƒxecuted queries. Seehe devel_xables.'));

980 
$fÜm
['qu”›s']['dev–_¡Üe_¿ndom'] = 
	`¬¿y
('#type' => 'textfield',

981 '#t™Ë' => 
	`t
('Sampling interval'),

982 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('devel_store_random', 1),

984 '#desütiÚ' => 
	`t
('If storing query statistics, only storeƒvery‚th…age view. 1 meansƒvery…age view, 2ƒvery second,‡nd so on.'));

986 
$fÜm
['dev–_­i_u¾'] = 
	`¬¿y
('#type' => 'textfield',

987 '#t™Ë' => 
	`t
('API Site'),

988 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('devel_api_url', 'api.drupal.org'),

989 '#desütiÚ' => 
	`t
('Thba£ URL fÜ you¸dev–İ” docum’tiÚ†šks. You mighˆchªgthi iàyou„uÀ<¨h»f="!u¾">­i.moduË</a>†oÿÎy.', 
	`¬¿y
('!u¾' => 
	`u¾
('http://drupal.org/project/api'))));

990 
$fÜm
['dev_tim”'] = 
	`¬¿y
('#type' => 'checkbox',

991 '#t™Ë' => 
	`t
('Display…ageimer'),

992 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('dev_timer', 0),

993 '#desütiÚ' => 
	`t
('Display…ageƒxecutionime inhe query†og box.'),

995 
$fÜm
['dev_mem'] = 
	`¬¿y
('#type' => 'checkbox',

996 '#t™Ë' => 
	`t
('Display memory usage'),

997 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('dev_mem', 0),

998 '#desütiÚ' => 
	`t
('Display how much memory is usedo generatehe current…age. This will show memory usage when devel_init() is called‡nd when devel_exit() is called. PHP must have been compiled withhe <em>--enable-memory-limit</em> configuration option forhis featureo work.'),

1000 
$fÜm
['dev–_»dœeù_·ge'] = 
	`¬¿y
('#type' => 'checkbox',

1001 '#t™Ë' => 
	`t
('Display„edirection…age'),

1002 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('devel_redirect_page', 0),

1003 '#desütiÚ' => 
	`t
('When‡ moduleƒxecutes drupal_goto(),he query†og‡nd other developer information is†ost. Enablinghis setting…resents‡n intermediate…ageo developers sohathe†og can beƒxamined before continuingohe destination…age.'),

1005 
$fÜm
['dev–_”rÜ_hªdËr'] = 
	`¬¿y
('#type' => 'radios',

1006 '#t™Ë' => 
	`t
('Error handler'),

1007 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('dev–_”rÜ_hªdËr', 
DEVEL_ERROR_HANDLER_STANDARD
),

1008 '#İtiÚs' => 
	`¬¿y
(
DEVEL_ERROR_HANDLER_NONE
 => 
	`t
('NÚe'), 
DEVEL_ERROR_HANDLER_STANDARD
 =>('Standard drupal')),

1009 '#desütiÚ' => 
	`t
('Choo£‡À”rÜ hªdË¸fÜ you¸s™e. <em>BackŒaû</em>…ršt niû debug infÜm©iÚ wh’‡À”rÜ i nÙiûd,‡nd you <¨h»f="@choo£">choo£Øshowƒ¼Ü Ú sü“n</a>. <¡rÚg>BackŒaû„equœe th<¨h»f="@krumo">krumØlib¿ry</a></¡rÚg>. <em>NÚe</em> i ¨good o±iÚ wh’ s‹µšghroughhs™š you¸debugg”.', 
	`¬¿y
('@krumo' => 
	`u¾
('http://krumo.sourceforge.net'), '@choose' => url('admin/settings/error-reporting'))),

1011 ià(
	`has_krumo
()) {

1012 
$fÜm
['dev–_”rÜ_hªdËr']['#İtiÚs'][
DEVEL_ERROR_HANDLER_BACKTRACE
] = 
	`t
('Backtrace');

1015 
$İtiÚs
 = 
	`dru·l_m­_assoc
(
	`¬¿y
('default', 'blue', 'green', 'orange', 'white', 'disabled'));

1016 
$fÜm
['dev–_krumo_skš'] = 
	`¬¿y
(

1018 '#t™Ë' => 
	`t
('Krumo display'),

1019 '#desütiÚ' => 
	`t
('Select‡ skin for your debug messages or select <em>disabled</em>o display object‡nd‡rray output in standard PHP format.'),

1020 '#İtiÚs' => 
$İtiÚs
,

1021 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('devel_krumo_skin', 'default'),

1025 ià(
	`v¬ŸbË_g‘
('sm_lib¿ry', ''è!ğ'' && v¬ŸbË_g‘('sm_lib¿ry', ''è!ğ
	`dru·l_g‘_f’ame
('module', 'devel')) {

1026 
	`v¬ŸbË_£t
('dev–_Şd_sm_lib¿ry', 
	`v¬ŸbË_g‘
('smtp_library', ''));

1028 
$sm_İtiÚs
 = 
	`¬¿y
(

1029 '' => 
	`t
('Default'),

1030 
	`dru·l_g‘_f’ame
('moduË', 'dev–'è=> 
	`t
('Log only'),

1032 ià(
	`v¬ŸbË_g‘
('devel_old_smtp_library', '') != '') {

1033 
$sm_İtiÚs
[
	`v¬ŸbË_g‘
('dev–_Şd_sm_lib¿ry', '')] = 
	`t
('Oth” (!lib¿ry)', 
	`¬¿y
('!library' => variable_get('devel_old_smtp_library', '')));

1035 
$fÜm
['sm_lib¿ry'] = 
	`¬¿y
(

1037 '#t™Ë' => 
	`t
('SMTP†ibrary'),

1038 '#İtiÚs' => 
$sm_İtiÚs
,

1039 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('smtp_library', ''),

1042 
$fÜm
['dev–_»bud_theme_»gi¡ry'] = 
	`¬¿y
(

1044 '#t™Ë' => 
	`t
('Rebuildheheme„egistry onƒvery…age†oad'),

1045 '#desütiÚ' => 
	`t
('While creating‚ewemplates‡ndheme_ overridesheheme„egistry‚eedso be„ebuilt.'),

1046 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('dev–_»bud_theme_»gi¡ry', 
FALSE
),

1049  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

1050 
	}
}

1055 
funùiÚ
 
	$dev–_ÿche_ş—r
() {

1057 
	`dru·l_æush_®l_ÿches
();

1059 
	`dru·l_£t_mes§ge
('Cache cleared.');

1061 
	`dru·l_gÙo
();

1062 
	}
}

1067 
funùiÚ
 
	$dev–_execu‹_block_fÜm
() {

1068 
$fÜm
['execu‹'] = 
	`¬¿y
(

1070 '#t™Ë' => 
	`t
('Execute PHP Code'),

1071 '#cŞÏpsibË' => 
TRUE
,

1072 '#cŞÏp£d' => (!
	`is£t
(
$_POST
['code'])),

1074 
$fÜm
['#subm™'] = 
	`¬¿y
('devel_execute_form_submit');

1075  
	`¬¿y_m”ge_»cursive
(
$fÜm
, 
	`dev–_execu‹_fÜm
());

1076 
	}
}

1081 
funùiÚ
 
	$dev–_execu‹_fÜm
() {

1082 
$fÜm
['execu‹']['code'] = 
	`¬¿y
(

1084 '#t™Ë' => 
	`t
('PHP codeoƒxecute'),

1085 '#desütiÚ' => 
	`t
('Enter some code. Do‚ot use <code>&lt;?php ?&gt;</code>ags.'),

1087 
$fÜm
['execu‹']['İ'] = 
	`¬¿y
('#ty³' => 'subm™', '#v®ue' => 
	`t
('Execute'));

1088 
$fÜm
['#»dœeù'] = 
FALSE
;

1089 
$fÜm
['#sk_du¶iÿ‹_check'] = 
TRUE
;

1090  
$fÜm
;

1091 
	}
}

1096 
funùiÚ
 
	$dev–_execu‹_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1097 
	`ob_¡¬t
();

1098 
´št
 
	`ev®
(
$fÜm_¡©e
['values']['code']);

1099 
	`dsm
(
	`ob_g‘_ş—n
());

1100 
	}
}

1105 
funùiÚ
 
	$dev–_m’u_»bud
() {

1106 
	`m’u_»bud
();

1107 
	`dru·l_£t_mes§ge
(
	`t
('The menu„outer has been„ebuilt.'));

1108 
	`dru·l_gÙo
();

1109 
	}
}

1114 
funùiÚ
 
	$dev–_»š¡®l
(
$fÜm_¡©e
) {

1115 
$ouut
 = '';

1116 
$moduËs
 = 
	`moduË_li¡
();

1117 
	`sÜt
(
$moduËs
);

1118 
$İtiÚs
 = 
	`dru·l_m­_assoc
(
$moduËs
);

1119 
$fÜm
['li¡'] = 
	`¬¿y
(

1121 '#İtiÚs' => 
$İtiÚs
,

1122 '#desütiÚ' => 
	`t
('Uninstall‡ndhen installhe selected modules. <code>hook_uninstall()</code>‡nd <code>hook_install()</code> will beƒxecuted‡ndhe schema version‚umber will be setohe most„ecent update‚umber. You may haveo manually clear out‡nyƒxistingables first ifhe module doesn\'t implement <code>hook_uninstall()</code>.'),

1124 
$fÜm
['subm™'] = 
	`¬¿y
(

1125 '#v®ue' => 
	`t
('Reinstall'),

1128 ià(
	`em±y
(
$fÜm_¡©e
['post'])) {

1129 
	`dru·l_£t_mes§ge
(
	`t
('Warning - will delete your moduleables‡nd variables.'), 'error');

1131  
$fÜm
;

1132 
	}
}

1137 
funùiÚ
 
	$dev–_»š¡®l_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1138 
»quœe_Úû
 './includes/install.inc';

1139 
$moduËs
 = 
	`¬¿y_f‹r
(
$fÜm_¡©e
['values']['list']);

1140 
	`fÜ—ch
 (
$moduËs
 
as
 
$moduË
) {

1141 
	`moduË_lßd_š¡®l
(
$moduË
);

1142 
$v”siÚs
 = 
	`dru·l_g‘_schema_v”siÚs
(
$moduË
);

1143 
	`dru·l_£t_š¡®Ëd_schema_v”siÚ
(
$moduË
, 
SCHEMA_UNINSTALLED
);

1144 
	`moduË_švoke
(
$moduË
, 'uninstall');

1145 
	`_dru·l_š¡®l_moduË
(
$moduË
);

1146 
	`moduË_švoke
(
$moduË
, 'enable');

1147 
	`dru·l_g‘_schema
(
NULL
, 
TRUE
);

1148 
	`dru·l_£t_mes§ge
(
	`t
('Unš¡®Ëd‡nd in¡®Ëdh%ÇmmoduË.', 
	`¬¿y
('%Çme' => 
$moduË
)));

1150 
	}
}

1153 
funùiÚ
 
	$dev–_theme_»gi¡ry
() {

1154 
	`š™_theme
();

1155 
$hooks
 = 
	`theme_g‘_»gi¡ry
();

1156  
	`k´št_r
(
$hooks
, 
TRUE
);

1157 
	}
}

1162 
funùiÚ
 
	$dev–_v¬ŸbË_·ge
() {

1164 
$ouut
 = 
	`dru·l_g‘_fÜm
('devel_variable_form');

1165 
´št
 
	`theme
('·ge', 
$ouut
, 
FALSE
);

1166 
	}
}

1168 
funùiÚ
 
	$dev–_v¬ŸbË_fÜm
() {

1169 
$h—d”
 = 
	`¬¿y
(

1170 
	`¬¿y
(''),

1171 
	`¬¿y
('d©a' => 
	`t
('Name'), 'field' => 'name', 'sort' => 'asc'),

1172 
	`¬¿y
('d©a' => 
	`t
('Value'), 'field' => 'value'),

1173 
	`¬¿y
('d©a' => 
	`t
('Length'), 'field' => 'length'),

1174 
	`¬¿y
('d©a' => 
	`t
('Operations')),

1177 
$GLOBALS
['db_type']) {

1179 
$sql
 = "SELECT *, COL_LENGTH('{variable}', 'value') AS†ength FROM {variable}";

1182 
$sql
 = "SELECT *, LENGTH(value) AS†ength FROM {variable}";

1185 
$»suÉ
 = 
	`db_qu”y
(
$sql
 . 
	`bËsÜt_sql
(
$h—d”
));

1186 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1187 
$v¬ŸbËs
[
$row
->
Çme
] = '';

1188 
$fÜm
['Çme'][
$row
->
Çme
] = 
	`¬¿y
('#v®ue' => 
	`check_¶aš
($row->name));

1189 ià(
	`m”™s_krumo
(
$row
->
v®ue
)) {

1190 
$v®ue
 = 
	`krumo_ob
(
	`v¬ŸbË_g‘
(
$row
->
Çme
, 
NULL
));

1193 ià(
	`dru·l_¡¾’
(
$row
->
v®ue
) > 70) {

1194 
$v®ue
 = 
	`check_¶aš
(
	`dru·l_sub¡r
(
$row
->
v®ue
, 0, 65)) .'...';

1197 
$v®ue
 = 
	`check_¶aš
(
$row
->
v®ue
);

1200 
$fÜm
[
$row
->
Çme
]['v®ue'] = 
	`¬¿y
('#v®ue' => 
$v®ue
);

1201 
$fÜm
[
$row
->
Çme
]['Ëngth'] = 
	`¬¿y
('#v®ue' => $row->
Ëngth
);

1202 
$fÜm
[
$row
->
Çme
]['ed™'] = 
	`¬¿y
('#v®ue' => 
	`l
(
	`t
('edit'), "devel/variable/edit/$row->name"));

1204 
$fÜm
['v¬ŸbËs'] = 
	`¬¿y
('#ty³' => 'checkboxes', '#İtiÚs' => 
$v¬ŸbËs
);

1205 
$fÜm
['subm™'] = 
	`¬¿y
(

1207 '#v®ue' => 
	`t
('Delete'),

1209  
$fÜm
;

1210 
	}
}

1212 
funùiÚ
 
	$theme_dev–_v¬ŸbË_fÜm
(
$fÜm
) {

1215 
$chd»n
 = 
	`–em’t_chd»n
(
$fÜm
['name']);

1216 
	`fÜ—ch
 (
$chd»n
 
as
 
$key
) {

1217 
$rows
[] = 
	`¬¿y
(

1218 
	`dru·l_»nd”
(
$fÜm
['v¬ŸbËs'][
$key
]),

1219 
	`dru·l_»nd”
(
$fÜm
['Çme'][
$key
]),

1220 
	`dru·l_»nd”
(
$fÜm
[
$key
]['value']),

1221 
	`dru·l_»nd”
(
$fÜm
[
$key
]['length']),

1222 
	`dru·l_»nd”
(
$fÜm
[
$key
]['edit']),

1225 
$h—d”
 = 
	`¬¿y
(

1226 
	`theme
('table_select_header_cell'),

1227 
	`¬¿y
('d©a' => 
	`t
('Name'), 'field' => 'name', 'sort' => 'asc'),

1228 
	`¬¿y
('d©a' => 
	`t
('Value'), 'field' => 'value'),

1229 
	`¬¿y
('d©a' => 
	`t
('Length'), 'field' => 'length'),

1230 
	`¬¿y
('d©a' => 
	`t
('Operations'), 'colspan' => 2),

1232 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

1233 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

1235  
$ouut
;

1236 
	}
}

1238 
funùiÚ
 
	$dev–_v¬ŸbË_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1239 
$d–‘es
 = 
	`¬¿y_f‹r
(
$fÜm_¡©e
['values']['variables']);

1240 
	`¬¿y_w®k
(
$d–‘es
, 'variable_del');

1241 ià(
	`couÁ
(
$d–‘es
)) {

1242 
	`dru·l_£t_mes§ge
(
	`fÜm©_¶u¿l
(
	`couÁ
(
$d–‘es
), 'One variable deleted.', '@count variables deleted.'));

1244 
	}
}

1246 
funùiÚ
 
	$dev–_v¬ŸbË_ed™
(
$fÜm_¡©e
, 
$Çme
) {

1247 
$v®ue
 = 
	`v¬ŸbË_g‘
(
$Çme
, 'not found');

1248 
$fÜm
['Çme'] = 
	`¬¿y
(

1250 '#v®ue' => 
$Çme


1252 
$fÜm
['v®ue'] = 
	`¬¿y
(

1254 '#t™Ë' => 
	`t
('Old value'),

1255 '#v®ue' => 
	`d´
(
$v®ue
, 
TRUE
),

1257 ià(
	`is_¡ršg
(
$v®ue
è|| 
	`is_num”ic
($value)) {

1258 
$fÜm
['Ãw'] = 
	`¬¿y
(

1260 '#t™Ë' => 
	`t
('New value'),

1261 '#deçuÉ_v®ue' => 
$v®ue


1263 
$fÜm
['subm™'] = 
	`¬¿y
(

1265 '#v®ue' => 
	`t
('Submit'),

1269 
$­i
 = 
	`v¬ŸbË_g‘
('devel_api_url', 'api.drupal.org');

1270 
$fÜm
['Ãw'] = 
	`¬¿y
(

1272 '#t™Ë' => 
	`t
('New value'),

1273 '#v®ue' => 
	`t
('SÜry, com¶ex v¬ŸbËy³ may‚Ù bed™ed y‘. U£h<em>Execu‹ PHP</em> block‡ndh<¨h»f="@v¬ŸbË-£t-doc">v¬ŸbË_£t()</a> funùiÚ.', 
	`¬¿y
('@variable-set-doc' => "http://$api/api/HEAD/function/variable_set"))

1276 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$Çme
));

1277  
$fÜm
;

1278 
	}
}

1280 
funùiÚ
 
	$dev–_v¬ŸbË_ed™_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1281 
	`v¬ŸbË_£t
(
$fÜm_¡©e
['values']['name'], $form_state['values']['new']);

1282 
	`dru·l_£t_mes§ge
(
	`t
('Saved‚ew v®ufÜ %Çme.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['values']['name'])));

1284 
	}
}

1289 
funùiÚ
 
	$dev–_£ssiÚ
() {

1290 
glob®
 
$u£r
;

1291 
$ouut
 = 
	`k´št_r
(
$_SESSION
, 
TRUE
);

1292 
$h—d”s
 = 
	`¬¿y
(
	`t
('Session‚ame'),('Session ID'));

1293 
$ouut
 .ğ
	`theme
('bË', 
$h—d”s
, 
	`¬¿y
×¼ay(
	`£ssiÚ_Çme
(), 
	`£ssiÚ_id
())));

1294  
$ouut
;

1295 
	}
}

1309 
funùiÚ
 
	$dev–_sw™ch_u£r
(
$Çme
 = 
NULL
) {

1310 
glob®
 
$u£r
;

1311 
$Üig_u£r
 = 
	`¬¿y
();

1313 ià(
	`is£t
(
$Çme
)) {

1314 
$u£r
 = 
	`u£r_lßd
(
	`¬¿y
('Çme' => 
$Çme
));

1317 
	`–£if
 (
	`couÁ
(
$Üig_u£r
)) {

1318 
$u£r
 = 
	`¬¿y_shiá
(
$Üig_u£r
);

1319 
	`¬¿y_unshiá
(
$Üig_u£r
, 
$u£r
);

1323 
$Üig_u£r
[] = 
$u£r
;

1325 
	`dru·l_gÙo
();

1326 
	}
}

1331 
funùiÚ
 
	$dev–_lßd_objeù
(
$objeù
, 
$Çme
 = 
NULL
) {

1332 
$t™Ë
 = 
	`is£t
(
$objeù
->
t™Ë
è? $objeù->t™Ë : $objeù->
Çme
;

1333 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$t™Ë
));

1334  
	`kdev–_´št_objeù
(
$objeù
, '$'. 
$Çme
 .'->');

1335 
	}
}

1340 
funùiÚ
 
	$dev–_»nd”_objeù
(
$ty³
, 
$objeù
) {

1341 
$ouut
 = '';

1342 
$t™Ë
 = 
	`is£t
(
$objeù
->
t™Ë
è? $objeù->t™Ë : $objeù->
Çme
;

1344 
	`dru·l_£t_t™Ë
(
	`check_¶aš
(
$t™Ë
));

1345 
$funùiÚ
 = 
$ty³
 .'_build_content';

1346 
$cÚ‹Á
 = 
	`$funùiÚ
(
$objeù
, 
FALSE
, FALSE);

1347  
	`kdev–_´št_objeù
(
$cÚ‹Á
, '$'. 
$ty³
 .'->');

1348 
	}
}

1350 
funùiÚ
 
	$dev–_–em’ts_·ge
() {

1351  
	`kdev–_´št_objeù
(
	`moduË_švoke_®l
('elements'));

1352 
	}
}

1362 
funùiÚ
 
	$kdev–_´št_objeù
(
$objeù
, 
$´efix
 = 
NULL
) {

1363  
	`has_krumo
(è? 
	`krumo_ob
(
$objeù
è: 
	`dev–_´št_objeù
($objeù, 
$´efix
);

1364 
	}
}

1367 
funùiÚ
 
	$krumo_ob
(
$objeù
) {

1368 
	`ob_¡¬t
();

1369 
	`krumo
(
$objeù
);

1370 
$ouut
 = 
	`ob_g‘_cÚ‹Ás
();

1371 
	`ob_’d_ş—n
();

1372  
$ouut
;

1373 
	}
}

1385 
funùiÚ
 
	$dev–_´št_objeù
(
$objeù
, 
$´efix
 = 
NULL
, 
$h—d”
 = 
TRUE
) {

1386 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'devel') .'/devel.css');

1387 
$ouut
 = '<div class="devel-obj-output">';

1388 ià(
$h—d”
) {

1389 
$ouut
 .ğ'<h3>'. 
	`t
('Di¥Ïy oà!ty³ !obj', 
	`¬¿y
('!ty³' => 
	`¡r_»¶aû
×¼ay('$', '->'), '', 
$´efix
), '!obj' => 
	`g‘ty³
(
$objeù
))) .'</h3>';

1391 
$ouut
 .ğ
	`_dev–_´št_objeù
(
$objeù
, 
$´efix
);

1392 
$ouut
 .= '</div>';

1393  
$ouut
;

1394 
	}
}

1414 
funùiÚ
 
	$_dev–_´št_objeù
(
$obj
, 
$´efix
 = 
NULL
, 
$·»Ás
 = NULL, 
$objeù
 = 
FALSE
) {

1415 
$roÙ_ty³
, 
$out_fÜm©
;

1417 ià(
	`is£t
(
$obj
->
v›w
)) {

1421 ià(!
	`is£t
(
$roÙ_ty³
)) {

1422 
$roÙ_ty³
 = 
	`g‘ty³
(
$obj
);

1423 ià(
$roÙ_ty³
 == 'object') {

1424 
$objeù
 = 
TRUE
;

1428 ià(
	`is_objeù
(
$obj
)) {

1429 
$obj
 = (
¬¿y
)$obj;

1431 ià(
	`is_¬¿y
(
$obj
)) {

1432 
$ouut
 = "<dl>\n";

1433 
	`fÜ—ch
 (
$obj
 
as
 
$f›ld
 => 
$v®ue
) {

1434 ià(
$f›ld
 == 'devel_flag_reference') {

1437 ià(!
	`is_nuÎ
(
$·»Ás
)) {

1438 ià(
$objeù
) {

1439 
$f›ld
 = 
$·»Ás
 .'->'. $field;

1442 ià(
	`is_št
(
$f›ld
)) {

1443 
$f›ld
 = 
$·»Ás
 .'['. $field .']';

1446 
$f›ld
 = 
$·»Ás
 .'[\''. $field .'\']';

1451 
$ty³
 = 
	`g‘ty³
(
$v®ue
);

1453 
$show_summ¬y
 = 
TRUE
;

1454 
$summ¬y
 = 
NULL
;

1455 ià(
$show_summ¬y
) {

1456 
$ty³
) {

1460 ià(
	`¡¾’
(
$v®ue
) == 0) {

1461 
$summ¬y
 = 
	`t
("{empty}");

1463 
	`–£if
 (
	`¡¾’
(
$v®ue
) < 40) {

1464 
$summ¬y
 = 
	`html¥ecŸlch¬s
(
$v®ue
);

1467 
$summ¬y
 = 
	`fÜm©_¶u¿l
(
	`dru·l_¡¾’
(
$v®ue
), '1 character', '@count characters');

1472 
$summ¬y
 = 
	`fÜm©_¶u¿l
(
	`couÁ
((
¬¿y
)
$v®ue
), '1ƒlement', '@countƒlements');

1475 
$summ¬y
 = 
$v®ue
 ? 
	`t
('TRUE') :('FALSE');

1479 ià(!
	`is_nuÎ
(
$summ¬y
)) {

1480 
$ty³sum
 = '('. 
$ty³
 .', <em>'. 
$summ¬y
 .'</em>)';

1483 
$ty³sum
 = '('. 
$ty³
 .')';

1486 
$ouut
 .= '<span class="devel-attr">';

1487 
$ouut
 .= "<dt><span class=\"field\">{$prefix}{$field}</span> $typesum</dt>\n";

1488 
$ouut
 .= "<dd>\n";

1490 ià(
	`is_¬¿y
(
$v®ue
è&& 
	`is£t
($value['devel_flag_reference'])) {

1491 
$v®ue
['dev–_æag_»ã»nû'] = 
TRUE
;

1494 ià(
	`is_¬¿y
(
$v®ue
è&& 
	`is£t
($value['devel_flag_reference']) && !$value['devel_flag_reference']) {

1495 
$v®ue
['dev–_æag_»ã»nû'] = 
FALSE
;

1496 
$ouut
 .ğ
	`_dev–_´št_objeù
(
$v®ue
, 
$´efix
, 
$f›ld
);

1498 
	`–£if
 (
	`is_objeù
(
$v®ue
)) {

1499 
$v®ue
->
dev–_æag_»ã»nû
 = 
FALSE
;

1500 
$ouut
 .ğ
	`_dev–_´št_objeù
((
¬¿y
)
$v®ue
, 
$´efix
, 
$f›ld
, 
TRUE
);

1503 
$v®ue
 = 
	`is_boŞ
($value) ? ($value ? 'TRUE' : 'FALSE') : $value;

1504 
$ouut
 .ğ
	`html¥ecŸlch¬s
(
	`´št_r
(
$v®ue
, 
TRUE
)) ."\n";

1506 
$ouut
 .= "</dd></span>\n";

1508 
$ouut
 .= "</dl>\n";

1510  
$ouut
;

1511 
	}
}

1517 
funùiÚ
 
	$dev–_qu”y_bË
(
$qu”›s
, 
$couÁs
) {

1518 ià(
	`em±y
(
$qu”›s
)) {

1519  
FALSE
;

1521 
$v”siÚ
 = 
	`dev–_g‘_cÜe_v”siÚ
(
VERSION
);

1522 
$h—d”
 = 
	`¬¿y
('ms', '#', 'where', 'query');

1523 
$i
 = 0;

1524 
$­i
 = 
	`v¬ŸbË_g‘
('devel_api_url', 'api.drupal.org');

1525 
	`fÜ—ch
 (
$qu”›s
 
as
 
$qu”y
) {

1527 
$¬
 = 
	`ex¶ode
("\n", 
$qu”y
[0]);

1528 
$funùiÚ
=
	`¬¿y_shiá
(
$¬
);

1529 
$couÁ
 = 
	`is£t
(
$couÁs
[
$qu”y
[0]]) ? $counts[$query[0]] : 0;

1530 
$qu”y
[0]=
	`još
(' ', 
$¬
);

1532 
$diff
 = 
	`round
(
$qu”y
[1] * 1000, 2);

1533 ià(
$diff
 > 
	`v¬ŸbË_g‘
('devel_execution', 5)) {

1534 
$ûÎ
[
$i
][] = 
	`¬¿y
('d©a' => 
$diff
, 'class' => 'marker');

1537 
$ûÎ
[
$i
][] = 
$diff
;

1539 ià(
$couÁ
 > 1) {

1540 
$ûÎ
[
$i
][] = 
	`¬¿y
('d©a' => 
$couÁ
, 'class' => 'marker');

1543 
$ûÎ
[
$i
][] = 
$couÁ
;

1545 
$ûÎ
[
$i
][] = 
	`l
(
$funùiÚ
, "http://$api/api/$version/function/$function");

1546 
$pos
 = 
	`¡½os
(
$qu”y
[0], '*/'è!=ğ
FALSE
 ? strpos($query[0], '*/') + 3 : 0;

1547 
$ûÎ
[
$i
][] = 
	`check_¶aš
(
	`sub¡r
(
$qu”y
[0], 
$pos
));

1548 
$i
++;

1549 
	`un£t
(
$diff
, 
$couÁ
);

1551 ià(
	`v¬ŸbË_g‘
('dev–_qu”y_sÜt', 
DEVEL_QUERY_SORT_BY_SOURCE
)) {

1552 
	`usÜt
(
$ûÎ
, '_devel_table_sort');

1554  
	`theme
('dev–_qu”ylog', 
$h—d”
, 
$ûÎ
);

1555 
	}
}

1557 
funùiÚ
 
	$theme_dev–_qu”ylog_row
(
$row
) {

1558 
$i
 = 0;

1559 
$ouut
 = '';

1560 
	`fÜ—ch
 (
$row
 
as
 
$ûÎ
) {

1561 
$i
++;

1563 ià(
	`is_¬¿y
(
$ûÎ
)) {

1564 
$d©a
 = !
	`em±y
(
$ûÎ
['data']) ? $cell['data'] : '';

1565 
	`un£t
(
$ûÎ
['data']);

1566 
$©Œ
 = 
$ûÎ
;

1569 
$d©a
 = 
$ûÎ
;

1570 
$©Œ
 = 
	`¬¿y
();

1573 ià(!
	`em±y
(
$©Œ
['class'])) {

1574 
$©Œ
['class'] .= " cell cell-$i";

1577 
$©Œ
['class'] = "cell cell-$i";

1579 
$©Œ
 = 
	`dru·l_©Œibu‹s
($attr);

1581 
$ouut
 .= "<div $attr>$data</div>";

1583  
$ouut
;

1584 
	}
}

1586 
funùiÚ
 
theme_dev–_qu”ylog
(
$h—d”
 = 
¬¿y
(), 
$rows
 = 
	$¬¿y
()) {

1587 
$ouut
 = '';

1588 ià(!
	`em±y
(
$h—d”
)) {

1589 
$ouut
 .= "<div class='devel-querylog devel-querylog-header clear-block'>";

1590 
$ouut
 .ğ
	`theme
('dev–_qu”ylog_row', 
$h—d”
);

1591 
$ouut
 .= "</div>";

1593 ià(!
	`em±y
(
$rows
)) {

1594 
$i
 = 0;

1595 
	`fÜ—ch
 (
$rows
 
as
 
$row
) {

1596 
$i
++;

1597 
$zeb¿
 = (
$i
 % 2) == 0 ? 'even' : 'odd';

1598 
$ouut
 .= "<div class='devel-querylog devel-querylog-$zebra clear-block'>";

1599 
$ouut
 .ğ
	`theme
('dev–_qu”ylog_row', 
$row
);

1600 
$ouut
 .= "</div>";

1603  
$ouut
;

1604 
	}
}

1606 
funùiÚ
 
	$_dev–_bË_sÜt
(
$a
, 
$b
) {

1607 
$a
 = 
	`is_¬¿y
($a[0]) ? $a[0]['data'] : $a[0];

1608 
$b
 = 
	`is_¬¿y
($b[0]) ? $b[0]['data'] : $b[0];

1609 ià(
$a
 < 
$b
) {

1612 ià(
$a
 > 
$b
) {

1616 
	}
}

1621 
funùiÚ
 
	$dev–_tim”
() {

1622 
$time
 = 
	`tim”_»ad
('page');

1623  
	`t_§ã
(' PagexecutiÚimwa @timms.', 
	`¬¿y
('@time' => 
$time
));

1624 
	}
}

1629 
funùiÚ
 
	$d¬gs
(
$®ways
 = 
TRUE
) {

1630 
$´š‹d
;

1631 ià(
$®ways
 || !
$´š‹d
) {

1632 
$bt
 = 
	`debug_backŒaû
();

1633 
´št
 
	`kdev–_´št_objeù
(
$bt
[1]['args']);

1634 
$´š‹d
 = 
TRUE
;

1636 
	}
}

1639 
funùiÚ
 
	$dd
(
$d©a
, 
$Ïb–
 = 
NULL
) {

1640  
	`dru·l_debug
(
$d©a
, 
$Ïb–
);

1641 
	}
}

1645 
funùiÚ
 
	$dru·l_debug
(
$d©a
, 
$Ïb–
 = 
NULL
) {

1646 
	`ob_¡¬t
();

1647 
	`´št_r
(
$d©a
);

1648 
$¡ršg
 = 
	`ob_g‘_ş—n
();

1649 ià(
$Ïb–
) {

1650 
$out
 = 
$Ïb–
 .': '. 
$¡ršg
;

1653 
$out
 = 
$¡ršg
;

1655 
$out
 .= "\n";

1658 
$fe
 = 
	`fe_dœeùÜy_‹mp
() .'/drupal_debug.txt';

1659 ià(
	`fe_put_cÚ‹Ás
(
$fe
, 
$out
, 
FILE_APPEND
è==ğ
FALSE
) {

1660 
	`dru·l_£t_mes§ge
(
	`t
('The file could‚ot be written.'), 'error');

1661  
FALSE
;

1663 
	}
}

1668 
funùiÚ
 
	$dpm
(
$šput
, 
$Çme
 = 
NULL
) {

1669 ià(
	`u£r_acûss
('access devel information')) {

1670 
$expÜt
 = 
	`k´št_r
(
$šput
, 
TRUE
, 
$Çme
);

1671 
	`dru·l_£t_mes§ge
(
$expÜt
);

1673 
	}
}

1678 
funùiÚ
 
	$dvm
(
$šput
, 
$Çme
 = 
NULL
) {

1679 ià(
	`u£r_acûss
('access devel information')) {

1680 
$expÜt
 = 
	`d´št_r
(
$šput
, 
TRUE
, 
$Çme
, 'v¬_dump', 
FALSE
);

1681 
	`dru·l_£t_mes§ge
(
$expÜt
);

1683 
	}
}

1686 
funùiÚ
 
	$dsm
(
$šput
, 
$Çme
 = 
NULL
) {

1687 
	`dpm
(
$šput
, 
$Çme
);

1688 
	}
}

1693 
funùiÚ
 
	$d´
(
$šput
, 
$»tuº
 = 
FALSE
, 
$Çme
 = 
NULL
) {

1694  
	`d´št_r
(
$šput
, 
$»tuº
, 
$Çme
);

1695 
	}
}

1700 
funùiÚ
 
	$k´
(
$šput
, 
$»tuº
 = 
FALSE
, 
$Çme
 = 
NULL
) {

1701  
	`k´št_r
(
$šput
, 
$»tuº
, 
$Çme
);

1702 
	}
}

1707 
funùiÚ
 
	$dvr
(
$šput
, 
$»tuº
 = 
FALSE
, 
$Çme
 = 
NULL
) {

1708  
	`d´št_r
(
$šput
, 
$»tuº
, 
$Çme
, 'v¬_dump', 
FALSE
);

1709 
	}
}

1711 
funùiÚ
 
k´št_r
(
$šput
, 
$»tuº
 = 
FALSE
, 
$Çme
 = 
NULL
, 
$funùiÚ
 = 'print_r') {

1713 ià(
m”™s_krumo
(
$šput
)) {

1714 ià(
u£r_acûss
('access devel information')) {

1715  
$»tuº
 ? (
is£t
(
$Çme
è? $Çm.' => ' : ''è. 
krumo_ob
(
$šput
è: 
krumo
($input);

1719  
d´št_r
(
$šput
, 
$»tuº
, 
$Çme
, 
$funùiÚ
);

1728 
funùiÚ
 
d´št_r
(
$šput
, 
$»tuº
 = 
FALSE
, 
$Çme
 = 
NULL
, 
$funùiÚ
 = '´št_r', 
$check
ğ
TRUE
) {

1729 ià(
u£r_acûss
('access devel information')) {

1730 ià(
$Çme
) {

1731 
$Çme
 .= ' => ';

1733 
ob_¡¬t
();

1734 
$funùiÚ
(
$šput
);

1735 
	g$ouut
 = 
ob_g‘_ş—n
();

1736 ià(
	g$check
) {

1737 
	g$ouut
 = 
check_¶aš
(
$ouut
);

1739 ià(
couÁ
(
$šput
, 
COUNT_RECURSIVE
è> 
	gDEVEL_MIN_TEXTAREA
) {

1741 
	g$´š‹d_v®ue
 = "<‹x»¨rows=30 styË=\"width: 100%;\">\n". 
$Çme
 . 
$ouut
 .'</textarea>';

1744 
	g$´š‹d_v®ue
 = '<´e>'. 
$Çme
 . 
$ouut
 .'</pre>';

1747 ià(
	g$»tuº
) {

1748  
	g$´š‹d_v®ue
;

1751 
´št
 
	g$´š‹d_v®ue
;

1759 
funùiÚ
 
	$ddebug_backŒaû
() {

1760 ià(
	`u£r_acûss
('access devel information')) {

1761 
$Œaû
 = 
	`debug_backŒaû
();

1762 
	`¬¿y_shiá
(
$Œaû
);

1763 
	`fÜ—ch
 (
$Œaû
 
as
 
$key
 => 
$v®ue
) {

1764 
$rich_Œaû
[
$v®ue
['function']] = $value;

1766 ià(
	`has_krumo
()) {

1767 
´št
 
	`krumo
(
$rich_Œaû
);

1770 
	`d´št_r
(
$rich_Œaû
);

1773 
	}
}

1780 
funùiÚ
 
	$db_qu”yd
(
$qu”y
) {

1781 
$¬gs
 = 
	`func_g‘_¬gs
();

1782 
	`¬¿y_shiá
(
$¬gs
);

1783 
$qu”y
 = 
	`db_´efix_bËs
($query);

1784 ià(
	`is£t
(
$¬gs
[0]è
ªd
 
	`is_¬¿y
($args[0])) {

1785 
$¬gs
 = $args[0];

1787 
	`_db_qu”y_ÿÎback
(
$¬gs
, 
TRUE
);

1788 
$qu”y
 = 
	`´eg_»¶aû_ÿÎback
(
DB_QUERY_REGEXP
, '_db_query_callback', $query);

1789  
	`_db_qu”y
(
$qu”y
, 1);

1790 
	}
}

1794 ià(
v¬ŸbË_g‘
('sm_lib¿ry', ''è=ğ
dru·l_g‘_f’ame
('module', 'devel')) {

1798 
funùiÚ
 
dru·l_ma_w¿µ”
(
$mes§ge
) {

1799 
	g$mimeh—d”s
 = 
¬¿y
();

1800 
fÜ—ch
 (
$mes§ge
['h—d”s'] 
as
 
$Çme
 => 
$v®ue
) {

1802 
$mimeh—d”s
[] = 
check_¶aš
(
$Çme
 .': '. 
mime_h—d”_’code
(
$v®ue
));

1804 
w©chdog
(

1807 
¬¿y
(

1808 '%ma_id' => 
$mes§ge
['id'],

1809 '%to' => 
$mes§ge
['to'],

1810 '%äom' => 
$mes§ge
['from'],

1811 '%Ïng' => 
$mes§ge
['Ïnguage']->
Ïnguage
,

1812 '%subjeù' => 
$mes§ge
['subject'],

1813 '%body' => 
$mes§ge
['body'],

1814 '!h—d”' => 
im¶ode
("<b¸/>", 
$mimeh—d”s
),

1815 
WATCHDOG_INFO
,

1818  
	gTRUE
;

1822 
funùiÚ
 
	$dev–_qu”›s
() {

1823 
$h—d”
 = 
	`¬¿y
(

1824 
	`¬¿y
('d©a' => 
	`t
('Total (ms)'), 'field' => 'total_time', 'sort' => 'desc'),

1825 
	`¬¿y
('d©a' => 
	`t
('Average (ms)'), 'field' => 'average', 'sort' => 'desc'),

1826 
	`¬¿y
('d©a' => 
	`t
('Std deviation (ms)')),

1827 
	`¬¿y
('d©a' => 
	`t
('Count'), 'field' => 'count'),

1828 
	`¬¿y
('d©a' => 
	`t
('Function'), 'field' => 'q.function'),

1829 
	`¬¿y
('d©a' => 
	`t
('Query'), 'field' => 'q.query'),

1832 
glob®
 
$db_ty³
;

1833 ià(
$db_ty³
 == 'pgsql') {

1834 
$»suÉ
 = 
	`·g”_qu”y
('SELECT q.qid, q.qu”y, q.funùiÚ ,.* FROM {dev–_qu”›s} q INNER JOIN (SELECT.qid, COUNTÑ.qidèAS couÁ,SUMÑ.timeèASÙ®_time, AVGÑ.timeèAS‡v”age, STDDEVÑ.timeèAS stddev FROM {dev–_times} GROUP BY.qidèAS ON.qid=q.qid '. 
	`bËsÜt_sql
(
$h—d”
), 30, 0, 'SELECT COUNT(qid) FROM {devel_queries}');

1837 
$»suÉ
 = 
	`·g”_qu”y
('SELECT q.qid, q.qu”y, q.funùiÚ,.*, COUNTÑ.qidèAS couÁ, SUMÑ.timeèASÙ®_time, AVGÑ.timeèAS‡v”age, STDDEVÑ.timeèAS stddev FROM {dev–_qu”›s} q INNER JOIN {dev–_times} ON q.qid =.qid GROUP BY.qid '. 
	`bËsÜt_sql
(
$h—d”
), 30, 0, 'SELECT COUNT(qid) FROM {devel_queries}');

1839 
$log
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1840 
$rows
[] = 
	`¬¿y
(

1841 
	`round
(
$log
->
tÙ®_time
 * 1000, 3),

1842 
	`round
(
$log
->
av”age
 * 1000, 3),

1843 
	`round
(
$log
->
¡ddev
 * 1000, 3),

1844 
$log
->
couÁ
,

1845 
$log
->
funùiÚ
,

1846 
	`check_¶aš
(
$log
->
qu”y
)

1850 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

1851 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 30, 0);

1852 
$ouut
 .ğ
	`l
(
	`t
('Delete collected query statistics'), 'devel/queries/empty');

1854 
´št
 
	`theme
('·ge', 
$ouut
, 
FALSE
);

1855 
	}
}

1857 
funùiÚ
 
	$dev–_qu”›s_em±y
() {

1858 
	`db_qu”y
('DELETE FROM {devel_queries}');

1859 
	`db_qu”y
('DELETE FROM {devel_times}');

1860 
	`dru·l_£t_mes§ge
(
	`t
('Stored query statistics deleted.'));

1861 
	`dru·l_gÙo
('devel/queries');

1862 
	}
}

1873 
funùiÚ
 
	$dev–_»bud_node_comm’t_¡©i¡ics_·ge
() {

1874 
	`dev–_»bud_node_comm’t_¡©i¡ics
();

1875 
	`dru·l_£t_mes§ge
('node_comment_statisticsable has been„ebuilt.');

1876 
	`dru·l_gÙo
('admin');

1877 
	}
}

1884 
funùiÚ
 
	$dev–_»bud_node_comm’t_¡©i¡ics
() {

1886 
$sql
 = "DELETE FROM {node_comment_statistics}";

1887 
	`db_qu”y
(
$sql
);

1889 
$sql
 = "INSERT INTO {node_comment_statistics} (nid,†ast_comment_timestamp,†ast_comment_name,†ast_comment_uid, comment_count) (select‚id, c.timestamp,‚ame, uid, comment_count FROM {comments} c INNER JOIN (SELECT MAX(timestamp) ASimestamp, COUNT(*) AS comment_count FROM {comments} WHERE status=%d GROUP BY‚id) AS c2 ON c.nid = c2.nid AND c.timestamp=c2.timestamp)";

1890 
	`db_qu”y
(
$sql
, 
COMMENT_PUBLISHED
);

1893 
	`db_qu”y_‹mpÜ¬y
("SELECT‚.nid,‚.created,‚.uid FROM {node}‚ LEFT JOIN {node_comment_statistics} c ON‚.nid = c.nid WHERE c.comment_count IS NULL", 'missing_nids');

1894 
	`db_qu”y
("INSERT INTO {node_comment_statistics} (nid,†ast_comment_timestamp,†ast_comment_name,†ast_comment_uid, comment_count) SELECT‚.nid,‚.created, NULL,‚.uid, 0 FROM missing_nids‚");

1895 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/devel/devel_generate.drush.inc

1 <?
php


12 
funùiÚ
 
	$dev–_g’”©e_drush_h–p
(
$£ùiÚ
) {

13 
$£ùiÚ
) {

15  
	`dt
('Generate user‡ccounts.');

17  
	`dt
('Generateaxonomyerms for‡ given vocabulary.');

19  
	`dt
('Generate‚odes‡nd comments.');

21 
	}
}

26 
funùiÚ
 
	$dev–_g’”©e_drush_commªd
() {

27 
$™ems
['g’”©e-u£rs'] = 
	`¬¿y
(

29 '¬gum’ts' => 
	`¬¿y
(

32 'İtiÚs' => 
	`¬¿y
(

35 '®Ÿ£s' => 
	`¬¿y
('genu'),

37 
$™ems
['g’”©e-xÚomy'] = 
	`¬¿y
(

39 '¬gum’ts' => 
	`¬¿y
(

43 'İtiÚs' => 
	`¬¿y
(

46 '®Ÿ£s' => 
	`¬¿y
('gent'),

48 
$™ems
['g’”©e-cÚ‹Á'] = 
	`¬¿y
(

50 'dru·Èd•’d’c›s' => 
	`¬¿y
('devel_generate'),

51 '¬gum’ts' => 
	`¬¿y
(

55 'İtiÚs' => 
	`¬¿y
(

62 '®Ÿ£s' => 
	`¬¿y
('genc'),

64  
$™ems
;

65 
	}
}

70 
funùiÚ
 
	$drush_dev–_g’”©e_g’”©e_u£rs
(
$num_u£rs
 = 
NULL
) {

71 ià(
	`drush_g’”©e_is_numb”
(
$num_u£rs
è=ğ
FALSE
) {

72 
	`drush_£t_”rÜ
('DEVEL_GENERATE_INVALID_NUMBER', 
	`dt
('Invalid‚umber of users.'));

74 
	`drush_g’”©e_šşude_dev–
();

75 
	`drush_İ
('dev–_ü—‹_u£rs', 
$num_u£rs
, 
	`drush_g‘_İtiÚ
('kill'));

76 
	`drush_log
(
	`dt
('G’”©ed @numb” u£rs.', 
	`¬¿y
('@numb”' => 
$num_u£rs
)), 'ok');

77 
	}
}

82 
funùiÚ
 
	$drush_dev–_g’”©e_g’”©e_xÚomy
(
$num_voÿb
 = 
NULL
, 
$num_‹rms
 = NULL) {

83 ià(
	`drush_g’”©e_is_numb”
(
$num_voÿb
è=ğ
FALSE
) {

84 
	`drush_£t_”rÜ
('DEVEL_GENERATE_INVALID_VID', 
	`dt
('Invalid vocabulary ID.'));

86 ià(
	`drush_g’”©e_is_numb”
(
$num_‹rms
è=ğ
FALSE
) {

87 
	`drush_£t_”rÜ
('DEVEL_GENERATE_INVALID_NUM_TERMS', 
	`dt
('Invalid‚umber oferms.'));

89 
	`drush_g’”©e_šşude_dev–
();

90 
	`drush_İ
('dev–_g’”©e_xÚomy_d©a', 
$num_voÿb
, 
$num_‹rms
, '12', 
	`drush_g‘_İtiÚ
('kill'));

91 
	`drush_log
(
	`dt
('G’”©ed @num_voÿb voÿbuÏry, @num_‹rm ‹rms', 
	`¬¿y
('@num_voÿb' => 
$num_voÿb
, '@num_‹rms' => 
$num_‹rms
)), 'ok');

92 
	}
}

97 
funùiÚ
 
	$drush_dev–_g’”©e_g’”©e_cÚ‹Á
(
$num_nodes
 = 
NULL
, 
$max_comm’ts
 = NULL, 
$add_Ïnguage
 = NULL) {

98 ià(
	`drush_g’”©e_is_numb”
(
$num_nodes
è=ğ
FALSE
) {

99 
	`drush_£t_”rÜ
('DEVEL_GENERATE_INVALID_NUM_NODES', 
	`dt
('Invalid‚umber of‚odes'));

101 ià(!
	`em±y
(
$max_comm’ts
è&& 
	`drush_g’”©e_is_numb”
($max_comm’tsè=ğ
FALSE
) {

102 
	`drush_£t_”rÜ
('DEVEL_GENERATE_INVALID_NUM_COMMENTS', 
	`dt
('Invalid‚umber of comments.'));

105 
$add_Ïnguage
 = 
	`drush_g‘_İtiÚ
('languages');

106 ià(!
	`em±y
(
$add_Ïnguage
)) {

107 
$add_Ïnguage
 = 
	`ex¶ode
(',', 
	`¡r_»¶aû
(' ', '', $add_language));

110 
$v®ues
['v®ues']['add_Ïnguage'] = 
	`¬¿y_æ
(
	`¬¿y_š‹r£ù
(
$add_Ïnguage
, 
	`¬¿y_keys
(
	`loÿË_Ïnguage_li¡
())));

114 
glob®
 
$u£r
;

115 
$u£r_Úe
 = 
	`u£r_lßd
(
	`¬¿y
('uid' => '1'));

116 
$u£r
 = 
$u£r_Úe
;

118 
	`£ssiÚ_§ve_£ssiÚ
(
FALSE
);

119 
	`drush_g’”©e_šşude_dev–
();

121 ià(
	`drush_g‘_İtiÚ
('kl')è
$v®ues
['values']['kill_content'] = 1;

122 
$v®ues
['values']['title_length'] = '8';

123 
$v®ues
['v®ues']['num_nodes'] = 
$num_nodes
;

124 
$v®ues
['v®ues']['max_comm’ts'] = 
$max_comm’ts
;

125 
$v®ues
['v®ues']['add_‹rms'] = 
	`drush_g‘_İtiÚ
('add-‹rms', 
FALSE
);

126 
$v®ues
['v®ues']['add_u¶ßd'] = 
	`drush_g‘_İtiÚ
('add-u¶ßd', 
FALSE
);

127 
$®l_ty³s
 = 
	`¬¿y_keys
(
	`dev–_g’”©e_cÚ‹Á_ty³s
());

128 ià(
	`drush_g‘_İtiÚ
('types')) {

129 
$ty³s
 = 
	`ex¶ode
(',', 
	`drush_g‘_İtiÚ
('types'));

130 
$ty³s
 = 
	`¬¿y_š‹r£ù
($ty³s, 
$®l_ty³s
);

133 
$ty³s
 = 
$®l_ty³s
;

135 
$v®ues
['v®ues']['node_ty³s'] = 
	`dru·l_m­_assoc
(
$ty³s
);

137 
	`drush_İ
('dev–_g’”©e_cÚ‹Á', 
$v®ues
);

138 
	`drush_log
(
	`dt
('G’”©ed @num_node nodes, @max_comm’t comm’t ³¸node', 
	`¬¿y
('@num_nodes' => 
$num_nodes
, '@max_comm’ts' => 
$max_comm’ts
)), 'ok');

139 
	}
}

145 
funùiÚ
 
	$drush_g’”©e_is_numb”
(
$numb”
) {

146 ià(
$numb”
 =ğ
NULL
è 
FALSE
;

147 ià(!
	`is_num”ic
(
$numb”
)è 
FALSE
;

148 ià(
$numb”
 < 0è 
FALSE
;

149  
TRUE
;

150 
	}
}

153 
funùiÚ
 
	$drush_g’”©e_šşude_dev–
() {

154 
$·th
 = 
	`dru·l_g‘_·th
('module', 'devel_generate');

155 
	`»quœe_Úû
(
$·th
 .'/devel_generate.inc');

156 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/devel/devel_generate.inc

1 <?
php


4 ià(!
ši_g‘
('safe_mode')) {

5 
£t_time_lim™
(240);

18 
funùiÚ
 
	$dev–_ü—‹_u£rs
(
$num
, 
$kl
, 
$age
 = 0) {

19 
$u¾
 = 
	`·r£_u¾
(
$GLOBALS
['base_url']);

20 ià(
$kl
) {

21 
	`db_qu”y
('DELETE FROM {users} WHERE uid > 1');

22 
	`dru·l_£t_mes§ge
(
	`t
('Users deleted.'));

24 ià(
$num
 > 0) {

25 
$Çmes
 = 
	`¬¿y
();

26 
	`couÁ
(
$Çmes
è< 
$num
) {

27 
$Ëngth
 = 
	`mt_¿nd
(6, 12);

28 
$Çme
 = 
	`dev–_g’”©e_wÜd
(
$Ëngth
);

29 
$Çmes
[
$Çme
] = '';

31 
	`fÜ—ch
 (
$Çmes
 
as
 
$Çme
 => 
$v®ue
) {

32 
$·ss
 = 
	`md5
(
	`u£r_·sswÜd
());

33 
$ma
 = 
$Çme
 .'@'. 
$u¾
['host'];

34 
$now
 = 
	`time
();

35 
$ü—‹d
 = (
$age
 ? 
$now
 - $age : $now - 1);

36 
$accouÁ
 = 
	`u£r_§ve
(
NULL
, 
	`¬¿y
('Çme' => 
$Çme
, '·ss' => 
$·ss
, 'ma' => 
$ma
, '¡©us' =>'1', 'ü—‹d' => 
$ü—‹d
, 'acûss' => 
$now
, 'dev–_g’”©e' => 
TRUE
));

38 
	`dru·l_£t_mes§ge
(
	`t
('!num_u£r ü—‹d.', 
	`¬¿y
('!num_u£rs' => 
	`fÜm©_¶u¿l
(
$num
, '1 user', '@count users'))));

40 
	}
}

51 
funùiÚ
 
	$dev–_g’”©e_cÚ‹Á
(
$fÜm_¡©e
) {

52 ià(
$fÜm_¡©e
['values']['kill_content']) {

53 
	`dev–_g’”©e_cÚ‹Á_kl
(
$fÜm_¡©e
['values']);

56 ià(
	`couÁ
(
$fÜm_¡©e
['values']['node_types'])) {

58 
	`dev–_g’”©e_cÚ‹Á_´e_node
(
$fÜm_¡©e
['values']);

59 
$i
 = 1; $˜<ğ
$fÜm_¡©e
['values']['num_nodes']; $i ++) {

60 
	`dev–_g’”©e_cÚ‹Á_add_node
(
$fÜm_¡©e
['values']);

64 
	`dru·l_£t_mes§ge
(
	`fÜm©_¶u¿l
(
$fÜm_¡©e
['values']['num_nodes'], '1‚ode created.', '@count‚odes created'));

65 
	}
}

67 
funùiÚ
 
	$dev–_g’”©e_add_comm’ts
(
$node
, 
$u£rs
, 
$max_comm’ts
, 
$t™Ë_Ëngth
 = 8) {

69 
$num_comm’ts
 = 
	`mt_¿nd
(1, 
$max_comm’ts
);

70 
$i
 = 1; $˜<ğ
$num_comm’ts
; $i++) {

71 
$comm’t
->
nid
 = 
$node
->nid;

72 
$comm’t
->
cid
 = 
NULL
;

73 
$comm’t
->
fÜm©
 = 
FILTER_FORMAT_DEFAULT
;

74 
$comm’t
->
Çme
 = 'devel generate';

75 
$comm’t
->
ma
 = 'devel_generate@example.com';

76 
$comm’t
->
time¡amp
 = 
	`mt_¿nd
(
$node
->
ü—‹d
, 
	`time
());

78 
$i
 % 3) {

80 
$comm’t
->
pid
 = 
	`db_»suÉ
(
	`db_qu”y_¿nge
("SELECT cid FROM {comm’ts} WHERE…id = 0 AND‚id = %d ORDER BY RAND()", $comm’t->
nid
, 0, 1));

83 
$comm’t
->
pid
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT cid FROM {comm’ts} WHERE…id > 0 AND‚id = %d ORDER BY RAND()", $comm’t->
nid
, 0, 1));

86 
$comm’t
->
pid
 = 0;

89 
$comm’t
->
subjeù
 = 
	`dev–_ü—‹_g»ekšg
(
	`mt_¿nd
(1, 
$t™Ë_Ëngth
), 
TRUE
);

90 
$comm’t
->
comm’t
 = 
	`dev–_ü—‹_cÚ‹Á
();

91 
$comm’t
->
uid
 = 
$u£rs
[
	`¬¿y_¿nd
($users)];

94 
	`comm’t_§ve
((
¬¿y
)
$comm’t
);

97 
	}
}

99 
funùiÚ
 
dev–_g’”©e_voÿbs
(
$»cÜds
, 
$maxËngth
 = 12, 
$ty³s
 = 
¬¿y
('story', 'blog', 'forum', 'page')) {

100 
	g$vocs
 = 
¬¿y
();

103 
	g$i
 = 1; $˜<ğ
$»cÜds
; $i++) {

104 
	g$voc
 = 
¬¿y
();

105 
	g$voc
['Çme'] = 
dev–_g’”©e_wÜd
(
¿nd
(2, 
$maxËngth
));

106 
	g$voc
['desütiÚ'] = "desütiÚ oà". 
$voc
['name'];

107 
	g$voc
['nodes'] = 
¬¿y_æ
(
¬¿y
(
$ty³s
[
¬¿y_¿nd
($types)]));

108 
fÜ—ch
 (
$voc
['nodes'] 
as
 
$key
 => 
$v®ue
) {

109 
$voc
['nodes'][
$key
] = $key;

111 
	g$voc
['multiple'] = 1;

112 
	g$voc
['required'] = 0;

113 
	g$voc
['relations'] = 1;

114 
	g$voc
['hierarchy'] = 1;

115 
	g$voc
['weight'] = 
mt_¿nd
(0,10);

117 
xÚomy_§ve_voÿbuÏry
(
$voc
);

118 
	g$vocs
[] = 
$voc
['name'];

120  
	g$vocs
;

123 
funùiÚ
 
	$dev–_g’”©e_‹rms
(
$»cÜds
, 
$vocs
, 
$maxËngth
 = 12) {

124 
$‹rms
 = 
	`¬¿y
();

127 
$i
 = 1; $˜<ğ
$»cÜds
; $i++) {

128 
$i
 % 2) {

130 
$‹rm
['vid'] = 
$vocs
[
	`¬¿y_¿nd
($vocs)];

136 
$·»Á
 = 
	`db_ãtch_objeù
(
	`db_qu”y_¿nge
("SELECT.tid, v.vid FROM {term_data} INNER JOIN {vocabulary} v ON.vid = v.vid ORDER BY RAND()", 0, 1));

137 
$‹rm
['·»Á'] = 
	`¬¿y
(
$·»Á
->
tid
);

138 
$‹rm
['vid'] = 
$·»Á
->
vid
;

142 
$‹rm
['Çme'] = 
	`dev–_g’”©e_wÜd
(
	`mt_¿nd
(2, 
$maxËngth
));

143 
$‹rm
['description'] = "description of ". $term['name'];

144 
$‹rm
['weight'] = 
	`mt_¿nd
(0,10);

146 
$¡©us
 = 
	`xÚomy_§ve_‹rm
(
$‹rm
);

147 
$ouut
 = 
NULL
;

149 ià(
$¡©us
) {

150 
$‹rms
[] = 
$‹rm
['name'];

153 
	`un£t
(
$‹rm
);

155  
$‹rms
;

156 
	}
}

158 
funùiÚ
 
	$dev–_g’”©e_g‘_voÿbs
() {

159 
$vocs
 = 
	`¬¿y
();

160 
$»suÉ
 = 
	`db_qu”y
("SELECT vid FROM {vocabulary}");

161 
$voc
 = 
	`db_ãtch_objeù
(
$»suÉ
)){

162 
$vocs
[] = 
$voc
->
vid
;

164  
$vocs
;

165 
	}
}

167 
funùiÚ
 
	$dev–_g’”©e_xÚomy_d©a
(
$num_voÿb
, 
$num_‹rms
, 
$t™Ë_Ëngth
, 
$kl
) {

169 ià(
$kl
) {

170 
	`db_qu”y
("DELETE FROM {term_data}");

171 
	`db_qu”y
("DELETE FROM {term_node}");

172 
	`db_qu”y
("DELETE FROM {term_hierarchy}");

173 
	`db_qu”y
("DELETE FROM {term_relation}");

174 
	`db_qu”y
("DELETE FROM {term_synonym}");

175 
	`db_qu”y
("DELETE FROM {vocabulary}");

176 
	`db_qu”y
("DELETE FROM {vocabulary_node_types}");

177 
$GLOBALS
['db_type']) {

180 
	`db_qu”y
("ALTER TABLE {vocabulary} AUTO_INCREMENT = 1");

181 
	`db_qu”y
("ALTER TABLE {term_data} AUTO_INCREMENT = 1");

184 
	`db_qu”y
("SELECT setval('{vocabulary}_vid_seq', 1, false)");

185 
	`db_qu”y
("SELECT setval('{term_data}_tid_seq', 1, false)");

188 
	`dru·l_£t_mes§ge
(
	`t
('Deletedaxonomy.'));

191 
$Ãw_vocs
 = 
	`dev–_g’”©e_voÿbs
(
$num_voÿb
, 
$t™Ë_Ëngth
);

192 ià(!
	`em±y
(
$Ãw_vocs
)) {

193 
	`dru·l_£t_mes§ge
(
	`t
('C»©edhfŞlowšg‚ew voÿbuÏr›s: !vocs', 
	`¬¿y
('!vocs' => 
	`theme
('™em_li¡', 
$Ãw_vocs
))));

195 
$vocs
 = 
	`dev–_g’”©e_g‘_voÿbs
();

196 
$Ãw_‹rms
 = 
	`dev–_g’”©e_‹rms
(
$num_‹rms
, 
$vocs
, 
$t™Ë_Ëngth
);

197 ià(!
	`em±y
(
$Ãw_‹rms
)) {

198 
	`dru·l_£t_mes§ge
(
	`t
('C»©edhfŞlowšg‚ew”ms: !‹rms', 
	`¬¿y
('!‹rms' => 
	`theme
('™em_li¡', 
$Ãw_‹rms
))));

200 
	}
}

202 
funùiÚ
 
	$dev–_g’”©e_wÜd
(
$Ëngth
){

203 
	`¤ªd
(()
	`miüÙime
()*1000000);

205 
$vow–s
 = 
	`¬¿y
("a", "e", "i", "o", "u");

206 
$cÚs
 = 
	`¬¿y
("b", "c", "d", "g", "h", "j", "k", "l", "m", "n", "p", "r", "s", "t", "u", "v", "w", "tr",

209 
$num_vow–s
 = 
	`couÁ
(
$vow–s
);

210 
$num_cÚs
 = 
	`couÁ
(
$cÚs
);

211 
$wÜd
 = '';

213 
	`¡¾’
(
$wÜd
è< 
$Ëngth
){

214 
$wÜd
 .ğ
$cÚs
[
	`mt_¿nd
(0, 
$num_cÚs
 - 1)] . 
$vow–s
[mt_¿nd(0, 
$num_vow–s
 - 1)];

217  
	`sub¡r
(
$wÜd
, 0, 
$Ëngth
);

218 
	}
}

220 
funùiÚ
 
	$dev–_ü—‹_cÚ‹Á
(
$ty³
 = 
NULL
) {

221 
$Å¬as
 = 
	`mt_¿nd
(1,12);

222 
$ty³
 = 
	`em±y
($ty³è? 
	`mt_¿nd
(0,3) : $type;

224 
$ouut
 = "";

225 
$ty³
 % 3) {

227 
$i
 = 1; $˜<ğ
$Å¬as
; $i++) {

228 
$ouut
 .ğ
	`dev–_ü—‹_·¿
(
	`mt_¿nd
(10, 60), 1);

233 
$i
 = 1; $˜<ğ
$Å¬as
; $i++) {

234 
$ouut
 .ğ
	`dev–_ü—‹_·¿
(
	`mt_¿nd
(10, 60), 2);

239 
$i
 = 1; $˜<ğ
$Å¬as
; $i++) {

240 
$ouut
 .ğ
	`dev–_ü—‹_·¿
(
	`mt_¿nd
(10,60)) ."\n\n";

244  
$ouut
;

245 
	}
}

248 
funùiÚ
 
	$dev–_g’”©e_cÚ‹Á_ty³s
() {

249 
$İtiÚs
 = 
	`¬¿y
();

251 ià(
	`moduË_exi¡s
('content')) {

252 
$ty³s
 = 
	`cÚ‹Á_ty³s
();

253 
	`fÜ—ch
 (
$ty³s
 
as
 
$ty³
) {

254 
$w¬n
 = '';

255 ià(
	`couÁ
(
$ty³
['fields'])) {

256 
$w¬n
 = 
	`t
('. Thisype contains CCK fields which will only be…opulated by fieldshat implementhe content_generate hook.');

258 
$İtiÚs
[
$ty³
['ty³']] = 
	`t
($ty³['Çme']). 
$w¬n
;

262 
$ty³s
 = 
	`node_g‘_ty³s
();

263 
	`fÜ—ch
 (
$ty³s
 
as
 
$ty³
) {

264 
$İtiÚs
[
$ty³
->
ty³
] = 
	`t
($ty³->
Çme
);

269 
	`un£t
(
$İtiÚs
['poll']);

271  
$İtiÚs
;

272 
	}
}

275 
funùiÚ
 
	$dev–_ü—‹_·¿
(
$wÜds
, 
$ty³
 = 0) {

276 
$ouut
 = "";

277 
$ty³
) {

279 
$ouut
 .= "<p>";

280 
$ouut
 .ğ
	`dev–_ü—‹_g»ekšg
(
$wÜds
);

281 
$ouut
 = 
	`Œim
($output) ."</p>";

285 
$ouut
 .ğ
	`dev–_ü—‹_g»ekšg
(
$wÜds
);

286 
$ouut
 = 
	`Œim
($output) ."<br />";

290 
$ouut
 .ğ
	`dev–_ü—‹_g»ekšg
(
$wÜds
);

291 
$ouut
 = 
	`Œim
($output);

293  
$ouut
;

294 
	}
}

296 
funùiÚ
 
	$dev–_ü—‹_g»ekšg
(
$wÜds
, 
$t™Ë
 = 
FALSE
) {

297 
$diùiÚ¬y
 = 
	`¬¿y
("abbas", "abdo", "abico", "abigo", "abluo", "accumsan",

328 
$g»ekšg
 = "";

330 ià(!
$t™Ë
) {

331 
$wÜds
 > 0) {

332 
$£Á’û_Ëngth
 = 
	`mt_¿nd
(3,10);

334 
$g»ekšg
 .ğ
	`ucfœ¡
(
$diùiÚ¬y
[
	`¬¿y_¿nd
($dictionary)]);

335 
$i
 = 1; $˜< 
$£Á’û_Ëngth
; $i++) {

336 
$g»ekšg
 .ğ" " . 
$diùiÚ¬y
[
	`¬¿y_¿nd
($dictionary)];

339 
$g»ekšg
 .= ". ";

340 
$wÜds
 -ğ
$£Á’û_Ëngth
;

345 
$t™Ë_Ëngth
 = 
$wÜds
;

346 
$¬¿y
 = 
	`¬¿y
();

347 
$i
 = 0; $˜< 
$wÜds
; $i++) {

348 
$¬¿y
[] = 
$diùiÚ¬y
[
	`¬¿y_¿nd
($dictionary)];

350 
$g»ekšg
 = 
	`ucwÜds
(
	`im¶ode
(' ', 
$¬¿y
));

352  
$g»ekšg
;

353 
	}
}

355 
funùiÚ
 
	$dev–_g’”©e_add_‹rms
(&
$node
) {

356 
$voÿbs
 = 
	`xÚomy_g‘_voÿbuÏr›s
(
$node
->
ty³
);

357 
	`fÜ—ch
 (
$voÿbs
 
as
 
$voÿb
) {

358 
$sql
 = "SELECTid FROM {term_data} WHERE vid = %d ORDER BY RAND()";

359 
$»suÉ
 = 
	`db_qu”y_¿nge
(
$sql
, 
$voÿb
->
vid
, 0, 5);

360 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

361 
$node
->
xÚomy
[] = 
$row
->
tid
;

362 ià(!
$voÿb
->
muÉË
) {

367 
	}
}

369 
funùiÚ
 
	$dev–_g‘_u£rs
() {

370 
$u£rs
 = 
	`¬¿y
();

371 
$»suÉ
 = 
	`db_qu”y_¿nge
("SELECT uid FROM {users}", 0, 50);

372 
$u£r
 = 
	`db_ãtch_objeù
(
$»suÉ
)){

373 
$u£rs
[] = 
$u£r
->
uid
;

375  
$u£rs
;

376 
	}
}

378 
funùiÚ
 
	$dev–_g’”©e_add_u¶ßd
(&
$node
) {

379 
$sourû
 = 'misc/blog.png';

380 
$size
 = 
	`fesize
(
$sourû
);

383 
	`fe_cİy
(
$sourû
);

384 
$fe
 = 
Ãw
 
	`¡dCÏss
();

385 
$fe
->
f’ame
 = 'blog.png';

386 
$fe
->
f•©h
 = 
$sourû
;

387 
$fe
->
femime
 = 'image/png';

388 
$fe
->
li¡
 = 
	`v¬ŸbË_g‘
('u¶ßd_li¡_deçuÉ', 
TRUE
);

389 
$fe
->
desütiÚ
 = 'b†og.png was here';

390 
$fe
->
fesize
 = 
$size
;

391 
$fe
->
weight
 = 
	`mt_¿nd
(0,10);

392 
$fe
->
Ãw
 = 
TRUE
;

395 
	`db_qu”y
("INSERT INTO {fes} (uid, f’ame, f•©h, femime, fesize, stus,ime¡ampèVALUES (%d, '%s', '%s', '%s', %d, %d, %d)", 
$node
->
uid
, 
$fe
->
f’ame
, $fe->
f•©h
, $fe->
femime
, $fe->
fesize
, 
FILE_STATUS_TEMPORARY
, 
	`time
());

396 
$fe
->
fid
 = 
	`db_Ï¡_š£¹_id
('files', 'fid');

397 
$node
->
fes
[
$fe
->
fid
] = $file;

398 
	}
}

406 
funùiÚ
 
	$dev–_g’”©e_add_¡©i¡ics
(
$node
) {

407 
$tÙ®couÁ
 = 
	`mt_¿nd
(0, 500);

408 
$daycouÁ
 = 
	`mt_¿nd
(0, 
$tÙ®couÁ
);

409 
$time¡amp
 = 
	`time
(è- 
	`mt_¿nd
(0, 
$node
->
ü—‹d
);

410 
	`db_qu”y
('INSERT INTO {node_couÁ”} (nid, daycouÁ,Ù®couÁ,ime¡ampèVALUES (%d, %d, %d, %d)', 
$node
->
nid
, 
$daycouÁ
, 
$tÙ®couÁ
, 
$time¡amp
);

411 
	}
}

420 
funùiÚ
 
	$dev–_g’”©e_cÚ‹Á_kl
(
$»suÉs
) {

421 
$sql
 = 'SELECT‚id FROM {node} WHEREy³ IN ('. 
	`db_¶aûhŞd”s
(
$»suÉs
['node_types'], 'text'). ')';

422 
$»suÉ
 = 
	`db_qu”y
(
$sql
, 
$»suÉs
['node_types']);

423 
$i
=0;

424 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

425 
	`node_d–‘e
(
$row
->
nid
);

426 
$i
++;

428 
	`dru·l_£t_mes§ge
(
	`fÜm©_¶u¿l
(
$i
, 'Deleted one…ost', 'Deleted @count…osts'));

429 
	}
}

439 
funùiÚ
 
	$dev–_g’”©e_cÚ‹Á_´e_node
(&
$»suÉs
) {

441 
$u£rs
 = 
	`dev–_g‘_u£rs
();

442 
$u£rs
 = 
	`¬¿y_m”ge
($u£rs, 
	`¬¿y
('0'));

443 
$»suÉs
['u£rs'] = 
$u£rs
;

444 
	}
}

453 
funùiÚ
 
	$dev–_g’”©e_cÚ‹Á_add_node
(&
$»suÉs
) {

455 
$node
->
ty³
 = 
	`¬¿y_¿nd
(
$»suÉs
['node_types']);

456 
	`moduË_lßd_šşude
('inc', 'node', 'node.pages');

457 
$ty³
 = 
	`node_g‘_ty³s
('ty³', 
$node
->
ty³
);

458 
	`node_objeù_´•¬e
(
$node
);

459 
$u£rs
 = 
$»suÉs
['users'];

460 
$node
->
uid
 = 
$u£rs
[
	`¬¿y_¿nd
($users)];

462 
$node
->
t™Ë
 = 
	`dev–_ü—‹_g»ekšg
(
	`mt_¿nd
(1, 
$»suÉs
['t™Ë_Ëngth']), 
TRUE
);

463 ià(
$ty³
->
has_body
) {

464 
$node
->
body
 = "nod($node->ty³è- ". 
	`dev–_ü—‹_cÚ‹Á
();

465 
$node
->
‹a£r
 = 
	`node_‹a£r
($node->
body
);

466 
$node
->
f‹r
 = 
	`v¬ŸbË_g‘
('filter_default_format', 1);

467 
$node
->
fÜm©
 = 
FILTER_FORMAT_DEFAULT
;

469 
$node
->
Ïnguage
 = '';

470 
$node
->
»visiÚ
 = 
	`mt_¿nd
(0,1);

471 
$node
->
´omÙe
 = 
	`mt_¿nd
(0, 1);

472 
$node
->
ü—‹d
 = 
	`time
(è- 
	`mt_¿nd
(0, 
$»suÉs
['time_range']);

475 
$node
->
dev–_g’”©e
 = 
$»suÉs
;

477 
	`node_§ve
(
$node
);

479 
	}
}

481 
funùiÚ
 
	$dev–_g’”©e_nod—pi
(&
$node
, 
$İ
, 
$a3
 = 
NULL
, 
$a4
 = NULL) {

482 ià(
	`is£t
(
$node
->
dev–_g’”©e
)) {

483 
$»suÉs
 = 
$node
->
dev–_g’”©e
;

484 
$İ
) {

488 ià(
$»suÉs
['add_upload']) {

489 
	`dev–_g’”©e_add_u¶ßd
(
$node
);

492 ià(
$»suÉs
['add_terms']) {

493 
	`dev–_g’”©e_add_‹rms
(
$node
);

495 ià(
	`is£t
(
$»suÉs
['add_Ïnguage']è&& 
	`v¬ŸbË_g‘
('Ïnguage_cÚ‹Á_ty³_' . 
$node
->
ty³
, 0)) {

496 
$Ïnguages
 = 
	`¬¿y_keys
(
$»suÉs
['add_language']);

497 
$node
->
Ïnguage
 = 
$Ïnguages
[
	`¬¿y_¿nd
($languages)];

501 ià(
$»suÉs
['max_comments']) {

502 
	`dev–_g’”©e_add_comm’ts
(
$node
, 
$»suÉs
['users'], $results['max_comments'], $results['title_length']);

506 ià(
$»suÉs
['add_alias']) {

507 
	`·th_£t_®Ÿs
("node/$node->nid", "node-$node->nid-$node->type");

511 ià(
$»suÉs
['add_statistics']) {

512 
	`dev–_g’”©e_add_¡©i¡ics
(
$node
);

517 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/devel/devel_generate.module

1 <?
php


4 
»quœe_Úû
('devel_generate_batch.inc');

9 
funùiÚ
 
	$dev–_g’”©e_m’u
() {

10 
$™ems
 = 
	`¬¿y
();

13 
$™ems
['admš/g’”©e'] = 
	`¬¿y
(

18 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

20 'f·th' => 
	`dru·l_g‘_·th
('module', 'system'),

22 
$™ems
['admš/g’”©e/u£r'] = 
	`¬¿y
(

26 '·g¬gum’ts' => 
	`¬¿y
('devel_generate_users_form'),

27 'acûs ¬gum’ts' => 
	`¬¿y
('administer users'),

29 
$™ems
['admš/g’”©e/cÚ‹Á'] = 
	`¬¿y
(

33 '·g¬gum’ts' => 
	`¬¿y
('devel_generate_content_form'),

34 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚odes'),

36 ià(
	`moduË_exi¡s
('taxonomy')) {

37 
$™ems
['admš/g’”©e/xÚomy'] = 
	`¬¿y
(

41 '·g¬gum’ts' => 
	`¬¿y
('devel_generate_taxonomy_form'),

42 'acûs ¬gum’ts' => 
	`¬¿y
('administer‚odes'),

46  
$™ems
;

47 
	}
}

49 
funùiÚ
 
	$dev–_g’”©e_u£rs_fÜm
() {

50 
$fÜm
['num'] = 
	`¬¿y
(

52 '#t™Ë' => 
	`t
('How many users would you†ikeo generate?'),

56 
$fÜm
['kl_u£rs'] = 
	`¬¿y
(

58 '#t™Ë' => 
	`t
('Delete‡ll users (except user id 1) before generating‚ew users.'),

59 '#deçuÉ_v®ue' => 
FALSE
,

62 
$İtiÚs
 = 
	`¬¿y
(1 => 
	`t
('Now'));

63 
	`fÜ—ch
 (
	`¬¿y
(3600, 86400, 604800, 2592000, 31536000è
as
 
$š‹rv®
) {

64 
$İtiÚs
[
$š‹rv®
] = 
	`fÜm©_š‹rv®
($š‹rv®, 1è. ' ' . 
	`t
('ago');

66 
$fÜm
['time_¿nge'] = 
	`¬¿y
(

68 '#t™Ë' => 
	`t
('How old should user‡ccounts be?'),

69 '#desütiÚ' => 
	`t
('User‡ges will be distributed„andomly fromhe currentime, backohe selectedime.'),

70 '#İtiÚs' => 
$İtiÚs
,

74 
$fÜm
['subm™'] = 
	`¬¿y
(

76 '#v®ue' => 
	`t
('Do it!'),

78  
$fÜm
;

79 
	}
}

81 
funùiÚ
 
	$dev–_g’”©e_u£rs_fÜm_subm™
(
$fÜm_id
, &
$fÜm_¡©e
) {

82 
	`moduË_lßd_šşude
('inc', 'devel_generate');

83 
	`dev–_ü—‹_u£rs
(
$fÜm_¡©e
['values']['num'], $form_state['values']['kill_users'], $form_state['values']['time_range']);

84 
	}
}

86 
funùiÚ
 
	$dev–_g’”©e_cÚ‹Á_fÜm
() {

87 
	`»quœe_Úû
('devel_generate.inc');

88 
$İtiÚs
 = 
	`dev–_g’”©e_cÚ‹Á_ty³s
();

90 ià(
	`em±y
(
$İtiÚs
)) {

91 
	`dru·l_£t_mes§ge
(
	`t
('You dØnÙ havªy cÚ‹Áy³ th© cª bg’”©ed. <¨h»f="@ü—‹-ty³">GØü—‹‡‚ew cÚ‹Áy³</a>‡Ì—dy!</a>', 
	`¬¿y
('@ü—‹-ty³' => 
	`u¾
('admš/cÚ‹Á/ty³s/add'))), '”rÜ', 
FALSE
);

95 
$fÜm
['node_ty³s'] = 
	`¬¿y
(

97 '#t™Ë' => 
	`t
('Which‚odeypes do you wanto create?'),

98 '#İtiÚs' => 
$İtiÚs
,

99 '#deçuÉ_v®ue' => 
	`¬¿y_keys
(
$İtiÚs
),

101 
$fÜm
['kl_cÚ‹Á'] = 
	`¬¿y
(

103 '#t™Ë' => 
	`t
('<strong>Delete‡ll content</strong> inhese‚odeypes before generating‚ew content.'),

104 '#deçuÉ_v®ue' => 
FALSE
,

106 
$fÜm
['num_nodes'] = 
	`¬¿y
(

108 '#t™Ë' => 
	`t
('How many‚odes would you†ikeo generate?'),

113 
$İtiÚs
 = 
	`¬¿y
(1 => 
	`t
('Now'));

114 
	`fÜ—ch
 (
	`¬¿y
(3600, 86400, 604800, 2592000, 31536000è
as
 
$š‹rv®
) {

115 
$İtiÚs
[
$š‹rv®
] = 
	`fÜm©_š‹rv®
($š‹rv®, 1è. ' ' . 
	`t
('ago');

117 
$fÜm
['time_¿nge'] = 
	`¬¿y
(

119 '#t™Ë' => 
	`t
('How far back inime shouldhe‚odes be dated?'),

120 '#desütiÚ' => 
	`t
('Node creation dates will be distributed„andomly fromhe currentime, backohe selectedime.'),

121 '#İtiÚs' => 
$İtiÚs
,

125 
$fÜm
['max_comm’ts'] = 
	`¬¿y
(

127 '#t™Ë' => 
	`t
('Maximum‚umber of generated comments…er‚ode'),

128 '#desütiÚ' => 
	`t
('You must‡lsoƒnable comments forhe‚odeypes you‡re generating.'),

131 '#acûss' => 
	`moduË_exi¡s
('comment'),

133 
$fÜm
['t™Ë_Ëngth'] = 
	`¬¿y
(

135 '#t™Ë' => 
	`t
('Max word†ength ofitles'),

139 
$fÜm
['add_u¶ßd'] = 
	`¬¿y
(

141 '#di§bËd' => !
	`moduË_exi¡s
('upload'),

142 '#desütiÚ' => 
	`t
('Requires upload.module'),

143 '#t™Ë' => 
	`t
('Add‡n uploadoƒach‚ode'),

144 '#deçuÉ_v®ue' => 
FALSE
,

146 
$fÜm
['add_‹rms'] = 
	`¬¿y
(

147 '#di§bËd' => !
	`moduË_exi¡s
('taxonomy'),

148 '#desütiÚ' => 
	`t
('Requiresaxonomy.module'),

150 '#t™Ë' => 
	`t
('Addaxonomyermsoƒach‚ode.'),

151 '#deçuÉ_v®ue' => 
FALSE
,

153 
$fÜm
['add_®Ÿs'] = 
	`¬¿y
(

155 '#di§bËd' => !
	`moduË_exi¡s
('path'),

156 '#desütiÚ' => 
	`t
('Requires…ath.module'),

157 '#t™Ë' => 
	`t
('Add‡n url‡lias forƒach‚ode.'),

158 '#deçuÉ_v®ue' => 
FALSE
,

160 
$fÜm
['add_¡©i¡ics'] = 
	`¬¿y
(

162 '#t™Ë' => 
	`t
('Generate‚ode view statistics (node_counterable).'),

163 '#deçuÉ_v®ue' => 
TRUE
,

164 '#acûss' => 
	`moduË_exi¡s
('statistics'),

166 ià(
	`moduË_exi¡s
('locale')) {

167 
$fÜm
['add_Ïnguage'] = 
	`¬¿y
(

169 '#t™Ë' => 
	`t
('Set†anguage on‚odes'),

170 '#muÉË' => 
TRUE
,

171 '#desütiÚ' => 
	`t
('Requires†ocale.module'),

172 '#İtiÚs' => 
	`¬¿y_m”ge
(
	`¬¿y
('' => 
	`t
('LªguagÃuŒ®')), 
	`loÿË_Ïnguage_li¡
()),

176 
$fÜm
['subm™'] = 
	`¬¿y
(

178 '#v®ue' => 
	`t
('Do it!'),

180 
$fÜm
['#»dœeù'] = 
FALSE
;

182  
$fÜm
;

183 
	}
}

185 
funùiÚ
 
	$dev–_g’”©e_cÚ‹Á_fÜm_subm™
(
$fÜm_id
, &
$fÜm_¡©e
) {

186 
$fÜm_¡©e
['v®ues']['node_ty³s'] = 
	`¬¿y_f‹r
($form_state['values']['node_types']);

187 ià(!
$fÜm_¡©e
['values']['kill_content'] && $form_state['values']['num_nodes'] <= 50 && $form_state['values']['max_comments'] <= 10) {

188 
	`»quœe_Úû
('devel_generate.inc');

189 
	`dev–_g’”©e_cÚ‹Á
(
$fÜm_¡©e
);

192 
	`dev–_b©ch_g’”©e_cÚ‹Á
(
$fÜm_¡©e
);

194 
	}
}

196 
funùiÚ
 
	$dev–_g’”©e_xÚomy_fÜm
() {

197 
$fÜm
['num_voÿb'] = 
	`¬¿y
(

199 '#t™Ë' => 
	`t
('How many vocabularies would you†ikeo generate?'),

203 
$fÜm
['num_‹rms'] = 
	`¬¿y
(

205 '#t™Ë' => 
	`t
('How manyerms would you†ikeo generate?'),

209 
$fÜm
['t™Ë_Ëngth'] = 
	`¬¿y
(

211 '#t™Ë' => 
	`t
('Max word†ength oferm/vocab‚ames'),

215 
$fÜm
['kl_xÚomy'] = 
	`¬¿y
(

217 '#t™Ë' => 
	`t
('Deleteƒxistingerms‡nd vocabularies before generating‚ew content.'),

218 '#deçuÉ_v®ue' => 
FALSE
,

220 
$fÜm
['subm™'] = 
	`¬¿y
(

222 '#v®ue' => 
	`t
('Do it!'),

224  
$fÜm
;

225 
	}
}

227 
funùiÚ
 
	$dev–_g’”©e_xÚomy_fÜm_subm™
(
$fÜm_id
, &
$fÜm_¡©e
) {

228 
	`»quœe_Úû
('devel_generate.inc');

229 
	`dev–_g’”©e_xÚomy_d©a
(
$fÜm_¡©e
['values']['num_vocab'], $form_state['values']['num_terms'], $form_state['values']['title_length'], $form_state['values']['kill_taxonomy']);

230 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/devel/devel_generate_batch.inc

1 <?
php


13 
funùiÚ
 
	$dev–_b©ch_g’”©e_cÚ‹Á
(
$fÜm_¡©e
) {

14 
$İ”©iÚs
 = 
	`¬¿y
();

17 
$İ”©iÚs
[] = 
	`¬¿y
('dev–_g’”©e_b©ch_cÚ‹Á_´e_node',‡¼ay(
$fÜm_¡©e
['values']));

20 ià(
$fÜm_¡©e
['values']['kill_content']) {

21 
$İ”©iÚs
[] = 
	`¬¿y
('devel_generate_batch_content_kill',‡rray());

25 
$num
 = 0; $num < 
$fÜm_¡©e
['values']['num_nodes']; $num ++) {

26 
$İ”©iÚs
[] = 
	`¬¿y
('devel_generate_batch_content_add_node',‡rray());

30 
$b©ch
 = 
	`¬¿y
(

31 't™Ë' => 
	`t
('Generating Content'),

32 'İ”©iÚs' => 
$İ”©iÚs
,

34 'fe' => 
	`dru·l_g‘_·th
('module', 'devel_generate') . '/devel_generate_batch.inc',

36 
	`b©ch_£t
(
$b©ch
);

37 
	}
}

43 
funùiÚ
 
	$dev–_g’”©e_b©ch_cÚ‹Á_kl
(&
$cÚ‹xt
) {

44 
	`»quœe_Úû
('devel_generate.inc');

45 
	`dev–_g’”©e_cÚ‹Á_kl
(
$cÚ‹xt
['results']);

46 
	}
}

48 
funùiÚ
 
	$dev–_g’”©e_b©ch_cÚ‹Á_´e_node
(
$v¬s
, &
$cÚ‹xt
) {

49 
$cÚ‹xt
['»suÉs'] = 
$v¬s
;

50 
$cÚ‹xt
['results']['num_nids'] = 0;

51 
	`»quœe_Úû
('devel_generate.inc');

52 
	`dev–_g’”©e_cÚ‹Á_´e_node
(
$cÚ‹xt
['results']);

53 
	}
}

55 
funùiÚ
 
	$dev–_g’”©e_b©ch_cÚ‹Á_add_node
(&
$cÚ‹xt
) {

56 
	`»quœe_Úû
('devel_generate.inc');

57 
	`dev–_g’”©e_cÚ‹Á_add_node
(
$cÚ‹xt
['results']);

58 
$cÚ‹xt
['results']['num_nids'] ++;

59 
	}
}

61 
funùiÚ
 
	$dev–_g’”©e_b©ch_fšished
(
$sucûss
, 
$»suÉs
, 
$İ”©iÚs
) {

62 ià(
$sucûss
) {

63 
$mes§ge
 = 
	`t
('Fšished @num_nid node ü—‹d sucûssfuÎy.', 
	`¬¿y
('@num_nids' => 
$»suÉs
['num_nids']));

66 
$mes§ge
 = 
	`t
('Finished with‡nƒrror.');

68 
	`dru·l_£t_mes§ge
(
$mes§ge
);

69 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/devel/devel_node_access.module

1 <?
php


12 
defše
('DNA_ACCESS_VIEW', 'view devel_node_access information');

14 
funùiÚ
 
	$dev–_node_acûss_³rm
() {

15  
	`¬¿y
('view devel_node_access information');

16 
	}
}

21 
funùiÚ
 
	$dev–_node_acûss_h–p
(
$·th
, 
$¬g
) {

22 
$·th
) {

24  
	`t
('Development helper for‚ode_accessable');

27 
$ouut
 = '<p>'. 
	`t
('This module helps in site development. Specifically, when‡n‡ccess control module is usedo†imit‡ccesso some or‡ll‚odes,his module…rovides some feedback showinghe‚ode_accessable inhe database.') ."</p>\n";

28 
$ouut
 .ğ'<p>'. 
	`t
('The‚ode_accessable is one method Drupal…rovideso hide content from some users while displaying ito others. By default, Drupal shows‡ll‚odeso‡ll users. There‡re‡‚umber of optional modules which may be installedo hide content from some users.') ."</p>\n";

29 
$ouut
 .ğ'<p>'. 
	`t
('If you have‚ot installed‡ny ofhese modules, you„eally have‚o‚eed forhe devel_node_access module. This module is intended for use during development, sohat developers‡nd‡dmins can confirmhathe‚ode_accessable is working‡sƒxpected. You…robably do‚ot wanthis moduleƒnabled on‡…roduction site.') ."</p>\n";

30 
$ouut
 .ğ'<p>'. 
	`t
('This module…rovideswo blocks. One called Devel Node Access by User is visible when‡ single‚ode is shown on‡…age. This block shows which users can view, update or deletehe‚ode shown. Notehathis block uses‡n inefficient‡lgorithmo…roduce its output. You should onlyƒnablehis block on sites with very few user‡ccounts.') ."</p>\n";

31 
$ouut
 .ğ'<p>'. 
	`t
('The second block…rovided byhis module showsheƒntries inhe‚ode_accessable for‡ny‚odes shown onhe current…age. You canƒnablehe debug mode onhe <a href="@settings_page">settings…age</a>o display much more information, buthis can cause considerable overhead. Becauseheables shown‡re wide, it is„ecommendedoƒnablehe blocks inhe…age footer„atherhan‡ sidebar.',

32 
	`¬¿y
('@£‰šgs_·ge' => 
	`u¾
('admin/settings/devel',‡rray('fragment' => 'edit-devel-node-access-debug-mode')))

34 
$ouut
 .ğ'<p>'. 
	`t
('This module‡lso…rovides‡ <a href="@summary_page">summary…age</a> which shows general information‡bout your‚ode_accessable. If you have installedhe Views module, you may browse‚ode_access by„ealm.',

35 
	`¬¿y
('@summ¬y_·ge' => 
	`u¾
('devel/node_access/summary'))

37  
$ouut
;

39 
	}
}

41 
funùiÚ
 
	$dev–_node_acûss_m’u
() {

42 
$™ems
 = 
	`¬¿y
();

45 
$™ems
['dev–/node_acûss/summ¬y'] = 
	`¬¿y
(

48 'acûs ¬gum’ts' => 
	`¬¿y
(
DNA_ACCESS_VIEW
),

52 ià(!
	`moduË_exi¡s
('devel')) {

53 
$™ems
['admš/£‰šgs/dev–'] = 
	`¬¿y
(

57 '·g¬gum’ts' => 
	`¬¿y
('devel_node_access_admin_settings'),

58 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

59 'ty³' => 
MENU_NORMAL_ITEM


63  
$™ems
;

64 
	}
}

66 
funùiÚ
 
	$dev–_node_acûss_admš_£‰šgs
() {

67 
$fÜm
 = 
	`¬¿y
();

68  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

69 
	}
}

71 
funùiÚ
 
	$dev–_node_acûss_fÜm_®‹r
(&
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
) {

72 
$Œ
 = 't';

73 ià(
$fÜm_id
 == 'devel_admin_settings' || $form_id == 'devel_node_access_admin_settings') {

74 
$fÜm
['dev–_node_acûss_debug_mode'] = 
	`¬¿y
(

76 '#t™Ë' => 
	`t
('Devel Node Access debug mode'),

77 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('dev–_node_acûss_debug_mode', 
FALSE
),

78 '#desütiÚ' => 
	`t
('Debug modv”if› thg¿Á„ecÜd šhnode_acûs bË‡gaš¡ho£h© would b£ˆby„uÂšg !Rebud_³rmissiÚs,‡nd di¥Ïy them‡Î;hi ÿÀÿu£ cÚsid”abË ov”h—d.', 
	`¬¿y
('!Rebud_³rmissiÚs' => 
	`l
('['. 
	`$Œ
('Rebuild…ermissions') .']', 'admin/content/node-settings'))),

81 
$fÜm
['devel_error_handler']['#weight'] = 1;

82 
$fÜm
['smtp_library']['#weight'] = 1;

83 
$fÜm
['buttons']['#weight'] = 2;

85 
	}
}

87 
funùiÚ
 
	$dÇ_summ¬y
() {

89 
$ouut
 = '';

90 
$»suÉ
 = 
	`db_qu”y
('SELECT DISTINCT„ealm FROM {node_access} WHERE‚id=0 AND gid=0');

91 
$rows
 = 
	`¬¿y
();

92 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

93 
$rows
[] = 
	`¬¿y
(
$row
->
»®m
);

95 ià(!
	`em±y
(
$rows
)) {

96 
$ouut
 .ğ'<h3>'. 
	`t
('Access Grantedo All Nodes (All Users)') ."</h3>\n";

97 
$ouut
 .ğ'<p>'. 
	`t
('Your‚ode_accessable containsƒntrieshat may be granting‡ll users‡ccesso‡ll‚odes. Depending on which‡ccess control module(s) you use, you may wanto deleteheseƒntries. If you‡re‚ot using‡n‡ccess control module, you should…robably†eaveheseƒntries‡s is.') ."</p>\n";

98 
$h—d”s
 = 
	`¬¿y
(
	`t
('realm'));

99 
$ouut
 .ğ
	`theme
('bË', 
$h—d”s
, 
$rows
);

100 
$acûss_g¿Áed_to_®l_nodes
 = 
TRUE
;

104 
$»suÉ
 = 
	`db_ãtch_objeù
(
	`db_qu”y
('SELECT COUNT(n.nid) AS‚um_nodes FROM {node}‚ LEFT JOIN {node_access}‚a ON‚.nid =‚a.nid WHERE‚a.nid IS NULL'));

105 ià(
$num
 = 
$»suÉ
->
num_nodes
) {

106 
$ouut
 .ğ'<h3>'. 
	`t
('Legacy Nodes') ."</h3>\n";

107 
$ouut
 .= '<p>'.

108 
	`t
('You hav!num‚ode š you¸nodbË which‡»‚Ù„•»£Áed iÀyou¸node_acûs bË. Iàyou havª‡cûs cÚŒŞ moduË in¡®Ëd,he£‚ode may bhidd’ from‡Î u£rs. Thi could bÿu£d by…ublishšg‚ode befÜ’ablšghacûs cÚŒŞ moduË. Iàthi i thÿ£, mªu®ly upd©šgƒach‚odshould‡dd iˆtØthnode_acûs bË‡nd fixh´obËm.', 
	`¬¿y
('!num' => 
	`l
(
$num
, 'devel/node_access/view/NULL')))

110 ià(!
	`em±y
(
$acûss_g¿Áed_to_®l_nodes
)) {

111 
$ouut
 .= '<p>'.

112 
	`t
('This issue may be masked byhe one‡bove, so†ook intohe former first.')

117 
$ouut
 .ğ'<h3>'. 
	`t
('All Nodes Represented') ."</h3>\n";

118 
$ouut
 .ğ'<p>'. 
	`t
('All‚odes‡re„epresented inhe‚ode_accessable.') ."</p>\n";

123 
$»suÉ
 = 
	`db_qu”y
('SELECT DISTINCT„ealm FROM {node_access} WHERE‚id = 0 AND gid <> 0');

124 
$rows
 = 
	`¬¿y
();

125 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

126 
$rows
[] = 
	`¬¿y
(
$row
->
»®m
);

128 ià(!
	`em±y
(
$rows
)) {

129 
$ouut
 .ğ'<h3>'. 
	`t
('Access Grantedo All Nodes (Some Users)') ."</h3>\n";

130 
$ouut
 .ğ'<p>'. 
	`t
('Your‚ode_accessable containsƒntrieshat may be granting some users‡ccesso‡ll‚odes. This may be…erfectly‚ormal, depending on which‡ccess control module(s) you use.') ."</p>\n";

131 
$h—d”s
 = 
	`¬¿y
(
	`t
('realm'));

132 
$ouut
 .ğ
	`theme
('bË', 
$h—d”s
, 
$rows
);

137 
$»suÉ
 = 
	`db_qu”y
('SELECT DISTINCT„ealm, COUNT(DISTINCT‚id)‡s‚ode_count FROM {node_access} WHERE gid = 0 AND‚id > 0 GROUP BY„ealm');

138 
$rows
 = 
	`¬¿y
();

139 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

140 
$rows
[] = 
	`¬¿y
(
$row
->
»®m
,

141 
	`¬¿y
('d©a' => 
$row
->
node_couÁ
,

144 ià(!
	`em±y
(
$rows
)) {

145 
$ouut
 .ğ'<h3>'. 
	`t
('Access Grantedo Some Nodes') ."</h3>\n";

146 
$ouut
 .= '<p>'.

147 
	`t
('The following„ealms‡ppearo grant‡ll users‡ccesso some specific‚odes. This may be…erfectly‚ormal, if some of your content is‡vailableohe…ublic.')

149 
$h—d”s
 = 
	`¬¿y
(
	`t
('realm'),('public‚odes'));

150 
$ouut
 .ğ
	`theme
('bË', 
$h—d”s
, 
$rows
, 
	`¬¿y
(), 
	`t
('Public Nodes'));

155 
$»suÉ
 = 
	`db_qu”y
('SELECT DISTINCT„ealm, COUNT(DISTINCT‚id)‡s‚ode_count FROM {node_access} WHERE gid <> 0 AND‚id > 0 GROUP BY„ealm');

156 
$rows
 = 
	`¬¿y
();

157 
$row
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

160 
$rows
[] = 
	`¬¿y
(
$row
->
»®m
,

161 
	`¬¿y
('d©a' => 
$row
->
node_couÁ
,

164 ià(!
	`em±y
(
$rows
)) {

165 
$ouut
 .ğ'<h3>'. 
	`t
('Summary by Realm') ."</h3>\n";

166 
$ouut
 .ğ'<p>'. 
	`t
('The following„ealms grant†imited‡ccesso some specific‚odes.') ."</p>\n";

167 
$h—d”s
 = 
	`¬¿y
(
	`t
('realm'),('private‚odes'));

168 
$ouut
 .ğ
	`theme
('bË', 
$h—d”s
, 
$rows
, 
	`¬¿y
(), 
	`t
('Protected Nodes'));

171  
$ouut
;

172 
	}
}

174 
funùiÚ
 
	$dÇ_visibË_nodes
(
$nid
 = 
NULL
) {

175 
$nids
 = 
	`¬¿y
();

176 ià(
$nid
) {

177 
$nids
[
$nid
] = $nid;

179  
$nids
;

180 
	}
}

182 
funùiÚ
 
	$dev–_node_acûss_nod—pi
(&
$node
, 
$İ
, 
$‹a£r
 = 
NULL
, 
$·ge
 = NULL) {

183 ià(
$İ
 == 'view') {

185 
	`dÇ_visibË_nodes
(
$node
->
nid
);

187 
	}
}

189 
funùiÚ
 
	$_dev–_node_acûss_moduË_švoke_®l
() {

190 
$¬gs
 = 
	`func_g‘_¬gs
();

191 
$hook
 = 
	`¬¿y_shiá
(
$¬gs
);

192 
$»tuº
 = 
	`¬¿y
();

193 
	`fÜ—ch
 (
	`moduË_im¶em’ts
(
$hook
è
as
 
$moduË
) {

194 
$funùiÚ
 = 
$moduË
 .'_'. 
$hook
;

195 
$»suÉ
 = 
	`ÿÎ_u£r_func_¬¿y
(
$funùiÚ
, 
$¬gs
);

196 ià(
	`is£t
(
$»suÉ
)) {

197 ià(
	`is_¬¿y
(
$»suÉ
)) {

198 
	`fÜ—ch
 (
$»suÉ
 
as
 
$key
 => 
$v®ue
) {

200 
$»suÉ
[
$key
]['#moduË'] = 
$moduË
;

205 
$»suÉ
 = 
	`¬¿y
(
$moduË
 => $result);

207 
$»tuº
 = 
	`¬¿y_m”ge
($»tuº, 
$»suÉ
);

210  
$»tuº
;

211 
	}
}

213 
funùiÚ
 
dev–_node_acûss_block
(
$İ
 = 'li¡', 
$d–
 = 0) {

214 
glob®
 
$u£r
;

215 
glob®
 
	g$theme_key
;

216 
	g$block1_visibË
, 
	g$hšt
 = '';

217 ià(!
is£t
(
$block1_visibË
)) {

218 
	g$block1_visibË
 = 
db_»suÉ
(
db_qu”y
("SELECT stu FROM {blocks} WHERE moduË = 'dev–_node_acûss' AND d– = '1' ANDhemğ'%s'", 
$theme_key
));

219 ià(!
	g$block1_visibË
) {

220 
	g$hšt
 = 
t
('FÜ…”-u£¸acûs ³rmissiÚ ’abËh£cÚd DNA <¨h»f="@block">block</a>.', 
¬¿y
('@block' => 
u¾
('admin/build/block')));

224 
	g$İ
) {

226 
$blocks
[0]['šfo'] = 
t
('Devel Node Access');

227 
	g$blocks
[0]['status'] = 1;

228 
	g$blocks
[0]['region'] = 'footer';

229 
	g$blocks
[1]['šfo'] = 
t
('Devel Node Access by User');

230 
	g$blocks
[1]['status'] = 0;

231 
	g$blocks
[1]['region'] = 'footer';

232  
	g$blocks
;

235 ià(!
u£r_acûss
(
DNA_ACCESS_VIEW
)) {

238 
	g$d–
) {

240 ià(!
couÁ
(
dÇ_visibË_nodes
())) {

245 
	g$nids
 = 
¬¿y_m”ge
(
¬¿y
(0 => 0), 
dÇ_visibË_nodes
());

246 
	g$»suÉ
 = 
db_qu”y
('SELECT‚a.*,‚.t™Ë FROM {node_acûss}‚¨LEFT JOIN {node}‚ ON‚.nid =‚a.nid WHERE‚a.nid IN ('. 
db_¶aûhŞd”s
(
$nids
) .') ORDER BY‚a.nid,‚a.realm,‚a.gid', $nids);

248 ià(!
v¬ŸbË_g‘
('dev–_node_acûss_debug_mode', 
FALSE
)) {

249 
	g$h—d”s
 = 
¬¿y
(
t
('node'),('realm'),('gid'),('view'),('update'),('delete'),('explained'));

250 
	g$rows
 = 
¬¿y
();

251 
	g$row
 = 
db_ãtch_objeù
(
$»suÉ
)) {

252 
$ex¶ašed
 = 
moduË_švoke_®l
('node_acûss_ex¶aš', 
$row
);

253 
	g$rows
[] = 
¬¿y
('<¨h»f="#node-'. 
$row
->
nid
 .'">'. 
_dev–_node_acûss_g‘_node_t™Ë
($row, 
TRUE
) .'</a>',

254 
$row
->
»®m
,

255 
$row
->
gid
,

256 
$row
->
g¿Á_v›w
,

257 
$row
->
g¿Á_upd©e
,

258 
$row
->
g¿Á_d–‘e
,

259 
im¶ode
('<b¸/>', 
$ex¶ašed
));

261 
	g$ouut
 = 
theme
('bË', 
$h—d”s
, 
$rows
, 
¬¿y
('style' => 'text-align:†eft'));

262 
	g$hšt
 = 
t
('TØ£mÜd‘a ’abË <¨h»f="@debug_mode">debug mode</a>.', 
¬¿y
('@debug_mode' => 
u¾
('admš/£‰šgs/dev–',‡¼ay('äagm’t' => 'ed™-dev–-node-acûss-debug-mode')))è.' '. 
$hšt
;

265 
	g$Œ
 = 't';

266 
	g$v¬ŸbËs
 = 
¬¿y
('!na' => '{node_access}');

267 
	g$¡©es
 = 
¬¿y
(

268 'deçuÉ' => 
¬¿y
(
t
('deçuÉ'), 'ok',('DeçuÉ g¿Á suµl›d by cÜšhab£nû oàªy oth”‚Ú-em±y g¿Ás, iÀ!Ç.', 
$v¬ŸbËs
)),

269 'ok' => 
¬¿y
(
t
('ok'), 'ok',('Highe¡…riÜ™y g¿Á, iÀ!Ç.', 
$v¬ŸbËs
)),

270 '¡©ic' => 
¬¿y
(
t
('¡©ic'), 'ok',('NÚ-¡ªd¬d g¿Á iÀ!Ç.', 
$v¬ŸbËs
)),

271 'uÃx³ùed' => 
¬¿y
(
t
('unexpected'), 'warning',('The 0/0/all/... grant‡pplieso‡ll‚odes‡nd‡ll users -- usually it should‚ot be…resent if‡ny‚ode‡ccess module is‡ctive!')),

272 'ignÜed' => 
¬¿y
(
t
('ignÜed'), 'w¬nšg',('Low”…riÜ™y g¿Á,‚Ù iÀ!Ç‡ndhu ignÜed.', 
$v¬ŸbËs
)),

273 'em±y' => 
¬¿y
(
t
('em±y'), 'w¬nšg',('DÛ nÙ g¿Á‡ny‡cûss, buˆcould block†ow”…riÜ™y g¿Ás;‚Ù iÀ!Ç.', 
$v¬ŸbËs
)),

274 'missšg' => 
¬¿y
(
t
('missšg'), '”rÜ',("Should bš !Ç buˆi¢'t!", 
$v¬ŸbËs
)),

275 'Ëg™im©e' => 
¬¿y
(
t
('Ëg™im©e'), '”rÜ',('Should NOT bš !Ç beÿu£ oàlow”…riÜ™y!', 
$v¬ŸbËs
)),

276 '®›n' => 
¬¿y
(
t
('®›n'), '”rÜ',('Should NOT bš !Ç beÿu£ oàunknowÀÜigš!', 
$v¬ŸbËs
)),

278 
	g$aùive_¡©es
 = 
¬¿y
('default', 'ok', 'static', 'unexpected', 'illegitimate', 'alien');

279 
	g$h—d”s
 = 
¬¿y
(
t
('node'),('prio'),('status'),('realm'),('gid'),('view'),('update'),('delete'),('explained'));

280 
	g$aùive_g¿Ás
 = 
¬¿y
();

281 
	g$aùive_g¿Á
 = 
db_ãtch_objeù
(
$»suÉ
)) {

282 
$aùive_g¿Ás
[
$aùive_g¿Á
->
nid
][$aùive_g¿Á->
»®m
][$aùive_g¿Á->
gid
] = $active_grant;

284 
	g$®l_g¿Ás
 = 
$checked_g¿Ás
 = 
$checked_¡©us
 = 
¬¿y
();

285 
fÜ—ch
 (
$nids
 
as
 
$nid
) {

286 
	g$acquœed_g¿Ás_nid
 = 
¬¿y
();

287 ià(
	g$node
 = 
node_lßd
(
$nid
)) {

289 
$g¿Ás
 = 
_dev–_node_acûss_moduË_švoke_®l
('node_acûss_»cÜds', 
$node
);

290 ià(!
em±y
(
$g¿Ás
)) {

291 
	g$tİ_´iÜ™y
 = 
NULL
;

292 
fÜ—ch
 (
$g¿Ás
 
as
 
$g¿Á
) {

293 
	g$´iÜ™y
 = 
štv®
(
$g¿Á
['priority']);

294 
	g$tİ_´iÜ™y
 = (
is£t
(
$tİ_´iÜ™y
è? 
max
($tİ_´iÜ™y, 
$´iÜ™y
) : $priority);

295 
	g$g¿Á
['´iÜ™y'] = (
is£t
(
$g¿Á
['´iÜ™y']è? 
$´iÜ™y
 : '&ndash;&nbsp;');

296 
	g$acquœed_g¿Ás_nid
[
$´iÜ™y
][
$g¿Á
['»®m']][$g¿Á['gid']] = $g¿Á + 
¬¿y
(

297 '#t™Ë' => 
_dev–_node_acûss_g‘_node_t™Ë
(
$node
),

298 '#moduË' => (
is£t
(
$g¿Á
['#module']) ? $grant['#module'] : ''),

301 
krsÜt
(
$acquœed_g¿Ás_nid
);

304 
	g$checked_¡©us
[
$nid
] = 
$node
->
¡©us
;

305 ià(
	g$node
->
	gnid
 && $node->
	g¡©us
) {

306 
fÜ—ch
 (
¬¿y
('v›w', 'upd©e', 'd–‘e'è
as
 
$İ
) {

307 
	g$checked_g¿Ás
[
$nid
][
$İ
] = 
¬¿y_m”ge
(

308 
¬¿y
('all' =>‡rray(0)),

309 
_dev–_node_acûss_moduË_švoke_®l
('node_g¿Ás', 
$u£r
, 
$İ
)

315 ià(
is£t
(
$aùive_g¿Ás
[
$nid
])) {

316 
fÜ—ch
 (
$aùive_g¿Ás
[
$nid
] 
as
 
$»®m
 => 
$aùive_g¿Ás_»®m
) {

317 
fÜ—ch
 (
$aùive_g¿Ás_»®m
 
as
 
$gid
 => 
$aùive_g¿Á
) {

318 
$found
 = 
FALSE
;

319 
	g$couÁ_nÚem±y_g¿Ás
 = 0;

320 
fÜ—ch
 (
$acquœed_g¿Ás_nid
 
as
 
$´iÜ™y
 => 
$acquœed_g¿Ás_nid_´iÜ™y
) {

321 ià(
is£t
(
$acquœed_g¿Ás_nid_´iÜ™y
[
$»®m
][
$gid
])) {

322 
$found
 = 
TRUE
;

325 ià(
	g$acquœed_g¿Ás_nid_´iÜ™y
 = 
»£t
(
$acquœed_g¿Ás_nid
)) {

326 
fÜ—ch
 (
$acquœed_g¿Ás_nid_´iÜ™y
 
as
 
$acquœed_g¿Ás_nid_´iÜ™y_»®m
) {

327 
fÜ—ch
 (
$acquœed_g¿Ás_nid_´iÜ™y_»®m
 
as
 
$acquœed_g¿Ás_nid_´iÜ™y_»®m_gid
) {

328 
$couÁ_nÚem±y_g¿Ás
 +ğ(!
em±y
(
$acquœed_g¿Ás_nid_´iÜ™y_»®m_gid
['grant_view']) || !empty($acquired_grants_nid_priority_realm_gid['grant_update']) || !empty($acquired_grants_nid_priority_realm_gid['grant_delete']));

332 
	g$fixed_g¿Á
 = (
¬¿y
è
$aùive_g¿Á
;

333 ià(
	g$couÁ_nÚem±y_g¿Ás
 =ğ0 && 
$»®m
 =ğ'®l' && 
$gid
 == 0 ) {

334 
$fixed_g¿Á
 +ğ
¬¿y
(

339 
–£if
 (!
$found
) {

340 
	g$acknowËdged
 = 
_dev–_node_acûss_moduË_švoke_®l
('node_acûss_acknowËdge', 
$fixed_g¿Á
);

341 ià(
em±y
(
$acknowËdged
)) {

343 
	g$fixed_g¿Á
 +ğ
¬¿y
(

350 
	g$fixed_g¿Á
 +ğ
¬¿y
(

353 '#moduË' => 
»£t
(
¬¿y_keys
(
$acknowËdged
)),

360 
	g$fixed_g¿Á
 +ğ
¬¿y
(

361 'nid' => 
$nid
,

362 '#t™Ë' => 
_dev–_node_acûss_g‘_node_t™Ë
(
$node
),

364 
	g$®l_g¿Ás
[] = 
$fixed_g¿Á
;

369 
fÜ—ch
 (
$acquœed_g¿Ás_nid
 
as
 
$´iÜ™y
 => 
$acquœed_g¿Ás_´iÜ™y
) {

370 
ksÜt
(
$acquœed_g¿Ás_´iÜ™y
);

371 
fÜ—ch
 (
$acquœed_g¿Ás_´iÜ™y
 
as
 
$»®m
 => 
$acquœed_g¿Ás_»®m
) {

372 
ksÜt
(
$acquœed_g¿Ás_»®m
);

373 
fÜ—ch
 (
$acquœed_g¿Ás_»®m
 
as
 
$gid
 => 
$acquœed_g¿Á
) {

374 ià(
$´iÜ™y
 =ğ
$tİ_´iÜ™y
) {

375 ià(
em±y
(
$acquœed_g¿Á
['grant_view']) &&ƒmpty($acquired_grant['grant_update']) &&ƒmpty($acquired_grant['grant_delete'])) {

376 
$acquœed_g¿Á
['state'] = 'empty';

379 
	g$acquœed_g¿Á
['¡©e'] = (
is£t
(
$aùive_g¿Ás
[
$nid
][
$»®m
][
$gid
]) ? 'ok' : 'missing');

380 ià(
	g$acquœed_g¿Á
['state'] == 'ok') {

381 
fÜ—ch
 (
¬¿y
('v›w', 'upd©e', 'd–‘e'è
as
 
$İ
) {

382 
$aùive_g¿Á
 = (
¬¿y
è
$aùive_g¿Ás
[
$nid
][
$»®m
][
$gid
];

383 ià(
em±y
(
$acquœed_g¿Á
["g¿Á_$İ"]è!ğem±y(
$aùive_g¿Á
["grant_$op"]) ) {

384 
$acquœed_g¿Á
["g¿Á_$İ!"] = 
$aùive_g¿Á
["grant_$op"];

391 
	g$acquœed_g¿Á
['¡©e'] = (
is£t
(
$aùive_g¿Ás
[
$nid
][
$»®m
][
$gid
]) ? 'illegitimate' : 'ignored');

393 
	g$®l_g¿Ás
[] = 
$acquœed_g¿Á
 + 
¬¿y
('nid' => 
$nid
);

399 
	g$rows
 = 
¬¿y
();

400 
	g$”rÜ_couÁ
 = 0;

401 
fÜ—ch
 (
$®l_g¿Ás
 
as
 
$g¿Á
) {

402 
	g$row
 = 
Ãw
 
¡dCÏss
();

403 
	g$row
->
	gnid
 = 
$g¿Á
['nid'];

404 
	g$row
->
	gt™Ë
 = 
$g¿Á
['#title'];

405 
	g$row
->
	g´iÜ™y
 = 
$g¿Á
['priority'];

406 
	g$row
->
	g¡©e
 = 
¬¿y
('d©a' => 
$¡©es
[
$g¿Á
['state']][0], 'title' => $states[$grant['state']][2]);

407 
	g$row
->
	g»®m
 = 
$g¿Á
['realm'];

408 
	g$row
->
	ggid
 = 
$g¿Á
['gid'];

409 
	g$row
->
	gg¿Á_v›w
 = 
$g¿Á
['grant_view'];

410 
	g$row
->
	gg¿Á_upd©e
 = 
$g¿Á
['grant_update'];

411 
	g$row
->
	gg¿Á_d–‘e
 = 
$g¿Á
['grant_delete'];

412 
	g$row
->
	gex¶ašed
 = 
im¶ode
('<b¸/>', 
moduË_švoke_®l
('node_acûss_ex¶aš', 
$row
));

413 
un£t
(
$row
->
t™Ë
);

414 ià(
	g$row
->
	gnid
 =ğ0 && 
$row
->
gid
 =ğ0 && $row->
»®m
 =ğ'®l' && 
couÁ
(
$®l_g¿Ás
) > 1) {

415 
$row
->
¡©e
 = 
¬¿y
('d©a' => 
$¡©es
['unexpected'][0], 'title' => $states['unexpected'][2]);

416 
	g$şass
 = 
$¡©es
['unexpected'][1];

419 
	g$şass
 = 
$¡©es
[
$g¿Á
['state']][1];

421 
	g$”rÜ_couÁ
 +ğ(
$şass
 == 'error');

422 
	g$row
 = (
¬¿y
è
$row
;

423 
fÜ—ch
 (
¬¿y
('v›w', 'upd©e', 'd–‘e'è
as
 
$İ
) {

424 
	g$row
["g¿Á_$İ"] = 
¬¿y
('d©a' => 
$row
["grant_$op"]);

425 ià((
is£t
(
$checked_g¿Ás
[
$g¿Á
['nid']][
$İ
][$g¿Á['»®m']]è&& 
š_¬¿y
($g¿Á['gid'], $checked_g¿Ás[$g¿Á['nid']][$İ][$g¿Á['»®m']]è|| (
	g$row
['nid'] =ğ0 && 
$row
['gid'] =ğ0 && $row['»®m'] =ğ'®l')è&& !
em±y
($row["g¿Á_$İ"]['d©a']è&& in_¬¿y($g¿Á['¡©e'], 
$aùive_¡©es
)) {

426 
	g$row
["grant_$op"]['data'] .= '&prime;';

427 
	g$row
["g¿Á_$İ"]['t™Ë'] = 
t
('Thisƒntry grants‡ccessohis‚odeohis user.');

429 ià(
is£t
(
$g¿Á
["grant_$op!"])) {

430 
	g$row
["g¿Á_$İ"]['d©a'] = 
$g¿Á
["g¿Á_$İ!"] .'&gt;'. (!
$row
["grant_$op"]['data'] ? 0 : $row["grant_$op"]['data']);

431 
	g$row
["grant_$op"]['class'] = 'error';

434 
	g$row
['nid'] = '<¨h»f="#node-'. 
$g¿Á
['nid'] .'">'. 
$row
['nid'] .'</a>';

435 
fÜ—ch
 (
¬¿y
('nid', '´iÜ™y', 'gid'è
as
 
$key
) {

436 
	g$row
[
$key
] = 
¬¿y
('d©a' => 
$row
[$key], 'style' => 'text-align:„ight');

438 
	g$row
['nid']['t™Ë'] = 
$g¿Á
['#title'];

439 
	g$row
['»®m'] = (
em±y
(
$g¿Á
['#moduË']è|| 
¡½os
($grant['realm'], $grant['#module']) === 0 ? '' : $grant['#module'] .':<br />') . $grant['realm'];

440 
	g$rows
[] = 
¬¿y
('d©a' => 
¬¿y_v®ues
(
$row
), 'şass' => 'ev’ '. 
$şass
);

442 
	g$ouut
 = 
theme
('bË', 
$h—d”s
, 
$rows
, 
¬¿y
('class' => 'system-status-report', 'style' => 'text-align:†eft'));

444 
	g$ouut
 .ğ
theme_™em
(
¬¿y
('#value' => '', '#description' => '(Some ofheableƒlements…rovide‡dditional information if you hover your mouse overhem.)'));

446 ià(
	g$”rÜ_couÁ
 > 0) {

447 
	g$v¬ŸbËs
['!Rebud_³rmissiÚs'] = '<¨h»f="'. 
u¾
('admš/cÚ‹Á/node-£‰šgs/»bud'è.'">'. 
$Œ
('Rebuild…ermissions') .'</a>';

448 
	g$ouut
 .ğ
theme_™em
(
¬¿y
('#v®ue' => '<div cÏss="”rÜ">'. 
t
("You hav”rÜ š you¸!ÇabË! You may babËØfixhe£ fÜ‚ow by„uÂšg !Rebud_³rmissiÚs, buˆthi i lik–yØde¡royhevid’û‡nd mak™ impossibËØid’tifyhund”lyšg issues. Iàyou dÚ'ˆfixho£,h”rÜ wÈ´obably comback‡gaš. <b¸/> DON'T dØthi ju¡ y‘ iàyou iÁ’dØask fÜ h–°w™hhi s™u©iÚ.", 
$v¬ŸbËs
) .'</div>'));

452 
	g$Œ
 = 't';

453 
¬¿y_shiá
(
$nids
);

454 
	g$accouÁs
 = 
¬¿y
();

455 
	g$v¬ŸbËs
 +ğ
¬¿y
(

456 '!u£ºame' => 
theme
('u£ºame', 
$u£r
),

457 '%uid' => 
$u£r
->
uid
,

460 ià(
u£r_acûss
('administer‚odes')) {

461 
	g$v¬ŸbËs
['%admši¡”_nodes'] = 
$Œ
('administer‚odes');

462 
	g$ouut
 .ğ
t
('!u£ºamha th%admši¡”_node ³rmissiÚ‡ndhu fuÎ‡cûs tØ®Ènodes.', 
$v¬ŸbËs
) .'<br />&nbsp;';

465 
	g$v¬ŸbËs
['!li¡'] = '<div styË="m¬gš-Ëá: 2em">'. 
_dev–_node_acûss_g‘_g¿Á_li¡
(
$nid
, 
$checked_¡©us
, 
$checked_g¿Ás
) .'</div>';

466 
	g$v¬ŸbËs
['%access'] = 'view';

467 
	g$ouut
 .ğ"\n<div styË='‹xt-®ign:†eá'™Ë='". 
t
('The£‡»hg¿Á »tuºed by hook_node_g¿Ás(èfÜhi u£r.'è."'>".('!u£ºam(u£¸%uidèÿÀu£he£ g¿Á fÜ %acûs acûs (iàthey‡»…»£Á‡bove): !li¡', 
$v¬ŸbËs
) ."</div>\n";

468 
	g$accouÁs
[] = 
$u£r
;

470 ià(
¬g
(0è=ğ'node' && 
is_num”ic
×rg(1)è&& !
$block1_visibË
) {

471 ià(
u£r_is_logged_š
()) {

472 
$accouÁs
[] = 
u£r_lßd
(0);

474 
fÜ—ch
 (
$accouÁs
 
as
 
$accouÁ
) {

475 
	g$v¬ŸbËs
['!u£ºame'] = 
theme
('u£ºame', 
$accouÁ
);

476 
	g$ouut
 .ğ"\n<div styË='‹xt-®ign:†eá'>". 
t
("!u£ºamha thfŞlowšg‡cûss", 
$v¬ŸbËs
) .' ';

477 
	g$nid_™ems
 = 
¬¿y
();

478 
fÜ—ch
 (
$nids
 
as
 
$nid
) {

479 
	g$İ_™ems
 = 
¬¿y
();

480 
fÜ—ch
 (
¬¿y
('ü—‹', 'v›w', 'upd©e', 'd–‘e'è
as
 
$İ
) {

481 
	g$ex¶aš
 = 
_dev–_node_acûss_ex¶aš_acûss
(
$İ
, 
$nid
, 
$accouÁ
);

482 
	g$İ_™ems
[] = "<div styË='width: 5em; di¥Ïy: iÆše-block'>". 
t
('%İ:', 
¬¿y
('%İ' => 
$İ
)è.' </div>'. 
$ex¶aš
[2];

484 
	g$nid_™ems
[] = 
t
('tØnod!nid:', 
¬¿y
('!nid' => 
l
(
$nid
, 'node/'. $nid)))

485 ."\n<div styË='m¬gš-Ëá: 2em'>". 
theme
('™em_li¡', 
$İ_™ems
, 
NULL
, 'ul') .'</div>';

487 ià(
couÁ
(
$nid_™ems
) == 1) {

488 
$ouut
 .ğ
$nid_™ems
[0];

491 
	g$ouut
 .ğ"\n<div styË='m¬gš-Ëá: 2em'>". 
theme
('™em_li¡', 
$nid_™ems
, 
NULL
, 'ul') .'</div>';

493 
	g$ouut
 .= "\n</div>\n";

498 ià(!
em±y
(
$hšt
)) {

499 
	g$ouut
 .ğ
theme_™em
(
¬¿y
('#v®ue' => '', '#desütiÚ' => '('. 
$hšt
 .')'));

501 
	g$subjeù
 = 
t
('node_accessƒntries for‚odes shown onhis…age');

502  
¬¿y
('subjeù' => 
$subjeù
, 'cÚ‹Á' => 
$ouut
 .'<br /><br />');

506 ià(
¬g
(0è=ğ'node' && 
is_num”ic
(
$nid
 =‡rg(1)è&&‡rg(2è=ğ
nuÎ
 && 
$node
 = 
node_lßd
($nid)) {

507 
$h—d”s
 = 
¬¿y
(
t
('u£ºame'), '<¥ª™Ë="'.("C»©node oàth'@Node_ty³'y³.",‡¼ay('@Node_ty³' => 
node_g‘_ty³s
('Çme', 
$node
))) .'">'.('create') .'</span>',('view'),('update'),('delete'));

508 
	g$rows
 = 
¬¿y
();

513 
	g$»suÉ
 = 
db_qu”y_¿nge
('SELECT DISTINCT u.* FROM {users} u ORDER BY u.access DESC', 0, 10);

514 
	g$d©a
 = 
db_ãtch_objeù
(
$»suÉ
)) {

515 
$accouÁ
 = 
u£r_lßd
(
$d©a
->
uid
);

516 
	g$u£ºame
 = 
theme
('u£ºame', 
$d©a
);

517 ià(
	g$accouÁ
->
	guid
 =ğ
$u£r
->
uid
) {

518 
$u£ºame
 = '<strong>'. $username .'</strong>';

520 
	g$rows
[] = 
¬¿y
(
$u£ºame
,

521 
theme
('dÇ_³rmissiÚ', 
_dev–_node_acûss_ex¶aš_acûss
('ü—‹', 
$nid
, 
$accouÁ
)),

522 
theme
('dÇ_³rmissiÚ', 
_dev–_node_acûss_ex¶aš_acûss
('v›w', 
$nid
, 
$accouÁ
)),

523 
theme
('dÇ_³rmissiÚ', 
_dev–_node_acûss_ex¶aš_acûss
('upd©e', 
$nid
, 
$accouÁ
)),

524 
theme
('dÇ_³rmissiÚ', 
_dev–_node_acûss_ex¶aš_acûss
('d–‘e', 
$nid
, 
$accouÁ
)),

527 ià(
couÁ
(
$rows
)) {

528 
	g$ouut
 = 
theme
('bË', 
$h—d”s
, 
$rows
, 
¬¿y
('style' => 'text-align:†eft'));

529 
	g$ouut
 .ğ
theme_™em
(
¬¿y
('#v®ue' => '', '#desütiÚ' => 
t
('(Thisable†istshe most-recently‡ctive users. Hover your mouse overƒach„esult for more details.)')));

530  
¬¿y
('subjeù' => 
t
('Access…ermissions by user'),

531 'cÚ‹Á' => 
$ouut
);

548 
funùiÚ
 
	$_dev–_node_acûss_ex¶aš_acûss
(
$İ
, 
$node
, 
$accouÁ
 = 
NULL
) {

549 
glob®
 
$u£r
;

550 
$f‹r_fÜm©s
;

552 ià(
	`is_num”ic
(
$node
è&& !($nodğ
	`node_lßd
($node))) {

553  
	`¬¿y
Ğ
FALSE
, '???',

554 
	`t
('Unableo†oadhe‚ode &ndash;his should‚ever happen!'),

557 ià(
$İ
 =ğ'ü—‹' && 
	`is_objeù
(
$node
)) {

558 
$node
 = $node->
ty³
;

561 ià(!
	`em±y
(
$accouÁ
)) {

562 
$f‹r_fÜm©s
 = 
	`f‹r_fÜm©s
();

565 
$§ved_u£r
 = 
$u£r
;

566 
	`£ssiÚ_§ve_£ssiÚ
(
FALSE
);

567 
$u£r
 = 
$accouÁ
;

568 
$»suÉ
 = 
	`_dev–_node_acûss_ex¶aš_acûss
(
$İ
, 
$node
, 
NULL
);

569 
$u£r
 = 
$§ved_u£r
;

570 
	`£ssiÚ_§ve_£ssiÚ
(
TRUE
);

571 
$£cÚd_İšiÚ
 = 
	`node_acûss
(
$İ
, 
$node
, 
$accouÁ
);

572 ià(
$£cÚd_İšiÚ
 !ğ
$»suÉ
[0]) {

573 
$»suÉ
[1] .ğ'<¥ª cÏss="'. (
$£cÚd_İšiÚ
 ? 'ok' : 'error') .'"itle="DNA‡nd Core seemo disagree onhis item. This is‡ bug inƒither one ofhem‡nd should be fixed! Tryo†ook‡this‚ode‡shis user‡nd check whetherhere is still disagreement.">*</span>';

575  
$»suÉ
;

578 
$v¬ŸbËs
 = 
	`¬¿y
(

579 '!NO' => 
	`t
('NO'),

580 '!YES' => 
	`t
('YES'),

583 ià(
$İ
 =ğ'upd©e' && !
	`_dev–_node_acûss_f‹r_acûss
(
$node
->
fÜm©
)) {

584  
	`¬¿y
Ğ
FALSE
,

585 
	`t
('!NO: iÅuˆfÜm©', 
$v¬ŸbËs
),

586 
	`t
("!NO: Thi u£¸i nÙ‡ÎowedØu£hšpuˆfÜm© '!fÜm©' (!fid).", 
$v¬ŸbËs
 +ğ
	`¬¿y
(

587 '!fid' => 
$node
->
fÜm©
,

588 '!fÜm©' => (
	`is£t
(
$f‹r_fÜm©s
[
$node
->
fÜm©
]è? $f‹r_fÜm©s[$node->fÜm©]->
Çme
 : '***'),

592 ià(
	`u£r_acûss
('administer‚odes')) {

593  
	`¬¿y
Ğ
TRUE
,

594 
	`t
('!YES:‡dmši¡”‚odes', 
$v¬ŸbËs
),

595 
	`t
("!YES: Thi u£¸ha th'!admši¡”_nodes'…”missiÚ‡nd may dØev”ythšg w™h‚odes.", 
$v¬ŸbËs
 +ğ
	`¬¿y
(

596 '!admši¡”_nodes' => 
	`t
('administer‚odes'),

600 
	`–£if
 (!
	`u£r_acûss
('access content')) {

601  
	`¬¿y
Ğ
FALSE
,

602 
	`t
('!NO:‡cûs cÚ‹Á', 
$v¬ŸbËs
),

603 
	`t
("!NO: Thi u£¸dÛ nÙ havth'!acûss_cÚ‹Á'…”missiÚ‡nd i d’›d došg‡nythšg w™h cÚ‹Á.", 
$v¬ŸbËs
 +ğ
	`¬¿y
(

604 '!acûss_cÚ‹Á' => 
	`t
('access content'),

608 
$moduË
 = 
	`node_g‘_ty³s
('moduË', 
$node
);

609 
$acûss
 = 
	`moduË_švoke
((
$moduË
 =ğ'node' ? 'node_cÚ‹Á' : $moduË), 'acûss', 
$İ
, 
$node
, 
$u£r
);

610 ià(!
	`is_nuÎ
(
$acûss
)) {

611 
$v¬ŸbËs
 +ğ
	`¬¿y
(

612 '@moduË' => 
$moduË
,

613 '@cÚ‹Á_ty³' => (
	`is_objeù
(
$node
è? $node->
ty³
 : $node),

615 ià(
$acûss
) {

616  
	`¬¿y
Ğ
TRUE
,

617 
	`t
('!YES: byhmoduË', 
$v¬ŸbËs
),

618 
	`t
("!YES: Th'@moduË' moduË (which defše th'@cÚ‹Á_ty³' cÚ‹Áy³è®low this,…robably ba£d oÀsom³rmissiÚ.", 
$v¬ŸbËs
),

622  
	`¬¿y
Ğ
FALSE
,

623 
	`t
('!NO: byhmoduË', 
$v¬ŸbËs
),

624 
	`t
("!NO: Th'@moduË' moduË (which defše th'@cÚ‹Á_ty³' cÚ‹Áy³èd’› this.", 
$v¬ŸbËs
),

629 ià(
$İ
 !ğ'ü—‹' && 
$node
->
nid
 && $node->
¡©us
) {

630 ià(
	`node_acûss
(
$İ
, 
$node
, 
$u£r
)) {

631  
	`¬¿y
Ğ
TRUE
,

632 
	`t
('!YES:‚odacûss', 
$v¬ŸbËs
),

633 
	`t
('!YES: Nodacûs ®low this.', 
$v¬ŸbËs
),

637  
	`¬¿y
Ğ
FALSE
,

638 
	`t
('!NO:‚odacûss', 
$v¬ŸbËs
),

639 
	`t
('!NO: Nodacûs d’› this.', 
$v¬ŸbËs
),

644 ià(
$İ
 =ğ'v›w' && 
$u£r
->
uid
 =ğ
$node
->uid && $user->uid != 0) {

645  
	`¬¿y
Ğ
TRUE
,

646 
	`t
('!YES: owÀnode', 
$v¬ŸbËs
),

647 
	`t
('!YES: Thu£¸may v›w his/h” owÀnode.', 
$v¬ŸbËs
),

650  
	`¬¿y
Ğ
FALSE
,

651 
	`t
('!NO:‚Ø»asÚ', 
$v¬ŸbËs
),

652 
	`t
("!NO: NÚoàthcheck »suÉed iÀ®lowšghis, sØ™' d’›d.", 
$v¬ŸbËs
) .

653 (
$İ
 !ğ'ü—‹' && !
$node
->
¡©us
 ? ' '. 
	`t
('Node‡ccess was‚ot checked becausehe‚ode is‚ot…ublished.') : '') .

654 (
$İ
 =ğ'ü—‹' ? ' '. 
	`t
('This is most†ikely dueo‡ withheld…ermission.') : ''),

656 
	}
}

662 
funùiÚ
 
	$_dev–_node_acûss_f‹r_acûss
(
$fÜm©
) {

663 
$fÜm©
 = 
	`f‹r_»sŞve_fÜm©
($format);

664 ià(
	`u£r_acûss
('admši¡” f‹rs'è|| (
$fÜm©
 =ğ
	`v¬ŸbË_g‘
('filter_default_format', 1))) {

665  
TRUE
;

668  (
boŞ
è
	`_dev–_node_acûss_f‹r_fÜm©s
(
$fÜm©
);

670 
	}
}

676 
funùiÚ
 
	$_dev–_node_acûss_f‹r_fÜm©s
(
$šdex
, 
$accouÁ
 = 
NULL
) {

677 
glob®
 
$u£r
;

678 
$fÜm©s
 = 
	`¬¿y
();

680 ià(!
	`is£t
(
$accouÁ
)) {

681 
$accouÁ
 = 
$u£r
;

685 
$®l
 = 
	`u£r_acûss
('admši¡” f‹rs', 
$accouÁ
);

687 ià(!
	`is£t
(
$fÜm©s
[
$accouÁ
->
uid
])) {

688 
$fÜm©s
[
$accouÁ
->
uid
] = 
	`¬¿y
();

690 
$qu”y
 = 'SELECT * FROM {filter_formats}';

693 
$¬gs
 = 
	`¬¿y
();

694 ià(!
$®l
) {

695 
$wh”e
 = 
	`¬¿y
();

696 
	`fÜ—ch
 (
$accouÁ
->
rŞes
 
as
 
$rid
 => 
$rŞe
) {

697 
$wh”e
[] = "roles LIKE '%%,%d,%%'";

698 
$¬gs
[] = 
$rid
;

700 
$qu”y
 .ğ' WHERE '. 
	`im¶ode
(' OR ', 
$wh”e
) .' OR format = %d';

701 
$¬gs
[] = 
	`v¬ŸbË_g‘
('filter_default_format', 1);

704 
$»suÉ
 = 
	`db_qu”y
(
$qu”y
, 
$¬gs
);

705 
$fÜm©
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

706 
$fÜm©s
[
$accouÁ
->
uid
][
$fÜm©
->
fÜm©
] = $format;

709 ià(
	`is£t
(
$šdex
)) {

710  
	`is£t
(
$fÜm©s
[
$accouÁ
->
uid
][
$šdex
]è? $fÜm©s[$accouÁ->uid][$šdex] : 
FALSE
;

712  
$fÜm©s
[
$accouÁ
->
uid
];

713 
	}
}

718 
funùiÚ
 
	$_dev–_node_acûss_g‘_g¿Á_li¡
(
$nid
, 
$checked_¡©us
, 
$checked_g¿Ás
) {

719 ià(!
	`em±y
(
$checked_¡©us
[
$nid
])) {

720 
$cgs_by_»®m
 = 
	`¬¿y
();

721 
	`fÜ—ch
 (
$checked_g¿Ás
[
$nid
]['v›w'] 
as
 
$»®m
 => 
$cg
) {

722 ià(
	`is£t
(
$cg
['#module'])) {

723 
$moduË
 = 
$cg
['#module'];

724 
	`un£t
(
$cg
['#module']);

725 ià(!
	`em±y
(
$moduË
è&& (
	`¡½os
(
$»®m
, $module) !== 0)) {

726 
$»®m
 = 
$moduË
 .':'. $realm;

729 
$cgs_by_»®m
[
$»®m
] = $»®m .': '. 
	`im¶ode
(', ', 
$cg
);

731 ià(!
	`em±y
(
$cgs_by_»®m
)) {

732  
	`theme
('™em_li¡', 
	`¬¿y_v®ues
(
$cgs_by_»®m
), 
NULL
, 'ul');

735 
	}
}

740 
funùiÚ
 
	$dev–_node_acûss_node_acûss_ex¶aš
(
$row
) {

741 ià(
$row
->
gid
 =ğ0 && $row->
»®m
 == 'all') {

742 
	`fÜ—ch
 (
	`¬¿y
('v›w', 'upd©e', 'd–‘e'è
as
 
$İ
) {

743 
$gİ
 = 'g¿Á_'. 
$İ
;

744 ià(!
	`em±y
(
$row
->
$gİ
)) {

745 
$İs
[] = 
$İ
;

748 ià(
	`em±y
(
$İs
)) {

749  '(NØacûs g¿ÁedØ'. (
$row
->
nid
 == 0 ? 'any‚odes.)' : 'this‚ode.)');

752  'AÎ u£r may '. 
	`im¶ode
('/', 
$İs
è. (
$row
->
nid
 == 0 ? '‡ll‚odes.' : 'his‚ode.');

755 
	}
}

760 
funùiÚ
 
	$_dev–_node_acûss_g‘_node_t™Ë
(
$node
, 
$ş_ªd_decÜ©e
 = 
FALSE
) {

761 ià(
	`is£t
(
$node
)) {

762 ià(
	`is£t
(
$node
->
t™Ë
)) {

763 
$node_t™Ë
 = 
	`check_¶aš
(
$node
->
t™Ë
);

764 ià(
$ş_ªd_decÜ©e
) {

765 ià(
	`dru·l_¡¾’
(
$node_t™Ë
) > 20) {

766 
$node_t™Ë
 = "<¥ª™Ë='node/$node->nid: $node_t™Ë'>". 
	`dru·l_sub¡r
($node_title, 0, 15) .'...</span>';

768 
$node_t™Ë
 = '<¥ª™Ë="node/'. 
$node
->
nid
 .'">'. $node_title .'</span>';

770  
$node_t™Ë
;

772 
	`–£if
 (
	`is£t
(
$node
->
nid
)) {

773  
$node
->
nid
;

777 
	}
}

782 
funùiÚ
 
	$dev–_node_acûss_theme
() {

783  
	`¬¿y
(

784 'dÇ_³rmissiÚ' => 
	`¬¿y
(

785 '¬gum’ts' => 
	`¬¿y
('³rmissiÚ' => 
NULL
),

788 
	}
}

793 
funùiÚ
 
	$theme_dÇ_³rmissiÚ
(
$³rmissiÚ
) {

794  '<¥ª cÏss="'. (
$³rmissiÚ
[0] ? 'ok' : 'error') .'"itle="'. $permission[2] .'">'. $permission[1] .'</span>';

795 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/devel/krumo/class.krumo.php

1 <?
php


21 if(!
defšed
('DIR_SEP')) {

22 
defše
('DIR_SEP', 
DIRECTORY_SEPARATOR
);

27 ià(!
defšed
('PATH_SEPARATOR')) {

28 
defše
('PATH_SEPARATOR', 
OS_WINDOWS
 ? ';' : ':');

38 ià(!
defšed
('KRUMO_DIR')) {

39 
defše
('KRUMO_DIR', 
dœÇme
(
__FILE__
è. 
DIRECTORY_SEPARATOR
);

47 ià(!
defšed
('KRUMO_TRUNCATE_LENGTH')) {

48 
defše
('KRUMO_TRUNCATE_LENGTH', 50);

61 
CÏss
 
	gkrumo
 {

70 
FunùiÚ
 
v”siÚ
() {

82 
FunùiÚ
 
backŒaû
() {

86 ià(!
	gkrumo
::
_debug
()) {

87  
çl£
;

92  
	gkrumo
::
dump
(
debug_backŒaû
());

101 
FunùiÚ
 
şas£s
() {

105 ià(!
	gkrumo
::
_debug
()) {

106  
çl£
;

112 <
div
 
	gşass
="krumo-title">

113 
This
 
is
 
a
 
li¡
 
of
 
®l
 
cu¼’y
 
deş¬ed
 
şas£s
.

114 </
div
>

115 <?
php


116  
krumo
::
dump
(
g‘_deş¬ed_şas£s
());

125 
FunùiÚ
 
š‹rçûs
() {

129 ià(!
	gkrumo
::
_debug
()) {

130  
çl£
;

136 <
div
 
	gşass
="krumo-title">

137 
This
 
is
 
a
 
li¡
 
of
 
®l
 
cu¼’y
 
deş¬ed
 
š‹rçûs
.

138 </
div
>

139 <?
php


140  
krumo
::
dump
(
g‘_deş¬ed_š‹rçûs
());

149 
FunùiÚ
 
šşudes
() {

153 ià(!
	gkrumo
::
_debug
()) {

154  
çl£
;

160 <
div
 
	gşass
="krumo-title">

161 
This
 
is
 
a
 
li¡
 
of
 
®l
 
cu¼’y
 
šşuded
 (
Ü
 
»quœed
è
fes
.

162 </
div
>

163 <?
php


164  
krumo
::
dump
(
g‘_šşuded_fes
());

173 
FunùiÚ
 
funùiÚs
() {

177 ià(!
	gkrumo
::
_debug
()) {

178  
çl£
;

184 <
div
 
	gşass
="krumo-title">

185 
This
 
is
 
a
 
li¡
 
of
 
®l
 
cu¼’y
 
deş¬ed
 
funùiÚs
.

186 </
div
>

187 <?
php


188  
krumo
::
dump
(
g‘_defšed_funùiÚs
());

197 
FunùiÚ
 
defšes
() {

201 ià(!
	gkrumo
::
_debug
()) {

202  
çl£
;

208 <
div
 
	gşass
="krumo-title">

209 
This
 
is
 
a
 
li¡
 
of
 
®l
 
cu¼’y
 
deş¬ed
 
cÚ¡ªts
 (
defšes
).

210 </
div
>

211 <?
php


212  
krumo
::
dump
(
g‘_defšed_cÚ¡ªts
());

221 
FunùiÚ
 
ex‹nsiÚs
() {

225 ià(!
	gkrumo
::
_debug
()) {

226  
çl£
;

232 <
div
 
	gşass
="krumo-title">

233 
This
 
is
 
a
 
li¡
 
of
 
®l
 
cu¼’y
 
lßded
 
PHP
 
ex‹nsiÚs
.

234 </
div
>

235 <?
php


236  
krumo
::
dump
(
g‘_lßded_ex‹nsiÚs
());

245 
FunùiÚ
 
h—d”s
() {

249 ià(!
	gkrumo
::
_debug
()) {

250  
çl£
;

256 <
div
 
	gşass
="krumo-title">

257 
This
 
is
 
a
 
li¡
 
of
 
®l
 
HTTP
 
»que¡
 
h—d”s
.

258 </
div
>

259 <?
php


260  
krumo
::
dump
(
g‘AÎH—d”s
());

269 
FunùiÚ
 
phpši
() {

273 ià(!
	gkrumo
::
_debug
()) {

274  
çl£
;

280 <
div
 
	gşass
="krumo-title">

281 
This
 
is
 
a
 
li¡
 
of
 
the
 
cÚfigu¿tiÚ
 
£‰šgs
 
»ad
 
äom
 <
code
><
b
><?
php
 
echo
 
g‘_cfg_v¬
('cfg_fe_·th');?></
	gb
></
	gcode
>.

282 </
	gdiv
>

283 <?
php


284  
	gkrumo
::
dump
(
·r£_ši_fe
(
g‘_cfg_v¬
('cfg_fe_·th'), 
Œue
));

293 
FunùiÚ
 
cÚf
() {

297 ià(!
	gkrumo
::
_debug
()) {

298  
çl£
;

304 <
div
 
	gşass
="krumo-title">

305 
This
 
is
 
a
 
li¡
 
of
 
®l
 
your
 
cÚfigu¿tiÚ
 
£‰šgs
.

306 </
div
>

307 <?
php


308  
krumo
::
dump
(
ši_g‘_®l
());

317 
FunùiÚ
 
·th
() {

321 ià(!
	gkrumo
::
_debug
()) {

322  
çl£
;

328 <
div
 
	gşass
="krumo-title">

329 
This
 
is
 
a
 
li¡
 
of
 
the
 
¥ecif›d
 
dœeùÜ›s
 
und”
 
your
 <
code
><
b
>
šşude_·th
</b></code> 
İtiÚ
.

330 </
div
>

331 <?
php


332  
krumo
::
dump
(
ex¶ode
(
PATH_SEPARATOR
, 
ši_g‘
('include_path')));

341 
FunùiÚ
 
»que¡
() {

345 ià(!
	gkrumo
::
_debug
()) {

346  
çl£
;

352 <
div
 
	gşass
="krumo-title">

353 
This
 
is
 
a
 
li¡
 
of
 
®l
 
the
 
v®ues
 
äom
h<
code
><
b
>
$_REQUEST
</b></code> 
¬¿y
.

354 </
div
>

355 <?
php


356  
krumo
::
dump
(
$_REQUEST
);

365 
FunùiÚ
 
g‘
() {

369 ià(!
	gkrumo
::
_debug
()) {

370  
çl£
;

376 <
div
 
	gşass
="krumo-title">

377 
This
 
is
 
a
 
li¡
 
of
 
®l
 
the
 
v®ues
 
äom
h<
code
><
b
>
$_GET
</b></code> 
¬¿y
.

378 </
div
>

379 <?
php


380  
krumo
::
dump
(
$_GET
);

389 
FunùiÚ
 
po¡
() {

393 ià(!
	gkrumo
::
_debug
()) {

394  
çl£
;

400 <
div
 
	gşass
="krumo-title">

401 
This
 
is
 
a
 
li¡
 
of
 
®l
 
the
 
v®ues
 
äom
h<
code
><
b
>
$_POST
</b></code> 
¬¿y
.

402 </
div
>

403 <?
php


404  
krumo
::
dump
(
$_POST
);

413 
FunùiÚ
 
£rv”
() {

417 ià(!
	gkrumo
::
_debug
()) {

418  
çl£
;

424 <
div
 
	gşass
="krumo-title">

425 
This
 
is
 
a
 
li¡
 
of
 
®l
 
the
 
v®ues
 
äom
h<
code
><
b
>
$_SERVER
</b></code> 
¬¿y
.

426 </
div
>

427 <?
php


428  
krumo
::
dump
(
$_SERVER
);

437 
FunùiÚ
 
cook›
() {

441 ià(!
	gkrumo
::
_debug
()) {

442  
çl£
;

448 <
div
 
	gşass
="krumo-title">

449 
This
 
is
 
a
 
li¡
 
of
 
®l
 
the
 
v®ues
 
äom
h<
code
><
b
>
$_COOKIE
</b></code> 
¬¿y
.

450 </
div
>

451 <?
php


452  
krumo
::
dump
(
$_COOKIE
);

461 
FunùiÚ
 
’v
() {

465 ià(!
	gkrumo
::
_debug
()) {

466  
çl£
;

472 <
div
 
	gşass
="krumo-title">

473 
This
 
is
 
a
 
li¡
 
of
 
®l
 
the
 
v®ues
 
äom
h<
code
><
b
>
$_ENV
</b></code> 
¬¿y
.

474 </
div
>

475 <?
php


476  
krumo
::
dump
(
$_ENV
);

485 
FunùiÚ
 
£ssiÚ
() {

489 ià(!
	gkrumo
::
_debug
()) {

490  
çl£
;

496 <
div
 
	gşass
="krumo-title">

497 
This
 
is
 
a
 
li¡
 
of
 
®l
 
the
 
v®ues
 
äom
h<
code
><
b
>
$_SESSION
</b></code> 
¬¿y
.

498 </
div
>

499 <?
php


500  
krumo
::
dump
(
$_SESSION
);

511 
FunùiÚ
 
ši
(
$ši_fe
) {

515 ià(!
	gkrumo
::
_debug
()) {

516  
çl£
;

521 ià(!
	g$_
 = @
·r£_ši_fe
(
$ši_fe
, 1)) {

522  
	gçl£
;

528 <
div
 
	gşass
="krumo-title">

529 
This
 
is
 
a
 
li¡
 
of
 
®l
 
the
 
v®ues
 
äom
h<
code
><
b
><?
php
 
echo
 
»®·th
(
$ši_fe
è?„—Í©h($ši_feè: $ši_fe;?></
	gb
></
	gcode
> 
INI
 
	gfe
.

530 </
	gdiv
>

531 <?
php


532  
	gkrumo
::
dump
(
$_
);

544 
FunùiÚ
 
dump
(
$d©a
) {

548 ià(!
	gkrumo
::
_debug
()) {

549  
çl£
;

554 ià(
func_num_¬gs
() > 1) {

555 
	g$_
 = 
func_g‘_¬gs
();

556 
fÜ—ch
(
$_
 
as
 
$d
) {

557 
	gkrumo
::
dump
(
$d
);

564 
	gkrumo
::
_css
();

569 
	g$_
 = 
¬¿y_»v”£
(
debug_backŒaû
());

570 
	g$d
 = 
¬¿y_pİ
(
$_
)) {

572 ià((
¡½os
(@
$d
['fe'], 'dev–'è==ğ
FALSE
) && (strpos(@$d['file'], 'krumo') === FALSE) && @$d['class'] != 'krumo') {

580 <
div
 
	gşass
="krumo-roÙ" 
dœ
="ltr">

581 <
ul
 
şass
="krumo-node krumo-first">

582 <?
php
 
echo
 
krumo
::
_dump
(
$d©a
);?>

583 <
li
 
	gşass
="krumo-footnote">

584 <
div
 
şass
="krumo-v”siÚ" 
¡yË
="white-space:nowrap;">

585 <
h6
>
Krumo
 
v”siÚ
 <?
php
 
echo
 
krumo
::v”siÚ();?></
	gh6
> | <
a


586 
	gh»f
="http://krumo.sourceforge.net"

587 
rg‘
="_bÏnk">
h‰p
:

588 </
div
>

590 <?
php
 ià(@
$d
['file']) { ?>

591 <
¥ª
 
şass
="krumo-ÿÎ" 
¡yË
="white-space:nowrap;">

592 
C®Ëd
 
äom
 <
code
><?
php
 
echo
 
$d
['file']?></code>,

593 
	glše
 <
	gcode
><?
php
 
echo
 
	g$d
['lše']?></code></
	g¥ª
>

594 <?
	gphp
 } ?>

595 &
	gnb¥
;

596 </
	gli
>

597 </
	gul
>

598 </
	gdiv
>

599 <?
php


602 
	g$_»cursiÚ_m¬k”
 = 
krumo
::
_m¬k”
();

603 ià(
	g$hive
 =& 
krumo
::
_hive
(
$dummy
)) {

604 
fÜ—ch
(
$hive
 
as
 
$i
=>
$b“
){

605 ià(
is_objeù
(
$b“
)) {

606 
un£t
(
$hive
[
$i
]->
$_»cursiÚ_m¬k”
);

608 
un£t
(
$hive
[
$i
][
$_»cursiÚ_m¬k”
]);

615 ià(
is_¬¿y
(
$d©a
è&& 
v”siÚ_com·»
(
PHP_VERSION
, "5", "<")) {

616 
un£t
(
$GLOBALS
[
krumo
::
_m¬k”
()]);

629 
FunùiÚ
 
_css
() {

631 
	g$_css
 = 
çl£
;

635 ià(
	g$_css
) {

636  
	gŒue
;

639 
	g$css
 = '';

642 
	g$skš
 = 
v¬ŸbË_g‘
('devel_krumo_skin', 'orange');

646 
	g$_
 = 
KRUMO_DIR
 . "skins/{$skin}/skin.css";

647 ià(
	g$å
 = @
fİ’
(
$_
, 'r', 1)) {

648 
	g$css
 = 
ä—d
(
$å
, 
fesize
(
$_
));

649 
fşo£
(
$å
);

654 ià(!
	g$css
 && (
	g$skš
 != 'default')) {

655 
$skš
 = 'default';

656 
	g$_
 = 
KRUMO_DIR
 . "skins/default/skin.css";

657 
	g$css
 = 
još
('', @
fe
(
$_
));

662 ià(
	g$_css
 = 
$css
 != '') {

668 
$css_u¾
 = 
ba£_·th
(è. 
dru·l_g‘_·th
('module', 'devel') . "/krumo/skins/{$skin}/";

670 
	g$css
 = 
´eg_»¶aû
('~%u¾%~Uis', 
$css_u¾
, 
$css
);

675 <!-- 
Usšg
 
Krumo
 
	gSkš
: <?
php
 
echo
 
´eg_»¶aû
('~^' . 
´eg_quÙe
(
»®·th
(
KRUMO_DIR
è. 
DIRECTORY_SEPARATOR
è. '~Uis', '',„—Í©h(
$_
));?> -->

676 <
¡yË
 
	gty³
="text/css">

678 <?
php
 
echo
 
$css
?>

681 </
¡yË
>

682 <?
php


686 <
süt
 
ty³
="text/javascript">

688 <?
php
 
echo
 
još
(
fe
(
KRUMO_DIR
 . "krumo.js"));?>

691 </
	gsüt
>

692 <?
	gphp


695  
	g$_css
;

707 
FunùiÚ
 
’abË
() {

708  
	gŒue
 ==ğ
krumo
::
_debug
(
Œue
);

718 
FunùiÚ
 
di§bË
() {

719  
	gçl£
 ==ğ
krumo
::
_debug
(
çl£
);

730 
FunùiÚ
 
_debug
(
$¡©e
=
nuÎ
) {

732 
$_
 = 
Œue
;

736 ià(
is£t
(
$¡©e
)) {

737 
	g$_
 = (
boŞ—n
è
$¡©e
;

742  
	g$_
;

755 
FunùiÚ
 
_dump
(&
$d©a
, 
$Çme
='...') {

759 ià(
is_objeù
(
$d©a
)) {

760  
krumo
::
_objeù
(
$d©a
, 
$Çme
);

765 ià(
is_¬¿y
(
$d©a
)) {

769 ià(
v”siÚ_com·»
(
PHP_VERSION
, "5", "<")) {

773 ià(!
is£t
(
$GLOBALS
[
krumo
::
_m¬k”
()])) {

774 
$GLOBALS
[
krumo
::
_m¬k”
()] = 
¬¿y
();

776 ià(!
is_¬¿y
(
$GLOBALS
[
krumo
::
_m¬k”
()])) {

777 
$GLOBALS
[
krumo
::
_m¬k”
()] = (
¬¿y
) $GLOBALS[krumo::_marker()];

782 ià(!
em±y
(
$GLOBALS
[
krumo
::
_m¬k”
()])) {

783 
$d
 = 
¬¿y_shiá
(
$GLOBALS
[
krumo
::
_m¬k”
()]);

784 ià(
is_¬¿y
(
$d
)) {

785 
	g$d©a
 = 
$d
;

790  
	gkrumo
::
_¬¿y
(
$d©a
, 
$Çme
);

795 ià(
is_»sourû
(
$d©a
)) {

796  
	gkrumo
::
_»sourû
(
$d©a
, 
$Çme
);

801 ià(
is_¡ršg
(
$d©a
)) {

802  
	gkrumo
::
_¡ršg
(
$d©a
, 
$Çme
);

805 ià(
is_æßt
(
$d©a
)) {

806  
	gkrumo
::
_æßt
(
$d©a
, 
$Çme
);

809 ià(
is_š‹g”
(
$d©a
)) {

810  
	gkrumo
::
_š‹g”
(
$d©a
, 
$Çme
);

813 ià(
is_boŞ
(
$d©a
)) {

814  
	gkrumo
::
_boŞ—n
(
$d©a
, 
$Çme
);

819 ià(
is_nuÎ
(
$d©a
)) {

820  
	gkrumo
::
_nuÎ
(
$Çme
);

834 
FunùiÚ
 
_nuÎ
(
$Çme
) {

836 <
li
 
	gşass
="krumo-child">

837 <
div
 
şass
="krumo-element"

838 
ÚMou£Ov”
="krumo.over(this);"

839 
ÚMou£Out
="krumo.out(this);">

841 <
a
 
şass
="krumo-Çme"><?
php
 
echo
 
$Çme
;?></
	ga
>

842 (<
em
 
	gşass
="krumo-ty³ krumo-nuÎ">
NULL
</em>)

843 </
div
>

844 </
li
>

845 <?
php


858 
FunùiÚ
 
_m¬k”
() {

860 
	g$_»cursiÚ_m¬k”
;

861 ià(!
is£t
(
$_»cursiÚ_m¬k”
)) {

862 
	g$_»cursiÚ_m¬k”
 = 
uniqid
('krumo');

865  
	g$_»cursiÚ_m¬k”
;

880 
	gFunùiÚ
 &
_hive
(&
$b“
) {

882 
	g$_
 = 
¬¿y
();

886 ià(!
is_nuÎ
(
$b“
)) {

890 
	g$_»cursiÚ_m¬k”
 = 
krumo
::
_m¬k”
();

891 (
is_objeù
(
$b“
))

892 ? @(
	g$b“
->
	g$_»cursiÚ_m¬k”
++)

893 : @(
$b“
[
$_»cursiÚ_m¬k”
]++);

895 
	g$_
[0][] =& 
$b“
;

900  
	g$_
[0];

912 
FunùiÚ
 
_v¬s
(&
$d©a
) {

914 
	g$_is_objeù
 = 
is_objeù
(
$d©a
);

919 
	g$_»cursiÚ_m¬k”
 = 
krumo
::
_m¬k”
();

920 
	g$_r
 = (
$_is_objeù
)

921 ? @
$d©a
->
$_»cursiÚ_m¬k”


922 : @
$d©a
[
$_»cursiÚ_m¬k”
] ;

923 
	g$_r
 = (
š‹g”
è
$_r
;

927 ià(
	g$_r
 > 0) {

928  
	gkrumo
::
_»cursiÚ
();

933 
	gkrumo
::
_hive
(
$d©a
);

938 <
div
 
	gşass
="krumo-Ã¡" 
¡yË
="display:none;">

939 <
ul
 
şass
="krumo-node">

940 <?
php


944 
$keys
 = (
$_is_objeù
)

945 ? 
¬¿y_keys
(
g‘_objeù_v¬s
(
$d©a
))

946 : 
¬¿y_keys
(
$d©a
);

950 
fÜ—ch
(
$keys
 
as
 
$k
) {

954 ià(
	g$k
 ==ğ
$_»cursiÚ_m¬k”
) {

960 ià(
	g$_is_objeù
) {

961 
	g$v
 =& 
$d©a
->
$k
;

963 
	g$v
 =& 
$d©a
[
$k
];

968 ià(
is_¬¿y
(
$d©a
è&& 
v”siÚ_com·»
(
PHP_VERSION
, "5", "<")) {

969 
	g$GLOBALS
[
krumo
::
_m¬k”
()][] =& 
$v
;

972 
	gkrumo
::
_dump
(
$v
,
$k
);

974 </
	gul
>

975 </
	gdiv
>

976 <?
	gphp


987 
FunùiÚ
 
_»cursiÚ
() {

989 <
div
 
	gşass
="krumo-Ã¡" 
¡yË
="display:none;">

990 <
ul
 
şass
="krumo-node">

991 <
li
 
şass
="krumo-child">

992 <
div
 
şass
="krumo-element"

993 
ÚMou£Ov”
="krumo.over(this);"

994 
ÚMou£Out
="krumo.out(this);">

995 <
a
 
şass
="krumo-Çme"><
big
>&#8734;</
	gbig
></
	ga
>

996 (<
em
 
	gşass
="krumo-ty³">
RecursiÚ
</em>)

997 </
div
>

999 </
li
>

1000 </
ul
>

1001 </
div
>

1002 <?
php


1015 
FunùiÚ
 
_¬¿y
(&
$d©a
, 
$Çme
) {

1017 <
li
 
	gşass
="krumo-child">

1019 <
div
 
şass
="krumo-element<?phpƒcho count($data) > 0 ? ' krumo-expand' : '';?>"

1020 <?
php
 ià(
couÁ
(
$d©a
è> 0è{?> 
ÚClick
="krumo.toggle(this);"<?php } ?>

1021 
	gÚMou£Ov”
="krumo.over(this);"

1022 
ÚMou£Out
="krumo.out(this);">

1024 <
a
 
şass
="krumo-Çme"><?
php
 
echo
 
$Çme
;?></
	ga
>

1025 (<
em
 
	gşass
="krumo-ty³">
A¼ay
, <
¡rÚg
 cÏss="krumo-¬¿y-Ëngth"><?
php
 
echo


1026 (
couÁ
(
$d©a
)==1)

1028 :(
couÁ
(
$d©a
)."ƒlements");

1029 ?></
	g¡rÚg
></
	gem
>)

1032 <?
php


1035 ià(
is_ÿÎabË
(
$d©a
)) {

1036 
	g$_
 = 
¬¿y_v®ues
(
$d©a
);

1038 <
¥ª
 
	gşass
="krumo-callback"> |

1039 (<
em
 
şass
="krumo-ty³">
C®lback
</em>)

1040 <
¡rÚg
 
şass
="krumo-¡ršg"><?
php


1041 
echo
 
htmlS³cŸlCh¬s
(
$_
[0]);?>::<?
php


1042 
echo
 
htmlS³cŸlCh¬s
(
$_
[1]);?>();</
	g¡rÚg
></
	g¥ª
>

1043 <?
	gphp


1047 </
	gdiv
>

1049 <?
php
 ià(
couÁ
(
$d©a
)) {

1050 
	gkrumo
::
_v¬s
(
$d©a
);

1052 </
	gli
>

1053 <?
	gphp


1066 
FunùiÚ
 
_objeù
(&
$d©a
, 
$Çme
) {

1068 <
li
 
	gşass
="krumo-child">

1070 <
div
 
şass
="krumo-element<?phpƒcho count($data) > 0 ? ' krumo-expand' : '';?>"

1071 <?
php
 ià(
couÁ
(
$d©a
è> 0è{?> 
ÚClick
="krumo.toggle(this);"<?php } ?>

1072 
	gÚMou£Ov”
="krumo.over(this);"

1073 
ÚMou£Out
="krumo.out(this);">

1075 <
a
 
şass
="krumo-Çme"><?
php
 
echo
 
$Çme
;?></
	ga
>

1076 (<
em
 
	gşass
="krumo-ty³">
Objeù
</em>)

1077 <
¡rÚg
 
şass
="krumo-şass"><?
php
 
echo
 
g‘_şass
(
$d©a
);?></
	g¡rÚg
>

1078 </
	gdiv
>

1080 <?
php
 ià(
couÁ
(
$d©a
)) {

1081 
	gkrumo
::
_v¬s
(
$d©a
);

1083 </
	gli
>

1084 <?
	gphp


1097 
FunùiÚ
 
_»sourû
(
$d©a
, 
$Çme
) {

1099 <
li
 
	gşass
="krumo-child">

1101 <
div
 
şass
="krumo-element"

1102 
ÚMou£Ov”
="krumo.over(this);"

1103 
ÚMou£Out
="krumo.out(this);">

1105 <
a
 
şass
="krumo-Çme"><?
php
 
echo
 
$Çme
;?></
	ga
>

1106 (<
em
 
	gşass
="krumo-ty³">
Resourû
</em>)

1107 <
¡rÚg
 
şass
="krumo-»sourû"><?
php
 
echo
 
g‘_»sourû_ty³
(
$d©a
);?></
	g¡rÚg
>

1108 </
	gdiv
>

1110 </
	gli
>

1111 <?
	gphp


1124 
FunùiÚ
 
_boŞ—n
(
$d©a
, 
$Çme
) {

1126 <
li
 
	gşass
="krumo-child">

1128 <
div
 
şass
="krumo-element"

1129 
ÚMou£Ov”
="krumo.over(this);"

1130 
ÚMou£Out
="krumo.out(this);">

1132 <
a
 
şass
="krumo-Çme"><?
php
 
echo
 
$Çme
;?></
	ga
>

1133 (<
em
 
	gşass
="krumo-ty³">
BoŞ—n
</em>)

1134 <
¡rÚg
 
şass
="krumo-boŞ—n"><?
php
 
echo
 
$d©a
?'TRUE':'FALSE'?></strong>

1135 </
div
>

1137 </
li
>

1138 <?
php


1151 
FunùiÚ
 
_š‹g”
(
$d©a
, 
$Çme
) {

1153 <
li
 
	gşass
="krumo-child">

1155 <
div
 
şass
="krumo-element"

1156 
ÚMou£Ov”
="krumo.over(this);"

1157 
ÚMou£Out
="krumo.out(this);">

1159 <
a
 
şass
="krumo-Çme"><?
php
 
echo
 
$Çme
;?></
	ga
>

1160 (<
em
 
	gşass
="krumo-ty³">
IÁeg”
</em>)

1161 <
¡rÚg
 
şass
="krumo-š‹g”"><?
php
 
echo
 
$d©a
;?></
	g¡rÚg
>

1162 </
	gdiv
>

1164 </
	gli
>

1165 <?
	gphp


1178 
FunùiÚ
 
_æßt
(
$d©a
, 
$Çme
) {

1180 <
li
 
	gşass
="krumo-child">

1182 <
div
 
şass
="krumo-element"

1183 
ÚMou£Ov”
="krumo.over(this);"

1184 
ÚMou£Out
="krumo.out(this);">

1186 <
a
 
şass
="krumo-Çme"><?
php
 
echo
 
$Çme
;?></
	ga
>

1187 (<
em
 
	gşass
="krumo-ty³">
Flßt
</em>)

1188 <
¡rÚg
 
şass
="krumo-æßt"><?
php
 
echo
 
$d©a
;?></
	g¡rÚg
>

1189 </
	gdiv
>

1191 </
	gli
>

1192 <?
	gphp


1205 
FunùiÚ
 
_¡ršg
(
$d©a
, 
$Çme
) {

1209 
	g$_exŒa
 = 
çl£
;

1210 
	g$_
 = 
$d©a
;

1211 ià(
¡rL’
(
$d©a
è> 
	gKRUMO_TRUNCATE_LENGTH
) {

1212 
	g$_
 = 
sub¡r
(
$d©a
, 0, 
KRUMO_TRUNCATE_LENGTH
 - 3) . '...';

1213 
	g$_exŒa
 = 
Œue
;

1216 <
li
 
	gşass
="krumo-child">

1218 <
div
 
şass
="krumo-element<?phpƒcho $_extra ? ' krumo-expand' : '';?>"

1219 <?
php
 ià(
$_exŒa
è{?> 
ÚClick
="krumo.toggle(this);"<?php } ?>

1220 
	gÚMou£Ov”
="krumo.over(this);"

1221 
ÚMou£Out
="krumo.out(this);">

1223 <
a
 
şass
="krumo-Çme"><?
php
 
echo
 
$Çme
;?></
	ga
>

1224 (<
em
 
	gşass
="krumo-ty³">
SŒšg
,

1225 <
¡rÚg
 
	gşass
="krumo-¡ršg-Ëngth"><?
php


1226 
echo
 
¡¾’
(
$d©a
è?> 
ch¬aù”s
</
¡rÚg
> </
em
>)

1227 <
¡rÚg
 
şass
="krumo-¡ršg"><?
php
 
echo
 
htmlS³cŸlCh¬s
(
$_
);?></
	g¡rÚg
>

1229 <?
php


1232 ià(
is_ÿÎabË
(
$d©a
)) {

1234 <
¥ª
 
	gşass
="krumo-callback"> |

1235 (<
em
 
şass
="krumo-ty³">
C®lback
</em>)

1236 <
¡rÚg
 
şass
="krumo-¡ršg"><?
php
 
echo
 
htmlS³cŸlCh¬s
(
$_
);?>();</
	g¡rÚg
></
	g¥ª
>

1237 <?
	gphp


1241 </
	gdiv
>

1243 <?
php
 ià(
	g$_exŒa
) { ?>

1244 <
div
 
	gşass
="krumo-Ã¡" 
¡yË
="display:none;">

1245 <
ul
 
şass
="krumo-node">

1247 <
li
 
şass
="krumo-child">

1248 <
div
 
şass
="krumo-´ev›w"><?
php
 
echo
 
htmlS³cŸlCh¬s
(
$d©a
);?></
	gdiv
>

1249 </
	gli
>

1251 </
	gul
>

1252 </
	gdiv
>

1253 <?
	gphp
 } ?>

1254 </
	gli
>

1255 <?
	gphp


1272 
FunùiÚ
 
	$krumo
() {

1273 
$_
 = 
	`func_g‘_¬gs
();

1274  
	`ÿÎ_u£r_func_¬¿y
(

1275 
	`¬¿y
('krumo', 'dump'), 
$_


1277 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/devel/performance/performance.module

1 <?
php


13 
defše
('PERFORMANCE_KEY', 'dru-³rf:'. 
$_SERVER
['HTTP_HOST'] .':');

14 
defše
('PERFORMANCE_MEMCACHE_BIN', 'cache_performance');

16 
funùiÚ
 
	$³rfÜmªû_memÿche_’abËd
() {

17 
glob®
 
$cÚf
;

19 ià(
	`funùiÚ_exi¡s
('dmemÿche_£t'è&& 
	`is£t
(
$cÚf
['memcache_bins']['cache_performance'])) {

20  
TRUE
;

22  
FALSE
;

23 
	}
}

25 
funùiÚ
 
	$³rfÜmªû_m’u
() {

26 
$™ems
 = 
	`¬¿y
();

28 
$™ems
['admš/£‰šgs/³rfÜmªû_loggšg'] = 
	`¬¿y
(

32 '·g¬gum’ts' => 
	`¬¿y
('performance_settings'),

33 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

36 
$™ems
['admš/£‰šgs/³rfÜmªû_loggšg/­c_ş—r'] = 
	`¬¿y
(

40 '·g¬gum’ts' => 
	`¬¿y
('performance_clear_apc_confirm'),

41 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

44 
$™ems
['admš/£‰šgs/³rfÜmªû_loggšg/memÿche_ş—r'] = 
	`¬¿y
(

48 '·g¬gum’ts' => 
	`¬¿y
('performance_clear_memcache_confirm'),

49 'acûs ¬gum’ts' => 
	`¬¿y
('access‡dministration…ages'),

52 
$™ems
['admš/»pÜts/³rfÜmªû_loggšg_summ¬y'] = 
	`¬¿y
(

56 'acûs ¬gum’ts' => 
	`¬¿y
('access site„eports'),

59 
$™ems
['admš/»pÜts/³rfÜmªû_loggšg_d‘as'] = 
	`¬¿y
(

63 'acûs ¬gum’ts' => 
	`¬¿y
('access site„eports'),

66  
$™ems
;

67 
	}
}

69 
funùiÚ
 
	$³rfÜmªû_£‰šgs
() {

70 
$İtiÚs
 = 
	`¬¿y
(

71 0 => 
	`t
('Disabled'),

72 1 => 
	`t
('Enabled'),

75 ià(
	`funùiÚ_exi¡s
('apc_cache_info')) {

76 
	`dru·l_£t_mes§ge
(
	`t
('APC i ’abËd. Iˆi »asÚably saãØ’abË summ¬y†oggšg oÀlivs™es.'), '¡©us', 
FALSE
);

79 
	`dru·l_£t_mes§ge
(
	`t
('APC i nÙƒÇbËd. Iˆi <¡rÚg>nÙ</¡rÚg> saãØ’abË summ¬y†oggšgØthd©aba£ oÀlivs™es.'), '”rÜ', 
FALSE
);

82 
$fÜm
['mode'] = 
	`¬¿y
(

84 '#t™Ë' => 
	`t
('Logging mode'),

85 '#cŞÏpsibË' => 
TRUE
,

88 
$fÜm
['mode']['³rfÜmªû_d‘a'] = 
	`¬¿y
(

90 '#t™Ë' => 
	`t
('Detailed†ogging'),

91 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('performance_detail', 0),

92 '#İtiÚs' => 
$İtiÚs
,

93 '#desütiÚ' => 
	`t
('Log memory usage‡nd…age generationimes forƒvery…age. This†ogging mode is <strong>not</strong> suitable for†arge sites,‡s it can degrade…erformance severly. It is intended for use by developers, or on‡est copy ofhe site.'),

96 
$fÜm
['mode']['³rfÜmªû_summ¬y_db'] = 
	`¬¿y
(

98 '#t™Ë' => 
	`t
('Summary†ogging (DB)'),

99 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('performance_summary_db', 0),

100 '#İtiÚs' => 
$İtiÚs
,

101 '#desütiÚ' => 
	`t
('Log summary data, such‡s‡verage‡nd maximum…age generationimes‡nd memory usageohe database. This†ogging mode is <strong>not</strong> suitable for most†ive sites.'),

104 
$di§bËd
 = 
TRUE
;

105 ià(
	`funùiÚ_exi¡s
('apc_cache_info')) {

106 
$di§bËd
 = 
FALSE
;

109 
$fÜm
['mode']['³rfÜmªû_summ¬y_­c'] = 
	`¬¿y
(

111 '#t™Ë' => 
	`t
('Summary†ogging (APC)'),

112 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('performance_summary_apc', 0),

113 '#İtiÚs' => 
$İtiÚs
,

114 '#di§bËd' => 
$di§bËd
,

115 '#desütiÚ' => 
	`t
('Log summary data, such‡s‡verage‡nd maximum…age generationimes‡nd memory usageo APC, if installed. The summary will be stored in APC memory,‡nd hencehere is‚o†oad onhe database. This†oggingo APC is suitable for most†ive sites, unlesshe‚umber of unique…age‡ccesses isƒxcessively high.'),

118 
$di§bËd
 = 
TRUE
;

119 ià(
	`³rfÜmªû_memÿche_’abËd
()) {

120 
$di§bËd
 = 
FALSE
;

123 
$fÜm
['mode']['³rfÜmªû_summ¬y_memÿche'] = 
	`¬¿y
(

125 '#t™Ë' => 
	`t
('Summary†ogging (Memcached)'),

126 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('performance_summary_memcache', 0),

127 '#İtiÚs' => 
$İtiÚs
,

128 '#di§bËd' => 
$di§bËd
,

129 '#desütiÚ' => 
	`t
('Log summary data, such‡s‡verage‡nd maximum…age generationimes‡nd memory usageo Memcached, if installed. The summary will be stored in Memcached memory,‡nd hencehere is‚o†oad onhe database. This†oggingo Memcached is suitable for most†ive sites, unlesshe‚umber of unique…age‡ccesses isƒxcessively high.'),

132 
$fÜm
['Ùh”'] = 
	`¬¿y
(

134 '#t™Ë' => 
	`t
('Other'),

135 '#cŞÏpsibË' => 
TRUE
,

138 
$fÜm
['Ùh”']['dev_qu”y'] = 
	`¬¿y
(

140 '#di§bËd' => 
TRUE
,

141 '#t™Ë' => 
	`t
('Database Queryiming‡nd count'),

142 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('dev_query', 0),

143 '#İtiÚs' => 
$İtiÚs
,

144 '#desütiÚ' => 
	`t
('Log database queryiming‡nd query count forƒach…age. This is usefulo know ifhe bottleneck is inƒxcessive database query counts, orheime„equiredoƒxecutehose queries is high. Enablinghis will incurr some memory overhead‡s queryimes‡ndhe‡ctual query strings‡re cached in memory‡s‡rrays forƒach…age, hence skewinghe overall…age memory„eported. Please‚otehathis settings isƒnabled or disabled inhe settings ofhe devel module.'),

147 
$fÜm
['Ùh”']['³rfÜmªû_th»shŞd_acûs£s'] = 
	`¬¿y
(

149 '#t™Ë' => 
	`t
('Accesseshreshold'),

150 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('performance_threshold_accesses', 0),

151 '#İtiÚs' => 
	`¬¿y
(0, 1, 2, 5, 10),

152 '#desütiÚ' => 
	`t
('When displayinghe summary„eport‡nd using APC, only…ages withhe‚umber of‡ccesses†argerhanhe specifiedhreshold will be shown. Also, when cron„uns,…ages withhat‚umber of‡ccesses or†ess will be„emoved, so‡s‚oto overflow APC\'s shared memory. This is useful on‡†ive site with‡ high volume of hits. On‡ development site, you…robably wanthis seto 0, so you can see‡ll…ages.'),

155  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

156 
	}
}

158 
funùiÚ
 
	$³rfÜmªû_boÙ
() {

159 
	`»gi¡”_shutdown_funùiÚ
('performance_shutdown');

160 
	}
}

162 
funùiÚ
 
	$³rfÜmªû_shutdown
() {

163 
glob®
 
$qu”›s
;

166 ià(
	`is£t
(
$_GET
['q']) && ($_GET['q'])) {

168 
$·th
 = 
$_GET
['q'];

172 
$·th
 = 
	`v¬ŸbË_g‘
('site_frontpage', 'node');

175 
$·¿ms
 = 
	`¬¿y
(

176 'tim”' => 
	`tim”_»ad
('page'),

177 '·th' => 
$·th
,

181 ià(
	`funùiÚ_exi¡s
('memory_get_peak_usage')) {

182 
$·¿ms
['mem'] = 
	`memÜy_g‘_³ak_u§ge
(
TRUE
);

185 
$·¿ms
['mem'] = 0;

189 
$qu”y_couÁ
 = 0;

190 
$qu”y_tim”
 = 0;

191 
$sum
 = 0;

192 ià(
	`v¬ŸbË_g‘
('dev_qu”y', 0è&& 
	`is_¬¿y
(
$qu”›s
)) {

193 
	`fÜ—ch
 (
$qu”›s
 
as
 
$qu”y
) {

194 
$sum
 +ğ
$qu”y
[1];

196 
$qu”y_couÁ
 = 
	`couÁ
(
$qu”›s
);

197 
$qu”y_tim”
 = 
	`round
(
$sum
 * 1000, 2);

200 
$·¿ms
['qu”y_couÁ'] = 
$qu”y_couÁ
;

201 
$·¿ms
['qu”y_tim”'] = 
$qu”y_tim”
;

203 
$ªÚ
 = (!
	`em±y
(
$d©a
['anon']))? 'Yes' : 'No';

205 
$h—d”
 = 
	`¬¿y
(

206 '·th' => 
$·th
,

207 'tim”' => 
$·¿ms
['timer'],

208 'ªÚ' => 
$ªÚ
,

210 
	`moduË_švoke_®l
('³rfÜmªû', 'h—d”', 
$h—d”
);

212 ià(
	`v¬ŸbË_g‘
('performance_detail', 0)) {

213 
$d©a
 = 
	`moduË_švoke_®l
('performance', 'data');

214 ià(!
	`em±y
(
$d©a
[0])) {

215 
$·¿ms
['d©a'] = 
$d©a
[0];

218 
	`³rfÜmªû_log_d‘as
(
$·¿ms
);

221 
	`moduË_švoke_®l
('performance', 'disable');

224 ià(
	`v¬ŸbË_g‘
('performance_summary_db', 0)) {

225 
	`³rfÜmªû_log_summ¬y_db
(
$·¿ms
);

228 ià(
	`v¬ŸbË_g‘
('performance_summary_apc', 0)) {

229 ià(
	`funùiÚ_exi¡s
('apc_cache_info')) {

230 
	`³rfÜmªû_log_summ¬y_­c
(
$·¿ms
);

234 ià(
	`v¬ŸbË_g‘
('performance_summary_memcache', 0)) {

235 ià(
	`³rfÜmªû_memÿche_’abËd
()) {

236 
	`³rfÜmªû_log_summ¬y_memÿche
(
$·¿ms
);

239 
	}
}

241 
funùiÚ
 
³rfÜmªû_log_summ¬y_­c
(
$·¿ms
 = 
	$¬¿y
()) {

242 
$key
 = 
PERFORMANCE_KEY
 . 
$·¿ms
['path'];

243 ià(
$d©a
 = 
	`­c_ãtch
(
$key
)) {

244 
$d©a
 = 
	`¬¿y
(

245 '·th' => 
$d©a
['path'],

246 'Ï¡_acûss' => 
	`time
(),

247 'by‹s_max' => 
	`max
(
$·¿ms
['mem'], 
$d©a
['bytes_max']),

248 'by‹s_avg' => (
$d©a
['by‹s_avg'] + 
$·¿ms
['mem']) / 2,

249 'ms_max' => 
	`max
(
$·¿ms
['tim”'], 
$d©a
['ms_max']),

250 'ms_avg' => (
$d©a
['ms_avg'] + 
$·¿ms
['timer']) / 2,

251 'qu”y_tim”_max' => 
	`max
(
$·¿ms
['qu”y_tim”'], 
$d©a
['query_timer_max']),

252 'qu”y_tim”_avg' => (
$d©a
['qu”y_tim”_avg'] + 
$·¿ms
['query_timer']) / 2,

253 'qu”y_couÁ_max' => 
	`max
(
$·¿ms
['qu”y_couÁ'], 
$d©a
['query_count_max']),

254 'qu”y_couÁ_avg' => (
$d©a
['qu”y_couÁ_avg'] + 
$·¿ms
['query_count']) / 2,

255 'num_acûs£s' => 
$d©a
['num_accesses'] + 1,

259 
$d©a
 = 
	`¬¿y
(

260 '·th' => 
$·¿ms
['path'],

261 'by‹s_max' => 
$·¿ms
['mem'],

262 'by‹s_avg' => 
$·¿ms
['mem'],

263 'ms_max' => 
$·¿ms
['timer'],

264 'ms_avg' => 
$·¿ms
['timer'],

265 'qu”y_tim”_max' => 
$·¿ms
['query_timer'],

266 'qu”y_tim”_avg' => 
$·¿ms
['query_timer'],

267 'qu”y_couÁ_max' => 
$·¿ms
['query_count'],

268 'qu”y_couÁ_avg' => 
$·¿ms
['query_count'],

270 'Ï¡_acûss' => 
	`time
(),

273 
	`­c_¡Üe
(
$key
, 
$d©a
);

274 
	}
}

276 
funùiÚ
 
³rfÜmªû_log_summ¬y_memÿche
(
$·¿ms
 = 
	$¬¿y
()) {

277 
$key
 = 
PERFORMANCE_KEY
 . 
$·¿ms
['path'];

278 ià(
$ÿche
 = 
	`ÿche_g‘
(
$key
, 
PERFORMANCE_MEMCACHE_BIN
)) {

279 
$ty³
 = 'existing';

280 
$v®ues
 = 
$ÿche
->
d©a
;

281 
$v®ues
 = 
	`¬¿y
(

282 '·th' => 
$·¿ms
['path'],

283 'Ï¡_acûss' => 
	`time
(),

284 'by‹s_max' => 
	`max
(
$·¿ms
['mem'], 
$v®ues
['bytes_max']),

285 'by‹s_avg' => (
$v®ues
['by‹s_avg'] + 
$·¿ms
['mem']) / 2,

286 'ms_max' => 
	`max
(
$·¿ms
['tim”'], 
$v®ues
['ms_max']),

287 'ms_avg' => (
$v®ues
['ms_avg'] + 
$·¿ms
['timer']) / 2,

288 'qu”y_tim”_max' => 
	`max
(
$·¿ms
['qu”y_tim”'], 
$v®ues
['query_timer_max']),

289 'qu”y_tim”_avg' => (
$v®ues
['qu”y_tim”_avg'] + 
$·¿ms
['query_timer']) / 2,

290 'qu”y_couÁ_max' => 
	`max
(
$·¿ms
['qu”y_couÁ'], 
$v®ues
['query_count_max']),

291 'qu”y_couÁ_avg' => (
$v®ues
['qu”y_couÁ_avg'] + 
$·¿ms
['query_count']) / 2,

292 'num_acûs£s' => 
$v®ues
['num_accesses'] + 1,

296 
$ty³
 = 'new';

298 
$v®ues
 = 
	`¬¿y
(

299 '·th' => 
$·¿ms
['path'],

300 'by‹s_max' => 
$·¿ms
['mem'],

301 'by‹s_avg' => 
$·¿ms
['mem'],

302 'ms_max' => 
$·¿ms
['timer'],

303 'ms_avg' => 
$·¿ms
['timer'],

304 'qu”y_tim”_max' => 
$·¿ms
['query_timer'],

305 'qu”y_tim”_avg' => 
$·¿ms
['query_timer'],

306 'qu”y_couÁ_max' => 
$·¿ms
['query_count'],

307 'qu”y_couÁ_avg' => 
$·¿ms
['query_count'],

309 'Ï¡_acûss' => 
	`time
(),

312 ià(
$keys_ÿche
 = 
	`ÿche_g‘
(
PERFORMANCE_KEY
, 
PERFORMANCE_MEMCACHE_BIN
)) {

313 
$keys_v®ues
 = 
$keys_ÿche
->
d©a
;

315 
$keys_v®ues
[
$key
] = 1;

316 
	`ÿche_£t
(
PERFORMANCE_KEY
, 
$keys_v®ues
, 
PERFORMANCE_MEMCACHE_BIN
, 
CACHE_PERMANENT
);

318 
	`ÿche_£t
(
$key
, 
$v®ues
, 
PERFORMANCE_MEMCACHE_BIN
, 
CACHE_PERMANENT
);

319 
	}
}

321 
funùiÚ
 
³rfÜmªû_log_summ¬y_db
(
$·¿ms
 = 
	$¬¿y
()) {

322 
$row
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT * FROM {³rfÜmªû_summ¬y} WHERE…©h = '%s'", 
$·¿ms
['path']));

323 ià(!
	`em±y
(
$row
)) {

324 
	`db_qu”y
("UPDATE {performance_summary}

325 
SET
 
Ï¡_acûss
 = %
d
,

326 
num_acûs£s
 =‚um_accesses + 1,

327 
by‹s_max
 = %
d
,

328 
by‹s_avg
 = %
d
,

329 
ms_max
 = %
d
,

330 
ms_avg
 = %
d
,

331 
qu”y_tim”_max
 = %
d
,

332 
qu”y_tim”_avg
 = %
d
,

333 
qu”y_couÁ_max
 = %
d
,

334 
qu”y_couÁ_avg
 = %
d


335 
WHERE
 
·th
 = '%s'",

336 
	`time
(),

337 
	`max
(
$·¿ms
['mem'], 
$row
->
by‹s_max
),

338 (
$row
->
by‹s_avg
 + 
$·¿ms
['mem']) / 2,

339 
	`max
(
$·¿ms
['tim”'], 
$row
->
ms_max
),

340 (
$row
->
ms_avg
 + 
$·¿ms
['timer']) / 2,

341 
	`max
(
$·¿ms
['qu”y_tim”'], 
$row
->
qu”y_tim”_max
),

342 (
$row
->
qu”y_tim”_avg
 + 
$·¿ms
['query_timer']) / 2,

343 
	`max
(
$·¿ms
['qu”y_couÁ'], 
$row
->
qu”y_couÁ_max
),

344 (
$row
->
qu”y_couÁ_avg
 + 
$·¿ms
['query_count']) / 2,

345 
$·¿ms
['path']);

349 
	`db_qu”y
("INSERT INTO {performance_summary}

350 (
·th
, 
Ï¡_acûss
, 
num_acûs£s
,

351 
by‹s_max
, 
by‹s_avg
, 
ms_max
, 
ms_avg
,

352 
qu”y_couÁ_max
, 
qu”y_couÁ_avg
, 
qu”y_tim”_max
, 
qu”y_tim”_avg
)

353 
VALUES


354 ('%s', %
d
, %d, %d, %d, %d, %d, %d, %d, %d, %d)",

355 
$·¿ms
['path'],

356 
	`time
(),

358 
$·¿ms
['mem'],

359 
$·¿ms
['mem'],

360 
$·¿ms
['timer'],

361 
$·¿ms
['timer'],

362 
$·¿ms
['query_count'],

363 
$·¿ms
['query_count'],

364 
$·¿ms
['query_timer'],

365 
$·¿ms
['query_timer']

368 
	}
}

370 
funùiÚ
 
³rfÜmªû_log_d‘as
(
$·¿ms
 = 
	$¬¿y
()) {

371 
glob®
 
$u£r
;

372 
$ªÚ
 = (
$u£r
->
uid
è? 
FALSE
 : 
TRUE
;

373 
	`db_qu”y
("INSERT INTO {performance_detail} (path,‡non, bytes, ms,imestamp, query_timer, query_count, data) VALUES ('%s', %d, %d, %d, %d, %d, %d, '%s')",

374 
$·¿ms
['path'],

375 
$ªÚ
,

376 
$·¿ms
['mem'],

377 
$·¿ms
['timer'],

378 
	`time
(),

379 
$·¿ms
['query_timer'],

380 
$·¿ms
['query_count'],

381 
$·¿ms
['data']

383 
	}
}

385 
funùiÚ
 
	$³rfÜmªû_­c_li¡_®l
() {

386 
$key_li¡
 = 
	`¬¿y
();

387 
$li¡
 = 
	`­c_ÿche_šfo
('user');

388 
	`fÜ—ch
 (
$li¡
['ÿche_li¡'] 
as
 
$ÿche_id
 => 
$ÿche_d©a
) {

389 
$»gex
 = '/^'. 
PERFORMANCE_KEY
 .'/';

390 ià(
	`´eg_m©ch
(
$»gex
, 
$ÿche_d©a
['info'])) {

391 
$key_li¡
[] = 
$ÿche_d©a
['info'];

394  
$key_li¡
;

395 
	}
}

404 
funùiÚ
 
	$³rfÜmªû_summ¬y_sÜt
(
$x
, 
$y
) {

407 
	}
}

409 
funùiÚ
 
	$³rfÜmªû_v›w_summ¬y
() {

410 
$sum
 = 
	`¬¿y
();

411 
$d©a_li¡
 = 
	`¬¿y
();

412 
$rows
 = 
	`¬¿y
();

414 
$sum
[] = 
	`v¬ŸbË_g‘
('performance_summary_db', 0);

415 
$sum
[] = 
	`v¬ŸbË_g‘
('performance_summary_apc', 0);

416 
$sum
[] = 
	`v¬ŸbË_g‘
('performance_summary_memcache', 0);

417 
$go
 = 
	`¬¿y_sum
(
$sum
);

419 ià(!
$go
) {

420  
	`t
('Summ¬y…”fÜmªû†og i nÙƒÇbËd. GØtØth<¨h»f="@lšk">£‰šg ·ge</a>Ø’abË it.', 
	`¬¿y
('@lšk' => 
	`u¾
('admin/settings/performance_logging')));

423 
$h—d”
 = 
	`¬¿y
();

425 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Path'), 'field' => 'path');

426 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Last‡ccess'), 'field' => 'last_access');

427 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('#‡ccesses'), 'field' => 'num_accesses');

428 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Max Memory (MB)'), 'field' => 'bytes_max');

429 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Avg Memory (MB)'), 'field' => 'bytes_avg');

430 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('ms (Max)'), 'field' => 'ms_max');

431 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('ms (Avg)'), 'field' => 'ms_avg');

433 ià(
	`v¬ŸbË_g‘
('dev_query', 0)) {

434 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Query ms (Max)'), 'field' => 'query_timer_max');

435 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Query ms (Avg)'), 'field' => 'query_timer_avg');

436 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Query Count (Max)'), 'field' => 'query_count_max');

437 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Query Count (Avg)'), 'field' => 'query_count_avg');

440 
$tÙ®_rows
 = 
$shown
 = 
$Ï¡_max
 = 
$tÙ®_by‹s
 = 
$tÙ®_ms
 = 
$tÙ®_acûs£s
 = 0;

441 
$Ï¡_mš
 = 
	`time
();

443 
$th»shŞd
 = 
	`v¬ŸbË_g‘
('performance_threshold_accesses', 0);

445 ià(
	`v¬ŸbË_g‘
('³rfÜmªû_summ¬y_memÿche', 0è&& 
	`³rfÜmªû_memÿche_’abËd
()) {

446 
$bËsÜt
 = 
	`bËsÜt_š™
(
$h—d”
);

448 ià(
$keys_ÿche
 = 
	`ÿche_g‘
(
PERFORMANCE_KEY
, 
PERFORMANCE_MEMCACHE_BIN
)) {

449 ià(
$keys_ÿche
->
d©a
) {

450 
	`fÜ—ch
 (
$keys_ÿche
->
d©a
 
as
 
$key
 => 
$v
) {

451 
$ÿche
 = 
	`ÿche_g‘
(
$key
, 
PERFORMANCE_MEMCACHE_BIN
);

452 
$d©a_li¡
[] = 
$ÿche
->
d©a
;

456 
	`usÜt
(
$d©a_li¡
, 'performance_summary_sort');

458 ià(
	`v¬ŸbË_g‘
('³rfÜmªû_summ¬y_­c', 0è&& 
	`funùiÚ_exi¡s
('apc_cache_info')) {

459 
$bËsÜt
 = 
	`bËsÜt_š™
(
$h—d”
);

461 
	`fÜ—ch
 (
	`³rfÜmªû_­c_li¡_®l
(è
as
 
$key
) {

462 
$d©a_li¡
[] = 
	`­c_ãtch
(
$key
è+ 
$bËsÜt
;

464 
	`usÜt
(
$d©a_li¡
, 'performance_summary_sort');

468 
$sql
 = "SELECT * FROM {performance_summary}";

469 
$bËsÜt
 = 
	`bËsÜt_sql
(
$h—d”
);

470 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
 . 
$bËsÜt
, 50);

471 
$row
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

472 
$d©a_li¡
[] = 
$row
;

476 
	`fÜ—ch
 (
$d©a_li¡
 
as
 
$d©a
) {

477 
$tÙ®_rows
++;

478 
$Ï¡_max
 = 
	`max
($Ï¡_max, 
$d©a
['last_access']);

479 
$Ï¡_mš
 = 
	`mš
($Ï¡_mš, 
$d©a
['last_access']);

482 
$tÙ®_by‹s
 +ğ
$d©a
['bytes_avg'];

483 
$tÙ®_ms
 +ğ
$d©a
['ms_avg'];

484 
$tÙ®_acûs£s
 +ğ
$d©a
['num_accesses'];

486 
$row_d©a
 = 
	`¬¿y
();

488 ià(
$d©a
['num_acûs£s'] > 
$th»shŞd
) {

489 
$shown
++;

490 
$row_d©a
[] = 
	`check_¶aš
(
$d©a
['path']);

491 
$row_d©a
[] = 
	`fÜm©_d©e
(
$d©a
['last_access'], 'small');

492 
$row_d©a
[] = 
$d©a
['num_accesses'];

493 
$row_d©a
[] = 
	`numb”_fÜm©
(
$d©a
['bytes_max']/1024/1024, 2);

494 
$row_d©a
[] = 
	`numb”_fÜm©
(
$d©a
['bytes_avg']/1024/1024, 2);

495 
$row_d©a
[] = 
	`numb”_fÜm©
(
$d©a
['ms_max'], 1);

496 
$row_d©a
[] = 
	`numb”_fÜm©
(
$d©a
['ms_avg'], 1);

497 ià(
	`v¬ŸbË_g‘
('dev_query', 0)) {

498 
$row_d©a
[] = 
	`numb”_fÜm©
(
$d©a
['query_timer_max'], 1);

499 
$row_d©a
[] = 
	`numb”_fÜm©
(
$d©a
['query_timer_avg'], 1);

500 
$row_d©a
[] = 
$d©a
['query_count_max'];

501 
$row_d©a
[] = 
$d©a
['query_count_avg'];

504 
$rows
[] = 
	`¬¿y
('d©a' => 
$row_d©a
);

507 ià(!
$rows
) {

508 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('NØ¡©i¡ic avaabË y‘.'), 'cŞ¥ª' => 
	`couÁ
(
$h—d”
)));

511 
$ouut
 = '';

512 ià(
$th»shŞd
) {

513 
$ouut
 .ğ
	`t
('Showing !shown…aths with morehan !threshold‡ccesses, out of !totalotal…aths.',

514 
	`¬¿y
('!th»shŞd' => 
$th»shŞd
, '!shown' => 
$shown
, '!tÙ®' => 
$tÙ®_rows
)) .'<br/>';

517 
$ouut
 .ğ
	`t
('Showšg‡Î !tÙ®…©hs.', 
	`¬¿y
('!tÙ®' => 
$tÙ®_rows
)) .'<br/>';

521 ià(
$tÙ®_rows
 > 0) {

522 
$mb_avg
 = 
	`numb”_fÜm©
(
$tÙ®_by‹s
/
$tÙ®_rows
/1024/1024, 1);

523 
$ms_avg
 = 
	`numb”_fÜm©
(
$tÙ®_ms
/
$tÙ®_rows
, 2);

526 
$mb_avg
 = 'n/a';

527 
$ms_avg
 = 'n/a';

530 
$ouut
 .ğ
	`t
('Av”agmemÜy…”…age: !mb_avg MB', 
	`¬¿y
('!mb_avg' => 
$mb_avg
)) .'<br/>';

531 
$ouut
 .ğ
	`t
('Av”agm ³¸·ge: !ms_avg', 
	`¬¿y
('!ms_avg' => 
$ms_avg
)) .'<br/>';

532 
$ouut
 .ğ
	`t
('TÙ®‚umb” oà·gacûs£s: !acûs£s', 
	`¬¿y
('!acûs£s' => 
$tÙ®_acûs£s
)) .'<br/>';

533 
$ouut
 .ğ
	`t
('Fœ¡‡cûss: !acûss.', 
	`¬¿y
('!acûss' => 
	`fÜm©_d©e
(
$Ï¡_mš
, 'small'))) .'<br/>';

534 
$ouut
 .ğ
	`t
('La¡‡cûss: !acûss.', 
	`¬¿y
('!acûss' => 
	`fÜm©_d©e
(
$Ï¡_max
, 'small'))) .'<br/>';

536 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

537 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 50, 0);

539  
$ouut
;

540 
	}
}

542 
funùiÚ
 
	$³rfÜmªû_v›w_d‘as
() {

543 ià(!
	`v¬ŸbË_g‘
('performance_detail', 0)) {

544  
	`t
('D‘a…”fÜmªû†og i nÙƒÇbËd. GØtØth<¨h»f="@lšk">£‰šg ·ge</a>Ø’abË it.', 
	`¬¿y
('@lšk' => 
	`u¾
('admin/settings/performance_logging')));

547 
$h—d”
 = 
	`¬¿y
(

548 
	`¬¿y
('d©a' => 
	`t
('#'), 'field' => 'pid', 'sort' => 'desc'),

549 
	`¬¿y
('d©a' => 
	`t
('Date'), 'field' => 'timestamp'),

550 
	`¬¿y
('d©a' => 
	`t
('Path'), 'field' => 'path'),

551 
	`¬¿y
('d©a' => 
	`t
('Memory (MB)'), 'field' => 'bytes'),

552 
	`¬¿y
('d©a' => 
	`t
('ms (Total)'), 'field' => 'ms'),

553 
	`¬¿y
('d©a' => 
	`t
('Anonymous?'), 'field' => 'anon'),

556 ià(
	`v¬ŸbË_g‘
('dev_query', 0)) {

557 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('# Queries'), 'field' => 'query_count');

558 
$h—d”
[] = 
	`¬¿y
('d©a' => 
	`t
('Query ms'), 'field' => 'query_timer');

561 
$sql
 = "SELECT * FROM {performance_detail}";

562 
$bËsÜt
 = 
	`bËsÜt_sql
(
$h—d”
);

563 
$»suÉ
 = 
	`·g”_qu”y
(
$sql
 . 
$bËsÜt
, 50);

565 
$d©a
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

566 
$row_d©a
 = 
	`¬¿y
();

568 
$row_d©a
[] = 
$d©a
['pid'];

569 
$row_d©a
[] = 
	`fÜm©_d©e
(
$d©a
['timestamp'], 'small');

570 
$row_d©a
[] = 
	`check_¶aš
(
$d©a
['path']);

571 
$row_d©a
[] = 
	`numb”_fÜm©
(
$d©a
['bytes']/1024/1024, 2);

572 
$row_d©a
[] = 
$d©a
['ms'];

573 
$row_d©a
[] = (
$d©a
['ªÚ']è? 
	`t
('Yes') :('No');

575 ià(
	`v¬ŸbË_g‘
('dev_query', 0)) {

576 
$row_d©a
[] = 
$d©a
['query_count'];

577 
$row_d©a
[] = 
$d©a
['query_timer'];

580 
$rows
[] = 
	`¬¿y
('d©a' => 
$row_d©a
);

583 ià(!
$rows
) {

584 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('NØlog mes§ge avaabË.'), 'cŞ¥ª' => 
	`couÁ
(
$h—d”
)));

587 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

588 
$ouut
 .ğ
	`theme
('·g”', 
NULL
, 50, 0);

590  
$ouut
;

591 
	}
}

593 
funùiÚ
 
	$³rfÜmªû_üÚ
() {

595 
$time¡amp
 = 
	`time
() - 24*60*60;

597 
	`³rfÜmªû_üÚ_db_´uÃ
(
$time¡amp
);

598 
	`³rfÜmªû_üÚ_­c_´uÃ
(
$time¡amp
);

599 
	}
}

601 
funùiÚ
 
	$³rfÜmªû_üÚ_db_´uÃ
(
$time¡amp
 = 0) {

603 
	`db_qu”y
("DELETE FROM {³rfÜmªû_summ¬y} WHERE†a¡_acûs <ğ%d", 
$time¡amp
);

606 
	`db_qu”y
("DELETE FROM {³rfÜmªû_d‘a} WHEREime¡am°<ğ%d", 
$time¡amp
);

607 
	}
}

609 
funùiÚ
 
	$³rfÜmªû_üÚ_­c_´uÃ
(
$time¡amp
 = 0) {

610 ià(!
	`funùiÚ_exi¡s
('apc_cache_info')) {

616 
$li¡
 = 
	`³rfÜmªû_­c_li¡_®l
();

617 ià(!
	`couÁ
(
$li¡
)) {

622 
	`fÜ—ch
 (
$li¡
 
as
 
$key
) {

623 ià(
$d©a
 = 
	`­c_ãtch
(
$key
)) {

624 ià(
$d©a
['Ï¡_acûss'] <ğ
$time¡amp
) {

625 
	`­c_d–‘e
(
$key
);

629 
	}
}

631 
funùiÚ
 
	$³rfÜmªû_ş—r_­c_cÚfœm
() {

632 
$fÜm
['cÚfœm'] = 
	`¬¿y
(

633 '#v®ue' => 
	`t
('Confirm APC clear'),

635  
	`cÚfœm_fÜm
(

636 
$fÜm
,

637 
	`t
('Are you sure you wanto clearhe APC statistics forhis site?'),

639 
	`t
('This will clear‡llhe collected…erformance statistics stored in APC. This‡ction cannot be undone.'),

640 
	`t
('Clear'),

641 
	`t
('Cancel'));

642 
	}
}

644 
funùiÚ
 
	$³rfÜmªû_ş—r_­c_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

645 ià(!
	`funùiÚ_exi¡s
('apc_cache_info')) {

646 
	`dru·l_£t_mes§ge
(
	`t
('APC i nÙƒÇbËd. NÙhšgØdØ...'), '¡©us', 
FALSE
);

647 
	`dru·l_gÙo
('admin/settings/performance');

651 
$li¡
 = 
	`³rfÜmªû_­c_li¡_®l
();

652 ià(!
	`couÁ
(
$li¡
)) {

657 
	`fÜ—ch
 (
$li¡
 
as
 
$key
) {

658 ià(
$d©a
 = 
	`­c_ãtch
(
$key
)) {

659 
	`­c_d–‘e
(
$key
);

663 
	`dru·l_£t_mes§ge
(
	`t
('P”fÜmªû sti¡ic cŞËùed iÀAPC ha b“Àş—»d.'), '¡©us', 
FALSE
);

664 
	`dru·l_gÙo
('admin/settings/performance');

665 
	}
}

667 
funùiÚ
 
	$³rfÜmªû_ş—r_memÿche_cÚfœm
() {

668 
$fÜm
['cÚfœm'] = 
	`¬¿y
(

669 '#v®ue' => 
	`t
('Confirm Memcache clear'),

671  
	`cÚfœm_fÜm
(

672 
$fÜm
,

673 
	`t
('Are you sure you wanto clearhe Memcache statistics forhis site?'),

675 
	`t
('This will clear‡llhe collected…erformance statistics stored in Memcache. This‡ction cannot be undone.'),

676 
	`t
('Clear'),

677 
	`t
('Cancel'));

678 
	}
}

680 
funùiÚ
 
	$³rfÜmªû_ş—r_memÿche_cÚfœm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

681 ià(!
	`³rfÜmªû_memÿche_’abËd
()) {

682 
	`dru·l_£t_mes§ge
(
	`t
('Memÿchi nÙƒÇbËd. NÙhšgØdØ...'), '¡©us', 
FALSE
);

683 
	`dru·l_gÙo
('admin/settings/performance');

690 ià(
$keys_ÿche
 = 
	`ÿche_g‘
(
PERFORMANCE_KEY
, 
PERFORMANCE_MEMCACHE_BIN
)) {

691 ià(
$keys_ÿche
->
d©a
) {

692 
	`fÜ—ch
 (
$keys_ÿche
->
d©a
 
as
 
$key
 => 
$v
) {

693 
	`dmemÿche_d–‘e
(
$key
, 
PERFORMANCE_MEMCACHE_BIN
);

695 
	`dmemÿche_d–‘e
(
PERFORMANCE_KEY
, 
PERFORMANCE_MEMCACHE_BIN
);

699 
	`dru·l_£t_mes§ge
(
	`t
('P”fÜmªû sti¡ic cŞËùed iÀMemÿchha b“Àş—»d.'), '¡©us', 
FALSE
);

700 
	`dru·l_gÙo
('admin/settings/performance');

701 
	}
}

706 
funùiÚ
 
	$³rfÜmªû_Çgios_šfo
() {

707  
	`¬¿y
(

711 
	}
}

716 
funùiÚ
 
	$³rfÜmªû_Çgios
() {

717 
$šfo
 = 
	`³rfÜmªû_Çgios_šfo
();

718 
$id
 = 
$šfo
['id'];

721 
$sum
 = 
	`¬¿y
();

723 
$sum
[] = 
	`v¬ŸbË_g‘
('performance_summary_db', 0);

724 
$sum
[] = 
	`v¬ŸbË_g‘
('performance_summary_apc', 0);

725 
$go
 = 
	`¬¿y_sum
(
$sum
);

727 ià(!
$go
) {

728  
	`¬¿y
(

729 
$id
 => 
	`¬¿y
(

730 '¡©us' => 
NAGIOS_STATUS_UNKNOWN
,

732 '‹xt' => 
	`t
('Performance†ogging is‚otƒnabled'),

738 
$tÙ®_rows
 = 
$tÙ®_by‹s
 = 
$tÙ®_ms
 = 
$tÙ®_acûs£s
 = 
$tÙ®_qu”y_time
 = 
$tÙ®_qu”y_couÁ
 = 0;

741 ià(
	`v¬ŸbË_g‘
('³rfÜmªû_summ¬y_­c', 0è&& 
	`funùiÚ_exi¡s
('apc_cache_info')) {

743 
	`fÜ—ch
 (
	`³rfÜmªû_­c_li¡_®l
(è
as
 
$key
) {

744 
$d©a_li¡
[] = 
	`­c_ãtch
(
$key
);

749 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {³rfÜmªû_summ¬y} WHERE†a¡_acûs >ğ%d", 
	`time
() - 15*60);

750 
	`is_¬¿y
(
$row
 = 
	`db_ãtch_¬¿y
(
$»suÉ
))) {

751 
$d©a_li¡
[] = 
$row
;

755 
	`fÜ—ch
 (
$d©a_li¡
 
as
 
$d©a
) {

756 
$tÙ®_rows
++;

759 
$tÙ®_by‹s
 +ğ
$d©a
['bytes_avg'];

760 
$tÙ®_ms
 +ğ
$d©a
['ms_avg'];

761 
$tÙ®_acûs£s
 +ğ
$d©a
['num_accesses'];

762 
$tÙ®_qu”y_time
 +ğ
$d©a
['query_timer_avg'];

763 
$tÙ®_qu”y_couÁ
 +ğ
$d©a
['query_count_avg'];

767 ià(
$tÙ®_rows
 > 0) {

768 
$ms_avg
 = 
	`numb”_fÜm©
(
$tÙ®_ms
 / 
$tÙ®_rows
, 1, '.', '');

769 
$ms_qu”y
 = 
	`numb”_fÜm©
(
$tÙ®_qu”y_time
 / 
$tÙ®_rows
, 1, '.', '');

770 
$qu”y_couÁ
 = 
	`numb”_fÜm©
(
$tÙ®_qu”y_couÁ
 / 
$tÙ®_rows
, 2, '.', '');

771 
$mb_avg
 = 
	`numb”_fÜm©
(
$tÙ®_by‹s
 / 
$tÙ®_rows
/1024/1024, 1);

774 
$ms_avg
 = '';

775 
$ms_qu”y
 = '';

776 
$mb_avg
 = '';

777 
$qu”y_couÁ
 = '';

780 
$¡©us
 = 
NAGIOS_STATUS_OK
;

782  
	`¬¿y
(

783 'ACC' => 
	`¬¿y
(

784 '¡©us' => 
$¡©us
,

786 '‹xt' => 
$tÙ®_acûs£s
,

788 'MS' => 
	`¬¿y
(

789 '¡©us' => 
$¡©us
,

791 '‹xt' => 
$ms_avg
,

793 'MMB' => 
	`¬¿y
(

794 '¡©us' => 
$¡©us
,

796 '‹xt' => 
$mb_avg
,

798 'QRC' => 
	`¬¿y
(

799 '¡©us' => 
$¡©us
,

801 '‹xt' => 
$qu”y_couÁ
,

803 'QRT' => 
	`¬¿y
(

804 '¡©us' => 
$¡©us
,

806 '‹xt' => 
$ms_qu”y
,

809 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/devel_themer/devel_themer.module

1 <?
php


6 
funùiÚ
 
	$dev–_them”_m’u
() {

7 
$™ems
 = 
	`¬¿y
();

9 
$™ems
['admš/£‰šgs/dev–_them”'] = 
	`¬¿y
(

13 '·g¬gum’ts' => 
	`¬¿y
('devel_themer_admin_settings'),

14 'acûs ¬gum’ts' => 
	`¬¿y
('administer site configuration'),

15 'ty³' => 
MENU_NORMAL_ITEM
,

17 
$™ems
['dev–_them”/v¬ŸbËs'] = 
	`¬¿y
(

21 'ty³' => 
MENU_CALLBACK
,

26 
$™ems
['dev–_them”/’abË'] = 
	`¬¿y
(

29 '·g¬gum’ts' => 
	`¬¿y
(1),

31 'ty³' => 
MENU_CALLBACK
,

33 
$™ems
['dev–_them”/di§bË'] = 
	`¬¿y
(

36 '·g¬gum’ts' => 
	`¬¿y
(1),

38 'ty³' => 
MENU_CALLBACK
,

40  
$™ems
;

41 
	}
}

53 
funùiÚ
 
	$dev–_them”_ajax_v¬ŸbËs
(
$»que¡_id
, 
$ÿÎ
) {

54 
$fe
 = 
	`fe_dœeùÜy_‹mp
(). "/devel_themer_$request_id";

55 ià(
$d©a
 = 
	`un£rŸlize
(
	`fe_g‘_cÚ‹Ás
(
$fe
))) {

56 
$v¬ŸbËs
 = 
$d©a
[
$ÿÎ
]['variables'];

57 ià(
	`has_krumo
()) {

58 
´št
 
	`krumo_ob
(
$v¬ŸbËs
);

60 
	`–£if
 (
$d©a
[
$ÿÎ
]['type'] == 'func') {

61 
´št
 
	`dev–_´št_objeù
(
$v¬ŸbËs
, 
NULL
, 
FALSE
);

64 
´št
 
	`dev–_´št_objeù
(
$v¬ŸbËs
, '$', 
FALSE
);

68 
´št
 'Ajax v¬ŸbË fnÙ found. -'. 
	`check_¶aš
(
$fe
);

70 
$GLOBALS
['dev–_shutdown'] = 
FALSE
;

72 
	}
}

79 
funùiÚ
 
	$dev–_them”_toggË
(
$aùiÚ
) {

80 
$funùiÚ
 = 
$aùiÚ
 == 'enable' ? 'module_enable' : 'module_disable';

84 
	`dru·l_gÙo
();

85 
	}
}

87 
funùiÚ
 
	$dev–_them”_admš_£‰šgs
() {

88 
$fÜm
['dev–_them”_log'] = 
	`¬¿y
('#type' => 'checkbox',

89 '#t™Ë' => 
	`t
('Displayheme†og'),

90 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('dev–_them”_log', 
FALSE
),

91 '#desütiÚ' => 
	`t
('Displayhe†ist ofhemeemplates‡ndheme functions which could have been be used for‡ given…age. The onehat was‡ctually used is bolded. This ishe same data‡she„epresented inhe…opup, but‡ll calls‡re†isted in chronological order‡nd can‡lternately be sorted byime.'),

93  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

94 
	}
}

99 
funùiÚ
 
	$dev–_them”_³rm
() {

100  
	`¬¿y
('access develheme information');

101 
	}
}

103 
funùiÚ
 
	$dev–_them”_š™
() {

104 ià(
	`dev–_them”_u£r_acûss
()) {

105 
$·th
 = 
	`dru·l_g‘_·th
('module', 'devel_themer');

106 
$·th_to_dev–
 = 
	`dru·l_g‘_·th
('module', 'devel');

108 ià(
	`has_krumo
()) {

109 
	`dru·l_add_js
(
$·th_to_dev–
. '/krumo/krumo.js');

110 
	`dru·l_add_css
(
$·th_to_dev–
. '/krumo/skins/default/skin.css');

112 
	`dru·l_add_css
(
$·th
 .'/devel_themer.css');

113 
	`dru·l_add_js
(
$·th
 .'/devel_themer.js');

116 ià(
	`moduË_exi¡s
('jquery_ui'))

118 
	`jqu”y_ui_add
('ui.core');

119 
	`jqu”y_ui_add
('ui.mouse');

120 
	`jqu”y_ui_add
('ui.draggable');

124 
	`dru·l_add_js
(
$·th_to_dev–
 .'/ui.mouse.js');

125 
	`dru·l_add_js
(
$·th_to_dev–
 .'/ui.draggable.js');

129 
	`dru·l_£t_html_h—d
('<!--[if IE]>

130 <
lšk
 
h»f
="' . ba£_·th(è. $·th .'/dev–_them”_›_fix.css" 
»l
="¡yËsh“t" 
ty³
="‹xt/css" 
medŸ
="screen" />

131 <![
’dif
]-->');

132 
	`dev–_them”_pİup
();

134 ià(!
	`dev–_s’t
(è&& 
	`v¬ŸbË_g‘
('dev–_them”_log', 
FALSE
)) {

135 
	`»gi¡”_shutdown_funùiÚ
('devel_themer_shutdown');

138 
	}
}

140 
funùiÚ
 
	$dev–_them”_shutdown
() {

141 
´št
 
	`dev–_them”_log
();

142 
	}
}

151 
funùiÚ
 
	$dev–_them”_theme_»gi¡ry_®‹r
(
$theme_»gi¡ry
) {

152 
	`fÜ—ch
 (
$theme_»gi¡ry
 
as
 
$hook
 => 
$d©a
) {

153 ià(
	`is£t
(
$theme_»gi¡ry
[
$hook
]['function'])) {

156 
$theme_»gi¡ry
[
$hook
]['devel_function_intercept'] = $theme_registry[$hook]['function'];

159 
$theme_»gi¡ry
[
$hook
]['function'] = 'devel_themer_catch_function';

161 
	}
}

166 
funùiÚ
 
	$dev–_them”_log
() {

167 ià(
	`is£t
(
$GLOBALS
['devel_theme_calls'])) {

168 
	`fÜ—ch
 (
$GLOBALS
['dev–_theme_ÿÎs'] 
as
 
$couÁ”
 => 
$ÿÎ
) {

170 ià(
	`is_¬¿y
(
$ÿÎ
)) {

171 
$id
 = "devel_theme_log_link_$counter";

172 
$m¬k”
 = "<div id=\"$id\" class=\"devel_theme_log_link\"></div>\n";

174 
$u£d
 = 
$ÿÎ
['used'];

175 ià(
$ÿÎ
['type'] == 'func') {

176 
$Çme
 = 
$ÿÎ
['name']. '()';

177 
	`fÜ—ch
 (
$ÿÎ
['ÿndid©es'] 
as
 
$™em
) {

178 ià(
$™em
 =ğ
$u£d
) {

179 
$™ems
[] = "<strong>$used</strong>";

182 
$™ems
[] = 
$™em
;

187 
$Çme
 = 
$ÿÎ
['name'];

188 
	`fÜ—ch
 (
$ÿÎ
['ÿndid©es'] 
as
 
$™em
) {

189 ià(
$™em
 =ğ
	`ba£Çme
(
$u£d
)) {

190 
$™ems
[] = "<strong>$used</strong>";

193 
$™ems
[] = 
$™em
;

197 
$rows
[] = 
	`¬¿y
(
$ÿÎ
['du¿tiÚ'], 
$m¬k”
. 
$Çme
, 
	`im¶ode
(', ', 
$™ems
));

198 
	`un£t
(
$™ems
);

201 
$h—d”
 = 
	`¬¿y
('Duration (ms)', 'Template/Function', "Candidateemplate files or function‚ames");

202 
$ouut
 = 
	`theme
('bË', 
$h—d”
, 
$rows
);

203  
$ouut
;

205 
	}
}

208 
funùiÚ
 
	$dev–_them”_g‘_ex‹nsiÚ
() {

209 
glob®
 
$theme_’gše
;

210 
$ex‹nsiÚ
 = 
NULL
;

212 ià(!
$ex‹nsiÚ
) {

213 
$ex‹nsiÚ_funùiÚ
 = 
$theme_’gše
 .'_extension';

214 ià(
	`funùiÚ_exi¡s
(
$ex‹nsiÚ_funùiÚ
)) {

215 
$ex‹nsiÚ
 = 
	`$ex‹nsiÚ_funùiÚ
();

218 
$ex‹nsiÚ
 = '.tpl.php';

221  
$ex‹nsiÚ
;

222 
	}
}

228 
funùiÚ
 
	$dev–_them”_ÿtch_funùiÚ
() {

229 
$¬gs
 = 
	`func_g‘_¬gs
();

233 
$Œaû
 = 
	`debug_backŒaû
();

234 
	`fÜ—ch
 (
$Œaû
 
as
 
$Œaû_’Œy
) {

235 ià(
$Œaû_’Œy
['function'] == 'theme') {

236 
$hook
 = 
$Œaû_’Œy
['args'][0];

240 
	`¬¿y_unshiá
(
$¬gs
, 
$hook
);

242 
$couÁ”
 = 
	`dev–_couÁ”
();

243 
$tim”_Çme
 = "thmr_$counter";

244 
	`tim”_¡¬t
(
$tim”_Çme
);

247 
	`li¡
(
$»tuº
, 
$m‘a
èğ
	`ÿÎ_u£r_func_¬¿y
('dev–_them”_theme_twš', 
$¬gs
);

248 
$time
 = 
	`tim”_¡İ
(
$tim”_Çme
);

250 
$sk_ÿÎs
 = 
	`¬¿y
('hidden', 'form_element', 'placeholder');

251 ià(!
	`em±y
(
$»tuº
è&& !
	`is_¬¿y
($»tuºè&& !
	`is_objeù
($»tuºè&& 
	`dev–_them”_u£r_acûss
()) {

252 
	`li¡
(
$´efix
, 
$suffix
èğ
	`dev–_theme_ÿÎ_m¬k”
(
$hook
, 
$couÁ”
, 'func');

253 
$¡¬t_»tuº
 = 
	`sub¡r
(
$»tuº
, 0, 31);

254 
$¡¬t_´efix
 = 
	`sub¡r
(
$´efix
, 0, 31);

256 ià(
$¡¬t_»tuº
 !ğ
$¡¬t_´efix
 && !
	`š_¬¿y
(
$hook
, 
$sk_ÿÎs
è&& 
	`em±y
(
$GLOBALS
['devel_themer_stop'])) {

257 ià(
$hook
 == 'page') {

258 
$GLOBALS
['dev–_theme_ÿÎs']['·ge_id'] = 
$couÁ”
;

261 
$GLOBALS
['dev–_them”_¡İ'] = 
TRUE
;

264 
$ouut
 = 
	`v¬ŸbË_g‘
('dev–_them”_no_wh™e¥aû', 
FALSE
è? (
$´efix
 . 
$»tuº
 . 
$suffix
) : ($prefix. "\n ". $return. $suffix. "\n");

267 ià(
$m‘a
['type'] == 'func') {

268 
$Çme
 = 
$m‘a
['used'];

269 
$u£d
 = 
$m‘a
['used'];

270 ià(
	`em±y
(
$m‘a
['wildcards'])) {

271 
$m‘a
['wdÿrds'][
$hook
] = '';

273 
$ÿndid©es
 = 
	`dev–_them”_ªû¡ry
(
	`¬¿y_»v”£
(
	`¬¿y_keys
(
$m‘a
['wildcards'])));

274 ià(
	`em±y
(
$m‘a
['variables'])) {

275 
$v¬ŸbËs
 = 
	`¬¿y
();

279 
$Çme
 = 
$m‘a
['u£d']. 
	`dev–_them”_g‘_ex‹nsiÚ
();

280 ià(
	`em±y
(
$sugge¡iÚs
)) {

281 
	`¬¿y_unshiá
(
$m‘a
['suggestions'], $meta['used']);

283 
$ÿndid©es
 = 
	`¬¿y_»v”£
(
	`¬¿y_m­
('dev–_them”_­³nd_ex‹nsiÚ', 
$m‘a
['suggestions']));

284 
$u£d
 = 
$m‘a
['template_file'];

287 
$key
 = "thmr_$counter";

289 
$GLOBALS
['dev–_theme_ÿÎs'][
$key
] = 
	`¬¿y
(

290 'Çme' => 
$Çme
,

291 'ty³' => 
$m‘a
['type'],

292 'du¿tiÚ' => 
$time
['time'],

293 'u£d' => 
$u£d
,

294 'ÿndid©es' => 
$ÿndid©es
,

295 '´•roûssÜs' => 
	`is£t
(
$m‘a
['´•roûssÜs']è? $m‘a['´•roûssÜs'] : 
	`¬¿y
(),

299 
$GLOBALS
['dev–_them”_£rv”'][
$key
] = 
	`¬¿y
(

300 'v¬ŸbËs' => 
$m‘a
['variables'],

301 'ty³' => 
$m‘a
['type'],

305 
$ouut
 = 
$»tuº
;

309  
	`is£t
(
$ouut
è? $ouuˆ: 
$»tuº
;

310 
	}
}

312 
funùiÚ
 
	$dev–_them”_­³nd_ex‹nsiÚ
(
$¡ršg
) {

313  
$¡ršg
. 
	`dev–_them”_g‘_ex‹nsiÚ
();

314 
	}
}

325 
funùiÚ
 
	$dev–_them”_ªû¡ry
(
$ÿÎs
) {

326 
glob®
 
$theme
, 
$theme_’gše
, 
$ba£_theme_šfo
;

327 
$´efixes
;

328 ià(!
	`is£t
(
$´efixes
)) {

329 
$´efixes
[] = 'theme';

330 ià(
	`is£t
(
$ba£_theme_šfo
)) {

331 
	`fÜ—ch
 (
$ba£_theme_šfo
 
as
 
$ba£
) {

332 
$´efixes
[] = 
$ba£
->
Çme
;

335 
$´efixes
[] = 
$theme_’gše
;

336 
$´efixes
[] = 
$theme
;

337 
$´efixes
 = 
	`¬¿y_f‹r
($prefixes);

340 
	`fÜ—ch
 (
$ÿÎs
 
as
 
$ÿÎ
) {

341 
	`fÜ—ch
 (
$´efixes
 
as
 
$´efix
) {

342 
$ÿndid©es
[] = 
$´efix
. '_'. 
$ÿÎ
;

345  
	`¬¿y_»v”£
(
$ÿndid©es
);

346 
	}
}

359 
funùiÚ
 
	$dev–_them”_theme_twš
() {

360 
$¬gs
 = 
	`func_g‘_¬gs
();

361 
$hook
 = 
	`¬¿y_shiá
(
$¬gs
);

363 
$hooks
 = 
NULL
;

364 ià(!
	`is£t
(
$hooks
)) {

365 
	`š™_theme
();

366 
$hooks
 = 
	`theme_g‘_»gi¡ry
();

370 
$m‘a
['wdÿrds'] = 
	`¬¿y
();

371 ià(
	`is_¬¿y
(
$hook
)) {

372 
	`fÜ—ch
 (
$hook
 
as
 
$ÿndid©e
) {

373 
$m‘a
['wdÿrds'][
$ÿndid©e
] = 
FALSE
;

374 ià(
	`is£t
(
$hooks
[
$ÿndid©e
])) {

375 
$m‘a
['wdÿrds'][
$ÿndid©e
] = 
TRUE
;

379 
$hook
 = 
$ÿndid©e
;

383 ià(!
	`is£t
(
$hooks
[
$hook
])) {

384  
	`¬¿y
('', 
$m‘a
);

387 
$šfo
 = 
$hooks
[
$hook
];

388 
$m‘a
['hook'] = 
$hook
;

389 
$m‘a
['·th'] = 
$šfo
['theme…ath'];

392 ià(!
	`em±y
(
$šfo
['include files'])) {

393 
	`fÜ—ch
 (
$šfo
['šşudfes'] 
as
 
$šşude_fe
) {

394 
	`šşude_Úû
(
$šşude_fe
);

399 ià(!
	`em±y
(
$šfo
['file'])) {

400 
$šşuded_fes
 = 
	`¬¿y
();

401 
$šşude_fe
 = 
$šfo
['file'];

402 ià(!
	`em±y
(
$šfo
['path'])) {

403 
$šşude_fe
 = 
$šfo
['path'] .'/'. $include_file;

406 ià(
	`em±y
(
$šşuded_fes
[
$šşude_fe
])) {

409 
$šşuded_fes
[
$šşude_fe
] = 
TRUE
;

410 ià(
	`fe_exi¡s
('./'. 
$šşude_fe
)) {

411 
	`šşude_Úû
('./'. 
$šşude_fe
);

416 ià(
	`is£t
(
$šfo
['devel_function_intercept'])) {

418 
$ouut
 = 
	`ÿÎ_u£r_func_¬¿y
(
$šfo
['dev–_funùiÚ_š‹rû±'], 
$¬gs
);

419 
$m‘a
['type'] = 'func';

420 
$m‘a
['u£d'] = 
$šfo
['devel_function_intercept'];

422 ià(!
	`em±y
(
$¬gs
è&& 
	`şass_exi¡s
('ReflectionFunction')) {

423 
$»æeù
 = 
Ãw
 
	`ReæeùiÚFunùiÚ
(
$šfo
['devel_function_intercept']);

424 
$·¿ms
 = 
$»æeù
->
	`g‘P¬am‘”s
();

425 
$i
=0; $˜< 
	`couÁ
(
$¬gs
); $i++) {

427 ià(
$i
 < 
	`couÁ
(
$·¿ms
)) {

428 
$m‘a
['v¬ŸbËs'][
$·¿ms
[
$i
]->
	`g‘Name
()] = 
$¬gs
[$i];

436 
$m‘a
['v¬ŸbËs'][] = 
$¬gs
[
$i
];

441 
$m‘a
['v¬ŸbËs'] = 
$¬gs
;

446 
$m‘a
['type'] = 'tpl';

447 
$m‘a
['u£d'] = 
	`¡r_»¶aû
(
$šfo
['theme…ath'] .'/', '', $info['template']);

448 
$v¬ŸbËs
 = 
	`¬¿y
(

449 '‹m¶©e_fes' => 
	`¬¿y
()

451 ià(!
	`em±y
(
$šfo
['arguments'])) {

452 
$couÁ
 = 0;

453 
	`fÜ—ch
 (
$šfo
['¬gum’ts'] 
as
 
$Çme
 => 
$deçuÉ
) {

454 
$v¬ŸbËs
[
$Çme
] = 
	`is£t
(
$¬gs
[
$couÁ
]è? $¬gs[$couÁ] : 
$deçuÉ
;

455 
$couÁ
++;

460 
$»nd”_funùiÚ
 = 'theme_render_template';

461 
$ex‹nsiÚ
 = '.tpl.php';

464 
glob®
 
$theme_’gše
;

465 ià(
	`is£t
(
$theme_’gše
)) {

468 ià(
$šfo
['type'] != 'module') {

469 ià(
	`funùiÚ_exi¡s
(
$theme_’gše
 .'_render_template')) {

470 
$»nd”_funùiÚ
 = 
$theme_’gše
 .'_render_template';

472 
$ex‹nsiÚ_funùiÚ
 = 
$theme_’gše
 .'_extension';

473 ià(
	`funùiÚ_exi¡s
(
$ex‹nsiÚ_funùiÚ
)) {

474 
$ex‹nsiÚ
 = 
	`$ex‹nsiÚ_funùiÚ
();

479 ià(
	`is£t
(
$šfo
['´•roûs funùiÚs']è&& 
	`is_¬¿y
($info['preprocess functions'])) {

482 
$¬gs
 = 
	`¬¿y
(&
$v¬ŸbËs
, 
$hook
);

483 
	`fÜ—ch
 (
$šfo
['´•roûs funùiÚs'] 
as
 
$´•roûss_funùiÚ
) {

484 ià(
	`funùiÚ_exi¡s
(
$´•roûss_funùiÚ
)) {

485 
	`ÿÎ_u£r_func_¬¿y
(
$´•roûss_funùiÚ
, 
$¬gs
);

494 
$sugge¡iÚs
 = 
	`¬¿y
();

496 ià(
	`is£t
(
$v¬ŸbËs
['template_files'])) {

497 
$sugge¡iÚs
 = 
$v¬ŸbËs
['template_files'];

499 ià(
	`is£t
(
$v¬ŸbËs
['template_file'])) {

500 
$sugge¡iÚs
[] = 
$v¬ŸbËs
['template_file'];

503 ià(
$sugge¡iÚs
) {

504 
$‹m¶©e_fe
 = 
	`dru·l_discov”_‹m¶©e
(
$šfo
['them·ths'], 
$sugge¡iÚs
, 
$ex‹nsiÚ
);

507 ià(
	`em±y
(
$‹m¶©e_fe
)) {

508 
$‹m¶©e_fe
 = 
$šfo
['‹m¶©e'] . 
$ex‹nsiÚ
;

509 ià(
	`is£t
(
$šfo
['path'])) {

510 
$‹m¶©e_fe
 = 
$šfo
['path'] .'/'. $template_file;

513 
$ouut
 = 
	`$»nd”_funùiÚ
(
$‹m¶©e_fe
, 
$v¬ŸbËs
);

514 
$m‘a
['sugge¡iÚs'] = 
$sugge¡iÚs
;

515 
$m‘a
['‹m¶©e_fe'] = 
$‹m¶©e_fe
;

516 
$m‘a
['v¬ŸbËs'] = 
$v¬ŸbËs
;

517 
$m‘a
['´•roûssÜs'] = 
$šfo
['preprocess functions'];

520  
	`¬¿y
(
$ouut
, 
$m‘a
);

521 
	}
}

524 
funùiÚ
 
	$dev–_them”_ex™
(
$de¡š©iÚ
 = 
NULL
) {

525 ià(!
	`is£t
(
$de¡š©iÚ
è&& !
	`em±y
(
$GLOBALS
['dev–_theme_ÿÎs']è&& 
$_SERVER
['REQUEST_METHOD'] != 'POST') {

527 
$»que¡_id
 = 
	`uniqid
(
	`¿nd
());

531 
	`dev–_put_cÚ‹Ás
(
	`fe_dœeùÜy_‹mp
(). "/dev–_them”_$»que¡_id", 
	`£rŸlize
(
$GLOBALS
['devel_themer_server']));

533 
$GLOBALS
['dev–_theme_ÿÎs']['»que¡_id'] = 
$»que¡_id
;

534 
$GLOBALS
['dev–_theme_ÿÎs']['dev–_them”_uri'] = 
	`u¾
("devel_themer/variables/$request_id");

535 
´št
 '<süˆty³="‹xt/javasüt">jQu”y.ex‹nd(Dru·l.£‰šgs, '. 
	`dru·l_to_js
(
$GLOBALS
['devel_theme_calls']) .");</script>\n";

537 
	}
}

539 
funùiÚ
 
	$dev–_theme_ÿÎ_m¬k”
(
$Çme
, 
$couÁ”
, 
$ty³
) {

540 
$id
 = "thmr_". 
$couÁ”
;

541  
	`¬¿y
("<span id=\"$id\" class=\"thmr_call\">", "</span>\n");

542 
	}
}

545 
funùiÚ
 
	$dev–_couÁ”
(
$šüem’t
 = 
TRUE
) {

546 
$couÁ”
 = 0;

547 ià(
$šüem’t
) {

548 
$couÁ”
++;

550  
$couÁ”
;

551 
	}
}

557 
funùiÚ
 
	$dev–_them”_pİup
() {

558 
$majÜv”
 = 
	`sub¡r
(
VERSION
, 0, 
	`¡½os
(VERSION, '.'));

561 
	`dru·l_add_js
(
	`¬¿y
('thmrStrings' =>

562 
	`¬¿y
(

563 'them”_šfo' => 
	`t
('Themer info'),

564 'toggË_throbb”' => ' <img src="'. 
	`ba£_·th
(è. 
	`dru·l_g‘_·th
('moduË', 'dev–'). '/lßd”-l™e.gif' .'"‡É="'. 
	`t
('loading') .'" class="throbber" width="16" height="16" style="display:none" />',

565 '·»Ás' => 
	`t
('Parents: '),

566 'funùiÚ_ÿÎed' => 
	`t
('Function called: '),

567 '‹m¶©e_ÿÎed' => 
	`t
('Template called: '),

568 'ÿndid©e_fes' => 
	`t
('Candidateemplate files: '),

569 '´•roûssÜs' => 
	`t
('Preprocess functions: '),

570 'ÿndid©e_funùiÚs' => 
	`t
('Candidate function‚ames: '),

571 'dru·l_­i_docs' => 
	`t
('linko Drupal API documentation'),

572 'sourû_lšk_t™Ë' => 
	`t
('linko source code'),

573 'funùiÚ_¬gum’ts' => 
	`t
('Function Arguments'),

574 '‹m¶©e_v¬ŸbËs' => 
	`t
('Template Variables'),

575 'fe_u£d' => 
	`t
('File used: '),

576 'du¿tiÚ' => 
	`t
('Duration: '),

577 '­i_s™e' => 
	`v¬ŸbË_g‘
('devel_api_site', 'http://api.drupal.org/'),

578 'dru·l_v”siÚ' => 
$majÜv”
,

579 'sourû_lšk' => 
	`u¾
('dev–/sourû', 
	`¬¿y
('query' =>‡rray('file' => ''))),

583 
$t™Ë
 = 
	`t
('Drupal Themer Information');

584 
$šŒo
 = 
	`t
('Click on‡nyƒlemento see information‡bouthe Drupalheme function oremplatehat created it.');

586 
$pİup
 = <<<
EOT


587 <
div
 
id
="themer-fixeder">

588 <
div
 
id
="themer-relativer">

589 <
div
 
id
="themer-popup">

590 <
div
 
şass
="topper">

591 <
¥ª
 
şass
="şo£">
X
</¥ª> 
$t™Ë


592 </
div
>

593 <
div
 
id
="·»Ás" 
şass
="row">

595 </
div
>

596 <
div
 
şass
="info„ow">

597 <
div
 
şass
="¡¬‹r">
$šŒo
</div>

598 <
dl
>

599 <
dt
 
şass
="key-type">

601 </
dt
>

602 <
dd
 
şass
="key">

604 </
dd
>

605 <
div
 
şass
="used">

606 </
div
>

607 <
dt
 
şass
="candidates-type">

609 </
dt
>

610 <
dd
 
şass
="candidates">

612 </
dd
>

614 <
dt
 
şass
="preprocessors-type">

616 </
dt
>

617 <
dd
 
şass
="preprocessors">

619 </
dd
>

621 <
div
 
şass
="duration"></div>

622 </
dl
>

623 </
div
><!-- /
šfo
 -->

624 <
div
 
şass
="attributes„ow">

626 </
div
><!-- /
©Œibu‹s
 -->

627 </
div
><!-- /
them”
-
pİup
 -->

628 </
div
>

629 </
div
>

630 
EOT
;

632 
	`dru·l_add_js
(
	`¬¿y
('thmr_pİup' => 
$pİup
), 'setting');

633 
	}
}

636 
funùiÚ
 
	$dev–_put_cÚ‹Ás
(
$n
, 
$d
, 
$æag
 = 
çl£
) {

637 ià(
	`funùiÚ_exi¡s
('file_put_contents')){

638 
	`fe_put_cÚ‹Ás
(
$n
, 
$d
, 
$æag
);

640 
$mode
 = (
$æag
 =ğ
FILE_APPEND
 || 
	`¡¹ouµ”
($flag) == 'FILE_APPEND') ? 'a' : 'w';

641 
$f
 = @
	`fİ’
(
$n
, 
$mode
);

642 ià(
$f
 ==ğ
çl£
) {

645 ià(
	`is_¬¿y
(
$d
)è$d = 
	`im¶ode
($d);

646 
	`fwr™e
(
$f
, 
$d
);

647 
	`fşo£
(
$f
);

650 
	}
}

662 
funùiÚ
 
	$dev–_them”_ş—nup
() {

663 
	`fÜ—ch
 (
	`¬¿y_keys
(
	`fe_sÿn_dœeùÜy
(
	`fe_dœeùÜy_‹mp
(), 'dev–_them”_*', 
	`¬¿y
('.', '..', 'CVS'), 0, 
FALSE
)è
as
 
$fe
) {

664 
	`fe_d–‘e
(
$fe
);

666 
	}
}

674 
funùiÚ
 
	$dev–_them”_üÚ
() {

675 
	`dev–_them”_ş—nup
();

676 
	}
}

690 
funùiÚ
 
	$dev–_them”_u£r_acûss
(
$accouÁ
 = 
NULL
) {

693  (
	`u£r_acûss
('acûs dev– infÜm©iÚ', 
$accouÁ
) || user_access('access develheme information', $account));

694 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/docs/docs.php

1 <?
php


74 
funùiÚ
 
	$hook_v›ws_d©a
() {

90 
$d©a
['exam¶e_bË']['bË']['group'] = 
	`t
('Exampleable');

95 
$d©a
['exam¶e_bË']['bË']['ba£'] = 
	`¬¿y
(

97 't™Ë' => 
	`t
('Exampleable'),

98 'h–p' => 
	`t
("Exampleable containsƒxample content‡nd can be„elatedo‚odes."),

105 
$d©a
['exam¶e_bË']['bË']['još'] = 
	`¬¿y
(

109 'node' => 
	`¬¿y
(

121 
$d©a
['exam¶e_bË']['nid'] = 
	`¬¿y
(

122 't™Ë' => 
	`t
('Example content'),

123 'h–p' => 
	`t
('Someƒxample contenthat„eferences‡‚ode.'),

127 '»ÏtiÚsh' => 
	`¬¿y
(

131 'Ïb–' => 
	`t
('Example‚ode'),

136 
$d©a
['exam¶e_bË']['¶aš_‹xt_f›ld'] = 
	`¬¿y
(

137 't™Ë' => 
	`t
('Plainext field'),

138 'h–p' => 
	`t
('Just‡…lainext field.'),

139 'f›ld' => 
	`¬¿y
(

141 'şick sÜbË' => 
TRUE
,

143 'sÜt' => 
	`¬¿y
(

146 'f‹r' => 
	`¬¿y
(

149 '¬gum’t' => 
	`¬¿y
(

155 
$d©a
['exam¶e_bË']['num”ic_f›ld'] = 
	`¬¿y
(

156 't™Ë' => 
	`t
('Numeric field'),

157 'h–p' => 
	`t
('Just‡‚umeric field.'),

158 'f›ld' => 
	`¬¿y
(

160 'şick sÜbË' => 
TRUE
,

162 'f‹r' => 
	`¬¿y
(

165 'sÜt' => 
	`¬¿y
(

171 
$d©a
['exam¶e_bË']['boŞ—n_f›ld'] = 
	`¬¿y
(

172 't™Ë' => 
	`t
('Boolean field'),

173 'h–p' => 
	`t
('Just‡n on/off field.'),

174 'f›ld' => 
	`¬¿y
(

176 'şick sÜbË' => 
TRUE
,

178 'f‹r' => 
	`¬¿y
(

180 'Ïb–' => 
	`t
('Published'),

183 'sÜt' => 
	`¬¿y
(

189 
$d©a
['exam¶e_bË']['time¡amp_f›ld'] = 
	`¬¿y
(

190 't™Ë' => 
	`t
('Timestamp field'),

191 'h–p' => 
	`t
('Just‡imestamp field.'),

192 'f›ld' => 
	`¬¿y
(

194 'şick sÜbË' => 
TRUE
,

196 'sÜt' => 
	`¬¿y
(

199 'f‹r' => 
	`¬¿y
(

204  
$d©a
;

205 
	}
}

218 
funùiÚ
 
	$hook_v›ws_¶ugšs
() {

220 
	}
}

225 
funùiÚ
 
	$hook_v›ws_¶ugšs_®‹r
(&
$¶ugšs
) {

227 
$¶ugšs
['row']['node']['base'][] = 'apachesolr';

228 
	}
}

236 
funùiÚ
 
	$hook_v›ws_hªdËrs
() {

238 
	}
}

252 
funùiÚ
 
	$hook_v›ws_­i
() {

253  
	`¬¿y
(

255 '·th' => 
	`dru·l_g‘_·th
('module', 'example') . '/includes/views',

257 
	}
}

276 
funùiÚ
 
	$hook_v›ws_deçuÉ_v›ws
() {

278 
$v›w
 = 
Ãw
 
v›w
;

279 
$v›w
->
Çme
 = 'frontpage';

280 
$v›w
->
desütiÚ
 = 
	`t
('Emulateshe default Drupal front…age; you may sethe default home…age…athohis viewo make it your front…age.');

281 
$v›w
->
g
 = 
	`t
('default');

282 
$v›w
->
v›w_php
 = '';

283 
$v›w
->
ba£_bË
 = 'node';

284 
$v›w
->
is_ÿch—bË
 = '0';

285 
$v›w
->
­i_v”siÚ
 = 2;

286 
$v›w
->
di§bËd
 = 
FALSE
;

287 
$v›w
->
di¥Ïy
 = 
	`¬¿y
();

288 
$di¥Ïy
 = 
Ãw
 
v›ws_di¥Ïy
;

289 
$di¥Ïy
->
id
 = 'default';

290 
$di¥Ïy
->
di¥Ïy_t™Ë
 = 
	`t
('Defaults');

291 
$di¥Ïy
->
di¥Ïy_¶ugš
 = 'default';

292 
$di¥Ïy
->
pos™iÚ
 = '1';

293 
$di¥Ïy
->
di¥Ïy_İtiÚs
 = 
	`¬¿y
 (

296 
	`¬¿y
 (

300 
	`¬¿y
 (

305 
	`¬¿y
 (

308 
	`¬¿y
 (

311 
	`¬¿y
 (

313 
	`¬¿y
 (

320 
	`¬¿y
 (

330 
	`¬¿y
 (

333 
	`¬¿y
 (

335 
	`¬¿y
 (

342 'expo£d' => 
çl£
,

344 
	`¬¿y
 (

345 'İ”©Ü' => 
çl£
,

350 
	`¬¿y
 (

357 'expo£d' => 
çl£
,

359 
	`¬¿y
 (

360 'İ”©Ü' => 
çl£
,

376 
$v›w
->
di¥Ïy
['deçuÉ'] = 
$di¥Ïy
;

377 
$di¥Ïy
 = 
Ãw
 
v›ws_di¥Ïy
;

378 
$di¥Ïy
->
id
 = 'page';

379 
$di¥Ïy
->
di¥Ïy_t™Ë
 = 
	`t
('Page');

380 
$di¥Ïy
->
di¥Ïy_¶ugš
 = 'page';

381 
$di¥Ïy
->
pos™iÚ
 = '2';

382 
$di¥Ïy
->
di¥Ïy_İtiÚs
 = 
	`¬¿y
 (

384 
	`¬¿y
 (

385 'acûss' => 
Œue
,

386 't™Ë' => 
Œue
,

387 'h—d”' => 
Œue
,

388 'h—d”_fÜm©' => 
Œue
,

389 'h—d”_em±y' => 
Œue
,

390 'foÙ”' => 
Œue
,

391 'foÙ”_fÜm©' => 
Œue
,

392 'foÙ”_em±y' => 
Œue
,

393 'em±y' => 
Œue
,

394 'em±y_fÜm©' => 
Œue
,

395 '™ems_³r_·ge' => 
Œue
,

396 'off£t' => 
Œue
,

397 'u£_·g”' => 
Œue
,

398 '·g”_–em’t' => 
Œue
,

399 'lšk_di¥Ïy' => 
Œue
,

400 'php_¬g_code' => 
Œue
,

401 'expo£d_İtiÚs' => 
Œue
,

402 '¡yË_¶ugš' => 
Œue
,

403 '¡yË_İtiÚs' => 
Œue
,

404 'row_¶ugš' => 
Œue
,

405 'row_İtiÚs' => 
Œue
,

406 '»ÏtiÚshs' => 
Œue
,

407 'f›lds' => 
Œue
,

408 'sÜts' => 
Œue
,

409 '¬gum’ts' => 
Œue
,

410 'f‹rs' => 
Œue
,

411 'u£_ajax' => 
Œue
,

412 'di¡šù' => 
Œue
,

415 
	`¬¿y
 (

418 
	`¬¿y
 (

421 
	`¬¿y
 (

424 
	`¬¿y
 (

427 
	`¬¿y
 (

431 
$v›w
->
di¥Ïy
['·ge'] = 
$di¥Ïy
;

432 
$di¥Ïy
 = 
Ãw
 
v›ws_di¥Ïy
;

433 
$di¥Ïy
->
id
 = 'feed';

434 
$di¥Ïy
->
di¥Ïy_t™Ë
 = 
	`t
('Feed');

435 
$di¥Ïy
->
di¥Ïy_¶ugš
 = 'feed';

436 
$di¥Ïy
->
pos™iÚ
 = '3';

437 
$di¥Ïy
->
di¥Ïy_İtiÚs
 = 
	`¬¿y
 (

439 
	`¬¿y
 (

440 'acûss' => 
Œue
,

441 't™Ë' => 
çl£
,

442 'h—d”' => 
Œue
,

443 'h—d”_fÜm©' => 
Œue
,

444 'h—d”_em±y' => 
Œue
,

445 'foÙ”' => 
Œue
,

446 'foÙ”_fÜm©' => 
Œue
,

447 'foÙ”_em±y' => 
Œue
,

448 'em±y' => 
Œue
,

449 'em±y_fÜm©' => 
Œue
,

450 'u£_ajax' => 
Œue
,

451 '™ems_³r_·ge' => 
Œue
,

452 'off£t' => 
Œue
,

453 'u£_·g”' => 
Œue
,

454 '·g”_–em’t' => 
Œue
,

455 'u£_mÜe' => 
Œue
,

456 'di¡šù' => 
Œue
,

457 'lšk_di¥Ïy' => 
Œue
,

458 'php_¬g_code' => 
Œue
,

459 'expo£d_İtiÚs' => 
Œue
,

460 '¡yË_¶ugš' => 
çl£
,

461 '¡yË_İtiÚs' => 
çl£
,

462 'row_¶ugš' => 
çl£
,

463 'row_İtiÚs' => 
çl£
,

464 '»ÏtiÚshs' => 
Œue
,

465 'f›lds' => 
Œue
,

466 'sÜts' => 
Œue
,

467 '¬gum’ts' => 
Œue
,

468 'f‹rs' => 
Œue
,

471 
	`¬¿y
 (

474 
	`¬¿y
 (

477 
	`¬¿y
 (

480 
	`¬¿y
 (

483 
	`¬¿y
 (

486 
	`¬¿y
 (

492 
	`¬¿y
 (

498 
	`¬¿y
 (

502 't™Ë' => 
	`t
('Front…age feed'),

504 
$v›w
->
di¥Ïy
['ãed'] = 
$di¥Ïy
;

508 
$v›ws
[
$v›w
->
Çme
] = $view;

513  
$v›ws
;

514 
	}
}

520 
funùiÚ
 
	$hook_v›ws_deçuÉ_v›ws_®‹r
(&
$v›ws
) {

521 ià(
	`is£t
(
$v›ws
['taxonomy_term'])) {

522 
$v›ws
['xÚomy_‹rm']->
	`£t_di¥Ïy
('default');

523 
$v›ws
['xÚomy_‹rm']->
di¥Ïy_hªdËr
->
	`£t_İtiÚ
('title', 'Categories');

525 
	}
}

534 
funùiÚ
 
	$hook_v›ws_cÚv”t
() {

536 
	}
}

541 
funùiÚ
 
	$hook_v›ws_qu”y_sub¡™utiÚs
() {

543 
	}
}

552 
funùiÚ
 
	$hook_v›ws_´e_v›w
(&
$v›w
, &
$di¥Ïy_id
, &
$¬gs
) {

554 
	}
}

563 
funùiÚ
 
	$hook_v›ws_´e_bud
(&
$v›w
) {

565 
	}
}

574 
funùiÚ
 
	$hook_v›ws_´e_execu‹
(&
$v›w
) {

576 
	}
}

589 
funùiÚ
 
	$hook_v›ws_´e_»nd”
(&
$v›w
) {

591 
	}
}

615 
funùiÚ
 
	$hook_v›ws_po¡_»nd”
(&
$v›w
, &
$ouut
, &
$ÿche
) {

617 
	}
}

627 
funùiÚ
 
	$hook_v›ws_qu”y_®‹r
(&
$v›w
, &
$qu”y
) {

629 
	}
}

644 
funùiÚ
 
	$hook_v›ws_admš_lšks_®‹r
(&
$lšks
, 
$v›w
) {

646 
	}
}

661 
funùiÚ
 
	$hook_v›ws_´ev›w_šfo_®‹r
(&
$rows
, 
$v›w
) {

663 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument.inc

1 <?
php


33 şas 
	cv›ws_hªdËr_¬gum’t
 
ex‹nds
 
	mv›ws_hªdËr
 {

34 
v¬
 
	m$Çme_f›ld
 = 
NULL
;

38 
funùiÚ
 
	$cÚ¡ruù
() {

39 
·»Á
::
	`cÚ¡ruù
();

41 ià(!
	`em±y
(
$this
->
defš™iÚ
['name field'])) {

42 
$this
->
Çme_f›ld
 = $this->
defš™iÚ
['name field'];

44 ià(!
	`em±y
(
$this
->
defš™iÚ
['nameable'])) {

45 
$this
->
Çme_bË
 = $this->
defš™iÚ
['nameable'];

49 
funùiÚ
 
	$š™
(&
$v›w
, &
$İtiÚs
) {

50 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

51 
	}
}

60 
funùiÚ
 
	$£t_b»adüumb
(&
$b»adüumb
è{ 
	}
}

67 
funùiÚ
 
	$u£s_b»adüumb
() {

68 
$šfo
 = 
$this
->
	`deçuÉ_aùiÚs
($this->
İtiÚs
['default_action']);

69  !
	`em±y
(
$šfo
['breadcrumb']);

70 
	}
}

72 
funùiÚ
 
	$is_wdÿrd
(
$¬g
 = 
NULL
) {

73 ià(!
	`is£t
(
$¬g
)) {

74 
$¬g
 = 
$this
->
¬gum’t
;

77  !
	`em±y
(
$this
->
İtiÚs
['wdÿrd']è&& $this->İtiÚs['wdÿrd'] ==ğ
$¬g
;

78 
	}
}

80 
funùiÚ
 
	$wdÿrd_t™Ë
() {

81  
$this
->
İtiÚs
['wildcard_substitution'];

82 
	}
}

89 
funùiÚ
 
	$Ãeds_¡yË_¶ugš
() {

90 
$šfo
 = 
$this
->
	`deçuÉ_aùiÚs
($this->
İtiÚs
['default_action']);

91 
$v®id©e_šfo
 = 
$this
->
	`deçuÉ_aùiÚs
($this->
İtiÚs
['validate_fail']);

92  !
	`em±y
(
$šfo
['¡yË…lugš']è|| !em±y(
$v®id©e_šfo
['style…lugin']);

93 
	}
}

95 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

96 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

98 
$İtiÚs
['deçuÉ_aùiÚ'] = 
	`¬¿y
('default' => 'ignore');

99 
$İtiÚs
['¡yË_¶ugš'] = 
	`¬¿y
('default' => 'default_summary');

100 
$İtiÚs
['¡yË_İtiÚs'] = 
	`¬¿y
('default' =>‡rray());

101 
$İtiÚs
['wdÿrd'] = 
	`¬¿y
('default' => 'all');

102 
$İtiÚs
['wdÿrd_sub¡™utiÚ'] = 
	`¬¿y
('deçuÉ' => 
	`t
('AÎ'), 'Œª¦©abË' => 
TRUE
);

103 
$İtiÚs
['t™Ë'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

104 
$İtiÚs
['b»adüumb'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

105 
$İtiÚs
['deçuÉ_¬gum’t_ty³'] = 
	`¬¿y
('default' => 'fixed');

106 
$İtiÚs
['deçuÉ_¬gum’t'] = 
	`¬¿y
('default' => '');

107 
$İtiÚs
['v®id©e_ty³'] = 
	`¬¿y
('default' => 'none');

108 
$İtiÚs
['v®id©e_ç'] = 
	`¬¿y
('default' => 'not found');

110  
$İtiÚs
;

111 
	}
}

113 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

114 
$deçuÉs
 = 
$this
->
	`deçuÉ_aùiÚs
();

116 
$fÜm
['t™Ë'] = 
	`¬¿y
(

120 '#t™Ë' => 
	`t
('Title'),

121 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['title'],

122 '#desütiÚ' => 
	`t
('Theitleo use whenhis‡rgument is…resent. It will overrideheitle ofhe view‡nditles from…revious‡rguments. You can use…ercent substitution hereo„eplace with‡rgumentitles. Use "%1" forhe first‡rgument, "%2" forhe second,ƒtc.'),

125 
$fÜm
['b»adüumb'] = 
	`¬¿y
(

129 '#t™Ë' => 
	`t
('Breadcrumb'),

130 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['breadcrumb'],

131 '#desütiÚ' => 
	`t
('The Breadcrumbitleo use whenhis‡rgument is…resent. If‚o breadcrumb is set here, default Title values will be used, see "Title" for…ercent substitutions.'),

134 
$fÜm
['ş—r_¡¬t'] = 
	`¬¿y
(

138 
$fÜm
['deçuÉs_¡¬t'] = 
	`¬¿y
(

142 
$fÜm
['deçuÉ_aùiÚ'] = 
	`¬¿y
(

144 '#t™Ë' => 
	`t
('Actionoake if‡rgument is‚ot…resent'),

145 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['default_action'],

148 
$fÜm
['deçuÉs_¡İ'] = 
	`¬¿y
(

152 
$fÜm
['wdÿrd'] = 
	`¬¿y
(

156 '#t™Ë' => 
	`t
('Wildcard'),

158 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['wildcard'],

159 '#desütiÚ' => 
	`t
('Ifhis value is„eceived‡s‡n‡rgument,he‡rgument will be ignored; i.e, "all values"'),

162 
$fÜm
['wdÿrd_sub¡™utiÚ'] = 
	`¬¿y
(

165 '#t™Ë' => 
	`t
('Wildcarditle'),

167 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['wildcard_substitution'],

168 '#desütiÚ' => 
	`t
('Theitleo use forhe wildcard in substitutionsƒlsewhere.'),

171 
$fÜm
['ş—r_¡İ'] = 
	`¬¿y
(

175 
$İtiÚs
 = 
	`¬¿y
();

176 
$v®id©e_İtiÚs
 = 
	`¬¿y
();

177 
	`fÜ—ch
 (
$deçuÉs
 
as
 
$id
 => 
$šfo
) {

178 
$İtiÚs
[
$id
] = 
$šfo
['title'];

179 ià(
	`em±y
(
$šfo
['default only'])) {

180 
$v®id©e_İtiÚs
[
$id
] = 
$šfo
['title'];

182 ià(!
	`em±y
(
$šfo
['form method'])) {

183 
$this
->{
$šfo
['fÜm m‘hod']}(
$fÜm
, 
$fÜm_¡©e
);

187 
$fÜm
['deçuÉ_aùiÚ']['#İtiÚs'] = 
$İtiÚs
;

189 
$fÜm
['v®id©e_İtiÚs_div_´efix'] = 
	`¬¿y
(

191 '#v®ue' => '<f›ld£ˆid="v›ws-v®id©Ü-İtiÚs"><Ëg’d>' . 
	`t
('Validator options') . '</legend>',

194 
$fÜm
['v®id©e_ty³'] = 
	`¬¿y
(

196 '#t™Ë' => 
	`t
('Validator'),

197 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['validate_type'],

200 
$v®id©e_ty³s
 = 
	`¬¿y
('nÚe' => 
	`t
('<Basic validation>'));

201 
$¶ugšs
 = 
	`v›ws_ãtch_¶ugš_d©a
('argument validator');

202 
	`fÜ—ch
 (
$¶ugšs
 
as
 
$id
 => 
$šfo
) {

203 ià(!
	`em±y
(
$šfo
['no ui'])) {

207 
$v®id
 = 
TRUE
;

208 ià(!
	`em±y
(
$šfo
['type'])) {

209 
$v®id
 = 
FALSE
;

210 ià(
	`em±y
(
$this
->
defš™iÚ
['validateype'])) {

213 
	`fÜ—ch
 ((
¬¿y
è
$šfo
['ty³'] 
as
 
$ty³
) {

214 ià(
$ty³
 =ğ
$this
->
defš™iÚ
['validateype']) {

215 
$v®id
 = 
TRUE
;

222 ià(
$v®id
) {

223 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('¬gum’ˆv®id©Ü', 
$id
);

224 ià(
$¶ugš
) {

225 
$¶ugš
->
	`š™
(
$this
->
v›w
, $this, 
$id
);

226 ià(
$¶ugš
->
	`acûss
(è|| 
$this
->
İtiÚs
['v®id©e_ty³'] =ğ
$id
) {

227 
$¶ugš
->
	`v®id©e_fÜm
(
$fÜm
, 
$fÜm_¡©e
, 
$id
);

228 
$v®id©e_ty³s
[
$id
] = 
$šfo
['title'];

234 
	`asÜt
(
$v®id©e_ty³s
);

235 
$fÜm
['v®id©e_ty³']['#İtiÚs'] = 
$v®id©e_ty³s
;

237 
$fÜm
['v®id©e_ç'] = 
	`¬¿y
(

239 '#t™Ë' => 
	`t
('Actionoake if‡rgument does‚ot validate'),

240 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['validate_fail'],

241 '#İtiÚs' => 
$v®id©e_İtiÚs
,

244 
$fÜm
['v®id©e_İtiÚs_div_suffix'] = 
	`¬¿y
(

247 
	}
}

255 
funùiÚ
 
	$deçuÉ_aùiÚs
(
$which
 = 
NULL
) {

256 
$deçuÉs
 = 
	`¬¿y
(

257 'ignÜe' => 
	`¬¿y
(

258 't™Ë' => 
	`t
('Display‡ll values'),

260 'b»adüumb' => 
TRUE
,

262 'nÙ found' => 
	`¬¿y
(

263 't™Ë' => 
	`t
('Hide view / Page‚ot found (404)'),

265 'h¬d fa' => 
TRUE
,

267 'em±y' => 
	`¬¿y
(

268 't™Ë' => 
	`t
('Displayƒmptyext'),

270 'b»adüumb' => 
TRUE
,

272 'summ¬y‡sc' => 
	`¬¿y
(

273 't™Ë' => 
	`t
('Summary, sorted‡scending'),

275 'm‘hod‡rgs' => 
	`¬¿y
('asc'),

276 '¡yË…lugš' => 
TRUE
,

277 'b»adüumb' => 
TRUE
,

279 'summ¬y desc' => 
	`¬¿y
(

280 't™Ë' => 
	`t
('Summary, sorted descending'),

282 'm‘hod‡rgs' => 
	`¬¿y
('desc'),

283 '¡yË…lugš' => 
TRUE
,

284 'b»adüumb' => 
TRUE
,

286 'deçuÉ' => 
	`¬¿y
(

287 't™Ë' => 
	`t
('Provide default‡rgument'),

290 'ha deçuÉ‡rgum’t' => 
TRUE
,

291 'deçuÉ oÆy' => 
TRUE
,

295 ià(
$which
) {

296 ià(!
	`em±y
(
$deçuÉs
[
$which
])) {

297  
$deçuÉs
[
$which
];

301  
$deçuÉs
;

303 
	}
}

309 
funùiÚ
 
	$deçuÉ_¬gum’t_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

310 
$¶ugšs
 = 
	`v›ws_ãtch_¶ugš_d©a
('argument default');

311 
$İtiÚs
 = 
	`¬¿y
();

317 
$fÜm
['deçuÉ_İtiÚs_div_´efix'] = 
	`¬¿y
(

320 '#´efix' => '<div><f›ld£ˆid="v›ws-deçuÉ-İtiÚs"><Ëg’d>' . 
	`t
('Provide default‡rgument options') . '</legend>',

321 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

322 '#d•’d’cy' => 
	`¬¿y
('radio:options[default_action]' =>‡rray('default')),

325 
$fÜm
['deçuÉ_¬gum’t_ty³'] = 
	`¬¿y
(

330 '#t™Ë' => 
	`t
('Default‡rgumentype'),

331 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['default_argument_type'],

332 '#´oûss' => 
	`¬¿y
('expand_radios', 'views_process_dependency'),

333 '#d•’d’cy' => 
	`¬¿y
('radio:options[default_action]' =>‡rray('default')),

336 
	`fÜ—ch
 (
$¶ugšs
 
as
 
$id
 => 
$šfo
) {

337 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('¬gum’ˆdeçuÉ', 
$id
);

338 ià(
$¶ugš
) {

339 
$¶ugš
->
	`š™
(
$this
->
v›w
, $this, 
$id
);

341 ià(
$¶ugš
->
	`acûss
(è|| 
$this
->
İtiÚs
['deçuÉ_¬gum’t_ty³'] =ğ
$id
) {

342 
$İtiÚs
[
$id
] = 
$šfo
['title'];

343 
$¶ugš
->
	`¬gum’t_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

348 
$fÜm
['deçuÉ_İtiÚs_div_suffix'] = 
	`¬¿y
(

352 
	`asÜt
(
$İtiÚs
);

353 
$fÜm
['deçuÉ_¬gum’t_ty³']['#İtiÚs'] = 
$İtiÚs
;

354 
	}
}

365 
funùiÚ
 
	$deçuÉ_aùiÚ
(
$šfo
 = 
NULL
) {

366 ià(!
	`is£t
(
$šfo
)) {

367 
$šfo
 = 
$this
->
	`deçuÉ_aùiÚs
($this->
İtiÚs
['default_action']);

370 ià(!
$šfo
) {

371  
FALSE
;

374 ià(!
	`em±y
(
$šfo
['method‡rgs'])) {

375  
	`ÿÎ_u£r_func_¬¿y
(
	`¬¿y
(&
$this
, 
$šfo
['method']), $info['method‡rgs']);

378  
$this
->{
$šfo
['method']}();

380 
	}
}

385 
funùiÚ
 
	$v®id©e_ç
() {

386 
$šfo
 = 
$this
->
	`deçuÉ_aùiÚs
($this->
İtiÚs
['validate_fail']);

387  
$this
->
	`deçuÉ_aùiÚ
(
$šfo
);

388 
	}
}

395 
funùiÚ
 
	$deçuÉ_ignÜe
() {

396  
TRUE
;

397 
	}
}

405 
funùiÚ
 
	$deçuÉ_nÙ_found
() {

407 
$this
->
v›w
->
bud_šfo
['ç'] = 
TRUE
;

408  
FALSE
;

409 
	}
}

417 
funùiÚ
 
	$deçuÉ_em±y
() {

419 
$this
->
v›w
->
but
 = 
TRUE
;

420 
$this
->
v›w
->
execu‹d
 = 
TRUE
;

421 
$this
->
v›w
->
»suÉ
 = 
	`¬¿y
();

422  
FALSE
;

423 
	}
}

429 
funùiÚ
 
	$deçuÉ_deçuÉ
() {

430  
TRUE
;

431 
	}
}

436 
funùiÚ
 
	$has_deçuÉ_¬gum’t
() {

437 
$šfo
 = 
$this
->
	`deçuÉ_aùiÚs
($this->
İtiÚs
['default_action']);

438  !
	`em±y
(
$šfo
['has default‡rgument']);

439 
	}
}

444 
funùiÚ
 
	$g‘_deçuÉ_¬gum’t
() {

445 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('¬gum’ˆdeçuÉ', 
$this
->
İtiÚs
['default_argument_type']);

446 ià(
$¶ugš
) {

447 
$¶ugš
->
	`š™
(
$this
->
v›w
, $this);

448  
$¶ugš
->
	`g‘_¬gum’t
();

450 
	}
}

458 
funùiÚ
 
	$deçuÉ_summ¬y
(
$Üd”
) {

459 
$this
->
v›w
->
bud_šfo
['summ¬y'] = 
TRUE
;

460 
$this
->
v›w
->
bud_šfo
['summ¬y_Ëv–'] = $this->
İtiÚs
['id'];

464 
$this
->
v›w
->
¶ugš_Çme
 = $this->
İtiÚs
['style_plugin'];

465 
$this
->
v›w
->
¡yË_İtiÚs
 = $this->
İtiÚs
['style_options'];

469 
$this
->
qu”y
->
	`ş—r_f›lds
();

470 
$this
->
	`summ¬y_qu”y
();

472 
$this
->
	`summ¬y_sÜt
(
$Üd”
);

476 
$this
->
v›w
->
bud_sÜt
 = $this->v›w->
bud_f›lds
 = 
FALSE
;

477  
TRUE
;

478 
	}
}

492 
funùiÚ
 
	$summ¬y_qu”y
() {

493 
$this
->
	`’su»_my_bË
();

495 
$this
->
ba£_®Ÿs
 = $this->
qu”y
->
	`add_f›ld
($this->
bË_®Ÿs
, $this->
»®_f›ld
);

497 
$this
->
	`summ¬y_Çme_f›ld
();

498  
$this
->
	`summ¬y_basics
();

499 
	}
}

505 
funùiÚ
 
	$summ¬y_Çme_f›ld
() {

509 ià(
	`is£t
(
$this
->
Çme_bË
)) {

512 ià(
$this
->
bË_®Ÿs
 !ğ$this->
bË
) {

513 
$j
 = 
	`v›ws_g‘_bË_još
(
$this
->
Çme_bË
, $this->
bË
);

514 ià(
$j
) {

515 
$još
 = 
	`dru·l_şÚe
(
$j
);

516 
$još
->
Ëá_bË
 = 
$this
->
bË_®Ÿs
;

517 
$this
->
Çme_bË_®Ÿs
 = $this->
qu”y
->
	`add_bË
($this->
Çme_bË
, $this->
»ÏtiÚsh
, 
$još
);

521 
$this
->
Çme_bË_®Ÿs
 = $this->
qu”y
->
	`’su»_bË
($this->
Çme_bË
, $this->
»ÏtiÚsh
);

525 
$this
->
Çme_bË_®Ÿs
 = $this->
bË_®Ÿs
;

528 ià(
	`is£t
(
$this
->
Çme_f›ld
)) {

529 
$this
->
Çme_®Ÿs
 = $this->
qu”y
->
	`add_f›ld
($this->
Çme_bË_®Ÿs
, $this->
Çme_f›ld
);

532 
$this
->
Çme_®Ÿs
 = $this->
ba£_®Ÿs
;

534 
	}
}

540 
funùiÚ
 
	$summ¬y_basics
(
$couÁ_f›ld
 = 
TRUE
) {

542 
$f›ld
 = 
$this
->
qu”y
->
ba£_bË
 . '.' . $this->qu”y->
ba£_f›ld
;

543 
$di¡šù
 = (
$this
->
v›w
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('di¡šù'è&& 
	`em±y
($this->
qu”y
->
no_di¡šù
));

545 
$couÁ_®Ÿs
 = 
$this
->
qu”y
->
	`add_f›ld
(
NULL
, 
$f›ld
, 'num_records',

546 
	`¬¿y
('couÁ' => 
TRUE
, 'di¡šù' => 
$di¡šù
));

547 
$this
->
qu”y
->
	`add_groupby
($this->
Çme_®Ÿs
);

549 ià(
$couÁ_f›ld
) {

550 
$this
->
qu”y
->
	`£t_couÁ_f›ld
($this->
bË_®Ÿs
, $this->
»®_f›ld
);

553 
$this
->
couÁ_®Ÿs
 = 
$couÁ_®Ÿs
;

554 
	}
}

563 
funùiÚ
 
	$summ¬y_sÜt
(
$Üd”
) {

564 
$this
->
qu”y
->
	`add_Üd”by
(
NULL
, NULL, 
$Üd”
, $this->
Çme_®Ÿs
);

565 
	}
}

575 
funùiÚ
 
	$summ¬y_¬gum’t
(
$d©a
) {

576  
$d©a
->{
$this
->
ba£_®Ÿs
};

577 
	}
}

586 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

587 
$v®ue
 = 
$d©a
->{
$this
->
Çme_®Ÿs
};

588 ià(
	`em±y
(
$v®ue
è&& !em±y(
$this
->
defš™iÚ
['empty field‚ame'])) {

589 
$v®ue
 = 
$this
->
defš™iÚ
['empty field‚ame'];

591  
	`check_¶aš
(
$v®ue
);

592 
	}
}

599 
funùiÚ
 
	$qu”y
() {

600 
$this
->
	`’su»_my_bË
();

601 
$¶aûhŞd”
 = 
	`em±y
(
$this
->
defš™iÚ
['numeric']) ? "'%s'" : '%d';

602 
$this
->
qu”y
->
	`add_wh”e
(0, "$this->bË_®Ÿs.$this->»®_f›ld = $¶aûhŞd”", $this->
¬gum’t
);

603 
	}
}

610 
funùiÚ
 
	$t™Ë
() {

611  
	`check_¶aš
(
$this
->
¬gum’t
);

612 
	}
}

618 
funùiÚ
 
	$g‘_t™Ë
() {

619 ià(
	`is£t
(
$this
->
v®id©ed_t™Ë
)) {

620  
$this
->
v®id©ed_t™Ë
;

623  
$this
->
	`t™Ë
();

625 
	}
}

630 
funùiÚ
 
	$v®id©e_¬g
(
$¬g
) {

633 ià(
	`is£t
(
$this
->
¬gum’t_v®id©ed
)) {

634  
$this
->
¬gum’t_v®id©ed
;

637 ià(
$this
->
	`is_wdÿrd
(
$¬g
)) {

638  
$this
->
¬gum’t_v®id©ed
 = 
TRUE
;

641 ià(
$this
->
İtiÚs
['validate_type'] == 'none') {

642  
$this
->
¬gum’t_v®id©ed
 = $this->
	`v®id©e_¬gum’t_basic
(
$¬g
);

645 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('¬gum’ˆv®id©Ü', 
$this
->
İtiÚs
['validate_type']);

646 ià(
$¶ugš
) {

647 
$¶ugš
->
	`š™
(
$this
->
v›w
, $this, $this->
İtiÚs
['validate_type']);

648  
$this
->
¬gum’t_v®id©ed
 = 
$¶ugš
->
	`v®id©e_¬gum’t
(
$¬g
);

652  
$this
->
¬gum’t_v®id©ed
 = $this->
	`v®id©e_¬gum’t_basic
(
$¬g
);

653 
	}
}

662 
funùiÚ
 
	$v®id©e_¬gum’t
(
$¬g
) {

663 
$v®id©e_šfo
 = 
$this
->
	`deçuÉ_aùiÚs
($this->
İtiÚs
['validate_fail']);

664 ià(
	`em±y
(
$v®id©e_šfo
['hard fail'])) {

665  
TRUE
;

668 
$rc
 = 
$this
->
	`v®id©e_¬g
(
$¬g
);

672 
$v®id©e_šfo
 = 
$this
->
	`deçuÉ_aùiÚs
($this->
İtiÚs
['validate_fail']);

673 ià(
	`em±y
(
$v®id©e_šfo
['hard fail'])) {

674  
TRUE
;

677  
$rc
;

678 
	}
}

687 
funùiÚ
 
	$v®id©e_¬gum’t_basic
(
$¬g
) {

688 ià(!
	`is£t
(
$¬g
) || $arg === '') {

689  
FALSE
;

692 ià(!
	`em±y
(
$this
->
defš™iÚ
['num”ic']è&& !
	`is£t
($this->
İtiÚs
['b»ak_ph¿£']è&& !
	`is_num”ic
(
$¬g
)) {

693  
FALSE
;

696  
TRUE
;

697 
	}
}

704 
funùiÚ
 
	$£t_¬gum’t
(
$¬g
) {

705 
$this
->
¬gum’t
 = 
$¬g
;

706  
$this
->
	`v®id©e_¬g
(
$¬g
);

707 
	}
}

712 
funùiÚ
 
	$g‘_v®ue
() {

714 ià(
	`is£t
(
$this
->
¬gum’t
)) {

715  
$this
->
¬gum’t
;

719 
$v®ue
 = 
NULL
;

721 
$pos™iÚ
 = 0;

722 
	`fÜ—ch
 (
$this
->
v›w
->
¬gum’t
 
as
 
$id
 => 
$¬gum’t
) {

723 ià(
$id
 =ğ
$this
->
İtiÚs
['id']) {

726 
$pos™iÚ
++;

729 
$¬g
 = 
	`is£t
(
$this
->
v›w
->
¬gs
[
$pos™iÚ
]è? $this->v›w->¬gs[$pos™iÚ] : 
NULL
;

730 
$this
->
pos™iÚ
 = 
$pos™iÚ
;

734 
$¬gum’t
 = 
	`dru·l_şÚe
(
$this
);

735 ià(!
	`is£t
(
$¬g
è&& 
$¬gum’t
->
	`has_deçuÉ_¬gum’t
()) {

736 
$¬g
 = 
$¬gum’t
->
	`g‘_deçuÉ_¬gum’t
();

739 ià(
$¬gum’t
->
	`£t_¬gum’t
(
$¬g
)) {

740 
$v®ue
 = 
$¬gum’t
->
¬gum’t
;

742 
	`un£t
(
$¬gum’t
);

743  
$v®ue
;

744 
	}
}

752 şas 
	cv›ws_hªdËr_¬gum’t_brok’
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

753 
funùiÚ
 
	$ui_Çme
(
$shÜt
 = 
FALSE
) {

754  
	`t
('Broken/missing handler');

757 
funùiÚ
 
	$’su»_my_bË
(è{ 
	}
}

758 
funùiÚ
 
	$qu”y
(è{ 
	}
}

759 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

760 
$fÜm
['m¬kup'] = 
	`¬¿y
(

762 '#v®ue' => 
	`t
('The handler forhis item is broken or missing‡nd cannot be used. If‡ module…rovidedhe handler‡nd was disabled,„e-enablinghe module may„estore it. Otherwise, you should…robably deletehis item.'),

764 
	}
}

769 
funùiÚ
 
	$brok’
(è{  
TRUE
; 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument_date.inc

1 <?
php


20 şas 
	cv›ws_hªdËr_¬gum’t_d©e
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_fÜmuÏ
 {

21 
v¬
 
	m$İtiÚ_Çme
 = 'default_argument_date';

22 
v¬
 
	m$¬g_fÜm©
 = 'Y-m-d';

27 
funùiÚ
 
	$deçuÉ_¬gum’t_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

28 
·»Á
::
	`deçuÉ_¬gum’t_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

29 
$fÜm
['deçuÉ_¬gum’t_ty³']['#İtiÚs'] +ğ
	`¬¿y
('d©e' => 
	`t
('Current date'));

30 
$fÜm
['deçuÉ_¬gum’t_ty³']['#İtiÚs'] +ğ
	`¬¿y
('node_ü—‹d' => 
	`t
("Current‚ode's creationime"));

31 
$fÜm
['deçuÉ_¬gum’t_ty³']['#İtiÚs'] +ğ
	`¬¿y
('node_chªged' => 
	`t
("Current‚ode's updateime")); }

37 
funùiÚ
 
	$g‘_deçuÉ_¬gum’t
(
$¿w
 = 
FALSE
) {

38 ià(!
$¿w
 && 
$this
->
İtiÚs
['default_argument_type'] == 'date') {

39  
	`d©e
(
$this
->
¬g_fÜm©
, 
	`time
());

41 ià(!
$¿w
 && 
	`š_¬¿y
(
$this
->
İtiÚs
['deçuÉ_¬gum’t_ty³'], 
	`¬¿y
('node_created', 'node_changed'))) {

42 
	`fÜ—ch
 (
	`¿nge
(1, 3è
as
 
$i
) {

43 
$node
 = 
	`m’u_g‘_objeù
('node', 
$i
);

44 ià(!
	`em±y
(
$node
)) {

49 ià(
	`¬g
(0è=ğ'node' && 
	`is_num”ic
(arg(1))) {

50 
$node
 = 
	`node_lßd
(
	`¬g
(1));

53 ià(
	`em±y
(
$node
)) {

54  
·»Á
::
	`g‘_deçuÉ_¬gum’t
();

56 ià(
$this
->
İtiÚs
['default_argument_type'] == 'node_created') {

57  
	`d©e
(
$this
->
¬g_fÜm©
, 
$node
->
ü—‹d
);

59 ià(
$this
->
İtiÚs
['default_argument_type'] == 'node_changed') {

60  
	`d©e
(
$this
->
¬g_fÜm©
, 
$node
->
chªged
);

64  
·»Á
::
	`g‘_deçuÉ_¬gum’t
(
$¿w
);

66 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument_formula.inc

1 <?
php


13 şas 
	cv›ws_hªdËr_¬gum’t_fÜmuÏ
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

14 
v¬
 
	m$fÜmuÏ
 = 
NULL
;

18 
funùiÚ
 
	$cÚ¡ruù
() {

19 
·»Á
::
	`cÚ¡ruù
();

21 ià(!
	`em±y
(
$this
->
defš™iÚ
['formula'])) {

22 
$this
->
fÜmuÏ
 = $this->
defš™iÚ
['formula'];

26 
funùiÚ
 
	$g‘_fÜmuÏ
() {

27  
	`¡r_»¶aû
('***bË***', 
$this
->
bË_®Ÿs
, $this->
fÜmuÏ
);

28 
	}
}

33 
funùiÚ
 
	$summ¬y_qu”y
() {

34 
$this
->
	`’su»_my_bË
();

36 
$fÜmuÏ
 = 
$this
->
	`g‘_fÜmuÏ
();

39 
$this
->
ba£_®Ÿs
 = $this->
Çme_®Ÿs
 = $this->
qu”y
->
	`add_f›ld
(
NULL
, 
$fÜmuÏ
, $this->
f›ld
);

40 
$this
->
qu”y
->
	`£t_couÁ_f›ld
(
NULL
, 
$fÜmuÏ
, $this->
f›ld
);

42  
$this
->
	`summ¬y_basics
(
FALSE
);

43 
	}
}

48 
funùiÚ
 
	$qu”y
() {

49 
$this
->
	`’su»_my_bË
();

51 
$fÜmuÏ
 = 
$this
->
	`g‘_fÜmuÏ
();

53 
$this
->
qu”y
->
	`add_wh”e
(0, "$fÜmuÏ = '%s'", $this->
¬gum’t
);

54 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument_many_to_one.inc

1 <?
php


16 şas 
	cv›ws_hªdËr_¬gum’t_mªy_to_Úe
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

17 
funùiÚ
 
	$š™
(&
$v›w
, &
$İtiÚs
) {

18 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

19 
$this
->
h–³r
 = 
Ãw
 
	`v›ws_mªy_to_Úe_h–³r
($this);

22 
$this
->
İ”©Ü
 = 'or';

23 
$this
->
v®ue
 = 
	`¬¿y
();

26 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

27 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

29 ià(!
	`em±y
(
$this
->
defš™iÚ
['numeric'])) {

30 
$İtiÚs
['b»ak_ph¿£'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

33 
$İtiÚs
['add_bË'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

34 
$İtiÚs
['»quœe_v®ue'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

36 
v›ws_mªy_to_Úe_h–³r
::
	`İtiÚ_defš™iÚ
(
$İtiÚs
);

37  
$İtiÚs
;

38 
	}
}

40 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

41 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

44 ià(!
	`em±y
(
$this
->
defš™iÚ
['numeric'])) {

45 
$fÜm
['b»ak_ph¿£'] = 
	`¬¿y
(

47 '#t™Ë' => 
	`t
('Allow multipleerms…er‡rgument.'),

48 '#desütiÚ' => 
	`t
('If selected, users canƒnter multiple‡rguments inhe form of 1+2+3 (for OR) or 1,2,3 (for AND).'),

49 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['break_phrase']),

53 
$fÜm
['add_bË'] = 
	`¬¿y
(

55 '#t™Ë' => 
	`t
('Allow multiple‡rgumentso workogether.'),

56 '#desütiÚ' => 
	`t
('If selected, multiple instances ofhis‡rgument can workogether,‡shough multipleerms were suppliedohe same‡rgument. This setting is‚ot compatible withhe "Reduce duplicates" setting.'),

57 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['add_table']),

60 
$fÜm
['»quœe_v®ue'] = 
	`¬¿y
(

62 '#t™Ë' => 
	`t
('Do‚ot display items with‚o value in summary'),

63 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['require_value']),

66 
$this
->
h–³r
->
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

67 
	}
}

73 
funùiÚ
 
	$’su»_my_bË
() {

74 
$this
->
h–³r
->
	`’su»_my_bË
();

75 
	}
}

77 
funùiÚ
 
	$qu”y
() {

78 
$em±y
 = 
FALSE
;

79 ià(
	`is£t
(
$this
->
defš™iÚ
['zero is‚ull']) && $this->definition['zero is‚ull']) {

80 ià(
	`em±y
(
$this
->
¬gum’t
)) {

81 
$em±y
 = 
TRUE
;

85 ià(!
	`is£t
(
$this
->
¬gum’t
)) {

86 
$em±y
 = 
TRUE
;

89 ià(
$em±y
) {

90 
·»Á
::
	`’su»_my_bË
();

91 
$this
->
qu”y
->
	`add_wh”e
(0, "$this->table_alias.$this->real_field IS NULL");

95 ià(!
	`em±y
(
$this
->
İtiÚs
['break_phrase'])) {

96 
	`v›ws_b»ak_ph¿£
(
$this
->
¬gum’t
, $this);

99 
$this
->
v®ue
 = 
	`¬¿y
($this->
¬gum’t
);

100 
$this
->
İ”©Ü
 = 'or';

103 
$this
->
h–³r
->
	`add_f‹r
();

104 
	}
}

106 
funùiÚ
 
	$t™Ë
() {

107 ià(!
$this
->
¬gum’t
) {

108  !
	`em±y
(
$this
->
defš™iÚ
['em±y f›ld‚ame']è? $this->defš™iÚ['em±y f›ld‚ame'] : 
	`t
('Uncategorized');

111 ià(!
	`em±y
(
$this
->
İtiÚs
['break_phrase'])) {

112 
	`v›ws_b»ak_ph¿£
(
$this
->
¬gum’t
, $this);

115 
$this
->
v®ue
 = 
	`¬¿y
($this->
¬gum’t
);

116 
$this
->
İ”©Ü
 = 'or';

121 ià(
	`em±y
(
$this
->
v®ue
)) {

122  !
	`em±y
(
$this
->
defš™iÚ
['em±y f›ld‚ame']è? $this->defš™iÚ['em±y f›ld‚ame'] : 
	`t
('Uncategorized');

125 ià(
$this
->
v®ue
 ==ğ
	`¬¿y
(-1)) {

126  !
	`em±y
(
$this
->
defš™iÚ
['šv®id iÅut']è? $this->defš™iÚ['šv®id iÅut'] : 
	`t
('Invalid input');

129  
	`im¶ode
(
$this
->
İ”©Ü
 =ğ'Ü' ? ' + ' : ', ', $this->
	`t™Ë_qu”y
());

130 
	}
}

132 
funùiÚ
 
	$summ¬y_qu”y
() {

133 
$f›ld
 = 
$this
->
bË
 . '.' . $this->
f›ld
;

134 
$još
 = 
$this
->
	`g‘_još
();

136 ià(!
	`em±y
(
$this
->
İtiÚs
['require_value'])) {

137 
$još
->
ty³
 = 'INNER';

140 ià(
	`em±y
(
$this
->
İtiÚs
['add_bË']è||ƒm±y($this->
v›w
->
mªy_to_Úe_bËs
[
$f›ld
])) {

141 
$this
->
bË_®Ÿs
 = $this->
qu”y
->
	`’su»_bË
($this->
bË
, $this->
»ÏtiÚsh
, 
$još
);

144 
$this
->
bË_®Ÿs
 = $this->
h–³r
->
	`summ¬y_još
();

148 
$this
->
ba£_®Ÿs
 = $this->
qu”y
->
	`add_f›ld
($this->
bË_®Ÿs
, $this->
»®_f›ld
);

150 
$this
->
	`summ¬y_Çme_f›ld
();

152  
$this
->
	`summ¬y_basics
();

153 
	}
}

155 
funùiÚ
 
	$summ¬y_¬gum’t
(
$d©a
) {

156 
$v®ue
 = 
$d©a
->{
$this
->
ba£_®Ÿs
};

157 ià(
	`em±y
(
$v®ue
)) {

158 
$v®ue
 = 0;

161  
$v®ue
;

162 
	}
}

167 
funùiÚ
 
	$t™Ë_qu”y
() {

168  
$this
->
v®ue
;

169 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument_null.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_¬gum’t_nuÎ
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

7 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

8 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

9 
$İtiÚs
['mu¡_nÙ_be'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

10  
$İtiÚs
;

17 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

18 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

19 
$fÜm
['mu¡_nÙ_be'] = 
	`¬¿y
(

21 '#t™Ë' => 
	`t
('Fail basic validation if‡ny‡rgument is given'),

22 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['must_not_be']),

23 '#desütiÚ' => 
	`t
('By checkinghis field, you can usehiso make sure views with more‡rgumentshan‚ecessary fail validation.'),

26 
	`un£t
(
$fÜm
['wildcard']);

27 
	`un£t
(
$fÜm
['wildcard_substitution']);

28 
	}
}

34 
funùiÚ
 
	$deçuÉ_aùiÚs
(
$which
 = 
NULL
) {

35 ià(
$which
) {

36 ià(
	`š_¬¿y
(
$which
, 
	`¬¿y
('ignore', 'not found', 'empty', 'default'))) {

37  
·»Á
::
	`deçuÉ_aùiÚs
(
$which
);

41 
$aùiÚs
 = 
·»Á
::
	`deçuÉ_aùiÚs
();

42 
	`un£t
(
$aùiÚs
['summary‡sc']);

43 
	`un£t
(
$aùiÚs
['summary desc']);

44  
$aùiÚs
;

45 
	}
}

47 
funùiÚ
 
	$v®id©e_¬gum’t_basic
(
$¬g
) {

48 ià(!
	`em±y
(
$this
->
İtiÚs
['must_not_be'])) {

49  !
	`is£t
(
$¬g
);

52  
·»Á
::
	`v®id©e_¬gum’t_basic
(
$¬g
);

53 
	}
}

59 
funùiÚ
 
	$qu”y
(è{
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument_numeric.inc

1 <?
php


14 şas 
	cv›ws_hªdËr_¬gum’t_num”ic
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

15 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

16 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

18 
$İtiÚs
['b»ak_ph¿£'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

19 
$İtiÚs
['nÙ'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

21  
$İtiÚs
;

24 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

25 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

28 
$fÜm
['b»ak_ph¿£'] = 
	`¬¿y
(

30 '#t™Ë' => 
	`t
('Allow multipleerms…er‡rgument.'),

31 '#desütiÚ' => 
	`t
('If selected, users canƒnter multiple‡rguments inhe form of 1+2+3 or 1,2,3.'),

32 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['break_phrase']),

35 
$fÜm
['nÙ'] = 
	`¬¿y
(

37 '#t™Ë' => 
	`t
('Excludehe‡rgument'),

38 '#desütiÚ' => 
	`t
('If selected,he‚umbersƒntered inhe‡rgument will beƒxcluded„atherhan†imitinghe view.'),

39 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['not']),

41 
	}
}

43 
funùiÚ
 
	$t™Ë
() {

44 ià(!
$this
->
¬gum’t
) {

45  !
	`em±y
(
$this
->
defš™iÚ
['em±y f›ld‚ame']è? $this->defš™iÚ['em±y f›ld‚ame'] : 
	`t
('Uncategorized');

48 ià(!
	`em±y
(
$this
->
İtiÚs
['break_phrase'])) {

49 
	`v›ws_b»ak_ph¿£
(
$this
->
¬gum’t
, $this);

52 
$this
->
v®ue
 = 
	`¬¿y
($this->
¬gum’t
);

53 
$this
->
İ”©Ü
 = 'or';

56 ià(
	`em±y
(
$this
->
v®ue
)) {

57  !
	`em±y
(
$this
->
defš™iÚ
['em±y f›ld‚ame']è? $this->defš™iÚ['em±y f›ld‚ame'] : 
	`t
('Uncategorized');

60 ià(
$this
->
v®ue
 ==ğ
	`¬¿y
(-1)) {

61  !
	`em±y
(
$this
->
defš™iÚ
['šv®id iÅut']è? $this->defš™iÚ['šv®id iÅut'] : 
	`t
('Invalid input');

64  
	`im¶ode
(
$this
->
İ”©Ü
 =ğ'Ü' ? ' + ' : ', ', $this->
	`t™Ë_qu”y
());

65 
	}
}

70 
funùiÚ
 
	$t™Ë_qu”y
() {

71  
$this
->
v®ue
;

72 
	}
}

74 
funùiÚ
 
	$qu”y
() {

75 
$this
->
	`’su»_my_bË
();

77 ià(!
	`em±y
(
$this
->
İtiÚs
['break_phrase'])) {

78 
	`v›ws_b»ak_ph¿£
(
$this
->
¬gum’t
, $this);

81 
$this
->
v®ue
 = 
	`¬¿y
($this->
¬gum’t
);

84 ià(
	`couÁ
(
$this
->
v®ue
) > 1) {

85 
$İ”©Ü
 = 
	`em±y
(
$this
->
İtiÚs
['not']) ? 'IN' : 'NOT IN';

86 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$this
->
v®ue
), '%d'));

87 
$this
->
qu”y
->
	`add_wh”e
(0, "$this->bË_®Ÿs.$this->»®_f›ld $İ”©Ü ($¶aûhŞd”s)", $this->
v®ue
);

90 
$İ”©Ü
 = 
	`em±y
(
$this
->
İtiÚs
['not']) ? '=' : '!=';

91 
$this
->
qu”y
->
	`add_wh”e
(0, "$this->bË_®Ÿs.$this->»®_f›ld $İ”©Ü %d", $this->
¬gum’t
);

93 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument_string.inc

1 <?
php


10 şas 
	cv›ws_hªdËr_¬gum’t_¡ršg
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

11 
funùiÚ
 
	$š™
(&
$v›w
, &
$İtiÚs
) {

12 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

13 ià(!
	`em±y
(
$this
->
defš™iÚ
['manyo one'])) {

14 
$this
->
h–³r
 = 
Ãw
 
	`v›ws_mªy_to_Úe_h–³r
($this);

17 
$this
->
İ”©Ü
 = 'or';

18 
$this
->
v®ue
 = 
	`¬¿y
();

22 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

23 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

25 
$İtiÚs
['glos§ry'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

26 
$İtiÚs
['lim™'] = 
	`¬¿y
('default' => 0);

27 
$İtiÚs
['ÿ£'] = 
	`¬¿y
('default' => 'none');

28 
$İtiÚs
['·th_ÿ£'] = 
	`¬¿y
('default' => 'none');

29 
$İtiÚs
['ŒªsfÜm_dash'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

31 ià(!
	`em±y
(
$this
->
defš™iÚ
['manyo one'])) {

32 
$İtiÚs
['add_bË'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

33 
$İtiÚs
['»quœe_v®ue'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

36  
$İtiÚs
;

37 
	}
}

39 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

40 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

42 
$fÜm
['glos§ry'] = 
	`¬¿y
(

44 '#t™Ë' => 
	`t
('Glossary mode'),

45 '#desütiÚ' => 
	`t
('Glossary mode‡pplies‡†imitohe‚umber of characters used inhe‡rgument, which‡llowshe summary viewo‡ct‡s‡ glossary.'),

46 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['glossary'],

49 
$fÜm
['lim™'] = 
	`¬¿y
(

51 '#t™Ë' => 
	`t
('Character†imit'),

52 '#desütiÚ' => 
	`t
('How many characters ofhe‡rgumento filter‡gainst. If seto 1,‡ll fields starting withhe†etter inhe‡rgument would be matched.'),

53 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['limit'],

54 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

55 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-glos§ry' =>‡¼ay(
TRUE
)),

58 
$fÜm
['ÿ£'] = 
	`¬¿y
(

60 '#t™Ë' => 
	`t
('Case'),

61 '#desütiÚ' => 
	`t
('When…rintinghe‡rgument„esult, howoransformhe case.'),

62 '#İtiÚs' => 
	`¬¿y
(

63 'nÚe' => 
	`t
('Noransform'),

64 'uµ”' => 
	`t
('Upper case'),

65 'low”' => 
	`t
('Lower case'),

66 'ucfœ¡' => 
	`t
('Capitalize first†etter'),

67 'ucwÜds' => 
	`t
('Capitalizeƒach word'),

69 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['case'],

72 
$fÜm
['·th_ÿ£'] = 
	`¬¿y
(

74 '#t™Ë' => 
	`t
('Case in…ath'),

75 '#desütiÚ' => 
	`t
('When…rinting url…aths, howoransformhe case ofhe‡rgument. Do‚ot usehis unless with Postgres‡s it uses case sensitive comparisons.'),

76 '#İtiÚs' => 
	`¬¿y
(

77 'nÚe' => 
	`t
('Noransform'),

78 'uµ”' => 
	`t
('Upper case'),

79 'low”' => 
	`t
('Lower case'),

80 'ucfœ¡' => 
	`t
('Capitalize first†etter'),

81 'ucwÜds' => 
	`t
('Capitalizeƒach word'),

83 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['path_case'],

86 
$fÜm
['ŒªsfÜm_dash'] = 
	`¬¿y
(

88 '#t™Ë' => 
	`t
('Transform spaceso dashes in URL'),

89 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['transform_dash'],

92 ià(!
	`em±y
(
$this
->
defš™iÚ
['manyo one'])) {

93 
$fÜm
['add_bË'] = 
	`¬¿y
(

95 '#t™Ë' => 
	`t
('Allow multiple‡rgumentso workogether.'),

96 '#desütiÚ' => 
	`t
('If selected, multiple instances ofhis‡rgument can workogether,‡shough multipleerms were suppliedohe same‡rgument. This setting is‚ot compatible withhe "Reduce duplicates" setting.'),

97 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['add_table']),

100 
$fÜm
['»quœe_v®ue'] = 
	`¬¿y
(

102 '#t™Ë' => 
	`t
('Do‚ot display items with‚o value in summary'),

103 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['require_value']),

106 
	}
}

111 
funùiÚ
 
	$summ¬y_qu”y
() {

112 ià(
	`em±y
(
$this
->
defš™iÚ
['manyo one'])) {

113 
$this
->
	`’su»_my_bË
();

116 
$this
->
bË_®Ÿs
 = $this->
h–³r
->
	`summ¬y_još
();

119 ià(
	`em±y
(
$this
->
İtiÚs
['glossary'])) {

121 
$this
->
ba£_®Ÿs
 = $this->
Çme_®Ÿs
 = $this->
qu”y
->
	`add_f›ld
($this->
bË_®Ÿs
, $this->
»®_f›ld
);

122 
$this
->
qu”y
->
	`£t_couÁ_f›ld
($this->
bË_®Ÿs
, $this->
»®_f›ld
);

126 
$fÜmuÏ
 = 
$this
->
	`g‘_fÜmuÏ
();

127 
$this
->
ba£_®Ÿs
 = $this->
Çme_®Ÿs
 = $this->
qu”y
->
	`add_f›ld
(
NULL
, 
$fÜmuÏ
, $this->
f›ld
 . '_truncated');

128 
$this
->
qu”y
->
	`£t_couÁ_f›ld
(
NULL
, 
$fÜmuÏ
, $this->
f›ld
, $this->field . '_truncated');

131  
$this
->
	`summ¬y_basics
(
FALSE
);

132 
	}
}

139 
funùiÚ
 
	$g‘_fÜmuÏ
() {

140  "SUBSTR($this->bË_®Ÿs.$this->»®_f›ld, 1, " . 
	`štv®
(
$this
->
İtiÚs
['limit']) . ")";

141 
	}
}

146 
funùiÚ
 
	$qu”y
() {

147 
$¬gum’t
 = 
$this
->
¬gum’t
;

148 ià(!
	`em±y
(
$this
->
İtiÚs
['transform_dash'])) {

149 
$¬gum’t
 = 
	`¡¹r
($argument, '-', ' ');

152 ià(!
	`em±y
(
$this
->
defš™iÚ
['manyo one'])) {

153 ià(!
	`em±y
(
$this
->
İtiÚs
['glossary'])) {

154 
$this
->
h–³r
->
fÜmuÏ
 = 
TRUE
;

156 
$this
->
v®ue
 = 
	`¬¿y
(
$¬gum’t
);

157 
$this
->
h–³r
->
	`’su»_my_bË
();

158 
$this
->
h–³r
->
	`add_f‹r
();

162 
$this
->
	`’su»_my_bË
();

163 ià(
	`em±y
(
$this
->
İtiÚs
['glossary'])) {

164 
$f›ld
 = "$this->table_alias.$this->real_field";

167 
$f›ld
 = 
$this
->
	`g‘_fÜmuÏ
();

170 
$this
->
qu”y
->
	`add_wh”e
(0, "$f›ld = '%s'", 
$¬gum’t
);

171 
	}
}

173 
funùiÚ
 
	$summ¬y_¬gum’t
(
$d©a
) {

174 
$v®ue
 = 
$this
->
	`ÿ£_ŒªsfÜm
(
$d©a
->{$this->
ba£_®Ÿs
}, 'path_case');

175 ià(!
	`em±y
(
$this
->
İtiÚs
['transform_dash'])) {

176 
$v®ue
 = 
	`¡¹r
($value, ' ', '-');

178  
$v®ue
;

179 
	}
}

181 
funùiÚ
 
	$ÿ£_ŒªsfÜm
(
$¡ršg
, 
$İtiÚ
) {

182 
glob®
 
$muÉiby‹
;

184 
$this
->
İtiÚs
[
$İtiÚ
]) {

186  
$¡ršg
;

188  
	`dru·l_¡¹ouµ”
(
$¡ršg
);

190  
	`dru·l_¡¹Şow”
(
$¡ršg
);

192  
	`dru·l_¡¹ouµ”
(
	`dru·l_sub¡r
(
$¡ršg
, 0, 1)) . drupal_substr($string, 1);

194 ià(
$muÉiby‹
 =ğ
UNICODE_MULTIBYTE
) {

195  
	`mb_cÚv”t_ÿ£
(
$¡ršg
, 
MB_CASE_TITLE
);

197  
	`ucwÜds
(
$¡ršg
);

200 
	}
}

202 
funùiÚ
 
	$t™Ë
() {

203 
$t™Ë
 = 
$this
->
	`ÿ£_ŒªsfÜm
($this->
¬gum’t
, 'case');

204 ià(!
	`em±y
(
$this
->
İtiÚs
['transform_dash'])) {

205 
$t™Ë
 = 
	`¡¹r
($title, '-', ' ');

208  
	`check_¶aš
(
$t™Ë
);

209 
	}
}

211 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

212  
$this
->
	`ÿ£_ŒªsfÜm
(
·»Á
::
	`summ¬y_Çme
(
$d©a
), 'case');

213 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field.inc

1 <?
php


21 şas 
	cv›ws_hªdËr_f›ld
 
ex‹nds
 
	mv›ws_hªdËr
 {

22 
v¬
 
	m$f›ld_®Ÿs
 = 'unknown';

23 
v¬
 
	m$®Ÿ£s
 = 
¬¿y
();

28 
funùiÚ
 
	$cÚ¡ruù
() {

29 
·»Á
::
	`cÚ¡ruù
();

31 
$this
->
add™iÚ®_f›lds
 = 
	`¬¿y
();

32 ià(!
	`em±y
(
$this
->
defš™iÚ
['additional fields'])) {

33 
$this
->
add™iÚ®_f›lds
 = $this->
defš™iÚ
['additional fields'];

36 ià(!
	`is£t
(
$this
->
İtiÚs
['exclude'])) {

37 
$this
->
İtiÚs
['exclude'] = '';

47 
funùiÚ
 
	$®low_advªûd_»nd”
() {

48  
TRUE
;

49 
	}
}

51 
funùiÚ
 
	$š™
(&
$v›w
, 
$İtiÚs
) {

52 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

54 
$this
->
İtiÚs
 +ğ
	`¬¿y
(

55 'exşude' => 
FALSE
,

57 
	}
}

62 
funùiÚ
 
	$qu”y
() {

63 
$this
->
	`’su»_my_bË
();

65 
$this
->
f›ld_®Ÿs
 = $this->
qu”y
->
	`add_f›ld
($this->
bË_®Ÿs
, $this->
»®_f›ld
);

67 
$this
->
	`add_add™iÚ®_f›lds
();

68 
	}
}

80 
funùiÚ
 
	$add_add™iÚ®_f›lds
(
$f›lds
 = 
NULL
) {

81 ià(!
	`is£t
(
$f›lds
)) {

83 ià(
	`em±y
(
$this
->
add™iÚ®_f›lds
)) {

86 
$f›lds
 = 
$this
->
add™iÚ®_f›lds
;

88 ià(!
	`em±y
(
$f›lds
è&& 
	`is_¬¿y
($fields)) {

89 
	`fÜ—ch
 (
$f›lds
 
as
 
$id’tif›r
 => 
$šfo
) {

90 ià(
	`is_¬¿y
(
$šfo
)) {

91 ià(
	`is£t
(
$šfo
['table'])) {

92 
$bË_®Ÿs
 = 
$this
->
qu”y
->
	`’su»_bË
(
$šfo
['bË'], $this->
»ÏtiÚsh
);

95 
$bË_®Ÿs
 = 
$this
->
bË_®Ÿs
;

97 ià(
	`em±y
(
$bË_®Ÿs
)) {

98 
	`v´
(
	`t
('HªdË¸@hªdË¸Œ›dØadd‡dd™iÚ®_f›ld @id’tif›¸buˆ@bË could‚Ù badded!', 
	`¬¿y
('@hªdËr' => 
$this
->
defš™iÚ
['hªdËr'], '@id’tif›r' => 
$id’tif›r
, '@bË' => 
$šfo
['table'])));

99 
$this
->
®Ÿ£s
[
$id’tif›r
] = 'broken';

102 
$this
->
®Ÿ£s
[
$id’tif›r
] = $this->
qu”y
->
	`add_f›ld
(
$bË_®Ÿs
, 
$šfo
['field']);

105 
$this
->
®Ÿ£s
[
$šfo
] = $this->
qu”y
->
	`add_f›ld
($this->
bË_®Ÿs
, $info);

109 
	}
}

114 
funùiÚ
 
	$şick_sÜt
(
$Üd”
) {

115 
$this
->
qu”y
->
	`add_Üd”by
($this->
bË
, $this->
f›ld
, 
$Üd”
, $this->
f›ld_®Ÿs
);

116 
	}
}

121 
funùiÚ
 
	$şick_sÜbË
() {

122  !
	`em±y
(
$this
->
defš™iÚ
['click sortable']);

123 
	}
}

128 
funùiÚ
 
	$Ïb–
() {

129 ià(!
	`is£t
(
$this
->
İtiÚs
['label'])) {

132  
$this
->
İtiÚs
['label'];

133 
	}
}

138 
funùiÚ
 
	$–em’t_ty³
() {

139 ià(
	`is£t
(
$this
->
defš™iÚ
['elementype'])) {

140  
$this
->
defš™iÚ
['elementype'];

144 
	}
}

146 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

147 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

149 
$İtiÚs
['Ïb–'] = 
	`¬¿y
('deçuÉ' => 
$this
->
defš™iÚ
['t™Ë'], 'Œª¦©abË' => 
TRUE
);

150 
$İtiÚs
['®‹r'] = 
	`¬¿y
(

151 'cÚšs' => 
	`¬¿y
(

152 '®‹r_‹xt' => 
	`¬¿y
('deçuÉ' => 
FALSE
),

153 '‹xt' => 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
),

154 'make_lšk' => 
	`¬¿y
('deçuÉ' => 
FALSE
),

155 '·th' => 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
),

156 '®t' => 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
),

157 'lšk_şass' => 
	`¬¿y
('default' => ''),

158 '´efix' => 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
),

159 'suffix' => 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
),

160 'rg‘' => 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
),

161 'Œim' => 
	`¬¿y
('deçuÉ' => 
FALSE
),

162 'max_Ëngth' => 
	`¬¿y
('default' => ''),

163 'wÜd_bound¬y' => 
	`¬¿y
('deçuÉ' => 
TRUE
),

164 '–lsis' => 
	`¬¿y
('deçuÉ' => 
TRUE
),

165 '¡r_gs' => 
	`¬¿y
('deçuÉ' => 
FALSE
),

166 'html' => 
	`¬¿y
('deçuÉ' => 
FALSE
),

169 
$İtiÚs
['em±y'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

170 
$İtiÚs
['hide_em±y'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

171 
$İtiÚs
['em±y_z”o'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

173  
$İtiÚs
;

174 
	}
}

180 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

181 
$fÜm
['Ïb–'] = 
	`¬¿y
(

183 '#t™Ë' => 
	`t
('Label'),

184 '#deçuÉ_v®ue' => 
	`is£t
(
$this
->
İtiÚs
['label']) ? $this->options['label'] : '',

185 '#desütiÚ' => 
	`t
('The†abel forhis fieldhat will be displayedoƒnd users ifhe style„equires it.'),

187 
$fÜm
['exşude'] = 
	`¬¿y
(

189 '#t™Ë' => 
	`t
('Exclude from display'),

190 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['exclude'],

191 '#desütiÚ' => 
	`t
('Checkhis boxo‚ot displayhis field, but still†oad it inhe view. Usehis optiono‚ot show‡ grouping field inƒach„ecord, or when doing‡dvancedheming.'),

194 ià(
$this
->
	`®low_advªûd_»nd”
()) {

195 
$fÜm
['®‹r']['#Œ“'] = 
TRUE
;

196 
$fÜm
['®‹r']['®‹r_‹xt'] = 
	`¬¿y
(

198 '#t™Ë' => 
	`t
('Rewritehe output ofhis field'),

199 '#desütiÚ' => 
	`t
('If checked, you can‡lterhe output ofhis field by specifying‡ string ofext with„eplacementokenshat can use‡nyƒxisting field output.'),

200 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['alter_text'],

203 
$fÜm
['®‹r']['‹xt'] = 
	`¬¿y
(

204 '#t™Ë' => 
	`t
('Text'),

206 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['text'],

207 '#desütiÚ' => 
	`t
('Theexto display forhis field. You may include HTML. You mayƒnter data fromhis view‡s…erhe "Replacement…atterns" below.'),

208 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

209 '#d•’d’cy' => 
	`¬¿y
(

210 'ed™-İtiÚs-®‹r-®‹r-‹xt' => 
	`¬¿y
(1)

214 
$fÜm
['®‹r']['make_lšk'] = 
	`¬¿y
(

216 '#t™Ë' => 
	`t
('Outputhis field‡s‡†ink'),

217 '#desütiÚ' => 
	`t
('If checked,his field will be made into‡†ink. The destination must be given below.'),

218 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['make_link'],

220 
$fÜm
['®‹r']['·th'] = 
	`¬¿y
(

221 '#t™Ë' => 
	`t
('Link…ath'),

223 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['path'],

224 '#desütiÚ' => 
	`t
('The Drupal…ath or‡bsolute URL forhis†ink. You mayƒnter data fromhis view‡s…erhe "Replacement…atterns" below.'),

225 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

226 '#d•’d’cy' => 
	`¬¿y
(

227 'ed™-İtiÚs-®‹r-make-lšk' => 
	`¬¿y
(1)

231 
$fÜm
['®‹r']['lšk_şass'] = 
	`¬¿y
(

232 '#t™Ë' => 
	`t
('Link class'),

234 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['link_class'],

235 '#desütiÚ' => 
	`t
('The CSS classo‡pplyohe†ink.'),

236 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

237 '#d•’d’cy' => 
	`¬¿y
(

238 'ed™-İtiÚs-®‹r-make-lšk' => 
	`¬¿y
(1)

241 
$fÜm
['®‹r']['®t'] = 
	`¬¿y
(

242 '#t™Ë' => 
	`t
('Altext'),

244 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['alt'],

245 '#desütiÚ' => 
	`t
('Texto…lace‡s "alt"ext which most browsers display‡s‡ooltip when hovering overhe†ink.'),

246 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

247 '#d•’d’cy' => 
	`¬¿y
(

248 'ed™-İtiÚs-®‹r-make-lšk' => 
	`¬¿y
(1)

251 
$fÜm
['®‹r']['´efix'] = 
	`¬¿y
(

252 '#t™Ë' => 
	`t
('Prefixext'),

254 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['prefix'],

255 '#desütiÚ' => 
	`t
('Anyexto display beforehis†ink. You may include HTML.'),

256 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

257 '#d•’d’cy' => 
	`¬¿y
(

258 'ed™-İtiÚs-®‹r-make-lšk' => 
	`¬¿y
(1)

261 
$fÜm
['®‹r']['suffix'] = 
	`¬¿y
(

262 '#t™Ë' => 
	`t
('Suffixext'),

264 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['suffix'],

265 '#desütiÚ' => 
	`t
('Anyexto display‡fterhis†ink. You may include HTML.'),

266 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

267 '#d•’d’cy' => 
	`¬¿y
(

268 'ed™-İtiÚs-®‹r-make-lšk' => 
	`¬¿y
(1)

271 
$fÜm
['®‹r']['rg‘'] = 
	`¬¿y
(

272 '#t™Ë' => 
	`t
('Target'),

274 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['target'],

275 '#desütiÚ' => 
	`t
("Target ofhe†ink, such‡s _blank, _parent or‡n iframe's‚ame. This field is„arely used."),

276 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

277 '#d•’d’cy' => 
	`¬¿y
(

278 'ed™-İtiÚs-®‹r-make-lšk' => 
	`¬¿y
(1)

284 
$İtiÚs
 = 
	`¬¿y
();

285 
	`fÜ—ch
 (
$this
->
v›w
->
di¥Ïy_hªdËr
->
	`g‘_hªdËrs
('f›ld'è
as
 
$f›ld
 => 
$hªdËr
) {

286 
$İtiÚs
[
	`t
('F›lds')]["[$f›ld]"] = 
$hªdËr
->
	`ui_Çme
();

288 ià(
$f›ld
 =ğ
$this
->
İtiÚs
['id']) {

292 
$couÁ
 = 0;

293 
	`fÜ—ch
 (
$this
->
v›w
->
di¥Ïy_hªdËr
->
	`g‘_hªdËrs
('¬gum’t'è
as
 
$¬g
 => 
$hªdËr
) {

294 
$İtiÚs
[
	`t
('Argum’ts')]['%' . ++
$couÁ
] =('@¬gum’ˆt™Ë', 
	`¬¿y
('@¬gum’t' => 
$hªdËr
->
	`ui_Çme
()));

295 
$İtiÚs
[
	`t
('Argum’ts')]['!' . 
$couÁ
] =('@¬gum’ˆšput', 
	`¬¿y
('@¬gum’t' => 
$hªdËr
->
	`ui_Çme
()));

298 
$this
->
	`docum’t_£lf_tok’s
(
$İtiÚs
[
	`t
('Fields')]);

301 
$ouut
 = 
	`t
('<p>You must‡dd some‡dditional fieldsohis display before usinghis field. These fields may be marked‡s <em>Exclude from display</em> if you…refer. Notehat dueo„endering order, you cannot use fieldshat come‡fterhis field; if you‚eed‡ field‚ot†isted here,„earrange your fields.</p>');

303 ià(!
	`em±y
(
$İtiÚs
)) {

304 
$ouut
 = 
	`t
('<p>The following substitution…atterns‡re‡vailable forhis display. Usehe…attern shown onhe†efto displayhe value indicated onhe„ight. Notehat dueo„endering order, you cannot use fieldshat come‡fterhis field; if you‚eed‡ field‚ot†isted here,„earrange your fields.</p>');

305 
	`fÜ—ch
 (
	`¬¿y_keys
(
$İtiÚs
è
as
 
$ty³
) {

306 ià(!
	`em±y
(
$İtiÚs
[
$ty³
])) {

307 
$™ems
 = 
	`¬¿y
();

308 
	`fÜ—ch
 (
$İtiÚs
[
$ty³
] 
as
 
$key
 => 
$v®ue
) {

309 
$™ems
[] = 
$key
 . ' =ğ' . 
$v®ue
;

311 
$ouut
 .ğ
	`theme
('™em_li¡', 
$™ems
, 
$ty³
);

319 
$fÜm
['®‹r']['h–p'] = 
	`¬¿y
(

322 '#´efix' => '<div><f›ld£ˆid="v›ws-tok’s-h–p"><Ëg’d>' . 
	`t
('R•Ïûm’ˆ·‰”ns'è. '</Ëg’d>' . 
$ouut
 . '</fieldset></div>',

323 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

324 '#d•’d’cy' => 
	`¬¿y
(

325 'ed™-İtiÚs-®‹r-make-lšk' => 
	`¬¿y
(1),

326 'ed™-İtiÚs-®‹r-®‹r-‹xt' => 
	`¬¿y
(1),

330 
$fÜm
['®‹r']['Œim'] = 
	`¬¿y
(

332 '#t™Ë' => 
	`t
('Trimhis fieldo‡ maximum†ength'),

333 '#desütiÚ' => 
	`t
('If checked,his field berimmedo‡ maximum†ength in characters.'),

334 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['trim'],

337 
$fÜm
['®‹r']['max_Ëngth'] = 
	`¬¿y
(

338 '#t™Ë' => 
	`t
('Maximum†ength'),

340 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['max_length'],

341 '#desütiÚ' => 
	`t
('The maximum‚umber of charactershis field can be.'),

342 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

343 '#d•’d’cy' => 
	`¬¿y
(

344 'ed™-İtiÚs-®‹r-Œim' => 
	`¬¿y
(1)

348 
$fÜm
['®‹r']['wÜd_bound¬y'] = 
	`¬¿y
(

350 '#t™Ë' => 
	`t
('Trim only on‡ word boundary'),

351 '#desütiÚ' => 
	`t
('If checked,his field berimmed only on‡ word boundary. This is guaranteedo behe maximum characters stated or†ess. Ifhere‡re‚o word boundarieshis couldrim‡ fieldo‚othing.'),

352 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['word_boundary'],

353 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

354 '#d•’d’cy' => 
	`¬¿y
(

355 'ed™-İtiÚs-®‹r-Œim' => 
	`¬¿y
(1)

359 
$fÜm
['®‹r']['–lsis'] = 
	`¬¿y
(

361 '#t™Ë' => 
	`t
('Add‡nƒllipsis'),

362 '#desütiÚ' => 
	`t
('If checked,‡ "..." will be‡dded if‡ field wasrimmed.'),

363 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['ellipsis'],

364 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

365 '#d•’d’cy' => 
	`¬¿y
(

366 'ed™-İtiÚs-®‹r-Œim' => 
	`¬¿y
(1)

370 
$fÜm
['®‹r']['html'] = 
	`¬¿y
(

372 '#t™Ë' => 
	`t
('Field can contain HTML'),

373 '#desütiÚ' => 
	`t
('If checked, HTML corrector will be„unoƒnsureags‡re…roperly closed‡fterrimming.'),

374 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['html'],

375 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

376 '#d•’d’cy' => 
	`¬¿y
(

377 'ed™-İtiÚs-®‹r-Œim' => 
	`¬¿y
(1)

381 
$fÜm
['®‹r']['¡r_gs'] = 
	`¬¿y
(

383 '#t™Ë' => 
	`t
('Strip HTMLags'),

384 '#desütiÚ' => 
	`t
('If checked,‡ll HTMLags will be stripped.'),

385 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alter']['strip_tags'],

386 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

390 
$fÜm
['em±y'] = 
	`¬¿y
(

392 '#t™Ë' => 
	`t
('Emptyext'),

393 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['empty'],

394 '#desütiÚ' => 
	`t
('Ifhe field isƒmpty, displayhisext instead.'),

397 
$fÜm
['em±y_z”o'] = 
	`¬¿y
(

399 '#t™Ë' => 
	`t
('Counthe‚umber 0‡sƒmpty'),

400 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['empty_zero'],

401 '#desütiÚ' => 
	`t
('Ifhe field containshe‚umber zero, displayheƒmptyext instead'),

404 
$fÜm
['hide_em±y'] = 
	`¬¿y
(

406 '#t™Ë' => 
	`t
('Hide ifƒmpty'),

407 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['hide_empty'],

408 '#desütiÚ' => 
	`t
('Do‚ot display‡nything forhis field if it isƒmpty. Notehathe field†abel may still be displayed. Check style or„ow style settingso hide†abels forƒmpty fields.'),

410 
	}
}

415 
funùiÚ
 
	$admš_summ¬y
() {

416  
$this
->
	`Ïb–
();

417 
	}
}

428 
funùiÚ
 
	$´e_»nd”
(
$v®ues
è{ 
	}
}

436 
funùiÚ
 
	$»nd”
(
$v®ues
) {

437 
$v®ue
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

438  
	`check_¶aš
(
$v®ue
);

439 
	}
}

447 
funùiÚ
 
	$advªûd_»nd”
(
$v®ues
) {

448 ià(
$this
->
	`®low_advªûd_»nd”
(è&& 
	`m‘hod_exi¡s
($this, 'render_item')) {

449 
$¿w_™ems
 = 
$this
->
	`g‘_™ems
(
$v®ues
);

452 
$this
->
Ï¡_»nd”
 = 
$v®ue
 = $this->
	`»nd”
(
$v®ues
);

453 
$this
->
Üigš®_v®ue
 = 
$v®ue
;

456 ià(
$this
->
	`®low_advªûd_»nd”
()) {

457 
$tok’s
 = 
NULL
;

458 ià(
	`m‘hod_exi¡s
(
$this
, 'render_item')) {

459 
$™ems
 = 
	`¬¿y
();

460 
	`fÜ—ch
 (
$¿w_™ems
 
as
 
$couÁ
 => 
$™em
) {

461 
$this
->
Ï¡_»nd”
 = $this->
	`»nd”_™em
(
$couÁ
, 
$™em
);

462 
$this
->
Üigš®_v®ue
 = $this->
Ï¡_»nd”
;

464 
$®‹r
 = 
$™em
 + 
$this
->
İtiÚs
['alter'];

465 
$™ems
[] = 
$this
->
	`»nd”_‹xt
(
$®‹r
);

468 
$v®ue
 = 
$this
->
	`»nd”_™ems
(
$™ems
);

471 
$v®ue
 = 
$this
->
	`»nd”_‹xt
($this->
İtiÚs
['alter']);

476 
$this
->
Ï¡_»nd”
 = 
$v®ue
;

479 ià(
	`em±y
(
$this
->
Ï¡_»nd”
)) {

480 ià((
$this
->
Ï¡_»nd”
 !=ğ0 && $this->Ï¡_»nd” !=ğ'0'è|| !
	`em±y
($this->
İtiÚs
['empty_zero'])) {

481 
$this
->
Ï¡_»nd”
 = $this->
İtiÚs
['empty'];

485  
$this
->
Ï¡_»nd”
;

486 
	}
}

494 
funùiÚ
 
	$»nd”_‹xt
(
$®‹r
) {

495 
$v®ue
 = 
	`Œim
(
$this
->
Ï¡_»nd”
);

496 ià(
$this
->
İtiÚs
['hide_em±y'] && 
	`em±y
(
$v®ue
) && ($value !== 0 || $this->options['empty_zero'])) {

500 ià(!
	`em±y
(
$®‹r
['alter_text']) && $alter['text'] !== '') {

501 
$tok’s
 = 
$this
->
	`g‘_»nd”_tok’s
(
$®‹r
);

502 
$v®ue
 = 
$this
->
	`»nd”_®‹»d
(
$®‹r
, 
$tok’s
);

505 ià(!
	`em±y
(
$®‹r
['strip_tags'])) {

506 
$v®ue
 = 
	`¡r_gs
($value);

509 ià(!
	`em±y
(
$®‹r
['trim']) && !empty($alter['max_length'])) {

510 
$v®ue
 = 
$this
->
	`»nd”_Œim_‹xt
(
$®‹r
, $value);

513 ià(!
	`em±y
(
$®‹r
['make_link']) && !empty($alter['path'])) {

514 ià(!
	`is£t
(
$tok’s
)) {

515 
$tok’s
 = 
$this
->
	`g‘_»nd”_tok’s
(
$®‹r
);

517 
$v®ue
 = 
$this
->
	`»nd”_as_lšk
(
$®‹r
, $v®ue, 
$tok’s
);

520  
$v®ue
;

521 
	}
}

526 
funùiÚ
 
	$»nd”_®‹»d
(
$®‹r
, 
$tok’s
) {

528 
$v®ue
 = 
	`f‹r_xss_admš
(
$®‹r
['text']);

529 
$v®ue
 = 
	`¡¹r
($v®ue, 
$tok’s
);

531  
$v®ue
;

532 
	}
}

537 
funùiÚ
 
	$»nd”_Œim_‹xt
(
$®‹r
, 
$v®ue
) {

538 ià(!
	`em±y
(
$®‹r
['strip_tags'])) {

542 
$this
->
defš™iÚ
['elementype'] = 'span';

544  
	`v›ws_Œim_‹xt
(
$®‹r
, 
$v®ue
);

545 
	}
}

551 
funùiÚ
 
	$»nd”_as_lšk
(
$®‹r
, 
$‹xt
, 
$tok’s
) {

552 
$v®ue
 = '';

554 ià(!
	`em±y
(
$®‹r
['prefix'])) {

555 
$v®ue
 .ğ
	`f‹r_xss_admš
(
	`¡¹r
(
$®‹r
['´efix'], 
$tok’s
));

558 
$İtiÚs
 = 
	`¬¿y
(

564 
$·th
 = 
$®‹r
['path'];

567 ià(
$·th
 != '<front>') {

571 
$·th
 = 
	`¡r_gs
(
	`html_’t™y_decode
(
	`¡¹r
($·th, 
$tok’s
)));

576 ià(
	`em±y
(
$·th
)) {

577  
$‹xt
;

581 
$u¾
 = 
	`·r£_u¾
(
$·th
);

582 ià(
	`is£t
(
$u¾
['query'])) {

583 
$·th
 = 
	`¡¹r
($·th, 
	`¬¿y
('?' . 
$u¾
['query'] => ''));

584 
$İtiÚs
['qu”y'] = 
$u¾
['query'];

586 ià(
	`is£t
(
$u¾
['fragment'])) {

587 
$·th
 = 
	`¡¹r
($·th, 
	`¬¿y
('#' . 
$u¾
['fragment'] => ''));

588 
$İtiÚs
['äagm’t'] = 
$u¾
['fragment'];

591 
$®t
 = 
	`¡¹r
(
$®‹r
['®t'], 
$tok’s
);

593 ià(
$®t
 && $®ˆ!ğ
$‹xt
) {

594 
$İtiÚs
['©Œibu‹s']['t™Ë'] = 
$®t
;

597 
$şass
 = 
	`¡¹r
(
$®‹r
['lšk_şass'], 
$tok’s
);

598 ià(
$şass
) {

599 
$İtiÚs
['©Œibu‹s']['şass'] = 
$şass
;

602 
$rg‘
 = 
	`check_¶aš
(
	`Œim
(
	`¡¹r
(
$®‹r
['rg‘'],
$tok’s
)));

603 ià(!
	`em±y
(
$rg‘
)) {

604 
$İtiÚs
['©Œibu‹s']['rg‘'] = 
$rg‘
;

609 ià(
	`is£t
(
$®‹r
['query'])) {

610 
$İtiÚs
['qu”y'] = 
	`¡¹r
(
$®‹r
['qu”y'], 
$tok’s
);

612 ià(
	`is£t
(
$®‹r
['alias'])) {

614 
$İtiÚs
['®Ÿs'] = 
$®‹r
['alias'];

616 ià(
	`is£t
(
$®‹r
['fragment'])) {

617 
$İtiÚs
['äagm’t'] = 
	`¡¹r
(
$®‹r
['äagm’t'], 
$tok’s
);

619 ià(
	`is£t
(
$this
->
İtiÚs
['alter']['language'])) {

620 
$İtiÚs
['Ïnguage'] = 
$this
->
İtiÚs
['alter']['language'];

623 
$v®ue
 .ğ
	`l
(
$‹xt
, 
$·th
, 
$İtiÚs
);

625 ià(!
	`em±y
(
$®‹r
['suffix'])) {

626 
$v®ue
 .ğ
	`f‹r_xss_admš
(
	`¡¹r
(
$®‹r
['suffix'], 
$tok’s
));

629  
$v®ue
;

630 
	}
}

639 
funùiÚ
 
	$g‘_»nd”_tok’s
(
$™em
) {

640 
$tok’s
 = 
	`¬¿y
();

641 ià(!
	`em±y
(
$this
->
v›w
->
bud_šfo
['substitutions'])) {

642 
$tok’s
 = 
$this
->
v›w
->
bud_šfo
['substitutions'];

644 
$couÁ
 = 0;

645 
	`fÜ—ch
 (
$this
->
v›w
->
di¥Ïy_hªdËr
->
	`g‘_hªdËrs
('¬gum’t'è
as
 
$¬g
 => 
$hªdËr
) {

646 
$tok’
 = '%' . ++
$couÁ
;

647 ià(!
	`is£t
(
$tok’s
[
$tok’
])) {

648 
$tok’s
[
$tok’
] = '';

651 
$tok’s
['!' . 
$couÁ
] = 
	`is£t
(
$this
->
v›w
->
¬gs
[$couÁ - 1]è? 
	`check_¶aš
($this->view->args[$count - 1]) : '';

655 
	`fÜ—ch
 (
$this
->
v›w
->
di¥Ïy_hªdËr
->
	`g‘_hªdËrs
('f›ld'è
as
 
$f›ld
 => 
$hªdËr
) {

656 ià(
	`is£t
(
$hªdËr
->
Ï¡_»nd”
)) {

657 
$tok’s
["[$f›ld]"] = 
$hªdËr
->
Ï¡_»nd”
;

660 
$tok’s
["[$field]"] = '';

662 
$this
->
	`add_£lf_tok’s
(
$tok’s
, 
$™em
);

665 ià(
$f›ld
 =ğ
$this
->
İtiÚs
['id']) {

670  
$tok’s
;

671 
	}
}

684 
funùiÚ
 
	$add_£lf_tok’s
(&
$tok’s
, 
$™em
è{ 
	}
}

691 
funùiÚ
 
	$docum’t_£lf_tok’s
(&
$tok’s
è{ 
	}
}

697 
funùiÚ
 
	$theme
(
$v®ues
) {

698  
	`theme
(
$this
->
	`theme_funùiÚs
(), $this->
v›w
, $this, 
$v®ues
);

699 
	}
}

701 
funùiÚ
 
	$theme_funùiÚs
() {

702 
$themes
 = 
	`¬¿y
();

703 
$hook
 = 'views_view_field';

705 
$di¥Ïy
 = 
$this
->
v›w
->
di¥Ïy
[$this->v›w->
cu¼’t_di¥Ïy
];

707 ià(!
	`em±y
(
$di¥Ïy
)) {

708 
$themes
[] = 
$hook
 . '__' . 
$this
->
v›w
->
Çme
 . '__' . 
$di¥Ïy
->
id
 . '__' . $this->
İtiÚs
['id'];

709 
$themes
[] = 
$hook
 . '__' . 
$this
->
v›w
->
Çme
 . '__' . 
$di¥Ïy
->
id
;

710 
$themes
[] = 
$hook
 . '__' . 
$di¥Ïy
->
id
 . '__' . 
$this
->
İtiÚs
['id'];

711 
$themes
[] = 
$hook
 . '__' . 
$di¥Ïy
->
id
;

712 ià(
$di¥Ïy
->
id
 !ğ$di¥Ïy->
di¥Ïy_¶ugš
) {

713 
$themes
[] = 
$hook
 . '__' . 
$this
->
v›w
->
Çme
 . '__' . 
$di¥Ïy
->
di¥Ïy_¶ugš
 . '__' . $this->
İtiÚs
['id'];

714 
$themes
[] = 
$hook
 . '__' . 
$this
->
v›w
->
Çme
 . '__' . 
$di¥Ïy
->
di¥Ïy_¶ugš
;

715 
$themes
[] = 
$hook
 . '__' . 
$di¥Ïy
->
di¥Ïy_¶ugš
 . '__' . 
$this
->
İtiÚs
['id'];

716 
$themes
[] = 
$hook
 . '__' . 
$di¥Ïy
->
di¥Ïy_¶ugš
;

719 
$themes
[] = 
$hook
 . '__' . 
$this
->
v›w
->
Çme
 . '__' . $this->
İtiÚs
['id'];

720 
$themes
[] = 
$hook
 . '__' . 
$this
->
v›w
->
Çme
;

721 
$themes
[] = 
$hook
 . '__' . 
$this
->
İtiÚs
['id'];

722 
$themes
[] = 
$hook
;

724  
$themes
;

725 
	}
}

731 şas 
	cv›ws_hªdËr_f›ld_brok’
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

732 
funùiÚ
 
	$ui_Çme
(
$shÜt
 = 
FALSE
) {

733  
	`t
('Broken/missing handler');

736 
funùiÚ
 
	$’su»_my_bË
(è{ 
	}
}

737 
funùiÚ
 
	$qu”y
(è{ 
	}
}

738 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

739 
$fÜm
['m¬kup'] = 
	`¬¿y
(

741 '#v®ue' => 
	`t
('The handler forhis item is broken or missing‡nd cannot be used. If‡ module…rovidedhe handler‡nd was disabled,„e-enablinghe module may„estore it. Otherwise, you should…robably deletehis item.'),

743 
	}
}

748 
funùiÚ
 
	$brok’
(è{  
TRUE
; 
	}
}

754 şas 
	cv›ws_hªdËr_f›ld_fe_size
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

755 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

756 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

758 
$İtiÚs
['fe_size_di¥Ïy'] = 
	`¬¿y
('default' => 'formatted');

760  
$İtiÚs
;

763 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

764 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

765 
$fÜm
['fe_size_di¥Ïy'] = 
	`¬¿y
(

766 '#t™Ë' => 
	`t
('File size display'),

768 '#İtiÚs' => 
	`¬¿y
(

769 'fÜm©‹d' => 
	`t
('Formatted (in KB or MB)'),

770 'by‹s' => 
	`t
('Raw bytes'),

773 
	}
}

775 
funùiÚ
 
	$»nd”
(
$v®ues
) {

776 ià(
$v®ues
->{
$this
->
f›ld_®Ÿs
}) {

777 
$this
->
İtiÚs
['file_size_display']) {

779  
$v®ues
->{
$this
->
f›ld_®Ÿs
};

782  
	`fÜm©_size
(
$v®ues
->{
$this
->
f›ld_®Ÿs
});

788 
	}
}

794 şas 
	cv›ws_hªdËr_f›ld_xss
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

795 
funùiÚ
 
	$»nd”
(
$v®ues
) {

796 
$v®ue
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

797  
	`f‹r_xss
(
$v®ue
);

799 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_boolean.inc

1 <?
php


20 şas 
	cv›ws_hªdËr_f›ld_boŞ—n
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

21 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

22 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

23 
$İtiÚs
['ty³'] = 
	`¬¿y
('default' => 'yes-no');

24 
$İtiÚs
['nÙ'] = 
	`¬¿y
('definition bool' => 'reverse');

26  
$İtiÚs
;

29 
funùiÚ
 
	$š™
(&
$v›w
, 
$İtiÚs
) {

30 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

32 
$deçuÉ_fÜm©s
 = 
	`¬¿y
(

33 'yes-no' => 
	`¬¿y
(
	`t
('Yes'),('No')),

34 'Œue-çl£' => 
	`¬¿y
(
	`t
('True'),('False')),

35 'Ú-off' => 
	`¬¿y
(
	`t
('On'),('Off')),

37 
$ouut_fÜm©s
 = 
	`is£t
(
$this
->
defš™iÚ
['ouuˆfÜm©s']è? $this->defš™iÚ['ouuˆfÜm©s'] : 
	`¬¿y
();

38 
$this
->
fÜm©s
 = 
	`¬¿y_m”ge
(
$deçuÉ_fÜm©s
, 
$ouut_fÜm©s
);

39 
	}
}

41 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

42 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

43 
	`fÜ—ch
 (
$this
->
fÜm©s
 
as
 
$key
 => 
$™em
) {

44 
$İtiÚs
[
$key
] = 
	`im¶ode
('/', 
$™em
);

47 
$fÜm
['ty³'] = 
	`¬¿y
(

49 '#t™Ë' => 
	`t
('Output format'),

50 '#İtiÚs' => 
$İtiÚs
,

51 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['type'],

53 
$fÜm
['nÙ'] = 
	`¬¿y
(

55 '#t™Ë' => 
	`t
('Reverse'),

56 '#desütiÚ' => 
	`t
('If checked,rue will be displayed‡s false.'),

57 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['not'],

59 
	}
}

61 
funùiÚ
 
	$»nd”
(
$v®ues
) {

62 
$v®ue
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

63 ià(!
	`em±y
(
$this
->
İtiÚs
['not'])) {

64 
$v®ue
 = !$value;

67 ià(
	`is£t
(
$this
->
fÜm©s
[$this->
İtiÚs
['type']])) {

68  
$v®ue
 ? 
$this
->
fÜm©s
[$this->
İtiÚs
['type']][0] : $this->formats[$this->options['type']][1];

71  
$v®ue
 ? 
$this
->
fÜm©s
['yes-no'][0] : $this->formats['yes-no'][1];

73 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_counter.inc

1 <?
php


4 şas 
	cv›ws_hªdËr_f›ld_couÁ”
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

5 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

6 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

7 
$İtiÚs
['couÁ”_¡¬t'] = 
	`¬¿y
('default' => 1);

8  
$İtiÚs
;

11 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

12 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

14 
$fÜm
['couÁ”_¡¬t'] = 
	`¬¿y
(

16 '#t™Ë' => 
	`t
('Starting value'),

17 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['counter_start'],

18 '#desütiÚ' => 
	`t
('Specifyhe‚umberhe counter should start‡t.'),

22 
	}
}

24 
funùiÚ
 
	$qu”y
() {

26 
	}
}

28 
funùiÚ
 
	$»nd”
(
$v®ues
) {

31 
$couÁ
 = 
	`is_num”ic
(
$this
->
İtiÚs
['counter_start']) ? $this->options['counter_start'] - 1 : 0;

32 
$·g”
 = 
$this
->
v›w
->
·g”
;

34 ià(
$·g”
['use_pager']) {

35 
$couÁ
 +ğ(
$·g”
['items_per_page'] * $pager['current_page']) + $pager['offset'];

38 
$couÁ
 +ğ
$this
->
v›w
->
row_šdex
 + 1;

40  
$couÁ
;

41 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_custom.inc

1 <?
php


9 şas 
	cv›ws_hªdËr_f›ld_cu¡om
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

10 
funùiÚ
 
	$qu”y
() {

14 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

15 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

18 
$İtiÚs
['®‹r']['cÚšs']['®‹r_‹xt'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

19  
$İtiÚs
;

20 
	}
}

22 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

23 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

26 
	`un£t
(
$fÜm
['alter']['alter_text']);

27 
	`un£t
(
$fÜm
['alter']['text']['#dependency']);

28 
	`un£t
(
$fÜm
['alter']['text']['#process']);

29 
	}
}

31 
funùiÚ
 
	$»nd”
(
$v®ues
) {

34 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_date.inc

1 <?
php


8 şas 
	cv›ws_hªdËr_f›ld_d©e
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

9 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

10 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

12 
$İtiÚs
['d©e_fÜm©'] = 
	`¬¿y
('default' => 'small');

13 
$İtiÚs
['cu¡om_d©e_fÜm©'] = 
	`¬¿y
('default' => '');

15  
$İtiÚs
;

18 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

19 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

20 
$time
 = 
	`time
();

22 
$fÜm
['d©e_fÜm©'] = 
	`¬¿y
(

24 '#t™Ë' => 
	`t
('Date format'),

25 '#İtiÚs' => 
	`¬¿y
(

26 'sm®l' => 
	`fÜm©_d©e
(
$time
, 'small'),

27 'medium' => 
	`fÜm©_d©e
(
$time
, 'medium'),

28 'Ïrge' => 
	`fÜm©_d©e
(
$time
, 'large'),

29 'cu¡om' => 
	`t
('Custom'),

30 '¿wimago' => 
	`t
('Time‡go'),

31 'timago' => 
	`t
('Time‡go (with "ago"‡ppended)'),

32 '¿wim¥ª' => 
	`t
('Time span (future dates start with - )'),

33 'tim¥ª' => 
	`t
('Time span (with "ago/hence"‡ppended)'),

35 '#deçuÉ_v®ue' => 
	`is£t
(
$this
->
İtiÚs
['date_format']) ? $this->options['date_format'] : 'small',

37 
$fÜm
['cu¡om_d©e_fÜm©'] = 
	`¬¿y
(

39 '#t™Ë' => 
	`t
('Custom date format'),

40 '#desütiÚ' => 
	`t
('If "Custom", see <a href="http://us.php.net/manual/en/function.date.php"arget="_blank">the PHP docs</a> for date formats. If "Time‡go"his ishehe‚umber of different unitso display, which defaultsowo.'),

41 '#deçuÉ_v®ue' => 
	`is£t
(
$this
->
İtiÚs
['custom_date_format']) ? $this->options['custom_date_format'] : '',

42 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

43 '#d•’d’cy' => 
	`¬¿y
('edit-options-date-format' =>‡rray('custom', 'rawime‡go', 'time‡go', 'rawime span', 'time span')),

45 
	}
}

47 
funùiÚ
 
	$»nd”
(
$v®ues
) {

48 
$v®ue
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

49 
$fÜm©
 = 
$this
->
İtiÚs
['date_format'];

50 ià(
	`š_¬¿y
(
$fÜm©
, 
	`¬¿y
('custom', 'rawime‡go', 'time‡go', 'rawime span', 'time span'))) {

51 
$cu¡om_fÜm©
 = 
$this
->
İtiÚs
['custom_date_format'];

54 ià(!
$v®ue
) {

55  
	`theme
('views_nodate');

58 
$time_diff
 = 
	`time
(è- 
$v®ue
;

59 
$fÜm©
) {

61  
	`fÜm©_š‹rv®
(
$time_diff
, 
	`is_num”ic
(
$cu¡om_fÜm©
) ? $custom_format : 2);

63  
	`t
('%timago', 
	`¬¿y
('%time' => 
	`fÜm©_š‹rv®
(
$time_diff
, 
	`is_num”ic
(
$cu¡om_fÜm©
) ? $custom_format : 2)));

65  (
$time_diff
 < 0 ? '-' : ''è. 
	`fÜm©_š‹rv®
(
	`abs
($time_diff), 
	`is_num”ic
(
$cu¡om_fÜm©
) ? $custom_format : 2);

67  
	`t
((
$time_diff
 < 0 ? '%timh’û' : '%timago'), 
	`¬¿y
('%time' => 
	`fÜm©_š‹rv®
(
	`abs
($time_diff), 
	`is_num”ic
(
$cu¡om_fÜm©
) ? $custom_format : 2)));

69  
	`fÜm©_d©e
(
$v®ue
, 
$fÜm©
, 
$cu¡om_fÜm©
);

71  
	`fÜm©_d©e
(
$v®ue
, 
$fÜm©
);

74 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_markup.inc

1 <?
php


14 şas 
	cv›ws_hªdËr_f›ld_m¬kup
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

18 
funùiÚ
 
	$cÚ¡ruù
() {

19 
·»Á
::
	`cÚ¡ruù
();

21 
$this
->
fÜm©
 = $this->
defš™iÚ
['format'];

23 
$this
->
add™iÚ®_f›lds
 = 
	`¬¿y
();

24 ià(!
	`is_num”ic
(
$this
->
fÜm©
)) {

25 
$this
->
add™iÚ®_f›lds
['fÜm©'] = 
	`¬¿y
('f›ld' => $this->
fÜm©
);

29 
funùiÚ
 
	$»nd”
(
$v®ues
) {

30 
$v®ue
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

31 
$fÜm©
 = 
	`is_num”ic
(
$this
->
fÜm©
è? $this->fÜm© : 
$v®ues
->{$this->
®Ÿ£s
['format']};

32 ià(
$v®ue
) {

33  
	`check_m¬kup
(
$v®ue
, 
$fÜm©
, 
FALSE
);

35 
	}
}

37 
funùiÚ
 
	$–em’t_ty³
() {

38 ià(
	`is£t
(
$this
->
defš™iÚ
['elementype'])) {

39  
$this
->
defš™iÚ
['elementype'];

43 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_numeric.inc

1 <?
php


12 şas 
	cv›ws_hªdËr_f›ld_num”ic
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

13 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

14 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

16 
$İtiÚs
['£t_´ecisiÚ'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

17 
$İtiÚs
['´ecisiÚ'] = 
	`¬¿y
('default' => 0);

18 
$İtiÚs
['decim®'] = 
	`¬¿y
('deçuÉ' => '.', 'Œª¦©abË' => 
TRUE
);

19 
$İtiÚs
['£·¿tÜ'] = 
	`¬¿y
('deçuÉ' => ',', 'Œª¦©abË' => 
TRUE
);

20 
$İtiÚs
['´efix'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

21 
$İtiÚs
['suffix'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

23  
$İtiÚs
;

26 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

27 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

29 ià(!
	`em±y
(
$this
->
defš™iÚ
['float'])) {

30 
$fÜm
['£t_´ecisiÚ'] = 
	`¬¿y
(

32 '#t™Ë' => 
	`t
('Round'),

33 '#desütiÚ' => 
	`t
('If checked,he‚umber will be„ounded.'),

34 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['set_precision'],

36 
$fÜm
['´ecisiÚ'] = 
	`¬¿y
(

38 '#t™Ë' => 
	`t
('Precision'),

39 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['precision'],

40 '#desütiÚ' => 
	`t
('Specify how many digitso…rint‡fterhe decimal…oint.'),

41 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

42 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-£t-´ecisiÚ' =>‡¼ay(
TRUE
)),

45 
$fÜm
['decim®'] = 
	`¬¿y
(

47 '#t™Ë' => 
	`t
('Decimal…oint'),

48 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['decimal'],

49 '#desütiÚ' => 
	`t
('What single charactero use‡s‡ decimal…oint.'),

53 
$fÜm
['£·¿tÜ'] = 
	`¬¿y
(

55 '#t™Ë' => 
	`t
('Thousands separator'),

56 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['separator'],

57 '#desütiÚ' => 
	`t
('What single charactero use‡shehousands separator.'),

60 
$fÜm
['´efix'] = 
	`¬¿y
(

62 '#t™Ë' => 
	`t
('Prefix'),

63 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['prefix'],

64 '#desütiÚ' => 
	`t
('Texto…ut beforehe‚umber, such‡s currency symbol.'),

66 
$fÜm
['suffix'] = 
	`¬¿y
(

68 '#t™Ë' => 
	`t
('Suffix'),

69 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['suffix'],

70 '#desütiÚ' => 
	`t
('Texto…ut‡fterhe‚umber, such‡s currency symbol.'),

72 
	}
}

74 
funùiÚ
 
	$»nd”
(
$v®ues
) {

75 
$v®ue
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

76 ià(!
	`em±y
(
$this
->
İtiÚs
['set_precision'])) {

77 
$v®ue
 = 
	`numb”_fÜm©
($v®ue, 
$this
->
İtiÚs
['precision'], $this->options['decimal'], $this->options['separator']);

80 
$»mašd”
 = 
	`abs
(
$v®ue
è- 
	`štv®
(abs($value));

81 
$v®ue
 = $v®u> 0 ? 
	`æoÜ
($v®ueè: 
	`û
($value);

82 
$v®ue
 = 
	`numb”_fÜm©
($v®ue, 0, '', 
$this
->
İtiÚs
['separator']);

83 ià(
$»mašd”
) {

85 
$v®ue
 .ğ
$this
->
İtiÚs
['decim®'] . 
	`sub¡r
(
$»mašd”
, 2);

90 ià(
$this
->
İtiÚs
['hide_em±y'] && 
	`em±y
(
$v®ue
) && ($value !== 0 || $this->options['empty_zero'])) {

94  
	`check_¶aš
(
$this
->
İtiÚs
['´efix'] . 
$v®ue
 . $this->options['suffix']);

95 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_prerender_list.inc

1 <?
php


14 şas 
	cv›ws_hªdËr_f›ld_´”’d”_li¡
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

15 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

16 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

18 
$İtiÚs
['ty³'] = 
	`¬¿y
('default' => 'separator');

19 
$İtiÚs
['£·¿tÜ'] = 
	`¬¿y
('default' => ', ');

21  
$İtiÚs
;

24 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

25 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

26 
$fÜm
['ty³'] = 
	`¬¿y
(

28 '#t™Ë' => 
	`t
('Displayype'),

29 '#İtiÚs' => 
	`¬¿y
(

30 'ul' => 
	`t
('Unordered†ist'),

31 'Ş' => 
	`t
('Ordered†ist'),

32 '£·¿tÜ' => 
	`t
('Simple separator'),

34 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['type'],

37 
$fÜm
['£·¿tÜ'] = 
	`¬¿y
(

39 '#t™Ë' => 
	`t
('Separator'),

40 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['separator'],

41 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

42 '#d•’d’cy' => 
	`¬¿y
('radio:options[type]' =>‡rray('separator')),

44 
	}
}

53 
funùiÚ
 
	$»nd”
(
$v®ues
) {

54 
$f›ld
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

55 ià(!
	`em±y
(
$this
->
™ems
[
$f›ld
])) {

56 ià(
$this
->
İtiÚs
['type'] == 'separator') {

57  
	`im¶ode
(
	`check_¶aš
(
$this
->
İtiÚs
['£·¿tÜ']), $this->
™ems
[
$f›ld
]);

60  
	`theme
('™em_li¡', 
$this
->
™ems
[
$f›ld
], 
NULL
, $this->
İtiÚs
['type']);

63 
	}
}

71 
funùiÚ
 
	$»nd”_™ems
(
$™ems
) {

72 ià(!
	`em±y
(
$™ems
)) {

73 ià(
$this
->
İtiÚs
['type'] == 'separator') {

74  
	`im¶ode
(
	`check_¶aš
(
$this
->
İtiÚs
['£·¿tÜ']), 
$™ems
);

77  
	`theme
('™em_li¡', 
$™ems
, 
NULL
, 
$this
->
İtiÚs
['type']);

80 
	}
}

92 
funùiÚ
 
	$g‘_™ems
(
$v®ues
) {

93 
$f›ld
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

94 ià(!
	`em±y
(
$this
->
™ems
[
$f›ld
])) {

95  
$this
->
™ems
[
$f›ld
];

98  
	`¬¿y
();

99 
	}
}

107 
funùiÚ
 
	$®low_advªûd_»nd”
() {

110  
	`m‘hod_exi¡s
(
$this
, 'render_item');

111 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_url.inc

1 <?
php


9 şas 
	cv›ws_hªdËr_f›ld_u¾
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

10 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

11 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

13 
$İtiÚs
['di¥Ïy_as_lšk'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

15  
$İtiÚs
;

21 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

22 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

23 
$fÜm
['di¥Ïy_as_lšk'] = 
	`¬¿y
(

24 '#t™Ë' => 
	`t
('Display‡s†ink'),

26 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['display_as_link']),

28 
	}
}

30 
funùiÚ
 
	$»nd”
(
$v®ues
) {

31 
$v®ue
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

32 ià(!
	`em±y
(
$this
->
İtiÚs
['display_as_link'])) {

33  
	`l
(
	`check_¶aš
(
$v®ue
), $v®ue, 
	`¬¿y
('html' => 
TRUE
));

36  
	`check_u¾
(
$v®ue
);

38 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter.inc

1 <?
php


17 şas 
	cv›ws_hªdËr_f‹r
 
ex‹nds
 
	mv›ws_hªdËr
 {

24 
funùiÚ
 
	$š™
(&
$v›w
, 
$İtiÚs
) {

25 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

27 
$this
->
İ”©Ü
 = $this->
İtiÚs
['operator'];

28 
$this
->
v®ue
 = $this->
İtiÚs
['value'];

32 ià(!
	`em±y
(
$İtiÚs
['expo£d']è&& !em±y($İtiÚs['expo£']['İ”©Ü']è&& !
	`is£t
($options['expose']['use_operator'])) {

33 
$this
->
İtiÚs
['expo£']['u£_İ”©Ü'] = 
TRUE
;

39 ià(
$this
->
v›w
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('relationships')) {

40 
$this
->
defš™iÚ
['®lowƒm±y'] = 
TRUE
;

44 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

45 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

47 
$İtiÚs
['İ”©Ü'] = 
	`¬¿y
('default' => '=');

48 
$İtiÚs
['v®ue'] = 
	`¬¿y
('default' => '');

49 
$İtiÚs
['group'] = 
	`¬¿y
('default' => '0');

50 
$İtiÚs
['expo£d'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

51 
$İtiÚs
['expo£'] = 
	`¬¿y
(

52 'cÚšs' => 
	`¬¿y
(

53 'İ”©Ü' => 
	`¬¿y
('deçuÉ' => 
FALSE
),

54 'Ïb–' => 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
),

58  
$İtiÚs
;

59 
	}
}

64 
funùiÚ
 
	$admš_summ¬y
() {

65  
	`check_¶aš
((
¡ršg
è
$this
->
İ”©Ü
è. ' ' . check_¶aš((¡ršgè$this->
v®ue
);

66 
	}
}

71 
funùiÚ
 
	$ÿn_expo£
(è{  
TRUE
; 
	}
}

79 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

80 ià(
$this
->
	`ÿn_expo£
()) {

81 
$this
->
	`show_expo£_bu‰Ú
(
$fÜm
, 
$fÜm_¡©e
);

83 
$fÜm
['İ_v®_¡¬t'] = 
	`¬¿y
('#value' => '<div class="clear-block">');

84 
$this
->
	`show_İ”©Ü_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

85 
$this
->
	`show_v®ue_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

86 
$fÜm
['İ_v®_’d'] = 
	`¬¿y
('#value' => '</div>');

87 ià(
$this
->
	`ÿn_expo£
()) {

88 
$this
->
	`show_expo£_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

90 
	}
}

95 
funùiÚ
 
	$İtiÚs_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
) {

96 
$this
->
	`İ”©Ü_v®id©e
(
$fÜm
, 
$fÜm_¡©e
);

97 
$this
->
	`v®ue_v®id©e
(
$fÜm
, 
$fÜm_¡©e
);

98 ià(!
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

99 
$this
->
	`expo£_v®id©e
(
$fÜm
, 
$fÜm_¡©e
);

102 
	}
}

107 
funùiÚ
 
	$İtiÚs_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

108 
	`un£t
(
$fÜm_¡©e
['values']['expose_button']);

109 
$this
->
	`İ”©Ü_subm™
(
$fÜm
, 
$fÜm_¡©e
);

110 
$this
->
	`v®ue_subm™
(
$fÜm
, 
$fÜm_¡©e
);

111 ià(!
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

112 
$this
->
	`expo£_subm™
(
$fÜm
, 
$fÜm_¡©e
);

114 
	}
}

119 
funùiÚ
 
	$show_İ”©Ü_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

120 
$this
->
	`İ”©Ü_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

121 
$fÜm
['operator']['#prefix'] = '<div class="views-left-30">';

122 
$fÜm
['operator']['#suffix'] = '</div>';

123 
	}
}

131 
funùiÚ
 
	$İ”©Ü_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

132 
$İtiÚs
 = 
$this
->
	`İ”©Ü_İtiÚs
();

133 ià(!
	`em±y
(
$İtiÚs
)) {

134 
$fÜm
['İ”©Ü'] = 
	`¬¿y
(

135 '#ty³' => 
	`couÁ
(
$İtiÚs
) < 10 ? 'radios' : 'select',

136 '#t™Ë' => 
	`t
('Operator'),

137 '#deçuÉ_v®ue' => 
$this
->
İ”©Ü
,

138 '#İtiÚs' => 
$İtiÚs
,

141 
	}
}

147 
funùiÚ
 
	$İ”©Ü_İtiÚs
(è{  
	`¬¿y
(); 
	}
}

152 
funùiÚ
 
	$İ”©Ü_v®id©e
(
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

158 
funùiÚ
 
	$İ”©Ü_subm™
(
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

163 
funùiÚ
 
	$show_v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

164 
$this
->
	`v®ue_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

165 ià(
	`em±y
(
$this
->
no_İ”©Ü
)) {

166 
$fÜm
['v®ue']['#´efix'] = '<div cÏss="v›ws-right-70">' . (
	`is£t
($form['value']['#prefix']) ? $form['value']['#prefix'] : '');

167 
$fÜm
['v®ue']['#suffix'] = (
	`is£t
($form['value']['#suffix']) ? $form['value']['#suffix'] : '') . '</div>';

169 
	}
}

177 
funùiÚ
 
	$v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
è{ $fÜm['v®ue'] = 
	`¬¿y
(); 
	}
}

182 
funùiÚ
 
	$v®ue_v®id©e
(
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

188 
funùiÚ
 
	$v®ue_subm™
(
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

193 
funùiÚ
 
	$show_expo£_bu‰Ú
(&
$fÜm
, &
$fÜm_¡©e
) {

194 
$fÜm
['expo£_bu‰Ú'] = 
	`¬¿y
(

198 ià(
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

199 
$fÜm
['expo£_bu‰Ú']['bu‰Ú'] = 
	`¬¿y
(

201 '#v®ue' => 
	`t
('Expose'),

202 '#subm™' => 
	`¬¿y
('views_ui_config_item_form_expose'),

204 
$fÜm
['expo£_bu‰Ú']['m¬kup'] = 
	`¬¿y
(

206 '#v®ue' => 
	`t
('This item is currently‚otƒxposed. If you <strong>expose</strong> it, users will be‡bleo changehe filter‡shey view it.'),

211 
$fÜm
['expo£_bu‰Ú']['bu‰Ú'] = 
	`¬¿y
(

213 '#v®ue' => 
	`t
('Hide'),

214 '#subm™' => 
	`¬¿y
('views_ui_config_item_form_expose'),

216 
$fÜm
['expo£_bu‰Ú']['m¬kup'] = 
	`¬¿y
(

218 '#v®ue' => 
	`t
('This item is currentlyƒxposed. If you <strong>hide</strong> it, users will‚ot be‡bleo changehe filter‡shey view it.'),

222 
	}
}

227 
funùiÚ
 
	$show_expo£_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

228 ià(
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

232 
$fÜm
['expo£'] = 
	`¬¿y
(

236 
$this
->
	`expo£_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

242 ià(!
	`em±y
(
$fÜm_¡©e
['force_expose_options'])) {

243 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['expo£']è
as
 
$id
) {

244 ià(
	`is£t
(
$fÜm
['expo£'][
$id
]['#default_value']) && !isset($form['expose'][$id]['#value'])) {

245 
$fÜm
['expo£'][
$id
]['#value'] = $form['expose'][$id]['#default_value'];

249 
	}
}

260 
funùiÚ
 
	$expo£_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

261 
$fÜm
['expo£']['¡¬t_Ëá'] = 
	`¬¿y
(

265 
$this
->
	`expo£_fÜm_Ëá
(
$fÜm
, 
$fÜm_¡©e
);

267 
$fÜm
['expo£']['’d_Ëá'] = 
	`¬¿y
(

271 
$fÜm
['expo£']['¡¬t_checkboxes'] = 
	`¬¿y
(

275 
$this
->
	`expo£_fÜm_right
(
$fÜm
, 
$fÜm_¡©e
);

277 
$fÜm
['expo£']['’d_checkboxes'] = 
	`¬¿y
(

280 
	}
}

285 
funùiÚ
 
	$expo£_fÜm_Ëá
(&
$fÜm
, &
$fÜm_¡©e
) {

286 ià(!
	`em±y
(
$fÜm
['operator']['#type'])) {

287 
$fÜm
['expo£']['u£_İ”©Ü'] = 
	`¬¿y
(

289 '#t™Ë' => 
	`t
('Unlock operator'),

290 '#desütiÚ' => 
	`t
('When checked,he operator will beƒxposedohe user'),

291 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['expose']['use_operator']),

293 
$fÜm
['expo£']['İ”©Ü'] = 
	`¬¿y
(

295 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['expose']['operator'],

296 '#t™Ë' => 
	`t
('Operator identifier'),

298 '#desütiÚ' => 
	`t
('This will‡ppear inhe URL‡fterhe ?o identifyhis operator.'),

299 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

300 '#d•’d’cy' => 
	`¬¿y
(

301 'ed™-İtiÚs-expo£-u£-İ”©Ü' => 
	`¬¿y
(1)

306 
$fÜm
['expo£']['İ”©Ü'] = 
	`¬¿y
(

312 
$fÜm
['expo£']['id’tif›r'] = 
	`¬¿y
(

314 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['expose']['identifier'],

315 '#t™Ë' => 
	`t
('Filter identifier'),

317 '#desütiÚ' => 
	`t
('This will‡ppear inhe URL‡fterhe ?o identifyhis filter. Cannot be blank.'),

319 
$fÜm
['expo£']['Ïb–'] = 
	`¬¿y
(

321 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['expose']['label'],

322 '#t™Ë' => 
	`t
('Label'),

325 
	}
}

330 
funùiÚ
 
	$expo£_fÜm_right
(&
$fÜm
, &
$fÜm_¡©e
) {

331 
$fÜm
['expo£']['İtiÚ®'] = 
	`¬¿y
(

333 '#t™Ë' => 
	`t
('Optional'),

334 '#desütiÚ' => 
	`t
('Thisƒxposed filter is optional‡nd will have‡dded optionso‡llow it‚oto be set.'),

335 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['expose']['optional'],

337 ià(
	`em±y
(
$this
->
no_sšgË
)) {

338 
$fÜm
['expo£']['sšgË'] = 
	`¬¿y
(

340 '#t™Ë' => 
	`t
('Force single'),

341 '#desütiÚ' => 
	`t
('Forcehisƒxposed filtero‡ccept only one option.'),

342 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['expose']['single'],

345 
$fÜm
['expo£']['»memb”'] = 
	`¬¿y
(

347 '#t™Ë' => 
	`t
('Remember'),

348 '#desütiÚ' => 
	`t
('Rememberhe†ast settinghe user gavehis filter.'),

349 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['expose']['remember'],

351 
	}
}

356 
funùiÚ
 
	$expo£_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

357 ià(
	`em±y
(
$this
->
İtiÚs
['expose']['identifier'])) {

358 ià(
	`em±y
(
$fÜm_¡©e
['values']['options']['expose']['identifier'])) {

359 
	`fÜm_”rÜ
(
$fÜm
['expo£']['id’tif›r'], 
	`t
('The identifier is„equired ifhe filter isƒxposed.'));

363 ià(!
	`em±y
(
$fÜm_¡©e
['values']['options']['expose']['identifier']) && $form_state['values']['options']['expose']['identifier'] == 'value') {

364 
	`fÜm_”rÜ
(
$fÜm
['expo£']['id’tif›r'], 
	`t
('This identifier is‚ot‡llowed.'));

367 ià(!
$this
->
v›w
->
di¥Ïy_hªdËr
->
	`is_id’tif›r_unique
(
$fÜm_¡©e
['id'], $form_state['values']['options']['expose']['identifier'])) {

368 
	`fÜm_”rÜ
(
$fÜm
['expo£']['id’tif›r'], 
	`t
('This identifier is used by‡nother handler.'));

370 
	}
}

376 
funùiÚ
 
	$expo£_subm™
(
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

381 
funùiÚ
 
	$expo£_İtiÚs
() {

382 
$this
->
İtiÚs
['expo£'] = 
	`¬¿y
(

383 'u£_İ”©Ü' => 
FALSE
,

384 'İ”©Ü' => 
$this
->
İtiÚs
['id'] . '_op',

385 'id’tif›r' => 
$this
->
İtiÚs
['id'],

386 'Ïb–' => 
$this
->
	`ui_Çme
(),

387 '»memb”' => 
FALSE
,

388 'sšgË' => 
TRUE
,

389 'İtiÚ®' => 
TRUE
,

391 
	}
}

398 
funùiÚ
 
	$expo£d_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

399 ià(
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

403 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['use_operator']) && !empty($this->options['expose']['operator'])) {

404 
$İ”©Ü
 = 
$this
->
İtiÚs
['expose']['operator'];

405 
$this
->
	`İ”©Ü_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

406 
$fÜm
[
$İ”©Ü
] = $form['operator'];

408 ià(
	`is£t
(
$fÜm
[
$İ”©Ü
]['#title'])) {

409 
	`un£t
(
$fÜm
[
$İ”©Ü
]['#title']);

412 
$this
->
	`expo£d_Œª¦©e
(
$fÜm
[
$İ”©Ü
], 'operator');

414 
	`un£t
(
$fÜm
['operator']);

417 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['identifier'])) {

418 
$v®ue
 = 
$this
->
İtiÚs
['expose']['identifier'];

419 
$this
->
	`v®ue_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

420 
$fÜm
[
$v®ue
] = $form['value'];

422 ià(
	`is£t
(
$fÜm
[
$v®ue
]['#t™Ë']è&& !
	`em±y
($form[$value]['#type']) && $form[$value]['#type'] != 'checkbox') {

423 
	`un£t
(
$fÜm
[
$v®ue
]['#title']);

426 
$this
->
	`expo£d_Œª¦©e
(
$fÜm
[
$v®ue
], 'value');

428 ià(!
	`em±y
(
$fÜm
['#type']) && ($form['#type'] == 'checkboxes' || ($form['#type'] == 'select' && !empty($form['#multiple'])))) {

429 
	`un£t
(
$fÜm
[
$v®ue
]['#default_value']);

432 ià(!
	`em±y
(
$fÜm
['#type']) && $form['#type'] == 'select' &&ƒmpty($form['#multiple'])) {

433 
$fÜm
[
$v®ue
]['#default_value'] = 'All';

436 ià(
$v®ue
 != 'value') {

437 
	`un£t
(
$fÜm
['value']);

440 
	}
}

446 
funùiÚ
 
	$expo£d_Œª¦©e
(&
$fÜm
, 
$ty³
) {

447 ià(!
	`is£t
(
$fÜm
['#type'])) {

451 ià(
$fÜm
['#type'] == 'radios') {

452 
$fÜm
['#type'] = 'select';

455 ià(
$fÜm
['#type'] == 'checkboxes') {

456 ià(
	`em±y
(
$fÜm
['#no_cÚv”t']è|| !em±y(
$this
->
İtiÚs
['expose']['single'])) {

457 
$fÜm
['#type'] = 'select';

459 ià(
	`em±y
(
$this
->
İtiÚs
['expose']['single'])) {

460 
$fÜm
['#muÉË'] = 
TRUE
;

463 ià(!
	`em±y
(
$this
->
İtiÚs
['expo£']['sšgË']è&& 
	`is£t
(
$fÜm
['#multiple'])) {

464 
	`un£t
(
$fÜm
['#multiple']);

465 
$fÜm
['#size'] = 
NULL
;

468 ià(
$ty³
 =ğ'v®ue' && !
	`em±y
(
$this
->
İtiÚs
['expo£']['İtiÚ®']è&& 
$fÜm
['#type'] == 'select' &&ƒmpty($form['#multiple'])) {

469 
$ªy_Ïb–
 = 
	`v¬ŸbË_g‘
('v›ws_expo£d_f‹r_ªy_Ïb–', 'Şd_ªy'è=ğ'Şd_ªy' ? '<Any>' : 
	`t
('- Any -');

470 
$fÜm
['#İtiÚs'] = 
	`¬¿y
('AÎ' => 
$ªy_Ïb–
) + $form['#options'];

471 
$fÜm
['#default_value'] = 'All';

473 
	}
}

479 
funùiÚ
 
	$expo£d_šfo
() {

480 ià(
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

484  
	`¬¿y
(

485 'İ”©Ü' => 
$this
->
İtiÚs
['expose']['operator'],

486 'v®ue' => 
$this
->
İtiÚs
['expose']['identifier'],

487 'Ïb–' => 
$this
->
İtiÚs
['expose']['label'],

489 
	}
}

495 
funùiÚ
 
	$acû±_expo£d_šput
(
$šput
) {

496 ià(
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

497  
TRUE
;

501 ià(!
	`em±y
(
$this
->
İtiÚs
['expo£']['u£_İ”©Ü']è&& !em±y($this->İtiÚs['expo£']['İ”©Ü']è&& 
	`is£t
(
$šput
[$this->options['expose']['operator']])) {

502 
$this
->
İ”©Ü
 = 
$šput
[$this->
İtiÚs
['expose']['operator']];

505 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['identifier'])) {

506 
$v®ue
 = 
$šput
[
$this
->
İtiÚs
['expose']['identifier']];

509 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['optional'])) {

510 ià(
$v®ue
 =ğ'AÎ' || $v®u==ğ
	`¬¿y
()) {

511  
FALSE
;

514 ià(!
	`em±y
(
$this
->
no_sšgË
è&& 
$v®ue
 === '') {

515  
FALSE
;

520 ià(
	`is£t
(
$v®ue
)) {

521 
$this
->
v®ue
 = 
$v®ue
;

522 ià(
	`em±y
(
$this
->
no_sšgË
è&& !em±y($this->
İtiÚs
['expose']['single'])) {

523 
$this
->
v®ue
 = 
	`¬¿y
(
$v®ue
);

527  
FALSE
;

531  
TRUE
;

532 
	}
}

534 
funùiÚ
 
	$¡Üe_expo£d_šput
(
$šput
, 
$¡©us
) {

535 ià(
	`em±y
(
$this
->
İtiÚs
['exposed']) ||ƒmpty($this->options['expose']['identifier'])) {

536  
TRUE
;

539 ià(
	`em±y
(
$this
->
İtiÚs
['expose']['remember'])) {

545 
$di¥Ïy_id
 = (
$this
->
v›w
->
di¥Ïy_hªdËr
->
	`is_deçuÉed
('f‹rs')è? 'deçuÉ' : $this->v›w->
cu¼’t_di¥Ïy
;

548 
$İ”©Ü
 = !
	`em±y
(
$this
->
İtiÚs
['expose']['use_operator']) && !empty($this->options['expose']['operator']);

552 ià(!
$¡©us
 && 
	`is£t
(
$_SESSION
['v›ws'][
$this
->
v›w
->
Çme
][
$di¥Ïy_id
])) {

553 
$£ssiÚ
 = &
$_SESSION
['v›ws'][
$this
->
v›w
->
Çme
][
$di¥Ïy_id
];

554 ià(
$İ”©Ü
 && 
	`is£t
(
$£ssiÚ
[
$this
->
İtiÚs
['expose']['operator']])) {

555 
	`un£t
(
$£ssiÚ
[
$this
->
İtiÚs
['expose']['operator']]);

558 ià(
	`is£t
(
$£ssiÚ
[
$this
->
İtiÚs
['expose']['identifier']])) {

559 
	`un£t
(
$£ssiÚ
[
$this
->
İtiÚs
['expose']['identifier']]);

563 ià(
$¡©us
) {

564 ià(!
	`is£t
(
$_SESSION
['v›ws'][
$this
->
v›w
->
Çme
][
$di¥Ïy_id
])) {

565 
$_SESSION
['v›ws'][
$this
->
v›w
->
Çme
][
$di¥Ïy_id
] = 
	`¬¿y
();

568 
$£ssiÚ
 = &
$_SESSION
['v›ws'][
$this
->
v›w
->
Çme
][
$di¥Ïy_id
];

570 ià(
$İ”©Ü
 && 
	`is£t
(
$šput
[
$this
->
İtiÚs
['expose']['operator']])) {

571 
$£ssiÚ
[
$this
->
İtiÚs
['expo£']['İ”©Ü']] = 
$šput
[$this->options['expose']['operator']];

574 
$£ssiÚ
[
$this
->
İtiÚs
['expo£']['id’tif›r']] = 
$šput
[$this->options['expose']['identifier']];

576 
	}
}

585 
funùiÚ
 
	$qu”y
() {

586 
$this
->
	`’su»_my_bË
();

587 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$this->bË_®Ÿs.$this->»®_f›ld " . $this->
İ”©Ü
 . " '%s'", $this->
v®ue
);

588 
	}
}

595 şas 
	cv›ws_hªdËr_f‹r_brok’
 
ex‹nds
 
	mv›ws_hªdËr_f‹r
 {

596 
funùiÚ
 
	$ui_Çme
(
$shÜt
 = 
FALSE
) {

597  
	`t
('Broken/missing handler');

600 
funùiÚ
 
	$’su»_my_bË
(è{ 
	}
}

601 
funùiÚ
 
	$qu”y
(è{ 
	}
}

602 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

603 
$fÜm
['m¬kup'] = 
	`¬¿y
(

605 '#v®ue' => 
	`t
('The handler forhis item is broken or missing‡nd cannot be used. If‡ module…rovidedhe handler‡nd was disabled,„e-enablinghe module may„estore it. Otherwise, you should…robably deletehis item.'),

607 
	}
}

612 
funùiÚ
 
	$brok’
(è{  
TRUE
; 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_boolean_operator.inc

1 <?
php


13 şas 
	cv›ws_hªdËr_f‹r_boŞ—n_İ”©Ü
 
ex‹nds
 
	mv›ws_hªdËr_f‹r
 {

15 
v¬
 
	m$no_sšgË
 = 
TRUE
;

17 
v¬
 
	m$no_İ”©Ü
 = 
TRUE
;

19 
v¬
 
	m$acû±_nuÎ
 = 
FALSE
;

21 
funùiÚ
 
	$cÚ¡ruù
() {

22 
$this
->
v®ue_v®ue
 = 
	`t
('True');

23 ià(
	`is£t
(
$this
->
defš™iÚ
['label'])) {

24 
$this
->
v®ue_v®ue
 = $this->
defš™iÚ
['label'];

26 ià(
	`is£t
(
$this
->
defš™iÚ
['accept_null'])) {

27 
$this
->
acû±_nuÎ
 = (
boŞ
è$this->
defš™iÚ
['accept_null'];

29 
$this
->
v®ue_İtiÚs
 = 
NULL
;

30 
·»Á
::
	`cÚ¡ruù
();

45 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

46 ià(
	`is£t
(
$this
->
defš™iÚ
['type'])) {

47 ià(
$this
->
defš™iÚ
['type'] == 'yes-no') {

48 
$this
->
v®ue_İtiÚs
 = 
	`¬¿y
(1 => 
	`t
('Yes'), 0 =>('No'));

50 ià(
$this
->
defš™iÚ
['type'] == 'on-off') {

51 
$this
->
v®ue_İtiÚs
 = 
	`¬¿y
(1 => 
	`t
('On'), 0 =>('Off'));

56 ià(!
	`is£t
(
$this
->
v®ue_İtiÚs
)) {

57 
$this
->
v®ue_İtiÚs
 = 
	`¬¿y
(1 => 
	`t
('True'), 0 =>('False'));

59 
	}
}

61 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

62 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

64 
$İtiÚs
['v®ue']['deçuÉ'] = 
FALSE
;

66  
$İtiÚs
;

67 
	}
}

69 
funùiÚ
 
	$İ”©Ü_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

70 
$fÜm
['İ”©Ü'] = 
	`¬¿y
();

71 
	}
}

73 
funùiÚ
 
	$v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

74 ià(
	`em±y
(
$this
->
v®ue_İtiÚs
)) {

76 
$this
->
	`g‘_v®ue_İtiÚs
();

78 ià(!
	`em±y
(
$fÜm_¡©e
['exposed'])) {

80 
$f‹r_fÜm_ty³
 = 'select';

84 
$f‹r_fÜm_ty³
 = 'radios';

86 
$fÜm
['v®ue'] = 
	`¬¿y
(

87 '#ty³' => 
$f‹r_fÜm_ty³
,

88 '#t™Ë' => 
$this
->
v®ue_v®ue
,

89 '#İtiÚs' => 
$this
->
v®ue_İtiÚs
,

90 '#deçuÉ_v®ue' => 
$this
->
v®ue
,

92 ià(!
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

93 
$id’tif›r
 = 
$this
->
İtiÚs
['expose']['identifier'];

94 ià(!
	`is£t
(
$fÜm_¡©e
['šput'][
$id’tif›r
])) {

95 
$fÜm_¡©e
['šput'][
$id’tif›r
] = 
$this
->
v®ue
;

98 
$ªy_Ïb–
 = 
	`v¬ŸbË_g‘
('v›ws_expo£d_f‹r_ªy_Ïb–', 'Şd_ªy'è=ğ'Şd_ªy' ? '<Any>' : 
	`t
('- Any -');

99 ià(
$fÜm
['value']['#type'] != 'select') {

100 
$ªy_Ïb–
 = 
	`check_¶aš
($any_label);

102 
$fÜm
['v®ue']['#İtiÚs'] = 
	`¬¿y
('AÎ' => 
$ªy_Ïb–
) + $form['value']['#options'];

104 
	}
}

106 
funùiÚ
 
	$v®ue_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
) {

107 ià(
$fÜm_¡©e
['v®ues']['İtiÚs']['v®ue'] =ğ'AÎ' && 
	`em±y
($form_state['values']['options']['expose']['optional'])) {

108 
	`fÜm_£t_”rÜ
('v®ue', 
	`t
('You must select‡ value unlesshis is‡n optionalƒxposed filter.'));

110 
	}
}

112 
funùiÚ
 
	$admš_summ¬y
() {

113 ià(!
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

114  
	`t
('exposed');

116 ià(
	`em±y
(
$this
->
v®ue_İtiÚs
)) {

117 
$this
->
	`g‘_v®ue_İtiÚs
();

123  
$this
->
v®ue_İtiÚs
[!
	`em±y
($this->
v®ue
)];

124 
	}
}

126 
funùiÚ
 
	$expo£_İtiÚs
() {

127 
·»Á
::
	`expo£_İtiÚs
();

128 
$this
->
İtiÚs
['expose']['operator'] = '';

129 
$this
->
İtiÚs
['expo£']['Ïb–'] = $this->
v®ue_v®ue
;

130 
$this
->
İtiÚs
['expo£']['İtiÚ®'] = 
FALSE
;

131 
	}
}

133 
funùiÚ
 
	$qu”y
() {

134 
$this
->
	`’su»_my_bË
();

136 
$wh”e
 = "$this->table_alias.$this->real_field ";

138 ià(
	`em±y
(
$this
->
v®ue
)) {

139 
$wh”e
 .= '= 0';

140 ià(
$this
->
acû±_nuÎ
) {

141 
$wh”e
 = '(' . $where . " OR $this->table_alias.$this->real_field IS NULL)";

145 
$wh”e
 .= '<> 0';

147 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], 
$wh”e
);

148 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_boolean_operator_string.inc

1 <?
php


12 şas 
	cv›ws_hªdËr_f‹r_boŞ—n_İ”©Ü_¡ršg
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_boŞ—n_İ”©Ü
 {

13 
funùiÚ
 
	$qu”y
() {

14 
$this
->
	`’su»_my_bË
();

15 
$wh”e
 = "$this->table_alias.$this->real_field ";

17 ià(
	`em±y
(
$this
->
v®ue
)) {

18 
$wh”e
 .= "= ''";

19 ià(
$this
->
acû±_nuÎ
) {

20 
$wh”e
 = '(' . $where . " OR $this->table_alias.$this->real_field IS NULL)";

24 
$wh”e
 .= "<> ''";

26 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], 
$wh”e
);

28 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_date.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_d©e
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_num”ic
 {

8 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

9 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

12 
$İtiÚs
['value']['type']['default'] = 'date';

14  
$İtiÚs
;

20 
funùiÚ
 
	$v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

21 ià(
	`em±y
(
$fÜm_¡©e
['exposed'])) {

22 
$fÜm
['v®ue']['ty³'] = 
	`¬¿y
(

24 '#t™Ë' => 
	`t
('Valueype'),

25 '#İtiÚs' => 
	`¬¿y
(

26 'd©e' => 
	`t
('A date in‡ny machine„eadable format. CCYY-MM-DD HH:MM:SS is…referred.'),

27 'off£t' => 
	`t
('An offset fromhe currentime such‡s "+1 day" or "-2 hours -30 minutes"'),

29 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
v®ue
['type']) ? $this->value['type'] : 'date',

32 
·»Á
::
	`v®ue_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

33 
	}
}

35 
funùiÚ
 
	$İtiÚs_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
) {

36 
·»Á
::
	`İtiÚs_v®id©e
(
$fÜm
, 
$fÜm_¡©e
);

38 ià(!
	`em±y
(
$fÜm_¡©e
['values']['options']['expose']['optional'])) {

43 
$this
->
	`v®id©e_v®id_time
(
$fÜm
['v®ue'], 
$fÜm_¡©e
['values']['options']['operator'], $form_state['values']['options']['value']);

44 
	}
}

46 
funùiÚ
 
	$expo£d_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
) {

47 ià(
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

51 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['optional'])) {

56 
$v®ue
 = &
$fÜm_¡©e
['v®ues'][
$this
->
İtiÚs
['expose']['identifier']];

57 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['use_operator']) && !empty($this->options['expose']['operator'])) {

58 
$İ”©Ü
 = 
$fÜm_¡©e
['v®ues'][
$this
->
İtiÚs
['expose']['operator']];

61 
$İ”©Ü
 = 
$this
->
İ”©Ü
;

64 
$this
->
	`v®id©e_v®id_time
($this->
İtiÚs
['expo£']['id’tif›r'], 
$İ”©Ü
, 
$v®ue
);

66 
	}
}

71 
funùiÚ
 
	$v®id©e_v®id_time
(&
$fÜm
, 
$İ”©Ü
, 
$v®ue
) {

72 
$İ”©Üs
 = 
$this
->
	`İ”©Üs
();

74 ià(
$İ”©Üs
[
$İ”©Ü
]['values'] == 1) {

75 
$cÚv”t
 = 
	`¡¹Ùime
(
$v®ue
['value']);

76 ià(
$cÚv”t
 =ğ-1 || $cÚv”ˆ==ğ
FALSE
) {

77 
	`fÜm_”rÜ
(
$fÜm
['v®ue'], 
	`t
('Invalid date format.'));

80 
	`–£if
 (
$İ”©Üs
[
$İ”©Ü
]['values'] == 2) {

81 
$mš
 = 
	`¡¹Ùime
(
$v®ue
['min']);

82 ià(
$mš
 =ğ-1 || $mš ==ğ
FALSE
) {

83 
	`fÜm_”rÜ
(
$fÜm
['mš'], 
	`t
('Invalid date format.'));

85 
$max
 = 
	`¡¹Ùime
(
$v®ue
['max']);

86 ià(
$max
 =ğ-1 || $max ==ğ
FALSE
) {

87 
	`fÜm_”rÜ
(
$fÜm
['max'], 
	`t
('Invalid date format.'));

90 
	}
}

92 
funùiÚ
 
	$acû±_expo£d_šput
(
$šput
) {

93 ià(
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

94  
TRUE
;

98 
$ty³
 = 
$this
->
v®ue
['type'];

99 
$rc
 = 
·»Á
::
	`acû±_expo£d_šput
(
$šput
);

102 
$İ”©Üs
 = 
$this
->
	`İ”©Üs
();

103 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['use_operator']) && !empty($this->options['expose']['operator'])) {

104 
$İ”©Ü
 = 
$šput
[
$this
->
İtiÚs
['expose']['operator']];

107 
$İ”©Ü
 = 
$this
->
İ”©Ü
;

110 ià(
$İ”©Üs
[
$İ”©Ü
]['values'] == 1) {

111 ià(
$this
->
v®ue
['value'] == '') {

112  
FALSE
;

116 ià(
$this
->
v®ue
['min'] == '' || $this->value['max'] == '') {

117  
FALSE
;

122 
$this
->
v®ue
['ty³'] = 
$ty³
;

123  
$rc
;

124 
	}
}

126 
funùiÚ
 
	$İ_b‘w“n
(
$f›ld
) {

127 ià(
$this
->
İ”©Ü
 == 'between') {

128 
$a
 = 
	`štv®
(
	`¡¹Ùime
(
$this
->
v®ue
['min'], 0));

129 
$b
 = 
	`štv®
(
	`¡¹Ùime
(
$this
->
v®ue
['max'], 0));

132 
$a
 = 
	`štv®
(
	`¡¹Ùime
(
$this
->
v®ue
['max'], 0));

133 
$b
 = 
	`štv®
(
	`¡¹Ùime
(
$this
->
v®ue
['min'], 0));

136 ià(
$this
->
v®ue
['type'] == 'offset') {

137 
$a
 = '***CURRENT_TIME***' . 
	`¥rštf
('%+d', $a);

138 
$b
 = '***CURRENT_TIME***' . 
	`¥rštf
('%+d', $b);

142 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$f›ld >ğ%s", 
$a
);

143 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$f›ld <ğ%s", 
$b
);

144 
	}
}

146 
funùiÚ
 
	$İ_sim¶e
(
$f›ld
) {

147 
$v®ue
 = 
	`štv®
(
	`¡¹Ùime
(
$this
->
v®ue
['value'], 0));

148 ià(!
	`em±y
(
$this
->
v®ue
['type']) && $this->value['type'] == 'offset') {

149 
$v®ue
 = '***CURRENT_TIME***' . 
	`¥rštf
('%+d', $value);

151 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$f›ld $this->İ”©Ü %s", 
$v®ue
);

152 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_equality.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f‹r_equ®™y
 
ex‹nds
 
	mv›ws_hªdËr_f‹r
 {

8 
v¬
 
	m$no_sšgË
 = 
TRUE
;

13 
funùiÚ
 
	$İ”©Ü_İtiÚs
() {

14  
	`¬¿y
(

15 '=' => 
	`t
('Isƒqualo'),

16 '!=' => 
	`t
('Is‚otƒqualo'),

23 
funùiÚ
 
	$v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

24 
$fÜm
['v®ue'] = 
	`¬¿y
(

26 '#t™Ë' => 
	`t
('Value'),

28 '#deçuÉ_v®ue' => 
$this
->
v®ue
,

31 ià(!
	`em±y
(
$fÜm_¡©e
['exposed'])) {

32 
$id’tif›r
 = 
$this
->
İtiÚs
['expose']['identifier'];

33 ià(!
	`is£t
(
$fÜm_¡©e
['šput'][
$id’tif›r
])) {

34 
$fÜm_¡©e
['šput'][
$id’tif›r
] = 
$this
->
v®ue
;

37 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_float.inc

1 <?
php


9 şas 
	cv›ws_hªdËr_f‹r_æßt
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_num”ic
 {

10 
funùiÚ
 
	$İ_b‘w“n
(
$f›ld
) {

11 ià(
$this
->
İ”©Ü
 == 'between') {

12 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$f›ld >ğ%f", $this->
v®ue
['min']);

13 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$f›ld <ğ%f", $this->
v®ue
['max']);

16 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$f›ld <ğ%àOR $f›ld >ğ%f", $this->
v®ue
['min'], $this->value['max']);

20 
funùiÚ
 
	$İ_sim¶e
(
$f›ld
) {

21 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$f›ld $this->İ”©Ü %f", $this->
v®ue
['value']);

22 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_in_operator.inc

1 <?
php


10 şas 
	cv›ws_hªdËr_f‹r_š_İ”©Ü
 
ex‹nds
 
	mv›ws_hªdËr_f‹r
 {

11 
v¬
 
	m$v®ue_fÜm_ty³
 = 'checkboxes';

13 
funùiÚ
 
	$cÚ¡ruù
() {

14 
·»Á
::
	`cÚ¡ruù
();

15 
$this
->
v®ue_t™Ë
 = 
	`t
('Options');

16 
$this
->
v®ue_İtiÚs
 = 
NULL
;

27 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

28 ià(
	`is£t
(
$this
->
v®ue_İtiÚs
)) {

32 ià(
	`is£t
(
$this
->
defš™iÚ
['İtiÚ ÿÎback']è&& 
	`is_ÿÎabË
($this->definition['options callback'])) {

33 
$this
->
v®ue_İtiÚs
 = 
	`ÿÎ_u£r_func
($this->
defš™iÚ
['options callback']);

36 
$this
->
v®ue_İtiÚs
 = 
	`¬¿y
(
	`t
('Yes'),('No'));

38 
	}
}

40 
funùiÚ
 
	$expo£_İtiÚs
() {

41 
·»Á
::
	`expo£_İtiÚs
();

42 
$this
->
İtiÚs
['expo£']['»duû'] = 
FALSE
;

43 
	}
}

45 
funùiÚ
 
	$expo£_fÜm_right
(&
$fÜm
, &
$fÜm_¡©e
) {

46 
·»Á
::
	`expo£_fÜm_right
(
$fÜm
, 
$fÜm_¡©e
);

47 
$fÜm
['expo£']['»duû'] = 
	`¬¿y
(

49 '#t™Ë' => 
	`t
('Limit†isto selected items'),

50 '#desütiÚ' => 
	`t
('If checked,he only items…resentedohe user will behe ones selected here.'),

51 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['expose']['reduce']),

53 
	}
}

55 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

56 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

58 
$İtiÚs
['operator']['default'] = 'in';

59 
$İtiÚs
['v®ue']['deçuÉ'] = 
	`¬¿y
();

61  
$İtiÚs
;

62 
	}
}

69 
funùiÚ
 
	$İ”©Üs
() {

70 
$İ”©Üs
 = 
	`¬¿y
(

71 'š' => 
	`¬¿y
(

72 't™Ë' => 
	`t
('Is one of'),

73 'shÜt' => 
	`t
('in'),

74 'shÜt_sšgË' => 
	`t
('='),

78 'nÙ in' => 
	`¬¿y
(

79 't™Ë' => 
	`t
('Is‚ot one of'),

80 'shÜt' => 
	`t
('not in'),

81 'shÜt_sšgË' => 
	`t
('<>'),

87 ià(!
	`em±y
(
$this
->
defš™iÚ
['allowƒmpty'])) {

88 
$İ”©Üs
 +ğ
	`¬¿y
(

89 'em±y' => 
	`¬¿y
(

90 't™Ë' => 
	`t
('Isƒmpty (NULL)'),

92 'shÜt' => 
	`t
('empty'),

95 'nÙƒm±y' => 
	`¬¿y
(

96 't™Ë' => 
	`t
('Is‚otƒmpty (NOT NULL)'),

98 'shÜt' => 
	`t
('notƒmpty'),

104  
$İ”©Üs
;

105 
	}
}

110 
funùiÚ
 
İ”©Ü_İtiÚs
(
$which
 = 'title') {

111 
$İtiÚs
 = 
¬¿y
();

112 
fÜ—ch
 (
$this
->
İ”©Üs
(è
as
 
$id
 => 
$šfo
) {

113 
$İtiÚs
[
$id
] = 
$šfo
[
$which
];

116  
	g$İtiÚs
;

119 
funùiÚ
 
	$İ”©Ü_v®ues
(
$v®ues
 = 1) {

120 
$İtiÚs
 = 
	`¬¿y
();

121 
	`fÜ—ch
 (
$this
->
	`İ”©Üs
(è
as
 
$id
 => 
$šfo
) {

122 ià(
	`is£t
(
$šfo
['v®ues']è&& $šfo['v®ues'] =ğ
$v®ues
) {

123 
$İtiÚs
[] = 
$id
;

127  
$İtiÚs
;

128 
	}
}

130 
funùiÚ
 
	$v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

131 
$fÜm
['v®ue'] = 
	`¬¿y
();

133 
$this
->
	`g‘_v®ue_İtiÚs
();

134 
$İtiÚs
 = 
$this
->
v®ue_İtiÚs
;

135 
$deçuÉ_v®ue
 = (
¬¿y
è
$this
->
v®ue
;

137 
$which
 = 'all';

138 ià(!
	`em±y
(
$fÜm
['operator'])) {

139 
$sourû
 = (
$fÜm
['operator']['#type'] == 'radios') ? 'radio:options[operator]' : 'edit-options-operator';

141 ià(!
	`em±y
(
$fÜm_¡©e
['exposed'])) {

142 
$id’tif›r
 = 
$this
->
İtiÚs
['expose']['identifier'];

144 ià(
	`em±y
(
$this
->
İtiÚs
['expose']['use_operator']) ||ƒmpty($this->options['expose']['operator'])) {

146 
$which
 = 
	`š_¬¿y
(
$this
->
İ”©Ü
, $this->
	`İ”©Ü_v®ues
(1)) ? 'value' : 'none';

149 
$sourû
 = 'ed™-' . 
	`fÜm_ş—n_id
(
$this
->
İtiÚs
['expose']['operator']);

152 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['reduce'])) {

153 
$İtiÚs
 = 
$this
->
	`»duû_v®ue_İtiÚs
();

155 ià(
	`em±y
(
$this
->
İtiÚs
['expose']['single']) && !empty($this->options['expose']['optional'])) {

156 
$deçuÉ_v®ue
 = 
	`¬¿y
();

160 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['single'])) {

161 ià(!
	`em±y
(
$this
->
İtiÚs
['expo£']['İtiÚ®']è&& (em±y(
$deçuÉ_v®ue
) || !empty($this->options['expose']['reduce']))) {

162 
$deçuÉ_v®ue
 = 'All';

164 ià(
	`em±y
(
$deçuÉ_v®ue
)) {

165 
$keys
 = 
	`¬¿y_keys
(
$İtiÚs
);

166 
$deçuÉ_v®ue
 = 
	`¬¿y_shiá
(
$keys
);

169 
$cİy
 = 
$deçuÉ_v®ue
;

170 
$deçuÉ_v®ue
 = 
	`¬¿y_shiá
(
$cİy
);

175 ià(
$which
 == 'all' || $which == 'value') {

176 
$fÜm
['v®ue'] = 
	`¬¿y
(

177 '#ty³' => 
$this
->
v®ue_fÜm_ty³
,

178 '#t™Ë' => 
$this
->
v®ue_t™Ë
,

179 '#İtiÚs' => 
$İtiÚs
,

180 '#deçuÉ_v®ue' => 
$deçuÉ_v®ue
,

182 '#muÉË' => 
TRUE
,

183 '#size' => 
	`couÁ
(
$İtiÚs
) > 8 ? 8 : count($options),

185 ià(!
	`em±y
(
$fÜm_¡©e
['expo£d']è&& !
	`is£t
($fÜm_¡©e['šput'][
$id’tif›r
])) {

186 
$fÜm_¡©e
['šput'][
$id’tif›r
] = 
$deçuÉ_v®ue
;

189 
$´oûss
 = 
	`¬¿y
();

190 ià(
$this
->
v®ue_fÜm_ty³
 == 'checkboxes') {

197 
$´oûss
[] = 'views_process_check_options';

199 ià(
$which
 == 'all') {

200 ià(
	`em±y
(
$fÜm_¡©e
['expo£d']è&& (
$this
->
v®ue_fÜm_ty³
 == 'checkboxes' || $this->value_form_type == 'radios')) {

201 
$´oûss
[] = "expand_$this->value_form_type";

202 
$fÜm
['value']['#prefix'] = '<div id="edit-options-value-wrapper">';

203 
$fÜm
['value']['#suffix'] = '</div>';

205 
$´oûss
[] = 'views_process_dependency';

206 
$fÜm
['v®ue']['#d•’d’cy'] = 
	`¬¿y
(
$sourû
 => 
$this
->
	`İ”©Ü_v®ues
(1));

208 ià(!
	`em±y
(
$´oûss
)) {

209 
$fÜm
['v®ue']['#´oûss'] = 
$´oûss
;

212 
	}
}

217 
funùiÚ
 
	$»duû_v®ue_İtiÚs
(
$šput
 = 
NULL
) {

218 ià(!
	`is£t
(
$šput
)) {

219 
$šput
 = 
$this
->
v®ue_İtiÚs
;

225 
$İtiÚs
 = 
	`¬¿y
();

226 
	`fÜ—ch
 (
$šput
 
as
 
$id
 => 
$İtiÚ
) {

227 ià(
	`is_¬¿y
(
$İtiÚ
)) {

228 
$İtiÚs
[
$id
] = 
$this
->
	`»duû_v®ue_İtiÚs
(
$İtiÚ
);

231 ià(
	`is_objeù
(
$İtiÚ
)) {

232 
$keys
 = 
	`¬¿y_keys
(
$İtiÚ
->
İtiÚ
);

233 
$key
 = 
	`¬¿y_shiá
(
$keys
);

234 ià(
	`is£t
(
$this
->
İtiÚs
['v®ue'][
$key
])) {

235 
$İtiÚs
[
$id
] = 
$İtiÚ
;

238 ià(
	`is£t
(
$this
->
İtiÚs
['v®ue'][
$id
])) {

239 
$İtiÚs
[
$id
] = 
$İtiÚ
;

242  
$İtiÚs
;

243 
	}
}

245 
funùiÚ
 
	$acû±_expo£d_šput
(
$šput
) {

248 ià(
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

249  
TRUE
;

254 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['single']) && !empty($this->options['expose']['optional']) && !empty($this->options['expose']['limit'])) {

255 
$id’tif›r
 = 
$this
->
İtiÚs
['expose']['identifier'];

256 ià(
$šput
[
$id’tif›r
] == 'All') {

257  
TRUE
;

261  
·»Á
::
	`acû±_expo£d_šput
(
$šput
);

262 
	}
}

264 
funùiÚ
 
	$v®ue_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

274 
$fÜm_¡©e
['v®ues']['İtiÚs']['v®ue'] = 
$fÜm
['value']['#value'];

276 
	}
}

278 
funùiÚ
 
	$admš_summ¬y
() {

279 ià(!
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

280  
	`t
('exposed');

282 
$šfo
 = 
$this
->
	`İ”©Üs
();

284 
$this
->
	`g‘_v®ue_İtiÚs
();

286 ià(!
	`is_¬¿y
(
$this
->
v®ue
)) {

290 
$İ”©Ü
 = 
	`check_¶aš
(
$šfo
[
$this
->
İ”©Ü
]['short']);

291 
$v®ues
 = '';

292 ià(
	`š_¬¿y
(
$this
->
İ”©Ü
, $this->
	`İ”©Ü_v®ues
(1))) {

294 
	`fÜ—ch
 (
$this
->
v®ue
 
as
 
$v®ue
) {

295 ià(!
	`is£t
(
$this
->
v®ue_İtiÚs
[
$v®ue
])) {

296 
	`un£t
(
$this
->
v®ue
[
$v®ue
]);

300 ià(
	`couÁ
(
$this
->
v®ue
) == 0) {

301 
$v®ues
 = 
	`t
('Unknown');

303 ià(
	`couÁ
(
$this
->
v®ue
) == 1) {

305 ià(
	`is£t
(
$šfo
[
$this
->
İ”©Ü
]['short_single'])) {

306 
$İ”©Ü
 = 
	`check_¶aš
(
$šfo
[
$this
->
İ”©Ü
]['short_single']);

309 
$keys
 = 
$this
->
v®ue
;

310 
$v®ue
 = 
	`¬¿y_shiá
(
$keys
);

311 
$v®ues
 = 
	`check_¶aš
(
$this
->
v®ue_İtiÚs
[
$v®ue
]);

314 
	`fÜ—ch
 (
$this
->
v®ue
 
as
 
$v®ue
) {

315 ià(
$v®ues
 !== '') {

316 
$v®ues
 .= ', ';

318 ià(
	`¡¾’
(
$v®ues
) > 8) {

319 
$v®ues
 .= '...';

322 
$v®ues
 .ğ
	`check_¶aš
(
$this
->
v®ue_İtiÚs
[
$v®ue
]);

327  
$İ”©Ü
 . ((
$v®ues
 !== '') ? ' ' . $values : '');

328 
	}
}

330 
funùiÚ
 
	$qu”y
() {

331 
$šfo
 = 
$this
->
	`İ”©Üs
();

332 ià(!
	`em±y
(
$šfo
[
$this
->
İ”©Ü
]['method'])) {

333 
$this
->{
$šfo
[$this->
İ”©Ü
]['method']}();

335 
	}
}

337 
funùiÚ
 
	$İ_sim¶e
() {

338 ià(
	`em±y
(
$this
->
v®ue
)) {

341 
$this
->
	`’su»_my_bË
();

342 
$¶aûhŞd”
 = !
	`em±y
(
$this
->
defš™iÚ
['numeric']) ? '%d' : "'%s'";

344 
$»¶aû
 = 
	`¬¿y_fl
(0, (
$this
->
v®ue
), 
$¶aûhŞd”
);

345 
$š
 = ' (' . 
	`im¶ode
(", ", 
$»¶aû
) . ')';

349 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$this->bË_®Ÿs.$this->»®_f›ld " . $this->
İ”©Ü
 . 
$š
, 
	`¬¿y_v®ues
($this->
v®ue
));

350 
	}
}

352 
funùiÚ
 
	$İ_em±y
() {

353 
$this
->
	`’su»_my_bË
();

354 
$f›ld
 = "$this->table_alias.$this->real_field";

356 ià(
$this
->
İ”©Ü
 == 'empty') {

357 
$İ”©Ü
 = "IS NULL";

360 
$İ”©Ü
 = "IS NOT NULL";

363 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$field $operator");

364 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_many_to_one.inc

1 <?
php


12 şas 
	cv›ws_hªdËr_f‹r_mªy_to_Úe
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_š_İ”©Ü
 {

13 
funùiÚ
 
	$š™
(&
$v›w
, 
$İtiÚs
) {

14 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

15 
$this
->
h–³r
 = 
Ãw
 
	`v›ws_mªy_to_Úe_h–³r
($this);

18 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

19 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

21 
$İtiÚs
['operator']['default'] = 'or';

22 
$İtiÚs
['v®ue']['deçuÉ'] = 
	`¬¿y
();

24  
$İtiÚs
;

25 
	}
}

27 
funùiÚ
 
	$İ”©Üs
() {

28 
$İ”©Üs
 = 
	`¬¿y
(

29 'Ü' => 
	`¬¿y
(

30 't™Ë' => 
	`t
('Is one of'),

31 'shÜt' => 
	`t
('or'),

32 'shÜt_sšgË' => 
	`t
('='),

37 'ªd' => 
	`¬¿y
(

38 't™Ë' => 
	`t
('Is‡ll of'),

39 'shÜt' => 
	`t
('and'),

40 'shÜt_sšgË' => 
	`t
('='),

45 'nÙ' => 
	`¬¿y
(

46 't™Ë' => 
	`t
('Is‚one of'),

47 'shÜt' => 
	`t
('not'),

48 'shÜt_sšgË' => 
	`t
('<>'),

55 ià(!
	`em±y
(
$this
->
defš™iÚ
['allowƒmpty'])) {

56 
$İ”©Üs
 +ğ
	`¬¿y
(

57 'em±y' => 
	`¬¿y
(

58 't™Ë' => 
	`t
('Isƒmpty (NULL)'),

60 'shÜt' => 
	`t
('empty'),

63 'nÙƒm±y' => 
	`¬¿y
(

64 't™Ë' => 
	`t
('Is‚otƒmpty (NOT NULL)'),

66 'shÜt' => 
	`t
('notƒmpty'),

72  
$İ”©Üs
;

73 
	}
}

75 
v¬
 
	g$v®ue_fÜm_ty³
 = 'select';

76 
funùiÚ
 
	$v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

77 
·»Á
::
	`v®ue_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

79 ià(
	`em±y
(
$fÜm_¡©e
['exposed'])) {

80 
$this
->
h–³r
->
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

82 
	}
}

88 
funùiÚ
 
	$’su»_my_bË
() {

90 
$šfo
 = 
$this
->
	`İ”©Üs
();

91 ià(
	`is£t
(
$šfo
[
$this
->
İ”©Ü
]['ensure_my_table']) && $info[$this->operator]['ensure_my_table'] == 'helper') {

92  
$this
->
h–³r
->
	`’su»_my_bË
();

95  
·»Á
::
	`’su»_my_bË
();

96 
	}
}

98 
funùiÚ
 
	$İ_h–³r
() {

99 ià(
	`em±y
(
$this
->
v®ue
)) {

102 
$this
->
h–³r
->
	`add_f‹r
();

103 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_numeric.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_num”ic
 
ex‹nds
 
	mv›ws_hªdËr_f‹r
 {

8 
v¬
 
	m$no_sšgË
 = 
TRUE
;

9 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

10 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

12 
$İtiÚs
['v®ue'] = 
	`¬¿y
(

13 'cÚšs' => 
	`¬¿y
(

14 'mš' => 
	`¬¿y
('default' => ''),

15 'max' => 
	`¬¿y
('default' => ''),

16 'v®ue' => 
	`¬¿y
('default' => ''),

20  
$İtiÚs
;

23 
funùiÚ
 
	$İ”©Üs
() {

24 
$İ”©Üs
 = 
	`¬¿y
(

25 '<' => 
	`¬¿y
(

26 't™Ë' => 
	`t
('Is†esshan'),

28 'shÜt' => 
	`t
('<'),

31 '<=' => 
	`¬¿y
(

32 't™Ë' => 
	`t
('Is†esshan orƒqualo'),

34 'shÜt' => 
	`t
('<='),

37 '=' => 
	`¬¿y
(

38 't™Ë' => 
	`t
('Isƒqualo'),

40 'shÜt' => 
	`t
('='),

43 '!=' => 
	`¬¿y
(

44 't™Ë' => 
	`t
('Is‚otƒqualo'),

46 'shÜt' => 
	`t
('!='),

49 '>=' => 
	`¬¿y
(

50 't™Ë' => 
	`t
('Is greaterhan orƒqualo'),

52 'shÜt' => 
	`t
('>='),

55 '>' => 
	`¬¿y
(

56 't™Ë' => 
	`t
('Is greaterhan'),

58 'shÜt' => 
	`t
('>'),

61 'b‘w“n' => 
	`¬¿y
(

62 't™Ë' => 
	`t
('Is between'),

64 'shÜt' => 
	`t
('between'),

67 'nÙ b‘w“n' => 
	`¬¿y
(

68 't™Ë' => 
	`t
('Is‚ot between'),

70 'shÜt' => 
	`t
('not between'),

76 ià(!
	`em±y
(
$this
->
defš™iÚ
['allowƒmpty'])) {

77 
$İ”©Üs
 +ğ
	`¬¿y
(

78 'em±y' => 
	`¬¿y
(

79 't™Ë' => 
	`t
('Isƒmpty (NULL)'),

81 'shÜt' => 
	`t
('empty'),

84 'nÙƒm±y' => 
	`¬¿y
(

85 't™Ë' => 
	`t
('Is‚otƒmpty (NOT NULL)'),

87 'shÜt' => 
	`t
('notƒmpty'),

93  
$İ”©Üs
;

94 
	}
}

99 
funùiÚ
 
İ”©Ü_İtiÚs
(
$which
 = 'title') {

100 
$İtiÚs
 = 
¬¿y
();

101 
fÜ—ch
 (
$this
->
İ”©Üs
(è
as
 
$id
 => 
$šfo
) {

102 
$İtiÚs
[
$id
] = 
$šfo
[
$which
];

105  
	g$İtiÚs
;

108 
funùiÚ
 
	$İ”©Ü_v®ues
(
$v®ues
 = 1) {

109 
$İtiÚs
 = 
	`¬¿y
();

110 
	`fÜ—ch
 (
$this
->
	`İ”©Üs
(è
as
 
$id
 => 
$šfo
) {

111 ià(
$šfo
['v®ues'] =ğ
$v®ues
) {

112 
$İtiÚs
[] = 
$id
;

116  
$İtiÚs
;

117 
	}
}

121 
funùiÚ
 
	$v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

122 
$fÜm
['v®ue']['#Œ“'] = 
TRUE
;

128 
$which
 = 'all';

129 ià(!
	`em±y
(
$fÜm
['operator'])) {

130 
$sourû
 = (
$fÜm
['operator']['#type'] == 'radios') ? 'radio:options[operator]' : 'edit-options-operator';

133 ià(!
	`em±y
(
$fÜm_¡©e
['exposed'])) {

134 
$id’tif›r
 = 
$this
->
İtiÚs
['expose']['identifier'];

136 ià(
	`em±y
(
$this
->
İtiÚs
['expose']['use_operator']) ||ƒmpty($this->options['expose']['operator'])) {

138 
$which
 = 
	`š_¬¿y
(
$this
->
İ”©Ü
, $this->
	`İ”©Ü_v®ues
(2)) ? 'minmax' : 'value';

141 
$sourû
 = 'ed™-' . 
	`fÜm_ş—n_id
(
$this
->
İtiÚs
['expose']['operator']);

145 ià(
$which
 == 'all') {

146 
$fÜm
['v®ue']['v®ue'] = 
	`¬¿y
(

148 '#t™Ë' => 
	`em±y
(
$fÜm_¡©e
['expo£d']è? 
	`t
('Value') : '',

150 '#deçuÉ_v®ue' => 
$this
->
v®ue
['value'],

151 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

152 '#d•’d’cy' => 
	`¬¿y
(
$sourû
 => 
$this
->
	`İ”©Ü_v®ues
(1)),

154 ià(!
	`em±y
(
$fÜm_¡©e
['expo£d']è&& !
	`is£t
($fÜm_¡©e['šput'][
$id’tif›r
]['value'])) {

155 
$fÜm_¡©e
['šput'][
$id’tif›r
]['v®ue'] = 
$this
->
v®ue
['value'];

158 ià(
$which
 == 'value') {

161 
$fÜm
['v®ue'] = 
	`¬¿y
(

163 '#t™Ë' => 
	`em±y
(
$fÜm_¡©e
['expo£d']è? 
	`t
('Value') : '',

165 '#deçuÉ_v®ue' => 
$this
->
v®ue
['value'],

167 ià(!
	`em±y
(
$fÜm_¡©e
['expo£d']è&& !
	`is£t
($fÜm_¡©e['šput'][
$id’tif›r
])) {

168 
$fÜm_¡©e
['šput'][
$id’tif›r
] = 
$this
->
v®ue
['value'];

172 ià(
$which
 == 'all' || $which == 'minmax') {

173 
$fÜm
['v®ue']['mš'] = 
	`¬¿y
(

175 '#t™Ë' => 
	`em±y
(
$fÜm_¡©e
['expo£d']è? 
	`t
('Min') : '',

177 '#deçuÉ_v®ue' => 
$this
->
v®ue
['min'],

179 
$fÜm
['v®ue']['max'] = 
	`¬¿y
(

181 '#t™Ë' => 
	`em±y
(
$fÜm_¡©e
['expo£d']è? 
	`t
('And max') :('And'),

183 '#deçuÉ_v®ue' => 
$this
->
v®ue
['max'],

185 ià(
$which
 == 'all') {

186 
$d•’d’cy
 = 
	`¬¿y
(

187 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

188 '#d•’d’cy' => 
	`¬¿y
(
$sourû
 => 
$this
->
	`İ”©Ü_v®ues
(2)),

190 
$fÜm
['v®ue']['mš'] +ğ
$d•’d’cy
;

191 
$fÜm
['v®ue']['max'] +ğ
$d•’d’cy
;

193 ià(!
	`em±y
(
$fÜm_¡©e
['expo£d']è&& !
	`is£t
($fÜm_¡©e['šput'][
$id’tif›r
]['min'])) {

194 
$fÜm_¡©e
['šput'][
$id’tif›r
]['mš'] = 
$this
->
v®ue
['min'];

196 ià(!
	`em±y
(
$fÜm_¡©e
['expo£d']è&& !
	`is£t
($fÜm_¡©e['šput'][
$id’tif›r
]['max'])) {

197 
$fÜm_¡©e
['šput'][
$id’tif›r
]['max'] = 
$this
->
v®ue
['max'];

200 ià(!
	`is£t
(
$fÜm
['value'])) {

202 
$fÜm
['v®ue'] = 
	`¬¿y
(

204 '#v®ue' => 
NULL


208 
	}
}

210 
funùiÚ
 
	$qu”y
() {

211 
$this
->
	`’su»_my_bË
();

212 
$f›ld
 = "$this->table_alias.$this->real_field";

214 
$šfo
 = 
$this
->
	`İ”©Üs
();

215 ià(!
	`em±y
(
$šfo
[
$this
->
İ”©Ü
]['method'])) {

216 
$this
->{
$šfo
[$this->
İ”©Ü
]['m‘hod']}(
$f›ld
);

218 
	}
}

220 
funùiÚ
 
	$İ_b‘w“n
(
$f›ld
) {

221 ià(
$this
->
İ”©Ü
 == 'between') {

222 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$f›ld >ğ%d", $this->
v®ue
['min']);

223 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$f›ld <ğ%d", $this->
v®ue
['max']);

226 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$f›ld <ğ%d OR $f›ld >ğ%d", $this->
v®ue
['min'], $this->value['max']);

228 
	}
}

230 
funùiÚ
 
	$İ_sim¶e
(
$f›ld
) {

231 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$f›ld $this->İ”©Ü %d", $this->
v®ue
['value']);

232 
	}
}

234 
funùiÚ
 
	$İ_em±y
(
$f›ld
) {

235 ià(
$this
->
İ”©Ü
 == 'empty') {

236 
$İ”©Ü
 = "IS NULL";

239 
$İ”©Ü
 = "IS NOT NULL";

242 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$field $operator");

243 
	}
}

245 
funùiÚ
 
	$admš_summ¬y
() {

246 ià(!
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

247  
	`t
('exposed');

250 
$İtiÚs
 = 
$this
->
	`İ”©Ü_İtiÚs
('short');

251 
$ouut
 = 
	`check_¶aš
(
$İtiÚs
[
$this
->
İ”©Ü
]);

252 ià(
	`š_¬¿y
(
$this
->
İ”©Ü
, $this->
	`İ”©Ü_v®ues
(2))) {

253 
$ouut
 .ğ' ' . 
	`t
('@mš‡nd @max', 
	`¬¿y
('@mš' => 
$this
->
v®ue
['min'], '@max' => $this->value['max']));

255 
	`–£if
 (
	`š_¬¿y
(
$this
->
İ”©Ü
, $this->
	`İ”©Ü_v®ues
(1))) {

256 
$ouut
 .ğ' ' . 
	`check_¶aš
(
$this
->
v®ue
['value']);

258  
$ouut
;

259 
	}
}

264 
funùiÚ
 
	$acû±_expo£d_šput
(
$šput
) {

265 ià(
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

266  
TRUE
;

271 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['identifier'])) {

272 
$v®ue
 = &
$šput
[
$this
->
İtiÚs
['expose']['identifier']];

273 ià(!
	`is_¬¿y
(
$v®ue
)) {

274 
$v®ue
 = 
	`¬¿y
(

275 'v®ue' => 
$v®ue
,

280 
$rc
 = 
·»Á
::
	`acû±_expo£d_šput
(
$šput
);

282 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['optional'])) {

284 
$šfo
 = 
$this
->
	`İ”©Üs
();

285 ià(!
	`em±y
(
$šfo
[
$this
->
İ”©Ü
]['values'])) {

286 
$šfo
[
$this
->
İ”©Ü
]['values']) {

288 ià(
$v®ue
['value'] === '') {

289  
FALSE
;

293 ià(
$v®ue
['min'] === '' && $value['max'] === '') {

294  
FALSE
;

301  
$rc
;

302 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_string.inc

1 <?
php


8 şas 
	cv›ws_hªdËr_f‹r_¡ršg
 
ex‹nds
 
	mv›ws_hªdËr_f‹r
 {

10 
v¬
 
	m$no_sšgË
 = 
TRUE
;

12 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

13 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

15 
$İtiÚs
['ÿ£'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

17  
$İtiÚs
;

25 
funùiÚ
 
	$İ”©Üs
() {

26 
$İ”©Üs
 = 
	`¬¿y
(

27 '=' => 
	`¬¿y
(

28 't™Ë' => 
	`t
('Isƒqualo'),

29 'shÜt' => 
	`t
('='),

33 '!=' => 
	`¬¿y
(

34 't™Ë' => 
	`t
('Is‚otƒqualo'),

35 'shÜt' => 
	`t
('!='),

39 'cÚšs' => 
	`¬¿y
(

40 't™Ë' => 
	`t
('Contains'),

41 'shÜt' => 
	`t
('contains'),

45 'wÜd' => 
	`¬¿y
(

46 't™Ë' => 
	`t
('Contains‡ny word'),

47 'shÜt' => 
	`t
('has word'),

51 '®lwÜds' => 
	`¬¿y
(

52 't™Ë' => 
	`t
('Contains‡ll words'),

53 'shÜt' => 
	`t
('has‡ll'),

57 '¡¬ts' => 
	`¬¿y
(

58 't™Ë' => 
	`t
('Starts with'),

59 'shÜt' => 
	`t
('begins'),

63 'nÙ_¡¬ts' => 
	`¬¿y
(

64 't™Ë' => 
	`t
('Does‚ot start with'),

65 'shÜt' => 
	`t
('not_begins'),

69 '’ds' => 
	`¬¿y
(

70 't™Ë' => 
	`t
('Ends with'),

71 'shÜt' => 
	`t
('ends'),

75 'nÙ_’ds' => 
	`¬¿y
(

76 't™Ë' => 
	`t
('Does‚otƒnd with'),

77 'shÜt' => 
	`t
('not_ends'),

81 'nÙ' => 
	`¬¿y
(

82 't™Ë' => 
	`t
('Does‚ot contain'),

83 'shÜt' => 
	`t
('!has'),

89 ià(!
	`em±y
(
$this
->
defš™iÚ
['allowƒmpty'])) {

90 
$İ”©Üs
 +ğ
	`¬¿y
(

91 'em±y' => 
	`¬¿y
(

92 't™Ë' => 
	`t
('Isƒmpty (NULL)'),

94 'shÜt' => 
	`t
('empty'),

97 'nÙƒm±y' => 
	`¬¿y
(

98 't™Ë' => 
	`t
('Is‚otƒmpty (NOT NULL)'),

100 'shÜt' => 
	`t
('notƒmpty'),

106  
$İ”©Üs
;

107 
	}
}

112 
funùiÚ
 
İ”©Ü_İtiÚs
(
$which
 = 'title') {

113 
$İtiÚs
 = 
¬¿y
();

114 
fÜ—ch
 (
$this
->
İ”©Üs
(è
as
 
$id
 => 
$šfo
) {

115 
$İtiÚs
[
$id
] = 
$šfo
[
$which
];

118  
	g$İtiÚs
;

121 
funùiÚ
 
	$admš_summ¬y
() {

122 ià(!
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

123  
	`t
('exposed');

126 
$İtiÚs
 = 
$this
->
	`İ”©Ü_İtiÚs
('short');

127 
$ouut
 = 
	`check_¶aš
(
$İtiÚs
[
$this
->
İ”©Ü
]);

128 ià(
	`š_¬¿y
(
$this
->
İ”©Ü
, $this->
	`İ”©Ü_v®ues
(1))) {

129 
$ouut
 .ğ' ' . 
	`check_¶aš
(
$this
->
v®ue
);

131  
$ouut
;

132 
	}
}

134 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

135 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

136 
$fÜm
['ÿ£'] = 
	`¬¿y
(

138 '#t™Ë' => 
	`t
('Case sensitive'),

139 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['case'],

140 '#desütiÚ' => 
	`t
('Case sensitive filters may be faster. MySQL might ignore case sensitivity.'),

142 
	}
}

144 
funùiÚ
 
	$İ”©Ü_v®ues
(
$v®ues
 = 1) {

145 
$İtiÚs
 = 
	`¬¿y
();

146 
	`fÜ—ch
 (
$this
->
	`İ”©Üs
(è
as
 
$id
 => 
$šfo
) {

147 ià(
	`is£t
(
$šfo
['v®ues']è&& $šfo['v®ues'] =ğ
$v®ues
) {

148 
$İtiÚs
[] = 
$id
;

152  
$İtiÚs
;

153 
	}
}

158 
funùiÚ
 
	$v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

163 
$which
 = 'all';

164 ià(!
	`em±y
(
$fÜm
['operator'])) {

165 
$sourû
 = (
$fÜm
['operator']['#type'] == 'radios') ? 'radio:options[operator]' : 'edit-options-operator';

167 ià(!
	`em±y
(
$fÜm_¡©e
['exposed'])) {

168 
$id’tif›r
 = 
$this
->
İtiÚs
['expose']['identifier'];

170 ià(
	`em±y
(
$this
->
İtiÚs
['expose']['use_operator']) ||ƒmpty($this->options['expose']['operator'])) {

172 
$which
 = 
	`š_¬¿y
(
$this
->
İ”©Ü
, $this->
	`İ”©Ü_v®ues
(1)) ? 'value' : 'none';

175 
$sourû
 = 'ed™-' . 
	`fÜm_ş—n_id
(
$this
->
İtiÚs
['expose']['operator']);

179 ià(
$which
 == 'all' || $which == 'value') {

180 
$fÜm
['v®ue'] = 
	`¬¿y
(

182 '#t™Ë' => 
	`t
('Value'),

184 '#deçuÉ_v®ue' => 
$this
->
v®ue
,

186 ià(!
	`em±y
(
$fÜm_¡©e
['expo£d']è&& !
	`is£t
($fÜm_¡©e['šput'][
$id’tif›r
])) {

187 
$fÜm_¡©e
['šput'][
$id’tif›r
] = 
$this
->
v®ue
;

190 ià(
$which
 == 'all') {

191 
$fÜm
['v®ue'] +ğ
	`¬¿y
(

192 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

193 '#d•’d’cy' => 
	`¬¿y
(
$sourû
 => 
$this
->
	`İ”©Ü_v®ues
(1)),

198 ià(!
	`is£t
(
$fÜm
['value'])) {

200 
$fÜm
['v®ue'] = 
	`¬¿y
(

202 '#v®ue' => 
NULL


205 
	}
}

207 
funùiÚ
 
	$ÿ£_ŒªsfÜm
() {

208  !
	`em±y
(
$this
->
İtiÚs
['case']) ? '' : 'UPPER';

209 
	}
}

218 
funùiÚ
 
	$qu”y
() {

219 
$this
->
	`’su»_my_bË
();

220 
$f›ld
 = "$this->table_alias.$this->real_field";

221 
$uµ”
 = 
$this
->
	`ÿ£_ŒªsfÜm
();

223 
$šfo
 = 
$this
->
	`İ”©Üs
();

224 ià(!
	`em±y
(
$šfo
[
$this
->
İ”©Ü
]['method'])) {

225 
$this
->{
$šfo
[$this->
İ”©Ü
]['m‘hod']}(
$f›ld
, 
$uµ”
);

227 
	}
}

229 
funùiÚ
 
	$İ_equ®
(
$f›ld
, 
$uµ”
) {

231 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$uµ”($f›ldè$this->İ”©Ü $uµ”('%s')", $this->
v®ue
);

232 
	}
}

234 
funùiÚ
 
	$İ_cÚšs
(
$f›ld
, 
$uµ”
) {

235 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$uµ”($f›ldèLIKE $uµ”('%%%s%%')", $this->
v®ue
);

236 
	}
}

238 
funùiÚ
 
	$İ_wÜd
(
$f›ld
, 
$uµ”
) {

239 
$wh”e
 = 
	`¬¿y
();

240 
	`´eg_m©ch_®l
('/ (-?)("[^"]+"|[^" ]+)/i', ' ' . 
$this
->
v®ue
, 
$m©ches
, 
PREG_SET_ORDER
);

241 
	`fÜ—ch
 (
$m©ches
 
as
 
$m©ch
) {

242 
$ph¿£
 = 
çl£
;

244 ià(
$m©ch
[2]{0} == '"') {

245 
$m©ch
[2] = 
	`sub¡r
($match[2], 1, -1);

246 
$ph¿£
 = 
Œue
;

248 
$wÜds
 = 
	`Œim
(
$m©ch
[2], ',?!();:-');

249 
$wÜds
 = 
$ph¿£
 ? 
	`¬¿y
($wÜdsè: 
	`´eg_¥l™
('/ /', $wÜds, -1, 
PREG_SPLIT_NO_EMPTY
);

250 
	`fÜ—ch
 (
$wÜds
 
as
 
$wÜd
) {

251 
$wh”e
[] = "$upper($field) LIKE $upper('%%%s%%')";

252 
$v®ues
[] = 
	`Œim
(
$wÜd
, " ,!?");

256 ià(!
$wh”e
) {

260 ià(
$this
->
İ”©Ü
 == 'word') {

261 
$wh”e
 = '(' . 
	`im¶ode
(' OR ', $where) . ')';

264 
$wh”e
 = 
	`im¶ode
(' AND ', $where);

268 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], 
$wh”e
, 
$v®ues
);

269 
	}
}

271 
funùiÚ
 
	$İ_¡¬ts
(
$f›ld
, 
$uµ”
) {

272 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$uµ”($f›ldèLIKE $uµ”('%s%%')", $this->
v®ue
);

273 
	}
}

275 
funùiÚ
 
	$İ_nÙ_¡¬ts
(
$f›ld
, 
$uµ”
) {

276 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$uµ”($f›ldèNOT LIKE $uµ”('%s%%')", $this->
v®ue
);

277 
	}
}

279 
funùiÚ
 
	$İ_’ds
(
$f›ld
, 
$uµ”
) {

280 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$uµ”($f›ldèLIKE $uµ”('%%%s')", $this->
v®ue
);

281 
	}
}

283 
funùiÚ
 
	$İ_nÙ_’ds
(
$f›ld
, 
$uµ”
) {

284 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$uµ”($f›ldèNOT LIKE $uµ”('%%%s')", $this->
v®ue
);

285 
	}
}

287 
funùiÚ
 
	$İ_nÙ
(
$f›ld
, 
$uµ”
) {

288 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$uµ”($f›ldèNOT LIKE $uµ”('%%%s%%')", $this->
v®ue
);

289 
	}
}

291 
funùiÚ
 
	$İ_em±y
(
$f›ld
) {

292 ià(
$this
->
İ”©Ü
 == 'empty') {

293 
$İ”©Ü
 = "IS NULL";

296 
$İ”©Ü
 = "IS NOT NULL";

299 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$field $operator");

300 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_relationship.inc

1 <?
php


36 şas 
	cv›ws_hªdËr_»ÏtiÚsh
 
ex‹nds
 
	mv›ws_hªdËr
 {

41 
funùiÚ
 
	$š™
(&
$v›w
, 
$İtiÚs
) {

42 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

43 ià(
	`is£t
(
$this
->
defš™iÚ
['relationshipable'])) {

44 
$this
->
bË
 = $this->
defš™iÚ
['relationshipable'];

46 ià(
	`is£t
(
$this
->
defš™iÚ
['relationship field'])) {

47 
$this
->
f›ld
 = $this->
defš™iÚ
['relationship field'];

54 
funùiÚ
 
	$Ïb–
() {

55 ià(!
	`is£t
(
$this
->
İtiÚs
['label'])) {

56  
$this
->
	`ui_Çme
();

58  
$this
->
İtiÚs
['label'];

59 
	}
}

61 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

62 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

64 
$Ïb–
 = !
	`em±y
(
$this
->
defš™iÚ
['label']) ? $this->definition['label'] : $this->definition['field'];

65 
$İtiÚs
['Ïb–'] = 
	`¬¿y
('deçuÉ' => 
$Ïb–
, 'Œª¦©abË' => 
TRUE
);

66 
$İtiÚs
['»quœed'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

68  
$İtiÚs
;

69 
	}
}

75 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

76 
$fÜm
['Ïb–'] = 
	`¬¿y
(

78 '#t™Ë' => 
	`t
('Label'),

79 '#deçuÉ_v®ue' => 
	`is£t
(
$this
->
İtiÚs
['label']) ? $this->options['label'] : '',

80 '#desütiÚ' => 
	`t
('The†abel forhis„elationshiphat will be displayed only‡dministratively.'),

83 
$fÜm
['»quœed'] = 
	`¬¿y
(

85 '#t™Ë' => 
	`t
('Requirehis„elationship'),

86 '#desütiÚ' => 
	`t
('If„equired, itemshat do‚ot containhis„elationship will‚ot‡ppear.'),

87 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['required']),

89 
	}
}

94 
funùiÚ
 
	$qu”y
() {

96 
$bË_d©a
 = 
	`v›ws_ãtch_d©a
(
$this
->
defš™iÚ
['base']);

97 
$ba£_f›ld
 = 
	`em±y
(
$this
->
defš™iÚ
['ba£ f›ld']è? 
$bË_d©a
['table']['base']['field'] : $this->definition['base field'];

99 
$this
->
	`’su»_my_bË
();

101 
$def
 = 
$this
->
defš™iÚ
;

102 
$def
['bË'] = 
$this
->
defš™iÚ
['base'];

103 
$def
['f›ld'] = 
$ba£_f›ld
;

104 
$def
['Ëá_bË'] = 
$this
->
bË_®Ÿs
;

105 
$def
['Ëá_f›ld'] = 
$this
->
f›ld
;

106 ià(!
	`em±y
(
$this
->
İtiÚs
['required'])) {

107 
$def
['type'] = 'INNER';

110 ià(!
	`em±y
(
$def
['još_hªdËr']è&& 
	`şass_exi¡s
($def['join_handler'])) {

111 
$još
 = 
Ãw
 
$def
['join_handler'];

114 
$još
 = 
Ãw
 
	`v›ws_još
();

117 
$još
->
defš™iÚ
 = 
$def
;

118 
$još
->
	`cÚ¡ruù
();

119 
$još
->
adju¡ed
 = 
TRUE
;

122 
$®Ÿs
 = 
$def
['bË'] . '_' . 
$this
->
bË
;

124 
$this
->
®Ÿs
 = $this->
qu”y
->
	`add_»ÏtiÚsh
(
$®Ÿs
, 
$još
, $this->
defš™iÚ
['ba£'], $this->
»ÏtiÚsh
);

125 
	}
}

131 şas 
	cv›ws_hªdËr_»ÏtiÚsh_brok’
 
ex‹nds
 
	mv›ws_hªdËr_»ÏtiÚsh
 {

132 
funùiÚ
 
	$ui_Çme
(
$shÜt
 = 
FALSE
) {

133  
	`t
('Broken/missing handler');

136 
funùiÚ
 
	$’su»_my_bË
(è{ 
	}
}

137 
funùiÚ
 
	$qu”y
(è{ 
	}
}

138 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

139 
$fÜm
['m¬kup'] = 
	`¬¿y
(

141 '#v®ue' => 
	`t
('The handler forhis item is broken or missing‡nd cannot be used. If‡ module…rovidedhe handler‡nd was disabled,„e-enablinghe module may„estore it. Otherwise, you should…robably deletehis item.'),

143 
	}
}

148 
funùiÚ
 
	$brok’
(è{  
TRUE
; 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_sort.inc

1 <?
php


12 şas 
	cv›ws_hªdËr_sÜt
 
ex‹nds
 
	mv›ws_hªdËr
 {

16 
funùiÚ
 
	$qu”y
() {

17 
$this
->
	`’su»_my_bË
();

19 
$this
->
qu”y
->
	`add_Üd”by
($this->
bË_®Ÿs
, $this->
»®_f›ld
, $this->
İtiÚs
['order']);

22 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

23 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

25 
$İtiÚs
['Üd”'] = 
	`¬¿y
('default' => 'ASC');

27  
$İtiÚs
;

28 
	}
}

33 
funùiÚ
 
	$admš_summ¬y
() {

34 
$this
->
İtiÚs
['order']) {

38 
$ty³
 = 
	`t
('asc');

42 
$ty³
 = 
	`t
('desc');

45  '<¥ª cÏss="v›ws-asûndšg"><¥ª>' . 
$ty³
 . '</span></span>';

46 
	}
}

51 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

52 
$fÜm
['Üd”'] = 
	`¬¿y
(

54 '#t™Ë' => 
	`t
('Sort order'),

55 '#İtiÚs' => 
	`¬¿y
('ASC' => 
	`t
('Ascending'), 'DESC' =>('Descending')),

56 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['order'],

58 
	}
}

64 şas 
	cv›ws_hªdËr_sÜt_brok’
 
ex‹nds
 
	mv›ws_hªdËr_sÜt
 {

65 
funùiÚ
 
	$ui_Çme
(
$shÜt
 = 
FALSE
) {

66  
	`t
('Broken/missing handler');

69 
funùiÚ
 
	$’su»_my_bË
(è{ 
	}
}

70 
funùiÚ
 
	$qu”y
(è{ 
	}
}

71 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

72 
$fÜm
['m¬kup'] = 
	`¬¿y
(

74 '#v®ue' => 
	`t
('The handler forhis item is broken or missing‡nd cannot be used. If‡ module…rovidedhe handler‡nd was disabled,„e-enablinghe module may„estore it. Otherwise, you should…robably deletehis item.'),

76 
	}
}

81 
funùiÚ
 
	$brok’
(è{  
TRUE
; 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_sort_date.inc

1 <?
php


12 şas 
	cv›ws_hªdËr_sÜt_d©e
 
ex‹nds
 
	mv›ws_hªdËr_sÜt
 {

13 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

14 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

16 
$İtiÚs
['g¿nuÏr™y'] = 
	`¬¿y
('default' => 'second');

18  
$İtiÚs
;

21 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

22 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

24 
$fÜm
['g¿nuÏr™y'] = 
	`¬¿y
(

26 '#t™Ë' => 
	`t
('Granularity'),

27 '#İtiÚs' => 
	`¬¿y
(

28 '£cÚd' => 
	`t
('Second'),

29 'mšu‹' => 
	`t
('Minute'),

30 'hour' => 
	`t
('Hour'),

31 'day' => 
	`t
('Day'),

32 'mÚth' => 
	`t
('Month'),

33 'y—r' => 
	`t
('Year'),

35 '#desütiÚ' => 
	`t
('The granularity ishe smallest unito use when determining whetherwo dates‡rehe same; forƒxample, ifhe granularity is "Year"hen‡ll dates in 1999,„egardless of whenhey fall in 1999, will be consideredhe same date.'),

36 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['granularity'],

38 
	}
}

43 
funùiÚ
 
	$qu”y
() {

44 
$this
->
	`’su»_my_bË
();

45 
$this
->
İtiÚs
['granularity']) {

48 
$this
->
qu”y
->
	`add_Üd”by
($this->
bË_®Ÿs
, $this->
»®_f›ld
, $this->
İtiÚs
['order']);

51 
$fÜmuÏ
 = 
	`v›ws_d©e_sql_fÜm©
('YmdHi', "$this->table_alias.$this->real_field");

54 
$fÜmuÏ
 = 
	`v›ws_d©e_sql_fÜm©
('YmdH', "$this->table_alias.$this->real_field");

57 
$fÜmuÏ
 = 
	`v›ws_d©e_sql_fÜm©
('Ymd', "$this->table_alias.$this->real_field");

60 
$fÜmuÏ
 = 
	`v›ws_d©e_sql_fÜm©
('Ym', "$this->table_alias.$this->real_field");

63 
$fÜmuÏ
 = 
	`v›ws_d©e_sql_fÜm©
('Y', "$this->table_alias.$this->real_field");

68 
$this
->
qu”y
->
	`add_Üd”by
(
NULL
, 
$fÜmuÏ
, $this->
İtiÚs
['Üd”'], $this->
bË_®Ÿs
 . '_' . $this->
f›ld
 . '_' . $this->options['granularity']);

69 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_sort_formula.inc

1 <?
php


17 şas 
	cv›ws_hªdËr_sÜt_fÜmuÏ
 
ex‹nds
 
	mv›ws_hªdËr_sÜt
 {

21 
funùiÚ
 
	$cÚ¡ruù
() {

22 
$this
->
fÜmuÏ
 = $this->
defš™iÚ
['formula'];

23 ià(
	`is_¬¿y
(
$this
->
fÜmuÏ
è&& !
	`is£t
($this->formula['default'])) {

24 
$this
->
”rÜ
 = 
	`t
('v›ws_hªdËr_sÜt_fÜmuÏ missšg deçuÉ: @fÜmuÏ', 
	`¬¿y
('@fÜmuÏ' => 
	`v¬_expÜt
($this->
fÜmuÏ
, 
TRUE
)));

26 
·»Á
::
	`cÚ¡ruù
();

31 
funùiÚ
 
	$qu”y
() {

32 ià(
	`is_¬¿y
(
$this
->
fÜmuÏ
)) {

33 
glob®
 
$db_ty³
;

34 ià(
	`is£t
(
$this
->
fÜmuÏ
[
$db_ty³
])) {

35 
$fÜmuÏ
 = 
$this
->
fÜmuÏ
[
$db_ty³
];

38 
$fÜmuÏ
 = 
$this
->
fÜmuÏ
['default'];

42 
$fÜmuÏ
 = 
$this
->
fÜmuÏ
;

44 
$this
->
	`’su»_my_bË
();

46 
$this
->
qu”y
->
	`add_Üd”by
(
NULL
, 
$fÜmuÏ
, $this->
İtiÚs
['Üd”'], $this->
bË_®Ÿs
 . '_' . $this->
f›ld
);

47 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_sort_menu_hierarchy.inc

1 <?
php


12 şas 
	cv›ws_hªdËr_sÜt_m’u_h›¿rchy
 
ex‹nds
 
	mv›ws_hªdËr_sÜt
 {

13 
funùiÚ
 
	$qu”y
() {

14 
$this
->
	`’su»_my_bË
();

15 
$max_d•th
 = 
	`is£t
(
$this
->
defš™iÚ
['max d•th']è? $this->defš™iÚ['max d•th'] : 
MENU_MAX_DEPTH
;

16 
$i
 = 1; $˜<ğ
$max_d•th
; ++$i) {

17 
$this
->
qu”y
->
	`add_Üd”by
($this->
bË_®Ÿs
, $this->
f›ld
 . 
$i
, $this->
İtiÚs
['order']);

20 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_sort_random.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_sÜt_¿ndom
 
ex‹nds
 
	mv›ws_hªdËr_sÜt
 {

8 
funùiÚ
 
	$qu”y
() {

9 
glob®
 
$db_ty³
;

10 
$db_ty³
) {

13 
$fÜmuÏ
 = 'RAND()';

16 
$fÜmuÏ
 = 'RANDOM()';

19 ià(!
	`em±y
(
$fÜmuÏ
)) {

20 
$this
->
qu”y
->
	`add_Üd”by
(
NULL
, 
$fÜmuÏ
, $this->
İtiÚs
['Üd”'], '_' . $this->
f›ld
);

24 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

25 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

26 
$fÜm
['Üd”']['#acûss'] = 
FALSE
;

27 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/admin.inc

1 <?
php


11 
funùiÚ
 
	$v›ws_ui_li¡_v›ws
(
$¬g
 = 
NULL
) {

12 ià(
$¬g
 !ğ
NULL
) {

13  
	`dru·l_nÙ_found
();

16 
$ouut
 = 
	`theme
('views_ui_list_views');

17 
	`v›ws_ui_check_advªûd_h–p
();

18  
$ouut
;

19 
	}
}

28 
funùiÚ
 
	$v›ws_ui_check_advªûd_h–p
() {

29 ià(
	`v¬ŸbË_g‘
('v›ws_hide_h–p_mes§ge', 
FALSE
)) {

33 ià(!
	`moduË_exi¡s
('advanced_help')) {

34 
$f’ame
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT filename FROM {system} WHEREype = 'module' AND‚ame = 'advanced_help'"));

35 ià(
$f’ame
 && 
	`fe_exi¡s
($filename)) {

36 
	`dru·l_£t_mes§ge
(
	`t
('Iàyou <¨h»f="@moduËs">’abËhadvªûd h–°moduË</a>, V›w wÈ´ovidmÜªd b‘‹¸h–p. <¨h»f="@hide">Hidthi mes§ge.</a>', 
	`¬¿y
('@moduËs' => 
	`u¾
('admin/build/modules'),'@hide' => url('admin/build/views/tools'))));

39 
	`dru·l_£t_mes§ge
(
	`t
('Iàyou in¡®Èthadvªûd h–°moduË from !h»f, V›w wÈ´ovidmÜªd b‘‹¸h–p. <¨h»f="@hide">Hidthi mes§ge.</a>', 
	`¬¿y
('!h»f' => 
	`l
('h‰p://dru·l.Üg/´ojeù/advªûd_h–p', 'h‰p://dru·l.Üg/´ojeù/advªûd_h–p'), '@hide' => 
	`u¾
('admin/build/views/tools'))));

42 
	}
}

47 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_ui_li¡_v›ws
(&
$v¬s
) {

48 
$™ems
 = 
	`¬¿y
();

49 
$sÜts
 = 
	`¬¿y
();

51 
$v›ws
 = 
	`v›ws_g‘_®l_v›ws
();

53 
$tok’_’abË
 = 
	`dru·l_g‘_tok’
('views-enable');

54 
$tok’_di§bË
 = 
	`dru·l_g‘_tok’
('views-disable');

58 ià(
	`is£t
(
$_GET
['İ']è&& $_GET['İ'] =ğ
	`t
('Reset')) {

59 
	`un£t
(
$_SESSION
['views']['#admin']);

60 
	`dru·l_gÙo
('admin/build/views');

62 ià(
	`couÁ
(
$_GET
) <= 1) {

63 ià(
	`is£t
(
$_SESSION
['v›ws']['#admš']è&& 
	`is_¬¿y
($_SESSION['views']['#admin'])) {

64 
$_GET
 +ğ
$_SESSION
['views']['#admin'];

68 
$_SESSION
['v›ws']['#admš'] = 
$_GET
;

69 
	`un£t
(
$_SESSION
['views']['#admin']['q']);

72 
$fÜm_¡©e
 = 
	`¬¿y
(

73 'v›ws' => 
$v›ws
,

74 'šput' => 
$_GET
,

76 '»»nd”' => 
TRUE
,

77 'no_»dœeù' => 
TRUE
,

80 
$v¬s
['widg‘s'] = 
	`dru·l_bud_fÜm
('v›ws_ui_li¡_v›ws_fÜm', 
$fÜm_¡©e
);

82 
$v¬s
['h–p_ty³_icÚ'] = 
	`theme
('advanced_help_topic', 'views', 'view-type');

84 
$ba£_bËs
 = 
	`v›ws_ãtch_ba£_bËs
();

86 
	`fÜ—ch
 (
$v›ws
 
as
 
$v›w
) {

87 ià(
$fÜm_¡©e
['values']['tag'] != 'all') {

88 ià(
$fÜm_¡©e
['values']['tag'] == 'none') {

89 ià(!
	`em±y
(
$v›w
->
g
)) {

93 ià(
$fÜm_¡©e
['v®ues']['g'] !ğ
$v›w
->
g
) {

97 ià(
$fÜm_¡©e
['v®ues']['ty³'] !ğ'®l' && $fÜm_¡©e['v®ues']['ty³'] !ğ
$v›w
->
ty³
) {

101 ià(
$fÜm_¡©e
['v®ues']['ba£'] !ğ'®l' && $fÜm_¡©e['v®ues']['ba£'] !ğ
$v›w
->
ba£_bË
) {

105 ià(
$fÜm_¡©e
['v®ues']['di¥Ïy'] !ğ'®l' && 
	`em±y
(
$v›w
->
di¥Ïy
[$form_state['values']['display']])) {

109 
$™em
 = 
Ãw
 
	`¡dCÏss
();

110 
$™em
->
İs
 = 
	`¬¿y
();

111 ià(
	`em±y
(
$v›w
->
di§bËd
)) {

112 
$™em
->
İs
[] = 
	`l
(
	`t
('Edit'), "admin/build/views/edit/$view->name");

113 
$™em
->
İs
[] = 
	`l
(
	`t
('Export'), "admin/build/views/export/$view->name");

114 
$™em
->
İs
[] = 
	`l
(
	`t
('Clone'), "admin/build/views/clone/$view->name");

116 ià(
$v›w
->
ty³
 !ğ
	`t
('Default')) {

117 
$‹xt
 = 
$v›w
->
ty³
 =ğ
	`t
('Overridden') ?('Revert') :('Delete');

118 
$™em
->
İs
[] = 
	`l
(
$‹xt
, "admin/build/views/delete/$view->name");

121 ià(
	`em±y
(
$v›w
->
di§bËd
)) {

122 
$™em
->
İs
[] = 
	`l
(
	`t
('Di§bË'), "admš/bud/v›ws/di§bË/$v›w->Çme", 
	`¬¿y
('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
(è. '&tok’=' . 
$tok’_di§bË
));

125 
$™em
->
İs
[] = 
	`l
(
	`t
('EÇbË'), "admš/bud/v›ws/’abË/$v›w->Çme", 
	`¬¿y
('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
(è. '&tok’=' . 
$tok’_’abË
));

129 
$™em
->
İs
 = 
	`im¶ode
(' | ', $item->ops);

130 ià(
	`em±y
(
$v›w
->
di¥Ïy
)) {

131 
$™em
->
·th
 = 
	`t
('Warning! Broken view!');

134 
$™em
->
·th
 = 
$¿w_·th
 = 
$v›w
->
	`g‘_·th
();

135 
$™em
->
·th
 = $™em->·th && 
	`em±y
(
$v›w
->
di§bËd
è&& 
	`¡½os
($™em->·th, '%'è==ğ
FALSE
 ? 
	`l
($™em->·th, $™em->·thè: 
	`check_¶aš
($item->path);

138 
$™em
->
ty³
 = 
$v›w
->type;

139 
$™em
->
Çme
 = 
$v›w
->name;

141 ià(!
	`em±y
(
$v›w
->
g
)) {

142 
$™em
->
g
 = 
$v›w
->tag;

145 
$™em
->
t™Ë
 = 
$v›w
->
	`g‘_t™Ë
();

146 
$™em
->
ba£
 = !
	`em±y
(
$ba£_bËs
[
$v›w
->
ba£_bË
]['t™Ë']è? $ba£_bËs[$v›w->ba£_bË]['t™Ë'] : 
	`t
('Broken');

148 
$™em
->
di¥Ïys
 = 
	`¬¿y
();

149 
	`fÜ—ch
 (
$v›w
->
di¥Ïy
 
as
 
$di¥Ïy
) {

150 ià(!
	`em±y
(
$di¥Ïy
->
hªdËr
->
defš™iÚ
['admin'])) {

151 
$™em
->
di¥Ïys
[
$di¥Ïy
->
hªdËr
->
defš™iÚ
['admš']] = 
TRUE
;

155 ià(
$™em
->
di¥Ïys
) {

156 
	`ksÜt
(
$™em
->
di¥Ïys
);

157 
$™em
->
di¥Ïys
 = 
	`im¶ode
(', ', 
	`¬¿y_keys
($item->displays));

160 
$™em
->
desütiÚ
 = 
	`check_¶aš
(
$v›w
->description);

161 
$™em
->
şas£s
 = 
	`em±y
(
$v›w
->
di§bËd
) ? 'view-enabled' : 'view-disabled';

162 
$™ems
[] = 
$™em
;

164 
$sÜt
 = 
	`štv®
(
	`em±y
(
$v›w
->
di§bËd
è
xÜ
 
$fÜm_¡©e
['values']['sort'] == 'asc');

166 
$fÜm_¡©e
['values']['order']) {

169 
$sÜt
 .ğ
	`¡¹Şow”
(
$v›w
->
Çme
);

172 
$sÜt
 .ğ
	`¡¹Şow”
(
$™em
->
t™Ë
);

175 
$sÜt
 .ğ
	`¡¹Şow”
(
$¿w_·th
);

178 
$sÜt
 .ğ
$v›w
->
ty³
 . $v›w->
Çme
;

181 
$sÜt
 .ğ
	`¡¹Şow”
(
$v›w
->
g
);

184 
$sÜt
 .ğ
	`¡¹Şow”
(
$v›w
->
desütiÚ
);

188 
$sÜts
[] = 
$sÜt
;

191 ià(
$fÜm_¡©e
['values']['sort'] == 'desc') {

192 
	`¬sÜt
(
$sÜts
);

195 
	`asÜt
(
$sÜts
);

198 
$i
 = 
	`¬¿y
();

199 
	`fÜ—ch
 (
$sÜts
 
as
 
$id
 => 
$t™Ë
) {

200 
$i
[] = 
$™ems
[
$id
];

203 
	`v›ws_add_css
('views-list');

204 
$v¬s
['v›ws'] = 
$i
;

206 
$g‘tšg_¡¬‹d
 = 
	`theme
('advanced_help_topic', 'views', 'getting-started', 'title');

207 ià(!
$g‘tšg_¡¬‹d
) {

208 
$g‘tšg_¡¬‹d
 = 
	`t
('Installhe‡dvanced help module forhe getting started');

211 
$v¬s
['h–p'] = 
	`t
('NÙ su» wh©Ødo? Tryh"!g‘tšg-¡¬‹d"…age.', 
	`¬¿y
('!g‘tšg-¡¬‹d' => 
$g‘tšg_¡¬‹d
));

212 
	}
}

217 
funùiÚ
 
	$v›ws_ui_li¡_v›ws_fÜm
(&
$fÜm_¡©e
) {

218 ià(!
	`v¬ŸbË_g‘
('ş—n_u¾', 
FALSE
)) {

219 
$fÜm
['q'] = 
	`¬¿y
(

221 '#v®ue' => 
$_GET
['q'],

225 
$®l
 = 
	`¬¿y
('®l' => 
	`t
('<All>'));

226 
$nÚe
 = 
	`¬¿y
('nÚe' => 
	`t
('<None>'));

228 
$fÜm
['ty³'] = 
	`¬¿y
(

230 '#t™Ë' => 
	`t
('Storage'),

231 '#İtiÚs' => 
	`¬¿y
(

232 '®l' => 
	`t
('<All>'),

233 
	`t
('Normal') =>('Normal'),

234 
	`t
('Default') =>('Default'),

235 
	`t
('Overridden') =>('Overridden'),

240 
$ba£s
 = 
	`¬¿y
();

241 
	`fÜ—ch
 (
	`v›ws_ãtch_ba£_bËs
(è
as
 
$bË
 => 
$šfo
) {

242 
$ba£s
[
$bË
] = 
$šfo
['title'];

245 
$fÜm
['ba£'] = 
	`¬¿y
(

247 '#t™Ë' => 
	`t
('Type'),

248 '#İtiÚs' => 
	`¬¿y_m”ge
(
$®l
, 
$ba£s
),

252 
$gs
 = 
	`¬¿y
();

254 
$exŒas
 = 
	`¬¿y
();

255 
	`fÜ—ch
 (
$fÜm_¡©e
['v›ws'] 
as
 
$Çme
 => 
$v›w
) {

256 ià(!
	`em±y
(
$v›w
->
g
)) {

257 
$gs
[
$v›w
->
g
] = $view->tag;

261 
	`asÜt
(
$gs
);

263 
$fÜm
['g'] = 
	`¬¿y
(

265 '#t™Ë' => 
	`t
('Tag'),

266 '#İtiÚs' => 
	`¬¿y_m”ge
(
$®l
, 
$nÚe
, 
$gs
),

270 
$di¥Ïys
 = 
	`¬¿y
();

271 
	`fÜ—ch
 (
	`v›ws_ãtch_¶ugš_d©a
('di¥Ïy'è
as
 
$id
 => 
$šfo
) {

272 ià(!
	`em±y
(
$šfo
['admin'])) {

273 
$di¥Ïys
[
$id
] = 
$šfo
['admin'];

277 
	`asÜt
(
$di¥Ïys
);

279 
$fÜm
['di¥Ïy'] = 
	`¬¿y
(

281 '#t™Ë' => 
	`t
('Displays'),

282 '#İtiÚs' => 
	`¬¿y_m”ge
(
$®l
, 
$di¥Ïys
),

286 
$fÜm
['Üd”'] = 
	`¬¿y
(

288 '#t™Ë' => 
	`t
('Sort by'),

289 '#İtiÚs' => 
	`¬¿y
(

290 'Çme' => 
	`t
('Name'),

291 't™Ë' => 
	`t
('Title'),

292 'g' => 
	`t
('Tag'),

293 '·th' => 
	`t
('Path'),

294 'ty³' => 
	`t
('Type'),

295 'desc' => 
	`t
('Description'),

300 
$fÜm
['sÜt'] = 
	`¬¿y
(

302 '#t™Ë' => 
	`t
('Order'),

303 '#İtiÚs' => 
	`¬¿y
(

304 'asc' => 
	`t
('Up'),

305 'desc' => 
	`t
('Down'),

310 
$fÜm
['subm™'] = 
	`¬¿y
(

314 '#v®ue' => 
	`t
('Apply'),

317 ià(!
	`em±y
(
$_SESSION
['views']['#admin'])) {

318 
$fÜm
['»£t'] = 
	`¬¿y
(

321 '#v®ue' => 
	`t
('Reset'),

325 
$fÜm
['#theme'] = 
	`¬¿y
('views_ui_list_views_form');

326  
$fÜm
;

327 
	}
}

329 
funùiÚ
 
	$theme_v›ws_ui_li¡_v›ws_fÜm
(
$fÜm
) {

331 
	`un£t
(
$fÜm
['form_id']);

332 
	`un£t
(
$fÜm
['form_build_id']);

333 
	`un£t
(
$fÜm
['form_token']);

334  
	`dru·l_»nd”
(
$fÜm
);

335 
	}
}

342 
funùiÚ
 
	$v›ws_ui_´ev›w
(
$js
, 
$v›w
) {

345 
$func_¬gs
 = 
	`func_g‘_¬gs
();

346 
	`¬¿y_shiá
(
$func_¬gs
);

347 
	`¬¿y_shiá
(
$func_¬gs
);

348 
$di¥Ïy_id
 = (
	`couÁ
(
$func_¬gs
)è? 
	`¬¿y_shiá
($func_args) : 'default';

350 
$fÜm_¡©e
 = 
	`¬¿y
(

351 'di¥Ïy_id' => 
$di¥Ïy_id
,

352 'v›w_¬gs' => 
$func_¬gs
 ? 
	`im¶ode
('/', $func_args) : '',

353 '»»nd”' => 
TRUE
,

354 'no_»dœeù' => 
TRUE
,

355 'v›w' => &
$v›w
,

356 'ajax' => 
$js


359 
$ouut
 = 
	`dru·l_bud_fÜm
('v›ws_ui_´ev›w_fÜm', 
$fÜm_¡©e
);

360 
$¬gs
 = 
	`¬¿y
();

361 ià(
	`is£t
(
$fÜm_¡©e
['view_args']) && $form_state['view_args'] !== '') {

362 
$¬gs
 = 
	`ex¶ode
('/', 
$fÜm_¡©e
['view_args']);

365 
$”rÜs
 = 
$v›w
->
	`v®id©e
();

366 ià(
$”rÜs
 ==ğ
TRUE
) {

367 
$v›w
->
ajax
 = 
$js
;

368 
$v›w
->
live_´ev›w
 = 
TRUE
;

371 
$v›w
->
	`£t_di¥Ïy
(
$fÜm_¡©e
['display_id']);

372 
$v›w
->
	`£t_¬gum’ts
(
$¬gs
);

374 ià(
$v›w
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('path')) {

375 
$·th
 = 
$v›w
->
	`g‘_u¾
();

379 
$v›w
->
ov”ride_·th
 = 'admš/bud/v›ws/nojs/´ev›w/' . $v›w->
Çme
 . '/' . 
$fÜm_¡©e
['display_id'];

382 
$_GET
['q'] = 
$v›w
->
ov”ride_·th
;

383 ià(
$fÜm_¡©e
['view_args']) {

384 
$_GET
['q'] .ğ'/' . 
$fÜm_¡©e
['view_args'];

387 
$´ev›w
 = 
$v›w
->
	`´ev›w
(
$fÜm_¡©e
['di¥Ïy_id'], 
$¬gs
);

390 ià(!
	`em±y
(
$v›w
->
bud_šfo
['query'])) {

391 
$rows
 = 
	`¬¿y
();

392 
$qu”y
 = 
	`db_´efix_bËs
(
$v›w
->
bud_šfo
['query']);

393 ià(
$v›w
->
bud_šfo
['query_args']) {

394 
	`_db_qu”y_ÿÎback
(
$v›w
->
bud_šfo
['qu”y_¬gs'], 
TRUE
);

395 
$qu”y
 = 
	`´eg_»¶aû_ÿÎback
(
DB_QUERY_REGEXP
, '_db_query_callback', $query);

397 
$rows
[] = 
	`¬¿y
('<¡rÚg>' . 
	`t
('Qu”y'è. '</¡rÚg>', '<´e>' . 
	`check_¶aš
(
$qu”y
) . '</pre>');

398 ià(!
	`em±y
(
$v›w
->
add™iÚ®_qu”›s
)) {

399 
$qu”›s
 = '<¡rÚg>' . 
	`t
('These queries were„un during view„endering:') . '</strong>';

400 
	`fÜ—ch
 (
$v›w
->
add™iÚ®_qu”›s
 
as
 
$qu”y
) {

401 ià(
$qu”›s
) {

402 
$qu”›s
 .= "\n";

404 
$qu”›s
 .ğ
	`t
('[@timms]', 
	`¬¿y
('@time' => 
	`štv®
(
$qu”y
[1] * 100000è/ 100)è. ' ' . 
	`check_¶aš
($query[0]);

407 
$rows
[] = 
	`¬¿y
('<¡rÚg>' . 
	`t
('Oth” qu”›s'è. '</¡rÚg>', '<´e>' . 
$qu”›s
 . '</pre>');

410 
$rows
[] = 
	`¬¿y
('<¡rÚg>' . 
	`t
('T™Ë'è. '</¡rÚg>', 
	`f‹r_xss_admš
(
$v›w
->
	`g‘_t™Ë
()));

411 ià(
	`is£t
(
$·th
)) {

412 
$·th
 = 
	`l
($path, $path);

415 
$·th
 = 
	`t
('This display has‚o…ath.');

418 
$rows
[] = 
	`¬¿y
('<¡rÚg>' . 
	`t
('P©h'è. '</¡rÚg>', 
$·th
);

420 
$rows
[] = 
	`¬¿y
('<¡rÚg>' . 
	`t
('Qu”y budime'è. '</¡rÚg>',('@timms',‡¼ay('@time' => 
	`štv®
(
$v›w
->
bud_time
 * 100000) / 100)));

421 
$rows
[] = 
	`¬¿y
('<¡rÚg>' . 
	`t
('Qu”yƒxecu‹ime'è. '</¡rÚg>',('@timms',‡¼ay('@time' => 
	`štv®
(
$v›w
->
execu‹_time
 * 100000) / 100)));

422 
$rows
[] = 
	`¬¿y
('<¡rÚg>' . 
	`t
('V›w„’d”ime'è. '</¡rÚg>',('@timms',‡¼ay('@time' => 
	`štv®
(
$v›w
->
»nd”_time
 * 100000) / 100)));

423 
	`dru·l_®‹r
('v›ws_´ev›w_šfo', 
$rows
, 
$v›w
);

425 
$šfo
 = 
	`theme
('bË', 
	`¬¿y
(), 
$rows
);

428 
$šfo
 = 
	`theme
('bË', 
	`¬¿y
(),‡¼ay×¼ay('<¡rÚg>' . 
	`t
('Query') . '</strong>',('No query was„un'))));

432 
	`fÜ—ch
 (
$”rÜs
 
as
 
$”rÜ
) {

433 
	`dru·l_£t_mes§ge
(
$”rÜ
, 'error');

435 
$´ev›w
 = 
	`t
('Unableo…review dueo validationƒrrors.');

436 
$šfo
 = '';

439 
$šfo
 = '<div class="views-query-info">' . $info . '</div>';

441 ià(
	`v¬ŸbË_g‘
('v›ws_ui_qu”y_Ú_tİ', 
FALSE
)) {

442 
$ouut
 .ğ
$šfo
 . 
$´ev›w
;

445 
$ouut
 .ğ
$´ev›w
 . 
$šfo
;

448 ià(!
$js
) {

449 
	`v›ws_add_css
('views-admin');

450 
	`dru·l_£t_t™Ë
(
$v›w
->
	`g‘_t™Ë
());

451  
$ouut
;

454 
	`v›ws_šşude
('ajax');

455 
$objeù
 = 
Ãw
 
	`¡dCÏss
();

456 ià(!
	`em±y
(
$v›w
->
js_£‰šgs
)) {

457 
$objeù
->
js
 = 
$v›w
->
js_£‰šgs
;

459 
$objeù
->
di¥Ïy
 = '';

460 ià(
$mes§ges
 = 
	`theme
('status_messages')) {

461 
$objeù
->
di¥Ïy
 = '<div cÏss="v›ws-mes§ges">' . 
$mes§ges
 . '</div>';

463 
$objeù
->
di¥Ïy
 .ğ
$ouut
;

464 
$objeù
->
t™Ë
 = 
$v›w
->
	`g‘_t™Ë
();

465 
	`v›ws_ajax_»nd”
(
$objeù
);

467 
	}
}

472 
funùiÚ
 
	$v›ws_ui_´ev›w_fÜm
(&
$fÜm_¡©e
) {

473 
$v›w
 = &
$fÜm_¡©e
['view'];

474 
$v›w
->
	`š™_di¥Ïy
();

475 
$İtiÚs
 = 
	`¬¿y
();

476 
	`fÜ—ch
 (
$v›w
->
di¥Ïy
 
as
 
$id
 => 
$di¥Ïy
) {

477 
$İtiÚs
[
$id
] = 
$di¥Ïy
->
di¥Ïy_t™Ë
;

480 
$fÜm
['#©Œibu‹s'] = 
	`¬¿y
(

484 
$fÜm
['di¥Ïy_id'] = 
	`¬¿y
(

486 '#t™Ë' => 
	`t
('Display'),

487 '#İtiÚs' => 
$İtiÚs
,

488 '#deçuÉ_v®ue' => 
$fÜm_¡©e
['display_id'],

492 
$fÜm
['¬gs'] = 
	`¬¿y
(

494 '#t™Ë' => 
	`t
('Arguments'),

495 '#deçuÉ_v®ue' => 
$fÜm_¡©e
['view_args'],

496 '#desütiÚ' => 
	`t
('Separate‡rguments with‡ /‡shoughhey were‡ URL…ath.'),

500 
$fÜm
['´ev›w'] = 
	`¬¿y
(

502 '#v®ue' => 
	`t
('Preview'),

507 
$fÜm
['live_´ev›w'] = 
	`¬¿y
(

509 '#t™Ë' => 
	`t
('Automatic†ive…review'),

510 '#deçuÉ_v®ue' => !
	`v¬ŸbË_g‘
('views_ui_disable_live_preview', 0),

513 
$fÜm
['#aùiÚ'] = 
	`u¾
("admin/build/views/nojs/preview/$view->name");

514  
$fÜm
;

515 
	}
}

523 
funùiÚ
 
	$v›ws_ui_´ev›w_fÜm_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

524 
$fÜm_¡©e
['display_id'] = $form_state['values']['display_id'];

525 
$fÜm_¡©e
['view_args'] = $form_state['values']['args'];

526 
	}
}

531 
funùiÚ
 
	$v›ws_ui_add_·ge
() {

532 
$fÜm_¡©e
 = 
	`¬¿y
(

533 'v›w' => 
NULL


536  
	`dru·l_bud_fÜm
('v›ws_ui_add_fÜm', 
$fÜm_¡©e
);

537 
	}
}

542 
funùiÚ
 
	$v›ws_ui_şÚe_·ge
(
$v›w
) {

543 
$fÜm_¡©e
 = 
	`¬¿y
(

544 'v›w' => 
$v›w
->
	`cİy
(),

547 
	`dru·l_£t_t™Ë
(
	`t
('ClÚv›w %v›w', 
	`¬¿y
('%v›w' => 
$v›w
->
Çme
)));

548  
	`dru·l_bud_fÜm
('v›ws_ui_add_fÜm', 
$fÜm_¡©e
);

549 
	}
}

554 
funùiÚ
 
	$v›ws_ui_add_fÜm
(&
$fÜm_¡©e
) {

555 
$v›w
 = 
$fÜm_¡©e
['view'];

556 
$fÜm
 = 
	`¬¿y
();

558 
$fÜm
['Çme'] = 
	`¬¿y
(

560 '#t™Ë' => 
	`t
('View‚ame'),

561 '#desütiÚ' => 
	`t
('This ishe unique‚ame ofhe view. It must contain only‡lphanumeric characters‡nd underscores; it is usedo identifyhe view internally‡ndo generate uniquehemingemplate‚ames forhis view. If overriding‡ module…rovided view,he‚ame must‚ot be changed or instead‡‚ew view will be created.'),

562 '#»quœed' => 
TRUE
,

564 '#deçuÉ_v®ue' => 
$v›w
 ? $v›w->
Çme
 : '',

565 '#©Œibu‹s' => 
	`¬¿y
('dir'=>'ltr'),

568 
$fÜm
['desütiÚ'] = 
	`¬¿y
(

570 '#t™Ë' => 
	`t
('View description'),

571 '#desütiÚ' => 
	`t
('This description will‡ppear onhe Views‡dministrative UIoell you whathe view is‡bout.'),

572 '#deçuÉ_v®ue' => 
$v›w
 ? $v›w->
desütiÚ
 : '',

575 
$fÜm
['g'] = 
	`¬¿y
(

577 '#t™Ë' => 
	`t
('Viewag'),

578 '#desütiÚ' => 
	`t
('Enter‡n optionalag forhis view; it is used onlyo help sort views onhe‡dministrative…age.'),

579 '#deçuÉ_v®ue' => 
$v›w
 ? $v›w->
g
 : '',

583 
$ba£_bËs
 = 
	`¬¿y
();

584 
	`fÜ—ch
 (
	`v›ws_ãtch_ba£_bËs
(è
as
 
$bË
 => 
$šfo
) {

585 
$ba£_bËs
[
$bË
] = 
$šfo
['title'] . '<div class="description">' . $info['description'] . '</div>';

588 
$fÜm
['ba£_bË'] = 
	`¬¿y
(

590 '#t™Ë' => 
	`t
('Viewype'),

591 '#desütiÚ' => 
	`t
('The viewype ishe…rimaryable for which information is being„etrieved. The viewype controls what‡rguments, fields, sort criteria‡nd filters‡re‡vailable, so oncehis is set it <strong>cannot be changed</strong>.'),

592 '#deçuÉ_v®ue' => 
$v›w
 ? $v›w->
ba£_bË
 : 'node',

593 '#İtiÚs' => 
$ba£_bËs
,

596 ià(
$v›w
) {

597 
$fÜm
['ba£_bË']['#di§bËd'] = 
TRUE
;

600 
$fÜm
['subm™'] = 
	`¬¿y
(

602 '#v®ue' => 
	`t
('Next'),

603 '#v®id©e' => 
	`¬¿y
('views_ui_add_form_validate'),

604 '#subm™' => 
	`¬¿y
('views_ui_add_form_submit'),

607  
$fÜm
;

608 
	}
}

613 
funùiÚ
 
	$v›ws_ui_add_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

614 
$Çme
 = 
$fÜm_¡©e
['values']['name'];

617 ià(
	`´eg_m©ch
('/[^a-zA-Z0-9_]/', 
$Çme
)) {

618 
	`fÜm_”rÜ
(
$fÜm
['Çme'], 
	`t
('View‚ame must be‡lphanumeric or underscores only.'));

622 
$v›w
 = 
	`v›ws_g‘_v›w
(
$fÜm_¡©e
['values']['name']);

623 ià(
$v›w
 && $v›w->
ty³
 !ğ
	`t
('Default')) {

624 
	`fÜm_”rÜ
(
$fÜm
['Çme'], 
	`t
('You must use‡ unique‚ame forhis view.'));

626 
	}
}

631 
funùiÚ
 
	$v›ws_ui_add_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

632 
$v›w
 = 
$fÜm_¡©e
['v›w'] ? $fÜm_¡©e['v›w'] : 
	`v›ws_Ãw_v›w
();

633 
$v›w
->
Çme
 = 
$fÜm_¡©e
['values']['name'];

634 
$v›w
->
desütiÚ
 = 
$fÜm_¡©e
['values']['description'];

635 
$v›w
->
g
 = 
$fÜm_¡©e
['values']['tag'];

636 ià(
	`em±y
(
$fÜm
['base_table']['#disabled'])) {

637 
$v›w
->
ba£_bË
 = 
$fÜm_¡©e
['values']['base_table'];

640 
	`v›ws_ui_ÿche_£t
(
$v›w
);

641 
$fÜm_¡©e
['»dœeù'] ='admš/bud/v›ws/ed™/' . 
$v›w
->
Çme
;

642 
	}
}

647 
funùiÚ
 
	$v›ws_ui_d–‘e_cÚfœm
(&
$fÜm_¡©e
, 
$v›w
) {

648 
$fÜm_¡©e
['v›w'] = &
$v›w
;

649 
$fÜm
 = 
	`¬¿y
();

651 
$ÿnûl
 = 'admin/build/views';

652 ià(!
	`em±y
(
$_REQUEST
['cancel'])) {

653 
$ÿnûl
 = 
$_REQUEST
['cancel'];

656 ià(
$v›w
->
ty³
 =ğ
	`t
('Overridden')) {

657 
$t™Ë
 = 
	`t
('A» you su» you wªˆtØ»v”ˆthv›w %Çme?', 
	`¬¿y
('%Çme' => 
$v›w
->
Çme
));

658 
$desc
 = 
	`t
('Revertinghe view will deletehe viewhat is inhe database,„everting itohe original default view. Any changes you have made will be†ost‡nd cannot be„ecovered.');

659 
$bu‰Ú
 = 
	`t
('Revert');

662 
$t™Ë
 = 
	`t
('A» you su» you wªˆtØd–‘thv›w %Çme?', 
	`¬¿y
('%Çme' => 
$v›w
->
Çme
));

663 
$desc
 = 
	`t
('Deleting‡ view cannot be undone.');

664 
$bu‰Ú
 = 
	`t
('Delete');

667  
	`cÚfœm_fÜm
(
$fÜm
,

668 
$t™Ë
,

669 
$ÿnûl
,

670 
$desc
,

671 
$bu‰Ú
,

672 
	`t
('Cancel'));

673 
	}
}

678 
funùiÚ
 
	$v›ws_ui_d–‘e_cÚfœm_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

679 
$fÜm_¡©e
['v›w']->
	`d–‘e
();

680 
	`v›ws_objeù_ÿche_ş—r
('v›w', 
$fÜm_¡©e
['v›w']->
Çme
);

681 
	`dru·l_£t_mes§ge
(
	`t
('The view has been deleted.'));

682 
$fÜm_¡©e
['redirect'] = 'admin/build/views';

683 
	}
}

688 
funùiÚ
 
	$v›ws_ui_b»ak_lock_cÚfœm
(&
$fÜm_¡©e
, 
$v›w
) {

689 
$fÜm_¡©e
['v›w'] = &
$v›w
;

690 
$fÜm
 = 
	`¬¿y
();

692 ià(
	`em±y
(
$v›w
->
locked
)) {

693  
	`t
('Th”i nØlock oÀv›w %v›wØb»ak.', 
	`¬¿y
('%Çme' => 
$v›w
->
Çme
));

696 
$ÿnûl
 = 'admš/bud/v›ws/ed™/' . 
$v›w
->
Çme
;

697 ià(!
	`em±y
(
$_REQUEST
['cancel'])) {

698 
$ÿnûl
 = 
$_REQUEST
['cancel'];

701 
$accouÁ
 = 
	`u£r_lßd
(
$v›w
->
locked
->
uid
);

702  
	`cÚfœm_fÜm
(
$fÜm
,

703 
	`t
('Are you sure you wanto breakhe†ock on view %name?',

704 
	`¬¿y
('%Çme' => 
$v›w
->
Çme
)),

705 
$ÿnûl
,

706 
	`t
('By b»akšghi lock,‡ny un§ved chªge madby !u£¸wÈblo¡!', 
	`¬¿y
('!u£r' => 
	`theme
('u£ºame', 
$accouÁ
))),

707 
	`t
('Break†ock'),

708 
	`t
('Cancel'));

709 
	}
}

714 
funùiÚ
 
	$v›ws_ui_b»ak_lock_cÚfœm_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

715 
	`db_qu”y
("DELETE FROM {v›ws_objeù_ÿche} WHERE obj = 'v›w' AND‚amğ'%s'", 
$fÜm_¡©e
['v›w']->
Çme
);

716 
$fÜm_¡©e
['»dœeù'] = 'admš/bud/v›ws/ed™/' . $fÜm_¡©e['v›w']->
Çme
;

717 
	`dru·l_£t_mes§ge
(
	`t
('The†ock has been broken‡nd you may‚owƒdithis view.'));

718 
	}
}

723 
funùiÚ
 
	$v›ws_ui_ed™_·ge
(
$v›w
) {

724 
	`dru·l_£t_t™Ë
(
	`t
('Ed™ v›w %v›w', 
	`¬¿y
('%v›w' => 
$v›w
->
Çme
)));

725 
$ouut
 = 
	`theme
('v›ws_ui_ed™_v›w', 
$v›w
);

726 
	`v›ws_ui_check_advªûd_h–p
();

727  
$ouut
;

728 
	}
}

733 
funùiÚ
 
	$v›ws_ui_expÜt_·ge
(&
$fÜm_¡©e
, 
$v›w
) {

734 
$code
 = 
$v›w
->
	`expÜt
();

735 
$lšes
 = 
	`sub¡r_couÁ
(
$code
, "\n");

736 
$fÜm
['code'] = 
	`¬¿y
(

738 '#t™Ë' => 
$v›w
->
Çme
,

739 '#deçuÉ_v®ue' => 
$code
,

740 '#rows' => 
$lšes
,

742  
$fÜm
;

743 
	}
}

748 
funùiÚ
 
	$v›ws_ui_impÜt_·ge
(&
$fÜm_¡©e
) {

749 
$fÜm
['Çme'] = 
	`¬¿y
(

751 '#t™Ë' => 
	`t
('View‚ame'),

752 '#desütiÚ' => 
	`t
('Enterhe‚ameo use forhis view if it is different fromhe source view. Leave blanko usehe‚ame ofhe view.'),

755 
$fÜm
['v›w'] = 
	`¬¿y
(

757 '#t™Ë' => 
	`t
('Paste view code here'),

758 '#»quœed' => 
TRUE
,

761 
$fÜm
['subm™'] = 
	`¬¿y
(

763 '#v®ue' => 
	`t
('Import'),

764 '#subm™' => 
	`¬¿y
('views_ui_import_submit'),

765 '#v®id©e' => 
	`¬¿y
('views_ui_import_validate'),

767  
$fÜm
;

768 
	}
}

773 
funùiÚ
 
	$v›ws_ui_impÜt_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

774 
$v›w
 = '';

775 
	`v›ws_šşude
('view');

776 
	`ob_¡¬t
();

777 
	`ev®
(
$fÜm_¡©e
['values']['view']);

778 
	`ob_’d_ş—n
();

780 ià(!
	`is_objeù
(
$v›w
)) {

781  
	`fÜm_”rÜ
(
$fÜm
['v›w'], 
	`t
('Unableo interpret view code.'));

784 ià(
	`em±y
(
$v›w
->
­i_v”siÚ
) || $view->api_version < 2) {

786 ià(
	`is£t
(
$v›w
->
u¾
è|| is£t($v›w->
·ge
è|| is£t($v›w->
block
)) {

787 
	`v›ws_šşude
('convert');

788 
$v›w
 = 
	`v›ws1_impÜt
($view);

789 
	`dru·l_£t_mes§ge
(
	`t
('You‡re importing‡ view created in Views version 1. You may‚eedo‡djust some…arameterso work correctly in version 2.'), 'warning');

792 
	`fÜm_”rÜ
(
$fÜm
['v›w'], 
	`t
('That view is‚ot compatible withhis version of Views.'));

795 
	`–£if
 (
$v›w
->
­i_v”siÚ
 > 
	`v›ws_­i_v”siÚ
()) {

796 
	`fÜm_”rÜ
(
$fÜm
['v›w'], 
	`t
('Th© v›w i ü—‹d fÜhv”siÚ @impÜt_v”siÚ oàv›ws, buˆyou oÆy hav@­i_v”siÚ', 
	`¬¿y
(

797 '@impÜt_v”siÚ' => 
$v›w
->
­i_v”siÚ
,

798 '@­i_v”siÚ' => 
	`v›ws_­i_v”siÚ
())));

802 ià(!
	`em±y
(
$fÜm_¡©e
['v®ues']['Çme']è&& 
	`´eg_m©ch
('/[^a-zA-Z0-9_]/', $form_state['values']['name'])) {

803 
	`fÜm_”rÜ
(
$fÜm
['Çme'], 
	`t
('View‚ame must be‡lphanumeric or underscores only.'));

806 ià(
$fÜm_¡©e
['values']['name']) {

807 
$v›w
->
Çme
 = 
$fÜm_¡©e
['values']['name'];

810 
$‹¡
 = 
	`v›ws_g‘_v›w
(
$v›w
->
Çme
);

811 ià(
$‹¡
 && $‹¡->
ty³
 !ğ
	`t
('Default')) {

812 
	`fÜm_£t_”rÜ
('', 
	`t
('A view byhat‚ame‡lreadyƒxists;…lease choose‡ different‚ame'));

815 
$v›w
->
	`š™_di¥Ïy
();

817 
$brok’
 = 
FALSE
;

819 
	`fÜ—ch
 (
$v›w
->
di¥Ïy
 
as
 
$id
 => 
$di¥Ïy
) {

820 ià(
	`em±y
(
$di¥Ïy
->
hªdËr
è|| !em±y($di¥Ïy->hªdËr->
brok’
)) {

821 
	`dru·l_£t_mes§ge
(
	`t
('Di¥Ïy…lugš @¶ugš i nÙ‡vaabË.', 
	`¬¿y
('@¶ugš' => 
$di¥Ïy
->
di¥Ïy_¶ugš
)), 'error');

822 
$brok’
 = 
TRUE
;

826 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('¡yË', 
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('style_plugin'));

827 ià(!
$¶ugš
) {

828 
	`dru·l_£t_mes§ge
(
	`t
('StyË…lugš @¶ugš i nÙ‡vaabË.', 
	`¬¿y
('@¶ugš' => 
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('style_plugin'))), 'error');

829 
$brok’
 = 
TRUE
;

831 ià(
$¶ugš
->
	`u£s_row_¶ugš
()) {

832 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('row', 
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('row_plugin'));

833 ià(!
$¶ugš
) {

834 
	`dru·l_£t_mes§ge
(
	`t
('Row…lugš @¶ugš i nÙ‡vaabË.', 
	`¬¿y
('@¶ugš' => 
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('row_plugin'))), 'error');

835 
$brok’
 = 
TRUE
;

839 
	`fÜ—ch
 (
	`v›ws_objeù_ty³s
(è
as
 
$ty³
 => 
$šfo
) {

840 
$hªdËrs
 = 
$di¥Ïy
->
hªdËr
->
	`g‘_hªdËrs
(
$ty³
);

841 ià(
$hªdËrs
) {

842 
	`fÜ—ch
 (
$hªdËrs
 
as
 
$id
 => 
$hªdËr
) {

843 ià(
$hªdËr
->
	`brok’
()) {

844 
	`dru·l_£t_mes§ge
(
	`t
('@ty³ hªdË¸@bË.@f›ld i nÙ‡vaabË.', 
	`¬¿y
(

845 '@ty³' => 
$šfo
['stitle'],

846 '@bË' => 
$hªdËr
->
bË
,

847 '@f›ld' => 
$hªdËr
->
f›ld
,

849 
$brok’
 = 
TRUE
;

856 ià(
$brok’
) {

857 
	`fÜm_£t_”rÜ
('', 
	`t
('Unableo import view.'));

860 
$fÜm_¡©e
['v›w'] = &
$v›w
;

861 
	}
}

866 
funùiÚ
 
	$v›ws_ui_impÜt_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

868 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

869 
$fÜm_¡©e
['»dœeù'] = 'admš/bud/v›ws/ed™/' . $fÜm_¡©e['v›w']->
Çme
;

870 
	}
}

875 
funùiÚ
 
	$v›ws_ui_ed™_v›w_fÜm
(&
$fÜm_¡©e
, 
$v›w
) {

876 
$fÜm
['bu‰Ús']['§ve'] = 
	`¬¿y
(

878 '#v®ue' => 
	`t
('Save'),

879 '#v®id©e' => 
	`¬¿y
('views_ui_edit_view_form_validate'),

880 '#subm™' => 
	`¬¿y
('views_ui_edit_view_form_submit'),

883 
$fÜm
['bu‰Ús']['ÿnûl'] = 
	`¬¿y
(

885 '#v®ue' => 
	`t
('Cancel'),

886 '#subm™' => 
	`¬¿y
('views_ui_edit_view_form_cancel'),

889 ià(
	`is_num”ic
(
$v›w
->
vid
)) {

890 
$fÜm
['bu‰Ús']['d–‘e'] = 
	`¬¿y
(

892 '#v®ue' => 
$v›w
->
ty³
 =ğ
	`t
('Overridden') ?('Revert') :('Delete'),

893 '#subm™' => 
	`¬¿y
('views_ui_edit_view_form_delete'),

897 
$fÜm_¡©e
['v›w'] = &
$v›w
;

898  
$fÜm
;

899 
	}
}

904 
funùiÚ
 
	$v›ws_ui_ed™_v›w_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

906 ià(
	`em±y
(
$fÜm_¡©e
['şicked_bu‰Ú']['#v®ue']è|| $fÜm_¡©e['şicked_bu‰Ú']['#v®ue'] !ğ
	`t
('Save')) {

910 
$”rÜs
 = 
$fÜm_¡©e
['v›w']->
	`v®id©e
();

911 ià(
$”rÜs
 !=ğ
TRUE
) {

912 
	`fÜ—ch
 (
$”rÜs
 
as
 
$”rÜ
) {

913 
	`fÜm_£t_”rÜ
('', 
$”rÜ
);

916 
	}
}

921 
funùiÚ
 
	$v›ws_ui_ed™_v›w_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

923 
	`fÜ—ch
 (
$fÜm_¡©e
['v›w']->
di¥Ïy
 
as
 
$id
 => 
$di¥Ïy
) {

924 ià(!
	`em±y
(
$di¥Ïy
->
d–‘ed
)) {

925 
	`un£t
(
$fÜm_¡©e
['v›w']->
di¥Ïy
[
$id
]);

929 
$fÜm_¡©e
['v›w']->
	`§ve
();

930 
	`dru·l_£t_mes§ge
(
	`t
('Thv›w %Çmha b“À§ved.', 
	`¬¿y
('%Çme' => 
$fÜm_¡©e
['v›w']->
Çme
)));

933 
	`m’u_»bud
();

936 
	`ÿche_ş—r_®l
('*', 'cache_views');

939 
	`ÿche_ş—r_®l
();

942 
	`v›ws_objeù_ÿche_ş—r
('v›w', 
$fÜm_¡©e
['v›w']->
Çme
);

943 
	}
}

948 
funùiÚ
 
	$v›ws_ui_ed™_v›w_fÜm_ÿnûl
(
$fÜm
, &
$fÜm_¡©e
) {

950 
	`v›ws_objeù_ÿche_ş—r
('v›w', 
$fÜm_¡©e
['v›w']->
Çme
);

951 ià(
	`em±y
(
$fÜm
['v›w']->
vid
)) {

954 
	`dru·l_gÙo
('admin/build/views');

956 
	}
}

958 
funùiÚ
 
	$v›ws_ui_ed™_v›w_fÜm_d–‘e
(
$fÜm
, &
$fÜm_¡©e
) {

959 
	`un£t
(
$_REQUEST
['destination']);

961 
$fÜm_¡©e
['»dœeù'] = 
	`¬¿y
('admš/bud/v›ws/d–‘e/' . $fÜm_¡©e['v›w']->
Çme
, 'cancel=admin/build/views/edit/' . $form_state['view']->name);

962 
	}
}

967 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_ui_ed™_v›w
(&
$v¬s
) {

968 
$v›w
 = &
$v¬s
['view'];

970 
$v¬s
['§ve_bu‰Ú'] = 
	`dru·l_g‘_fÜm
('v›ws_ui_ed™_v›w_fÜm', 
$v›w
);

972 
$bË
 = 
	`v›ws_ãtch_d©a
(
$v›w
->
ba£_bË
);

973 
$v¬s
['ba£_bË'] = !
	`em±y
(
$bË
['table']['base']['title']) ?

974 
$bË
['bË']['ba£']['t™Ë'] : 
	`t
('Unknown or missingable‚ame');

976 
	`v›ws_šşude
('tabs');

977 
$bs
 = 
Ãw
 
v›ws_b£t
;

979 
$v¬s
['mes§ge'] = '<div cÏss="mes§ge">' . 
	`t
("Click on‡n itemoƒdithat item's details.") . '</div>';

981 ià(!
$v›w
->
	`£t_di¥Ïy
('default')) {

982 
	`dru·l_£t_mes§ge
(
	`t
('This view has‡ broken default display‡nd cannot be used.'), 'error');

985 
	`fÜ—ch
 (
$v›w
->
di¥Ïy
 
as
 
$di¥Ïy
) {

986 
	`li¡
(
$t™Ë
, 
$body
èğ
	`v›ws_ui_di¥Ïy_b
(
$v›w
, 
$di¥Ïy
);

988 
$bs
->
	`£t
(
$di¥Ïy
->
id
, 
$t™Ë
, 
$body
);

992 
$fÜm_¡©e
 = 
	`¬¿y
(

993 'v›w' => &
$v›w
,

994 'ajax' => 
FALSE
,

997 
$di¥Ïy_bu‰Ú
 = 
	`dru·l_bud_fÜm
('v›ws_ui_add_di¥Ïy_fÜm', 
$fÜm_¡©e
);

998 
$ª®yze_bu‰Ú
 = 
	`dru·l_g‘_fÜm
('v›ws_ui_ª®yze_v›w_bu‰Ú', 
$v›w
);

999 
$bs
->
	`add_exŒa
(
$di¥Ïy_bu‰Ú
 . 
$ª®yze_bu‰Ú
);

1001 
$v¬s
['bs'] = 
$bs
->
	`»nd”
();

1003 
$fÜm_¡©e
 = 
	`¬¿y
(

1006 '»»nd”' => 
FALSE
,

1007 'no_»dœeù' => 
TRUE
,

1008 'v›w' => &
$v›w
,

1009 'šput' => 
	`¬¿y
(),

1011 
$v¬s
['´ev›w'] = 
	`dru·l_bud_fÜm
('v›ws_ui_´ev›w_fÜm', 
$fÜm_¡©e
);

1013 
$v¬s
['locked'] = 
NULL
;

1014 ià(
	`is£t
(
$v›w
->
locked
è&& 
	`is_objeù
($view->locked)) {

1015 
$accouÁ
 = 
	`u£r_lßd
(
$v›w
->
locked
->
uid
);

1016 
$v¬s
['locked'] = 
	`theme
('u£ºame', 
$accouÁ
);

1017 
$v¬s
['lock_age'] = 
	`fÜm©_š‹rv®
(
	`time
(è- 
$v›w
->
locked
->
upd©ed
);

1018 
$v¬s
['b»ak'] = 
	`u¾
('admš/bud/v›ws/b»ak-lock/' . 
$v›w
->
Çme
);

1021 
$v¬s
['quick_lšks_¿w'] = 
	`¬¿y
(

1022 
	`¬¿y
(

1023 't™Ë' => 
	`t
('Export'),

1024 '®t' => 
	`t
("Exporthis view"),

1027 
	`¬¿y
(

1028 't™Ë' => 
	`t
('Clone'),

1029 '®t' => 
	`t
("Create‡ copy ofhis view"),

1034 
$·ths
 = 
	`¬¿y
();

1035 
	`fÜ—ch
 (
$v›w
->
di¥Ïy
 
as
 
$id
 => 
$di¥Ïy
) {

1036 ià(!
	`em±y
(
$di¥Ïy
->
hªdËr
è&& $di¥Ïy->hªdËr->
	`has_·th
()) {

1037 
$·th
 = 
$di¥Ïy
->
hªdËr
->
	`g‘_·th
();

1038 ià(
	`¡½os
(
$·th
, '%'è==ğ
FALSE
 && !
	`is£t
(
$·ths
[$path])) {

1039 
$v¬s
['quick_lšks_¿w'][] = 
	`¬¿y
(

1040 't™Ë' => 
	`t
('V›w "@di¥Ïy"', 
	`¬¿y
('@di¥Ïy' => 
$di¥Ïy
->
di¥Ïy_t™Ë
)),

1041 '®t' => 
	`t
("Goohe„eal…age forhis display"),

1042 'h»f' => 
$·th
,

1045 
$·ths
[
$·th
] = 
TRUE
;

1050 
$v¬s
['quick_lšks'] = 
	`theme
('links', $vars['quick_links_raw']);

1051 
	`v›ws_add_css
('views-admin');

1052 
	`v›ws_add_js
('ajax');

1053 
	`dru·l_add_js
('misc/jquery.form.js');

1056 
$¶ugšs
 = 
	`v›ws_ãtch_¶ugš_d©a
();

1057 
	`fÜ—ch
 (
$¶ugšs
 
as
 
$ty³
 => 
$ty³_¶ugšs
) {

1058 
	`fÜ—ch
 (
$ty³_¶ugšs
 
as
 
$Çme
 => 
$¶ugš
) {

1059 ià(!
	`em±y
(
$¶ugš
['js'])) {

1060 
	`fÜ—ch
 (
$¶ugš
['js'] 
as
 
$fe
) {

1061 
	`dru·l_add_js
(
$fe
);

1067 
$£‰šgs
 = 
	`¬¿y
('views' =>‡rray('ajax' =>‡rray(

1070 'deçuÉFÜm' => 
$v¬s
['message'],

1073 
	`dru·l_add_js
(
$£‰šgs
, 'setting');

1074 
	}
}

1076 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_ui_ed™_b
(&
$v¬s
) {

1077 
$v›w
 = 
$v¬s
['view'];

1078 
$di¥Ïy
 = 
$v¬s
['display'];

1079 
$¶ugš
 = 
$di¥Ïy
->
hªdËr
->
defš™iÚ
;

1081 
$tİ
 = 
$Ëá
 = 
$middË
 = 
$right
 = '';

1086 
$v¬s
['remove'] = '';

1087 ià(
	`em±y
(
$¶ugš
['no„emove'])) {

1088 ià(!
	`em±y
(
$_POST
['form_id']) && $_POST['form_id'] == 'views_ui_remove_display_form') {

1089 
	`un£t
(
$_POST
['form_id']);

1091 
$fÜm_¡©e
 = 
	`¬¿y
('v›w' => &
$v›w
, 'di¥Ïy_id' => 
$di¥Ïy
->
id
, 'ajax' => 
FALSE
);

1092 
$v¬s
['»move'] = 
	`dru·l_bud_fÜm
('v›ws_ui_»move_di¥Ïy_fÜm', 
$fÜm_¡©e
);

1096 
$v¬s
['t™Ë'] = 
	`check_¶aš
(
$di¥Ïy
->
di¥Ïy_t™Ë
);

1097 
$v¬s
['desütiÚ'] = 
	`check_¶aš
(
$¶ugš
['help']);

1100 
$v¬s
['deçuÉ'] = (
$di¥Ïy
->
id
 == 'default');

1101 
$v¬s
['d‘as_şass'] = 
	`v›ws_ui_™em_css
('details');

1102 ià(!
	`em±y
(
$v›w
->
chªged_£ùiÚs
['details'])) {

1103 
$v¬s
['d‘as_chªged'] = 
TRUE
;

1106 
$g
 = 
	`em±y
(
$v›w
->
g
è? 
	`t
('None') : $view->tag;

1107 
$v¬s
['d‘as'] = 
	`t
('DesütiÚ'è. '/' .('Tag'è. ': ' . 
	`l
(
$g
, "admš/bud/v›ws/nojs/d‘as/$v›w->Çme", 
	`¬¿y
('attributes' =>‡rray('class' => 'views-ajax-link')));

1110 
$İtiÚs
 = 
$ÿ‹gÜ›s
 = 
	`¬¿y
();

1111 
$di¥Ïy
->
hªdËr
->
	`İtiÚs_summ¬y
(
$ÿ‹gÜ›s
, 
$İtiÚs
);

1115 
	`fÜ—ch
 (
$İtiÚs
 
as
 
$id
 => 
$İtiÚ
) {

1116 ià(
	`em±y
(
$ÿ‹gÜ›s
[
$İtiÚ
['category']]['data'])) {

1117 
$ÿ‹gÜ›s
[
$İtiÚ
['ÿ‹gÜy']]['d©a'] = 
	`¬¿y
();

1119 
$ÿ‹gÜ›s
[
$İtiÚ
['ÿ‹gÜy']]['d©a'][
$id
] = 
	`¬¿y
();

1120 
$d©a
 = &
$ÿ‹gÜ›s
[
$İtiÚ
['ÿ‹gÜy']]['d©a'][
$id
];

1121 
$d©a
['content'] = '';

1122 
$d©a
['links'] = '';

1123 
$d©a
['ov”ridd’'] = 
FALSE
;

1124 
$d©a
['deçuÉed'] = 
FALSE
;

1127 ià(!
	`em±y
(
$İtiÚ
['links'])) {

1128 
	`fÜ—ch
 (
$İtiÚ
['lšks'] 
as
 
$lšk_id
 => 
$lšk_v®ue
) {

1129 
$d©a
['lšks'] .ğ
$di¥Ïy
->
hªdËr
->
	`İtiÚ_lšk
(
$lšk_v®ue
, 
$lšk_id
, 'views-button-configure');

1132 ià(!
	`em±y
(
$İtiÚ
['title'])) {

1133 
$d©a
['cÚ‹Á'] .ğ
$İtiÚ
['title'] . ': ';

1136 
$d©a
['cÚ‹Á'] .ğ
$di¥Ïy
->
hªdËr
->
	`İtiÚ_lšk
(
$İtiÚ
['v®ue'], 
$id
, '', 
	`em±y
($option['desc']) ? '' : $option['desc']);

1137 ià(!
	`em±y
(
$di¥Ïy
->
hªdËr
->
İtiÚs
['deçuÉs'][
$id
])) {

1138 
$di¥Ïy_id
 = 'default';

1139 
$d©a
['deçuÉed'] = 
TRUE
;

1142 
$di¥Ïy_id
 = 
$di¥Ïy
->
id
;

1143 ià(!
$di¥Ïy
->
hªdËr
->
	`is_deçuÉ_di¥Ïy
()) {

1144 ià(
$di¥Ïy
->
hªdËr
->
	`deçuÉabË_£ùiÚs
(
$id
)) {

1145 
$d©a
['ov”ridd’'] = 
TRUE
;

1149 
$d©a
['şass'] = 
	`v›ws_ui_™em_css
(
$di¥Ïy_id
 . '-' . 
$id
);

1150 ià(!
	`em±y
(
$v›w
->
chªged_£ùiÚs
[
$di¥Ïy_id
 . '-' . 
$id
])) {

1151 
$d©a
['chªged'] = 
TRUE
;

1155 
$v¬s
['ÿ‹gÜ›s'] = 
$ÿ‹gÜ›s
;

1158 ià(
	`is£t
(
$¶ugš
['helpopic'])) {

1159 
$v¬s
['di¥Ïy_h–p_icÚ'] = 
	`theme
('advªûd_h–p_tİic', 
$¶ugš
['module'], $plugin['helpopic']);

1162 
$v¬s
['display_help_icon'] = '';

1166 
$¡yË_¶ugš
 = 
$di¥Ïy
->
hªdËr
->
	`g‘_¶ugš
();

1168 
$v¬s
['fields'] = '';

1169 
$v¬s
['f›lds'] = 
	`theme
('v›ws_ui_ed™_™em', 'f›ld', 
$v›w
, 
$di¥Ïy
, !(
$¡yË_¶ugš
 && $¡yË_¶ugš->
	`u£s_f›lds
()));

1170 
$v¬s
['»ÏtiÚshs'] = 
	`theme
('v›ws_ui_ed™_™em', '»ÏtiÚsh', 
$v›w
, 
$di¥Ïy
);

1171 
$v¬s
['¬gum’ts'] = 
	`theme
('v›ws_ui_ed™_™em', '¬gum’t', 
$v›w
, 
$di¥Ïy
);

1172 
$v¬s
['f‹rs'] = 
	`theme
('v›ws_ui_ed™_™em', 'f‹r', 
$v›w
, 
$di¥Ïy
);

1173 
$v¬s
['sÜts'] = 
	`theme
('v›ws_ui_ed™_™em', 'sÜt', 
$v›w
, 
$di¥Ïy
);

1174 
	}
}

1179 
funùiÚ
 
	$v›ws_ui_di¥Ïy_b
(
$v›w
, 
$di¥Ïy
) {

1180 ià(
	`is£t
(
$di¥Ïy
->
hªdËr
)) {

1181 
$¶ugš
 = 
$di¥Ïy
->
hªdËr
->
defš™iÚ
;

1183 ià(
	`em±y
(
$¶ugš
)) {

1184 
$t™Ë
 = 
	`is£t
(
$di¥Ïy
->
di¥Ïy_t™Ë
è? $di¥Ïy->di¥Ïy_t™Ë : 
	`t
('Invalid');

1185  
	`¬¿y
(
$t™Ë
, 
	`t
("E¼Ü: Di¥Ïy @di¥Ïy„eãr tØ¨¶ugš‚amed '@¶ugš', buˆth©…lugš dÛ¢'ˆexi¡!",‡¼ay('@di¥Ïy' => 
$di¥Ïy
->
id
, '@¶ugš' => $di¥Ïy->
di¥Ïy_¶ugš
)));

1191 ià(
	`em±y
(
$di¥Ïy
->
hªdËr
)) {

1192  
FALSE
;

1195 
$body
 = 
	`theme
('v›ws_ui_ed™_b', 
$v›w
, 
$di¥Ïy
);

1196  
	`¬¿y
(
$di¥Ïy
->
di¥Ïy_t™Ë
, 
$body
);

1197 
	}
}

1202 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_ui_ed™_™em
(&
$v¬s
) {

1203 
$ty³
 = 
$v¬s
['type'];

1204 
$v›w
 = 
$v¬s
['view'];

1205 
$di¥Ïy
 = 
$v¬s
['display'];

1207 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

1209 
$v¬s
['ov”ridd’'] = 
FALSE
;

1210 
$v¬s
['deçuÉed'] = 
FALSE
;

1212 ià(
$v¬s
['no_fields']) {

1213 
$v¬s
['t™Ë'] = 
$ty³s
[
$ty³
]['title'];

1214 
$v¬s
['™em_h–p_icÚ'] = 
	`theme
('advªûd_h–p_tİic', 'v›ws', 
$ty³
);

1215 
$v¬s
['»¬¿nge'] = 
NULL
;

1216 
$v¬s
['add'] = 
NULL
;

1220 
$v¬s
['»¬¿nge'] = 
	`l
('<¥ª>' . 
	`t
('R—¼ªge'è. '</¥ª>', "admš/bud/v›ws/nojs/»¬¿nge/$v›w->Çme/$di¥Ïy->id/$ty³", 
	`¬¿y
('©Œibu‹s' =>‡¼ay('şass' => 'v›ws-bu‰Ú-»¬¿ngv›ws-ajax-lšk', 't™Ë' =>('R—¼ªge')), 'html' => 
Œue
));

1222 
$v¬s
['add'] = 
	`l
('<¥ª>' . 
	`t
('Add'è. '</¥ª>', "admš/bud/v›ws/nojs/add-™em/$v›w->Çme/$di¥Ïy->id/$ty³", 
	`¬¿y
('©Œibu‹s' =>‡¼ay('şass' => 'v›ws-bu‰Ú-add v›ws-ajax-lšk', 't™Ë' =>('Add')), 'html' => 
Œue
));

1224 ià(!
$di¥Ïy
->
hªdËr
->
	`is_deçuÉ_di¥Ïy
()) {

1225 ià(!
$di¥Ïy
->
hªdËr
->
	`is_deçuÉed
(
$ty³s
[
$ty³
]['plural'])) {

1226 
$v¬s
['ov”ridd’'] = 
TRUE
;

1229 
$v¬s
['deçuÉed'] = 
TRUE
;

1233 
$v¬s
['t™Ë'] = 
	`l
(
$ty³s
[
$ty³
]['t™Ë'], "admš/bud/v›ws/nojs/cÚfig-ty³/$v›w->Çme/$di¥Ïy->id/$ty³", 
	`¬¿y
('attributes' =>‡rray('class' => 'views-ajax-link')));

1236 
$f›lds
 = 
	`¬¿y
();

1238 
$»ÏtiÚshs
 = 
NULL
;

1239 ià(!
	`is£t
(
$»ÏtiÚshs
)) {

1241 
$»ÏtiÚshs
 = 
	`¬¿y
();

1243 
	`fÜ—ch
 (
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('»ÏtiÚshs'è
as
 
$id
 => 
$»ÏtiÚsh
) {

1244 
$hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$»ÏtiÚsh
['table'], $relationship['field'], 'relationship');

1245 ià(
	`em±y
(
$hªdËr
)) {

1248 
$hªdËr
->
	`š™
(
$v›w
, 
$»ÏtiÚsh
);

1249 
$»ÏtiÚshs
[
$id
] = 
$hªdËr
->
	`Ïb–
();

1254 
	`fÜ—ch
 (
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
(
$ty³s
[
$ty³
]['¶u¿l']è
as
 
$id
 => 
$f›ld
) {

1255 
$f›lds
[
$id
] = 
	`¬¿y
();

1257 
$hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$f›ld
['bË'], $f›ld['f›ld'], 
$ty³
);

1258 ià(
	`em±y
(
$hªdËr
)) {

1259 
$f›lds
[
$id
]['class'] = 'broken';

1260 
$f›ld_Çme
 = 
	`t
('Brok’/missšg hªdËr: @bË > @f›ld', 
	`¬¿y
('@bË' => 
$f›ld
['table'], '@field' => $field['field']));

1261 
$f›lds
[
$id
]['t™Ë'] = 
	`l
(
$f›ld_Çme
, "admš/bud/v›ws/nojs/cÚfig-™em/$v›w->Çme/$di¥Ïy->id/$ty³/$id", 
	`¬¿y
('©Œibu‹s' =>‡¼ay('şass' => 'v›ws-ajax-lšk'), 'html' => 
TRUE
));

1262 
$f›lds
[
$id
]['info'] = '';

1265 
$hªdËr
->
	`š™
(
$v›w
, 
$f›ld
);

1267 
$f›ld_Çme
 = 
$hªdËr
->
	`ui_Çme
(
TRUE
);

1268 ià(!
	`em±y
(
$f›ld
['»ÏtiÚsh']è&& !em±y(
$»ÏtiÚshs
[$field['relationship']])) {

1269 
$f›ld_Çme
 = '(' . 
$»ÏtiÚshs
[
$f›ld
['relationship']] . ') ' . $field_name;

1272 
$f›lds
[
$id
]['t™Ë'] = 
	`l
(
$f›ld_Çme
, "admš/bud/v›ws/nojs/cÚfig-™em/$v›w->Çme/$di¥Ïy->id/$ty³/$id", 
	`¬¿y
('©Œibu‹s' =>‡¼ay('şass' => 'v›ws-ajax-lšk'), 'html' => 
TRUE
));

1273 
$f›lds
[
$id
]['şass'] = 
	`v›ws_ui_™em_css
(
$di¥Ïy
->
id
 . '-' . 
$ty³
 . '-' . $id);

1274 ià(!
	`em±y
(
$v›w
->
chªged_£ùiÚs
[
$di¥Ïy
->
id
 . '-' . 
$ty³
 . '-' . 
$id
])) {

1275 
$f›lds
[
$id
]['chªged'] = 
TRUE
;

1277 
$f›lds
[
$id
]['šfo'] = 
$hªdËr
->
	`admš_summ¬y
();

1279 ià(
$hªdËr
->
	`has_exŒa_İtiÚs
()) {

1280 
$f›lds
[
$id
]['lšks'] = 
	`l
('<¥ª>' . 
	`t
('S‘tšgs'è. '</¥ª>', "admš/bud/v›ws/nojs/cÚfig-™em-exŒa/$v›w->Çme/$di¥Ïy->id/$ty³/$id", 
	`¬¿y
('©Œibu‹s' =>‡¼ay('şass' => 'v›ws-bu‰Ú-cÚfigu» v›ws-ajax-lšk', 't™Ë' =>('S‘tšgs')), 'html' => 
Œue
));

1283 ià(
$hªdËr
->
	`Ãeds_¡yË_¶ugš
()) {

1284 
$¡yË_¶ugš
 = 
	`v›ws_ãtch_¶ugš_d©a
('¡yË', 
$hªdËr
->
İtiÚs
['style_plugin']);

1285 
$¡yË_t™Ë
 = 
	`em±y
(
$¡yË_¶ugš
['t™Ë']è? 
	`t
('Missing style…lugin') : $style_plugin['title'];

1286 
$pid
 = 
$id
 . '-style-plugin';

1288 ià(!
	`em±y
(
$¡yË_¶ugš
['uses options'])) {

1289 
$f›lds
[
$pid
]['lšks'] = 
	`l
('<¥ª>' . 
	`t
('Chªg£‰šg fÜhi ¡yË'è. '</¥ª>', "admš/bud/v›ws/nojs/cÚfig-¡yË/$v›w->Çme/$di¥Ïy->id/$ty³/$id", 
	`¬¿y
('©Œibu‹s' =>‡¼ay('şass' => 'v›ws-bu‰Ú-cÚfigu» v›ws-ajax-lšk', 't™Ë' =>('S‘tšgs')), 'html' => 
Œue
));

1292 
$f›lds
[
$pid
]['t™Ë'] = ' ' . 
	`t
('&nb¥; StyË: !¡yË', 
	`¬¿y
('!¡yË' => 
	`l
(
$¡yË_t™Ë
, "admin/build/views/nojs/change-style/$view->name/$display->id/$type/$id",‡rray('attributes' =>‡rray('class' => 'views-ajax-link')))));

1293 
$f›lds
[
$pid
]['şass'] = 
	`v›ws_ui_™em_css
(
$di¥Ïy
->
id
 . '-' . 
$ty³
 . '-' . $pid);

1294 ià(!
	`em±y
(
$v›w
->
chªged_£ùiÚs
[
$di¥Ïy
->
id
 . '-' . 
$ty³
 . '-' . 
$pid
])) {

1295 
$f›lds
[
$pid
]['chªged'] = 
TRUE
;

1297 
$f›lds
[
$pid
]['info'] = '';

1301 
$v¬s
['f›lds'] = 
$f›lds
;

1302 
$v¬s
['™em_h–p_icÚ'] = 
	`theme
('advªûd_h–p_tİic', 'v›ws', 
$ty³
);

1303 
	}
}

1308 
funùiÚ
 
	$v›ws_ui_»g’”©e_bs
(&
$v›w
, 
$di¥Ïy_id
 = 
NULL
, 
$objeù
 = NULL) {

1309 ià(
	`em±y
(
$di¥Ïy_id
)) {

1310 
$di¥Ïys
 = 
	`¬¿y_keys
(
$v›w
->
di¥Ïy
);

1312 
	`–£if
 (!
	`is_¬¿y
(
$di¥Ïy_id
)) {

1313 
$di¥Ïys
 = 
	`¬¿y
(
$di¥Ïy_id
);

1314 ià(
$di¥Ïy_id
 != 'default') {

1315 
$di¥Ïys
[] = 'default';

1319 
$di¥Ïys
 = 
$di¥Ïy_id
;

1322 ià(!
$v›w
->
	`£t_di¥Ïy
('default')) {

1323 
	`v›ws_ajax_»nd”
(
	`t
('Invalid display id found while„egeneratingabs'));

1326 ià(!
	`is_objeù
(
$objeù
)) {

1327 
$objeù
 = 
Ãw
 
	`¡dCÏss
();

1330 
$objeù
->
»¶aû
 = 
	`¬¿y
();

1331 
	`fÜ—ch
 (
$di¥Ïys
 
as
 
$id
) {

1332 
	`li¡
(
$t™Ë
, 
$body
èğ
	`v›ws_ui_di¥Ïy_b
(
$v›w
, $v›w->
di¥Ïy
[
$id
]);

1333 
$objeù
->
»¶aû
['#v›ws-b-' . 
$id
] = 
$body
;

1334 
$objeù
->
»¶aû
['#v›ws-b-t™Ë-' . 
$id
] = 
	`check_¶aš
(
$t™Ë
);

1337 ià(!
	`em±y
(
$v›w
->
chªged
)) {

1338 
$objeù
->
chªged
 = 
TRUE
;

1341 
	`v›ws_ajax_»nd”
(
$objeù
);

1342 
	}
}

1349 
funùiÚ
 
	$v›ws_ui_¡ªd¬d_fÜm_bu‰Ús
(&
$fÜm
, &
$fÜm_¡©e
, 
$fÜm_id
, 
$Çme
 = 
NULL
, 
$thœd
 = NULL, 
$subm™
 = NULL) {

1350 
$fÜm
['bu‰Ús'] = 
	`¬¿y
(

1355 ià(
	`em±y
(
$Çme
)) {

1356 
$Çme
 = 
	`t
('Update');

1359 
$fÜm
['#v®id©e'] = 
	`¬¿y
();

1361 ià(
	`em±y
(
$fÜm_¡©e
['ok_button'])) {

1363 
$fÜm
['bu‰Ús']['subm™'] = 
	`¬¿y
(

1365 '#v®ue' => 
$Çme
,

1366 '#subm™' => 
	`¬¿y
(
$fÜm_id
 . '_submit'),

1367 '#v®id©e' => 
	`¬¿y
('v›ws_ui_¡ªd¬d_subm™', 
$fÜm_id
 . '_validate'),

1371 
$ÿnûl_subm™
 = 
	`funùiÚ_exi¡s
(
$fÜm_id
 . '_cancel') ? $form_id . '_cancel' : 'views_ui_standard_cancel';

1372 
$fÜm
['bu‰Ús']['ÿnûl'] = 
	`¬¿y
(

1374 '#v®ue' => 
	`em±y
(
$fÜm_¡©e
['ok_bu‰Ú']è? 
	`t
('Cancel') :('Ok'),

1375 '#subm™' => 
	`¬¿y
(
$ÿnûl_subm™
),

1376 '#v®id©e' => 
	`¬¿y
(),

1379 ià(
$thœd
) {

1380 ià(
	`em±y
(
$subm™
)) {

1381 
$subm™
 = 'third';

1383 
$thœd_subm™
 = 
	`funùiÚ_exi¡s
(
$fÜm_id
 . '_' . 
$subm™
) ? $form_id . '_' . $submit : 'views_ui_standard_cancel';

1385 
$fÜm
['bu‰Ús'][
$subm™
] = 
	`¬¿y
(

1387 '#v®ue' => 
$thœd
,

1388 '#v®id©e' => 
	`¬¿y
(),

1389 '#subm™' => 
	`¬¿y
(
$thœd_subm™
),

1395 ià(
	`is£t
(
$fÜm
['#title'])) {

1396 
$fÜm_¡©e
['t™Ë'] = 
$fÜm
['#title'];

1398 ià(
	`is£t
(
$fÜm
['#help_topic'])) {

1399 
$fÜm_¡©e
['h–p_tİic'] = 
$fÜm
['#help_topic'];

1401 ià(
	`is£t
(
$fÜm
['#help_module'])) {

1402 
$fÜm_¡©e
['h–p_moduË'] = 
$fÜm
['#help_module'];

1404 ià(
	`is£t
(
$fÜm
['#url'])) {

1405 
$fÜm_¡©e
['u¾'] = 
$fÜm
['#url'];

1407 ià(
	`is£t
(
$fÜm
['#js'])) {

1408 ià(!
	`em±y
(
$fÜm_¡©e
['j £‰šgs']è&& 
	`is_¬¿y
($form_state['js settings'])) {

1409 
$fÜm_¡©e
['j £‰šgs'] = 
	`¬¿y_m”ge
($fÜm_¡©e['j £‰šgs'], 
$fÜm
['#js']);

1412 
$fÜm_¡©e
['j £‰šgs'] = 
$fÜm
['#js'];

1415 ià(
	`is£t
(
$fÜm
['#section'])) {

1416 
$fÜm_¡©e
['#£ùiÚ'] = 
$fÜm
['#section'];

1419 
$fÜm
['#no_ÿche'] = 
TRUE
;

1422 ià(!
	`em±y
(
$fÜm
['#title'])) {

1423 
	`dru·l_£t_t™Ë
(
$fÜm
['#title']);

1425 
	`v›ws_add_css
('views-admin');

1426 
	}
}

1431 
funùiÚ
 
	$v›ws_ui_¡ªd¬d_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1432 ià(!
	`em±y
(
$fÜm
['#section'])) {

1433 
$fÜm_¡©e
['v›w']->
chªged_£ùiÚs
[
$fÜm
['#£ùiÚ']] = 
TRUE
;

1435 
	}
}

1440 
funùiÚ
 
	$v›ws_ui_¡ªd¬d_ÿnûl
(
$fÜm
, &
$fÜm_¡©e
) {

1441 
$fÜm_¡©e
['»dœeù'] = 'admš/bud/v›ws/ed™/' . $fÜm_¡©e['v›w']->
Çme
;

1442 
	}
}

1447 
funùiÚ
 
	$v›ws_ui_ajax_fÜms
(
$key
 = 
NULL
) {

1448 
$fÜms
 = 
	`¬¿y
(

1449 'di¥Ïy' => 
	`¬¿y
(

1451 '¬gs' => 
	`¬¿y
('section'),

1453 '»move-di¥Ïy' => 
	`¬¿y
(

1455 '¬gs' => 
	`¬¿y
(),

1457 'cÚfig-ty³' => 
	`¬¿y
(

1459 '¬gs' => 
	`¬¿y
('type'),

1461 '»¬¿nge' => 
	`¬¿y
(

1463 '¬gs' => 
	`¬¿y
('type'),

1465 'add-™em' => 
	`¬¿y
(

1467 '¬gs' => 
	`¬¿y
('type'),

1469 'cÚfig-™em' => 
	`¬¿y
(

1471 '¬gs' => 
	`¬¿y
('type', 'id'),

1473 'cÚfig-™em-exŒa' => 
	`¬¿y
(

1475 '¬gs' => 
	`¬¿y
('type', 'id'),

1477 'chªge-¡yË' => 
	`¬¿y
(

1479 '¬gs' => 
	`¬¿y
('type', 'id'),

1481 'cÚfig-¡yË' => 
	`¬¿y
(

1483 '¬gs' => 
	`¬¿y
('type', 'id'),

1487 ià(
$key
) {

1488  !
	`em±y
(
$fÜms
[
$key
]è? $fÜms[$key] : 
NULL
;

1491  
$fÜms
;

1492 
	}
}

1499 
funùiÚ
 
	$v›ws_ui_bud_id’tif›r
(
$key
, 
$v›w
, 
$di¥Ïy_id
, 
$¬gs
) {

1500 
$fÜm
 = 
	`v›ws_ui_ajax_fÜms
(
$key
);

1501 
$id’tif›r
 = 
	`im¶ode
('-', 
	`¬¿y
(
$key
, 
$v›w
->
Çme
, 
$di¥Ïy_id
));

1503 
	`fÜ—ch
 (
$fÜm
['¬gs'] 
as
 
$id
) {

1504 
$¬g
 = (!
	`em±y
(
$¬gs
)è? 
	`¬¿y_shiá
($¬gsè: 
NULL
;

1505 
$id’tif›r
 .ğ'-' . 
$¬g
;

1507  
$id’tif›r
;

1508 
	}
}

1514 
funùiÚ
 
	$v›ws_ui_bud_fÜm_¡©e
(
$js
, 
$key
, &
$v›w
, 
$di¥Ïy_id
, 
$¬gs
) {

1515 
$fÜm
 = 
	`v›ws_ui_ajax_fÜms
(
$key
);

1517 
$fÜm_¡©e
 = 
	`¬¿y
(

1518 'fÜm_key' => 
$key
,

1519 'fÜm_id' => 
$fÜm
['form_id'],

1520 'v›w' => &
$v›w
,

1521 'ajax' => 
$js
,

1522 'di¥Ïy_id' => 
$di¥Ïy_id
,

1523 'no_»dœeù' => 
TRUE
,

1526 
	`fÜ—ch
 (
$fÜm
['¬gs'] 
as
 
$id
) {

1527 
$fÜm_¡©e
[
$id
] = (!
	`em±y
(
$¬gs
)è? 
	`¬¿y_shiá
($¬gsè: 
NULL
;

1530  
$fÜm_¡©e
;

1531 
	}
}

1537 
funùiÚ
 
	$v›ws_ui_bud_fÜm_u¾
(
$fÜm_¡©e
) {

1538 
$fÜm
 = 
	`v›ws_ui_ajax_fÜms
(
$fÜm_¡©e
['form_key']);

1539 
$ajax
 = 
	`em±y
(
$fÜm_¡©e
['ajax']) ? 'nojs' : 'ajax';

1540 
$Çme
 = 
$fÜm_¡©e
['v›w']->
Çme
;

1541 
$u¾
 = "admin/build/views/$ajax/$form_state[form_key]/$name/$form_state[display_id]";

1542 
	`fÜ—ch
 (
$fÜm
['¬gs'] 
as
 
$¬g
) {

1543 
$u¾
 .ğ'/' . 
$fÜm_¡©e
[
$¬g
];

1545  
$u¾
;

1546 
	}
}

1552 
funùiÚ
 
	$v›ws_ui_add_fÜm_to_¡ack
(
$key
, &
$v›w
, 
$di¥Ïy_id
, 
$¬gs
, 
$tİ
 = 
FALSE
) {

1553 ià(
	`em±y
(
$v›w
->
¡ack
)) {

1554 
$v›w
->
¡ack
 = 
	`¬¿y
();

1557 
$¡ack
 = 
	`¬¿y
(
	`v›ws_ui_bud_id’tif›r
(
$key
, 
$v›w
, 
$di¥Ïy_id
, 
$¬gs
), $key, &$view, $display_id, $args);

1558 ià(
$tİ
) {

1559 
	`¬¿y_unshiá
(
$v›w
->
¡ack
, 
$¡ack
);

1562 
$v›w
->
¡ack
[] = 
$¡ack
;

1564 
	}
}

1574 
funùiÚ
 
	$v›ws_ui_ajax_fÜm
(
$js
, 
$key
, 
$v›w
, 
$di¥Ïy_id
) {

1575 
$fÜm
 = 
	`v›ws_ui_ajax_fÜms
(
$key
);

1576 ià(
	`em±y
(
$fÜm
)) {

1577  
	`dru·l_nÙ_found
();

1580 
	`v›ws_šşude
('ajax');

1581 
$¬gs
 = 
	`func_g‘_¬gs
();

1583 
	`¬¿y_¥liû
(
$¬gs
, 0, 4);

1585 
$fÜm_¡©e
 = 
	`v›ws_ui_bud_fÜm_¡©e
(
$js
, 
$key
, 
$v›w
, 
$di¥Ïy_id
, 
$¬gs
);

1589 ià(!
	`em±y
(
$v›w
->
¡ack
)) {

1590 
$id’tif›r
 = 
	`v›ws_ui_bud_id’tif›r
(
$key
, 
$v›w
, 
$di¥Ïy_id
, 
$¬gs
);

1591 
$tİ
 = 
	`¬¿y_shiá
(
$v›w
->
¡ack
);

1592 ià(
	`¬¿y_shiá
(
$tİ
è!ğ
$id’tif›r
) {

1593 
$v›w
->
¡ack
 = 
	`¬¿y
();

1597 
$ouut
 = 
	`v›ws_ajax_fÜm_w¿µ”
(
$fÜm_¡©e
['form_id'], $form_state);

1599 ià(!
$ouut
) {

1601 
$objeù
 = 
NULL
;

1602 ià(!
	`em±y
(
$v›w
->
¡ack
)) {

1603 
$¡ack
 = 
$v›w
->
¡ack
;

1604 
$tİ
 = 
	`¬¿y_shiá
(
$¡ack
);

1605 
$tİ
[0] = 
$js
;

1606 
$fÜm_¡©e
 = 
	`ÿÎ_u£r_func_¬¿y
('v›ws_ui_bud_fÜm_¡©e', 
$tİ
);

1607 
$fÜm_¡©e
['šput'] = 
	`¬¿y
();

1609 ià(!
$js
) {

1610  
	`dru·l_gÙo
(
	`v›ws_ui_bud_fÜm_u¾
(
$fÜm_¡©e
));

1612 
$objeù
 = 
	`v›ws_ajax_fÜm_w¿µ”
(
$fÜm_¡©e
['form_id'], $form_state);

1613 
$objeù
->
u¾
 = 
	`u¾
(
	`v›ws_ui_bud_fÜm_u¾
(
$fÜm_¡©e
));

1615 ià(!
$js
) {

1617  
	`dru·l_gÙo
("admin/build/views/edit/$view->name");

1620  
	`v›ws_ui_»g’”©e_bs
(
$v›w
, 
NULL
, 
$objeù
);

1623  (
$js
è? 
	`v›ws_ajax_»nd”
(
$ouut
) : $output;

1624 
	}
}

1629 
funùiÚ
 
	$v›ws_ui_add_di¥Ïy
(
$js
, 
$v›w
) {

1630 
	`v›ws_šşude
('ajax');

1631 
$fÜm_¡©e
 = 
	`¬¿y
(

1632 'v›w' => &
$v›w
,

1633 'ajax' => 
$js
,

1636 
$ouut
 = 
	`v›ws_ajax_fÜm_w¿µ”
('v›ws_ui_add_di¥Ïy_fÜm', 
$fÜm_¡©e
);

1638 ià(
$js
) {

1640 ià(
	`em±y
(
$ouut
)) {

1641 
$id
 = 
$fÜm_¡©e
['id'];

1644 ià(!
$v›w
->
	`£t_di¥Ïy
('default')) {

1645 
	`v›ws_ajax_»nd”
(
	`t
('Unableo initialize default display'));

1649 
	`li¡
(
$t™Ë
, 
$body
èğ
	`v›ws_ui_di¥Ïy_b
(
$v›w
, $v›w->
di¥Ïy
[
$id
]);

1652 
$ouut
 = 
Ãw
 
¡dCÏss
;

1653 
$ouut
->
b
 = 
	`¬¿y
('#v›ws-b-' . 
$id
 =>‡¼ay('t™Ë' => 
$t™Ë
, 'body' => 
$body
));

1656 
	`v›ws_ajax_»nd”
(
$ouut
);

1660  
$ouut
;

1661 
	}
}

1666 
funùiÚ
 
	$v›ws_ui_add_di¥Ïy_fÜm
(&
$fÜm_¡©e
) {

1667 
$v›w
 = &
$fÜm_¡©e
['view'];

1669 
$fÜm
['di¥Ïy']['di¥Ïy'] = 
	`¬¿y
(

1671 '#İtiÚs' => 
	`v›ws_ãtch_¶ugš_Çmes
('display'),

1675 
$fÜm
['di¥Ïy']['add_di¥Ïy'] = 
	`¬¿y
(

1677 '#v®ue' => 
	`t
('Add display'),

1678 '#subm™' => 
	`¬¿y
('views_ui_add_display_form_submit'),

1681 
$fÜm
['#id'] = 'views-add-display-form';

1682 
$fÜm
['#©Œibu‹s'] = 
	`¬¿y
('class' => 'views-ajax-form');

1683 
$fÜm
['#aùiÚ'] = 
	`u¾
("admin/build/views/nojs/add-display/$view->name");

1685  
$fÜm
;

1686 
	}
}

1691 
funùiÚ
 
	$v›ws_ui_add_di¥Ïy_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1693 
$¶ugš
 = 
$fÜm_¡©e
['values']['display'];

1694 
$fÜm_¡©e
['id'] = $fÜm_¡©e['v›w']->
	`add_di¥Ïy
(
$¶ugš
);

1697 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

1700 
$fÜm_¡©e
['»dœeù'] = 
	`¬¿y
('admš/bud/v›ws/ed™/' . $fÜm_¡©e['v›w']->
Çme
, 
NULL
, 'views-tab-' . $form_state['id']);

1701 
	}
}

1706 
funùiÚ
 
	$v›ws_ui_»move_di¥Ïy_fÜm
(&
$fÜm_¡©e
) {

1707 
$v›w
 = &
$fÜm_¡©e
['view'];

1708 
$di¥Ïy_id
 = 
$fÜm_¡©e
['display_id'];

1710 ià(
	`em±y
(
$v›w
->
di¥Ïy
[
$di¥Ïy_id
]->
d–‘ed
)) {

1711 
$fÜm
['di¥Ïy'] = 
	`¬¿y
(

1715 
$fÜm
['»move_di¥Ïy'] = 
	`¬¿y
(

1717 '#v®ue' => 
	`t
('Remove display'),

1718 '#subm™' => 
	`¬¿y
('views_ui_remove_display_form_submit'),

1722 
$fÜm
['di¥Ïy'] = 
	`¬¿y
(

1726 
$fÜm
['»¡Üe_di¥Ïy'] = 
	`¬¿y
(

1728 '#v®ue' => 
	`t
('Restore display'),

1729 '#subm™' => 
	`¬¿y
('views_ui_remove_display_form_restore'),

1732 
$fÜm
['#aùiÚ'] = 
	`u¾
("admin/build/views/nojs/remove-display/$view->name/$display_id");

1733 
$fÜm
['#©Œibu‹s'] = 
	`¬¿y
('class' => 'views-ajax-form');

1735  
$fÜm
;

1736 
	}
}

1741 
funùiÚ
 
	$v›ws_ui_»move_di¥Ïy_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1743 
$¶ugš
 = 
	`v›ws_ãtch_¶ugš_d©a
('di¥Ïy', 
$fÜm_¡©e
['v›w']->
di¥Ïy
[$fÜm_¡©e['di¥Ïy_id']]->
di¥Ïy_¶ugš
);

1744 ià(
	`em±y
(
$¶ugš
['no„emove'])) {

1745 
$id
 = 
$fÜm_¡©e
['display_id'];

1746 
$fÜm_¡©e
['v›w']->
di¥Ïy
[
$id
]->
d–‘ed
 = 
TRUE
;

1749 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

1751 
	}
}

1756 
funùiÚ
 
	$v›ws_ui_»move_di¥Ïy_fÜm_»¡Üe
(
$fÜm
, &
$fÜm_¡©e
) {

1758 
$id
 = 
$fÜm_¡©e
['display_id'];

1759 
$fÜm_¡©e
['v›w']->
di¥Ïy
[
$id
]->
d–‘ed
 = 
FALSE
;

1762 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

1763 
	}
}

1768 
funùiÚ
 
	$v›ws_ui_ª®yze_v›w
(
$js
, 
$v›w
) {

1769 
	`v›ws_šşude
('ajax');

1770 
$fÜm_¡©e
 = 
	`¬¿y
(

1771 'v›w' => &
$v›w
,

1772 'ajax' => 
$js
,

1775 
$ouut
 = 
	`v›ws_ajax_fÜm_w¿µ”
('v›ws_ui_ª®yze_v›w_fÜm', 
$fÜm_¡©e
);

1777 ià(
$js
) {

1779 ià(
	`em±y
(
$ouut
)) {

1780  
	`v›ws_ui_»g’”©e_bs
(
$v›w
);

1782  
	`v›ws_ajax_»nd”
(
$ouut
);

1785  
$ouut
;

1786 
	}
}

1795 
funùiÚ
 
	$v›ws_ui_ª®yze_v›w_bu‰Ú
(&
$fÜm_¡©e
, 
$v›w
) {

1796 
$fÜm
['#aùiÚ'] = 
	`u¾
("admin/build/views/nojs/analyze/$view->name");

1797 
$fÜm
['#©Œibu‹s'] = 
	`¬¿y
('class' => 'views-ajax-form');

1798 
$fÜm
['subm™'] = 
	`¬¿y
(

1800 '#v®ue' => 
	`t
('Analyze'),

1803  
$fÜm
;

1804 
	}
}

1809 
funùiÚ
 
	$v›ws_ui_ª®yze_v›w_fÜm
(&
$fÜm_¡©e
) {

1810 
$v›w
 = &
$fÜm_¡©e
['view'];

1812 
$fÜm
['#t™Ë'] = 
	`t
('View‡nalysis');

1813 
$fÜm
['#section'] = 'analyze';

1815 
	`v›ws_šşude
('analyze');

1816 
$mes§ges
 = 
	`v›ws_ª®yze_v›w
(
$v›w
);

1818 
$fÜm
['ª®ysis'] = 
	`¬¿y
(

1821 '#v®ue' => 
	`v›ws_ª®yze_fÜm©_»suÉ
(
$v›w
, 
$mes§ges
),

1825 
$fÜm_¡©e
['ok_bu‰Ú'] = 
TRUE
;

1826 
	`v›ws_ui_¡ªd¬d_fÜm_bu‰Ús
(
$fÜm
, 
$fÜm_¡©e
, 'views_ui_analyze_view_form');

1827  
$fÜm
;

1828 
	}
}

1833 
funùiÚ
 
	$v›ws_ui_ª®yze_v›w_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1834 
$fÜm_¡©e
['»dœeù'] = 'admš/bud/v›ws/ed™/' . $fÜm_¡©e['v›w']->
Çme
;

1835 
	}
}

1840 
funùiÚ
 
	$v›ws_ui_ed™_d‘as
(
$js
, 
$v›w
) {

1841 
	`v›ws_šşude
('ajax');

1842 
$fÜm_¡©e
 = 
	`¬¿y
(

1843 'v›w' => &
$v›w
,

1844 'ajax' => 
$js
,

1847 
$ouut
 = 
	`v›ws_ajax_fÜm_w¿µ”
('v›ws_ui_ed™_d‘as_fÜm', 
$fÜm_¡©e
);

1849 ià(
$js
) {

1851 ià(
	`em±y
(
$ouut
)) {

1852  
	`v›ws_ui_»g’”©e_bs
(
$v›w
);

1854  
	`v›ws_ajax_»nd”
(
$ouut
);

1857  
$ouut
;

1858 
	}
}

1863 
funùiÚ
 
	$v›ws_ui_ed™_d‘as_fÜm
(&
$fÜm_¡©e
) {

1864 
$v›w
 = &
$fÜm_¡©e
['view'];

1866 
$fÜm
['#t™Ë'] = 
	`t
('View details');

1867 
$fÜm
['#section'] = 'details';

1869 
$fÜm
['desütiÚ'] = 
	`¬¿y
(

1871 '#t™Ë' => 
	`t
('View description'),

1872 '#desütiÚ' => 
	`t
('This description will‡ppear onhe Views‡dministrative UIoell you whathe view is‡bout.'),

1873 '#deçuÉ_v®ue' => 
$v›w
->
desütiÚ
,

1876 
$fÜm
['g'] = 
	`¬¿y
(

1878 '#t™Ë' => 
	`t
('Viewag'),

1879 '#desütiÚ' => 
	`t
('Enter‡n optionalag forhis view; it is used onlyo help sort views onhe‡dministrative…age.'),

1880 '#deçuÉ_v®ue' => 
$v›w
->
g
,

1884 
	`v›ws_ui_¡ªd¬d_fÜm_bu‰Ús
(
$fÜm
, 
$fÜm_¡©e
, 'views_ui_edit_details_form');

1885  
$fÜm
;

1886 
	}
}

1891 
funùiÚ
 
	$v›ws_ui_ed™_d‘as_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1892 
$fÜm_¡©e
['v›w']->
desütiÚ
 = $form_state['values']['description'];

1893 
$fÜm_¡©e
['v›w']->
g
 = $form_state['values']['tag'];

1894 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

1895 
$fÜm_¡©e
['»dœeù'] = 'admš/bud/v›ws/ed™/' . $fÜm_¡©e['v›w']->
Çme
;

1896 
	}
}

1901 
funùiÚ
 
	$v›ws_ui_ed™_di¥Ïy_fÜm
(&
$fÜm_¡©e
) {

1902 
$v›w
 = &
$fÜm_¡©e
['view'];

1903 
$di¥Ïy_id
 = 
$fÜm_¡©e
['display_id'];

1904 
$£ùiÚ
 = 
$fÜm_¡©e
['section'];

1906 ià(!
$v›w
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

1907 
	`v›ws_ajax_»nd”
(
	`t
('Inv®id di¥Ïy id @di¥Ïy', 
	`¬¿y
('@di¥Ïy' => 
$di¥Ïy_id
)));

1909 
$di¥Ïy
 = &
$v›w
->
di¥Ïy
[
$di¥Ïy_id
];

1912 
$di¥Ïy
->
hªdËr
->
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

1913 
$Çme
 = 
NULL
;

1914 ià(
	`is£t
(
$fÜm_¡©e
['update_name'])) {

1915 
$Çme
 = 
$fÜm_¡©e
['update_name'];

1918 
	`v›ws_ui_¡ªd¬d_fÜm_bu‰Ús
(
$fÜm
, 
$fÜm_¡©e
, 'v›ws_ui_ed™_di¥Ïy_fÜm', 
$Çme
);

1919  
$fÜm
;

1920 
	}
}

1925 
funùiÚ
 
	$v›ws_ui_ed™_di¥Ïy_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

1926 
$di¥Ïy
 = &
$fÜm_¡©e
['v›w']->
di¥Ïy
[$form_state['display_id']];

1927 
$di¥Ïy
->
hªdËr
->
	`İtiÚs_v®id©e
(
$fÜm
, 
$fÜm_¡©e
);

1928 
	}
}

1933 
funùiÚ
 
	$v›ws_ui_ed™_di¥Ïy_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1934 
$di¥Ïy
 = &
$fÜm_¡©e
['v›w']->
di¥Ïy
[$form_state['display_id']];

1935 
$di¥Ïy
->
hªdËr
->
	`İtiÚs_subm™
(
$fÜm
, 
$fÜm_¡©e
);

1937 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

1938 
	}
}

1943 
funùiÚ
 
	$v›ws_ui_ed™_di¥Ïy_fÜm_ov”ride
(
$fÜm
, &
$fÜm_¡©e
) {

1944 
$di¥Ïy
 = &
$fÜm_¡©e
['v›w']->
di¥Ïy
[$form_state['display_id']];

1945 
$di¥Ïy
->
hªdËr
->
	`İtiÚs_ov”ride
(
$fÜm
, 
$fÜm_¡©e
);

1947 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

1948 
$fÜm_¡©e
['»»nd”'] = 
TRUE
;

1949 
$fÜm_¡©e
['»bud'] = 
TRUE
;

1950 
	}
}

1954 
funùiÚ
 
	$v›ws_ui_cÚfig_ty³_fÜm
(&
$fÜm_¡©e
) {

1955 
$v›w
 = &
$fÜm_¡©e
['view'];

1956 
$di¥Ïy_id
 = 
$fÜm_¡©e
['display_id'];

1957 
$ty³
 = 
$fÜm_¡©e
['type'];

1959 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

1960 ià(!
$v›w
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

1961 
	`v›ws_ajax_»nd”
(
	`t
('Inv®id di¥Ïy id @di¥Ïy', 
	`¬¿y
('@di¥Ïy' => 
$di¥Ïy_id
)));

1963 
$di¥Ïy
 = &
$v›w
->
di¥Ïy
[
$di¥Ïy_id
];

1964 
$fÜm
['#t™Ë'] = 
	`check_¶aš
(
$di¥Ïy
->
di¥Ïy_t™Ë
) . ': ';

1965 
$fÜm
['#t™Ë'] .ğ
	`t
('CÚfigu» @ty³', 
	`¬¿y
('@ty³' => 
$ty³s
[
$ty³
]['ltitle']));

1966 
$fÜm
['#£ùiÚ'] = 
$di¥Ïy_id
 . 'config-item';

1968 ià(
$di¥Ïy
->
hªdËr
->
	`deçuÉabË_£ùiÚs
(
$ty³s
[
$ty³
]['plural'])) {

1969 
$fÜm_¡©e
['£ùiÚ'] = 
$ty³s
[
$ty³
]['plural'];

1970 
$di¥Ïy
->
hªdËr
->
	`add_ov”ride_bu‰Ú
(
$fÜm
, 
$fÜm_¡©e
, $form_state['section']);

1973 ià(!
	`em±y
(
$ty³s
[
$ty³
]['İtiÚs']è&& 
	`funùiÚ_exi¡s
($types[$type]['options'])) {

1974 
$İtiÚs
 = 
$ty³
 . '_options';

1975 
$fÜm
[
$İtiÚs
] = 
	`¬¿y
('#Œ“' => 
TRUE
);

1976 
$ty³s
[
$ty³
]['İtiÚs'](
$fÜm
, 
$fÜm_¡©e
);

1979 
$Çme
 = 
NULL
;

1980 ià(
	`is£t
(
$fÜm_¡©e
['update_name'])) {

1981 
$Çme
 = 
$fÜm_¡©e
['update_name'];

1984 
	`v›ws_ui_¡ªd¬d_fÜm_bu‰Ús
(
$fÜm
, 
$fÜm_¡©e
, 'v›ws_ui_cÚfig_ty³_fÜm', 
$Çme
);

1985  
$fÜm
;

1986 
	}
}

1991 
funùiÚ
 
	$v›ws_ui_cÚfig_ty³_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

1992 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

1993 
$di¥Ïy
 = &
$fÜm_¡©e
['v›w']->
di¥Ïy
[$form_state['display_id']];

1996 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

1997 
	}
}

2002 
funùiÚ
 
	$v›ws_ui_cÚfig_f‹rs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

2004 
	}
}

2009 
funùiÚ
 
	$v›ws_ui_»¬¿nge_fÜm
(&
$fÜm_¡©e
) {

2010 
$v›w
 = &
$fÜm_¡©e
['view'];

2011 
$di¥Ïy_id
 = 
$fÜm_¡©e
['display_id'];

2012 
$ty³
 = 
$fÜm_¡©e
['type'];

2014 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

2015 ià(!
$v›w
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

2016 
	`v›ws_ajax_»nd”
(
	`t
('Inv®id di¥Ïy id @di¥Ïy', 
	`¬¿y
('@di¥Ïy' => 
$di¥Ïy_id
)));

2018 
$di¥Ïy
 = &
$v›w
->
di¥Ïy
[
$di¥Ïy_id
];

2019 
$fÜm
['#t™Ë'] = 
	`check_¶aš
(
$di¥Ïy
->
di¥Ïy_t™Ë
) . ': ';

2020 
$fÜm
['#t™Ë'] .ğ
	`t
('R—¼ªg@ty³', 
	`¬¿y
('@ty³' => 
$ty³s
[
$ty³
]['ltitle']));

2021 
$fÜm
['#£ùiÚ'] = 
$di¥Ïy_id
 . 'rearrange-item';

2023 ià(
$di¥Ïy
->
hªdËr
->
	`deçuÉabË_£ùiÚs
(
$ty³s
[
$ty³
]['plural'])) {

2024 
$fÜm_¡©e
['£ùiÚ'] = 
$ty³s
[
$ty³
]['plural'];

2025 
$di¥Ïy
->
hªdËr
->
	`add_ov”ride_bu‰Ú
(
$fÜm
, 
$fÜm_¡©e
, $form_state['section']);

2028 
$couÁ
 = 0;

2031 
$»ÏtiÚshs
 = 
	`¬¿y
();

2033 
	`fÜ—ch
 (
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('»ÏtiÚshs'è
as
 
$id
 => 
$»ÏtiÚsh
) {

2034 
$hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$»ÏtiÚsh
['table'], $relationship['field'], 'relationship');

2035 ià(
	`em±y
(
$hªdËr
)) {

2038 
$hªdËr
->
	`š™
(
$v›w
, 
$»ÏtiÚsh
);

2039 
$»ÏtiÚshs
[
$id
] = 
$hªdËr
->
	`Ïb–
();

2043 
	`fÜ—ch
 (
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
(
$ty³s
[
$ty³
]['¶u¿l']è
as
 
$id
 => 
$f›ld
) {

2044 
$fÜm
[
$id
] = 
	`¬¿y
('#Œ“' => 
TRUE
);

2045 
$fÜm
[
$id
]['weight'] = 
	`¬¿y
(

2048 '#deçuÉ_v®ue' => ++
$couÁ
,

2050 
$hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$f›ld
['bË'], $f›ld['f›ld'], 
$ty³
);

2051 ià(
$hªdËr
) {

2052 
$hªdËr
->
	`š™
(
$v›w
, 
$f›ld
);

2053 
$Çme
 = 
$hªdËr
->
	`ui_Çme
(è. ' ' . $hªdËr->
	`admš_summ¬y
();

2054 ià(!
	`em±y
(
$f›ld
['»ÏtiÚsh']è&& !em±y(
$»ÏtiÚshs
[$field['relationship']])) {

2055 
$Çme
 = '(' . 
$»ÏtiÚshs
[
$f›ld
['relationship']] . ') ' . $name;

2058 
$fÜm
[
$id
]['Çme'] = 
	`¬¿y
(

2059 '#v®ue' => 
$Çme
,

2063 
$fÜm
[
$id
]['Çme'] = 
	`¬¿y
('#v®ue' => 
	`t
('Broken field @id',‡rray('@id' => $id)));

2065 
$fÜm
[
$id
]['»moved'] = 
	`¬¿y
(

2067 '#id' => 'v›ws-»moved-' . 
$id
,

2068 '#©Œibu‹s' => 
	`¬¿y
('class' => 'views-remove-checkbox'),

2074 
$fÜm
['#js']['bËD¿g']['¬¿nge']['weight'][0] = 
	`¬¿y
(

2076 'sourû' => 
NULL
,

2079 'hidd’' => 
TRUE
,

2083 
$Çme
 = 
NULL
;

2084 ià(
	`is£t
(
$fÜm_¡©e
['update_name'])) {

2085 
$Çme
 = 
$fÜm_¡©e
['update_name'];

2088 
	`v›ws_ui_¡ªd¬d_fÜm_bu‰Ús
(
$fÜm
, 
$fÜm_¡©e
, 'views_ui_rearrange_form');

2089  
$fÜm
;

2090 
	}
}

2095 
funùiÚ
 
	$theme_v›ws_ui_»¬¿nge_fÜm
(
$fÜm
) {

2096 
$rows
 = 
	`¬¿y
();

2097 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
è
as
 
$id
) {

2098 ià(
	`is£t
(
$fÜm
[
$id
]['name'])) {

2099 
$row
 = 
	`¬¿y
();

2100 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
[
$id
]['name']);

2101 
$fÜm
[
$id
]['weight']['#attributes']['class'] = 'weight';

2102 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
[
$id
]['weight']);

2103 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
[
$id
]['»moved']è. 
	`l
('<¥ª>' . 
	`t
('Remove'è. '</¥ª>', 'javasüt:void()', 
	`¬¿y
('©Œibu‹s' =>‡¼ay('id' => 'v›ws-»move-lšk-' . $id, 'şass' => 'v›ws-bu‰Ú-»movv›ws-»move-lšk', '®t' =>('Removthi ™em'), 't™Ë' =>('Removthi ™em')), 'html' => 
Œue
));

2105 
$rows
[] = 
	`¬¿y
('d©a' => 
$row
, 'şass' => 'd¿ggabË', 'id' => 'v›ws-row-' . 
$id
);

2108 ià(
	`em±y
(
$rows
)) {

2109 
$rows
[] = 
	`¬¿y
×¼ay('d©a' => 
	`t
('No fields‡vailable.'), 'colspan' => '2'));

2112 
$h—d”
 = 
	`¬¿y
('', 
	`t
('Weight'),('Remove'));

2113 
	`dru·l_add_bËd¿g
('arrange', 'order', 'sibling', 'weight');

2114 
$ouut
 = 
	`dru·l_»nd”
(
$fÜm
['override']);

2115 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
, 
	`¬¿y
('id' => 'arrange'));

2116 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

2117  
$ouut
;

2119 
	}
}

2124 
funùiÚ
 
	$v›ws_ui_»¬¿nge_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

2125 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

2126 
$di¥Ïy
 = &
$fÜm_¡©e
['v›w']->
di¥Ïy
[$form_state['display_id']];

2128 
$Şd_f›lds
 = 
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
(
$ty³s
[
$fÜm_¡©e
['type']]['plural']);

2129 
$Ãw_f›lds
 = 
$Üd”
 = 
	`¬¿y
();

2132 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues'] 
as
 
$f›ld
 => 
$šfo
) {

2135 ià(
	`is_¬¿y
(
$šfo
è&& 
	`is£t
($šfo['weight']è&& 
	`em±y
($info['removed'])) {

2136 
$Üd”
[
$f›ld
] = 
$šfo
['weight'];

2141 
	`asÜt
(
$Üd”
);

2144 
	`fÜ—ch
 (
	`¬¿y_keys
(
$Üd”
è
as
 
$f›ld
) {

2145 
$Ãw_f›lds
[
$f›ld
] = 
$Şd_f›lds
[$field];

2147 
$di¥Ïy
->
hªdËr
->
	`£t_İtiÚ
(
$ty³s
[
$fÜm_¡©e
['ty³']]['¶u¿l'], 
$Ãw_f›lds
);

2150 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

2151 
	}
}

2156 
funùiÚ
 
	$v›ws_ui_add_™em_fÜm
(&
$fÜm_¡©e
) {

2157 
$v›w
 = &
$fÜm_¡©e
['view'];

2158 
$di¥Ïy_id
 = 
$fÜm_¡©e
['display_id'];

2159 
$ty³
 = 
$fÜm_¡©e
['type'];

2161 ià(!
$v›w
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

2162 
	`v›ws_ajax_»nd”
(
	`t
('Inv®id di¥Ïy id @di¥Ïy', 
	`¬¿y
('@di¥Ïy' => 
$di¥Ïy_id
)));

2164 
$di¥Ïy
 = &
$v›w
->
di¥Ïy
[
$di¥Ïy_id
];

2166 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

2167 
$fÜm
['#t™Ë'] = 
	`check_¶aš
(
$di¥Ïy
->
di¥Ïy_t™Ë
) . ': ';

2168 
$fÜm
['#t™Ë'] .ğ
	`t
('Add @ty³', 
	`¬¿y
('@ty³' => 
$ty³s
[
$ty³
]['ltitle']));

2169 
$fÜm
['#£ùiÚ'] = 
$di¥Ïy_id
 . 'add-item';

2172 
$ba£_bËs
 = 
$v›w
->
	`g‘_ba£_bËs
();

2173 
$İtiÚs
 = 
	`v›ws_ãtch_f›lds
(
	`¬¿y_keys
(
$ba£_bËs
), 
$ty³
);

2175 ià(!
	`em±y
(
$İtiÚs
)) {

2176 
$groups
 = 
	`¬¿y
('®l' => 
	`t
('<All>'));

2177 
$fÜm
['group'] = 
	`¬¿y
(

2179 '#t™Ë' => 
	`t
('Groups'),

2180 '#İtiÚs' => 
	`¬¿y
(),

2181 '#©Œibu‹s' => 
	`¬¿y
('class' => 'views-master-dependent'),

2184 
$fÜm
['Çme'] = 
	`¬¿y
(

2187 '#Œ“' => 
TRUE
,

2193 
$grou³d_İtiÚs
 = 
	`¬¿y
();

2194 
	`fÜ—ch
 (
$İtiÚs
 
as
 
$key
 => 
$İtiÚ
) {

2195 
$group
 = 
	`´eg_»¶aû
('/[^a-z0-9]/', '-', 
	`¡¹Şow”
(
$İtiÚ
['group']));

2196 
$groups
[
$group
] = 
$İtiÚ
['group'];

2197 
$grou³d_İtiÚs
[
$group
][
$key
] = 
$İtiÚ
;

2200 
	`fÜ—ch
 (
$grou³d_İtiÚs
 
as
 
$group
 => 
$group_İtiÚs
) {

2201 
$fÜm
['Çme'][
$group
 . '_¡¬t'] = 
	`¬¿y
('#type' => 'markup', '#value' => '<div class="views-dependent-all views-dependent-' . $group . '">');

2202 
	`fÜ—ch
 (
$group_İtiÚs
 
as
 
$key
 => 
$İtiÚ
) {

2203 
$fÜm
['Çme'][
$key
] = 
	`¬¿y
(

2205 '#t™Ë' => 
	`t
('!group: !f›ld', 
	`¬¿y
('!group' => 
$İtiÚ
['group'], '!field' => $option['title'])),

2206 '#desütiÚ' => 
$İtiÚ
['help'],

2207 '#»tuº_v®ue' => 
$key
,

2210 
$fÜm
['Çme'][
$group
 . '_’d'] = 
	`¬¿y
('#type' => 'markup', '#value' => '</div>');

2213 
$fÜm
['group']['#İtiÚs'] = 
$groups
;

2216 
$fÜm
['m¬kup'] = 
	`¬¿y
(

2217 '#v®ue' => '<div cÏss="fÜm-™em">' . 
	`t
('Th”¬nØ@ty³ avaabËØadd.', 
	`¬¿y
('@ty³s' => 
$ty³s
[
$ty³
]['ltitle'])) . '</div>',

2220 
	`v›ws_ui_¡ªd¬d_fÜm_bu‰Ús
(
$fÜm
, 
$fÜm_¡©e
, 'v›ws_ui_add_™em_fÜm', 
	`t
('Add'));

2222  
$fÜm
;

2223 
	}
}

2228 
funùiÚ
 
	$v›ws_ui_add_™em_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

2229 
$ty³
 = 
$fÜm_¡©e
['type'];

2230 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

2232 ià(!
	`em±y
(
$fÜm_¡©e
['v®ues']['Çme']è&& 
	`is_¬¿y
($form_state['values']['name'])) {

2234 
	`fÜ—ch
 (
	`¬¿y_keys
(
	`¬¿y_f‹r
(
$fÜm_¡©e
['v®ues']['Çme'])è
as
 
$f›ld
) {

2235 
	`li¡
(
$bË
, 
$f›ld
èğ
	`ex¶ode
('.', $field, 2);

2236 
$id
 = 
$fÜm_¡©e
['v›w']->
	`add_™em
($fÜm_¡©e['di¥Ïy_id'], 
$ty³
, 
$bË
, 
$f›ld
);

2239 
$hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$bË
, 
$f›ld
, 
$ty³
);

2240 ià(
$hªdËr
 && $hªdËr->
	`has_exŒa_İtiÚs
()) {

2241 
	`v›ws_ui_add_fÜm_to_¡ack
('cÚfig-™em-exŒa', 
$fÜm_¡©e
['v›w'], $fÜm_¡©e['di¥Ïy_id'], 
	`¬¿y
(
$ty³
, 
$id
));

2244 
	`v›ws_ui_add_fÜm_to_¡ack
('cÚfig-™em', 
$fÜm_¡©e
['v›w'], $fÜm_¡©e['di¥Ïy_id'], 
	`¬¿y
(
$ty³
, 
$id
));

2249 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

2250 
	}
}

2256 
funùiÚ
 
	$v›ws_ui_cÚfig_™em_fÜm
(&
$fÜm_¡©e
) {

2257 
$v›w
 = &
$fÜm_¡©e
['view'];

2258 
$di¥Ïy_id
 = 
$fÜm_¡©e
['display_id'];

2259 
$ty³
 = 
$fÜm_¡©e
['type'];

2260 
$id
 = 
$fÜm_¡©e
['id'];

2262 
$fÜm
 = 
	`¬¿y
('İtiÚs' =>‡¼ay('#Œ“' => 
TRUE
));

2263 ià(!
$v›w
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

2264 
	`v›ws_ajax_»nd”
(
	`t
('Inv®id di¥Ïy id @di¥Ïy', 
	`¬¿y
('@di¥Ïy' => 
$di¥Ïy_id
)));

2266 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy_id
, 
$ty³
, 
$id
);

2268 ià(
$™em
) {

2269 
$hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$™em
['bË'], $™em['f›ld'], 
$ty³
);

2270 ià(
	`em±y
(
$hªdËr
)) {

2271 
$fÜm
['m¬kup'] = 
	`¬¿y
('#v®ue' => 
	`t
("E¼Ü: hªdË¸fÜ @bË > @f›ld dÛ¢'ˆexi¡!",‡¼ay('@bË' => 
$™em
['table'], '@field' => $item['field'])));

2274 
$hªdËr
->
	`š™
(
$v›w
, 
$™em
);

2275 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

2277 ià(
$v›w
->
di¥Ïy_hªdËr
->
	`deçuÉabË_£ùiÚs
(
$ty³s
[
$ty³
]['plural'])) {

2278 
$fÜm_¡©e
['£ùiÚ'] = 
$ty³s
[
$ty³
]['plural'];

2279 
$v›w
->
di¥Ïy_hªdËr
->
	`add_ov”ride_bu‰Ú
(
$fÜm
['İtiÚs'], 
$fÜm_¡©e
, $form_state['section']);

2284 
$»ÏtiÚshs
 = 
$v›w
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('relationships');

2285 
$»ÏtiÚsh_İtiÚs
 = 
	`¬¿y
();

2287 
	`fÜ—ch
 (
$»ÏtiÚshs
 
as
 
$»ÏtiÚsh
) {

2290 ià(
$ty³
 =ğ'»ÏtiÚsh' && 
$id
 =ğ
$»ÏtiÚsh
['id']) {

2293 
$»ÏtiÚsh_hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$»ÏtiÚsh
['table'], $relationship['field'], 'relationship');

2295 ià(
	`em±y
(
$»ÏtiÚsh_hªdËr
)) {

2300 
$d©a
 = 
	`v›ws_ãtch_d©a
(
$»ÏtiÚsh
['table']);

2301 
$ba£
 = 
$d©a
[
$»ÏtiÚsh
['field']]['relationship']['base'];

2302 
$ba£_f›lds
 = 
	`v›ws_ãtch_f›lds
(
$ba£
, 
$fÜm_¡©e
['type']);

2303 ià(
	`is£t
(
$ba£_f›lds
[
$™em
['table'] . '.' . $item['field']])) {

2304 
$»ÏtiÚsh_hªdËr
->
	`š™
(
$v›w
, 
$»ÏtiÚsh
);

2305 
$»ÏtiÚsh_İtiÚs
[
$»ÏtiÚsh
['id']] = 
$»ÏtiÚsh_hªdËr
->
	`Ïb–
();

2309 ià(!
	`em±y
(
$»ÏtiÚsh_İtiÚs
)) {

2312 
$ba£_f›lds
 = 
	`v›ws_ãtch_f›lds
(
$v›w
->
ba£_bË
, 
$fÜm_¡©e
['type']);

2313 ià(
	`is£t
(
$ba£_f›lds
[
$™em
['table'] . '.' . $item['field']])) {

2314 
$»ÏtiÚsh_İtiÚs
 = 
	`¬¿y_m”ge
(
	`¬¿y
('nÚe' => 
	`t
('Do‚ot use‡„elationship')), $relationship_options);

2316 
$»l
 = 
	`em±y
(
$™em
['relationship']) ? 'none' : $item['relationship'];

2317 ià(
	`em±y
(
$»ÏtiÚsh_İtiÚs
[
$»l
])) {

2319 
$»l
 = 
	`key
(
$»ÏtiÚsh_İtiÚs
);

2322 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy_id
, 
$ty³
, 
$id
, '»ÏtiÚsh', 
$»l
);

2323 
$‹mp_v›w
 = 
$v›w
->
	`şÚe_v›w
();

2324 
	`v›ws_ui_ÿche_£t
(
$‹mp_v›w
);

2327 
$fÜm
['İtiÚs']['»ÏtiÚsh'] = 
	`¬¿y
(

2329 '#t™Ë' => 
	`t
('Relationship'),

2330 '#İtiÚs' => 
$»ÏtiÚsh_İtiÚs
,

2331 '#deçuÉ_v®ue' => 
$»l
,

2335 
$fÜm
['İtiÚs']['»ÏtiÚsh'] = 
	`¬¿y
(

2341 
$fÜm
['#t™Ë'] = 
	`check_¶aš
(
$v›w
->
di¥Ïy
[
$di¥Ïy_id
]->
di¥Ïy_t™Ë
) . ': ';

2342 
$fÜm
['#t™Ë'] .ğ
	`t
('CÚfigu» @ty³ %™em', 
	`¬¿y
('@ty³' => 
$ty³s
[
$ty³
]['l¡™Ë'], '%™em' => 
$hªdËr
->
	`ui_Çme
()));

2344 
$fÜm
['#£ùiÚ'] = 
$di¥Ïy_id
 . '-' . 
$ty³
 . '-' . 
$id
;

2347 
$hªdËr
->
	`İtiÚs_fÜm
(
$fÜm
['İtiÚs'], 
$fÜm_¡©e
);

2348 
$fÜm_¡©e
['hªdËr'] = &
$hªdËr
;

2351 
$Çme
 = 
NULL
;

2352 ià(
	`is£t
(
$fÜm_¡©e
['update_name'])) {

2353 
$Çme
 = 
$fÜm_¡©e
['update_name'];

2356 
	`v›ws_ui_¡ªd¬d_fÜm_bu‰Ús
(
$fÜm
, 
$fÜm_¡©e
, 'v›ws_ui_cÚfig_™em_fÜm', 
$Çme
, 
	`t
('Remove'), 'remove');

2358  
$fÜm
;

2359 
	}
}

2364 
funùiÚ
 
	$v›ws_ui_cÚfig_™em_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

2365 
$fÜm_¡©e
['hªdËr']->
	`İtiÚs_v®id©e
(
$fÜm
['options'], $form_state);

2366 
	}
}

2371 
funùiÚ
 
	$v›ws_ui_cÚfig_™em_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

2373 
$fÜm_¡©e
['hªdËr']->
	`İtiÚs_subm™
(
$fÜm
['options'], $form_state);

2374 
$™em
 = 
$fÜm_¡©e
['hªdËr']->
İtiÚs
;

2377 
	`un£t
(
$fÜm_¡©e
['values']['options']['expose_button']);

2380 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['İtiÚs'] 
as
 
$key
 => 
$v®ue
) {

2381 
$™em
[
$key
] = 
$v®ue
;

2385 
$fÜm_¡©e
['v›w']->
	`£t_™em
($fÜm_¡©e['di¥Ïy_id'], $fÜm_¡©e['ty³'], $fÜm_¡©e['id'], 
$™em
);

2387 
$hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$™em
['bË'], $™em['f›ld'], 
$fÜm_¡©e
['type']);

2388 
$hªdËr
->
	`š™
(
$fÜm_¡©e
['v›w'], 
$™em
);

2389 ià(
$hªdËr
 && $hªdËr->
	`Ãeds_¡yË_¶ugš
()) {

2390 
	`v›ws_ui_add_fÜm_to_¡ack
('chªge-¡yË', 
$fÜm_¡©e
['v›w'], $fÜm_¡©e['di¥Ïy_id'], 
	`¬¿y
($fÜm_¡©e['ty³'], $fÜm_¡©e['id']), 
TRUE
);

2394 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

2395 
	}
}

2400 
funùiÚ
 
	$v›ws_ui_cÚfig_™em_fÜm_»move
(
$fÜm
, &
$fÜm_¡©e
) {

2402 
$fÜm_¡©e
['v›w']->
	`£t_™em
($fÜm_¡©e['di¥Ïy_id'], $fÜm_¡©e['ty³'], $fÜm_¡©e['id'], 
NULL
);

2405 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

2406 
	}
}

2411 
funùiÚ
 
	$v›ws_ui_cÚfig_™em_fÜm_expo£
(
$fÜm
, &
$fÜm_¡©e
) {

2412 
$™em
 = &
$fÜm_¡©e
['hªdËr']->
İtiÚs
;

2414 
$™em
['expo£d'] = 
	`em±y
($item['exposed']);

2417 ià(
$™em
['exposed']) {

2418 
$fÜm_¡©e
['hªdËr']->
	`expo£_İtiÚs
();

2421 
$fÜm_¡©e
['v›w']->
	`£t_™em
($fÜm_¡©e['di¥Ïy_id'], $fÜm_¡©e['ty³'], $fÜm_¡©e['id'], 
$™em
);

2423 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

2424 
$fÜm_¡©e
['»»nd”'] = 
TRUE
;

2425 
$fÜm_¡©e
['»bud'] = 
TRUE
;

2426 
$fÜm_¡©e
['fÜû_expo£_İtiÚs'] = 
TRUE
;

2427 
	}
}

2432 
funùiÚ
 
	$v›ws_ui_cÚfig_™em_exŒa_fÜm
(&
$fÜm_¡©e
) {

2433 
$v›w
 = &
$fÜm_¡©e
['view'];

2434 
$di¥Ïy_id
 = 
$fÜm_¡©e
['display_id'];

2435 
$ty³
 = 
$fÜm_¡©e
['type'];

2436 
$id
 = 
$fÜm_¡©e
['id'];

2438 
$fÜm
 = 
	`¬¿y
('İtiÚs' =>‡¼ay('#Œ“' => 
TRUE
));

2439 ià(!
$v›w
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

2440 
	`v›ws_ajax_»nd”
(
	`t
('Inv®id di¥Ïy id @di¥Ïy', 
	`¬¿y
('@di¥Ïy' => 
$di¥Ïy_id
)));

2442 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy_id
, 
$ty³
, 
$id
);

2444 ià(
$™em
) {

2445 
$hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$™em
['bË'], $™em['f›ld'], 
$ty³
);

2446 ià(
	`em±y
(
$hªdËr
)) {

2447 
$fÜm
['m¬kup'] = 
	`¬¿y
('#v®ue' => 
	`t
("E¼Ü: hªdË¸fÜ @bË > @f›ld dÛ¢'ˆexi¡!",‡¼ay('@bË' => 
$™em
['table'], '@field' => $item['field'])));

2451 
$hªdËr
->
	`š™
(
$v›w
, 
$™em
);

2452 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

2454 
$fÜm
['#t™Ë'] = 
	`check_¶aš
(
$v›w
->
di¥Ïy
[
$di¥Ïy_id
]->
di¥Ïy_t™Ë
) . ': ';

2455 
$fÜm
['#t™Ë'] .ğ
	`t
('CÚfigu»ƒxŒ¨£‰šg fÜ @ty³ %™em', 
	`¬¿y
('@ty³' => 
$ty³s
[
$ty³
]['l¡™Ë'], '%™em' => 
$hªdËr
->
	`ui_Çme
()));

2457 
$fÜm
['#£ùiÚ'] = 
$di¥Ïy_id
 . '-' . 
$ty³
 . '-' . 
$id
;

2460 
$hªdËr
->
	`exŒa_İtiÚs_fÜm
(
$fÜm
['İtiÚs'], 
$fÜm_¡©e
);

2461 
$fÜm_¡©e
['hªdËr'] = &
$hªdËr
;

2465 
	`v›ws_ui_¡ªd¬d_fÜm_bu‰Ús
(
$fÜm
, 
$fÜm_¡©e
, 'views_ui_config_item_extra_form');

2467  
$fÜm
;

2468 
	}
}

2473 
funùiÚ
 
	$v›ws_ui_cÚfig_™em_exŒa_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

2474 
$fÜm_¡©e
['hªdËr']->
	`exŒa_İtiÚs_v®id©e
(
$fÜm
['options'], $form_state);

2475 
	}
}

2480 
funùiÚ
 
	$v›ws_ui_cÚfig_™em_exŒa_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

2482 
$fÜm_¡©e
['hªdËr']->
	`exŒa_İtiÚs_subm™
(
$fÜm
['options'], $form_state);

2483 
$™em
 = 
$fÜm_¡©e
['hªdËr']->
İtiÚs
;

2486 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['İtiÚs'] 
as
 
$key
 => 
$v®ue
) {

2487 
$™em
[
$key
] = 
$v®ue
;

2491 
$fÜm_¡©e
['v›w']->
	`£t_™em
($fÜm_¡©e['di¥Ïy_id'], $fÜm_¡©e['ty³'], $fÜm_¡©e['id'], 
$™em
);

2494 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

2495 
	}
}

2500 
funùiÚ
 
	$v›ws_ui_chªge_¡yË_fÜm
(&
$fÜm_¡©e
) {

2501 
$v›w
 = &
$fÜm_¡©e
['view'];

2502 
$di¥Ïy_id
 = 
$fÜm_¡©e
['display_id'];

2503 
$ty³
 = 
$fÜm_¡©e
['type'];

2504 
$id
 = 
$fÜm_¡©e
['id'];

2506 
$fÜm
 = 
	`¬¿y
('İtiÚs' =>‡¼ay('#Œ“' => 
TRUE
));

2507 ià(!
$v›w
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

2508 
	`v›ws_ajax_»nd”
(
	`t
('Inv®id di¥Ïy id @di¥Ïy', 
	`¬¿y
('@di¥Ïy' => 
$di¥Ïy_id
)));

2510 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy_id
, 
$ty³
, 
$id
);

2512 ià(
$™em
) {

2513 
$hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$™em
['bË'], $™em['f›ld'], 
$ty³
);

2514 ià(
	`em±y
(
$hªdËr
)) {

2515 
$fÜm
['m¬kup'] = 
	`¬¿y
('#v®ue' => 
	`t
("E¼Ü: hªdË¸fÜ @bË > @f›ld dÛ¢'ˆexi¡!",‡¼ay('@bË' => 
$™em
['table'], '@field' => $item['field'])));

2518 
$hªdËr
->
	`š™
(
$v›w
, 
$™em
);

2519 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

2520 
$fÜm
['#t™Ë'] = 
	`t
('Chªgsumm¬y styË fÜ @ty³ %™em', 
	`¬¿y
('@ty³' => 
$ty³s
[
$ty³
]['l¡™Ë'], '%™em' => 
$hªdËr
->
	`ui_Çme
()));

2522 
$fÜm
['#£ùiÚ'] = 
$di¥Ïy_id
 . '-' . 
$ty³
 . '-' . 
$id
 . '-style-plugin';

2524 
$fÜm
['¡yË_¶ugš'] = 
	`¬¿y
(

2526 '#İtiÚs' => 
	`v›ws_ãtch_¶ugš_Çmes
('style', 'summary'),

2527 '#deçuÉ_v®ue' => 
$™em
['style_plugin'],

2530 
$fÜm_¡©e
['hªdËr'] = &
$hªdËr
;

2532 
	`v›ws_ui_¡ªd¬d_fÜm_bu‰Ús
(
$fÜm
, 
$fÜm_¡©e
, 'views_ui_change_style_form');

2534  
$fÜm
;

2535 
	}
}

2537 
funùiÚ
 
	$v›ws_ui_chªge_¡yË_fÜm_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

2539 
$fÜm_¡©e
['hªdËr']->
	`İtiÚs_v®id©e
(
$fÜm
['options'], $form_state);

2541 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('¡yË', 
$fÜm_¡©e
['values']['style_plugin']);

2542 ià(!
$¶ugš
) {

2543 
	`fÜm_”rÜ
(
$fÜm
['¡yË_¶ugš'], 
	`t
('Internalƒrror: broken…lugin.'));

2545 
	}
}

2550 
funùiÚ
 
	$v›ws_ui_chªge_¡yË_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

2552 
$fÜm_¡©e
['hªdËr']->
	`İtiÚs_subm™
(
$fÜm
['options'], $form_state);

2553 
$™em
 = 
$fÜm_¡©e
['hªdËr']->
İtiÚs
;

2555 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('¡yË', 
$fÜm_¡©e
['values']['style_plugin']);

2556 ià(!
$¶ugš
) {

2557 
	`dru·l_£t_mes§ge
(
	`t
('Internalƒrror: broken…lugin.'), 'error');

2561 
$¶ugš
->
	`š™
(
$fÜm_¡©e
['v›w'], $fÜm_¡©e['v›w']->
di¥Ïy
[$form_state['display_id']]);

2564 ià(
	`em±y
(
$™em
['¡yË_¶ugš']è|| $™em['¡yË_¶ugš'] !ğ
$fÜm_¡©e
['values']['style_plugin']) {

2565 
$™em
['¡yË_İtiÚs'] = 
$¶ugš
->
İtiÚs
;

2569 
$™em
['¡yË_¶ugš'] = 
$fÜm_¡©e
['values']['style_plugin'];

2572 
$fÜm_¡©e
['v›w']->
	`£t_™em
($fÜm_¡©e['di¥Ïy_id'], $fÜm_¡©e['ty³'], $fÜm_¡©e['id'], 
$™em
);

2574 ià(!
	`em±y
(
$¶ugš
->
defš™iÚ
['uses options'])) {

2575 
	`v›ws_ui_add_fÜm_to_¡ack
('cÚfig-¡yË', 
$fÜm_¡©e
['v›w'], $fÜm_¡©e['di¥Ïy_id'], 
	`¬¿y
($fÜm_¡©e['ty³'], $fÜm_¡©e['id']), 
TRUE
);

2579 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

2580 
	}
}

2585 
funùiÚ
 
	$v›ws_ui_cÚfig_¡yË_fÜm
(&
$fÜm_¡©e
) {

2586 
$v›w
 = &
$fÜm_¡©e
['view'];

2587 
$di¥Ïy_id
 = 
$fÜm_¡©e
['display_id'];

2588 
$ty³
 = 
$fÜm_¡©e
['type'];

2589 
$id
 = 
$fÜm_¡©e
['id'];

2591 
$fÜm
 = 
	`¬¿y
('İtiÚs' =>‡¼ay('#Œ“' => 
TRUE
));

2592 ià(!
$v›w
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

2593 
	`v›ws_ajax_»nd”
(
	`t
('Inv®id di¥Ïy id @di¥Ïy', 
	`¬¿y
('@di¥Ïy' => 
$di¥Ïy_id
)));

2595 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy_id
, 
$ty³
, 
$id
);

2597 ià(
$™em
) {

2598 
$hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$™em
['bË'], $™em['f›ld'], 
$ty³
);

2599 ià(
	`em±y
(
$hªdËr
)) {

2600 
$fÜm
['m¬kup'] = 
	`¬¿y
('#v®ue' => 
	`t
("E¼Ü: hªdË¸fÜ @bË > @f›ld dÛ¢'ˆexi¡!",‡¼ay('@bË' => 
$™em
['table'], '@field' => $item['field'])));

2603 
$hªdËr
->
	`š™
(
$v›w
, 
$™em
);

2604 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

2606 
$fÜm
['#t™Ë'] = 
	`check_¶aš
(
$v›w
->
di¥Ïy
[
$di¥Ïy_id
]->
di¥Ïy_t™Ë
) . ': ';

2607 
$fÜm
['#t™Ë'] .ğ
	`t
('CÚfigu» summ¬y styË fÜ @ty³ %™em', 
	`¬¿y
('@ty³' => 
$ty³s
[
$ty³
]['l¡™Ë'], '%™em' => 
$hªdËr
->
	`ui_Çme
()));

2609 
$fÜm
['#£ùiÚ'] = 
$di¥Ïy_id
 . '-' . 
$ty³
 . '-style-options';

2611 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('¡yË', 
$™em
['style_plugin']);

2612 ià(
$¶ugš
) {

2613 
$fÜm
['¡yË_İtiÚs'] = 
	`¬¿y
(

2614 '#Œ“' => 
TRUE
,

2616 
$¶ugš
->
	`š™
(
$v›w
, $v›w->
di¥Ïy
[
$di¥Ïy_id
], 
$™em
['style_options']);

2618 
$¶ugš
->
	`İtiÚs_fÜm
(
$fÜm
['¡yË_İtiÚs'], 
$fÜm_¡©e
);

2621 
$fÜm_¡©e
['hªdËr'] = &
$hªdËr
;

2623 
	`v›ws_ui_¡ªd¬d_fÜm_bu‰Ús
(
$fÜm
, 
$fÜm_¡©e
, 'views_ui_config_style_form');

2625  
$fÜm
;

2626 
	}
}

2631 
funùiÚ
 
	$v›ws_ui_cÚfig_¡yË_fÜm_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

2633 
$fÜm_¡©e
['hªdËr']->
	`İtiÚs_subm™
(
$fÜm
['style_options'], $form_state);

2634 
$™em
 = 
$fÜm_¡©e
['hªdËr']->
İtiÚs
;

2637 
$™em
['¡yË_İtiÚs'] = 
$fÜm_¡©e
['values']['style_options'];

2640 
$fÜm_¡©e
['v›w']->
	`£t_™em
($fÜm_¡©e['di¥Ïy_id'], $fÜm_¡©e['ty³'], $fÜm_¡©e['id'], 
$™em
);

2643 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

2644 
	}
}

2649 
funùiÚ
 
	$v›ws_ui_g‘_rŞes
() {

2650 
$rŞes
 = 
NULL
;

2651 ià(!
	`is£t
(
$rŞes
)) {

2652 
$rŞes
 = 
	`¬¿y
();

2653 
$»suÉ
 = 
	`db_qu”y
("SELECT„.rid,„.name FROM {role}„ ORDER BY„.name");

2654 
$obj
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

2655 
$rŞes
[
$obj
->
rid
] = $obj->
Çme
;

2659  
$rŞes
;

2660 
	}
}

2665 
funùiÚ
 
	$v›ws_ui_™em_css
(
$™em
) {

2666  
	`v›ws_css_§ã
('v›ws-™em-' . 
$™em
);

2667 
	}
}

2672 
funùiÚ
 
	$v›ws_ui_’abË_·ge
(
$v›w
) {

2673 ià(
	`is£t
(
$_GET
['tok’']è&& 
	`dru·l_v®id_tok’
($_GET['token'], 'views-enable')) {

2674 
$v›ws_¡©us
 = 
	`v¬ŸbË_g‘
('v›ws_deçuÉs', 
	`¬¿y
());

2675 
$v›ws_¡©us
[
$v›w
->
Çme
] = 
FALSE
;

2676 
	`v¬ŸbË_£t
('v›ws_deçuÉs', 
$v›ws_¡©us
);

2677 
	`v›ws_šv®id©e_ÿche
();

2678 
	`m’u_»bud
();

2679 
	`dru·l_gÙo
('admin/build/views');

2682  
	`dru·l_acûss_d’›d
();

2684 
	}
}

2689 
funùiÚ
 
	$v›ws_ui_di§bË_·ge
(
$v›w
) {

2690 ià(
	`is£t
(
$_GET
['tok’']è&& 
	`dru·l_v®id_tok’
($_GET['token'], 'views-disable')) {

2691 
$v›ws_¡©us
 = 
	`v¬ŸbË_g‘
('v›ws_deçuÉs', 
	`¬¿y
());

2692 
$v›ws_¡©us
[
$v›w
->
Çme
] = 
TRUE
;

2693 
	`v¬ŸbË_£t
('v›ws_deçuÉs', 
$v›ws_¡©us
);

2694 
	`v›ws_šv®id©e_ÿche
();

2695 
	`m’u_»bud
();

2696 
	`dru·l_gÙo
('admin/build/views');

2699  
	`dru·l_acûss_d’›d
();

2701 
	}
}

2706 
funùiÚ
 
	$v›ws_ui_admš_toŞs
() {

2707 
$fÜm
['ş—r_ÿche'] = 
	`¬¿y
(

2709 '#v®ue' => 
	`t
("Clear Views' cache"),

2710 '#subm™' => 
	`¬¿y
('views_ui_tools_clear_cache'),

2713 
$fÜm
['v›ws_sql_sigÇtu»'] = 
	`¬¿y
(

2715 '#t™Ë' => 
	`t
('Add Views signatureo‡ll SQL queries'),

2716 '#desütiÚ' => 
	`t
("All Views-generated queries will include‡ special 'VIEWS' = 'VIEWS' string inhe WHERE clause. This makes identifying Views queries in database server†ogs simpler, but should only be used whenroubleshooting."),

2717 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('v›ws_sql_sigÇtu»', 
FALSE
),

2720 
$fÜm
['v›ws_sk_ÿche'] = 
	`¬¿y
(

2722 '#t™Ë' => 
	`t
('Disable views data caching'),

2723 '#desütiÚ' => 
	`t
("Views caches data‡boutables, modules‡nd views‡vailable,o increase…erformance. By checkinghis box, Views will skiphis cache‡nd‡lways„ebuildhis data when‚eeded. This can have‡ serious…erformance impact on your site."),

2724 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('v›ws_sk_ÿche', 
FALSE
),

2727 
$fÜm
['v›ws_hide_h–p_mes§ge'] = 
	`¬¿y
(

2729 '#t™Ë' => 
	`t
('Ignore missing‡dvanced help module'),

2730 '#desütiÚ' => 
	`t
("Views useshe‡dvanced help moduleo…rovide helpext; ifhis module is‚ot…resent Views will complain, unlesshis setting is checked."),

2731 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('v›ws_hide_h–p_mes§ge', 
FALSE
),

2734 
$fÜm
['v›ws_ui_qu”y_Ú_tİ'] = 
	`¬¿y
(

2736 '#t™Ë' => 
	`t
('Show query‡bove†ive…review'),

2737 '#desütiÚ' => 
	`t
("The†ive…review feature will show youhe output ofhe view you're creating,‡s well‡she view. Check hereo showhe query‡nd other information‡bovehe view;†eavehis uncheckedo showhat information belowhe view."),

2738 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('v›ws_ui_qu”y_Ú_tİ', 
FALSE
),

2741 
$fÜm
['v›ws_ui_di§bË_live_´ev›w'] = 
	`¬¿y
(

2743 '#t™Ë' => 
	`t
('Disable‡utomatic†ive…review'),

2744 '#desütiÚ' => 
	`t
("Don't‡utomatically updatehe…review. This can speed upheƒditing of views‡ bit.'"),

2745 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('views_ui_disable_live_preview', 0),

2748 
$fÜm
['v›ws_show_add™iÚ®_qu”›s'] = 
	`¬¿y
(

2750 '#t™Ë' => 
	`t
('Show other queries„un during„ender during†ive…review'),

2751 '#desütiÚ' => 
	`t
("Drupal hashe…otentialo„un many queries while‡ view is being„endered. Checkinghis box will displayƒvery query„un during view„ender‡s…art ofhe†ive…review."),

2752 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('v›ws_show_add™iÚ®_qu”›s', 
FALSE
),

2755 
$fÜm
['v›ws_no_hov”_lšks'] = 
	`¬¿y
(

2757 '#t™Ë' => 
	`t
('Do‚ot show hover†inks over views'),

2758 '#desütiÚ' => 
	`t
("To make itƒasiero‡dministrate your views, Views…rovides 'hover'†inksoake youoheƒdit‡ndƒxport screen of‡ view wheneverhe view is used. This can be distracting on somehemes,hough; if it is…roblematic, you canurn it off here."),

2759 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('v›ws_no_hov”_lšks', 
FALSE
),

2762 
$fÜm
['v›ws_dev–_ouut'] = 
	`¬¿y
(

2764 '#t™Ë' => 
	`t
('Enable views…erformance statistics viahe Devel module'),

2765 '#desütiÚ' => 
	`t
("Checkhisoƒnable some Views query‡nd…erformance statistics <em>if Devel is installed</em>."),

2766 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('v›ws_dev–_ouut', 
FALSE
),

2769 
$fÜm
['v›ws_no_javasüt'] = 
	`¬¿y
(

2771 '#t™Ë' => 
	`t
('Disable javascript with Views'),

2772 '#desütiÚ' => 
	`t
("If you‡re having…roblems withhe javascript, you can disable it here;he Views UI should degrade‡nd still be usable without javascript, it just‚ot‡s good."),

2773 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('v›ws_no_javasüt', 
FALSE
),

2776 
$»giÚs
 = 
	`sy¡em_»giÚ_li¡
(
	`v¬ŸbË_g‘
('theme_default', 'garland'));

2777 
$»giÚs
['w©chdog'] = 
	`t
('Watchdog');

2779 
$fÜm
['v›ws_dev–_»giÚ'] = 
	`¬¿y
(

2781 '#t™Ë' => 
	`t
('Page„egiono output…erformance statistics'),

2782 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('views_devel_region', 'footer'),

2783 '#İtiÚs' => 
$»giÚs
,

2786 
$fÜm
['v›ws_expo£d_f‹r_ªy_Ïb–'] = 
	`¬¿y
(

2788 '#t™Ë' => 
	`t
('Label for "Any" value on optional single-selectƒxposed filters'),

2789 '#İtiÚs' => 
	`¬¿y
('Şd_ªy' => '<Any>', 'Ãw_ªy' => 
	`t
('- Any -')),

2790 '#deçuÉ_v®ue' => 
	`v¬ŸbË_g‘
('views_exposed_filter_any_label', 'old_any'),

2793  
	`sy¡em_£‰šgs_fÜm
(
$fÜm
);

2794 
	}
}

2799 
funùiÚ
 
	$v›ws_ui_toŞs_ş—r_ÿche
() {

2800 
	`v›ws_šv®id©e_ÿche
();

2801 
	`dru·l_£t_mes§ge
(
	`t
('The cache has been cleared.'));

2802 
	}
}

2808 
funùiÚ
 
	$v›ws_ui_cÚfig_™em_fÜm_»sÿn
(
$fÜm
, &
$fÜm_¡©e
) {

2809 
	`dru·l_»bud_theme_»gi¡ry
();

2817 
	`un£t
(
$GLOBALS
['theme']);

2818 
	`š™_theme
();

2820 
$fÜm_¡©e
['»»nd”'] = 
TRUE
;

2821 
$fÜm_¡©e
['»bud'] = 
TRUE
;

2822 
	}
}

2827 
funùiÚ
 
	$v›ws_ui_ed™_di¥Ïy_fÜm_chªge_theme
(
$fÜm
, &
$fÜm_¡©e
) {

2829 
$fÜm_¡©e
['v›w']->
theme
 = $form_state['values']['theme'];

2831 
	`v›ws_ui_ÿche_£t
(
$fÜm_¡©e
['view']);

2832 
$fÜm_¡©e
['»»nd”'] = 
TRUE
;

2833 
$fÜm_¡©e
['»bud'] = 
TRUE
;

2834 
	}
}

2839 
funùiÚ
 
v›ws_ui_autocom¶‘e_g
(
$¡ršg
 = '') {

2840 
$m©ches
 = 
¬¿y
();

2842 
v›ws_šşude
('view');

2843 
	g$v›ws
 = 
v›ws_discov”_deçuÉ_v›ws
();

2844 
fÜ—ch
 (
$v›ws
 
as
 
$v›w
) {

2845 ià(!
em±y
(
$v›w
->
g
è&& 
¡½os
($v›w->g, 
$¡ršg
) === 0) {

2846 
$m©ches
[
$v›w
->
g
] = $view->tag;

2850 ià(
	g$¡ršg
) {

2851 
	g$»suÉ
 = 
db_qu”y_¿nge
("SELECT DISTINCTag FROM {v›ws_v›w} WHERE LOWERÑagèLIKE LOWER('%s%%')", 
$¡ršg
, 0, 10 - 
couÁ
(
$m©ches
));

2852 
	g$v›w
 = 
db_ãtch_objeù
(
$»suÉ
)) {

2853 
$m©ches
[
$v›w
->
g
] = 
check_¶aš
($view->tag);

2857 
dru·l_jsÚ
(
$m©ches
);

2863 
funùiÚ
 
	$_v›ws_weight_sÜt
(
$a
, 
$b
) {

2864 ià(
$a
['weight'] !ğ
$b
['weight']) {

2865  
$a
['weight'] < 
$b
['weight'] ? -1 : 1;

2867 ià(
$a
['t™Ë'] !ğ
$b
['title']) {

2868  
$a
['t™Ë'] < 
$b
['title'] ? -1 : 1;

2872 
	}
}

2880 
funùiÚ
 
	$v›ws_ãtch_ba£_bËs
() {

2881 
$ba£_bËs
 = 
	`¬¿y
();

2882 ià(
	`em±y
(
$ba£_bËs
)) {

2883 
$weights
 = 
	`¬¿y
();

2884 
$bËs
 = 
	`¬¿y
();

2885 
$d©a
 = 
	`v›ws_ãtch_d©a
();

2886 
	`fÜ—ch
 (
$d©a
 
as
 
$bË
 => 
$šfo
) {

2887 ià(!
	`em±y
(
$šfo
['table']['base'])) {

2888 
$bËs
[
$bË
] = 
	`¬¿y
(

2889 't™Ë' => 
$šfo
['table']['base']['title'],

2890 'desütiÚ' => 
$šfo
['table']['base']['help'],

2891 'weight' => !
	`em±y
(
$šfo
['table']['base']['weight']) ? $info['table']['base']['weight'] : 0,

2895 
	`uasÜt
(
$bËs
, '_views_weight_sort');

2896 
$ba£_bËs
 = 
$bËs
;

2899  
$ba£_bËs
;

2900 
	}
}

2902 
funùiÚ
 
	$_v›ws_sÜt_ty³s
(
$a
, 
$b
) {

2903 ià(
$a
['group'] !ğ
$b
['group']) {

2904  
$a
['group'] < 
$b
['group'] ? -1 : 1;

2907 ià(
$a
['t™Ë'] !ğ
$b
['title']) {

2908  
$a
['t™Ë'] < 
$b
['title'] ? -1 : 1;

2912 
	}
}

2920 
funùiÚ
 
	$v›ws_ãtch_f›lds
(
$ba£
, 
$ty³
) {

2921 
$f›lds
 = 
	`¬¿y
();

2922 ià(
	`em±y
(
$f›lds
)) {

2923 
$d©a
 = 
	`v›ws_ãtch_d©a
();

2924 
$¡¬t
 = 
	`v›ws_miüÙime
();

2935 
	`fÜ—ch
 (
$d©a
 
as
 
$bË
 => 
$bË_d©a
) {

2936 
$ba£s
 = 
	`¬¿y
();

2937 
$¡ršgs
 = 
	`¬¿y
();

2938 
$sk_ba£s
 = 
	`¬¿y
();

2939 
	`fÜ—ch
 (
$bË_d©a
 
as
 
$f›ld
 => 
$šfo
) {

2941 ià(
$f›ld
 == 'table') {

2943 ià(!
	`em±y
(
$šfo
['join'])) {

2944 
$ba£s
 = 
	`¬¿y_keys
(
$šfo
['join']);

2947 
$ba£s
[] = 
$bË
;

2950 
	`fÜ—ch
 (
	`¬¿y
('f›ld', 'sÜt', 'f‹r', '¬gum’t', '»ÏtiÚsh'è
as
 
$key
) {

2951 ià(!
	`em±y
(
$šfo
[
$key
])) {

2952 ià(!
	`em±y
(
$šfo
[
$key
]['skip base'])) {

2953 
	`fÜ—ch
 ((
¬¿y
è
$šfo
[
$key
]['sk ba£'] 
as
 
$ba£_Çme
) {

2954 
$sk_ba£s
[
$f›ld
][
$key
][
$ba£_Çme
] = 
TRUE
;

2957 
	`–£if
 (!
	`em±y
(
$šfo
['skip base'])) {

2958 
	`fÜ—ch
 ((
¬¿y
è
$šfo
['sk ba£'] 
as
 
$ba£_Çme
) {

2959 
$sk_ba£s
[
$f›ld
][
$key
][
$ba£_Çme
] = 
TRUE
;

2962 
	`fÜ—ch
 (
	`¬¿y
('t™Ë', 'group', 'h–p', 'ba£'è
as
 
$¡ršg
) {

2964 ià(!
	`em±y
(
$šfo
[
$key
][
$¡ršg
])) {

2965 
$¡ršgs
[
$f›ld
][
$key
][
$¡ršg
] = 
$šfo
[$key][$string];

2968 
	`–£if
 (!
	`em±y
(
$šfo
[
$¡ršg
])) {

2969 
$¡ršgs
[
$f›ld
][
$key
][
$¡ršg
] = 
$šfo
[$string];

2972 
	`–£if
 (!
	`em±y
(
$bË_d©a
['bË'][
$¡ršg
])) {

2973 
$¡ršgs
[
$f›ld
][
$key
][
$¡ršg
] = 
$bË_d©a
['table'][$string];

2976 ià(
$¡ršg
 != 'base') {

2977 
$¡ršgs
[
$f›ld
][
$key
][
$¡ršg
] = 
	`t
("E¼Ü: missšg @compÚ’t", 
	`¬¿y
('@component' => $string));

2984 
	`fÜ—ch
 (
$ba£s
 
as
 
$ba£_Çme
) {

2985 
	`fÜ—ch
 (
$¡ršgs
 
as
 
$f›ld
 => 
$f›ld_¡ršgs
) {

2986 
	`fÜ—ch
 (
$f›ld_¡ršgs
 
as
 
$ty³_Çme
 => 
$ty³_¡ršgs
) {

2987 ià(
	`em±y
(
$sk_ba£s
[
$f›ld
][
$ty³_Çme
][
$ba£_Çme
])) {

2988 
$f›lds
[
$ba£_Çme
][
$ty³_Çme
]["$bË.$f›ld"] = 
$ty³_¡ršgs
;

3000 ià(
	`is_¬¿y
(
$ba£
)) {

3001 
$¡ršgs
 = 
	`¬¿y
();

3002 
	`fÜ—ch
 (
$ba£
 
as
 
$ba£_bË
) {

3003 ià(
	`is£t
(
$f›lds
[
$ba£_bË
][
$ty³
])) {

3004 
$¡ršgs
 +ğ
$f›lds
[
$ba£_bË
][
$ty³
];

3007 
	`uasÜt
(
$¡ršgs
, '_views_sort_types');

3008  
$¡ršgs
;

3011 ià(
	`is£t
(
$f›lds
[
$ba£
][
$ty³
])) {

3012 
	`uasÜt
(
$f›lds
[
$ba£
][
$ty³
], '_views_sort_types');

3013  
$f›lds
[
$ba£
][
$ty³
];

3015  
	`¬¿y
();

3016 
	}
}

3032 
funùiÚ
 
v›ws_ãtch_¶ugš_Çmes
(
$ty³
, 
$key
 = 
NULL
, 
$ba£
 = 
	$¬¿y
()) {

3033 
$d©a
 = 
	`v›ws_ãtch_¶ugš_d©a
();

3035 
$¶ugšs
[
$ty³
] = 
	`¬¿y
();

3037 
	`fÜ—ch
 (
$d©a
[
$ty³
] 
as
 
$id
 => 
$¶ugš
) {

3039 ià(
$key
 && (
	`em±y
(
$¶ugš
['type']) || $plugin['type'] != $key)) {

3042 ià(
	`em±y
(
$¶ugš
['nØui']è&& (em±y(
$ba£
è||ƒm±y($¶ugš['ba£']è|| 
	`¬¿y_š‹r£ù
($base, $plugin['base']))) {

3043 
$¶ugšs
[
$ty³
][
$id
] = 
$¶ugš
['title'];

3047 ià(!
	`em±y
(
$¶ugšs
[
$ty³
])) {

3048 
	`asÜt
(
$¶ugšs
[
$ty³
]);

3049  
$¶ugšs
[
$ty³
];

3052  
	`¬¿y
();

3053 
	}
}

3059 
funùiÚ
 
	$theme_v›ws_ui_¡yË_¶ugš_bË
(
$fÜm
) {

3060 
$ouut
 = 
	`dru·l_»nd”
(
$fÜm
['description_markup']);

3062 
$h—d”
 = 
	`¬¿y
(

3063 
	`t
('Field'),

3064 
	`t
('Column'),

3065 
	`t
('Separator'),

3066 
	`¬¿y
(

3067 'd©a' => 
	`t
('Sortable'),

3070 
	`¬¿y
(

3071 'd©a' => 
	`t
('Default sort'),

3075 
$rows
 = 
	`¬¿y
();

3076 
	`fÜ—ch
 (
	`–em’t_chd»n
(
$fÜm
['cŞumns']è
as
 
$id
) {

3077 
$row
 = 
	`¬¿y
();

3078 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['šfo'][
$id
]['name']);

3079 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['cŞumns'][
$id
]);

3080 
$row
[] = 
	`dru·l_»nd”
(
$fÜm
['šfo'][
$id
]['separator']);

3081 ià(!
	`em±y
(
$fÜm
['šfo'][
$id
]['sortable'])) {

3082 
$row
[] = 
	`¬¿y
(

3083 'd©a' => 
	`dru·l_»nd”
(
$fÜm
['šfo'][
$id
]['sortable']),

3086 
$row
[] = 
	`¬¿y
(

3087 'd©a' => 
	`dru·l_»nd”
(
$fÜm
['deçuÉ'][
$id
]),

3092 
$row
[] = '';

3093 
$row
[] = '';

3095 
$rows
[] = 
$row
;

3099 
$rows
[] = 
	`¬¿y
(
	`t
('NÚe'), '', '', '',‡¼ay('®ign' => 'ûÁ”', 'd©a' => 
	`dru·l_»nd”
(
$fÜm
['default'][-1])));

3101 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

3102 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

3103  
$ouut
;

3104 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/ajax.inc

1 <?
php


16 
funùiÚ
 
	$v›ws_ajax
() {

17 ià(
	`is£t
(
$_REQUEST
['view_name']) && isset($_REQUEST['view_display_id'])) {

18 
$Çme
 = 
$_REQUEST
['view_name'];

19 
$di¥Ïy_id
 = 
$_REQUEST
['view_display_id'];

20 
$¬gs
 = 
	`is£t
(
$_REQUEST
['v›w_¬gs']è&& $_REQUEST['v›w_¬gs'] !=ğ'' ? 
	`ex¶ode
('/', $_REQUEST['v›w_¬gs']è: 
	`¬¿y
();

21 
$·th
 = 
	`is£t
(
$_REQUEST
['v›w_·th']è? $_REQUEST['v›w_·th'] : 
NULL
;

22 
$dom_id
 = 
	`is£t
(
$_REQUEST
['v›w_dom_id']è? 
	`štv®
($_REQUEST['v›w_dom_id']è: 
NULL
;

23 
$·g”_–em’t
 = 
	`is£t
(
$_REQUEST
['·g”_–em’t']è? 
	`štv®
($_REQUEST['·g”_–em’t']è: 
NULL
;

24 
	`v›ws_šşude
('ajax');

25 
$objeù
 = 
Ãw
 
	`¡dCÏss
();

27 
$objeù
->
¡©us
 = 
FALSE
;

28 
$objeù
->
di¥Ïy
 = '';

30 
$¬g
 = 
	`ex¶ode
('/', 
$_REQUEST
['view_path']);

32 ià(
$¬g
[0] =ğ'admš' || (
	`v¬ŸbË_g‘
('node_admin_theme', '0') && $arg[0] == 'node' && ($arg[1] == 'add' || $arg[2] == 'edit'))) {

33 
glob®
 
$cu¡om_theme
;

34 
$cu¡om_theme
 = 
	`v¬ŸbË_g‘
('admin_theme', '0');

35 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'system') .'/admin.css', 'module');

38 ià(
$v›w
 = 
	`v›ws_g‘_v›w
(
$Çme
)) {

39 ià(
$v›w
->
	`acûss
(
$di¥Ïy_id
)) {

42 ià(!
	`em±y
(
$·th
)) {

43 
$_GET
['q'] = 
$·th
;

47 ià(
	`is£t
(
$·g”_–em’t
)) {

48 
$v›w
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
->
	`£t_İtiÚ
('·g”_–em’t', 
$·g”_–em’t
);

51 
$v›w
->
dom_id
 = 
$dom_id
;

53 
$”rÜs
 = 
$v›w
->
	`v®id©e
();

54 ià(
$”rÜs
 ==ğ
TRUE
) {

55 
$objeù
->
¡©us
 = 
TRUE
;

56 
$objeù
->
t™Ë
 = 
$v›w
->
	`g‘_t™Ë
();

57 
$objeù
->
di¥Ïy
 .ğ
$v›w
->
	`´ev›w
(
$di¥Ïy_id
, 
$¬gs
);

60 
	`fÜ—ch
 (
$”rÜs
 
as
 
$”rÜ
) {

61 
	`dru·l_£t_mes§ge
(
$”rÜ
, 'error');

65 
$objeù
->
__ÿÎbacks
 = 
	`¬¿y
('Drupal.Views.Ajax.ajaxViewResponse');

67 
	`dru·l_®‹r
('ajax_d©a', 
$objeù
, 'v›ws', 
$v›w
);

70 
$mes§ges
 = 
	`theme
('status_messages');

71 
$objeù
->
mes§ges
 = 
$mes§ges
 ? '<div class="views-messages">' . $messages . '</div>' : '';

73 
	`v›ws_ajax_»nd”
(
$objeù
);

75 
	}
}

87 
funùiÚ
 
	$v›ws_ajax_»nd”
(
$ouut
 = 
NULL
, 
$t™Ë
 = NULL, 
$u¾
 = NULL, 
$js
 = NULL) {

88 ià(
	`em±y
(
$ouut
)) {

89 
$ouut
->
di¥Ïy
 = 
	`t
('Server„eports invalid inputƒrror.');

90 
$ouut
->
t™Ë
 = 
	`t
('Error');

92 
	`–£if
 (!
	`is_objeù
(
$ouut
)) {

93 
$‹mp
 = 
Ãw
 
	`¡dCÏss
();

94 
$‹mp
->
di¥Ïy
 = 
$ouut
;

95 
$‹mp
->
t™Ë
 = 
$t™Ë
;

96 
$‹mp
->
u¾
 = 
$u¾
;

97 
$ouut
 = 
$‹mp
;

99 ià(!
	`em±y
(
$js
)) {

100 
$ouut
->
js
 = 
$js
;

103 
	`dru·l_jsÚ
(
$ouut
);

104 
ex™
;

105 
	}
}

111 
funùiÚ
 
	$v›ws_ajax_fÜm_w¿µ”
(
$fÜm_id
, &
$fÜm_¡©e
) {

113 
$fÜm_¡©e
 +ğ
	`¬¿y
(

114 '»_»nd”' => 
FALSE
,

115 'no_»dœeù' => !
	`em±y
(
$fÜm_¡©e
['ajax']),

118 
$ouut
 = 
	`dru·l_bud_fÜm
(
$fÜm_id
, 
$fÜm_¡©e
);

119 ià(!
	`em±y
(
$fÜm_¡©e
['ajax']) &&ƒmpty($form_state['executed'])) {

122 
$objeù
 = 
Ãw
 
	`¡dCÏss
();

123 
$objeù
->
di¥Ïy
 = '';

124 ià(
$mes§ges
 = 
	`theme
('status_messages')) {

125 
$objeù
->
di¥Ïy
 = '<div cÏss="v›ws-mes§ges">' . 
$mes§ges
 . '</div>';

127 
$objeù
->
di¥Ïy
 .ğ
$ouut
;

129 
$objeù
->
t™Ë
 = 
	`em±y
(
$fÜm_¡©e
['title']) ? '' : $form_state['title'];

130 ià(!
	`em±y
(
$fÜm_¡©e
['help_topic'])) {

131 
$moduË
 = !
	`em±y
(
$fÜm_¡©e
['help_module']) ? $form_state['help_module'] : 'views';

132 
$objeù
->
t™Ë
 = 
	`theme
('advªûd_h–p_tİic', 
$moduË
, 
$fÜm_¡©e
['help_topic']) . $object->title;

134 
$objeù
->
u¾
 = 
	`em±y
(
$fÜm_¡©e
['u¾']è? 
	`u¾
(
$_GET
['q'], 
	`¬¿y
('absŞu‹' => 
TRUE
)) : $form_state['url'];

135 
$objeù
->
js
 = 
	`em±y
(
$fÜm_¡©e
['j £‰šgs']è? 
NULL
 : $form_state['js settings'];

136 ià(!
	`em±y
(
$fÜm_¡©e
['#section'])) {

137 
$objeù
->
h™e
 = '.' . 
	`v›ws_ui_™em_css
(
$fÜm_¡©e
['#section']);

140 
$ouut
 = 
$objeù
;

144 ià(
	`em±y
(
$fÜm_¡©e
['ajax']) && !empty($form_state['title'])) {

145 
	`dru·l_£t_t™Ë
(
$fÜm_¡©e
['title']);

148  
$ouut
;

149 
	}
}

155 
funùiÚ
 
v›ws_ajax_autocom¶‘e_u£r
(
$¡ršg
 = '') {

157 
$¬¿y
 = 
dru·l_ex¶ode_gs
(
$¡ršg
);

160 
	g$Ï¡_¡ršg
 = 
Œim
(
¬¿y_pİ
(
$¬¿y
));

161 
	g$m©ches
 = 
¬¿y
();

162 ià(
	g$Ï¡_¡ršg
 != '') {

163 
$´efix
 = 
couÁ
(
$¬¿y
è? 
im¶ode
(', ', $array) . ', ' : '';

165 ià(
¡½os
('ªÚymous', 
¡¹Şow”
(
$Ï¡_¡ršg
)è!=ğ
FALSE
) {

166 
$m©ches
[
$´efix
 . 'Anonymous'] = 'Anonymous';

168 
	g$»suÉ
 = 
db_qu”y_¿nge
("SELECT‚amFROM {u£rs} WHERE LOWERÒameèLIKE LOWER('%s%%')", 
$Ï¡_¡ršg
, 0, 10);

170 
	g$accouÁ
 = 
db_ãtch_objeù
(
$»suÉ
)) {

171 
$n
 = 
$accouÁ
->
Çme
;

173 ià(
¡½os
(
$accouÁ
->
Çme
, ','è!=ğ
FALSE
 || strpos($account->name, '"') !== FALSE) {

174 
$n
 = '"' . 
¡r_»¶aû
('"', '""', 
$accouÁ
->
Çme
) . '"';

176 
	g$m©ches
[
$´efix
 . 
$n
] = 
check_¶aš
(
$accouÁ
->
Çme
);

180 
dru·l_jsÚ
(
$m©ches
);

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/analyze.inc

1 <?
php


23 
funùiÚ
 
	$v›ws_ª®yze_v›w
(&
$v›w
) {

24 
$v›w
->
	`š™_di¥Ïy
();

25 
$mes§ges
 = 
	`moduË_švoke_®l
('v›ws_ª®yze', 
$v›w
);

27  
$mes§ges
;

28 
	}
}

36 
funùiÚ
 
	$v›ws_ª®yze_fÜm©_»suÉ
(
$v›w
, 
$mes§ges
) {

37 ià(
	`em±y
(
$mes§ges
)) {

38 
$mes§ges
 = 
	`¬¿y
(
	`v›ws_ui_ª®ysis
(
	`t
('View‡nalysis can find‚othingo„eport.'), 'ok'));

41 
$ty³s
 = 
	`¬¿y
('ok' =>‡rray(), 'warning' =>‡rray(), 'error' =>‡rray());

42 
	`fÜ—ch
 (
$mes§ges
 
as
 
$mes§ge
) {

43 ià(
	`em±y
(
$ty³s
[
$mes§ge
['type']])) {

44 
$ty³s
[
$mes§ge
['ty³']] = 
	`¬¿y
();

46 
$ty³s
[
$mes§ge
['type']][] = $message['message'];

49 
$ouut
 = '';

50 
	`fÜ—ch
 (
$ty³s
 
as
 
$ty³
 => 
$mes§ges
) {

51 
$mes§ge
 = '';

52 ià(
	`couÁ
(
$mes§ges
) > 1) {

53 
$mes§ge
 = 
	`theme
('™em_li¡', 
$mes§ges
);

55 ià(
$mes§ges
) {

56 
$mes§ge
 = 
	`¬¿y_shiá
(
$mes§ges
);

59 ià(
$mes§ge
) {

60 
$ouut
 .= "<div class=\"$type\">$message</div>";

64  
$ouut
;

65 
	}
}

89 
funùiÚ
 
v›ws_ui_ª®ysis
(
$mes§ge
, 
$ty³
 = 'error') {

90  
¬¿y
('mes§ge' => 
$mes§ge
, 'ty³' => 
$ty³
);

100 
funùiÚ
 
	$v›ws_ui_v›ws_ª®yze
(
$v›w
) {

101 
$»t
 = 
	`¬¿y
();

103 ià(
	`couÁ
(
$v›w
->
di¥Ïy
) < 2) {

104 
$»t
[] = 
	`v›ws_ui_ª®ysis
(
	`t
('This view has only‡ default display‡ndherefore will‚ot be…laced‡nywhere on your site;…erhaps you wanto‡dd‡…age or‡ block display.'), 'warning');

107  
$»t
;

108 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/base.inc

1 <?
php


12 şas 
	cv›ws_objeù
 {

16 
v¬
 
	m$İtiÚs
 = 
¬¿y
();

34 
funùiÚ
 
	$İtiÚ_defš™iÚ
(è{  
	`¬¿y
(); }

40 
funùiÚ
 
	$cÚ¡ruù
(è{ 
$this
->
	`£t_deçuÉ_İtiÚs
(); 
	}
}

46 
funùiÚ
 
	$İtiÚs
(è{ 
	}
}

53 
funùiÚ
 
	$£t_deçuÉ_İtiÚs
() {

54 
$this
->
	`_£t_İtiÚ_deçuÉs
($this->
İtiÚs
, $this->
	`İtiÚ_defš™iÚ
());

57 
$this
->
	`İtiÚs
($this->
İtiÚs
);

58 
	}
}

60 
funùiÚ
 
	$_£t_İtiÚ_deçuÉs
(&
$¡Üage
, 
$İtiÚs
, 
$Ëv–
 = 0) {

61 
	`fÜ—ch
 (
$İtiÚs
 
as
 
$İtiÚ
 => 
$defš™iÚ
) {

62 ià(
	`is£t
(
$defš™iÚ
['cÚšs']è&& 
	`is_¬¿y
($definition['contains'])) {

63 
$¡Üage
[
$İtiÚ
] = 
	`¬¿y
();

64 
$this
->
	`_£t_İtiÚ_deçuÉs
(
$¡Üage
[
$İtiÚ
], 
$defš™iÚ
['cÚšs'], 
$Ëv–
++);

66 
	`–£if
 (!
	`em±y
(
$defš™iÚ
['translatable']) && !empty($definition['default'])) {

67 
$¡Üage
[
$İtiÚ
] = 
	`t
(
$defš™iÚ
['default']);

70 
$¡Üage
[
$İtiÚ
] = 
	`is£t
(
$defš™iÚ
['deçuÉ']è? $defš™iÚ['deçuÉ'] : 
NULL
;

73 
	}
}

79 
funùiÚ
 
	$uÅack_İtiÚs
(&
$¡Üage
, 
$İtiÚs
, 
$defš™iÚ
 = 
NULL
) {

80 ià(!
	`is_¬¿y
(
$İtiÚs
)) {

84 ià(!
	`is£t
(
$defš™iÚ
)) {

85 
$defš™iÚ
 = 
$this
->
	`İtiÚ_defš™iÚ
();

88 
	`fÜ—ch
 (
$İtiÚs
 
as
 
$key
 => 
$v®ue
) {

89 ià(
	`is_¬¿y
(
$v®ue
)) {

90 ià(!
	`is£t
(
$¡Üage
[
$key
]è|| !
	`is_¬¿y
($storage[$key])) {

91 
$¡Üage
[
$key
] = 
	`¬¿y
();

94 
$this
->
	`uÅack_İtiÚs
(
$¡Üage
[
$key
], 
$v®ue
, 
	`is£t
(
$defš™iÚ
[$key]['cÚšs']è? $defš™iÚ[$key]['cÚšs'] : 
	`¬¿y
());

96 ià(!
	`em±y
(
$defš™iÚ
[
$key
]['Œª¦©abË']è&& !em±y(
$v®ue
)) {

97 
$¡Üage
[
$key
] = 
	`t
(
$v®ue
);

100 
$¡Üage
[
$key
] = 
$v®ue
;

103 
	}
}

108 
funùiÚ
 
	$£t_defš™iÚ
(
$defš™iÚ
) {

109 
$this
->
defš™iÚ
 = 
$defš™iÚ
;

110 ià(
	`is£t
(
$defš™iÚ
['field'])) {

111 
$this
->
»®_f›ld
 = 
$defš™iÚ
['field'];

113 
	}
}

115 
funùiÚ
 
	$de¡roy
() {

116 ià(
	`is£t
(
$this
->
v›w
)) {

117 
	`un£t
(
$this
->
v›w
);

120 ià(
	`is£t
(
$this
->
di¥Ïy
)) {

121 
	`un£t
(
$this
->
di¥Ïy
);

124 ià(
	`is£t
(
$this
->
qu”y
)) {

125 
	`un£t
(
$this
->
qu”y
);

127 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/cache.inc

1 <?
php


13 
funùiÚ
 
	$_v›ws_šşude_hªdËrs
() {

14 
	`v›ws_moduË_šşude
('views.inc');

15 
	}
}

20 
funùiÚ
 
	$_v›ws_šşude_deçuÉ_v›ws
() {

21 
	`v›ws_moduË_šşude
('views_default.inc');

22 
	}
}

27 
funùiÚ
 
	$_v›ws_ãtch_d©a
(
$bË
 = 
NULL
) {

28 
$ÿche
 = 
NULL
;

29 ià(!
	`is£t
(
$ÿche
)) {

30 
$¡¬t
 = 
	`v›ws_miüÙime
();

32 
	`v›ws_šşude_hªdËrs
();

34 
$d©a
 = 
	`v›ws_ÿche_g‘
('v›ws_d©a', 
TRUE
);

35 ià(!
	`em±y
(
$d©a
->
d©a
)) {

36 
$ÿche
 = 
$d©a
->
d©a
;

39 ià(
	`em±y
(
$ÿche
)) {

40 
$ÿche
 = 
	`moduË_švoke_®l
('views_data');

41 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_d©a_®‹r'è
as
 
$moduË
) {

42 
$funùiÚ
 = 
$moduË
 . '_views_data_alter';

43 
	`$funùiÚ
(
$ÿche
);

46 
	`v›ws_ÿche_£t
('v›ws_d©a', 
$ÿche
, 
TRUE
);

49 
	`v´
('V›w d©¨budime: ' . (
	`v›ws_miüÙime
(è- 
$¡¬t
) * 1000 . ' ms');

52 ià(!
$bË
) {

53  
$ÿche
;

55 ià(
	`is£t
(
$ÿche
[
$bË
])) {

56  
$ÿche
[
$bË
];

60  
	`¬¿y
();

61 
	}
}

66 
funùiÚ
 
	$_v›ws_ãtch_¶ugš_d©a
(
$ty³
 = 
NULL
, 
$¶ugš
 = NULL) {

67 
$ÿche
 = 
NULL
;

68 ià(!
	`is£t
(
$ÿche
)) {

69 
$¡¬t
 = 
	`v›ws_miüÙime
();

70 
	`v›ws_šşude_hªdËrs
();

72 
$ÿche
 = 
	`v›ws_discov”_¶ugšs
();

74 
	`v´
('V›w ¶ugš budime: ' . (
	`v›ws_miüÙime
(è- 
$¡¬t
) * 1000 . ' ms');

77 ià(!
$ty³
 && !
$¶ugš
) {

78  
$ÿche
;

80 ià(!
$¶ugš
) {

82 ià(
	`is£t
(
$ÿche
[
$ty³
])) {

83  
$ÿche
[
$ty³
];

86 ià(
	`is£t
(
$ÿche
[
$ty³
][
$¶ugš
])) {

87  
$ÿche
[
$ty³
][
$¶ugš
];

91  
	`¬¿y
();

92 
	}
}

99 
funùiÚ
 
	$_v›ws_discov”_deçuÉ_v›ws
() {

100 
$ÿche
 = 
NULL
;

102 ià(!
	`is£t
(
$ÿche
)) {

103 
$šdex
 = 
	`v›ws_ÿche_g‘
('v›ws_deçuÉ_v›ws_šdex', 
TRUE
);

106 ià(
	`is£t
(
$šdex
->
d©a
è&& 
	`is_¬¿y
($index->data)) {

107 
$ÿche
 = 
	`¬¿y
();

108 
	`fÜ—ch
 (
$šdex
->
d©a
 
as
 
$v›w_Çme
) {

109 
$d©a
 = 
	`v›ws_ÿche_g‘
('v›ws_deçuÉ:' . 
$v›w_Çme
, 
TRUE
);

110 ià(
	`is£t
(
$d©a
->
d©a
è&& 
	`is_objeù
($data->data)) {

111 
$ÿche
[
$v›w_Çme
] = 
$d©a
->
d©a
;

117 
	`v›ws_šşude_deçuÉ_v›ws
();

118 
$ÿche
 = 
	`¬¿y
();

120 
	`fÜ—ch
(
	`moduË_im¶em’ts
('v›ws_deçuÉ_v›ws'è
as
 
$moduË
) {

121 
$»suÉs
 = 
	`ÿÎ_u£r_func
(
$moduË
 . "_views_default_views");

122 ià(!
	`em±y
(
$»suÉs
è&& 
	`is_¬¿y
($results)) {

123 
	`fÜ—ch
(
$»suÉs
 
as
 
$Çme
 => 
$v›w
) {

125 ià(!
	`em±y
(
$v›w
->
­i_v”siÚ
) && $view->api_version >= 2) {

127 
$v›w
->
	`de¡roy
();

128 ià(!
	`is£t
(
$ÿche
[
$Çme
])) {

129 
$ÿche
[
$Çme
] = 
$v›w
;

132 
	`w©chdog
('v›w', "V›w‚am'@Çme' i ®»adyak’", 
	`¬¿y
('@Çme' => 
$Çme
), 
WATCHDOG_ERROR
);

140 
	`dru·l_®‹r
('v›ws_deçuÉ_v›ws', 
$ÿche
);

143 
$šdex
 = 
	`¬¿y_keys
(
$ÿche
);

144 
	`v›ws_ÿche_£t
('v›ws_deçuÉ_v›ws_šdex', 
$šdex
, 
TRUE
);

147 
	`fÜ—ch
 (
$ÿche
 
as
 
$Çme
 => 
$v›w
) {

148 
	`v›ws_ÿche_£t
('v›ws_deçuÉ:' . 
$Çme
, 
$v›w
, 
TRUE
);

153  
$ÿche
;

154 
	}
}

169 
funùiÚ
 
	$v›ws_ÿche_£t
(
$cid
, 
$d©a
, 
$u£_Ïnguage
 = 
FALSE
) {

170 
glob®
 
$Ïnguage
;

172 ià(
	`v¬ŸbË_g‘
('v›ws_sk_ÿche', 
FALSE
)) {

175 ià(
$u£_Ïnguage
) {

176 
$cid
 .ğ':' . 
$Ïnguage
->
Ïnguage
;

179 
	`ÿche_£t
(
$cid
, 
$d©a
, 'cache_views');

180 
	}
}

192 
funùiÚ
 
	$v›ws_ÿche_g‘
(
$cid
, 
$u£_Ïnguage
 = 
FALSE
) {

193 
glob®
 
$Ïnguage
;

195 ià(
	`v¬ŸbË_g‘
('v›ws_sk_ÿche', 
FALSE
)) {

198 ià(
$u£_Ïnguage
) {

199 
$cid
 .ğ':' . 
$Ïnguage
->
Ïnguage
;

202  
	`ÿche_g‘
(
$cid
, 'cache_views');

203 
	}
}

232 
funùiÚ
 
	$v›ws_objeù_ÿche_g‘
(
$obj
, 
$Çme
, 
$sk_ÿche
 = 
FALSE
) {

233 
$ÿche
 = 
	`¬¿y
();

234 
$key
 = "$obj:$name";

235 ià(
$sk_ÿche
) {

236 
	`un£t
(
$ÿche
[
$key
]);

239 ià(!
	`¬¿y_key_exi¡s
(
$key
, 
$ÿche
)) {

240 
$d©a
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT * FROM {v›ws_objeù_ÿche} WHERE sid = '%s' AND obj = '%s' AND‚amğ'%s'", 
	`£ssiÚ_id
(), 
$obj
, 
$Çme
));

241 ià(
$d©a
) {

242 
$ÿche
[
$key
] = 
	`un£rŸlize
(
$d©a
->
d©a
);

245  
	`is£t
(
$ÿche
[
$key
]è? $ÿche[$key] : 
NULL
;

246 
	}
}

259 
funùiÚ
 
	$v›ws_objeù_ÿche_£t
(
$obj
, 
$Çme
, 
$ÿche
) {

260 
	`v›ws_objeù_ÿche_ş—r
(
$obj
, 
$Çme
);

261 
	`db_qu”y
("INSERT INTO {v›ws_objeù_ÿche} (sid, obj,‚ame, d©a, upd©edèVALUES ('%s', '%s', '%s', '%s', %d)", 
	`£ssiÚ_id
(), 
$obj
, 
$Çme
, 
	`£rŸlize
(
$ÿche
), 
	`time
());

262 
	}
}

273 
funùiÚ
 
	$v›ws_objeù_ÿche_ş—r
(
$obj
, 
$Çme
) {

274 
	`db_qu”y
("DELETE FROM {v›ws_objeù_ÿche} WHERE sid = '%s' AND obj = '%s' AND‚amğ'%s'", 
	`£ssiÚ_id
(), 
$obj
, 
$Çme
);

275 
	}
}

285 
funùiÚ
 
	$v›ws_objeù_ÿche_ş—n
(
$age
 = 
NULL
) {

286 ià(
	`em±y
(
$age
)) {

287 
$age
 = 86400 * 7;

289 
	`db_qu”y
("DELETE FROM {v›ws_objeù_ÿche} WHERE upd©ed < %d", 
	`time
(è- 
$age
);

290 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/convert.inc

1 <?
php


12 
funùiÚ
 
	$v›ws_ui_admš_cÚv”t
() {

13 ià(!
	`db_bË_exi¡s
('view_view')) {

14  
	`t
('There‡re‚o Views 1 views stored inhe databaseo convert.');

16 
$™ems
 = 
	`¬¿y
();

17 
$sÜts
 = 
	`¬¿y
();

19 
$h—d”
 = 
	`¬¿y
(

20 
	`¬¿y
('d©a' => 
	`t
('View‚ame'), 'field' => 'name', 'sort' => 'asc'),

21 
	`¬¿y
('d©a' => 
	`t
('Description')),

22 
	`¬¿y
('d©a' => 
	`t
('Operations')),

24 
$cu¼’t_v›ws
 = 
	`v›ws_g‘_®l_v›ws
();

26 
$»suÉ
 = 
	`db_qu”y
("SELECT v.* FROM {view_view} v");

27 
$v›w
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

28 
$İs
 = 
	`¬¿y
();

29 ià(!
	`is£t
(
$cu¼’t_v›ws
[
$v›w
->
Çme
])) {

30 
$İs
[] = 
	`l
(
	`t
('Convert'), "admin/build/views1/convert/$view->name");

33 
$İs
[] = 
	`t
('Converted');

35 
$İs
[] = 
	`l
(
	`t
('Delete'), "admin/build/views1/delete/$view->name");

37 
$™em
 = 
	`¬¿y
();

38 
$™em
[] = 
	`check_¶aš
(
$v›w
->
Çme
);

39 
$™em
[] = 
	`check_¶aš
(
$v›w
->
desütiÚ
);

40 
$™em
[] = 
	`im¶ode
(' | ', 
$İs
);

41 
$™ems
[] = 
$™em
;

43 
$ts
 = 
	`bËsÜt_š™
(
$h—d”
);

44 
$ts
['sql']) {

47 
$sÜts
[] = 
$™em
[0];

50 
$sÜts
[] = 
$™em
[1];

55 ià(!
	`em±y
(
$ts
)) {

56 ià(
	`¡¹Şow”
(
$ts
['sort']) == 'desc') {

57 
	`¬sÜt
(
$sÜts
);

60 
	`asÜt
(
$sÜts
);

64 
$i
 = 
	`¬¿y
();

65 
	`fÜ—ch
 (
$sÜts
 
as
 
$id
 => 
$t™Ë
) {

66 
$i
[] = 
$™ems
[
$id
];

68 
$ouut
 = 
	`t
('Theable below†ists Views version 1 viewshat‡re stored inhe database. You canƒither converthemo work in Views version 2, or deletehem. The views‡re convertible only ifhere is‚o Views 2 view withhe same‚ame.');

69 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$i
);

71 
$ouut
 .ğ
	`dru·l_g‘_fÜm
('views_ui_convert_cleanup_form');

72  
$ouut
;

73 
	}
}

78 
funùiÚ
 
	$v›ws_ui_cÚv”t_ş—nup_fÜm
() {

79 
$fÜm
['v”ify'] = 
	`¬¿y
(

81 '#t™Ë' => 
	`t
('Remove‡ll Views 1ables'),

82 '#desütiÚ' => 
	`t
('Checkhis box‡ndhen click clean upo drop‡ll Views 1ables. Warning:his operation will‚ot be„eversible! Dohis only if you‡re sure you‚o†onger‚eedhis data.'),

83 '#»quœed' => 
TRUE
,

86 
$fÜm
['subm™'] = 
	`¬¿y
(

88 '#v®ue' => 
	`t
('Clean up'),

91  
$fÜm
;

92 
	}
}

94 
funùiÚ
 
	$v›ws_ui_cÚv”t_ş—nup_fÜm_subm™
(
$fÜm
, 
$fÜm_¡©e
) {

95 ià(
	`em±y
(
$fÜm_¡©e
['values']['verify'])) {

96 
	`dru·l_£t_mes§ge
('Please checkhe boxo verify you wanto destroy your Views 1able data.');

100 
$»t
 = 
	`¬¿y
();

101 ià(
	`db_bË_exi¡s
('view_view')) {

102 
	`db_drİ_bË
(
$»t
, 'view_view');

104 ià(
	`db_bË_exi¡s
('view_sort')) {

105 
	`db_drİ_bË
(
$»t
, 'view_sort');

107 ià(
	`db_bË_exi¡s
('view_argument')) {

108 
	`db_drİ_bË
(
$»t
, 'view_argument');

110 ià(
	`db_bË_exi¡s
('view_tablefield')) {

111 
	`db_drİ_bË
(
$»t
, 'view_tablefield');

113 ià(
	`db_bË_exi¡s
('view_filter')) {

114 
	`db_drİ_bË
(
$»t
, 'view_filter');

116 ià(
	`db_bË_exi¡s
('view_exposed_filter')) {

117 
	`db_drİ_bË
(
$»t
, 'view_exposed_filter');

120 
	`dru·l_£t_mes§ge
(
	`t
('All Views 1ables have been„emoved.'));

121 
	}
}

126 
funùiÚ
 
	$v›ws_ui_cÚv”t1
(
$Çme
) {

127 
$Şd
 = 
	`v›ws1_lßd
(
$Çme
);

128 ià(!
$Şd
) {

129  
	`t
('Unableo find view.');

132 
$v›w
 = 
	`v›ws1_impÜt
(
$Şd
);

134 ià(
$v›w
) {

135 
	`v›ws_ui_ÿche_£t
(
$v›w
);

136 
	`dru·l_gÙo
('admš/bud/v›ws/ed™/' . 
$v›w
->
Çme
);

139  
	`t
('Unableo convert view.');

141 
	}
}

146 
funùiÚ
 
	$v›ws_ui_d–‘e1_cÚfœm
(&
$fÜm_¡©e
, 
$vid
) {

147 
$fÜm_¡©e
['vid'] = 
$vid
;

148 
$fÜm
 = 
	`¬¿y
();

150 
$ÿnûl
 = 'admin/build/views/tools/convert';

151 ià(!
	`em±y
(
$_REQUEST
['cancel'])) {

152 
$ÿnûl
 = 
$_REQUEST
['cancel'];

154  
	`cÚfœm_fÜm
(
$fÜm
,

155 
	`t
('A» you su» you wªˆtØd–‘thv›w %Çme?', 
	`¬¿y
('%Çme' => 
$v›w
->
Çme
)),

156 
$ÿnûl
,

157 
	`t
('This‡ction cannot be undone.'),

158 
	`t
('Delete'),

159 
	`t
('Cancel'));

160 
	}
}

165 
funùiÚ
 
	$v›ws_ui_d–‘e1_cÚfœm_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

166 
	`v›ws1_d–‘e
(
$fÜm_¡©e
['vid']);

167 
	`dru·l_£t_mes§ge
(
	`t
('The view has been deleted'));

168 
$fÜm_¡©e
['redirect'] = 'admin/build/views/tools/convert';

169 
	}
}

174 
funùiÚ
 
	$v›ws1_impÜt
(
$impÜ‹d
) {

175 
	`v›ws_šşude_hªdËrs
();

176 
	`v›ws_moduË_šşude
('views_convert.inc');

178 
$v›w
 = 
	`v›ws_Ãw_v›w
();

180 
$v›w
->
Çme
 = 
$impÜ‹d
->name;

181 
$v›w
->
desütiÚ
 = 
$impÜ‹d
->description;

183 ià(!
	`em±y
(
$impÜ‹d
->
·ge
è&& !em±y($impÜ‹d->
u¾
)) {

184 
$·ge_di¥Ïy
 = 
$v›w
->
	`add_di¥Ïy
('page');

186 ià(!
	`em±y
(
$impÜ‹d
->
block
)) {

187 
$block_di¥Ïy
 = 
$v›w
->
	`add_di¥Ïy
('block');

189 
$v›w
->
	`š™_di¥Ïy
();

191 
$hªdËr
 = &
$v›w
->
di¥Ïy
['deçuÉ']->
hªdËr
;

192 
$hªdËr
->
	`£t_İtiÚ
('t™Ë', 
$impÜ‹d
->
·ge_t™Ë
);

193 
$hªdËr
->
	`£t_İtiÚ
('h—d”', 
$impÜ‹d
->
·ge_h—d”
);

194 
$hªdËr
->
	`£t_İtiÚ
('h—d”_fÜm©', 
$impÜ‹d
->
·ge_h—d”_fÜm©
);

195 
$hªdËr
->
	`£t_İtiÚ
('foÙ”', 
$impÜ‹d
->
·ge_foÙ”
);

196 
$hªdËr
->
	`£t_İtiÚ
('foÙ”_fÜm©', 
$impÜ‹d
->
·ge_foÙ”_fÜm©
);

197 
$hªdËr
->
	`£t_İtiÚ
('em±y', 
$impÜ‹d
->
·ge_em±y
);

198 
$hªdËr
->
	`£t_İtiÚ
('em±y_fÜm©', 
$impÜ‹d
->
·ge_em±y_fÜm©
);

200 
$hªdËr
->
	`£t_İtiÚ
('u£_·g”', 
$impÜ‹d
->
u£_·g”
);

201 
$hªdËr
->
	`£t_İtiÚ
('™ems_³r_·ge', 
$impÜ‹d
->
nodes_³r_·ge
);

202 
$hªdËr
->
	`£t_İtiÚ
('pager_element', 0);

203 
$hªdËr
->
	`£t_İtiÚ
('offset', 0);

205 
$acûss
 = 
	`¬¿y
('type' => 'none', 'role' =>‡rray(), 'perm' => '');

206 ià(
$impÜ‹d
->
acûss
) {

207 
$acûss
['type'] = 'role';

208 
$acûss
['rŞe'] = 
	`dru·l_m­_assoc
(
$impÜ‹d
->
acûss
);

211 
$hªdËr
->
	`£t_İtiÚ
('acûss', 
$acûss
);

212 ià(!
	`em±y
(
$impÜ‹d
->
·ge
è&& !em±y($impÜ‹d->
u¾
)) {

213 
$hªdËr
 = &
$v›w
->
di¥Ïy
[
$·ge_di¥Ïy
]->
hªdËr
;

214 
$u¾
 = 
	`¡r_»¶aû
('$¬g', '%', 
$impÜ‹d
->
u¾
);

215 
$hªdËr
->
	`£t_İtiÚ
('·th', 
$u¾
);

216 ià(
$impÜ‹d
->
m’u
) {

217 
$m’u
 = 
	`¬¿y
('type' => 'normal');

218 ià(
$impÜ‹d
->
m’u_b
) {

219 
$m’u
['type'] = 'tab';

221 ià(
$impÜ‹d
->
m’u_b_deçuÉ
) {

222 
$m’u
['type'] = 'defaultab';

224 
$m’u
['t™Ë'] = 
$impÜ‹d
->
m’u_t™Ë
 ? $impÜ‹d->m’u_t™Ë : $impÜ‹d->
·ge_t™Ë
;

225 
$hªdËr
->
	`£t_İtiÚ
('m’u', 
$m’u
);

227 ià(
$m’u
['type'] == 'defaultab') {

228 
$b_İtiÚs
 = 
	`¬¿y
('type' => 'none');

229 
$impÜ‹d
->
m’u_b_deçuÉ_·»Á_ty³
) {

232 
$b_İtiÚs
['ty³'] = 
$impÜ‹d
->
m’u_b_deçuÉ_·»Á_ty³
;

236 
$b_İtiÚs
['t™Ë'] = 
$impÜ‹d
->
m’u_·»Á_t™Ë
;

237 
$b_İtiÚs
['weight'] = 
$impÜ‹d
->
m’u_·»Á_b_weight
;

238 
$hªdËr
->
	`£t_İtiÚ
('b_İtiÚs', 
$b_İtiÚs
);

242 
	`v›ws1_cÚv”t_¡yË
(
$v›w
, 
$hªdËr
, 
$impÜ‹d
->
·ge_ty³
);

244 ià(!
	`em±y
(
$impÜ‹d
->
block
)) {

245 
$hªdËr
 = &
$v›w
->
di¥Ïy
[
$block_di¥Ïy
]->
hªdËr
;

247 ià(!
	`em±y
(
$impÜ‹d
->
block_t™Ë
)) {

248 ià(!
	`em±y
(
$impÜ‹d
->
·ge
)) {

249 
$hªdËr
->
	`£t_ov”ride
('title');

251 
$hªdËr
->
	`£t_İtiÚ
('t™Ë', 
$impÜ‹d
->
block_t™Ë
);

254 ià(!
	`em±y
(
$impÜ‹d
->
·ge
)) {

255 
$hªdËr
->
	`£t_ov”ride
('use_pager');

257 
$hªdËr
->
	`£t_İtiÚ
('u£_·g”', 
FALSE
);

259 ià(
$impÜ‹d
->
nodes_³r_block
 !ğ$impÜ‹d->
nodes_³r_·ge
) {

260 
$hªdËr
->
	`£t_İtiÚ
('™ems_³r_·ge', 
$impÜ‹d
->
nodes_³r_block
);

261 
$hªdËr
->
	`£t_İtiÚ
('offset', 0);

264 ià(
	`em±y
(
$impÜ‹d
->
block_u£_·ge_h—d”
)) {

265 ià(!
	`em±y
(
$impÜ‹d
->
·ge
)) {

266 
$hªdËr
->
	`£t_ov”ride
('header');

268 ià(!
	`em±y
(
$impÜ‹d
->
block_h—d”
)) {

269 
$hªdËr
->
	`£t_İtiÚ
('h—d”', 
$impÜ‹d
->
block_h—d”
);

270 
$hªdËr
->
	`£t_İtiÚ
('h—d”_fÜm©', 
$impÜ‹d
->
block_h—d”_fÜm©
);

273 ià(
	`em±y
(
$impÜ‹d
->
block_u£_·ge_foÙ”
)) {

274 ià(!
	`em±y
(
$impÜ‹d
->
·ge
)) {

275 
$hªdËr
->
	`£t_ov”ride
('footer');

277 ià(!
	`em±y
(
$impÜ‹d
->
block_foÙ”
)) {

278 
$hªdËr
->
	`£t_İtiÚ
('foÙ”', 
$impÜ‹d
->
block_foÙ”
);

279 
$hªdËr
->
	`£t_İtiÚ
('foÙ”_fÜm©', 
$impÜ‹d
->
block_foÙ”_fÜm©
);

282 ià(
	`em±y
(
$impÜ‹d
->
block_u£_·ge_em±y
)) {

283 ià(!
	`em±y
(
$impÜ‹d
->
·ge
)) {

284 
$hªdËr
->
	`£t_ov”ride
('empty');

286 ià(!
	`em±y
(
$impÜ‹d
->
block_em±y
)) {

287 
$hªdËr
->
	`£t_İtiÚ
('em±y', 
$impÜ‹d
->
block_em±y
);

288 
$hªdËr
->
	`£t_İtiÚ
('em±y_fÜm©', 
$impÜ‹d
->
block_em±y_fÜm©
);

292 
$hªdËr
->
	`£t_İtiÚ
('u£_mÜe', 
$impÜ‹d
->
block_mÜe
);

294 ià(!
	`em±y
(
$impÜ‹d
->
·ge
)) {

295 
$hªdËr
->
	`£t_ov”ride
('style_plugin');

297 
	`v›ws1_cÚv”t_¡yË
(
$v›w
, 
$hªdËr
, 
$impÜ‹d
->
block_ty³
);

304 
	`fÜ—ch
 (
$impÜ‹d
->
f›ld
 
as
 
$f›ld
) {

305 
$id
 = 
$v›w
->
	`add_™em
('deçuÉ', 'f›ld', 
$f›ld
['bËÇme'], $f›ld['f›ld'], 
	`¬¿y
('label' => $field['label']));

306 ià(
$v›w
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('style_plugin') == 'table') {

307 
$İtiÚs
 = 
$v›w
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('style_options');

308 ià(!
	`em±y
(
$f›ld
['sortable'])) {

309 
$İtiÚs
['šfo'][
$id
]['sÜbË'] = 
TRUE
;

310 ià(!
	`em±y
(
$f›ld
['defaultsort'])) {

311 
$İtiÚs
['deçuÉ'] = 
$id
;

314 
$v›w
->
di¥Ïy_hªdËr
->
	`£t_İtiÚ
('¡yË_İtiÚs', 
$İtiÚs
);

316 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_cÚv”t'è
as
 
$moduË
) {

317 
	`moduË_švoke
(
$moduË
, 'v›ws_cÚv”t', 'deçuÉ', 'f›ld', 
$v›w
, 
$f›ld
, 
$id
);

320 
	`fÜ—ch
 (
$impÜ‹d
->
sÜt
 
as
 
$f›ld
) {

321 
$id
 = 
$v›w
->
	`add_™em
('deçuÉ', 'sÜt', 
$f›ld
['bËÇme'], $f›ld['f›ld'], 
	`¬¿y
('order' => $field['sortorder']));

322 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_cÚv”t'è
as
 
$moduË
) {

323 
	`moduË_švoke
(
$moduË
, 'v›ws_cÚv”t', 'deçuÉ', 'sÜt', 
$v›w
, 
$f›ld
, 
$id
);

326 
$aùiÚs
 = 
	`¬¿y
('ignore', 'not found', 'ignore', 'summary‡sc', 'summary‡sc', 'summary desc', 'summary‡sc', 'empty');

327 
	`fÜ—ch
 (
$impÜ‹d
->
¬gum’t
 
as
 
$id
 => 
$f›ld
) {

328 ià(!
	`em±y
(
$impÜ‹d
->
v›w_¬gs_php
)) {

329 
$f›ld
['argoptions']['default_action'] = 'default';

330 
$f›ld
['argoptions']['default_argument_type'] = 'php';

331 
$f›ld
['¬gİtiÚs']['deçuÉ_¬gum’t_php'] = '$¬g ğev®(\''. 
	`¡r_»¶aû
("'", "\\'", 
$impÜ‹d
->
v›w_¬gs_php
) .'\');'."\n";

332 
$f›ld
['argoptions']['default_argument_php'] .= 'if (isset($args['. $field['position'] .'])) {'."\n";

333 
$f›ld
['argoptions']['default_argument_php'] .= '„eturn $args['. $field['position'] .'];'."\n";

334 
$f›ld
['argoptions']['default_argument_php'] .= '}';

335 
$f›ld
['¬gİtiÚs']['v®id©e_ç'] = 
$aùiÚs
[$field['argdefault']];

338 
$f›ld
['¬gİtiÚs']['deçuÉ_aùiÚ'] = 
$aùiÚs
[$field['argdefault']];

340 ià(!
	`em±y
(
$f›ld
['title'])) {

341 
$f›ld
['argoptions']['title'] = $field['title'];

343 ià(!
	`em±y
(
$f›ld
['wildcard'])) {

344 
$f›ld
['argoptions']['wildcard'] = $field['wildcard'];

346 ià(!
	`em±y
(
$f›ld
['wildcard_substitution'])) {

347 
$f›ld
['argoptions']['wildcard_substitution'] = $field['wildcard_substitution'];

351 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_cÚv”t'è
as
 
$moduË
) {

352 
	`moduË_švoke
(
$moduË
, 'v›ws_cÚv”t', 'deçuÉ', '¬gum’t', 
$v›w
, 
$f›ld
, 
NULL
);

355 
	`fÜ—ch
 (
$impÜ‹d
->
f‹r
 
as
 
$f›ld
) {

356 
$İtiÚs
 = 
$f›ld
['v®ue'] =ğ'' ? 
	`¬¿y
() :‡rray('value' => $field['value']);

357 
$id
 = 
$v›w
->
	`add_™em
('deçuÉ', 'f‹r', 
$f›ld
['bËÇme'], $f›ld['f›ld'], 
$İtiÚs
);

358 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_cÚv”t'è
as
 
$moduË
) {

359 
	`moduË_švoke
(
$moduË
, 'v›ws_cÚv”t', 'deçuÉ', 'f‹r', 
$v›w
, 
$f›ld
, 
$id
);

363 
$couÁ
 = 0;

364 
	`fÜ—ch
 (
$impÜ‹d
->
expo£d_f‹r
 
as
 
$f›ld
) {

365 
	`li¡
(, 
$id
èğ
	`ex¶ode
('.', 
$f›ld
['field'], 2);

366 
$™em
 = 
$v›w
->
	`g‘_™em
('deçuÉ', 'f‹r', 
$id
);

367 ià(
	`v›ws_g‘_hªdËr
(
$™em
['table'], $item['field'], 'filter')) {

368 
$™em
['expo£d'] = 
TRUE
;

371 
$™em
['expo£']['id’tif›r'] = 'f‹r' . 
$couÁ
;

372 
$™em
['expo£']['Ïb–'] = 
$f›ld
['label'];

373 
$™em
['expo£']['İ”©Ü'] = 
$f›ld
['İ”©Ü'] ? 'İ' . 
$couÁ
 : '';

374 
$™em
['expo£']['İtiÚ®'] = 
$f›ld
['optional'];

375 
$™em
['expo£']['sšgË'] = 
$f›ld
['single'];

376 
$v›w
->
	`£t_™em
('deçuÉ', 'f‹r', 
$id
, 
$™em
);

378 
$couÁ
++;

379 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_cÚv”t'è
as
 
$moduË
) {

380 
	`moduË_švoke
(
$moduË
, 'v›ws_cÚv”t', 'deçuÉ', 'expo£d_f‹r', 
$v›w
, 
$f›ld
, 
$id
);

384  
$v›w
;

385 
	}
}

387 
funùiÚ
 
	$v›ws1_cÚv”t_¡yË
(&
$v›w
, &
$hªdËr
, 
$ty³
) {

388 
$ty³
) {

390 
$hªdËr
->
	`£t_İtiÚ
('style_plugin', 'list');

391 
$hªdËr
->
	`£t_İtiÚ
('¡yË_İtiÚs', 
	`¬¿y
('type' => 'ul'));

392 
$hªdËr
->
	`£t_İtiÚ
('row_plugin', 'fields');

395 
$hªdËr
->
	`£t_İtiÚ
('row_plugin', 'node');

396 
$hªdËr
->
	`£t_İtiÚ
('row_İtiÚs', 
	`¬¿y
('‹a£r' => 
FALSE
, 'lšks' => 
TRUE
));

399 
$hªdËr
->
	`£t_İtiÚ
('row_plugin', 'node');

400 
$hªdËr
->
	`£t_İtiÚ
('row_İtiÚs', 
	`¬¿y
('‹a£r' => 
TRUE
, 'links' => TRUE));

403 
$İtiÚs
 = 
	`¬¿y
();

404 
$İtiÚs
['cŞumns'] = 
	`¬¿y
();

405 
$İtiÚs
['default'] = '';

406 
$İtiÚs
['šfo'] = 
	`¬¿y
();

407 
$İtiÚs
['ov”ride'] = 
FALSE
;

408 
$İtiÚs
['order'] = 'asc';

410 
$hªdËr
->
	`£t_İtiÚ
('style_plugin', 'table');

411 
$hªdËr
->
	`£t_İtiÚ
('¡yË_İtiÚs', 
$İtiÚs
);

415 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_cÚv”t'è
as
 
$moduË
) {

416 
	`moduË_švoke
(
$moduË
, 'v›ws_cÚv”t', 
$hªdËr
->
di¥Ïy
->
id
, '¡yË', 
$v›w
, 
$ty³
);

419 
	}
}

424 
funùiÚ
 
	$v›ws1_lßd
(
$¬g
) {

425 
$ÿche
 = 
	`¬¿y
();

426 
$which
 = 
	`is_num”ic
(
$¬g
) ? 'vid' : 'name';

427 ià(
	`is£t
(
$ÿche
[
$which
][
$¬g
])) {

428  
$ÿche
[
$which
][
$¬g
];

431 
$wh”e
 = (
	`is_num”ic
(
$¬g
) ? "v.vid = %d" : "v.name = '%s'");

432 
$v›w
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT v.* FROM {v›w_v›w} v WHERE $wh”e", 
$¬g
));

434 ià(!
$v›w
->
Çme
) {

435  
NULL
;

438 
$v›w
->
acûss
 = ($v›w->acûs ? 
	`ex¶ode
(', ', $v›w->acûssè: 
	`¬¿y
());

441 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {view_sort} vs WHERE vid = $view->vid ORDER BY…osition ASC");

443 
$v›w
->
sÜt
 = 
	`¬¿y
();

444 
$sÜt
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

445 ià(
	`sub¡r
(
$sÜt
['field'], 0, 2) == 'n.') {

446 
$sÜt
['f›ld'] = 'node' . 
	`sub¡r
($sort['field'], 1);

448 
$sÜt
['id'] = $sort['field'];

449 
$b™s
 = 
	`ex¶ode
('.', 
$sÜt
['field']);

450 
$sÜt
['bËÇme'] = 
$b™s
[0];

451 
$sÜt
['f›ld'] = 
$b™s
[1];

452 
$v›w
->
sÜt
[
$sÜt
['position']] = $sort;

455 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {view_argument} WHERE vid = $view->vid ORDER BY…osition ASC");

457 
$v›w
->
¬gum’t
 = 
	`¬¿y
();

458 
$¬g
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

459 
$¬g
['id'] = $arg['type'];

460 
$v›w
->
¬gum’t
[
$¬g
['position']] = $arg;

463 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {view_tablefield} WHERE vid = $view->vid ORDER BY…osition ASC");

465 
$v›w
->
f›ld
 = 
	`¬¿y
();

466 
$¬g
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

467 ià(
$¬g
['tablename'] == 'n') {

468 
$¬g
['tablename'] = 'node';

470 
$¬g
['id'] = $arg['fullname'] = "$arg[tablename].$arg[field]";

471 
$¬g
['queryname'] = "$arg[tablename]_$arg[field]";

472 
$v›w
->
f›ld
[] = 
$¬g
;

475 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {view_filter} WHERE vid = $view->vid ORDER BY…osition ASC");

481 
$v›w
->
f‹r
 = 
	`¬¿y
();

482 
$f‹r
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

483 ià(
	`sub¡r
(
$f‹r
['field'], 0, 2) == 'n.') {

484 
$f‹r
['f›ld'] = 'node' . 
	`sub¡r
($filter['field'], 1);

487 ià(
$f‹r
['operator'] == 'AND' ||

488 
$f‹r
['operator'] == 'OR' ||

489 
$f‹r
['operator'] == 'NOR') {

493 ià(
$f‹r
['v®ue'] !=ğ
NULL
 && $filter['value'] !== '') {

494 
$f‹r
['v®ue'] = 
	`ex¶ode
(',', $filter['value']);

497 
$f‹r
['v®ue'] = 
	`¬¿y
();

500 
$f‹r
['id'] = $filter['field'];

501 
$b™s
 = 
	`ex¶ode
('.', 
$f‹r
['field']);

502 
$f‹r
['bËÇme'] = 
$b™s
[0];

503 
$f‹r
['f›ld'] = 
$b™s
[1];

504 
$v›w
->
f‹r
[
$f‹r
['position']] = $filter;

507 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {view_exposed_filter} WHERE vid = $view->vid ORDER BY…osition ASC");

509 
$v›w
->
expo£d_f‹r
 = 
	`¬¿y
();

510 
$¬g
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

511 
$¬g
['id'] = $arg['field'];

512 
$v›w
->
expo£d_f‹r
[] = 
$¬g
;

515 
$ÿche
['vid'][
$v›w
->
vid
] = $view;

516 
$ÿche
['Çme'][
$v›w
->
Çme
] = $view;

518  
$v›w
;

519 
	}
}

525 
funùiÚ
 
	$v›ws1_d–‘e
(
$¬g
) {

526 
$ÿche
 = 
	`¬¿y
();

527 
$wh”e
 = (
	`is_num”ic
(
$¬g
) ? "v.vid = %d" : "v.name = '%s'");

528 
$v›w
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT v.* FROM {v›w_v›w} v WHERE $wh”e", 
$¬g
));

530 ià(!
$v›w
->
Çme
) {

531  
NULL
;

536 
$»suÉ
 = 
	`db_qu”y
("DELETE FROM {view_sort} WHERE vid = $view->vid");

537 
$»suÉ
 = 
	`db_qu”y
("DELETE FROM {view_argument} WHERE vid = $view->vid");

538 
$»suÉ
 = 
	`db_qu”y
("DELETE FROM {view_tablefield} WHERE vid = $view->vid");

539 
$»suÉ
 = 
	`db_qu”y
("DELETE FROM {view_filter} WHERE vid = $view->vid");

540 
$»suÉ
 = 
	`db_qu”y
("DELETE FROM {view_exposed_filter} WHERE vid = $view->vid");

541 
$»suÉ
 = 
	`db_qu”y
("DELETE FROM {view_view} WHERE vid = $view->vid");

542 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/form.inc

1 <?
php


9 
funùiÚ
 
	$_dru·l_bud_fÜm
(
$fÜm_id
, &
$fÜm_¡©e
) {

13 
$fÜm_¡©e
 +ğ
	`¬¿y
('¡Üage' => 
NULL
, 'subm™‹d' => 
FALSE
, 'šput' => 
$_POST
, 'method' => 'post');

15 
$¬gs
 = 
	`is£t
(
$fÜm_¡©e
['¬gs']è? $fÜm_¡©e['¬gs'] : 
	`¬¿y
();

16 
$ÿch—bË
 = 
FALSE
;

18 ià(
	`is£t
(
$_SESSION
['batch_form_state'])) {

22 
$fÜm_¡©e
 = 
$_SESSION
['batch_form_state'];

23 
	`un£t
(
$_SESSION
['batch_form_state']);

31 ià(
	`is£t
(
$_POST
['fÜm_id']è&& $_POST['fÜm_id'] =ğ
$fÜm_id
 && !
	`em±y
($_POST['form_build_id'])) {

32 
$fÜm
 = 
	`fÜm_g‘_ÿche
(
$_POST
['fÜm_bud_id'], 
$fÜm_¡©e
);

33 ià(!
	`em±y
(
$fÜm
['#no_cache']) ||ƒmpty($form)) {

34 
	`un£t
(
$fÜm
);

41 ià(!
	`is£t
(
$fÜm
)) {

42 
$fÜm_¡©e
['post'] = $form_state['input'];

44 
$¬gs_‹mp
 = 
$¬gs
;

45 
$¬gs_‹mp
[0] = &
$fÜm_¡©e
;

46 
	`¬¿y_unshiá
(
$¬gs_‹mp
, 
$fÜm_id
);

48 
$fÜm
 = 
	`ÿÎ_u£r_func_¬¿y
('dru·l_»Œ›ve_fÜm', 
$¬gs_‹mp
);

49 
$fÜm_bud_id
 = 'fÜm-' . 
	`md5
(
	`mt_¿nd
());

50 
$fÜm
['#bud_id'] = 
$fÜm_bud_id
;

52 ià(
$fÜm_¡©e
['m‘hod'] =ğ'g‘' && !
	`is£t
(
$fÜm
['#method'])) {

53 
$fÜm
['#method'] = 'get';

56 
	`dru·l_´•¬e_fÜm
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
);

59 
$Üigš®_fÜm
 = 
$fÜm
;

60 
$ÿch—bË
 = 
TRUE
;

61 
	`un£t
(
$fÜm_¡©e
['post']);

63 
$fÜm
['#po¡'] = 
$fÜm_¡©e
['input'];

70 
	`dru·l_´oûss_fÜm_Ãw
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
);

74 ià(!
	`em±y
(
$fÜm_¡©e
['executed']) &&ƒmpty($form_state['rerender'])) {

78 ià(
$ÿch—bË
 && !
	`em±y
(
$fÜm
['#cache']) &&ƒmpty($form['#no_cache'])) {

82 
	`fÜm_£t_ÿche
(
$fÜm_bud_id
, 
$Üigš®_fÜm
, 
NULL
);

100 ià(!
	`em±y
(
$fÜm_¡©e
['rebuild']) || !empty($form_state['storage'])) {

101 
$fÜm
 = 
	`dru·l_»bud_fÜm_Ãw
(
$fÜm_id
, 
$fÜm_¡©e
, 
$¬gs
);

106  
	`dru·l_»nd”_fÜm
(
$fÜm_id
, 
$fÜm
);

107 
	}
}

114 
funùiÚ
 
	$dru·l_»bud_fÜm_Ãw
(
$fÜm_id
, &
$fÜm_¡©e
, 
$¬gs
, 
$fÜm_bud_id
 = 
NULL
) {

118 
$¬gs
[0] = &
$fÜm_¡©e
;

120 
	`¬¿y_unshiá
(
$¬gs
, 
$fÜm_id
);

121 
$fÜm
 = 
	`ÿÎ_u£r_func_¬¿y
('dru·l_»Œ›ve_fÜm', 
$¬gs
);

123 ià(!
	`is£t
(
$fÜm_bud_id
)) {

125 
$fÜm_bud_id
 = 'fÜm-' . 
	`md5
(
	`mt_¿nd
());

127 
$fÜm
['#bud_id'] = 
$fÜm_bud_id
;

128 
	`dru·l_´•¬e_fÜm
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
);

130 ià(
	`em±y
(
$fÜm
['#no_cache'])) {

134 
	`fÜm_£t_ÿche
(
$fÜm_bud_id
, 
$fÜm
, 
$fÜm_¡©e
);

140 
$fÜm
['#po¡'] = 
$fÜm_¡©e
['input'];

141 
$fÜm
 = 
	`fÜm_bud”
(
$fÜm_id
, $fÜm, 
$fÜm_¡©e
);

143  
$fÜm
;

144 
	}
}

150 
funùiÚ
 
	$dru·l_´oûss_fÜm_Ãw
(
$fÜm_id
, &
$fÜm
, &
$fÜm_¡©e
) {

155 
$fÜm_¡©e
['v®ues'] = 
	`¬¿y
();

158 ià(
$fÜm_¡©e
['method'] == 'get') {

159 ià(!
	`is£t
(
$fÜm
['#post']['form_build_id'])) {

160 
$fÜm
['#post']['form_build_id'] = $form['#build_id'];

162 ià(!
	`is£t
(
$fÜm
['#post']['form_id'])) {

163 
$fÜm
['#po¡']['fÜm_id'] = 
$fÜm_id
;

165 ià(!
	`is£t
(
$fÜm
['#post']['form_token']) && isset($form['#token'])) {

166 
$fÜm
['#po¡']['fÜm_tok’'] = 
	`dru·l_g‘_tok’
($form['#token']);

170 
$fÜm
 = 
	`fÜm_bud”
(
$fÜm_id
, $fÜm, 
$fÜm_¡©e
);

174 ià((!
	`em±y
(
$fÜm
['#´og¿mmed'])è|| (!em±y($fÜm['#po¡']è&& (
	`is£t
($fÜm['#po¡']['fÜm_id']è&& ($fÜm['#po¡']['fÜm_id'] =ğ
$fÜm_id
)))) {

175 
	`dru·l_v®id©e_fÜm_Ãw
(
$fÜm_id
, 
$fÜm
, 
$fÜm_¡©e
);

182 
	`fÜm_ş—n_id
(
NULL
, 
TRUE
);

184 ià((!
	`em±y
(
$fÜm_¡©e
['subm™‹d'])è&& !
	`fÜm_g‘_”rÜs
() &&ƒmpty($form_state['rebuild'])) {

185 
$fÜm_¡©e
['»dœeù'] = 
NULL
;

186 
	`fÜm_execu‹_hªdËrs
('subm™', 
$fÜm
, 
$fÜm_¡©e
);

191 ià(
	`v¬ŸbË_g‘
('ÿche', 
CACHE_DISABLED
è=ğCACHE_DISABLED && !
	`em±y
(
$fÜm_¡©e
['values']['form_build_id'])) {

192 
	`ÿche_ş—r_®l
('fÜm_' . 
$fÜm_¡©e
['values']['form_build_id'], 'cache_form');

193 
	`ÿche_ş—r_®l
('¡Üage_' . 
$fÜm_¡©e
['values']['form_build_id'], 'cache_form');

200 ià(
$b©ch
 =& 
	`b©ch_g‘
(è&& !
	`is£t
($batch['current_set'])) {

203 
$b©ch
['fÜm'] = 
$fÜm
;

204 
$b©ch
['fÜm_¡©e'] = 
$fÜm_¡©e
;

205 
$b©ch
['´og»ssive'] = !
$fÜm
['#programmed'];

206 
	`b©ch_´oûss
();

220 ià(!
$fÜm
['#´og¿mmed'] && 
	`em±y
(
$fÜm_¡©e
['rebuild']) &&ƒmpty($form_state['storage'])) {

221 ià(!
	`em±y
(
$fÜm_¡©e
['no_redirect'])) {

222 
$fÜm_¡©e
['execu‹d'] = 
TRUE
;

225 
	`dru·l_»dœeù_fÜm
(
$fÜm
, 
$fÜm_¡©e
['redirect']);

230 
	}
}

237 
funùiÚ
 
	$dru·l_v®id©e_fÜm_Ãw
(
$fÜm_id
, 
$fÜm
, &
$fÜm_¡©e
) {

238 
$v®id©ed_fÜms
 = 
	`¬¿y
();

240 ià(
	`is£t
(
$v®id©ed_fÜms
[
$fÜm_id
]è&& 
	`em±y
(
$fÜm_¡©e
['must_validate'])) {

246 ià(
	`is£t
(
$fÜm
['#token'])) {

247 ià(!
	`dru·l_v®id_tok’
(
$fÜm_¡©e
['v®ues']['fÜm_tok’'], 
$fÜm
['#token'])) {

249 
	`fÜm_£t_”rÜ
('fÜm_tok’', 
	`t
('Validationƒrror,…leasery‡gain. Ifhisƒrror…ersists,…lease contacthe site‡dministrator.'));

253 
	`_fÜm_v®id©e
(
$fÜm
, 
$fÜm_¡©e
, 
$fÜm_id
);

254 
$v®id©ed_fÜms
[
$fÜm_id
] = 
TRUE
;

255 
	}
}

266 
funùiÚ
 
	$v›ws_´oûss_d•’d’cy
(
$–em’t
, 
$ed™
, &
$fÜm_¡©e
, &
$fÜm
) {

267 
$d•’d’c›s
;

268 ià(
	`is£t
(
$–em’t
['#d•’d’cy']è&& !is£t(
$d•’d’c›s
[$element['#id']])) {

269 ià(!
	`is£t
(
$–em’t
['#dependency_count'])) {

270 
$–em’t
['#dependency_count'] = 1;

272 ià(!
	`em±y
(
$fÜm_¡©e
['ajax'])) {

273 
$fÜm_¡©e
['j £‰šgs']['v›wsAjax']['fÜmR–©iÚshs'][
$–em’t
['#id']] = 
	`¬¿y
('num' => $element['#dependency_count'], 'values' => $element['#dependency']);

276 
	`v›ws_add_js
('dependent');

277 
$İtiÚs
['v›wsAjax']['fÜmR–©iÚshs'][
$–em’t
['#id']] = 
	`¬¿y
('num' => $element['#dependency_count'], 'values' => $element['#dependency']);

278 
	`dru·l_add_js
(
$İtiÚs
, 'setting');

280 
$d•’d’c›s
[
$–em’t
['#id']] = 
TRUE
;

283  
$–em’t
;

284 
	}
}

295 
funùiÚ
 
	$v›ws_´oûss_check_İtiÚs
(
$–em’t
, 
$ed™
, &
$fÜm_¡©e
, &
$fÜm
) {

296 ià(
$–em’t
['#type'] == 'checkboxes' || $element['#type'] == 'checkbox') {

297 
$–em’t
['#İtiÚs'] = 
	`¬¿y_m­
('check_plain', $element['#options']);

299  
$–em’t
;

300 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/handlers.inc

1 <?
php


11 
funùiÚ
 
_v›ws_ü—‹_hªdËr
(
$defš™iÚ
, 
$ty³
 = 'handler') {

13 ià(
em±y
(
$defš™iÚ
['handler'])) {

17 ià(!
şass_exi¡s
(
$defš™iÚ
['hªdËr']è&& !
v›ws_šşude_hªdËr
($defš™iÚ, 
$ty³
)) {

21 
	g$hªdËr
 = 
Ãw
 
$defš™iÚ
['handler'];

22 
	g$hªdËr
->
£t_defš™iÚ
(
$defš™iÚ
);

24 
	g$hªdËr
->
cÚ¡ruù
();

26  
	g$hªdËr
;

35 
funùiÚ
 
	$v›ws_šşude_hªdËr
(
$defš™iÚ
, 
$ty³
, 
$couÁ
 = 0) {

37 ià(
	`is£t
(
$defš™iÚ
['hªdËr']è&& 
	`şass_exi¡s
($definition['handler'])) {

38  
TRUE
;

42 ià(
$couÁ
 > 10) {

43 
	`v´
(
	`t
('HªdË¸@hªdË¸šşudŒ›dØloİ infš™–y!', 
	`¬¿y
('@hªdËr' => 
$defš™iÚ
['handler'])));

44  
FALSE
;

47 ià(!
	`is£t
(
$defš™iÚ
['path'])) {

48 ià(
$ty³
 == 'handler') {

49 
$defš™iÚ
 +ğ
	`v›ws_ãtch_hªdËr_d©a
($definition['handler']);

52 
$defš™iÚ
 +ğ
	`v›ws_ãtch_¶ugš_d©a
(
$ty³
, $definition['handler']);

56 ià(!
	`em±y
(
$defš™iÚ
['parent'])) {

57 ià(
$ty³
 == 'handler') {

58 
$·»Á
 = 
	`v›ws_ãtch_hªdËr_d©a
(
$defš™iÚ
['parent']);

61 
$·»Á
 = 
	`v›ws_ãtch_¶ugš_d©a
(
$ty³
, 
$defš™iÚ
['parent']);

64 ià(
$·»Á
) {

65 
$rc
 = 
	`v›ws_šşude_hªdËr
(
$·»Á
, 
$ty³
, 
$couÁ
 + 1);

68 ià(!
$rc
) {

69  
FALSE
;

74 ià(
	`is£t
(
$defš™iÚ
['path']) && $definition['file']) {

75 
$f’ame
 = './' . 
$defš™iÚ
['path'] . '/' . $definition['file'];

76 ià(
	`fe_exi¡s
(
$f’ame
)) {

77 
»quœe_Úû
 
$f’ame
;

81  
	`şass_exi¡s
(
$defš™iÚ
['handler']);

82 
	}
}

87 
funùiÚ
 
	$_v›ws_´•¬e_hªdËr
(
$defš™iÚ
, 
$d©a
, 
$f›ld
) {

88 
	`fÜ—ch
 (
	`¬¿y
('group', 't™Ë', 't™Ë shÜt', 'h–p', '»® f›ld'è
as
 
$key
) {

89 ià(!
	`is£t
(
$defš™iÚ
[
$key
])) {

91 ià(!
	`em±y
(
$d©a
[
$f›ld
][
$key
])) {

92 
$defš™iÚ
[
$key
] = 
$d©a
[
$f›ld
][$key];

95 ià(!
	`em±y
(
$d©a
['bË'][
$key
])) {

96 
$defš™iÚ
[
$key
] = 
$d©a
['table'][$key];

101  
	`_v›ws_ü—‹_hªdËr
(
$defš™iÚ
);

102 
	}
}

107 
funùiÚ
 
	$v›ws_ãtch_hªdËr_d©a
(
$hªdËr
 = 
NULL
) {

108 
$ÿche
 = 
NULL
;

109 ià(!
	`is£t
(
$ÿche
)) {

110 
$¡¬t
 = 
	`v›ws_miüÙime
();

112 
$ÿche
 = 
	`v›ws_discov”_hªdËrs
();

114 
	`v´
('V›w hªdËr budime: ' . (
	`v›ws_miüÙime
(è- 
$¡¬t
) * 1000 . ' ms');

117 ià(!
$hªdËr
) {

118  
$ÿche
;

120 ià(
	`is£t
(
$ÿche
[
$hªdËr
])) {

121  
$ÿche
[
$hªdËr
];

125  
	`¬¿y
();

126 
	}
}

133 
funùiÚ
 
	$v›ws_discov”_hªdËrs
() {

134 
$ÿche
 = 
	`¬¿y
();

136 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_hªdËrs'è
as
 
$moduË
) {

137 
$funùiÚ
 = 
$moduË
 . '_views_handlers';

138 
$»suÉ
 = 
	`$funùiÚ
();

139 ià(!
	`is_¬¿y
(
$»suÉ
)) {

143 
$moduË_dœ
 = 
	`is£t
(
$»suÉ
['šfo']['moduË']è? $»suÉ['šfo']['moduË'] : 
$moduË
;

144 
$·th
 = 
	`is£t
(
$»suÉ
['šfo']['·th']è? $»suÉ['šfo']['·th'] : 
	`dru·l_g‘_·th
('moduË', 
$moduË_dœ
);

146 
	`fÜ—ch
 (
$»suÉ
['hªdËrs'] 
as
 
$hªdËr
 => 
$def
) {

147 ià(!
	`is£t
(
$def
['module'])) {

148 
$def
['moduË'] = 
$moduË_dœ
;

150 ià(!
	`is£t
(
$def
['path'])) {

151 
$def
['·th'] = 
$·th
;

153 ià(!
	`is£t
(
$def
['file'])) {

154 
$def
['file'] = "$handler.inc";

156 ià(!
	`is£t
(
$def
['handler'])) {

157 
$def
['hªdËr'] = 
$hªdËr
;

160 
$ÿche
[
$hªdËr
] = 
$def
;

163  
$ÿche
;

164 
	}
}

169 
funùiÚ
 
	$v›ws_g‘_bË_još
(
$bË
, 
$ba£_bË
) {

170 
$d©a
 = 
	`v›ws_ãtch_d©a
(
$bË
);

171 ià(
	`is£t
(
$d©a
['bË']['još'][
$ba£_bË
])) {

172 
$h
 = 
$d©a
['bË']['još'][
$ba£_bË
];

173 ià(!
	`em±y
(
$h
['hªdËr']è&& 
	`şass_exi¡s
($h['handler'])) {

174 
$hªdËr
 = 
Ãw
 
$h
['handler'];

177 
$hªdËr
 = 
Ãw
 
	`v›ws_još
();

181 
$hªdËr
->
defš™iÚ
 = 
$h
;

182 ià(
	`em±y
(
$hªdËr
->
defš™iÚ
['table'])) {

183 
$hªdËr
->
defš™iÚ
['bË'] = 
$bË
;

186 ià(
	`em±y
(
$hªdËr
->
defš™iÚ
['left_table'])) {

187 
$hªdËr
->
defš™iÚ
['Ëá_bË'] = 
$ba£_bË
;

190 ià(
	`is£t
(
$h
['arguments'])) {

191 
	`ÿÎ_u£r_func_¬¿y
(
	`¬¿y
(&
$hªdËr
, 'cÚ¡ruù'), 
$h
['arguments']);

194 
$hªdËr
->
	`cÚ¡ruù
();

197  
$hªdËr
;

200 
	`v´
("Missing join: $table $base_table");

201 
	}
}

229 şas 
	cv›ws_hªdËr
 
ex‹nds
 
	mv›ws_objeù
 {

238 
funùiÚ
 
	$š™
(&
$v›w
, 
$İtiÚs
) {

239 
$this
->
v›w
 = &
$v›w
;

240 
$this
->
	`uÅack_İtiÚs
($this->
İtiÚs
, 
$İtiÚs
);

243 ià(
	`is£t
(
$İtiÚs
['table'])) {

244 
$this
->
bË
 = 
$İtiÚs
['table'];

247 ià(
	`is£t
(
$this
->
defš™iÚ
['real field'])) {

248 
$this
->
»®_f›ld
 = $this->
defš™iÚ
['real field'];

251 ià(
	`is£t
(
$this
->
defš™iÚ
['field'])) {

252 
$this
->
»®_f›ld
 = $this->
defš™iÚ
['field'];

255 ià(
	`is£t
(
$İtiÚs
['field'])) {

256 
$this
->
f›ld
 = 
$İtiÚs
['field'];

257 ià(!
	`is£t
(
$this
->
»®_f›ld
)) {

258 
$this
->
»®_f›ld
 = 
$İtiÚs
['field'];

262 
$this
->
qu”y
 = &
$v›w
->query;

268 
funùiÚ
 
	$ui_Çme
(
$shÜt
 = 
FALSE
) {

269 
$t™Ë
 = (
$shÜt
 && 
	`is£t
(
$this
->
defš™iÚ
['title short'])) ? $this->definition['title short'] : $this->definition['title'];

270  
	`t
('!group: !t™Ë', 
	`¬¿y
('!group' => 
$this
->
defš™iÚ
['group'], '!t™Ë' => 
$t™Ë
));

271 
	}
}

276 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

281 
funùiÚ
 
	$İtiÚs_v®id©e
(
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

287 
funùiÚ
 
	$İtiÚs_subm™
(
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

293 
funùiÚ
 
	$has_exŒa_İtiÚs
(è{  
FALSE
; 
	}
}

298 
funùiÚ
 
	$exŒa_İtiÚs
(&
$İtiÚ
è{ 
	}
}

303 
funùiÚ
 
	$exŒa_İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

308 
funùiÚ
 
	$exŒa_İtiÚs_v®id©e
(
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

314 
funùiÚ
 
	$exŒa_İtiÚs_subm™
(
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

320 
funùiÚ
 
	$expo£_İtiÚs
(è{ 
	}
}

324 
funùiÚ
 
	$expo£d_fÜm
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

329 
funùiÚ
 
	$expo£d_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

334 
funùiÚ
 
	$expo£d_subm™
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

345 
funùiÚ
 
	$expo£d_šfo
(è{ 
	}
}

350 
funùiÚ
 
	$ÿn_expo£
(è{  
FALSE
; 
	}
}

357 
funùiÚ
 
	$acûss
() {

358 ià(
	`is£t
(
$this
->
defš™iÚ
['acûs ÿÎback']è&& 
	`funùiÚ_exi¡s
($this->definition['access callback'])) {

359 ià(
	`is£t
(
$this
->
defš™iÚ
['acûs ¬gum’ts']è&& 
	`is_¬¿y
($this->definition['access‡rguments'])) {

360  
	`ÿÎ_u£r_func_¬¿y
(
$this
->
defš™iÚ
['access callback'], $this->definition['access‡rguments']);

362  
$this
->
defš™iÚ
['access callback']();

365  
TRUE
;

366 
	}
}

374 
funùiÚ
 
	$´e_qu”y
(è{ 
	}
}

380 
funùiÚ
 
	$£t_»ÏtiÚsh
() {

382 
$this
->
»ÏtiÚsh
 = 
NULL
;

385 ià(
	`em±y
(
$this
->
İtiÚs
['relationship']) || $this->options['relationship'] == 'none') {

389 
$»ÏtiÚsh
 = 
$this
->
İtiÚs
['relationship'];

392 ià(
	`em±y
(
$this
->
v›w
->
»ÏtiÚsh
[
$»ÏtiÚsh
])) {

398 ià(
	`em±y
(
$this
->
v›w
->
»ÏtiÚsh
[
$»ÏtiÚsh
]->
®Ÿs
)) {

403 
$this
->
»ÏtiÚsh
 = $this->
v›w
->»ÏtiÚsh[
$»ÏtiÚsh
]->
®Ÿs
;

404 
	}
}

411 
funùiÚ
 
	$qu”y
(è{ 
	}
}

417 
funùiÚ
 
	$’su»_my_bË
() {

418 ià(!
	`is£t
(
$this
->
bË_®Ÿs
)) {

419 
$this
->
bË_®Ÿs
 = $this->
qu”y
->
	`’su»_bË
($this->
bË
, $this->
»ÏtiÚsh
);

421  
$this
->
bË_®Ÿs
;

422 
	}
}

427 
funùiÚ
 
	$admš_summ¬y
(è{ 
	}
}

434 
funùiÚ
 
	$Ãeds_¡yË_¶ugš
(è{  
FALSE
; 
	}
}

442 
funùiÚ
 
	$is_expo£d
() {

443  !
	`em±y
(
$this
->
İtiÚs
['exposed']);

444 
	}
}

449 
funùiÚ
 
	$acû±_expo£d_šput
(
$šput
è{  
TRUE
; 
	}
}

454 
funùiÚ
 
	$¡Üe_expo£d_šput
(
$šput
, 
$¡©us
è{  
TRUE
; 
	}
}

463 
funùiÚ
 
	$g‘_još
() {

466 ià(
	`em±y
(
$this
->
qu”y
->
»ÏtiÚshs
[$this->
»ÏtiÚsh
])) {

467 
$ba£_bË
 = 
$this
->
qu”y
->
ba£_bË
;

470 
$ba£_bË
 = 
$this
->
qu”y
->
»ÏtiÚshs
[$this->
»ÏtiÚsh
]['base'];

473 
$još
 = 
	`v›ws_g‘_bË_još
(
$this
->
bË
, 
$ba£_bË
);

474 ià(
$još
) {

475  
	`dru·l_şÚe
(
$još
);

477 
	}
}

490 
funùiÚ
 
	$v®id©e
(è{  
	`¬¿y
(); 
	}
}

496 
funùiÚ
 
	$brok’
(è{ 
	}
}

513 şas 
	cv›ws_mªy_to_Úe_h–³r
 {

514 
funùiÚ
 
	$v›ws_mªy_to_Úe_h–³r
(&
$hªdËr
) {

515 
$this
->
hªdËr
 = &
$hªdËr
;

518 
funùiÚ
 
	$İtiÚ_defš™iÚ
(&
$İtiÚs
) {

519 
$İtiÚs
['»duû_du¶iÿ‹s'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

520 
	}
}

522 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

523 
$fÜm
['»duû_du¶iÿ‹s'] = 
	`¬¿y
(

525 '#t™Ë' => 
	`t
('Reduce duplicates'),

526 '#desütiÚ' => 
	`t
('This filter can cause itemshat have morehan one ofhe selected optionso‡ppear‡s duplicate„esults. Ifhis filter causes duplicate„esultso occur,his checkbox can„educehose duplicates; however,he moreerms it haso search for,he†ess…erformanthe query will be, so usehis with caution. Shouldn\'t be set on single-value fields,‡s it may cause valueso disappear from display, if used on‡n incompatible field.'),

527 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
hªdËr
->
İtiÚs
['reduce_duplicates']),

529 
	}
}

536 
funùiÚ
 
	$g‘_f›ld
() {

537 ià(!
	`em±y
(
$this
->
fÜmuÏ
)) {

538  
$this
->
hªdËr
->
	`g‘_fÜmuÏ
();

541  
$this
->
hªdËr
->
bË_®Ÿs
 . '.' . $this->hªdËr->
»®_f›ld
;

543 
	}
}

553 
funùiÚ
 
	$add_bË
(
$još
 = 
NULL
, 
$®Ÿs
 = NULL) {

555 
$f›ld
 = 
$this
->
hªdËr
->
bË
 . '.' . $this->hªdËr->
f›ld
;

557 ià(
	`em±y
(
$još
)) {

558 
$još
 = 
$this
->
	`g‘_još
();

563 
$»ÏtiÚsh
 = 
$this
->
hªdËr
->
»ÏtiÚsh
;

566 ià(
	`em±y
(
$this
->
hªdËr
->
qu”y
->
»ÏtiÚshs
[
$»ÏtiÚsh
])) {

567 
$ba£_bË
 = 
$this
->
hªdËr
->
qu”y
->
ba£_bË
;

570 
$ba£_bË
 = 
$this
->
hªdËr
->
qu”y
->
»ÏtiÚshs
[
$»ÏtiÚsh
]['base'];

575 
$r_još
 = 
	`dru·l_şÚe
(
$još
);

576 
$r_još
->
Ëá_bË
 !ğ
$ba£_bË
) {

577 
$r_još
 = 
	`v›ws_g‘_bË_još
($r_još->
Ëá_bË
, 
$ba£_bË
);

580 ià(
$r_još
->
bË
 !ğ
$još
->table) {

581 
$»ÏtiÚsh
 = 
$this
->
hªdËr
->
qu”y
->
	`add_»ÏtiÚsh
($this->hªdËr->
bË
 . '_' . 
$r_još
->bË, $r_još, $r_još->bË, $this->hªdËr->
»ÏtiÚsh
);

585 
$®Ÿs
 = 
$this
->
hªdËr
->
qu”y
->
	`add_bË
($this->hªdËr->
bË
, 
$»ÏtiÚsh
, 
$još
, $alias);

589 ià(
	`em±y
(
$this
->
hªdËr
->
v›w
->
mªy_to_Úe_bËs
[
$f›ld
])) {

590 
$this
->
hªdËr
->
v›w
->
mªy_to_Úe_bËs
[
$f›ld
] = $this->hªdËr->
v®ue
;

593 
$this
->
hªdËr
->
v›w
->
mªy_to_Úe_bËs
[
$f›ld
] = 
	`¬¿y_m”ge
($this->hªdËr->v›w->mªy_to_Úe_bËs[$f›ld], $this->hªdËr->
v®ue
);

596  
$®Ÿs
;

597 
	}
}

599 
funùiÚ
 
	$g‘_još
() {

600  
$this
->
hªdËr
->
	`g‘_još
();

601 
	}
}

607 
funùiÚ
 
	$summ¬y_još
() {

608 
$f›ld
 = 
$this
->
hªdËr
->
bË
 . '.' . $this->hªdËr->
f›ld
;

609 
$još
 = 
$this
->
	`g‘_još
();

612 
$İtiÚs
 = 
$this
->
hªdËr
->
İtiÚs
;

613 
$v›w
 = &
$this
->
hªdËr
->
v›w
;

614 
$qu”y
 = &
$this
->
hªdËr
->
qu”y
;

616 ià(!
	`em±y
(
$İtiÚs
['require_value'])) {

617 
$još
->
ty³
 = 'INNER';

620 ià(
	`em±y
(
$İtiÚs
['add_bË']è||ƒm±y(
$v›w
->
mªy_to_Úe_bËs
[
$f›ld
])) {

621  
$qu”y
->
	`’su»_bË
(
$this
->
hªdËr
->
bË
, $this->hªdËr->
»ÏtiÚsh
, 
$još
);

624 ià(!
	`em±y
(
$v›w
->
mªy_to_Úe_bËs
[
$f›ld
])) {

625 
	`fÜ—ch
 (
$v›w
->
mªy_to_Úe_bËs
[
$f›ld
] 
as
 
$v®ue
) {

626 
$još
->
exŒa
 = 
	`¬¿y
(

627 
	`¬¿y
(

628 'f›ld' => 
$this
->
hªdËr
->
»®_f›ld
,

630 'v®ue' => 
$v®ue
,

631 'num”ic' => !
	`em±y
(
$this
->
defš™iÚ
['numeric']),

636  
$this
->
	`add_bË
(
$još
);

638 
	}
}

644 
funùiÚ
 
	$’su»_my_bË
() {

645 ià(!
	`is£t
(
$this
->
hªdËr
->
bË_®Ÿs
)) {

647 
$f›ld
 = 
$this
->
hªdËr
->
bË
 . '.' . $this->hªdËr->
f›ld
;

648 ià(
$this
->
hªdËr
->
İ”©Ü
 =ğ'Ü' && 
	`em±y
($this->hªdËr->
İtiÚs
['reduce_duplicates'])) {

649 ià(
	`em±y
(
$this
->
hªdËr
->
İtiÚs
['add_bË']è&&ƒm±y($this->hªdËr->
v›w
->
mªy_to_Úe_bËs
[
$f›ld
])) {

652 
$još
 = 
$this
->
	`g‘_još
();

653 
$još
->
ty³
 = 'INNER';

654 
$this
->
hªdËr
->
bË_®Ÿs
 = $this->hªdËr->
qu”y
->
	`’su»_bË
($this->hªdËr->
bË
, $this->hªdËr->
»ÏtiÚsh
, 
$još
);

655 
$this
->
hªdËr
->
v›w
->
mªy_to_Úe_bËs
[
$f›ld
] = $this->hªdËr->
v®ue
;

658 
$još
 = 
$this
->
	`g‘_još
();

659 
$još
->
ty³
 = 'LEFT';

660 ià(!
	`em±y
(
$this
->
hªdËr
->
v›w
->
mªy_to_Úe_bËs
[
$f›ld
])) {

661 
	`fÜ—ch
 (
$this
->
hªdËr
->
v›w
->
mªy_to_Úe_bËs
[
$f›ld
] 
as
 
$v®ue
) {

662 
$još
->
exŒa
 = 
	`¬¿y
(

663 
	`¬¿y
(

664 'f›ld' => 
$this
->
hªdËr
->
»®_f›ld
,

666 'v®ue' => 
$v®ue
,

667 'num”ic' => !
	`em±y
(
$this
->
hªdËr
->
defš™iÚ
['numeric']),

673 
$this
->
hªdËr
->
bË_®Ÿs
 = $this->
	`add_bË
(
$još
);

676  
$this
->
hªdËr
->
bË_®Ÿs
;

679 ià(
$this
->
hªdËr
->
İ”©Ü
 != 'not') {

682 
$this
->
hªdËr
->
bË_®Ÿ£s
 = 
	`¬¿y
();

683 
	`fÜ—ch
 (
$this
->
hªdËr
->
v®ue
 
as
 
$v®ue
) {

684 
$još
 = 
$this
->
	`g‘_još
();

685 ià(
$this
->
hªdËr
->
İ”©Ü
 == 'and') {

686 
$još
->
ty³
 = 'INNER';

688 
$još
->
exŒa
 = 
	`¬¿y
(

689 
	`¬¿y
(

690 'f›ld' => 
$this
->
hªdËr
->
»®_f›ld
,

691 'v®ue' => 
$v®ue
,

692 'num”ic' => !
	`em±y
(
$this
->
hªdËr
->
defš™iÚ
['numeric']),

698 ià(!
	`is£t
(
$this
->
hªdËr
->
v›w
->
mªy_to_Úe_®Ÿ£s
[
$f›ld
][
$v®ue
])) {

699 ià(!
	`is£t
(
$this
->
hªdËr
->
v›w
->
mªy_to_Úe_couÁ
[$this->hªdËr->
bË
])) {

700 
$this
->
hªdËr
->
v›w
->
mªy_to_Úe_couÁ
[$this->hªdËr->
bË
] = 0;

702 
$this
->
hªdËr
->
v›w
->
mªy_to_Úe_®Ÿ£s
[
$f›ld
][
$v®ue
] = $this->hªdËr->
bË
 . '_v®ue_' . ($this->hªdËr->v›w->
mªy_to_Úe_couÁ
[$this->handler->table]++);

704 
$®Ÿs
 = 
$this
->
hªdËr
->
bË_®Ÿ£s
[
$v®ue
] = $this->
	`add_bË
(
$još
, $this->hªdËr->
v›w
->
mªy_to_Úe_®Ÿ£s
[
$f›ld
][$value]);

707 ià(
	`em±y
(
$this
->
hªdËr
->
bË_®Ÿs
)) {

708 
$this
->
hªdËr
->
bË_®Ÿs
 = 
$®Ÿs
;

715 
$još
 = 
$this
->
	`g‘_još
();

716 
$još
->
ty³
 = 'LEFT';

717 
$još
->
exŒa
 = 
	`¬¿y
();

718 
$još
->
exŒa_ty³
 = 'OR';

719 
	`fÜ—ch
 (
$this
->
hªdËr
->
v®ue
 
as
 
$v®ue
) {

720 
$još
->
exŒa
[] = 
	`¬¿y
(

721 'f›ld' => 
$this
->
hªdËr
->
»®_f›ld
,

722 'v®ue' => 
$v®ue
,

723 'num”ic' => !
	`em±y
(
$this
->
hªdËr
->
defš™iÚ
['numeric']),

727 
$this
->
hªdËr
->
bË_®Ÿs
 = $this->
	`add_bË
(
$još
);

730  
$this
->
hªdËr
->
bË_®Ÿs
;

731 
	}
}

733 
funùiÚ
 
	$add_f‹r
() {

734 ià(
	`em±y
(
$this
->
hªdËr
->
v®ue
)) {

737 
$this
->
hªdËr
->
	`’su»_my_bË
();

740 
$f›ld
 = 
$this
->
	`g‘_f›ld
();

741 
$İtiÚs
 = 
$this
->
hªdËr
->
İtiÚs
;

742 
$İ”©Ü
 = 
$this
->
hªdËr
->
İ”©Ü
;

743 ià(
	`em±y
(
$İtiÚs
['group'])) {

744 
$İtiÚs
['group'] = 0;

747 
$¶aûhŞd”
 = !
	`em±y
(
$this
->
hªdËr
->
defš™iÚ
['numeric']) ? '%d' : "'%s'";

749 ià(
$İ”©Ü
 == 'not') {

750 
$this
->
hªdËr
->
qu”y
->
	`add_wh”e
(
$İtiÚs
['group'], "$field IS NULL");

752 ià(
$İ”©Ü
 =ğ'Ü' && 
	`em±y
(
$İtiÚs
['reduce_duplicates'])) {

753 ià(
	`couÁ
(
$this
->
hªdËr
->
v®ue
) > 1) {

754 
$»¶aû
 = 
	`¬¿y_fl
(0, (
$this
->
hªdËr
->
v®ue
), 
$¶aûhŞd”
);

755 
$š
 = '(' . 
	`im¶ode
(", ", 
$»¶aû
) . ')';

756 
$this
->
hªdËr
->
qu”y
->
	`add_wh”e
(
$İtiÚs
['group'], "$f›ld IN $š", $this->hªdËr->
v®ue
);

759 
$this
->
hªdËr
->
qu”y
->
	`add_wh”e
(
$İtiÚs
['group'], "$f›ld = $¶aûhŞd”", $this->hªdËr->
v®ue
);

763 
$f›ld
 = 
$this
->
hªdËr
->
»®_f›ld
;

764 
$şau£s
 = 
	`¬¿y
();

765 
	`fÜ—ch
 (
$this
->
hªdËr
->
bË_®Ÿ£s
 
as
 
$v®ue
 => 
$®Ÿs
) {

766 
$şau£s
[] = "$alias.$field = $placeholder";

769 
$group
 = 
	`em±y
(
$İtiÚs
['group']) ? 0 : $options['group'];

772 
$this
->
hªdËr
->
qu”y
->
	`add_wh”e
(
$group
, 
	`im¶ode
(' ' . 
	`¡¹ouµ”
(
$İ”©Ü
è. ' ', 
$şau£s
), $this->hªdËr->
v®ue
);

774 
	}
}

788 
funùiÚ
 
	$v›ws_b»ak_ph¿£
(
$¡r
, &
$f‹r
) {

789 ià(!
$f‹r
) {

790 
$f‹r
 = 
Ãw
 
	`¡dCÏss
();

794 ià(!
	`is£t
(
$f‹r
->
v®ue
)) {

795 
$f‹r
->
v®ue
 = 
	`¬¿y
();

798 ià(!
	`is£t
(
$f‹r
->
İ”©Ü
)) {

799 
$f‹r
->
İ”©Ü
 = 'or';

802 ià(
$¡r
 == '') {

803  
$f‹r
;

806 ià(
	`´eg_m©ch
('/^([0-9]+[+ ])+[0-9]+$/', 
$¡r
)) {

808 
$f‹r
->
İ”©Ü
 = 'or';

809 
$f‹r
->
v®ue
 = 
	`´eg_¥l™
('/[+ ]/', 
$¡r
);

811 ià(
	`´eg_m©ch
('/^([0-9]+,)*[0-9]+$/', 
$¡r
)) {

812 
$f‹r
->
İ”©Ü
 = 'and';

813 
$f‹r
->
v®ue
 = 
	`ex¶ode
(',', 
$¡r
);

817 ià(!
	`em±y
(
$¡r
è&& (em±y(
$f‹r
->
v®ue
è|| !
	`is_¬¿y
($filter->value))) {

818 
$f‹r
->
v®ue
 = 
	`¬¿y
(-1);

819  
$f‹r
;

823 
	`fÜ—ch
 (
$f‹r
->
v®ue
 
as
 
$id
 => 
$v®ue
) {

824 
$f‹r
->
v®ue
[
$id
] = 
	`štv®
(
$v®ue
);

827  
$f‹r
;

828 
	}
}

836 
funùiÚ
 
	$v›ws_g‘_timezÚe
() {

837 
glob®
 
$u£r
;

838 ià(
	`v¬ŸbË_g‘
('cÚfigu¿bË_timezÚes', 1è&& 
$u£r
->
uid
 && 
	`¡¾’
($u£r->
timezÚe
)) {

839 
$timezÚe
 = 
$u£r
->
timezÚe
;

842 
$timezÚe
 = 
	`v¬ŸbË_g‘
('date_default_timezone', 0);

846 ià(
	`š_¬¿y
(
$GLOBALS
['db_ty³'], 
	`¬¿y
('mysql', 'mysqli', 'pgsql'))) {

847 
$off£t
 = '+00:00';

848 
$®»ady_£t
 = 
çl£
;

849 ià(!
$®»ady_£t
) {

850 ià(
$GLOBALS
['db_type'] == 'pgsql') {

851 
	`db_qu”y
("SET TIME ZONE INTERVAL '$offset' HOUR TO MINUTE");

853 
	`–£if
 (
$GLOBALS
['db_ty³'] =ğ'mysqli' || 
	`v”siÚ_com·»
(
	`mysql_g‘_£rv”_šfo
(), '4.1.3', '>=')) {

854 
	`db_qu”y
("SET @@session.time_zone = '$offset'");

857 
$®»ady_£t
 = 
Œue
;

861  
$timezÚe
;

862 
	}
}

878 
funùiÚ
 
v›ws_d©e_sql_f›ld
(
$f›ld
, 
$f›ld_ty³
 = 'št', 
$£t_off£t
 = 
NULL
) {

879 
$db_ty³
 = 
$GLOBALS
['db_type'];

880 
	g$off£t
 = 
$£t_off£t
 !=ğ
NULL
 ? $£t_off£ˆ: 
v›ws_g‘_timezÚe
();

881 
	g$db_ty³
) {

884 
$f›ld_ty³
) {

886 
$f›ld
 = "FROM_UNIXTIME($field)";

891 ià(!
em±y
(
$off£t
)) {

892 
	g$f›ld
 = "($field + INTERVAL $offset SECOND)";

894  
	g$f›ld
;

896 
$f›ld_ty³
) {

898 
$f›ld
 = "$field::ABSTIME";

903 ià(!
em±y
(
$off£t
)) {

904 
	g$f›ld
 = "($field + INTERVAL '$offset SECONDS')";

906  
	g$f›ld
;

926 
funùiÚ
 
v›ws_d©e_sql_fÜm©
(
$fÜm©
, 
$f›ld
, 
$f›ld_ty³
 = 'št', 
$£t_off£t
 = 
NULL
) {

927 
$db_ty³
 = 
$GLOBALS
['db_type'];

928 
	g$f›ld
 = 
v›ws_d©e_sql_f›ld
(
$f›ld
, 
$f›ld_ty³
, 
$£t_off£t
);

929 
	g$db_ty³
) {

932 
$»¶aû
 = 
¬¿y
(

940 
	g$fÜm©
 = 
¡¹r
(
$fÜm©
, 
$»¶aû
);

943 
$»¶aû
 = 
¬¿y
(

951 
	g$fÜm©
 = 
¡¹r
(
$fÜm©
, 
$»¶aû
);

972 
funùiÚ
 
v›ws_d©e_sql_exŒaù
(
$exŒaù_ty³
, 
$f›ld
, 
$f›ld_ty³
 = 'št', 
$£t_off£t
 = 
NULL
) {

973 
$db_ty³
 = 
$GLOBALS
['db_type'];

974 
	g$f›ld
 = 
v›ws_d©e_sql_f›ld
(
$f›ld
, 
$f›ld_ty³
, 
$£t_off£t
);

978 
	g$exŒaù_ty³
) {

980  
$f›ld
;

994 
$db_ty³
) {

1003 
$db_ty³
) {

1013 
$db_ty³
) {

1027 
funùiÚ
 
	$v›ws_v›ws_hªdËrs
() {

1028  
	`¬¿y
(

1029 'šfo' => 
	`¬¿y
(

1030 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/handlers',

1032 'hªdËrs' => 
	`¬¿y
(

1034 'v›ws_hªdËr_¬gum’t' => 
	`¬¿y
(

1037 'v›ws_hªdËr_¬gum’t_num”ic' => 
	`¬¿y
(

1040 'v›ws_hªdËr_¬gum’t_fÜmuÏ' => 
	`¬¿y
(

1043 'v›ws_hªdËr_¬gum’t_d©e' => 
	`¬¿y
(

1046 'v›ws_hªdËr_¬gum’t_¡ršg' => 
	`¬¿y
(

1049 'v›ws_hªdËr_¬gum’t_mªy_to_Úe' => 
	`¬¿y
(

1052 'v›ws_hªdËr_¬gum’t_nuÎ' => 
	`¬¿y
(

1057 'v›ws_hªdËr_f›ld' => 
	`¬¿y
(

1060 'v›ws_hªdËr_f›ld_d©e' => 
	`¬¿y
(

1063 'v›ws_hªdËr_f›ld_boŞ—n' => 
	`¬¿y
(

1066 'v›ws_hªdËr_f›ld_m¬kup' => 
	`¬¿y
(

1069 'v›ws_hªdËr_f›ld_xss' => 
	`¬¿y
(

1073 'v›ws_hªdËr_f›ld_u¾' => 
	`¬¿y
(

1076 'v›ws_hªdËr_f›ld_fe_size' => 
	`¬¿y
(

1080 'v›ws_hªdËr_f›ld_´”’d”_li¡' => 
	`¬¿y
(

1083 'v›ws_hªdËr_f›ld_num”ic' => 
	`¬¿y
(

1086 'v›ws_hªdËr_f›ld_cu¡om' => 
	`¬¿y
(

1089 'v›ws_hªdËr_f›ld_couÁ”' => 
	`¬¿y
(

1094 'v›ws_hªdËr_f‹r' => 
	`¬¿y
(

1097 'v›ws_hªdËr_f‹r_equ®™y' => 
	`¬¿y
(

1100 'v›ws_hªdËr_f‹r_¡ršg' => 
	`¬¿y
(

1103 'v›ws_hªdËr_f‹r_boŞ—n_İ”©Ü' => 
	`¬¿y
(

1106 'v›ws_hªdËr_f‹r_boŞ—n_İ”©Ü_¡ršg' => 
	`¬¿y
(

1109 'v›ws_hªdËr_f‹r_š_İ”©Ü' => 
	`¬¿y
(

1112 'v›ws_hªdËr_f‹r_num”ic' => 
	`¬¿y
(

1115 'v›ws_hªdËr_f‹r_æßt' => 
	`¬¿y
(

1118 'v›ws_hªdËr_f‹r_d©e' => 
	`¬¿y
(

1121 'v›ws_hªdËr_f‹r_mªy_to_Úe' => 
	`¬¿y
(

1126 'v›ws_hªdËr_»ÏtiÚsh' => 
	`¬¿y
(

1132 'v›ws_hªdËr_sÜt' => 
	`¬¿y
(

1135 'v›ws_hªdËr_sÜt_fÜmuÏ' => 
	`¬¿y
(

1138 'v›ws_hªdËr_sÜt_d©e' => 
	`¬¿y
(

1141 'v›ws_hªdËr_sÜt_m’u_h›¿rchy' => 
	`¬¿y
(

1144 'v›ws_hªdËr_sÜt_¿ndom' => 
	`¬¿y
(

1149 
	}
}

1205 şas 
	cv›ws_još
 {

1209 
funùiÚ
 
cÚ¡ruù
(
$bË
 = 
NULL
, 
$Ëá_bË
 = NULL, 
$Ëá_f›ld
 = NULL, 
$f›ld
 = NULL, 
$exŒa
 = 
¬¿y
(), 
$ty³
 = 'LEFT') {

1210 
$this
->
exŒa_ty³
 = 'AND';

1211 ià(!
em±y
(
$bË
)) {

1212 
	m$this
->
	mbË
 = 
$bË
;

1213 
	m$this
->
	mËá_bË
 = 
$Ëá_bË
;

1214 
	m$this
->
	mËá_f›ld
 = 
$Ëá_f›ld
;

1215 
	m$this
->
	mf›ld
 = 
$f›ld
;

1216 
	m$this
->
	mexŒa
 = 
$exŒa
;

1217 
	m$this
->
	mty³
 = 
¡¹ouµ”
(
$ty³
);

1219 ià(!
em±y
(
$this
->
defš™iÚ
)) {

1222 
	m$this
->
	mbË
 = 
$this
->
defš™iÚ
['table'];

1223 
	m$this
->
	mËá_bË
 = 
$this
->
defš™iÚ
['left_table'];

1224 
	m$this
->
	mËá_f›ld
 = 
$this
->
defš™iÚ
['left_field'];

1225 
	m$this
->
	mf›ld
 = 
$this
->
defš™iÚ
['field'];

1226 ià(!
em±y
(
$this
->
defš™iÚ
['extra'])) {

1227 
	m$this
->
	mexŒa
 = 
$this
->
defš™iÚ
['extra'];

1229 ià(!
em±y
(
$this
->
defš™iÚ
['extraype'])) {

1230 
	m$this
->
	mexŒa_ty³
 = 
¡¹ouµ”
(
$this
->
defš™iÚ
['extraype']);

1233 
	m$this
->
	mty³
 = !
em±y
(
$this
->
defš™iÚ
['ty³']è? 
¡¹ouµ”
($this->definition['type']) : 'LEFT';

1240 
funùiÚ
 
	$još
(
$bË
, &
$qu”y
) {

1241 ià(
	`em±y
(
$this
->
defš™iÚ
['table formula'])) {

1242 
$right_bË
 = "{" . 
$this
->
bË
 . "}";

1245 
$right_bË
 = 
$this
->
defš™iÚ
['table formula'];

1248 ià(
$this
->
Ëá_bË
) {

1249 
$Ëá
 = 
$qu”y
->
	`g‘_bË_šfo
(
$this
->
Ëá_bË
);

1250 
$Ëá_f›ld
 = "$left[alias].$this->left_field";

1254 
$Ëá_f›ld
 = 
$this
->
Ëá_f›ld
;

1257 
$ouut
 = " $this->type JOIN $right_table $table[alias] ON $left_field = $table[alias].$this->field";

1259 ià(
	`is£t
(
$this
->
exŒa
)) {

1260 ià(
	`is_¬¿y
(
$this
->
exŒa
)) {

1261 
$exŒas
 = 
	`¬¿y
();

1262 
	`fÜ—ch
 (
$this
->
exŒa
 
as
 
$šfo
) {

1263 
$exŒa
 = '';

1266 
$još_bË
 = '';

1267 ià(!
	`¬¿y_key_exi¡s
('bË', 
$šfo
)) {

1268 
$još_bË
 = 
$bË
['alias'] . '.';

1270 
	`–£if
 (
	`is£t
(
$šfo
['table'])) {

1271 
$još_bË
 = 
$šfo
['table'] . '.';

1277 
$¿w_v®ue
 = 
$this
->
	`db_§ã
(
$šfo
['value']);

1278 
$q
 = (
	`em±y
(
$šfo
['numeric']) ? "'" : '');

1280 ià(
	`is_¬¿y
(
$¿w_v®ue
)) {

1281 
$İ”©Ü
 = !
	`em±y
(
$šfo
['operator']) ? $info['operator'] : 'IN';

1283 ià(
	`couÁ
(
$¿w_v®ue
) == 1) {

1284 
$v®ue
 = 
$q
 . 
	`¬¿y_shiá
(
$¿w_v®ue
) . $q;

1285 
$İ”©Ü
 = $operator == 'NOT IN' ? '!=' : '=';

1288 
$v®ue
 = "($q" . 
	`im¶ode
("$q, $q", 
$¿w_v®ue
) . "$q)";

1292 
$İ”©Ü
 = !
	`em±y
(
$šfo
['operator']) ? $info['operator'] : '=';

1293 
$v®ue
 = "$q$raw_value$q";

1295 
$exŒas
[] = "$join_table$info[field] $operator $value";

1298 ià(
$exŒas
) {

1299 ià(
	`couÁ
(
$exŒas
) == 1) {

1300 
$ouut
 .ğ' AND ' . 
	`¬¿y_shiá
(
$exŒas
);

1303 
$ouut
 .ğ' AND (' . 
	`im¶ode
(' ' . 
$this
->
exŒa_ty³
 . ' ', 
$exŒas
) . ')';

1307 ià(
$this
->
exŒa
 && 
	`is_¡ršg
($this->extra)) {

1308 
$ouut
 .= " AND ($this->extra)";

1311  
$ouut
;

1312 
	}
}

1319 
funùiÚ
 
	$db_§ã
(
$šput
) {

1320 ià(
	`is_¬¿y
(
$šput
)) {

1321 
$ouut
 = 
	`¬¿y
();

1322 
	`fÜ—ch
 (
$šput
 
as
 
$v®ue
) {

1323 ià(
	`em±y
(
$šfo
['numeric'])) {

1324 
$ouut
[] = 
	`db_esÿ³_¡ršg
(
$v®ue
);

1327 
$ouut
[] = 
	`štv®
(
$v®ue
);

1331 ià(
	`em±y
(
$šfo
['numeric'])) {

1332 
$ouut
 = 
	`db_esÿ³_¡ršg
(
$šput
);

1335 
$ouut
 = 
	`štv®
(
$šput
);

1338  
$ouut
;

1339 
	}
}

1353 
funùiÚ
 
	$v›ws_v›ws_­i
() {

1354  
	`¬¿y
(

1356 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules',

1358 
	}
}

1360 
funùiÚ
 
	$agg»g©Ü_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1362 
funùiÚ
 
	$book_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1364 
funùiÚ
 
	$comm’t_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1366 
funùiÚ
 
	$loÿË_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1368 
funùiÚ
 
	$f‹r_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1370 
funùiÚ
 
	$node_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1372 
funùiÚ
 
	$pŞl_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1374 
funùiÚ
 
	$´ofe_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1376 
funùiÚ
 
	$£¬ch_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1378 
funùiÚ
 
	$¡©i¡ics_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1380 
funùiÚ
 
	$sy¡em_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1382 
funùiÚ
 
	$xÚomy_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1384 
funùiÚ
 
	$Œª¦©iÚ_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1386 
funùiÚ
 
	$u¶ßd_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1388 
funùiÚ
 
	$u£r_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

1390 
funùiÚ
 
	$cÚù_v›ws_­i
(è{  
	`v›ws_v›ws_­i
(); 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/plugins.inc

1 <?
php


12 
funùiÚ
 
	$v›ws_v›ws_¶ugšs
() {

13 
$·th
 = 
	`dru·l_g‘_·th
('module', 'views') . '/js';

15 
$¶ugšs
 = 
	`¬¿y
(

17 'di¥Ïy' => 
	`¬¿y
(

18 '·»Á' => 
	`¬¿y
(

21 'nØui' => 
TRUE
,

25 'deçuÉ' => 
	`¬¿y
(

26 't™Ë' => 
	`t
('Defaults'),

27 'h–p' => 
	`t
('Default settings forhis view.'),

30 'nØui' => 
TRUE
,

31 'nØ»move' => 
TRUE
,

32 'js' => 
	`¬¿y
('misc/collapse.js', 'misc/textarea.js', 'misc/tabledrag.js', 'misc/autocomplete.js', "$path/dependent.js"),

33 'u£‡jax' => 
TRUE
,

34 'u£…ag”' => 
TRUE
,

35 'u£ mÜe' => 
TRUE
,

36 'acû±‡‰achm’ts' => 
TRUE
,

39 '·ge' => 
	`¬¿y
(

40 't™Ë' => 
	`t
('Page'),

41 'h–p' => 
	`t
('Displayhe view‡s‡…age, with‡ URL‡nd menu†inks.'),

44 'u£ hook m’u' => 
TRUE
,

45 'u£‡jax' => 
TRUE
,

46 'u£…ag”' => 
TRUE
,

47 'acû±‡‰achm’ts' => 
TRUE
,

48 'admš' => 
	`t
('Page'),

51 'block' => 
	`¬¿y
(

52 't™Ë' => 
	`t
('Block'),

53 'h–p' => 
	`t
('Displayhe view‡s‡ block.'),

56 'u£ hook block' => 
TRUE
,

57 'u£‡jax' => 
TRUE
,

58 'u£…ag”' => 
TRUE
,

59 'u£ mÜe' => 
TRUE
,

60 'acû±‡‰achm’ts' => 
TRUE
,

61 'admš' => 
	`t
('Block'),

64 '©chm’t' => 
	`¬¿y
(

65 't™Ë' => 
	`t
('Attachment'),

66 'h–p' => 
	`t
('Attachments‡ddedo other displayso‡chieve multiple views inhe same view.'),

69 'u£‡jax' => 
TRUE
,

72 'ãed' => 
	`¬¿y
(

73 't™Ë' => 
	`t
('Feed'),

74 'h–p' => 
	`t
('Displayhe view‡s‡ feed, such‡s‡n RSS feed.'),

77 'u£ hook m’u' => 
TRUE
,

78 'u£‡jax' => 
FALSE
,

79 'u£…ag”' => 
FALSE
,

80 'acû±‡‰achm’ts' => 
FALSE
,

81 'admš' => 
	`t
('Feed'),

85 '¡yË' => 
	`¬¿y
(

86 '·»Á' => 
	`¬¿y
(

89 'nØui' => 
TRUE
,

93 'deçuÉ' => 
	`¬¿y
(

94 't™Ë' => 
	`t
('Unformatted'),

95 'h–p' => 
	`t
('Displays„ows one‡fter‡nother.'),

98 'u£ row…lugš' => 
TRUE
,

99 'u£ groupšg' => 
TRUE
,

100 'u£ İtiÚs' => 
TRUE
,

104 'li¡' => 
	`¬¿y
(

105 't™Ë' => 
	`t
('HTML List'),

106 'h–p' => 
	`t
('Displays„ows‡s‡n HTML†ist.'),

109 'u£ row…lugš' => 
TRUE
,

110 'u£ İtiÚs' => 
TRUE
,

114 'grid' => 
	`¬¿y
(

115 't™Ë' => 
	`t
('Grid'),

116 'h–p' => 
	`t
('Displays„ows in‡ grid.'),

119 'u£ row…lugš' => 
TRUE
,

120 'u£ İtiÚs' => 
TRUE
,

124 'bË' => 
	`¬¿y
(

125 't™Ë' => 
	`t
('Table'),

126 'h–p' => 
	`t
('Displays„ows in‡able.'),

129 'u£ row…lugš' => 
FALSE
,

130 'u£ f›lds' => 
TRUE
,

131 'u£ İtiÚs' => 
TRUE
,

135 'deçuÉ_summ¬y' => 
	`¬¿y
(

136 't™Ë' => 
	`t
('List'),

137 'h–p' => 
	`t
('Displayshe default summary‡s‡†ist.'),

141 'u£ İtiÚs' => 
TRUE
,

144 'unfÜm©‹d_summ¬y' => 
	`¬¿y
(

145 't™Ë' => 
	`t
('Unformatted'),

146 'h–p' => 
	`t
('Displayshe summary unformatted, with option for one‡fter‡nother or inline.'),

151 'u£ İtiÚs' => 
TRUE
,

154 'rss' => 
	`¬¿y
(

155 't™Ë' => 
	`t
('RSS Feed'),

156 'h–p' => 
	`t
('Generates‡n RSS feed from‡ view.'),

159 'u£ row…lugš' => 
TRUE
,

160 'u£ İtiÚs' => 
TRUE
,

165 'row' => 
	`¬¿y
(

166 '·»Á' => 
	`¬¿y
(

169 'nØui' => 
TRUE
,

173 'f›lds' => 
	`¬¿y
(

174 't™Ë' => 
	`t
('Fields'),

175 'h–p' => 
	`t
('Displayshe fields with‡n optionalemplate.'),

178 'u£ f›lds' => 
TRUE
,

179 'u£ İtiÚs' => 
TRUE
,

184 '¬gum’ˆdeçuÉ' => 
	`¬¿y
(

187 'fixed' => 
	`¬¿y
(

188 't™Ë' => 
	`t
('Fixedƒntry'),

191 'php' => 
	`¬¿y
(

192 't™Ë' => 
	`t
('PHP Code'),

197 '¬gum’ˆv®id©Ü' => 
	`¬¿y
(

198 '·»Á' => 
	`¬¿y
(

199 'nØui' => 
TRUE
,

203 'php' => 
	`¬¿y
(

204 't™Ë' => 
	`t
('PHP Code'),

207 'num”ic' => 
	`¬¿y
(

208 't™Ë' => 
	`t
('Numeric'),

212 'acûss' => 
	`¬¿y
(

213 '·»Á' => 
	`¬¿y
(

214 'nØui' => 
TRUE
,

218 'nÚe' => 
	`¬¿y
(

219 't™Ë' => 
	`t
('None'),

220 'h–p' => 
	`t
('Will be‡vailableo‡ll users.'),

224 'rŞe' => 
	`¬¿y
(

225 't™Ë' => 
	`t
('Role'),

226 'h–p' => 
	`t
('Access will be grantedo users with‡ny ofhe specified„oles.'),

228 'u£ İtiÚs' => 
TRUE
,

231 '³rm' => 
	`¬¿y
(

232 't™Ë' => 
	`t
('Permission'),

233 'h–p' => 
	`t
('Access will be grantedo users withhe specified…ermission string.'),

235 'u£ İtiÚs' => 
TRUE
,

239 'ÿche' => 
	`¬¿y
(

240 '·»Á' => 
	`¬¿y
(

241 'nØui' => 
TRUE
,

245 'nÚe' => 
	`¬¿y
(

246 't™Ë' => 
	`t
('None'),

247 'h–p' => 
	`t
('No caching of Views data.'),

251 'time' => 
	`¬¿y
(

252 't™Ë' => 
	`t
('Time-based'),

253 'h–p' => 
	`t
('Simpleime-based caching of data.'),

255 'u£ İtiÚs' => 
TRUE
,

261 ià(
	`moduË_švoke
('ctools', 'api_version', '1.3')) {

262 
$¶ugšs
['¡yË']['jump_m’u_summ¬y'] = 
	`¬¿y
(

263 't™Ë' => 
	`t
('Jump menu'),

264 'h–p' => 
	`t
('Puts‡ll ofhe„esults into‡ select box‡nd‡llowshe usero goo‡ different…age based uponhe„esults.'),

268 'u£ İtiÚs' => 
TRUE
,

271 
$¶ugšs
['¡yË']['jump_m’u'] = 
	`¬¿y
(

272 't™Ë' => 
	`t
('Jump menu'),

273 'h–p' => 
	`t
('Puts‡ll ofhe„esults into‡ select box‡nd‡llowshe usero goo‡ different…age based uponhe„esults.'),

276 'u£ row…lugš' => 
TRUE
,

277 'u£ f›lds' => 
TRUE
,

278 'u£ İtiÚs' => 
TRUE
,

284  
$¶ugšs
;

285 
	}
}

292 
funùiÚ
 
	$v›ws_discov”_¶ugšs
() {

293 
$ÿche
 = 
	`¬¿y
('display' =>‡rray(), 'style' =>‡rray(), 'row' =>‡rray(), 'argument default' =>‡rray(), 'argument validator' =>‡rray(), 'access' =>‡rray(), 'cache' =>‡rray());

295 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_¶ugšs'è
as
 
$moduË
) {

296 
$funùiÚ
 = 
$moduË
 . '_views_plugins';

297 
$»suÉ
 = 
	`$funùiÚ
();

298 ià(!
	`is_¬¿y
(
$»suÉ
)) {

302 
$moduË_dœ
 = 
	`is£t
(
$»suÉ
['moduË']è? $»suÉ['moduË'] : 
$moduË
;

304 ià(
$moduË_dœ
 == 'views') {

305 
$theme_·th
 = 
	`dru·l_g‘_·th
('moduË', 
$moduË_dœ
) . '/theme';

306 
$theme_fe
 = 'theme.inc';

307 
$·th
 = 
	`dru·l_g‘_·th
('moduË', 
$moduË_dœ
) . '/plugins';

310 
$theme_·th
 = 
$·th
 = 
	`dru·l_g‘_·th
('moduË', 
$moduË_dœ
);

311 
$theme_fe
 = "$module.views.inc";

314 
	`fÜ—ch
 (
$»suÉ
 
as
 
$ty³
 => 
$šfo
) {

315 ià(
$ty³
 == 'module') {

318 
	`fÜ—ch
 (
$šfo
 
as
 
$¶ugš
 => 
$def
) {

319 
$def
['moduË'] = 
$moduË_dœ
;

320 ià(!
	`is£t
(
$def
['theme…ath'])) {

321 
$def
['them·th'] = 
$theme_·th
;

323 ià(!
	`is£t
(
$def
['theme file'])) {

324 
$def
['themfe'] = 
$theme_fe
;

326 ià(!
	`is£t
(
$def
['path'])) {

327 
$def
['·th'] = 
$·th
;

329 ià(!
	`is£t
(
$def
['file'])) {

330 
$def
['file'] = $def['handler'] . '.inc';

332 ià(!
	`is£t
(
$def
['parent'])) {

333 
$def
['parent'] = 'parent';

336 
$ÿche
[
$ty³
][
$¶ugš
] = 
$def
;

342 
	`dru·l_®‹r
('v›ws_¶ugšs', 
$ÿche
);

343  
$ÿche
;

344 
	}
}

349 şas 
	cv›ws_¶ugš
 
ex‹nds
 
	mv›ws_objeù
 {

354 
funùiÚ
 
	$š™
(&
$v›w
, &
$di¥Ïy
) {

355 
$this
->
v›w
 = &
$v›w
;

356 
$this
->
di¥Ïy
 = &
$di¥Ïy
;

362 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

367 
funùiÚ
 
	$İtiÚs_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

372 
funùiÚ
 
	$İtiÚs_subm™
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

377 
funùiÚ
 
	$qu”y
(è{ 
	}
}

382 
funùiÚ
 
	$theme_funùiÚs
() {

383  
	`v›ws_theme_funùiÚs
(
$this
->
defš™iÚ
['theme'], $this->
v›w
, $this->
di¥Ïy
);

384 
	}
}

389 
funùiÚ
 
	$add™iÚ®_theme_funùiÚs
() {

390 
$funcs
 = 
	`¬¿y
();

391 ià(!
	`em±y
(
$this
->
defš™iÚ
['additionalhemes'])) {

392 
	`fÜ—ch
 (
$this
->
defš™iÚ
['add™iÚ®hemes'] 
as
 
$theme
 => 
$ty³
) {

393 
$funcs
[] = 
	`v›ws_theme_funùiÚs
(
$theme
, 
$this
->
v›w
, $this->
di¥Ïy
);

396  
$funcs
;

397 
	}
}

406 
funùiÚ
 
	$v®id©e
(è{  
	`¬¿y
(); 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/query.inc

1 <?
php


11 şas 
	cv›ws_qu”y
 {

16 
v¬
 
	m$bË_queue
 = 
¬¿y
();

21 
v¬
 
	m$bËs
 = 
¬¿y
();

27 
v¬
 
	m$»ÏtiÚshs
 = 
¬¿y
();

34 
v¬
 
	m$wh”e
 = 
¬¿y
();

40 
v¬
 
	m$havšg
 = 
¬¿y
();

45 
v¬
 
	m$group_İ”©Ü
 = 'AND';

50 
v¬
 
	m$Üd”by
 = 
¬¿y
();

55 
v¬
 
	m$groupby
 = 
¬¿y
();

61 
v¬
 
	m$h—d”
 = 
¬¿y
();

66 
v¬
 
	m$di¡šù
 = 
FALSE
;

71 
funùiÚ
 
v›ws_qu”y
(
$ba£_bË
 = 'node', 
$ba£_f›ld
 = 'nid') {

72 
$this
->
ba£_bË
 = 
$ba£_bË
;

73 
	m$this
->
	mba£_f›ld
 = 
$ba£_f›ld
;

74 
	m$this
->
	m»ÏtiÚshs
[
$ba£_bË
] = 
¬¿y
(

75 'lšk' => 
NULL
,

76 'bË' => 
$ba£_bË
,

77 '®Ÿs' => 
$ba£_bË
,

78 'ba£' => 
$ba£_bË


82 
	m$this
->
	mbË_queue
[
$ba£_bË
] = 
¬¿y
(

83 '®Ÿs' => 
$ba£_bË
,

84 'bË' => 
$ba£_bË
,

85 '»ÏtiÚsh' => 
$ba£_bË
,

86 'još' => 
NULL
,

90 
	m$this
->
	mbËs
[
$ba£_bË
][$ba£_bË] = 
¬¿y
(

92 '®Ÿs' => 
$ba£_bË
,

95 ià(
	m$ba£_f›ld
) {

96 
	m$this
->
	mf›lds
[
$ba£_f›ld
] = 
¬¿y
(

97 'bË' => 
$ba£_bË
,

98 'f›ld' => 
$ba£_f›ld
,

99 '®Ÿs' => 
$ba£_f›ld
,

103 
	m$this
->
	mcouÁ_f›ld
 = 
¬¿y
(

104 'bË' => 
$ba£_bË
,

105 'f›ld' => 
$ba£_f›ld
,

106 '®Ÿs' => 
$ba£_f›ld
,

107 'couÁ' => 
TRUE
,

117 
funùiÚ
 
	$£t_di¡šù
(
$v®ue
 = 
TRUE
) {

118 ià(!(
	`is£t
(
$this
->
no_di¡šù
è&& 
$v®ue
)) {

119 
$this
->
di¡šù
 = 
$v®ue
;

121 
	}
}

126 
funùiÚ
 
	$£t_couÁ_f›ld
(
$bË
, 
$f›ld
, 
$®Ÿs
 = 
NULL
) {

127 ià(
	`em±y
(
$®Ÿs
)) {

128 
$®Ÿs
 = 
$bË
 . '_' . 
$f›ld
;

130 
$this
->
couÁ_f›ld
 = 
	`¬¿y
(

131 'bË' => 
$bË
,

132 'f›ld' => 
$f›ld
,

133 '®Ÿs' => 
$®Ÿs
,

134 'couÁ' => 
TRUE
,

136 
	}
}

142 
funùiÚ
 
	$£t_h—d”
(
$h—d”
) {

143 
$this
->
h—d”
 = 
$h—d”
;

144 
	}
}

177 
funùiÚ
 
	$add_»ÏtiÚsh
(
$®Ÿs
, 
$još
, 
$ba£
, 
$lšk_pošt
 = 
NULL
) {

178 ià(
	`em±y
(
$lšk_pošt
)) {

179 
$lšk_pošt
 = 
$this
->
ba£_bË
;

181 ià(!
	`¬¿y_key_exi¡s
(
$lšk_pošt
, 
$this
->
»ÏtiÚshs
)) {

182  
FALSE
;

186 
$®Ÿs_ba£
 = 
$®Ÿs
;

187 
$couÁ
 = 1;

188 !
	`em±y
(
$this
->
»ÏtiÚshs
[
$®Ÿs
])) {

189 
$®Ÿs
 = 
$®Ÿs_ba£
 . '_' . 
$couÁ
++;

193 ià(
$lšk_pošt
 && 
	`is£t
(
$this
->
»ÏtiÚshs
[$link_point])) {

194 
$još
 = 
$this
->
	`adju¡_još
($još, 
$lšk_pošt
);

199 
$this
->
bË_queue
[
$®Ÿs
] = 
	`¬¿y
(

200 'bË' => 
$još
->
bË
,

202 '®Ÿs' => 
$®Ÿs
,

203 'još' => 
$još
,

204 '»ÏtiÚsh' => 
$lšk_pošt
,

207 
$this
->
»ÏtiÚshs
[
$®Ÿs
] = 
	`¬¿y
(

208 'lšk' => 
$lšk_pošt
,

209 'bË' => 
$još
->
bË
,

210 'ba£' => 
$ba£
,

213 
$this
->
bËs
[$this->
ba£_bË
][
$®Ÿs
] = 
	`¬¿y
(

215 '®Ÿs' => 
$®Ÿs
,

218  
$®Ÿs
;

219 
	}
}

251 
funùiÚ
 
	$add_bË
(
$bË
, 
$»ÏtiÚsh
 = 
NULL
, 
$još
 = NULL, 
$®Ÿs
 = NULL) {

252 ià(!
$this
->
	`’su»_·th
(
$bË
, 
$»ÏtiÚsh
, 
$još
)) {

253  
FALSE
;

256 ià(!
$još
) {

257 
$još
 = 
$this
->
	`g‘_još_d©a
(
$bË
, $this->
»ÏtiÚshs
[
$»ÏtiÚsh
]['base']);

260 
$još
 = 
$this
->
	`adju¡_još
($još, 
$»ÏtiÚsh
);

262  
$this
->
	`queue_bË
(
$bË
, 
$»ÏtiÚsh
, 
$još
, 
$®Ÿs
);

263 
	}
}

292 
funùiÚ
 
	$queue_bË
(
$bË
, 
$»ÏtiÚsh
 = 
NULL
, 
$još
 = NULL, 
$®Ÿs
 = NULL) {

294 ià(
	`is£t
(
$this
->
bË_queue
[
$®Ÿs
])) {

295  
$®Ÿs
;

298 ià(
	`em±y
(
$»ÏtiÚsh
)) {

299 
$»ÏtiÚsh
 = 
$this
->
ba£_bË
;

302 ià(!
	`¬¿y_key_exi¡s
(
$»ÏtiÚsh
, 
$this
->
»ÏtiÚshs
)) {

303  
FALSE
;

306 ià(!
$®Ÿs
 && 
$još
 && 
$»ÏtiÚsh
 && !
	`em±y
($još->
adju¡ed
è&& 
$bË
 !ğ$još->
bË
) {

307 ià(
$»ÏtiÚsh
 =ğ
$this
->
ba£_bË
) {

308 
$®Ÿs
 = 
$bË
;

311 
$®Ÿs
 = 
$»ÏtiÚsh
 . '_' . 
$bË
;

317 ià(
	`is£t
(
$this
->
bË_queue
[
$®Ÿs
])) {

318  
$®Ÿs
;

321 
$®Ÿs
 = 
$this
->
	`m¬k_bË
(
$bË
, 
$»ÏtiÚsh
, $alias);

324 ià(!
	`is£t
(
$®Ÿs
)) {

325 
$®Ÿs
 = 
$this
->
bËs
[
$»ÏtiÚsh
][
$bË
]['alias'] . $this->tables[$relationship][$table]['count'];

330 ià(
$bË
 !ğ
$®Ÿs
) {

331 
$this
->
	`m¬k_bË
(
$®Ÿs
, $this->
ba£_bË
, $alias);

335 ià(!
	`is£t
(
$još
)) {

336 
$još
 = 
$this
->
	`g‘_još_d©a
(
$bË
, $this->
»ÏtiÚshs
[
$»ÏtiÚsh
]['base']);

337 ià(
	`em±y
(
$još
)) {

338  
FALSE
;

341 
$još
 = 
$this
->
	`adju¡_još
($još, 
$»ÏtiÚsh
);

344 
$this
->
bË_queue
[
$®Ÿs
] = 
	`¬¿y
(

345 'bË' => 
$bË
,

346 'num' => 
$this
->
bËs
[
$»ÏtiÚsh
][
$bË
]['count'],

347 '®Ÿs' => 
$®Ÿs
,

348 'još' => 
$još
,

349 '»ÏtiÚsh' => 
$»ÏtiÚsh
,

352  
$®Ÿs
;

353 
	}
}

355 
funùiÚ
 
	$m¬k_bË
(
$bË
, 
$»ÏtiÚsh
, 
$®Ÿs
) {

357 ià(
	`em±y
(
$this
->
bËs
[
$»ÏtiÚsh
][
$bË
])) {

358 ià(!
	`is£t
(
$®Ÿs
)) {

359 
$®Ÿs
 = '';

360 ià(
$»ÏtiÚsh
 !ğ
$this
->
ba£_bË
) {

363 
$®Ÿs
 = 
$»ÏtiÚsh
 . '__';

365 
$®Ÿs
 .ğ
$bË
;

367 
$this
->
bËs
[
$»ÏtiÚsh
][
$bË
] = 
	`¬¿y
(

369 '®Ÿs' => 
$®Ÿs
,

373 
$this
->
bËs
[
$»ÏtiÚsh
][
$bË
]['count']++;

376  
$®Ÿs
;

377 
	}
}

397 
funùiÚ
 
	$’su»_bË
(
$bË
, 
$»ÏtiÚsh
 = 
NULL
, 
$još
 = NULL) {

399 ià(
	`em±y
(
$»ÏtiÚsh
)) {

400 
$»ÏtiÚsh
 = 
$this
->
ba£_bË
;

407 ià(
$»ÏtiÚsh
 =ğ
$this
->
ba£_bË
 && !
	`em±y
($this->
bËs
[$»ÏtiÚsh][
$bË
])) {

408  
$this
->
bËs
[
$»ÏtiÚsh
][
$bË
]['alias'];

411 ià(!
	`¬¿y_key_exi¡s
(
$»ÏtiÚsh
, 
$this
->
»ÏtiÚshs
)) {

412  
FALSE
;

415 ià(
$bË
 =ğ
$this
->
»ÏtiÚshs
[
$»ÏtiÚsh
]['base']) {

416  
$»ÏtiÚsh
;

420 ià(!
	`is£t
(
$još
)) {

421 
$još
 = 
$this
->
	`g‘_još_d©a
(
$bË
, $this->
»ÏtiÚshs
[
$»ÏtiÚsh
]['base']);

425 ià(
	`em±y
(
$još
)) {

432 
$još
 = 
$this
->
	`adju¡_još
($još, 
$»ÏtiÚsh
);

434 ià(
$this
->
	`’su»_·th
(
$bË
, 
$»ÏtiÚsh
, 
$još
)) {

456 
	`fÜ—ch
 (
$this
->
bË_queue
 
as
 
$queued_bË
) {

460 ià(
$queued_bË
['»ÏtiÚsh'] =ğ
$»ÏtiÚsh
 && $queued_bË['još'] =ğ
$još
) {

461  
$queued_bË
['alias'];

465  
$this
->
	`queue_bË
(
$bË
, 
$»ÏtiÚsh
, 
$još
);

467 
	}
}

476 
funùiÚ
 
’su»_·th
(
$bË
, 
$»ÏtiÚsh
 = 
NULL
, 
$još
 = NULL, 
$Œaûd
 = 
¬¿y
(), 
$add
 = 
	$¬¿y
()) {

477 ià(!
	`is£t
(
$»ÏtiÚsh
)) {

478 
$»ÏtiÚsh
 = 
$this
->
ba£_bË
;

481 ià(!
	`¬¿y_key_exi¡s
(
$»ÏtiÚsh
, 
$this
->
»ÏtiÚshs
)) {

482  
FALSE
;

486 ià(!
	`is£t
(
$još
)) {

487 
$još
 = 
$this
->
	`g‘_još_d©a
(
$bË
, $this->
»ÏtiÚshs
[
$»ÏtiÚsh
]['base']);

491 ià(
	`em±y
(
$još
)) {

492  
FALSE
;

496 ià(
	`is£t
(
$this
->
bËs
[
$»ÏtiÚsh
][
$bË
]) ||

497 (
$još
 && $još->
Ëá_bË
 =ğ
$»ÏtiÚsh
) ||

498 (
$još
 && $još->
Ëá_bË
 =ğ
$this
->
»ÏtiÚshs
[
$»ÏtiÚsh
]['table'])) {

501 
	`fÜ—ch
 (
	`¬¿y_»v”£
(
$add
è
as
 
$bË
 => 
$·th_još
) {

502 
$this
->
	`queue_bË
(
$bË
, 
$»ÏtiÚsh
, $this->
	`adju¡_još
(
$·th_još
, $relationship));

504  
TRUE
;

508 ià(
	`is£t
(
$Œaûd
[
$još
->
Ëá_bË
])) {

510  
FALSE
;

514 
$Ëá_još
 = 
$this
->
	`g‘_još_d©a
(
$još
->
Ëá_bË
, $this->
»ÏtiÚshs
[
$»ÏtiÚsh
]['base']);

515 ià(!
	`is£t
(
$this
->
bËs
[
$»ÏtiÚsh
][
$još
->
Ëá_bË
])) {

516 
$add
[
$još
->
Ëá_bË
] = 
$Ëá_još
;

520 
$Œaûd
[
$još
->
Ëá_bË
] = 
TRUE
;

521  
$this
->
	`’su»_·th
(
$još
->
Ëá_bË
, 
$»ÏtiÚsh
, 
$Ëá_još
, 
$Œaûd
, 
$add
);

522 
	}
}

528 
funùiÚ
 
	$adju¡_još
(
$još
, 
$»ÏtiÚsh
) {

529 ià(!
	`em±y
(
$još
->
adju¡ed
)) {

530  
$još
;

533 ià(
	`em±y
(
$»ÏtiÚsh
è||ƒm±y(
$this
->
»ÏtiÚshs
[$relationship])) {

534  
$još
;

538 ià(
$»ÏtiÚsh
 !ğ
$this
->
ba£_bË
) {

543 
$još
 = 
	`dru·l_şÚe
($join);

546 ià(
$još
->
Ëá_bË
 !ğ
$this
->
»ÏtiÚshs
[
$»ÏtiÚsh
]['table'] &&

547 
$još
->
Ëá_bË
 !ğ
$this
->
»ÏtiÚshs
[
$»ÏtiÚsh
]['base'] &&

548 !
	`is£t
(
$this
->
bËs
[
$»ÏtiÚsh
][
$još
->
Ëá_bË
]['alias'])) {

549 
$this
->
	`’su»_bË
(
$još
->
Ëá_bË
, 
$»ÏtiÚsh
);

553 ià(
$još
->
Ëá_bË
 =ğ
$this
->
»ÏtiÚshs
[
$»ÏtiÚsh
]['table']) {

554 
$još
->
Ëá_bË
 = 
$»ÏtiÚsh
;

557 ià(
	`is£t
(
$this
->
bËs
[
$»ÏtiÚsh
][
$još
->
Ëá_bË
]['alias'])) {

558 
$još
->
Ëá_bË
 = 
$this
->
bËs
[
$»ÏtiÚsh
][$join->left_table]['alias'];

561 ià(
	`is£t
(
$this
->
bË_queue
[
$»ÏtiÚsh
]['alias'])) {

562 
$još
->
Ëá_bË
 = 
$this
->
bË_queue
[
$»ÏtiÚsh
]['alias'];

566 
$još
->
adju¡ed
 = 
TRUE
;

567  
$još
;

568 
	}
}

581 
funùiÚ
 
	$g‘_još_d©a
(
$bË
, 
$ba£_bË
) {

584 ià(!
	`em±y
(
$this
->
bË_queue
[
$bË
])) {

585 
$bË
 = 
$this
->
bË_queue
[$table]['table'];

587  
	`v›ws_g‘_bË_još
(
$bË
, 
$ba£_bË
);

589 
	}
}

597 
funùiÚ
 
	$g‘_bË_šfo
(
$bË
) {

598 ià(!
	`em±y
(
$this
->
bË_queue
[
$bË
])) {

599  
$this
->
bË_queue
[
$bË
];

603 ià(!
	`em±y
(
$this
->
bËs
[$this->
ba£_bË
][
$bË
])) {

604 
$®Ÿs
 = 
$this
->
bËs
[$this->
ba£_bË
][
$bË
]['alias'];

605 ià(!
	`em±y
(
$this
->
bË_queue
[
$®Ÿs
])) {

606  
$this
->
bË_queue
[
$®Ÿs
];

609 
	}
}

630 
funùiÚ
 
add_f›ld
(
$bË
, 
$f›ld
, 
$®Ÿs
 = '', 
$·¿ms
 = 
NULL
) {

632 ià(
$bË
 =ğ
$this
->
ba£_bË
 && 
$f›ld
 =ğ$this->
ba£_f›ld
 && 
em±y
(
$®Ÿs
)) {

633 
$®Ÿs
 = 
$this
->
ba£_f›ld
;

636 ià(
	g$bË
 && 
em±y
(
$this
->
bË_queue
[
$bË
])) {

637 
	g$this
->
’su»_bË
(
$bË
);

640 ià(!
	g$®Ÿs
 && 
	g$bË
) {

641 
	g$®Ÿs
 = 
$bË
 . '_' . 
$f›ld
;

644 
	g$Çme
 = 
$®Ÿs
 ? $®Ÿ : 
$f›ld
;

647 ià(
em±y
(
$this
->
f›lds
[
$®Ÿs
])) {

648 
	g$this
->
	gf›lds
[
$Çme
] = 
¬¿y
(

649 'f›ld' => 
$f›ld
,

650 'bË' => 
$bË
,

651 '®Ÿs' => 
$®Ÿs
,

655 
fÜ—ch
 ((
¬¿y
)
$·¿ms
 
as
 
$key
 => 
$v®ue
) {

656 
$this
->
f›lds
[
$Çme
][
$key
] = 
$v®ue
;

659  
	g$Çme
;

666 
funùiÚ
 
	$ş—r_f›lds
() {

667 
$this
->
f›lds
 = 
	`¬¿y
();

668 
	}
}

684 
funùiÚ
 
£t_wh”e_group
(
$ty³
 = 'AND', 
$group
 = 
NULL
, 
$wh”e
 = 'where') {

686 
$groups
 = &
$this
->
$wh”e
;

688 ià(!
is£t
(
$group
)) {

689 
	g$group
 = 
em±y
(
$groups
è? 1 : 
max
(
¬¿y_keys
($groups)) + 1;

693 ià(
em±y
(
$groups
[
$group
])) {

694 
	g$groups
[
$group
] = 
¬¿y
('clauses' =>‡rray(), 'args' =>‡rray());

697 
	g$groups
[
$group
]['ty³'] = 
¡¹ouµ”
(
$ty³
);

698  
	g$group
;

707 
funùiÚ
 
£t_group_İ”©Ü
(
$ty³
 = 'AND') {

708 
$this
->
group_İ”©Ü
 = 
¡¹ouµ”
(
$ty³
);

729 
funùiÚ
 
	$add_wh”e
(
$group
, 
$şau£
) {

730 
$¬gs
 = 
	`func_g‘_¬gs
();

731 
	`¬¿y_shiá
(
$¬gs
);

732 
	`¬¿y_shiá
(
$¬gs
);

735 ià(
	`couÁ
(
$¬gs
è=ğ1 && 
	`is_¬¿y
(
	`»£t
($args))) {

736 
$¬gs
 = 
	`cu¼’t
($args);

741 ià(
	`em±y
(
$group
)) {

742 
$group
 = 0;

746 ià(!
	`is£t
(
$this
->
wh”e
[
$group
])) {

747 
$this
->
	`£t_wh”e_group
('AND', 
$group
);

751 ià(
	`is_¬¿y
(
$¬gs
)) {

752 
$this
->
wh”e
[
$group
]['şau£s'][] = 
$şau£
;

755 
$this
->
wh”e
[
$group
]['¬gs'] = 
	`¬¿y_m”ge
($this->wh”e[$group]['¬gs'], 
	`¬¿y_v®ues
(
$¬gs
));

757 
	}
}

777 
funùiÚ
 
	$add_havšg
(
$group
, 
$şau£
) {

778 
$¬gs
 = 
	`func_g‘_¬gs
();

779 
	`¬¿y_shiá
(
$¬gs
);

780 
	`¬¿y_shiá
(
$¬gs
);

783 ià(
	`couÁ
(
$¬gs
è=ğ1 && 
	`is_¬¿y
(
	`»£t
($args))) {

784 
$¬gs
 = 
	`cu¼’t
($args);

789 ià(
	`em±y
(
$group
)) {

790 
$group
 = 0;

794 ià(!
	`is£t
(
$this
->
havšg
[
$group
])) {

795 
$this
->
	`£t_wh”e_group
('AND', 
$group
, 'having');

799 ià(
	`is_¬¿y
(
$¬gs
)) {

800 
$this
->
havšg
[
$group
]['şau£s'][] = 
$şau£
;

801 
$this
->
havšg
[
$group
]['¬gs'] = 
	`¬¿y_m”ge
($this->havšg[$group]['¬gs'], 
	`¬¿y_v®ues
(
$¬gs
));

803 
	}
}

821 
funùiÚ
 
add_Üd”by
(
$bË
, 
$f›ld
, 
$Üd”
, 
$®Ÿs
 = '') {

822 ià(
$bË
) {

823 
$this
->
’su»_bË
(
$bË
);

828 ià(!
	g$®Ÿs
 && 
	g$bË
) {

829 
	g$as
 = 
$bË
 . '_' . 
$f›ld
;

832 
	g$as
 = 
$®Ÿs
;

835 ià(
	g$f›ld
) {

836 
	g$this
->
add_f›ld
(
$bË
, 
$f›ld
, 
$as
);

839 
	g$this
->
	gÜd”by
[] = "$a " . 
¡¹ouµ”
(
$Üd”
);

844 ià(
	g$this
->
	ggroupby
 && 
	g$bË
) {

845 
	g$this
->
add_groupby
(
$as
);

854 
funùiÚ
 
	$add_groupby
(
$şau£
) {

856 ià(!
	`š_¬¿y
(
$şau£
, 
$this
->
groupby
)) {

857 
$this
->
groupby
[] = 
$şau£
;

859 
	}
}

867 
funùiÚ
 
cÚd™iÚ_sql
(
$wh”e
 = 'where') {

868 
$şau£s
 = 
¬¿y
();

869 
fÜ—ch
 (
$this
->
$wh”e
 
as
 
$group
 => 
$šfo
) {

870 
$şau£
 = 
im¶ode
("è" . 
$šfo
['type'] . " (", $info['clauses']);

871 ià(
couÁ
(
$šfo
['clauses']) > 1) {

872 
	g$şau£
 = '(' . 
$şau£
 . ')';

874 
	g$şau£s
[] = 
$şau£
;

877 ià(
	g$şau£s
) {

878 
	g$keywÜd
 = 
dru·l_¡¹ouµ”
(
$wh”e
);

879 ià(
couÁ
(
$şau£s
) > 1) {

880  "$keywÜd (" . 
im¶ode
(")\À " . 
$this
->
group_İ”©Ü
 . ' (', 
$şau£s
) . ")\n";

883  "$keywÜd " . 
¬¿y_shiá
(
$şau£s
) . "\n";

896 
funùiÚ
 
	$qu”y
(
$g‘_couÁ
 = 
FALSE
) {

898 ià(
	`em±y
(
$this
->
no_di¡šù
è&& $this->
di¡šù
 && !em±y($this->
f›lds
)) {

899 ià(!
	`em±y
(
$this
->
f›lds
[$this->
ba£_f›ld
])) {

900 
$this
->
f›lds
[$this->
ba£_f›ld
]['di¡šù'] = 
TRUE
;

901 
$this
->
	`add_groupby
($this->
ba£_f›ld
);

909 
$f›lds_¬¿y
 = 
$this
->
f›lds
;

910 ià(
$g‘_couÁ
 && !
$this
->
groupby
) {

911 
	`fÜ—ch
 (
$f›lds_¬¿y
 
as
 
$f›ld
) {

912 ià(!
	`em±y
(
$f›ld
['distinct'])) {

913 
$g‘_couÁ_İtimized
 = 
FALSE
;

919 
$g‘_couÁ_İtimized
 = 
FALSE
;

921 ià(!
	`is£t
(
$g‘_couÁ_İtimized
)) {

922 
$g‘_couÁ_İtimized
 = 
TRUE
;

925 
$jošs
 = 
$f›lds
 = 
$wh”e
 = 
$havšg
 = 
$Üd”by
 = 
$groupby
 = '';

927 
	`fÜ—ch
 (
$this
->
bË_queue
 
as
 
$bË
) {

928 ià(
	`is_objeù
(
$bË
['join'])) {

929 
$jošs
 .ğ
$bË
['još']->
	`još
($bË, 
$this
) . "\n";

933 
$has_agg»g©e
 = 
FALSE
;

934 
$nÚ_agg»g©es
 = 
	`¬¿y
();

936 
	`fÜ—ch
 (
$f›lds_¬¿y
 
as
 
$f›ld
) {

937 ià(
$f›lds
) {

938 
$f›lds
 .= ",\n ";

940 
$¡ršg
 = '';

941 ià(!
	`em±y
(
$f›ld
['table'])) {

942 
$¡ršg
 .ğ
$f›ld
['table'] . '.';

944 
$¡ršg
 .ğ
$f›ld
['field'];

947 
$f›ldÇme
 = (!
	`em±y
(
$f›ld
['®Ÿs']è? $f›ld['®Ÿs'] : 
$¡ršg
);

949 ià(!
	`em±y
(
$f›ld
['distinct'])) {

950 
$¡ršg
 = "DISTINCT($string)";

952 ià(!
	`em±y
(
$f›ld
['count'])) {

953 
$¡ršg
 = "COUNT($string)";

954 
$has_agg»g©e
 = 
TRUE
;

956 ià(!
	`em±y
(
$f›ld
['aggregate'])) {

957 
$has_agg»g©e
 = 
TRUE
;

959 
	`–£if
 (
$this
->
di¡šù
 && !
	`š_¬¿y
(
$f›ldÇme
, $this->
groupby
)) {

960 
$¡ršg
 = 
$GLOBALS
['db_type'] == 'pgsql' ? "FIRST($string)" : $string;

963 
$nÚ_agg»g©es
[] = 
$f›ldÇme
;

965 ià(
$f›ld
['alias']) {

966 
$¡ršg
 .= " AS $field[alias]";

968 
$f›lds
 .ğ
$¡ršg
;

970 ià(
$g‘_couÁ_İtimized
) {

976 ià(
$has_agg»g©e
 || 
$this
->
groupby
) {

977 
$groupby
 = "GROUP BY " . 
	`im¶ode
(', ', 
	`¬¿y_unique
(
	`¬¿y_m”ge
(
$this
->
groupby
, 
$nÚ_agg»g©es
))) . "\n";

978 ià(
$this
->
havšg
) {

979 
$havšg
 = 
$this
->
	`cÚd™iÚ_sql
('having');

983 ià(!
$g‘_couÁ_İtimized
) {

985 ià(
$this
->
Üd”by
) {

986 
$Üd”by
 = "ORDER BY " . 
	`im¶ode
(', ', 
$this
->
Üd”by
) . "\n";

990 
$wh”e
 = 
$this
->
	`cÚd™iÚ_sql
();

992 
$qu”y
 = "SELECT $f›lds\ÀFROM {" . 
$this
->
ba£_bË
 . "} $this->base_table \n$joins $where $groupby $having $orderby";

994 
$»¶aû
 = 
	`¬¿y
('&gt;' => '>', '&lt;' => '<');

995 
$qu”y
 = 
	`¡¹r
($qu”y, 
$»¶aû
);

997  
$qu”y
;

998 
	}
}

1003 
funùiÚ
 
	$g‘_wh”e_¬gs
() {

1004 
$¬gs
 = 
	`¬¿y
();

1005 
	`fÜ—ch
 (
$this
->
wh”e
 
as
 
$group
 => 
$wh”e
) {

1006 
$¬gs
 = 
	`¬¿y_m”ge
($¬gs, 
$wh”e
['args']);

1008 
	`fÜ—ch
 (
$this
->
havšg
 
as
 
$group
 => 
$havšg
) {

1009 
$¬gs
 = 
	`¬¿y_m”ge
($¬gs, 
$havšg
['args']);

1011  
$¬gs
;

1012 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/tabs.inc

1 <?
php


17 şas 
	cv›ws_b£t
 {

18 
v¬
 
	m$bs
 = 
¬¿y
();

19 
v¬
 
	m$exŒa
 = '';

20 
v¬
 
	m$£Ëùed
 = 
NULL
;

36 
funùiÚ
 
add
(
$Çme
, 
$t™Ë
 = '', 
$body
 = '') {

37 ià(
is_objeù
(
$Çme
è&& 
is_subşass_of
($name, 'views_tab')) {

38 
$this
->
add_b
(
$Çme
);

40 
–£if
 (
is_¬¿y
(
$Çme
)) {

41 
fÜ—ch
 (
$Çme
 
as
 
$»®_b
) {

42 
	m$this
->
add
(
$»®_b
);

46 
	m$this
->
add_b
(
Ãw
 
v›ws_b
(
$Çme
, 
$t™Ë
, 
$body
));

56 
funùiÚ
 
	$add_b
(
$b
) {

57 
$this
->
bs
[
$b
->
Çme
] = $tab;

58 
	}
}

70 
funùiÚ
 
	$£t
(
$Çme
, 
$t™Ë
, 
$body
 = 
NULL
) {

71 ià(
	`em±y
(
$this
->
bs
[
$Çme
])) {

72  
$this
->
	`add
(
$Çme
, 
$t™Ë
, 
$body
);

74 
$this
->
bs
[
$Çme
]->
t™Ë
 = 
$t™Ë
;

75 ià(
	`is£t
(
$body
)) {

76 
$this
->
bs
[
$Çme
]->
body
 = 
$body
;

78 
	}
}

83 
funùiÚ
 
	$£t_body
(
$Çme
, 
$body
) {

84 ià(
	`em±y
(
$this
->
bs
[
$Çme
])) {

85  
$this
->
	`add
(
$Çme
, '', 
$body
);

87 
$this
->
bs
[
$Çme
]->
body
 = 
$body
;

88 
	}
}

93 
funùiÚ
 
	$add_exŒa
(
$‹xt
) {

94 
$this
->
exŒa
 .ğ
$‹xt
;

95 
	}
}

103 
funùiÚ
 
	$»move
(
$b
) {

104 ià(
	`is_¡ršg
(
$b
)) {

105 
	`un£t
(
$this
->
bs
[
$b
]);

108 
	`un£t
(
$this
->
bs
[
$b
->
Çme
]);

110 
	}
}

115 
funùiÚ
 
	$£t_£Ëùed
(
$Çme
) {

116 
$this
->
£Ëùed
 = 
$Çme
;

117 
	}
}

125 
funùiÚ
 
	$»nd”
() {

126 
	`v›ws_add_js
('tabs');

127 
	`v›ws_add_css
('views-tabs');

129 ià(
	`em±y
(
$this
->
£Ëùed
)) {

130 
$keys
 = 
	`¬¿y_keys
(
$this
->
bs
);

131 
$this
->
£Ëùed
 = 
	`¬¿y_shiá
(
$keys
);

134 
	`dru·l_®‹r
('v›ws_b£t', 
$this
);

135  
	`theme
('v›ws_b£t', 
$this
->
bs
, $this->
exŒa
, $this->
£Ëùed
);

136 
	}
}

142 şas 
	cv›ws_b
 {

143 
v¬
 
	m$t™Ë
;

144 
v¬
 
	m$body
;

145 
v¬
 
	m$Çme
;

150 
funùiÚ
 
	$v›ws_b
(
$Çme
, 
$t™Ë
, 
$body
 = 
NULL
) {

151 
$this
->
Çme
 = 
$Çme
;

152 
$this
->
t™Ë
 = 
$t™Ë
;

153 
$this
->
body
 = 
$body
;

159 
funùiÚ
 
	$»nd”
() {

160  
	`theme
('v›ws_b', 
$this
->
body
);

161 
	}
}

169 
funùiÚ
 
	$theme_v›ws_b£t
(
$bs
, 
$exŒa
 = 
NULL
, 
$£Ëùed
 = NULL) {

170 
$lšk_ouut
 = "<div class=\"views-tabs\"><ul id=\"views-tabset\">\n";

171 
$b_ouut
 = "<div class=\"views-tab-area\">\n";

173 
	`fÜ—ch
 (
$bs
 
as
 
$Çme
 => 
$b
) {

174 
$lšk_ouut
 .ğ'<li' . (
$Çme
 =ğ
$£Ëùed
 ? ' cÏss="aùive"': ''è. '><¨h»f="#v›ws-b-' . 
$b
->
Çme
 . '" id="v›ws-b-t™Ë-' . $b->Çm. '">' . 
	`check_¶aš
($b->
t™Ë
) . '</a></li>' . "\n";

175 
$b_ouut
 .ğ'<div id="v›ws-b-' . 
$b
->
Çme
 . '" cÏss="v›ws-b">' . $b->
	`»nd”
() . "</div>\n";

177 
$lšk_ouut
 .= "</ul>\n";

179 ià(
$exŒa
) {

180 
$lšk_ouut
 .= "<div class=\"extra\">$extra</div>\n";

183 
$lšk_ouut
 .= "</div>\n";

184 
$b_ouut
 .= "</div>\n";

185  '<div cÏss="v›ws-b£ˆş—r-block">' . 
$lšk_ouut
 . 
$b_ouut
 . '</div>';

186 
	}
}

191 
funùiÚ
 
	$theme_v›ws_b
(
$body
) {

192  
$body
;

193 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/view.inc

1 <?
php


19 şas 
	cv›w
 
ex‹nds
 
	mv›ws_db_objeù
 {

20 
v¬
 
	m$db_bË
 = 'views_view';

21 
v¬
 
	m$ba£_bË
 = 'node';

24 
v¬
 
	m$but
 = 
FALSE
;

25 
v¬
 
	m$execu‹d
 = 
FALSE
;

27 
v¬
 
	m$¬gs
 = 
¬¿y
();

28 
v¬
 
	m$bud_šfo
 = 
¬¿y
();

30 
v¬
 
	m$u£_ajax
 = 
FALSE
;

33 
v¬
 
	m$»suÉ
 = 
¬¿y
();

36 
v¬
 
	m$·g”
 = 
¬¿y
(

37 'u£_·g”' => 
FALSE
,

45 
v¬
 
	m$©chm’t_befÜe
 = '';

46 
v¬
 
	m$©chm’t_aá”
 = '';

49 
v¬
 
	m$expo£d_d©a
 = 
¬¿y
();

50 
v¬
 
	m$expo£d_šput
 = 
¬¿y
();

53 
v¬
 
	m$Şd_v›w
 = 
¬¿y
();

57 
funùiÚ
 
	$v›w
() {

58 
·»Á
::
	`š™
();

60 
	`fÜ—ch
 (
$this
->
	`db_objeùs
(è
as
 
$objeù
) {

61 
$this
->
$objeù
 = 
	`¬¿y
();

64 
$this
->
qu”y
 = 
Ãw
 
	`¡dCÏss
();

71 
funùiÚ
 
	$di¥Ïy_objeùs
() {

72  
	`¬¿y
('argument', 'field', 'sort', 'filter', 'relationship');

73 
	}
}

82 
funùiÚ
 
	$db_objeùs
() {

83  
	`¬¿y
('display');

84 
	}
}

90 
funùiÚ
 
	$£t_¬gum’ts
(
$¬gs
) {

91 
$this
->
¬gs
 = 
$¬gs
;

92 
	}
}

97 
funùiÚ
 
	$£t_™ems_³r_·ge
(
$™ems_³r_·ge
) {

98 
$this
->
·g”
['™ems_³r_·ge'] = 
$™ems_³r_·ge
;

99 ià(
	`em±y
(
$™ems_³r_·ge
)) {

100 
$this
->
·g”
['u£_·g”'] = 
FALSE
;

102 
	}
}

107 
funùiÚ
 
	$£t_cu¼’t_·ge
(
$·ge
) {

108 
$this
->
·g”
['cu¼’t_·ge'] = 
$·ge
;

109 
	}
}

114 
funùiÚ
 
	$£t_u£_·g”
(
$u£_·g”
) {

115 
$this
->
·g”
['u£_·g”'] = 
$u£_·g”
;

116 
	}
}

121 
funùiÚ
 
	$£t_·g”_–em’t
(
$·g”_–em’t
) {

122 
$this
->
·g”
['–em’t'] = 
$·g”_–em’t
;

123 
	}
}

129 
funùiÚ
 
	$£t_off£t
(
$off£t
) {

130 
$this
->
·g”
['off£t'] = 
$off£t
;

131 
	}
}

138 
funùiÚ
 
	$£t_u£_ajax
(
$u£_ajax
) {

139 
$this
->
u£_ajax
 = 
$u£_ajax
;

140 
	}
}

146 
funùiÚ
 
	$£t_expo£d_šput
(
$f‹rs
) {

147 
$this
->
expo£d_šput
 = 
$f‹rs
;

148 
	}
}

153 
funùiÚ
 
	$g‘_expo£d_šput
() {

156 ià(
	`em±y
(
$this
->
expo£d_šput
)) {

157 
$this
->
expo£d_šput
 = 
$_GET
;

159 
	`fÜ—ch
 (
	`¬¿y
('·ge', 'q'è
as
 
$key
) {

160 ià(
	`is£t
(
$this
->
expo£d_šput
[
$key
])) {

161 
	`un£t
(
$this
->
expo£d_šput
[
$key
]);

171 
$di¥Ïy_id
 = (
$this
->
di¥Ïy_hªdËr
->
	`is_deçuÉed
('f‹rs')è? 'deçuÉ' : $this->
cu¼’t_di¥Ïy
;

173 ià(
	`em±y
(
$this
->
expo£d_šput
è&& !em±y(
$_SESSION
['v›ws'][$this->
Çme
][
$di¥Ïy_id
])) {

174 
$this
->
expo£d_šput
 = 
$_SESSION
['v›ws'][$this->
Çme
][
$di¥Ïy_id
];

178  
$this
->
expo£d_šput
;

179 
	}
}

184 
funùiÚ
 
	$š™_di¥Ïy
(
$»£t
 = 
FALSE
) {

186 ià(
	`is£t
(
$this
->
cu¼’t_di¥Ïy
)) {

187  
TRUE
;

191 
	`fÜ—ch
 (
	`¬¿y_keys
(
$this
->
di¥Ïy
è
as
 
$id
) {

198 ià(!
	`em±y
(
$this
->
di¥Ïy
[
$id
]->
hªdËr
)) {

199 
$this
->
di¥Ïy
[
$id
] = 
	`dru·l_şÚe
($this->display[$id]);

200 
	`un£t
(
$this
->
di¥Ïy
[
$id
]->
hªdËr
);

202 
$this
->
di¥Ïy
[
$id
]->
hªdËr
 = 
	`v›ws_g‘_¶ugš
('di¥Ïy', $this->di¥Ïy[$id]->
di¥Ïy_¶ugš
);

203 ià(!
	`em±y
(
$this
->
di¥Ïy
[
$id
]->
hªdËr
)) {

205 
$this
->
di¥Ïy
[
$id
]->
hªdËr
->
	`š™
($this, $this->display[$id]);

210 ià(
$id
 != 'default') {

211 
$this
->
di¥Ïy
[
$id
]->
hªdËr
->
deçuÉ_di¥Ïy
 = &$this->display['default']->handler;

216 
$this
->
cu¼’t_di¥Ïy
 = 'default';

217 
$this
->
di¥Ïy_hªdËr
 = &$this->
di¥Ïy
['deçuÉ']->
hªdËr
;

219  
TRUE
;

220 
	}
}

228 
funùiÚ
 
	$choo£_di¥Ïy
(
$di¥Ïys
) {

229 ià(!
	`is_¬¿y
(
$di¥Ïys
)) {

230  
$di¥Ïys
;

233 
$this
->
	`š™_di¥Ïy
();

235 
	`fÜ—ch
 (
$di¥Ïys
 
as
 
$di¥Ïy_id
) {

236 ià(
$this
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
->
	`acûss
()) {

237  
$di¥Ïy_id
;

242 
	}
}

250 
funùiÚ
 
	$£t_di¥Ïy
(
$di¥Ïy_id
 = 
NULL
) {

252 ià(
	`em±y
(
$this
->
cu¼’t_di¥Ïy
)) {

253 
$this
->
	`š™_di¥Ïy
();

257 ià(
	`em±y
(
$di¥Ïy_id
)) {

258 
$di¥Ïy_id
 = 'default';

262 
$di¥Ïy_id
 = 
$this
->
	`choo£_di¥Ïy
($display_id);

265 ià(
	`em±y
(
$di¥Ïy_id
)) {

266  
TRUE
;

270 ià(
	`em±y
(
$this
->
di¥Ïy
[
$di¥Ïy_id
])) {

271 
$di¥Ïy_id
 = 'default';

272 ià(
	`em±y
(
$this
->
di¥Ïy
[
$di¥Ïy_id
])) {

273 
	`v´
(
	`t
('£t_di¥Ïy(èÿÎed w™h inv®id di¥Ïy id @di¥Ïy.', 
	`¬¿y
('@di¥Ïy' => 
$di¥Ïy_id
)));

274  
FALSE
;

279 
$this
->
cu¼’t_di¥Ïy
 = 
$di¥Ïy_id
;

282 ià(
	`em±y
(
$this
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
)) {

283  
FALSE
;

287 
$this
->
di¥Ïy_hªdËr
 = &$this->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
;

289  
TRUE
;

290 
	}
}

298 
funùiÚ
 
	$š™_¡yË
() {

299 ià(
	`is£t
(
$this
->
¡yË_¶ugš
)) {

300  
	`is_objeù
(
$this
->
¡yË_¶ugš
);

303 ià(!
	`is£t
(
$this
->
¶ugš_Çme
)) {

304 
$this
->
¶ugš_Çme
 = $this->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('style_plugin');

305 
$this
->
¡yË_İtiÚs
 = $this->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('style_options');

308 
$this
->
¡yË_¶ugš
 = 
	`v›ws_g‘_¶ugš
('¡yË', $this->
¶ugš_Çme
);

310 ià(
	`em±y
(
$this
->
¡yË_¶ugš
)) {

311  
FALSE
;

315 
$this
->
¡yË_¶ugš
->
	`š™
($this, $this->
di¥Ïy
[$this->
cu¼’t_di¥Ïy
], $this->
¡yË_İtiÚs
);

316  
TRUE
;

317 
	}
}

322 
funùiÚ
 
	$š™_hªdËrs
() {

323 ià(
	`em±y
(
$this
->
š™ed
)) {

324 
	`fÜ—ch
 (
	`v›ws_objeù_ty³s
(è
as
 
$key
 => 
$šfo
) {

325 
$this
->
	`_š™_hªdËr
(
$key
, 
$šfo
);

327 
$this
->
š™ed
 = 
TRUE
;

329 
	}
}

335 
funùiÚ
 
	$g‘_ba£_bËs
() {

336 
$ba£_bËs
 = 
	`¬¿y
(

337 
$this
->
ba£_bË
 => 
TRUE
,

338 '#glob®' => 
TRUE
,

341 
	`fÜ—ch
 (
$this
->
di¥Ïy_hªdËr
->
	`g‘_hªdËrs
('»ÏtiÚsh'è
as
 
$hªdËr
) {

342 
$ba£_bËs
[
$hªdËr
->
defš™iÚ
['ba£']] = 
TRUE
;

344  
$ba£_bËs
;

345 
	}
}

350 
funùiÚ
 
	$_´e_qu”y
() {

351 
	`fÜ—ch
 (
	`v›ws_objeù_ty³s
(è
as
 
$key
 => 
$šfo
) {

352 
$hªdËrs
 = &
$this
->
$key
;

353 
$pos™iÚ
 = 0;

354 
	`fÜ—ch
 (
$hªdËrs
 
as
 
$id
 => 
$hªdËr
) {

355 
$hªdËrs
[
$id
]->
pos™iÚ
 = 
$pos™iÚ
;

356 
$hªdËrs
[
$id
]->
	`´e_qu”y
();

357 
$pos™iÚ
++;

360 
	}
}

370 
funùiÚ
 
	$_š™_hªdËr
(
$key
, 
$šfo
) {

372 
$this
->
$key
 = $this->
di¥Ïy_hªdËr
->
	`g‘_hªdËrs
($key);

375 
$hªdËrs
 = &
$this
->
$key
;

378 
	`fÜ—ch
 (
$hªdËrs
 
as
 
$id
 => 
$hªdËr
) {

379 ià(!
$hªdËr
->
	`acûss
()) {

380 
	`un£t
(
$hªdËrs
[
$id
]);

383 
	}
}

392 
funùiÚ
 
	$»nd”_expo£d_fÜm
(
$block
 = 
FALSE
) {

394 
$fÜm_¡©e
 = 
	`¬¿y
(

395 'v›w' => &
$this
,

396 'di¥Ïy' => &
$this
->
di¥Ïy_hªdËr
->
di¥Ïy
,

398 '»»nd”' => 
TRUE
,

399 'no_»dœeù' => 
TRUE
,

405 ià(!
$this
->
di¥Ïy_hªdËr
->
	`di¥Ïys_expo£d
(è|| (!
$block
 && $this->di¥Ïy_hªdËr->
	`g‘_İtiÚ
('exposed_block'))) {

406 
	`un£t
(
$fÜm_¡©e
['rerender']);

409 ià(!
	`em±y
(
$this
->
ajax
)) {

410 
$fÜm_¡©e
['ajax'] = 
TRUE
;

413 
$ouut
 = 
	`dru·l_bud_fÜm
('v›ws_expo£d_fÜm', 
$fÜm_¡©e
);

414 ià(!
	`em±y
(
$fÜm_¡©e
['js settings'])) {

415 
$this
->
js_£‰šgs
 = 
$fÜm_¡©e
['js settings'];

420 ià(
	`fÜm_g‘_”rÜs
(è&& 
	`em±y
(
$fÜm_¡©e
['rerender'])) {

421  
NULL
;

424  
$ouut
;

425 
	}
}

430 
funùiÚ
 
	$_bud_¬gum’ts
() {

433 ià(
	`em±y
(
$this
->
¬gum’t
)) {

434  
TRUE
;

438 
$pos™iÚ
 = -1;

441 
$t™Ë
 = 
$this
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('title');

443 
$this
->
bud_šfo
['b»adüumb'] = 
	`¬¿y
();

444 
$b»adüumb_¬gs
 = 
	`¬¿y
();

445 
$sub¡™utiÚs
 = 
	`¬¿y
();

447 
$¡©us
 = 
TRUE
;

450 
	`fÜ—ch
 (
$this
->
¬gum’t
 
as
 
$id
 => 
$¬g
) {

451 
$pos™iÚ
++;

452 
$¬gum’t
 = &
$this
->
¬gum’t
[
$id
];

454 ià(
$¬gum’t
->
	`brok’
()) {

458 
$¬gum’t
->
	`£t_»ÏtiÚsh
();

460 
$¬g
 = 
	`is£t
(
$this
->
¬gs
[
$pos™iÚ
]è? $this->¬gs[$pos™iÚ] : 
NULL
;

461 
$¬gum’t
->
pos™iÚ
 = 
$pos™iÚ
;

463 ià(
	`is£t
(
$¬g
è|| 
$¬gum’t
->
	`has_deçuÉ_¬gum’t
()) {

464 ià(!
	`is£t
(
$¬g
)) {

465 
$¬g
 = 
$¬gum’t
->
	`g‘_deçuÉ_¬gum’t
();

467 ià(
	`is£t
(
$¬g
)) {

468 
$this
->
¬gs
[
$pos™iÚ
] = 
$¬g
;

473 ià(!
$¬gum’t
->
	`£t_¬gum’t
(
$¬g
)) {

474 
$¡©us
 = 
$¬gum’t
->
	`v®id©e_ç
(
$¬g
);

478 ià(
$¬gum’t
->
	`is_wdÿrd
()) {

479 
$¬g_t™Ë
 = 
$¬gum’t
->
	`wdÿrd_t™Ë
();

482 
$¬g_t™Ë
 = 
$¬gum’t
->
	`g‘_t™Ë
();

483 
$¬gum’t
->
	`qu”y
();

487 
$sub¡™utiÚs
['%' . (
$pos™iÚ
 + 1)] = 
$¬g_t™Ë
;

491 ià(
$this
->
di¥Ïy_hªdËr
->
	`u£s_b»adüumb
(è&& 
$¬gum’t
->uses_breadcrumb()) {

492 
$·th
 = 
$this
->
	`g‘_u¾
(
$b»adüumb_¬gs
);

493 ià(
	`¡½os
(
$·th
, '%'è==ğ
FALSE
) {

494 
$b»adüumb
 = !
	`em±y
(
$¬gum’t
->
İtiÚs
['b»adüumb'])? $¬gum’t->İtiÚs['b»adüumb'] : 
$t™Ë
;

495 
$this
->
bud_šfo
['b»adüumb'][
$·th
] = 
	`¡r_»¶aû
(
	`¬¿y_keys
(
$sub¡™utiÚs
), $sub¡™utiÚs, 
$b»adüumb
);

500 
$¬gum’t
->
	`£t_b»adüumb
(
$this
->
bud_šfo
['breadcrumb']);

503 ià(!
	`em±y
(
$¬gum’t
->
İtiÚs
['title'])) {

504 
$t™Ë
 = 
$¬gum’t
->
İtiÚs
['title'];

507 
$b»adüumb_¬gs
[] = 
$¬g
;

511 
$¡©us
 = 
$¬gum’t
->
	`deçuÉ_aùiÚ
();

516 
	`un£t
(
$¬gum’t
);

520 ià(!
	`em±y
(
$t™Ë
)) {

521 
$this
->
bud_šfo
['t™Ë'] = 
	`¡r_»¶aû
(
	`¬¿y_keys
(
$sub¡™utiÚs
), $sub¡™utiÚs, 
$t™Ë
);

525 
$this
->
bud_šfo
['sub¡™utiÚs'] = 
$sub¡™utiÚs
;

527  
$¡©us
;

528 
	}
}

533 
funùiÚ
 
	$š™_qu”y
() {

535 
$v›ws_d©a
 = 
	`v›ws_ãtch_d©a
(
$this
->
ba£_bË
);

536 
$this
->
ba£_f›ld
 = 
$v›ws_d©a
['table']['base']['field'];

537 ià(!
	`em±y
(
$v›ws_d©a
['table']['base']['database'])) {

538 
$this
->
ba£_d©aba£
 = 
$v›ws_d©a
['table']['base']['database'];

540 
	`v›ws_šşude
('query');

541 
$this
->
qu”y
 = 
Ãw
 
	`v›ws_qu”y
($this->
ba£_bË
, $this->
ba£_f›ld
);

542 
	}
}

547 
funùiÚ
 
	$bud
(
$di¥Ïy_id
 = 
NULL
) {

548 ià(!
	`em±y
(
$this
->
but
)) {

552 ià(
	`em±y
(
$this
->
cu¼’t_di¥Ïy
è|| 
$di¥Ïy_id
) {

553 ià(!
$this
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

554  
FALSE
;

559 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_´e_bud'è
as
 
$moduË
) {

560 
$funùiÚ
 = 
$moduË
 . '_views_pre_build';

561 
	`$funùiÚ
(
$this
);

567 
$¡¬t
 = 
	`v›ws_miüÙime
();

569 
$this
->
bud_šfo
 = 
	`¬¿y
(

572 'qu”y_¬gs' => 
	`¬¿y
(),

575 
$this
->
	`š™_qu”y
();

583 
$this
->
	`š™_hªdËrs
();

586 
$this
->
	`_´e_qu”y
();

588 ià(
$this
->
di¥Ïy_hªdËr
->
	`u£s_expo£d
()) {

589 
$this
->
expo£d_widg‘s
 = $this->
	`»nd”_expo£d_fÜm
();

590 ià(
	`fÜm_£t_”rÜ
(è|| !
	`em±y
(
$this
->
bud_šfo
['abort'])) {

591 
$this
->
but
 = 
TRUE
;

592  
	`em±y
(
$this
->
bud_šfo
['fail']);

597 
$this
->
	`_bud
('relationship');

600 
$this
->
	`_bud
('filter');

602 
$this
->
bud_sÜt
 = 
TRUE
;

605 ià(!
$this
->
	`_bud_¬gum’ts
()) {

606 
$this
->
bud_time
 = 
	`v›ws_miüÙime
(è- 
$¡¬t
;

607 
$this
->
	`©ch_di¥Ïys
();

608  
$this
->
but
;

614 ià(!
$this
->
	`š™_¡yË
()) {

615 
$this
->
bud_šfo
['ç'] = 
TRUE
;

616  
FALSE
;

619 ià(
$this
->
¡yË_¶ugš
->
	`u£s_f›lds
()) {

620 
$this
->
	`_bud
('field');

624 ià(!
	`em±y
(
$this
->
bud_sÜt
)) {

626 ià(
$this
->
¡yË_¶ugš
->
	`bud_sÜt
()) {

627 
$this
->
	`_bud
('sort');

630 
$this
->
¡yË_¶ugš
->
	`bud_sÜt_po¡
();

634 
$this
->
di¥Ïy_hªdËr
->
	`qu”y
();

637 
$this
->
¡yË_¶ugš
->
	`qu”y
();

639 ià(
	`v¬ŸbË_g‘
('v›ws_sql_sigÇtu»', 
FALSE
)) {

640 
$this
->
qu”y
->
	`add_f›ld
(
NULL
, "'" . $this->
Çme
 . ':' . $this->
cu¼’t_di¥Ïy
 . "'", 'view_name');

644 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_qu”y_®‹r'è
as
 
$moduË
) {

645 
$funùiÚ
 = 
$moduË
 . '_views_query_alter';

646 
	`$funùiÚ
(
$this
, $this->
qu”y
);

649 
$this
->
bud_šfo
['qu”y'] = $this->
qu”y
->
	`qu”y
();

650 
$this
->
bud_šfo
['couÁ_qu”y'] = $this->
qu”y
->
	`qu”y
(
TRUE
);

651 
$this
->
bud_šfo
['qu”y_¬gs'] = $this->
qu”y
->
	`g‘_wh”e_¬gs
();

652 
$this
->
but
 = 
TRUE
;

653 
$this
->
bud_time
 = 
	`v›ws_miüÙime
(è- 
$¡¬t
;

656 
$this
->
	`©ch_di¥Ïys
();

657  
TRUE
;

658 
	}
}

663 
funùiÚ
 
	$_bud
(
$key
) {

664 
$hªdËrs
 = &
$this
->
$key
;

665 
	`fÜ—ch
 (
$hªdËrs
 
as
 
$id
 => 
$d©a
) {

666 ià(!
	`em±y
(
$hªdËrs
[
$id
]è&& 
	`is_objeù
($handlers[$id])) {

668 ià(!
	`em±y
(
$this
->
expo£d_d©a
)) {

669 
$rc
 = 
$hªdËrs
[
$id
]->
	`acû±_expo£d_šput
(
$this
->
expo£d_d©a
);

670 
$hªdËrs
[
$id
]->
	`¡Üe_expo£d_šput
(
$this
->
expo£d_d©a
, 
$rc
);

671 ià(!
$rc
) {

675 
$hªdËrs
[
$id
]->
	`£t_»ÏtiÚsh
();

676 
$hªdËrs
[
$id
]->
	`qu”y
();

679 
	}
}

684 
funùiÚ
 
	$execu‹
(
$di¥Ïy_id
 = 
NULL
) {

685 ià(
	`em±y
(
$this
->
but
)) {

686 ià(!
$this
->
	`bud
(
$di¥Ïy_id
)) {

687  
FALSE
;

691 ià(!
	`em±y
(
$this
->
execu‹d
)) {

692  
TRUE
;

696 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_´e_execu‹'è
as
 
$moduË
) {

697 
$funùiÚ
 = 
$moduË
 . '_views_pre_execute';

698 
	`$funùiÚ
(
$this
);

701 
$qu”y
 = 
	`db_»wr™e_sql
(
$this
->
bud_šfo
['qu”y'], $this->
ba£_bË
, $this->
ba£_f›ld
, 
	`¬¿y
('view' => &$this));

702 
$couÁ_qu”y
 = 
	`db_»wr™e_sql
(
$this
->
bud_šfo
['couÁ_qu”y'], $this->
ba£_bË
, $this->
ba£_f›ld
, 
	`¬¿y
('view' => &$this));

704 
$¬gs
 = 
$this
->
bud_šfo
['query_args'];

706 
	`v´
(
$qu”y
);

710 ià(!
	`em±y
(
$this
->
live_´ev›w
)) {

711 
$ÿche
 = 
FALSE
;

714 
$ÿche
 = 
$this
->
di¥Ïy_hªdËr
->
	`g‘_ÿche_¶ugš
();

716 ià(
$ÿche
 && $ÿche->
	`ÿche_g‘
('results')) {

717 
	`v´
('Used cached„esults');

720 
$™ems
 = 
	`¬¿y
();

721 ià(
$qu”y
) {

722 
$»¶aûm’ts
 = 
	`moduË_švoke_®l
('v›ws_qu”y_sub¡™utiÚs', 
$this
);

723 
$qu”y
 = 
	`¡r_»¶aû
(
	`¬¿y_keys
(
$»¶aûm’ts
), $replacements, $query);

724 
$couÁ_qu”y
 = 'SELECT COUNT(*èFROM (' . 
	`¡r_»¶aû
(
	`¬¿y_keys
(
$»¶aûm’ts
), $replacements, $count_query) . ') count_alias';

726 ià(
	`is_¬¿y
(
$¬gs
)) {

727 
	`fÜ—ch
 (
$¬gs
 
as
 
$id
 => 
$¬g
) {

728 
$¬gs
[
$id
] = 
	`¡r_»¶aû
(
	`¬¿y_keys
(
$»¶aûm’ts
), $»¶aûm’ts, 
$¬g
);

733 ià(
	`is£t
(
$this
->
ba£_d©aba£
)) {

734 
	`db_£t_aùive
(
$this
->
ba£_d©aba£
);

735 
$ex‹º®
 = 
TRUE
;

738 
$¡¬t
 = 
	`v›ws_miüÙime
();

739 ià(!
	`em±y
(
$this
->
·g”
['items_per_page'])) {

744 ià(!
	`em±y
(
$this
->
·g”
['u£_·g”']è|| !em±y($this->
g‘_tÙ®_rows
)) {

745 
$this
->
tÙ®_rows
 = 
	`db_»suÉ
(
	`db_qu”y
(
$couÁ_qu”y
, 
$¬gs
)è- $this->
·g”
['offset'];

748 ià(!
	`em±y
(
$this
->
·g”
['use_pager'])) {

750 
glob®
 
$·g”_·ge_¬¿y
, 
$·g”_tÙ®
, 
$·g”_tÙ®_™ems
;

752 
$·g”_tÙ®_™ems
[
$this
->
·g”
['–em’t']] = $this->
tÙ®_rows
;

754 
$·g”_tÙ®
[
$this
->
·g”
['–em’t']] = 
	`û
(
$·g”_tÙ®_™ems
[$this->pager['element']] / $this->pager['items_per_page']);

757 
$·g”_·ge_¬¿y
 = 
	`is£t
(
$_GET
['·ge']è? 
	`ex¶ode
(',', $_GET['·ge']è: 
	`¬¿y
();

761 ià(!
	`em±y
(
$·g”_·ge_¬¿y
[
$this
->
·g”
['element']])) {

762 
$·ge
 = 
	`štv®
(
$·g”_·ge_¬¿y
[
$this
->
·g”
['element']]);

763 ià(
$·ge
 > 0 && $·g< 
$·g”_tÙ®
[
$this
->
·g”
['element']]) {

764 
$this
->
·g”
['cu¼’t_·ge'] = 
$·ge
;

767 
$·g”_·ge_¬¿y
[
$this
->
·g”
['element']] = $this->pager['current_page'];

770 
$off£t
 = 
$this
->
·g”
['current_page'] * $this->pager['items_per_page'] + $this->pager['offset'];

771 
$»suÉ
 = 
	`db_qu”y_¿nge
(
$qu”y
, 
$¬gs
, 
$off£t
, 
$this
->
·g”
['items_per_page']);

775 
$»suÉ
 = 
	`db_qu”y
(
$qu”y
, 
$¬gs
);

778 
$this
->
»suÉ
 = 
	`¬¿y
();

779 
$™em
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

780 
$this
->
»suÉ
[] = 
$™em
;

785 ià(
	`em±y
(
$this
->
·g”
['items_per_page'])) {

786 
$this
->
tÙ®_rows
 = 
	`couÁ
($this->
»suÉ
);

789 ià(!
	`em±y
(
$ex‹º®
)) {

790 
	`db_£t_aùive
();

792 
$this
->
execu‹_time
 = 
	`v›ws_miüÙime
(è- 
$¡¬t
;

794 ià(
$ÿche
) {

795 
$ÿche
->
	`ÿche_£t
('results');

799 
$this
->
execu‹d
 = 
TRUE
;

800 
	}
}

805 
funùiÚ
 
	$»nd”
(
$di¥Ïy_id
 = 
NULL
) {

806 
$this
->
	`execu‹
(
$di¥Ïy_id
);

809 ià(!
	`em±y
(
$this
->
bud_šfo
['fail'])) {

813 
	`š™_theme
();

815 
$¡¬t
 = 
	`v›ws_miüÙime
();

816 ià(!
	`em±y
(
$this
->
live_´ev›w
è&& 
	`v¬ŸbË_g‘
('v›ws_show_add™iÚ®_qu”›s', 
FALSE
)) {

817 
$this
->
	`¡¬t_qu”y_ÿ±u»
();

821 ià(!
	`em±y
(
$this
->
live_´ev›w
)) {

822 
$ÿche
 = 
FALSE
;

825 
$ÿche
 = 
$this
->
di¥Ïy_hªdËr
->
	`g‘_ÿche_¶ugš
();

827 ià(
$ÿche
 && $ÿche->
	`ÿche_g‘
('output')) {

828 
	`v´
('Used cached output');

831 ià(
$ÿche
) {

832 
$ÿche
->
	`ÿche_¡¬t
();

836 
$this
->
	`š™_¡yË
();

838 
$this
->
¡yË_¶ugš
->
	`´e_»nd”
($this->
»suÉ
);

841 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_´e_»nd”'è
as
 
$moduË
) {

842 
$funùiÚ
 = 
$moduË
 . '_views_pre_render';

843 
	`$funùiÚ
(
$this
);

847 
$funùiÚ
 = 
$GLOBALS
['theme'] . '_views_pre_render';

848 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

849 
	`$funùiÚ
(
$this
, $this->
di¥Ïy_hªdËr
->
ouut
, 
$ÿche
);

854 ià(
$this
->
¡yË_¶ugš
->
	`u£s_f›lds
()) {

855 
	`fÜ—ch
 (
$this
->
f›ld
 
as
 
$id
 => 
$hªdËr
) {

856 ià(!
	`em±y
(
$this
->
f›ld
[
$id
])) {

857 
$this
->
f›ld
[
$id
]->
	`´e_»nd”
($this->
»suÉ
);

861 
$this
->
di¥Ïy_hªdËr
->
ouut
 = $this->di¥Ïy_hªdËr->
	`»nd”
();

862 ià(
$ÿche
) {

863 
$ÿche
->
	`ÿche_£t
('output');

867 ià(
$ÿche
) {

868 
$ÿche
->
	`po¡_»nd”
(
$this
->
di¥Ïy_hªdËr
->
ouut
);

872 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_po¡_»nd”'è
as
 
$moduË
) {

873 
$funùiÚ
 = 
$moduË
 . '_views_post_render';

874 
	`$funùiÚ
(
$this
, $this->
di¥Ïy_hªdËr
->
ouut
, 
$ÿche
);

878 
$funùiÚ
 = 
$GLOBALS
['theme'] . '_views_post_render';

879 ià(
	`funùiÚ_exi¡s
(
$funùiÚ
)) {

880 
	`$funùiÚ
(
$this
, $this->
di¥Ïy_hªdËr
->
ouut
, 
$ÿche
);

883 ià(!
	`em±y
(
$this
->
live_´ev›w
è&& 
	`v¬ŸbË_g‘
('v›ws_show_add™iÚ®_qu”›s', 
FALSE
)) {

884 
$this
->
	`’d_qu”y_ÿ±u»
();

886 
$this
->
»nd”_time
 = 
	`v›ws_miüÙime
(è- 
$¡¬t
;

888  
$this
->
di¥Ïy_hªdËr
->
ouut
;

889 
	}
}

894 
funùiÚ
 
	$»nd”_f›ld
(
$f›ld
, 
$row
) {

895 ià(
	`is£t
(
$this
->
f›ld
[
$f›ld
]è&& is£t($this->
»suÉ
[
$row
])) {

896  
$this
->
f›ld
[
$f›ld
]->
	`advªûd_»nd”
($this->
»suÉ
[
$row
]);

898 
	}
}

912 
funùiÚ
 
execu‹_di¥Ïy
(
$di¥Ïy_id
 = 
NULL
, 
$¬gs
 = 
	$¬¿y
()) {

913 ià(
	`em±y
(
$this
->
cu¼’t_di¥Ïy
è|| $this->cu¼’t_di¥Ïy !ğ$this->
	`choo£_di¥Ïy
(
$di¥Ïy_id
)) {

914 ià(!
$this
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

915  
FALSE
;

919 
$this
->
	`´e_execu‹
(
$¬gs
);

922 
$ouut
 = 
$this
->
di¥Ïy_hªdËr
->
	`execu‹
();

924 
$this
->
	`po¡_execu‹
();

925  
$ouut
;

926 
	}
}

935 
funùiÚ
 
´ev›w
(
$di¥Ïy_id
 = 
NULL
, 
$¬gs
 = 
	$¬¿y
()) {

936 ià(
	`em±y
(
$this
->
cu¼’t_di¥Ïy
è|| $this->cu¼’t_di¥Ïy !ğ
$di¥Ïy_id
) {

937 ià(!
$this
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

938  
FALSE
;

942 
$this
->
´ev›w
 = 
TRUE
;

943 
$this
->
	`´e_execu‹
(
$¬gs
);

945 
$ouut
 = 
$this
->
di¥Ïy_hªdËr
->
	`´ev›w
();

947 
$this
->
	`po¡_execu‹
();

948  
$ouut
;

949 
	}
}

955 
funùiÚ
 
´e_execu‹
(
$¬gs
 = 
	$¬¿y
()) {

956 
$this
->
Şd_v›w
[] = 
	`v›ws_g‘_cu¼’t_v›w
();

957 
	`v›ws_£t_cu¼’t_v›w
(
$this
);

958 
$di¥Ïy_id
 = 
$this
->
cu¼’t_di¥Ïy
;

961 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_´e_v›w'è
as
 
$moduË
) {

962 
$funùiÚ
 = 
$moduË
 . '_views_pre_view';

963 
	`$funùiÚ
(
$this
, 
$di¥Ïy_id
, 
$¬gs
);

968 ià(
$¬gs
) {

969 
$this
->
	`£t_¬gum’ts
(
$¬gs
);

975 
$this
->
di¥Ïy_hªdËr
->
	`´e_execu‹
();

976 
	}
}

981 
funùiÚ
 
	$po¡_execu‹
() {

985 ià(
$this
->
Şd_v›w
) {

986 
$Şd_v›w
 = 
	`¬¿y_pİ
(
$this
->
Şd_v›w
);

989 
	`v›ws_£t_cu¼’t_v›w
(
	`is£t
(
$Şd_v›w
è? $Şd_v›w : 
FALSE
);

990 
	}
}

995 
funùiÚ
 
	$©ch_di¥Ïys
() {

996 ià(!
	`em±y
(
$this
->
is_©chm’t
)) {

1000 ià(!
$this
->
di¥Ïy_hªdËr
->
	`acû±_©chm’ts
()) {

1004 
$this
->
is_©chm’t
 = 
TRUE
;

1006 
	`fÜ—ch
 (
$this
->
di¥Ïy
 
as
 
$id
 => 
$di¥Ïy
) {

1007 ià(!
	`em±y
(
$this
->
di¥Ïy
[
$id
]->
hªdËr
)) {

1008 
$this
->
di¥Ïy
[
$id
]->
hªdËr
->
	`©ch_to
($this->
cu¼’t_di¥Ïy
);

1011 
$this
->
is_©chm’t
 = 
FALSE
;

1012 
	}
}

1022 
funùiÚ
 
execu‹_hook_m’u
(
$di¥Ïy_id
 = 
NULL
, 
$ÿÎbacks
 = 
	$¬¿y
()) {

1026 ià(!
$this
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

1027  
FALSE
;

1031 ià(
	`is£t
(
$this
->
di¥Ïy_hªdËr
)) {

1032  
$this
->
di¥Ïy_hªdËr
->
	`execu‹_hook_m’u
(
$ÿÎbacks
);

1034 
	}
}

1040 
funùiÚ
 
	$execu‹_hook_block
(
$di¥Ïy_id
 = 
NULL
) {

1044 ià(!
$this
->
	`£t_di¥Ïy
(
$di¥Ïy_id
)) {

1045  
FALSE
;

1049 ià(
	`is£t
(
$this
->
di¥Ïy_hªdËr
)) {

1050  
$this
->
di¥Ïy_hªdËr
->
	`execu‹_hook_block
();

1052 
	}
}

1058 
funùiÚ
 
	$acûss
(
$di¥Ïys
 = 
NULL
, 
$accouÁ
 = NULL) {

1059 ià(!
	`is£t
(
$this
->
cu¼’t_di¥Ïy
)) {

1060 
$this
->
	`š™_di¥Ïy
();

1063 ià(!
$accouÁ
) {

1064 
$accouÁ
 = 
$GLOBALS
['user'];

1069 
$di¥Ïys
 = (
¬¿y
)$displays;

1070 
	`fÜ—ch
 (
$di¥Ïys
 
as
 
$di¥Ïy_id
) {

1071 ià(!
	`em±y
(
$this
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
)) {

1072 ià(
$this
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
->
	`acûss
(
$accouÁ
)) {

1073  
TRUE
;

1078  
FALSE
;

1079 
	}
}

1085 
funùiÚ
 
	$g‘_t™Ë
() {

1086 ià(
	`em±y
(
$this
->
di¥Ïy_hªdËr
)) {

1087 ià(!
$this
->
	`£t_di¥Ïy
('default')) {

1088  
FALSE
;

1093 ià(!
	`em±y
(
$this
->
bud_šfo
['title'])) {

1094 
$t™Ë
 = 
$this
->
bud_šfo
['title'];

1097 
$t™Ë
 = 
$this
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('title');

1100  
$t™Ë
;

1101 
	}
}

1106 
funùiÚ
 
	$bud_t™Ë
() {

1107 
$this
->
	`š™_di¥Ïy
();

1108 ià(
	`em±y
(
$this
->
but
)) {

1109 
$this
->
	`š™_qu”y
();

1111 
$this
->
	`š™_hªdËrs
();

1113 
$this
->
	`_bud_¬gum’ts
();

1114 
	}
}

1121 
funùiÚ
 
	$g‘_u¾
(
$¬gs
 = 
NULL
, 
$·th
 = NULL) {

1122 ià(!
	`is£t
(
$·th
)) {

1123 
$·th
 = 
$this
->
	`g‘_·th
();

1125 ià(!
	`is£t
(
$¬gs
)) {

1126 
$¬gs
 = 
$this
->
¬gs
;

1129 ià(
	`em±y
(
$·th
è|| (em±y(
$¬gs
è&& 
	`¡½os
($·th, '%'è==ğ
FALSE
)) {

1130  
$·th
;

1133 
$p›ûs
 = 
	`¬¿y
();

1134 
$¬gum’ts
 = 
	`is£t
($¬gum’tsè? $¬gum’t : 
$this
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('arguments');

1135 
$¬gum’t_keys
 = 
	`is£t
(
$¬gum’ts
è? 
	`¬¿y_keys
($¬gum’tsè: 
	`¬¿y
();

1136 
$id
 = 
	`cu¼’t
(
$¬gum’t_keys
);

1137 
	`fÜ—ch
 (
	`ex¶ode
('/', 
$·th
è
as
 
$p›û
) {

1138 ià(
$p›û
 != '%') {

1139 
$p›ûs
[] = 
$p›û
;

1142 ià(
	`em±y
(
$¬gs
)) {

1144 ià(
$id
 && !
	`em±y
(
$¬gum’ts
[$id]['wildcard'])) {

1145 
$p›ûs
[] = 
$¬gum’ts
[
$id
]['wildcard'];

1148 
$p›ûs
[] = '*';

1153 
$p›ûs
[] = 
	`¬¿y_shiá
(
$¬gs
);

1156 ià(
$id
) {

1157 
$id
 = 
	`Ãxt
(
$¬gum’t_keys
);

1162 ià(!
	`em±y
(
$¬gs
)) {

1163 
$p›ûs
 = 
	`¬¿y_m”ge
($p›ûs, 
$¬gs
);

1165  
	`im¶ode
('/', 
$p›ûs
);

1166 
	}
}

1171 
funùiÚ
 
	$g‘_·th
() {

1172 ià(!
	`em±y
(
$this
->
ov”ride_·th
)) {

1173  
$this
->
ov”ride_·th
;

1176 ià(
	`em±y
(
$this
->
di¥Ïy_hªdËr
)) {

1177 ià(!
$this
->
	`£t_di¥Ïy
('default')) {

1178  
FALSE
;

1181  
$this
->
di¥Ïy_hªdËr
->
	`g‘_·th
();

1182 
	}
}

1190 
funùiÚ
 
	$g‘_b»adüumb
(
$£t
 = 
FALSE
) {

1192 
$ba£
 = 
TRUE
;

1193 
$b»adüumb
 = 
	`¬¿y
();

1195 ià(!
	`em±y
(
$this
->
bud_šfo
['breadcrumb'])) {

1196 
	`fÜ—ch
 (
$this
->
bud_šfo
['b»adüumb'] 
as
 
$·th
 => 
$t™Ë
) {

1199 ià(
$·th
 =ğ
	`v¬ŸbË_g‘
('site_frontpage', 'node')) {

1200 
$ba£
 = 
FALSE
;

1201 
$t™Ë
 = 
	`t
('Home');

1203 ià(
$t™Ë
) {

1204 
$b»adüumb
[] = 
	`l
(
$t™Ë
, 
$·th
, 
	`¬¿y
('html' => 
Œue
));

1208 ià(
$£t
) {

1209 ià(
$ba£
) {

1210 
$b»adüumb
 = 
	`¬¿y_m”ge
(
	`dru·l_g‘_b»adüumb
(), $breadcrumb);

1212 
	`dru·l_£t_b»adüumb
(
$b»adüumb
);

1215  
$b»adüumb
;

1216 
	}
}

1221 
funùiÚ
 
	$is_ÿch—bË
() {

1222  
$this
->
is_ÿch—bË
;

1223 
	}
}

1234 
funùiÚ
 
	$¡¬t_qu”y_ÿ±u»
() {

1235 
glob®
 
$cÚf
, 
$qu”›s
;

1236 ià(
	`em±y
(
$cÚf
['dev_query'])) {

1237 
$this
->
fix_dev_qu”y
 = 
TRUE
;

1238 
$cÚf
['dev_qu”y'] = 
TRUE
;

1243 
$this
->
Ï¡_qu”y_key
 = 
NULL
;

1245 ià(!
	`em±y
(
$qu”›s
)) {

1246 
$keys
 = 
	`¬¿y_keys
(
$qu”›s
);

1247 
$this
->
Ï¡_qu”y_key
 = 
	`¬¿y_pİ
(
$keys
);

1249 
	}
}

1256 
funùiÚ
 
	$’d_qu”y_ÿ±u»
() {

1257 
glob®
 
$cÚf
, 
$qu”›s
;

1258 ià(!
	`em±y
(
$this
->
fix_dev_qu”y
)) {

1259 
$cÚf
['dev_qu”y'] = 
FALSE
;

1263 
$‹mp
 = 
$qu”›s
;

1267 ià(
	`is£t
(
$this
->
Ï¡_qu”y_key
)) {

1268 
	`li¡
(
$id
, 
$qu”y
èğ
	`—ch
(
$qu”›s
)) {

1269 ià(
$id
 =ğ
$this
->
Ï¡_qu”y_key
) {

1273 
	`un£t
(
$‹mp
[
$id
]);

1277 
$this
->
add™iÚ®_qu”›s
 = 
$‹mp
;

1278 
	}
}

1292 
	gfunùiÚ
 &
	$lßd
(
$¬g
, 
$»£t
 = 
FALSE
) {

1293 
$ÿche
 = 
	`¬¿y
();

1296 ià(!
	`¬¿y_key_exi¡s
(
$¬g
, 
$ÿche
è|| 
$»£t
) {

1297 
$wh”e
 = (
	`is_num”ic
(
$¬g
) ? "vid = %d" : "name = '%s'");

1298 
$d©a
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT * FROM {v›ws_v›w} WHERE $wh”e", 
$¬g
));

1299 ià(
	`em±y
(
$d©a
)) {

1300 
$ÿche
[
$¬g
] = 
NULL
;

1303 
$v›w
 = 
Ãw
 
	`v›w
();

1304 
$v›w
->
	`lßd_row
(
$d©a
);

1305 
$v›w
->
ty³
 = 
	`t
('Normal');

1307 
	`fÜ—ch
 (
$v›w
->
	`db_objeùs
(è
as
 
$key
) {

1308 
$objeù_Çme
 = "views_$key";

1309 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {{$objeù_Çme}} WHERE vid = %d ORDER BY…os™iÚ", 
$v›w
->
vid
);

1311 
$d©a
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1312 
$objeù
 = 
Ãw
 
	`$objeù_Çme
(
FALSE
);

1313 
$objeù
->
	`lßd_row
(
$d©a
);

1317 
$loÿtiÚ
 = &
$v›w
->
$key
;

1321 ià(!
	`em±y
(
$objeù
->
id
)) {

1322 
$loÿtiÚ
[
$objeù
->
id
] = $object;

1325 
$loÿtiÚ
[] = 
$objeù
;

1330 
$v›w
->
lßded
 = 
TRUE
;

1331 
$ÿche
[
$¬g
] = 
$v›w
;

1335  
$ÿche
[
$¬g
];

1336 
	}
}

1345 
funùiÚ
 
	$lßd_v›ws
() {

1346 
$»suÉ
 = 
	`db_qu”y
("SELECT DISTINCT v.* FROM {views_view} v");

1347 
$v›ws
 = 
	`¬¿y
();

1348 
$vids
 = 
	`¬¿y
();

1351 
$d©a
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1352 
$v›w
 = 
Ãw
 
v›w
;

1353 
$v›w
->
	`lßd_row
(
$d©a
);

1354 
$v›w
->
lßded
 = 
TRUE
;

1355 
$v›w
->
ty³
 = 
	`t
('Normal');

1356 
$v›ws
[
$v›w
->
Çme
] = $view;

1357 
$Çmes
[
$v›w
->
vid
] = $v›w->
Çme
;

1361 ià(!
$v›ws
) {

1362  
	`¬¿y
();

1365 
$vids
 = 
	`im¶ode
(', ', 
	`¬¿y_keys
(
$Çmes
));

1367 
	`fÜ—ch
 (
v›w
::
	`db_objeùs
(è
as
 
$key
) {

1368 
$objeù_Çme
 = "views_$key";

1369 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {{$object_name}} WHERE vid IN ($vids) ORDER BY vid,…osition");

1371 
$d©a
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

1372 
$objeù
 = 
Ãw
 
	`$objeù_Çme
(
FALSE
);

1373 
$objeù
->
	`lßd_row
(
$d©a
);

1377 
$loÿtiÚ
 = &
$v›ws
[
$Çmes
[
$objeù
->
vid
]]->
$key
;

1381 ià(!
	`em±y
(
$objeù
->
id
)) {

1382 
$loÿtiÚ
[
$objeù
->
id
] = $object;

1385 
$loÿtiÚ
[] = 
$objeù
;

1389  
$v›ws
;

1390 
	}
}

1396 
funùiÚ
 
	$§ve
() {

1397 ià(
$this
->
vid
 == 'new') {

1398 
$this
->
vid
 = 
NULL
;

1402 ià(!
	`em±y
(
$this
->
vid
)) {

1404 
	`fÜ—ch
 (
$this
->
	`db_objeùs
(è
as
 
$key
) {

1405 
	`db_qu”y
("DELETE from {v›ws_" . 
$key
 . "} WHERE vid = %d", 
$this
->
vid
);

1409 
$this
->
	`§ve_row
(!
	`em±y
($this->
vid
è? 'vid' : 
FALSE
);

1412 
	`fÜ—ch
 (
$this
->
	`db_objeùs
(è
as
 
$key
) {

1413 
$this
->
	`_§ve_rows
(
$key
);

1416 
	`ÿche_ş—r_®l
('views_urls', 'cache_views');

1417 
	`ÿche_ş—r_®l
();

1418 
	}
}

1424 
funùiÚ
 
	$_§ve_rows
(
$key
) {

1425 
$couÁ
 = 0;

1426 
	`fÜ—ch
 (
$this
->
$key
 
as
 
$pos™iÚ
 => 
$objeù
) {

1427 
$objeù
->
pos™iÚ
 = ++
$couÁ
;

1428 
$objeù
->
vid
 = 
$this
->vid;

1429 
$objeù
->
	`§ve_row
();

1431 
	}
}

1436 
funùiÚ
 
	$d–‘e
(
$ş—r
 = 
TRUE
) {

1437 ià(
	`em±y
(
$this
->
vid
)) {

1441 
	`db_qu”y
("DELETE FROM {v›ws_v›w} WHERE vid = %d", 
$this
->
vid
);

1443 
	`fÜ—ch
 (
$this
->
	`db_objeùs
(è
as
 
$key
) {

1444 
	`db_qu”y
("DELETE from {v›ws_" . 
$key
 . "} WHERE vid = %d", 
$this
->
vid
);

1447 
	`ÿche_ş—r_®l
('v›ws_qu”y:' . 
$this
->
Çme
, 'cache_views');

1449 ià(
$ş—r
) {

1450 
	`ÿche_ş—r_®l
();

1451 
	`m’u_»bud
();

1453 
	}
}

1458 
funùiÚ
 
expÜt
(
$šd’t
 = '') {

1459 
$this
->
š™_di¥Ïy
();

1460 
	g$ouut
 = '';

1461 
	g$ouut
 .ğ
$this
->
expÜt_row
('v›w', 
$šd’t
);

1463 
	g$ouut
 .ğ
$šd’t
 . '$v›w->­i_v”siÚ = ' . 
v›ws_­i_v”siÚ
() . ";\n";

1464 
	g$ouut
 .ğ
$šd’t
 . '$view->disabled = FALSE; /* Edithisorueo make‡ default view disabled initially */' . "\n";

1466 
fÜ—ch
 (
$this
->
di¥Ïy
 
as
 
$id
 => 
$di¥Ïy
) {

1467 
$ouut
 .ğ
$šd’t
 . '$hªdË¸ğ$v›w->Ãw_di¥Ïy(' . 
v›ws_v¬_expÜt
(
$di¥Ïy
->
di¥Ïy_¶ugš
, $šd’tè. ', ' . v›ws_v¬_expÜt($di¥Ïy->
di¥Ïy_t™Ë
, $šd’tè. ', \'' . 
	g$id
 . "');\n";

1468 ià(
em±y
(
$di¥Ïy
->
hªdËr
)) {

1475 
fÜ—ch
 (
$di¥Ïy
->
hªdËr
->
İtiÚ_defš™iÚ
(è
as
 
$İtiÚ
 => 
$defš™iÚ
) {

1477 
$İtiÚ
) {

1482 ià(!
$di¥Ïy
->
hªdËr
->
is_deçuÉed
(
$İtiÚ
)) {

1483 
$v®ue
 = 
$di¥Ïy
->
hªdËr
->
g‘_İtiÚ
(
$İtiÚ
);

1484 ià(
	g$id
 == 'default') {

1485 
$deçuÉ
 = 
is£t
(
$defš™iÚ
['deçuÉ']è? $defš™iÚ['deçuÉ'] : 
NULL
;

1488 
	g$deçuÉ
 = 
$this
->
di¥Ïy
['deçuÉ']->
hªdËr
->
g‘_İtiÚ
(
$İtiÚ
);

1491 ià(
	g$v®ue
 !=ğ
$deçuÉ
) {

1492 
$ouut
 .ğ
$šd’t
 . '$hªdËr->ov”ride_İtiÚ(\'' . 
$İtiÚ
 . '\', ' . 
v›ws_v¬_expÜt
(
$v®ue
, $indent) . ");\n";

1499  
	g$ouut
;

1508 
funùiÚ
 
	$cİy
() {

1509 
$code
 = 
$this
->
	`expÜt
();

1510 
	`ev®
(
$code
);

1511  
$v›w
;

1512 
	}
}

1525 
funùiÚ
 
	$şÚe_v›w
() {

1526 
$şÚe
 = 
	`v”siÚ_com·»
(
	`phpv”siÚ
(), '5.0'è< 0 ? 
$this
 : 
	`şÚe
($this);

1528 
$keys
 = 
	`¬¿y
('current_display', 'display_handler', 'build_info', 'built', 'executed', 'attachment_before', 'attachment_after', 'field', 'argument', 'filter', 'sort', 'relationship', 'query', 'inited', 'style_plugin', 'plugin_name', 'exposed_data', 'exposed_input', 'exposed_widgets', 'many_to_one_tables', 'feed_icon');

1529 
	`fÜ—ch
 (
$keys
 
as
 
$key
) {

1530 ià(
	`is£t
(
$şÚe
->
$key
)) {

1531 
	`un£t
(
$şÚe
->
$key
);

1534 
$şÚe
->
but
 = $şÚe->
execu‹d
 = 
FALSE
;

1535 
$şÚe
->
bud_šfo
 = 
	`¬¿y
();

1536 
$şÚe
->
©chm’t_befÜe
 = '';

1537 
$şÚe
->
©chm’t_aá”
 = '';

1538 
$şÚe
->
»suÉ
 = 
	`¬¿y
();

1542 
$di¥Ïys
 = 
	`¬¿y
();

1543 
	`fÜ—ch
 (
$şÚe
->
di¥Ïy
 
as
 
$id
 => 
$di¥Ïy
) {

1544 
$di¥Ïys
[
$id
] = 
	`dru·l_şÚe
(
$di¥Ïy
);

1545 ià(
	`is£t
(
$di¥Ïys
[
$id
]->
hªdËr
)) {

1546 
	`un£t
(
$di¥Ïys
[
$id
]->
hªdËr
);

1549 
$şÚe
->
di¥Ïy
 = 
$di¥Ïys
;

1551  
$şÚe
;

1552 
	}
}

1558 
funùiÚ
 
	$de¡roy
() {

1559 
	`fÜ—ch
 (
	`¬¿y_keys
(
$this
->
di¥Ïy
è
as
 
$di¥Ïy_id
) {

1560 ià(
	`is£t
(
$this
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
)) {

1561 
$this
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
->
	`de¡roy
();

1562 
	`un£t
(
$this
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
);

1565 
	`fÜ—ch
 (
	`v›ws_objeù_ty³s
(è
as
 
$ty³
 => 
$šfo
) {

1566 ià(
	`is£t
(
$this
->
$ty³
)) {

1567 
$hªdËrs
 = &
$this
->
$ty³
;

1568 
	`fÜ—ch
 (
$hªdËrs
 
as
 
$id
 => 
$™em
) {

1569 
$hªdËrs
[
$id
]->
	`de¡roy
();

1571 
	`un£t
(
$hªdËrs
);

1575 ià(
	`is£t
(
$this
->
¡yË_¶ugš
)) {

1576 
$this
->
¡yË_¶ugš
->
	`de¡roy
();

1577 
	`un£t
(
$this
->
¡yË_¶ugš
);

1581 ià(
	`is£t
(
$this
->
di¥Ïy_hªdËr
)) {

1582 
	`un£t
(
$this
->
di¥Ïy_hªdËr
);

1585 ià(
	`is£t
(
$this
->
cu¼’t_di¥Ïy
)) {

1586 
	`un£t
(
$this
->
cu¼’t_di¥Ïy
);

1589 ià(
	`is£t
(
$this
->
qu”y
)) {

1590 
	`un£t
(
$this
->
qu”y
);

1593 
	}
}

1601 
funùiÚ
 
	$v®id©e
() {

1602 
$this
->
	`š™_di¥Ïy
();

1604 
$”rÜs
 = 
	`¬¿y
();

1606 
	`fÜ—ch
 (
$this
->
di¥Ïy
 
as
 
$id
 => 
$di¥Ïy
) {

1607 ià(
$di¥Ïy
->
hªdËr
) {

1608 ià(!
	`em±y
(
$di¥Ïy
->
d–‘ed
)) {

1612 
$»suÉ
 = 
$this
->
di¥Ïy
[
$id
]->
hªdËr
->
	`v®id©e
();

1613 ià(!
	`em±y
(
$»suÉ
è&& 
	`is_¬¿y
($result)) {

1614 
$”rÜs
 = 
	`¬¿y_m”ge
($”rÜs, 
$»suÉ
);

1619  
$”rÜs
 ? $”rÜ : 
TRUE
;

1620 
	}
}

1626 şas 
	cv›ws_db_objeù
 {

1635 
funùiÚ
 
	$š™
(
$š™
 = 
TRUE
) {

1636 ià(
	`is_¬¿y
(
$š™
)) {

1637  
$this
->
	`lßd_row
(
$š™
);

1640 ià(!
$š™
) {

1644 
$schema
 = 
	`dru·l_g‘_schema
(
$this
->
db_bË
);

1646 ià(!
$schema
) {

1651 
	`fÜ—ch
 (
$schema
['f›lds'] 
as
 
$f›ld
 => 
$šfo
) {

1652 ià(
$šfo
['type'] == 'serial') {

1653 
$this
->
$f›ld
 = 
NULL
;

1655 ià(!
	`is£t
(
$this
->
$f›ld
)) {

1656 ià(!
	`em±y
(
$šfo
['£rŸlize']è&& 
	`is£t
($info['serialized default'])) {

1657 
$this
->
$f›ld
 = 
	`un£rŸlize
(
$šfo
['serialized default']);

1659 ià(
	`is£t
(
$šfo
['default'])) {

1660 
$this
->
$f›ld
 = 
$šfo
['default'];

1663 
$this
->
$f›ld
 = '';

1675 
funùiÚ
 
	$§ve_row
(
$upd©e
 = 
NULL
) {

1676 
$schema
 = 
	`dru·l_g‘_schema
(
$this
->
db_bË
);

1677 
$f›lds
 = 
$defs
 = 
$v®ues
 = 
$£rŸls
 = 
	`¬¿y
();

1680 
	`fÜ—ch
 (
$schema
['f›lds'] 
as
 
$f›ld
 => 
$šfo
) {

1682 ià(
$šfo
['type'] == 'serial') {

1683 
$£rŸls
[] = 
$f›ld
;

1686 
$f›lds
[] = 
$f›ld
;

1687 
$šfo
['type']) {

1689 
$defs
[] = '%b';

1692 
$defs
[] = '%d';

1696 
$defs
[] = '%f';

1699 
$defs
[] = "'%s'";

1701 ià(
	`em±y
(
$šfo
['serialize'])) {

1702 
$v®ues
[] = 
$this
->
$f›ld
;

1705 
$v®ues
[] = 
	`£rŸlize
(
$this
->
$f›ld
);

1708 
$qu”y
 = '';

1709 ià(!
$upd©e
) {

1710 
$qu”y
 = "INSERT INTO {" . 
$this
->
db_bË
 . "} (" . 
	`im¶ode
(', ', 
$f›lds
è. 'èVALUES (' . im¶ode(', ', 
$defs
) . ')';

1713 
$qu”y
 = '';

1714 
	`fÜ—ch
 (
$f›lds
 
as
 
$id
 => 
$f›ld
) {

1715 ià(
$qu”y
) {

1716 
$qu”y
 .= ', ';

1718 
$qu”y
 .ğ
$f›ld
 . ' = ' . 
$defs
[
$id
];

1720 
$qu”y
 = "UPDATE {" . 
$this
->
db_bË
 . "} SET " . $qu”y . " WHERE $upd©ğ" . $this->
$upd©e
;

1722 
	`db_qu”y
(
$qu”y
, 
$v®ues
);

1724 ià(
$£rŸls
 && !
$upd©e
) {

1726 
	`fÜ—ch
 (
$£rŸls
 
as
 
$f›ld
) {

1727 
$this
->
$f›ld
 = 
	`db_Ï¡_š£¹_id
($this->
db_bË
, $field);

1730 
	}
}

1743 
funùiÚ
 
	$lßd_row
(
$d©a
) {

1744 
$schema
 = 
	`dru·l_g‘_schema
(
$this
->
db_bË
);

1747 
	`fÜ—ch
 (
$schema
['f›lds'] 
as
 
$f›ld
 => 
$šfo
) {

1748 
$this
->
$f›ld
 = 
	`em±y
(
$šfo
['£rŸlize']è? 
$d©a
->$f›ld : 
	`un£rŸlize
(
	`db_decode_blob
($data->$field));

1750 
	}
}

1760 
funùiÚ
 
expÜt_row
(
$id’tif›r
 = 
NULL
, 
$šd’t
 = '') {

1761 ià(!
$id’tif›r
) {

1762 
$id’tif›r
 = 
$this
->
db_bË
;

1764 
	g$schema
 = 
dru·l_g‘_schema
(
$this
->
db_bË
);

1766 
	g$ouut
 = 
$šd’t
 . '$' . 
$id’tif›r
 . ' =‚ew ' . 
g‘_şass
(
$this
) . ";\n";

1768 
fÜ—ch
 (
$schema
['f›lds'] 
as
 
$f›ld
 => 
$šfo
) {

1769 ià(!
em±y
(
$šfo
['noƒxport'])) {

1772 ià(!
is£t
(
$this
->
$f›ld
)) {

1773 ià(
is£t
(
$šfo
['default'])) {

1774 
	g$this
->
	g$f›ld
 = 
$šfo
['default'];

1777 
	g$this
->
	g$f›ld
 = '';

1781 ià(
is£t
(
$šfo
['serialize'])) {

1782 
	g$this
->
	g$f›ld
 = 
un£rŸlize
(
db_decode_blob
(
$this
->
$f›ld
));

1785 
	g$v®ue
 = 
$this
->
$f›ld
;

1786 ià(
	g$šfo
['type'] == 'int') {

1787 
$v®ue
 = (
$šfo
['size'] =ğ'tšy'è? (
boŞ
) $value : () $value;

1790 
	g$ouut
 .ğ
$šd’t
 . '$' . 
$id’tif›r
 . '->' . 
$f›ld
 . ' = ' . 
v›ws_v¬_expÜt
(
$v®ue
, $indent) . ";\n";

1792  
	g$ouut
;

1808 
funùiÚ
 
add_di¥Ïy
(
$ty³
 = '·ge', 
$t™Ë
 = 
NULL
, 
$id
 = NULL) {

1809 ià(
em±y
(
$ty³
)) {

1810  
FALSE
;

1813 
	g$¶ugš
 = 
v›ws_ãtch_¶ugš_d©a
('di¥Ïy', 
$ty³
);

1814 ià(
em±y
(
$¶ugš
)) {

1815 
	g$¶ugš
['t™Ë'] = 
t
('Broken');

1820 ià(
em±y
(
$id
)) {

1821 
	g$id
 = (
$ty³
 == 'default') ? $type : $type . '_1';

1822 
	g$t™Ë
 = 
$¶ugš
['title'];

1824 
	g$couÁ
 = 1;

1828 !
em±y
(
$this
->
di¥Ïy
[
$id
])) {

1829 
	g$id
 = 
$ty³
 . '_' . ++
$couÁ
;

1830 ià(
em±y
(
$t™Ë
)) {

1831 
	g$t™Ë
 = 
$¶ugš
['t™Ë'] . ' ' . 
$couÁ
;

1837 
	g$di¥Ïy
 = 
Ãw
 
v›ws_di¥Ïy
;

1838 
	g$di¥Ïy
->
İtiÚs
(
$ty³
, 
$id
, 
$t™Ë
);

1841 
	g$this
->
	gdi¥Ïy
[
$id
] = 
$di¥Ïy
;

1842  
	g$id
;

1856 
	gfunùiÚ
 &
Ãw_di¥Ïy
(
$ty³
 = '·ge', 
$t™Ë
 = 
NULL
, 
$id
 = NULL) {

1857 
$id
 = 
$this
->
add_di¥Ïy
(
$ty³
, 
$t™Ë
, $id);

1860 
	g$this
->
	gdi¥Ïy
[
$id
]->
	ghªdËr
 = 
v›ws_g‘_¶ugš
('di¥Ïy', 
$this
->
di¥Ïy
[$id]->
di¥Ïy_¶ugš
);

1861 ià(
em±y
(
$this
->
di¥Ïy
[
$id
]->
hªdËr
)) {

1864 
	g$this
->
	gdi¥Ïy
[
$id
]->
	ghªdËr
 = 
v›ws_g‘_¶ugš
('display', 'default');

1867 ià(!
em±y
(
$this
->
di¥Ïy
[
$id
]->
hªdËr
)) {

1869 
	g$this
->
	gdi¥Ïy
[
$id
]->
	ghªdËr
->
š™
(
$this
, $this->
di¥Ïy
[$id]);

1871 ià(
	g$id
 != 'default') {

1872 
$this
->
di¥Ïy
[
$id
]->
hªdËr
->
deçuÉ_di¥Ïy
 = &$this->display['default']->handler;

1876  
	g$this
->
	gdi¥Ïy
[
$id
]->
	ghªdËr
;

1884 
funùiÚ
 
add_™em
(
$di¥Ïy_id
, 
$ty³
, 
$bË
, 
$f›ld
, 
$İtiÚs
 = 
¬¿y
(), 
$id
 = 
NULL
) {

1885 
$ty³s
 = 
v›ws_objeù_ty³s
();

1886 
	g$this
->
£t_di¥Ïy
(
$di¥Ïy_id
);

1888 
	g$f›lds
 = 
$this
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
->
g‘_İtiÚ
(
$ty³s
[
$ty³
]['plural']);

1890 ià(
em±y
(
$id
)) {

1891 
	g$couÁ
 = 0;

1892 
	g$id
 = 
$f›ld
;

1893 !
em±y
(
$f›lds
[
$id
])) {

1894 
	g$id
 = 
$f›ld
 . '_' . ++
$couÁ
;

1898 
	g$Ãw_™em
 = 
¬¿y
(

1899 'id' => 
$id
,

1900 'bË' => 
$bË
,

1901 'f›ld' => 
$f›ld
,

1902 è+ 
	g$İtiÚs
;

1904 
	g$hªdËr
 = 
v›ws_g‘_hªdËr
(
$bË
, 
$f›ld
, 
$ty³
);

1906 
	g$f›lds
[
$id
] = 
$Ãw_™em
;

1907 
	g$this
->
	gdi¥Ïy
[
$di¥Ïy_id
]->
	ghªdËr
->
£t_İtiÚ
(
$ty³s
[
$ty³
]['¶u¿l'], 
$f›lds
);

1909  
	g$id
;

1915 
funùiÚ
 
	$g‘_™ems
(
$ty³
, 
$di¥Ïy_id
 = 
NULL
) {

1916 
$this
->
	`£t_di¥Ïy
(
$di¥Ïy_id
);

1918 ià(!
	`is£t
(
$di¥Ïy_id
)) {

1919 
$di¥Ïy_id
 = 
$this
->
cu¼’t_di¥Ïy
;

1923 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

1924  
$this
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
->
	`g‘_İtiÚ
(
$ty³s
[
$ty³
]['plural']);

1925 
	}
}

1931 
funùiÚ
 
	$g‘_™em
(
$di¥Ïy_id
, 
$ty³
, 
$id
) {

1933 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

1935 
$this
->
	`£t_di¥Ïy
(
$di¥Ïy_id
);

1938 
$f›lds
 = 
$this
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
->
	`g‘_İtiÚ
(
$ty³s
[
$ty³
]['plural']);

1940  
	`is£t
(
$f›lds
[
$id
]è? $f›lds[$id] : 
NULL
;

1941 
	}
}

1949 
funùiÚ
 
	$£t_™em
(
$di¥Ïy_id
, 
$ty³
, 
$id
, 
$™em
) {

1951 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

1953 
$this
->
	`£t_di¥Ïy
(
$di¥Ïy_id
);

1956 
$f›lds
 = 
$this
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
->
	`g‘_İtiÚ
(
$ty³s
[
$ty³
]['plural']);

1957 ià(
	`is£t
(
$™em
)) {

1958 
$f›lds
[
$id
] = 
$™em
;

1961 
	`un£t
(
$f›lds
[
$id
]);

1965 
$this
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
->
	`£t_İtiÚ
(
$ty³s
[
$ty³
]['¶u¿l'], 
$f›lds
);

1966 
	}
}

1975 
funùiÚ
 
	$£t_™em_İtiÚ
(
$di¥Ïy_id
, 
$ty³
, 
$id
, 
$İtiÚ
, 
$v®ue
) {

1976 
$™em
 = 
$this
->
	`g‘_™em
(
$di¥Ïy_id
, 
$ty³
, 
$id
);

1977 
$™em
[
$İtiÚ
] = 
$v®ue
;

1978 
$this
->
	`£t_™em
(
$di¥Ïy_id
, 
$ty³
, 
$id
, 
$™em
);

1979 
	}
}

1988 şas 
	cv›ws_di¥Ïy
 
ex‹nds
 
	mv›ws_db_objeù
 {

1989 
v¬
 
	m$db_bË
 = 'views_display';

1990 
funùiÚ
 
	$v›ws_di¥Ïy
(
$š™
 = 
TRUE
) {

1991 
·»Á
::
	`š™
(
$š™
);

1994 
funùiÚ
 
	$İtiÚs
(
$ty³
, 
$id
, 
$t™Ë
) {

1995 
$this
->
di¥Ïy_¶ugš
 = 
$ty³
;

1996 
$this
->
id
 = 
$id
;

1997 
$this
->
di¥Ïy_t™Ë
 = 
$t™Ë
;

1998 
	}
}

2005 
funùiÚ
 
	$v›ws_objeù_ty³s
() {

2006 
$»tv®
 = 
NULL
;

2009 ià(!
	`is£t
(
$»tv®
)) {

2010 
$»tv®
 = 
	`¬¿y
(

2011 'f›ld' => 
	`¬¿y
(

2012 't™Ë' => 
	`t
('Fields'),

2013 'É™Ë' => 
	`t
('fields'),

2014 '¡™Ë' => 
	`t
('Field'),

2015 'l¡™Ë' => 
	`t
('field'),

2018 '¬gum’t' => 
	`¬¿y
(

2019 't™Ë' => 
	`t
('Arguments'),

2020 'É™Ë' => 
	`t
('arguments'),

2021 '¡™Ë' => 
	`t
('Argument'),

2022 'l¡™Ë' => 
	`t
('Argument'),

2025 'sÜt' => 
	`¬¿y
(

2026 't™Ë' => 
	`t
('Sort criteria'),

2027 'É™Ë' => 
	`t
('sort criteria'),

2028 '¡™Ë' => 
	`t
('Sort criterion'),

2029 'l¡™Ë' => 
	`t
('sort criterion'),

2032 'f‹r' => 
	`¬¿y
(

2033 't™Ë' => 
	`t
('Filters'),

2034 'É™Ë' => 
	`t
('filters'),

2035 '¡™Ë' => 
	`t
('Filter'),

2036 'l¡™Ë' => 
	`t
('filter'),

2040 '»ÏtiÚsh' => 
	`¬¿y
(

2041 't™Ë' => 
	`t
('Relationships'),

2042 'É™Ë' => 
	`t
('relationships'),

2043 '¡™Ë' => 
	`t
('Relationship'),

2044 'l¡™Ë' => 
	`t
('Relationship'),

2050  
$»tv®
;

2051 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator.views.inc

1 <?
php


20 
funùiÚ
 
	$agg»g©Ü_v›ws_d©a
() {

26 
$d©a
['agg»g©Ü_™em']['bË']['group'] = 
	`t
('Aggregator');

29 
$d©a
['agg»g©Ü_™em']['bË']['ba£'] = 
	`¬¿y
(

31 't™Ë' => 
	`t
('Aggregator item'),

32 'h–p' => 
	`t
("Aggregator items‡re imported fromƒxternal RSS‡nd Atom‚ews feeds."),

39 
$d©a
['agg»g©Ü_™em']['t™Ë'] = 
	`¬¿y
(

40 't™Ë' => 
	`t
('Title'),

41 'h–p' => 
	`t
('Theitle ofhe‡ggregator item.'),

43 'f›ld' => 
	`¬¿y
(

45 'exŒa' => 
	`¬¿y
('link'),

46 'şick sÜbË' => 
TRUE
,

48 'sÜt' => 
	`¬¿y
(

52 'f‹r' => 
	`¬¿y
(

58 
$d©a
['agg»g©Ü_™em']['lšk'] = 
	`¬¿y
(

59 't™Ë' => 
	`t
('Link'),

60 'h–p' => 
	`t
('The†inkohe original source URL ofhe item.'),

61 'f›ld' => 
	`¬¿y
(

63 'şick sÜbË' => 
TRUE
,

65 'sÜt' => 
	`¬¿y
(

69 'f‹r' => 
	`¬¿y
(

75 
$d©a
['agg»g©Ü_™em']['authÜ'] = 
	`¬¿y
(

76 't™Ë' => 
	`t
('Author'),

77 'h–p' => 
	`t
('The‡uthor ofhe original imported item.'),

79 'f›ld' => 
	`¬¿y
(

81 'şick sÜbË' => 
TRUE
,

83 'sÜt' => 
	`¬¿y
(

87 'f‹r' => 
	`¬¿y
(

90 '¬gum’t' => 
	`¬¿y
(

96 
$d©a
['agg»g©Ü_™em']['desütiÚ'] = 
	`¬¿y
(

97 't™Ë' => 
	`t
('Body'),

98 'h–p' => 
	`t
('The‡ctual content ofhe imported item.'),

100 'f›ld' => 
	`¬¿y
(

102 'şick sÜbË' => 
FALSE
,

105 'f‹r' => 
	`¬¿y
(

111 
$d©a
['agg»g©Ü_™em']['time¡amp'] = 
	`¬¿y
(

112 't™Ë' => 
	`t
('Timestamp'),

113 'h–p' => 
	`t
('The datehe original feed item was…osted. (With some feeds,his will behe date it was imported.)'),

115 'f›ld' => 
	`¬¿y
(

117 'şick sÜbË' => 
TRUE
,

119 'sÜt' => 
	`¬¿y
(

123 'f‹r' => 
	`¬¿y
(

126 '¬gum’t' => 
	`¬¿y
(

135 
$d©a
['agg»g©Ü_ãed']['bË']['group'] = 
	`t
('Aggregator feed');

138 
$d©a
['agg»g©Ü_ãed']['bË']['još'] = 
	`¬¿y
(

139 'agg»g©Ü_™em' => 
	`¬¿y
(

146 
$d©a
['agg»g©Ü_ãed']['fid'] = 
	`¬¿y
(

147 't™Ë' => 
	`t
('Feed ID'),

148 'h–p' => 
	`t
('The unique ID ofhe‡ggregator feed.'),

150 'f›ld' => 
	`¬¿y
(

152 'şick sÜbË' => 
TRUE
,

155 '¬gum’t' => 
	`¬¿y
(

158 'num”ic' => 
TRUE
,

161 'f‹r' => 
	`¬¿y
(

165 'sÜt' => 
	`¬¿y
(

171 
$d©a
['agg»g©Ü_ãed']['t™Ë'] = 
	`¬¿y
(

172 't™Ë' => 
	`t
('Title'),

173 'h–p' => 
	`t
('Theitle ofhe‡ggregator feed.'),

175 'f›ld' => 
	`¬¿y
(

177 'exŒa' => 
	`¬¿y
('link'),

178 'şick sÜbË' => 
TRUE
,

180 'sÜt' => 
	`¬¿y
(

184 'f‹r' => 
	`¬¿y
(

190 
$d©a
['agg»g©Ü_ãed']['lšk'] = 
	`¬¿y
(

191 't™Ë' => 
	`t
('Link'),

192 'h–p' => 
	`t
('The†inkohe source URL ofhe feed.'),

194 'f›ld' => 
	`¬¿y
(

196 'şick sÜbË' => 
TRUE
,

198 'sÜt' => 
	`¬¿y
(

202 'f‹r' => 
	`¬¿y
(

208 
$d©a
['agg»g©Ü_ãed']['checked'] = 
	`¬¿y
(

209 't™Ë' => 
	`t
('Last checked'),

210 'h–p' => 
	`t
('The datehe feed was†ast checked for‚ew content.'),

212 'f›ld' => 
	`¬¿y
(

214 'şick sÜbË' => 
TRUE
,

216 'sÜt' => 
	`¬¿y
(

220 'f‹r' => 
	`¬¿y
(

223 '¬gum’t' => 
	`¬¿y
(

229 
$d©a
['agg»g©Ü_ãed']['desütiÚ'] = 
	`¬¿y
(

230 't™Ë' => 
	`t
('Description'),

231 'h–p' => 
	`t
('The description ofhe‡ggregator feed.'),

233 'f›ld' => 
	`¬¿y
(

235 'şick sÜbË' => 
FALSE
,

238 'f‹r' => 
	`¬¿y
(

244 
$d©a
['agg»g©Ü_ãed']['modif›d'] = 
	`¬¿y
(

245 't™Ë' => 
	`t
('Last modified'),

246 'h–p' => 
	`t
('The date ofhe most„ecent‚ew content onfhe feed.'),

248 'f›ld' => 
	`¬¿y
(

250 'şick sÜbË' => 
TRUE
,

252 'sÜt' => 
	`¬¿y
(

256 'f‹r' => 
	`¬¿y
(

259 '¬gum’t' => 
	`¬¿y
(

267 
$d©a
['agg»g©Ü_ÿ‹gÜy_ãed']['bË']['još'] = 
	`¬¿y
(

268 'agg»g©Ü_™em' => 
	`¬¿y
(

277 
$d©a
['agg»g©Ü_ÿ‹gÜy']['bË']['group'] = 
	`t
('Aggregator category');

279 
$d©a
['agg»g©Ü_ÿ‹gÜy']['bË']['još'] = 
	`¬¿y
(

280 'agg»g©Ü_™em' => 
	`¬¿y
(

288 
$d©a
['agg»g©Ü_ÿ‹gÜy']['cid'] = 
	`¬¿y
(

289 't™Ë' => 
	`t
('Category ID'),

290 'h–p' => 
	`t
('The unique ID ofhe‡ggregator category.'),

291 'f›ld' => 
	`¬¿y
(

293 'şick sÜbË' => 
TRUE
,

295 '¬gum’t' => 
	`¬¿y
(

298 'num”ic' => 
TRUE
,

300 'f‹r' => 
	`¬¿y
(

303 'sÜt' => 
	`¬¿y
(

309 
$d©a
['agg»g©Ü_ÿ‹gÜy']['t™Ë'] = 
	`¬¿y
(

310 't™Ë' => 
	`t
('Category'),

311 'h–p' => 
	`t
('Theitle ofhe‡ggregator category.'),

312 'f›ld' => 
	`¬¿y
(

314 'şick sÜbË' => 
TRUE
,

316 'sÜt' => 
	`¬¿y
(

319 'f‹r' => 
	`¬¿y
(

324  
$d©a
;

325 
	}
}

331 
funùiÚ
 
	$agg»g©Ü_v›ws_hªdËrs
() {

332  
	`¬¿y
(

333 'šfo' => 
	`¬¿y
(

334 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/aggregator',

336 'hªdËrs' => 
	`¬¿y
(

338 'v›ws_hªdËr_f›ld_agg»g©Ü_t™Ë_lšk' => 
	`¬¿y
(

341 'v›ws_hªdËr_f›ld_agg»g©Ü_ÿ‹gÜy' => 
	`¬¿y
(

344 'v›ws_hªdËr_f›ld_agg»g©Ü_™em_desütiÚ' => 
	`¬¿y
(

349 'v›ws_hªdËr_¬gum’t_agg»g©Ü_fid' => 
	`¬¿y
(

352 'v›ws_hªdËr_¬gum’t_agg»g©Ü_ÿ‹gÜy_cid' => 
	`¬¿y
(

357 'v›ws_hªdËr_f‹r_agg»g©Ü_ÿ‹gÜy_cid' => 
	`¬¿y
(

362 
	}
}

368 
funùiÚ
 
	$agg»g©Ü_v›ws_¶ugšs
() {

369  
	`¬¿y
(

371 'row' => 
	`¬¿y
(

372 'agg»g©Ü_rss' => 
	`¬¿y
(

373 't™Ë' => 
	`t
('Aggregator item'),

374 'h–p' => 
	`t
('Displayhe‡ggregator item usinghe data fromhe original source.'),

376 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/aggregator',

378 'ba£' => 
	`¬¿y
('aggregator_item'),

379 'u£ İtiÚs' => 
TRUE
,

385 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_handler_argument_aggregator_category_cid.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_¬gum’t_agg»g©Ü_ÿ‹gÜy_cid
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_num”ic
 {

11 
funùiÚ
 
	$t™Ë_qu”y
() {

12 
$t™Ës
 = 
	`¬¿y
();

13 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$this
->
v®ue
), '%d'));

15 
$»suÉ
 = 
	`db_qu”y
("SELECT c.t™Ë FROM {agg»g©Ü_ÿ‹gÜy} c WHERE c.cid IN ($¶aûhŞd”s)", 
$this
->
v®ue
);

16 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

17 
$t™Ës
[] = 
	`check_¶aš
(
$‹rm
->
t™Ë
);

19  
$t™Ës
;

21 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_handler_argument_aggregator_fid.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_¬gum’t_agg»g©Ü_fid
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_num”ic
 {

11 
funùiÚ
 
	$t™Ë_qu”y
() {

12 
$t™Ës
 = 
	`¬¿y
();

13 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$this
->
v®ue
), '%d'));

15 
$»suÉ
 = 
	`db_qu”y
("SELECT f.t™Ë FROM {agg»g©Ü_ãed} f WHERE f.fid IN ($¶aûhŞd”s)", 
$this
->
v®ue
);

16 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

17 
$t™Ës
[] = 
	`check_¶aš
(
$‹rm
->
t™Ë
);

19  
$t™Ës
;

21 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_handler_field_aggregator_category.inc

1 <?
php


8 şas 
	cv›ws_hªdËr_f›ld_agg»g©Ü_ÿ‹gÜy
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

12 
funùiÚ
 
	$cÚ¡ruù
() {

13 
·»Á
::
	`cÚ¡ruù
();

14 
$this
->
add™iÚ®_f›lds
['cid'] = 'cid';

17 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

18 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

19 
$İtiÚs
['lšk_to_ÿ‹gÜy'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

20  
$İtiÚs
;

21 
	}
}

26 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

27 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

28 
$fÜm
['lšk_to_ÿ‹gÜy'] = 
	`¬¿y
(

29 '#t™Ë' => 
	`t
('Linkhis fieldo its‡ggregator category…age'),

30 '#desütiÚ' => 
	`t
('This will override‡ny other†ink you have set.'),

32 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['link_to_category']),

34 
	}
}

41 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ues
) {

42 ià(!
	`em±y
(
$this
->
İtiÚs
['lšk_to_ÿ‹gÜy']è&& !em±y(
$v®ues
->{$this->
®Ÿ£s
['cid']}è&& 
$d©a
 !=ğ
NULL
 && $data !== '') {

43 
$cid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['cid']};

44 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
TRUE
;

45 
$this
->
İtiÚs
['alter']['path'] = "aggregator/category/$cid";

47  
$d©a
;

48 
	}
}

50 
funùiÚ
 
	$»nd”
(
$v®ues
) {

51  
$this
->
	`»nd”_lšk
(
	`check_¶aš
(
$v®ues
->{$this->
f›ld_®Ÿs
}), $values);

52 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_handler_field_aggregator_item_description.inc

1 <?
php


8 şas 
	cv›ws_hªdËr_f›ld_agg»g©Ü_™em_desütiÚ
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_xss
 {

9 
funùiÚ
 
	$»nd”
(
$v®ues
) {

10 
$v®ue
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

11  
	`agg»g©Ü_f‹r_xss
(
$v®ue
);

13 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_handler_field_aggregator_title_link.inc

1 <?
php


8 şas 
	cv›ws_hªdËr_f›ld_agg»g©Ü_t™Ë_lšk
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

9 
funùiÚ
 
	$cÚ¡ruù
() {

10 
·»Á
::
	`cÚ¡ruù
();

11 
$this
->
add™iÚ®_f›lds
['link'] = 'link';

14 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

15 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

17 
$İtiÚs
['di¥Ïy_as_lšk'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

19  
$İtiÚs
;

20 
	}
}

25 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

26 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

27 
$fÜm
['di¥Ïy_as_lšk'] = 
	`¬¿y
(

28 '#t™Ë' => 
	`t
('Display‡s†ink'),

30 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['display_as_link']),

32 
	}
}

34 
funùiÚ
 
	$»nd”
(
$v®ues
) {

35 
$v®ue
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

36 
$lšk
 = 
$v®ues
->{
$this
->
bË_®Ÿs
 . '_link'};

37 ià(!
	`em±y
(
$this
->
İtiÚs
['display_as_link'])) {

38  
	`l
(
	`check_¶aš
(
$v®ue
), 
$lšk
, 
	`¬¿y
('html' => 
TRUE
));

41  
	`check_¶aš
(
$v®ue
);

43 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_handler_filter_aggregator_category_cid.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_agg»g©Ü_ÿ‹gÜy_cid
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_š_İ”©Ü
 {

8 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

9 ià(
	`is£t
(
$this
->
v®ue_İtiÚs
)) {

13 
$this
->
v®ue_İtiÚs
 = 
	`¬¿y
();

15 
$»suÉ
 = 
	`db_qu”y
('SELECT * FROM {aggregator_category} ORDER BYitle');

16 
$ÿ‹gÜy
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

17 
$this
->
v®ue_İtiÚs
[
$ÿ‹gÜy
->
cid
] = $ÿ‹gÜy->
t™Ë
;

20 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_plugin_row_aggregator_rss.inc

1 <?
php


11 şas 
	cv›ws_¶ugš_row_agg»g©Ü_rss
 
ex‹nds
 
	mv›ws_¶ugš_row
 {

12 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

13 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

15 
$İtiÚs
['™em_Ëngth'] = 
	`¬¿y
('default' => 'default');

17  
$İtiÚs
;

20 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

21 
$fÜm
['™em_Ëngth'] = 
	`¬¿y
(

23 '#t™Ë' => 
	`t
('Displayype'),

24 '#İtiÚs' => 
	`¬¿y
(

25 'fuÎ‹xt' => 
	`t
('Fullext'),

26 '‹a£r' => 
	`t
('Title…luseaser'),

27 't™Ë' => 
	`t
('Title only'),

28 'deçuÉ' => 
	`t
('Use default RSS settings'),

30 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['item_length'],

32 
	}
}

34 
funùiÚ
 
	$»nd”
(
$row
) {

35 
$sql
 = "SELECT‡i.iid,‡i.fid,‡i.title,‡i.link,‡i.author,‡i.description, ";

36 
$sql
 .= "ai.timestamp,‡i.guid,‡f.title AS feed_title,‡i.link AS feed_LINK ";

37 
$sql
 .= "FROM {aggregator_item}‡i LEFT JOIN {aggregator_feed}‡f ON‡i.fid =‡f.fid ";

38 
$sql
 .= "WHERE‡i.iid = %d";

40 
$™em
 = 
	`db_ãtch_objeù
(
	`db_qu”y
(
$sql
, 
$row
->
iid
));

42 
$™em
->
–em’ts
 = 
	`¬¿y
(

43 
	`¬¿y
('key' => 'pubD©e', 'v®ue' => 
	`gmd©e
('r', 
$™em
->
time¡amp
)),

44 
	`¬¿y
(

46 'v®ue' => 
$™em
->
authÜ
,

47 'Çme¥aû' => 
	`¬¿y
('xmlns:dc' => 'http://purl.org/dc/elements/1.1/'),

49 
	`¬¿y
(

51 'v®ue' => 
$™em
->
guid
,

52 '©Œibu‹s' => 
	`¬¿y
('isPermaLink' => 'false')

56 
	`fÜ—ch
 (
$™em
->
–em’ts
 
as
 
$–em’t
) {

57 ià(
	`is£t
(
$–em’t
['namespace'])) {

58 
$this
->
v›w
->
¡yË_¶ugš
->
Çme¥aûs
 = 
	`¬¿y_m”ge
($this->v›w->¡yË_¶ugš->Çme¥aûs, 
$–em’t
['namespace']);

62  
	`theme
(
$this
->
	`theme_funùiÚs
(), $this->
v›w
, $this->
İtiÚs
, 
$™em
);

63 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/book.views.inc

1 <?
php


17 
funùiÚ
 
	$book_v›ws_d©a
() {

21 
$d©a
['book']['bË']['group'] = 
	`t
('Book');

22 
$d©a
['book']['bË']['još'] = 
	`¬¿y
(

23 'node' => 
	`¬¿y
(

29 
$d©a
['book']['bid'] = 
	`¬¿y
(

30 't™Ë' => 
	`t
('Top†evel book'),

31 'h–p' => 
	`t
('The bookhe‚ode is in.'),

32 '»ÏtiÚsh' => 
	`¬¿y
(

35 'Ïb–' => 
	`t
('Book'),

45 
$d©a
['book_m’u_lšks']['bË']['group'] = 
	`t
('Book');

46 
$d©a
['book_m’u_lšks']['bË']['još'] = 
	`¬¿y
(

47 'node' => 
	`¬¿y
(

55 
$d©a
['book_m’u_lšks']['weight'] = 
	`¬¿y
(

56 't™Ë' => 
	`t
('Weight'),

57 'h–p' => 
	`t
('The weight ofhe book…age.'),

58 'f›ld' => 
	`¬¿y
(

60 'şick sÜbË' => 
TRUE
,

62 'sÜt' => 
	`¬¿y
(

67 
$d©a
['book_m’u_lšks']['d•th'] = 
	`¬¿y
(

68 't™Ë' => 
	`t
('Depth'),

69 'h–p' => 
	`t
('The depth ofhe book…age inhe hierarchy;op†evel books have‡ depth of 1.'),

70 'f›ld' => 
	`¬¿y
(

72 'şick sÜbË' => 
TRUE
,

74 'sÜt' => 
	`¬¿y
(

77 'f‹r' => 
	`¬¿y
(

80 '¬gum’t' => 
	`¬¿y
(

85 
$d©a
['book_m’u_lšks']['p'] = 
	`¬¿y
(

86 't™Ë' => 
	`t
('Hierarchy'),

87 'h–p' => 
	`t
('The order of…ages inhe book hierarchy.'),

88 'sÜt' => 
	`¬¿y
(

98 
$d©a
['book_·»Á']['bË']['group'] = 
	`t
('Book');

99 
$d©a
['book_·»Á']['bË']['još'] = 
	`¬¿y
(

100 'node' => 
	`¬¿y
(

108 
$d©a
['book_·»Á']['nid'] = 
	`¬¿y
(

109 't™Ë' => 
	`t
('Parent'),

110 'h–p' => 
	`t
('The…arent book‚ode.'),

111 '»ÏtiÚsh' => 
	`¬¿y
(

115 'Ïb–' => 
	`t
('Book…arent'),

119  
$d©a
;

120 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/book.views_convert.inc

1 <?
php


12 
funùiÚ
 
	$book_v›ws_cÚv”t
(
$di¥Ïy
, 
$ty³
, &
$v›w
, 
$f›ld
, 
$id
 = 
NULL
) {

13 
$ty³
) {

15 
$f›ld
['tablename']) {

17 
$f›ld
['field']) {

19 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f›ld', 
$id
);

20 ià(
$f›ld
['handler'] == 'views_handler_field_book_parent_title') {

21 
$™em
['lšk_to_node'] = 
TRUE
;

23 
$™em
['»ÏtiÚsh'] = 
$v›w
->
	`add_™em
(
$di¥Ïy
, '»ÏtiÚsh', 'book_·»Á', 'nid', 
	`¬¿y
(), 'book_parent_nid');

24 
$™em
['table'] = 'node';

25 
$™em
['field'] = 'title';

26 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f›ld', 
$id
, 
$™em
);

33 
$f›ld
['tablename']) {

35 
$f›ld
['field']) {

37 
$İ”©Üs
 = 
	`¬¿y
('AND' => '=', 'OR' => '=', 'NOT' => '!=');

38 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f‹r', 
$id
);

39 
$™em
['İ”©Ü'] = 
$İ”©Üs
[
$f›ld
['operator']];

40 
$™em
['»ÏtiÚsh'] = 
$v›w
->
	`add_™em
(
$di¥Ïy
, '»ÏtiÚsh', 'book_·»Á', 'nid', 
	`¬¿y
(), 'book_parent_nid');

41 
$™em
['table'] = 'node';

42 
$™em
['field'] = 'nid';

43 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f‹r', 
$id
, 
$™em
);

50 
$f›ld
['tablename']) {

52 
$f›ld
['field']) {

54 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'sÜt', 
$id
, 'table', 'book_menu_links');

59 
$f›ld
['field']) {

61 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'sÜt', 
$id
);

62 
$™em
['»ÏtiÚsh'] = 
$v›w
->
	`add_™em
(
$di¥Ïy
, '»ÏtiÚsh', 'book_·»Á', 'nid', 
	`¬¿y
(), 'book_parent_nid');

63 
$™em
['table'] = 'node';

64 
$™em
['field'] = 'title';

65 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'sÜt', 
$id
, 
$™em
);

72 
$İtiÚs
 = 
$f›ld
['argoptions'];

73 
$f›ld
['type']) {

75 
$İtiÚs
['»ÏtiÚsh'] = 
$v›w
->
	`add_™em
(
$di¥Ïy
, '»ÏtiÚsh', 'book_·»Á', 'nid', 
	`¬¿y
(), 'book_parent_nid');

76 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'node', 'nid', 
$İtiÚs
, 
$f›ld
['id']);

81 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment.views.inc

1 <?
php


19 
funùiÚ
 
	$comm’t_v›ws_d©a
() {

22 
$d©a
['comm’ts']['bË']['group'] = 
	`t
('Comment');

24 
$d©a
['comm’ts']['bË']['ba£'] = 
	`¬¿y
(

26 't™Ë' => 
	`t
('Comment'),

27 'h–p' => 
	`t
("Comments‡re„esponseso‚ode content."),

31 
$d©a
['comm’ts']['bË']['još'] = 
	`¬¿y
(

33 'node' => 
	`¬¿y
(

43 
$d©a
['comm’ts']['subjeù'] = 
	`¬¿y
(

44 't™Ë' => 
	`t
('Title'),

45 'h–p' => 
	`t
('Theitle ofhe comment.'),

46 'f›ld' => 
	`¬¿y
(

48 'şick sÜbË' => 
TRUE
,

50 'f‹r' => 
	`¬¿y
(

53 'sÜt' => 
	`¬¿y
(

56 '¬gum’t' => 
	`¬¿y
(

62 
$d©a
['comm’ts']['comm’t'] = 
	`¬¿y
(

63 't™Ë' => 
	`t
('Body'),

64 'h–p' => 
	`t
('Theext ofhe comment.'),

65 'f›ld' => 
	`¬¿y
(

69 'f‹r' => 
	`¬¿y
(

75 
$d©a
['comm’ts']['cid'] = 
	`¬¿y
(

76 't™Ë' => 
	`t
('ID'),

77 'h–p' => 
	`t
('The comment ID ofhe field'),

78 'f›ld' => 
	`¬¿y
(

80 'şick sÜbË' => 
TRUE
,

82 'f‹r' => 
	`¬¿y
(

85 'sÜt' => 
	`¬¿y
(

88 '¬gum’t' => 
	`¬¿y
(

94 
$d©a
['comm’ts']['Çme'] = 
	`¬¿y
(

95 't™Ë' => 
	`t
('Author'),

96 'h–p' => 
	`t
("The‚ame ofhe comment's‡uthor. Can be„endered‡s‡†inkohe‡uthor's homepage."),

97 'f›ld' => 
	`¬¿y
(

99 'şick sÜbË' => 
TRUE
,

101 'f‹r' => 
	`¬¿y
(

104 'sÜt' => 
	`¬¿y
(

107 '¬gum’t' => 
	`¬¿y
(

113 
$d©a
['comm’ts']['hom•age'] = 
	`¬¿y
(

114 't™Ë' => 
	`t
("Author's website"),

115 'h–p' => 
	`t
("The website‡ddress ofhe comment's‡uthor. Can be„endered‡s‡†ink. Will beƒmpty ifhe‡uthor is‡„egistered user."),

116 'f›ld' => 
	`¬¿y
(

118 'şick sÜbË' => 
TRUE
,

120 'f‹r' => 
	`¬¿y
(

123 'sÜt' => 
	`¬¿y
(

126 '¬gum’t' => 
	`¬¿y
(

132 
$d©a
['comm’ts']['ho¡Çme'] = 
	`¬¿y
(

133 't™Ë' => 
	`t
('Hostname'),

134 'h–p' => 
	`t
('Hostname of userhat…ostedhe comment.'),

135 'f›ld' => 
	`¬¿y
(

137 'şick sÜbË' => 
TRUE
,

139 'f‹r' => 
	`¬¿y
(

142 'sÜt' => 
	`¬¿y
(

145 '¬gum’t' => 
	`¬¿y
(

151 
$d©a
['comm’ts']['ma'] = 
	`¬¿y
(

152 't™Ë' => 
	`t
('Mail'),

153 'h–p' => 
	`t
('Email of userhat…ostedhe comment. Will beƒmpty ifhe‡uthor is‡„egistered user.'),

154 'f›ld' => 
	`¬¿y
(

156 'şick sÜbË' => 
TRUE
,

158 'f‹r' => 
	`¬¿y
(

161 'sÜt' => 
	`¬¿y
(

164 '¬gum’t' => 
	`¬¿y
(

170 
$d©a
['comm’ts']['time¡amp'] = 
	`¬¿y
(

171 't™Ë' => 
	`t
('Post date'),

172 'h–p' => 
	`t
('Date‡ndime of whenhe comment was…osted.'),

173 'f›ld' => 
	`¬¿y
(

175 'şick sÜbË' => 
TRUE
,

177 'sÜt' => 
	`¬¿y
(

180 'f‹r' => 
	`¬¿y
(

186 
$d©a
['comm’ts']['¡©us'] = 
	`¬¿y
(

187 't™Ë' => 
	`t
('In moderation'),

188 'h–p' => 
	`t
('Whether or‚othe comment is currently in moderation.'),

189 'f›ld' => 
	`¬¿y
(

191 'şick sÜbË' => 
TRUE
,

193 'f‹r' => 
	`¬¿y
(

195 'Ïb–' => 
	`t
('Moderated'),

198 'sÜt' => 
	`¬¿y
(

204 
$d©a
['comm’ts']['v›w_comm’t'] = 
	`¬¿y
(

205 'f›ld' => 
	`¬¿y
(

206 't™Ë' => 
	`t
('View†ink'),

207 'h–p' => 
	`t
('Provide‡ simple†inko viewhe comment.'),

213 
$d©a
['comm’ts']['ed™_comm’t'] = 
	`¬¿y
(

214 'f›ld' => 
	`¬¿y
(

215 't™Ë' => 
	`t
('Edit†ink'),

216 'h–p' => 
	`t
('Provide‡ simple†inkoƒdithe comment.'),

222 
$d©a
['comm’ts']['d–‘e_comm’t'] = 
	`¬¿y
(

223 'f›ld' => 
	`¬¿y
(

224 't™Ë' => 
	`t
('Delete†ink'),

225 'h–p' => 
	`t
('Provide‡ simple†inko deletehe comment.'),

231 
$d©a
['comm’ts']['»¶yto_comm’t'] = 
	`¬¿y
(

232 'f›ld' => 
	`¬¿y
(

233 't™Ë' => 
	`t
('Reply-to†ink'),

234 'h–p' => 
	`t
('Provide‡ simple†inko„eplyohe comment.'),

239 
$d©a
['comm’ts']['th»ad'] = 
	`¬¿y
(

240 'f›ld' => 
	`¬¿y
(

241 't™Ë' => 
	`t
('Depth'),

242 'h–p' => 
	`t
('Displayhe depth ofhe comment if it ishreaded.'),

245 'sÜt' => 
	`¬¿y
(

246 't™Ë' => 
	`t
('Thread'),

247 'h–p' => 
	`t
('Sort byhehreaded order. This will keep child commentsogether withheir…arents.'),

252 
$d©a
['comm’ts']['nid'] = 
	`¬¿y
(

253 't™Ë' => 
	`t
('Node'),

254 'h–p' => 
	`t
('The‚odehe comment is‡„eplyo.'),

255 '»ÏtiÚsh' => 
	`¬¿y
(

259 'Ïb–' => 
	`t
('Node'),

263 
$d©a
['comm’ts']['uid'] = 
	`¬¿y
(

264 't™Ë' => 
	`t
('User'),

265 'h–p' => 
	`t
("The User ID ofhe comment's‡uthor."),

266 '»ÏtiÚsh' => 
	`¬¿y
(

270 'Ïb–' => 
	`t
('User'),

274 
$d©a
['comm’ts']['pid'] = 
	`¬¿y
(

275 't™Ë' => 
	`t
('Parent CID'),

276 'h–p' => 
	`t
('The Comment ID ofhe…arent comment.'),

277 'f›ld' => 
	`¬¿y
(

280 '»ÏtiÚsh' => 
	`¬¿y
(

281 't™Ë' => 
	`t
('Parent comment'),

282 'h–p' => 
	`t
('The…arent comment.'),

286 'Ïb–' => 
	`t
('Parent comment'),

294 
$d©a
['node_comm’t_¡©i¡ics']['bË']['group'] = 
	`t
('Node');

297 
$d©a
['node_comm’t_¡©i¡ics']['bË']['još'] = 
	`¬¿y
(

299 'node' => 
	`¬¿y
(

307 
$d©a
['node_comm’t_¡©i¡ics']['Ï¡_comm’t_time¡amp'] = 
	`¬¿y
(

308 't™Ë' => 
	`t
('Last commentime'),

309 'h–p' => 
	`t
('Date‡ndime of whenhe†ast comment was…osted.'),

310 'f›ld' => 
	`¬¿y
(

312 'şick sÜbË' => 
TRUE
,

314 'sÜt' => 
	`¬¿y
(

317 'f‹r' => 
	`¬¿y
(

323 
$d©a
['node_comm’t_¡©i¡ics']['Ï¡_comm’t_Çme'] = 
	`¬¿y
(

324 't™Ë' => 
	`t
("Last comment‡uthor"),

325 'h–p' => 
	`t
('The‚ame ofhe‡uthor ofhe†ast…osted comment.'),

326 'f›ld' => 
	`¬¿y
(

328 'şick sÜbË' => 
TRUE
,

330 'sÜt' => 
	`¬¿y
(

336 
$d©a
['node_comm’t_¡©i¡ics']['comm’t_couÁ'] = 
	`¬¿y
(

337 't™Ë' => 
	`t
('Comment count'),

338 'h–p' => 
	`t
('The‚umber of comments‡‚ode has.'),

339 'f›ld' => 
	`¬¿y
(

341 'şick sÜbË' => 
TRUE
,

343 'f‹r' => 
	`¬¿y
(

346 'sÜt' => 
	`¬¿y
(

349 '¬gum’t' => 
	`¬¿y
(

355 
$d©a
['node_comm’t_¡©i¡ics']['Ï¡_upd©ed'] = 
	`¬¿y
(

356 't™Ë' => 
	`t
('Updated/commented date'),

357 'h–p' => 
	`t
('The most„ecent of†ast comment…osted or‚ode updatedime.'),

358 'f›ld' => 
	`¬¿y
(

360 'şick sÜbË' => 
TRUE
,

362 'sÜt' => 
	`¬¿y
(

365 'f‹r' => 
	`¬¿y
(

370  
$d©a
;

371 
	}
}

377 
funùiÚ
 
	$comm’t_v›ws_d©a_®‹r
(&
$d©a
) {

379 
$d©a
['node']['Ãw_comm’ts'] = 
	`¬¿y
(

380 't™Ë' => 
	`t
('New comments'),

381 'h–p' => 
	`t
('The‚umber of‚ew comments onhe‚ode.'),

382 'f›ld' => 
	`¬¿y
(

387 
$d©a
['node']['comm’ts_lšk'] = 
	`¬¿y
(

388 'f›ld' => 
	`¬¿y
(

389 't™Ë' => 
	`t
('Add comment†ink'),

390 'h–p' => 
	`t
('Displayhe standard‡dd comment†ink used on„egular‚odes, which will only display ifhe viewing user has‡ccesso‡dd‡ comment.'),

396 
$d©a
['node']['comm’t'] = 
	`¬¿y
(

397 't™Ë' => 
	`t
('Comment status'),

398 'h–p' => 
	`t
('Whether comments‡reƒnabled or disabled onhe‚ode.'),

399 'f›ld' => 
	`¬¿y
(

401 'şick sÜbË' => 
TRUE
,

403 'sÜt' => 
	`¬¿y
(

406 'f‹r' => 
	`¬¿y
(

411 
$d©a
['node']['uid_touch'] = 
	`¬¿y
(

412 't™Ë' => 
	`t
('User…osted or commented'),

413 'h–p' => 
	`t
('Display‚odes only if‡ user…ostedhe‚ode or commented onhe‚ode.'),

414 '¬gum’t' => 
	`¬¿y
(

420 'f‹r' => 
	`¬¿y
(

428 
	}
}

433 
funùiÚ
 
	$comm’t_v›ws_¶ugšs
() {

434  
	`¬¿y
(

436 'row' => 
	`¬¿y
(

437 'comm’t' => 
	`¬¿y
(

438 't™Ë' => 
	`t
('Comment'),

439 'h–p' => 
	`t
('Displayhe comment with standard comment view.'),

441 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/comment',

443 'ba£' => 
	`¬¿y
('comments'),

444 'u£ İtiÚs' => 
TRUE
,

448 'comm’t_rss' => 
	`¬¿y
(

449 't™Ë' => 
	`t
('Comment'),

450 'h–p' => 
	`t
('Displayhe comment‡s RSS.'),

452 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/comment',

454 'ba£' => 
	`¬¿y
('comments'),

460 
	}
}

466 
funùiÚ
 
	$comm’t_v›ws_hªdËrs
() {

467  
	`¬¿y
(

468 'šfo' => 
	`¬¿y
(

469 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/comment',

471 'hªdËrs' => 
	`¬¿y
(

472 'v›ws_hªdËr_f›ld_comm’t' => 
	`¬¿y
(

475 'v›ws_hªdËr_f›ld_comm’t_u£ºame' => 
	`¬¿y
(

478 'v›ws_hªdËr_f›ld_comm’t_d•th' => 
	`¬¿y
(

481 'v›ws_hªdËr_f›ld_comm’t_lšk' => 
	`¬¿y
(

484 'v›ws_hªdËr_f›ld_comm’t_lšk_ed™' => 
	`¬¿y
(

487 'v›ws_hªdËr_f›ld_comm’t_lšk_d–‘e' => 
	`¬¿y
(

490 'v›ws_hªdËr_f›ld_comm’t_lšk_»¶y' => 
	`¬¿y
(

493 'v›ws_hªdËr_f›ld_comm’t_node_lšk' => 
	`¬¿y
(

496 'v›ws_hªdËr_f›ld_ncs_Ï¡_comm’t_Çme' => 
	`¬¿y
(

499 'v›ws_hªdËr_f›ld_ncs_Ï¡_upd©ed' => 
	`¬¿y
(

502 'v›ws_hªdËr_f›ld_node_Ãw_comm’ts' => 
	`¬¿y
(

505 'v›ws_hªdËr_f›ld_node_comm’t' => 
	`¬¿y
(

510 'v›ws_hªdËr_sÜt_comm’t_th»ad' => 
	`¬¿y
(

513 'v›ws_hªdËr_sÜt_ncs_Ï¡_comm’t_Çme' => 
	`¬¿y
(

516 'v›ws_hªdËr_sÜt_ncs_Ï¡_upd©ed' => 
	`¬¿y
(

521 'v›ws_hªdËr_f‹r_ncs_Ï¡_upd©ed' => 
	`¬¿y
(

524 'v›ws_hªdËr_f‹r_node_comm’t' => 
	`¬¿y
(

527 'v›ws_hªdËr_f‹r_comm’t_u£r_uid' => 
	`¬¿y
(

532 'v›ws_hªdËr_¬gum’t_comm’t_u£r_uid' => 
	`¬¿y
(

537 
	}
}

542 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_row_comm’t
(&
$v¬s
) {

543 
$İtiÚs
 = 
$v¬s
['options'];

544 
$v›w
 = &
$v¬s
['view'];

545 
$¶ugš
 = &
$v›w
->
¡yË_¶ugš
->
row_¶ugš
;

546 
$comm’t
 = 
$¶ugš
->
comm’ts
[
$v¬s
['row']->
cid
];

547 
$node
 = 
	`node_lßd
(
$comm’t
->
nid
);

549 
$node
->
v›w
 = &
$v›w
;

551 
$lšks
 = 
	`¬¿y
();

552 ià(!
	`em±y
(
$İtiÚs
['links'])) {

553 
$lšks
 = 
	`moduË_švoke_®l
('lšk', 'comm’t', 
$comm’t
, 0);

554 
	`dru·l_®‹r
('lšk', 
$lšks
, 
$node
);

557 
$v¬s
['comm’t'] = 
	`theme
('comm’t_v›w', 
$comm’t
, 
$node
, 
$lšks
);

558 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment.views_convert.inc

1 <?
php


16 
funùiÚ
 
	$comm’t_v›ws_cÚv”t
(
$di¥Ïy
, 
$ty³
, &
$v›w
, 
$f›ld
, 
$id
 = 
NULL
) {

17 
$ty³
) {

19 
$f›ld
['tablename']) {

21 
$f›ld
['field']) {

23 ià(
$f›ld
['options'] = 'nolink') {

24 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'lšk_to_comm’t', 
FALSE
);

28 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'lšk_to_comm’t', 
FALSE
);

31 
$hªdËrs
 = 
	`¬¿y
(

38 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'd©e_fÜm©', 
$hªdËrs
[
$f›ld
['handler']]);

39 ià(!
	`em±y
(
$f›ld
['options'])) {

40 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'cu¡om_d©e_fÜm©', 
$f›ld
['options']);

44 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'field', 'replyto_comment');

49 
$f›ld
['field']) {

51 
$hªdËrs
 = 
	`¬¿y
(

58 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'd©e_fÜm©', 
$hªdËrs
[
$f›ld
['handler']]);

59 ià(!
	`em±y
(
$f›ld
['options'])) {

60 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'cu¡om_d©e_fÜm©', 
$f›ld
['options']);

64 
$hªdËrs
 = 
	`¬¿y
(

71 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f›ld', 
$id
);

72 
$™em
['d©e_fÜm©'] = 
$hªdËrs
[
$f›ld
['handler']];

73 ià(!
	`em±y
(
$f›ld
['options'])) {

74 
$™em
['cu¡om_d©e_fÜm©'] = 
$f›ld
['options'];

76 
$™em
['field'] = 'last_updated';

77 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f›ld', 
$id
, 
$™em
);

84 
$f›ld
['tablename']) {

86 
$f›ld
['field']) {

88 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'İ”©Ü', 
$f›ld
['operator']);

91 
$f›ld
['field'] = 'last_updated';

93 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f‹r', 
$id
);

94 
$™em
['İ”©Ü'] = 
$f›ld
['operator'];

95 
$™em
['v®ue'] = 
	`¬¿y
(

96 'ty³' => 
$f›ld
['value'] == 'now' ? 'offset' : 'date',

97 'v®ue' => 
$f›ld
['value'],

99 ià(!
	`em±y
(
$f›ld
['options'])) {

100 
$™em
['v®ue']['v®ue'] = 
	`štv®
(
$f›ld
['options']) .' seconds';

102 
$™em
['f›ld'] = 
$f›ld
['field'];

103 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f‹r', 
$id
, 
$™em
);

110 
$f›ld
['tablename']) {

112 
$f›ld
['field']) {

114 
$f›ld
['options'] = $field['options'] == 'normal' ? 'second' : $field['options'];

115 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'sÜt', 
$id
, 'g¿nuÏr™y', 
$f›ld
['options']);

120 
$f›ld
['field']) {

122 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'sÜt', 
$id
, 'field', 'last_updated');

124 
$f›ld
['options'] = $field['options'] == 'normal' ? 'second' : $field['options'];

125 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'sÜt', 
$id
, 'g¿nuÏr™y', 
$f›ld
['options']);

132 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment.views_default.inc

1 <?
php


11 
funùiÚ
 
	$comm’t_v›ws_deçuÉ_v›ws
() {

12 
$v›w
 = 
Ãw
 
v›w
;

13 
$v›w
->
Çme
 = 'comments_recent';

14 
$v›w
->
desütiÚ
 = 'Contains‡ block‡nd‡…ageo†ist„ecent comments;he block will‡utomatically†inkohe…age, which displayshe comment body‡s well‡s‡†inkohe‚ode.';

15 
$v›w
->
g
 = 'default';

16 
$v›w
->
v›w_php
 = '';

17 
$v›w
->
ba£_bË
 = 'comments';

18 
$v›w
->
is_ÿch—bË
 = '0';

19 
$v›w
->
­i_v”siÚ
 = 2;

20 
$v›w
->
di§bËd
 = 
TRUE
;

21 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('default', 'Defaults', 'default');

22 
$hªdËr
->
	`ov”ride_İtiÚ
('»ÏtiÚshs', 
	`¬¿y
(

23 'nid' => 
	`¬¿y
(

28 '»quœed' => 
FALSE
,

31 
$hªdËr
->
	`ov”ride_İtiÚ
('f›lds', 
	`¬¿y
(

32 'subjeù' => 
	`¬¿y
(

40 'time¡amp' => 
	`¬¿y
(

50 
$hªdËr
->
	`ov”ride_İtiÚ
('sÜts', 
	`¬¿y
(

51 'time¡amp' => 
	`¬¿y
(

60 
$hªdËr
->
	`ov”ride_İtiÚ
('f‹rs', 
	`¬¿y
(

61 '¡©us_exŒa' => 
	`¬¿y
(

68 'expo£d' => 
FALSE
,

69 'expo£' => 
	`¬¿y
(

70 'İ”©Ü' => 
FALSE
,

76 
$hªdËr
->
	`ov”ride_İtiÚ
('acûss', 
	`¬¿y
(

78 'rŞe' => 
	`¬¿y
(),

81 
$hªdËr
->
	`ov”ride_İtiÚ
('title', 'Recent comments');

82 
$hªdËr
->
	`ov”ride_İtiÚ
('items_per_page', 5);

83 
$hªdËr
->
	`ov”ride_İtiÚ
('use_more', 1);

84 
$hªdËr
->
	`ov”ride_İtiÚ
('style_plugin', 'list');

85 
$hªdËr
->
	`ov”ride_İtiÚ
('¡yË_İtiÚs', 
	`¬¿y
(

88 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('page', 'Page', 'page');

89 
$hªdËr
->
	`ov”ride_İtiÚ
('f›lds', 
	`¬¿y
(

90 't™Ë' => 
	`¬¿y
(

98 'time¡amp' => 
	`¬¿y
(

107 'subjeù' => 
	`¬¿y
(

115 'comm’t' => 
	`¬¿y
(

123 
$hªdËr
->
	`ov”ride_İtiÚ
('items_per_page', 25);

124 
$hªdËr
->
	`ov”ride_İtiÚ
('use_pager', '1');

125 
$hªdËr
->
	`ov”ride_İtiÚ
('row_İtiÚs', 
	`¬¿y
(

126 'šlše' => 
	`¬¿y
(

132 
$hªdËr
->
	`ov”ride_İtiÚ
('path', 'comments/recent');

133 
$hªdËr
->
	`ov”ride_İtiÚ
('m’u', 
	`¬¿y
(

138 
$hªdËr
->
	`ov”ride_İtiÚ
('b_İtiÚs', 
	`¬¿y
(

143 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('block', 'Block', 'block');

144 
$hªdËr
->
	`ov”ride_İtiÚ
('block_description', 'Recent comments view');

145 
$v›ws
[
$v›w
->
Çme
] = $view;

147 
$v›w
 = 
Ãw
 
v›w
;

148 
$v›w
->
Çme
 = 'tracker';

149 
$v›w
->
desütiÚ
 = 'Shows‡ll‚ew‡ctivity on system.';

150 
$v›w
->
g
 = 'default';

151 
$v›w
->
v›w_php
 = '';

152 
$v›w
->
ba£_bË
 = 'node';

153 
$v›w
->
is_ÿch—bË
 = '0';

154 
$v›w
->
­i_v”siÚ
 = 2;

155 
$v›w
->
di§bËd
 = 
TRUE
;

156 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('default', 'Defaults', 'default');

157 
$hªdËr
->
	`ov”ride_İtiÚ
('f›lds', 
	`¬¿y
(

158 'ty³' => 
	`¬¿y
(

164 't™Ë' => 
	`¬¿y
(

169 'lšk_to_node' => 
TRUE
,

171 'Çme' => 
	`¬¿y
(

176 'lšk_to_u£r' => 
TRUE
,

178 'comm’t_couÁ' => 
	`¬¿y
(

183 '£t_´ecisiÚ' => 
FALSE
,

190 'Ï¡_comm’t_time¡amp' => 
	`¬¿y
(

198 'time¡amp' => 
	`¬¿y
(

208 'Ãw_comm’ts' => 
	`¬¿y
(

213 '£t_´ecisiÚ' => 
FALSE
,

224 
$hªdËr
->
	`ov”ride_İtiÚ
('sÜts', 
	`¬¿y
(

225 'Ï¡_comm’t_time¡amp' => 
	`¬¿y
(

233 
$hªdËr
->
	`ov”ride_İtiÚ
('¬gum’ts', 
	`¬¿y
(

234 'uid_touch' => 
	`¬¿y
(

240 '¡yË_İtiÚs' => 
	`¬¿y
(

241 'couÁ' => 
TRUE
,

242 'ov”ride' => 
FALSE
,

255 'v®id©e_¬gum’t_node_ty³' => 
	`¬¿y
(

266 
$hªdËr
->
	`ov”ride_İtiÚ
('f‹rs', 
	`¬¿y
(

267 '¡©us' => 
	`¬¿y
(

274 'expo£d' => 
FALSE
,

275 'expo£' => 
	`¬¿y
(

276 'İ”©Ü' => 
FALSE
,

279 '¡©us' => 
	`¬¿y
(

286 'expo£d' => 
FALSE
,

287 'expo£' => 
	`¬¿y
(

288 'İ”©Ü' => 
FALSE
,

295 
$hªdËr
->
	`ov”ride_İtiÚ
('acûss', 
	`¬¿y
(

297 'rŞe' => 
	`¬¿y
(),

300 
$hªdËr
->
	`ov”ride_İtiÚ
('title', 'Recent…osts');

301 
$hªdËr
->
	`ov”ride_İtiÚ
('items_per_page', '25');

302 
$hªdËr
->
	`ov”ride_İtiÚ
('u£_·g”', 
TRUE
);

303 
$hªdËr
->
	`ov”ride_İtiÚ
('style_plugin', 'table');

304 
$hªdËr
->
	`ov”ride_İtiÚ
('¡yË_İtiÚs', 
	`¬¿y
(

307 'cŞumns' => 
	`¬¿y
(

316 'šfo' => 
	`¬¿y
(

317 'ty³' => 
	`¬¿y
(

321 't™Ë' => 
	`¬¿y
(

325 'Çme' => 
	`¬¿y
(

329 'comm’t_couÁ' => 
	`¬¿y
(

333 'Ï¡_comm’t_time¡amp' => 
	`¬¿y
(

337 'time¡amp' => 
	`¬¿y
(

340 'Ãw_comm’ts' => 
	`¬¿y
(

346 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('page', 'Page', 'page');

347 
$hªdËr
->
	`ov”ride_İtiÚ
('path', 'tracker');

348 
$hªdËr
->
	`ov”ride_İtiÚ
('m’u', 
	`¬¿y
(

353 
$hªdËr
->
	`ov”ride_İtiÚ
('b_İtiÚs', 
	`¬¿y
(

355 't™Ë' => 
NULL
,

356 'weight' => 
NULL
,

358 
$v›ws
[
$v›w
->
Çme
] = $view;

360  
$v›ws
;

361 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_argument_comment_user_uid.inc

1 <?
php


8 şas 
	cv›ws_hªdËr_¬gum’t_comm’t_u£r_uid
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

9 
funùiÚ
 
	$t™Ë
() {

10 ià(!
$this
->
¬gum’t
) {

11 
$t™Ë
 = 
	`v¬ŸbË_g‘
('ªÚymous', 
	`t
('Anonymous'));

14 
$t™Ë
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT u.ÇmFROM {u£rs} u WHERE u.uid = %d", 
$this
->
¬gum’t
));

16 ià(
	`em±y
(
$t™Ë
)) {

17  
	`t
('No user');

20  
	`check_¶aš
(
$t™Ë
);

23 
funùiÚ
 
	$deçuÉ_aùiÚs
(
$which
 = 
NULL
) {

25 ià(!
$which
) {

26 
$aùiÚs
 = 
·»Á
::
	`deçuÉ_aùiÚs
();

27 
	`un£t
(
$aùiÚs
['summary‡sc']);

28 
	`un£t
(
$aùiÚs
['summary desc']);

29  
$aùiÚs
;

32 ià(
$which
 != 'summary‡sc' && $which != 'summary desc') {

33  
·»Á
::
	`deçuÉ_aùiÚs
(
$which
);

35 
	}
}

37 
funùiÚ
 
	$qu”y
() {

38 
$this
->
	`’su»_my_bË
();

39 
$this
->
qu”y
->
	`add_wh”e
(0, "$this->bË_®Ÿs.uid = %d OR ((SELECT COUNT(*èFROM {comm’ts} c WHERE c.uid = %d AND c.nid = $this->bË_®Ÿs.nidè> 0)", $this->
¬gum’t
, $this->argument);

40 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_comm’t
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

10 
funùiÚ
 
	$š™
(&
$v›w
, &
$İtiÚs
) {

11 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

12 ià(!
	`em±y
(
$this
->
İtiÚs
['link_to_comment'])) {

13 
$this
->
add™iÚ®_f›lds
['cid'] = 'cid';

14 
$this
->
add™iÚ®_f›lds
['nid'] = 'nid';

18 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

19 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

20 
$İtiÚs
['lšk_to_comm’t'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

21  
$İtiÚs
;

22 
	}
}

27 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

28 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

29 
$fÜm
['lšk_to_comm’t'] = 
	`¬¿y
(

30 '#t™Ë' => 
	`t
('Linkhis fieldo its comment'),

31 '#desütiÚ' => 
	`t
('This will override‡ny other†ink you have set.'),

33 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['link_to_comment'],

35 
	}
}

37 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ues
) {

38 ià(!
	`em±y
(
$this
->
İtiÚs
['lšk_to_comm’t']è&& 
$d©a
 !=ğ
NULL
 && $data !== '') {

39 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
TRUE
;

40 
$this
->
İtiÚs
['®‹r']['·th'] = "node/". 
$v®ues
->{$this->
®Ÿ£s
['nid']};

41 
$this
->
İtiÚs
['®‹r']['äagm’t'] = "comm’t-" . 
$v®ues
->{$this->
®Ÿ£s
['cid']};

44  
$d©a
;

45 
	}
}

47 
funùiÚ
 
	$»nd”
(
$v®ues
) {

48  
$this
->
	`»nd”_lšk
(
	`check_¶aš
(
$v®ues
->{$this->
f›ld_®Ÿs
}), $values);

49 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_depth.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_comm’t_d•th
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

10 
funùiÚ
 
	$»nd”
(
$v®ues
) {

11  
	`couÁ
(
	`ex¶ode
('.', 
$v®ues
->
comm’ts_th»ad
)) - 1;

13 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_link.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_comm’t_lšk
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

9 
$this
->
add™iÚ®_f›lds
['cid'] = 'cid';

10 
$this
->
add™iÚ®_f›lds
['nid'] = 'nid';

13 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

14 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

15 
$İtiÚs
['‹xt'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

16  
$İtiÚs
;

17 
	}
}

19 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

20 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

21 
$fÜm
['‹xt'] = 
	`¬¿y
(

23 '#t™Ë' => 
	`t
('Texto display'),

24 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['text'],

26 
	}
}

28 
funùiÚ
 
	$qu”y
() {

29 
$this
->
	`’su»_my_bË
();

30 
$this
->
	`add_add™iÚ®_f›lds
();

31 
	}
}

33 
funùiÚ
 
	$»nd”
(
$v®ues
) {

34 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('view');

35  
	`l
(
$‹xt
, "node/" . 
$v®ues
->{
$this
->
®Ÿ£s
['nid']}, 
	`¬¿y
('html' => 
TRUE
, 'fragment' => "comment-" . $values->{$this->aliases['cid']}));

36 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_link_delete.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_comm’t_lšk_d–‘e
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_comm’t_lšk
 {

7 
funùiÚ
 
	$»nd”
(
$v®ues
) {

9 ià(!
	`u£r_acûss
('administer comments')) {

12 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('delete');

13  
	`l
(
$‹xt
, "comm’t/d–‘e/" . 
$v®ues
->{
$this
->
®Ÿ£s
['cid']}, 
	`¬¿y
('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
()));

15 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_link_edit.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_comm’t_lšk_ed™
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_comm’t_lšk
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

9 
$this
->
add™iÚ®_f›lds
['uid'] = 'uid';

12 
funùiÚ
 
	$»nd”
(
$v®ues
) {

14 
$comm’t
 = 
Ãw
 
	`¡dCÏss
();

15 
$comm’t
->
cid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['cid']};

16 
$comm’t
->
uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

17 ià(!
	`comm’t_acûss
('ed™', 
$comm’t
)) {

21 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('edit');

22  
	`l
(
$‹xt
, "comm’t/ed™/" . 
$v®ues
->{
$this
->
®Ÿ£s
['cid']});

23 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_link_reply.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_comm’t_lšk_»¶y
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_comm’t_lšk
 {

8 
funùiÚ
 
	$»nd”
(
$v®ues
) {

10 ià(!
	`u£r_acûss
('post comments')) {

13 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('reply');

14  
	`l
(
$‹xt
, "comm’t/»¶y/" . 
$v®ues
->{
$this
->
®Ÿ£s
['nid']} . '/' . $values->{$this->aliases['cid']});

16 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_node_link.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_comm’t_node_lšk
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

11 
$this
->
add™iÚ®_f›lds
['nid'] = 
	`¬¿y
(

14 
$this
->
add™iÚ®_f›lds
['ty³'] = 
	`¬¿y
(

17 
$this
->
add™iÚ®_f›lds
['comm’t'] = 
	`¬¿y
(

22 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

23 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

24 
$İtiÚs
['‹a£r'] = 
	`¬¿y
('default' => 0);

25  
$İtiÚs
;

26 
	}
}

28 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

29 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

31 
$fÜm
['‹a£r'] = 
	`¬¿y
(

33 '#t™Ë' => 
	`t
('Showeaser-style†ink'),

34 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['teaser'],

38 
	}
}

40 
funùiÚ
 
	$qu”y
() {

41 
$this
->
	`’su»_my_bË
();

42 
$this
->
	`add_add™iÚ®_f›lds
();

43 
	}
}

45 
funùiÚ
 
	$»nd”
(
$v®ues
) {

47 
$node
 = 
Ãw
 
	`¡dCÏss
();

48 
$node
->
nid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['nid']};

49 
$node
->
ty³
 = 
$v®ues
->{
$this
->
®Ÿ£s
['type']};

50 
$node
->
comm’t
 = 
$v®ues
->{
$this
->
®Ÿ£s
['comment']};

53 
$lšks
 = 
	`comm’t_lšk
('node', 
$node
, 
$this
->
İtiÚs
['teaser']);

57  !
	`em±y
(
$lšks
è? 
	`theme
('lšks', $lšks, 
	`¬¿y
('class' => 'links inline')) : '';

58 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_username.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_comm’t_u£ºame
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

10 
funùiÚ
 
	$š™
(&
$v›w
, &
$d©a
) {

11 
·»Á
::
	`š™
(
$v›w
, 
$d©a
);

12 
$this
->
add™iÚ®_f›lds
['uid'] = 'uid';

13 
$this
->
add™iÚ®_f›lds
['homepage'] = 'homepage';

16 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

17 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

18 
$İtiÚs
['lšk_to_u£r'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

19  
$İtiÚs
;

20 
	}
}

22 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

23 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

24 
$fÜm
['lšk_to_u£r'] = 
	`¬¿y
(

25 '#t™Ë' => 
	`t
("Linkhis fieldo its user or‡n‡uthor's homepage"),

27 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['link_to_user'],

29 
	}
}

31 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ues
) {

32 ià(!
	`em±y
(
$this
->
İtiÚs
['link_to_user'])) {

33 
$accouÁ
->
uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

34 
$accouÁ
->
Çme
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

35 
$accouÁ
->
hom•age
 = 
$v®ues
->{
$this
->
®Ÿ£s
['homepage']};

37  
	`theme
('u£ºame', 
$accouÁ
);

40  
$d©a
;

42 
	}
}

44 
funùiÚ
 
	$»nd”
(
$v®ues
) {

45  
$this
->
	`»nd”_lšk
(
	`check_¶aš
(
$v®ues
->{$this->
f›ld_®Ÿs
}), $values);

46 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_ncs_last_comment_name.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_ncs_Ï¡_comm’t_Çme
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

8 
funùiÚ
 
	$qu”y
() {

11 
$this
->
	`’su»_my_bË
();

13 
$još
 = 
Ãw
 
	`v›ws_još
();

14 
$još
->
	`cÚ¡ruù
('u£rs', 
$this
->
bË_®Ÿs
, 'last_comment_uid', 'uid');

15 
$još
->
exŒa
 = 
	`¬¿y
(array('field' => 'uid', 'operator' => '!=', 'value' => '0'));

19 
$this
->
u£r_bË
 = $this->
qu”y
->
	`’su»_bË
('ncs_u£rs', $this->
»ÏtiÚsh
, 
$još
);

21 
$this
->
f›ld_®Ÿs
 = $this->
qu”y
->
	`add_f›ld
(
NULL
, "COALESCE($this->u£r_bË.Çme, $this->bË_®Ÿs.$this->f›ld)", $this->
bË_®Ÿs
 . '_' . $this->
f›ld
);

23 
$this
->
u£r_f›ld
 = $this->
qu”y
->
	`add_f›ld
($this->
u£r_bË
, 'name');

24 
$this
->
uid
 = $this->
qu”y
->
	`add_f›ld
($this->
bË_®Ÿs
, 'last_comment_uid');

27 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

28 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

30 
$İtiÚs
['lšk_to_u£r'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

32  
$İtiÚs
;

33 
	}
}

35 
funùiÚ
 
	$»nd”
(
$v®ues
) {

36 ià(!
	`em±y
(
$this
->
İtiÚs
['link_to_user'])) {

37 
$accouÁ
 = 
Ãw
 
	`¡dCÏss
();

38 
$accouÁ
->
Çme
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

39 
$accouÁ
->
uid
 = 
$v®ues
->{
$this
->uid};

40  
	`theme
('u£ºame', 
$accouÁ
);

43  
	`check_¶aš
(
$v®ues
->{
$this
->
f›ld_®Ÿs
});

45 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_ncs_last_updated.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_ncs_Ï¡_upd©ed
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_d©e
 {

7 
funùiÚ
 
	$qu”y
() {

8 
$this
->
	`’su»_my_bË
();

9 
$this
->
node_bË
 = $this->
qu”y
->
	`’su»_bË
('node', $this->
»ÏtiÚsh
);

10 
$this
->
f›ld_®Ÿs
 = $this->
qu”y
->
	`add_f›ld
(
NULL
, "GREATEST(" . $this->
node_bË
 . ".chªged, " . $this->
bË_®Ÿs
 . ".Ï¡_comm’t_time¡amp)", $this->bË_®Ÿ . '_' . $this->
f›ld
);

12 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_node_comment.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_node_comm’t
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

8 
funùiÚ
 
	$»nd”
(
$v®ues
) {

9 
$v®ues
->{
$this
->
f›ld_®Ÿs
}) {

10 
COMMENT_NODE_DISABLED
:

12  
	`t
('Disabled');

13 
COMMENT_NODE_READ_ONLY
:

14  
	`t
('Read only');

15 
COMMENT_NODE_READ_WRITE
:

16  
	`t
('Read/Write');

19 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_node_new_comments.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_node_Ãw_comm’ts
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_num”ic
 {

8 
funùiÚ
 
	$š™
(&
$v›w
, 
$İtiÚs
) {

9 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

12 ià(!
	`em±y
(
$İtiÚs
['no_empty'])) {

13 
$this
->
İtiÚs
['hide_em±y'] = 
TRUE
;

14 
	`un£t
(
$this
->
İtiÚs
['no_empty']);

18 
funùiÚ
 
	$cÚ¡ruù
() {

19 
·»Á
::
	`cÚ¡ruù
();

20 
$this
->
add™iÚ®_f›lds
 = 
	`¬¿y
('nid' => 'nid', 'type' => 'type');

21 
	}
}

23 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

24 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

26 
$İtiÚs
['lšk_to_comm’t'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

28  
$İtiÚs
;

29 
	}
}

31 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

32 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

33 
$fÜm
['lšk_to_comm’t'] = 
	`¬¿y
(

34 '#t™Ë' => 
	`t
('Linkhis fieldo‚ew comments'),

35 '#desütiÚ' => 
	`t
('This will override‡ny other†ink you have set.'),

37 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['link_to_comment'],

39 
	}
}

41 
funùiÚ
 
	$qu”y
() {

42 
$this
->
	`’su»_my_bË
();

43 
$this
->
	`add_add™iÚ®_f›lds
();

44 
$this
->
f›ld_®Ÿs
 = $this->
bË
 . '_' . $this->
f›ld
;

45 
	}
}

47 
funùiÚ
 
	$´e_»nd”
(&
$v®ues
) {

48 
glob®
 
$u£r
;

49 ià(!
$u£r
->
uid
 || 
	`em±y
(
$v®ues
)) {

53 
$nids
 = 
	`¬¿y
();

54 
$ids
 = 
	`¬¿y
();

55 
	`fÜ—ch
 (
$v®ues
 
as
 
$id
 => 
$»suÉ
) {

56 
$nids
[] = 
$»suÉ
->{
$this
->
®Ÿ£s
['nid']};

57 
$v®ues
[
$id
]->{
$this
->
f›ld_®Ÿs
} = 0;

59 ià(
	`em±y
(
$ids
[
$»suÉ
->{
$this
->
®Ÿ£s
['nid']}])) {

60 
$ids
[
$»suÉ
->{
$this
->
®Ÿ£s
['nid']}] = 
	`¬¿y
();

62 
$ids
[
$»suÉ
->{
$this
->
®Ÿ£s
['nid']}][] = 
$id
;

65 ià(
$nids
) {

66 
$»suÉ
 = 
	`db_qu”y
("SELECT‚.nid, COUNT(c.cidèa num_comm’t FROM {node}‚ INNER JOIN {comm’ts} c ON‚.nid = c.nid LEFT JOIN {hi¡Üy} h ON h.nid =‚.nid AND h.uid = %d WHERE‚.nid IN (" . 
	`im¶ode
(', ', 
$nids
è. "èAND c.time¡am°> GREATEST(COALESCE(h.time¡amp, %d), %dèAND c.¡©u ğ%d GROUP BY‚.nid ", 
$u£r
->
uid
, 
NODE_NEW_LIMIT
, NODE_NEW_LIMIT, 
COMMENT_PUBLISHED
);

68 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

69 
	`fÜ—ch
 (
$ids
[
$node
->
nid
] 
as
 
$id
) {

70 
$v®ues
[
$id
]->{
$this
->
f›ld_®Ÿs
} = 
$node
->
num_comm’ts
;

75 
	}
}

77 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ues
) {

78 ià(!
	`em±y
(
$this
->
İtiÚs
['lšk_to_comm’t']è&& 
$d©a
 !=ğ
NULL
 && $data !== '') {

79 
$node
 = 
Ãw
 
	`¡dCÏss
();

80 
$node
->
nid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['nid']};

81 
$node
->
ty³
 = 
$v®ues
->{
$this
->
®Ÿ£s
['type']};

82 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
TRUE
;

83 
$this
->
İtiÚs
['®‹r']['·th'] = 'node/' . 
$node
->
nid
;

84 
$this
->
İtiÚs
['®‹r']['qu”y'] = 
	`comm’t_Ãw_·ge_couÁ
(
$v®ues
->
node_comm’t_¡©i¡ics_comm’t_couÁ
, $v®ues->
node_Ãw_comm’ts
, 
$node
);

85 
$this
->
İtiÚs
['alter']['fragment'] = 'new';

88  
$d©a
;

89 
	}
}

91 
funùiÚ
 
	$»nd”
(
$v®ues
) {

92 ià(!
	`em±y
(
$v®ues
->{
$this
->
f›ld_®Ÿs
})) {

93  
$this
->
	`»nd”_lšk
(
·»Á
::
	`»nd”
(
$v®ues
), $values);

96 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
FALSE
;

98 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_filter_comment_user_uid.inc

1 <?
php


8 şas 
	cv›ws_hªdËr_f‹r_comm’t_u£r_uid
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_u£r_Çme
 {

9 
funùiÚ
 
	$qu”y
() {

10 
$this
->
	`’su»_my_bË
();

11 
$»¶aû
 = 
	`¬¿y_fl
(0, (
$this
->
v®ue
), '%d');

12 
$cÚd™iÚ
 = 
$this
->
İ”©Ü
 . ' (' . 
	`im¶ode
(", ", 
$»¶aû
) . ')';

16 
$¬gs
 = 
	`¬¿y_v®ues
(
$this
->
v®ue
);

17 
$¬gs
 = 
	`¬¿y_m”ge
($args, $args);

19 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$this->bË_®Ÿs.uid " . 
$cÚd™iÚ
 . " OR

20 ((
SELECT
 
	`COUNT
(*è
FROM
 {
comm’ts
} 
c
 
WHERE
 c.
uid
 " . $cÚd™iÚ . " 
AND
 c.
nid
 = 
$this
->
bË_®Ÿs
.nid) > 0)",

21 
$¬gs
);

23 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_filter_ncs_last_updated.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f‹r_ncs_Ï¡_upd©ed
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_d©e
 {

7 
funùiÚ
 
	$qu”y
() {

8 
$this
->
	`’su»_my_bË
();

9 
$this
->
node_bË
 = $this->
qu”y
->
	`’su»_bË
('node', $this->
»ÏtiÚsh
);

11 
$f›ld
 = "GREATEST(" . 
$this
->
node_bË
 . ".chªged, " . $this->
bË_®Ÿs
 . ".last_comment_timestamp)";

13 
$šfo
 = 
$this
->
	`İ”©Üs
();

14 ià(!
	`em±y
(
$šfo
[
$this
->
İ”©Ü
]['method'])) {

15 
$this
->{
$šfo
[$this->
İ”©Ü
]['m‘hod']}(
$f›ld
);

18 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_filter_node_comment.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_node_comm’t
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_š_İ”©Ü
 {

8 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

9 
$this
->
v®ue_İtiÚs
 = 
	`¬¿y
(

10 
COMMENT_NODE_DISABLED
 => 
	`t
('Disabled'),

11 
COMMENT_NODE_READ_ONLY
 => 
	`t
('Read only'),

12 
COMMENT_NODE_READ_WRITE
 => 
	`t
('Read/Write'),

15 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_sort_comment_thread.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_sÜt_comm’t_th»ad
 
ex‹nds
 
	mv›ws_hªdËr_sÜt
 {

7 
funùiÚ
 
	$qu”y
() {

8 
$this
->
	`’su»_my_bË
();

12 ià(
$this
->
İtiÚs
['order'] == 'DESC') {

13 
$this
->
qu”y
->
	`add_Üd”by
($this->
bË_®Ÿs
, $this->
»®_f›ld
, $this->
İtiÚs
['order']);

16 
$®Ÿs
 = 
$this
->
bË_®Ÿs
 . '_' . $this->
»®_f›ld
 . 'asc';

18 
$this
->
qu”y
->
	`add_Üd”by
(
NULL
, "SUBSTRING({$this->bË_®Ÿs}.{$this->»®_f›ld}, 1, (LENGTH({$this->bË_®Ÿs}.{$this->»®_f›ld}è- 1))", $this->
İtiÚs
['Üd”'], 
$®Ÿs
);

21 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_sort_ncs_last_comment_name.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_sÜt_ncs_Ï¡_comm’t_Çme
 
ex‹nds
 
	mv›ws_hªdËr_sÜt
 {

8 
funùiÚ
 
	$qu”y
() {

9 
$this
->
	`’su»_my_bË
();

10 
$još
 = 
Ãw
 
	`v›ws_još
();

11 
$još
->
	`cÚ¡ruù
('u£rs', 
$this
->
bË_®Ÿs
, 'last_comment_uid', 'uid');

17 
$this
->
u£r_bË
 = $this->
qu”y
->
	`’su»_bË
('ncs_u£rs', $this->
»ÏtiÚsh
, 
$još
);

18 
$this
->
u£r_f›ld
 = $this->
qu”y
->
	`add_f›ld
($this->
u£r_bË
, 'name');

21 
$this
->
qu”y
->
	`add_Üd”by
(
NULL
, "LOWER(COALESCE($this->u£r_bË.Çme, $this->bË_®Ÿs.$this->f›ld))", $this->
İtiÚs
['Üd”'], $this->
bË_®Ÿs
 . '_' . $this->
f›ld
);

23 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_sort_ncs_last_updated.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_sÜt_ncs_Ï¡_upd©ed
 
ex‹nds
 
	mv›ws_hªdËr_sÜt_d©e
 {

7 
funùiÚ
 
	$qu”y
() {

8 
$this
->
	`’su»_my_bË
();

9 
$this
->
node_bË
 = $this->
qu”y
->
	`’su»_bË
('node', $this->
»ÏtiÚsh
);

10 
$this
->
f›ld_®Ÿs
 = $this->
qu”y
->
	`add_Üd”by
(
NULL
, "GREATEST(" . $this->
node_bË
 . ".chªged, " . $this->
bË_®Ÿs
 . ".Ï¡_comm’t_time¡amp)", $this->
İtiÚs
['Üd”'], $this->bË_®Ÿ . '_' . $this->
f›ld
);

12 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_plugin_row_comment_rss.inc

1 <?
php


11 şas 
	cv›ws_¶ugš_row_comm’t_rss
 
ex‹nds
 
	mv›ws_¶ugš_row
 {

13 
funùiÚ
 
	$»nd”
(
$row
) {

14 
glob®
 
$ba£_u¾
;

17 
$comm’t
 = 
	`_comm’t_lßd
(
$row
->
cid
);

19 
$™em
 = 
Ãw
 
	`¡dCÏss
();

20 
$™em
->
t™Ë
 = 
$comm’t
->
subjeù
;

21 
$™em
->
lšk
 = 
	`u¾
('node/' . 
$comm’t
->
nid
, 
	`¬¿y
('absŞu‹' => 
TRUE
, 'äagm’t' => 'comm’t-' . $comm’t->
cid
));

22 
$™em
->
desütiÚ
 = 
	`check_m¬kup
(
$comm’t
->
comm’t
, $comm’t->
fÜm©
, 
FALSE
);

23 
$™em
->
–em’ts
 = 
	`¬¿y
(

24 
	`¬¿y
('key' => 'pubD©e', 'v®ue' => 
	`gmd©e
('r', 
$comm’t
->
time¡amp
)),

25 
	`¬¿y
('key' => 'dc:ü—tÜ', 'v®ue' => 
$comm’t
->
Çme
),

26 
	`¬¿y
(

28 'v®ue' => 'comm’ˆ' . 
$row
->
cid
 . '‡ˆ' . 
$ba£_u¾
,

29 '©Œibu‹s' => 
	`¬¿y
('isPermaLink' => 'false'),

30 'Çme¥aû' => 
	`¬¿y
('xmlns:dc' => 'http://purl.org/dc/elements/1.1/'),

34 
	`fÜ—ch
 (
$™em
->
–em’ts
 
as
 
$–em’t
) {

35 ià(
	`is£t
(
$–em’t
['namespace'])) {

36 
$this
->
v›w
->
¡yË_¶ugš
->
Çme¥aûs
 = 
	`¬¿y_m”ge
($this->v›w->¡yË_¶ugš->Çme¥aûs, 
$–em’t
['namespace']);

40  
	`theme
(
$this
->
	`theme_funùiÚs
(), $this->
v›w
, $this->
İtiÚs
, 
$™em
);

42 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_plugin_row_comment_view.inc

1 <?
php


11 şas 
	cv›ws_¶ugš_row_comm’t_v›w
 
ex‹nds
 
	mv›ws_¶ugš_row
 {

12 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

13 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

14 
$İtiÚs
['lšks'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

15  
$İtiÚs
;

18 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

19 
$fÜm
['lšks'] = 
	`¬¿y
(

21 '#t™Ë' => 
	`t
('Display†inks'),

22 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['links'],

24 
	}
}

26 
funùiÚ
 
	$´e_»nd”
(
$»suÉ
) {

27 
$cids
 = 
	`¬¿y
();

28 
$this
->
comm’ts
 = 
	`¬¿y
();

30 
	`fÜ—ch
 (
$»suÉ
 
as
 
$row
) {

31 
$cids
[] = 
$row
->
cid
;

34 ià(
	`couÁ
(
$cids
) > 1) {

35 
$¶aûhŞd”
 = " IN (" . 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$cids
), '%d')) . ")";

38 
$¶aûhŞd”
 = " = %d";

41 
$üesuÉ
 = 
	`db_qu”y
("SELECT c.cid‡ cid, c.pid, c.nid, c.subjeù, c.comm’t, c.fÜm©, c.time¡amp, c.Çme, c.ma, c.hom•age, u.uid, u.ÇmAS„egi¡”ed_Çme, u.sigÇtu», u.piùu», u.d©a, c.th»ad, c.¡©u FROM {comm’ts} c INNER JOIN {u£rs} u ON c.uid = u.uid WHERE c.cid $¶aûhŞd”", 
$cids
);

42 
$comm’t
 = 
	`db_ãtch_objeù
(
$üesuÉ
)) {

43 
$comm’t
 = 
	`dru·l_uÅack
($comment);

44 
$comm’t
->
Çme
 = $comm’t->
uid
 ? $comm’t->
»gi¡”ed_Çme
 : $comment->name;

45 
$comm’t
->
d•th
 = 
	`couÁ
(
	`ex¶ode
('.', $comm’t->
th»ad
)) - 1;

46 
$this
->
comm’ts
[
$comm’t
->
cid
] = $comment;

48 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/contact.views.inc

1 <?
php


8 
funùiÚ
 
	$cÚù_v›ws_d©a
() {

9 
$d©a
['u£rs']['cÚù'] = 
	`¬¿y
(

10 'f›ld' => 
	`¬¿y
(

11 't™Ë' => 
	`t
('Linko contact…age'),

12 'h–p' => 
	`t
('Provide‡ simple†inkohe user contact…age.'),

16  
$d©a
;

17 
	}
}

22 
funùiÚ
 
	$cÚù_v›ws_hªdËrs
() {

23  
	`¬¿y
(

24 'šfo' => 
	`¬¿y
(

25 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/contact',

27 'hªdËrs' => 
	`¬¿y
(

28 'v›ws_hªdËr_f›ld_cÚù_lšk' => 
	`¬¿y
(

33 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/contact/views_handler_field_contact_link.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_cÚù_lšk
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_u£r_lšk
 {

8 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

9 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

10 
$İtiÚs
['lšk_di¥Ïy'] = 
	`¬¿y
('deçuÉ' => 'lšk', 'Œª¦©abË' => 
FALSE
);

11  
$İtiÚs
;

14 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

15 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

16 
$fÜm
['lšk_di¥Ïy'] = 
	`¬¿y
(

17 '#t™Ë' => 
	`t
('Type of†ink'),

18 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['link_display'],

20 '#İtiÚs' => 
	`¬¿y
(

21 'lšk' => 
	`t
('Link'),

22 'icÚ' => 
	`t
('Icon'),

25 
$fÜm
['‹xt']['#t™Ë'] = 
	`t
('Link†abel');

26 
$fÜm
['‹xt']['#»quœed'] = 
TRUE
;

27 
$fÜm
['‹xt']['#deçuÉ_v®ue'] = 
	`em±y
(
$this
->
İtiÚs
['‹xt']è? 
	`t
('contact') : $this->options['text'];

28 
	}
}

30 
funùiÚ
 
	$»nd”
(
$v®ues
) {

31 
glob®
 
$u£r
;

32 
$uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

35 ià(
	`em±y
(
$u£r
->
uid
è||ƒm±y(
$uid
)) {

39 
$accouÁ
 = 
	`u£r_lßd
(
$uid
);

40 ià(
	`em±y
(
$accouÁ
)) {

46 ià(!
	`_cÚù_u£r_b_acûss
(
$accouÁ
è|| 
	`em±y
($accouÁ->
cÚù
)) {

50 ià(
$this
->
İtiÚs
['link_display'] == 'icon') {

51  
	`l
(
	`theme
('image', 'misc/fÜum-Ãw.²g'), 'u£r/'. 
$accouÁ
->
uid
 .'/cÚù', 
	`¬¿y
('html' => 
TRUE
, '©Œibu‹s' =>‡¼ay('t™Ë' => 
	`t
('CÚù %u£r',‡¼ay('%u£r' => $accouÁ->
Çme
)))));

54  
	`l
(
$this
->
İtiÚs
['‹xt'], 'u£r/'. 
$accouÁ
->
uid
 .'/cÚù', 
	`¬¿y
('©Œibu‹s' =>‡¼ay('t™Ë' => 
	`t
('CÚù %u£r',‡¼ay('%u£r' => $accouÁ->
Çme
)))));

56 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/filter.views.inc

1 <?
php


18 
funùiÚ
 
	$f‹r_v›ws_d©a
() {

24 
$d©a
['f‹r_fÜm©s']['bË']['još'] = 
	`¬¿y
(

25 'node_»visiÚs' => 
	`¬¿y
(

29 'node' => 
	`¬¿y
(

36  
$d©a
;

37 
	}
}

39 
funùiÚ
 
	$f‹r_v›ws_hªdËrs
() {

40  
	`¬¿y
(

41 'šfo' => 
	`¬¿y
(

42 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/filter',

44 'hªdËrs' => 
	`¬¿y
(

46 'v›ws_hªdËr_f›ld_f‹r_fÜm©_Çme' => 
	`¬¿y
(

51 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/filter/views_handler_field_filter_format_name.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_f‹r_fÜm©_Çme
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

10 
$this
->
add™iÚ®_f›lds
['Çme'] = 
	`¬¿y
('table' => 'filter_formats', 'field' => 'name');

13 
funùiÚ
 
	$qu”y
() {

14 
$this
->
	`’su»_my_bË
();

15 
$this
->
	`add_add™iÚ®_f›lds
();

16 
	}
}

18 
funùiÚ
 
	$»nd”
(
$v®ues
) {

19 
$fÜm©_Çme
 = 
$v®ues
->{
$this
->
®Ÿ£s
['name']};

20 ià(!
$fÜm©_Çme
) {

24 
$fÜm©
 = 
	`f‹r_fÜm©s
(
	`v¬ŸbË_g‘
('filter_default_format', 1));

25  
	`check_¶aš
(
$fÜm©
->
Çme
);

27  
	`check_¶aš
(
$fÜm©_Çme
);

28 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale.views.inc

1 <?
php


19 
funùiÚ
 
	$loÿË_v›ws_d©a
() {

23 
$d©a
['loÿËs_sourû']['bË']['group'] = 
	`t
('Locale source');

26 
$d©a
['loÿËs_sourû']['bË']['ba£'] = 
	`¬¿y
(

28 't™Ë' => 
	`t
('Locale source'),

29 'h–p' => 
	`t
('A source string forranslation, in English orhe default site†anguage.'),

33 
$d©a
['loÿËs_sourû']['lid'] = 
	`¬¿y
(

34 't™Ë' => 
	`t
('LID'),

35 'h–p' => 
	`t
('The ID ofhe source string.'),

36 'f›ld' => 
	`¬¿y
(

38 'şick sÜbË' => 
TRUE
,

40 '¬gum’t' => 
	`¬¿y
(

42 'num”ic' => 
TRUE
,

45 'f‹r' => 
	`¬¿y
(

48 'sÜt' => 
	`¬¿y
(

54 
$d©a
['loÿËs_sourû']['loÿtiÚ'] = 
	`¬¿y
(

55 'group' => 
	`t
('Locale source'),

56 't™Ë' => 
	`t
('Location'),

57 'h–p' => 
	`t
('A description ofhe†ocation or context ofhe string.'),

58 'f›ld' => 
	`¬¿y
(

60 'şick sÜbË' => 
TRUE
,

62 'sÜt' => 
	`¬¿y
(

65 'f‹r' => 
	`¬¿y
(

68 '¬gum’t' => 
	`¬¿y
(

74 
$d©a
['loÿËs_sourû']['‹xtgroup'] = 
	`¬¿y
(

75 'group' => 
	`t
('Locale source'),

76 't™Ë' => 
	`t
('Group'),

77 'h–p' => 
	`t
('The groupheranslation is in.'),

78 'f›ld' => 
	`¬¿y
(

80 'şick sÜbË' => 
TRUE
,

82 'f‹r' => 
	`¬¿y
(

85 '¬gum’t' => 
	`¬¿y
(

91 
$d©a
['loÿËs_sourû']['sourû'] = 
	`¬¿y
(

92 'group' => 
	`t
('Locale source'),

93 't™Ë' => 
	`t
('Source'),

94 'h–p' => 
	`t
('The full original string.'),

95 'f›ld' => 
	`¬¿y
(

98 'f‹r' => 
	`¬¿y
(

104 
$d©a
['loÿËs_sourû']['v”siÚ'] = 
	`¬¿y
(

105 'group' => 
	`t
('Locale source'),

106 't™Ë' => 
	`t
('Version'),

107 'h–p' => 
	`t
('The version of Drupal corehathis string is for.'),

108 'f›ld' => 
	`¬¿y
(

110 'şick sÜbË' => 
TRUE
,

112 'f‹r' => 
	`¬¿y
(

115 '¬gum’t' => 
	`¬¿y
(

120 
$d©a
['loÿËs_sourû']['ed™_lid'] = 
	`¬¿y
(

121 'group' => 
	`t
('Locale source'),

122 'f›ld' => 
	`¬¿y
(

123 't™Ë' => 
	`t
('Edit†ink'),

124 'h–p' => 
	`t
('Provide‡ simple†inkoƒditheranslations.'),

134 
$d©a
['loÿËs_rg‘']['bË']['group'] = 
	`t
('Localearget');

137 
$d©a
['loÿËs_rg‘']['bË']['još'] = 
	`¬¿y
(

138 'loÿËs_sourû' => 
	`¬¿y
(

145 
$d©a
['loÿËs_rg‘']['Œª¦©iÚ'] = 
	`¬¿y
(

146 'group' => 
	`t
('Localearget'),

147 't™Ë' => 
	`t
('Translation'),

148 'h–p' => 
	`t
('The fullranslation string.'),

149 'f›ld' => 
	`¬¿y
(

152 'f‹r' => 
	`¬¿y
(

158 
$d©a
['loÿËs_rg‘']['Ïnguage'] = 
	`¬¿y
(

159 'group' => 
	`t
('Localearget'),

160 't™Ë' => 
	`t
('Language'),

161 'h–p' => 
	`t
('The†anguagehisranslation is in.'),

162 'f›ld' => 
	`¬¿y
(

164 'şick sÜbË' => 
TRUE
,

166 'f‹r' => 
	`¬¿y
(

169 '¬gum’t' => 
	`¬¿y
(

174 
$d©a
['loÿËs_rg‘']['¶id'] = 
	`¬¿y
(

175 'group' => 
	`t
('Localearget'),

176 't™Ë' => 
	`t
('Singular LID'),

177 'h–p' => 
	`t
('The ID ofhe…arentranslation.'),

178 'f›ld' => 
	`¬¿y
(

184 
$d©a
['loÿËs_rg‘']['¶u¿l'] = 
	`¬¿y
(

185 'group' => 
	`t
('Localearget'),

186 't™Ë' => 
	`t
('Plural'),

187 'h–p' => 
	`t
('Whether or‚otheranslation is…lural.'),

188 'f›ld' => 
	`¬¿y
(

190 'şick sÜbË' => 
TRUE
,

192 'f‹r' => 
	`¬¿y
(

194 'Ïb–' => 
	`t
('Plural'),

197 'sÜt' => 
	`¬¿y
(

202  
$d©a
;

203 
	}
}

208 
funùiÚ
 
	$loÿË_v›ws_hªdËrs
() {

209  
	`¬¿y
(

210 'šfo' => 
	`¬¿y
(

211 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/locale',

213 'hªdËrs' => 
	`¬¿y
(

215 'v›ws_hªdËr_f›ld_loÿË_group' => 
	`¬¿y
(

218 'v›ws_hªdËr_f›ld_loÿË_Ïnguage' => 
	`¬¿y
(

221 'v›ws_hªdËr_f›ld_loÿË_lšk_ed™' => 
	`¬¿y
(

225 'v›ws_hªdËr_¬gum’t_loÿË_group' => 
	`¬¿y
(

228 'v›ws_hªdËr_¬gum’t_loÿË_Ïnguage' => 
	`¬¿y
(

232 'v›ws_hªdËr_f‹r_loÿË_group' => 
	`¬¿y
(

235 'v›ws_hªdËr_f‹r_loÿË_Ïnguage' => 
	`¬¿y
(

238 'v›ws_hªdËr_f‹r_loÿË_v”siÚ' => 
	`¬¿y
(

243 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_argument_locale_group.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_¬gum’t_loÿË_group
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

8 
funùiÚ
 
	$cÚ¡ruù
() {

9 
·»Á
::
	`cÚ¡ruù
('group');

16 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

17  
$this
->
	`loÿË_group
(
$d©a
->{$this->
Çme_®Ÿs
});

18 
	}
}

24 
funùiÚ
 
	$t™Ë
() {

25  
$this
->
	`loÿË_group
($this->
¬gum’t
);

26 
	}
}

28 
funùiÚ
 
	$loÿË_group
(
$group
) {

29 
$groups
 = 
	`moduË_švoke_®l
('locale', 'groups');

31 
	`asÜt
(
$groups
);

32  
	`is£t
(
$groups
[
$group
]è? $groups[$group] : 
	`t
('Unknown group');

33 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_argument_locale_language.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_¬gum’t_loÿË_Ïnguage
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

8 
funùiÚ
 
	$cÚ¡ruù
() {

9 
·»Á
::
	`cÚ¡ruù
('language');

16 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

17  
$this
->
	`loÿË_Ïnguage
(
$d©a
->{$this->
Çme_®Ÿs
});

18 
	}
}

24 
funùiÚ
 
	$t™Ë
() {

25  
$this
->
	`loÿË_Ïnguage
($this->
¬gum’t
);

26 
	}
}

28 
funùiÚ
 
	$loÿË_Ïnguage
(
$Ïngcode
) {

29 
$Ïnguages
 = 
	`loÿË_Ïnguage_li¡
();

30  
	`is£t
(
$Ïnguages
[
$Ïngcode
]è? $Ïnguages[$Ïngcode] : 
	`t
('Unknown†anguage');

31 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_field_locale_group.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_loÿË_group
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

8 
funùiÚ
 
	$»nd”
(
$v®ues
) {

9 
$groups
 = 
	`moduË_švoke_®l
('locale', 'groups');

11 
	`asÜt
(
$groups
);

12  
	`is£t
(
$groups
[
$v®ues
->{
$this
->
f›ld_®Ÿs
}]) ? $groups[$values->{$this->field_alias}] : '';

14 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_field_locale_language.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_loÿË_Ïnguage
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

8 
funùiÚ
 
	$»nd”
(
$v®ues
) {

9 
$Ïnguages
 = 
	`Ïnguage_li¡
();

10  
	`is£t
(
$Ïnguages
[
$v®ues
->{
$this
->
f›ld_®Ÿs
}]è? $Ïnguages[$v®ues->{$this->f›ld_®Ÿs}]->
Çme
 : '';

12 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_field_locale_link_edit.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_loÿË_lšk_ed™
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

8 
funùiÚ
 
	$cÚ¡ruù
() {

9 
·»Á
::
	`cÚ¡ruù
();

10 
$this
->
add™iÚ®_f›lds
['lid'] = 'lid';

13 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

14 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

16 
$İtiÚs
['‹xt'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

18  
$İtiÚs
;

19 
	}
}

21 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

22 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

23 
$fÜm
['‹xt'] = 
	`¬¿y
(

25 '#t™Ë' => 
	`t
('Texto display'),

26 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['text'],

28 
	}
}

30 
funùiÚ
 
	$qu”y
() {

31 
$this
->
	`’su»_my_bË
();

32 
$this
->
	`add_add™iÚ®_f›lds
();

33 
	}
}

35 
funùiÚ
 
	$»nd”
(
$v®ues
) {

37 ià(!
	`u£r_acûss
('translate interface')) {

41 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('edit');

42  
	`l
(
$‹xt
, 'admš/bud/Œª¦©e/ed™/' . 
$v®ues
->{
$this
->
®Ÿ£s
['lid']}, 
	`¬¿y
('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
()));

43 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_filter_locale_group.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_loÿË_group
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_š_İ”©Ü
 {

8 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

9 ià(!
	`is£t
(
$this
->
v®ue_İtiÚs
)) {

10 
$this
->
v®ue_t™Ë
 = 
	`t
('Group');

11 
$groups
 = 
	`moduË_švoke_®l
('locale', 'groups');

13 
	`asÜt
(
$groups
);

14 
$this
->
v®ue_İtiÚs
 = 
$groups
;

17 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_filter_locale_language.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_loÿË_Ïnguage
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_š_İ”©Ü
 {

8 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

9 ià(!
	`is£t
(
$this
->
v®ue_İtiÚs
)) {

10 
$this
->
v®ue_t™Ë
 = 
	`t
('Language');

11 
$Ïnguages
 = 
	`¬¿y
('***CURRENT_LANGUAGE***' => 
	`t
("Current user's†anguage"), '***DEFAULT_LANGUAGE***' =>("Default site†anguage"), '***NO_LANGUAGE***' =>('No†anguage'));

12 
$Ïnguages
 = 
	`¬¿y_m”ge
($Ïnguages, 
	`loÿË_Ïnguage_li¡
());

13 
$this
->
v®ue_İtiÚs
 = 
$Ïnguages
;

16 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_filter_locale_version.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_loÿË_v”siÚ
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_š_İ”©Ü
 {

8 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

9 ià(!
	`is£t
(
$this
->
v®ue_İtiÚs
)) {

10 
$this
->
v®ue_t™Ë
 = 
	`t
('Version');

12 
$v”siÚs
 = 
	`¬¿y
('***CURRENT_VERSION***' => 
	`t
('Current installed version'));

13 
$»suÉ
 = 
	`db_qu”y
('SELECT DISTINCT(version) FROM {locales_source} ORDER BY version');

14 
$row
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

15 ià(!
	`em±y
(
$row
['version'])) {

16 
$v”siÚs
[
$row
['version']] = $row['version'];

19 
$this
->
v®ue_İtiÚs
 = 
$v”siÚs
;

22 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node.views.inc

1 <?
php


18 
funùiÚ
 
	$node_v›ws_d©a
() {

24 
$d©a
['node']['bË']['group'] = 
	`t
('Node');

27 
$d©a
['node']['bË']['ba£'] = 
	`¬¿y
(

29 't™Ë' => 
	`t
('Node'),

30 'h–p' => 
	`t
("Nodes‡re‡ Drupal site's…rimary content."),

35 
$d©a
['node']['bË']['još'] = 
	`¬¿y
(

38 'node_»visiÚs' => 
	`¬¿y
(

56 
$d©a
['node']['nid'] = 
	`¬¿y
(

57 't™Ë' => 
	`t
('Nid'),

58 'h–p' => 
	`t
('The‚ode ID ofhe‚ode.'),

60 'f›ld' => 
	`¬¿y
(

62 'şick sÜbË' => 
TRUE
,

65 '¬gum’t' => 
	`¬¿y
(

69 'num”ic' => 
TRUE
,

73 'f‹r' => 
	`¬¿y
(

77 'sÜt' => 
	`¬¿y
(

84 
$d©a
['node']['t™Ë'] = 
	`¬¿y
(

85 't™Ë' => 
	`t
('Title'),

86 'h–p' => 
	`t
('Theitle ofhe‚ode.'),

88 'f›ld' => 
	`¬¿y
(

90 'group' => 
	`t
('Node'),

92 'şick sÜbË' => 
TRUE
,

94 'sÜt' => 
	`¬¿y
(

98 'f‹r' => 
	`¬¿y
(

101 '¬gum’t' => 
	`¬¿y
(

107 
$d©a
['node']['ü—‹d'] = 
	`¬¿y
(

108 't™Ë' => 
	`t
('Post date'),

109 'h–p' => 
	`t
('The datehe‚ode was…osted.'),

110 'f›ld' => 
	`¬¿y
(

112 'şick sÜbË' => 
TRUE
,

114 'sÜt' => 
	`¬¿y
(

117 'f‹r' => 
	`¬¿y
(

123 
$d©a
['node']['chªged'] = 
	`¬¿y
(

124 't™Ë' => 
	`t
('Updated date'),

125 'h–p' => 
	`t
('The datehe‚ode was†ast updated.'),

126 'f›ld' => 
	`¬¿y
(

128 'şick sÜbË' => 
TRUE
,

130 'sÜt' => 
	`¬¿y
(

133 'f‹r' => 
	`¬¿y
(

139 
$d©a
['node']['ty³'] = 
	`¬¿y
(

140 't™Ë' => 
	`t
('Type'),

141 'h–p' => 
	`t
('Theype of‡‚ode (forƒxample, "blogƒntry", "forum…ost", "story",ƒtc).'),

142 'f›ld' => 
	`¬¿y
(

144 'şick sÜbË' => 
TRUE
,

146 'sÜt' => 
	`¬¿y
(

149 'f‹r' => 
	`¬¿y
(

152 '¬gum’t' => 
	`¬¿y
(

158 
$d©a
['node']['¡©us'] = 
	`¬¿y
(

159 't™Ë' => 
	`t
('Published'),

160 'h–p' => 
	`t
('Whether or‚othe‚ode is…ublished.'),

161 'f›ld' => 
	`¬¿y
(

163 'şick sÜbË' => 
TRUE
,

165 'f‹r' => 
	`¬¿y
(

167 'Ïb–' => 
	`t
('Published'),

170 'sÜt' => 
	`¬¿y
(

176 
$d©a
['node']['¡©us_exŒa'] = 
	`¬¿y
(

177 't™Ë' => 
	`t
('Published or‡dmin'),

178 'h–p' => 
	`t
('Filters out unpublished‚odes ifhe current user cannot viewhem.'),

179 'f‹r' => 
	`¬¿y
(

182 'Ïb–' => 
	`t
('Published or‡dmin'),

187 
$d©a
['node']['´omÙe'] = 
	`¬¿y
(

188 't™Ë' => 
	`t
('Promotedo front…age'),

189 'h–p' => 
	`t
('Whether or‚othe‚ode is…romotedohe front…age.'),

190 'f›ld' => 
	`¬¿y
(

192 'şick sÜbË' => 
TRUE
,

194 'f‹r' => 
	`¬¿y
(

196 'Ïb–' => 
	`t
('Promotedo front…age'),

199 'sÜt' => 
	`¬¿y
(

205 
$d©a
['node']['mod”©e'] = 
	`¬¿y
(

206 't™Ë' => 
	`t
('Moderated'),

207 'h–p' => 
	`t
('Whether or‚othe‚ode is moderated.'),

209 'f›ld' => 
	`¬¿y
(

211 'şick sÜbË' => 
TRUE
,

213 'f‹r' => 
	`¬¿y
(

215 'Ïb–' => 
	`t
('Moderated'),

218 'sÜt' => 
	`¬¿y
(

224 
$d©a
['node']['¡icky'] = 
	`¬¿y
(

225 't™Ë' => 
	`t
('Sticky'),

226 'h–p' => 
	`t
('Whether or‚othe‚ode is sticky.'),

228 'f›ld' => 
	`¬¿y
(

230 'şick sÜbË' => 
TRUE
,

231 'ouuˆfÜm©s' => 
	`¬¿y
(

232 '¡icky' => 
	`¬¿y
('', 
	`t
('Sticky')),

235 'f‹r' => 
	`¬¿y
(

237 'Ïb–' => 
	`t
('Sticky'),

240 'sÜt' => 
	`¬¿y
(

242 'h–p' => 
	`t
('Whether or‚othe‚ode is sticky. To†ist sticky‚odes first, sethiso descending.'),

248 
$d©a
['node']['v›w_node'] = 
	`¬¿y
(

249 'f›ld' => 
	`¬¿y
(

250 't™Ë' => 
	`t
('Link'),

251 'h–p' => 
	`t
('Provide‡ simple†inkohe‚ode.'),

256 
$d©a
['node']['ed™_node'] = 
	`¬¿y
(

257 'f›ld' => 
	`¬¿y
(

258 't™Ë' => 
	`t
('Edit†ink'),

259 'h–p' => 
	`t
('Provide‡ simple†inkoƒdithe‚ode.'),

264 
$d©a
['node']['d–‘e_node'] = 
	`¬¿y
(

265 'f›ld' => 
	`¬¿y
(

266 't™Ë' => 
	`t
('Delete†ink'),

267 'h–p' => 
	`t
('Provide‡ simple†inko deletehe‚ode.'),

272 
$d©a
['node']['·th'] = 
	`¬¿y
(

273 'f›ld' => 
	`¬¿y
(

274 't™Ë' => 
	`t
('Path'),

275 'h–p' => 
	`t
('The‡liased…athohis‚ode.'),

283 
$d©a
['node']['ü—‹d_fuÎd©e'] = 
	`¬¿y
(

284 't™Ë' => 
	`t
('Created date'),

285 'h–p' => 
	`t
('Inhe form of CCYYMMDD.'),

286 '¬gum’t' => 
	`¬¿y
(

292 
$d©a
['node']['ü—‹d_y—r_mÚth'] = 
	`¬¿y
(

293 't™Ë' => 
	`t
('Created year + month'),

294 'h–p' => 
	`t
('Inhe form of YYYYMM.'),

295 '¬gum’t' => 
	`¬¿y
(

301 
$d©a
['node']['ü—‹d_y—r'] = 
	`¬¿y
(

302 't™Ë' => 
	`t
('Created year'),

303 'h–p' => 
	`t
('Inhe form of YYYY.'),

304 '¬gum’t' => 
	`¬¿y
(

310 
$d©a
['node']['ü—‹d_mÚth'] = 
	`¬¿y
(

311 't™Ë' => 
	`t
('Created month'),

312 'h–p' => 
	`t
('Inhe form of MM (01 - 12).'),

313 '¬gum’t' => 
	`¬¿y
(

319 
$d©a
['node']['ü—‹d_day'] = 
	`¬¿y
(

320 't™Ë' => 
	`t
('Created day'),

321 'h–p' => 
	`t
('Inhe form of DD (01 - 31).'),

322 '¬gum’t' => 
	`¬¿y
(

328 
$d©a
['node']['ü—‹d_w“k'] = 
	`¬¿y
(

329 't™Ë' => 
	`t
('Created week'),

330 'h–p' => 
	`t
('Inhe form of WW (01 - 53).'),

331 '¬gum’t' => 
	`¬¿y
(

337 
$d©a
['node']['chªged_fuÎd©e'] = 
	`¬¿y
(

338 't™Ë' => 
	`t
('Updated date'),

339 'h–p' => 
	`t
('Inhe form of CCYYMMDD.'),

340 '¬gum’t' => 
	`¬¿y
(

346 
$d©a
['node']['chªged_y—r_mÚth'] = 
	`¬¿y
(

347 't™Ë' => 
	`t
('Updated year + month'),

348 'h–p' => 
	`t
('Inhe form of YYYYMM.'),

349 '¬gum’t' => 
	`¬¿y
(

355 
$d©a
['node']['chªged_y—r'] = 
	`¬¿y
(

356 't™Ë' => 
	`t
('Updated year'),

357 'h–p' => 
	`t
('Inhe form of YYYY.'),

358 '¬gum’t' => 
	`¬¿y
(

364 
$d©a
['node']['chªged_mÚth'] = 
	`¬¿y
(

365 't™Ë' => 
	`t
('Updated month'),

366 'h–p' => 
	`t
('Inhe form of MM (01 - 12).'),

367 '¬gum’t' => 
	`¬¿y
(

373 
$d©a
['node']['chªged_day'] = 
	`¬¿y
(

374 't™Ë' => 
	`t
('Updated day'),

375 'h–p' => 
	`t
('Inhe form of DD (01 - 31).'),

376 '¬gum’t' => 
	`¬¿y
(

382 
$d©a
['node']['chªged_w“k'] = 
	`¬¿y
(

383 't™Ë' => 
	`t
('Updated week'),

384 'h–p' => 
	`t
('Inhe form of WW (01 - 53).'),

385 '¬gum’t' => 
	`¬¿y
(

396 
$d©a
['node_»visiÚs']['bË']['group'] = 
	`t
('Node„evision');

399 
$d©a
['node_»visiÚs']['bË']['ba£'] = 
	`¬¿y
(

401 't™Ë' => 
	`t
('Node„evision'),

402 'h–p' => 
	`t
('Node„evisions‡re‡ history of changeso‚odes.'),

406 
$d©a
['node_»visiÚs']['bË']['još'] = 
	`¬¿y
(

408 'node' => 
	`¬¿y
(

415 
$d©a
['node_»visiÚs']['uid'] = 
	`¬¿y
(

416 't™Ë' => 
	`t
('User'),

417 'h–p' => 
	`t
('Relate‡‚ode„evisionohe user who createdhe„evision.'),

418 '»ÏtiÚsh' => 
	`¬¿y
(

422 'Ïb–' => 
	`t
('user'),

427 
$d©a
['node_»visiÚs']['body'] = 
	`¬¿y
(

428 'group' => 
	`t
('Node'),

429 't™Ë' => 
	`t
('Body'),

430 'h–p' => 
	`t
('The‡ctual, full data inhe body field;his may‚ot be valid data on‡ll‚odeypes.'),

432 'f›ld' => 
	`¬¿y
(

436 'f‹r' => 
	`¬¿y
(

442 
$d©a
['node_»visiÚs']['‹a£r'] = 
	`¬¿y
(

443 'group' => 
	`t
('Node'),

444 't™Ë' => 
	`t
('Teaser'),

445 'h–p' => 
	`t
('The storedeaser field. This may‚ot be valid or useful data on‡ll‚odeypes.'),

447 'f›ld' => 
	`¬¿y
(

451 'f‹r' => 
	`¬¿y
(

457 
$d©a
['node_»visiÚs']['vid'] = 
	`¬¿y
(

458 't™Ë' => 
	`t
('Vid'),

459 'h–p' => 
	`t
('The„evision ID ofhe‚ode„evision.'),

461 'f›ld' => 
	`¬¿y
(

463 'şick sÜbË' => 
TRUE
,

466 '¬gum’t' => 
	`¬¿y
(

469 'şick sÜbË' => 
TRUE
,

470 'num”ic' => 
TRUE
,

473 'f‹r' => 
	`¬¿y
(

477 'sÜt' => 
	`¬¿y
(

483 
$d©a
['node_»visiÚs']['t™Ë'] = 
	`¬¿y
(

484 't™Ë' => 
	`t
('Title'),

485 'h–p' => 
	`t
('Theitle ofhe‚ode.'),

487 'f›ld' => 
	`¬¿y
(

490 'şick sÜbË' => 
TRUE
,

492 'sÜt' => 
	`¬¿y
(

495 'f‹r' => 
	`¬¿y
(

498 '¬gum’t' => 
	`¬¿y
(

504 
$d©a
['node_»visiÚs']['log'] = 
	`¬¿y
(

505 't™Ë' => 
	`t
('Log message'),

506 'h–p' => 
	`t
('The†og messageƒntered whenhe„evision was created.'),

508 'f›ld' => 
	`¬¿y
(

511 'f‹r' => 
	`¬¿y
(

518 
$d©a
['node_»visiÚs']['time¡amp'] = 
	`¬¿y
(

519 't™Ë' => 
	`t
('Created date'),

520 'h–p' => 
	`t
('The datehe‚ode„evision was created.'),

521 'f›ld' => 
	`¬¿y
(

523 'şick sÜbË' => 
TRUE
,

525 'sÜt' => 
	`¬¿y
(

528 'f‹r' => 
	`¬¿y
(

534 
$d©a
['node_»visiÚs']['fÜm©'] = 
	`¬¿y
(

535 't™Ë' => 
	`t
('Input format id'),

536 'h–p' => 
	`t
('Thnum”iøšpuˆfÜm© oàthnod»visiÚ. !deçuÉ m—n thdeçuÉ iÅuˆfÜm©.', 
	`¬¿y
('!deçuÉ' => 
FILTER_FORMAT_DEFAULT
)),

538 'f›ld' => 
	`¬¿y
(

540 'şick sÜbË' => 
TRUE
,

543 'sÜt' => 
	`¬¿y
(

547 'f‹r' => 
	`¬¿y
(

557 
$d©a
['node_»visiÚs']['fÜm©_Çme'] = 
	`¬¿y
(

558 't™Ë' => 
	`t
('Input format'),

559 'h–p' => 
	`t
('The‚ame ofhe input format ofhe‚ode„evision.'),

561 'f›ld' => 
	`¬¿y
(

566 
$d©a
['node_»visiÚs']['»v”t_»visiÚ'] = 
	`¬¿y
(

567 'f›ld' => 
	`¬¿y
(

568 't™Ë' => 
	`t
('Revert†ink'),

569 'h–p' => 
	`t
('Provide‡ simple†inko„evertohe„evision.'),

574 
$d©a
['node_»visiÚs']['d–‘e_»visiÚ'] = 
	`¬¿y
(

575 'f›ld' => 
	`¬¿y
(

576 't™Ë' => 
	`t
('Delete†ink'),

577 'h–p' => 
	`t
('Provide‡ simple†inko deletehe‚ode„evision.'),

587 
$d©a
['node_acûss']['bË']['group'] = 
	`t
('Node‡ccess');

590 
$d©a
['node_acûss']['bË']['još'] = 
	`¬¿y
(

592 'node' => 
	`¬¿y
(

598 
$d©a
['node_acûss']['nid'] = 
	`¬¿y
(

599 't™Ë' => 
	`t
('Access'),

600 'h–p' => 
	`t
('Filter by‡ccess.'),

601 'f‹r' => 
	`¬¿y
(

603 'h–p' => 
	`t
('Filter for‚odes by view‡ccess. <strong>Not‚ecessary if you‡re using‚ode‡s your baseable.</strong>'),

613 
$d©a
['hi¡Üy_u£r']['bË']['group'] = 
	`t
('Node');

616 
$d©a
['hi¡Üy_u£r']['bË']['još'] = 
	`¬¿y
(

618 'node' => 
	`¬¿y
(

622 'exŒa' => 
	`¬¿y
(

623 
	`¬¿y
('f›ld' => 'uid', 'v®ue' => '***CURRENT_USER***', 'num”ic' => 
TRUE
),

628 
$d©a
['hi¡Üy_u£r']['time¡amp'] = 
	`¬¿y
(

629 't™Ë' => 
	`t
('Has‚ew content'),

630 'f›ld' => 
	`¬¿y
(

632 'h–p' => 
	`t
('Show‡ marker ifhe‚ode has‚ew or updated content.'),

634 'f‹r' => 
	`¬¿y
(

635 'h–p' => 
	`t
('Show only‚odeshat have‚ew content.'),

639  
$d©a
;

640 
	}
}

646 
funùiÚ
 
	$node_v›ws_hªdËrs
() {

647  
	`¬¿y
(

648 'šfo' => 
	`¬¿y
(

649 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/node',

651 'hªdËrs' => 
	`¬¿y
(

653 'v›ws_hªdËr_f›ld_node' => 
	`¬¿y
(

656 'v›ws_hªdËr_f›ld_node_ty³' => 
	`¬¿y
(

659 'v›ws_hªdËr_f›ld_node_lšk' => 
	`¬¿y
(

662 'v›ws_hªdËr_f›ld_node_·th' => 
	`¬¿y
(

665 'v›ws_hªdËr_f›ld_node_ty³' => 
	`¬¿y
(

668 'v›ws_hªdËr_f›ld_node_lšk_ed™' => 
	`¬¿y
(

671 'v›ws_hªdËr_f›ld_node_lšk_d–‘e' => 
	`¬¿y
(

674 'v›ws_hªdËr_f›ld_node_»visiÚ_lšk_»v”t' => 
	`¬¿y
(

677 'v›ws_hªdËr_f›ld_node_»visiÚ_lšk_d–‘e' => 
	`¬¿y
(

680 'v›ws_hªdËr_f›ld_hi¡Üy_u£r_time¡amp' => 
	`¬¿y
(

683 'v›ws_hªdËr_f›ld_node_»visiÚ' => 
	`¬¿y
(

687 'v›ws_hªdËr_¬gum’t_node_ty³' => 
	`¬¿y
(

690 'v›ws_hªdËr_¬gum’t_node_nid' => 
	`¬¿y
(

693 'v›ws_hªdËr_¬gum’t_node_vid' => 
	`¬¿y
(

696 'v›ws_hªdËr_¬gum’t_node_ü—‹d_fuÎd©e' => 
	`¬¿y
(

701 'v›ws_hªdËr_¬gum’t_node_ü—‹d_y—r' => 
	`¬¿y
(

706 'v›ws_hªdËr_¬gum’t_node_ü—‹d_y—r_mÚth' => 
	`¬¿y
(

711 'v›ws_hªdËr_¬gum’t_node_ü—‹d_mÚth' => 
	`¬¿y
(

716 'v›ws_hªdËr_¬gum’t_node_ü—‹d_day' => 
	`¬¿y
(

721 'v›ws_hªdËr_¬gum’t_node_ü—‹d_w“k' => 
	`¬¿y
(

728 'v›ws_hªdËr_f‹r_node_ty³' => 
	`¬¿y
(

731 'v›ws_hªdËr_f‹r_hi¡Üy_u£r_time¡amp' => 
	`¬¿y
(

734 'v›ws_hªdËr_f‹r_node_¡©us' => 
	`¬¿y
(

737 'v›ws_hªdËr_f‹r_node_acûss' => 
	`¬¿y
(

742 
	}
}

747 
funùiÚ
 
	$node_v›ws_¶ugšs
() {

748  
	`¬¿y
(

750 'row' => 
	`¬¿y
(

751 'node' => 
	`¬¿y
(

752 't™Ë' => 
	`t
('Node'),

753 'h–p' => 
	`t
('Displayhe‚ode with standard‚ode view.'),

755 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/node',

757 'ba£' => 
	`¬¿y
('node'),

758 'u£ İtiÚs' => 
TRUE
,

762 'node_rss' => 
	`¬¿y
(

763 't™Ë' => 
	`t
('Node'),

764 'h–p' => 
	`t
('Displayhe‚ode with standard‚ode view.'),

766 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/node',

768 'ba£' => 
	`¬¿y
('node'),

769 'u£ İtiÚs' => 
TRUE
,

774 '¬gum’ˆv®id©Ü' => 
	`¬¿y
(

775 'node' => 
	`¬¿y
(

776 't™Ë' => 
	`t
('Node'),

778 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/node',

781 '¬gum’ˆdeçuÉ' => 
	`¬¿y
(

782 'node' => 
	`¬¿y
(

783 't™Ë' => 
	`t
('Node ID from URL'),

785 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/node',

790 
	}
}

795 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_row_node
(&
$v¬s
) {

796 
$İtiÚs
 = 
$v¬s
['options'];

799 
$v¬s
['node'] = '';

800 
$v¬s
['comments'] = '';

802 
$nid
 = 
$v¬s
['row']->{$vars['field_alias']};

803 ià(!
	`is_num”ic
(
$nid
)) {

807 
$node
 = 
	`node_lßd
(
$nid
);

809 ià(
	`em±y
(
$node
)) {

813 
$node
->
v›w
 = 
$v¬s
['view'];

814 
$node
->
bud_mode
 = (
$İtiÚs
['bud_mode'] =ğ'‹a£r' || $İtiÚs['bud_mode'] =ğ'fuÎ'è? 
NODE_BUILD_NORMAL
 : $options['build_mode'];

815 
$v¬s
['node'] = 
	`node_v›w
(
$node
, 
$İtiÚs
['bud_mode'] =ğ'‹a£r', 
FALSE
, $options['links']);

817 ià(!
	`em±y
(
$İtiÚs
['comm’ts']è&& 
	`funùiÚ_exi¡s
('comment_render')) {

818 
$v¬s
['comm’ts'] = 
	`comm’t_»nd”
(
$node
);

820 
	}
}

825 
funùiÚ
 
	$node_v›ws_qu”y_sub¡™utiÚs
() {

826  
	`¬¿y
(

827 '***ADMINISTER_NODES***' => 
	`štv®
(
	`u£r_acûss
('administer‚odes')),

829 
	}
}

834 
funùiÚ
 
	$node_v›ws_ª®yze
(
$v›w
) {

835 
$»t
 = 
	`¬¿y
();

837 ià(
$v›w
->
ba£_bË
 == 'node') {

838 
	`fÜ—ch
 (
$v›w
->
di¥Ïy
 
as
 
$id
 => 
$di¥Ïy
) {

839 ià(!
$di¥Ïy
->
hªdËr
->
	`is_deçuÉed
('access') || !$display->handler->is_defaulted('filters')) {

841 
$acûss
 = 
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('access');

842 ià(
	`em±y
(
$acûss
['type']) || $access['type'] == 'none') {

843 
$f‹rs
 = 
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('filters');

844 
	`fÜ—ch
 (
$f‹rs
 
as
 
$f‹r
) {

845 ià(
$f‹r
['table'] == 'node' && ($filter['field'] == 'status' || $filter['field'] == 'status_extra')) {

849 
$»t
[] = 
	`v›ws_ui_ª®ysis
(
	`t
('Di¥Ïy %di¥Ïy ha nØacûs cÚŒŞ buˆdÛ nÙ cÚš‡ f‹¸fÜ…ublished‚odes.', 
	`¬¿y
('%di¥Ïy' => 
$di¥Ïy
->
di¥Ïy_t™Ë
)), 'warning');

854 
	`fÜ—ch
 (
$v›w
->
di¥Ïy
 
as
 
$id
 => 
$di¥Ïy
) {

855 ià(
$di¥Ïy
->
di¥Ïy_¶ugš
 == 'page') {

856 ià(
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('path') == 'node/%') {

857 
$»t
[] = 
	`v›ws_ui_ª®ysis
(
	`t
('Di¥Ïy %di¥Ïy ha £ˆnode/%‡ ·th. Thi wÈnÙ…roduû wh© you wªt. Iàyou wªˆtØhavmuÉË v”siÚ oàthnodv›w, u£…ª–s.', 
	`¬¿y
('%di¥Ïy' => 
$di¥Ïy
->
di¥Ïy_t™Ë
)), 'warning');

862  
$»t
;

863 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node.views_convert.inc

1 <?
php


16 
funùiÚ
 
	$node_v›ws_cÚv”t
(
$di¥Ïy
, 
$ty³
, &
$v›w
, 
$f›ld
, 
$id
 = 
NULL
) {

17 
$ty³
) {

19 
$f›ld
['tablename']) {

21 
$f›ld
['field']) {

23 ià(
$f›ld
['options'] != 'no_link') {

24 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'lšk_to_node', 
TRUE
);

29 
$hªdËrs
 = 
	`¬¿y
(

36 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'd©e_fÜm©', 
$hªdËrs
[
$f›ld
['handler']]);

37 ià(!
	`em±y
(
$f›ld
['options'])) {

38 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'cu¡om_d©e_fÜm©', 
$f›ld
['options']);

42 
$f›ld
['field'] = $field['handler'] == 'views_handler_field_teaser' ? 'teaser' : $field['field'];

43 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'f›ld', 
$f›ld
['field']);

44 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'table', 'node_revisions');

50 
$f›ld
['field'] = $field['field'] == 'link' ? 'view_node' : "$field[field]_node";

51 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'f›ld', 
$f›ld
['field']);

52 ià(!
	`em±y
(
$f›ld
['options'])) {

53 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, '‹xt', 
$f›ld
['options']);

61 
$f›ld
['tablename']) {

63 
$f›ld
['field']) {

65 
$İ”©Üs
 = 
	`¬¿y
('OR' => 'in', 'NOR' => 'not in');

66 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'İ”©Ü', 
$İ”©Üs
[
$f›ld
['operator']]);

69 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f‹r', 
$id
);

70 
$™em
['v®ue'] = 
	`¬¿y
(0);

71 
$™em
['table'] = 'users';

72 
$™em
['field'] = 'uid';

73 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f‹r', 
$id
, 
$™em
);

76 
$İ”©Üs
 = 
	`¬¿y
('=' => 
TRUE
, '!=' => 
FALSE
);

77 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f‹r', 
$id
);

78 
$™em
['v®ue'] = 
$İ”©Üs
[
$f›ld
['operator']];

79 
$™em
['table'] = 'users';

80 
$™em
['field'] = 'uid_current';

81 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f‹r', 
$id
, 
$™em
);

84 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'value', '=');

85 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'field', 'uid_touch');

88 
$v›w
->
di¥Ïy_hªdËr
->
	`£t_İtiÚ
('di¡šù', 
$f›ld
['operator'] == '=' && $field['value'] == 'distinct');

89 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f‹r', 
$id
, 
NULL
);

92 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f‹r', 
$id
);

93 
$™em
['İ”©Ü'] = 
$f›ld
['operator'];

94 
$™em
['ÿ£'] = 
FALSE
;

95 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f‹r', 
$id
, 
$™em
);

99 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f‹r', 
$id
);

100 
$™em
['İ”©Ü'] = 
$f›ld
['operator'];

101 
$™em
['v®ue'] = 
	`¬¿y
(

102 'ty³' => 
$f›ld
['value'] == 'now' ? 'offset' : 'date',

103 'v®ue' => 
$f›ld
['value'],

105 ià(!
	`em±y
(
$f›ld
['options'])) {

106 
$™em
['v®ue']['v®ue'] = 
	`štv®
(
$f›ld
['options']) .' seconds';

108 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f‹r', 
$id
, 
$™em
);

111 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f‹r', 
$id
);

112 
$™em
['İ”©Ü'] = 
$f›ld
['operator'];

113 
$™em
['ÿ£'] = 
FALSE
;

114 
$™em
['table'] = 'node_revisions';

115 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f‹r', 
$id
, 
$™em
);

120 
$f›ld
['field']) {

122 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'table', 'history_user');

129 
$f›ld
['tablename']) {

131 
$f›ld
['field']) {

134 
$f›ld
['options'] = $field['options'] == 'normal' ? 'second' : $field['options'];

135 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'sÜt', 
$id
, 'g¿nuÏr™y', 
$f›ld
['options']);

138 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'sÜt', 
$id
, 'table', 'views');

145 
$İtiÚs
 = 
$f›ld
['argoptions'];

146 
$f›ld
['type']) {

148 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'node', 'ty³', 
$İtiÚs
, 
$f›ld
['id']);

151 ià(!
	`em±y
(
$f›ld
['options'])) {

152 
$İtiÚs
['glos§ry'] = 
TRUE
;

153 
$İtiÚs
['lim™'] = 
$f›ld
['options'];

155 
$İtiÚs
['case'] = 'upper';

156 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'node', 't™Ë', 
$İtiÚs
, 
$f›ld
['id']);

159 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'node', 'ü—‹d_y—r', 
$İtiÚs
, 
$f›ld
['id']);

162 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'node', 'ü—‹d_mÚth', 
$İtiÚs
, 
$f›ld
['id']);

165 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'node', 'ü—‹d_w“k', 
$İtiÚs
, 
$f›ld
['id']);

168 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'node', 'ü—‹d_y—r_mÚth', 
$İtiÚs
, 
$f›ld
['id']);

171 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'node', 'ü—‹d_fuÎd©e', 
$İtiÚs
, 
$f›ld
['id']);

174 ià(!
	`em±y
(
$f›ld
['options'])) {

175 
$İtiÚs
['nÙ'] = 
TRUE
;

177 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'node', 'nid', 
$İtiÚs
, 
$f›ld
['id']);

182 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node.views_default.inc

1 <?
php


11 
funùiÚ
 
	$node_v›ws_deçuÉ_v›ws
() {

12 
$v›w
 = 
Ãw
 
v›w
;

13 
$v›w
->
Çme
 = 'frontpage';

14 
$v›w
->
desütiÚ
 = 'Emulateshe default Drupal front…age; you may sethe default home…age…athohis viewo make it your front…age.';

15 
$v›w
->
g
 = 'default';

16 
$v›w
->
v›w_php
 = '';

17 
$v›w
->
ba£_bË
 = 'node';

18 
$v›w
->
is_ÿch—bË
 = '0';

19 
$v›w
->
­i_v”siÚ
 = 2;

20 
$v›w
->
di§bËd
 = 
TRUE
;

21 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('default', 'Defaults', 'default');

22 
$hªdËr
->
	`ov”ride_İtiÚ
('sÜts', 
	`¬¿y
(

23 '¡icky' => 
	`¬¿y
(

29 'ü—‹d' => 
	`¬¿y
(

38 
$hªdËr
->
	`ov”ride_İtiÚ
('f‹rs', 
	`¬¿y
(

39 '´omÙe' => 
	`¬¿y
(

46 'expo£d' => 
FALSE
,

47 'expo£' => 
	`¬¿y
(

48 'İ”©Ü' => 
FALSE
,

52 '¡©us' => 
	`¬¿y
(

59 'expo£d' => 
FALSE
,

60 'expo£' => 
	`¬¿y
(

61 'İ”©Ü' => 
FALSE
,

66 
$hªdËr
->
	`ov”ride_İtiÚ
('acûss', 
	`¬¿y
(

68 'rŞe' => 
	`¬¿y
(),

71 
$hªdËr
->
	`ov”ride_İtiÚ
('header_format', '1');

72 
$hªdËr
->
	`ov”ride_İtiÚ
('footer_format', '1');

73 
$hªdËr
->
	`ov”ride_İtiÚ
('empty_format', '1');

74 
$hªdËr
->
	`ov”ride_İtiÚ
('use_pager', '1');

75 
$hªdËr
->
	`ov”ride_İtiÚ
('row_plugin', 'node');

76 
$hªdËr
->
	`ov”ride_İtiÚ
('row_İtiÚs', 
	`¬¿y
(

80 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('page', 'Page', 'page');

81 
$hªdËr
->
	`ov”ride_İtiÚ
('path', 'frontpage');

82 
$hªdËr
->
	`ov”ride_İtiÚ
('m’u', 
	`¬¿y
(

87 
$hªdËr
->
	`ov”ride_İtiÚ
('b_İtiÚs', 
	`¬¿y
(

92 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('feed', 'Feed', 'feed');

93 
$hªdËr
->
	`ov”ride_İtiÚ
('sitename_title', '1');

94 
$hªdËr
->
	`ov”ride_İtiÚ
('title', 'Front…age feed');

95 
$hªdËr
->
	`ov”ride_İtiÚ
('¡yË_İtiÚs', 
	`¬¿y
(

99 
$hªdËr
->
	`ov”ride_İtiÚ
('row_plugin', 'node_rss');

100 
$hªdËr
->
	`ov”ride_İtiÚ
('row_İtiÚs', 
	`¬¿y
(

103 
$hªdËr
->
	`ov”ride_İtiÚ
('path', 'rss.xml');

104 
$hªdËr
->
	`ov”ride_İtiÚ
('m’u', 
	`¬¿y
(

109 
$hªdËr
->
	`ov”ride_İtiÚ
('b_İtiÚs', 
	`¬¿y
(

114 
$hªdËr
->
	`ov”ride_İtiÚ
('di¥Ïys', 
	`¬¿y
(

118 
$v›ws
[
$v›w
->
Çme
] = $view;

120 
$v›w
 = 
Ãw
 
v›w
;

121 
$v›w
->
Çme
 = 'glossary';

122 
$v›w
->
desütiÚ
 = 'A†ist of‡ll content, by†etter.';

123 
$v›w
->
g
 = 'default';

124 
$v›w
->
v›w_php
 = '';

125 
$v›w
->
ba£_bË
 = 'node';

126 
$v›w
->
is_ÿch—bË
 = '0';

127 
$v›w
->
­i_v”siÚ
 = 2;

128 
$v›w
->
di§bËd
 = 
TRUE
;

129 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('default', 'Defaults', 'default');

130 
$hªdËr
->
	`ov”ride_İtiÚ
('f›lds', 
	`¬¿y
(

131 't™Ë' => 
	`¬¿y
(

140 'Çme' => 
	`¬¿y
(

149 'chªged' => 
	`¬¿y
(

160 
$hªdËr
->
	`ov”ride_İtiÚ
('¬gum’ts', 
	`¬¿y
(

161 't™Ë' => 
	`¬¿y
(

164 '¡yË_İtiÚs' => 
	`¬¿y
(),

184 'v®id©e_¬gum’t_voÿbuÏry' => 
	`¬¿y
(),

189 
$hªdËr
->
	`ov”ride_İtiÚ
('acûss', 
	`¬¿y
(

191 'rŞe' => 
	`¬¿y
(),

194 
$hªdËr
->
	`ov”ride_İtiÚ
('use_ajax', '1');

195 
$hªdËr
->
	`ov”ride_İtiÚ
('items_per_page', 36);

196 
$hªdËr
->
	`ov”ride_İtiÚ
('use_pager', '1');

197 
$hªdËr
->
	`ov”ride_İtiÚ
('style_plugin', 'table');

198 
$hªdËr
->
	`ov”ride_İtiÚ
('¡yË_İtiÚs', 
	`¬¿y
(

203 'cŞumns' => 
	`¬¿y
(

208 'šfo' => 
	`¬¿y
(

209 't™Ë' => 
	`¬¿y
(

213 'Çme' => 
	`¬¿y
(

217 'chªged' => 
	`¬¿y
(

224 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('page', 'Page', 'page');

225 
$hªdËr
->
	`ov”ride_İtiÚ
('path', 'glossary');

226 
$hªdËr
->
	`ov”ride_İtiÚ
('m’u', 
	`¬¿y
(

231 
$hªdËr
->
	`ov”ride_İtiÚ
('b_İtiÚs', 
	`¬¿y
(

236 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('attachment', 'Attachment', 'attachment');

237 
$hªdËr
->
	`ov”ride_İtiÚ
('¬gum’ts', 
	`¬¿y
(

238 't™Ë' => 
	`¬¿y
(

241 '¡yË_İtiÚs' => 
	`¬¿y
(

266 'v®id©e_¬gum’t_voÿbuÏry' => 
	`¬¿y
(),

270 
$hªdËr
->
	`ov”ride_İtiÚ
('inherit_arguments', 0);

271 
$hªdËr
->
	`ov”ride_İtiÚ
('di¥Ïys', 
	`¬¿y
(

275 
$v›ws
[
$v›w
->
Çme
] = $view;

277 
$v›w
 = 
Ãw
 
v›w
;

278 
$v›w
->
Çme
 = 'archive';

279 
$v›w
->
desütiÚ
 = 'Display‡†ist of monthshat†inko content forhat month.';

280 
$v›w
->
g
 = 'default';

281 
$v›w
->
v›w_php
 = '';

282 
$v›w
->
ba£_bË
 = 'node';

283 
$v›w
->
is_ÿch—bË
 = '0';

284 
$v›w
->
­i_v”siÚ
 = 2;

285 
$v›w
->
di§bËd
 = 
TRUE
;

286 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('default', 'Defaults', 'default');

287 
$hªdËr
->
	`ov”ride_İtiÚ
('title', 'Monthly‡rchive');

288 
$hªdËr
->
	`ov”ride_İtiÚ
('sÜts', 
	`¬¿y
(

289 'ü—‹d' => 
	`¬¿y
(

298 
$hªdËr
->
	`ov”ride_İtiÚ
('¬gum’ts', 
	`¬¿y
(

299 'ü—‹d_y—r_mÚth' => 
	`¬¿y
(

305 '¡yË_İtiÚs' => 
	`¬¿y
(

319 
$hªdËr
->
	`ov”ride_İtiÚ
('f‹rs', 
	`¬¿y
(

320 '¡©us' => 
	`¬¿y
(

327 'expo£d' => 
FALSE
,

328 'expo£' => 
	`¬¿y
(

329 'İ”©Ü' => 
FALSE
,

335 
$hªdËr
->
	`ov”ride_İtiÚ
('acûss', 
	`¬¿y
(

337 'rŞe' => 
	`¬¿y
(),

340 
$hªdËr
->
	`ov”ride_İtiÚ
('use_pager', '1');

341 
$hªdËr
->
	`ov”ride_İtiÚ
('row_plugin', 'node');

342 
$hªdËr
->
	`ov”ride_İtiÚ
('row_İtiÚs', 
	`¬¿y
(

343 '‹a£r' => 
TRUE
,

344 'lšks' => 
TRUE
,

346 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('page', 'Page', 'page');

347 
$hªdËr
->
	`ov”ride_İtiÚ
('path', 'archive');

348 
$hªdËr
->
	`ov”ride_İtiÚ
('m’u', 
	`¬¿y
(

353 
$hªdËr
->
	`ov”ride_İtiÚ
('b_İtiÚs', 
	`¬¿y
(

358 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('block', 'Block', 'block');

359 
$hªdËr
->
	`ov”ride_İtiÚ
('¬gum’ts', 
	`¬¿y
(

360 'ü—‹d_y—r_mÚth' => 
	`¬¿y
(

366 '¡yË_İtiÚs' => 
	`¬¿y
(

380 
$hªdËr
->
	`ov”ride_İtiÚ
('block_description', 'Archive†ist');

381 
$v›ws
[
$v›w
->
Çme
] = $view;

383  
$v›ws
;

384 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_argument_dates_various.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_¬gum’t_node_ü—‹d_fuÎd©e
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_d©e
 {

10 
funùiÚ
 
	$cÚ¡ruù
() {

11 
·»Á
::
	`cÚ¡ruù
();

12 
$this
->
fÜm©
 = 'F j, Y';

13 
$this
->
¬g_fÜm©
 = 'Ymd';

14 
$this
->
fÜmuÏ
 = 
	`v›ws_d©e_sql_fÜm©
($this->
¬g_fÜm©
, "***table***.$this->real_field");

20 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

21 
$ü—‹d
 = 
$d©a
->{
$this
->
Çme_®Ÿs
};

22  
	`fÜm©_d©e
(
	`¡¹Ùime
(
$ü—‹d
), 'cu¡om', 
$this
->
fÜm©
, 0);

23 
	}
}

28 
funùiÚ
 
	$t™Ë
() {

29  
	`fÜm©_d©e
(
	`¡¹Ùime
(
$this
->
¬gum’t
), 'cu¡om', $this->
fÜm©
, 0);

30 
	}
}

36 şas 
	cv›ws_hªdËr_¬gum’t_node_ü—‹d_y—r
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_d©e
 {

40 
funùiÚ
 
	$cÚ¡ruù
() {

41 
·»Á
::
	`cÚ¡ruù
();

42 
$this
->
¬g_fÜm©
 = 'Y';

43 
$this
->
fÜmuÏ
 = 
	`v›ws_d©e_sql_exŒaù
('YEAR', "***table***.$this->real_field");

45 
	}
}

50 şas 
	cv›ws_hªdËr_¬gum’t_node_ü—‹d_y—r_mÚth
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_d©e
 {

54 
funùiÚ
 
	$cÚ¡ruù
() {

55 
·»Á
::
	`cÚ¡ruù
();

56 
$this
->
fÜm©
 = 'F Y';

57 
$this
->
¬g_fÜm©
 = 'Ym';

58 
$this
->
fÜmuÏ
 = 
	`v›ws_d©e_sql_fÜm©
($this->
¬g_fÜm©
, "***table***.$this->real_field");

64 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

65 
$ü—‹d
 = 
$d©a
->{
$this
->
Çme_®Ÿs
};

66  
	`fÜm©_d©e
(
	`¡¹Ùime
(
$ü—‹d
 . "15"), 'cu¡om', 
$this
->
fÜm©
, 0);

67 
	}
}

72 
funùiÚ
 
	$t™Ë
() {

73  
	`fÜm©_d©e
(
	`¡¹Ùime
(
$this
->
¬gum’t
 . "15"), 'cu¡om', $this->
fÜm©
, 0);

74 
	}
}

80 şas 
	cv›ws_hªdËr_¬gum’t_node_ü—‹d_mÚth
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_d©e
 {

84 
funùiÚ
 
	$cÚ¡ruù
() {

85 
·»Á
::
	`cÚ¡ruù
();

86 
$this
->
fÜmuÏ
 = 
	`v›ws_d©e_sql_exŒaù
('MONTH', "***table***.$this->real_field");

87 
$this
->
fÜm©
 = 'F';

88 
$this
->
¬g_fÜm©
 = 'm';

94 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

95 
$mÚth
 = 
	`¡r_·d
(
$d©a
->{
$this
->
Çme_®Ÿs
}, 2, '0', 
STR_PAD_LEFT
);

96  
	`fÜm©_d©e
(
	`¡¹Ùime
("2005" . 
$mÚth
 . "15"), 'cu¡om', 
$this
->
fÜm©
);

97 
	}
}

102 
funùiÚ
 
	$t™Ë
() {

103 
$mÚth
 = 
	`¡r_·d
(
$this
->
¬gum’t
, 2, '0', 
STR_PAD_LEFT
);

104  
	`fÜm©_d©e
(
	`¡¹Ùime
("2005" . 
$mÚth
 . "15"), 'cu¡om', 
$this
->
fÜm©
, 0);

105 
	}
}

107 
funùiÚ
 
	$summ¬y_¬gum’t
(
$d©a
) {

109  
	`¡r_·d
(
$d©a
->{
$this
->
ba£_®Ÿs
}, 2, '0', 
STR_PAD_LEFT
);

110 
	}
}

116 şas 
	cv›ws_hªdËr_¬gum’t_node_ü—‹d_day
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_d©e
 {

120 
funùiÚ
 
	$cÚ¡ruù
() {

121 
·»Á
::
	`cÚ¡ruù
();

122 
$this
->
fÜmuÏ
 = 
	`v›ws_d©e_sql_exŒaù
('DAY', "***table***.$this->real_field");

123 
$this
->
fÜm©
 = 'j';

124 
$this
->
¬g_fÜm©
 = 'd';

130 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

131 
$day
 = 
	`¡r_·d
(
$d©a
->{
$this
->
Çme_®Ÿs
}, 2, '0', 
STR_PAD_LEFT
);

132  
	`fÜm©_d©e
(
	`¡¹Ùime
("2005" . "05" . 
$day
), 'cu¡om', 
$this
->
fÜm©
, 0);

133 
	}
}

138 
funùiÚ
 
	$t™Ë
() {

139 
$day
 = 
	`¡r_·d
(
$this
->
¬gum’t
, 2, '0', 
STR_PAD_LEFT
);

140  
	`fÜm©_d©e
(
	`¡¹Ùime
("2005" . "05" . 
$day
), 'cu¡om', 
$this
->
fÜm©
, 0);

141 
	}
}

143 
funùiÚ
 
	$summ¬y_¬gum’t
(
$d©a
) {

145  
	`¡r_·d
(
$d©a
->{
$this
->
ba£_®Ÿs
}, 2, '0', 
STR_PAD_LEFT
);

146 
	}
}

152 şas 
	cv›ws_hªdËr_¬gum’t_node_ü—‹d_w“k
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_d©e
 {

156 
funùiÚ
 
	$cÚ¡ruù
() {

157 
·»Á
::
	`cÚ¡ruù
();

158 
$this
->
¬g_fÜm©
 = 'w';

159 
$this
->
fÜmuÏ
 = 
	`v›ws_d©e_sql_exŒaù
('WEEK', "***table***.$this->real_field");

165 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

166 
$ü—‹d
 = 
$d©a
->{
$this
->
Çme_®Ÿs
};

167  
	`t
('W“k @w“k', 
	`¬¿y
('@w“k' => 
$ü—‹d
));

168 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_argument_node_language.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_¬gum’t_node_Ïnguage
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
('language');

15 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

16  
$this
->
	`node_Ïnguage
(
$d©a
->{$this->
Çme_®Ÿs
});

17 
	}
}

23 
funùiÚ
 
	$t™Ë
() {

24  
$this
->
	`node_Ïnguage
($this->
¬gum’t
);

25 
	}
}

27 
funùiÚ
 
	$node_Ïnguage
(
$Ïngcode
) {

28 
$Ïnguages
 = 
	`loÿË_Ïnguage_li¡
();

29  
	`is£t
(
$Ïnguages
[
$Ïngcode
]è? $Ïnguages[$Ïngcode] : 
	`t
('Unknown†anguage');

30 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_argument_node_nid.inc

1 <?
php


11 şas 
	cv›ws_hªdËr_¬gum’t_node_nid
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_num”ic
 {

15 
funùiÚ
 
	$t™Ë_qu”y
() {

16 
$t™Ës
 = 
	`¬¿y
();

17 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$this
->
v®ue
), '%d'));

19 
$»suÉ
 = 
	`db_qu”y
("SELECT‚.t™Ë FROM {node}‚ WHERE‚.nid IN ($¶aûhŞd”s)", 
$this
->
v®ue
);

20 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

21 
$t™Ës
[] = 
	`check_¶aš
(
$‹rm
->
t™Ë
);

23  
$t™Ës
;

25 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_argument_node_type.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_¬gum’t_node_ty³
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
('type');

15 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

16  
$this
->
	`node_ty³
(
$d©a
->{$this->
Çme_®Ÿs
});

17 
	}
}

23 
funùiÚ
 
	$t™Ë
() {

24  
$this
->
	`node_ty³
($this->
¬gum’t
);

25 
	}
}

27 
funùiÚ
 
	$node_ty³
(
$ty³
) {

28 
$ouut
 = 
	`node_g‘_ty³s
('Çme', 
$ty³
);

29 ià(
	`em±y
(
$ouut
)) {

30  
	`t
('Unknown‚odeype');

33  
	`check_¶aš
(
	`t
(
$ouut
));

35 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_argument_node_vid.inc

1 <?
php


11 şas 
	cv›ws_hªdËr_¬gum’t_node_vid
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_num”ic
 {

17 
funùiÚ
 
	$t™Ë_qu”y
() {

18 
$t™Ës
 = 
	`¬¿y
();

19 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$this
->
v®ue
), '%d'));

21 
$»suÉ
 = 
	`db_qu”y
("SELECT‚.t™Ë FROM {node_»visiÚs}‚ WHERE‚.nid IN ($¶aûhŞd”s)", 
$this
->
v®ue
);

22 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

23 
$t™Ës
[] = 
	`check_¶aš
(
$‹rm
->
t™Ë
);

25  
$t™Ës
;

27 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_history_user_timestamp.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_hi¡Üy_u£r_time¡amp
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_node
 {

7 
funùiÚ
 
	$š™
(&
$v›w
, 
$İtiÚs
) {

8 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

9 
glob®
 
$u£r
;

10 ià(
$u£r
->
uid
) {

11 
$this
->
add™iÚ®_f›lds
['ü—‹d'] = 
	`¬¿y
('table' => 'node', 'field' => 'created');

12 
$this
->
add™iÚ®_f›lds
['chªged'] = 
	`¬¿y
('table' => 'node', 'field' => 'changed');

13 ià(
	`moduË_exi¡s
('comm’t'è&& !
	`em±y
(
$this
->
İtiÚs
['comments'])) {

14 
$this
->
add™iÚ®_f›lds
['Ï¡_comm’t'] = 
	`¬¿y
('table' => 'node_comment_statistics', 'field' => 'last_comment_timestamp');

19 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

20 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

22 
$İtiÚs
['comm’ts'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

24  
$İtiÚs
;

25 
	}
}

27 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

28 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

29 ià(
	`moduË_exi¡s
('comment')) {

30 
$fÜm
['comm’ts'] = 
	`¬¿y
(

32 '#t™Ë' => 
	`t
('Check for‚ew comments‡s well'),

33 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['comments']),

36 
	}
}

38 
funùiÚ
 
	$qu”y
() {

40 
glob®
 
$u£r
;

41 ià(!
$u£r
->
uid
) {

44 
·»Á
::
	`qu”y
();

45 
	}
}

47 
funùiÚ
 
	$»nd”
(
$v®ues
) {

51 
$m¬k
 = 
MARK_READ
;

52 
glob®
 
$u£r
;

53 ià(
$u£r
->
uid
) {

54 
$Ï¡_»ad
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

55 
$ü—‹d
 = 
$v®ues
->{
$this
->
®Ÿ£s
['created']};

56 
$chªged
 = 
$v®ues
->{
$this
->
®Ÿ£s
['changed']};

58 
$Ï¡_comm’t
 = 
	`moduË_exi¡s
('comm’t'è&& !
	`em±y
(
$this
->
İtiÚs
['comm’ts']è? 
$v®ues
->{$this->
®Ÿ£s
['last_comment']} : 0;

60 ià(!
$Ï¡_»ad
 && 
$ü—‹d
 > 
NODE_NEW_LIMIT
) {

61 
$m¬k
 = 
MARK_NEW
;

63 
	`–£if
 (
$chªged
 > 
$Ï¡_»ad
 && $chªged > 
NODE_NEW_LIMIT
) {

64 
$m¬k
 = 
MARK_UPDATED
;

66 
	`–£if
 (
$Ï¡_comm’t
 > 
$Ï¡_»ad
 && $Ï¡_comm’ˆ> 
NODE_NEW_LIMIT
) {

67 
$m¬k
 = 
MARK_UPDATED
;

69  
$this
->
	`»nd”_lšk
(
	`theme
('m¬k', 
$m¬k
), 
$v®ues
);

71 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node.inc

1 <?
php


11 şas 
	cv›ws_hªdËr_f›ld_node
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

15 
funùiÚ
 
	$cÚ¡ruù
() {

16 
·»Á
::
	`cÚ¡ruù
();

17 
$this
->
add™iÚ®_f›lds
['nid'] = 
	`¬¿y
('table' => 'node', 'field' => 'nid');

18 ià(
	`moduË_exi¡s
('translation')) {

19 
$this
->
add™iÚ®_f›lds
['Ïnguage'] = 
	`¬¿y
('table' => 'node', 'field' => 'language');

23 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

24 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

25 
$İtiÚs
['lšk_to_node'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

26  
$İtiÚs
;

27 
	}
}

32 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

33 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

34 
$fÜm
['lšk_to_node'] = 
	`¬¿y
(

35 '#t™Ë' => 
	`t
('Linkhis fieldo its‚ode'),

36 '#desütiÚ' => 
	`t
('This will override‡ny other†ink you have set.'),

38 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['link_to_node']),

40 
	}
}

47 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ues
) {

48 ià(!
	`em±y
(
$this
->
İtiÚs
['lšk_to_node']è&& 
$d©a
 !=ğ
NULL
 && $data !== '') {

49 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
TRUE
;

50 
$this
->
İtiÚs
['®‹r']['·th'] = "node/" . 
$v®ues
->{$this->
®Ÿ£s
['nid']};

51 ià(
	`is£t
(
$this
->
®Ÿ£s
['language'])) {

52 
$Ïnguages
 = 
	`Ïnguage_li¡
();

53 ià(
	`is£t
(
$Ïnguages
[
$v®ues
->{
$this
->
®Ÿ£s
['language']}])) {

54 
$this
->
İtiÚs
['®‹r']['Ïnguage'] = 
$Ïnguages
[
$v®ues
->{$this->
®Ÿ£s
['language']}];

57 
	`un£t
(
$this
->
İtiÚs
['alter']['language']);

61  
$d©a
;

62 
	}
}

64 
funùiÚ
 
	$»nd”
(
$v®ues
) {

65  
$this
->
	`»nd”_lšk
(
	`check_¶aš
(
$v®ues
->{$this->
f›ld_®Ÿs
}), $values);

66 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_link.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_node_lšk
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

9 
$this
->
add™iÚ®_f›lds
['nid'] = 'nid';

12 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

13 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

15 
$İtiÚs
['‹xt'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

17  
$İtiÚs
;

18 
	}
}

20 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

21 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

22 
$fÜm
['‹xt'] = 
	`¬¿y
(

24 '#t™Ë' => 
	`t
('Texto display'),

25 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['text'],

27 
	}
}

29 
funùiÚ
 
	$qu”y
() {

30 
$this
->
	`’su»_my_bË
();

31 
$this
->
	`add_add™iÚ®_f›lds
();

32 
	}
}

34 
funùiÚ
 
	$»nd”
(
$v®ues
) {

35 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('view');

36 
$nid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['nid']};

37  
	`l
(
$‹xt
, "node/$nid");

38 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_link_delete.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_node_lšk_d–‘e
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_node_lšk
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

9 
$this
->
add™iÚ®_f›lds
['type'] = 'type';

10 
$this
->
add™iÚ®_f›lds
['uid'] = 'uid';

11 
$this
->
add™iÚ®_f›lds
['fÜm©'] = 
	`¬¿y
('table' => 'node_revisions', 'field' => 'format');

14 
funùiÚ
 
	$»nd”
(
$v®ues
) {

16 
$node
 = 
Ãw
 
	`¡dCÏss
();

17 
$node
->
nid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['nid']};

18 
$node
->
uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

19 
$node
->
ty³
 = 
$v®ues
->{
$this
->
®Ÿ£s
['type']};

20 
$node
->
fÜm©
 = 
$v®ues
->{
$this
->
®Ÿ£s
['format']};

21 
$node
->
¡©us
 = 1;

22 ià(!
	`node_acûss
('d–‘e', 
$node
)) {

26 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('delete');

27  
	`l
(
$‹xt
, "node/$node->nid/d–‘e", 
	`¬¿y
('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
()));

28 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_link_edit.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_node_lšk_ed™
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_node_lšk
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

9 
$this
->
add™iÚ®_f›lds
['uid'] = 'uid';

10 
$this
->
add™iÚ®_f›lds
['type'] = 'type';

11 
$this
->
add™iÚ®_f›lds
['fÜm©'] = 
	`¬¿y
('table' => 'node_revisions', 'field' => 'format');

14 
funùiÚ
 
	$»nd”
(
$v®ues
) {

16 
$node
 = 
Ãw
 
	`¡dCÏss
();

17 
$node
->
nid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['nid']};

18 
$node
->
uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

19 
$node
->
ty³
 = 
$v®ues
->{
$this
->
®Ÿ£s
['type']};

20 
$node
->
fÜm©
 = 
$v®ues
->{
$this
->
®Ÿ£s
['format']};

21 
$node
->
¡©us
 = 1;

22 ià(!
	`node_acûss
('upd©e', 
$node
)) {

26 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('edit');

27  
	`l
(
$‹xt
, "node/$node->nid/ed™", 
	`¬¿y
('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
()));

28 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_path.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_node_·th
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

8 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

9 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

10 
$İtiÚs
['absŞu‹'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

12  
$İtiÚs
;

15 
funùiÚ
 
	$cÚ¡ruù
() {

16 
·»Á
::
	`cÚ¡ruù
();

17 
$this
->
add™iÚ®_f›lds
['nid'] = 'nid';

18 
	}
}

20 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

21 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

22 
$fÜm
['absŞu‹'] = 
	`¬¿y
(

24 '#t™Ë' => 
	`t
('Use‡bsolute†ink (begins with "http://")'),

25 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['absolute'],

26 '#desütiÚ' => 
	`t
('If you wanto usehis‡s in "outputhis field‡s†ink" in "link…ath", you mustƒnablehis option.'),

28 
	}
}

30 
funùiÚ
 
	$qu”y
() {

31 
$this
->
	`’su»_my_bË
();

32 
$this
->
	`add_add™iÚ®_f›lds
();

33 
	}
}

35 
funùiÚ
 
	$»nd”
(
$v®ues
) {

36 
$nid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['nid']};

37  
	`u¾
("node/$nid", 
	`¬¿y
('absŞu‹' => 
$this
->
İtiÚs
['absolute']));

38 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_revision.inc

1 <?
php


8 şas 
	cv›ws_hªdËr_f›ld_node_»visiÚ
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_node
 {

9 
funùiÚ
 
	$š™
(&
$v›w
, 
$İtiÚs
) {

10 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

11 ià(!
	`em±y
(
$this
->
İtiÚs
['link_to_node_revision'])) {

12 
$this
->
add™iÚ®_f›lds
['vid'] = 'vid';

13 
$this
->
add™iÚ®_f›lds
['nid'] = 'nid';

14 ià(
	`moduË_exi¡s
('translation')) {

15 
$this
->
add™iÚ®_f›lds
['Ïnguage'] = 
	`¬¿y
('table' => 'node', 'field' => 'language');

19 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

20 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

21 
$İtiÚs
['lšk_to_node_»visiÚ'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

22  
$İtiÚs
;

23 
	}
}

28 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

29 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

30 
$fÜm
['lšk_to_node_»visiÚ'] = 
	`¬¿y
(

31 '#t™Ë' => 
	`t
('Linkhis fieldo its‚ode„evision'),

32 '#desütiÚ' => 
	`t
('This will override‡ny other†ink you have set.'),

34 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['link_to_node_revision']),

36 
	}
}

43 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ues
) {

44 ià(!
	`em±y
(
$this
->
İtiÚs
['lšk_to_node_»visiÚ']è&& 
$d©a
 !=ğ
NULL
 && $data !== '') {

45 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
TRUE
;

46 
$this
->
İtiÚs
['®‹r']['·th'] = "node/" . 
$v®ues
->{$this->
®Ÿ£s
['nid']} . '/revisions/' . $values->{$this->aliases['vid']} .'/view';

47 ià(
	`is£t
(
$this
->
®Ÿ£s
['language'])) {

48 
$Ïnguages
 = 
	`Ïnguage_li¡
();

49 ià(
	`is£t
(
$Ïnguages
[
$v®ues
->{
$this
->
®Ÿ£s
['language']}])) {

50 
$this
->
İtiÚs
['®‹r']['Ïnguage'] = 
$Ïnguages
[
$v®ues
->{$this->
®Ÿ£s
['language']}];

55  
·»Á
::
	`»nd”_lšk
(
$d©a
, 
$v®ues
);

57  
$d©a
;

58 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_revision_link_delete.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_node_»visiÚ_lšk_d–‘e
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_node_lšk
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

9 
$this
->
add™iÚ®_f›lds
['uid'] = 
	`¬¿y
('table' => 'node', 'field' => 'uid');

10 
$this
->
add™iÚ®_f›lds
['node_vid'] = 
	`¬¿y
('table' => 'node', 'field' => 'vid');

11 
$this
->
add™iÚ®_f›lds
['vid'] = 'vid';

12 
$this
->
add™iÚ®_f›lds
['format'] = 'format';

15 
funùiÚ
 
	$acûss
() {

16  
	`u£r_acûss
('delete„evisions') || user_access('administer‚odes');

17 
	}
}

19 
funùiÚ
 
	$»nd”
(
$v®ues
) {

21 
$node
 = 
Ãw
 
	`¡dCÏss
();

22 
$node
->
nid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['nid']};

23 
$node
->
vid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['vid']};

24 
$node
->
uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

25 
$node
->
fÜm©
 = 
$v®ues
->{
$this
->
®Ÿ£s
['format']};

26 
$node
->
¡©us
 = 1;

27 ià(!
	`node_acûss
('d–‘e', 
$node
)) {

32 ià(
$node
->
vid
 =ğ
$v®ues
->{
$this
->
®Ÿ£s
['node_vid']}) {

35 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('delete');

36  
	`l
(
$‹xt
, "node/$node->nid/»visiÚs/$node->vid/d–‘e", 
	`¬¿y
('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
()));

37 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_revision_link_revert.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_node_»visiÚ_lšk_»v”t
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_node_lšk
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

9 
$this
->
add™iÚ®_f›lds
['uid'] = 
	`¬¿y
('table' => 'node', 'field' => 'uid');

10 
$this
->
add™iÚ®_f›lds
['node_vid'] = 
	`¬¿y
('table' => 'node', 'field' => 'vid');

11 
$this
->
add™iÚ®_f›lds
['vid'] = 'vid';

12 
$this
->
add™iÚ®_f›lds
['format'] = 'format';

15 
funùiÚ
 
	$acûss
() {

16  
	`u£r_acûss
('revert„evisions') || user_access('administer‚odes');

17 
	}
}

19 
funùiÚ
 
	$»nd”
(
$v®ues
) {

21 
$node
 = 
Ãw
 
	`¡dCÏss
();

22 
$node
->
nid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['nid']};

23 
$node
->
vid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['vid']};

24 
$node
->
uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

25 
$node
->
fÜm©
 = 
$v®ues
->{
$this
->
®Ÿ£s
['format']};

26 
$node
->
¡©us
 = 1;

27 ià(!
	`node_acûss
('upd©e', 
$node
)) {

32 ià(
$node
->
vid
 =ğ
$v®ues
->{
$this
->
®Ÿ£s
['node_vid']}) {

36 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('revert');

37  
	`l
(
$‹xt
, "node/$node->nid/»visiÚs/$node->vid/»v”t", 
	`¬¿y
('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
()));

38 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_type.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_node_ty³
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_node
 {

9 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

10 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

11 
$İtiÚs
['machše_Çme'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

13  
$İtiÚs
;

19 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

20 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

21 
$fÜm
['machše_Çme'] = 
	`¬¿y
(

22 '#t™Ë' => 
	`t
('Output machine‚ame'),

23 '#desütiÚ' => 
	`t
('Display field‡she‚odeype machine‚ame.'),

25 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['machine_name']),

27 
	}
}

32 
funùiÚ
 
	$»nd”_Çme
(
$d©a
, 
$v®ues
) {

33 ià(
$this
->
İtiÚs
['machše_Çme'] !ğ1 && 
$d©a
 !=ğ
NULL
 && $data !== '') {

34  
	`t
(
	`check_¶aš
(
	`node_g‘_ty³s
('Çme', 
$d©a
)));

36  
	`check_¶aš
(
$d©a
);

37 
	}
}

39 
funùiÚ
 
	$»nd”
(
$v®ues
) {

40  
$this
->
	`»nd”_lšk
($this->
	`»nd”_Çme
(
$v®ues
->{$this->
f›ld_®Ÿs
}, $values), $values);

41 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_filter_history_user_timestamp.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f‹r_hi¡Üy_u£r_time¡amp
 
ex‹nds
 
	mv›ws_hªdËr_f‹r
 {

8 
v¬
 
	m$no_İ”©Ü
 = 
TRUE
;

10 
funùiÚ
 
	$expo£_fÜm_right
() {

14 
funùiÚ
 
	$v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

18 ià(!
	`em±y
(
$fÜm_¡©e
['exposed'])) {

19 ià(
	`is£t
(
$this
->
İtiÚs
['expose']['label'])) {

20 
$Ïb–
 = 
$this
->
İtiÚs
['expose']['label'];

23 
$Ïb–
 = 
	`t
('Has‚ew content');

25 
$fÜm
['v®ue'] = 
	`¬¿y
(

27 '#t™Ë' => 
$Ïb–
,

28 '#deçuÉ_v®ue' => 
$this
->
v®ue
,

31 
	}
}

33 
funùiÚ
 
	$qu”y
() {

34 
glob®
 
$u£r
;

36 ià(!
$u£r
 || !$u£r->
uid
) {

41 ià((!
	`em±y
(
$this
->
İtiÚs
['expo£d'])è&&ƒm±y($this->
v®ue
)) {

48 
$lim™
 = 
	`time
(è- 
NODE_NEW_LIMIT
;

50 
$this
->
	`’su»_my_bË
();

51 
$f›ld
 = "$this->table_alias.$this->real_field";

52 
$node
 = 
$this
->
qu”y
->
	`’su»_bË
('node');

54 ià(
	`moduË_exi¡s
('comment')) {

55 
$ncs
 = 
$this
->
qu”y
->
	`’su»_bË
('node_comment_statistics');

56 
$şau£
 = ("OR $ncs.last_comment_timestamp > (***CURRENT_TIME*** - $limit)");

57 
$şau£2
 = "OR $field < $ncs.last_comment_timestamp";

63 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "($field IS NULL AND ($node.changed > (***CURRENT_TIME*** - $limit) $clause)) OR $field < $node.changed $clause2");

64 
	}
}

66 
funùiÚ
 
	$admš_summ¬y
() {

67 ià(!
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

68  
	`t
('exposed');

70 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_filter_node_access.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f‹r_node_acûss
 
ex‹nds
 
	mv›ws_hªdËr_f‹r
 {

7 
funùiÚ
 
	$admš_summ¬y
() { }

8 
funùiÚ
 
	$İ”©Ü_fÜm
(è{ 
	}
}

9 
funùiÚ
 
	$ÿn_expo£
() {

10  
FALSE
;

11 
	}
}

16 
funùiÚ
 
	$qu”y
() {

17 ià(!
	`u£r_acûss
('administer‚odes')) {

18 
$bË
 = 
$this
->
	`’su»_my_bË
();

19 
$g¿Ás
 = 
	`¬¿y
();

20 
	`fÜ—ch
 (
	`node_acûss_g¿Ás
('v›w'è
as
 
$»®m
 => 
$gids
) {

21 
	`fÜ—ch
 (
$gids
 
as
 
$gid
) {

22 
$g¿Ás
[] = "($table.gid = $gid AND $table.realm = '$realm')";

25 
$g¿Ás_sql
 = '';

26 ià(
	`couÁ
(
$g¿Ás
)) {

27 
$g¿Ás_sql
 = 
	`im¶ode
(' OR ', 
$g¿Ás
);

29 
$this
->
qu”y
->
	`add_wh”e
('AND', 
$g¿Ás_sql
);

30 
$this
->
qu”y
->
	`add_wh”e
('AND', "$table.grant_view >= 1");

32 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_filter_node_status.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f‹r_node_¡©us
 
ex‹nds
 
	mv›ws_hªdËr_f‹r
 {

7 
funùiÚ
 
	$admš_summ¬y
() { }

8 
funùiÚ
 
	$İ”©Ü_fÜm
(è{ 
	}
}

10 
funùiÚ
 
	$qu”y
() {

11 
$bË
 = 
$this
->
	`’su»_my_bË
();

12 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$table.status <> 0 OR ($table.uid = ***CURRENT_USER*** AND ***CURRENT_USER*** <> 0) OR ***ADMINISTER_NODES*** = 1");

13 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_filter_node_type.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f‹r_node_ty³
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_š_İ”©Ü
 {

7 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

8 ià(!
	`is£t
(
$this
->
v®ue_İtiÚs
)) {

9 
$this
->
v®ue_t™Ë
 = 
	`t
('Nodeype');

10 
$ty³s
 = 
	`node_g‘_ty³s
();

11 
	`fÜ—ch
 (
$ty³s
 
as
 
$ty³
 => 
$šfo
) {

12 
$İtiÚs
[
$ty³
] = 
	`t
(
$šfo
->
Çme
);

14 
$this
->
v®ue_İtiÚs
 = 
$İtiÚs
;

17 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_plugin_argument_default_node.inc

1 <?
php


11 şas 
	cv›ws_¶ugš_¬gum’t_deçuÉ_node
 
ex‹nds
 
	mv›ws_¶ugš_¬gum’t_deçuÉ
 {

12 
funùiÚ
 
	$¬gum’t_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

15 
funùiÚ
 
	$g‘_¬gum’t
() {

16 
	`fÜ—ch
 (
	`¿nge
(1, 3è
as
 
$i
) {

17 
$node
 = 
	`m’u_g‘_objeù
('node', 
$i
);

18 ià(!
	`em±y
(
$node
)) {

19  
$node
->
nid
;

23 ià(
	`¬g
(0è=ğ'node' && 
	`is_num”ic
(arg(1))) {

24  
	`¬g
(1);

26 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_plugin_argument_validate_node.inc

1 <?
php


11 şas 
	cv›ws_¶ugš_¬gum’t_v®id©e_node
 
ex‹nds
 
	mv›ws_¶ugš_¬gum’t_v®id©e
 {

12 
v¬
 
	m$İtiÚ_Çme
 = 'validate_argument_node_type';

14 
funùiÚ
 
	$v®id©e_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

15 
$ty³s
 = 
	`node_g‘_ty³s
();

16 
	`fÜ—ch
 (
$ty³s
 
as
 
$ty³
 => 
$šfo
) {

17 
$İtiÚs
[
$ty³
] = 
	`check_¶aš
(
	`t
(
$šfo
->
Çme
));

20 
$¬g
 = 
$this
->
	`g‘_¬gum’t
();

21 ià(
	`em±y
(
$¬g
)) {

22 
$¬g
 = 
	`¬¿y
();

25 
$fÜm
[
$this
->
İtiÚ_Çme
] = 
	`¬¿y
(

29 '#t™Ë' => 
	`t
('Types'),

30 '#İtiÚs' => 
$İtiÚs
,

31 '#deçuÉ_v®ue' => 
$¬g
,

32 '#desütiÚ' => 
	`t
('If you wisho validate for specific‚odeypes, checkhem; if‚one‡re checked,‡ll‚odes will…ass.'),

33 '#´oûss' => 
	`¬¿y
('expand_checkboxes', 'views_process_dependency'),

34 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-v®id©e-ty³' =>‡¼ay(
$this
->
id
)),

37 
$fÜm
['v®id©e_¬gum’t_node_acûss'] = 
	`¬¿y
(

39 '#t™Ë' => 
	`t
('Validate user has‡ccessohe‚ode'),

40 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
¬gum’t
->
İtiÚs
['validate_argument_node_access']),

41 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

42 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-v®id©e-ty³' =>‡¼ay(
$this
->
id
)),

45 
$fÜm
['v®id©e_¬gum’t_nid_ty³'] = 
	`¬¿y
(

47 '#t™Ë' => 
	`t
('Argumentype'),

48 '#İtiÚs' => 
	`¬¿y
(

49 'nid' => 
	`t
('Node ID'),

50 'nids' => 
	`t
('Node IDs separated by , or +'),

52 '#deçuÉ_v®ue' => 
	`is£t
(
$this
->
¬gum’t
->
İtiÚs
['validate_argument_nid_type']) ? $this->argument->options['validate_argument_nid_type'] : 'nid',

53 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

54 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-v®id©e-ty³' =>‡¼ay(
$this
->
id
)),

58 
funùiÚ
 
	$v®id©e_¬gum’t
(
$¬gum’t
) {

59 
$ty³s
 = 
	`¬¿y_f‹r
(
$this
->
¬gum’t
->
İtiÚs
[$this->
İtiÚ_Çme
]);

61 
$ty³
 = 
	`is£t
(
$this
->
¬gum’t
->
İtiÚs
['validate_argument_nid_type']) ? $this->argument->options['validate_argument_nid_type'] : 'nid';

63 
$ty³
) {

65 ià(!
	`is_num”ic
(
$¬gum’t
)) {

66  
FALSE
;

68 
$node
 = 
	`node_lßd
(
$¬gum’t
);

69 ià(!
$node
) {

70  
FALSE
;

73 ià(!
	`em±y
(
$this
->
¬gum’t
->
İtiÚs
['validate_argument_node_access'])) {

74 ià(!
	`node_acûss
('v›w', 
$node
)) {

75  
FALSE
;

80 
$this
->
¬gum’t
->
v®id©ed_t™Ë
 = 
	`check_¶aš
(
$node
->
t™Ë
);

82 ià(
	`em±y
(
$ty³s
)) {

83  
TRUE
;

86  
	`is£t
(
$ty³s
[
$node
->
ty³
]);

89 
$nids
 = 
Ãw
 
	`¡dCÏss
();

90 
$nids
->
v®ue
 = 
	`¬¿y
(
$¬gum’t
);

91 
$nids
 = 
	`v›ws_b»ak_ph¿£
(
$¬gum’t
, $nids);

92 ià(
$nids
->
v®ue
 == -1) {

93  
FALSE
;

96 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$nids
->
v®ue
), '%d'));

98 
$‹¡
 = 
	`dru·l_m­_assoc
(
$nids
->
v®ue
);

99 
$t™Ës
 = 
	`¬¿y
();

101 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {node} WHERE‚id IN ($¶aûhŞd”s)", 
$nids
->
v®ue
);

102 
$node
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

103 ià(
$ty³s
 && 
	`em±y
($ty³s[
$node
->
ty³
])) {

104  
FALSE
;

107 ià(!
	`em±y
(
$this
->
¬gum’t
->
İtiÚs
['validate_argument_node_access'])) {

108 ià(!
	`node_acûss
('v›w', 
$node
)) {

109  
FALSE
;

113 
$t™Ës
[] = 
	`check_¶aš
(
$node
->
t™Ë
);

114 
	`un£t
(
$‹¡
[
$node
->
nid
]);

117 
$this
->
¬gum’t
->
v®id©ed_t™Ë
 = 
	`im¶ode
(
$nids
->
İ”©Ü
 =ğ'Ü' ? ' + ' : ', ', 
$t™Ës
);

119  
	`em±y
(
$‹¡
);

121 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_plugin_row_node_rss.inc

1 <?
php


12 şas 
	cv›ws_¶ugš_row_node_rss
 
ex‹nds
 
	mv›ws_¶ugš_row
 {

14 
v¬
 
	m$ba£_bË
 = 'node';

15 
v¬
 
	m$ba£_f›ld
 = 'nid';

17 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

18 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

20 
$İtiÚs
['™em_Ëngth'] = 
	`¬¿y
('default' => 'default');

22  
$İtiÚs
;

25 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

26 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

28 
$fÜm
['™em_Ëngth'] = 
	`¬¿y
(

30 '#t™Ë' => 
	`t
('Displayype'),

31 '#İtiÚs' => 
	`¬¿y
(

32 'fuÎ‹xt' => 
	`t
('Fullext'),

33 '‹a£r' => 
	`t
('Title…luseaser'),

34 't™Ë' => 
	`t
('Title only'),

35 'deçuÉ' => 
	`t
('Use default RSS settings'),

37 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['item_length'],

39 
	}
}

41 
funùiÚ
 
	$»nd”
(
$row
) {

43 
glob®
 
$ba£_u¾
;

45 
$nid
 = 
$row
->{
$this
->
f›ld_®Ÿs
};

46 ià(!
	`is_num”ic
(
$nid
)) {

50 
$™em_Ëngth
 = 
$this
->
İtiÚs
['item_length'];

51 ià(
$™em_Ëngth
 == 'default') {

52 
$™em_Ëngth
 = 
	`v¬ŸbË_g‘
('feed_item_length', 'teaser');

56 
$node
 = 
	`node_lßd
(
$nid
);

57 ià(
	`em±y
(
$node
)) {

61 
$node
->
bud_mode
 = 
NODE_BUILD_RSS
;

63 ià(
$™em_Ëngth
 != 'title') {

64 
$‹a£r
 = (
$™em_Ëngth
 =ğ'‹a£r'è? 
TRUE
 : 
FALSE
;

67 ià(
	`node_hook
(
$node
, 'view')) {

68 
$node
 = 
	`node_švoke
($node, 'v›w', 
$‹a£r
, 
FALSE
);

71 
$node
 = 
	`node_´•¬e
($node, 
$‹a£r
);

75 
	`node_švoke_nod—pi
(
$node
, 'v›w', 
$‹a£r
, 
FALSE
);

80 
$cÚ‹Á
 = 
	`dru·l_»nd”
(
$node
->
cÚ‹Á
);

81 ià(
$‹a£r
) {

82 
$node
->
‹a£r
 = 
$cÚ‹Á
;

83 
	`un£t
(
$node
->
body
);

86 
$node
->
body
 = 
$cÚ‹Á
;

87 
	`un£t
(
$node
->
‹a£r
);

91 
	`node_švoke_nod—pi
(
$node
, '®‹r', 
$‹a£r
, 
FALSE
);

93 
$™em
 = 
Ãw
 
	`¡dCÏss
();

94 
$™em
->
t™Ë
 = 
$node
->title;

95 
$™em
->
lšk
 = 
	`u¾
("node/$row->nid", 
	`¬¿y
('absŞu‹' => 
TRUE
));

96 
$™em
->
nid
 = 
$node
->nid;

97 
$™em
->
»admÜe
 = 
$node
->readmore;

100 
$exŒa
 = 
	`node_švoke_nod—pi
(
$node
, 'rss item');

101 
$™em
->
–em’ts
 = 
	`¬¿y_m”ge
(
$exŒa
,

102 
	`¬¿y
(

103 
	`¬¿y
('key' => 'pubD©e', 'v®ue' => 
	`gmd©e
('r', 
$node
->
ü—‹d
)),

104 
	`¬¿y
(

106 'v®ue' => 
$node
->
Çme
,

107 'Çme¥aû' => 
	`¬¿y
('xmlns:dc' => 'http://purl.org/dc/elements/1.1/'),

109 
	`¬¿y
(

111 'v®ue' => 
$node
->
nid
 . '‡ˆ' . 
$ba£_u¾
,

112 '©Œibu‹s' => 
	`¬¿y
('isPermaLink' => 'false')

117 
	`fÜ—ch
 (
$™em
->
–em’ts
 
as
 
$–em’t
) {

118 ià(
	`is£t
(
$–em’t
['namespace'])) {

119 
$this
->
v›w
->
¡yË_¶ugš
->
Çme¥aûs
 = 
	`¬¿y_m”ge
($this->v›w->¡yË_¶ugš->Çme¥aûs, 
$–em’t
['namespace']);

124 
$™em_Ëngth
) {

126 
$™em
->
desütiÚ
 = 
$node
->
body
;

129 
$™em
->
desütiÚ
 = 
$node
->
‹a£r
;

130 ià(!
	`em±y
(
$™em
->
»admÜe
)) {

131 
$™em
->
desütiÚ
 .ğ'<p>' . 
	`l
(
	`t
('»ad mÜe'), 'node/' . $™em->
nid
, 
	`¬¿y
('absŞu‹' => 
TRUE
, 'attributes' =>‡rray('target' => '_blank'))) . '</p>';

135 
$™em
->
desütiÚ
 = '';

139  
	`theme
(
$this
->
	`theme_funùiÚs
(), $this->
v›w
, $this->
İtiÚs
, 
$™em
);

140 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_plugin_row_node_view.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_row_node_v›w
 
ex‹nds
 
	mv›ws_¶ugš_row
 {

15 
v¬
 
	m$ba£_bË
 = 'node';

16 
v¬
 
	m$ba£_f›ld
 = 'nid';

18 
funùiÚ
 
	$š™
(&
$v›w
, &
$di¥Ïy
, 
$İtiÚs
 = 
NULL
) {

19 
·»Á
::
	`š™
(
$v›w
, 
$di¥Ïy
, 
$İtiÚs
);

21 ià(
	`is£t
(
$this
->
İtiÚs
['teaser'])) {

22 
$this
->
İtiÚs
['build_mode'] = $this->options['teaser'] ? 'teaser' : 'full';

26 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

27 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

29 
$İtiÚs
['bud_mode'] = 
	`¬¿y
('default' => 'teaser');

30 
$İtiÚs
['lšks'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

31 
$İtiÚs
['comm’ts'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

33  
$İtiÚs
;

34 
	}
}

36 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

37 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

42 ià(
$modes
 = 
	`moduË_švoke
('content', 'build_modes')) {

43 
$İtiÚs
 = 
	`¬¿y
();

44 
	`fÜ—ch
 (
$modes
 
as
 
$key
 => 
$v®ue
) {

45 ià(
	`is£t
(
$v®ue
['views style']) && $value['views style']) {

46 
$İtiÚs
[
$key
] = 
$v®ue
['title'];

51 
$İtiÚs
 = 
	`¬¿y
(

52 '‹a£r' => 
	`t
('Teaser'),

53 'fuÎ' => 
	`t
('Full‚ode')

56 
$fÜm
['bud_mode'] = 
	`¬¿y
(

58 '#İtiÚs' => 
$İtiÚs
,

59 '#t™Ë' => 
	`t
('Build mode'),

60 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['build_mode'],

62 
$fÜm
['lšks'] = 
	`¬¿y
(

64 '#t™Ë' => 
	`t
('Display†inks'),

65 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['links'],

67 
$fÜm
['comm’ts'] = 
	`¬¿y
(

69 '#t™Ë' => 
	`t
('Display‚ode comments'),

70 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['comments'],

72 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/poll.views.inc

1 <?
php


18 
funùiÚ
 
	$pŞl_v›ws_d©a
() {

20 
$d©a
['pŞl']['bË']['group'] = 
	`t
('Poll');

23 
$d©a
['pŞl']['bË']['još'] = 
	`¬¿y
(

24 'node' => 
	`¬¿y
(

34 
$d©a
['pŞl']['aùive'] = 
	`¬¿y
(

35 't™Ë' => 
	`t
('Active'),

36 'h–p' => 
	`t
('Whetherhe…oll is open for voting.'),

37 'f›ld' => 
	`¬¿y
(

39 'şick sÜbË' => 
TRUE
,

41 'f‹r' => 
	`¬¿y
(

43 'Ïb–' => 
	`t
('Active'),

46 'sÜt' => 
	`¬¿y
(

51  
$d©a
;

52 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/profile.views.inc

1 <?
php


17 
funùiÚ
 
	$´ofe_v›ws_d©a
() {

20 
$d©a
['´ofe_v®ues']['bË']['group'] = 
	`t
('Profile');

22 
$d©a
['´ofe_v®ues']['bË']['još'] = 
	`¬¿y
(

23 'node' => 
	`¬¿y
(

28 'u£rs' => 
	`¬¿y
(

35 
$f›lds
 = 
	`´ofe_v›ws_g‘_f›lds
();

36 
	`fÜ—ch
(
$f›lds
 
as
 
$f›ld
) {

37 
$bË_Çme
 = '´ofe_v®ues_' . 
$f›ld
->
Çme
;

38 
$d©a
[
$bË_Çme
] = 
	`¬¿y
(

39 'bË' => 
	`¬¿y
(

40 'group' => 
	`t
('Profile'),

41 'još' => 
	`¬¿y
(

42 'node' => 
	`¬¿y
(

47 'exŒa' => 
	`¬¿y
×¼ay('f›ld' => 'fid', 'v®ue' => 
$f›ld
->
fid
)),

49 'u£rs' => 
	`¬¿y
(

53 'exŒa' => 
	`¬¿y
×¼ay('f›ld' => 'fid', 'v®ue' => 
$f›ld
->
fid
)),

59 
$d©a
[
$bË_Çme
]['v®ue'] = 
	`´ofe_v›ws_ãtch_f›ld
(
$f›ld
);

62  
$d©a
;

63 
	}
}

68 
funùiÚ
 
	$´ofe_v›ws_g‘_f›lds
() {

69 
$f›lds
 = 
NULL
;

71 ià(!
	`is£t
(
$f›lds
)) {

72 
$f›lds
 = 
	`¬¿y
();

73 
$»suÉs
 = 
	`db_qu”y
("SELECT * FROM {profile_fields} ORDER BY category, weight");

75 
$row
 = 
	`db_ãtch_objeù
(
$»suÉs
)) {

76 ià(!
	`em±y
(
$row
->
İtiÚs
)) {

77 ià(!
	`š_¬¿y
(
	`sub¡r
(
$row
->
İtiÚs
, 0, 2), 
	`¬¿y
('a:', 'b:', 'i:', 'f:', 'o:', 's:', ))) {

79 
$İtiÚs
 = 
$row
->
İtiÚs
;

80 
	`un£t
(
$row
->
İtiÚs
);

81 
$row
->
İtiÚs
 = 
$İtiÚs
;

85 
$row
->
İtiÚs
 = 
	`un£rŸlize
(
	`db_decode_blob
($row->options));

88 
$f›lds
[
$row
->
fid
] = $row;

91  
$f›lds
;

92 
	}
}

98 
funùiÚ
 
	$´ofe_v›ws_ãtch_f›ld
(
$f›ld
) {

99 
$d©a
 = 
	`¬¿y
(

100 't™Ë' => 
	`t
('@ÿ‹gÜy: @f›ld-Çme', 
	`¬¿y
('@ÿ‹gÜy' => 
$f›ld
->
ÿ‹gÜy
, '@f›ld-Çme' => $f›ld->
t™Ë
)),

104 
$f›ld
->
ty³
) {

106 
$d©a
 +ğ
	`¬¿y
(

107 'h–p' => 
	`t
('Profileextfield'),

108 'f›ld' => 
	`¬¿y
(

110 'şick sÜbË' => 
TRUE
,

112 'sÜt' => 
	`¬¿y
(

115 'f‹r' => 
	`¬¿y
(

118 '¬gum’t' => 
	`¬¿y
(

125 
$d©a
 +ğ
	`¬¿y
(

126 'h–p' => 
	`t
('Profileextarea'),

127 'f›ld' => 
	`¬¿y
(

129 'fÜm©' => 
FILTER_FORMAT_DEFAULT
,

131 'sÜt' => 
	`¬¿y
(

134 'f‹r' => 
	`¬¿y
(

141 
$d©a
 +ğ
	`¬¿y
(

142 'h–p' => 
	`t
('Profile checkbox'),

143 'f›ld' => 
	`¬¿y
(

145 'şick sÜbË' => 
TRUE
,

147 'sÜt' => 
	`¬¿y
(

150 'f‹r' => 
	`¬¿y
(

158 
$d©a
 +ğ
	`¬¿y
(

159 'h–p' => 
	`t
('Profile URL'),

160 'f›ld' => 
	`¬¿y
(

162 'şick sÜbË' => 
TRUE
,

164 'sÜt' => 
	`¬¿y
(

167 'f‹r' => 
	`¬¿y
(

174 
$d©a
 +ğ
	`¬¿y
(

175 'h–p' => 
	`t
('Profile selection'),

176 'f›ld' => 
	`¬¿y
(

178 'şick sÜbË' => 
TRUE
,

180 'sÜt' => 
	`¬¿y
(

183 'f‹r' => 
	`¬¿y
(

185 'fid' => 
$f›ld
->
fid
,

187 '¬gum’t' => 
	`¬¿y
(

194 
$d©a
 +ğ
	`¬¿y
(

195 'h–p' => 
	`t
('Profä“fÜm†i¡ %f›ld-Çme.', 
	`¬¿y
('%f›ld-Çme' => 
$f›ld
->
t™Ë
)),

196 'f›ld' => 
	`¬¿y
(

199 'f‹r' => 
	`¬¿y
(

206 
$d©a
 +ğ
	`¬¿y
(

207 'h–p' => 
	`t
('Profd©%f›ld-Çme.', 
	`¬¿y
('%f›ld-Çme' => 
$f›ld
->
t™Ë
)),

208 'f›ld' => 
	`¬¿y
(

217  
$d©a
;

218 
	}
}

224 
funùiÚ
 
	$´ofe_v›ws_hªdËrs
() {

225  
	`¬¿y
(

226 'šfo' => 
	`¬¿y
(

227 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/profile',

229 'hªdËrs' => 
	`¬¿y
(

230 'v›ws_hªdËr_f›ld_´ofe_d©e' => 
	`¬¿y
(

233 'v›ws_hªdËr_f›ld_´ofe_li¡' => 
	`¬¿y
(

236 'v›ws_hªdËr_f‹r_´ofe_£ËùiÚ' => 
	`¬¿y
(

241 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/profile.views_convert.inc

1 <?
php


16 
funùiÚ
 
	$´ofe_v›ws_cÚv”t
(
$di¥Ïy
, 
$ty³
, &
$v›w
, 
$f›ld
, 
$id
 = 
NULL
) {

17 
$´ofe_f›lds
;

18 ià(!
	`is£t
(
$´ofe_f›lds
)) {

19 
$´ofe_f›lds
 = 
	`¬¿y
();

20 
	`fÜ—ch
 (
	`´ofe_v›ws_g‘_f›lds
(è
as
 
$´ofe_f›ld
) {

21 
$´ofe_f›lds
['´ofe_v®ues_'. 
$´ofe_f›ld
->
Çme
] = $profile_field;

24 
$ty³
) {

26 ià(
	`is£t
(
$bËs
[
$f›ld
['tablename']])) {

27 
$´ofe_f›lds
[
$f›ld
['bËÇme']]->
ty³
) {

30 
$İ”©Üs
 = 
	`¬¿y
('AND' => 'in', 'OR' => 'in', 'NOR' => 'not in');

31 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'İ”©Ü', 
$İ”©Üs
[
$f›ld
['operator']]);

34 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'İ”©Ü', 
$f›ld
['operator']);

40 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/profile/views_handler_field_profile_date.inc

1 <?
php


9 şas 
	cv›ws_hªdËr_f›ld_´ofe_d©e
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_d©e
 {

10 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

11 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

13 
	`un£t
(
$fÜm
['date_format']['#options']['time‡go']);

19 
funùiÚ
 
	$»nd”
(
$v®ue
) {

20 ià(!
$v®ue
->{
$this
->
f›ld_®Ÿs
}) {

23 
$v®ue
 = 
	`un£rŸlize
($v®ue->{
$this
->
f›ld_®Ÿs
});

24 
$fÜm©
 = 
$this
->
İtiÚs
['date_format'];

25 
$fÜm©
) {

27 
$fÜm©
 = 
$this
->
İtiÚs
['custom_date_format'];

30 
$fÜm©
 = 
	`v¬ŸbË_g‘
('date_format_short', 'm/d/Y - H:i');

33 
$fÜm©
 = 
	`v¬ŸbË_g‘
('date_format_medium', 'D, m/d/Y - H:i');

36 
$fÜm©
 = 
	`v¬ŸbË_g‘
('date_format_long', 'l, F j, Y - H:i');

45 
$d©e
 = 
	`gmmktime
(0, 0, 0, 
$v®ue
['month'], $value['day'], 1970);

46 
$»¶aû
 = 
	`¬¿y
(

48 'd' => 
	`¥rštf
('%02d', 
$v®ue
['day']),

49 'D' => 
NULL
,

50 'l' => 
NULL
,

51 'N' => 
NULL
,

52 'S' => 
	`d©e
('S', 
$d©e
),

53 'w' => 
NULL
,

54 'j' => 
$v®ue
['day'],

56 'F' => 
	`d©e
('F', 
$d©e
),

57 'm' => 
	`¥rštf
('%02d', 
$v®ue
['month']),

58 'M' => 
	`d©e
('M', 
$d©e
),

59 'n' => 
	`d©e
('n', 
$d©e
),

61 'Y' => 
$v®ue
['year'],

62 'y' => 
	`sub¡r
(
$v®ue
['year'], 2, 2),

65 'a' => 
NULL
,

66 'A' => 
NULL
,

67 'g' => 
NULL
,

68 'G' => 
NULL
,

69 'h' => 
NULL
,

70 'H' => 
NULL
,

71 'i' => 
NULL
,

72 's' => 
NULL
,

73 ':' => 
NULL
,

74 'T' => 
NULL
,

75 ' - ' => 
NULL
,

76 ':' => 
NULL
,

79  
	`¡¹r
(
$fÜm©
, 
$»¶aû
);

80 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/profile/views_handler_field_profile_list.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_´ofe_li¡
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_´”’d”_li¡
 {

10 
funùiÚ
 
	$´e_»nd”
(
$v®ues
) {

11 
$this
->
™ems
 = 
	`¬¿y
();

12 
	`fÜ—ch
 (
$v®ues
 
as
 
$v®ue
) {

13 
$f›ld
 = 
$v®ue
->{
$this
->
f›ld_®Ÿs
};

14 
$this
->
™ems
[
$f›ld
] = 
	`¬¿y
();

15 
	`fÜ—ch
 (
	`¥l™
("[,\n\r]", 
$f›ld
è
as
 
$™em
) {

16 ià(
$™em
 !ğ'' && $™em !=ğ
NULL
) {

17 
$this
->
™ems
[
$f›ld
][] = 
	`¬¿y
('™em' => 
$™em
);

23 
funùiÚ
 
	$»nd”_™em
(
$couÁ
, 
$™em
) {

24  
$™em
['item'];

25 
	}
}

27 
funùiÚ
 
	$docum’t_£lf_tok’s
(&
$tok’s
) {

28 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-™em' . ']'] = 
	`t
('Theext ofhe…rofile item.');

29 
	}
}

31 
funùiÚ
 
	$add_£lf_tok’s
(&
$tok’s
, 
$™em
) {

32 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-™em' . ']'] = 
$™em
['item'];

33 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/profile/views_handler_filter_profile_selection.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_´ofe_£ËùiÚ
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_š_İ”©Ü
 {

8 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

9 ià(
	`is£t
(
$this
->
v®ue_İtiÚs
)) {

13 
$this
->
v®ue_İtiÚs
 = 
	`¬¿y
();

14 
$®l_İtiÚs
 = 
	`´ofe_v›ws_g‘_f›lds
();

15 
$f›ld
 = 
$®l_İtiÚs
[
$this
->
defš™iÚ
['fid']];

17 
$lšes
 = 
	`¥l™
("[,\n\r]", 
$f›ld
->
İtiÚs
);

18 
	`fÜ—ch
 (
$lšes
 
as
 
$lše
) {

19 ià(
$lše
 = 
	`Œim
($line)) {

20 
$this
->
v®ue_İtiÚs
[
$lše
] = $line;

24 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search.views.inc

1 <?
php


18 
funùiÚ
 
	$£¬ch_v›ws_d©a
() {

23 
$d©a
['£¬ch_šdex']['bË']['group'] = 
	`t
('Search');

26 
$d©a
['£¬ch_šdex']['bË']['još'] = 
	`¬¿y
(

27 'node' => 
	`¬¿y
(

33 
$d©a
['£¬ch_tÙ®']['bË']['još'] = 
	`¬¿y
(

34 'node' => 
	`¬¿y
(

39 'u£rs' => 
	`¬¿y
(

46 
$d©a
['£¬ch_d©a£t']['bË']['još'] = 
	`¬¿y
(

47 'node' => 
	`¬¿y
(

54 'u£rs' => 
	`¬¿y
(

67 
$d©a
['£¬ch_šdex']['scÜe'] = 
	`¬¿y
(

68 't™Ë' => 
	`t
('Score'),

69 'h–p' => 
	`t
('The score ofhe search item. This will‚ot be used ifhe search filter is‚ot‡lso…resent.'),

70 'f›ld' => 
	`¬¿y
(

72 'şick sÜbË' => 
TRUE
,

73 'æßt' => 
TRUE
,

76 'sÜt' => 
	`¬¿y
(

82 
$d©a
['£¬ch_node_lšks_äom']['bË']['group'] = 
	`t
('Search');

83 
$d©a
['£¬ch_node_lšks_äom']['bË']['još'] = 
	`¬¿y
(

84 'node' => 
	`¬¿y
(

85 '¬gum’ts' => 
	`¬¿y
('£¬ch_node_lšks', 'node', 'nid', 'nid', 
NULL
, 'INNER'),

88 
$d©a
['£¬ch_node_lšks_äom']['sid'] = 
	`¬¿y
(

89 't™Ë' => 
	`t
('Links from'),

90 'h–p' => 
	`t
('Other‚odeshat‡re†inked fromhe‚ode.'),

91 '¬gum’t' => 
	`¬¿y
(

94 'f‹r' => 
	`¬¿y
(

100 
$d©a
['£¬ch_node_lšks_to']['bË']['group'] = 
	`t
('Search');

101 
$d©a
['£¬ch_node_lšks_to']['bË']['još'] = 
	`¬¿y
(

102 'node' => 
	`¬¿y
(

103 '¬gum’ts' => 
	`¬¿y
('£¬ch_node_lšks', 'node', 'nid', 'sid', 
NULL
, 'INNER'),

106 
$d©a
['£¬ch_node_lšks_to']['nid'] = 
	`¬¿y
(

107 't™Ë' => 
	`t
('Linkso'),

108 'h–p' => 
	`t
('Other‚odeshat†inkohe‚ode.'),

109 '¬gum’t' => 
	`¬¿y
(

112 'f‹r' => 
	`¬¿y
(

118 
$d©a
['£¬ch_šdex']['keys'] = 
	`¬¿y
(

119 't™Ë' => 
	`t
('Search Terms'),

120 'h–p' => 
	`t
('Theermso search for.'),

122 'f‹r' => 
	`¬¿y
(

127  
$d©a
;

128 
	}
}

134 
funùiÚ
 
	$£¬ch_v›ws_hªdËrs
() {

135  
	`¬¿y
(

136 'šfo' => 
	`¬¿y
(

137 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/search',

139 'hªdËrs' => 
	`¬¿y
(

140 'v›ws_hªdËr_f›ld_£¬ch_scÜe' => 
	`¬¿y
(

143 'v›ws_hªdËr_sÜt_£¬ch_scÜe' => 
	`¬¿y
(

146 'v›ws_hªdËr_f‹r_£¬ch' => 
	`¬¿y
(

151 
	}
}

156 
funùiÚ
 
	$£¬ch_v›ws_¶ugšs
() {

159  
	`¬¿y
(

161 'row' => 
	`¬¿y
(

162 '£¬ch' => 
	`¬¿y
(

163 't™Ë' => 
	`t
('Search'),

164 'h–p' => 
	`t
('Displayhe„esults with standard search view.'),

166 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/search',

168 'ba£' => 
	`¬¿y
('node'),

173 
	}
}

178 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_row_£¬ch
(&
$v¬s
) {

179 
$v¬s
['node'] = '';

180 
$nid
 = 
$v¬s
['row']->
nid
;

181 ià(!
	`is_num”ic
(
$nid
)) {

185 
$node
 = 
	`node_lßd
(
$nid
);

187 ià(
	`em±y
(
$node
)) {

192 
$node
 = 
	`node_bud_cÚ‹Á
($node, 
FALSE
, FALSE);

193 
$node
->
body
 = 
	`dru·l_»nd”
($node->
cÚ‹Á
);

196 
$node
->
body
 .ğ
	`moduË_švoke
('comment', 'nodeapi', $node, 'update index');

199 
$node
->
body
 .ğ
	`moduË_švoke
('taxonomy', 'nodeapi', $node, 'update index');

201 
$v¬s
['u¾'] = 
	`u¾
('node/' . 
$nid
);

202 
$v¬s
['t™Ë'] = 
	`check_¶aš
(
$node
->
t™Ë
);

204 
$šfo
 = 
	`¬¿y
();

205 
$šfo
['ty³'] = 
	`node_g‘_ty³s
('Çme', 
$node
);

206 
$šfo
['u£r'] = 
	`theme
('u£ºame', 
$node
);

207 
$šfo
['d©e'] = 
	`fÜm©_d©e
(
$node
->
chªged
, 'small');

208 
$exŒa
 = 
	`node_švoke_nod—pi
(
$node
, 'search„esult');

209 ià(
	`is£t
(
$exŒa
è&& 
	`is_¬¿y
($extra)) {

210 
$šfo
 = 
	`¬¿y_m”ge
($šfo, 
$exŒa
);

212 
$v¬s
['šfo_¥l™'] = 
$šfo
;

213 
$v¬s
['šfo'] = 
	`im¶ode
(' - ', 
$šfo
);

215 
$v¬s
['node'] = 
$node
;

218 
$v¬s
['¢³t'] = 
	`£¬ch_exû½t
($v¬s['v›w']->
v®ue
, 
$node
->
body
);

219 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search.views_convert.inc

1 <?
php


9 
funùiÚ
 
	$£¬ch_v›ws_cÚv”t
(
$di¥Ïy
, 
$ty³
, &
$v›w
, 
$f›ld
, 
$id
 = 
NULL
) {

10 
$ty³
) {

12 
$f›ld
['tablename']) {

14 
$f›ld
['field']) {

16 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'table', 'search_index');

17 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'field', 'keys');

24 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search.views_default.inc

1 <?
php


11 
funùiÚ
 
	$£¬ch_v›ws_deçuÉ_v›ws
() {

12 
$v›w
 = 
Ãw
 
v›w
;

13 
$v›w
->
Çme
 = 'backlinks';

14 
$v›w
->
desütiÚ
 = 'Displays‡†ist of‚odeshat†inkohe‚ode, usinghe search backlinksable.';

15 
$v›w
->
g
 = 'default';

16 
$v›w
->
v›w_php
 = '';

17 
$v›w
->
ba£_bË
 = 'node';

18 
$v›w
->
is_ÿch—bË
 = '0';

19 
$v›w
->
­i_v”siÚ
 = 2;

20 
$v›w
->
di§bËd
 = 
TRUE
;

21 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('default', 'Defaults', 'default');

22 
$hªdËr
->
	`ov”ride_İtiÚ
('f›lds', 
	`¬¿y
(

23 't™Ë' => 
	`¬¿y
(

32 
$hªdËr
->
	`ov”ride_İtiÚ
('¬gum’ts', 
	`¬¿y
(

33 'nid' => 
	`¬¿y
(

39 '¡yË_İtiÚs' => 
	`¬¿y
(

40 'couÁ' => 
TRUE
,

41 'ov”ride' => 
FALSE
,

54 'v®id©e_¬gum’t_node_ty³' => 
	`¬¿y
(),

58 
$hªdËr
->
	`ov”ride_İtiÚ
('f‹rs', 
	`¬¿y
(

59 '¡©us' => 
	`¬¿y
(

66 'expo£d' => 
FALSE
,

67 'expo£' => 
	`¬¿y
(

68 'İ”©Ü' => 
FALSE
,

74 
$hªdËr
->
	`ov”ride_İtiÚ
('acûss', 
	`¬¿y
(

76 'rŞe' => 
	`¬¿y
(),

79 
$hªdËr
->
	`ov”ride_İtiÚ
('empty', 'No backlinks found.');

80 
$hªdËr
->
	`ov”ride_İtiÚ
('empty_format', '1');

81 
$hªdËr
->
	`ov”ride_İtiÚ
('items_per_page', 30);

82 
$hªdËr
->
	`ov”ride_İtiÚ
('use_pager', '1');

83 
$hªdËr
->
	`ov”ride_İtiÚ
('style_plugin', 'list');

84 
$hªdËr
->
	`ov”ride_İtiÚ
('¡yË_İtiÚs', 
	`¬¿y
(

87 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('page', 'Page', 'page');

88 
$hªdËr
->
	`ov”ride_İtiÚ
('path', 'node/%/backlinks');

89 
$hªdËr
->
	`ov”ride_İtiÚ
('m’u', 
	`¬¿y
(

94 
$hªdËr
->
	`ov”ride_İtiÚ
('b_İtiÚs', 
	`¬¿y
(

99 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('block', 'Block', 'block');

100 
$hªdËr
->
	`ov”ride_İtiÚ
('¬gum’ts', 
	`¬¿y
(

101 'nid' => 
	`¬¿y
(

107 '¡yË_İtiÚs' => 
	`¬¿y
(

108 'couÁ' => 
TRUE
,

109 'ov”ride' => 
FALSE
,

122 'v®id©e_¬gum’t_node_ty³' => 
	`¬¿y
(

132 'v®id©e_¬gum’t_voÿbuÏry' => 
	`¬¿y
(

142 
$hªdËr
->
	`ov”ride_İtiÚ
('items_per_page', 6);

143 
$hªdËr
->
	`ov”ride_İtiÚ
('use_more', 1);

144 
$hªdËr
->
	`ov”ride_İtiÚ
('style_plugin', 'list');

145 
$hªdËr
->
	`ov”ride_İtiÚ
('¡yË_İtiÚs', 
	`¬¿y
(

148 
$hªdËr
->
	`ov”ride_İtiÚ
('block_description', 'What†inks here');

149 
$v›ws
[
$v›w
->
Çme
] = $view;

151  
$v›ws
;

152 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search/views_handler_field_search_score.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_£¬ch_scÜe
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_num”ic
 {

8 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

9 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

11 
$İtiÚs
['®‹º©e_sÜt'] = 
	`¬¿y
('default' => '');

12 
$İtiÚs
['®‹º©e_Üd”'] = 
	`¬¿y
('default' => 'asc');

14  
$İtiÚs
;

17 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

18 
$¡yË_İtiÚs
 = 
$this
->
v›w
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('style_options');

19 ià(
	`is£t
(
$¡yË_İtiÚs
['deçuÉ']è&& $¡yË_İtiÚs['deçuÉ'] =ğ
$this
->
İtiÚs
['id']) {

20 
$hªdËrs
 = 
$this
->
v›w
->
di¥Ïy_hªdËr
->
	`g‘_hªdËrs
('field');

21 
$İtiÚs
 = 
	`¬¿y
('' => 
	`t
('No‡lternate'));

22 
	`fÜ—ch
 (
$hªdËrs
 
as
 
$id
 => 
$hªdËr
) {

23 
$İtiÚs
[
$id
] = 
$hªdËr
->
	`ui_Çme
();

26 
$fÜm
['®‹º©e_sÜt'] = 
	`¬¿y
(

28 '#t™Ë' => 
	`t
('Alternative sort'),

29 '#desütiÚ' => 
	`t
('If‚o search is…erformed‡ndhis field does‚ot‡ppear,…ick‡n‡lternative defaultable sort field.'),

30 '#İtiÚs' => 
$İtiÚs
,

31 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alternate_sort'],

34 
$fÜm
['®‹º©e_Üd”'] = 
	`¬¿y
(

36 '#t™Ë' => 
	`t
('Alternate sort order'),

37 '#İtiÚs' => 
	`¬¿y
('asc' => 
	`t
('Ascending'), 'desc' =>('Descending')),

38 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alternate_order'],

42 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

43 
	}
}

45 
funùiÚ
 
	$qu”y
() {

50 
	`fÜ—ch
 (
$this
->
v›w
->
f‹r
 
as
 
$hªdËr
) {

51 ià(
	`is£t
(
$hªdËr
->
£¬ch_scÜe
è&& $hªdËr->
»ÏtiÚsh
 =ğ
$this
->relationship) {

52 
$this
->
f›ld_®Ÿs
 = 
$hªdËr
->
£¬ch_scÜe
;

53 
$this
->
bË_®Ÿs
 = 
$hªdËr
->table_alias;

59 
$this
->
İtiÚs
['exşude'] = 
TRUE
;

60 ià(!
	`em±y
(
$this
->
İtiÚs
['alternate_sort'])) {

61 ià(
	`is£t
(
$this
->
v›w
->
¡yË_¶ugš
->
İtiÚs
['default']) && $this->view->style_plugin->options['default'] == $this->options['id']) {

63 
$this
->
v›w
->
¡yË_¶ugš
->
İtiÚs
['default'] = $this->options['alternate_sort'];

64 
$this
->
v›w
->
¡yË_¶ugš
->
İtiÚs
['order'] = $this->options['alternate_order'];

67 
	}
}

69 
funùiÚ
 
	$şick_sÜt
(
$Üd”
) {

70 ià(
	`is£t
(
$this
->
bË_®Ÿs
)) {

71 
$this
->
qu”y
->
	`add_Üd”by
(
NULL
, NULL, 
$Üd”
, $this->
f›ld_®Ÿs
);

73 
	}
}

75 
funùiÚ
 
	$»nd”
(
$v®ues
) {

77 ià(
	`is£t
(
$this
->
bË_®Ÿs
)) {

78  
·»Á
::
	`»nd”
(
$v®ues
);

80 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search/views_handler_filter_search.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_£¬ch
 
ex‹nds
 
	mv›ws_hªdËr_f‹r
 {

8 
v¬
 
	m$no_sšgË
 = 
TRUE
;

9 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

10 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

12 
$İtiÚs
['operator']['default'] = 'optional';

14  
$İtiÚs
;

20 
funùiÚ
 
	$İ”©Ü_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

21 
$fÜm
['İ”©Ü'] = 
	`¬¿y
(

23 '#t™Ë' => 
	`t
('Onƒmpty input'),

24 '#deçuÉ_v®ue' => 
$this
->
İ”©Ü
,

25 '#İtiÚs' => 
	`¬¿y
(

26 'İtiÚ®' => 
	`t
('Show All'),

27 '»quœed' => 
	`t
('Show None'),

30 
	}
}

35 
funùiÚ
 
	$expo£d_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

36 ià(
	`is£t
(
$this
->
İtiÚs
['expose']['identifier'])) {

37 
$key
 = 
$this
->
İtiÚs
['expose']['identifier'];

38 
$fÜm
[
$key
] = 
	`¬¿y
(

41 '#deçuÉ_v®ue' => 
$this
->
v®ue
,

42 '#©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
	`t
('Enterheerms you wisho search for.')),

45 
	}
}

50 
funùiÚ
 
	$expo£d_v®id©e
(
$fÜm
, &
$fÜm_¡©e
) {

51 ià(!
	`is£t
(
$this
->
İtiÚs
['expose']['identifier'])) {

55 
$key
 = 
$this
->
İtiÚs
['expose']['identifier'];

56 ià(!
	`em±y
(
$fÜm_¡©e
['v®ues'][
$key
])) {

57 
$this
->
£¬ch_qu”y
 = 
	`£¬ch_·r£_qu”y
(
$fÜm_¡©e
['v®ues'][
$key
]);

59 ià(
$this
->
£¬ch_qu”y
[2] == '') {

60 
	`fÜm_£t_”rÜ
(
$key
, 
	`t
('You mu¡ inşud©†—¡ oÃ…os™ivkeywÜd w™h @couÁ ch¬aù” Ü mÜe.', 
	`¬¿y
('@couÁ' => 
	`v¬ŸbË_g‘
('minimum_word_size', 3))));

62 ià(
$this
->
£¬ch_qu”y
[6]) {

63 ià(
$this
->
£¬ch_qu”y
[6] == 'or') {

64 
	`dru·l_£t_mes§ge
(
	`t
('Search forƒither ofhewoerms with uppercase <strong>OR</strong>. Forƒxample, <strong>cats OR dogs</strong>.'));

68 
	}
}

77 
funùiÚ
 
	$qu”y
() {

78 ià(!
	`is£t
(
$this
->
£¬ch_qu”y
è|| 
	`em±y
($this->search_query[3])) {

79 ià(
$this
->
İ”©Ü
 == 'required') {

80 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], 'FALSE');

84 
$£¬ch_šdex
 = 
$this
->
	`’su»_my_bË
();

85 
$this
->
£¬ch_qu”y
[2] = 
	`¡r_»¶aû
('i.', "$search_index.", $this->search_query[2]);

88 
$još
 = 
Ãw
 
v›ws_još
;

89 
$još
->
	`cÚ¡ruù
('£¬ch_tÙ®', 
$£¬ch_šdex
, 'word', 'word');

90 
$£¬ch_tÙ®
 = 
$this
->
qu”y
->
	`add_»ÏtiÚsh
('£¬ch_tÙ®', 
$još
, 
$£¬ch_šdex
);

92 
$this
->
£¬ch_scÜe
 = $this->
qu”y
->
	`add_f›ld
('', "SUM($£¬ch_šdex.scÜ* $£¬ch_tÙ®.couÁ)", 'scÜe', 
	`¬¿y
('agg»g©e' => 
TRUE
));

94 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], $this->
£¬ch_qu”y
[2], $this->search_query[3]);

96 ià(
	`em±y
(
$this
->
qu”y
->
»ÏtiÚshs
[$this->
»ÏtiÚsh
])) {

97 
$ba£_bË
 = 
$this
->
qu”y
->
ba£_bË
;

100 
$ba£_bË
 = 
$this
->
qu”y
->
»ÏtiÚshs
[$this->
»ÏtiÚsh
]['base'];

102 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$£¬ch_šdex.ty³ = '%s'", 
$ba£_bË
);

103 ià(!
$this
->
£¬ch_qu”y
[5]) {

104 
$£¬ch_d©a£t
 = 
$this
->
qu”y
->
	`add_bË
('search_dataset');

105 
$this
->
£¬ch_qu”y
[0] = 
	`¡r_»¶aû
('d.', "$search_dataset.", $this->search_query[0]);

106 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], $this->
£¬ch_qu”y
[0], $this->search_query[1]);

109 
$this
->
qu”y
->
	`add_groupby
("$search_index.sid");

110 
$this
->
qu”y
->
	`add_havšg
($this->
İtiÚs
['group'], 'COUNT(*è>ğ%d', $this->
£¬ch_qu”y
[4]);

112 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search/views_handler_sort_search_score.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_sÜt_£¬ch_scÜe
 
ex‹nds
 
	mv›ws_hªdËr_sÜt
 {

8 
funùiÚ
 
	$qu”y
() {

13 
	`fÜ—ch
 (
$this
->
v›w
->
f‹r
 
as
 
$hªdËr
) {

14 ià(
	`is£t
(
$hªdËr
->
£¬ch_scÜe
è&& $hªdËr->
»ÏtiÚsh
 =ğ
$this
->relationship) {

15 
$this
->
qu”y
->
	`add_Üd”by
(
NULL
, NULL, $this->
İtiÚs
['Üd”'], 
$hªdËr
->
£¬ch_scÜe
);

16 
$this
->
bË_®Ÿs
 = 
$hªdËr
->table_alias;

24 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search/views_plugin_row_search_view.inc

1 <?
php


11 şas 
	cv›ws_¶ugš_row_£¬ch_v›w
 
ex‹nds
 
	mv›ws_¶ugš_row
 {

12 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

13 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

15 
$İtiÚs
['scÜe'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

17  
$İtiÚs
;

20 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

21 
$fÜm
['scÜe'] = 
	`¬¿y
(

23 '#t™Ë' => 
	`t
('Display score'),

24 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['score'],

26 
	}
}

31 
funùiÚ
 
	$»nd”
(
$row
) {

32  
	`theme
(
$this
->
	`theme_funùiÚs
(), $this->
v›w
, $this->
İtiÚs
, 
$row
);

33 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/statistics.views.inc

1 <?
php


18 
funùiÚ
 
	$¡©i¡ics_v›ws_d©a
() {

24 
$d©a
['node_couÁ”']['bË']['group'] = 
	`t
('Node statistics');

26 
$d©a
['node_couÁ”']['bË']['još'] = 
	`¬¿y
(

28 'node' => 
	`¬¿y
(

35 
$d©a
['node_couÁ”']['tÙ®couÁ'] = 
	`¬¿y
(

36 't™Ë' => 
	`t
('Total views'),

37 'h–p' => 
	`t
('Theotal‚umber ofimeshe‚ode has been viewed.'),

39 'f›ld' => 
	`¬¿y
(

41 'şick sÜbË' => 
TRUE
,

43 'f‹r' => 
	`¬¿y
(

46 'sÜt' => 
	`¬¿y
(

52 
$d©a
['node_couÁ”']['daycouÁ'] = 
	`¬¿y
(

53 't™Ë' => 
	`t
('Viewsoday'),

54 'h–p' => 
	`t
('Theotal‚umber ofimeshe‚ode has been viewedoday.'),

56 'f›ld' => 
	`¬¿y
(

58 'şick sÜbË' => 
TRUE
,

60 'f‹r' => 
	`¬¿y
(

63 'sÜt' => 
	`¬¿y
(

69 
$d©a
['node_couÁ”']['time¡amp'] = 
	`¬¿y
(

70 't™Ë' => 
	`t
('Most„ecent view'),

71 'h–p' => 
	`t
('The most„ecentimehe‚ode has been viewed.'),

73 'f›ld' => 
	`¬¿y
(

75 'şick sÜbË' => 
TRUE
,

77 'f‹r' => 
	`¬¿y
(

80 'sÜt' => 
	`¬¿y
(

89 
$d©a
['acûs¦og']['bË']['group'] = 
	`t
('Access†og');

92 
$d©a
['acûs¦og']['bË']['ba£'] = 
	`¬¿y
(

94 't™Ë' => 
	`t
('Access†og'),

95 'h–p' => 
	`t
('Stores site‡ccess information.'),

100 
$d©a
['acûs¦og']['bË']['još'] = 
	`¬¿y
(

101 'u£rs' => 
	`¬¿y
(

108 
$d©a
['acûs¦og']['sid'] = 
	`¬¿y
(

109 't™Ë' => 
	`t
('Session ID'),

110 'h–p' => 
	`t
('Browser session ID of userhat visited…age.'),

112 'f›ld' => 
	`¬¿y
(

114 'şick sÜbË' => 
TRUE
,

116 'f‹r' => 
	`¬¿y
(

119 '¬gum’t' => 
	`¬¿y
(

122 'sÜt' => 
	`¬¿y
(

128 
$d©a
['acûs¦og']['t™Ë'] = 
	`¬¿y
(

129 't™Ë' => 
	`t
('Pageitle'),

130 'h–p' => 
	`t
('Title of…age visited.'),

132 'f›ld' => 
	`¬¿y
(

134 'şick sÜbË' => 
TRUE
,

136 'f‹r' => 
	`¬¿y
(

139 'sÜt' => 
	`¬¿y
(

142 '¬gum’t' => 
	`¬¿y
(

148 
$d©a
['acûs¦og']['·th'] = 
	`¬¿y
(

149 't™Ë' => 
	`t
('Path'),

150 'h–p' => 
	`t
('Internal…atho…age visited (relativeo Drupal„oot.)'),

152 'f›ld' => 
	`¬¿y
(

154 'şick sÜbË' => 
TRUE
,

156 'f‹r' => 
	`¬¿y
(

159 'sÜt' => 
	`¬¿y
(

168 
$d©a
['acûs¦og']['u¾'] = 
	`¬¿y
(

169 't™Ë' => 
	`t
('Referrer'),

170 'h–p' => 
	`t
('Referrer URI.'),

171 'f›ld' => 
	`¬¿y
(

173 'şick sÜbË' => 
TRUE
,

175 'f‹r' => 
	`¬¿y
(

178 'sÜt' => 
	`¬¿y
(

184 
$d©a
['acûs¦og']['ho¡Çme'] = 
	`¬¿y
(

185 't™Ë' => 
	`t
('Hostname'),

186 'h–p' => 
	`t
('Hostname of userhat visitedhe…age.'),

187 'f›ld' => 
	`¬¿y
(

189 'şick sÜbË' => 
TRUE
,

191 'f‹r' => 
	`¬¿y
(

194 'sÜt' => 
	`¬¿y
(

197 '¬gum’t' => 
	`¬¿y
(

203 
$d©a
['acûs¦og']['uid'] = 
	`¬¿y
(

204 't™Ë' => 
	`t
('User'),

205 'h–p' => 
	`t
('The user who visitedhe site.'),

206 '»ÏtiÚsh' => 
	`¬¿y
(

214 
$d©a
['acûs¦og']['tim”'] = 
	`¬¿y
(

215 't™Ë' => 
	`t
('Timer'),

216 'h–p' => 
	`t
('Time in millisecondshathe…ageooko†oad.'),

217 'f›ld' => 
	`¬¿y
(

219 'şick sÜbË' => 
TRUE
,

221 'f‹r' => 
	`¬¿y
(

224 'sÜt' => 
	`¬¿y
(

230 
$d©a
['acûs¦og']['time¡amp'] = 
	`¬¿y
(

231 't™Ë' => 
	`t
('Timestamp'),

232 'h–p' => 
	`t
('Timestamp of whenhe…age was visited.'),

233 'f›ld' => 
	`¬¿y
(

235 'şick sÜbË' => 
TRUE
,

237 'sÜt' => 
	`¬¿y
(

240 'f‹r' => 
	`¬¿y
(

246  
$d©a
;

247 
	}
}

253 
funùiÚ
 
	$¡©i¡ics_v›ws_hªdËrs
() {

254  
	`¬¿y
(

255 'šfo' => 
	`¬¿y
(

256 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/statistics',

258 'hªdËrs' => 
	`¬¿y
(

259 'v›ws_hªdËr_f›ld_acûs¦og_·th' => 
	`¬¿y
(

264 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/statistics.views_convert.inc

1 <?
php


16 
funùiÚ
 
	$¡©i¡ics_v›ws_cÚv”t
(
$di¥Ïy
, 
$ty³
, &
$v›w
, 
$f›ld
, 
$id
 = 
NULL
) {

17 
$ty³
) {

19 
$f›ld
['tablename']) {

21 
$f›ld
['field']) {

23 
$hªdËrs
 = 
	`¬¿y
(

30 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'd©e_fÜm©', 
$hªdËrs
[
$f›ld
['handler']]);

31 ià(!
	`em±y
(
$f›ld
['options'])) {

32 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'cu¡om_d©e_fÜm©', 
$f›ld
['options']);

40 
$f›ld
['tablename']) {

42 
$f›ld
['field']) {

44 
$f›ld
['options'] = $field['options'] == 'normal' ? 'second' : $field['options'];

45 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'sÜt', 
$id
, 'g¿nuÏr™y', 
$f›ld
['options']);

52 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/statistics.views_default.inc

1 <?
php


11 
funùiÚ
 
	$¡©i¡ics_v›ws_deçuÉ_v›ws
() {

12 
$v›w
 = 
Ãw
 
v›w
;

13 
$v›w
->
Çme
 = 'popular';

14 
$v›w
->
desütiÚ
 = 'Showshe most-viewed‚odes onhe site. This„equireshe statisticso beƒnabled‡t‡dminister >>„eports >>‡ccess†og settings.';

15 
$v›w
->
g
 = 'default';

16 
$v›w
->
v›w_php
 = '';

17 
$v›w
->
ba£_bË
 = 'node';

18 
$v›w
->
is_ÿch—bË
 = '0';

19 
$v›w
->
­i_v”siÚ
 = 2;

20 
$v›w
->
di§bËd
 = 
TRUE
;

21 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('default', 'Defaults', 'default');

22 
$hªdËr
->
	`ov”ride_İtiÚ
('f›lds', 
	`¬¿y
(

23 'ty³' => 
	`¬¿y
(

29 't™Ë' => 
	`¬¿y
(

34 'lšk_to_node' => 
TRUE
,

36 'Çme' => 
	`¬¿y
(

41 'lšk_to_u£r' => 
TRUE
,

43 'time¡amp' => 
	`¬¿y
(

54 
$hªdËr
->
	`ov”ride_İtiÚ
('sÜts', 
	`¬¿y
(

55 'tÙ®couÁ' => 
	`¬¿y
(

63 
$hªdËr
->
	`ov”ride_İtiÚ
('f‹rs', 
	`¬¿y
(

64 '¡©us' => 
	`¬¿y
(

71 'expo£d' => 
FALSE
,

72 'expo£' => 
	`¬¿y
(

73 'İ”©Ü' => 
FALSE
,

77 'tÙ®couÁ' => 
	`¬¿y
(

82 'v®ue' => 
	`¬¿y
(

88 'expo£d' => 
FALSE
,

89 'expo£' => 
	`¬¿y
(

90 'İ”©Ü' => 
FALSE
,

96 
$hªdËr
->
	`ov”ride_İtiÚ
('acûss', 
	`¬¿y
(

98 'rŞe' => 
	`¬¿y
(),

101 
$hªdËr
->
	`ov”ride_İtiÚ
('title', 'Popular content');

102 
$hªdËr
->
	`ov”ride_İtiÚ
('items_per_page', '25');

103 
$hªdËr
->
	`ov”ride_İtiÚ
('u£_·g”', 
TRUE
);

104 
$hªdËr
->
	`ov”ride_İtiÚ
('use_more', 1);

105 
$hªdËr
->
	`ov”ride_İtiÚ
('style_plugin', 'table');

106 
$hªdËr
->
	`ov”ride_İtiÚ
('¡yË_İtiÚs', 
	`¬¿y
(

109 'cŞumns' => 
	`¬¿y
(

116 'šfo' => 
	`¬¿y
(

117 'ty³' => 
	`¬¿y
(

121 't™Ë' => 
	`¬¿y
(

125 'Çme' => 
	`¬¿y
(

129 'time¡amp' => 
	`¬¿y
(

132 'tÙ®couÁ' => 
	`¬¿y
(

139 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('page', 'Popular (page)', 'page');

140 
$hªdËr
->
	`ov”ride_İtiÚ
('path', 'popular/all');

141 
$hªdËr
->
	`ov”ride_İtiÚ
('m’u', 
	`¬¿y
(

146 
$hªdËr
->
	`ov”ride_İtiÚ
('b_İtiÚs', 
	`¬¿y
(

151 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('page', 'Today (page)', 'page_1');

152 
$hªdËr
->
	`ov”ride_İtiÚ
('f›lds', 
	`¬¿y
(

153 'ty³' => 
	`¬¿y
(

159 't™Ë' => 
	`¬¿y
(

164 'lšk_to_node' => 
TRUE
,

166 'Çme' => 
	`¬¿y
(

171 'lšk_to_u£r' => 
TRUE
,

173 'time¡amp' => 
	`¬¿y
(

183 'daycouÁ' => 
	`¬¿y
(

188 '£t_´ecisiÚ' => 
FALSE
,

197 
$hªdËr
->
	`ov”ride_İtiÚ
('sÜts', 
	`¬¿y
(

198 'daycouÁ' => 
	`¬¿y
(

206 
$hªdËr
->
	`ov”ride_İtiÚ
('path', 'popular/today');

207 
$hªdËr
->
	`ov”ride_İtiÚ
('m’u', 
	`¬¿y
(

212 
$hªdËr
->
	`ov”ride_İtiÚ
('b_İtiÚs', 
	`¬¿y
(

217 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('block', 'Popular (block)', 'block');

218 
$hªdËr
->
	`ov”ride_İtiÚ
('f›lds', 
	`¬¿y
(

219 't™Ë' => 
	`¬¿y
(

227 'tÙ®couÁ' => 
	`¬¿y
(

232 '£t_´ecisiÚ' => 
FALSE
,

241 
$hªdËr
->
	`ov”ride_İtiÚ
('items_per_page', 5);

242 
$hªdËr
->
	`ov”ride_İtiÚ
('style_plugin', 'list');

243 
$hªdËr
->
	`ov”ride_İtiÚ
('¡yË_İtiÚs', 
	`¬¿y
(

246 
$hªdËr
->
	`ov”ride_İtiÚ
('row_İtiÚs', 
	`¬¿y
(

247 'šlše' => 
	`¬¿y
(

253 
$hªdËr
->
	`ov”ride_İtiÚ
('block_description', 'Popular content');

254 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('block', 'Today (block)', 'block_1');

255 
$hªdËr
->
	`ov”ride_İtiÚ
('f›lds', 
	`¬¿y
(

256 't™Ë' => 
	`¬¿y
(

264 'daycouÁ' => 
	`¬¿y
(

269 '£t_´ecisiÚ' => 
FALSE
,

278 
$hªdËr
->
	`ov”ride_İtiÚ
('sÜts', 
	`¬¿y
(

279 'daycouÁ' => 
	`¬¿y
(

287 
$hªdËr
->
	`ov”ride_İtiÚ
('title', 'Today\'s…opular content');

288 
$hªdËr
->
	`ov”ride_İtiÚ
('items_per_page', 5);

289 
$hªdËr
->
	`ov”ride_İtiÚ
('link_display', 'page_1');

290 
$hªdËr
->
	`ov”ride_İtiÚ
('style_plugin', 'list');

291 
$hªdËr
->
	`ov”ride_İtiÚ
('¡yË_İtiÚs', 
	`¬¿y
(

294 
$hªdËr
->
	`ov”ride_İtiÚ
('row_İtiÚs', 
	`¬¿y
(

295 'šlše' => 
	`¬¿y
(

301 
$hªdËr
->
	`ov”ride_İtiÚ
('block_description', 'Today\'s…opular content');

302 
$v›ws
[
$v›w
->
Çme
] = $view;

304  
$v›ws
;

305 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/statistics/views_handler_field_accesslog_path.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_acûs¦og_·th
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

10 
funùiÚ
 
	$š™
(&
$v›w
, &
$d©a
) {

11 
·»Á
::
	`š™
(
$v›w
, 
$d©a
);

12 ià(
	`is£t
(
$d©a
['display_as_link'])) {

13 
$this
->
add™iÚ®_f›lds
[] = 'path';

17 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

18 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

20 
$İtiÚs
['di¥Ïy_as_lšk'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

22  
$İtiÚs
;

23 
	}
}

28 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

29 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

30 
$fÜm
['di¥Ïy_as_lšk'] = 
	`¬¿y
(

31 '#t™Ë' => 
	`t
('Display‡s†ink'),

33 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['display_as_link']),

35 
	}
}

37 
funùiÚ
 
	$»nd”
(
$v®ues
) {

38 
$t™Ë
 = 
	`check_¶aš
(
$v®ues
->{
$this
->
f›ld_®Ÿs
});

39 ià(!
	`em±y
(
$this
->
İtiÚs
['display_as_link'])) {

40  
	`l
(
$t™Ë
, 
$v®ues
->{
$this
->
®Ÿ£s
['·th']}, 
	`¬¿y
('html' => 
TRUE
));

43  
$t™Ë
;

45 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/system.views.inc

1 <?
php


19 
funùiÚ
 
	$sy¡em_v›ws_d©a
() {

20 
$d©a
 = 
	`¬¿y
();

25 
$d©a
['fes']['bË']['group'] = 
	`t
('File');

28 
$d©a
['fes']['bË']['ba£'] = 
	`¬¿y
(

30 't™Ë' => 
	`t
('File'),

31 'h–p' => 
	`t
("Files maintained by Drupal‡nd various modules."),

39 
$d©a
['fes']['bË']['još'] = 
	`¬¿y
(

40 'u£rs' => 
	`¬¿y
(

48 
$d©a
['fes']['fid'] = 
	`¬¿y
(

49 't™Ë' => 
	`t
('File ID'),

50 'h–p' => 
	`t
('The ID ofhe file.'),

51 'f›ld' => 
	`¬¿y
(

53 'şick sÜbË' => 
TRUE
,

55 '¬gum’t' => 
	`¬¿y
(

59 'f‹r' => 
	`¬¿y
(

62 'sÜt' => 
	`¬¿y
(

68 
$d©a
['fes']['f’ame'] = 
	`¬¿y
(

69 't™Ë' => 
	`t
('Name'),

70 'h–p' => 
	`t
('The‚ame ofhe file.'),

71 'f›ld' => 
	`¬¿y
(

73 'şick sÜbË' => 
TRUE
,

75 'sÜt' => 
	`¬¿y
(

78 'f‹r' => 
	`¬¿y
(

81 '¬gum’t' => 
	`¬¿y
(

87 
$d©a
['fes']['f•©h'] = 
	`¬¿y
(

88 't™Ë' => 
	`t
('Path'),

89 'h–p' => 
	`t
('The…ath ofhe file.'),

90 'f›ld' => 
	`¬¿y
(

92 'şick sÜbË' => 
TRUE
,

94 'sÜt' => 
	`¬¿y
(

97 'f‹r' => 
	`¬¿y
(

100 '¬gum’t' => 
	`¬¿y
(

106 
$d©a
['fes']['femime'] = 
	`¬¿y
(

107 't™Ë' => 
	`t
('Mimeype'),

108 'h–p' => 
	`t
('The mimeype ofhe file.'),

109 'f›ld' => 
	`¬¿y
(

111 'şick sÜbË' => 
TRUE
,

113 'sÜt' => 
	`¬¿y
(

116 'f‹r' => 
	`¬¿y
(

119 '¬gum’t' => 
	`¬¿y
(

125 
$d©a
['fes']['fesize'] = 
	`¬¿y
(

126 't™Ë' => 
	`t
('Size'),

127 'h–p' => 
	`t
('The size ofhe file.'),

128 'f›ld' => 
	`¬¿y
(

130 'şick sÜbË' => 
TRUE
,

132 'sÜt' => 
	`¬¿y
(

135 'f‹r' => 
	`¬¿y
(

141 
$d©a
['fes']['¡©us'] = 
	`¬¿y
(

142 't™Ë' => 
	`t
('Status'),

143 'h–p' => 
	`t
('The status ofhe file.'),

144 'f›ld' => 
	`¬¿y
(

146 'şick sÜbË' => 
TRUE
,

148 'sÜt' => 
	`¬¿y
(

151 'f‹r' => 
	`¬¿y
(

157 
$d©a
['fes']['time¡amp'] = 
	`¬¿y
(

158 't™Ë' => 
	`t
('Upload date'),

159 'h–p' => 
	`t
('The datehe file was uploaded.'),

160 'f›ld' => 
	`¬¿y
(

162 'şick sÜbË' => 
TRUE
,

164 'sÜt' => 
	`¬¿y
(

167 'f‹r' => 
	`¬¿y
(

173  
$d©a
;

174 
	}
}

180 
funùiÚ
 
	$sy¡em_v›ws_hªdËrs
() {

181  
	`¬¿y
(

182 'šfo' => 
	`¬¿y
(

183 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/system',

185 'hªdËrs' => 
	`¬¿y
(

186 'v›ws_hªdËr_f›ld_fe' => 
	`¬¿y
(

189 'v›ws_hªdËr_f›ld_fe_¡©us' => 
	`¬¿y
(

192 'v›ws_hªdËr_f‹r_fe_¡©us' => 
	`¬¿y
(

195 'v›ws_hªdËr_¬gum’t_fe_fid' => 
	`¬¿y
(

200 
	}
}

202 
funùiÚ
 
	$_v›ws_fe_¡©us
(
$choiû
 = 
NULL
) {

203 
$¡©us
 = 
	`¬¿y
(

204 
FILE_STATUS_TEMPORARY
 => 
	`t
('Temporary'),

205 
FILE_STATUS_PERMANENT
 => 
	`t
('Permanent'),

208 ià(
	`is£t
(
$choiû
)) {

209  
	`is£t
(
$¡©us
[
$choiû
]è? $¡©us[$choiû] : 
	`t
('Unknown');

212  
$¡©us
;

213 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/system/views_handler_argument_file_fid.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_¬gum’t_fe_fid
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

10 
funùiÚ
 
	$t™Ë
() {

11 
$t™Ë
 = 
	`db_»suÉ
(
	`db_qu”y
(
	`db_»wr™e_sql
("SELECT f.f’amFROM {fes} f WHERE f.fid = %d", 
$this
->
¬gum’t
)));

12 ià(
	`em±y
(
$t™Ë
)) {

13  
	`t
('Noitle');

16  
	`check_¶aš
(
$t™Ë
);

18 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/system/views_handler_field_file.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_fe
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

10 
funùiÚ
 
	$š™
(&
$v›w
, &
$İtiÚs
) {

11 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

12 ià(!
	`em±y
(
$İtiÚs
['link_to_file'])) {

13 
$this
->
add™iÚ®_f›lds
['filepath'] = 'filepath';

17 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

18 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

19 
$İtiÚs
['lšk_to_fe'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

20  
$İtiÚs
;

21 
	}
}

26 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

27 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

28 
$fÜm
['lšk_to_fe'] = 
	`¬¿y
(

29 '#t™Ë' => 
	`t
('Linkhis fieldo downloadhe file'),

30 '#desütiÚ' => 
	`t
('This will override‡ny other†ink you have set.'),

32 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['link_to_file']),

34 
	}
}

41 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ues
) {

42 ià(!
	`em±y
(
$this
->
İtiÚs
['lšk_to_fe']è&& 
$d©a
 !=ğ
NULL
 && $data !== '') {

43 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
TRUE
;

44 
$this
->
İtiÚs
['®‹r']['·th'] = 
	`fe_ü—‹_u¾
(
$v®ues
->{$this->
®Ÿ£s
['filepath']});

47  
$d©a
;

48 
	}
}

50 
funùiÚ
 
	$»nd”
(
$v®ues
) {

51  
$this
->
	`»nd”_lšk
(
	`check_¶aš
(
$v®ues
->{$this->
f›ld_®Ÿs
}), $values);

52 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/system/views_handler_field_file_status.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_fe_¡©us
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

7 
funùiÚ
 
	$»nd”
(
$v®ues
) {

8  
	`_v›ws_fe_¡©us
(
$v®ues
->{
$this
->
f›ld_®Ÿs
});

10 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/system/views_handler_filter_file_status.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f‹r_fe_¡©us
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_š_İ”©Ü
 {

7 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

8 ià(!
	`is£t
(
$this
->
v®ue_İtiÚs
)) {

9 
$this
->
v®ue_İtiÚs
 = 
	`_v›ws_fe_¡©us
();

12 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy.views.inc

1 <?
php


18 
funùiÚ
 
	$xÚomy_v›ws_d©a
() {

19 
$d©a
 = 
	`¬¿y
();

24 
$d©a
['voÿbuÏry']['bË']['group'] = 
	`t
('Taxonomy');

26 
$d©a
['voÿbuÏry']['bË']['još'] = 
	`¬¿y
(

28 '‹rm_d©a' => 
	`¬¿y
(

33 'node' => 
	`¬¿y
(

39 'node_»visiÚ' => 
	`¬¿y
(

47 
$d©a
['voÿbuÏry']['Çme'] = 
	`¬¿y
(

48 't™Ë' => 
	`t
('Vocabulary‚ame'),

49 'f›ld' => 
	`¬¿y
(

50 'h–p' => 
	`t
('Name ofhe vocabulary‡erm is‡ member of. This will behe vocabularyhat whicheverermhe "Taxonomy: Term" field is;‡nd can similarly cause duplicates.'),

52 'şick sÜbË' => 
TRUE
,

55 
$d©a
['voÿbuÏry']['vid'] = 
	`¬¿y
(

56 't™Ë' => 
	`t
('Vocabulary ID'),

57 'h–p' => 
	`t
('Theaxonomy vocabulary ID'),

58 '¬gum’t' => 
	`¬¿y
(

67 
$d©a
['‹rm_d©a']['bË']['group'] = 
	`t
('Taxonomy');

68 
$d©a
['‹rm_d©a']['bË']['ba£'] = 
	`¬¿y
(

70 't™Ë' => 
	`t
('Term'),

71 'h–p' => 
	`t
('Taxonomyerms‡re‡ttachedo‚odes.'),

76 
$d©a
['‹rm_d©a']['bË']['još'] = 
	`¬¿y
(

77 'node' => 
	`¬¿y
(

82 'node_»visiÚ' => 
	`¬¿y
(

88 '‹rm_node' => 
	`¬¿y
(

95 
$d©a
['‹rm_d©a']['tid'] = 
	`¬¿y
(

96 't™Ë' => 
	`t
('Term ID'),

97 'h–p' => 
	`t
('Theaxonomyerm ID'),

98 'f›ld' => 
	`¬¿y
(

100 'şick sÜbË' => 
TRUE
,

102 'sÜt' => 
	`¬¿y
(

105 '¬gum’t' => 
	`¬¿y
(

107 'sk ba£' => 
	`¬¿y
('node', 'node_revision'),

108 'z”Øi nuÎ' => 
TRUE
,

110 'f‹r' => 
	`¬¿y
(

113 'num”ic' => 
TRUE
,

114 'sk ba£' => 
	`¬¿y
('node', 'node_revision'),

119 
$d©a
['‹rm_d©a']['Çme'] = 
	`¬¿y
(

120 't™Ë' => 
	`t
('Term'),

121 'h–p' => 
	`t
('Taxonomyerms. Notehat usinghis can cause duplicate‚odeso‡ppear in views; you must‡dd filterso„educehe„esult set.'),

122 'f›ld' => 
	`¬¿y
(

124 'şick sÜbË' => 
TRUE
,

126 'sÜt' => 
	`¬¿y
(

129 'f‹r' => 
	`¬¿y
(

131 'h–p' => 
	`t
('Taxonomyerm‚ame.'),

133 '¬gum’t' => 
	`¬¿y
(

135 'h–p' => 
	`t
('Taxonomyerm‚ame.'),

136 'mªyØÚe' => 
TRUE
,

137 'em±y f›ld‚ame' => 
	`t
('Uncategorized'),

142 
$d©a
['‹rm_d©a']['weight'] = 
	`¬¿y
(

143 't™Ë' => 
	`t
('Weight'),

144 'h–p' => 
	`t
('Theerm weight field'),

145 'f›ld' => 
	`¬¿y
(

147 'şick sÜbË' => 
TRUE
,

149 'sÜt' => 
	`¬¿y
(

155 
$d©a
['‹rm_d©a']['desütiÚ'] = 
	`¬¿y
(

156 't™Ë' => 
	`t
('Term description'),

157 'h–p' => 
	`t
('The description‡ssociated with‡axonomyerm.'),

158 'f›ld' => 
	`¬¿y
(

160 'group' => 
	`t
('Taxonomy'),

162 'fÜm©' => 
FILTER_FORMAT_DEFAULT
,

167 
$d©a
['‹rm_d©a']['vid'] = 
	`¬¿y
(

168 't™Ë' => 
	`t
('Vocabulary'),

169 'h–p' => 
	`t
('Filterhe„esults of "Taxonomy: Term"o‡…articular vocabulary.'),

170 'f‹r' => 
	`¬¿y
(

178 
$d©a
['‹rm_node']['bË']['group'] = 
	`t
('Taxonomy');

180 
$d©a
['‹rm_node']['bË']['još'] = 
	`¬¿y
(

181 '‹rm_d©a' => 
	`¬¿y
(

186 'node' => 
	`¬¿y
(

191 'node_»visiÚs' => 
	`¬¿y
(

196 '‹rm_h›¿rchy' => 
	`¬¿y
(

202 
$d©a
['‹rm_node']['vid'] = 
	`¬¿y
(

203 't™Ë' => 
	`t
('Node'),

204 'h–p' => 
	`t
('Get‡ll‚odesagged with‡erm.'),

205 '»ÏtiÚsh' => 
	`¬¿y
(

209 'Ïb–' => 
	`t
('node'),

214 
$d©a
['‹rm_node']['tid'] = 
	`¬¿y
(

215 't™Ë' => 
	`t
('Term ID'),

216 'h–p' => 
	`t
('Theaxonomyerm ID'),

217 'f›ld' => 
	`¬¿y
(

218 't™Ë' => 
	`t
('Allerms'),

219 'h–p' => 
	`t
('Display‡llaxonomyerms‡ssociated with‡‚ode from specified vocabularies.'),

223 '¬gum’t' => 
	`¬¿y
(

227 'em±y f›ld‚ame' => 
	`t
('Uncategorized'),

228 'num”ic' => 
TRUE
,

231 'f‹r' => 
	`¬¿y
(

232 't™Ë' => 
	`t
('Term'),

235 'num”ic' => 
TRUE
,

237 '®lowƒm±y' => 
TRUE
,

243 
$d©a
['‹rm_»ÏtiÚ']['bË']['group'] = 
	`t
('Taxonomy');

245 
$d©a
['‹rm_»ÏtiÚ']['bË']['još'] = 
	`¬¿y
(

246 '‹rm_d©a' => 
	`¬¿y
(

251 '‹rm_»ÏtiÚ' => 
	`¬¿y
(

256 'node' => 
	`¬¿y
(

261 'node_»visiÚs' => 
	`¬¿y
(

268 
$d©a
['‹rm_»ÏtiÚ']['tid2'] = 
	`¬¿y
(

269 't™Ë' => 
	`t
('Relatederms'),

270 'h–p' => 
	`t
('The„elatederms ofheerm. This can…roduce duplicateƒntries ifhere is morehan one„elatederm.'),

271 '»ÏtiÚsh' => 
	`¬¿y
(

274 'Ïb–' => 
	`t
('Relatederm'),

276 '¬gum’t' => 
	`¬¿y
(

277 'h–p' => 
	`t
('A„elatederm ofheerm.'),

285 
$d©a
['‹rm_h›¿rchy']['bË']['group'] = 
	`t
('Taxonomy');

287 
$d©a
['‹rm_h›¿rchy']['bË']['još'] = 
	`¬¿y
(

288 '‹rm_h›¿rchy' => 
	`¬¿y
(

293 '‹rm_d©a' => 
	`¬¿y
(

298 'node' => 
	`¬¿y
(

304 'node_»visiÚs' => 
	`¬¿y
(

312 
$d©a
['‹rm_h›¿rchy']['·»Á'] = 
	`¬¿y
(

313 't™Ë' => 
	`t
('Parenterm'),

314 'h–p' => 
	`t
('The…arenterm ofheerm. This can…roduce duplicateƒntries if you‡re using‡ vocabularyhat‡llows multiple…arents.'),

315 '»ÏtiÚsh' => 
	`¬¿y
(

318 'Ïb–' => 
	`t
('Parent'),

320 '¬gum’t' => 
	`¬¿y
(

321 'h–p' => 
	`t
('The…arenterm ofheerm.'),

329 
$d©a
['‹rm_synÚym']['bË']['group'] = 
	`t
('Taxonomy');

331 
$d©a
['‹rm_synÚym']['bË']['još'] = 
	`¬¿y
(

332 '‹rm_d©a' => 
	`¬¿y
(

337 'node' => 
	`¬¿y
(

342 'node_»visiÚs' => 
	`¬¿y
(

349 
$d©a
['‹rm_synÚym']['Çme'] = 
	`¬¿y
(

350 't™Ë' => 
	`t
('Term synonym'),

351 'h–p' => 
	`t
('Term synonyms may be usedo finderms by‡lternate‚ames.'),

352 '¬gum’t' => 
	`¬¿y
(

354 'mªyØÚe' => 
TRUE
,

355 'em±y f›ld‚ame' => 
	`t
('Uncategorized'),

358  
$d©a
;

359 
	}
}

364 
funùiÚ
 
	$xÚomy_v›ws_d©a_®‹r
(&
$d©a
) {

365 
$d©a
['node']['‹rm_node_tid'] = 
	`¬¿y
(

366 'group' => 
	`t
('Taxonomy'),

367 't™Ë' => 
	`t
('Relatederms'),

368 'h–p' => 
	`t
('Relate‚odesoaxonomyerms, specifiying which vocabulary or vocabularieso use. This„elationship will cause duplicated„ecords ifhere‡re multipleerms.'),

369 '»ÏtiÚsh' => 
	`¬¿y
(

371 'Ïb–' => 
	`t
('term'),

376 
$d©a
['node']['‹rm_node_tid_d•th'] = 
	`¬¿y
(

377 'group' => 
	`t
('Taxonomy'),

378 't™Ë' => 
	`t
('Term ID (with depth)'),

379 'h–p' => 
	`t
('The depth filter is more complex, so…rovides fewer options.'),

381 '¬gum’t' => 
	`¬¿y
(

383 'acû± d•th modif›r' => 
TRUE
,

385 'f‹r' => 
	`¬¿y
(

390 
$d©a
['node']['‹rm_node_tid_d•th_modif›r'] = 
	`¬¿y
(

391 'group' => 
	`t
('Taxonomy'),

392 't™Ë' => 
	`t
('Term ID depth modifier'),

393 'h–p' => 
	`t
('Allowshe "depth" for Taxonomy: Term ID (with depth)o be modified via‡n‡dditional‡rgument.'),

394 '¬gum’t' => 
	`¬¿y
(

398 
	}
}

404 
funùiÚ
 
	$xÚomy_v›ws_hªdËrs
() {

405  
	`¬¿y
(

406 'šfo' => 
	`¬¿y
(

407 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/taxonomy',

409 'hªdËrs' => 
	`¬¿y
(

410 'v›ws_hªdËr_¬gum’t_‹rm_node_tid_d•th' => 
	`¬¿y
(

413 'v›ws_hªdËr_¬gum’t_‹rm_node_tid_d•th_modif›r' => 
	`¬¿y
(

416 'v›ws_hªdËr_¬gum’t_xÚomy' => 
	`¬¿y
(

419 'v›ws_hªdËr_¬gum’t_voÿbuÏry_vid' => 
	`¬¿y
(

422 'v›ws_hªdËr_¬gum’t_‹rm_node_tid' => 
	`¬¿y
(

425 'v›ws_hªdËr_f›ld_‹rm_node_tid' => 
	`¬¿y
(

428 'v›ws_hªdËr_f›ld_xÚomy' => 
	`¬¿y
(

431 'v›ws_hªdËr_f‹r_voÿbuÏry_vid' => 
	`¬¿y
(

434 'v›ws_hªdËr_f‹r_‹rm_node_tid' => 
	`¬¿y
(

437 'v›ws_hªdËr_f‹r_‹rm_node_tid_d•th' => 
	`¬¿y
(

440 'v›ws_hªdËr_»ÏtiÚsh_node_‹rm_d©a' => 
	`¬¿y
(

445 
	}
}

450 
funùiÚ
 
	$xÚomy_v›ws_¶ugšs
() {

451  
	`¬¿y
(

453 '¬gum’ˆv®id©Ü' => 
	`¬¿y
(

454 'xÚomy_‹rm' => 
	`¬¿y
(

455 't™Ë' => 
	`t
('Taxonomyerm'),

457 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/taxonomy',

460 '¬gum’ˆdeçuÉ' => 
	`¬¿y
(

461 'xÚomy_tid' => 
	`¬¿y
(

462 't™Ë' => 
	`t
('Taxonomy Term ID from URL'),

464 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/taxonomy',

469 
	}
}

474 
funùiÚ
 
	$v›ws_xÚomy_£t_b»adüumb
(&
$b»adüumb
, &
$¬gum’t
) {

475 ià(
	`em±y
(
$¬gum’t
->
İtiÚs
['set_breadcrumb'])) {

479 
$¬gs
 = 
$¬gum’t
->
v›w
->
¬gs
;

480 
$·»Ás
 = 
	`xÚomy_g‘_·»Ás_®l
(
$¬gum’t
->
¬gum’t
);

481 
	`fÜ—ch
 (
	`¬¿y_»v”£
(
$·»Ás
è
as
 
$·»Á
) {

483 ià(
$·»Á
->
tid
 =ğ
$¬gum’t
->
¬gum’t
) {

486 ià(
$¬gum’t
->
İtiÚs
['use_taxonomy_term_path']) {

487 
$·th
 = 
	`xÚomy_‹rm_·th
(
$·»Á
);

490 
$¬gs
[
$¬gum’t
->
pos™iÚ
] = 
$·»Á
->
tid
;

491 
$·th
 = 
$¬gum’t
->
v›w
->
	`g‘_u¾
(
$¬gs
);

493 
$b»adüumb
[
$·th
] = 
	`check_¶aš
(
$·»Á
->
Çme
);

495 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy.views_convert.inc

1 <?
php


16 
funùiÚ
 
	$xÚomy_v›ws_cÚv”t
(
$di¥Ïy
, 
$ty³
, &
$v›w
, 
$f›ld
, 
$id
 = 
NULL
) {

17 
$ty³
) {

19 ià(
$f›ld
['bËÇme'] =ğ'‹rm_node' || !
	`¡ºcmp
($field['tablename'], 'term_node_', 10)) {

20 
$f›ld
['field']) {

22 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f›ld', 
$id
);

23 ià(
$f›ld
['options'] != 'nolink') {

24 
$™em
['lšk_to_xÚomy'] = 
TRUE
;

26 ià(!
	`em±y
(
$f›ld
['vocabulary'])) {

27 
$™em
['lim™'] = 
TRUE
;

28 
$™em
['vids'] = 
	`¬¿y
(
$f›ld
['vocabulary']);

30 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f›ld', 
$id
, 
$™em
);

34 
	`–£if
 (
$f›ld
['tablename'] == 'term_data') {

35 
$f›ld
['field']) {

37 ià(
$f›ld
['field'] == 'views_handler_field_tid_link') {

38 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'lšk_to_xÚomy', 
TRUE
);

45 ià(
$f›ld
['bËÇme'] =ğ'‹rm_node' || !
	`¡ºcmp
($field['tablename'], 'term_node_', 10)) {

46 
$f›ld
['field']) {

48 
$İ”©Üs
 = 
	`¬¿y
('AND' => 'and', 'OR' => 'or', 'NOR' => 'not');

49 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f‹r', 
$id
);

50 ià(
$vid
 = (
š‹g”
è
	`sub¡r
(
$f›ld
['tablename'], 10)) {

51 
$™em
['table'] = 'term_node';

52 
$™em
['vid'] = 
$vid
;

55 
$™em
['lim™'] = 
FALSE
;

57 
$™em
['İ”©Ü'] = 
$İ”©Üs
[
$f›ld
['operator']];

58 
$™em
['type'] = 'select';

59 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f‹r', 
$id
, 
$™em
);

63 
	`–£if
 (
$f›ld
['tablename'] == 'term_data') {

64 
$f›ld
['field']) {

66 
$İ”©Üs
 = 
	`¬¿y
('AND' => 'in', 'OR' => 'in', 'NOR' => 'not in');

67 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'İ”©Ü', 
$İ”©Üs
[
$f›ld
['operator']]);

73 
$İtiÚs
 = 
$f›ld
['argoptions'];

74 
$f›ld
['type']) {

76 ià(!
	`em±y
(
$f›ld
['options'])) {

77 
$İtiÚs
['d•th'] = 
$f›ld
['options'];

79 
$İtiÚs
['b»ak_ph¿£'] = 
TRUE
;

80 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'node', '‹rm_node_tid_d•th', 
$İtiÚs
, 
$f›ld
['id']);

83 ià(!
	`em±y
(
$f›ld
['options'])) {

84 
$İtiÚs
['glos§ry'] = 
TRUE
;

85 
$İtiÚs
['lim™'] = 
$f›ld
['options'];

87 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', '‹rm_d©a', 'Çme', 
$İtiÚs
, 
$f›ld
['id']);

90 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'voÿbuÏry', 'vid', 
$İtiÚs
, 
$f›ld
['id']);

95 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy.views_default.inc

1 <?
php


11 
funùiÚ
 
	$xÚomy_v›ws_deçuÉ_v›ws
() {

12 
$v›w
 = 
Ãw
 
v›w
;

13 
$v›w
->
Çme
 = 'taxonomy_term';

14 
$v›w
->
desütiÚ
 = 'A viewoƒmulate Drupal core\'s handling ofaxonomy/term; it‡lsoƒmulates Views 1\'s handling by havingwo…ossible feeds.';

15 
$v›w
->
g
 = 'default';

16 
$v›w
->
v›w_php
 = '';

17 
$v›w
->
ba£_bË
 = 'node';

18 
$v›w
->
is_ÿch—bË
 = '0';

19 
$v›w
->
­i_v”siÚ
 = 2;

20 
$v›w
->
di§bËd
 = 
TRUE
;

21 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('default', 'Defaults', 'default');

22 
$hªdËr
->
	`ov”ride_İtiÚ
('sÜts', 
	`¬¿y
(

23 '¡icky' => 
	`¬¿y
(

30 'ü—‹d' => 
	`¬¿y
(

39 
$hªdËr
->
	`ov”ride_İtiÚ
('¬gum’ts', 
	`¬¿y
(

40 '‹rm_node_tid_d•th' => 
	`¬¿y
(

46 '¡yË_İtiÚs' => 
	`¬¿y
(

47 'couÁ' => 
TRUE
,

48 'ov”ride' => 
FALSE
,

63 'v®id©e_¬gum’t_node_ty³' => 
	`¬¿y
(

71 'v®id©e_¬gum’t_voÿbuÏry' => 
	`¬¿y
(

81 '‹rm_node_tid_d•th_modif›r' => 
	`¬¿y
(

87 '¡yË_İtiÚs' => 
	`¬¿y
(

88 'couÁ' => 
TRUE
,

89 'ov”ride' => 
FALSE
,

101 
$hªdËr
->
	`ov”ride_İtiÚ
('f‹rs', 
	`¬¿y
(

102 '¡©us_exŒa' => 
	`¬¿y
(

109 'expo£d' => 
FALSE
,

110 'expo£' => 
	`¬¿y
(

111 'İ”©Ü' => 
FALSE
,

117 
$hªdËr
->
	`ov”ride_İtiÚ
('acûss', 
	`¬¿y
(

119 'rŞe' => 
	`¬¿y
(),

122 
$hªdËr
->
	`ov”ride_İtiÚ
('use_pager', '1');

123 
$hªdËr
->
	`ov”ride_İtiÚ
('row_plugin', 'node');

124 
$hªdËr
->
	`ov”ride_İtiÚ
('row_İtiÚs', 
	`¬¿y
(

125 '‹a£r' => 
TRUE
,

126 'lšks' => 
TRUE
,

128 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('page', 'Page', 'page');

129 
$hªdËr
->
	`ov”ride_İtiÚ
('path', 'taxonomy/term/%');

130 
$hªdËr
->
	`ov”ride_İtiÚ
('m’u', 
	`¬¿y
(

135 
$hªdËr
->
	`ov”ride_İtiÚ
('b_İtiÚs', 
	`¬¿y
(

140 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('feed', 'Core feed', 'feed');

141 
$hªdËr
->
	`ov”ride_İtiÚ
('items_per_page', 15);

142 
$hªdËr
->
	`ov”ride_İtiÚ
('use_pager', '1');

143 
$hªdËr
->
	`ov”ride_İtiÚ
('row_plugin', 'node_rss');

144 
$hªdËr
->
	`ov”ride_İtiÚ
('row_İtiÚs', 
	`¬¿y
(

147 
$hªdËr
->
	`ov”ride_İtiÚ
('path', 'taxonomy/term/%/%/feed');

148 
$hªdËr
->
	`ov”ride_İtiÚ
('m’u', 
	`¬¿y
(

153 
$hªdËr
->
	`ov”ride_İtiÚ
('b_İtiÚs', 
	`¬¿y
(

158 
$hªdËr
->
	`ov”ride_İtiÚ
('di¥Ïys', 
	`¬¿y
(

162 
$hªdËr
 = 
$v›w
->
	`Ãw_di¥Ïy
('feed', 'Views 1 feed', 'feed_1');

163 
$hªdËr
->
	`ov”ride_İtiÚ
('items_per_page', 15);

164 
$hªdËr
->
	`ov”ride_İtiÚ
('use_pager', '1');

165 
$hªdËr
->
	`ov”ride_İtiÚ
('row_plugin', 'node_rss');

166 
$hªdËr
->
	`ov”ride_İtiÚ
('row_İtiÚs', 
	`¬¿y
(

169 
$hªdËr
->
	`ov”ride_İtiÚ
('path', 'taxonomy/term/%/feed');

170 
$hªdËr
->
	`ov”ride_İtiÚ
('m’u', 
	`¬¿y
(

175 
$hªdËr
->
	`ov”ride_İtiÚ
('b_İtiÚs', 
	`¬¿y
(

180 
$v›ws
[
$v›w
->
Çme
] = $view;

182  
$v›ws
;

183 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_argument_taxonomy.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_¬gum’t_xÚomy
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

12 
funùiÚ
 
	$t™Ë
() {

13 
$‹rm
 = 
	`xÚomy_g‘_‹rm
(
$this
->
¬gum’t
);

14 ià(!
	`em±y
(
$‹rm
)) {

15  
	`check_¶aš
(
$‹rm
->
Çme
);

18  
	`t
('No‚ame');

20 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_argument_term_node_tid.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_¬gum’t_‹rm_node_tid
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_mªy_to_Úe
 {

7 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

8 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

9 
$İtiÚs
['£t_b»adüumb'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

10  
$İtiÚs
;

13 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

14 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

15 
$fÜm
['£t_b»adüumb'] = 
	`¬¿y
(

17 '#t™Ë' => 
	`t
("Sethe breadcrumb forheerm…arents"),

18 '#desütiÚ' => 
	`t
('If selected,he breadcrumbrail will include‡ll…arenterms,ƒach one†inkingohis view. Notehathis only works if just oneerm was„eceived.'),

19 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['set_breadcrumb']),

21 
	}
}

23 
funùiÚ
 
	$£t_b»adüumb
(&
$b»adüumb
) {

24 ià(
	`em±y
(
$this
->
İtiÚs
['£t_b»adüumb']è|| !
	`is_num”ic
($this->
¬gum’t
)) {

28  
	`v›ws_xÚomy_£t_b»adüumb
(
$b»adüumb
, 
$this
);

29 
	}
}

31 
funùiÚ
 
	$t™Ë_qu”y
() {

32 
$t™Ës
 = 
	`¬¿y
();

33 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$this
->
v®ue
), '%d'));

35 
$»suÉ
 = 
	`db_qu”y
("SELECT‚amFROM {‹rm_d©a} WHEREid IN ($¶aûhŞd”s)", 
$this
->
v®ue
);

36 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

37 
$t™Ës
[] = 
	`check_¶aš
(
$‹rm
->
Çme
);

39  
$t™Ës
;

40 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_argument_term_node_tid_depth.inc

1 <?
php


9 şas 
	cv›ws_hªdËr_¬gum’t_‹rm_node_tid_d•th
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

10 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

11 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

13 
$İtiÚs
['d•th'] = 
	`¬¿y
('default' => 0);

14 
$İtiÚs
['b»ak_ph¿£'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

15 
$İtiÚs
['£t_b»adüumb'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

16 
$İtiÚs
['u£_xÚomy_‹rm_·th'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

18  
$İtiÚs
;

21 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

22 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

23 
$fÜm
['d•th'] = 
	`¬¿y
(

25 '#t™Ë' => 
	`t
('Depth'),

26 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['depth'],

27 '#desütiÚ' => 
	`t
('The depth will match‚odesagged witherms inhe hierarchy. Forƒxample, if you haveheerm "fruit"‡nd‡ childerm "apple", with‡ depth of 1 (or higher)hen filtering forheerm "fruit" will get‚odeshat‡reagged with "apple"‡s well‡s "fruit". If‚egative,he„everse isrue; searching for "apple" will‡lso…ick up‚odesagged with "fruit" if depth is -1 (or†ower).'),

30 
$fÜm
['b»ak_ph¿£'] = 
	`¬¿y
(

32 '#t™Ë' => 
	`t
('Allow multipleerms…er‡rgument'),

33 '#desütiÚ' => 
	`t
('If selected, users canƒnter multiple‡rguments inhe form of 1+2+3. Dueohe‚umber of JOINs it would„equire, AND will bereated‡s OR withhis‡rgument.'),

34 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['break_phrase']),

37 
$fÜm
['£t_b»adüumb'] = 
	`¬¿y
(

39 '#t™Ë' => 
	`t
("Sethe breadcrumb forheerm…arents"),

40 '#desütiÚ' => 
	`t
('If selected,he breadcrumbrail will include‡ll…arenterms,ƒach one†inkingohis view. Notehathis only works if just oneerm was„eceived.'),

41 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['set_breadcrumb']),

44 
$fÜm
['u£_xÚomy_‹rm_·th'] = 
	`¬¿y
(

46 '#t™Ë' => 
	`t
("Use Drupal'saxonomyerm…atho create breadcrumb†inks"),

47 '#desütiÚ' => 
	`t
('If selected,he†inks inhe breadcrumbrail will be created usinghe standard drupal method instead ofhe custom views method. This is useful if you‡re using modules†ikeaxonomy„edirecto modify youraxonomyerm†inks.'),

48 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['use_taxonomy_term_path']),

49 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

50 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-£t-b»adüumb' =>‡¼ay(
TRUE
)),

52 
	}
}

54 
funùiÚ
 
	$£t_b»adüumb
(&
$b»adüumb
) {

55 ià(
	`em±y
(
$this
->
İtiÚs
['£t_b»adüumb']è|| !
	`is_num”ic
($this->
¬gum’t
)) {

59  
	`v›ws_xÚomy_£t_b»adüumb
(
$b»adüumb
, 
$this
);

60 
	}
}

65 
funùiÚ
 
	$deçuÉ_aùiÚs
(
$which
 = 
NULL
) {

66 ià(
$which
) {

67 ià(
	`š_¬¿y
(
$which
, 
	`¬¿y
('ignore', 'not found', 'empty', 'default'))) {

68  
·»Á
::
	`deçuÉ_aùiÚs
(
$which
);

72 
$aùiÚs
 = 
·»Á
::
	`deçuÉ_aùiÚs
();

73 
	`un£t
(
$aùiÚs
['summary‡sc']);

74 
	`un£t
(
$aùiÚs
['summary desc']);

75  
$aùiÚs
;

76 
	}
}

78 
funùiÚ
 
	$qu”y
() {

79 
$this
->
	`’su»_my_bË
();

81 ià(!
	`em±y
(
$this
->
İtiÚs
['break_phrase'])) {

82 
$tids
 = 
Ãw
 
	`¡dCÏss
();

83 
$tids
->
v®ue
 = 
$this
->
¬gum’t
;

84 
$tids
 = 
	`v›ws_b»ak_ph¿£
(
$this
->
¬gum’t
, $tids);

85 ià(
$tids
->
v®ue
 == -1) {

86  
FALSE
;

89 ià(
	`couÁ
(
$tids
->
v®ue
) > 1) {

90 
$¶aûhŞd”
 = " IN (" . 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$tids
->
v®ue
), '%d')) . ")";

93 
$¶aûhŞd”
 = " = %d";

96 
$tids
 = $tids->
v®ue
;

99 
$¶aûhŞd”
 = "= %d";

100 
$tids
 = 
	`¬¿y
(
$this
->
¬gum’t
);

102 
$subqu”y
 = "\n SELECTn.vid FROM {term_node}n\n";

103 
$wh”e
 = " WHEREn.tid $placeholder\n";

104 
$¬gs
 = 
$tids
;

105 
$Ï¡
 = "tn";

107 ià(
$this
->
İtiÚs
['depth'] > 0) {

108 
$subqu”y
 .= " LEFT JOIN {term_hierarchy}h ONh.tid =n.tid\n";

109 
$Ï¡
 = "th";

110 
	`fÜ—ch
 (
	`¿nge
(1, 
	`abs
(
$this
->
İtiÚs
['d•th'])è
as
 
$couÁ
) {

111 
$subqu”y
 .= " LEFT JOIN {term_hierarchy}h$count ON $last.parent =h$count.tid\n";

112 
$wh”e
 .= " ORh$count.tid $placeholder\n";

113 
$¬gs
 = 
	`¬¿y_m”ge
($¬gs, 
$tids
);

114 
$Ï¡
 = "th$count";

117 ià(
$this
->
İtiÚs
['depth'] < 0) {

118 
	`fÜ—ch
 (
	`¿nge
(1, 
	`abs
(
$this
->
İtiÚs
['d•th'])è
as
 
$couÁ
) {

119 
$subqu”y
 .= " LEFT JOIN {term_hierarchy}h$count ON $last.tid =h$count.parent\n";

120 
$wh”e
 .= " ORh$count.tid $placeholder\n";

121 
$¬gs
 = 
	`¬¿y_m”ge
($¬gs, 
$tids
);

122 
$Ï¡
 = "th$count";

126 
$this
->
qu”y
->
	`add_wh”e
(0, "$this->bË_®Ÿs.$this->»®_f›ld IN ($subqu”y$wh” )", 
$¬gs
);

127 
	}
}

129 
funùiÚ
 
	$t™Ë
() {

130 
$‹rm
 = 
	`xÚomy_g‘_‹rm
(
$this
->
¬gum’t
);

131 ià(!
	`em±y
(
$‹rm
)) {

132  
	`check_¶aš
(
$‹rm
->
Çme
);

135  
	`t
('No‚ame');

136 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_argument_term_node_tid_depth_modifier.inc

1 <?
php


10 şas 
	cv›ws_hªdËr_¬gum’t_‹rm_node_tid_d•th_modif›r
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

11 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) { }

12 
funùiÚ
 
	$qu”y
(è{ 
	}
}

13 
funùiÚ
 
	$´e_qu”y
() {

15 
$¬gum’t
 = 
	`is£t
(
$this
->
v›w
->
¬gs
[$this->
pos™iÚ
]è? $this->v›w->¬gs[$this->pos™iÚ] : 
NULL
;

16 ià(!
	`is_num”ic
(
$¬gum’t
)) {

20 ià(
$¬gum’t
 > 10) {

21 
$¬gum’t
 = 10;

24 ià(
$¬gum’t
 < -10) {

25 
$¬gum’t
 = -10;

29 
$keys
 = 
	`¬¿y_»v”£
(
	`¬¿y_keys
(
$this
->
v›w
->
¬gum’t
));

30 
$sk
 = 
TRUE
;

31 
	`fÜ—ch
 (
$keys
 
as
 
$key
) {

32 ià(
$key
 =ğ
$this
->
İtiÚs
['id']) {

33 
$sk
 = 
FALSE
;

37 ià(
$sk
) {

41 ià(
	`em±y
(
$this
->
v›w
->
¬gum’t
[
$key
])) {

45 ià(
	`is£t
(
$hªdËr
)) {

46 
	`un£t
(
$hªdËr
);

49 
$hªdËr
 = &
$this
->
v›w
->
¬gum’t
[
$key
];

50 ià(
	`em±y
(
$hªdËr
->
defš™iÚ
['accept depth modifier'])) {

55 
$hªdËr
->
İtiÚs
['d•th'] = 
$¬gum’t
;

57 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_argument_vocabulary_vid.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_¬gum’t_voÿbuÏry_vid
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

11 
funùiÚ
 
	$t™Ë
() {

12 
$t™Ë
 = 
	`db_»suÉ
(
	`db_qu”y
("SELECT v.ÇmFROM {voÿbuÏry} v WHERE v.vid = %d", 
$this
->
¬gum’t
));

14 ià(
	`em±y
(
$t™Ë
)) {

15  
	`t
('No vocabulary');

18  
	`check_¶aš
(
$t™Ë
);

20 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_field_taxonomy.inc

1 <?
php


8 şas 
	cv›ws_hªdËr_f›ld_xÚomy
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

15 
funùiÚ
 
	$cÚ¡ruù
() {

16 
·»Á
::
	`cÚ¡ruù
();

17 
$this
->
add™iÚ®_f›lds
['vid'] = 'vid';

18 
$this
->
add™iÚ®_f›lds
['tid'] = 'tid';

21 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

22 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

23 
$İtiÚs
['lšk_to_xÚomy'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

24  
$İtiÚs
;

25 
	}
}

30 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

31 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

32 
$fÜm
['lšk_to_xÚomy'] = 
	`¬¿y
(

33 '#t™Ë' => 
	`t
('Linkhis fieldo itsaxonomyerm…age'),

34 '#desütiÚ' => 
	`t
('This will override‡ny other†ink you have set.'),

36 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['link_to_taxonomy']),

38 
	}
}

45 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ues
) {

46 ià(!
	`em±y
(
$this
->
İtiÚs
['lšk_to_xÚomy']è&& !em±y(
$v®ues
->{$this->
®Ÿ£s
['tid']}è&& 
$d©a
 !=ğ
NULL
 && $data !== '') {

47 
$‹rm
 = 
Ãw
 
	`¡dCÏss
();

48 
$‹rm
->
tid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['tid']};

49 
$‹rm
->
vid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['vid']};

50 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
TRUE
;

51 
$this
->
İtiÚs
['®‹r']['·th'] = 
	`xÚomy_‹rm_·th
(
$‹rm
);

53  
$d©a
;

54 
	}
}

56 
funùiÚ
 
	$»nd”
(
$v®ues
) {

57  
$this
->
	`»nd”_lšk
(
	`check_¶aš
(
$v®ues
->{$this->
f›ld_®Ÿs
}), $values);

58 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_field_term_node_tid.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_‹rm_node_tid
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_´”’d”_li¡
 {

8 
funùiÚ
 
	$š™
(&
$v›w
, 
$İtiÚs
) {

9 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

10 ià(
$v›w
->
ba£_bË
 == 'node_revisions') {

11 
$this
->
add™iÚ®_f›lds
['vid'] = 
	`¬¿y
('table' => 'node_revisions', 'field' => 'vid');

14 
$this
->
add™iÚ®_f›lds
['vid'] = 
	`¬¿y
('table' => 'node', 'field' => 'vid');

18 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

19 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

21 
$İtiÚs
['lšk_to_xÚomy'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

22 
$İtiÚs
['lim™'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

23 
$İtiÚs
['vids'] = 
	`¬¿y
('default' =>‡rray());

25  
$İtiÚs
;

26 
	}
}

31 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

32 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

33 
$fÜm
['lšk_to_xÚomy'] = 
	`¬¿y
(

34 '#t™Ë' => 
	`t
('Linkhis fieldo itserm…age'),

36 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['link_to_taxonomy']),

39 
$fÜm
['lim™'] = 
	`¬¿y
(

41 '#t™Ë' => 
	`t
('Limiterms by vocabulary'),

42 '#deçuÉ_v®ue'=> 
$this
->
İtiÚs
['limit'],

45 
$İtiÚs
 = 
	`¬¿y
();

46 
$voÿbuÏr›s
 = 
	`xÚomy_g‘_voÿbuÏr›s
();

47 
	`fÜ—ch
 (
$voÿbuÏr›s
 
as
 
$voc
) {

48 
$İtiÚs
[
$voc
->
vid
] = 
	`check_¶aš
($voc->
Çme
);

51 
$fÜm
['vids'] = 
	`¬¿y
(

55 '#t™Ë' => 
	`t
('Vocabularies'),

56 '#İtiÚs' => 
$İtiÚs
,

57 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['vids'],

58 '#´oûss' => 
	`¬¿y
('expand_checkboxes', 'views_process_dependency'),

59 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-lim™' =>‡¼ay(
TRUE
)),

61 
	}
}

66 
funùiÚ
 
	$qu”y
() {

67 
$this
->
	`add_add™iÚ®_f›lds
();

68 
	}
}

70 
funùiÚ
 
	$´e_»nd”
(
$v®ues
) {

71 
$this
->
f›ld_®Ÿs
 = $this->
®Ÿ£s
['vid'];

72 
$vids
 = 
	`¬¿y
();

73 
	`fÜ—ch
 (
$v®ues
 
as
 
$»suÉ
) {

74 ià(!
	`em±y
(
$»suÉ
->{
$this
->
®Ÿ£s
['vid']})) {

75 
$vids
[] = 
$»suÉ
->{
$this
->
®Ÿ£s
['vid']};

79 ià(
$vids
) {

80 
$voc
 = '';

81 ià(!
	`em±y
(
$this
->
İtiÚs
['limit']) && !empty($this->options['vids'])) {

82 
$voc
 = " ANDd.vid IN (" . 
	`im¶ode
(', ', 
	`¬¿y_keys
(
	`¬¿y_f‹r
(
$this
->
İtiÚs
['vids']))) . ")";

85 
$»suÉ
 = 
	`db_qu”y
("SELECTn.vid AS‚ode_vid,d.*, v.Çma voÿbuÏry FROM {‹rm_d©a}d INNER JOIN {‹rm_node}ÀONd.tid =n.tid INNER JOIN {voÿbuÏry} v ON v.vid =d.vid WHEREn.vid IN (" . 
	`im¶ode
(', ', 
$vids
) . ")$voc ORDER BYd.weight,d.name");

87 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

88 
$this
->
™ems
[
$‹rm
->
node_vid
][$‹rm->
tid
]['Çme'] = 
	`check_¶aš
($‹rm->
Çme
);

89 
$this
->
™ems
[
$‹rm
->
node_vid
][$‹rm->
tid
]['tid'] = $term->tid;

90 
$this
->
™ems
[
$‹rm
->
node_vid
][$‹rm->
tid
]['vid'] = $‹rm->
vid
;

91 
$this
->
™ems
[
$‹rm
->
node_vid
][$‹rm->
tid
]['voÿbuÏry'] = 
	`check_¶aš
($‹rm->
voÿbuÏry
);

93 ià(!
	`em±y
(
$this
->
İtiÚs
['link_to_taxonomy'])) {

94 
$this
->
™ems
[
$‹rm
->
node_vid
][$‹rm->
tid
]['make_lšk'] = 
TRUE
;

95 
$this
->
™ems
[
$‹rm
->
node_vid
][$‹rm->
tid
]['·th'] = 
	`xÚomy_‹rm_·th
($term);

99 
	}
}

101 
funùiÚ
 
	$»nd”_™em
(
$couÁ
, 
$™em
) {

102  
$™em
['name'];

103 
	}
}

105 
funùiÚ
 
	$docum’t_£lf_tok’s
(&
$tok’s
) {

106 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-tid' . ']'] = 
	`t
('Theaxonomyerm ID forheerm.');

107 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-Çme' . ']'] = 
	`t
('Theaxonomyerm‚ame forheerm.');

108 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-vid' . ']'] = 
	`t
('The vocabulary ID forhe vocabularyheerm belongso.');

109 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-voÿbuÏry' . ']'] = 
	`t
('The‚ame forhe vocabularyheerm belongso.');

110 
	}
}

112 
funùiÚ
 
	$add_£lf_tok’s
(&
$tok’s
, 
$™em
) {

113 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-tid' . ']'] = 
$™em
['tid'];

114 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-Çme' . ']'] = 
$™em
['name'];

115 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-vid' . ']'] = 
$™em
['vid'];

116 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-voÿbuÏry' . ']'] = 
$™em
['vocabulary'];

117 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_filter_term_node_tid.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_‹rm_node_tid
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_mªy_to_Úe
 {

8 
funùiÚ
 
	$has_exŒa_İtiÚs
(è{  
TRUE
; }

10 
funùiÚ
 
	$g‘_v®ue_İtiÚs
(è{ 
	}
}

12 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

13 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

15 
$İtiÚs
['ty³'] = 
	`¬¿y
('default' => 'textfield');

16 
$İtiÚs
['lim™'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

17 
$İtiÚs
['vid'] = 
	`¬¿y
('default' => 0);

19  
$İtiÚs
;

20 
	}
}

22 
funùiÚ
 
	$exŒa_İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

23 
$voÿbuÏr›s
 = 
	`xÚomy_g‘_voÿbuÏr›s
();

24 
	`fÜ—ch
 (
$voÿbuÏr›s
 
as
 
$voc
) {

25 
$İtiÚs
[
$voc
->
vid
] = 
	`check_¶aš
($voc->
Çme
);

28 ià(
$this
->
İtiÚs
['limit']) {

31 ià(
$this
->
İtiÚs
['vid'] == 0) {

32 
$this
->
İtiÚs
['vid'] = 
	`db_»suÉ
(
	`db_qu”y
('SELECT MIN(vid) FROM {vocabulary} v'));

35 
$fÜm
['vid'] = 
	`¬¿y
(

39 '#t™Ë' => 
	`t
('Vocabulary'),

40 '#İtiÚs' => 
$İtiÚs
,

41 '#desütiÚ' => 
	`t
('Select which vocabularyo showerms for inhe„egular options.'),

42 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['vid'],

46 
$fÜm
['m¬kup_¡¬t'] = 
	`¬¿y
(

50 
$fÜm
['ty³'] = 
	`¬¿y
(

52 '#t™Ë' => 
	`t
('Selectionype'),

53 '#İtiÚs' => 
	`¬¿y
('£Ëù' => 
	`t
('Dropdown'), 'textfield' =>('Autocomplete')),

54 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['type'],

57 
$fÜm
['h›¿rchy'] = 
	`¬¿y
(

59 '#t™Ë' => 
	`t
('Show hierarchy in dropdown'),

60 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['hierarchy']),

61 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

62 '#d•’d’cy' => 
	`¬¿y
('radio:options[type]' =>‡rray('select')),

65 
$fÜm
['m¬kup_’d'] = 
	`¬¿y
(

68 
	}
}

70 
funùiÚ
 
	$v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

71 
$voÿbuÏry
 = 
	`xÚomy_voÿbuÏry_lßd
(
$this
->
İtiÚs
['vid']);

72 ià(
	`em±y
(
$voÿbuÏry
è&& 
$this
->
İtiÚs
['limit']) {

73 
$fÜm
['m¬kup'] = 
	`¬¿y
(

76 '#v®ue' => 
	`t
('An invalid vocabulary is selected. Please change it inhe options.'),

81 ià(
$this
->
İtiÚs
['type'] == 'textfield') {

82 
$deçuÉ
 = '';

83 ià(
$this
->
v®ue
) {

84 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {‹rm_d©a}d WHEREd.tid IN (" . 
	`im¶ode
(', ', 
$this
->
v®ue
) . ')');

85 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

86 ià(
$deçuÉ
) {

87 
$deçuÉ
 .= ', ';

89 
$deçuÉ
 .ğ
$‹rm
->
Çme
;

93 
$fÜm
['v®ue'] = 
	`¬¿y
(

94 '#t™Ë' => 
$this
->
İtiÚs
['lim™'] ? 
	`t
('S–eù”m äom voÿbuÏry @voc', 
	`¬¿y
('@voc' => 
$voÿbuÏry
->
Çme
)) :('Selecterms'),

96 '#deçuÉ_v®ue' => 
$deçuÉ
,

99 ià(
$this
->
İtiÚs
['limit']) {

100 
$fÜm
['v®ue']['#autocom¶‘e_·th'] = 'xÚomy/autocom¶‘e/' . 
$voÿbuÏry
->
vid
;

104 ià(!
	`em±y
(
$this
->
İtiÚs
['hierarchy']) && $this->options['limit']) {

105 
$Œ“
 = 
	`xÚomy_g‘_Œ“
(
$voÿbuÏry
->
vid
);

106 
$İtiÚs
 = 
	`¬¿y
();

108 ià(
$Œ“
) {

109 
	`fÜ—ch
 (
$Œ“
 
as
 
$‹rm
) {

110 
$choiû
 = 
Ãw
 
	`¡dCÏss
();

111 
$choiû
->
İtiÚ
 = 
	`¬¿y
(
$‹rm
->
tid
 => 
	`¡r_»³©
('-', $‹rm->
d•th
è. $‹rm->
Çme
);

112 
$İtiÚs
[] = 
$choiû
;

117 
$İtiÚs
 = 
	`¬¿y
();

118 ià(
$this
->
İtiÚs
['limit']) {

119 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {‹rm_d©a} WHERE vid = %d ORDER BY weight,‚ame", 
$voÿbuÏry
->
vid
);

122 
$»suÉ
 = 
	`db_qu”y
("SELECTd.* FROM {term_data}d INNER JOIN {vocabulary} v ONd.vid = v.vid ORDER BY v.weight, v.name,d.weight,d.name");

124 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

125 
$İtiÚs
[
$‹rm
->
tid
] = $‹rm->
Çme
;

129 
$deçuÉ_v®ue
 = (
¬¿y
è
$this
->
v®ue
;

131 ià(!
	`em±y
(
$fÜm_¡©e
['exposed'])) {

132 
$id’tif›r
 = 
$this
->
İtiÚs
['expose']['identifier'];

134 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['reduce'])) {

135 
$İtiÚs
 = 
$this
->
	`»duû_v®ue_İtiÚs
($options);

137 ià(
	`em±y
(
$this
->
İtiÚs
['expose']['single']) && !empty($this->options['expose']['optional'])) {

138 
$deçuÉ_v®ue
 = 
	`¬¿y
();

142 ià(!
	`em±y
(
$this
->
İtiÚs
['expose']['single'])) {

143 ià(!
	`em±y
(
$this
->
İtiÚs
['expo£']['İtiÚ®']è&& (em±y(
$deçuÉ_v®ue
) || !empty($this->options['expose']['reduce']))) {

144 
$deçuÉ_v®ue
 = 'All';

146 ià(
	`em±y
(
$deçuÉ_v®ue
)) {

147 
$keys
 = 
	`¬¿y_keys
(
$İtiÚs
);

148 
$deçuÉ_v®ue
 = 
	`¬¿y_shiá
(
$keys
);

151 
$cİy
 = 
$deçuÉ_v®ue
;

152 
$deçuÉ_v®ue
 = 
	`¬¿y_shiá
(
$cİy
);

156 
$fÜm
['v®ue'] = 
	`¬¿y
(

158 '#t™Ë' => 
$this
->
İtiÚs
['lim™'] ? 
	`t
('S–eù”m äom voÿbuÏry @voc', 
	`¬¿y
('@voc' => 
$voÿbuÏry
->
Çme
)) :('Selecterms'),

159 '#muÉË' => 
TRUE
,

160 '#İtiÚs' => 
$İtiÚs
,

161 '#size' => 
	`mš
(9, 
	`couÁ
(
$İtiÚs
)),

162 '#deçuÉ_v®ue' => 
$deçuÉ_v®ue
,

165 ià(!
	`em±y
(
$fÜm_¡©e
['expo£d']è&& !
	`is£t
($fÜm_¡©e['šput'][
$id’tif›r
])) {

166 
$fÜm_¡©e
['šput'][
$id’tif›r
] = 
$deçuÉ_v®ue
;

171 ià(
	`em±y
(
$fÜm_¡©e
['exposed'])) {

173 
$this
->
h–³r
->
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

175 
	}
}

177 
funùiÚ
 
	$v®ue_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
) {

179 ià(
$this
->
İtiÚs
['type'] != 'textfield') {

183 
$v®ues
 = 
	`dru·l_ex¶ode_gs
(
$fÜm_¡©e
['values']['options']['value']);

184 
$tids
 = 
$this
->
	`v®id©e_‹rm_¡ršgs
(
$fÜm
['v®ue'], 
$v®ues
);

186 ià(
$tids
) {

187 
$fÜm_¡©e
['v®ues']['İtiÚs']['v®ue'] = 
$tids
;

189 
	}
}

191 
funùiÚ
 
	$acû±_expo£d_šput
(
$šput
) {

192 ià(
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

193  
TRUE
;

197 ià(
$this
->
İtiÚs
['expo£']['İtiÚ®'] && 
	`em±y
($this->
v®id©ed_expo£d_šput
)) {

198  
FALSE
;

201 
$rc
 = 
·»Á
::
	`acû±_expo£d_šput
(
$šput
);

202 ià(
$rc
) {

204 ià(
	`is£t
(
$this
->
v®id©ed_expo£d_šput
)) {

205 
$this
->
v®ue
 = $this->
v®id©ed_expo£d_šput
;

209  
$rc
;

210 
	}
}

212 
funùiÚ
 
	$expo£d_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
) {

213 ià(
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

217 
$id’tif›r
 = 
$this
->
İtiÚs
['expose']['identifier'];

220 ià(
$this
->
İtiÚs
['type'] != 'textfield') {

221 ià(
$fÜm_¡©e
['v®ues'][
$id’tif›r
] != 'All') {

222 
$this
->
v®id©ed_expo£d_šput
 = (
¬¿y
è
$fÜm_¡©e
['v®ues'][
$id’tif›r
];

227 ià(
	`em±y
(
$this
->
İtiÚs
['expose']['identifier'])) {

231 
$v®ues
 = 
	`dru·l_ex¶ode_gs
(
$fÜm_¡©e
['v®ues'][
$id’tif›r
]);

233 
$tids
 = 
$this
->
	`v®id©e_‹rm_¡ršgs
(
$fÜm
[
$id’tif›r
], 
$v®ues
);

234 ià(
$tids
) {

235 
$this
->
v®id©ed_expo£d_šput
 = 
$tids
;

237 
	}
}

244 
funùiÚ
 
	$v®id©e_‹rm_¡ršgs
(&
$fÜm
, 
$v®ues
) {

245 ià(
	`em±y
(
$v®ues
)) {

246  
	`¬¿y
();

249 
$tids
 = 
	`¬¿y
();

250 
$¶aûhŞd”s
 = 
	`¬¿y
();

251 
$¬gs
 = 
	`¬¿y
();

252 
$»suÉs
 = 
	`¬¿y
();

253 
	`fÜ—ch
 (
$v®ues
 
as
 
$v®ue
) {

254 
$missšg
[
	`¡¹Şow”
(
$v®ue
)] = 
TRUE
;

255 
$¬gs
[] = 
$v®ue
;

256 
$¶aûhŞd”s
[] = "'%s'";

259 ià(!
$¬gs
) {

264 
$¬gs
[] = 
$this
->
İtiÚs
['vid'];

266 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {‹rm_d©a} WHERE‚amIN (" . 
	`im¶ode
(', ', 
$¶aûhŞd”s
è. "èAND vid = %d", 
$¬gs
);

267 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

268 
	`un£t
(
$missšg
[
	`¡¹Şow”
(
$‹rm
->
Çme
)]);

269 
$tids
[] = 
$‹rm
->
tid
;

272 ià(
$missšg
) {

273 
	`fÜm_”rÜ
(
$fÜm
, 
	`fÜm©_¶u¿l
(
	`couÁ
(
$missšg
), 'UÇbËØfšd”m: @‹rms', 'UÇbËØfšd”ms: @‹rms', 
	`¬¿y
('@‹rms' => 
	`im¶ode
(', ', 
	`¬¿y_keys
($missing)))));

276  
$tids
;

277 
	}
}

279 
funùiÚ
 
	$v®ue_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

281 
	}
}

283 
funùiÚ
 
	$expo£_fÜm_right
(&
$fÜm
, &
$fÜm_¡©e
) {

284 
·»Á
::
	`expo£_fÜm_right
(
$fÜm
, 
$fÜm_¡©e
);

285 ià(
$this
->
İtiÚs
['type'] != 'select') {

286 
	`un£t
(
$fÜm
['expose']['reduce']);

288 
	}
}

290 
funùiÚ
 
	$admš_summ¬y
() {

292 
$this
->
v®ue_İtiÚs
 = 
	`¬¿y
();

294 ià(
$this
->
v®ue
) {

295 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {‹rm_d©a}d WHEREd.tid IN (" . 
	`im¶ode
(', ', 
$this
->
v®ue
) . ")");

297 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

298 
$this
->
v®ue_İtiÚs
[
$‹rm
->
tid
] = $‹rm->
Çme
;

301  
·»Á
::
	`admš_summ¬y
();

302 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_filter_term_node_tid_depth.inc

1 <?
php


9 şas 
	cv›ws_hªdËr_f‹r_‹rm_node_tid_d•th
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_‹rm_node_tid
 {

10 
funùiÚ
 
	$İ”©Ü_İtiÚs
() {

11  
	`¬¿y
(

12 'Ü' => 
	`t
('Is one of'),

16 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

17 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

19 
$İtiÚs
['d•th'] = 
	`¬¿y
('default' => 0);

21  
$İtiÚs
;

22 
	}
}

24 
funùiÚ
 
	$exŒa_İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

25 
·»Á
::
	`exŒa_İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

27 
$fÜm
['d•th'] = 
	`¬¿y
(

29 '#t™Ë' => 
	`t
('Depth'),

30 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['depth'],

31 '#desütiÚ' => 
	`t
('The depth will match‚odesagged witherms inhe hierarchy. Forƒxample, if you haveheerm "fruit"‡nd‡ childerm "apple", with‡ depth of 1 (or higher)hen filtering forheerm "fruit" will get‚odeshat‡reagged with "apple"‡s well‡s "fruit". If‚egative,he„everse isrue; searching for "apple" will‡lso…ick up‚odesagged with "fruit" if depth is -1 (or†ower).'),

33 
	}
}

35 
funùiÚ
 
	$qu”y
() {

37 ià(
	`couÁ
(
$this
->
v®ue
) == 0) {

40 ià(
	`couÁ
(
$this
->
v®ue
) == 1) {

41 
$¶aûhŞd”
 = " = %d";

44 
$¶aûhŞd”
 = " IN (" . 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$this
->
v®ue
), '%d')) . ")";

51 ià(!
	`em±y
(
$this
->
»ÏtiÚsh
)) {

52 
$this
->
bË_®Ÿs
 = $this->
»ÏtiÚsh
;

55 ià(
	`is£t
(
$this
->
qu”y
->
bË_queue
[$this->qu”y->
ba£_bË
]['alias'])) {

56 
$this
->
bË_®Ÿs
 = $this->
qu”y
->
bË_queue
[$this->qu”y->
ba£_bË
]['alias'];

64 
$subqu”y
 = "\n SELECTn.vid FROM {term_node}n\n";

65 
$wh”e
 = " WHEREn.tid $placeholder\n";

66 
$¬gs
 = 
$this
->
v®ue
;

67 
$Ï¡
 = "tn";

69 ià(
$this
->
İtiÚs
['depth'] > 0) {

70 
$subqu”y
 .= " LEFT JOIN {term_hierarchy}h ONh.tid =n.tid\n";

71 
$Ï¡
 = "th";

72 
	`fÜ—ch
 (
	`¿nge
(1, 
	`abs
(
$this
->
İtiÚs
['d•th'])è
as
 
$couÁ
) {

73 
$subqu”y
 .= " LEFT JOIN {term_hierarchy}h$count ON $last.parent =h$count.tid\n";

74 
$wh”e
 .= " ORh$count.tid $placeholder\n";

75 
$¬gs
 = 
	`¬¿y_m”ge
($¬gs, 
$this
->
v®ue
);

76 
$Ï¡
 = "th$count";

79 ià(
$this
->
İtiÚs
['depth'] < 0) {

80 
	`fÜ—ch
 (
	`¿nge
(1, 
	`abs
(
$this
->
İtiÚs
['d•th'])è
as
 
$couÁ
) {

81 
$subqu”y
 .= " LEFT JOIN {term_hierarchy}h$count ON $last.tid =h$count.parent\n";

82 
$wh”e
 .= " ORh$count.tid $placeholder\n";

83 
$¬gs
 = 
	`¬¿y_m”ge
($¬gs, 
$this
->
v®ue
);

84 
$Ï¡
 = "th$count";

88 
$this
->
qu”y
->
	`add_wh”e
(0, "$this->bË_®Ÿs.$this->»®_f›ld IN ($subqu”y$wh” )", 
$¬gs
);

89 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_filter_vocabulary_vid.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_voÿbuÏry_vid
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_š_İ”©Ü
 {

8 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

9 ià(
	`is£t
(
$this
->
v®ue_İtiÚs
)) {

13 
$this
->
v®ue_İtiÚs
 = 
	`¬¿y
();

14 
$voÿbuÏr›s
 = 
	`xÚomy_g‘_voÿbuÏr›s
();

15 
	`fÜ—ch
 (
$voÿbuÏr›s
 
as
 
$voc
) {

16 
$this
->
v®ue_İtiÚs
[
$voc
->
vid
] = $voc->
Çme
;

19 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_relationship_node_term_data.inc

1 <?
php


8 şas 
	cv›ws_hªdËr_»ÏtiÚsh_node_‹rm_d©a
 
ex‹nds
 
	mv›ws_hªdËr_»ÏtiÚsh
 {

9 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

10 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

11 
$İtiÚs
['vids'] = 
	`¬¿y
('default' =>‡rray());

12  
$İtiÚs
;

19 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

20 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

21 
$voÿbuÏr›s
 = 
	`xÚomy_g‘_voÿbuÏr›s
();

22 
$İtiÚs
 = 
	`¬¿y
();

23 
	`fÜ—ch
 (
$voÿbuÏr›s
 
as
 
$voc
) {

24 
$İtiÚs
[
$voc
->
vid
] = 
	`check_¶aš
($voc->
Çme
);

27 
$fÜm
['vids'] = 
	`¬¿y
(

29 '#t™Ë' => 
	`t
('Vocabularies'),

30 '#İtiÚs' => 
$İtiÚs
,

31 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['vids'],

32 '#desütiÚ' => 
	`t
('Choose which vocabularies you wisho„elate. Rememberhatƒveryerm found will create‡‚ew„ecord, sohis„elationship is best used on just one vocabularyhat has only oneerm…er‚ode.'),

34 
	}
}

39 
funùiÚ
 
	$qu”y
() {

40 
$this
->
	`’su»_my_bË
();

42 
$def
 = 
$this
->
defš™iÚ
;

43 
$def
['table'] = 'term_data';

45 ià(!
	`em±y
(
$this
->
İtiÚs
['»quœed']è|| !
	`¬¿y_f‹r
($this->options['vids'])) {

46 
$‹rm_node
 = 
$this
->
qu”y
->
	`add_bË
('‹rm_node', $this->
»ÏtiÚsh
);

47 
$def
['Ëá_bË'] = 
$‹rm_node
;

48 
$def
['left_field'] = 'tid';

49 
$def
['field'] = 'tid';

50 ià(!
	`em±y
(
$this
->
İtiÚs
['required'])) {

51 
$def
['type'] = 'INNER';

56 
$def
['Ëá_bË'] = 
$this
->
bË_®Ÿs
;

57 
$def
['left_field'] = 'vid';

58 
$def
['field'] = 'revision';

60 
$vids
 = 
	`im¶ode
(', ', 
	`¬¿y_f‹r
(
$this
->
İtiÚs
['vids']));

61 
$def
['table formula'] = "(SELECTd.*,n.vid AS„evision FROM {term_data}d INNER JOIN {term_node}n ONn.tid =d.tid WHEREd.vid IN ($vids))";

64 
$još
 = 
Ãw
 
	`v›ws_još
();

66 
$još
->
defš™iÚ
 = 
$def
;

67 
$još
->
	`cÚ¡ruù
();

68 
$još
->
adju¡ed
 = 
TRUE
;

71 
$®Ÿs
 = 
$def
['bË'] . '_' . 
$this
->
bË
;

73 
$this
->
®Ÿs
 = $this->
qu”y
->
	`add_»ÏtiÚsh
(
$®Ÿs
, 
$još
, '‹rm_d©a', $this->
»ÏtiÚsh
);

74 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_plugin_argument_default_taxonomy_tid.inc

1 <?
php


8 şas 
	cv›ws_¶ugš_¬gum’t_deçuÉ_xÚomy_tid
 
ex‹nds
 
	mv›ws_¶ugš_¬gum’t_deçuÉ
 {

9 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

10 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

12 
$İtiÚs
['‹rm_·ge'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

13 
$İtiÚs
['node'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

14 
$İtiÚs
['lim™'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

15 
$İtiÚs
['vids'] = 
	`¬¿y
('deçuÉ' => 
NULL
);

17  
$İtiÚs
;

20 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

21 
$fÜm
['‹rm_·ge'] = 
	`¬¿y
(

23 '#t™Ë' => 
	`t
('Load default‡rgument fromerm…age'),

24 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['term_page'],

26 
$fÜm
['node'] = 
	`¬¿y
(

28 '#t™Ë' => 
	`t
('Load default‡rgument from‚ode…age,hats good for„elatedaxonomy blocks.'),

29 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['node'],

32 
$fÜm
['lim™'] = 
	`¬¿y
(

34 '#t™Ë' => 
	`t
('Limiterms by vocabulary'),

35 '#deçuÉ_v®ue'=> 
$this
->
İtiÚs
['limit'],

36 '#´oûss' => 
	`¬¿y
('expand_checkboxes', 'views_process_dependency'),

37 '#d•’d’cy' => 
	`¬¿y
(

38 'ed™-İtiÚs-¬gum’t-deçuÉ-xÚomy-tid-node' => 
	`¬¿y
(1),

42 
$İtiÚs
 = 
	`¬¿y
();

43 
$voÿbuÏr›s
 = 
	`xÚomy_g‘_voÿbuÏr›s
();

44 
	`fÜ—ch
 (
$voÿbuÏr›s
 
as
 
$voc
) {

45 
$İtiÚs
[
$voc
->
vid
] = 
	`check_¶aš
($voc->
Çme
);

48 
$fÜm
['vids'] = 
	`¬¿y
(

52 '#t™Ë' => 
	`t
('Vocabularies'),

53 '#İtiÚs' => 
$İtiÚs
,

54 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['vids'],

55 '#´oûss' => 
	`¬¿y
('expand_checkboxes', 'views_process_dependency'),

56 '#d•’d’cy' => 
	`¬¿y
(

58 'ed™-İtiÚs-¬gum’t-deçuÉ-xÚomy-tid-node' => 
	`¬¿y
(1),

61 
	}
}

63 
funùiÚ
 
	$İtiÚs_subm™
(&
$fÜm
, &
$fÜm_¡©e
, &
$İtiÚs
) {

65 
$İtiÚs
['vids'] = 
	`¬¿y_f‹r
($options['vids']);

66 
	}
}

68 
funùiÚ
 
	$g‘_¬gum’t
() {

70 ià(!
	`em±y
(
$this
->
İtiÚs
['term_page'])) {

71 ià(
	`¬g
(0è=ğ'xÚomy' &&‡rg(1è=ğ'‹rm' && 
	`is_num”ic
(arg(2))) {

72  
	`¬g
(2);

76 ià(!
	`em±y
(
$this
->
İtiÚs
['node'])) {

77 
	`fÜ—ch
 (
	`¿nge
(1, 3è
as
 
$i
) {

78 
$node
 = 
	`m’u_g‘_objeù
('node', 
$i
);

79 ià(!
	`em±y
(
$node
)) {

84 ià(
$node
) {

85 ià(!
	`em±y
(
$this
->
İtiÚs
['limit'])) {

86 
$tids
 = 
	`¬¿y
();

88 
	`fÜ—ch
 (
$node
->
xÚomy
 
as
 
$tid
 => 
$‹rm
) {

89 ià(!
	`em±y
(
$this
->
İtiÚs
['vids'][
$‹rm
->
vid
])) {

90 
$tids
[] = 
$tid
;

93  
	`im¶ode
(",", 
$tids
);

97  
	`im¶ode
(",", 
	`¬¿y_keys
(
$node
->
xÚomy
));

101 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_plugin_argument_validate_taxonomy_term.inc

1 <?
php


11 şas 
	cv›ws_¶ugš_¬gum’t_v®id©e_xÚomy_‹rm
 
ex‹nds
 
	mv›ws_¶ugš_¬gum’t_v®id©e
 {

12 
funùiÚ
 
	$v®id©e_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

13 
$voÿbuÏr›s
 = 
	`xÚomy_g‘_voÿbuÏr›s
();

14 
$İtiÚs
 = 
	`¬¿y
();

15 
	`fÜ—ch
 (
$voÿbuÏr›s
 
as
 
$voc
) {

16 
$İtiÚs
[
$voc
->
vid
] = 
	`check_¶aš
($voc->
Çme
);

19 
$fÜm
['v®id©e_¬gum’t_voÿbuÏry'] = 
	`¬¿y
(

23 '#t™Ë' => 
	`t
('Vocabularies'),

24 '#İtiÚs' => 
$İtiÚs
,

25 '#deçuÉ_v®ue' => 
	`is£t
(
$this
->
¬gum’t
->
İtiÚs
['v®id©e_¬gum’t_voÿbuÏry']è? $this->¬gum’t->İtiÚs['v®id©e_¬gum’t_voÿbuÏry'] : 
	`¬¿y
(),

26 '#desütiÚ' => 
	`t
('If you wisho validate for specific vocabularies, checkhem; if‚one‡re checked,‡llerms will…ass.'),

27 '#´oûss' => 
	`¬¿y
('expand_checkboxes', 'views_process_dependency'),

28 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-v®id©e-ty³' =>‡¼ay(
$this
->
id
)),

31 
$fÜm
['v®id©e_¬gum’t_ty³'] = 
	`¬¿y
(

33 '#t™Ë' => 
	`t
('Argumentype'),

34 '#İtiÚs' => 
	`¬¿y
(

35 'tid' => 
	`t
('Term ID'),

36 'tids' => 
	`t
('Term IDs separated by , or +'),

37 'Çme' => 
	`t
('Term‚ame or synonym'),

38 'cÚv”t' => 
	`t
('Term‚ame/synonym convertedo Term ID'),

40 '#deçuÉ_v®ue' => 
	`is£t
(
$this
->
¬gum’t
->
İtiÚs
['validate_argument_type']) ? $this->argument->options['validate_argument_type'] : 'tid',

41 '#desütiÚ' => 
	`t
('Selecthe form ofhis‡rgument; if usingerm‚ame, it is generally moreƒfficiento convert ito‡erm ID‡nd use Taxonomy: Term ID„atherhan Taxonomy: Term Name"‡s‡n‡rgument.'),

42 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

43 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-v®id©e-ty³' =>‡¼ay(
$this
->
id
)),

46 
$fÜm
['v®id©e_¬gum’t_ŒªsfÜm'] = 
	`¬¿y
(

48 '#t™Ë' => 
	`t
('Transform dashes in URLo spaces inerm‚ame‡rguments'),

49 '#deçuÉ_v®ue' => 
	`is£t
(
$this
->
¬gum’t
->
İtiÚs
['v®id©e_¬gum’t_ŒªsfÜm']è? $this->¬gum’t->İtiÚs['v®id©e_¬gum’t_ŒªsfÜm'] : 
FALSE
,

50 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

51 '#d•’d’cy' => 
	`¬¿y
('edit-options-validate-argument-type' =>‡rray('convert')),

55 
funùiÚ
 
	$v®id©e_¬gum’t
(
$¬gum’t
) {

56 
$vids
 = 
	`is£t
(
$this
->
¬gum’t
->
İtiÚs
['v®id©e_¬gum’t_voÿbuÏry']è? 
	`¬¿y_f‹r
($this->¬gum’t->İtiÚs['v®id©e_¬gum’t_voÿbuÏry']è: 
	`¬¿y
();

57 
$ty³
 = 
	`is£t
(
$this
->
¬gum’t
->
İtiÚs
['validate_argument_type']) ? $this->argument->options['validate_argument_type'] : 'tid';

58 
$ŒªsfÜm
 = 
	`is£t
(
$this
->
¬gum’t
->
İtiÚs
['v®id©e_¬gum’t_ŒªsfÜm']è? $this->¬gum’t->İtiÚs['v®id©e_¬gum’t_ŒªsfÜm'] : 
FALSE
;

60 
$ty³
) {

62 ià(!
	`is_num”ic
(
$¬gum’t
)) {

63  
FALSE
;

66 
$»suÉ
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT * FROM {‹rm_d©a} WHEREid = %d", 
$¬gum’t
));

67 ià(!
$»suÉ
) {

68  
FALSE
;

71  
	`em±y
(
$vids
è|| !em±y($vids[
$»suÉ
->
vid
]);

73 
$tids
 = 
Ãw
 
	`¡dCÏss
();

74 
$tids
->
v®ue
 = 
$¬gum’t
;

75 
$tids
 = 
	`v›ws_b»ak_ph¿£
(
$¬gum’t
, $tids);

76 ià(
$tids
->
v®ue
 =ğ
	`¬¿y
(-1)) {

77  
FALSE
;

80 
$‹¡
 = 
	`dru·l_m­_assoc
(
$tids
->
v®ue
);

81 
$t™Ës
 = 
	`¬¿y
();

84 
$v®id©ed_ÿche
 = 
	`¬¿y
();

85 
	`fÜ—ch
 (
$‹¡
 
as
 
$tid
) {

86 ià(
	`is£t
(
$v®id©ed_ÿche
[
$tid
])) {

87 ià(
$v®id©ed_ÿche
[
$tid
] ==ğ
FALSE
) {

88  
FALSE
;

91 
$t™Ës
[] = 
$v®id©ed_ÿche
[
$tid
];

92 
	`un£t
(
$‹¡
[
$tid
]);

99 ià(
	`couÁ
(
$‹¡
)) {

100 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, 
	`couÁ
(
$‹¡
), '%d'));

102 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {‹rm_d©a} WHEREid IN ($¶aûhŞd”s)", 
$‹¡
);

103 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

104 ià(
$vids
 && 
	`em±y
($vids[
$‹rm
->
vid
])) {

105 
$v®id©ed_ÿche
[
$‹rm
->
tid
] = 
FALSE
;

106  
FALSE
;

109 
$t™Ës
[] = 
$v®id©ed_ÿche
[
$‹rm
->
tid
] = 
	`check_¶aš
($‹rm->
Çme
);

110 
	`un£t
(
$‹¡
[
$‹rm
->
tid
]);

115 
$t™Ës
 = 
	`¬¿y_unique
($titles);

117 
$this
->
¬gum’t
->
v®id©ed_t™Ë
 = 
	`im¶ode
(
$tids
->
İ”©Ü
 =ğ'Ü' ? ' + ' : ', ', 
$t™Ës
);

119  
	`em±y
(
$‹¡
);

122 
$ªd
 = '';

123 ià(!
	`em±y
(
$vids
)) {

124 
$ªd
 = " ANDd.vid IN(" . 
	`im¶ode
(', ', 
$vids
) . ')';

126 ià(
$ŒªsfÜm
) {

127 
$»suÉ
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECTd.* FROM {‹rm_d©a}d LEFT JOIN {‹rm_synÚym} ONs.tid =d.tid WHERE (»¶aûÑd.Çme, ' ', '-'èğ'%s' OR„•ÏûÑs.Çme, ' ', '-'èğ'%s')$ªd", 
$¬gum’t
, $argument));

130 
$»suÉ
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECTd.* FROM {‹rm_d©a}d LEFT JOIN {‹rm_synÚym} ONs.tid =d.tid WHERE (td.Çmğ'%s' ORs.Çmğ'%s')$ªd", 
$¬gum’t
, $argument));

132 ià(!
$»suÉ
) {

133  
FALSE
;

136 ià(
$ty³
 == 'convert') {

137 
$this
->
¬gum’t
->¬gum’ˆğ
$»suÉ
->
tid
;

138 
$this
->
¬gum’t
->
v®id©ed_t™Ë
 = 
	`check_¶aš
(
$»suÉ
->
Çme
);

141  
TRUE
;

143 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation.views.inc

1 <?
php


21 
funùiÚ
 
	$Œª¦©iÚ_v›ws_d©a_®‹r
(&
$d©a
) {

24 
$d©a
['node']['bË']['još']['node'] = 
	`¬¿y
(

30 
$d©a
['node']['Ïnguage'] = 
	`¬¿y
(

31 'group' => 
	`t
('Noderanslation'),

32 't™Ë' => 
	`t
('Language'),

33 'h–p' => 
	`t
('The†anguagehe content is in.'),

34 'f›ld' => 
	`¬¿y
(

36 'şick sÜbË' => 
TRUE
,

38 'f‹r' => 
	`¬¿y
(

41 '¬gum’t' => 
	`¬¿y
(

47 
$d©a
['node']['Šid'] = 
	`¬¿y
(

48 'group' => 
	`t
('Noderanslation'),

49 't™Ë' => 
	`t
('Translation set‚ode ID'),

50 'h–p' => 
	`t
('The ID ofheranslation sethe content belongso.'),

51 'f›ld' => 
	`¬¿y
(

53 'şick sÜbË' => 
TRUE
,

55 'f‹r' => 
	`¬¿y
(

58 '¬gum’t' => 
	`¬¿y
(

62 'num”ic' => 
TRUE
,

65 'sÜt' => 
	`¬¿y
(

68 '»ÏtiÚsh' => 
	`¬¿y
(

69 't™Ë' => 
	`t
('Sourceranslation'),

70 'h–p' => 
	`t
('The sourcehathis content wasranslated from.'),

74 'Ïb–' => 
	`t
('Sourceranslation'),

79 
$d©a
['node']['Œª¦©iÚ'] = 
	`¬¿y
(

80 'group' => 
	`t
('Noderanslation'),

81 't™Ë' => 
	`t
('Translations'),

82 'h–p' => 
	`t
('Versions of content in different†anguages.'),

83 '»ÏtiÚsh' => 
	`¬¿y
(

84 't™Ë' => 
	`t
('Translations'),

85 'h–p' => 
	`t
('Versions of content in different†anguages.'),

91 'Ïb–' => 
	`t
('Translations'),

96 
$d©a
['node']['sourû_Œª¦©iÚ'] = 
	`¬¿y
(

97 'group' => 
	`t
('Noderanslation'),

98 't™Ë' => 
	`t
('Sourceranslation'),

99 'h–p' => 
	`t
('Nodeshat‡reƒither untranslated or‡rehe original versions of‡ranslation set.'),

100 'f‹r' => 
	`¬¿y
(

106 
$d©a
['node']['chd_Œª¦©iÚ'] = 
	`¬¿y
(

107 'group' => 
	`t
('Noderanslation'),

108 't™Ë' => 
	`t
('Childranslation'),

109 'h–p' => 
	`t
('Nodeshat‡reranslations of‡ sourceranslation.'),

110 'f‹r' => 
	`¬¿y
(

116 
$d©a
['node']['Œª¦©e'] = 
	`¬¿y
(

117 'group' => 
	`t
('Noderanslation'),

118 't™Ë' => 
	`t
('Translation status'),

119 'h–p' => 
	`t
('Theranslation status ofhe‚ode--whether or‚otheranslation‚eedso be updated.'),

120 'f›ld' => 
	`¬¿y
(

122 'şick sÜbË' => 
TRUE
,

124 'f‹r' => 
	`¬¿y
(

126 'Ïb–' => 
	`t
('Outdated'),

129 'sÜt' => 
	`¬¿y
(

135 
$d©a
['node']['Œª¦©e_node'] = 
	`¬¿y
(

136 'group' => 
	`t
('Noderanslation'),

137 't™Ë' => 
	`t
('Translate†ink'),

138 'h–p' => 
	`t
('Provide‡ simple†inkoranslatehe‚ode.'),

139 'f›ld' => 
	`¬¿y
(

145 
	}
}

151 
funùiÚ
 
	$Œª¦©iÚ_v›ws_hªdËrs
() {

152  
	`¬¿y
(

153 'šfo' => 
	`¬¿y
(

154 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/translation',

156 'hªdËrs' => 
	`¬¿y
(

158 'v›ws_hªdËr_f›ld_node_Ïnguage' => 
	`¬¿y
(

161 'v›ws_hªdËr_f›ld_node_lšk_Œª¦©e' => 
	`¬¿y
(

165 'v›ws_hªdËr_¬gum’t_node_Ïnguage' => 
	`¬¿y
(

168 'v›ws_hªdËr_¬gum’t_node_Šid' => 
	`¬¿y
(

172 'v›ws_hªdËr_f‹r_node_Ïnguage' => 
	`¬¿y
(

175 'v›ws_hªdËr_f‹r_node_Šid' => 
	`¬¿y
(

179 'v›ws_hªdËr_»ÏtiÚsh_Œª¦©iÚ' => 
	`¬¿y
(

182 'v›ws_hªdËr_f‹r_node_Šid_chd' => 
	`¬¿y
(

188 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_argument_node_language.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_¬gum’t_node_Ïnguage
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
('language');

15 
funùiÚ
 
	$summ¬y_Çme
(
$d©a
) {

16  
$this
->
	`node_Ïnguage
(
$d©a
->{$this->
Çme_®Ÿs
});

17 
	}
}

23 
funùiÚ
 
	$t™Ë
() {

24  
$this
->
	`node_Ïnguage
($this->
¬gum’t
);

25 
	}
}

27 
funùiÚ
 
	$node_Ïnguage
(
$Ïngcode
) {

28 
$Ïnguages
 = 
	`loÿË_Ïnguage_li¡
();

29  
	`is£t
(
$Ïnguages
[
$Ïngcode
]è? $Ïnguages[$Ïngcode] : 
	`t
('Unknown†anguage');

30 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_argument_node_tnid.inc

1 <?
php


11 şas 
	cv›ws_hªdËr_¬gum’t_node_Šid
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_num”ic
 {

15 
funùiÚ
 
	$t™Ë_qu”y
() {

16 
$t™Ës
 = 
	`¬¿y
();

17 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$this
->
v®ue
), '%d'));

19 
$»suÉ
 = 
	`db_qu”y
("SELECT‚.t™Ë FROM {node}‚ WHERE‚.Šid IN ($¶aûhŞd”s)", 
$this
->
v®ue
);

20 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

21 
$t™Ës
[] = 
	`check_¶aš
(
$‹rm
->
t™Ë
);

23  
$t™Ës
;

25 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_field_node_language.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_node_Ïnguage
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_node
 {

8 
funùiÚ
 
	$»nd”
(
$v®ues
) {

9 
$Ïnguages
 = 
	`loÿË_Ïnguage_li¡
();

10 
$v®ue
 = 
	`is£t
(
$Ïnguages
[
$v®ues
->{
$this
->
f›ld_®Ÿs
}]) ? $languages[$values->{$this->field_alias}] : '';

11  
$this
->
	`»nd”_lšk
(
$v®ue
, 
$v®ues
);

13 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_field_node_link_translate.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_node_lšk_Œª¦©e
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_node_lšk
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

9 
$this
->
add™iÚ®_f›lds
['uid'] = 'uid';

10 
$this
->
add™iÚ®_f›lds
['type'] = 'type';

11 
$this
->
add™iÚ®_f›lds
['language'] = 'language';

12 
$this
->
add™iÚ®_f›lds
['fÜm©'] = 
	`¬¿y
('table' => 'node_revisions', 'field' => 'format');

15 
funùiÚ
 
	$»nd”
(
$v®ues
) {

17 
$node
 = 
Ãw
 
	`¡dCÏss
();

18 
$node
->
nid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['nid']};

19 
$node
->
uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

20 
$node
->
ty³
 = 
$v®ues
->{
$this
->
®Ÿ£s
['type']};

21 
$node
->
fÜm©
 = 
$v®ues
->{
$this
->
®Ÿ£s
['format']};

22 
$node
->
Ïnguage
 = 
$v®ues
->{
$this
->
®Ÿ£s
['language']};

23 
$node
->
¡©us
 = 1;

24 ià(
	`em±y
(
$node
->
Ïnguage
è|| !
	`Œª¦©iÚ_suµÜ‹d_ty³
($node->
ty³
è|| !
	`node_acûss
('v›w', $nodeè|| !
	`u£r_acûss
('translate content')) {

28 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('translate');

29  
	`l
(
$‹xt
, "node/$node->nid/Œª¦©e", 
	`¬¿y
('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
()));

30 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_field_node_translation_link.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_node_Œª¦©iÚ_lšk
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

9 
$this
->
add™iÚ®_f›lds
['nid'] = 'nid';

10 
$this
->
add™iÚ®_f›lds
['tnid'] = 'tnid';

11 
$this
->
add™iÚ®_f›lds
['title'] = 'title';

12 
$this
->
add™iÚ®_f›lds
['language'] = 'language';

15 
funùiÚ
 
	$qu”y
() {

16 
$this
->
	`’su»_my_bË
();

17 
$this
->
	`add_add™iÚ®_f›lds
();

18 
	}
}

20 
funùiÚ
 
	$»nd”
(
$v®ues
) {

21 
glob®
 
$Ïnguage
;

22 
$Šid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['tnid']};

24 ià(
$v®ues
->{
$this
->
®Ÿ£s
['Ïnguage']} !ğ
$Ïnguage
->
Ïnguage
) {

25 
$Œª¦©iÚs
 = 
	`Œª¦©iÚ_node_g‘_Œª¦©iÚs
(
$Šid
);

26 ià(
	`is£t
(
$Œª¦©iÚs
[
$Ïnguage
->
Ïnguage
])) {

27 
$v®ues
->{
$this
->
®Ÿ£s
['nid']} = 
$Œª¦©iÚs
[
$Ïnguage
->
Ïnguage
]->
nid
;

28 
$v®ues
->{
$this
->
®Ÿ£s
['t™Ë']} = 
$Œª¦©iÚs
[
$Ïnguage
->
Ïnguage
]->
t™Ë
;

31  
	`l
(
$v®ues
->{
$this
->
®Ÿ£s
['title']}, "node/" . $values->{$this->aliases['nid']});

32 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_filter_node_language.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f‹r_node_Ïnguage
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_š_İ”©Ü
 {

7 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

8 ià(!
	`is£t
(
$this
->
v®ue_İtiÚs
)) {

9 
$this
->
v®ue_t™Ë
 = 
	`t
('Language');

10 
$Ïnguages
 = 
	`¬¿y
('***CURRENT_LANGUAGE***' => 
	`t
("Current user's†anguage"), '***DEFAULT_LANGUAGE***' =>("Default site†anguage"), '***NO_LANGUAGE***' =>('No†anguage'));

11 
$Ïnguages
 = 
	`¬¿y_m”ge
($Ïnguages, 
	`loÿË_Ïnguage_li¡
());

12 
$this
->
v®ue_İtiÚs
 = 
$Ïnguages
;

15 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_filter_node_tnid.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f‹r_node_Šid
 
ex‹nds
 
	mv›ws_hªdËr_f‹r
 {

7 
funùiÚ
 
	$admš_summ¬y
() { }

8 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

9 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

11 
$İtiÚs
['operator']['default'] = 1;

13  
$İtiÚs
;

14 
	}
}

19 
funùiÚ
 
	$İ”©Ü_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

20 
$fÜm
['İ”©Ü'] = 
	`¬¿y
(

22 '#t™Ë' => 
	`t
('Include untranslated‚odes'),

23 '#deçuÉ_v®ue' => 
$this
->
İ”©Ü
,

24 '#İtiÚs' => 
	`¬¿y
(

25 1 => 
	`t
('Yes'),

26 0 => 
	`t
('No'),

29 
	}
}

31 
funùiÚ
 
	$ÿn_expo£
(è{  
FALSE
; 
	}
}

33 
funùiÚ
 
	$qu”y
() {

34 
$bË
 = 
$this
->
	`’su»_my_bË
();

36 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$bË.Šid = $bË.nid" . ($this->
İ”©Ü
 ? " OR $table.tnid = 0" : ''));

37 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_filter_node_tnid_child.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f‹r_node_Šid_chd
 
ex‹nds
 
	mv›ws_hªdËr_f‹r
 {

7 
funùiÚ
 
	$admš_summ¬y
() { }

8 
funùiÚ
 
	$İ”©Ü_fÜm
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

9 
funùiÚ
 
	$ÿn_expo£
(è{  
FALSE
; 
	}
}

11 
funùiÚ
 
	$qu”y
() {

12 
$bË
 = 
$this
->
	`’su»_my_bË
();

13 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "$table.tnid <> $table.nid AND $table.tnid > 0");

14 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_relationship_translation.inc

1 <?
php


8 şas 
	cv›ws_hªdËr_»ÏtiÚsh_Œª¦©iÚ
 
ex‹nds
 
	mv›ws_hªdËr_»ÏtiÚsh
 {

9 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

10 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

11 
$İtiÚs
['Ïnguage'] = 
	`¬¿y
('default' => 'current');

13  
$İtiÚs
;

19 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

20 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

22 
$İtiÚs
 = 
	`¬¿y
(

23 '®l' => 
	`t
('All'),

24 'cu¼’t' => 
	`t
('Current†anguage'),

25 'deçuÉ' => 
	`t
('Default†anguage'),

27 
$İtiÚs
 = 
	`¬¿y_m”ge
($İtiÚs, 
	`loÿË_Ïnguage_li¡
());

28 
$fÜm
['Ïnguage'] = 
	`¬¿y
(

30 '#İtiÚs' => 
$İtiÚs
,

31 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['language'],

32 '#t™Ë' => 
	`t
('Translation option'),

33 '#desütiÚ' => 
	`t
('Theranslation options‡llows youo select whichranslation orranslations in‡ranslation set join on. Select "Current†anguage" or "Default†anguage"o join onheranslation inhe current or default†anguage„espectively. Select‡ specific†anguageo join on‡ranslation inhat†anguage. If you select "All",ƒachranslation will create‡‚ew„ow, which may‡ppearo cause duplicates.'),

35 
	}
}

40 
funùiÚ
 
	$qu”y
() {

42 
$bË_d©a
 = 
	`v›ws_ãtch_d©a
(
$this
->
defš™iÚ
['base']);

43 
$ba£_f›ld
 = 
	`em±y
(
$this
->
defš™iÚ
['ba£ f›ld']è? 
$bË_d©a
['table']['base']['field'] : $this->definition['base field'];

45 
$this
->
	`’su»_my_bË
();

47 
$def
 = 
$this
->
defš™iÚ
;

48 
$def
['bË'] = 
$this
->
defš™iÚ
['base'];

49 
$def
['f›ld'] = 
$ba£_f›ld
;

50 
$def
['Ëá_bË'] = 
$this
->
bË_®Ÿs
;

51 
$def
['Ëá_f›ld'] = 
$this
->
f›ld
;

52 ià(!
	`em±y
(
$this
->
İtiÚs
['required'])) {

53 
$def
['type'] = 'INNER';

56 
$def
['exŒa'] = 
	`¬¿y
();

57 ià(
$this
->
İtiÚs
['language'] != 'all') {

58 
$this
->
İtiÚs
['language']) {

60 
$def
['exŒa'][] = 
	`¬¿y
(

66 
$def
['exŒa'][] = 
	`¬¿y
(

73 
$def
['exŒa'][] = 
	`¬¿y
(

75 'v®ue' => 
$this
->
İtiÚs
['language'],

81 ià(!
	`em±y
(
$def
['još_hªdËr']è&& 
	`şass_exi¡s
($def['join_handler'])) {

82 
$još
 = 
Ãw
 
$def
['join_handler'];

85 
$još
 = 
Ãw
 
	`v›ws_još
();

88 
$još
->
defš™iÚ
 = 
$def
;

89 
$još
->
	`cÚ¡ruù
();

90 
$još
->
adju¡ed
 = 
TRUE
;

93 
$®Ÿs
 = 
$def
['bË'] . '_' . 
$this
->
bË
;

95 
$this
->
®Ÿs
 = $this->
qu”y
->
	`add_»ÏtiÚsh
(
$®Ÿs
, 
$još
, $this->
defš™iÚ
['ba£'], $this->
»ÏtiÚsh
);

96 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/upload.views.inc

1 <?
php


19 
funùiÚ
 
	$u¶ßd_v›ws_d©a
() {

20 
$d©a
 = 
	`¬¿y
();

25 
$d©a
['u¶ßd']['bË']['group'] = 
	`t
('Upload');

27 
$d©a
['u¶ßd']['bË']['još'] = 
	`¬¿y
(

28 'node' => 
	`¬¿y
(

32 'node_»visiÚs' => 
	`¬¿y
(

36 'fes' => 
	`¬¿y
(

42 
$d©a
['u¶ßd']['vid'] = 
	`¬¿y
(

43 't™Ë' => 
	`t
('Node'),

44 'h–p' => 
	`t
('The‚odehe uploaded file is‡ttachedo'),

45 '»ÏtiÚsh' => 
	`¬¿y
(

46 'Ïb–' => 
	`t
('upload'),

51 'sk ba£' => 
	`¬¿y
('node', 'node_revisions'),

55 
$d©a
['u¶ßd']['desütiÚ'] = 
	`¬¿y
(

56 't™Ë' => 
	`t
('Description'),

57 'h–p' => 
	`t
('The description ofhe uploaded file.'),

58 'f›ld' => 
	`¬¿y
(

60 'şick sÜbË' => 
TRUE
,

62 'sÜt' => 
	`¬¿y
(

65 'f‹r' => 
	`¬¿y
(

68 '¬gum’t' => 
	`¬¿y
(

73 
$d©a
['u¶ßd']['li¡'] = 
	`¬¿y
(

74 't™Ë' => 
	`t
('Listed'),

75 'h–p' => 
	`t
('Whether or‚othe file is markedo be†isted.'),

76 'f›ld' => 
	`¬¿y
(

78 'şick sÜbË' => 
TRUE
,

80 'f‹r' => 
	`¬¿y
(

82 'Ïb–' => 
	`t
('Published'),

85 'sÜt' => 
	`¬¿y
(

90 
$d©a
['u¶ßd']['weight'] = 
	`¬¿y
(

91 't™Ë' => 
	`t
('Weight'),

92 'h–p' => 
	`t
('The weight, used for sorting.'),

93 'f›ld' => 
	`¬¿y
(

95 'şick sÜbË' => 
TRUE
,

97 'sÜt' => 
	`¬¿y
(

100 'f‹r' => 
	`¬¿y
(

105  
$d©a
;

106 
	}
}

111 
funùiÚ
 
	$u¶ßd_v›ws_d©a_®‹r
(&
$d©a
) {

112 
$d©a
['node']['u¶ßd_fid'] = 
	`¬¿y
(

113 'group' => 
	`t
('Upload'),

114 't™Ë' => 
	`t
('Attached files'),

115 'h–p' => 
	`t
('All files‡ttachedo‡‚ode with upload.module.'),

117 'f›ld' => 
	`¬¿y
(

120 'f‹r' => 
	`¬¿y
(

122 't™Ë' => 
	`t
('Has‡ttached files'),

124 'h–p' => 
	`t
('Only display items with‡ttached files. This can cause duplicates ifhere‡re multiple‡ttached files.'),

126 '»ÏtiÚsh' => 
	`¬¿y
(

127 't™Ë' => 
	`t
('Attached files'),

128 'h–p' => 
	`t
('Add‡„elationshipo gain‡ccesso more file data for files uploaded by upload.module. Notehathis„elationship will cause duplicate‚odes ifhere‡re multiple files‡ttachedohe‚ode.'),

134 'Ïb–' => 
	`t
('Files'),

137 
	}
}

143 
funùiÚ
 
	$u¶ßd_v›ws_hªdËrs
() {

144  
	`¬¿y
(

145 'šfo' => 
	`¬¿y
(

146 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/upload',

148 'hªdËrs' => 
	`¬¿y
(

149 'v›ws_hªdËr_f›ld_u¶ßd_fid' => 
	`¬¿y
(

152 'v›ws_hªdËr_f›ld_u¶ßd_desütiÚ' => 
	`¬¿y
(

155 'v›ws_hªdËr_f‹r_u¶ßd_fid' => 
	`¬¿y
(

160 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/upload.views_convert.inc

1 <?
php


16 
funùiÚ
 
	$u¶ßd_v›ws_cÚv”t
(
$di¥Ïy
, 
$ty³
, &
$v›w
, 
$f›ld
, 
$id
 = 
NULL
) {

17 
$ty³
) {

19 
$f›ld
['tablename']) {

21 
$f›ld
['field']) {

23 
$»ÏtiÚsh
 = 
$v›w
->
	`add_™em
(
$di¥Ïy
, '»ÏtiÚsh', 'node', 'u¶ßd_fid', 
	`¬¿y
(), 'node_upload_fid');

24 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, '»ÏtiÚsh', 
$»ÏtiÚsh
);

25 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'table', 'files');

30 
$f›ld
['field']) {

32 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f›ld', 
$id
);

33 
$f›ld
['options']) {

35 
$™em
['lšk_to_fe'] = 
TRUE
;

38 
$™em
['lšk_to_fe'] = 
TRUE
;

40 
$™em
['®‹r']['®‹r_‹xt'] = 
TRUE
;

41 
$™em
['®‹r']['‹xt'] = '['. 
$v›w
->
	`add_™em
(
$di¥Ïy
, 'f›ld', 'u¶ßd', 'desütiÚ', 
	`¬¿y
('exşude' => 
TRUE
)) .']';

44 ià(
$f›ld
['handler'] == 'views_handler_file_listed_files') {

45 
$™em
['Úly_li¡ed'] = 
TRUE
;

47 
$™em
['table'] = 'node';

48 
$™em
['field'] = 'upload_fid';

49 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f›ld', 
$id
, 
$™em
);

52 ià(
$f›ld
['handler'] == 'views_handler_file_filename_download') {

53 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'lšk_to_fe', 
TRUE
);

55 
$»ÏtiÚsh
 = 
$v›w
->
	`add_™em
(
$di¥Ïy
, '»ÏtiÚsh', 'node', 'u¶ßd_fid', 
	`¬¿y
(), 'node_upload_fid');

56 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, '»ÏtiÚsh', 
$»ÏtiÚsh
);

63 
$f›ld
['tablename']) {

65 
$f›ld
['field']) {

67 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'table', 'node');

68 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'field', 'upload_fid');

71 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'table', 'upload');

76 
$f›ld
['field']) {

79 
$™em
 = 
$v›w
->
	`g‘_™em
(
$di¥Ïy
, 'f‹r', 
$id
);

80 
$™em
['İ”©Ü'] = 
$f›ld
['operator'];

81 
$™em
['ÿ£'] = 
FALSE
;

82 
$™em
['»ÏtiÚsh'] = 
$v›w
->
	`add_™em
(
$di¥Ïy
, '»ÏtiÚsh', 'node', 'u¶ßd_fid', 
	`¬¿y
(), 'node_upload_fid');

83 
$v›w
->
	`£t_™em
(
$di¥Ïy
, 'f‹r', 
$id
, 
$™em
);

86 
$»ÏtiÚsh
 = 
$v›w
->
	`add_™em
(
$di¥Ïy
, '»ÏtiÚsh', 'node', 'u¶ßd_fid', 
	`¬¿y
(), 'node_upload_fid');

87 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, '»ÏtiÚsh', 
$»ÏtiÚsh
);

88 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'İ”©Ü', 
$f›ld
['operator']);

95 
$f›ld
['tablename']) {

97 
$f›ld
['field']) {

99 
$»ÏtiÚsh
 = 
$v›w
->
	`add_™em
(
$di¥Ïy
, '»ÏtiÚsh', 'node', 'u¶ßd_fid', 
	`¬¿y
(), 'node_upload_fid');

100 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, '»ÏtiÚsh', 
$»ÏtiÚsh
);

101 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'table', 'files');

108 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/upload/views_handler_field_upload_description.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_u¶ßd_desütiÚ
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

8 
funùiÚ
 
	$š™
(&
$v›w
, &
$İtiÚs
) {

9 
·»Á
::
	`š™
(
$v›w
, 
$İtiÚs
);

10 ià(!
	`em±y
(
$İtiÚs
['link_to_file'])) {

11 
$this
->
add™iÚ®_f›lds
['fid'] = 'fid';

15 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

16 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

17 
$İtiÚs
['lšk_to_fe'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

18  
$İtiÚs
;

19 
	}
}

21 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

22 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

23 
$fÜm
['lšk_to_fe'] = 
	`¬¿y
(

24 '#t™Ë' => 
	`t
('Linkhis fieldo downloadhe file'),

26 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['link_to_file']),

28 
	}
}

30 
funùiÚ
 
	$´e_»nd”
(
$v®ues
) {

31 ià(
	`em±y
(
$this
->
İtiÚs
['link_to_file'])) {

35 
$fids
 = 
	`¬¿y
();

36 
$this
->
™ems
 = 
	`¬¿y
();

38 
$d©a
 = 
	`¬¿y
();

39 
	`fÜ—ch
 (
$v®ues
 
as
 
$»suÉ
) {

40 ià(
$»suÉ
->{
$this
->
®Ÿ£s
['fid']}) {

41 
$fids
[] = 
$»suÉ
->{
$this
->
®Ÿ£s
['fid']};

45 ià(
$fids
) {

46 
$»suÉ
 = 
	`db_qu”y
("SELECT f.fid, f.f•©h FROM {fes} f WHERE f.fid IN (" . 
	`im¶ode
(', ', 
$fids
) . ")");

47 
$fe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

48 
$this
->
™ems
[
$fe
->
fid
] = $file;

51 
	}
}

53 
funùiÚ
 
	$»nd”
(
$v®ues
) {

54  
$this
->
	`»nd”_lšk
(
	`check_¶aš
(
$v®ues
->{$this->
f›ld_®Ÿs
}), $values);

55 
	}
}

62 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ue
) {

63 ià(!
	`em±y
(
$this
->
İtiÚs
['lšk_to_fe']è&& 
$v®ue
->{$this->
®Ÿ£s
['fid']} && 
$d©a
 !=ğ
NULL
 && $data !== '') {

64 
$v®ues
 = 
$this
->
™ems
[
$v®ue
->{$this->
®Ÿ£s
['fid']}];

65 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
TRUE
;

66 
$this
->
İtiÚs
['®‹r']['·th'] = 
	`fe_ü—‹_u¾
(
$v®ues
->
f•©h
);

69 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
FALSE
;

71  
$d©a
;

72 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/upload/views_handler_field_upload_fid.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_u¶ßd_fid
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_´”’d”_li¡
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

11 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

12 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

13 
$İtiÚs
['lšk_to_fe'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

14 
$İtiÚs
['Úly_li¡ed'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

15  
$İtiÚs
;

16 
	}
}

18 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

19 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

20 
$fÜm
['lšk_to_fe'] = 
	`¬¿y
(

21 '#t™Ë' => 
	`t
('Linkhis fieldo downloadhe file'),

23 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['link_to_file']),

26 
$fÜm
['Úly_li¡ed'] = 
	`¬¿y
(

27 '#t™Ë' => 
	`t
('Only show "listed" file‡ttachments'),

29 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['only_listed']),

31 
	}
}

33 
funùiÚ
 
	$´e_»nd”
(
$v®ues
) {

34 
$vids
 = 
	`¬¿y
();

35 
$this
->
™ems
 = 
	`¬¿y
();

37 
	`fÜ—ch
 (
$v®ues
 
as
 
$»suÉ
) {

38 
$vids
[] = 
$»suÉ
->{
$this
->
f›ld_®Ÿs
};

41 ià(
$vids
) {

43 
$wh”e
 = '';

44 ià(!
	`em±y
(
$this
->
İtiÚs
['only_listed'])) {

45 
$wh”e
 = " AND u.list <> 0";

47 
$»suÉ
 = 
	`db_qu”y
("SELECT u.vid, u.fid, f.f’ame, f.f•©h, f.fesize, f.femime, u.desütiÚ FROM {u¶ßd} u LEFT JOIN {fes} f ON f.fid = u.fid WHERE u.vid IN (" . 
	`im¶ode
(', ', 
$vids
) . ")$where ORDER BY u.weight");

48 
$fe
 = 
	`db_ãtch_¬¿y
(
$»suÉ
)) {

49 
$fe
['f’ame'] = 
	`check_¶aš
($file['filename']);

50 
$fe
['femime'] = 
	`check_¶aš
($file['filemime']);

51 
$fe
['desütiÚ'] = 
	`check_¶aš
($file['description']);

52 
$fe
['fesize'] = 
	`fÜm©_size
($file['filesize']);

53 
$fe
['f•©h'] = 
	`fe_ü—‹_u¾
($file['filepath']);

54 ià(!
	`em±y
(
$this
->
İtiÚs
['link_to_file']) ) {

55 
$fe
['make_lšk'] = 
TRUE
;

56 
$fe
['path'] = $file['filepath'];

58 
$this
->
™ems
[
$fe
['vid']][$file['fid']] = $file;

61 
	}
}

63 
funùiÚ
 
	$»nd”_™em
(
$couÁ
, 
$™em
) {

64  
$™em
['description'];

65 
	}
}

67 
funùiÚ
 
	$docum’t_£lf_tok’s
(&
$tok’s
) {

68 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-fid' . ']'] = 
	`t
('The file ID forhe file.');

69 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-Çme' . ']'] = 
	`t
('The‚ame ofhe‡ttached file.');

70 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-ty³' . ']'] = 
	`t
('The MIMEype ofhe‡ttached file.');

71 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-desütiÚ' . ']'] = 
	`t
('The‚ame ofhe‡ttached file.');

72 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-·th' . ']'] = 
	`t
('The…ath ofhe‡ttached file.');

73 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-size' . ']'] = 
	`t
('The size ofhe‡ttached file.');

74 
	}
}

76 
funùiÚ
 
	$add_£lf_tok’s
(&
$tok’s
, 
$™em
) {

77 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-fid' . ']'] = 
$™em
['fid'];

78 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-Çme' . ']'] = 
$™em
['filename'];

79 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-ty³' . ']'] = 
$™em
['filemime'];

80 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-desütiÚ' . ']'] = 
$™em
['description'];

81 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-·th' . ']'] = 
$™em
['filepath'];

82 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-size' . ']'] = 
$™em
['filesize'];

83 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/upload/views_handler_filter_upload_fid.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_u¶ßd_fid
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_boŞ—n_İ”©Ü
 {

8 
funùiÚ
 
	$cÚ¡ruù
() {

9 
·»Á
::
	`cÚ¡ruù
();

10 
$this
->
v®ue_v®ue
 = 
	`t
('Has‡ttached files');

13 
funùiÚ
 
	$qu”y
() {

14 
$this
->
	`’su»_my_bË
();

15 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], "(SELECT COUNT(*èFROM {u¶ßd} u WHERE u.vid = $this->bË_®Ÿs.$this->»®_f›ldè" . (
	`em±y
($this->
v®ue
) ? '=' : '<>') . " 0");

16 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user.views.inc

1 <?
php


17 
funùiÚ
 
	$u£r_v›ws_d©a
() {

23 
$d©a
['u£rs']['bË']['group'] = 
	`t
('User');

25 
$d©a
['u£rs']['bË']['ba£'] = 
	`¬¿y
(

27 't™Ë' => 
	`t
('User'),

28 'h–p' => 
	`t
('Users who have created‡ccounts on your site.'),

31 
$d©a
['u£rs']['bË']['još'] = 
	`¬¿y
(

32 'node' => 
	`¬¿y
(

38 'node_»visiÚs' => 
	`¬¿y
(

47 
$d©a
['u£rs']['uid'] = 
	`¬¿y
(

48 't™Ë' => 
	`t
('Uid'),

49 'h–p' => 
	`t
('The user ID'),

50 'f›ld' => 
	`¬¿y
(

52 'şick sÜbË' => 
TRUE
,

54 '¬gum’t' => 
	`¬¿y
(

58 'f‹r' => 
	`¬¿y
(

59 't™Ë' => 
	`t
('Name'),

62 'sÜt' => 
	`¬¿y
(

68 
$d©a
['u£rs']['uid_cu¼’t'] = 
	`¬¿y
(

70 't™Ë' => 
	`t
('Current'),

71 'h–p' => 
	`t
('Filterhe viewohe currently†ogged in user.'),

72 'f‹r' => 
	`¬¿y
(

79 
$d©a
['u£rs']['Çme'] = 
	`¬¿y
(

80 't™Ë' => 
	`t
('Name'),

81 'h–p' => 
	`t
('The user or‡uthor‚ame.'),

82 'f›ld' => 
	`¬¿y
(

84 'şick sÜbË' => 
TRUE
,

86 'sÜt' => 
	`¬¿y
(

89 '¬gum’t' => 
	`¬¿y
(

96 
$d©a
['u£rs']['ma'] = 
	`¬¿y
(

97 't™Ë' => 
	`t
('E-mail'),

98 'h–p' => 
	`t
('Email‡ddress for‡ given user. This field is‚ormally‚ot showno users, so be cautious when using it.'),

99 'f›ld' => 
	`¬¿y
(

101 'şick sÜbË' => 
TRUE
,

103 'sÜt' => 
	`¬¿y
(

106 'f‹r' => 
	`¬¿y
(

109 '¬gum’t' => 
	`¬¿y
(

115 
$d©a
['u£rs']['Ïnguage'] = 
	`¬¿y
(

116 't™Ë' => 
	`t
('Language'),

117 'h–p' => 
	`t
('Language ofhe user'),

118 'f›ld' => 
	`¬¿y
(

120 'şick sÜbË' => 
TRUE
,

122 'sÜt' => 
	`¬¿y
(

125 'f‹r' => 
	`¬¿y
(

128 '¬gum’t' => 
	`¬¿y
(

134 
$d©a
['u£rs']['piùu»'] = 
	`¬¿y
(

135 't™Ë' => 
	`t
('Picture'),

136 'h–p' => 
	`t
("The user's…icture, if‡llowed."),

138 'f›ld' => 
	`¬¿y
(

140 'şick sÜbË' => 
TRUE
,

142 'sÜt' => 
	`¬¿y
(

145 'f‹r' => 
	`¬¿y
(

147 'Ïb–' => 
	`t
('Has Avatar'),

153 
$d©a
['u£rs']['ü—‹d'] = 
	`¬¿y
(

154 't™Ë' => 
	`t
('Created date'),

155 'h–p' => 
	`t
('The datehe user was created.'),

156 'f›ld' => 
	`¬¿y
(

158 'şick sÜbË' => 
TRUE
,

160 'sÜt' => 
	`¬¿y
(

163 'f‹r' => 
	`¬¿y
(

169 
$d©a
['u£rs']['acûss'] = 
	`¬¿y
(

170 't™Ë' => 
	`t
('Last‡ccess'),

171 'h–p' => 
	`t
("The user's†ast‡ccess date."),

172 'f›ld' => 
	`¬¿y
(

174 'şick sÜbË' => 
TRUE
,

176 'sÜt' => 
	`¬¿y
(

179 'f‹r' => 
	`¬¿y
(

185 
$d©a
['u£rs']['logš'] = 
	`¬¿y
(

186 't™Ë' => 
	`t
('Last†ogin'),

187 'h–p' => 
	`t
("The user's†ast†ogin date."),

188 'f›ld' => 
	`¬¿y
(

190 'şick sÜbË' => 
TRUE
,

192 'sÜt' => 
	`¬¿y
(

195 'f‹r' => 
	`¬¿y
(

201 
$d©a
['u£rs']['¡©us'] = 
	`¬¿y
(

202 't™Ë' => 
	`t
('Active'),

203 'h–p' => 
	`t
('Whether‡ user is‡ctive or blocked.'),

205 'f›ld' => 
	`¬¿y
(

207 'şick sÜbË' => 
TRUE
,

209 'f‹r' => 
	`¬¿y
(

211 'Ïb–' => 
	`t
('Active'),

214 'sÜt' => 
	`¬¿y
(

220 
$d©a
['u£rs']['sigÇtu»'] = 
	`¬¿y
(

221 't™Ë' => 
	`t
('Signature'),

222 'h–p' => 
	`t
("The user's signature."),

224 'f›ld' => 
	`¬¿y
(

227 'f‹r' => 
	`¬¿y
(

232 
$d©a
['u£rs']['ed™_node'] = 
	`¬¿y
(

233 'f›ld' => 
	`¬¿y
(

234 't™Ë' => 
	`t
('Edit†ink'),

235 'h–p' => 
	`t
('Provide‡ simple†inkoƒdithe user.'),

240 
$d©a
['u£rs']['d–‘e_node'] = 
	`¬¿y
(

241 'f›ld' => 
	`¬¿y
(

242 't™Ë' => 
	`t
('Delete†ink'),

243 'h–p' => 
	`t
('Provide‡ simple†inko deletehe user.'),

251 
$d©a
['u£rs_rŞes']['bË']['group'] = 
	`t
('User');

254 
$d©a
['u£rs_rŞes']['bË']['još'] = 
	`¬¿y
(

256 'u£rs' => 
	`¬¿y
(

260 'node' => 
	`¬¿y
(

264 'node_»visiÚs' => 
	`¬¿y
(

271 
$d©a
['u£rs_rŞes']['rid'] = 
	`¬¿y
(

272 't™Ë' => 
	`t
('Roles'),

273 'h–p' => 
	`t
('Roleshat‡ user belongso.'),

274 'f›ld' => 
	`¬¿y
(

277 'f‹r' => 
	`¬¿y
(

279 'num”ic' => 
TRUE
,

281 '¬gum’t' => 
	`¬¿y
(

285 'em±y f›ld‚ame' => 
	`t
('No„ole'),

286 'num”ic' => 
TRUE
,

293 
$d©a
['rŞe']['bË']['još'] = 
	`¬¿y
(

295 'u£rs' => 
	`¬¿y
(

301 'u£rs_rŞes' => 
	`¬¿y
(

305 'node' => 
	`¬¿y
(

310 'node_»visiÚs' => 
	`¬¿y
(

320 
$d©a
['authm­']['bË']['group'] = 
	`t
('User');

321 
$d©a
['authm­']['bË']['još'] = 
	`¬¿y
(

323 'u£rs' => 
	`¬¿y
(

327 'node' => 
	`¬¿y
(

333 
$d©a
['authm­']['aid'] = 
	`¬¿y
(

334 't™Ë' => 
	`t
('Authmap ID'),

335 'h–p' => 
	`t
('The Authmap ID.'),

336 'f›ld' => 
	`¬¿y
(

339 'f‹r' => 
	`¬¿y
(

341 'num”ic' => 
TRUE
,

343 '¬gum’t' => 
	`¬¿y
(

345 'num”ic' => 
TRUE
,

348 
$d©a
['authm­']['authÇme'] = 
	`¬¿y
(

349 't™Ë' => 
	`t
('Authentication‚ame'),

350 'h–p' => 
	`t
('The unique‡uthentication‚ame.'),

351 'f›ld' => 
	`¬¿y
(

354 'f‹r' => 
	`¬¿y
(

357 '¬gum’t' => 
	`¬¿y
(

361 
$d©a
['authm­']['moduË'] = 
	`¬¿y
(

362 't™Ë' => 
	`t
('Authentication module'),

363 'h–p' => 
	`t
('The‚ame ofhe module managinghe‡uthenticationƒntry.'),

364 'f›ld' => 
	`¬¿y
(

367 'f‹r' => 
	`¬¿y
(

370 '¬gum’t' => 
	`¬¿y
(

375  
$d©a
;

376 
	}
}

381 
funùiÚ
 
	$u£r_v›ws_¶ugšs
() {

382  
	`¬¿y
(

384 '¬gum’ˆdeçuÉ' => 
	`¬¿y
(

385 'u£r' => 
	`¬¿y
(

386 't™Ë' => 
	`t
('User ID from URL'),

388 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/user',

391 'cu¼’t_u£r' => 
	`¬¿y
(

392 't™Ë' => 
	`t
('User ID from†ogged in user'),

394 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/user',

398 '¬gum’ˆv®id©Ü' => 
	`¬¿y
(

399 'u£r' => 
	`¬¿y
(

400 't™Ë' => 
	`t
('User'),

402 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/user',

406 
	}
}

412 
funùiÚ
 
	$u£r_v›ws_hªdËrs
() {

413  
	`¬¿y
(

414 'šfo' => 
	`¬¿y
(

415 '·th' => 
	`dru·l_g‘_·th
('module', 'views') . '/modules/user',

417 'hªdËrs' => 
	`¬¿y
(

418 'v›ws_hªdËr_¬gum’t_u£r_uid' => 
	`¬¿y
(

421 'v›ws_hªdËr_f›ld_u£r' => 
	`¬¿y
(

424 'v›ws_hªdËr_f›ld_u£r_Çme' => 
	`¬¿y
(

427 'v›ws_hªdËr_f›ld_u£r_lšk' => 
	`¬¿y
(

430 'v›ws_hªdËr_f›ld_u£r_lšk_ed™' => 
	`¬¿y
(

433 'v›ws_hªdËr_f›ld_u£r_lšk_d–‘e' => 
	`¬¿y
(

436 'v›ws_hªdËr_f›ld_u£r_ma' => 
	`¬¿y
(

439 'v›ws_hªdËr_f›ld_u£r_Ïnguage' => 
	`¬¿y
(

442 'v›ws_hªdËr_f›ld_u£r_piùu»' => 
	`¬¿y
(

445 'v›ws_hªdËr_f›ld_u£r_rŞes' => 
	`¬¿y
(

448 'v›ws_hªdËr_f‹r_u£r_Çme' => 
	`¬¿y
(

451 'v›ws_hªdËr_f‹r_u£r_cu¼’t' => 
	`¬¿y
(

454 'v›ws_hªdËr_f‹r_u£r_rŞes' => 
	`¬¿y
(

457 'v›ws_hªdËr_¬gum’t_u£rs_rŞes_rid' => 
	`¬¿y
(

462 
	}
}

468 
funùiÚ
 
	$u£r_v›ws_qu”y_sub¡™utiÚs
(
$v›w
) {

469 
glob®
 
$u£r
;

470  
	`¬¿y
('***CURRENT_USER***' => 
	`štv®
(
$u£r
->
uid
));

471 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user.views_convert.inc

1 <?
php


12 
funùiÚ
 
	$u£r_v›ws_cÚv”t
(
$di¥Ïy
, 
$ty³
, &
$v›w
, 
$f›ld
, 
$id
 = 
NULL
) {

13 
$ty³
) {

15 
$f›ld
['tablename']) {

17 
$f›ld
['field']) {

19 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f›ld', 
$id
, 'field', 'picture');

26 ià(
$f›ld
['bËÇme'] =ğ'u£rs' || !
	`¡ºcmp
($field['tablename'], 'users_role_', 11)) {

27 
$f›ld
['field']) {

29 
$İ”©Üs
 = 
	`¬¿y
('OR' => 'in', 'NOR' => 'not in');

30 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'İ”©Ü', 
$İ”©Üs
[
$f›ld
['operator']]);

31 ià(
$rid
 = (
š‹g”
è
	`sub¡r
(
$f›ld
['tablename'], 11)) {

32 
$v›w
->
	`add_™em
(
$di¥Ïy
, 'f‹r', 'u£rs_rŞes', 'rid', 
	`¬¿y
('v®ue' => 
$rid
));

37 
	`–£if
 (
$f›ld
['tablename'] == 'users_roles') {

38 
$f›ld
['field']) {

40 
$İ”©Üs
 = 
	`¬¿y
('AND' => 'and', 'OR' => 'or', 'NOR' => 'not');

41 
$v›w
->
	`£t_™em_İtiÚ
(
$di¥Ïy
, 'f‹r', 
$id
, 'İ”©Ü', 
$İ”©Üs
[
$f›ld
['operator']]);

47 
$İtiÚs
 = 
$f›ld
['argoptions'];

48 
$f›ld
['type']) {

50 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'u£rs', 'uid', 
$İtiÚs
, 
$f›ld
['id']);

53 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'node', 'uid_touch', 
$İtiÚs
, 
$f›ld
['id']);

56 
$v›w
->
	`add_™em
(
$di¥Ïy
, '¬gum’t', 'u£rs', 'Çme', 
$İtiÚs
, 
$f›ld
['id']);

61 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_argument_user_uid.inc

1 <?
php


11 şas 
	cv›ws_hªdËr_¬gum’t_u£r_uid
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_num”ic
 {

15 
funùiÚ
 
	$t™Ë_qu”y
() {

16 ià(!
$this
->
¬gum’t
) {

17  
	`¬¿y
(
	`v¬ŸbË_g‘
('ªÚymous', 
	`t
('Anonymous')));

20 
$t™Ës
 = 
	`¬¿y
();

21 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$this
->
v®ue
), '%d'));

23 
$»suÉ
 = 
	`db_qu”y
("SELECT u.ÇmFROM {u£rs} u WHERE u.uid IN ($¶aûhŞd”s)", 
$this
->
v®ue
);

24 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

25 
$t™Ës
[] = 
	`check_¶aš
(
$‹rm
->
Çme
);

27  
$t™Ës
;

29 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_argument_users_roles_rid.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_¬gum’t_u£rs_rŞes_rid
 
ex‹nds
 
	mv›ws_hªdËr_¬gum’t_mªy_to_Úe
 {

7 
funùiÚ
 
	$t™Ë_qu”y
() {

8 
$t™Ës
 = 
	`¬¿y
();

9 
$¶aûhŞd”s
 = 
	`im¶ode
(', ', 
	`¬¿y_fl
(0, (
$this
->
v®ue
), '%d'));

11 
$»suÉ
 = 
	`db_qu”y
("SELECT‚amFROM {rŞe} WHERE„id IN ($¶aûhŞd”s)", 
$this
->
v®ue
);

12 
$‹rm
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

13 
$t™Ës
[] = 
	`check_¶aš
(
$‹rm
->
Çme
);

15  
$t™Ës
;

17 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_u£r
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

11 
funùiÚ
 
	$š™
(&
$v›w
, &
$d©a
) {

12 
·»Á
::
	`š™
(
$v›w
, 
$d©a
);

13 ià(!
	`em±y
(
$this
->
İtiÚs
['link_to_user'])) {

14 
$this
->
add™iÚ®_f›lds
['uid'] = 'uid';

18 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

19 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

20 
$İtiÚs
['lšk_to_u£r'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

21  
$İtiÚs
;

22 
	}
}

27 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

28 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

29 
$fÜm
['lšk_to_u£r'] = 
	`¬¿y
(

30 '#t™Ë' => 
	`t
('Linkhis fieldo its user'),

31 '#desütiÚ' => 
	`t
('This will override‡ny other†ink you have set.'),

33 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['link_to_user'],

35 
	}
}

37 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ues
) {

38 ià(!
	`em±y
(
$this
->
İtiÚs
['lšk_to_u£r']è&& 
	`u£r_acûss
('acûs u£¸´ofes'è&& 
$v®ues
->{$this->
®Ÿ£s
['uid']} && 
$d©a
 !=ğ
NULL
 && $data !== '') {

39 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
TRUE
;

40 
$this
->
İtiÚs
['®‹r']['·th'] = "u£r/" . 
$v®ues
->{$this->
®Ÿ£s
['uid']};

42  
$d©a
;

43 
	}
}

45 
funùiÚ
 
	$»nd”
(
$v®ues
) {

46  
$this
->
	`»nd”_lšk
(
	`check_¶aš
(
$v®ues
->{$this->
f›ld_®Ÿs
}), $values);

47 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_language.inc

1 <?
php


8 şas 
	cv›ws_hªdËr_f›ld_u£r_Ïnguage
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_u£r
 {

10 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ues
) {

11 ià(!
	`em±y
(
$this
->
İtiÚs
['lšk_to_u£r']è&& 
	`u£r_acûss
('acûs u£¸´ofes'è&& 
$v®ues
->{$this->
®Ÿ£s
['uid']}) {

12 
$this
->
İtiÚs
['®‹r']['make_lšk'] = 
TRUE
;

13 
$this
->
İtiÚs
['®‹r']['·th'] = 'u£r/' . 
$v®ues
->{$this->
®Ÿ£s
['uid']};

15 ià(
	`em±y
(
$d©a
)) {

16 
$Ïng
 = 
	`Ïnguage_deçuÉ
();

19 
$Ïng
 = 
	`Ïnguage_li¡
();

20 
$Ïng
 = $Ïng[
$d©a
];

23  
	`check_¶aš
(
$Ïng
->
Çme
);

26 
funùiÚ
 
	$»nd”
(
$v®ues
) {

27  
$this
->
	`»nd”_lšk
(
	`check_¶aš
(
$v®ues
->{$this->
f›ld_®Ÿs
}), $values);

28 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_link.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_u£r_lšk
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

9 
$this
->
add™iÚ®_f›lds
['uid'] = 'uid';

12 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

13 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

14 
$İtiÚs
['‹xt'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

15  
$İtiÚs
;

16 
	}
}

18 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

19 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

20 
$fÜm
['‹xt'] = 
	`¬¿y
(

22 '#t™Ë' => 
	`t
('Texto display'),

23 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['text'],

25 
	}
}

28 
funùiÚ
 
	$acûss
() {

29  
	`u£r_acûss
('access user…rofiles');

30 
	}
}

32 
funùiÚ
 
	$qu”y
() {

33 
$this
->
	`’su»_my_bË
();

34 
$this
->
	`add_add™iÚ®_f›lds
();

35 
	}
}

37 
funùiÚ
 
	$»nd”
(
$v®ues
) {

38 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('view');

39 
$uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

40  
	`l
(
$‹xt
, "user/$uid");

41 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_link_delete.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_u£r_lšk_d–‘e
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_u£r_lšk
 {

8 
funùiÚ
 
	$acûss
() {

9  
	`u£r_acûss
('administer users');

12 
funùiÚ
 
	$»nd”
(
$v®ues
) {

13 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('delete');

14 
$uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

15  
	`l
(
$‹xt
, "u£r/$uid/d–‘e", 
	`¬¿y
('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
()));

16 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_link_edit.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_u£r_lšk_ed™
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_u£r_lšk
 {

7 
funùiÚ
 
	$»nd”
(
$v®ues
) {

8 
$‹xt
 = !
	`em±y
(
$this
->
İtiÚs
['‹xt']è? $this->İtiÚs['‹xt'] : 
	`t
('edit');

9 
$uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

11 
$accouÁ
 = 
Ãw
 
	`¡dCÏss
();

12 
$accouÁ
->
uid
 = 
$uid
;

13 ià(
	`u£r_ed™_acûss
(
$accouÁ
)) {

14  
	`l
(
$‹xt
, "u£r/$uid/ed™", 
	`¬¿y
('qu”y' => 
	`dru·l_g‘_de¡š©iÚ
()));

17 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_mail.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_u£r_ma
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_u£r
 {

7 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

8 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

9 
$İtiÚs
['lšk_to_u£r'] = 
	`¬¿y
('default' => 'mailto');

10  
$İtiÚs
;

13 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

14 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

15 
$fÜm
['lšk_to_u£r'] = 
	`¬¿y
(

16 '#t™Ë' => 
	`t
('Linkhis field'),

18 '#İtiÚs' => 
	`¬¿y
(

19 0 => 
	`t
('No†ink'),

20 'u£r' => 
	`t
('Tohe user'),

21 'mato' => 
	`t
("With‡ mailto:"),

23 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['link_to_user'],

25 
	}
}

27 
funùiÚ
 
	$»nd”
(
$v®ues
) {

28 ià(
$this
->
İtiÚs
['link_to_user'] == 'mailto') {

29  
	`l
(
$v®ues
->{
$this
->
f›ld_®Ÿs
}, "mailto:" . $values->{$this->field_alias});

31  
$this
->
	`»nd”_lšk
(
	`check_¶aš
(
$v®ues
->{$this->
f›ld_®Ÿs
}), $values);

32 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_name.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_u£r_Çme
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_u£r
 {

10 
funùiÚ
 
	$š™
(&
$v›w
, &
$d©a
) {

11 
·»Á
::
	`š™
(
$v›w
, 
$d©a
);

12 ià(!
	`em±y
(
$this
->
İtiÚs
['overwrite_anonymous'])) {

13 
$this
->
add™iÚ®_f›lds
['uid'] = 'uid';

17 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

18 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

20 
$İtiÚs
['ov”wr™e_ªÚymous'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

21 
$İtiÚs
['ªÚymous_‹xt'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

23  
$İtiÚs
;

24 
	}
}

26 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

27 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

29 
$fÜm
['ov”wr™e_ªÚymous'] = 
	`¬¿y
(

30 '#t™Ë' => 
	`t
('Overwritehe valueo display for‡nonymous users'),

32 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['overwrite_anonymous']),

33 '#desütiÚ' => 
	`t
('If selected, you will see‡ fieldoƒnterheexto use for‡nonymous users.'),

35 
$fÜm
['ªÚymous_‹xt'] = 
	`¬¿y
(

36 '#t™Ë' => 
	`t
('Texto display for‡nonymous users'),

38 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['anonymous_text'],

39 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

40 '#d•’d’cy' => 
	`¬¿y
(

41 'ed™-İtiÚs-ov”wr™e-ªÚymous' => 
	`¬¿y
(1),

44 
	}
}

46 
funùiÚ
 
	$»nd”_lšk
(
$d©a
, 
$v®ues
) {

47 ià(!
	`em±y
(
$this
->
İtiÚs
['link_to_user']) || !empty($this->options['overwrite_anonymous'])) {

48 
$accouÁ
 = 
Ãw
 
	`¡dCÏss
();

49 
$accouÁ
->
uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

50 ià(!
	`em±y
(
$this
->
İtiÚs
['ov”wr™e_ªÚymous']è&& !
$accouÁ
->
uid
) {

52  
	`check_¶aš
(
$this
->
İtiÚs
['anonymous_text']);

54 
	`–£if
 (!
	`em±y
(
$this
->
İtiÚs
['link_to_user'])) {

55 
$accouÁ
->
Çme
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

56  
	`theme
('u£ºame', 
$accouÁ
);

60  
$d©a
;

61 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_picture.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f›ld_u£r_piùu»
 
ex‹nds
 
	mv›ws_hªdËr_f›ld
 {

8 
funùiÚ
 
	$cÚ¡ruù
() {

9 
·»Á
::
	`cÚ¡ruù
();

10 
$this
->
add™iÚ®_f›lds
['uid'] = 'uid';

11 
$this
->
add™iÚ®_f›lds
['name'] = 'name';

12 
$this
->
add™iÚ®_f›lds
['mail'] = 'mail';

15 
funùiÚ
 
	$–em’t_ty³
() {

17 
	}
}

19 
funùiÚ
 
	$»nd”
(
$v®ues
) {

21 
$accouÁ
 = 
Ãw
 
	`¡dCÏss
();

22 
$accouÁ
->
uid
 = 
$v®ues
->{
$this
->
®Ÿ£s
['uid']};

23 
$accouÁ
->
Çme
 = 
$v®ues
->{
$this
->
®Ÿ£s
['name']};

24 
$accouÁ
->
ma
 = 
$v®ues
->{
$this
->
®Ÿ£s
['mail']};

25 
$accouÁ
->
piùu»
 = 
$v®ues
->{
$this
->
f›ld_®Ÿs
};

27  
	`theme
('u£r_piùu»', 
$accouÁ
);

28 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_roles.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f›ld_u£r_rŞes
 
ex‹nds
 
	mv›ws_hªdËr_f›ld_´”’d”_li¡
 {

7 
funùiÚ
 
	$cÚ¡ruù
() {

8 
·»Á
::
	`cÚ¡ruù
();

9 
$this
->
add™iÚ®_f›lds
['uid'] = 
	`¬¿y
('table' => 'users', 'field' => 'uid');

12 
funùiÚ
 
	$qu”y
() {

13 
$this
->
	`add_add™iÚ®_f›lds
();

14 
$this
->
f›ld_®Ÿs
 = $this->
®Ÿ£s
['uid'];

15 
	}
}

17 
funùiÚ
 
	$´e_»nd”
(
$v®ues
) {

18 
$uids
 = 
	`¬¿y
();

19 
$this
->
™ems
 = 
	`¬¿y
();

21 
	`fÜ—ch
 (
$v®ues
 
as
 
$»suÉ
) {

22 
$uids
[] = 
$»suÉ
->{
$this
->
®Ÿ£s
['uid']};

25 ià(
$uids
) {

26 
$»suÉ
 = 
	`db_qu”y
("SELECT u.uid, u.rid,„.ÇmFROM {rŞe}„ INNER JOIN {u£rs_rŞes} u ON u.rid =„.rid WHERE u.uid IN (" . 
	`im¶ode
(', ', 
$uids
) . ") ORDER BY„.name");

27 
$rŞe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

28 
$this
->
™ems
[
$rŞe
->
uid
][$rŞe->
rid
]['rŞe'] = 
	`check_¶aš
($rŞe->
Çme
);

29 
$this
->
™ems
[
$rŞe
->
uid
][$rŞe->
rid
]['rid'] = $role->rid;

32 
	}
}

34 
funùiÚ
 
	$»nd”_™em
(
$couÁ
, 
$™em
) {

35  
$™em
['role'];

36 
	}
}

38 
funùiÚ
 
	$docum’t_£lf_tok’s
(&
$tok’s
) {

39 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-rŞe' . ']'] = 
	`t
('The‚ame ofhe„ole.');

40 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-rid' . ']'] = 
	`t
('The„ole ID ofhe„ole.');

41 
	}
}

43 
funùiÚ
 
	$add_£lf_tok’s
(&
$tok’s
, 
$™em
) {

44 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-rŞe' . ']'] = 
$™em
['role'];

45 
$tok’s
['[' . 
$this
->
İtiÚs
['id'] . '-rid' . ']'] = 
$™em
['rid'];

46 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_filter_user_current.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_u£r_cu¼’t
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_boŞ—n_İ”©Ü
 {

8 
funùiÚ
 
	$cÚ¡ruù
() {

9 
·»Á
::
	`cÚ¡ruù
();

10 
$this
->
v®ue_v®ue
 = 
	`t
('Ishe†ogged in user');

13 
funùiÚ
 
	$qu”y
() {

14 
$this
->
	`’su»_my_bË
();

15 
$wh”e
 = "$this->table_alias.$this->real_field ";

17 ià(
	`em±y
(
$this
->
v®ue
)) {

18 
$wh”e
 .= '<> ***CURRENT_USER***';

19 ià(
$this
->
acû±_nuÎ
) {

20 
$wh”e
 = '(' . $where . " OR $this->table_alias.$this->real_field IS NULL)";

24 
$wh”e
 .= '= ***CURRENT_USER***';

26 
$this
->
qu”y
->
	`add_wh”e
($this->
İtiÚs
['group'], 
$wh”e
);

27 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_filter_user_name.inc

1 <?
php


7 şas 
	cv›ws_hªdËr_f‹r_u£r_Çme
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_š_İ”©Ü
 {

8 
v¬
 
	m$no_sšgË
 = 
TRUE
;

10 
funùiÚ
 
	$v®ue_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

11 
$v®ues
 = 
	`¬¿y
();

12 ià(
$this
->
v®ue
) {

13 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {u£rs} u WHERE uid IN (" . 
	`im¶ode
(', ', 
$this
->
v®ue
) . ")");

14 
$accouÁ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

15 ià(
$accouÁ
->
uid
) {

16 
$v®ues
[] = 
$accouÁ
->
Çme
;

19 
$v®ues
[] = 'Anonymous';

24 
	`sÜt
(
$v®ues
);

25 
$deçuÉ_v®ue
 = 
	`im¶ode
(', ', 
$v®ues
);

26 
$fÜm
['v®ue'] = 
	`¬¿y
(

28 '#t™Ë' => 
	`t
('Usernames'),

29 '#desütiÚ' => 
	`t
('Enter‡ comma separated†ist of user‚ames.'),

30 '#deçuÉ_v®ue' => 
$deçuÉ_v®ue
,

34 ià(!
	`em±y
(
$fÜm_¡©e
['expo£d']è&& !
	`is£t
($fÜm_¡©e['šput'][
$this
->
İtiÚs
['expose']['identifier']])) {

35 
$fÜm_¡©e
['šput'][
$this
->
İtiÚs
['expo£']['id’tif›r']] = 
$deçuÉ_v®ue
;

39 
funùiÚ
 
	$v®ue_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
) {

40 
$v®ues
 = 
	`dru·l_ex¶ode_gs
(
$fÜm_¡©e
['values']['options']['value']);

41 
$uids
 = 
$this
->
	`v®id©e_u£r_¡ršgs
(
$fÜm
['v®ue'], 
$v®ues
);

43 ià(
$uids
) {

44 
$fÜm_¡©e
['v®ues']['İtiÚs']['v®ue'] = 
$uids
;

46 
	}
}

48 
funùiÚ
 
	$acû±_expo£d_šput
(
$šput
) {

49 
$rc
 = 
·»Á
::
	`acû±_expo£d_šput
(
$šput
);

51 ià(
$rc
) {

53 ià(
	`is£t
(
$this
->
v®id©ed_expo£d_šput
)) {

54 
$this
->
v®ue
 = $this->
v®id©ed_expo£d_šput
;

58  
$rc
;

59 
	}
}

61 
funùiÚ
 
	$expo£d_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
) {

62 ià(
	`em±y
(
$this
->
İtiÚs
['exposed'])) {

66 ià(
	`em±y
(
$this
->
İtiÚs
['expose']['identifier'])) {

70 
$id’tif›r
 = 
$this
->
İtiÚs
['expose']['identifier'];

71 
$v®ues
 = 
	`dru·l_ex¶ode_gs
(
$fÜm_¡©e
['v®ues'][
$id’tif›r
]);

73 
$uids
 = 
$this
->
	`v®id©e_u£r_¡ršgs
(
$fÜm
[
$id’tif›r
], 
$v®ues
);

75 ià(
$uids
) {

76 
$this
->
v®id©ed_expo£d_šput
 = 
$uids
;

78 
	}
}

85 
funùiÚ
 
	$v®id©e_u£r_¡ršgs
(&
$fÜm
, 
$v®ues
) {

86 
$uids
 = 
	`¬¿y
();

87 
$¶aûhŞd”s
 = 
	`¬¿y
();

88 
$¬gs
 = 
	`¬¿y
();

89 
$»suÉs
 = 
	`¬¿y
();

90 
	`fÜ—ch
 (
$v®ues
 
as
 
$v®ue
) {

91 ià(
	`¡¹Şow”
(
$v®ue
) == 'anonymous') {

92 
$uids
[] = 0;

95 
$missšg
[
	`¡¹Şow”
(
$v®ue
)] = 
TRUE
;

96 
$¬gs
[] = 
$v®ue
;

97 
$¶aûhŞd”s
[] = "'%s'";

101 ià(!
$¬gs
) {

102  
$uids
;

105 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {u£rs} WHERE‚amIN (" . 
	`im¶ode
(', ', 
$¶aûhŞd”s
è. ")", 
$¬gs
);

106 
$accouÁ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

107 
	`un£t
(
$missšg
[
	`¡¹Şow”
(
$accouÁ
->
Çme
)]);

108 
$uids
[] = 
$accouÁ
->
uid
;

111 ià(
$missšg
) {

112 
	`fÜm_”rÜ
(
$fÜm
, 
	`fÜm©_¶u¿l
(
	`couÁ
(
$missšg
), 'UÇbËØfšd u£r: @u£rs', 'UÇbËØfšd u£rs: @u£rs', 
	`¬¿y
('@u£rs' => 
	`im¶ode
(', ', 
	`¬¿y_keys
($missing)))));

115  
$uids
;

116 
	}
}

118 
funùiÚ
 
	$v®ue_subm™
() {

120 
	}
}

123 
funùiÚ
 
	$g‘_v®ue_İtiÚs
(è{ 
	}
}

125 
funùiÚ
 
	$admš_summ¬y
() {

127 
$this
->
v®ue_İtiÚs
 = 
	`¬¿y
();

129 ià(
$this
->
v®ue
) {

130 
$»suÉ
 = 
	`db_qu”y
("SELECT * FROM {u£rs} u WHERE uid IN (" . 
	`im¶ode
(', ', 
$this
->
v®ue
) . ")");

132 
$accouÁ
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

133 ià(
$accouÁ
->
uid
) {

134 
$this
->
v®ue_İtiÚs
[
$accouÁ
->
uid
] = $accouÁ->
Çme
;

137 
$this
->
v®ue_İtiÚs
[
$accouÁ
->
uid
] = 'Anonymous';

142  
·»Á
::
	`admš_summ¬y
();

143 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_filter_user_roles.inc

1 <?
php


6 şas 
	cv›ws_hªdËr_f‹r_u£r_rŞes
 
ex‹nds
 
	mv›ws_hªdËr_f‹r_mªy_to_Úe
 {

7 
funùiÚ
 
	$g‘_v®ue_İtiÚs
() {

8 
$this
->
v®ue_İtiÚs
 = 
	`u£r_rŞes
(
TRUE
);

9 
	`un£t
(
$this
->
v®ue_İtiÚs
[
DRUPAL_AUTHENTICATED_RID
]);

11 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_plugin_argument_default_current_user.inc

1 <?
php


11 şas 
	cv›ws_¶ugš_¬gum’t_deçuÉ_cu¼’t_u£r
 
ex‹nds
 
	mv›ws_¶ugš_¬gum’t_deçuÉ
 {

12 
funùiÚ
 
	$g‘_¬gum’t
() {

13 
glob®
 
$u£r
;

14  
$u£r
->
uid
;

16 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_plugin_argument_default_user.inc

1 <?
php


11 şas 
	cv›ws_¶ugš_¬gum’t_deçuÉ_u£r
 
ex‹nds
 
	mv›ws_¶ugš_¬gum’t_deçuÉ
 {

12 
v¬
 
	m$İtiÚ_Çme
 = 'default_argument_user';

14 
funùiÚ
 
	$¬gum’t_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

15 
$fÜm
[
$this
->
İtiÚ_Çme
] = 
	`¬¿y
(

17 '#t™Ë' => 
	`t
('Also†ook for‡‚ode‡nd usehe‚ode‡uthor'),

18 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
¬gum’t
->
İtiÚs
[$this->
İtiÚ_Çme
]),

19 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

20 '#d•’d’cy' => 
	`¬¿y
(

21 '¿dio:İtiÚs[deçuÉ_aùiÚ]' => 
	`¬¿y
('default'),

22 '¿dio:İtiÚs[deçuÉ_¬gum’t_ty³]' => 
	`¬¿y
(
$this
->
id
)

28 
funùiÚ
 
	$g‘_¬gum’t
() {

29 
	`fÜ—ch
 (
	`¿nge
(1, 3è
as
 
$i
) {

30 
$u£r
 = 
	`m’u_g‘_objeù
('u£r', 
$i
);

31 ià(!
	`em±y
(
$u£r
)) {

32  
$u£r
->
uid
;

36 
	`fÜ—ch
 (
	`¿nge
(1, 3è
as
 
$i
) {

37 
$u£r
 = 
	`m’u_g‘_objeù
('u£r_uid_İtiÚ®', 
$i
);

38 ià(!
	`em±y
(
$u£r
)) {

39  
$u£r
->
uid
;

43 ià(!
	`em±y
(
$this
->
¬gum’t
->
İtiÚs
[$this->
İtiÚ_Çme
])) {

44 
	`fÜ—ch
 (
	`¿nge
(1, 3è
as
 
$i
) {

45 
$node
 = 
	`m’u_g‘_objeù
('node', 
$i
);

46 ià(!
	`em±y
(
$node
)) {

47  
$node
->
uid
;

52 ià(
	`¬g
(0è=ğ'u£r' && 
	`is_num”ic
(arg(1))) {

53  
	`¬g
(1);

56 ià(
	`¬g
(0è=ğ'node' && 
	`is_num”ic
(arg(1))) {

57 
$node
 = 
	`node_lßd
(
	`¬g
(1));

58 ià(
$node
) {

59  
$node
->
uid
;

62 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_plugin_argument_validate_user.inc

1 <?
php


11 şas 
	cv›ws_¶ugš_¬gum’t_v®id©e_u£r
 
ex‹nds
 
	mv›ws_¶ugš_¬gum’t_v®id©e
 {

12 
funùiÚ
 
	$v®id©e_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

15 ià(!
	`is£t
(
$this
->
¬gum’t
->
İtiÚs
['validate_user_argument_type'])) {

16 
$this
->
¬gum’t
->
İtiÚs
['validate_user_argument_type'] = 'uid';

17 
$this
->
¬gum’t
->
İtiÚs
['v®id©e_u£r_rŞes'] = 
	`¬¿y
();

20 
$fÜm
['v®id©e_u£r_¬gum’t_ty³'] = 
	`¬¿y
(

22 '#t™Ë' => 
	`t
('Type of user‡rgumento‡llow'),

23 '#İtiÚs' => 
	`¬¿y
(

24 'uid' => 
	`t
('Only‡llow‚umeric UIDs'),

25 'Çme' => 
	`t
('Only‡llow string usernames'),

26 'e™h”' => 
	`t
('Allow both‚umeric UIDs‡nd string usernames'),

28 '#deçuÉ_v®ue' => 
$this
->
¬gum’t
->
İtiÚs
['validate_user_argument_type'],

29 '#´oûss' => 
	`¬¿y
('expand_radios', 'views_process_dependency'),

30 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-v®id©e-ty³' =>‡¼ay(
$this
->
id
)),

35 
$fÜm
['v®id©e_u£r_»¡riù_rŞes'] = 
	`¬¿y
(

37 '#t™Ë' => 
	`t
('Restrict user based on„ole'),

38 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
¬gum’t
->
İtiÚs
['validate_user_restrict_roles']),

39 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

40 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-v®id©e-ty³' =>‡¼ay(
$this
->
id
)),

43 
$fÜm
['v®id©e_u£r_rŞes'] = 
	`¬¿y
(

47 '#t™Ë' => 
	`t
('Restrictohe selected„oles'),

48 '#İtiÚs' => 
	`u£r_rŞes
(
TRUE
),

49 '#deçuÉ_v®ue' => 
$this
->
¬gum’t
->
İtiÚs
['validate_user_roles'],

50 '#desütiÚ' => 
	`t
('If‚o„oles‡re selected, users from‡ny„ole will be‡llowed.'),

51 '#´oûss' => 
	`¬¿y
('expand_checkboxes', 'views_process_dependency'),

52 '#d•’d’cy' => 
	`¬¿y
(

53 'ed™-İtiÚs-v®id©e-ty³' => 
	`¬¿y
(
$this
->
id
),

54 'ed™-İtiÚs-v®id©e-u£r-»¡riù-rŞes' => 
	`¬¿y
(1),

60 
funùiÚ
 
	$v®id©e_¬gum’t
(
$¬gum’t
) {

61 
$ty³
 = 
$this
->
¬gum’t
->
İtiÚs
['validate_user_argument_type'];

64 ià(
	`is_num”ic
(
$¬gum’t
) && $argument == ()$argument) {

65 ià(
$ty³
 == 'uid' || $type == 'either') {

66 ià(
$¬gum’t
 =ğ
$GLOBALS
['u£r']->
uid
) {

67 
$accouÁ
 = 
$GLOBALS
['user'];

69 
$wh”e
 = 'uid = %d';

73 ià(
$ty³
 == 'name' || $type == 'either') {

74 ià(
$¬gum’t
 =ğ
$GLOBALS
['u£r']->
Çme
) {

75 
$accouÁ
 = 
$GLOBALS
['user'];

77 
$wh”e
 = "name = '%s'";

82 ià(
	`em±y
(
$wh”e
)) {

83  
FALSE
;

86 ià(!
	`is£t
(
$accouÁ
)) {

87 
$qu”y
 = "SELECT uid,‚ame FROM {users} WHERE $where";

88 
$accouÁ
 = 
	`db_ãtch_objeù
(
	`db_qu”y
(
$qu”y
, 
$¬gum’t
));

90 ià(
	`em±y
(
$accouÁ
)) {

92  
FALSE
;

96 ià(!
	`em±y
(
$this
->
¬gum’t
->
İtiÚs
['validate_user_restrict_roles']) && !empty($this->argument->options['validate_user_roles'])) {

97 
$rŞes
 = 
$this
->
¬gum’t
->
İtiÚs
['validate_user_roles'];

98 
$accouÁ
->
rŞes
 = 
	`¬¿y
();

99 
$accouÁ
->
rŞes
[] = $accouÁ->
uid
 ? 
DRUPAL_AUTHENTICATED_RID
 : 
DRUPAL_ANONYMOUS_RID
;

100 
$»suÉ
 = 
	`db_qu”y
('SELECT„id FROM {u£rs_rŞes} WHERE uid = %d', 
$accouÁ
->
uid
);

101 
$rŞe
 = 
	`db_ãtch_objeù
(
$»suÉ
)) {

102 
$accouÁ
->
rŞes
[] = 
$rŞe
->
rid
;

104 ià(!(
boŞ
)
	`¬¿y_š‹r£ù
(
$accouÁ
->
rŞes
, 
$rŞes
)) {

105  
FALSE
;

109 
$this
->
¬gum’t
->¬gum’ˆğ
$accouÁ
->
uid
;

110 
$this
->
¬gum’t
->
v®id©ed_t™Ë
 = 
	`check_¶aš
(
$accouÁ
->
Çme
);

111  
TRUE
;

112 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/views.views.inc

1 <?
php


17 
funùiÚ
 
	$v›ws_v›ws_d©a
() {

18 
$d©a
['v›ws']['bË']['group'] = 
	`t
('Global');

19 
$d©a
['v›ws']['bË']['još'] = 
	`¬¿y
(

20 '#glob®' => 
	`¬¿y
(),

23 
$d©a
['v›ws']['¿ndom'] = 
	`¬¿y
(

24 't™Ë' => 
	`t
('Random'),

25 'h–p' => 
	`t
('Randomizehe display order.'),

26 'sÜt' => 
	`¬¿y
(

31 
$d©a
['v›ws']['nuÎ'] = 
	`¬¿y
(

32 't™Ë' => 
	`t
('Null'),

33 'h–p' => 
	`t
('Allow‡n‡rgumento be ignored. The query will‚ot be‡ltered byhis‡rgument.'),

34 '¬gum’t' => 
	`¬¿y
(

39 
$d©a
['v›ws']['nÙhšg'] = 
	`¬¿y
(

40 't™Ë' => 
	`t
('Customext'),

41 'h–p' => 
	`t
('Provide customext or†ink.'),

42 'f›ld' => 
	`¬¿y
(

47 
$d©a
['v›ws']['couÁ”'] = 
	`¬¿y
(

48 't™Ë' => 
	`t
('View„esult counter'),

49 'h–p' => 
	`t
('Displayshe‡ctual…osition ofhe view„esult'),

50 'f›ld' => 
	`¬¿y
(

55  
$d©a
;

56 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_access.inc

1 <?
php


9 şas 
	cv›ws_¶ugš_acûss
 
ex‹nds
 
	mv›ws_¶ugš
 {

18 
funùiÚ
 
	$š™
(&
$v›w
, &
$di¥Ïy
) {

19 
$this
->
v›w
 = &
$v›w
;

20 
$this
->
di¥Ïy
 = &
$di¥Ïy
;

21 
$this
->
İtiÚs
 = 
	`¬¿y
();

23 ià(
	`is_objeù
(
$di¥Ïy
->
hªdËr
)) {

25 
$this
->
İtiÚs
 = 
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('access');

33 
funùiÚ
 
	$İtiÚ_deçuÉs
(&
$İtiÚs
è{ 
	}
}

38 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

43 
funùiÚ
 
	$İtiÚs_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

48 
funùiÚ
 
	$İtiÚs_subm™
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

54 
funùiÚ
 
	$summ¬y_t™Ë
() {

55  
	`t
('Unknown');

56 
	}
}

61 
funùiÚ
 
	$acûss
(
$accouÁ
) {

63  
TRUE
;

64 
	}
}

78 
funùiÚ
 
	$g‘_acûss_ÿÎback
() {

80  
TRUE
;

81 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_access_none.inc

1 <?
php


7 şas 
	cv›ws_¶ugš_acûss_nÚe
 
ex‹nds
 
	mv›ws_¶ugš_acûss
 {

8 
funùiÚ
 
	$summ¬y_t™Ë
() {

9  
	`t
('Unrestricted');

11 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_access_perm.inc

1 <?
php


7 şas 
	cv›ws_¶ugš_acûss_³rm
 
ex‹nds
 
	mv›ws_¶ugš_acûss
 {

8 
funùiÚ
 
	$acûss
(
$accouÁ
) {

9  
	`v›ws_check_³rm
(
$this
->
İtiÚs
['³rm'], 
$accouÁ
);

12 
funùiÚ
 
	$g‘_acûss_ÿÎback
() {

13  
	`¬¿y
('v›ws_check_³rm',‡¼ay(
$this
->
İtiÚs
['perm']));

14 
	}
}

16 
funùiÚ
 
	$summ¬y_t™Ë
() {

17  
	`t
(
$this
->
İtiÚs
['perm']);

18 
	}
}

20 
funùiÚ
 
	$İtiÚ_deçuÉs
(&
$İtiÚs
) {

21 
$İtiÚs
['perm'] = 'access content';

22 
	}
}

24 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

25 
$³rms
 = 
	`¬¿y
();

27 
	`fÜ—ch
 (
	`moduË_li¡
(
FALSE
, FALSE, 
TRUE
è
as
 
$moduË
) {

28 ià(
$³rmissiÚs
 = 
	`moduË_švoke
(
$moduË
, 'perm')) {

29 
$³rms
[
$moduË
] = 
	`dru·l_m­_assoc
(
$³rmissiÚs
);

32 
$fÜm
['³rm'] = 
	`¬¿y
(

34 '#İtiÚs' => 
$³rms
,

35 '#t™Ë' => 
	`t
('Permission'),

36 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['perm'],

37 '#desütiÚ' => 
	`t
('Only users withhe selected…ermission flag will be‡bleo‡ccesshis display. Notehat users with "access‡ll views" can see‡ny view,„egardless of other…ermissions.'),

39 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_access_role.inc

1 <?
php


7 şas 
	cv›ws_¶ugš_acûss_rŞe
 
ex‹nds
 
	mv›ws_¶ugš_acûss
 {

8 
funùiÚ
 
	$acûss
(
$accouÁ
) {

9  
	`v›ws_check_rŞes
(
	`¬¿y_f‹r
(
$this
->
İtiÚs
['rŞe']), 
$accouÁ
);

12 
funùiÚ
 
	$g‘_acûss_ÿÎback
() {

13  
	`¬¿y
('v›ws_check_rŞes',‡¼ay(
	`¬¿y_f‹r
(
$this
->
İtiÚs
['role'])));

14 
	}
}

16 
funùiÚ
 
	$summ¬y_t™Ë
() {

17 
$couÁ
 = 
	`couÁ
(
$this
->
İtiÚs
['role']);

18 ià(
$couÁ
 < 1) {

19  
	`t
('No„ole(s) selected');

21 ià(
$couÁ
 > 1) {

22  
	`t
('Multiple„oles');

25 
$rids
 = 
	`v›ws_ui_g‘_rŞes
();

26 
$rid
 = 
	`¬¿y_shiá
(
$this
->
İtiÚs
['role']);

27  
$rids
[
$rid
];

29 
	}
}

31 
funùiÚ
 
	$İtiÚ_deçuÉs
(&
$İtiÚs
) {

32 
$İtiÚs
['rŞe'] = 
	`¬¿y
();

33 
	}
}

35 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

36 
$fÜm
['rŞe'] = 
	`¬¿y
(

38 '#t™Ë' => 
	`t
('Role'),

39 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['role'],

40 '#İtiÚs' => 
	`v›ws_ui_g‘_rŞes
(),

41 '#desütiÚ' => 
	`t
('Onlyhe checked„oles will be‡bleo‡ccesshis display. Notehat users with "access‡ll views" can see‡ny view,„egardless of„ole.'),

43 
	}
}

45 
funùiÚ
 
	$İtiÚs_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
) {

46 ià(!
	`¬¿y_f‹r
(
$fÜm_¡©e
['values']['access_options']['role'])) {

47 
	`fÜm_”rÜ
(
$fÜm
['rŞe'], 
	`t
('You must select‡t†east one„ole ifype is "by„ole"'));

49 
	}
}

51 
funùiÚ
 
	$İtiÚs_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

53 
$fÜm_¡©e
['v®ues']['acûss_İtiÚs']['rŞe'] = 
	`¬¿y_f‹r
($form_state['values']['access_options']['role']);

54 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_argument_default.inc

1 <?
php


21 şas 
	cv›ws_¶ugš_¬gum’t_deçuÉ
 
ex‹nds
 
	mv›ws_¶ugš
 {

22 
v¬
 
	m$İtiÚ_Çme
 = 'default_argument_fixed';

27 
funùiÚ
 
	$š™
(&
$v›w
, &
$¬gum’t
, 
$id
 = 
NULL
) {

28 
$this
->
v›w
 = &
$v›w
;

29 
$this
->
¬gum’t
 = &
$¬gum’t
;

30 
$this
->
id
 = 
$id
;

37 
funùiÚ
 
	$acûss
(è{  
TRUE
; 
	}
}

39 
funùiÚ
 
	$¬gum’t_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

40 
$fÜm
[
$this
->
İtiÚ_Çme
] = 
	`¬¿y
(

42 '#t™Ë' => 
	`t
('Default‡rgument'),

43 '#deçuÉ_v®ue' => 
$this
->
	`g‘_¬gum’t
(),

44 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

45 '#d•’d’cy' => 
	`¬¿y
(

46 '¿dio:İtiÚs[deçuÉ_aùiÚ]' => 
	`¬¿y
('default'),

47 '¿dio:İtiÚs[deçuÉ_¬gum’t_ty³]' => 
	`¬¿y
(
$this
->
id
)

53 
$this
->
	`check_acûss
(
$fÜm
);

54 
	}
}

60 
funùiÚ
 
	$check_acûss
(&
$fÜm
) {

61 ià(!
$this
->
	`acûss
()) {

62 
$fÜm
[
$this
->
İtiÚ_Çme
]['#di§bËd'] = 
TRUE
;

63 
$fÜm
[
$this
->
İtiÚ_Çme
]['#value'] = $form[$this->option_name]['#default_value'];

64 
$fÜm
[
$this
->
İtiÚ_Çme
]['#desütiÚ'] .ğ' <¡rÚg>' . 
	`t
('Note: you do‚ot have…ermissiono modifyhis. If you changehe default‡rgumentype,his setting will be†ost‡nd you will NOT be‡bleo get it back.') . '</strong>';

66 
	}
}

71 
funùiÚ
 
	$g‘_¬gum’t
() {

72  
	`is£t
(
$this
->
¬gum’t
->
İtiÚs
[$this->
İtiÚ_Çme
]) ? $this->argument->options[$this->option_name] : '';

73 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_argument_default_php.inc

1 <?
php


11 şas 
	cv›ws_¶ugš_¬gum’t_deçuÉ_php
 
ex‹nds
 
	mv›ws_¶ugš_¬gum’t_deçuÉ
 {

12 
v¬
 
	m$İtiÚ_Çme
 = 'default_argument_php';

14 
funùiÚ
 
	$¬gum’t_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

15 
$fÜm
[
$this
->
İtiÚ_Çme
] = 
	`¬¿y
(

17 '#t™Ë' => 
	`t
('PHP‡rgument code'),

18 '#deçuÉ_v®ue' => 
$this
->
	`g‘_¬gum’t
(
TRUE
),

19 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

20 '#desütiÚ' => 
	`t
('Enter PHP codehat„eturns‡ valueo use forhis‡rgument. Do‚ot use &lt;?php ?&gt;. You must„eturn only‡ single value for justhis‡rgument.'),

21 '#d•’d’cy' => 
	`¬¿y
(

22 '¿dio:İtiÚs[deçuÉ_aùiÚ]' => 
	`¬¿y
('default'),

23 '¿dio:İtiÚs[deçuÉ_¬gum’t_ty³]' => 
	`¬¿y
(
$this
->
id
)

28 
$this
->
	`check_acûss
(
$fÜm
);

35 
funùiÚ
 
	$acûss
() {

36  
	`u£r_acûss
('use PHP for block visibility');

37 
	}
}

39 
funùiÚ
 
	$g‘_¬gum’t
(
$¿w
 = 
FALSE
) {

40 ià(
$¿w
) {

41  
·»Á
::
	`g‘_¬gum’t
();

45 
$v›w
 = &
$this
->
v›w
;

46 
$¬gum’t
 = &
$this
->
¬gum’t
;

47 
	`ob_¡¬t
();

48 
$»suÉ
 = 
	`ev®
(
$this
->
¬gum’t
->
İtiÚs
[$this->
İtiÚ_Çme
]);

49 
	`ob_’d_ş—n
();

50  
$»suÉ
;

51 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_argument_validate.inc

1 <?
php


22 şas 
	cv›ws_¶ugš_¬gum’t_v®id©e
 
ex‹nds
 
	mv›ws_¶ugš
 {

23 
v¬
 
	m$İtiÚ_Çme
 = 'validate_argument';

29 
funùiÚ
 
	$š™
(&
$v›w
, &
$¬gum’t
, 
$id
 = 
NULL
) {

30 
$this
->
v›w
 = &
$v›w
;

31 
$this
->
¬gum’t
 = &
$¬gum’t
;

32 
$this
->
id
 = 
$id
;

39 
funùiÚ
 
	$acûss
(è{  
TRUE
; 
	}
}

41 
funùiÚ
 
	$¬gum’t_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

42 
	}
}

48 
funùiÚ
 
	$check_acûss
(&
$fÜm
) {

49 ià(!
$this
->
	`acûss
()) {

50 
$fÜm
[
$this
->
İtiÚ_Çme
]['#di§bËd'] = 
TRUE
;

51 
$fÜm
[
$this
->
İtiÚ_Çme
]['#value'] = $form[$this->option_name]['#default_value'];

52 
$fÜm
[
$this
->
İtiÚ_Çme
]['#desütiÚ'] .ğ' <¡rÚg>' . 
	`t
('Note: you do‚ot have…ermissiono modifyhis. If you changehe validator,his setting will be†ost‡nd you will NOT be‡bleo get it back.') . '</strong>';

54 
	}
}

59 
funùiÚ
 
	$g‘_¬gum’t
() {

60  
	`is£t
(
$this
->
¬gum’t
->
İtiÚs
[$this->
İtiÚ_Çme
]) ? $this->argument->options[$this->option_name] : '';

61 
	}
}

63 
funùiÚ
 
	$v®id©e_fÜm
(&
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

65 
funùiÚ
 
	$v®id©e_¬gum’t
(
$¬g
è{  
TRUE
; 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_argument_validate_numeric.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_¬gum’t_v®id©e_num”ic
 
ex‹nds
 
	mv›ws_¶ugš_¬gum’t_v®id©e
 {

14 
v¬
 
	m$İtiÚ_Çme
 = 'validate_argument_numeric';

20 
funùiÚ
 
	$acûss
() {

21  !
	`em±y
(
$this
->
¬gum’t
->
defš™iÚ
['numeric']);

24 
funùiÚ
 
	$v®id©e_¬gum’t
(
$¬gum’t
) {

25  
	`is_num”ic
(
$¬gum’t
);

26 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_argument_validate_php.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_¬gum’t_v®id©e_php
 
ex‹nds
 
	mv›ws_¶ugš_¬gum’t_v®id©e
 {

14 
v¬
 
	m$İtiÚ_Çme
 = 'validate_argument_php';

16 
funùiÚ
 
	$v®id©e_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

17 
$fÜm
[
$this
->
İtiÚ_Çme
] = 
	`¬¿y
(

19 '#t™Ë' => 
	`t
('PHP validate code'),

20 '#deçuÉ_v®ue' => 
$this
->
	`g‘_¬gum’t
(),

21 '#desütiÚ' => 
	`t
('Enter PHP codehat„eturns TRUE or FALSE. No„eturn ishe same‡s FALSE, so be SUREo„eturn something if you do‚ot wanto declarehe‡rgument invalid. Do‚ot use &lt;?php ?&gt;. The‡rgumento validate will be "$argument"‡ndhe view will be "$view". You may changehe‡rgument by setting "$handler->argument".'),

22 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

23 '#d•’d’cy' => 
	`¬¿y
('ed™-İtiÚs-v®id©e-ty³' =>‡¼ay(
$this
->
id
)),

26 
$this
->
	`check_acûss
(
$fÜm
);

33 
funùiÚ
 
	$acûss
() {

34  
	`u£r_acûss
('use PHP for block visibility');

35 
	}
}

37 
funùiÚ
 
	$v®id©e_¬gum’t
(
$¬gum’t
) {

39 
$v›w
 = &
$this
->
v›w
;

40 
$hªdËr
 = &
$this
->
¬gum’t
;

42 
	`ob_¡¬t
();

43 
$»suÉ
 = 
	`ev®
(
$this
->
¬gum’t
->
İtiÚs
[$this->
İtiÚ_Çme
]);

44 
	`ob_’d_ş—n
();

45  
$»suÉ
;

46 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_cache.inc

1 <?
php


9 şas 
	cv›ws_¶ugš_ÿche
 
ex‹nds
 
	mv›ws_¶ugš
 {

13 
v¬
 
	m$¡Üage
 = 
¬¿y
();

18 
v¬
 
	m$bË
 = 'cache_views_data';

28 
funùiÚ
 
	$š™
(&
$v›w
, &
$di¥Ïy
) {

29 
$this
->
v›w
 = &
$v›w
;

30 
$this
->
di¥Ïy
 = &
$di¥Ïy
;

31 
$this
->
İtiÚs
 = 
	`¬¿y
();

33 ià(
	`is_objeù
(
$di¥Ïy
->
hªdËr
)) {

35 
$this
->
İtiÚs
 = 
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('cache');

43 
funùiÚ
 
	$İtiÚ_deçuÉs
(&
$İtiÚs
è{ 
	}
}

49 
funùiÚ
 
	$summ¬y_t™Ë
() {

50  
	`t
('Unknown');

51 
	}
}

61 
funùiÚ
 
	$ÿche_expœe
(
$ty³
è{ 
	}
}

68 
funùiÚ
 
	$ÿche_£t
(
$ty³
) {

69 
$ty³
) {

74 
$d©a
 = 
	`¬¿y
(

75 '»suÉ' => 
$this
->
v›w
->
»suÉ
,

76 'tÙ®_rows' => 
$this
->
v›w
->
tÙ®_rows
,

77 '·g”' => 
$this
->
v›w
->
·g”
,

79 
	`ÿche_£t
(
$this
->
	`g‘_»suÉs_key
(), 
$d©a
, $this->
bË
);

82 
$this
->
	`g©h”_h—d”s
();

83 
$this
->
¡Üage
['ouut'] = $this->
v›w
->
di¥Ïy_hªdËr
->
ouut
;

84 
	`ÿche_£t
(
$this
->
	`g‘_ouut_key
(), $this->
¡Üage
, $this->
bË
);

87 
	}
}

95 
funùiÚ
 
	$ÿche_g‘
(
$ty³
) {

96 
$cutoff
 = 
$this
->
	`ÿche_expœe
(
$ty³
);

97 
$ty³
) {

100  
FALSE
;

104 ià(
$ÿche
 = 
	`ÿche_g‘
(
$this
->
	`g‘_»suÉs_key
(), $this->
bË
)) {

105 ià(!
$cutoff
 || 
$ÿche
->
ü—‹d
 > $cutoff) {

106 
$this
->
v›w
->
»suÉ
 = 
$ÿche
->
d©a
['result'];

107 
$this
->
v›w
->
tÙ®_rows
 = 
$ÿche
->
d©a
['total_rows'];

108 
$this
->
v›w
->
·g”
 = 
$ÿche
->
d©a
['pager'];

109 
$this
->
v›w
->
execu‹_time
 = 0;

110  
TRUE
;

113  
FALSE
;

115 ià(
$ÿche
 = 
	`ÿche_g‘
(
$this
->
	`g‘_ouut_key
(), $this->
bË
)) {

116 ià(!
$cutoff
 || 
$ÿche
->
ü—‹d
 > $cutoff) {

117 
$this
->
¡Üage
 = 
$ÿche
->
d©a
;

118 
$this
->
v›w
->
di¥Ïy_hªdËr
->
ouut
 = 
$ÿche
->
d©a
['output'];

119 
$this
->
	`»¡Üe_h—d”s
();

120  
TRUE
;

123  
FALSE
;

125 
	}
}

133 
funùiÚ
 
	$ÿche_æush
() {

134 
	`ÿche_ş—r_®l
(
$this
->
v›w
->
Çme
 . ':', $this->
bË
, 
TRUE
);

135 
	}
}

157 
funùiÚ
 
	$po¡_»nd”
(&
$ouut
è{ 
	}
}

166 
funùiÚ
 
	$ÿche_¡¬t
() {

167 
$this
->
¡Üage
['h—d'] = 
	`dru·l_£t_html_h—d
();

168 
$this
->
¡Üage
['css'] = 
	`dru·l_add_css
();

170 
	`fÜ—ch
 (
	`¬¿y
('h—d”', 'foÙ”'è
as
 
$scİe
) {

171 
$this
->
¡Üage
['js'][
$scİe
] = 
	`dru·l_add_js
(
NULL
, NULL, $scope);

173 
	}
}

178 
funùiÚ
 
	$g©h”_h—d”s
() {

180 
$this
->
¡Üage
['h—d'] = 
	`¡r_»¶aû
($this->¡Üage['h—d'], '', 
	`dru·l_£t_html_h—d
());

183 
$css
 = 
	`dru·l_add_css
();

184 
$¡¬t
 = 
$this
->
¡Üage
['css'];

185 
$this
->
¡Üage
['css'] = 
	`¬¿y
();

187 
	`fÜ—ch
 (
$css
 
as
 
$medŸ
 => 
$medŸs
) {

188 
	`fÜ—ch
 (
$medŸs
 
as
 
$ty³
 => 
$ty³s
) {

189 
	`fÜ—ch
 (
$ty³s
 
as
 
$·th
 => 
$´•roûss
) {

190 ià(!
	`is£t
(
$¡¬t
[
$medŸ
][
$ty³
][
$·th
])) {

191 
$this
->
¡Üage
['css'][] = 
	`¬¿y
(
$·th
, 
$ty³
, 
$medŸ
, 
$´•roûss
);

197 
$js
 = 
	`¬¿y
();

199 
	`fÜ—ch
 (
	`¬¿y
('h—d”', 'foÙ”'è
as
 
$scİe
) {

200 
$js
[
$scİe
] = 
	`dru·l_add_js
(
NULL
, NULL, $scope);

203 
$¡¬t
 = 
$this
->
¡Üage
['js'];

204 
$this
->
¡Üage
['js'] = 
	`¬¿y
();

206 
	`fÜ—ch
 (
$js
 
as
 
$scİe
 => 
$scİes
) {

207 
	`fÜ—ch
 (
$scİes
 
as
 
$ty³
 => 
$ty³s
) {

208 
	`fÜ—ch
 (
$ty³s
 
as
 
$id
 => 
$šfo
) {

209 ià(!
	`is£t
(
$¡¬t
[
$scİe
][
$ty³
][
$id
])) {

210 
$ty³
) {

212 
$this
->
¡Üage
['js'][] = 
	`¬¿y
(
$šfo
, 
$ty³
, 
$scİe
);

216 
$this
->
¡Üage
['js'][] = 
	`¬¿y
(
$šfo
['code'], 
$ty³
, 
$scİe
, $info['defer']);

220 
$this
->
¡Üage
['js'][] = 
	`¬¿y
(
$id
, 
$ty³
, 
$scİe
, 
$šfo
['defer'], $info['cache']);

226 
	}
}

231 
funùiÚ
 
	$»¡Üe_h—d”s
() {

232 ià(!
	`em±y
(
$this
->
¡Üage
['head'])) {

233 
	`dru·l_£t_html_h—d
(
$this
->
¡Üage
['head']);

235 ià(!
	`em±y
(
$this
->
¡Üage
['css'])) {

236 
	`fÜ—ch
 (
$this
->
¡Üage
['css'] 
as
 
$¬gs
) {

237 
	`ÿÎ_u£r_func_¬¿y
('dru·l_add_css', 
$¬gs
);

240 ià(!
	`em±y
(
$this
->
¡Üage
['js'])) {

241 
	`fÜ—ch
 (
$this
->
¡Üage
['js'] 
as
 
$¬gs
) {

242 
	`ÿÎ_u£r_func_¬¿y
('dru·l_add_js', 
$¬gs
);

245 
	}
}

247 
funùiÚ
 
	$g‘_»suÉs_key
() {

248 
glob®
 
$u£r
;

250 ià(!
	`is£t
(
$this
->
_»suÉs_key
)) {

251 
$key_d©a
 = 
	`¬¿y
(

252 'bud_šfo' => 
$this
->
v›w
->
bud_šfo
,

253 'rŞes' => 
	`¬¿y_keys
(
$u£r
->
rŞes
),

254 'su³r-u£r' => 
$u£r
->
uid
 == 1,

255 'Ïnguage' => 
$GLOBALS
['language'],

257 
	`fÜ—ch
 (
	`¬¿y
('expo£d_šfo', '·ge', 'sÜt', 'Üd”'è
as
 
$key
) {

258 ià(
	`is£t
(
$_GET
[
$key
])) {

259 
$key_d©a
[
$key
] = 
$_GET
[$key];

263 
$this
->
_»suÉs_key
 = $this->
v›w
->
Çme
 . ':' . $this->
di¥Ïy
->
id
 . ':»suÉs:' . 
	`md5
(
	`£rŸlize
(
$key_d©a
));

266  
$this
->
_»suÉs_key
;

267 
	}
}

269 
funùiÚ
 
	$g‘_ouut_key
() {

270 
glob®
 
$u£r
;

271 ià(!
	`is£t
(
$this
->
_ouut_key
)) {

272 
$key_d©a
 = 
	`¬¿y
(

273 '»suÉ' => 
$this
->
v›w
->
»suÉ
,

274 'rŞes' => 
	`¬¿y_keys
(
$u£r
->
rŞes
),

275 'su³r-u£r' => 
$u£r
->
uid
 == 1,

276 'theme' => 
$GLOBALS
['theme'],

277 'Ïnguage' => 
$GLOBALS
['language'],

280 
$this
->
_ouut_key
 = $this->
v›w
->
Çme
 . ':' . $this->
di¥Ïy
->
id
 . ':ouut:' . 
	`md5
(
	`£rŸlize
(
$key_d©a
));

283  
$this
->
_ouut_key
;

284 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_cache_none.inc

1 <?
php


7 şas 
	cv›ws_¶ugš_ÿche_nÚe
 
ex‹nds
 
	mv›ws_¶ugš_ÿche
 {

8 
funùiÚ
 
	$ÿche_¡¬t
() { }

10 
funùiÚ
 
	$summ¬y_t™Ë
() {

11  
	`t
('None');

12 
	}
}

14 
funùiÚ
 
	$ÿche_g‘
(
$ty³
) {

15  
FALSE
;

16 
	}
}

18 
funùiÚ
 
	$ÿche_£t
(
$ty³
è{ 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_cache_time.inc

1 <?
php


7 şas 
	cv›ws_¶ugš_ÿche_time
 
ex‹nds
 
	mv›ws_¶ugš_ÿche
 {

8 
funùiÚ
 
	$İtiÚ_deçuÉs
(&
$İtiÚs
) {

9 
$İtiÚs
['results_lifespan'] = 3600;

10 
$İtiÚs
['output_lifespan'] = 3600;

13 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

14 
$İtiÚs
 = 
	`¬¿y
(60, 300, 1800, 3600, 21600, 518400);

15 
$İtiÚs
 = 
	`dru·l_m­_assoc
($options, 'format_interval');

16 
$İtiÚs
 = 
	`¬¿y
(-1 => 
	`t
('Never cache')) + $options;

18 
$fÜm
['»suÉs_liã¥ª'] = 
	`¬¿y
(

20 '#t™Ë' => 
	`t
('Query„esults'),

21 '#desütiÚ' => 
	`t
('The†ength ofime„aw query„esults should be cached.'),

22 '#İtiÚs' => 
$İtiÚs
,

23 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['results_lifespan'],

25 
$fÜm
['ouut_liã¥ª'] = 
	`¬¿y
(

27 '#t™Ë' => 
	`t
('Rendered output'),

28 '#desütiÚ' => 
	`t
('The†ength ofime„endered HTML output should be cached.'),

29 '#İtiÚs' => 
$İtiÚs
,

30 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['output_lifespan'],

32 
	}
}

34 
funùiÚ
 
	$summ¬y_t™Ë
() {

35  
	`fÜm©_š‹rv®
(
$this
->
İtiÚs
['results_lifespan'], 1) . '/' . format_interval($this->options['output_lifespan'], 1);

36 
	}
}

38 
funùiÚ
 
	$ÿche_expœe
(
$ty³
) {

39 ià(
$liã¥ª
 = 
$this
->
İtiÚs
[
$ty³
 . '_lifespan']) {

40 
$cutoff
 = 
	`time
(è- 
$liã¥ª
;

41  
$cutoff
;

44  
FALSE
;

46 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_display.inc

1 <?
php


27 şas 
	cv›ws_¶ugš_di¥Ïy
 
ex‹nds
 
	mv›ws_¶ugš
 {

28 
v¬
 
	m$hªdËrs
 = 
¬¿y
();

30 
funùiÚ
 
	$š™
(&
$v›w
, &
$di¥Ïy
, 
$İtiÚs
 = 
NULL
) {

31 
$this
->
v›w
 = &
$v›w
;

32 
$this
->
di¥Ïy
 = &
$di¥Ïy
;

35 ià(!
	`is£t
(
$İtiÚs
)) {

36 
$İtiÚs
 = 
$di¥Ïy
->
di¥Ïy_İtiÚs
;

39 ià(
$this
->
	`is_deçuÉ_di¥Ïy
(è&& 
	`is£t
(
$İtiÚs
['defaults'])) {

40 
	`un£t
(
$İtiÚs
['defaults']);

43 
$this
->
	`uÅack_İtiÚs
($this->
İtiÚs
, 
$İtiÚs
);

46 
funùiÚ
 
	$de¡roy
() {

47 
·»Á
::
	`de¡roy
();

49 
	`fÜ—ch
 (
$this
->
hªdËrs
 
as
 
$ty³
 => 
$hªdËrs
) {

50 
	`fÜ—ch
 (
$hªdËrs
 
as
 
$id
 => 
$hªdËr
) {

51 ià(
	`is_objeù
(
$hªdËr
)) {

52 
$this
->
hªdËrs
[
$ty³
][
$id
]->
	`de¡roy
();

57 ià(
	`is£t
(
$this
->
deçuÉ_di¥Ïy
)) {

58 
	`un£t
(
$this
->
deçuÉ_di¥Ïy
);

60 
	}
}

66 
funùiÚ
 
	$is_deçuÉ_di¥Ïy
(è{  
FALSE
; 
	}
}

72 
funùiÚ
 
	$u£s_expo£d
() {

73 ià(!
	`is£t
(
$this
->
has_expo£d
)) {

74 
	`fÜ—ch
 (
	`¬¿y
('f›ld', 'f‹r'è
as
 
$ty³
) {

75 
	`fÜ—ch
 (
$this
->
v›w
->
$ty³
 
as
 
$key
 => 
$hªdËr
) {

76 ià(
$hªdËr
->
	`is_expo£d
()) {

78 
$this
->
has_expo£d
 = 
TRUE
;

79  
TRUE
;

83 
$this
->
has_expo£d
 = 
FALSE
;

86  
$this
->
has_expo£d
;

87 
	}
}

98 
funùiÚ
 
	$di¥Ïys_expo£d
() {

99  
TRUE
;

100 
	}
}

105 
funùiÚ
 
	$u£_ajax
() {

106 ià(!
	`em±y
(
$this
->
defš™iÚ
['use‡jax'])) {

107  
$this
->
	`g‘_İtiÚ
('use_ajax');

109  
FALSE
;

110 
	}
}

115 
funùiÚ
 
	$u£_·g”
() {

116 ià(!
	`em±y
(
$this
->
defš™iÚ
['use…ager'])) {

117  
$this
->
	`g‘_İtiÚ
('use_pager');

119  
FALSE
;

120 
	}
}

125 
funùiÚ
 
	$»nd”_·g”
() {

126  
$this
->
	`u£_·g”
();

127 
	}
}

132 
funùiÚ
 
	$u£_mÜe
() {

133 ià(!
	`em±y
(
$this
->
defš™iÚ
['use more'])) {

134  
$this
->
	`g‘_İtiÚ
('use_more');

136  
FALSE
;

137 
	}
}

142 
funùiÚ
 
	$u£_mÜe_®ways
() {

143 ià(!
	`em±y
(
$this
->
defš™iÚ
['use more'])) {

144  
$this
->
	`g‘_İtiÚ
('use_more_always');

146  
FALSE
;

147 
	}
}

152 
funùiÚ
 
	$u£_mÜe_‹xt
() {

153 ià(!
	`em±y
(
$this
->
defš™iÚ
['use more'])) {

154  
$this
->
	`g‘_İtiÚ
('use_more_text');

156  
FALSE
;

157 
	}
}

162 
funùiÚ
 
	$acû±_©chm’ts
() {

163  !
	`em±y
(
$this
->
defš™iÚ
['accept‡ttachments']);

164 
	}
}

169 
funùiÚ
 
	$©ch_to
(
$di¥Ïy_id
è{ 
	}
}

175 
funùiÚ
 
	$deçuÉabË_£ùiÚs
(
$£ùiÚ
 = 
NULL
) {

176 
$£ùiÚs
 = 
	`¬¿y
(

177 'acûss' => 
	`¬¿y
('access'),

178 'ÿche' => 
	`¬¿y
('cache'),

179 't™Ë' => 
	`¬¿y
('title'),

180 'css_şass' => 
	`¬¿y
('css_class'),

181 'h—d”' => 
	`¬¿y
('header', 'header_format', 'header_empty'),

182 'foÙ”' => 
	`¬¿y
('footer', 'footer_format', 'footer_empty'),

183 'em±y' => 
	`¬¿y
('empty', 'empty_format'),

184 'u£_ajax' => 
	`¬¿y
('use_ajax'),

185 '™ems_³r_·ge' => 
	`¬¿y
('items_per_page', 'offset', 'use_pager', 'pager_element'),

186 'u£_·g”' => 
	`¬¿y
('items_per_page', 'offset', 'use_pager', 'pager_element'),

187 'u£_mÜe' => 
	`¬¿y
('use_more', 'use_more_always', 'use_more_text'),

188 'lšk_di¥Ïy' => 
	`¬¿y
('link_display'),

189 'di¡šù' => 
	`¬¿y
('distinct'),

190 'expo£d_block' => 
	`¬¿y
('exposed_block'),

193 '¡yË_¶ugš' => 
	`¬¿y
('style_plugin', 'style_options', 'row_plugin', 'row_options'),

194 '¡yË_İtiÚs' => 
	`¬¿y
('style_plugin', 'style_options', 'row_plugin', 'row_options'),

195 'row_¶ugš' => 
	`¬¿y
('style_plugin', 'style_options', 'row_plugin', 'row_options'),

196 'row_İtiÚs' => 
	`¬¿y
('style_plugin', 'style_options', 'row_plugin', 'row_options'),

199 '»ÏtiÚshs' => 
	`¬¿y
('relationships'),

200 'f›lds' => 
	`¬¿y
('fields'),

201 'sÜts' => 
	`¬¿y
('sorts'),

202 '¬gum’ts' => 
	`¬¿y
('arguments'),

203 'f‹rs' => 
	`¬¿y
('filters'),

205 ià(
$£ùiÚ
) {

206 ià(!
	`em±y
(
$£ùiÚs
[
$£ùiÚ
])) {

207  
$£ùiÚs
[
$£ùiÚ
];

211  
$£ùiÚs
;

213 
	}
}

222 
funùiÚ
 
	$_£t_İtiÚ_deçuÉs
(&
$¡Üage
, 
$İtiÚs
, 
$Ëv–
 = 0) {

223 
	`fÜ—ch
 (
$İtiÚs
 
as
 
$İtiÚ
 => 
$defš™iÚ
) {

225 ià(
$Ëv–
 =ğ0 && !
$this
->
	`is_deçuÉ_di¥Ïy
(è&& !
	`em±y
(
$İtiÚs
['deçuÉs']['deçuÉ'][
$İtiÚ
])) {

229 ià(
	`is£t
(
$defš™iÚ
['cÚšs']è&& 
	`is_¬¿y
($definition['contains'])) {

230 
$¡Üage
[
$İtiÚ
] = 
	`¬¿y
();

231 
$this
->
	`_£t_İtiÚ_deçuÉs
(
$¡Üage
[
$İtiÚ
], 
$defš™iÚ
['cÚšs'], 
$Ëv–
++);

234 
$¡Üage
[
$İtiÚ
] = 
	`is£t
(
$defš™iÚ
['deçuÉ']è? $defš™iÚ['deçuÉ'] : 
NULL
;

237 
	}
}

239 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

240 
$İtiÚs
 = 
	`¬¿y
(

241 'deçuÉs' => 
	`¬¿y
(

242 'deçuÉ' => 
	`¬¿y
(

243 'acûss' => 
TRUE
,

244 'ÿche' => 
TRUE
,

245 't™Ë' => 
TRUE
,

246 'css_şass' => 
TRUE
,

247 'h—d”' => 
TRUE
,

248 'h—d”_fÜm©' => 
TRUE
,

249 'h—d”_em±y' => 
TRUE
,

250 'foÙ”' => 
TRUE
,

251 'foÙ”_fÜm©' => 
TRUE
,

252 'foÙ”_em±y' => 
TRUE
,

253 'em±y' => 
TRUE
,

254 'em±y_fÜm©' => 
TRUE
,

256 'u£_ajax' => 
TRUE
,

257 '™ems_³r_·ge' => 
TRUE
,

258 'off£t' => 
TRUE
,

259 'u£_·g”' => 
TRUE
,

260 '·g”_–em’t' => 
TRUE
,

261 'u£_mÜe' => 
TRUE
,

262 'u£_mÜe_®ways' => 
TRUE
,

263 'u£_mÜe_‹xt' => 
TRUE
,

264 'di¡šù' => 
TRUE
,

265 'expo£d_block' => 
TRUE
,

267 'lšk_di¥Ïy' => 
TRUE
,

269 '¡yË_¶ugš' => 
TRUE
,

270 '¡yË_İtiÚs' => 
TRUE
,

271 'row_¶ugš' => 
TRUE
,

272 'row_İtiÚs' => 
TRUE
,

274 '»ÏtiÚshs' => 
TRUE
,

275 'f›lds' => 
TRUE
,

276 'sÜts' => 
TRUE
,

277 '¬gum’ts' => 
TRUE
,

278 'f‹rs' => 
TRUE
,

281 '»ÏtiÚshs' => 
	`¬¿y
(

282 'deçuÉ' => 
	`¬¿y
(),

285 'f›lds' => 
	`¬¿y
(

286 'deçuÉ' => 
	`¬¿y
(),

289 'sÜts' => 
	`¬¿y
(

290 'deçuÉ' => 
	`¬¿y
(),

293 '¬gum’ts' => 
	`¬¿y
(

294 'deçuÉ' => 
	`¬¿y
(),

297 'f‹rs' => 
	`¬¿y
(

298 'deçuÉ' => 
	`¬¿y
(),

301 'acûss' => 
	`¬¿y
(

302 'cÚšs' => 
	`¬¿y
(

303 'ty³' => 
	`¬¿y
('default' => 'none'),

306 'ÿche' => 
	`¬¿y
(

307 'cÚšs' => 
	`¬¿y
(

308 'ty³' => 
	`¬¿y
('default' => 'none'),

311 't™Ë' => 
	`¬¿y
(

313 'Œª¦©abË' => 
TRUE
,

315 'css_şass' => 
	`¬¿y
(

317 'Œª¦©abË' => 
FALSE
,

319 'h—d”' => 
	`¬¿y
(

321 'Œª¦©abË' => 
TRUE
,

323 'h—d”_fÜm©' => 
	`¬¿y
(

324 'deçuÉ' => 
FILTER_FORMAT_DEFAULT
,

326 'h—d”_em±y' => 
	`¬¿y
(

327 'deçuÉ' => 
FALSE
,

329 'foÙ”' => 
	`¬¿y
(

331 'Œª¦©abË' => 
TRUE
,

333 'foÙ”_fÜm©' => 
	`¬¿y
(

334 'deçuÉ' => 
FILTER_FORMAT_DEFAULT
,

336 'foÙ”_em±y' => 
	`¬¿y
(

337 'deçuÉ' => 
FALSE
,

339 'em±y' => 
	`¬¿y
(

341 'Œª¦©abË' => 
TRUE
,

343 'em±y_fÜm©' => 
	`¬¿y
(

344 'deçuÉ' => 
FILTER_FORMAT_DEFAULT
,

346 'u£_ajax' => 
	`¬¿y
(

347 'deçuÉ' => 
FALSE
,

349 '™ems_³r_·ge' => 
	`¬¿y
(

352 'off£t' => 
	`¬¿y
(

355 'u£_·g”' => 
	`¬¿y
(

356 'deçuÉ' => 
FALSE
,

358 '·g”_–em’t' => 
	`¬¿y
(

361 'u£_mÜe' => 
	`¬¿y
(

362 'deçuÉ' => 
FALSE
,

364 'u£_mÜe_®ways' => 
	`¬¿y
(

365 'deçuÉ' => 
FALSE
,

367 'u£_mÜe_‹xt' => 
	`¬¿y
(

369 'Œª¦©abË' => 
TRUE
,

371 'lšk_di¥Ïy' => 
	`¬¿y
(

374 'di¡šù' => 
	`¬¿y
(

375 'deçuÉ' => 
FALSE
,

378 '¡yË_¶ugš' => 
	`¬¿y
(

381 '¡yË_İtiÚs' => 
	`¬¿y
(

382 'deçuÉ' => 
	`¬¿y
(),

384 'row_¶ugš' => 
	`¬¿y
(

387 'row_İtiÚs' => 
	`¬¿y
(

388 'deçuÉ' => 
	`¬¿y
(),

391 'expo£d_block' => 
	`¬¿y
(

392 'deçuÉ' => 
FALSE
,

396 ià(
$this
->
	`is_deçuÉ_di¥Ïy
()) {

397 
	`un£t
(
$İtiÚs
['defaults']);

399  
$İtiÚs
;

400 
	}
}

411 
funùiÚ
 
	$has_·th
(è{  
FALSE
; 
	}
}

420 
funùiÚ
 
	$u£s_lšk_di¥Ïy
(è{  !
$this
->
	`has_·th
(); 
	}
}

426 
funùiÚ
 
	$g‘_lšk_di¥Ïy
() {

427 
$di¥Ïy_id
 = 
$this
->
	`g‘_İtiÚ
('link_display');

429 ià(
	`em±y
(
$di¥Ïy_id
è||ƒm±y(
$this
->
v›w
->
di¥Ïy
[$display_id])) {

430 
	`fÜ—ch
 (
$this
->
v›w
->
di¥Ïy
 
as
 
$di¥Ïy_id
 => 
$di¥Ïy
) {

431 ià(!
	`em±y
(
$di¥Ïy
->
hªdËr
è&& $di¥Ïy->hªdËr->
	`has_·th
()) {

432  
$di¥Ïy_id
;

437  
$di¥Ïy_id
;

440 
	}
}

448 
funùiÚ
 
	$g‘_·th
() {

449 ià(
$this
->
	`has_·th
()) {

450  
$this
->
	`g‘_İtiÚ
('path');

453 
$di¥Ïy_id
 = 
$this
->
	`g‘_lšk_di¥Ïy
();

454 ià(
$di¥Ïy_id
 && !
	`em±y
(
$this
->
v›w
->
di¥Ïy
[$di¥Ïy_id]è&& 
	`is_objeù
($this->v›w->di¥Ïy[$di¥Ïy_id]->
hªdËr
)) {

455  
$this
->
v›w
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
->
	`g‘_·th
();

457 
	}
}

464 
funùiÚ
 
	$u£s_b»adüumb
(è{  
FALSE
; 
	}
}

473 
funùiÚ
 
	$is_deçuÉed
(
$İtiÚ
) {

474  !
$this
->
	`is_deçuÉ_di¥Ïy
(è&& !
	`em±y
($this->
deçuÉ_di¥Ïy
è&& !em±y($this->
İtiÚs
['deçuÉs'][
$İtiÚ
]);

475 
	}
}

481 
funùiÚ
 
	$g‘_İtiÚ
(
$İtiÚ
) {

482 ià(
$this
->
	`is_deçuÉed
(
$İtiÚ
)) {

483  
$this
->
deçuÉ_di¥Ïy
->
	`g‘_İtiÚ
(
$İtiÚ
);

486 ià(
	`¬¿y_key_exi¡s
(
$İtiÚ
, 
$this
->
İtiÚs
)) {

487  
$this
->
İtiÚs
[
$İtiÚ
];

489 
	}
}

494 
funùiÚ
 
	$u£s_f›lds
() {

495 
$¶ugš
 = 
$this
->
	`g‘_¶ugš
();

496 ià(
$¶ugš
) {

497  
$¶ugš
->
	`u£s_f›lds
();

499 
	}
}

504 
funùiÚ
 
g‘_¶ugš
(
$ty³
 = '¡yË', 
$Çme
 = 
NULL
) {

505 ià(!
$Çme
) {

506 
$Çme
 = 
$this
->
g‘_İtiÚ
(
$ty³
 . '_plugin');

509 
	g$¶ugš
 = 
v›ws_g‘_¶ugš
(
$ty³
, 
$Çme
);

510 ià(
	g$¶ugš
) {

511 
	g$İtiÚs
 = 
$this
->
g‘_İtiÚ
(
$ty³
 . '_options');

512 
	g$¶ugš
->
š™
(
$this
->
v›w
, $this->
di¥Ïy
, 
$İtiÚs
);

513  
	g$¶ugš
;

520 
funùiÚ
 
	$g‘_acûss_¶ugš
(
$Çme
 = 
NULL
) {

521 ià(!
$Çme
) {

522 
$acûss
 = 
$this
->
	`g‘_İtiÚ
('access');

523 
$Çme
 = 
$acûss
['type'];

526 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('acûss', 
$Çme
);

527 ià(
$¶ugš
) {

528 
$¶ugš
->
	`š™
(
$this
->
v›w
, $this->
di¥Ïy
);

529  
$¶ugš
;

531 
	}
}

536 
funùiÚ
 
	$g‘_ÿche_¶ugš
(
$Çme
 = 
NULL
) {

537 ià(!
$Çme
) {

538 
$ÿche
 = 
$this
->
	`g‘_İtiÚ
('cache');

539 
$Çme
 = 
$ÿche
['type'];

542 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('ÿche', 
$Çme
);

543 ià(
$¶ugš
) {

544 
$¶ugš
->
	`š™
(
$this
->
v›w
, $this->
di¥Ïy
);

545  
$¶ugš
;

547 
	}
}

552 
	gfunùiÚ
 &
	$g‘_hªdËr
(
$ty³
, 
$id
) {

553 ià(!
	`is£t
(
$this
->
hªdËrs
[
$ty³
])) {

554 
$this
->
	`g‘_hªdËrs
(
$ty³
);

557 ià(
	`is£t
(
$this
->
hªdËrs
[
$ty³
][
$id
])) {

558  
$this
->
hªdËrs
[
$ty³
][
$id
];

562 
$nuÎ
 = 
NULL
;

563  
$nuÎ
;

564 
	}
}

569 
funùiÚ
 
	$g‘_hªdËrs
(
$ty³
) {

570 ià(!
	`is£t
(
$this
->
hªdËrs
[
$ty³
])) {

571 
$this
->
hªdËrs
[
$ty³
] = 
	`¬¿y
();

572 
$ty³s
 = 
	`v›ws_objeù_ty³s
();

573 
$¶u¿l
 = 
$ty³s
[
$ty³
]['plural'];

574 
	`fÜ—ch
 (
$this
->
	`g‘_İtiÚ
(
$¶u¿l
è
as
 
$id
 => 
$šfo
) {

575 ià(
$šfo
['id'] !ğ
$id
) {

576 
$šfo
['id'] = 
$id
;

579 
$hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$šfo
['bË'], $šfo['f›ld'], 
$ty³
);

580 ià(
$hªdËr
) {

581 
$hªdËr
->
	`š™
(
$this
->
v›w
, 
$šfo
);

582 
$this
->
hªdËrs
[
$ty³
][
$id
] = &
$hªdËr
;

586 
	`un£t
(
$hªdËr
);

590  
$this
->
hªdËrs
[
$ty³
];

591 
	}
}

597 
funùiÚ
 
	$g‘_f›ld_Ïb–s
() {

598 
$İtiÚs
 = 
	`¬¿y
();

599 
	`fÜ—ch
 (
$this
->
	`g‘_hªdËrs
('»ÏtiÚsh'è
as
 
$»ÏtiÚsh
 => 
$hªdËr
) {

600 ià(
$Ïb–
 = 
$hªdËr
->
	`Ïb–
()) {

601 
$»ÏtiÚshs
[
$»ÏtiÚsh
] = 
$Ïb–
;

604 
$»ÏtiÚshs
[
$»ÏtiÚsh
] = 
$hªdËr
->
	`ui_Çme
();

608 
	`fÜ—ch
 (
$this
->
	`g‘_hªdËrs
('f›ld'è
as
 
$id
 => 
$hªdËr
) {

609 ià(
$Ïb–
 = 
$hªdËr
->
	`Ïb–
()) {

610 
$İtiÚs
[
$id
] = 
$Ïb–
;

613 
$İtiÚs
[
$id
] = 
$hªdËr
->
	`ui_Çme
();

615 ià(!
	`em±y
(
$hªdËr
->
İtiÚs
['»ÏtiÚsh']è&& !em±y(
$»ÏtiÚshs
[$handler->options['relationship']])) {

616 
$İtiÚs
[
$id
] = '(' . 
$»ÏtiÚshs
[
$hªdËr
->
İtiÚs
['relationship']] . ') ' . $options[$id];

619  
$İtiÚs
;

620 
	}
}

626 
funùiÚ
 
	$£t_İtiÚ
(
$İtiÚ
, 
$v®ue
) {

627 ià(
$this
->
	`is_deçuÉed
(
$İtiÚ
)) {

628  
$this
->
deçuÉ_di¥Ïy
->
	`£t_İtiÚ
(
$İtiÚ
, 
$v®ue
);

634 
$this
->
di¥Ïy
->
di¥Ïy_İtiÚs
[
$İtiÚ
] = 
$v®ue
;

635  
$this
->
İtiÚs
[
$İtiÚ
] = 
$v®ue
;

636 
	}
}

641 
funùiÚ
 
	$ov”ride_İtiÚ
(
$İtiÚ
, 
$v®ue
) {

642 
$this
->
	`£t_ov”ride
(
$İtiÚ
, 
FALSE
);

643 
$this
->
	`£t_İtiÚ
(
$İtiÚ
, 
$v®ue
);

644 
	}
}

650 
funùiÚ
 
İtiÚ_lšk
(
$‹xt
, 
$£ùiÚ
, 
$şass
 = '', 
$t™Ë
 = '') {

651 ià(!
em±y
(
$şass
)) {

652 
$‹xt
 = '<span>' . $text . '</span>';

655 ià(!
Œim
(
$‹xt
)) {

656 
	g$‹xt
 = 
t
('Broken field');

659 ià(
em±y
(
$t™Ë
)) {

660 
	g$t™Ë
 = 
$‹xt
;

663  
l
(
$‹xt
, 'admš/bud/v›ws/nojs/di¥Ïy/' . 
$this
->
v›w
->
Çme
 . '/' . $this->
di¥Ïy
->
id
 . '/' . 
$£ùiÚ
, 
¬¿y
('©Œibu‹s' =>‡¼ay('şass' => 'v›ws-ajax-lšk ' . 
$şass
, 't™Ë' => 
$t™Ë
), 'html' => 
TRUE
));

671 
funùiÚ
 
	$İtiÚs_summ¬y
(&
$ÿ‹gÜ›s
, &
$İtiÚs
) {

672 
$ÿ‹gÜ›s
['basic'] = 
	`¬¿y
(

673 't™Ë' => 
	`t
('Basic settings'),

676 
$İtiÚs
['di¥Ïy_t™Ë'] = 
	`¬¿y
(

678 't™Ë' => 
	`t
('Name'),

679 'v®ue' => 
	`check_¶aš
(
$this
->
di¥Ïy
->
di¥Ïy_t™Ë
),

680 'desc' => 
	`t
('Changehe‚ame ofhis display.'),

683 
$t™Ë
 = 
	`¡r_gs
(
$this
->
	`g‘_İtiÚ
('title'));

684 ià(!
$t™Ë
) {

685 
$t™Ë
 = 
	`t
('None');

688 
$İtiÚs
['t™Ë'] = 
	`¬¿y
(

690 't™Ë' => 
	`t
('Title'),

691 'v®ue' => 
$t™Ë
,

692 'desc' => 
	`t
('Changeheitlehathis display will use.'),

695 
$¡yË_¶ugš
 = 
	`v›ws_ãtch_¶ugš_d©a
('¡yË', 
$this
->
	`g‘_İtiÚ
('style_plugin'));

696 
$¡yË_t™Ë
 = 
	`em±y
(
$¡yË_¶ugš
['t™Ë']è? 
	`t
('Missing style…lugin') : $style_plugin['title'];

698 
$¡yË
 = '';

700 
$İtiÚs
['¡yË_¶ugš'] = 
	`¬¿y
(

702 't™Ë' => 
	`t
('Style'),

703 'v®ue' => 
$¡yË_t™Ë
,

704 'desc' => 
	`t
('Changehe style…lugin.'),

708 ià(!
	`em±y
(
$¡yË_¶ugš
['uses options'])) {

709 
$İtiÚs
['¡yË_¶ugš']['lšks']['¡yË_İtiÚs'] = 
	`t
('Change settings forhis style');

712 ià(!
	`em±y
(
$¡yË_¶ugš
['uses„ow…lugin'])) {

713 
$row_¶ugš
 = 
	`v›ws_ãtch_¶ugš_d©a
('row', 
$this
->
	`g‘_İtiÚ
('row_plugin'));

714 
$row_t™Ë
 = 
	`em±y
(
$row_¶ugš
['t™Ë']è? 
	`t
('Missing style…lugin') : $row_plugin['title'];

716 
$İtiÚs
['row_¶ugš'] = 
	`¬¿y
(

718 't™Ë' => 
	`t
('Row style'),

719 'v®ue' => 
$row_t™Ë
,

720 'desc' => 
	`t
('Changehe„ow…lugin.'),

723 ià(!
	`em±y
(
$row_¶ugš
['uses options'])) {

724 
$İtiÚs
['row_¶ugš']['lšks']['row_İtiÚs'] = 
	`t
('Change settings forhis style');

727 ià(!
	`em±y
(
$this
->
defš™iÚ
['use‡jax'])) {

728 
$İtiÚs
['u£_ajax'] = 
	`¬¿y
(

730 't™Ë' => 
	`t
('Use AJAX'),

731 'v®ue' => 
$this
->
	`g‘_İtiÚ
('u£_ajax'è? 
	`t
('Yes') :('No'),

732 'desc' => 
	`t
('Change whether or‚othis display will use AJAX.'),

736 ià(!
	`em±y
(
$this
->
defš™iÚ
['use…ager'])) {

737 
$İtiÚs
['u£_·g”'] = 
	`¬¿y
(

739 't™Ë' => 
	`t
('Use…ager'),

740 'v®ue' => 
$this
->
	`g‘_İtiÚ
('u£_·g”'è? ($this->g‘_İtiÚ('u£_·g”'è==ğ'mši' ? 
	`t
('Mini') :('Yes')) :('No'),

741 'desc' => 
	`t
("Changehis display's…ager setting."),

745 
$™ems
 = 
	`štv®
(
$this
->
	`g‘_İtiÚ
('items_per_page'));

746 
$İtiÚs
['™ems_³r_·ge'] = 
	`¬¿y
(

748 't™Ë' => 
$this
->
	`u£_·g”
(è? 
	`t
('Items…er…age') :('Itemso display'),

749 'v®ue' => 
$™ems
 ? $™em : 
	`t
('Unlimited'),

750 'desc' => 
	`t
('Change how many itemso display.'),

753 ià(!
	`em±y
(
$this
->
defš™iÚ
['use more'])) {

754 
$İtiÚs
['u£_mÜe'] = 
	`¬¿y
(

756 't™Ë' => 
	`t
('More†ink'),

757 'v®ue' => 
$this
->
	`g‘_İtiÚ
('u£_mÜe'è? 
	`t
('Yes') :('No'),

758 'desc' => 
	`t
('Specify whetherhis display will…rovide‡ "more"†ink.'),

762 
$İtiÚs
['di¡šù'] = 
	`¬¿y
(

764 't™Ë' => 
	`t
('Distinct'),

765 'v®ue' => 
$this
->
	`g‘_İtiÚ
('di¡šù'è? 
	`t
('Yes') :('No'),

766 'desc' => 
	`t
('Display only distinct items, without duplicates.'),

769 
$acûss_¶ugš
 = 
$this
->
	`g‘_acûss_¶ugš
();

770 ià(!
$acûss_¶ugš
) {

772 
$acûss_¶ugš
 = 
	`v›ws_g‘_¶ugš
('access', 'none');

775 
$acûss_¡r
 = 
$acûss_¶ugš
->
	`summ¬y_t™Ë
();

777 
$İtiÚs
['acûss'] = 
	`¬¿y
(

779 't™Ë' => 
	`t
('Access'),

780 'v®ue' => 
$acûss_¡r
,

781 'desc' => 
	`t
('Specify‡ccess controlype forhis display.'),

784 ià(!
	`em±y
(
$acûss_¶ugš
->
defš™iÚ
['uses options'])) {

785 
$İtiÚs
['acûss']['lšks']['acûss_İtiÚs'] = 
	`t
('Change settings forhis‡ccessype.');

788 
$ÿche_¶ugš
 = 
$this
->
	`g‘_ÿche_¶ugš
();

789 ià(!
$ÿche_¶ugš
) {

791 
$ÿche_¶ugš
 = 
	`v›ws_g‘_¶ugš
('cache', 'none');

794 
$ÿche_¡r
 = 
$ÿche_¶ugš
->
	`summ¬y_t™Ë
();

796 
$İtiÚs
['ÿche'] = 
	`¬¿y
(

798 't™Ë' => 
	`t
('Caching'),

799 'v®ue' => 
$ÿche_¡r
,

800 'desc' => 
	`t
('Specify cachingype forhis display.'),

803 ià(!
	`em±y
(
$ÿche_¶ugš
->
defš™iÚ
['uses options'])) {

804 
$İtiÚs
['ÿche']['lšks']['ÿche_İtiÚs'] = 
	`t
('Change settings forhis cachingype.');

807 ià(
$this
->
	`u£s_lšk_di¥Ïy
()) {

809 
$couÁ
 = 0;

810 
	`fÜ—ch
 (
$this
->
v›w
->
di¥Ïy
 
as
 
$di¥Ïy_id
 => 
$di¥Ïy
) {

811 ià(
	`is_objeù
(
$di¥Ïy
->
hªdËr
è&& $di¥Ïy->hªdËr->
	`has_·th
()) {

812 
$couÁ
++;

814 ià(
$couÁ
 > 1) {

819 ià(
$couÁ
 > 1) {

820 
$di¥Ïy_id
 = 
$this
->
	`g‘_lšk_di¥Ïy
();

821 
$lšk_di¥Ïy
 = 
	`em±y
(
$this
->
v›w
->
di¥Ïy
[
$di¥Ïy_id
]è? 
	`t
('NÚe'è: 
	`check_¶aš
($this->v›w->di¥Ïy[$di¥Ïy_id]->
di¥Ïy_t™Ë
);

822 
$İtiÚs
['lšk_di¥Ïy'] = 
	`¬¿y
(

824 't™Ë' => 
	`t
('Link display'),

825 'v®ue' => 
$lšk_di¥Ïy
,

826 'desc' => 
	`t
('Specify which displayhis display will†inko.'),

831 
$İtiÚs
['expo£d_block'] = 
	`¬¿y
(

833 't™Ë' => 
	`t
('Exposed form in block'),

834 'v®ue' => 
$this
->
	`g‘_İtiÚ
('expo£d_block'è? 
	`t
('Yes') :('No'),

835 'desc' => 
	`t
('Allowheƒxposed formo‡ppear in‡ block instead ofhe view.'),

838 
	`fÜ—ch
 (
	`¬¿y
('h—d”' => 
	`t
('H—d”'), 'foÙ”' =>('FoÙ”'), 'em±y' =>('Em±yext')è
as
 
$ty³
 => 
$Çme
) {

839 ià(!
$this
->
	`g‘_İtiÚ
(
$ty³
)) {

840 
$f›ld
 = 
	`t
('None');

844 
$fmt_¡ršg
 = 
$this
->
	`g‘_İtiÚ
(
$ty³
 . '_format');

845 ià(
	`em±y
(
$fmt_¡ršg
)) {

846 
$fmt_¡ršg
 = 
FILTER_FORMAT_DEFAULT
;

848 
$fÜm©_v®
 = 
	`f‹r_»sŞve_fÜm©
(
$fmt_¡ršg
);

849 
$fÜm©
 = 
	`f‹r_fÜm©s
(
$fÜm©_v®
);

850 ià(
$fÜm©
) {

851 
$f›ld
 = 
	`check_¶aš
(
$fÜm©
->
Çme
);

854 
$f›ld
 = 
	`t
('Unknown/missing format');

858 
$İtiÚs
[
$ty³
] = 
	`¬¿y
(

860 't™Ë' => 
$Çme
,

861 'v®ue' => 
$f›ld
,

862 'desc' => 
	`t
("Chªgthi di¥Ïy' !Çme.", 
	`¬¿y
('!Çme' => 
	`¡¹Şow”
(
$Çme
))),

866 
$css_şass
 = 
	`check_¶aš
(
	`Œim
(
$this
->
	`g‘_İtiÚ
('css_class')));

867 ià(!
$css_şass
) {

868 
$css_şass
 = 
	`t
('None');

871 
$İtiÚs
['css_şass'] = 
	`¬¿y
(

873 't™Ë' => 
	`t
('CSS class'),

874 'v®ue' => 
$css_şass
,

875 'desc' => 
	`t
('Changehe CSS class‚ame(s)hat will be‡ddedohis display.'),

878 
$İtiÚs
['ª®yze-theme'] = 
	`¬¿y
(

880 't™Ë' => 
	`t
('Theme'),

881 'v®ue' => 
	`t
('Information'),

882 'desc' => 
	`t
('Get information on howohemehis display'),

884 
	}
}

889 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

890 ià(
$this
->
	`deçuÉabË_£ùiÚs
(
$fÜm_¡©e
['section'])) {

891 
$this
->
	`add_ov”ride_bu‰Ú
(
$fÜm
, 
$fÜm_¡©e
, $form_state['section']);

893 
$fÜm
['#t™Ë'] = 
	`check_¶aš
(
$this
->
di¥Ïy
->
di¥Ïy_t™Ë
) . ': ';

899 ià(!
	`em±y
(
$this
->
İtiÚs
['deçuÉs'][
$fÜm_¡©e
['section']])) {

900 
$fÜm
['#£ùiÚ'] = 'deçuÉ-' . 
$fÜm_¡©e
['section'];

903 
$fÜm
['#£ùiÚ'] = 
$this
->
di¥Ïy
->
id
 . '-' . 
$fÜm_¡©e
['section'];

906 
$fÜm_¡©e
['section']) {

908 
$fÜm
['#t™Ë'] .ğ
	`t
('The‚ame ofhis display');

909 
$fÜm
['di¥Ïy_t™Ë'] = 
	`¬¿y
(

911 '#desütiÚ' => 
	`t
('Thisitle will‡ppear only inhe‡dministrative interface forhe View.'),

912 '#deçuÉ_v®ue' => 
$this
->
di¥Ïy
->
di¥Ïy_t™Ë
,

916 
$fÜm
['#t™Ë'] .ğ
	`t
('Theitle ofhis view');

917 
$fÜm
['t™Ë'] = 
	`¬¿y
(

919 '#desütiÚ' => 
	`t
('Thisitle will be displayed withhe view, whereveritles‡re‚ormally displayed; i.e,‡she…ageitle, blockitle,ƒtc.'),

920 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('title'),

924 
$fÜm
['#t™Ë'] .ğ
	`t
('CSS class');

925 
$fÜm
['css_şass'] = 
	`¬¿y
(

927 '#desütiÚ' => 
	`t
('The CSS class‚ames will be‡ddedohe view. Thisƒnables youo use specific CSS code forƒach view. You may define multiples classes separated by spaces.'),

928 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('css_class'),

932 
$fÜm
['#t™Ë'] .ğ
	`t
('Use AJAX when‡vailableo†oadhis view');

933 
$fÜm
['desütiÚ'] = 
	`¬¿y
(

936 '#v®ue' => 
	`t
('If set,his view will use‡n AJAX mechanism for…aging,able sorting‡ndƒxposed filters. This meansheƒntire…age will‚ot„efresh. It is‚ot„ecommendedhat you usehis ifhis view ishe main content ofhe…age‡s it will…revent deep†inkingo specific…ages, but it is very useful for side content.'),

938 
$fÜm
['u£_ajax'] = 
	`¬¿y
(

940 '#İtiÚs' => 
	`¬¿y
(1 => 
	`t
('Yes'), 0 =>('No')),

941 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('use_ajax') ? 1 : 0,

945 
$fÜm
['#t™Ë'] .ğ
	`t
('Use‡…ager forhis view');

946 
$fÜm
['u£_·g”'] = 
	`¬¿y
(

948 '#İtiÚs' => 
	`¬¿y
(
TRUE
 => 
	`t
('Full…ager'), 'mini' =>('Mini…ager'), 0 =>('No')),

949 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('use_pager'),

951 
$fÜm
['·g”_–em’t'] = 
	`¬¿y
(

953 '#t™Ë' => 
	`t
('Pagerƒlement'),

954 '#desütiÚ' => 
	`t
("Unless you'reƒxperiencing…roblems with…agers„elatedohis view, you should†eavehis‡t 0. If using multiple…agers on one…age you may‚eedo sethis‚umbero‡ higher value so‡s‚oto conflict withinhe ?page=‡rray. Large values will‡dd‡†ot of commaso your URLs, so‡void if…ossible."),

955 '#deçuÉ_v®ue' => 
	`štv®
(
$this
->
	`g‘_İtiÚ
('pager_element')),

959 
$fÜm
['#t™Ë'] .ğ
$this
->
	`u£_·g”
(è? 
	`t
('Items…er…age') :('Itemso display');

961 
$fÜm
['™ems_³r_·ge'] = 
	`¬¿y
(

963 '#desütiÚ' => 
	`t
('The‚umber of itemso display…er…age. Enter 0 for‚o†imit.'),

964 '#deçuÉ_v®ue' => 
	`štv®
(
$this
->
	`g‘_İtiÚ
('items_per_page')),

966 
$fÜm
['off£t'] = 
	`¬¿y
(

968 '#t™Ë' => 
	`t
('Offset'),

969 '#desütiÚ' => 
	`t
('The‚umber of itemso skip. Forƒxample, ifhis field is 3,he first 3 items will be skipped‡nd‚ot displayed. Offset can‚ot be used if itemso display is 0; instead use‡ very†arge‚umberhere.'),

970 '#deçuÉ_v®ue' => 
	`štv®
(
$this
->
	`g‘_İtiÚ
('offset')),

974 
$fÜm
['#t™Ë'] .ğ
	`t
('Add‡ more†inkohe bottom ofhe display.');

975 
$fÜm
['u£_mÜe'] = 
	`¬¿y
(

977 '#t™Ë' => 
	`t
('Create more†ink'),

978 '#desütiÚ' => 
	`t
("This will‡dd‡ more†inkohe bottom ofhis view, which will†inkohe…age view. If you have morehan one…age view,he†ink will…ointohe display specified in 'Link display'‡bove."),

979 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('use_more'),

981 
$fÜm
['u£_mÜe_®ways'] = 
	`¬¿y
(

983 '#t™Ë' => 
	`t
('Always display more†ink'),

984 '#desütiÚ' => 
	`t
("This will displayhe more†inkƒven ifhere‡re‚o more itemso display."),

985 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('use_more_always'),

987 
$fÜm
['#t™Ë'] .ğ
	`t
('Texto use forhe more†ink.');

988 
$fÜm
['u£_mÜe_‹xt'] = 
	`¬¿y
(

990 '#t™Ë' => 
	`t
('More†inkext'),

991 '#desütiÚ' => 
	`t
("Theexto display forhe more†ink."),

992 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('use_more_text'),

996 
$fÜm
['#t™Ë'] .ğ
	`t
('Display only distinct items, without duplicates.');

997 
$fÜm
['di¡šù'] = 
	`¬¿y
(

999 '#t™Ë' => 
	`t
('Distinct'),

1000 '#desütiÚ' => 
	`t
('This will makehe view display only distinct items. Ifhere‡re multiple identical items,ƒach will be displayed only once. You can usehisory‡nd„emove duplicates from‡ view,hough it does‚ot‡lways work. Notehathis can slow queries down, so use it with caution.'),

1001 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('distinct'),

1005 
$fÜm
['#t™Ë'] .ğ
	`t
('Access„estrictions');

1006 
$fÜm
['acûss'] = 
	`¬¿y
(

1009 '#Œ“' => 
TRUE
,

1012 
$acûss
 = 
$this
->
	`g‘_İtiÚ
('access');

1013 
$fÜm
['acûss']['ty³'] = 
	`¬¿y
(

1015 '#İtiÚs' => 
	`v›ws_ãtch_¶ugš_Çmes
('access'),

1016 '#deçuÉ_v®ue' => 
$acûss
['type'],

1019 
$acûss_¶ugš
 = 
	`v›ws_ãtch_¶ugš_d©a
('acûss', 
$acûss
['type']);

1020 ià(!
	`em±y
(
$acûss_¶ugš
['uses options'])) {

1021 
$fÜm
['m¬kup'] = 
	`¬¿y
(

1024 '#v®ue' => 
	`t
('You may‡lsØadju¡h!£‰šg fÜhcu¼’y s–eùed‡cûs »¡riùiÚ by clickšg oÀthicÚ.', 
	`¬¿y
('!£‰šgs' => 
$this
->
	`İtiÚ_lšk
(t('settings'), 'access_options'))),

1030 
$acûss
 = 
$this
->
	`g‘_İtiÚ
('access');

1031 
$¶ugš
 = 
$this
->
	`g‘_acûss_¶ugš
();

1032 
$fÜm
['#t™Ë'] .ğ
	`t
('Access options');

1033 ià(
$¶ugš
) {

1034 
$fÜm
['#h–p_tİic'] = 
$¶ugš
->
defš™iÚ
['helpopic'];

1035 
$fÜm
['#h–p_moduË'] = 
$¶ugš
->
defš™iÚ
['module'];

1037 
$fÜm
['acûss_İtiÚs'] = 
	`¬¿y
(

1038 '#Œ“' => 
TRUE
,

1040 
$fÜm
['acûss_İtiÚs']['ty³'] = 
	`¬¿y
(

1042 '#v®ue' => 
$acûss
['type'],

1044 
$¶ugš
->
	`İtiÚs_fÜm
(
$fÜm
['acûss_İtiÚs'], 
$fÜm_¡©e
);

1048 
$fÜm
['#t™Ë'] .ğ
	`t
('Caching');

1049 
$fÜm
['ÿche'] = 
	`¬¿y
(

1052 '#Œ“' => 
TRUE
,

1055 
$ÿche
 = 
$this
->
	`g‘_İtiÚ
('cache');

1056 
$fÜm
['ÿche']['ty³'] = 
	`¬¿y
(

1058 '#İtiÚs' => 
	`v›ws_ãtch_¶ugš_Çmes
('cache'),

1059 '#deçuÉ_v®ue' => 
$ÿche
['type'],

1062 
$ÿche_¶ugš
 = 
	`v›ws_ãtch_¶ugš_d©a
('ÿche', 
$ÿche
['type']);

1063 ià(!
	`em±y
(
$ÿche_¶ugš
['uses options'])) {

1064 
$fÜm
['m¬kup'] = 
	`¬¿y
(

1067 '#v®ue' => 
	`t
('You may‡lsØadju¡h!£‰šg fÜhcu¼’y s–eùed cachmechªism by clickšg oÀthicÚ.', 
	`¬¿y
('!£‰šgs' => 
$this
->
	`İtiÚ_lšk
(t('settings'), 'cache_options'))),

1072 
$ÿche
 = 
$this
->
	`g‘_İtiÚ
('cache');

1073 
$¶ugš
 = 
$this
->
	`g‘_ÿche_¶ugš
();

1074 
$fÜm
['#t™Ë'] .ğ
	`t
('Caching options');

1075 ià(
$¶ugš
) {

1076 
$fÜm
['#h–p_tİic'] = 
$¶ugš
->
defš™iÚ
['helpopic'];

1077 
$fÜm
['#h–p_moduË'] = 
$¶ugš
->
defš™iÚ
['module'];

1079 
$fÜm
['ÿche_İtiÚs'] = 
	`¬¿y
(

1080 '#Œ“' => 
TRUE
,

1082 
$fÜm
['ÿche_İtiÚs']['ty³'] = 
	`¬¿y
(

1084 '#v®ue' => 
$ÿche
['type'],

1086 
$¶ugš
->
	`İtiÚs_fÜm
(
$fÜm
['ÿche_İtiÚs'], 
$fÜm_¡©e
);

1090 
$fÜm
['#t™Ë'] .ğ
	`t
('Header');

1091 
$fÜm
['h—d”_em±y'] = 
	`¬¿y
(

1093 '#t™Ë' => 
	`t
('Displayƒven if view has‚o„esult'),

1094 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('header_empty'),

1096 
$fÜm
['h—d”'] = 
	`¬¿y
(

1098 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('header'),

1100 '#desütiÚ' => 
	`t
('Texto display‡theop ofhe view. May contain‡nƒxplanation or†inks or whatever you†ike. Optional.'),

1103 
$fÜm
['h—d”_fÜm©'] = 
	`f‹r_fÜm
(
$this
->
	`g‘_İtiÚ
('h—d”_fÜm©'), 
NULL
, 
	`¬¿y
('header_format'));

1106 
$fÜm
['#t™Ë'] .ğ
	`t
('Footer');

1107 
$fÜm
['foÙ”_em±y'] = 
	`¬¿y
(

1109 '#t™Ë' => 
	`t
('Displayƒven if view has‚o„esult'),

1110 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('footer_empty'),

1112 
$fÜm
['foÙ”'] = 
	`¬¿y
(

1114 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('footer'),

1116 '#desütiÚ' => 
	`t
('Texto display beneathhe view. May contain‡nƒxplanation or†inks or whatever you†ike. Optional.'),

1119 
$fÜm
['foÙ”_fÜm©'] = 
	`f‹r_fÜm
(
$this
->
	`g‘_İtiÚ
('foÙ”_fÜm©'), 
NULL
, 
	`¬¿y
('footer_format'));

1122 
$fÜm
['#t™Ë'] .ğ
	`t
('Emptyext');

1123 
$fÜm
['em±y'] = 
	`¬¿y
(

1125 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('empty'),

1127 '#desütiÚ' => 
	`t
('Texto display ifhe view has‚o„esults. Optional.'),

1130 
$fÜm
['em±y_fÜm©'] = 
	`f‹r_fÜm
(
$this
->
	`g‘_İtiÚ
('em±y_fÜm©'), 
NULL
, 
	`¬¿y
('empty_format'));

1133 
$fÜm
['#t™Ë'] .ğ
	`t
('How shouldhis view be styled');

1134 
$fÜm
['#help_topic'] = 'style';

1135 
$fÜm
['¡yË_¶ugš'] = 
	`¬¿y
(

1137 '#İtiÚs' => 
	`v›ws_ãtch_¶ugš_Çmes
('¡yË', 
$this
->
	`g‘_¡yË_ty³
(), 
	`¬¿y
($this->
v›w
->
ba£_bË
)),

1138 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('style_plugin'),

1139 '#desütiÚ' => 
	`t
('Ifhe style you choose has settings, be sureo clickhe settings buttonhat will‡ppear‚exto it inhe View summary.'),

1142 
$¡yË_¶ugš
 = 
	`v›ws_ãtch_¶ugš_d©a
('¡yË', 
$this
->
	`g‘_İtiÚ
('style_plugin'));

1143 ià(!
	`em±y
(
$¡yË_¶ugš
['uses options'])) {

1144 
$fÜm
['m¬kup'] = 
	`¬¿y
(

1147 '#v®ue' => 
	`t
('You may‡lsØadju¡h!£‰šg fÜhcu¼’y s–eùed styË by clickšg oÀthicÚ.', 
	`¬¿y
('!£‰šgs' => 
$this
->
	`İtiÚ_lšk
(t('settings'), 'style_options'))),

1153 
$fÜm
['#t™Ë'] .ğ
	`t
('Style options');

1154 
$¡yË
 = 
TRUE
;

1155 
$ty³
 = 'style_plugin';

1156 
$Çme
 = 
$this
->
	`g‘_İtiÚ
('style_plugin');

1159 ià(!
	`is£t
(
$Çme
)) {

1160 
$Çme
 = 
$this
->
	`g‘_İtiÚ
('row_plugin');

1163 ià(
	`em±y
(
$¡yË
)) {

1164 
$fÜm
['#t™Ë'] .ğ
	`t
('Row style options');

1165 
$ty³
 = 'row_plugin';

1167 
$¶ugš
 = 
$this
->
	`g‘_¶ugš
(
	`em±y
(
$¡yË
) ? 'row' : 'style');

1168 ià(
$¶ugš
) {

1169 ià(
	`is£t
(
$¶ugš
->
defš™iÚ
['helpopic'])) {

1170 
$fÜm
['#h–p_tİic'] = 
$¶ugš
->
defš™iÚ
['helpopic'];

1171 
$fÜm
['#h–p_moduË'] = 
$¶ugš
->
defš™iÚ
['module'];

1173 
$fÜm
[
$fÜm_¡©e
['£ùiÚ']] = 
	`¬¿y
(

1174 '#Œ“' => 
TRUE
,

1176 
$¶ugš
->
	`İtiÚs_fÜm
(
$fÜm
[
$fÜm_¡©e
['section']], $form_state);

1180 
$fÜm
['#t™Ë'] .ğ
	`t
('How shouldƒach„ow inhis view be styled');

1181 
$fÜm
['#help_topic'] = 'style-row';

1182 
$fÜm
['row_¶ugš'] = 
	`¬¿y
(

1184 '#İtiÚs' => 
	`v›ws_ãtch_¶ugš_Çmes
('row', 
$this
->
	`g‘_¡yË_ty³
(), 
	`¬¿y
($this->
v›w
->
ba£_bË
)),

1185 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('row_plugin'),

1188 
$row_¶ugš
 = 
	`v›ws_ãtch_¶ugš_d©a
('row', 
$this
->
	`g‘_İtiÚ
('row_plugin'));

1189 ià(!
	`em±y
(
$row_¶ugš
['uses options'])) {

1190 
$fÜm
['m¬kup'] = 
	`¬¿y
(

1193 '#v®ue' => 
	`t
('You may‡lsØadju¡h!£‰šg fÜhcu¼’y s–eùed„ow styË by clickšg oÀthicÚ.', 
	`¬¿y
('!£‰šgs' => 
$this
->
	`İtiÚ_lšk
(t('settings'), 'row_options'))),

1199 
$fÜm
['#t™Ë'] .ğ
	`t
('Which displayo use for…ath');

1200 
	`fÜ—ch
 (
$this
->
v›w
->
di¥Ïy
 
as
 
$di¥Ïy_id
 => 
$di¥Ïy
) {

1201 ià(
$di¥Ïy
->
hªdËr
->
	`has_·th
()) {

1202 
$İtiÚs
[
$di¥Ïy_id
] = 
$di¥Ïy
->
di¥Ïy_t™Ë
;

1205 
$fÜm
['lšk_di¥Ïy'] = 
	`¬¿y
(

1207 '#İtiÚs' => 
$İtiÚs
,

1208 '#desütiÚ' => 
	`t
("Which displayo useo gethis display's…ath forhings†ike summary†inks,„ss feed†inks, more†inks,ƒtc."),

1209 '#deçuÉ_v®ue' => 
$this
->
	`g‘_lšk_di¥Ïy
(),

1213 
$fÜm
['#t™Ë'] .ğ
	`t
('Theming information');

1214 
$fÜm
['#help_topic'] = 'analyze-theme';

1216 ià(
	`is£t
(
$_POST
['theme'])) {

1217 
$this
->
v›w
->
theme
 = 
$_POST
['theme'];

1219 ià(
	`em±y
(
$this
->
v›w
->
theme
)) {

1220 
$this
->
v›w
->
theme
 = 
	`v¬ŸbË_g‘
('theme_default', 'garland');

1223 
glob®
 
$cu¡om_theme
;

1224 
$cu¡om_theme
 = 
$this
->
v›w
->
theme
;

1225 
	`š™_theme
();

1227 
$funcs
 = 
	`¬¿y
();

1231 ià(!
	`em±y
(
$this
->
defš™iÚ
['theme'])) {

1232 
$funcs
[] = 
$this
->
	`İtiÚ_lšk
(
	`t
('Di¥Ïy ouut'), 'ª®yze-theme-di¥Ïy'è. ': ' . $this->
	`fÜm©_themes
($this->
	`theme_funùiÚs
());

1233 
$themes
 = 
$this
->
	`add™iÚ®_theme_funùiÚs
();

1234 ià(
$themes
) {

1235 
	`fÜ—ch
 (
$themes
 
as
 
$theme
) {

1236 
$funcs
[] = 
$this
->
	`İtiÚ_lšk
(
	`t
('AÉ”Çtivdi¥Ïy ouut'), 'ª®yze-theme-di¥Ïy'è. ': ' . $this->
	`fÜm©_themes
(
$theme
);

1241 
$¶ugš
 = 
$this
->
	`g‘_¶ugš
();

1242 ià(
$¶ugš
) {

1243 
$funcs
[] = 
$this
->
	`İtiÚ_lšk
(
	`t
('StyË ouut'), 'ª®yze-theme-¡yË'è. ': ' . $this->
	`fÜm©_themes
(
$¶ugš
->
	`theme_funùiÚs
(), $¶ugš->
	`add™iÚ®_theme_funùiÚs
());

1244 
$themes
 = 
$¶ugš
->
	`add™iÚ®_theme_funùiÚs
();

1245 ià(
$themes
) {

1246 
	`fÜ—ch
 (
$themes
 
as
 
$theme
) {

1247 
$funcs
[] = 
$this
->
	`İtiÚ_lšk
(
	`t
('AÉ”Çtiv¡yË'), 'ª®yze-theme-¡yË'è. ': ' . $this->
	`fÜm©_themes
(
$theme
);

1251 ià(
$¶ugš
->
	`u£s_row_¶ugš
()) {

1252 
$row_¶ugš
 = 
$this
->
	`g‘_¶ugš
('row');

1253 ià(
$row_¶ugš
) {

1254 
$funcs
[] = 
$this
->
	`İtiÚ_lšk
(
	`t
('Row styË ouut'), 'ª®yze-theme-row'è. ': ' . $this->
	`fÜm©_themes
(
$row_¶ugš
->
	`theme_funùiÚs
());

1255 
$themes
 = 
$row_¶ugš
->
	`add™iÚ®_theme_funùiÚs
();

1256 ià(
$themes
) {

1257 
	`fÜ—ch
 (
$themes
 
as
 
$theme
) {

1258 
$funcs
[] = 
$this
->
	`İtiÚ_lšk
(
	`t
('AÉ”Çtivrow styË'), 'ª®yze-theme-row'è. ': ' . $this->
	`fÜm©_themes
(
$theme
);

1264 ià(
$¶ugš
->
	`u£s_f›lds
()) {

1265 
	`fÜ—ch
 (
$this
->
	`g‘_hªdËrs
('f›ld'è
as
 
$id
 => 
$hªdËr
) {

1266 
$funcs
[] = 
$this
->
	`İtiÚ_lšk
(
	`t
('F›ld @f›ld (ID: @id)', 
	`¬¿y
('@f›ld' => 
$hªdËr
->
	`ui_Çme
(), '@id' => 
$id
)), 'ª®yze-theme-f›ld'è. ': ' . $this->
	`fÜm©_themes
($hªdËr->
	`theme_funùiÚs
());

1271 
$fÜm
['impÜÁ'] = 
	`¬¿y
(

1274 '#v®ue' => '<p>' . 
	`t
('This section†ists‡ll…ossibleemplates forhe display…lugin‡nd forhe style…lugins, ordered„oughly fromhe†east specificohe most specific. The‡ctiveemplate forƒach…lugin -- which ishe most specificemplate found onhe system -- is highlighted in bold.') . '</p>',

1277 
	`fÜ—ch
 (
	`li¡_themes
(è
as
 
$key
 => 
$theme
) {

1278 
$İtiÚs
[
$key
] = 
$theme
->
šfo
['name'];

1281 
$fÜm
['box'] = 
	`¬¿y
(

1285 
$fÜm
['box']['theme'] = 
	`¬¿y
(

1287 '#İtiÚs' => 
$İtiÚs
,

1288 '#deçuÉ_v®ue' => 
$this
->
v›w
->
theme
,

1291 
$fÜm
['box']['chªge'] = 
	`¬¿y
(

1293 '#v®ue' => 
	`t
('Changeheme'),

1294 '#subm™' => 
	`¬¿y
('views_ui_edit_display_form_change_theme'),

1297 
$fÜm
['ª®ysis'] = 
	`¬¿y
(

1300 '#v®ue' => 
	`theme
('™em_li¡', 
$funcs
),

1303 
$fÜm
['»sÿn_bu‰Ú'] = 
	`¬¿y
(

1307 
$fÜm
['»sÿn_bu‰Ú']['bu‰Ú'] = 
	`¬¿y
(

1309 '#v®ue' => 
	`t
('Rescanemplate files'),

1310 '#subm™' => 
	`¬¿y
('views_ui_config_item_form_rescan'),

1312 
$fÜm
['»sÿn_bu‰Ú']['m¬kup'] = 
	`¬¿y
(

1315 '#v®ue' => 
	`t
("<strong>Important!</strong> When‡dding,„emoving, or„enamingemplate files, it is‚ecessaryo make Drupal‡ware ofhe changes by making it„escanhe files on your system. By clickinghis button you clear Drupal'sheme„egistry‡ndherebyriggerhis„escanning…rocess. The highlightedemplates‡bove willhen„eflecthe‚ew state of your system."),

1318 
$fÜm_¡©e
['ok_bu‰Ú'] = 
TRUE
;

1321 
$fÜm
['#t™Ë'] .ğ
	`t
('Theming information (display)');

1322 
$ouut
 = '<p>' . 
	`t
('BackØ!šfo.', 
	`¬¿y
('!šfo' => 
$this
->
	`İtiÚ_lšk
(t('theming information'), 'analyze-theme'))) . '</p>';

1324 ià(
	`em±y
(
$this
->
defš™iÚ
['theme'])) {

1325 
$ouut
 .ğ
	`t
('This display has‚oheming information');

1328 
$ouut
 .ğ'<p>' . 
	`t
('This ishe defaulthemeemplate used forhis display.') . '</p>';

1329 
$ouut
 .ğ'<´e>' . 
	`check_¶aš
(
	`fe_g‘_cÚ‹Ás
('./' . 
$this
->
defš™iÚ
['them·th'] . '/' . 
	`¡¹r
($this->definition['theme'], '_', '-') . '.tpl.php')) . '</pre>';

1332 ià(!
	`em±y
(
$this
->
defš™iÚ
['additionalhemes'])) {

1333 
	`fÜ—ch
 (
$this
->
defš™iÚ
['add™iÚ®hemes'] 
as
 
$theme
 => 
$ty³
) {

1334 
$ouut
 .ğ'<p>' . 
	`t
('This is‡n‡lternativeemplate forhis display.') . '</p>';

1335 
$ouut
 .ğ'<´e>' . 
	`check_¶aš
(
	`fe_g‘_cÚ‹Ás
('./' . 
$this
->
defš™iÚ
['them·th'] . '/' . 
	`¡¹r
(
$theme
, '_', '-') . '.tpl.php')) . '</pre>';

1339 
$fÜm
['ª®ysis'] = 
	`¬¿y
(

1342 '#v®ue' => 
$ouut
,

1345 
$fÜm_¡©e
['ok_bu‰Ú'] = 
TRUE
;

1348 
$fÜm
['#t™Ë'] .ğ
	`t
('Theming information (style)');

1349 
$ouut
 = '<p>' . 
	`t
('BackØ!šfo.', 
	`¬¿y
('!šfo' => 
$this
->
	`İtiÚ_lšk
(t('theming information'), 'analyze-theme'))) . '</p>';

1351 
$¶ugš
 = 
$this
->
	`g‘_¶ugš
();

1353 ià(
	`em±y
(
$¶ugš
->
defš™iÚ
['theme'])) {

1354 
$ouut
 .ğ
	`t
('This display has‚o styleheming information');

1357 
$ouut
 .ğ'<p>' . 
	`t
('This ishe defaulthemeemplate used forhis style.') . '</p>';

1358 
$ouut
 .ğ'<´e>' . 
	`check_¶aš
(
	`fe_g‘_cÚ‹Ás
('./' . 
$¶ugš
->
defš™iÚ
['them·th'] . '/' . 
	`¡¹r
($plugin->definition['theme'], '_', '-') . '.tpl.php')) . '</pre>';

1361 ià(!
	`em±y
(
$¶ugš
->
defš™iÚ
['additionalhemes'])) {

1362 
	`fÜ—ch
 (
$¶ugš
->
defš™iÚ
['add™iÚ®hemes'] 
as
 
$theme
 => 
$ty³
) {

1363 
$ouut
 .ğ'<p>' . 
	`t
('This is‡n‡lternativeemplate forhis style.') . '</p>';

1364 
$ouut
 .ğ'<´e>' . 
	`check_¶aš
(
	`fe_g‘_cÚ‹Ás
('./' . 
$¶ugš
->
defš™iÚ
['them·th'] . '/' . 
	`¡¹r
(
$theme
, '_', '-') . '.tpl.php')) . '</pre>';

1368 
$fÜm
['ª®ysis'] = 
	`¬¿y
(

1371 '#v®ue' => 
$ouut
,

1374 
$fÜm_¡©e
['ok_bu‰Ú'] = 
TRUE
;

1377 
$fÜm
['#t™Ë'] .ğ
	`t
('Theming information (row style)');

1378 
$ouut
 = '<p>' . 
	`t
('BackØ!šfo.', 
	`¬¿y
('!šfo' => 
$this
->
	`İtiÚ_lšk
(t('theming information'), 'analyze-theme'))) . '</p>';

1380 
$¶ugš
 = 
$this
->
	`g‘_¶ugš
('row');

1382 ià(
	`em±y
(
$¶ugš
->
defš™iÚ
['theme'])) {

1383 
$ouut
 .ğ
	`t
('This display has‚o„ow styleheming information');

1386 
$ouut
 .ğ'<p>' . 
	`t
('This ishe defaulthemeemplate used forhis„ow style.') . '</p>';

1387 
$ouut
 .ğ'<´e>' . 
	`check_¶aš
(
	`fe_g‘_cÚ‹Ás
('./' . 
$¶ugš
->
defš™iÚ
['them·th'] . '/' . 
	`¡¹r
($plugin->definition['theme'], '_', '-') . '.tpl.php')) . '</pre>';

1390 ià(!
	`em±y
(
$¶ugš
->
defš™iÚ
['additionalhemes'])) {

1391 
	`fÜ—ch
 (
$¶ugš
->
defš™iÚ
['add™iÚ®hemes'] 
as
 
$theme
 => 
$ty³
) {

1392 
$ouut
 .ğ'<p>' . 
	`t
('This is‡n‡lternativeemplate forhis„ow style.') . '</p>';

1393 
$ouut
 .ğ'<´e>' . 
	`check_¶aš
(
	`fe_g‘_cÚ‹Ás
('./' . 
$¶ugš
->
defš™iÚ
['them·th'] . '/' . 
	`¡¹r
(
$theme
, '_', '-') . '.tpl.php')) . '</pre>';

1397 
$fÜm
['ª®ysis'] = 
	`¬¿y
(

1400 '#v®ue' => 
$ouut
,

1403 
$fÜm_¡©e
['ok_bu‰Ú'] = 
TRUE
;

1406 
$fÜm
['#t™Ë'] .ğ
	`t
('Theming information (row style)');

1407 
$ouut
 = '<p>' . 
	`t
('BackØ!šfo.', 
	`¬¿y
('!šfo' => 
$this
->
	`İtiÚ_lšk
(t('theming information'), 'analyze-theme'))) . '</p>';

1409 
$ouut
 .ğ'<p>' . 
	`t
('This ishe defaulthemeemplate used forhis„ow style.') . '</p>';

1413 
$ouut
 .ğ'<´e>' . 
	`check_¶aš
(
	`fe_g‘_cÚ‹Ás
(
	`dru·l_g‘_·th
('module', 'views') . '/theme/views-view-field.tpl.php')) . '</pre>';

1415 
$fÜm
['ª®ysis'] = 
	`¬¿y
(

1418 '#v®ue' => 
$ouut
,

1420 
$fÜm_¡©e
['ok_bu‰Ú'] = 
TRUE
;

1424 
$fÜm
['#t™Ë'] .ğ
	`t
('Putheƒxposed form in‡ block');

1425 
$fÜm
['desütiÚ'] = 
	`¬¿y
(

1428 '#v®ue' => 
	`t
('If set,‡nyƒxposed widgets will‚ot‡ppear withhis view. Instead,‡ block will be made‡vailableohe Drupal block‡dministration system,‡ndheƒxposed form will‡ppearhere. Notehathis block must beƒnabled manually, Views will‚otƒnable it for you.'),

1430 
$fÜm
['expo£d_block'] = 
	`¬¿y
(

1432 '#İtiÚs' => 
	`¬¿y
(1 => 
	`t
('Yes'), 0 =>('No')),

1433 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('exposed_block') ? 1 : 0,

1437 
	}
}

1442 
funùiÚ
 
	$fÜm©_themes
(
$themes
) {

1443 
$»gi¡ry
 = 
	`theme_g‘_»gi¡ry
();

1446 
glob®
 
$theme_’gše
;

1447 
$ex‹nsiÚ
 = '.tpl.php';

1448 ià(
	`is£t
(
$theme_’gše
)) {

1449 
$ex‹nsiÚ_funùiÚ
 = 
$theme_’gše
 . '_extension';

1450 ià(
	`funùiÚ_exi¡s
(
$ex‹nsiÚ_funùiÚ
)) {

1451 
$ex‹nsiÚ
 = 
	`$ex‹nsiÚ_funùiÚ
();

1455 
$ouut
 = '';

1456 
$picked
 = 
FALSE
;

1457 
	`fÜ—ch
 (
$themes
 
as
 
$theme
) {

1458 
$‹m¶©e
 = 
	`¡¹r
(
$theme
, '_', '-'è. 
$ex‹nsiÚ
;

1459 ià(!
$picked
 && !
	`em±y
(
$»gi¡ry
[
$theme
])) {

1460 
$‹m¶©e_·th
 = 
	`is£t
(
$»gi¡ry
[
$theme
]['path']) ? $registry[$theme]['path'] . '/' : './';

1461 ià(
	`fe_exi¡s
(
$‹m¶©e_·th
 . 
$‹m¶©e
)) {

1462 
$hšt
 = 
	`t
('Ffound iÀfŞd” @‹m¶©e-·th', 
	`¬¿y
('@‹m¶©e-·th' => 
$‹m¶©e_·th
));

1463 
$‹m¶©e
 = '<¡rÚg™Ë="'. 
$hšt
 .'">' . $template . '</strong>';

1466 
$‹m¶©e
 = '<¡rÚg cÏss="”rÜ">' . $‹m¶©. ' ' . 
	`t
('(FnÙ found, iÀfŞd” @‹m¶©e-·th)', 
	`¬¿y
('@‹m¶©e-·th' => 
$‹m¶©e_·th
)) . '</strong>';

1468 
$picked
 = 
TRUE
;

1470 
$fixed
[] = 
$‹m¶©e
;

1473  
	`im¶ode
(', ', 
	`¬¿y_»v”£
(
$fixed
));

1474 
	}
}

1479 
funùiÚ
 
	$İtiÚs_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
) {

1480 
$fÜm_¡©e
['section']) {

1482 
$css_şass
 = 
$fÜm_¡©e
['values']['css_class'];

1483 ià(
	`´eg_m©ch
('/[^a-zA-Z0-9- ]/', 
$css_şass
)) {

1484 
	`fÜm_”rÜ
(
$fÜm
['css_şass'], 
	`t
('CSS classes must be‡lphanumeric or dashes only.'));

1488 
$¡yË
 = 
TRUE
;

1491 
$¶ugš
 = 
$this
->
	`g‘_¶ugš
(
	`em±y
(
$¡yË
) ? 'row' : 'style');

1492 ià(
$¶ugš
) {

1493 
$¶ugš
->
	`İtiÚs_v®id©e
(
$fÜm
[
$fÜm_¡©e
['section']], $form_state);

1497 
$¶ugš
 = 
$this
->
	`g‘_acûss_¶ugš
();

1498 ià(
$¶ugš
) {

1499 
$¶ugš
->
	`İtiÚs_v®id©e
(
$fÜm
['acûss_İtiÚs'], 
$fÜm_¡©e
);

1503 
$¶ugš
 = 
$this
->
	`g‘_ÿche_¶ugš
();

1504 ià(
$¶ugš
) {

1505 
$¶ugš
->
	`İtiÚs_v®id©e
(
$fÜm
['ÿche_İtiÚs'], 
$fÜm_¡©e
);

1509 
	}
}

1515 
funùiÚ
 
	$İtiÚs_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

1517 
$ÿche_¶ugš
 = 
$this
->
	`g‘_ÿche_¶ugš
();

1518 ià(
$ÿche_¶ugš
) {

1519 
$ÿche_¶ugš
->
	`ÿche_æush
();

1522 
$£ùiÚ
 = 
$fÜm_¡©e
['section'];

1523 
$£ùiÚ
) {

1525 
$this
->
di¥Ïy
->
di¥Ïy_t™Ë
 = 
$fÜm_¡©e
['values']['display_title'];

1528 
$acûss
 = 
$this
->
	`g‘_İtiÚ
('access');

1529 ià(
$acûss
['ty³'] !ğ
$fÜm_¡©e
['values']['access']['type']) {

1530 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('acûss', 
$fÜm_¡©e
['values']['access']['type']);

1531 ià(
$¶ugš
) {

1532 
$acûss
 = 
	`¬¿y
('ty³' => 
$fÜm_¡©e
['values']['access']['type']);

1533 
$¶ugš
->
	`İtiÚ_deçuÉs
(
$acûss
);

1534 
$this
->
	`£t_İtiÚ
('acûss', 
$acûss
);

1535 ià(!
	`em±y
(
$¶ugš
->
defš™iÚ
['uses options'])) {

1536 
	`v›ws_ui_add_fÜm_to_¡ack
('di¥Ïy', 
$this
->
v›w
, $this->
di¥Ïy
->
id
, 
	`¬¿y
('access_options'));

1543 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('acûss', 
$fÜm_¡©e
['v®ues'][
$£ùiÚ
]['type']);

1544 ià(
$¶ugš
) {

1545 
$¶ugš
->
	`İtiÚs_subm™
(
$fÜm
['acûss_İtiÚs'], 
$fÜm_¡©e
);

1546 
$this
->
	`£t_İtiÚ
('acûss', 
$fÜm_¡©e
['v®ues'][
$£ùiÚ
]);

1550 
$ÿche
 = 
$this
->
	`g‘_İtiÚ
('cache');

1551 ià(
$ÿche
['ty³'] !ğ
$fÜm_¡©e
['values']['cache']['type']) {

1552 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('ÿche', 
$fÜm_¡©e
['values']['cache']['type']);

1553 ià(
$¶ugš
) {

1554 
$ÿche
 = 
	`¬¿y
('ty³' => 
$fÜm_¡©e
['values']['cache']['type']);

1555 
$¶ugš
->
	`İtiÚ_deçuÉs
(
$ÿche
);

1556 
$this
->
	`£t_İtiÚ
('ÿche', 
$ÿche
);

1557 ià(!
	`em±y
(
$¶ugš
->
defš™iÚ
['uses options'])) {

1558 
	`v›ws_ui_add_fÜm_to_¡ack
('di¥Ïy', 
$this
->
v›w
, $this->
di¥Ïy
->
id
, 
	`¬¿y
('cache_options'));

1565 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('ÿche', 
$fÜm_¡©e
['v®ues'][
$£ùiÚ
]['type']);

1566 ià(
$¶ugš
) {

1567 
$¶ugš
->
	`İtiÚs_subm™
(
$fÜm
['ÿche_İtiÚs'], 
$fÜm_¡©e
);

1568 
$this
->
	`£t_İtiÚ
('ÿche', 
$fÜm_¡©e
['v®ues'][
$£ùiÚ
]);

1574 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
, 
$fÜm_¡©e
['values'][$section]);

1577 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
, (
boŞ
)
$fÜm_¡©e
['values'][$section]);

1580 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
, 
$fÜm_¡©e
['values'][$section]);

1581 
$this
->
	`£t_İtiÚ
('·g”_–em’t', 
	`štv®
(
$fÜm_¡©e
['values']['pager_element']));

1584 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
, 
	`štv®
(
$fÜm_¡©e
['values'][$section]));

1585 
$this
->
	`£t_İtiÚ
('off£t', 
	`štv®
(
$fÜm_¡©e
['values']['offset']));

1588 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
, 
	`štv®
(
$fÜm_¡©e
['values'][$section]));

1589 
$this
->
	`£t_İtiÚ
('u£_mÜe_®ways', 
	`štv®
(
$fÜm_¡©e
['values']['use_more_always']));

1590 
$this
->
	`£t_İtiÚ
('u£_mÜe_‹xt', 
$fÜm_¡©e
['values']['use_more_text']);

1592 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
, 
$fÜm_¡©e
['values'][$section]);

1597 ià(
$this
->
	`g‘_İtiÚ
(
$£ùiÚ
è!ğ
$fÜm_¡©e
['values'][$section]) {

1598 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('row', 
$fÜm_¡©e
['v®ues'][
$£ùiÚ
]);

1599 ià(
$¶ugš
) {

1600 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
, 
$fÜm_¡©e
['values'][$section]);

1601 
$this
->
	`£t_İtiÚ
('row_İtiÚs', 
	`¬¿y
());

1604 ià(!
	`em±y
(
$¶ugš
->
defš™iÚ
['uses options'])) {

1605 
	`v›ws_ui_add_fÜm_to_¡ack
('di¥Ïy', 
$this
->
v›w
, $this->
di¥Ïy
->
id
, 
	`¬¿y
('row_options'));

1613 ià(
$this
->
	`g‘_İtiÚ
(
$£ùiÚ
è!ğ
$fÜm_¡©e
['values'][$section]) {

1614 
$¶ugš
 = 
	`v›ws_g‘_¶ugš
('¡yË', 
$fÜm_¡©e
['v®ues'][
$£ùiÚ
]);

1615 ià(
$¶ugš
) {

1616 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
, 
$fÜm_¡©e
['values'][$section]);

1617 
$this
->
	`£t_İtiÚ
('¡yË_İtiÚs', 
	`¬¿y
());

1619 ià(!
	`em±y
(
$¶ugš
->
defš™iÚ
['uses options'])) {

1620 
	`v›ws_ui_add_fÜm_to_¡ack
('di¥Ïy', 
$this
->
v›w
, $this->
di¥Ïy
->
id
, 
	`¬¿y
('style_options'));

1626 
$¡yË
 = 
TRUE
;

1629 
$¶ugš
 = 
$this
->
	`g‘_¶ugš
(
	`em±y
(
$¡yË
) ? 'row' : 'style');

1630 ià(
$¶ugš
) {

1631 
$¶ugš
->
	`İtiÚs_subm™
(
$fÜm
[
$£ùiÚ
], 
$fÜm_¡©e
);

1633 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
, 
$fÜm_¡©e
['values'][$section]);

1638 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
, 
$fÜm_¡©e
['values'][$section]);

1639 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
 . '_fÜm©', 
$fÜm_¡©e
['values'][$section . '_format']);

1640 ià(
$£ùiÚ
 != 'empty') {

1641 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
 . '_em±y', 
$fÜm_¡©e
['values'][$section . '_empty']);

1645 
$this
->
	`£t_İtiÚ
(
$£ùiÚ
, (
boŞ
è
$fÜm_¡©e
['values'][$section]);

1648 
	}
}

1655 
funùiÚ
 
	$add_ov”ride_bu‰Ú
(&
$fÜm
, &
$fÜm_¡©e
, 
$£ùiÚ
) {

1656 ià(
$this
->
	`is_deçuÉ_di¥Ïy
()) {

1660 
$fÜm
['ov”ride'] = 
	`¬¿y
(

1664 ià(
$this
->
	`is_deçuÉed
(
$£ùiÚ
)) {

1665 
$fÜm
['ov”ride']['bu‰Ú'] = 
	`¬¿y
(

1667 '#v®ue' => 
	`t
('Override'),

1668 '#subm™' => 
	`¬¿y
('views_ui_edit_display_form_override'),

1670 
$fÜm
['ov”ride']['m¬kup'] = 
	`¬¿y
(

1672 '#v®ue' => 
	`theme
('advªûd_h–p_tİic', 'v›ws', 'ov”rides'è. 
	`t
('Status: using default values.'),

1676 
$fÜm_¡©e
['upd©e_Çme'] = 
	`t
('Update default display');

1679 
$fÜm
['ov”ride']['bu‰Ú'] = 
	`¬¿y
(

1681 '#v®ue' => 
	`t
('Use default'),

1682 '#subm™' => 
	`¬¿y
('views_ui_edit_display_form_override'),

1684 
$fÜm
['ov”ride']['m¬kup'] = 
	`¬¿y
(

1686 '#v®ue' => 
	`theme
('advªûd_h–p_tİic', 'v›ws', 'ov”rides'è. 
	`t
('Status: using overridden values.'),

1690 
$fÜm_¡©e
['upd©e_Çme'] = 
NULL
;

1692 
	}
}

1697 
funùiÚ
 
	$İtiÚs_ov”ride
(
$fÜm
, &
$fÜm_¡©e
) {

1698 
$this
->
	`£t_ov”ride
(
$fÜm_¡©e
['section']);

1699 
	}
}

1704 
funùiÚ
 
	$£t_ov”ride
(
$£ùiÚ
, 
$Ãw_¡©e
 = 
NULL
) {

1705 
$İtiÚs
 = 
$this
->
	`deçuÉabË_£ùiÚs
(
$£ùiÚ
);

1706 ià(!
$İtiÚs
) {

1710 ià(!
	`is£t
(
$Ãw_¡©e
)) {

1711 
$Ãw_¡©e
 = 
	`em±y
(
$this
->
İtiÚs
['deçuÉs'][
$£ùiÚ
]);

1715 
	`fÜ—ch
 (
$İtiÚs
 
as
 
$İtiÚ
) {

1716 ià(
$Ãw_¡©e
) {

1718 
	`un£t
(
$this
->
İtiÚs
[
$İtiÚ
]);

1719 
	`un£t
(
$this
->
di¥Ïy
->
di¥Ïy_İtiÚs
[
$İtiÚ
]);

1723 
$this
->
İtiÚs
[
$İtiÚ
] = $this->
	`g‘_İtiÚ
($option);

1724 
$this
->
di¥Ïy
->
di¥Ïy_İtiÚs
[
$İtiÚ
] = $this->
İtiÚs
[$option];

1726 
$this
->
İtiÚs
['deçuÉs'][
$İtiÚ
] = 
$Ãw_¡©e
;

1727 
$this
->
di¥Ïy
->
di¥Ïy_İtiÚs
['deçuÉs'][
$İtiÚ
] = 
$Ãw_¡©e
;

1729 
	}
}

1734 
funùiÚ
 
	$qu”y
() {

1736 ià(
$this
->
	`g‘_İtiÚ
('distinct')) {

1737 
$this
->
v›w
->
qu”y
->
	`£t_di¡šù
();

1739 
	}
}

1744 
funùiÚ
 
	$»nd”_f‹rs
(è{ 
	}
}

1749 
funùiÚ
 
	$»nd”_mÜe_lšk
() {

1750 ià(
$this
->
	`u£_mÜe
(è&& ($this->
	`u£_mÜe_®ways
(è|| !
	`is£t
($this->
v›w
->
tÙ®_rows
è|| $this->v›w->tÙ®_row > $this->v›w->
·g”
['items_per_page'])) {

1751 
$·th
 = 
$this
->
	`g‘_·th
();

1752 ià(
$·th
) {

1753 
$·th
 = 
$this
->
v›w
->
	`g‘_u¾
(
NULL
, $path);

1754 
$u¾_İtiÚs
 = 
	`¬¿y
();

1755 ià(!
	`em±y
(
$this
->
v›w
->
expo£d_¿w_šput
)) {

1756 
$u¾_İtiÚs
['qu”y'] = 
$this
->
v›w
->
expo£d_¿w_šput
;

1758 
$theme
 = 
	`v›ws_theme_funùiÚs
('v›ws_mÜe', 
$this
->
v›w
, $this->
di¥Ïy
);

1759 
$·th
 = 
	`check_u¾
(
	`u¾
($·th, 
$u¾_İtiÚs
));

1760  
	`theme
(
$theme
, 
$·th
, 
	`check_¶aš
(
$this
->
	`u£_mÜe_‹xt
()));

1763 
	}
}

1768 
funùiÚ
 
	$»nd”_‹x»a
(
$¬—
) {

1769 
$fÜm©s
 = 
	`¬¿y
();

1771 
$v®ue
 = 
$this
->
	`g‘_İtiÚ
(
$¬—
);

1774 
$fÜm©
 = 
	`f‹r_»sŞve_fÜm©
(
$this
->
	`g‘_İtiÚ
(
$¬—
 . '_format'));

1776 ià(!
	`¬¿y_key_exi¡s
(
$fÜm©
, 
$fÜm©s
)) {

1777 
$fÜm©s
[
$fÜm©
] = 
	`db_»suÉ
(
	`db_qu”y
("SELECT‚ame FROM {filter_formats} WHERE format = %d", $format));

1780 ià(!
$fÜm©s
[
$fÜm©
]) {

1784 ià(
$v®ue
) {

1785  
	`check_m¬kup
(
$v®ue
, 
$fÜm©
, 
FALSE
);

1787 
	}
}

1792 
funùiÚ
 
	$»nd”_h—d”
() {

1793 ià(!
	`em±y
(
$this
->
v›w
->
»suÉ
è|| $this->
	`g‘_İtiÚ
('header_empty')) {

1794  
$this
->
	`»nd”_‹x»a
('header');

1796 
	}
}

1801 
funùiÚ
 
	$»nd”_foÙ”
() {

1802 ià(!
	`em±y
(
$this
->
v›w
->
»suÉ
è|| $this->
	`g‘_İtiÚ
('footer_empty')) {

1803  
$this
->
	`»nd”_‹x»a
('footer');

1805 
	}
}

1810 
funùiÚ
 
	$»nd”_em±y
(è{  
$this
->
	`»nd”_‹x»a
('em±y'); 
	}
}

1814 
funùiÚ
 
hook_block
(
$İ
 = 'li¡', 
$d–
 = 0, 
$ed™
 = 
	$¬¿y
()è{  
	`¬¿y
(); 
	}
}

1819 
funùiÚ
 
	$hook_m’u
(è{  
	`¬¿y
(); 
	}
}

1824 
funùiÚ
 
	$»nd”
() {

1825  
	`theme
(
$this
->
	`theme_funùiÚs
(), $this->
v›w
);

1826 
	}
}

1831 
funùiÚ
 
	$acûss
(
$accouÁ
 = 
NULL
) {

1832 ià(!
	`is£t
(
$accouÁ
)) {

1833 
glob®
 
$u£r
;

1834 
$accouÁ
 = 
$u£r
;

1838 ià(
	`u£r_acûss
('acûs ®Èv›ws', 
$accouÁ
)) {

1839  
TRUE
;

1842 
$¶ugš
 = 
$this
->
	`g‘_acûss_¶ugš
();

1843 ià(
$¶ugš
) {

1844  
$¶ugš
->
	`acûss
(
$accouÁ
);

1848  
TRUE
;

1849 
	}
}

1856 
funùiÚ
 
	$´e_execu‹
() {

1857 
$this
->
v›w
->
	`£t_u£_ajax
($this->
	`u£_ajax
());

1859 
$this
->
v›w
->
	`£t_u£_·g”
($this->
	`u£_·g”
());

1860 
$this
->
v›w
->
	`£t_·g”_–em’t
($this->
	`g‘_İtiÚ
('pager_element'));

1861 
$this
->
v›w
->
	`£t_™ems_³r_·ge
($this->
	`g‘_İtiÚ
('items_per_page'));

1862 
$this
->
v›w
->
	`£t_off£t
($this->
	`g‘_İtiÚ
('offset'));

1863 ià(
$this
->
	`u£_mÜe
()) {

1864 
$this
->
v›w
->
g‘_tÙ®_rows
 = 
TRUE
;

1866 
	}
}

1874 
funùiÚ
 
	$execu‹
(è{ 
	}
}

1880 
funùiÚ
 
	$´ev›w
(è{  
$this
->
v›w
->
	`»nd”
(); 
	}
}

1886 
funùiÚ
 
	$g‘_¡yË_ty³
(è{  'nÜm®'; 
	}
}

1894 
funùiÚ
 
	$v®id©e
() {

1895 
$”rÜs
 = 
	`¬¿y
();

1897 ià(
$this
->
	`u£s_f›lds
()) {

1898 
$f›lds
 = 
FALSE
;

1899 
	`fÜ—ch
 (
$this
->
	`g‘_hªdËrs
('f›ld'è
as
 
$f›ld
) {

1900 ià(
	`em±y
(
$f›ld
->
İtiÚs
['exclude'])) {

1901 
$f›lds
 = 
TRUE
;

1905 ià(!
$f›lds
) {

1906 
$”rÜs
[] = 
	`t
('Di¥Ïy "@di¥Ïy" u£ f›ld buˆth”¬nÚdefšed fÜ iˆÜ‡Î‡»ƒxşuded.', 
	`¬¿y
('@di¥Ïy' => 
$this
->
di¥Ïy
->
di¥Ïy_t™Ë
));

1910 ià(
$this
->
	`has_·th
(è&& !$this->
	`g‘_İtiÚ
('path')) {

1911 
$”rÜs
[] = 
	`t
('Di¥Ïy "@di¥Ïy" u£ ¨·th buˆth·th i undefšed.', 
	`¬¿y
('@di¥Ïy' => 
$this
->
di¥Ïy
->
di¥Ïy_t™Ë
));

1915 
$¡yË
 = 
$this
->
	`g‘_¶ugš
();

1916 ià(
	`em±y
(
$¡yË
)) {

1917 
$”rÜs
[] = 
	`t
('Di¥Ïy "@di¥Ïy" ha ª inv®id styË…lugš.', 
	`¬¿y
('@di¥Ïy' => 
$this
->
di¥Ïy
->
di¥Ïy_t™Ë
));

1920 
$»suÉ
 = 
$¡yË
->
	`v®id©e
();

1921 ià(!
	`em±y
(
$»suÉ
è&& 
	`is_¬¿y
($result)) {

1922 
$”rÜs
 = 
	`¬¿y_m”ge
($”rÜs, 
$»suÉ
);

1927 
	`fÜ—ch
 (
	`v›ws_objeù_ty³s
(è
as
 
$ty³
 => 
$šfo
) {

1928 
	`fÜ—ch
 (
$this
->
	`g‘_hªdËrs
(
$ty³
è
as
 
$hªdËr
) {

1929 
$»suÉ
 = 
$hªdËr
->
	`v®id©e
();

1930 ià(!
	`em±y
(
$»suÉ
è&& 
	`is_¬¿y
($result)) {

1931 
$”rÜs
 = 
	`¬¿y_m”ge
($”rÜs, 
$»suÉ
);

1936  
$”rÜs
;

1937 
	}
}

1942 
funùiÚ
 
	$is_id’tif›r_unique
(
$id
, 
$id’tif›r
) {

1943 
	`fÜ—ch
 (
	`v›ws_objeù_ty³s
(è
as
 
$ty³
 => 
$šfo
) {

1944 
	`fÜ—ch
 (
$this
->
	`g‘_hªdËrs
(
$ty³
è
as
 
$key
 => 
$hªdËr
) {

1945 ià(
$hªdËr
->
	`ÿn_expo£
(è&& $hªdËr->
	`is_expo£d
()) {

1946 ià(
$id
 !ğ
$key
 && 
$id’tif›r
 =ğ
$hªdËr
->
İtiÚs
['expose']['identifier']) {

1947  
FALSE
;

1952  
TRUE
;

1953 
	}
}

1958 
funùiÚ
 
	$g‘_¥ecŸl_blocks
() {

1959 
$d–
 = '-exp-' . 
$this
->
v›w
->
Çme
 . '-' . $this->
di¥Ïy
->
id
;

1960 
$desc
 = 
	`t
('Expo£d fÜm: @v›w-@di¥Ïy_id', 
	`¬¿y
('@v›w' => 
$this
->
v›w
->
Çme
, '@di¥Ïy_id' => $this->
di¥Ïy
->
id
));

1962  
	`¬¿y
(

1963 
$d–
 => 
	`¬¿y
(

1964 'šfo' => 
$desc
,

1967 
	}
}

1972 
funùiÚ
 
	$v›w_¥ecŸl_blocks
(
$ty³
) {

1973 ià(
$ty³
 == '-exp') {

1975 ià(
	`¬g
(0) == 'admin' &&‡rg(1) == 'build' &&‡rg(2) == 'views') {

1978 
$this
->
v›w
->
	`š™_hªdËrs
();

1979  
	`¬¿y
(

1980 'cÚ‹Á' => 
$this
->
v›w
->
	`»nd”_expo£d_fÜm
(
TRUE
),

1983 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_display_attachment.inc

1 <?
php


17 şas 
	cv›ws_¶ugš_di¥Ïy_©chm’t
 
ex‹nds
 
	mv›ws_¶ugš_di¥Ïy
 {

18 
funùiÚ
 
	$İtiÚ_defš™iÚ
 () {

19 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

21 
$İtiÚs
['©chm’t_pos™iÚ'] = 
	`¬¿y
('default' => 'before');

22 
$İtiÚs
['šh”™_¬gum’ts'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

23 
$İtiÚs
['šh”™_expo£d_f‹rs'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

24 
$İtiÚs
['šh”™_·g”'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

25 
$İtiÚs
['»nd”_·g”'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

26 
$İtiÚs
['di¥Ïys'] = 
	`¬¿y
('default' =>‡rray());

28  
$İtiÚs
;

31 
funùiÚ
 
	$execu‹
() {

32  
$this
->
v›w
->
	`»nd”
($this->
di¥Ïy
->
id
);

33 
	}
}

35 
funùiÚ
 
	$©chm’t_pos™iÚs
(
$pos™iÚ
 = 
NULL
) {

36 
$pos™iÚs
 = 
	`¬¿y
(

37 'befÜe' => 
	`t
('Before'),

38 'aá”' => 
	`t
('After'),

39 'bÙh' => 
	`t
('Both'),

42 ià(
$pos™iÚ
) {

43  
$pos™iÚs
[
$pos™iÚ
];

46  
$pos™iÚs
;

47 
	}
}

54 
funùiÚ
 
	$İtiÚs_summ¬y
(&
$ÿ‹gÜ›s
, &
$İtiÚs
) {

56 
·»Á
::
	`İtiÚs_summ¬y
(
$ÿ‹gÜ›s
, 
$İtiÚs
);

58 
$ÿ‹gÜ›s
['©chm’t'] = 
	`¬¿y
(

59 't™Ë' => 
	`t
('Attachment settings'),

62 
$İtiÚs
['šh”™_¬gum’ts'] = 
	`¬¿y
(

64 't™Ë' => 
	`t
('Inherit‡rguments'),

65 'v®ue' => 
$this
->
	`g‘_İtiÚ
('šh”™_¬gum’ts'è? 
	`t
('Yes') :('No'),

68 
$İtiÚs
['šh”™_expo£d_f‹rs'] = 
	`¬¿y
(

70 't™Ë' => 
	`t
('Inheritƒxposed filters'),

71 'v®ue' => 
$this
->
	`g‘_İtiÚ
('šh”™_expo£d_f‹rs'è? 
	`t
('Yes') :('No'),

74 
$İtiÚs
['šh”™_·g”'] = 
	`¬¿y
(

76 't™Ë' => 
	`t
('Inherit…ager'),

77 'v®ue' => 
$this
->
	`g‘_İtiÚ
('šh”™_·g”'è? 
	`t
('Yes') :('No'),

80 
$İtiÚs
['»nd”_·g”'] = 
	`¬¿y
(

82 't™Ë' => 
	`t
('Render…ager'),

83 'v®ue' => 
$this
->
	`g‘_İtiÚ
('»nd”_·g”'è? 
	`t
('Yes') :('No'),

86 
$İtiÚs
['©chm’t_pos™iÚ'] = 
	`¬¿y
(

88 't™Ë' => 
	`t
('Position'),

89 'v®ue' => 
$this
->
	`©chm’t_pos™iÚs
($this->
	`g‘_İtiÚ
('attachment_position')),

92 
$di¥Ïys
 = 
	`¬¿y_f‹r
(
$this
->
	`g‘_İtiÚ
('displays'));

93 ià(
	`couÁ
(
$di¥Ïys
) > 1) {

94 
$©ch_to
 = 
	`t
('Multiple displays');

96 ià(
	`couÁ
(
$di¥Ïys
) == 1) {

97 
$di¥Ïy
 = 
	`¬¿y_shiá
(
$di¥Ïys
);

98 ià(!
	`em±y
(
$this
->
v›w
->
di¥Ïy
[
$di¥Ïy
])) {

99 
$©ch_to
 = 
	`check_¶aš
(
$this
->
v›w
->
di¥Ïy
[
$di¥Ïy
]->
di¥Ïy_t™Ë
);

103 ià(!
	`is£t
(
$©ch_to
)) {

104 
$©ch_to
 = 
	`t
('None');

107 
$İtiÚs
['di¥Ïys'] = 
	`¬¿y
(

109 't™Ë' => 
	`t
('Attacho'),

110 'v®ue' => 
$©ch_to
,

112 
	}
}

117 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

119 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

121 
$fÜm_¡©e
['section']) {

123 
$fÜm
['#t™Ë'] .ğ
	`t
('Inherit‡rguments');

124 
$fÜm
['šh”™_¬gum’ts'] = 
	`¬¿y
(

126 '#t™Ë' => 
	`t
('Inherit'),

127 '#desütiÚ' => 
	`t
('Shouldhis display inherit its‡rguments fromhe…arent displayo which it is‡ttached?'),

128 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('inherit_arguments'),

132 
$fÜm
['#t™Ë'] .ğ
	`t
('Inheritƒxposed filters');

133 
$fÜm
['šh”™_expo£d_f‹rs'] = 
	`¬¿y
(

135 '#t™Ë' => 
	`t
('Inherit'),

136 '#desütiÚ' => 
	`t
('Shouldhis display inherit itsƒxposed filter values fromhe…arent displayo which it is‡ttached?'),

137 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('inherit_exposed_filters'),

141 
$fÜm
['#t™Ë'] .ğ
	`t
('Inherit…ager');

142 
$fÜm
['šh”™_·g”'] = 
	`¬¿y
(

144 '#t™Ë' => 
	`t
('Inherit'),

145 '#desütiÚ' => 
	`t
('Shouldhis display inherit its…aging values fromhe…arent displayo which it is‡ttached? Notehathis will…rovide unexpected„esults ifhe‚umber of itemso display do‚ot match.'),

146 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('inherit_pager'),

150 
$fÜm
['#t™Ë'] .ğ
	`t
('Render…ager');

151 
$fÜm
['»nd”_·g”'] = 
	`¬¿y
(

153 '#t™Ë' => 
	`t
('Render'),

154 '#desütiÚ' => 
	`t
('Shouldhis display„enderhe…ager values? If‚ot it can inherit fromhe…arent...'),

155 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('render_pager'),

159 
$fÜm
['#t™Ë'] .ğ
	`t
('Position');

160 
$fÜm
['©chm’t_pos™iÚ'] = 
	`¬¿y
(

162 '#desütiÚ' => 
	`t
('Attach before or‡fterhe…arent display?'),

163 '#İtiÚs' => 
$this
->
	`©chm’t_pos™iÚs
(),

164 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('attachment_position'),

168 
$fÜm
['#t™Ë'] .ğ
	`t
('Attacho');

169 
$di¥Ïys
 = 
	`¬¿y
();

170 
	`fÜ—ch
 (
$this
->
v›w
->
di¥Ïy
 
as
 
$di¥Ïy_id
 => 
$di¥Ïy
) {

171 ià(!
	`em±y
(
$di¥Ïy
->
hªdËr
è&& $di¥Ïy->hªdËr->
	`acû±_©chm’ts
()) {

172 
$di¥Ïys
[
$di¥Ïy_id
] = 
$di¥Ïy
->
di¥Ïy_t™Ë
;

175 
$fÜm
['di¥Ïys'] = 
	`¬¿y
(

177 '#desütiÚ' => 
	`t
('Select which display or displayshis should‡ttacho.'),

178 '#İtiÚs' => 
$di¥Ïys
,

179 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('displays'),

183 
	}
}

189 
funùiÚ
 
	$İtiÚs_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

191 
·»Á
::
	`İtiÚs_subm™
(
$fÜm
, 
$fÜm_¡©e
);

192 
$fÜm_¡©e
['section']) {

199 
$this
->
	`£t_İtiÚ
(
$fÜm_¡©e
['section'], $form_state['values'][$form_state['section']]);

202 
	}
}

207 
funùiÚ
 
	$©ch_to
(
$di¥Ïy_id
) {

208 
$di¥Ïys
 = 
$this
->
	`g‘_İtiÚ
('displays');

210 ià(
	`em±y
(
$di¥Ïys
[
$di¥Ïy_id
])) {

214 ià(!
$this
->
	`acûss
()) {

220 
$v›w
 = 
$this
->
v›w
->
	`şÚe_v›w
();

221 
$v›w
->
Üigš®_¬gs
 = $v›w->
¬gs
;

223 
$¬gs
 = 
$this
->
	`g‘_İtiÚ
('šh”™_¬gum’ts'è? $this->
v›w
->
¬gs
 : 
	`¬¿y
();

224 
$v›w
->
	`£t_¬gum’ts
(
$¬gs
);

225 
$v›w
->
	`£t_di¥Ïy
(
$this
->
di¥Ïy
->
id
);

226 ià(
$this
->
	`g‘_İtiÚ
('inherit_pager')) {

227 
$v›w
->
di¥Ïy_hªdËr
->
u£_·g”
 = 
$this
->
v›w
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
->
	`u£_·g”
();

228 
$v›w
->
di¥Ïy_hªdËr
->
	`£t_İtiÚ
('·g”_–em’t', 
$this
->
v›w
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
->
	`g‘_İtiÚ
('pager_element'));

233 
$©chm’t
 = 
$v›w
->
	`execu‹_di¥Ïy
(
$this
->
di¥Ïy
->
id
, 
$¬gs
);

235 
$this
->
	`g‘_İtiÚ
('attachment_position')) {

237 
$this
->
v›w
->
©chm’t_befÜe
 .ğ
$©chm’t
;

240 
$this
->
v›w
->
©chm’t_aá”
 .ğ
$©chm’t
;

243 
$this
->
v›w
->
©chm’t_befÜe
 .ğ
$©chm’t
;

244 
$this
->
v›w
->
©chm’t_aá”
 .ğ
$©chm’t
;

248 
$v›w
->
	`de¡roy
();

249 
	}
}

256 
funùiÚ
 
	$u£s_expo£d
() {

257 ià(!
	`em±y
(
$this
->
İtiÚs
['šh”™_expo£d_f‹rs']è&& 
·»Á
::
	`u£s_expo£d
()) {

258  
TRUE
;

260  
FALSE
;

261 
	}
}

268 
funùiÚ
 
	$di¥Ïys_expo£d
() {

269  
$this
->
İtiÚs
['šh”™_expo£d_f‹rs'] ? 
FALSE
 : 
TRUE
;

270 
	}
}

272 
funùiÚ
 
	$u£_·g”
() {

273  !
	`em±y
(
$this
->
u£_·g”
);

274 
	}
}

276 
funùiÚ
 
	$»nd”_·g”
() {

277  !
	`em±y
(
$this
->
u£_·g”
è&& $this->
	`g‘_İtiÚ
('render_pager');

278 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_display_block.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_di¥Ïy_block
 
ex‹nds
 
	mv›ws_¶ugš_di¥Ïy
 {

14 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

15 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

17 
$İtiÚs
['block_desütiÚ'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

18 
$İtiÚs
['block_ÿchšg'] = 
	`¬¿y
('deçuÉ' => 
BLOCK_NO_CACHE
);

20  
$İtiÚs
;

28 
funùiÚ
 
	`execu‹_hook_block
(
$İ
 = 'li¡', 
$d–
 = 0, 
$ed™
 = 
	$¬¿y
()) {

29 ià(
$İ
 == 'list') {

30 
$d–
 = 
$this
->
v›w
->
Çme
 . '-' . $this->
di¥Ïy
->
id
;

31 
$desc
 = 
$this
->
	`g‘_İtiÚ
('block_description');

33 ià(
	`em±y
(
$desc
)) {

34 
$desc
 = 
	`t
('@v›w: @di¥Ïy', 
	`¬¿y
('@v›w' => 
$this
->
v›w
->
Çme
, '@di¥Ïy' => $this->
di¥Ïy
->
di¥Ïy_t™Ë
));

36  
	`¬¿y
(

37 
$d–
 => 
	`¬¿y
(

38 'šfo' => 
$desc
,

39 'ÿche' => 
$this
->
	`g‘_ÿche_ty³
()

43 
	}
}

48 
funùiÚ
 
	$execu‹
() {

51 
$šfo
['cÚ‹Á'] = 
$this
->
v›w
->
	`»nd”
();

52 
$šfo
['subjeù'] = 
	`f‹r_xss_admš
(
$this
->
v›w
->
	`g‘_t™Ë
());

53 ià(!
	`em±y
(
$this
->
v›w
->
»suÉ
è|| $this->
	`g‘_İtiÚ
('em±y'è|| !em±y($this->v›w->
¡yË_¶ugš
->
defš™iÚ
['evenƒmpty'])) {

54  
$šfo
;

56 
	}
}

63 
funùiÚ
 
	$İtiÚs_summ¬y
(&
$ÿ‹gÜ›s
, &
$İtiÚs
) {

65 
·»Á
::
	`İtiÚs_summ¬y
(
$ÿ‹gÜ›s
, 
$İtiÚs
);

67 
$ÿ‹gÜ›s
['block'] = 
	`¬¿y
(

68 't™Ë' => 
	`t
('Block settings'),

71 
$block_desütiÚ
 = 
	`¡r_gs
(
$this
->
	`g‘_İtiÚ
('block_description'));

72 ià(
	`em±y
(
$block_desütiÚ
)) {

73 
$block_desütiÚ
 = 
	`t
('None');

76 ià(
	`¡¾’
(
$block_desütiÚ
) > 16) {

77 
$block_desütiÚ
 = 
	`sub¡r
($block_description, 0, 16) . '...';

80 
$İtiÚs
['block_desütiÚ'] = 
	`¬¿y
(

82 't™Ë' => 
	`t
('Admin'),

83 'v®ue' => 
$block_desütiÚ
,

86 
$ÿche_ty³
 = 
$this
->
	`g‘_İtiÚ
('block_caching');

87 ià(
	`em±y
(
$ÿche_ty³
)) {

88 
$ÿche_ty³
 = 
BLOCK_NO_CACHE
;

91 
$ty³s
 = 
$this
->
	`block_ÿchšg_modes
();

92 
$İtiÚs
['block_ÿchšg'] = 
	`¬¿y
(

94 't™Ë' => 
	`t
('Caching'),

95 'v®ue' => 
$ty³s
[
$this
->
	`g‘_ÿche_ty³
()],

97 
	}
}

102 
funùiÚ
 
	$block_ÿchšg_modes
() {

103  
	`¬¿y
(

104 
BLOCK_NO_CACHE
 => 
	`t
('Do‚ot cache'),

105 
BLOCK_CACHE_GLOBAL
 => 
	`t
('Cache once forƒverything (global)'),

106 
BLOCK_CACHE_PER_PAGE
 => 
	`t
('Per…age'),

107 
BLOCK_CACHE_PER_ROLE
 => 
	`t
('Per„ole'),

108 
BLOCK_CACHE_PER_ROLE
 | 
BLOCK_CACHE_PER_PAGE
 => 
	`t
('Per„ole…er…age'),

109 
BLOCK_CACHE_PER_USER
 => 
	`t
('Per user'),

110 
BLOCK_CACHE_PER_USER
 | 
BLOCK_CACHE_PER_PAGE
 => 
	`t
('Per user…er…age'),

112 
	}
}

118 
funùiÚ
 
	$g‘_ÿche_ty³
() {

119 
$ÿche_ty³
 = 
$this
->
	`g‘_İtiÚ
('block_caching');

120 ià(
	`em±y
(
$ÿche_ty³
)) {

121 
$ÿche_ty³
 = 
BLOCK_NO_CACHE
;

123  
$ÿche_ty³
;

124 
	}
}

129 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

131 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

133 
$fÜm_¡©e
['section']) {

135 
$fÜm
['#t™Ë'] .ğ
	`t
('Block‡dmin description');

136 
$fÜm
['block_desütiÚ'] = 
	`¬¿y
(

138 '#desütiÚ' => 
	`t
('This will‡ppear‡she‚ame ofhis block in‡dminister >> site building >> blocks.'),

139 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('block_description'),

143 
$fÜm
['#t™Ë'] .ğ
	`t
('Block cachingype');

145 
$fÜm
['block_ÿchšg'] = 
	`¬¿y
(

147 '#desütiÚ' => 
	`t
("This setshe default status for Drupal's built-in block caching method;his„equireshat caching beurned on in block‡dministration,‡nd be careful because you have†ittle control over whenhis cache is flushed."),

148 '#İtiÚs' => 
$this
->
	`block_ÿchšg_modes
(),

149 '#deçuÉ_v®ue' => 
$this
->
	`g‘_ÿche_ty³
(),

153 
	}
}

159 
funùiÚ
 
	$İtiÚs_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

161 
·»Á
::
	`İtiÚs_subm™
(
$fÜm
, 
$fÜm_¡©e
);

162 
$fÜm_¡©e
['section']) {

164 
$this
->
	`£t_İtiÚ
('block_desütiÚ', 
$fÜm_¡©e
['values']['block_description']);

167 
$this
->
	`£t_İtiÚ
('block_ÿchšg', 
$fÜm_¡©e
['values']['block_caching']);

168 
$this
->
	`§ve_block_ÿche
(
$fÜm_¡©e
['v›w']->
Çme
.'-'.$form_state['display_id'], $form_state['values']['block_caching']);

171 
	}
}

176 
funùiÚ
 
	$u£s_expo£d
() {

177 ià(
$this
->
	`u£_ajax
()) {

178  
·»Á
::
	`u£s_expo£d
();

181  
FALSE
;

182 
	}
}

188 
funùiÚ
 
	$§ve_block_ÿche
(
$d–
, 
$ÿche_£‰šg
) {

189 ià(
$bid
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT bid, cachFROM {blocks} WHERE moduË = 'v›ws' AND d– = '%s'", 
$d–
))) {

190 
	`db_qu”y
("UPDATE {blocks} s‘ cachğ%d WHERE moduË = 'v›ws' AND d– = '%s'", 
$ÿche_£‰šg
, 
$d–
);

192 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_display_default.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_di¥Ïy_deçuÉ
 
ex‹nds
 
	mv›ws_¶ugš_di¥Ïy
 {

18 
funùiÚ
 
	$is_deçuÉ_di¥Ïy
(è{  
TRUE
; }

53 
funùiÚ
 
	$execu‹
() {

54  
$this
->
v›w
->
	`»nd”
($this->
di¥Ïy
->
id
);

55 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_display_feed.inc

1 <?
php


15 şas 
	cv›ws_¶ugš_di¥Ïy_ãed
 
ex‹nds
 
	mv›ws_¶ugš_di¥Ïy_·ge
 {

16 
funùiÚ
 
	$u£s_b»adüumb
(è{  
FALSE
; }

17 
funùiÚ
 
	$g‘_¡yË_ty³
(è{  'ãed'; 
	}
}

24 
funùiÚ
 
	$execu‹
() {

25 
$ouut
 = 
$this
->
v›w
->
	`»nd”
();

26 ià(
	`em±y
(
$ouut
)) {

27  
	`dru·l_nÙ_found
();

29 
´št
 
$ouut
;

30 
	}
}

32 
funùiÚ
 
	$´ev›w
() {

33 ià(!
	`em±y
(
$this
->
live_´ev›w
)) {

34  '<´e>' . 
	`check_¶aš
(
$this
->
v›w
->
	`»nd”
()) . '</pre>';

36  
$this
->
v›w
->
	`»nd”
();

37 
	}
}

43 
funùiÚ
 
	$»nd”
() {

44  
$this
->
v›w
->
¡yË_¶ugš
->
	`»nd”
($this->v›w->
»suÉ
);

45 
	}
}

47 
funùiÚ
 
	$deçuÉabË_£ùiÚs
(
$£ùiÚ
 = 
NULL
) {

48 ià(
	`š_¬¿y
(
$£ùiÚ
, 
	`¬¿y
('style_options', 'style_plugin', 'row_options', 'row_plugin',))) {

49  
FALSE
;

52 
$£ùiÚs
 = 
·»Á
::
	`deçuÉabË_£ùiÚs
(
$£ùiÚ
);

55 ià(
$£ùiÚ
 == 'title') {

56 
$£ùiÚs
[] = 'sitename_title';

58 
	`–£if
 (!
$£ùiÚ
) {

59 
$£ùiÚs
['title'][] = 'sitename_title';

61  
$£ùiÚs
;

62 
	}
}

64 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

65 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

67 
$İtiÚs
['di¥Ïys'] = 
	`¬¿y
('default' =>‡rray());

70 
$İtiÚs
['style_plugin']['default'] = 'rss';

71 
$İtiÚs
['¡yË_İtiÚs']['deçuÉ'] = 
	`¬¿y
('missiÚ_desütiÚ' => 
FALSE
, 'description' => '');

72 
$İtiÚs
['s™’ame_t™Ë']['deçuÉ'] = 
FALSE
;

73 
$İtiÚs
['row_plugin']['default'] = '';

74 
$İtiÚs
['deçuÉs']['deçuÉ']['¡yË_¶ugš'] = 
FALSE
;

75 
$İtiÚs
['deçuÉs']['deçuÉ']['¡yË_İtiÚs'] = 
FALSE
;

76 
$İtiÚs
['deçuÉs']['deçuÉ']['row_¶ugš'] = 
FALSE
;

77 
$İtiÚs
['deçuÉs']['deçuÉ']['row_İtiÚs'] = 
FALSE
;

79  
$İtiÚs
;

80 
	}
}

82 
funùiÚ
 
	$İtiÚs_summ¬y
(&
$ÿ‹gÜ›s
, &
$İtiÚs
) {

84 
·»Á
::
	`İtiÚs_summ¬y
(
$ÿ‹gÜ›s
, 
$İtiÚs
);

88 
$ÿ‹gÜ›s
['·ge'] = 
	`¬¿y
(

89 't™Ë' => 
	`t
('Feed settings'),

92 ià(
$this
->
	`g‘_İtiÚ
('sitename_title')) {

93 
$İtiÚs
['t™Ë']['v®ue'] = 
	`t
('Usinghe site‚ame');

97 
	`un£t
(
$İtiÚs
['menu']);

99 
$di¥Ïys
 = 
	`¬¿y_f‹r
(
$this
->
	`g‘_İtiÚ
('displays'));

100 ià(
	`couÁ
(
$di¥Ïys
) > 1) {

101 
$©ch_to
 = 
	`t
('Multiple displays');

103 ià(
	`couÁ
(
$di¥Ïys
) == 1) {

104 
$di¥Ïy
 = 
	`¬¿y_shiá
(
$di¥Ïys
);

105 ià(!
	`em±y
(
$this
->
v›w
->
di¥Ïy
[
$di¥Ïy
])) {

106 
$©ch_to
 = 
	`check_¶aš
(
$this
->
v›w
->
di¥Ïy
[
$di¥Ïy
]->
di¥Ïy_t™Ë
);

110 ià(!
	`is£t
(
$©ch_to
)) {

111 
$©ch_to
 = 
	`t
('None');

114 
$İtiÚs
['di¥Ïys'] = 
	`¬¿y
(

116 't™Ë' => 
	`t
('Attacho'),

117 'v®ue' => 
$©ch_to
,

119 
	}
}

124 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

126 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

128 
$fÜm_¡©e
['section']) {

130 
$t™Ë
 = 
$fÜm
['title'];

132 
	`un£t
(
$fÜm
['title']);

133 
$fÜm
['s™’ame_t™Ë'] = 
	`¬¿y
(

135 '#t™Ë' => 
	`t
('Usehe site‚ame forheitle'),

136 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('sitename_title'),

138 
$fÜm
['t™Ë'] = 
$t™Ë
;

139 
$fÜm
['t™Ë']['#´oûss'] = 
	`¬¿y
('views_process_dependency');

140 
$fÜm
['t™Ë']['#d•’d’cy'] = 
	`¬¿y
('ed™-s™’ame-t™Ë' =>‡¼ay(
FALSE
));

143 
$fÜm
['#t™Ë'] .ğ
	`t
('Attacho');

144 
$di¥Ïys
 = 
	`¬¿y
();

145 
	`fÜ—ch
 (
$this
->
v›w
->
di¥Ïy
 
as
 
$di¥Ïy_id
 => 
$di¥Ïy
) {

146 ià(!
	`em±y
(
$di¥Ïy
->
hªdËr
è&& $di¥Ïy->hªdËr->
	`acû±_©chm’ts
()) {

147 
$di¥Ïys
[
$di¥Ïy_id
] = 
$di¥Ïy
->
di¥Ïy_t™Ë
;

150 
$fÜm
['di¥Ïys'] = 
	`¬¿y
(

152 '#desütiÚ' => 
	`t
('The feed icon will be‡vailable onlyohe selected displays.'),

153 '#İtiÚs' => 
$di¥Ïys
,

154 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('displays'),

158 
$fÜm
['·th']['#desütiÚ'] = 
	`t
('This view will be displayed by visitinghis…ath on your site. It is„ecommendedhathe…ath be something†ike "path/%/%/feed" or "path/%/%/rss.xml",…utting one % inhe…ath forƒach‡rgument you have defined inhe view.');

160 
	}
}

166 
funùiÚ
 
	$İtiÚs_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

168 
·»Á
::
	`İtiÚs_subm™
(
$fÜm
, 
$fÜm_¡©e
);

169 
$fÜm_¡©e
['section']) {

171 
$this
->
	`£t_İtiÚ
('s™’ame_t™Ë', 
$fÜm_¡©e
['values']['sitename_title']);

174 
$this
->
	`£t_İtiÚ
(
$fÜm_¡©e
['section'], $form_state['values'][$form_state['section']]);

177 
	}
}

182 
funùiÚ
 
	$©ch_to
(
$di¥Ïy_id
) {

183 
$di¥Ïys
 = 
$this
->
	`g‘_İtiÚ
('displays');

184 ià(
	`em±y
(
$di¥Ïys
[
$di¥Ïy_id
])) {

190 
$¶ugš
 = 
$this
->
	`g‘_¶ugš
();

191 ià(
$¶ugš
) {

192 
$şÚe
 = 
$this
->
v›w
->
	`şÚe_v›w
();

193 
$şÚe
->
	`£t_di¥Ïy
(
$this
->
di¥Ïy
->
id
);

194 
$şÚe
->
	`bud_t™Ë
();

195 
$¶ugš
->
	`©ch_to
(
$di¥Ïy_id
, 
$this
->
	`g‘_·th
(), 
$şÚe
->
	`g‘_t™Ë
());

197 
	}
}

199 
funùiÚ
 
	$u£s_lšk_di¥Ïy
() {

200  
TRUE
;

201 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_display_page.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_di¥Ïy_·ge
 
ex‹nds
 
	mv›ws_¶ugš_di¥Ïy
 {

17 
funùiÚ
 
	$has_·th
(è{  
TRUE
; }

18 
funùiÚ
 
	$u£s_b»adüumb
(è{  
TRUE
; 
	}
}

20 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

21 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

23 
$İtiÚs
['·th'] = 
	`¬¿y
('default' => '');

24 
$İtiÚs
['m’u'] = 
	`¬¿y
(

25 'cÚšs' => 
	`¬¿y
(

26 'ty³' => 
	`¬¿y
('default' => 'none'),

28 't™Ë' => 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
FALSE
),

29 'desütiÚ' => 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
FALSE
),

30 'weight' => 
	`¬¿y
('default' => 0),

31 'Çme' => 
	`¬¿y
('default' => 'navigation'),

34 
$İtiÚs
['b_İtiÚs'] = 
	`¬¿y
(

35 'cÚšs' => 
	`¬¿y
(

36 'ty³' => 
	`¬¿y
('default' => 'none'),

38 't™Ë' => 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
FALSE
),

39 'desütiÚ' => 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
FALSE
),

40 'weight' => 
	`¬¿y
('default' => 0),

41 'Çme' => 
	`¬¿y
('default' => 'navigation'),

45  
$İtiÚs
;

46 
	}
}

51 
funùiÚ
 
	$execu‹_hook_m’u
(
$ÿÎbacks
) {

52 
$™ems
 = 
	`¬¿y
();

56 
$b™s
 = 
	`ex¶ode
('/', 
$this
->
	`g‘_İtiÚ
('path'));

57 
$·ge_¬gum’ts
 = 
	`¬¿y
(
$this
->
v›w
->
Çme
, $this->
di¥Ïy
->
id
);

61 
	`fÜ—ch
(
$b™s
 
as
 
$pos
 => 
$b™
) {

62 ià(
$b™
 == '%') {

63 
$b™s
[
$pos
] = '%views_arg';

64 
$·ge_¬gum’ts
[] = 
$pos
;

68 
$·th
 = 
	`im¶ode
('/', 
$b™s
);

70 
$acûss_¶ugš
 = 
$this
->
	`g‘_acûss_¶ugš
();

71 ià(!
	`is£t
(
$acûss_¶ugš
)) {

72 
$acûss_¶ugš
 = 
	`v›ws_g‘_¶ugš
('access', 'none');

74 ià(
$·th
) {

75 
$™ems
[
$·th
] = 
	`¬¿y
(

78 '·g¬gum’ts' => 
$·ge_¬gum’ts
,

81 'acûs ¬gum’ts' => 
	`¬¿y
(
$acûss_¶ugš
->
	`g‘_acûss_ÿÎback
()),

83 'lßd‡rgum’ts' => 
	`¬¿y
(
$this
->
v›w
->
Çme
, $this->
di¥Ïy
->
id
, '%index'),

85 
$m’u
 = 
$this
->
	`g‘_İtiÚ
('menu');

86 ià(
	`em±y
(
$m’u
)) {

87 
$m’u
 = 
	`¬¿y
('type' => 'none');

90 ià(
$m’u
['type'] != 'none') {

91 
$™ems
[
$·th
]['t™Ë'] = 
$m’u
['title'];

92 
$™ems
[
$·th
]['desütiÚ'] = 
$m’u
['description'];

95 ià(
	`is£t
(
$m’u
['weight'])) {

96 
$™ems
[
$·th
]['weight'] = 
	`štv®
(
$m’u
['weight']);

99 
$m’u
['type']) {

102 
$™ems
[
$·th
]['ty³'] = 
MENU_CALLBACK
;

105 
$™ems
[
$·th
]['ty³'] = 
MENU_NORMAL_ITEM
;

107 
$™ems
[
$·th
]['m’u_Çme'] = 
$m’u
['name'];

110 
$™ems
[
$·th
]['ty³'] = 
MENU_LOCAL_TASK
;

113 
$™ems
[
$·th
]['ty³'] = 
MENU_DEFAULT_LOCAL_TASK
;

119 ià(
$m’u
['type'] == 'defaultab') {

120 
$b_İtiÚs
 = 
$this
->
	`g‘_İtiÚ
('tab_options');

121 ià(!
	`em±y
(
$b_İtiÚs
['type']) && $tab_options['type'] != 'none') {

122 
$b™s
 = 
	`ex¶ode
('/', 
$·th
);

124 
$b™
 = 
	`¬¿y_pİ
(
$b™s
);

128 ià(
$b™
 !ğ'%v›ws_¬g' && !
	`em±y
(
$b™s
)) {

129 
$deçuÉ_·th
 = 
	`im¶ode
('/', 
$b™s
);

130 
$™ems
[
$deçuÉ_·th
] = 
	`¬¿y
(

133 '·g¬gum’ts' => 
$·ge_¬gum’ts
,

136 'acûs ¬gum’ts' => 
	`¬¿y
(
$acûss_¶ugš
->
	`g‘_acûss_ÿÎback
()),

138 'lßd‡rgum’ts' => 
	`¬¿y
(
$this
->
v›w
->
Çme
, $this->
di¥Ïy
->
id
, '%index'),

139 't™Ë' => 
$b_İtiÚs
['title'],

140 'desütiÚ' => 
$b_İtiÚs
['description'],

141 'm’u_Çme' => 
$b_İtiÚs
['name'],

143 
$b_İtiÚs
['type']) {

146 
$™ems
[
$deçuÉ_·th
]['ty³'] = 
MENU_NORMAL_ITEM
;

149 
$™ems
[
$deçuÉ_·th
]['ty³'] = 
MENU_LOCAL_TASK
;

152 ià(
	`is£t
(
$b_İtiÚs
['weight'])) {

153 
$™ems
[
$deçuÉ_·th
]['weight'] = 
	`štv®
(
$b_İtiÚs
['weight']);

160  
$™ems
;

161 
	}
}

168 
funùiÚ
 
	$execu‹
() {

170 
	`v›ws_£t_·ge_v›w
(
$this
);

174 
$this
->
v›w
->
	`bud
();

175 ià(!
	`em±y
(
$this
->
v›w
->
bud_šfo
['fail'])) {

176  
	`dru·l_nÙ_found
();

179 
$this
->
v›w
->
	`g‘_b»adüumb
(
TRUE
);

182 
	`dru·l_£t_t™Ë
(
	`f‹r_xss_admš
(
$this
->
v›w
->
	`g‘_t™Ë
()));

185  
$this
->
v›w
->
	`»nd”
();

186 
	}
}

193 
funùiÚ
 
	$İtiÚs_summ¬y
(&
$ÿ‹gÜ›s
, &
$İtiÚs
) {

195 
·»Á
::
	`İtiÚs_summ¬y
(
$ÿ‹gÜ›s
, 
$İtiÚs
);

197 
$ÿ‹gÜ›s
['·ge'] = 
	`¬¿y
(

198 't™Ë' => 
	`t
('Page settings'),

201 
$·th
 = 
	`¡r_gs
(
$this
->
	`g‘_İtiÚ
('path'));

202 ià(
	`em±y
(
$·th
)) {

203 
$·th
 = 
	`t
('None');

206 ià(
	`¡¾’
(
$·th
) > 16) {

207 
$·th
 = 
	`sub¡r
($path, 0, 16) . '...';

210 
$İtiÚs
['·th'] = 
	`¬¿y
(

212 't™Ë' => 
	`t
('Path'),

213 'v®ue' => 
$·th
,

216 
$m’u
 = 
$this
->
	`g‘_İtiÚ
('menu');

217 ià(!
	`is_¬¿y
(
$m’u
)) {

218 
$m’u
 = 
	`¬¿y
('type' => 'none');

220 
$m’u
['type']) {

223 
$m’u_¡r
 = 
	`t
('No menu');

226 
$m’u_¡r
 = 
	`t
('NÜm®: @t™Ë', 
	`¬¿y
('@t™Ë' => 
$m’u
['title']));

230 
$m’u_¡r
 = 
	`t
('Tab: @t™Ë', 
	`¬¿y
('@t™Ë' => 
$m’u
['title']));

234 ià(
	`¡¾’
(
$m’u_¡r
) > 16) {

235 
$m’u_¡r
 = 
	`sub¡r
($menu_str, 0, 16) . '...';

238 
$İtiÚs
['m’u'] = 
	`¬¿y
(

240 't™Ë' => 
	`t
('Menu'),

241 'v®ue' => 
$m’u_¡r
,

245 ià(
$m’u
['type'] == 'defaultab') {

246 
$İtiÚs
['m’u']['lšks']['b_İtiÚs'] = 
	`t
('Change settings forhe…arent menu');

248 
	}
}

253 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

255 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

257 
$fÜm_¡©e
['section']) {

259 
$fÜm
['#t™Ë'] .ğ
	`t
('The menu…ath or URL ofhis view');

260 
$fÜm
['#help_topic'] = 'path';

261 
$fÜm
['·th'] = 
	`¬¿y
(

263 '#desütiÚ' => 
	`t
('This view will be displayed by visitinghis…ath on your site. You may use "%" in your URLo„epresent valueshat will be used for‡rguments: Forƒxample, "node/%/feed".'),

264 '#deçuÉ_v®ue' => 
$this
->
	`g‘_İtiÚ
('path'),

265 '#f›ld_´efix' => '<¥ª dœ="Ér">' . 
	`u¾
(
NULL
, 
	`¬¿y
('absŞu‹' => 
TRUE
)è. (
	`v¬ŸbË_g‘
('clean_url', 0) ? '' : '?q='),

267 '#©Œibu‹s' => 
	`¬¿y
('dir'=>'ltr'),

271 
$fÜm
['#t™Ë'] .ğ
	`t
('Menu itemƒntry');

272 
$fÜm
['#help_topic'] = 'menu';

273 
$fÜm
['m’u'] = 
	`¬¿y
(

276 '#Œ“' => 
TRUE
,

278 
$m’u
 = 
$this
->
	`g‘_İtiÚ
('menu');

279 ià(
	`em±y
(
$m’u
)) {

280 
$m’u
 = 
	`¬¿y
('type' => 'none', 'title' => '', 'weight' => 0);

282 
$fÜm
['m’u']['ty³'] = 
	`¬¿y
(

285 '#t™Ë' => 
	`t
('Type'),

287 '#İtiÚs' => 
	`¬¿y
(

288 'nÚe' => 
	`t
('No menuƒntry'),

289 'nÜm®' => 
	`t
('Normal menuƒntry'),

290 'b' => 
	`t
('Menuab'),

291 'deçuÉab' => 
	`t
('Default menuab')

293 '#deçuÉ_v®ue' => 
$m’u
['type'],

295 
$fÜm
['m’u']['t™Ë'] = 
	`¬¿y
(

297 '#t™Ë' => 
	`t
('Title'),

299 '#deçuÉ_v®ue' => 
$m’u
['title'],

300 '#desütiÚ' => 
	`t
('If seto‚ormal orab,ƒnterheexto use forhe menu item.'),

301 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

302 '#d•’d’cy' => 
	`¬¿y
('radio:menu[type]' =>‡rray('normal', 'tab', 'defaultab')),

304 
$fÜm
['m’u']['desütiÚ'] = 
	`¬¿y
(

305 '#t™Ë' => 
	`t
('Description'),

307 '#deçuÉ_v®ue' => 
$m’u
['description'],

308 '#desütiÚ' => 
	`t
("If seto‚ormal orab,ƒnterheexto use forhe menu item's description."),

309 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

310 '#d•’d’cy' => 
	`¬¿y
('radio:menu[type]' =>‡rray('normal', 'tab', 'defaultab')),

312 
$fÜm
['m’u']['Çme-w¬nšg'] = 
	`¬¿y
(

315 '#v®ue' => 
	`t
("W¬nšg: Chªgšghi ™em' m’u wÈnÙ wÜk„–Ÿbly iÀDru·È6.4 o¸—¾›r. PËa£ upg¿dyou¸cİy oàDru·È© !u¾.", 
	`¬¿y
('!u¾' => 
	`l
('drupal.org', 'http://drupal.org/project/Drupal+project'))),

317 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

318 '#d•’d’cy' => 
	`¬¿y
('radio:menu[type]' =>‡rray('normal')),

319 '#acûss' => 
	`v”siÚ_com·»
(
VERSION
, '6.5', '<'),

323 ià(
	`moduË_exi¡s
('menu')) {

324 
$fÜm
['m’u']['Çme'] = 
	`¬¿y
(

325 '#t™Ë' => 
	`t
('Menu'),

327 '#İtiÚs' => 
	`m’u_g‘_m’us
(),

328 '#deçuÉ_v®ue' => 
$m’u
['name'],

329 '#desütiÚ' => 
	`t
('Insert item into‡n‡vailable menu.'),

330 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

331 '#d•’d’cy' => 
	`¬¿y
('radio:menu[type]' =>‡rray('normal')),

335 
$fÜm
['m’u']['Çme'] = 
	`¬¿y
(

337 '#v®ue' => 
$m’u
['name'],

339 
$fÜm
['m’u']['m¬kup'] = 
	`¬¿y
(

340 '#v®ue' => 
	`t
('Menu selection„equireshe‡ctivation of menu module.'),

343 
$fÜm
['m’u']['weight'] = 
	`¬¿y
(

345 '#t™Ë' => 
	`t
('Weight'),

347 '#deçuÉ_v®ue' => 
	`is£t
(
$m’u
['weight']) ? $menu['weight'] : 0,

348 '#desütiÚ' => 
	`t
('The†owerhe weighthe higher/further†eft it will‡ppear.'),

349 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

350 '#d•’d’cy' => 
	`¬¿y
('radio:menu[type]' =>‡rray('normal', 'tab', 'defaultab')),

354 
$fÜm
['#t™Ë'] .ğ
	`t
('Defaultab options');

355 
$b_İtiÚs
 = 
$this
->
	`g‘_İtiÚ
('tab_options');

356 ià(
	`em±y
(
$b_İtiÚs
)) {

357 
$b_İtiÚs
 = 
	`¬¿y
('type' => 'none', 'title' => '', 'weight' => 0);

360 
$fÜm
['b_m¬kup'] = 
	`¬¿y
(

363 '#v®ue' => 
	`t
('When…roviding‡ menu item‡s‡ab, Drupal‚eedso know whathe…arent menu item ofhatab will be. Sometimeshe…arent will‡lreadyƒxist, but otherimes you will‚eedo have one created. The…ath of‡…arent item will‡lways behe same…ath withhe†ast…art†eft off. i.e, ifhe…athohis view is <em>foo/bar/baz</em>,he…arent…ath would be <em>foo/bar</em>.'),

366 
$fÜm
['b_İtiÚs'] = 
	`¬¿y
(

369 '#Œ“' => 
TRUE
,

371 
$fÜm
['b_İtiÚs']['ty³'] = 
	`¬¿y
(

374 '#t™Ë' => 
	`t
('Parent menu item'),

376 '#İtiÚs' => 
	`¬¿y
('nÚe' => 
	`t
('Alreadyƒxists'), 'normal' =>('Normal menu item'), 'tab' =>('Menuab')),

377 '#deçuÉ_v®ue' => 
$b_İtiÚs
['type'],

379 
$fÜm
['b_İtiÚs']['t™Ë'] = 
	`¬¿y
(

381 '#t™Ë' => 
	`t
('Title'),

383 '#deçuÉ_v®ue' => 
$b_İtiÚs
['title'],

384 '#desütiÚ' => 
	`t
('If creating‡…arent menu item,ƒnterheitle ofhe item.'),

385 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

386 '#d•’d’cy' => 
	`¬¿y
('radio:tab_options[type]' =>‡rray('normal', 'tab')),

388 
$fÜm
['b_İtiÚs']['desütiÚ'] = 
	`¬¿y
(

389 '#t™Ë' => 
	`t
('Description'),

391 '#deçuÉ_v®ue' => 
$b_İtiÚs
['description'],

392 '#desütiÚ' => 
	`t
('If creating‡…arent menu item,ƒnterhe description ofhe item.'),

393 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

394 '#d•’d’cy' => 
	`¬¿y
('radio:tab_options[type]' =>‡rray('normal', 'tab')),

397 ià(
	`moduË_exi¡s
('menu')) {

398 
$fÜm
['b_İtiÚs']['Çme'] = 
	`¬¿y
(

399 '#t™Ë' => 
	`t
('Menu'),

401 '#İtiÚs' => 
	`m’u_g‘_m’us
(),

402 '#deçuÉ_v®ue' => 
$b_İtiÚs
['name'],

403 '#desütiÚ' => 
	`t
('Insert item into‡n‡vailable menu.'),

404 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

405 '#d•’d’cy' => 
	`¬¿y
('radio:tab_options[type]' =>‡rray('normal')),

409 
$fÜm
['b_İtiÚs']['Çme'] = 
	`¬¿y
(

411 '#v®ue' => 
$b_İtiÚs
['name'],

413 
$fÜm
['b_İtiÚs']['m¬kup'] = 
	`¬¿y
(

414 '#v®ue' => 
	`t
('Menu selection„equireshe‡ctivation of menu module.'),

417 
$fÜm
['b_İtiÚs']['weight'] = 
	`¬¿y
(

419 '#t™Ë' => 
	`t
('Tab weight'),

421 '#deçuÉ_v®ue' => 
$b_İtiÚs
['weight'],

423 '#desütiÚ' => 
	`t
('Ifhe…arent menu item is‡ab,ƒnterhe weight ofheab. The†owerhe‚umber,he moreohe†eft it will be.'),

424 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

425 '#d•’d’cy' => 
	`¬¿y
('radio:tab_options[type]' =>‡rray('tab')),

429 
	}
}

431 
funùiÚ
 
	$İtiÚs_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
) {

433 
·»Á
::
	`İtiÚs_v®id©e
(
$fÜm
, 
$fÜm_¡©e
);

434 
$fÜm_¡©e
['section']) {

436 ià(
	`¡½os
(
$fÜm_¡©e
['v®ues']['·th'], '$¬g'è!=ğ
FALSE
) {

437 
	`fÜm_”rÜ
(
$fÜm
['·th'], 
	`t
('"$arg" is‚o†onger supported. Use % instead.'));

440 ià(
	`¡½os
(
$fÜm_¡©e
['values']['path'], '%') === 0) {

441 
	`fÜm_”rÜ
(
$fÜm
['·th'], 
	`t
('"%" may‚ot be used forhe first segment of‡…ath.'));

445 
$fÜm_¡©e
['v®ues']['·th'] = 
	`Œim
($form_state['values']['path'], '/');

449 
$·th
 = 
$this
->
	`g‘_İtiÚ
('path');

450 ià(
$fÜm_¡©e
['v®ues']['m’u']['ty³'] =ğ'nÜm®' && 
	`¡½os
(
$·th
, '%'è!=ğ
FALSE
) {

451 
	`fÜm_”rÜ
(
$fÜm
['m’u']['ty³'], 
	`t
('Views cannot create‚ormal menu items for…aths with‡ % inhem.'));

454 ià(
$fÜm_¡©e
['values']['menu']['type'] == 'defaultab' || $form_state['values']['menu']['type'] == 'tab') {

455 
$b™s
 = 
	`ex¶ode
('/', 
$·th
);

456 
$Ï¡
 = 
	`¬¿y_pİ
(
$b™s
);

457 ià(
$Ï¡
 == '%') {

458 
	`fÜm_”rÜ
(
$fÜm
['m’u']['ty³'], 
	`t
('A display whose…athƒnds with‡ % cannot be‡ab.'));

462 ià(
$fÜm_¡©e
['v®ues']['m’u']['ty³'] !ğ'nÚe' && 
	`em±y
($form_state['values']['menu']['title'])) {

463 
	`fÜm_”rÜ
(
$fÜm
['m’u']['t™Ë'], 
	`t
('Title is„equired forhis menuype.'));

467 
	}
}

469 
funùiÚ
 
	$İtiÚs_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

471 
·»Á
::
	`İtiÚs_subm™
(
$fÜm
, 
$fÜm_¡©e
);

472 
$fÜm_¡©e
['section']) {

474 
$this
->
	`£t_İtiÚ
('·th', 
$fÜm_¡©e
['values']['path']);

477 
$this
->
	`£t_İtiÚ
('m’u', 
$fÜm_¡©e
['values']['menu']);

479 ià(
$fÜm_¡©e
['values']['menu']['type'] == 'defaultab') {

480 
	`v›ws_ui_add_fÜm_to_¡ack
('di¥Ïy', 
$this
->
v›w
, $this->
di¥Ïy
->
id
, 
	`¬¿y
('tab_options'));

484 
$this
->
	`£t_İtiÚ
('b_İtiÚs', 
$fÜm_¡©e
['values']['tab_options']);

487 
	}
}

489 
funùiÚ
 
	$v®id©e
() {

490 
$”rÜs
 = 
·»Á
::
	`v®id©e
();

492 
$m’u
 = 
$this
->
	`g‘_İtiÚ
('menu');

493 ià(!
	`em±y
(
$m’u
['type']) && $menu['type'] != 'none' &&ƒmpty($menu['title'])) {

494 
$”rÜs
[] = 
	`t
('Di¥Ïy @di¥Ïy i £ˆtØu£‡ m’u buˆthm’u™Ë i nÙ s‘.', 
	`¬¿y
('@di¥Ïy' => 
$this
->
di¥Ïy
->
di¥Ïy_t™Ë
));

497 ià(
$m’u
['type'] == 'defaultab') {

498 
$b_İtiÚs
 = 
$this
->
	`g‘_İtiÚ
('tab_options');

499 ià(!
	`em±y
(
$b_İtiÚs
['type']) && $tab_options['type'] != 'none' &&ƒmpty($tab_options['title'])) {

500 
$”rÜs
[] = 
	`t
('Di¥Ïy @di¥Ïy i £ˆtØu£‡…¬’ˆm’u buˆth·»Á m’u™Ë i nÙ s‘.', 
	`¬¿y
('@di¥Ïy' => 
$this
->
di¥Ïy
->
di¥Ïy_t™Ë
));

504  
$”rÜs
;

505 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_row.inc

1 <?
php


25 şas 
	cv›ws_¶ugš_row
 
ex‹nds
 
	mv›ws_¶ugš
 {

29 
funùiÚ
 
	$š™
(&
$v›w
, &
$di¥Ïy
, 
$İtiÚs
 = 
NULL
) {

30 
$this
->
v›w
 = &
$v›w
;

31 
$this
->
di¥Ïy
 = &
$di¥Ïy
;

34 
$this
->
	`uÅack_İtiÚs
($this->
İtiÚs
, 
	`is£t
(
$İtiÚs
è? $İtiÚ : 
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('row_options'));

37 
funùiÚ
 
	$u£s_f›lds
() {

38  !
	`em±y
(
$this
->
defš™iÚ
['uses fields']);

39 
	}
}

42 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

43 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

44 ià(
	`is£t
(
$this
->
ba£_bË
)) {

45 
$İtiÚs
['»ÏtiÚsh'] = 
	`¬¿y
('default' => 'none');

48  
$İtiÚs
;

49 
	}
}

54 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

55 ià(
	`is£t
(
$this
->
ba£_bË
)) {

56 
$v›w
 = &
$fÜm_¡©e
['view'];

60 
$»ÏtiÚshs
 = 
$v›w
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('relationships');

61 
$»ÏtiÚsh_İtiÚs
 = 
	`¬¿y
();

63 
	`fÜ—ch
 (
$»ÏtiÚshs
 
as
 
$»ÏtiÚsh
) {

64 
$»ÏtiÚsh_hªdËr
 = 
	`v›ws_g‘_hªdËr
(
$»ÏtiÚsh
['table'], $relationship['field'], 'relationship');

67 
$d©a
 = 
	`v›ws_ãtch_d©a
(
$»ÏtiÚsh
['table']);

68 
$ba£
 = 
$d©a
[
$»ÏtiÚsh
['field']]['relationship']['base'];

69 ià(
$ba£
 =ğ
$this
->
ba£_bË
) {

70 
$»ÏtiÚsh_hªdËr
->
	`š™
(
$v›w
, 
$»ÏtiÚsh
);

71 
$»ÏtiÚsh_İtiÚs
[
$»ÏtiÚsh
['id']] = 
$»ÏtiÚsh_hªdËr
->
	`Ïb–
();

75 ià(!
	`em±y
(
$»ÏtiÚsh_İtiÚs
)) {

76 
$»ÏtiÚsh_İtiÚs
 = 
	`¬¿y_m”ge
(
	`¬¿y
('nÚe' => 
	`t
('Do‚ot use‡„elationship')), $relationship_options);

77 
$»l
 = 
	`em±y
(
$this
->
İtiÚs
['relationship']) ? 'none' : $this->options['relationship'];

78 ià(
	`em±y
(
$»ÏtiÚsh_İtiÚs
[
$»l
])) {

80 
$»l
 = 
	`key
(
$»ÏtiÚsh_İtiÚs
);

83 
$fÜm
['»ÏtiÚsh'] = 
	`¬¿y
(

85 '#t™Ë' => 
	`t
('Relationship'),

86 '#İtiÚs' => 
$»ÏtiÚsh_İtiÚs
,

87 '#deçuÉ_v®ue' => 
$»l
,

91 
$fÜm
['»ÏtiÚsh'] = 
	`¬¿y
(

97 
	}
}

102 
funùiÚ
 
	$İtiÚs_v®id©e
(
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

108 
funùiÚ
 
	$İtiÚs_subm™
(
$fÜm
, &
$fÜm_¡©e
è{ 
	}
}

110 
funùiÚ
 
	$qu”y
() {

111 ià(
	`is£t
(
$this
->
ba£_bË
è&& is£t($this->
İtiÚs
['»ÏtiÚsh']è&& is£t($this->
v›w
->
»ÏtiÚsh
[$this->options['relationship']])) {

112 
$»ÏtiÚsh
 = 
$this
->
v›w
->
»ÏtiÚsh
[$this->
İtiÚs
['relationship']];

113 
$this
->
f›ld_®Ÿs
 = $this->
v›w
->
qu”y
->
	`add_f›ld
(
$»ÏtiÚsh
->
®Ÿs
, $this->
ba£_f›ld
);

116 
$this
->
f›ld_®Ÿs
 = $this->
v›w
->
ba£_f›ld
;

118 
	}
}

126 
funùiÚ
 
	$´e_»nd”
(
$»suÉ
è{ 
	}
}

132 
funùiÚ
 
	$»nd”
(
$row
) {

133  
	`theme
(
$this
->
	`theme_funùiÚs
(), $this->
v›w
, $this->
İtiÚs
, 
$row
, $this->
f›ld_®Ÿs
);

134 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_row_fields.inc

1 <?
php


16 şas 
	cv›ws_¶ugš_row_f›lds
 
ex‹nds
 
	mv›ws_¶ugš_row
 {

17 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

18 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

20 
$İtiÚs
['šlše'] = 
	`¬¿y
('default' =>‡rray());

21 
$İtiÚs
['£·¿tÜ'] = 
	`¬¿y
('default' => '');

22 
$İtiÚs
['hide_em±y'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

23  
$İtiÚs
;

29 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

30 
$İtiÚs
 = 
$this
->
di¥Ïy
->
hªdËr
->
	`g‘_f›ld_Ïb–s
();

32 ià(
	`em±y
(
$this
->
İtiÚs
['inline'])) {

33 
$this
->
İtiÚs
['šlše'] = 
	`¬¿y
();

36 
$fÜm
['šlše'] = 
	`¬¿y
(

38 '#t™Ë' => 
	`t
('Inline fields'),

39 '#İtiÚs' => 
$İtiÚs
,

40 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['inline'],

41 '#desütiÚ' => 
	`t
('Inline fields will be displayed‚extoƒach other„atherhan one‡fter‡nother.'),

44 
$fÜm
['£·¿tÜ'] = 
	`¬¿y
(

45 '#t™Ë' => 
	`t
('Separator'),

48 '#deçuÉ_v®ue' => 
	`is£t
(
$this
->
İtiÚs
['separator']) ? $this->options['separator'] : '',

49 '#desütiÚ' => 
	`t
('The separator may be…laced between inline fieldso keephem from squishing up‚extoƒach other. You can use HTML inhis field.'),

52 
$fÜm
['hide_em±y'] = 
	`¬¿y
(

54 '#t™Ë' => 
	`t
('Hideƒmpty fields'),

55 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['hide_empty'],

56 '#desütiÚ' => 
	`t
('Do‚ot display fields,†abels or markup for fieldshat‡reƒmpty.'),

58 
	}
}

64 
funùiÚ
 
	$İtiÚs_subm™
(
$fÜm
, &
$fÜm_¡©e
) {

65 
$fÜm_¡©e
['v®ues']['row_İtiÚs']['šlše'] = 
	`¬¿y_f‹r
($form_state['values']['row_options']['inline']);

66 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style.inc

1 <?
php


21 şas 
	cv›ws_¶ugš_¡yË
 
ex‹nds
 
	mv›ws_¶ugš
 {

31 
funùiÚ
 
	$š™
(&
$v›w
, &
$di¥Ïy
, 
$İtiÚs
 = 
NULL
) {

32 
$this
->
v›w
 = &
$v›w
;

33 
$this
->
di¥Ïy
 = &
$di¥Ïy
;

36 
$this
->
	`uÅack_İtiÚs
($this->
İtiÚs
, 
	`is£t
(
$İtiÚs
è? $İtiÚ : 
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('style_options'));

38 ià(
$this
->
	`u£s_row_¶ugš
(è&& 
$di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('row_plugin')) {

39 
$this
->
row_¶ugš
 = 
$di¥Ïy
->
hªdËr
->
	`g‘_¶ugš
('row');

42 
$this
->
İtiÚs
 +ğ
	`¬¿y
(

46 
$this
->
defš™iÚ
 +ğ
	`¬¿y
(

47 'u£ groupšg' => 
TRUE
,

51 
funùiÚ
 
	$de¡roy
() {

52 
·»Á
::
	`de¡roy
();

54 ià(
	`is£t
(
$this
->
row_¶ugš
)) {

55 
$this
->
row_¶ugš
->
	`de¡roy
();

57 
	}
}

62 
funùiÚ
 
	$u£s_row_¶ugš
() {

63  !
	`em±y
(
$this
->
defš™iÚ
['uses„ow…lugin']);

64 
	}
}

69 
funùiÚ
 
	$u£s_f›lds
() {

72 ià(
$this
->
	`u£s_row_¶ugš
(è&& !
	`em±y
($this->
row_¶ugš
)) {

73  
$this
->
row_¶ugš
->
	`u£s_f›lds
();

76  !
	`em±y
(
$this
->
defš™iÚ
['uses fields']);

77 
	}
}

79 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

80 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

81 
$İtiÚs
['groupšg'] = 
	`¬¿y
('default' => '');

82  
$İtiÚs
;

83 
	}
}

85 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

90 ià(
$this
->
	`u£s_f›lds
(è&& $this->
defš™iÚ
['uses grouping']) {

91 
$İtiÚs
 = 
	`¬¿y
('' => 
	`t
('<None>'));

92 
$İtiÚs
 +ğ
$this
->
di¥Ïy
->
hªdËr
->
	`g‘_f›ld_Ïb–s
();

95 ià(
	`couÁ
(
$İtiÚs
) > 1) {

96 
$fÜm
['groupšg'] = 
	`¬¿y
(

98 '#t™Ë' => 
	`t
('Grouping field'),

99 '#İtiÚs' => 
$İtiÚs
,

100 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['grouping'],

101 '#desütiÚ' => 
	`t
('You may optionally specify‡ field by whicho grouphe„ecords. Leave blanko‚ot group.'),

105 
	}
}

112 
funùiÚ
 
	$bud_sÜt
(è{  
TRUE
; 
	}
}

118 
funùiÚ
 
	$bud_sÜt_po¡
(è{ 
	}
}

126 
funùiÚ
 
	$´e_»nd”
(
$»suÉ
) {

127 ià(!
	`em±y
(
$this
->
row_¶ugš
)) {

128 
$this
->
row_¶ugš
->
	`´e_»nd”
(
$»suÉ
);

130 
	}
}

135 
funùiÚ
 
	$»nd”
() {

136 ià(
$this
->
	`u£s_row_¶ugš
(è&& 
	`em±y
($this->
row_¶ugš
)) {

137 
	`v´
('views_plugin_style_default: Missing„ow…lugin');

142 
$£ts
 = 
$this
->
	`»nd”_groupšg
($this->
v›w
->
»suÉ
, $this->
İtiÚs
['grouping']);

146 
$ouut
 = '';

147 
	`fÜ—ch
 (
$£ts
 
as
 
$t™Ë
 => 
$»cÜds
) {

148 ià(
$this
->
	`u£s_row_¶ugš
()) {

149 
$rows
 = 
	`¬¿y
();

150 
	`fÜ—ch
 (
$»cÜds
 
as
 
$row_šdex
 => 
$row
) {

151 
$this
->
v›w
->
row_šdex
 = 
$row_šdex
;

152 
$rows
[] = 
$this
->
row_¶ugš
->
	`»nd”
(
$row
);

156 
$rows
 = 
$»cÜds
;

159 
$ouut
 .ğ
	`theme
(
$this
->
	`theme_funùiÚs
(), $this->
v›w
, $this->
İtiÚs
, 
$rows
, 
$t™Ë
);

161 
	`un£t
(
$this
->
v›w
->
row_šdex
);

162  
$ouut
;

163 
	}
}

176 
funùiÚ
 
»nd”_groupšg
(
$»cÜds
, 
$groupšg_f›ld
 = '') {

178 
$this
->
»nd”_f›lds
($this->
v›w
->
»suÉ
);

179 
	g$£ts
 = 
¬¿y
();

180 ià(
	g$groupšg_f›ld
) {

181 
fÜ—ch
 (
$»cÜds
 
as
 
$šdex
 => 
$row
) {

182 
$groupšg
 = '';

186 ià(
is£t
(
$this
->
v›w
->
f›ld
[
$groupšg_f›ld
])) {

187 
	g$groupšg
 = 
$this
->
g‘_f›ld
(
$šdex
, 
$groupšg_f›ld
);

188 ià(
	g$this
->
	gv›w
->
	gf›ld
[
$groupšg_f›ld
]->
	gİtiÚs
['label']) {

189 
	g$groupšg
 = 
$this
->
v›w
->
f›ld
[
$groupšg_f›ld
]->
İtiÚs
['Ïb–'] . ': ' . 
$groupšg
;

192 
	g$£ts
[
$groupšg
][
$šdex
] = 
$row
;

197 
	g$£ts
[''] = 
$»cÜds
;

199  
	g$£ts
;

208 
funùiÚ
 
	$»nd”_f›lds
(
$»suÉ
) {

209 ià(!
$this
->
	`u£s_f›lds
()) {

213 
$¡¬t
 = 
	`v›ws_miüÙime
();

214 ià(
	`is£t
(
$this
->
»nd”ed_f›lds
)) {

215  
$this
->
»nd”ed_f›lds
;

218 
$this
->
v›w
->
row_šdex
 = 0;

219 
$keys
 = 
	`¬¿y_keys
(
$this
->
v›w
->
f›ld
);

220 
	`fÜ—ch
 (
$»suÉ
 
as
 
$couÁ
 => 
$row
) {

221 
$this
->
v›w
->
row_šdex
 = 
$couÁ
;

222 
	`fÜ—ch
 (
$keys
 
as
 
$id
) {

223 
$this
->
»nd”ed_f›lds
[
$couÁ
][
$id
] = $this->
v›w
->
f›ld
[$id]->
	`theme
(
$row
);

226 
	`un£t
(
$this
->
v›w
->
row_šdex
);

227 
	}
}

237 
funùiÚ
 
	$g‘_f›ld
(
$šdex
, 
$f›ld
) {

238 ià(!
	`is£t
(
$this
->
»nd”ed_f›lds
)) {

239 
$this
->
	`»nd”_f›lds
($this->
v›w
->
»suÉ
);

242 ià(
	`is£t
(
$this
->
»nd”ed_f›lds
[
$šdex
][
$f›ld
])) {

243  
$this
->
»nd”ed_f›lds
[
$šdex
][
$f›ld
];

245 
	}
}

247 
funùiÚ
 
	$v®id©e
() {

248 
$”rÜs
 = 
·»Á
::
	`v®id©e
();

250 ià(
$this
->
	`u£s_row_¶ugš
()) {

251 
$¶ugš
 = 
$this
->
di¥Ïy
->
hªdËr
->
	`g‘_¶ugš
('row');

252 ià(
	`em±y
(
$¶ugš
)) {

253 
$”rÜs
[] = 
	`t
('StyË @¡yË„equœe ¨row styË buˆthrow…lugš i šv®id.', 
	`¬¿y
('@¡yË' => 
$this
->
defš™iÚ
['title']));

256 
$»suÉ
 = 
$¶ugš
->
	`v®id©e
();

257 ià(!
	`em±y
(
$»suÉ
è&& 
	`is_¬¿y
($result)) {

258 
$”rÜs
 = 
	`¬¿y_m”ge
($”rÜs, 
$»suÉ
);

262  
$”rÜs
;

263 
	}
}

265 
funùiÚ
 
	$qu”y
() {

266 
·»Á
::
	`qu”y
();

267 ià(
	`is£t
(
$this
->
row_¶ugš
)) {

268 
$this
->
row_¶ugš
->
	`qu”y
();

270 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_default.inc

1 <?
php


14 şas 
	cv›ws_¶ugš_¡yË_deçuÉ
 
ex‹nds
 
	mv›ws_¶ugš_¡yË
 {

18 
funùiÚ
 
	$İtiÚs
(&
$İtiÚs
) {

19 
·»Á
::
	`İtiÚs
(
$İtiÚs
);

22 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

23 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

24 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_grid.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_¡yË_grid
 
ex‹nds
 
	mv›ws_¶ugš_¡yË
 {

17 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

18 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

20 
$İtiÚs
['cŞumns'] = 
	`¬¿y
('default' => '4');

21 
$İtiÚs
['®ignm’t'] = 
	`¬¿y
('default' => 'horizontal');

22 
$İtiÚs
['fl_sšgË_lše'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

24  
$İtiÚs
;

30 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

31 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

32 
$fÜm
['cŞumns'] = 
	`¬¿y
(

34 '#t™Ë' => 
	`t
('Number of columns'),

35 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['columns'],

37 
$fÜm
['®ignm’t'] = 
	`¬¿y
(

39 '#t™Ë' => 
	`t
('Alignment'),

40 '#İtiÚs' => 
	`¬¿y
('hÜizÚl' => 
	`t
('Horizontal'), 'vertical' =>('Vertical')),

41 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['alignment'],

42 '#desütiÚ' => 
	`t
('Horizontal‡lignment will…lace items starting inhe upper†eft‡nd moving„ight. Vertical‡lignment will…lace items starting inhe upper†eft‡nd moving down.'),

45 
$fÜm
['fl_sšgË_lše'] = 
	`¬¿y
(

47 '#t™Ë' => 
	`t
('Fill up single†ine'),

48 '#desütiÚ' => 
	`t
('If you disablehis option‡ grid with only one„ow will havehe‡mount of items‡sds. If you disable ithis can cause…roblems with your css.'),

49 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['fill_single_line']),

51 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_jump_menu.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_¡yË_jump_m’u
 
ex‹nds
 
	mv›ws_¶ugš_¡yË
 {

14 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

15 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

17 
$İtiÚs
['hide'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

18 
$İtiÚs
['·th'] = 
	`¬¿y
('default' => '');

19 
$İtiÚs
['‹xt'] = 
	`¬¿y
('deçuÉ' => 'Go', 'Œª¦©abË' => 
TRUE
);

20 
$İtiÚs
['choo£'] = 
	`¬¿y
('deçuÉ' => '- Choo£ -', 'Œª¦©abË' => 
TRUE
);

22  
$İtiÚs
;

28 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

29 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

30 
$hªdËrs
 = 
$this
->
di¥Ïy
->
hªdËr
->
	`g‘_hªdËrs
('field');

31 ià(
	`em±y
(
$hªdËrs
)) {

32 
$fÜm
['”rÜ_m¬kup'] = 
	`¬¿y
(

33 '#v®ue' => 
	`t
('You‚eed‡t†east one field before you can configure your jump menu settings'),

40 
$fÜm
['m¬kup'] = 
	`¬¿y
(

41 '#v®ue' => 
	`t
('To…roperly configure‡ jump menu, you must select one fieldhat will„epresenthe…atho utilize. You shouldhen sethat fieldoƒxclude. All other displayed fields will be…art ofhe menu. Please‚otehat‡ll HTML will be stripped fromhis output‡s select boxes cannot show HTML.'),

46 
	`fÜ—ch
 (
$hªdËrs
 
as
 
$id
 => 
$hªdËr
) {

47 
$İtiÚs
[
$id
] = 
$hªdËr
->
	`ui_Çme
();

50 
$fÜm
['·th'] = 
	`¬¿y
(

52 '#t™Ë' => 
	`t
('Path field'),

53 '#İtiÚs' => 
$İtiÚs
,

54 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['path'],

57 
$fÜm
['hide'] = 
	`¬¿y
(

59 '#t™Ë' => 
	`t
('Hidehe "Go" button.'),

60 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['hide']),

61 '#desütiÚ' => 
	`t
('If hidden,his button will only be hidden for users with javascript‡ndhe…age will‡utomatically jump whenhe select is changed.'),

64 
$fÜm
['‹xt'] = 
	`¬¿y
(

66 '#t™Ë' => 
	`t
('Buttonext'),

67 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['text'],

70 
$fÜm
['choo£'] = 
	`¬¿y
(

72 '#t™Ë' => 
	`t
('Chooseext'),

73 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['choose'],

74 '#desütiÚ' => 
	`t
('Theexthat will‡ppear‡she selected option inhe jump menu.'),

76 
	}
}

83 
funùiÚ
 
	$»nd”
() {

84 
$»suÉ
 = 
$this
->
v›w
->
»suÉ
;

86 
$f›lds
 = 
$this
->
	`»nd”_f›lds
(
$»suÉ
);

87 
$£ts
 = 
	`¬¿y
();

88 ià(
$this
->
İtiÚs
['grouping']) {

89 
	`fÜ—ch
 (
$»suÉ
 
as
 
$šdex
 => 
$row
) {

90 
$groupšg
 = '';

94 ià(
	`is£t
(
$this
->
v›w
->
f›ld
[$this->
İtiÚs
['grouping']])) {

95 
$groupšg
 = 
	`¡r_gs
(
$this
->
	`g‘_f›ld
(
$šdex
, $this->
İtiÚs
['grouping']));

96 ià(
$this
->
v›w
->
f›ld
[$this->
İtiÚs
['grouping']]->options['label']) {

97 
$groupšg
 = 
$this
->
v›w
->
f›ld
[$this->
İtiÚs
['grouping']]->options['label'] . ': ' . $grouping;

99 
$groupšg
 = 
	`u¾
($grouping);

101 
$£ts
[
$groupšg
][] = 
$row
;

106 
$£ts
[''] = 
$»suÉ
;

110 
$this
->
v›w
->
row_šdex
 = 0;

111 
$İtiÚs
 = 
	`¬¿y
();

112 
	`fÜ—ch
 (
$£ts
 
as
 
$t™Ë
 => 
$»cÜds
) {

113 
	`fÜ—ch
 (
$»cÜds
 
as
 
$row
) {

114 
$·th
 = 
	`¡r_gs
(
$this
->
	`g‘_f›ld
($this->
v›w
->
row_šdex
, $this->
İtiÚs
['path']));

115 
$f›ld
 = 
	`¡r_gs
(
$this
->
row_¶ugš
->
	`»nd”
(
$row
));;

116 ià(
$t™Ë
) {

117 
$İtiÚs
[
$t™Ë
][
$·th
] = 
$f›ld
;

120 
$İtiÚs
[
$·th
] = 
$f›ld
;

122 
$this
->
v›w
->
row_šdex
++;

125 
	`un£t
(
$this
->
v›w
->
row_šdex
);

127 
	`ùoŞs_šşude
('jump-menu');

128 
$£‰šgs
 = 
	`¬¿y
(

129 'hide' => 
$this
->
İtiÚs
['hide'],

130 'bu‰Ú' => 
$this
->
İtiÚs
['text'],

131 'choo£' => 
$this
->
İtiÚs
['choose'],

134  
	`dru·l_g‘_fÜm
('ùoŞs_jump_m’u', 
$İtiÚs
, 
$£‰šgs
);

135 
	}
}

137 
funùiÚ
 
	$»nd”_£t
(
$t™Ë
, 
$»cÜds
) {

138 
$İtiÚs
 = 
	`¬¿y
();

139 
$f›lds
 = 
$this
->
»nd”ed_f›lds
;

140 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_list.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_¡yË_li¡
 
ex‹nds
 
	mv›ws_¶ugš_¡yË
 {

17 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

18 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

20 
$İtiÚs
['ty³'] = 
	`¬¿y
('default' => 'ul');

22  
$İtiÚs
;

28 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

29 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

30 
$fÜm
['ty³'] = 
	`¬¿y
(

32 '#t™Ë' => 
	`t
('Listype'),

33 '#İtiÚs' => 
	`¬¿y
('ul' => 
	`t
('Unordered†ist'), 'ol' =>('Ordered†ist')),

34 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['type'],

36 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_rss.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_¡yË_rss
 
ex‹nds
 
	mv›ws_¶ugš_¡yË
 {

14 
funùiÚ
 
	$©ch_to
(
$di¥Ïy_id
, 
$·th
, 
$t™Ë
) {

15 
$di¥Ïy
 = 
$this
->
v›w
->
di¥Ïy
[
$di¥Ïy_id
]->
hªdËr
;

16 
$u¾_İtiÚs
 = 
	`¬¿y
();

17 
$šput
 = 
$this
->
v›w
->
	`g‘_expo£d_šput
();

18 ià(
$šput
) {

19 
$u¾_İtiÚs
['qu”y'] = 
$šput
;

22 
$u¾
 = 
	`u¾
(
$this
->
v›w
->
	`g‘_u¾
(
NULL
, 
$·th
), 
$u¾_İtiÚs
);

23 ià(
$di¥Ïy
->
	`has_·th
()) {

24 ià(
	`em±y
(
$this
->
´ev›w
)) {

25 
	`dru·l_add_ãed
(
$u¾
, 
$t™Ë
);

29 ià(
	`em±y
(
$this
->
v›w
->
ãed_icÚ
)) {

30 
$this
->
v›w
->
ãed_icÚ
 = '';

33 
$this
->
v›w
->
ãed_icÚ
 .ğ
	`theme
('ãed_icÚ', 
$u¾
, 
$t™Ë
);

34 
	`dru·l_add_lšk
(
	`¬¿y
(

37 't™Ë' => 
$t™Ë
,

38 'h»f' => 
$u¾


43 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

44 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

46 
$İtiÚs
['desütiÚ'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

47 
$İtiÚs
['missiÚ_desütiÚ'] = 
	`¬¿y
('deçuÉ' => '', 'Œª¦©abË' => 
TRUE
);

49  
$İtiÚs
;

50 
	}
}

52 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

53 
$fÜm
['missiÚ_desütiÚ'] = 
	`¬¿y
(

55 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['mission_description']),

56 '#t™Ë' => 
	`t
('Usehe site mission forhe description'),

58 
$fÜm
['desütiÚ'] = 
	`¬¿y
(

60 '#t™Ë' => 
	`t
('RSS description'),

61 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['description'],

62 '#desütiÚ' => 
	`t
('This will‡ppear inhe RSS feed itself.'),

63 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

64 '#d•’d’cy' => 
	`¬¿y
('ed™-¡yË-İtiÚs-ov”ride' =>‡¼ay(
FALSE
)),

66 
	}
}

74 
funùiÚ
 
	$g‘_chªÃl_–em’ts
() {

75  
	`¬¿y
();

76 
	}
}

78 
funùiÚ
 
	$»nd”
() {

79 ià(
	`em±y
(
$this
->
row_¶ugš
)) {

80 
	`v´
('views_plugin_style_default: Missing„ow…lugin');

83 
$rows
 = '';

87 
$this
->
Çme¥aûs
 = 
	`¬¿y
();

91 
$this
->
chªÃl_–em’ts
 = $this->
	`g‘_chªÃl_–em’ts
();

92 
	`fÜ—ch
 (
$this
->
chªÃl_–em’ts
 
as
 
$–em’t
) {

93 ià(
	`is£t
(
$–em’t
['namespace'])) {

94 
$this
->
Çme¥aûs
 = 
	`¬¿y_m”ge
($this->Çme¥aûs, 
$–em’t
['namespace']);

98 
	`fÜ—ch
 (
$this
->
v›w
->
»suÉ
 
as
 
$row
) {

99 
$rows
 .ğ
$this
->
row_¶ugš
->
	`»nd”
(
$row
);

102  
	`theme
(
$this
->
	`theme_funùiÚs
(), $this->
v›w
, $this->
İtiÚs
, 
$rows
);

103 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_summary.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_¡yË_summ¬y
 
ex‹nds
 
	mv›ws_¶ugš_¡yË
 {

14 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

15 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

17 
$İtiÚs
['couÁ'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

18 
$İtiÚs
['ov”ride'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

19 
$İtiÚs
['™ems_³r_·ge'] = 
	`¬¿y
('default' => 25);

21  
$İtiÚs
;

24 
funùiÚ
 
	$qu”y
() {

25 ià(!
	`em±y
(
$this
->
İtiÚs
['override'])) {

26 
$this
->
v›w
->
	`£t_™ems_³r_·ge
(
	`štv®
($this->
İtiÚs
['items_per_page']));

28 
	}
}

30 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

31 
$fÜm
['couÁ'] = 
	`¬¿y
(

33 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['count']),

34 '#t™Ë' => 
	`t
('Display„ecord count with†ink'),

36 
$fÜm
['ov”ride'] = 
	`¬¿y
(

38 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['override']),

39 '#t™Ë' => 
	`t
('Override‚umber of itemso display'),

41 
$fÜm
['™ems_³r_·ge'] = 
	`¬¿y
(

43 '#t™Ë' => 
	`t
('Itemso display'),

44 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['items_per_page'],

45 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

46 '#d•’d’cy' => 
	`¬¿y
('ed™-¡yË-İtiÚs-ov”ride' =>‡¼ay(
TRUE
)),

48 
	}
}

50 
funùiÚ
 
	$»nd”
() {

51 
$rows
 = 
	`¬¿y
();

52 
	`fÜ—ch
 (
$this
->
v›w
->
»suÉ
 
as
 
$row
) {

54 
$rows
[] = 
$row
;

56  
	`theme
(
$this
->
	`theme_funùiÚs
(), $this->
v›w
, $this->
İtiÚs
, 
$rows
);

57 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_summary_jump_menu.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_¡yË_summ¬y_jump_m’u
 
ex‹nds
 
	mv›ws_¶ugš_¡yË
 {

14 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

15 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

17 
$İtiÚs
['couÁ'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

18 
$İtiÚs
['hide'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

19 
$İtiÚs
['‹xt'] = 
	`¬¿y
('deçuÉ' => 
	`t
('Go'), 'Œª¦©abË' => 
TRUE
);

21  
$İtiÚs
;

24 
funùiÚ
 
	$qu”y
() {

25 
$this
->
v›w
->
	`£t_™ems_³r_·ge
(0);

26 
$this
->
v›w
->
	`£t_u£_·g”
(0);

27 
	}
}

29 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

30 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

31 
$fÜm
['couÁ'] = 
	`¬¿y
(

33 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['count']),

34 '#t™Ë' => 
	`t
('Display„ecord count with†ink'),

37 
$fÜm
['hide'] = 
	`¬¿y
(

39 '#t™Ë' => 
	`t
('Hidehe "Go" button.'),

40 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['hide']),

41 '#desütiÚ' => 
	`t
('If hidden,his button will only be hidden for users with javascript‡ndhe…age will‡utomatically jump whenhe select is changed.'),

44 
$fÜm
['‹xt'] = 
	`¬¿y
(

46 '#t™Ë' => 
	`t
('Buttonext'),

47 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['text'],

49 
	}
}

51 
funùiÚ
 
	$»nd”
() {

52 
$¬gum’t
 = 
$this
->
v›w
->
¬gum’t
[$this->v›w->
bud_šfo
['summary_level']];

54 
$u¾_İtiÚs
 = 
	`¬¿y
();

56 ià(!
	`em±y
(
$this
->
v›w
->
expo£d_¿w_šput
)) {

57 
$u¾_İtiÚs
['qu”y'] = 
$this
->
v›w
->
expo£d_¿w_šput
;

60 
$İtiÚs
 = 
	`¬¿y
();

61 
	`fÜ—ch
 (
$this
->
v›w
->
»suÉ
 
as
 
$id
 => 
$row
) {

62 
$¬gs
 = 
$this
->
v›w
->
¬gs
;

63 
$¬gs
[
$¬gum’t
->
pos™iÚ
] = $¬gum’t->
	`summ¬y_¬gum’t
(
$row
);

64 
$·th
 = 
	`u¾
(
$this
->
v›w
->
	`g‘_u¾
(
$¬gs
), 
$u¾_İtiÚs
);

66 
$İtiÚs
[
$·th
] = 
	`¡r_gs
(
$¬gum’t
->
	`summ¬y_Çme
(
$row
));

67 ià(!
	`em±y
(
$this
->
İtiÚs
['count'])) {

68 
$İtiÚs
[
$·th
] .ğ' (' . 
	`štv®
(
$row
->{
$¬gum’t
->
couÁ_®Ÿs
}) . ')';

72 
	`ùoŞs_šşude
('jump-menu');

73 
$£‰šgs
 = 
	`¬¿y
(

74 'hide' => 
$this
->
İtiÚs
['hide'],

75 'bu‰Ú' => 
$this
->
İtiÚs
['text'],

78  
	`dru·l_g‘_fÜm
('ùoŞs_jump_m’u', 
$İtiÚs
, 
$£‰šgs
);

79 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_summary_unformatted.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_¡yË_summ¬y_unfÜm©‹d
 
ex‹nds
 
	mv›ws_¶ugš_¡yË_summ¬y
 {

14 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

15 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

16 
$İtiÚs
['šlše'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

17 
$İtiÚs
['£·¿tÜ'] = 
	`¬¿y
('default' => '');

18  
$İtiÚs
;

21 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

22 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

23 
$fÜm
['šlše'] = 
	`¬¿y
(

25 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['inline']),

26 '#t™Ë' => 
	`t
('Display items inline'),

28 
$fÜm
['£·¿tÜ'] = 
	`¬¿y
(

30 '#t™Ë' => 
	`t
('Separator'),

31 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['separator'],

33 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_table.inc

1 <?
php


13 şas 
	cv›ws_¶ugš_¡yË_bË
 
ex‹nds
 
	mv›ws_¶ugš_¡yË
 {

14 
funùiÚ
 
	$İtiÚ_defš™iÚ
() {

15 
$İtiÚs
 = 
·»Á
::
	`İtiÚ_defš™iÚ
();

17 
$İtiÚs
['cŞumns'] = 
	`¬¿y
('default' =>‡rray());

18 
$İtiÚs
['deçuÉ'] = 
	`¬¿y
('default' => '');

19 
$İtiÚs
['šfo'] = 
	`¬¿y
('default' =>‡rray());

20 
$İtiÚs
['ov”ride'] = 
	`¬¿y
('deçuÉ' => 
TRUE
);

21 
$İtiÚs
['¡icky'] = 
	`¬¿y
('deçuÉ' => 
FALSE
);

22 
$İtiÚs
['Üd”'] = 
	`¬¿y
('default' => 'asc');

24  
$İtiÚs
;

30 
funùiÚ
 
	$bud_sÜt
() {

31 ià(!
	`is£t
(
$_GET
['Üd”']è&& (
$this
->
İtiÚs
['deçuÉ'] =ğ-1 || 
	`em±y
($this->
v›w
->
f›ld
[$this->options['default']]))) {

32  
TRUE
;

36 ià(
	`is£t
(
$_GET
['Üd”']è&& 
	`em±y
(
$this
->
v›w
->
f›ld
[$_GET['order']])) {

37  
TRUE
;

41  
	`em±y
(
$this
->
İtiÚs
['override']);

42 
	}
}

47 
funùiÚ
 
	$bud_sÜt_po¡
() {

48 ià(!
	`is£t
(
$_GET
['order'])) {

50 ià(
	`em±y
(
$this
->
İtiÚs
['default'])) {

53 
$sÜt
 = 
$this
->
İtiÚs
['default'];

54 
$this
->
Üd”
 = !
	`em±y
($this->
İtiÚs
['order']) ? $this->options['order'] : 'asc';

57 
$sÜt
 = 
$_GET
['order'];

59 
$this
->
Üd”
 = !
	`em±y
(
$_GET
['sÜt']è? 
	`¡¹Şow”
($_GET['sort']) : 'asc';

63 ià(
	`em±y
(
$this
->
v›w
->
f›ld
[
$sÜt
])) {

68 ià(
$this
->
Üd”
 != 'asc' && $this->order != 'desc') {

69 
$this
->
Üd”
 = 'asc';

73 
$this
->
aùive
 = 
$sÜt
;

76 
$this
->
v›w
->
f›ld
[
$sÜt
]->
	`şick_sÜt
($this->
Üd”
);

77 
	}
}

100 
funùiÚ
 
	$§n™ize_cŞumns
(
$cŞumns
, 
$f›lds
 = 
NULL
) {

101 
$§n™ized
 = 
	`¬¿y
();

102 ià(
$f›lds
 ==ğ
NULL
) {

103 
$f›lds
 = 
$this
->
di¥Ïy
->
hªdËr
->
	`g‘_İtiÚ
('fields');

107 
	`fÜ—ch
 (
$f›lds
 
as
 
$f›ld
 => 
$šfo
) {

110 
$§n™ized
[
$f›ld
] = $field;

113 
	`fÜ—ch
 (
$cŞumns
 
as
 
$f›ld
 => 
$cŞumn
) {

115 ià(!
	`is£t
(
$§n™ized
[
$f›ld
])) {

121 ià(
$f›ld
 =ğ
$cŞumn
 || 
$cŞumns
[$cŞumn] =ğ$cŞumÀ&& !
	`em±y
(
$§n™ized
[$column])) {

122 
$§n™ized
[
$f›ld
] = 
$cŞumn
;

129  
$§n™ized
;

130 
	}
}

135 
funùiÚ
 
	$İtiÚs_fÜm
(&
$fÜm
, &
$fÜm_¡©e
) {

136 
·»Á
::
	`İtiÚs_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

137 
$hªdËrs
 = 
$this
->
di¥Ïy
->
hªdËr
->
	`g‘_hªdËrs
('field');

138 ià(
	`em±y
(
$hªdËrs
)) {

139 
$fÜm
['”rÜ_m¬kup'] = 
	`¬¿y
(

140 '#v®ue' => 
	`t
('You‚eed‡t†east one field before you can configure yourable settings'),

147 
$fÜm
['ov”ride'] = 
	`¬¿y
(

149 '#t™Ë' => 
	`t
('Override‚ormal sorting if click sorting is used'),

150 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['override']),

153 
$fÜm
['¡icky'] = 
	`¬¿y
(

155 '#t™Ë' => 
	`t
('Enable Drupal style "sticky"able headers (Javascript)'),

156 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['sticky']),

157 '#desütiÚ' => 
	`t
('(Sticky headerƒffects will‚ot be‡ctive for…review below, only on†ive output.)'),

160 
$fÜm
['Üd”'] = 
	`¬¿y
(

162 '#t™Ë' => 
	`t
('Default sort order'),

163 '#İtiÚs' => 
	`¬¿y
('asc' => 
	`t
('Ascending'), 'desc' =>('Descending')),

164 '#deçuÉ_v®ue' => 
$this
->
İtiÚs
['order'],

165 '#desütiÚ' => 
	`t
('If‡ default sort order is selected, what order should it use by default.'),

170 
$fÜm
['#theme'] = 'views_ui_style_plugin_table';

172 
$cŞumns
 = 
$this
->
	`§n™ize_cŞumns
($this->
İtiÚs
['columns']);

175 
$f›ld_Çmes
 = 
$this
->
di¥Ïy
->
hªdËr
->
	`g‘_f›ld_Ïb–s
();

177 ià(
	`is£t
(
$this
->
İtiÚs
['default'])) {

178 
$deçuÉ
 = 
$this
->
İtiÚs
['default'];

179 ià(!
	`is£t
(
$cŞumns
[
$deçuÉ
])) {

180 
$deçuÉ
 = -1;

184 
$deçuÉ
 = -1;

187 
	`fÜ—ch
 (
$cŞumns
 
as
 
$f›ld
 => 
$cŞumn
) {

188 
$§ã
 = 
	`¡r_»¶aû
(
	`¬¿y
('][', '_', ' '), '-', 
$f›ld
);

190 
$id
 = 'ed™-¡yË-İtiÚs-cŞumns-' . 
$§ã
;

192 
$fÜm
['cŞumns'][
$f›ld
] = 
	`¬¿y
(

194 '#İtiÚs' => 
$f›ld_Çmes
,

195 '#deçuÉ_v®ue' => 
$cŞumn
,

197 ià(
$hªdËrs
[
$f›ld
]->
	`şick_sÜbË
()) {

198 
$fÜm
['šfo'][
$f›ld
]['sÜbË'] = 
	`¬¿y
(

200 '#deçuÉ_v®ue' => !
	`em±y
(
$this
->
İtiÚs
['šfo'][
$f›ld
]['sortable']),

201 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

202 '#d•’d’cy' => 
	`¬¿y
(
$id
 =>‡¼ay(
$f›ld
)),

205 
$¿dio_id
 = 
	`fÜm_ş—n_id
('ed™-deçuÉ-' . 
$f›ld
);

206 
$fÜm
['deçuÉ'][
$f›ld
] = 
	`¬¿y
(

208 '#»tuº_v®ue' => 
$f›ld
,

209 '#·»Ás' => 
	`¬¿y
('style_options', 'default'),

210 '#id' => 
$¿dio_id
,

212 '#©Œibu‹s' => 
	`¬¿y
('id' => 
$¿dio_id
),

213 '#deçuÉ_v®ue' => 
$deçuÉ
,

214 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

215 '#d•’d’cy' => 
	`¬¿y
(
$id
 =>‡¼ay(
$f›ld
)),

218 
$fÜm
['šfo'][
$f›ld
]['£·¿tÜ'] = 
	`¬¿y
(

221 '#deçuÉ_v®ue' => 
	`is£t
(
$this
->
İtiÚs
['šfo'][
$f›ld
]['separator']) ? $this->options['info'][$field]['separator'] : '',

222 '#´oûss' => 
	`¬¿y
('views_process_dependency'),

223 '#d•’d’cy' => 
	`¬¿y
(
$id
 =>‡¼ay(
$f›ld
)),

227 
$fÜm
['šfo'][
$f›ld
]['Çme'] = 
	`¬¿y
(

228 '#v®ue' => 
$f›ld_Çmes
[
$f›ld
],

233 
$fÜm
['deçuÉ'][-1] = 
	`¬¿y
(

236 '#·»Ás' => 
	`¬¿y
('style_options', 'default'),

238 '#deçuÉ_v®ue' => 
$deçuÉ
,

241 
$fÜm
['desütiÚ_m¬kup'] = 
	`¬¿y
(

244 '#v®ue' => 
	`t
('Place fields into columns; you may combine multiple fields intohe same column. If you do,he separator inhe column specified will be usedo separatehe fields. Checkhe sortable boxo makehat column click sortable,‡nd checkhe default sort„adioo determine which column will be sorted by default, if‡ny. You may control column order‡nd field†abels inhe fields section.'),

246 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/theme.inc

1 <?
php


21 
funùiÚ
 
	$_v›ws_theme_funùiÚs
(
$hook
, 
$v›w
, 
$di¥Ïy
 = 
NULL
) {

22 
$themes
 = 
	`¬¿y
();

24 ià(
$di¥Ïy
) {

25 
$themes
[] = 
$hook
 . '__' . 
$v›w
->
Çme
 . '__' . 
$di¥Ïy
->
id
;

26 
$themes
[] = 
$hook
 . '__' . 
$di¥Ïy
->
id
;

27 
$themes
[] = 
$hook
 . '__' . 
	`´eg_»¶aû
('/[^a-z0-9]/', '-', 
	`¡¹Şow”
(
$v›w
->
g
));

28 ià(
$di¥Ïy
->
id
 !ğ$di¥Ïy->
di¥Ïy_¶ugš
) {

29 
$themes
[] = 
$hook
 . '__' . 
$v›w
->
Çme
 . '__' . 
$di¥Ïy
->
di¥Ïy_¶ugš
;

30 
$themes
[] = 
$hook
 . '__' . 
$di¥Ïy
->
di¥Ïy_¶ugš
;

33 
$themes
[] = 
$hook
 . '__' . 
$v›w
->
Çme
;

34 
$themes
[] = 
$hook
;

35  
$themes
;

36 
	}
}

41 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w
(&
$v¬s
) {

42 
glob®
 
$ba£_·th
;

44 
$v›w
 = 
$v¬s
['view'];

46 
$v¬s
['rows'] = !
	`em±y
(
$v›w
->
»suÉ
è|| !em±y($v›w->
¡yË_¶ugš
->
defš™iÚ
['ev’ƒm±y']è? $v›w->¡yË_¶ugš->
	`»nd”
($view->result) : '';

48 
$v¬s
['css_Çme'] = 
	`v›ws_css_§ã
(
$v›w
->
Çme
);

49 
$v¬s
['Çme'] = 
$v›w
->
Çme
;

50 
$v¬s
['di¥Ïy_id'] = 
$v›w
->
cu¼’t_di¥Ïy
;

53 
$v¬s
['şas£s_¬¿y'] = 
	`¬¿y
();

54 
$v¬s
['classes_array'][] = 'view';

55 
$v¬s
['şas£s_¬¿y'][] = 'v›w-' . 
	`v›ws_css_§ã
($vars['name']);

56 
$v¬s
['classes_array'][] = 'view-id-' . $vars['name'];

57 
$v¬s
['classes_array'][] = 'view-display-id-' . $vars['display_id'];

59 
$css_şass
 = 
$v›w
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('css_class');

60 ià(!
	`em±y
(
$css_şass
)) {

61 
$v¬s
['css_şass'] = 
	`´eg_»¶aû
('/[^a-zA-Z0-9- ]/', '-', 
$css_şass
);

62 
$v¬s
['classes_array'][] = $vars['css_class'];

65 ià(!
$v¬s
['rows']) {

66 
$v¬s
['em±y'] = 
$v›w
->
di¥Ïy_hªdËr
->
	`»nd”_em±y
();

67 ià(!
$v›w
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('header_empty')) {

68 
$v¬s
['header'] = '';

70 ià(!
$v›w
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('footer_empty')) {

71 
$v¬s
['footer'] = '';

75 
$v¬s
['empty'] = '';

76 
$h—d”
 = 
TRUE
;

79 
$v¬s
['expo£d'] = !
	`em±y
(
$v›w
->
expo£d_widg‘s
) ? $view->exposed_widgets : '';

80 ià(!
	`is£t
(
$v¬s
['header'])) {

81 
$v¬s
['h—d”'] = 
$v›w
->
di¥Ïy_hªdËr
->
	`»nd”_h—d”
();

83 ià(!
	`is£t
(
$v¬s
['footer'])) {

84 
$v¬s
['foÙ”'] = 
$v›w
->
di¥Ïy_hªdËr
->
	`»nd”_foÙ”
();

86 
$v¬s
['mÜe'] = 
$v›w
->
di¥Ïy_hªdËr
->
	`»nd”_mÜe_lšk
();

87 
$v¬s
['ãed_icÚ'] = !
	`em±y
(
$v›w
->
ãed_icÚ
) ? $view->feed_icon : '';

89 
$v¬s
['©chm’t_befÜe'] = !
	`em±y
(
$v›w
->
©chm’t_befÜe
) ? $view->attachment_before : '';

90 
$v¬s
['©chm’t_aá”'] = !
	`em±y
(
$v›w
->
©chm’t_aá”
) ? $view->attachment_after : '';

92 
$v¬s
['pager'] = '';

94 
$expo£d_šput
 = 
	`is£t
(
$v›w
->
expo£d_d©a_¿w
è? $v›w->expo£d_d©a_¿w : 
NULL
;

95 ià(
$v›w
->
di¥Ïy_hªdËr
->
	`»nd”_·g”
()) {

96 
$·g”_ty³
 = (
$v›w
->
·g”
['use_pager'] === 'mini' ? 'views_mini_pager' : 'pager');

97 
$·g”_theme
 = 
	`v›ws_theme_funùiÚs
(
$·g”_ty³
, 
$v›w
, $v›w->
di¥Ïy_hªdËr
->
di¥Ïy
);

98 
$v¬s
['·g”'] = 
	`theme
(
$·g”_theme
, 
$expo£d_šput
, 
$v›w
->
·g”
['items_per_page'], $view->pager['element']);

102 ià(
	`u£r_acûss
('admši¡” v›ws'è&& 
	`moduË_exi¡s
('v›ws_ui'è&& 
	`em±y
(
$v›w
->
hide_admš_lšks
è&& !
	`v¬ŸbË_g‘
('v›ws_no_hov”_lšks', 
FALSE
)) {

103 
$v¬s
['admš_lšks_¿w'] = 
	`¬¿y
(

104 
	`¬¿y
(

105 't™Ë' => 
	`t
('Edit'),

106 '®t' => 
	`t
("Edithis view"),

108 'äagm’t' => 'v›ws-b-' . 
$v›w
->
cu¼’t_di¥Ïy
,

109 'qu”y' => 
	`dru·l_g‘_de¡š©iÚ
(),

111 
	`¬¿y
(

112 't™Ë' => 
	`t
('Export'),

113 '®t' => 
	`t
("Exporthis view"),

116 
	`¬¿y
(

117 't™Ë' => 
	`t
('Clone'),

118 '®t' => 
	`t
("Create‡ copy ofhis view"),

123 
	`dru·l_®‹r
('v›ws_admš_lšks', 
$v¬s
['admš_lšks_¿w'], 
$v›w
);

124 
$v¬s
['admš_lšks'] = 
	`theme
('links', $vars['admin_links_raw']);

127 
$v¬s
['admin_links'] = '';

128 
$v¬s
['admš_lšks_¿w'] = 
	`¬¿y
();

140 
$dom_id
 = 1;

141 
$v¬s
['dom_id'] = !
	`em±y
(
$v›w
->
dom_id
è? $v›w->dom_id : 
$dom_id
++;

142 
$v¬s
['classes_array'][] = 'view-dom-id-' . $vars['dom_id'];

145 ià(
$v›w
->
u£_ajax
) {

146 
$£‰šgs
 = 
	`¬¿y
(

147 'v›ws' => 
	`¬¿y
(

148 'ajax_·th' => 
	`u¾
('views/ajax'),

149 'ajaxV›ws' => 
	`¬¿y
(

150 
	`¬¿y
(

151 'v›w_Çme' => 
$v›w
->
Çme
,

152 'v›w_di¥Ïy_id' => 
$v›w
->
cu¼’t_di¥Ïy
,

153 'v›w_¬gs' => 
	`im¶ode
('/', 
$v›w
->
¬gs
),

154 'v›w_·th' => 
$_GET
['q'],

157 'v›w_ba£_·th' => 
$v›w
->
	`g‘_·th
(),

158 'v›w_dom_id' => 
$v¬s
['dom_id'],

161 '·g”_–em’t' => 
$v›w
->
·g”
['element'],

167 
	`dru·l_add_js
(
$£‰šgs
, 'setting');

168 
	`v›ws_add_js
('ajax_view');

171 
$v¬s
['şas£s'] = 
	`im¶ode
(' ', $vars['classes_array']);

172 
	}
}

177 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_f›lds
(&
$v¬s
) {

178 
$v›w
 = 
$v¬s
['view'];

181 
$šlše
 = 
FALSE
;

182 
$v¬s
['f›lds'] = 
	`¬¿y
();

183 
	`fÜ—ch
 (
$v›w
->
f›ld
 
as
 
$id
 => 
$f›ld
) {

185 
$f›ld_ouut
 = 
$v›w
->
¡yË_¶ugš
->
	`g‘_f›ld
($v›w->
row_šdex
, 
$id
);

186 
$em±y
 = 
$f›ld_ouut
 !=ğ0 && 
	`em±y
($field_output);

187 ià(
	`em±y
(
$f›ld
->
İtiÚs
['exşude']è&& (!
$em±y
 ||ƒmpty($field->options['hide_empty']))) {

188 
$objeù
 = 
Ãw
 
	`¡dCÏss
();

190 
$objeù
->
cÚ‹Á
 = 
$f›ld_ouut
;

191 ià(
	`is£t
(
$v›w
->
f›ld
[
$id
]->
f›ld_®Ÿs
è&& is£t(
$v¬s
['row']->{$view->field[$id]->field_alias})) {

192 
$objeù
->
¿w
 = 
$v¬s
['row']->{
$v›w
->
f›ld
[
$id
]->
f›ld_®Ÿs
};

195 
$objeù
->
¿w
 = 
NULL
;

197 
$objeù
->
šlše
 = !
	`em±y
(
$v¬s
['İtiÚs']['šlše'][
$id
]);

198 
$objeù
->
šlše_html
 = $objeù->
šlše
 ? 'span' : 'div';

199 ià(!
	`em±y
(
$v¬s
['İtiÚs']['£·¿tÜ']è&& 
$šlše
 && 
$objeù
->
šlše
 && $objeù->
cÚ‹Á
) {

200 
$objeù
->
£·¿tÜ
 = 
	`f‹r_xss_admš
(
$v¬s
['options']['separator']);

203 
$šlše
 = 
$objeù
->
šlše
;

205 
$objeù
->
hªdËr
 = &
$v›w
->
f›ld
[
$id
];

206 
$objeù
->
–em’t_ty³
 = $objeù->
hªdËr
->
	`–em’t_ty³
();

208 
$objeù
->
şass
 = 
	`v›ws_css_§ã
(
$id
);

209 
$objeù
->
Ïb–
 = 
	`check_¶aš
(
$v›w
->
f›ld
[
$id
]->
	`Ïb–
());

210 
$v¬s
['f›lds'][
$id
] = 
$objeù
;

214 
	}
}

223 
funùiÚ
 
	$theme_v›ws_v›w_f›ld
(
$v›w
, 
$f›ld
, 
$row
) {

225  
$v›w
->
f›ld
[
$f›ld
->
İtiÚs
['id']]->
	`advªûd_»nd”
(
$row
);

226 
	}
}

235 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_f›ld
(&
$v¬s
) {

236 
$v¬s
['ouut'] = $v¬s['f›ld']->
	`advªûd_»nd”
($vars['row']);

237 
	}
}

242 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_summ¬y
(&
$v¬s
) {

243 
$v›w
 = 
$v¬s
['view'];

244 
$¬gum’t
 = 
$v›w
->
¬gum’t
[$v›w->
bud_šfo
['summary_level']];

246 
$u¾_İtiÚs
 = 
	`¬¿y
();

248 ià(!
	`em±y
(
$v›w
->
expo£d_¿w_šput
)) {

249 
$u¾_İtiÚs
['qu”y'] = 
$v›w
->
expo£d_¿w_šput
;

251 
$v¬s
['şas£s'] = 
	`¬¿y
();

252 
	`fÜ—ch
 (
$v¬s
['rows'] 
as
 
$id
 => 
$row
) {

253 
$v¬s
['rows'][
$id
]->
lšk
 = 
$¬gum’t
->
	`summ¬y_Çme
(
$row
);

254 
$¬gs
 = 
$v›w
->
¬gs
;

255 
$¬gs
[
$¬gum’t
->
pos™iÚ
] = $¬gum’t->
	`summ¬y_¬gum’t
(
$row
);

257 
$v¬s
['rows'][
$id
]->
u¾
 = 
	`u¾
(
$v›w
->
	`g‘_u¾
(
$¬gs
), 
$u¾_İtiÚs
);

258 
$v¬s
['rows'][
$id
]->
couÁ
 = 
	`štv®
(
$row
->{
$¬gum’t
->
couÁ_®Ÿs
});

259 ià(
$v¬s
['rows'][
$id
]->
u¾
 =ğ
	`ba£_·th
(è. 
$_GET
['q'] || $v¬s['rows'][$id]->u¾ =ğba£_·th(è. 
	`dru·l_g‘_·th_®Ÿs
($_GET['q'])) {

260 
$v¬s
['şas£s'][
$id
] = 'active';

263 
	}
}

269 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_summ¬y_unfÜm©‹d
(&
$v¬s
) {

270 
$v›w
 = 
$v¬s
['view'];

271 
$¬gum’t
 = 
$v›w
->
¬gum’t
[$v›w->
bud_šfo
['summary_level']];

272 
$v¬s
['şas£s'] = 
	`¬¿y
();

274 
$u¾_İtiÚs
 = 
	`¬¿y
();

276 ià(!
	`em±y
(
$v›w
->
expo£d_¿w_šput
)) {

277 
$u¾_İtiÚs
['qu”y'] = 
$v›w
->
expo£d_¿w_šput
;

280 
$couÁ
 = 0;

281 
	`fÜ—ch
 (
$v¬s
['rows'] 
as
 
$id
 => 
$row
) {

283 ià(
$couÁ
++) {

284 
$v¬s
['rows'][
$id
]->
£·¿tÜ
 = 
	`f‹r_xss_admš
($vars['options']['separator']);

286 
$v¬s
['rows'][
$id
]->
lšk
 = 
$¬gum’t
->
	`summ¬y_Çme
(
$row
);

287 
$¬gs
 = 
$v›w
->
¬gs
;

288 
$¬gs
[
$¬gum’t
->
pos™iÚ
] = $¬gum’t->
	`summ¬y_¬gum’t
(
$row
);

290 
$v¬s
['rows'][
$id
]->
u¾
 = 
	`u¾
(
$v›w
->
	`g‘_u¾
(
$¬gs
), 
$u¾_İtiÚs
);

291 
$v¬s
['rows'][
$id
]->
couÁ
 = 
	`štv®
(
$row
->{
$¬gum’t
->
couÁ_®Ÿs
});

292 ià(
$v¬s
['rows'][
$id
]->
u¾
 =ğ
	`ba£_·th
(è. 
$_GET
['q'] || $v¬s['rows'][$id]->u¾ =ğba£_·th(è. 
	`dru·l_g‘_·th_®Ÿs
($_GET['q'])) {

293 
$v¬s
['şas£s'][
$id
] = 'active';

296 
	}
}

301 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_bË
(&
$v¬s
) {

302 
$v›w
 = 
$v¬s
['view'];

309 
$»suÉ
 = 
$v¬s
['result'] = $vars['rows'];

310 
$v¬s
['rows'] = 
	`¬¿y
();

312 
$İtiÚs
 = 
$v›w
->
¡yË_¶ugš
->
İtiÚs
;

313 
$hªdËr
 = 
$v›w
->
¡yË_¶ugš
;

315 
$f›lds
 = &
$v›w
->
f›ld
;

316 
$cŞumns
 = 
$hªdËr
->
	`§n™ize_cŞumns
(
$İtiÚs
['cŞumns'], 
$f›lds
);

318 
$aùive
 = !
	`em±y
(
$hªdËr
->
aùive
) ? $handler->active : '';

319 
$Üd”
 = !
	`em±y
(
$hªdËr
->
Üd”
) ? $handler->order : 'asc';

321 
$qu”y
 = 
	`bËsÜt_g‘_qu”y¡ršg
();

322 ià(
$qu”y
) {

323 
$qu”y
 = '&' . $query;

328 
$»nd”s
 = 
$hªdËr
->
	`»nd”_f›lds
(
$»suÉ
);

330 
	`fÜ—ch
 (
$cŞumns
 
as
 
$f›ld
 => 
$cŞumn
) {

332 ià(
$f›ld
 =ğ
$cŞumn
 && 
	`em±y
(
$f›lds
[$f›ld]->
İtiÚs
['exclude'])) {

333 
$Ïb–
 = 
	`check_¶aš
(!
	`em±y
(
$f›lds
[
$f›ld
]è? $f›lds[$f›ld]->
	`Ïb–
() : '');

334 ià(
	`em±y
(
$İtiÚs
['šfo'][
$f›ld
]['sÜbË']è|| !
$f›lds
[$f›ld]->
	`şick_sÜbË
()) {

335 
$v¬s
['h—d”'][
$f›ld
] = 
$Ïb–
;

339 
$š™Ÿl
 = 'asc';

341 ià(
$aùive
 =ğ
$f›ld
 && 
$Üd”
 == 'asc') {

342 
$š™Ÿl
 = 'desc';

345 
$t™Ë
 = 
	`t
('sÜˆby @s', 
	`¬¿y
('@s' => 
$Ïb–
));

346 ià(
$aùive
 =ğ
$f›ld
) {

347 
$Ïb–
 .ğ
	`theme
('bËsÜt_šdiÿtÜ', 
$š™Ÿl
);

349 
$lšk_İtiÚs
 = 
	`¬¿y
(

350 'html' => 
Œue
,

351 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
$t™Ë
),

352 'qu”y' => 'Üd”=' . 
	`u¾’code
(
$f›ld
è. '&sÜt=' . 
$š™Ÿl
 . 
$qu”y
,

354 
$v¬s
['h—d”'][
$f›ld
] = 
	`l
(
$Ïb–
, 
$_GET
['q'], 
$lšk_İtiÚs
);

360 
$v¬s
['f›lds'][
$f›ld
] = 
	`v›ws_css_§ã
($field);

361 ià(
$aùive
 =ğ
$f›ld
) {

362 
$v¬s
['f›lds'][
$f›ld
] .= '‡ctive';

366 
	`fÜ—ch
 (
$»suÉ
 
as
 
$num
 => 
$row
) {

367 ià(!
	`em±y
(
$f›lds
[
$f›ld
]è&&ƒm±y($f›lds[$f›ld]->
İtiÚs
['exclude'])) {

368 
$f›ld_ouut
 = 
$»nd”s
[
$num
][
$f›ld
];

370 ià(!
	`is£t
(
$v¬s
['rows'][
$num
][
$cŞumn
])) {

371 
$v¬s
['rows'][
$num
][
$cŞumn
] = '';

375 ià(
$f›ld_ouut
 === '') {

380 ià(
$v¬s
['rows'][
$num
][
$cŞumn
] !== '') {

381 ià(!
	`em±y
(
$İtiÚs
['šfo'][
$cŞumn
]['separator'])) {

382 
$v¬s
['rows'][
$num
][
$cŞumn
] .ğ
	`f‹r_xss_admš
(
$İtiÚs
['info'][$column]['separator']);

386 
$v¬s
['rows'][
$num
][
$cŞumn
] .ğ
$f›ld_ouut
;

391 
$couÁ
 = 0;

392 
	`fÜ—ch
 (
$v¬s
['rows'] 
as
 
$num
 => 
$row
) {

393 
$v¬s
['row_şas£s'][
$num
][] = (
$couÁ
++ % 2 == 0) ? 'odd' : 'even';

396 
$v¬s
['row_classes'][0][] = 'views-row-first';

397 
$v¬s
['row_şas£s'][
	`couÁ
($vars['row_classes']) - 1][] = 'views-row-last';

399 
$v¬s
['class'] = 'views-table';

400 ià(!
	`em±y
(
$İtiÚs
['sticky'])) {

401 
	`dru·l_add_js
('misc/tableheader.js');

402 
$v¬s
['class'] .= " sticky-enabled";

404 
$v¬s
['şass'] .ğ' cŞs-'. 
	`couÁ
($vars['rows']);

405 
	}
}

410 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_grid
(&
$v¬s
) {

411 
$v›w
 = 
$v¬s
['view'];

412 
$»suÉ
 = 
$v›w
->
»suÉ
;

413 
$İtiÚs
 = 
$v›w
->
¡yË_¶ugš
->
İtiÚs
;

414 
$hªdËr
 = 
$v›w
->
¡yË_¶ugš
;

416 
$cŞumns
 = 
$İtiÚs
['columns'];

418 
$rows
 = 
	`¬¿y
();

420 ià(
$İtiÚs
['alignment'] == 'horizontal') {

421 
$row
 = 
	`¬¿y
();

422 
$row_couÁ
 = 0;

423 
	`fÜ—ch
 (
$v¬s
['rows'] 
as
 
$couÁ
 => 
$™em
) {

424 
$row
[] = 
$™em
;

425 
$row_couÁ
++;

426 ià((
$couÁ
 + 1è% 
$cŞumns
 == 0) {

427 
$rows
[] = 
$row
;

428 
$row
 = 
	`¬¿y
();

429 
$row_couÁ
 = 0;

432 ià(
$row
) {

434 ià(!
	`em±y
(
$hªdËr
->
İtiÚs
['fl_sšgË_lše']è|| 
	`couÁ
(
$rows
)) {

435 
$i
 = 0; $˜< (
$cŞumns
 - 
$row_couÁ
); $i++) {

436 
$row
[] = '';

439 
$rows
[] = 
$row
;

443 
$num_rows
 = 
	`æoÜ
(
	`couÁ
(
$v¬s
['rows']è/ 
$cŞumns
);

445 
$»mašd”s
 = 
	`couÁ
(
$v¬s
['rows']è% 
$cŞumns
;

446 
$row
 = 0;

447 
$cŞ
 = 0;

448 
	`fÜ—ch
 (
$v¬s
['rows'] 
as
 
$couÁ
 => 
$™em
) {

449 
$rows
[
$row
][
$cŞ
] = 
$™em
;

450 
$row
++;

452 ià(!
$»mašd”s
 && 
$row
 =ğ
$num_rows
) {

453 
$row
 = 0;

454 
$cŞ
++;

456 ià(
$»mašd”s
 && 
$row
 =ğ
$num_rows
 + 1) {

457 
$row
 = 0;

458 
$cŞ
++;

459 
$»mašd”s
--;

462 
$i
 = 0; $˜< 
	`couÁ
(
$rows
[0]); $i++) {

464 ià(!
	`is£t
(
$rows
[
	`couÁ
($rowsè- 1][
$i
])) {

465 
$rows
[
	`couÁ
($rowsè- 1][
$i
] = '';

469 
$v¬s
['rows'] = 
$rows
;

470 
	}
}

475 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_unfÜm©‹d
(&
$v¬s
) {

476 
$v›w
 = 
$v¬s
['view'];

477 
$rows
 = 
$v¬s
['rows'];

479 
$v¬s
['şas£s'] = 
	`¬¿y
();

481 
	`fÜ—ch
 (
$rows
 
as
 
$id
 => 
$row
) {

482 
$row_şas£s
 = 
	`¬¿y
();

483 
$row_şas£s
[] = 'views-row';

484 
$row_şas£s
[] = 'v›ws-row-' . (
$id
 + 1);

485 
$row_şas£s
[] = 'v›ws-row-' . (
$id
 % 2 ? 'even' : 'odd');

486 ià(
$id
 == 0) {

487 
$row_şas£s
[] = 'views-row-first';

489 ià(
$id
 =ğ
	`couÁ
(
$rows
) -1) {

490 
$row_şas£s
[] = 'views-row-last';

493 
$v¬s
['şas£s'][
$id
] = 
	`im¶ode
(' ', 
$row_şas£s
);

495 
	}
}

500 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_li¡
(&
$v¬s
) {

501 
	`‹m¶©e_´•roûss_v›ws_v›w_unfÜm©‹d
(
$v¬s
);

502 
	}
}

507 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_rss
(&
$v¬s
) {

508 
glob®
 
$ba£_u¾
;

509 
glob®
 
$Ïnguage
;

511 
$v›w
 = &
$v¬s
['view'];

512 
$İtiÚs
 = &
$v¬s
['options'];

513 
$™ems
 = &
$v¬s
['rows'];

515 
$¡yË
 = &
$v›w
->
¡yË_¶ugš
;

517 ià(!
	`em±y
(
$İtiÚs
['mission_description'])) {

518 
$desütiÚ
 = 
	`v¬ŸbË_g‘
('site_mission', '');

521 
$desütiÚ
 = 
$İtiÚs
['description'];

526 
$v¬s
['desütiÚ'] = 
	`check_¶aš
(
	`decode_’t™›s
(
	`¡r_gs
(
$desütiÚ
)));

528 ià(
$v›w
->
di¥Ïy_hªdËr
->
	`g‘_İtiÚ
('sitename_title')) {

529 
$t™Ë
 = 
	`v¬ŸbË_g‘
('site_name', 'Drupal');

530 ià(
$¦ogª
 = 
	`v¬ŸbË_g‘
('site_slogan', '')) {

531 
$t™Ë
 .ğ' - ' . 
$¦ogª
;

535 
$t™Ë
 = 
$v›w
->
	`g‘_t™Ë
();

537 
$v¬s
['t™Ë'] = 
	`check_¶aš
(
$t™Ë
);

541 
$lšk_di¥Ïy_id
 = 
$v›w
->
di¥Ïy_hªdËr
->
	`g‘_lšk_di¥Ïy
();

542 ià(
$lšk_di¥Ïy_id
 && !
	`em±y
(
$v›w
->
di¥Ïy
[$link_display_id])) {

543 
$·th
 = 
$v›w
->
di¥Ïy
[
$lšk_di¥Ïy_id
]->
hªdËr
->
	`g‘_·th
();

546 ià(
$·th
) {

547 
$·th
 = 
$v›w
->
	`g‘_u¾
(
NULL
, $path);

548 
$u¾_İtiÚs
 = 
	`¬¿y
('absŞu‹' => 
TRUE
);

549 ià(!
	`em±y
(
$v›w
->
expo£d_¿w_šput
)) {

550 
$u¾_İtiÚs
['qu”y'] = 
$v›w
->
expo£d_¿w_šput
;

554 ià(
$·th
 =ğ
	`v¬ŸbË_g‘
('site_frontpage', 'node')) {

555 
$·th
 = '';

558 
$v¬s
['lšk'] = 
	`check_u¾
(
	`u¾
(
$·th
, 
$u¾_İtiÚs
));

561 
$v¬s
['Ïngcode'] = 
	`check_¶aš
(
$Ïnguage
->
Ïnguage
);

562 
$v¬s
['Çme¥aûs'] = 
	`dru·l_©Œibu‹s
(
$¡yË
->
Çme¥aûs
);

563 
$v¬s
['™ems'] = 
$™ems
;

564 
$v¬s
['chªÃl_–em’ts'] = 
	`fÜm©_xml_–em’ts
(
$¡yË
->
chªÃl_–em’ts
);

566 
	`dru·l_£t_h—d”
('Content-Type:‡pplication/rss+xml; charset=utf-8');

567 
	}
}

572 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_v›w_row_rss
(&
$v¬s
) {

573 
$v›w
 = &
$v¬s
['view'];

574 
$İtiÚs
 = &
$v¬s
['options'];

575 
$™em
 = &
$v¬s
['row'];

577 
$v¬s
['t™Ë'] = 
	`check_¶aš
(
$™em
->
t™Ë
);

578 
$v¬s
['lšk'] = 
	`check_u¾
(
$™em
->
lšk
);

579 
$v¬s
['desütiÚ'] = 
	`check_¶aš
(
$™em
->
desütiÚ
);

580 
$v¬s
['™em_–em’ts'] = 
	`em±y
(
$™em
->
–em’ts
è? '' : 
	`fÜm©_xml_–em’ts
($item->elements);

581 
	}
}

586 
funùiÚ
 
	$‹m¶©e_´•roûss_v›ws_expo£d_fÜm
(&
$v¬s
) {

587 
$fÜm
 = &
$v¬s
['form'];

590 
$checkboxes
 = '';

592 ià(!
	`em±y
(
$fÜm
['q'])) {

593 
$v¬s
['q'] = 
	`dru·l_»nd”
(
$fÜm
['q']);

596 
$v¬s
['widg‘s'] = 
	`¬¿y
();

597 
	`fÜ—ch
 (
$fÜm
['#šfo'] 
as
 
$id
 => 
$šfo
) {

599 ià(
	`is£t
(
$fÜm
[
$šfo
['value']]['#type']) && $form[$info['value']]['#type'] == 'checkbox') {

600 
$checkboxes
 .ğ
	`dru·l_»nd”
(
$fÜm
[
$šfo
['value']]);

603 
$widg‘
 = 
Ãw
 
¡dCÏss
;

605 
$widg‘
->
Ïb–
 = $widg‘->
İ”©Ü
 = $widg‘->
widg‘
 = 
NULL
;

607 
$widg‘
->
id
 = 
$fÜm
[
$šfo
['value']]['#id'];

608 ià(!
	`em±y
(
$šfo
['label'])) {

609 
$widg‘
->
Ïb–
 = 
$šfo
['label'];

611 ià(!
	`em±y
(
$šfo
['operator'])) {

612 
$widg‘
->
İ”©Ü
 = 
	`dru·l_»nd”
(
$fÜm
[
$šfo
['operator']]);

614 
$widg‘
->
widg‘
 = 
	`dru·l_»nd”
(
$fÜm
[
$šfo
['value']]);

615 
$v¬s
['widg‘s'][
$id
] = 
$widg‘
;

619 ià(
$checkboxes
) {

620 
$widg‘
 = 
Ãw
 
¡dCÏss
;

622 
$widg‘
->
Ïb–
 = $widg‘->
İ”©Ü
 = $widg‘->
widg‘
 = 
NULL
;

623 
$widg‘
->
widg‘
 = 
$checkboxes
;

624 
$v¬s
['widg‘s']['checkboxes'] = 
$widg‘
;

628 
	`un£t
(
$fÜm
['form_id']);

629 
	`un£t
(
$fÜm
['form_build_id']);

630 
	`un£t
(
$fÜm
['form_token']);

633 
$v¬s
['bu‰Ú'] = 
	`dru·l_»nd”
(
$fÜm
);

634 
	}
}

636 
funùiÚ
 
theme_v›ws_mši_·g”
(
$gs
 = 
¬¿y
(), 
$lim™
 = 10, 
$–em’t
 = 0, 
$·¿m‘”s
 =‡¼ay(), 
$quªt™y
 = 9) {

637 
glob®
 
$·g”_·ge_¬¿y
, 
$·g”_tÙ®
;

641 
	g$·g”_middË
 = 
û
(
$quªt™y
 / 2);

643 
	g$·g”_cu¼’t
 = 
$·g”_·ge_¬¿y
[
$–em’t
] + 1;

645 
	g$·g”_max
 = 
$·g”_tÙ®
[
$–em’t
];

649 
	g$li_´evious
 = 
theme
('·g”_´evious', (
is£t
(
$gs
[1]è? $gs[1] : 
t
('â€¹â€¹')), 
$lim™
, 
$–em’t
, 1, 
$·¿m‘”s
);

650 ià(
em±y
(
$li_´evious
)) {

651 
	g$li_´evious
 = "&nbsp;";

654 
	g$li_Ãxt
 = 
theme
('·g”_Ãxt', (
is£t
(
$gs
[3]è? $gs[3] : 
t
('â€ºâ€º')), 
$lim™
, 
$–em’t
, 1, 
$·¿m‘”s
);

655 ià(
em±y
(
$li_Ãxt
)) {

656 
	g$li_Ãxt
 = "&nbsp;";

659 ià(
	g$·g”_tÙ®
[
$–em’t
] > 1) {

660 
	g$™ems
[] = 
¬¿y
(

662 'd©a' => 
$li_´evious
,

665 
	g$™ems
[] = 
¬¿y
(

667 'd©a' => 
t
('@cu¼’ˆoà@max', 
¬¿y
('@cu¼’t' => 
$·g”_cu¼’t
, '@max' => 
$·g”_max
)),

670 
	g$™ems
[] = 
¬¿y
(

672 'd©a' => 
$li_Ãxt
,

674  
theme
('™em_li¡', 
$™ems
, 
NULL
, 'ul', 
¬¿y
('class' => 'pager'));

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-exposed-form.tpl.php

1 <?
	gphp


18 <?
php
 ià(!
	$em±y
(
$q
)): ?>

19 <?
php


22 
´št
 
$q
;

24 <?
php
 
’dif
; ?>

25 <
div
 
şass
="views-exposed-form">

26 <
div
 
şass
="views-exposed-widgets clear-block">

27 <?
php
 
	`fÜ—ch
(
$widg‘s
 
as
 
$id
 => 
$widg‘
): ?>

28 <
div
 
şass
="views-exposed-widget">

29 <?
php
 ià(!
	`em±y
(
$widg‘
->
Ïb–
)): ?>

30 <
Ïb–
 ="<?php…rint $widget->id; ?>">

31 <?
php
 
´št
 
$widg‘
->
Ïb–
; ?>

32 </
Ïb–
>

33 <?
php
 
’dif
; ?>

34 <?
php
 ià(!
	`em±y
(
$widg‘
->
İ”©Ü
)): ?>

35 <
div
 
şass
="views-operator">

36 <?
php
 
´št
 
$widg‘
->
İ”©Ü
; ?>

37 </
div
>

38 <?
php
 
’dif
; ?>

39 <
div
 
şass
="views-widget">

40 <?
php
 
´št
 
$widg‘
->
widg‘
; ?>

41 </
div
>

42 </
div
>

43 <?
php
 
’dfÜ—ch
; ?>

44 <
div
 
şass
="views-exposed-widget">

45 <?
php
 
´št
 
$bu‰Ú
 ?>

46 </
div
>

47 </
div
>

48 </
div
>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-more.tpl.php

1 <?
	gphp


13 <
div
 
	gşass
="more-link">

14 <
a
 
h»f
="<?php…rint $more_url ?>">

15 <?
php
 
´št
 
$lšk_‹xt
; ?>

16 </
	ga
>

17 </
	gdiv
>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-ui-edit-item.tpl.php

1 <?
	gphp


9 <?
php
 
´št
 
	g$»¬¿nge
; ?>

10 <?
php
 
´št
 
	g$add
; ?>

11 <
div
 
	gşass
="views-category-title<?php

12 ià(
$ov”ridd’
) {

13 
´št
 ' overridden';

15 ià(
	g$deçuÉed
) {

16 
	g´št
 ' defaulted';

19 <?
php
 
´št
 
	g$™em_h–p_icÚ
; ?>

20 <?
php
 
´št
 
	g$t™Ë
; ?>

21 </
	gdiv
>

23 <
div
 
	gşass
="views-category-content<?php

24 ià(
$ov”ridd’
) {

25 
´št
 ' overridden';

27 ià(
	g$deçuÉed
) {

28 
	g´št
 ' defaulted';

31 <?
php
 ià(!
	$em±y
(
$no_f›lds
)): ?>

32 <
div
><?
php
 
´št
 
	`t
('The style selected does‚ot utilize fields.'); ?></div>

33 <?
php
 
	`–£if
 (
	$em±y
(
$f›lds
)): ?>

34 <
div
><?
php
 
´št
 
	`t
('None defined'); ?></div>

35 <?
php
 : ?>

36 <?
php
 
	`fÜ—ch
 (
$f›lds
 
as
 
$pid
 => 
$f›ld
): ?>

37 <?
php
 ià(!
	`em±y
(
$f›ld
['links'])): ?>

38 <?
php
 
´št
 
$f›ld
['links']; ?>

39 <?
php
 
’dif
; ?>

40 <
div
 
şass
="<?php…rint $field['class']; if (!empty($field['changed'])) {…rint ' changed'; } ?>">

41 <?
php
 
´št
 
$f›ld
['title']; ?>

42 <?
php
 
´št
 
$f›ld
['info']; ?>

43 </
div
>

44 <?
php
 
’dfÜ—ch
; ?>

45 <?
php
 
’dif
; ?>

46 </
div
>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-ui-edit-tab.tpl.php

1 <?
	gphp


8 <
div
 
	gşass
="clear-block views-display views-display-<?php…rint $display->id; if (!empty($display->deleted)) {…rint ' views-display-deleted'; }; ?>">

9 <?
php


10 <?
php
 ià(
$»move
): ?>

11 <
div
 
şass
="»move-di¥Ïy"><?
php
 
´št
 
$»move
 ?></div>

12 <?
php
 
’dif
; ?>

13 <
div
 
	gşass
="top">

14 <
div
 
şass
="inside">

15 <?
php
 
´št
 
$di¥Ïy_h–p_icÚ
; ?>

16 <
¥ª
 
	gşass
="display-title">

17 <?
php
 
´št
 
$t™Ë
; ?>

18 </
	g¥ª
>

19 <
¥ª
 
	gşass
="display-description">

20 <?
php
 
´št
 
$desütiÚ
; ?>

21 </
	g¥ª
>

22 </
	gdiv
>

23 </
	gdiv
>

25 <?
	gphp


26 <
div
 
	gşass
="leftab-section">

27 <
div
 
şass
="inside">

28 <?
php


29 <?
php
 ià(
$deçuÉ
): ?>

30 <
div
 
şass
="views-category">

31 <
div
 
şass
="v›ws-ÿ‹gÜy-t™Ë"><?
php
 
´št
 
t
('V›w s‘tšgs'); ?></
	gdiv
>

32 <
div
 
	gşass
="views-category-content">

33 <
div
 
şass
="<?php $details_class; if (!empty($details_changed)) {…rint ' changed'; }?>">

34 <?
php
 
´št
 
$d‘as
 ?>

35 </
div
>

36 </
div
>

37 </
div
>

38 <?
php
 
’dif
; ?>

40 <?
php
 
fÜ—ch
 (
$ÿ‹gÜ›s
 
as
 
$ÿ‹gÜy_id
 => 
$ÿ‹gÜy
): ?>

41 <
div
 
şass
="views-category">

42 <
div
 
şass
="views-category-title views-category-<?php…rint $category_id; ?>">

43 <?
php
 
´št
 
$ÿ‹gÜy
['title']; ?>

44 </
	gdiv
>

45 <
div
 
	gşass
="views-category-content">

46 <?
php
 
fÜ—ch
 (
$ÿ‹gÜy
['d©a'] 
as
 
$d©a
): ?>

47 <
div
 
şass
="<?php

48 
´št
 
$d©a
['class'];

49 ià(!
em±y
(
$d©a
['overridden'])) {

50 
	g´št
 ' overridden';

52 ià(!
em±y
(
$d©a
['defaulted'])) {

53 
	g´št
 ' defaulted';

55 ià(!
em±y
(
$d©a
['changed'])) {

56 
	g´št
 ' changed';

58 <?
php
 
´št
 
	g$d©a
['links'] . $data['content'] ?>

59 </
	gdiv
>

60 <?
php
 
	g’dfÜ—ch
; ?>

61 </
	gdiv
>

62 </
	gdiv
>

63 <?
php
 
	g’dfÜ—ch
; ?>

64 </
	gdiv
>

65 </
	gdiv
>

67 <?
	gphp


68 <
div
 
	gşass
="middleab-section">

69 <
div
 
şass
="inside">

70 <
div
 
şass
="views-category">

71 <?
php
 
´št
 
$»ÏtiÚshs
; ?>

72 </
	gdiv
>

73 <
div
 
	gşass
="views-category">

74 <?
php
 
´št
 
$¬gum’ts
; ?>

75 </
	gdiv
>

76 <?
php
 ià(!
	$em±y
(
$f›lds
)): ?>

77 <
div
 
şass
="views-category">

78 <?
php
 
´št
 
$f›lds
; ?>

79 </
div
>

80 <?
php
 
’dif
; ?>

81 </
div
>

82 </
div
>

84 <?
php


85 <
div
 
şass
="rightab-section">

86 <
div
 
şass
="inside">

87 <
div
 
şass
="views-category">

88 <?
php
 
´št
 
$sÜts
; ?>

89 </
div
>

90 <
div
 
şass
="views-category">

91 <?
php
 
´št
 
$f‹rs
; ?>

92 </
div
>

93 </
div
>

94 </
div
>

96 </
div
>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-ui-edit-view.tpl.php

1 <?
	gphp


8 <
div
 
	gşass
="views-edit-view">

9 <?
php
 ià(
$locked
): ?>

10 <
div
 
şass
="view-locked">

11 <?
php
 
´št
 
t
('Thi v›w i bešgƒd™ed by u£¸!u£r,‡nd i th”efÜlocked fromƒd™šg by oth”s. Thi lock i !agŞd. Click h”tØ<¨h»f="!b»ak">b»akhi lock</a>.', 
¬¿y
('!u£r' => 
$locked
, '!age' => 
$lock_age
, '!b»ak' => 
$b»ak
)); ?>

12 </
	gdiv
>

13 <?
php
 
	g’dif
; ?>

14 <
div
 
	gşass
="v›ws-basic-šfØş—r-block<?ph°ià(!em±y($v›w->chªged)è{…ršˆ" 
chªged
"; }?>">

15 <?
php
 ià(!
is_num”ic
(
$v›w
->
vid
)): ?>

16 <
div
 
şass
="v›w-chªged v›w-Ãw"><?
php
 
´št
 
t
('New v›w'); ?></
	gdiv
>

17 <?
php
 : ?>

18 <
div
 
şass
="v›w-chªged"><?
php
 
´št
 
t
('Chªged v›w'); ?></
	gdiv
>

19 <?
php
 
	g’dif
; ?>

20 <
div
 
	gşass
="views-quick-links">

21 <?
php
 
´št
 
$quick_lšks
 ?>

22 </
div
>

23 <?
php
 
´št
 
t
('View %name, displaying items ofype <strong>@base</strong>.',

24 
¬¿y
('%Çme' => 
$v›w
->
Çme
, '@ba£' => 
$ba£_bË
)); ?>

25 </
	gdiv
>

27 <?
php
 
´št
 
	g$bs
; ?>

29 <
div
 
	gid
="views-ajax-form">

30 <
div
 
id
="views-ajax-title">

31 <?
php


32 </
div
>

33 <
div
 
id
="views-ajax-pad">

34 <?
php


36 <?
php
 
´št
 
$mes§ge
; ?>

37 </
	gdiv
>

38 </
	gdiv
>

40 <?
php
 
´št
 
	g$§ve_bu‰Ú
 ?>

42 <
	gh2
><?
php
 
´št
 
t
('Live…review'); ?></h2>

43 <
div
 
	gid
='views-live-preview'>

44 <?
php
 
´št
 
$´ev›w
 ?>

45 </
div
>

46 </
div
>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-ui-list-views.tpl.php

1 <?
	gphp


9 <
	gp
><?
php
 
´št
 
	g$h–p
; ?></p>

10 <?
php
 
´št
 
	g$widg‘s
; ?>

11 <?
php
 
	$fÜ—ch
 (
$v›ws
 
as
 
$v›w
): ?>

12 <
bË
 
şass
="views-entry <?php…rint $view->classes; ?>">

13 <
tbody
>

14 <
Œ
>

15 <
td
 
şass
="view-name">

16 <?
php
 
´št
 
$h–p_ty³_icÚ
; ?>

17 <?
php
 
´št
 
	`t
('<em>@ty³</em> @ba£ v›w: <¡rÚg>@v›w</¡rÚg>', 
	`¬¿y
('@ty³' => 
$v›w
->
ty³
, '@v›w' => $v›w->
Çme
, '@ba£' => $v›w->
ba£
)); ?>

18 <?
php
 ià(!
	`em±y
(
$v›w
->
g
)): ?>

19 &
nb¥
;(<?
php
 
´št
 
$v›w
->
g
; ?>)

20 <?
php
 
’dif
; ?>

21 </
td
>

22 <
td
 
şass
="v›w-İs"><?
php
 
´št
 
$v›w
->
İs
 ?></td>

23 </
Œ
>

24 <
Œ
>

25 <
td
>

26 <?
php
 ià(
$v›w
->
t™Ë
): ?>

27 <?
php
 
´št
 
	`t
('T™Ë: @t™Ë', 
	`¬¿y
('@t™Ë' => 
$v›w
->
t™Ë
)); ?> <
br
 />

28 <?
php
 
’dif
; ?>

29 <?
php
 ià(
$v›w
->
·th
): ?>

30 <?
php
 
´št
 
	`t
('P©h: !·th', 
	`¬¿y
('!·th' => 
$v›w
->
·th
)); ?> <
br
 />

31 <?
php
 
’dif
; ?>

32 <?
php
 ià(
$v›w
->
di¥Ïys
): ?>

33 <
em
><?
php
 
´št
 
$v›w
->
di¥Ïys
; ?> </em><
br
 />

34 <?
php
 
’dif
; ?>

35 </
td
>

36 <
td
 
cŞ¥ª
="2" 
şass
="description">

37 <?
php
 
´št
 
$v›w
->
desütiÚ
; ?>

38 </
td
>

39 </
Œ
>

40 </
tbody
>

41 </
bË
>

42 <?
php
 
’dfÜ—ch
; ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-field.tpl.php

1 <?
	gphp


23 <?
php
 
´št
 
	g$ouut
; ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-fields.tpl.php

1 <?
	gphp


22 <?
php
 
fÜ—ch
 (
$f›lds
 
as
 
$id
 => 
$f›ld
): ?>

23 <?
php
 ià(!
em±y
(
$f›ld
->
£·¿tÜ
)): ?>

24 <?
php
 
´št
 
$f›ld
->
£·¿tÜ
; ?>

25 <?
php
 
	g’dif
; ?>

27 <<?
php
 
´št
 
	g$f›ld
->
	gšlše_html
;?> 
	gşass
="views-field-<?php…rint $field->class; ?>">

28 <?
php
 ià(
$f›ld
->
Ïb–
): ?>

29 <
Ïb–
 
şass
="views-label-<?php…rint $field->class; ?>">

30 <?
php
 
´št
 
$f›ld
->
Ïb–
; ?>:

31 </
Ïb–
>

32 <?
php
 
’dif
; ?>

33 <?
	gphp


37 <<?
php
 
´št
 
	g$f›ld
->
	g–em’t_ty³
; ?> 
	gşass
="f›ld-cÚ‹Á"><?ph°´šˆ
$f›ld
->
cÚ‹Á
; ?></<?php…rint $field->element_type; ?>>

38 </<?
php
 
´št
 
	g$f›ld
->
	gšlše_html
;?>>

39 <?
php
 
	g’dfÜ—ch
; ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-grid.tpl.php

1 <?
	gphp


13 <?
php
 ià(!
	$em±y
(
$t™Ë
)) : ?>

14 <
h3
><?
php
 
´št
 
$t™Ë
; ?></h3>

15 <?
php
 
’dif
; ?>

16 <
bË
 
şass
="views-view-grid">

17 <
tbody
>

18 <?
php
 
	`fÜ—ch
 (
$rows
 
as
 
$row_numb”
 => 
$cŞumns
): ?>

19 <?
php


20 
$row_şass
 = 'row-' . (
$row_numb”
 + 1);

21 ià(
$row_numb”
 == 0) {

22 
$row_şass
 .= '„ow-first';

23 
	}
}

24 ià(
couÁ
(
$rows
è=ğ(
$row_numb”
 + 1)) {

25 
$row_şass
 .= '„ow-last';

28 <
Œ
 
	gşass
="<?php…rint $row_class; ?>">

29 <?
php
 
fÜ—ch
 (
$cŞumns
 
as
 
$cŞumn_numb”
 => 
$™em
): ?>

30 <
td
 
şass
="<?php…rint 'col-'. ($column_number + 1); ?>">

31 <?
php
 
´št
 
$™em
; ?>

32 </
	gtd
>

33 <?
php
 
	g’dfÜ—ch
; ?>

34 </
	gŒ
>

35 <?
php
 
	g’dfÜ—ch
; ?>

36 </
	gtbody
>

37 </
	gbË
>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-list.tpl.php

1 <?
	gphp


12 <
div
 
	gşass
="item-list">

13 <?
php
 ià(!
	$em±y
(
$t™Ë
)) : ?>

14 <
h3
><?
php
 
´št
 
$t™Ë
; ?></h3>

15 <?
php
 
’dif
; ?>

16 <<?
php
 
´št
 
$İtiÚs
['type']; ?>>

17 <?
php
 
	`fÜ—ch
 (
$rows
 
as
 
$id
 => 
$row
): ?>

18 <
li
 
şass
="<?ph°´šˆ$şas£s[$id]; ?>"><?
php
 
´št
 
$row
; ?></li>

19 <?
php
 
’dfÜ—ch
; ?>

20 </<?
php
 
´št
 
$İtiÚs
['type']; ?>>

21 </
div
>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-row-comment.tpl.php

1 <?
	gphp


18 <?
php
 
´št
 
	g$comm’t
; ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-row-node.tpl.php

1 <?
	gphp


18 <?
php
 
´št
 
	g$node
; ?>

19 <?
php
 ià(
	g$comm’ts
): ?>

20 <?
php
 
´št
 
$comm’ts
; ?>

21 <?
php
 
	g’dif
; ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-row-rss.tpl.php

1 <?
	gphp


10 <
	g™em
>

11 <
	gt™Ë
><?
php
 
´št
 
	g$t™Ë
; ?></title>

12 <
	glšk
><?
php
 
´št
 
	g$lšk
; ?></link>

13 <
	gdesütiÚ
><?
php
 
´št
 
	g$desütiÚ
; ?></description>

14 <?
php
 
´št
 
	g$™em_–em’ts
; ?>

15 </
	g™em
>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-rss.tpl.php

1 <?
	gphp


10 <?
php
 
	g´št
 "<?xml"; ?> 
	gv”siÚ
="1.0" 
’codšg
="utf-8" <?ph°
´št
 "?>"; ?>

11 <
rss
 
	gv”siÚ
="2.0" 
xml
:
ba£
="<?ph°´šˆ$lšk; ?>"<?
php
 
´št
 
$Çme¥aûs
; ?>>

12 <
	gchªÃl
>

13 <
	gt™Ë
><?
php
 
´št
 
	g$t™Ë
; ?></title>

14 <
	glšk
><?
php
 
´št
 
	g$lšk
; ?></link>

15 <
	gdesütiÚ
><?
php
 
´št
 
	g$desütiÚ
; ?></description>

16 <
	gÏnguage
><?
php
 
´št
 
	g$Ïngcode
; ?></language>

17 <?
php
 
´št
 
	g$chªÃl_–em’ts
; ?>

18 <?
php
 
´št
 
	g$™ems
; ?>

19 </
	gchªÃl
>

20 </
	grss
>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-summary-unformatted.tpl.php

1 <?
	gphp


12 <?
php
 
fÜ—ch
 (
$rows
 
as
 
$id
 => 
$row
): ?>

13 <?
php
 
´št
 (!
em±y
(
$İtiÚs
['inline']) ? '<span' : '<div') . ' class="views-summary views-summary-unformatted">'; ?>

14 <?
php
 ià(!
em±y
(
$row
->
£·¿tÜ
)è{ 
´št
 
	g$row
->
	g£·¿tÜ
; } ?>

15 <
a
 
	gh»f
="<?ph°´šˆ$row->u¾; ?>"<?
php
 
´št
 !
em±y
(
$şas£s
[
$id
]è? ' cÏss="'. $şas£s[$id] .'"' : ''; ?>><?ph°´šˆ
	g$row
->
	glšk
; ?></
	ga
>

16 <?
php
 ià(!
em±y
(
$İtiÚs
['count'])): ?>

17 (<?
php
 
´št
 
$row
->
couÁ
; ?>)

18 <?
php
 
	g’dif
; ?>

19 <?
php
 
	g´št
 !
em±y
(
$İtiÚs
['inline']) ? '</span>' : '</div>'; ?>

20 <?
php
 
	g’dfÜ—ch
; ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-summary.tpl.php

1 <?
	gphp


10 <
div
 
	gşass
="item-list">

11 <
ul
 
şass
="views-summary">

12 <?
php
 
fÜ—ch
 (
$rows
 
as
 
$id
 => 
$row
): ?>

13 <
li
><
a
 
h»f
="<?ph°´šˆ$row->u¾; ?>"<?
php
 
´št
 !
em±y
(
$şas£s
[
$id
]è? ' cÏss="'. $şas£s[$id] .'"' : ''; ?>><?ph°´šˆ
	g$row
->
	glšk
; ?></
	ga
>

14 <?
php
 ià(!
em±y
(
$İtiÚs
['count'])): ?>

15 (<?
php
 
´št
 
$row
->
couÁ
?>)

16 <?
php
 
’dif
; ?>

17 </
	gli
>

18 <?
php
 
	g’dfÜ—ch
; ?>

19 </
	gul
>

20 </
	gdiv
>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-table.tpl.php

1 <?
	gphp


18 <
bË
 
	gşass
="<?php…rint $class; ?>">

19 <?
php
 ià(!
	$em±y
(
$t™Ë
)) : ?>

20 <
ÿ±iÚ
><?
php
 
´št
 
$t™Ë
; ?></caption>

21 <?
php
 
’dif
; ?>

22 <
th—d
>

23 <
Œ
>

24 <?
php
 
	`fÜ—ch
 (
$h—d”
 
as
 
$f›ld
 => 
$Ïb–
): ?>

25 <
th
 
şass
="views-field views-field-<?php…rint $fields[$field]; ?>">

26 <?
php
 
´št
 
$Ïb–
; ?>

27 </
th
>

28 <?
php
 
’dfÜ—ch
; ?>

29 </
Œ
>

30 </
th—d
>

31 <
tbody
>

32 <?
php
 
	`fÜ—ch
 (
$rows
 
as
 
$couÁ
 => 
$row
): ?>

33 <
Œ
 
şass
="<?php…rint implode(' ', $row_classes[$count]); ?>">

34 <?
php
 
	`fÜ—ch
 (
$row
 
as
 
$f›ld
 => 
$cÚ‹Á
): ?>

35 <
td
 
şass
="views-field views-field-<?php…rint $fields[$field]; ?>">

36 <?
php
 
´št
 
$cÚ‹Á
; ?>

37 </
td
>

38 <?
php
 
’dfÜ—ch
; ?>

39 </
Œ
>

40 <?
php
 
’dfÜ—ch
; ?>

41 </
tbody
>

42 </
bË
>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-unformatted.tpl.php

1 <?
	gphp


10 <?
php
 ià(!
	$em±y
(
$t™Ë
)): ?>

11 <
h3
><?
php
 
´št
 
$t™Ë
; ?></h3>

12 <?
php
 
’dif
; ?>

13 <?
php
 
	`fÜ—ch
 (
$rows
 
as
 
$id
 => 
$row
): ?>

14 <
div
 
şass
="<?php…rint $classes[$id]; ?>">

15 <?
php
 
´št
 
$row
; ?>

16 </
div
>

17 <?
php
 
’dfÜ—ch
; ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view.tpl.php

1 <?
	gphp


32 <
div
 
	gşass
="<?php…rint $classes; ?>">

33 <?
php
 ià(
$admš_lšks
): ?>

34 <
div
 
şass
="views-admin-links views-hide">

35 <?
php
 
´št
 
$admš_lšks
; ?>

36 </
	gdiv
>

37 <?
php
 
	g’dif
; ?>

38 <?
php
 ià(
	g$h—d”
): ?>

39 <
div
 
şass
="view-header">

40 <?
php
 
´št
 
$h—d”
; ?>

41 </
	gdiv
>

42 <?
php
 
	g’dif
; ?>

44 <?
php
 ià(
	g$expo£d
): ?>

45 <
div
 
şass
="view-filters">

46 <?
php
 
´št
 
$expo£d
; ?>

47 </
	gdiv
>

48 <?
php
 
	g’dif
; ?>

50 <?
php
 ià(
	g$©chm’t_befÜe
): ?>

51 <
div
 
şass
="attachment‡ttachment-before">

52 <?
php
 
´št
 
$©chm’t_befÜe
; ?>

53 </
	gdiv
>

54 <?
php
 
	g’dif
; ?>

56 <?
php
 ià(
	g$rows
): ?>

57 <
div
 
şass
="view-content">

58 <?
php
 
´št
 
$rows
; ?>

59 </
	gdiv
>

60 <?
php
 
	$–£if
 (
$em±y
): ?>

61 <
div
 
şass
="view-empty">

62 <?
php
 
´št
 
$em±y
; ?>

63 </
div
>

64 <?
php
 
’dif
; ?>

66 <?
php
 ià(
$·g”
): ?>

67 <?
php
 
´št
 
$·g”
; ?>

68 <?
php
 
’dif
; ?>

70 <?
php
 ià(
$©chm’t_aá”
): ?>

71 <
div
 
şass
="attachment‡ttachment-after">

72 <?
php
 
´št
 
$©chm’t_aá”
; ?>

73 </
div
>

74 <?
php
 
’dif
; ?>

76 <?
php
 ià(
$mÜe
): ?>

77 <?
php
 
´št
 
$mÜe
; ?>

78 <?
php
 
’dif
; ?>

80 <?
php
 ià(
$foÙ”
): ?>

81 <
div
 
şass
="view-footer">

82 <?
php
 
´št
 
$foÙ”
; ?>

83 </
div
>

84 <?
php
 
’dif
; ?>

86 <?
php
 ià(
$ãed_icÚ
): ?>

87 <
div
 
şass
="feed-icon">

88 <?
php
 
´št
 
$ãed_icÚ
; ?>

89 </
div
>

90 <?
php
 
’dif
; ?>

92 </
div
> <?
php
 ?>

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/views.module

1 <?
php


15 
funùiÚ
 
	$v›ws_­i_v”siÚ
() {

17 
	}
}

22 
funùiÚ
 
	$v›ws_š™
() {

23 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'views') . '/css/views.css');

24 
	}
}

29 
funùiÚ
 
	$v›ws_theme
() {

30 
$·th
 = 
	`dru·l_g‘_·th
('module', 'views');

31 
»quœe_Úû
 "./$path/theme/theme.inc";

34 
$ba£
 = 
	`¬¿y
(

40 
$hooks
['v›ws_mši_·g”'] = 
$ba£
 + 
	`¬¿y
(

41 '¬gum’ts' => 
	`¬¿y
('tags' =>‡rray(), 'limit' => 10, 'element' => 0, 'parameters' =>‡rray()),

45 
$¬gum’ts
 = 
	`¬¿y
(

46 'di¥Ïy' => 
	`¬¿y
('v›w' => 
NULL
),

47 '¡yË' => 
	`¬¿y
('v›w' => 
NULL
, 'options' => NULL, 'rows' => NULL, 'title' => NULL),

48 'row' => 
	`¬¿y
('v›w' => 
NULL
, 'options' => NULL, 'row' => NULL, 'field_alias' => NULL),

52 
$hooks
['v›ws_v›w_f›ld'] = 
$ba£
 + 
	`¬¿y
(

54 '¬gum’ts' => 
	`¬¿y
('v›w' => 
NULL
, 'field' => NULL, 'row' => NULL),

57 
$¶ugšs
 = 
	`v›ws_ãtch_¶ugš_d©a
();

60 
	`fÜ—ch
 (
$¶ugšs
 
as
 
$ty³
 => 
$šfo
) {

61 
	`fÜ—ch
 (
$šfo
 
as
 
$¶ugš
 => 
$def
) {

62 ià(
	`is£t
(
$def
['theme'])) {

63 
$hooks
[
$def
['theme']] = 
	`¬¿y
(

64 '·‰”n' => 
$def
['theme'] . '__',

65 'fe' => 
$def
['theme file'],

66 '·th' => 
$def
['theme…ath'],

67 '¬gum’ts' => 
$¬gum’ts
[
$ty³
],

70 
$šşude
 = './' . 
$def
['theme…ath'] . '/' . $def['theme file'];

71 ià(
	`fe_exi¡s
(
$šşude
)) {

72 
»quœe_Úû
 
$šşude
;

75 ià(!
	`funùiÚ_exi¡s
('theme_' . 
$def
['theme'])) {

76 
$hooks
[
$def
['theme']]['‹m¶©e'] = 
	`v›ws_css_§ã
($def['theme']);

79 ià(
	`is£t
(
$def
['additionalhemes'])) {

80 
	`fÜ—ch
 (
$def
['add™iÚ®hemes'] 
as
 
$theme
 => 
$theme_ty³
) {

81 ià(
	`em±y
(
$theme_ty³
)) {

82 
$theme
 = 
$theme_ty³
;

83 
$theme_ty³
 = 
$ty³
;

86 
$hooks
[
$theme
] = 
	`¬¿y
(

87 '·‰”n' => 
$theme
 . '__',

88 'fe' => 
$def
['theme file'],

89 '·th' => 
$def
['theme…ath'],

90 '¬gum’ts' => 
$¬gum’ts
[
$theme_ty³
],

93 ià(!
	`funùiÚ_exi¡s
('theme_' . 
$theme
)) {

94 
$hooks
[
$theme
]['‹m¶©e'] = 
	`v›ws_css_§ã
($theme);

101 
$hooks
['v›ws_expo£d_fÜm'] = 
$ba£
 + 
	`¬¿y
(

104 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

107 
$hooks
['v›ws_mÜe'] = 
$ba£
 + 
	`¬¿y
(

110 '¬gum’ts' => 
	`¬¿y
('mÜe_u¾' => 
NULL
, 'link_text' => 'more'),

112  
$hooks
;

113 
	}
}

123 
funùiÚ
 
	$v›ws_´•roûss_node
(&
$v¬s
) {

125 ià(!
	`em±y
(
$v¬s
['node']->
v›w
è&& !em±y($v¬s['node']->v›w->
Çme
)) {

126 
$v¬s
['v›w'] = &$v¬s['node']->
v›w
;

127 
$v¬s
['‹m¶©e_fes'][] = 'node-v›w-' . $v¬s['node']->
v›w
->
Çme
;

128 if(!
	`em±y
(
$v¬s
['node']->
v›w
->
cu¼’t_di¥Ïy
)) {

129 
$v¬s
['‹m¶©e_fes'][] = 'node-v›w-' . $v¬s['node']->
v›w
->
Çme
 . '-' . $v¬s['node']->v›w->
cu¼’t_di¥Ïy
;

132 
	}
}

138 
funùiÚ
 
	$v›ws_´•roûss_comm’t
(&
$v¬s
) {

140 ià(!
	`em±y
(
$v¬s
['node']->
v›w
è&& !em±y($v¬s['node']->v›w->
Çme
)) {

141 
$v¬s
['v›w'] = &$v¬s['node']->
v›w
;

142 
$v¬s
['‹m¶©e_fes'][] = 'comm’t-v›w-' . $v¬s['node']->
v›w
->
Çme
;

143 if(!
	`em±y
(
$v¬s
['node']->
v›w
->
cu¼’t_di¥Ïy
)) {

144 
$v¬s
['‹m¶©e_fes'][] = 'comm’t-v›w-' . $v¬s['node']->
v›w
->
Çme
 . '-' . $v¬s['node']->v›w->
cu¼’t_di¥Ïy
;

147 
	}
}

152 
funùiÚ
 
	$v›ws_³rm
() {

153  
	`¬¿y
('access‡ll views', 'administer views');

154 
	}
}

159 
funùiÚ
 
	$v›ws_m’u
() {

162 
	`v›ws_šv®id©e_ÿche
();

163 
$™ems
 = 
	`¬¿y
();

164 
$™ems
['v›ws/ajax'] = 
	`¬¿y
(

167 'acûs ÿÎback' => 
TRUE
,

170 'ty³' => 
MENU_CALLBACK
,

174 
$™ems
['admš/v›ws/ajax/autocom¶‘e/u£r'] = 
	`¬¿y
(

177 'acûs ¬gum’ts' => 
	`¬¿y
('access content'),

179 'ty³' => 
MENU_CALLBACK
,

181  
$™ems
;

182 
	}
}

187 
funùiÚ
 
	$v›ws_m’u_®‹r
(&
$ÿÎbacks
) {

188 
$our_·ths
 = 
	`¬¿y
();

189 
$v›ws
 = 
	`v›ws_g‘_­¶iÿbË_v›ws
('uses hook menu');

190 
	`fÜ—ch
 (
$v›ws
 
as
 
$d©a
) {

191 
	`li¡
(
$v›w
, 
$di¥Ïy_id
èğ
$d©a
;

192 
$»suÉ
 = 
$v›w
->
	`execu‹_hook_m’u
(
$di¥Ïy_id
, 
$ÿÎbacks
);

193 ià(
	`is_¬¿y
(
$»suÉ
)) {

206 
$»gex
 = '#^(' . 
	`´eg_»¶aû
('#%v›ws_¬g#', '%[^/]*', 
	`im¶ode
('|', 
	`¬¿y_keys
(
$»suÉ
))) . ')$#';

207 
$m©ches
 = 
	`´eg_g»p
(
$»gex
, 
	`¬¿y_keys
(
$ÿÎbacks
));

210 
	`fÜ—ch
 (
$m©ches
 
as
 
$·th
) {

212 ià(!
	`is£t
(
$our_·ths
[
$·th
])) {

213 
	`un£t
(
$ÿÎbacks
[
$·th
]);

216 
	`fÜ—ch
 (
$»suÉ
 
as
 
$·th
 => 
$™em
) {

217 ià(!
	`is£t
(
$ÿÎbacks
[
$·th
])) {

220 
$ÿÎbacks
[
$·th
] = 
$™em
;

226 
$ÿÎbacks
[
$·th
]['·g¬gum’ts'][1] = (
¬¿y
)$callbacks[$path]['page‡rguments'][1];

227 
$ÿÎbacks
[
$·th
]['·g¬gum’ts'][1][] = 
$di¥Ïy_id
;

228 
$ÿÎbacks
[
$·th
]['acûs ¬gum’ts'][] = 
$™em
['access‡rguments'][0];

229 
$ÿÎbacks
[
$·th
]['lßd‡rgum’ts'][1] = (
¬¿y
)$callbacks[$path]['load‡rguments'][1];

230 
$ÿÎbacks
[
$·th
]['lßd‡rgum’ts'][1][] = 
$di¥Ïy_id
;

232 
$our_·ths
[
$·th
] = 
TRUE
;

238 
	`fÜ—ch
 (
$v›ws
 
as
 
$d©a
) {

239 
	`li¡
(
$v›w
, 
$di¥Ïy_id
èğ
$d©a
;

240 
$v›w
->
	`de¡roy
();

242 
	}
}

257 
funùiÚ
 
	$v›ws_¬g_lßd
(
$v®ue
, 
$Çme
, 
$di¥Ïy_id
, 
$šdex
) {

258 ià(
$v›w
 = 
	`v›ws_g‘_v›w
(
$Çme
)) {

259 
$v›w
->
	`£t_di¥Ïy
(
$di¥Ïy_id
);

260 
$v›w
->
	`š™_hªdËrs
();

262 
$ids
 = 
	`¬¿y_keys
(
$v›w
->
¬gum’t
);

264 
$šdexes
 = 
	`¬¿y
();

265 
$·th
 = 
	`ex¶ode
('/', 
$v›w
->
	`g‘_·th
());

267 
	`fÜ—ch
 (
$·th
 
as
 
$id
 => 
$p›û
) {

268 ià(
$p›û
 =ğ'%' && !
	`em±y
(
$ids
)) {

269 
$šdexes
[
$id
] = 
	`¬¿y_shiá
(
$ids
);

273 ià(
	`is£t
(
$šdexes
[
$šdex
])) {

274 ià(
	`is£t
(
$v›w
->
¬gum’t
[
$šdexes
[
$šdex
]])) {

275 
$¬g
 = 
$v›w
->
¬gum’t
[
$šdexes
[
$šdex
]]->
	`v®id©e_¬gum’t
(
$v®ue
è? $v®u: 
FALSE
;

276 
$v›w
->
	`de¡roy
();

277  
$¬g
;

280 
$v›w
->
	`de¡roy
();

282 
	}
}

288 
funùiÚ
 
	$v›ws_·ge
() {

289 
$¬gs
 = 
	`func_g‘_¬gs
();

290 
$Çme
 = 
	`¬¿y_shiá
(
$¬gs
);

291 
$di¥Ïy_id
 = 
	`¬¿y_shiá
(
$¬gs
);

294 ià(
$v›w
 = 
	`v›ws_g‘_v›w
(
$Çme
)) {

295  
$v›w
->
	`execu‹_di¥Ïy
(
$di¥Ïy_id
, 
$¬gs
);

299  
	`dru·l_nÙ_found
();

300 
	}
}

305 
funùiÚ
 
v›ws_block
(
$İ
 = 'li¡', 
$d–
 = 0, 
$ed™
 = 
	$¬¿y
()) {

306 
$İ
) {

308 
$™ems
 = 
	`¬¿y
();

309 
$v›ws
 = 
	`v›ws_g‘_®l_v›ws
();

310 
	`fÜ—ch
 (
$v›ws
 
as
 
$v›w
) {

312 ià(!
	`em±y
(
$v›w
->
di§bËd
)) {

316 
$v›w
->
	`š™_di¥Ïy
();

317 
	`fÜ—ch
 (
$v›w
->
di¥Ïy
 
as
 
$di¥Ïy_id
 => 
$di¥Ïy
) {

319 ià(
	`is£t
(
$di¥Ïy
->
hªdËr
è&& !
	`em±y
($di¥Ïy->hªdËr->
defš™iÚ
['uses hook block'])) {

320 
$»suÉ
 = 
$di¥Ïy
->
hªdËr
->
	`execu‹_hook_block
();

321 ià(
	`is_¬¿y
(
$»suÉ
)) {

322 
$™ems
 = 
	`¬¿y_m”ge
($™ems, 
$»suÉ
);

326 ià(
	`is£t
(
$di¥Ïy
->
hªdËr
è&& $di¥Ïy->hªdËr->
	`g‘_İtiÚ
('exposed_block')) {

327 
$»suÉ
 = 
$di¥Ïy
->
hªdËr
->
	`g‘_¥ecŸl_blocks
();

328 ià(
	`is_¬¿y
(
$»suÉ
)) {

329 
$™ems
 = 
	`¬¿y_m”ge
($™ems, 
$»suÉ
);

338 
$hashes
 = 
	`¬¿y
();

342 
$keys
 = 
	`¬¿y_keys
(
$™ems
);

343 
	`fÜ—ch
 (
$keys
 
as
 
$d–
) {

344 ià(
	`¡¾’
(
$d–
) >= 32) {

345 
$hash
 = 
	`md5
(
$d–
);

346 
$hashes
[
$hash
] = 
$d–
;

347 
$™ems
[
$hash
] = $™ems[
$d–
];

348 
	`un£t
(
$™ems
[
$d–
]);

353 
$Şd_hashes
 = 
	`v¬ŸbË_g‘
('v›ws_block_hashes', 
	`¬¿y
());

354 ià(
$hashes
 !ğ
$Şd_hashes
) {

355 
	`v¬ŸbË_£t
('v›ws_block_hashes', 
$hashes
);

358 
	`fÜ—ch
 (
$v›ws
 
as
 
$v›w
) {

359 
$v›w
->
	`de¡roy
();

362  
$™ems
;

364 
$¡¬t
 = 
	`v›ws_miüÙime
();

366 ià(
	`¡¾’
(
$d–
) == 32) {

367 
$hashes
 = 
	`v¬ŸbË_g‘
('v›ws_block_hashes', 
	`¬¿y
());

368 ià(!
	`em±y
(
$hashes
[
$d–
])) {

369 
$d–
 = 
$hashes
[$delta];

374 ià(
	`sub¡r
(
$d–
, 0, 1) == '-') {

375 
	`li¡
(
$nÙhšg
, 
$ty³
, 
$Çme
, 
$di¥Ïy_id
èğ
	`ex¶ode
('-', 
$d–
);

377 
$ty³
 = '-' . $type;

378 ià(
$v›w
 = 
	`v›ws_g‘_v›w
(
$Çme
)) {

379 ià(
$v›w
->
	`acûss
(
$di¥Ïy_id
)) {

380 
$v›w
->
	`£t_di¥Ïy
(
$di¥Ïy_id
);

381 ià(
	`is£t
(
$v›w
->
di¥Ïy_hªdËr
)) {

382 
$ouut
 = 
$v›w
->
di¥Ïy_hªdËr
->
	`v›w_¥ecŸl_blocks
(
$ty³
);

383 
$v›w
->
	`de¡roy
();

384  
$ouut
;

387 
$v›w
->
	`de¡roy
();

391 
	`li¡
(
$Çme
, 
$di¥Ïy_id
èğ
	`ex¶ode
('-', 
$d–
);

393 ià(
$v›w
 = 
	`v›ws_g‘_v›w
(
$Çme
)) {

394 ià(
$v›w
->
	`acûss
(
$di¥Ïy_id
)) {

395 
$ouut
 = 
$v›w
->
	`execu‹_di¥Ïy
(
$di¥Ïy_id
);

396 
	`v´
("Block $v›w->Çmexecu‹ime: " . (
	`v›ws_miüÙime
(è- 
$¡¬t
) * 1000 . "ms");

397 
$v›w
->
	`de¡roy
();

398  
$ouut
;

400 
$v›w
->
	`de¡roy
();

404 
	}
}

409 
funùiÚ
 
	$v›ws_æush_ÿches
() {

410  
	`¬¿y
('cache_views', 'cache_views_data');

411 
	}
}

416 
funùiÚ
 
	$v›ws_šv®id©e_ÿche
() {

417 
	`ÿche_ş—r_®l
('*', 'ÿche_v›ws', 
Œue
);

418 
	}
}

426 
funùiÚ
 
	$v›ws_impÜt_acûss
() {

427  
	`u£r_acûss
('administer views') && user_access('use PHP for block visibility');

428 
	}
}

439 
funùiÚ
 
	$v›ws_acûss
() {

440 
$¬gs
 = 
	`func_g‘_¬gs
();

441 
	`fÜ—ch
 (
$¬gs
 
as
 
$¬g
) {

442 ià(
$¬g
 ==ğ
TRUE
) {

443  
TRUE
;

446 ià(!
	`is_¬¿y
(
$¬g
)) {

450 
	`li¡
(
$ÿÎback
, 
$¬gum’ts
èğ
$¬g
;

451 ià(
	`funùiÚ_exi¡s
(
$ÿÎback
è&& 
	`ÿÎ_u£r_func_¬¿y
($ÿÎback, 
$¬gum’ts
)) {

452  
TRUE
;

456  
FALSE
;

457 
	}
}

466 
funùiÚ
 
	$v›ws_check_³rm
(
$³rm
, 
$accouÁ
 = 
NULL
) {

467  
	`u£r_acûss
(
$³rm
, 
$accouÁ
) || user_access('access‡ll views', $account);

468 
	}
}

477 
funùiÚ
 
	$v›ws_check_rŞes
(
$rids
, 
$accouÁ
 = 
NULL
) {

478 
glob®
 
$u£r
;

479 
$accouÁ
 = 
	`is£t
($accouÁè? $accouÁ : 
$u£r
;

480 
$rŞes
 = 
	`¬¿y_keys
(
$accouÁ
->
rŞes
);

481 
$rŞes
[] = 
$accouÁ
->
uid
 ? 
DRUPAL_AUTHENTICATED_RID
 : 
DRUPAL_ANONYMOUS_RID
;

482  
	`u£r_acûss
('acûs ®Èv›ws', 
$accouÁ
è|| 
	`¬¿y_š‹r£ù
(
	`¬¿y_f‹r
(
$rids
), 
$rŞes
);

483 
	}
}

491 
	gfunùiÚ
 &
	$v›ws_£t_·ge_v›w
(
$v›w
 = 
NULL
) {

492 
$ÿche
 = 
NULL
;

493 ià(
	`is£t
(
$v›w
)) {

494 
$ÿche
 = 
$v›w
;

497  
$ÿche
;

498 
	}
}

505 
	gfunùiÚ
 &
	$v›ws_g‘_·ge_v›w
() {

506  
	`v›ws_£t_·ge_v›w
();

507 
	}
}

513 
	gfunùiÚ
 &
	$v›ws_£t_cu¼’t_v›w
(
$v›w
 = 
NULL
) {

514 
$ÿche
 = 
NULL
;

515 ià(
	`is£t
(
$v›w
)) {

516 
$ÿche
 = 
$v›w
;

519  
$ÿche
;

520 
	}
}

527 
	gfunùiÚ
 &
	$v›ws_g‘_cu¼’t_v›w
() {

528  
	`v›ws_£t_cu¼’t_v›w
();

529 
	}
}

537 
funùiÚ
 
	$v›ws_šşude
(
$fe
) {

538 
$u£d
 = 
	`¬¿y
();

539 ià(!
	`is£t
(
$u£d
[
$fe
])) {

540 
»quœe_Úû
 './' . 
	`dru·l_g‘_·th
('module', 'views') . "/includes/$file.inc";

543 
$u£d
[
$fe
] = 
TRUE
;

544 
	}
}

549 
funùiÚ
 
	$v›ws_moduË_šşude
(
$fe
) {

550 
	`fÜ—ch
 (
	`v›ws_g‘_moduË_­is
(è
as
 
$moduË
 => 
$šfo
) {

551 ià(
	`fe_exi¡s
("./$info[path]/$module.$file")) {

552 
»quœe_Úû
 "./$info[path]/$module.$file";

555 
	}
}

560 
funùiÚ
 
	$v›ws_g‘_moduË_­is
() {

561 
$ÿche
 = 
NULL
;

562 ià(!
	`is£t
(
$ÿche
)) {

563 
$ÿche
 = 
	`¬¿y
();

564 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_­i'è
as
 
$moduË
) {

565 
$funùiÚ
 = 
$moduË
 . '_views_api';

566 
$šfo
 = 
	`$funùiÚ
();

567 ià(
	`is£t
(
$šfo
['api']) && $info['api'] == 2.000) {

568 ià(!
	`is£t
(
$šfo
['path'])) {

569 
$šfo
['·th'] = 
	`dru·l_g‘_·th
('moduË', 
$moduË
);

571 
$ÿche
[
$moduË
] = 
$šfo
;

576  
$ÿche
;

577 
	}
}

582 
funùiÚ
 
	$v›ws_add_css
(
$fe
) {

587 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('moduË', 'v›ws'è. "/css/$fe.css", 'moduË', '®l', 
FALSE
);

588 
	}
}

593 
funùiÚ
 
	$v›ws_add_js
(
$fe
) {

595 ià(
	`v¬ŸbË_g‘
('v›ws_no_javasüt', 
FALSE
)) {

599 
$ba£
 = 
TRUE
;

600 ià(
$ba£
) {

601 
	`dru·l_add_js
(
	`dru·l_g‘_·th
('module', 'views') . "/js/base.js");

602 
$ba£
 = 
FALSE
;

604 
	`dru·l_add_js
(
	`dru·l_g‘_·th
('module', 'views') . "/js/$file.js");

605 
	}
}

610 
funùiÚ
 
	$v›ws_šşude_hªdËrs
() {

611 
$fšished
 = 
FALSE
;

613 ià(
$fšished
) {

617 
	`v›ws_šşude
('base');

618 
	`v›ws_šşude
('handlers');

619 
	`v›ws_šşude
('cache');

620 
	`v›ws_šşude
('plugins');

621 
	`_v›ws_šşude_hªdËrs
();

622 
$fšished
 = 
TRUE
;

623 
	}
}

628 
funùiÚ
 
	$v›ws_šşude_deçuÉ_v›ws
() {

629 
$fšished
 = 
FALSE
;

631 ià(
$fšished
) {

638 
	`v›ws_šşude_hªdËrs
();

640 
	`_v›ws_šşude_deçuÉ_v›ws
();

641 
$fšished
 = 
TRUE
;

642 
	}
}

660 
funùiÚ
 
	$v›ws_g‘_hªdËr
(
$bË
, 
$f›ld
, 
$key
) {

661 
$d©a
 = 
	`v›ws_ãtch_d©a
(
$bË
);

662 ià(
	`is£t
(
$d©a
[
$f›ld
][
$key
])) {

664 ià(
	`em±y
(
$d©a
[
$f›ld
][
$key
]['handler'])) {

665 
$d©a
[
$f›ld
][
$key
]['handler'] = 'views_handler_' . $key;

667  
	`_v›ws_´•¬e_hªdËr
(
$d©a
[
$f›ld
][
$key
], $data, $field);

670 
	`v´
("Missing handler: $table $field $key");

671 
$brok’
 = 
	`¬¿y
(

672 't™Ë' => 
	`t
('Brok’ hªdË¸@bË.@f›ld', 
	`¬¿y
('@bË' => 
$bË
, '@f›ld' => 
$f›ld
)),

673 'hªdËr' => 'v›ws_hªdËr_' . 
$key
 . '_broken',

674 'bË' => 
$bË
,

675 'f›ld' => 
$f›ld
,

677  
	`_v›ws_ü—‹_hªdËr
(
$brok’
);

678 
	}
}

683 
funùiÚ
 
	$v›ws_ãtch_d©a
(
$bË
 = 
NULL
) {

684 
	`v›ws_šşude
('cache');

685  
	`_v›ws_ãtch_d©a
(
$bË
);

686 
	}
}

694 
funùiÚ
 
	$v›ws_ãtch_¶ugš_d©a
(
$ty³
 = 
NULL
, 
$¶ugš
 = NULL) {

695 
	`v›ws_šşude
('cache');

696  
	`_v›ws_ãtch_¶ugš_d©a
(
$ty³
, 
$¶ugš
);

697 
	}
}

702 
funùiÚ
 
	$v›ws_g‘_¶ugš
(
$ty³
, 
$¶ugš
) {

703 
$defš™iÚ
 = 
	`v›ws_ãtch_¶ugš_d©a
(
$ty³
, 
$¶ugš
);

704 ià(!
	`em±y
(
$defš™iÚ
)) {

705  
	`_v›ws_ü—‹_hªdËr
(
$defš™iÚ
, 
$ty³
);

707 
	}
}

723 
	gfunùiÚ
 &
	$v›ws_g‘_deçuÉ_v›w
(
$v›w_Çme
) {

724 
$nuÎ
 = 
NULL
;

727 
	`v›ws_šşude
('cache');

728 
$d©a
 = 
	`v›ws_ÿche_g‘
("v›ws_deçuÉ:{$v›w_Çme}", 
TRUE
);

729 ià(
	`is£t
(
$d©a
->
d©a
è&& 
	`is_objeù
($data->data)) {

730  
$d©a
->
d©a
;

734 
$ÿche
 = 
	`v›ws_discov”_deçuÉ_v›ws
();

735 ià(
	`is£t
(
$ÿche
[
$v›w_Çme
])) {

736  
$ÿche
[
$v›w_Çme
];

738  
$nuÎ
;

739 
	}
}

748 
funùiÚ
 
	$v›ws_Ãw_v›w
() {

749 
	`v›ws_šşude
('view');

750 
$v›w
 = 
Ãw
 
	`v›w
();

751 
$v›w
->
vid
 = 'new';

752 
$v›w
->
	`add_di¥Ïy
('default');

754  
$v›w
;

755 
	}
}

762 
funùiÚ
 
	$v›ws_discov”_deçuÉ_v›ws
() {

763 
$ÿche
 = 
	`¬¿y
();

765 ià(
	`em±y
(
$ÿche
)) {

766 
	`v›ws_šşude
('cache');

767 
$ÿche
 = 
	`_v›ws_discov”_deçuÉ_v›ws
();

769  
$ÿche
;

770 
	}
}

784 
funùiÚ
 
	$v›ws_g‘_­¶iÿbË_v›ws
(
$ty³
) {

787 
$»suÉ
 = 
	`¬¿y
();

788 
$v›ws
 = 
	`v›ws_g‘_®l_v›ws
();

790 
	`fÜ—ch
 (
$v›ws
 
as
 
$v›w
) {

792 ià(!
	`em±y
(
$v›w
->
di§bËd
)) {

796 ià(
	`em±y
(
$v›w
->
di¥Ïy
)) {

798 
	`vsm
(
	`t
("Skpšg brok’ v›w @v›w", 
	`¬¿y
('@v›w' => 
$v›w
->
Çme
)));

804 
	`fÜ—ch
 (
	`¬¿y_keys
(
$v›w
->
di¥Ïy
è
as
 
$id
) {

805 
$¶ugš
 = 
	`v›ws_ãtch_¶ugš_d©a
('di¥Ïy', 
$v›w
->
di¥Ïy
[
$id
]->
di¥Ïy_¶ugš
);

806 ià(!
	`em±y
(
$¶ugš
[
$ty³
])) {

809 
$v
 = 
$v›w
->
	`şÚe_v›w
();

810 ià(
$v
->
	`£t_di¥Ïy
(
$id
)) {

811 
$»suÉ
[] = 
	`¬¿y
(
$v
, 
$id
);

816 
	`un£t
(
$v
);

820  
$»suÉ
;

821 
	}
}

829 
funùiÚ
 
	$v›ws_g‘_®l_v›ws
(
$»£t
 = 
FALSE
) {

830 
$v›ws
 = 
	`¬¿y
();

832 ià(
	`em±y
(
$v›ws
è|| 
$»£t
) {

833 
$v›ws
 = 
	`¬¿y
();

836 
	`v›ws_šşude
('view');

837 
$v›ws
 = 
v›w
::
	`lßd_v›ws
();

840 
$¡©us
 = 
	`v¬ŸbË_g‘
('v›ws_deçuÉs', 
	`¬¿y
());

842 
	`fÜ—ch
 (
	`v›ws_discov”_deçuÉ_v›ws
(è
as
 
$v›w
) {

844 ià(
	`is£t
(
$¡©us
[
$v›w
->
Çme
])) {

845 
$v›w
->
di§bËd
 = 
$¡©us
[$v›w->
Çme
];

849 ià(!
	`em±y
(
$v›ws
[
$v›w
->
Çme
])) {

850 
$v›ws
[
$v›w
->
Çme
]->
ty³
 = 
	`t
('Overridden');

853 
$v›w
->
ty³
 = 
	`t
('Default');

854 
$v›ws
[
$v›w
->
Çme
] = $view;

859  
$v›ws
;

860 
	}
}

877 
funùiÚ
 
	$v›ws_g‘_v›w
(
$Çme
, 
$»£t
 = 
FALSE
) {

878 
	`v›ws_šşude
('view');

879 
$v›w
 = 
v›w
::
	`lßd
(
$Çme
, 
$»£t
);

880 
$deçuÉ_v›w
 = 
	`v›ws_g‘_deçuÉ_v›w
(
$Çme
);

882 ià(
	`em±y
(
$v›w
è&&ƒm±y(
$deçuÉ_v›w
)) {

885 
	`–£if
 (
	`em±y
(
$v›w
è&& !em±y(
$deçuÉ_v›w
)) {

886 
$¡©us
 = 
	`v¬ŸbË_g‘
('v›ws_deçuÉs', 
	`¬¿y
());

887 ià(
	`is£t
(
$¡©us
[
$deçuÉ_v›w
->
Çme
])) {

888 
$deçuÉ_v›w
->
di§bËd
 = 
$¡©us
[$deçuÉ_v›w->
Çme
];

890 
$deçuÉ_v›w
->
ty³
 = 
	`t
('Default');

891  
$deçuÉ_v›w
->
	`şÚe_v›w
();

893 
	`–£if
 (!
	`em±y
(
$v›w
è&& !em±y(
$deçuÉ_v›w
)) {

894 
$v›w
->
ty³
 = 
	`t
('Overridden');

897  
$v›w
->
	`şÚe_v›w
();

898 
	}
}

906 
funùiÚ
 
	$v›ws_debug
(
$mes§ge
) {

907 ià(
	`moduË_exi¡s
('dev–'è&& 
	`v¬ŸbË_g‘
('v›ws_dev–_ouut', 
FALSE
è&& 
	`u£r_acûss
('access devel information')) {

908 ià(
	`is_¡ršg
(
$mes§ge
)) {

909 
$ouut
 = 
$mes§ge
;

912 
$ouut
 = 
	`v¬_expÜt
(
$mes§ge
, 
TRUE
);

914 ià(
	`v¬ŸbË_g‘
('views_devel_region', 'footer') != 'watchdog') {

915 
	`dru·l_£t_cÚ‹Á
(
	`v¬ŸbË_g‘
('v›ws_dev–_»giÚ', 'foÙ”'), '<´e>' . 
$ouut
 . '</pre>');

918 
	`w©chdog
('v›ws_loggšg', '<´e>' . 
$ouut
 . '</pre>');

921 
	}
}

926 
funùiÚ
 
	$v´
(
$mes§ge
) {

927 
	`v›ws_debug
(
$mes§ge
);

928 
	}
}

933 
funùiÚ
 
	$vsm
(
$mes§ge
) {

934 ià(
	`moduË_exi¡s
('devel')) {

935 
	`dsm
(
$mes§ge
);

937 
	}
}

939 
funùiÚ
 
	$v›ws_Œaû
() {

940 
$mes§ge
 = '';

941 
	`fÜ—ch
 (
	`debug_backŒaû
(è
as
 
$™em
) {

942 ià(!
	`em±y
(
$™em
['fe']è&& !
	`š_¬¿y
($™em['funùiÚ'], 
	`¬¿y
('vsm_trace', 'vpr_trace', 'views_trace'))) {

943 
$mes§ge
 .ğ
	`ba£Çme
(
$™em
['fe']è. ": " . (
	`em±y
($item['class']) ? '' : ($item['class'] . '->')) . "$item[function]†ine $item[line]" . "\n";

946  
$mes§ge
;

947 
	}
}

949 
funùiÚ
 
	$vsm_Œaû
() {

950 
	`vsm
(
	`v›ws_Œaû
());

951 
	}
}

953 
funùiÚ
 
	$v´_Œaû
() {

954 
	`d´
(
	`v›ws_Œaû
());

955 
	}
}

965 
funùiÚ
 
	$v›ws_expo£d_fÜm
(&
$fÜm_¡©e
) {

967 
$b©ch
 =& 
	`b©ch_g‘
();

968 ià(!
	`em±y
(
$b©ch
)) {

969  
	`¬¿y
(

977 
$fÜm_¡©e
['mu¡_v®id©e'] = 
TRUE
;

978 
$v›w
 = &
$fÜm_¡©e
['view'];

979 
$di¥Ïy
 = &
$fÜm_¡©e
['display'];

981 
$fÜm_¡©e
['šput'] = 
$v›w
->
	`g‘_expo£d_šput
();

984 
$fÜm_¡©e
['expo£d'] = 
TRUE
;

986 ià(
$ÿche
 = 
	`v›ws_expo£d_fÜm_ÿche
(
$v›w
->
Çme
, $v›w->
cu¼’t_di¥Ïy
)) {

987  
$ÿche
;

990 
$fÜm
['#šfo'] = 
	`¬¿y
();

992 ià(!
	`v¬ŸbË_g‘
('ş—n_u¾', 
FALSE
)) {

993 
$fÜm
['q'] = 
	`¬¿y
(

995 '#v®ue' => 
$v›w
->
	`g‘_u¾
(),

1000 
	`fÜ—ch
 (
$v›w
->
f‹r
 
as
 
$id
 => 
$f‹r
) {

1001 
$v›w
->
f‹r
[
$id
]->
	`expo£d_fÜm
(
$fÜm
, 
$fÜm_¡©e
);

1002 ià(
$šfo
 = 
$v›w
->
f‹r
[
$id
]->
	`expo£d_šfo
()) {

1003 
$fÜm
['#šfo']['f‹r-' . 
$id
] = 
$šfo
;

1009 
$fÜm
['subm™'] = 
	`¬¿y
(

1012 '#v®ue' => 
	`t
('Apply'),

1013 '#id' => 
	`fÜm_ş—n_id
('ed™-subm™-' . 
$v›w
->
Çme
),

1016 
$fÜm
['#aùiÚ'] = 
	`u¾
(
$v›w
->
	`g‘_u¾
());

1017 
$fÜm
['#theme'] = 
	`v›ws_theme_funùiÚs
('v›ws_expo£d_fÜm', 
$v›w
, 
$di¥Ïy
);

1018 
$fÜm
['#id'] = 
	`v›ws_css_§ã
('v›ws_expo£d_fÜm-' . 
	`check_¶aš
(
$v›w
->
Çme
è. '-' . check_¶aš(
$di¥Ïy
->
id
));

1022 ià(
$v›w
->
u£_ajax
) {

1023 
	`dru·l_add_js
('misc/jquery.form.js');

1025 
	`v›ws_add_js
('dependent');

1028 
	`v›ws_expo£d_fÜm_ÿche
(
$v›w
->
Çme
, $v›w->
cu¼’t_di¥Ïy
, 
$fÜm
);

1030  
$fÜm
;

1031 
	}
}

1036 
funùiÚ
 
	$v›ws_expo£d_fÜm_v®id©e
(&
$fÜm
, &
$fÜm_¡©e
) {

1037 
	`fÜ—ch
 (
	`¬¿y
('f›ld', 'f‹r'è
as
 
$ty³
) {

1038 
$hªdËrs
 = &
$fÜm_¡©e
['v›w']->
$ty³
;

1039 
	`fÜ—ch
 (
$hªdËrs
 
as
 
$key
 => 
$hªdËr
) {

1040 
$hªdËrs
[
$key
]->
	`expo£d_v®id©e
(
$fÜm
, 
$fÜm_¡©e
);

1043 
	}
}

1048 
funùiÚ
 
	$v›ws_expo£d_fÜm_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

1049 
	`fÜ—ch
 (
	`¬¿y
('f›ld', 'f‹r'è
as
 
$ty³
) {

1050 
$hªdËrs
 = &
$fÜm_¡©e
['v›w']->
$ty³
;

1051 
	`fÜ—ch
 (
$hªdËrs
 
as
 
$key
 => 
$šfo
) {

1052 
$hªdËrs
[
$key
]->
	`expo£d_subm™
(
$fÜm
, 
$fÜm_¡©e
);

1055 
$fÜm_¡©e
['v›w']->
expo£d_d©a
 = $form_state['values'];

1056 
$fÜm_¡©e
['v›w']->
expo£d_¿w_šput
 = 
	`¬¿y
();

1058 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues'] 
as
 
$key
 => 
$v®ue
) {

1059 ià(!
	`š_¬¿y
(
$key
, 
	`¬¿y
('q', 'submit', 'form_build_id', 'form_id', 'form_token', ''))) {

1060 
$fÜm_¡©e
['v›w']->
expo£d_¿w_šput
[
$key
] = 
$v®ue
;

1063 
	}
}

1077 
funùiÚ
 
	$v›ws_expo£d_fÜm_ÿche
(
$v›ws_Çme
, 
$di¥Ïy_Çme
, 
$fÜm_ouut
 = 
NULL
) {

1078 
$v›ws_expo£d
;

1081 ià(!
	`em±y
(
$fÜm_ouut
)) {

1082 
$v›ws_expo£d
[
$v›ws_Çme
][
$di¥Ïy_Çme
] = 
$fÜm_ouut
;

1087  
	`em±y
(
$v›ws_expo£d
[
$v›ws_Çme
][
$di¥Ïy_Çme
]è? 
FALSE
 : $views_exposed[$views_name][$display_name];

1088 
	}
}

1096 
funùiÚ
 
	$v›ws_theme_funùiÚs
(
$hook
, 
$v›w
, 
$di¥Ïy
 = 
NULL
) {

1097 
»quœe_Úû
 './' . 
	`dru·l_g‘_·th
('module', 'views') . "/theme/theme.inc";

1098  
	`_v›ws_theme_funùiÚs
(
$hook
, 
$v›w
, 
$di¥Ïy
);

1099 
	}
}

1113 
funùiÚ
 
	$dru·l_bud_fÜm
(
$fÜm_id
, &
$fÜm_¡©e
) {

1114 
	`v›ws_šşude
('form');

1115  
	`_dru·l_bud_fÜm
(
$fÜm_id
, 
$fÜm_¡©e
);

1116 
	}
}

1121 
funùiÚ
 
	$v›ws_v›ws_qu”y_sub¡™utiÚs
(
$v›w
) {

1122 
glob®
 
$Ïnguage
;

1123  
	`¬¿y
(

1124 '***CURRENT_VERSION***' => 
VERSION
,

1125 '***CURRENT_TIME***' => 
	`time
(),

1126 '***CURRENT_LANGUAGE***' => 
$Ïnguage
->
Ïnguage
,

1127 '***DEFAULT_LANGUAGE***' => 
	`Ïnguage_deçuÉ
('language'),

1130 
	}
}

1152 
funùiÚ
 
v›ws_embed_v›w
(
$Çme
, 
$di¥Ïy_id
 = 'default') {

1153 
$¬gs
 = 
func_g‘_¬gs
();

1154 
¬¿y_shiá
(
$¬gs
);

1155 ià(
couÁ
(
$¬gs
)) {

1156 
¬¿y_shiá
(
$¬gs
);

1159 
	g$v›w
 = 
v›ws_g‘_v›w
(
$Çme
);

1160 ià(!
	g$v›w
 || !$v›w->
acûss
(
$di¥Ïy_id
)) {

1164  
	g$v›w
->
´ev›w
(
$di¥Ïy_id
, 
$¬gs
);

1185 
funùiÚ
 
	$v›ws_g‘_v›w_»suÉ
(
$Çme
, 
$di¥Ïy_id
 = 
NULL
) {

1186 
$¬gs
 = 
	`func_g‘_¬gs
();

1187 
	`¬¿y_shiá
(
$¬gs
);

1188 ià(
	`couÁ
(
$¬gs
)) {

1189 
	`¬¿y_shiá
(
$¬gs
);

1192 
$v›w
 = 
	`v›ws_g‘_v›w
(
$Çme
);

1193 ià(
	`is_objeù
(
$v›w
)) {

1194 ià(
	`is_¬¿y
(
$¬gs
)) {

1195 
$v›w
->
	`£t_¬gum’ts
(
$¬gs
);

1197 ià(
	`is_¡ršg
(
$di¥Ïy_id
)) {

1198 
$v›w
->
	`£t_di¥Ïy
(
$di¥Ïy_id
);

1201 
$v›w
->
	`š™_di¥Ïy
();

1203 
$v›w
->
	`´e_execu‹
();

1204 
$v›w
->
	`execu‹
();

1205  
$v›w
->
»suÉ
;

1208  
	`¬¿y
();

1210 
	}
}

1215 
funùiÚ
 
v›ws_v¬_expÜt
(
$v¬
, 
$´efix
 = '', 
$š™
 = 
TRUE
) {

1216 ià(
is_¬¿y
(
$v¬
)) {

1217 ià(
em±y
(
$v¬
)) {

1218 
$ouut
 = 'array()';

1221 
	g$ouut
 = "array(\n";

1222 
fÜ—ch
 (
$v¬
 
as
 
$key
 => 
$v®ue
) {

1223 
$ouut
 .ğ" '$key' => " . 
v›ws_v¬_expÜt
(
$v®ue
, ' ', 
FALSE
) . ",\n";

1225 
	g$ouut
 .= ')';

1228 ià(
is_boŞ
(
$v¬
)) {

1229 
	g$ouut
 = 
$v¬
 ? 'TRUE' : 'FALSE';

1231 ià(
is_¡ršg
(
$v¬
è&& 
¡½os
($v¬, "\n"è!=ğ
FALSE
) {

1235 
$v¬
 = 
¡r_»¶aû
("\n", "***BREAK***", $var);

1236 
	g$ouut
 = 
v¬_expÜt
(
$v¬
, 
TRUE
);

1239 
	g$ouut
 = 
v¬_expÜt
(
$v¬
, 
TRUE
);

1242 ià(
	g$´efix
) {

1243 
	g$ouut
 = 
¡r_»¶aû
("\n", "\n$´efix", 
$ouut
);

1246 ià(
	g$š™
) {

1247 
	g$ouut
 = 
¡r_»¶aû
("***BREAK***", "\n", 
$ouut
);

1250  
	g$ouut
;

1256 
funùiÚ
 
	$v›ws_css_§ã
(
$¡ršg
) {

1257  
	`¡r_»¶aû
('_', '-', 
$¡ršg
);

1258 
	}
}

1263 
funùiÚ
 
v›ws_v›ws_expÜbËs
(
$İ
 = 'li¡', 
$v›ws
 = 
NULL
, 
$Çme
 = 'foo') {

1264 
$®l_v›ws
 = 
v›ws_g‘_®l_v›ws
();

1265 ià(
	g$İ
 == 'list') {

1267 
fÜ—ch
 (
$®l_v›ws
 
as
 
$Çme
 => 
$v›w
) {

1269 ià(
em±y
(
$v›ws
è|| 
š_¬¿y
(
$v›w
->
g
, $views)) {

1270 
$»tuº
[
$Çme
] = 
¬¿y
(

1271 'Çme' => 
check_¶aš
(
$Çme
),

1272 'desc' => 
check_¶aš
(
$v›w
->
desütiÚ
),

1273 'g' => 
check_¶aš
(
$v›w
->
g
)

1277  
	g$»tuº
;

1280 ià(
	g$İ
 == 'export') {

1281 
$code
 = "/**\n";

1282 
	g$code
 .= " * Implementation of hook_views_default_views().\n";

1283 
	g$code
 .= " */\n";

1284 
	g$code
 .ğ"funùiÚ " . 
$Çme
 . "_views_default_views() {\n";

1285 
fÜ—ch
 (
$v›ws
 
as
 
$v›w
 => 
$Œuth
) {

1286 
$code
 .= " /*\n";

1287 
	g$code
 .ğ" * V›w ". 
v¬_expÜt
(
$®l_v›ws
[
$v›w
]->
Çme
, 
TRUE
) ."\n";

1288 
	g$code
 .= " */\n";

1289 
	g$code
 .ğ
$®l_v›ws
[
$v›w
]->
expÜt
(' ');

1290 
	g$code
 .= ' $views[$view->name] = $view;' . "\n\n";

1292 
	g$code
 .= "„eturn \$views;\n";

1293 
	g$code
 .= "}\n";

1295  
	g$code
;

1302 
funùiÚ
 
	$v›ws_miüÙime
() {

1303 
	`li¡
(
$u£c
, 
$£c
èğ
	`ex¶ode
(' ', 
	`miüÙime
());

1304  ()
$£c
 + ()
$u£c
;

1305 
	}
}

1316 
funùiÚ
 
	$v›ws_Œim_‹xt
(
$®‹r
, 
$v®ue
) {

1317 ià(
	`dru·l_¡¾’
(
$v®ue
è> 
$®‹r
['max_length']) {

1318 
$v®ue
 = 
	`dru·l_sub¡r
($v®ue, 0, 
$®‹r
['max_length']);

1320 ià(!
	`em±y
(
$®‹r
['word_boundary'])) {

1321 
$»gex
 = "(.*)\b.+";

1322 ià(
	`funùiÚ_exi¡s
('mb_ereg')) {

1323 
	`mb_»gex_’codšg
('UTF-8');

1324 
$found
 = 
	`mb_”eg
(
$»gex
, 
$v®ue
, 
$m©ches
);

1327 
$found
 = 
	`´eg_m©ch
("/$»gex/us", 
$v®ue
, 
$m©ches
);

1329 ià(
$found
) {

1330 
$v®ue
 = 
$m©ches
[1];

1334 
$v®ue
 = 
	`¹rim
(
	`´eg_»¶aû
('/(?:<(?!.+>)|&(?!.+;)).*$/us', '', $value));

1336 ià(!
	`em±y
(
$®‹r
['ellipsis'])) {

1337 
$v®ue
 .= '...';

1340 ià(!
	`em±y
(
$®‹r
['html'])) {

1341 
$v®ue
 = 
	`_f‹r_htmlcÜ»ùÜ
($value);

1344  
$v®ue
;

1345 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/views_export/views_export.module

1 <?
php


14 
funùiÚ
 
	$v›ws_expÜt_m’u
() {

15 
$™ems
 = 
	`¬¿y
();

16 
$™ems
['admš/bud/v›ws/toŞs/expÜt'] = 
	`¬¿y
(

18 'acûs ¬gum’ts' => 
	`¬¿y
('use viewsƒxporter'),

20 'ty³' => 
MENU_LOCAL_TASK
,

23 
$™ems
['admš/bud/v›ws/toŞs/expÜt/»suÉs'] = 
	`¬¿y
(

24 'acûs ¬gum’ts' => 
	`¬¿y
('use viewsƒxporter'),

26 'ty³' => 
MENU_CALLBACK
,

29  
$™ems
;

30 
	}
}

32 
funùiÚ
 
	$v›ws_expÜt_theme
() {

33  
	`¬¿y
(

34 'v›ws_expÜt_expÜt_fÜm' => 
	`¬¿y
(

35 '¬gs' => 
	`¬¿y
('fÜm' => 
NULL
),

38 
	}
}

43 
funùiÚ
 
	$v›ws_expÜt_³rm
() {

44  
	`¬¿y
('use viewsƒxporter');

45 
	}
}

50 
funùiÚ
 
	$v›ws_expÜt_expÜt
() {

51 
$gs
 = 
	`¬¿y
();

52 ià(!
	`em±y
(
$_GET
['tags'])) {

53 
$gs
 = 
	`ex¶ode
(',', 
$_GET
['tags']);

56 
$expÜbËs
 = 
	`¬¿y
();

57 
	`fÜ—ch
 (
	`moduË_im¶em’ts
('v›ws_expÜbËs'è
as
 
$moduË
) {

58 
$funùiÚ
 = 
$moduË
 . '_views_exportables';

59 
$expÜbËs
[
$moduË
] = 
	`$funùiÚ
('li¡', 
$gs
);

60 
	`asÜt
(
$expÜbËs
[
$moduË
]);

63 ià(
$expÜbËs
) {

64 
$fÜm_¡©e
 = 
	`¬¿y
(

65 'no_»dœeù' => 
TRUE
,

66 'expÜbËs' => 
$expÜbËs
,

67 'gs' => 
$gs
,

70 
$ouut
 = 
	`dru·l_bud_fÜm
('v›ws_expÜt_expÜt_fÜm', 
$fÜm_¡©e
);

71 ià(!
$ouut
) {

72 
$ouut
 = 
$fÜm_¡©e
['output'];

74  
$ouut
;

77  
	`t
('There‡re‚o viewso beƒxported‡thisime.');

79 
	}
}

84 
funùiÚ
 
	$v›ws_expÜt_expÜt_fÜm
(&
$fÜm_¡©e
) {

85 
	`fÜ—ch
 (
$fÜm_¡©e
['expÜbËs'] 
as
 
$moduË
 => 
$v›ws
) {

86 
	`fÜ—ch
 (
$v›ws
 
as
 
$Çme
 => 
$d©a
) {

87 
$İtiÚs
[
$Çme
] = 
$d©a
['name'];

90 
$fÜm
['moduËs']['#Œ“'] = 
TRUE
;

91 
$fÜm
['moduËs'][
$moduË
] = 
	`¬¿y
(

93 '#İtiÚs' => 
$İtiÚs
,

94 '#deçuÉ_v®ue' => 
	`¬¿y
(),

98 
$gs
 = 
	`¬¿y
();

99 
	`fÜ—ch
 (
	`v›ws_g‘_®l_v›ws
(è
as
 
$Çme
 => 
$v›w
) {

100 ià(!
	`em±y
(
$v›w
->
g
)) {

101 
$gs
[
$v›w
->
g
] = $view->tag;

105 
	`asÜt
(
$gs
);

107 
$fÜm
['gs'] = 
	`¬¿y
(

109 '#t™Ë' => 
	`t
('Show onlyheseags'),

110 '#İtiÚs' => 
$gs
,

111 '#deçuÉ_v®ue' => 
$fÜm_¡©e
['tags'],

112 '#muÉË' => 
TRUE
,

115 
$fÜm
['­¶y'] = 
	`¬¿y
(

117 '#v®ue' => 
	`t
('Apply'),

118 '#subm™' => 
	`¬¿y
('views_export_export_form_apply'),

121 
$fÜm
['Çme'] = 
	`¬¿y
(

123 '#t™Ë' => 
	`t
('Module‚ame'),

124 '#desütiÚ' => 
	`t
('Enterhe module‚ameoƒxport codeo.'),

127 
$fÜm
['subm™'] = 
	`¬¿y
(

129 '#v®ue' => 
	`t
('Export'),

132 
$fÜm
['#aùiÚ'] = 
	`u¾
('admin/build/views/tools/export/results');

133 
$fÜm
['#»dœeù'] = 
FALSE
;

134 
$fÜm
['#expÜbËs'] = 
$fÜm_¡©e
['exportables'];

135  
$fÜm
;

136 
	}
}

138 
funùiÚ
 
	$theme_v›ws_expÜt_expÜt_fÜm
(
$fÜm
) {

139 
$ouut
 = '';

140 
$fes
 = 
	`moduË_»bud_ÿche
();

141 
$expÜbËs
 = 
$fÜm
['#exportables'];

142 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['tags']);

143 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
['apply']);

144 
$ouut
 .= '<div class="clear-block">';

146 
	`fÜ—ch
 (
$expÜbËs
 
as
 
$moduË
 => 
$v›ws
) {

147 
$h—d”
 = 
	`¬¿y
(
	`theme
('bË_£Ëù_h—d”_ûÎ'), 
$fes
[
$moduË
]->
šfo
['Çme'], 
	`t
('Tag'),('Description'));

148 
$rows
 = 
	`¬¿y
();

149 
	`fÜ—ch
 (
$v›ws
 
as
 
$Çme
 => 
$v›w
) {

150 
$t™Ë
 = 
$fÜm
['moduËs'][
$moduË
][
$Çme
]['#title'];

151 
	`un£t
(
$fÜm
['moduËs'][
$moduË
][
$Çme
]['#title']);

152 
$rows
[] = 
	`¬¿y
(
	`dru·l_»nd”
(
$fÜm
['moduËs'][
$moduË
][
$Çme
]), 
$t™Ë
, 
$v›w
['tag'], '<div class="description">' . $view['desc'] . '</div>');

154 
$ouut
 .= '<div class="export-container">';

155 
$ouut
 .ğ
	`theme
('bË', 
$h—d”
, 
$rows
);

156 
$ouut
 .= "</div>\n";

158 
$ouut
 .= '</div>';

159 
	`dru·l_add_css
(
	`dru·l_g‘_·th
('module', 'views_export') . '/views_export.css');

160 
$ouut
 .ğ
	`dru·l_»nd”
(
$fÜm
);

161  
$ouut
;

162 
	}
}

164 
funùiÚ
 
	$v›ws_expÜt_expÜt_fÜm_­¶y
(&
$fÜm
, &
$fÜm_¡©e
) {

165 
$gs
 = 
$fÜm_¡©e
['values']['tags'];

166 ià(
$gs
) {

167 
	`dru·l_gÙo
('admš/bud/v›ws/toŞs/expÜt', 
	`¬¿y
('gs' => 
	`im¶ode
(',', 
$gs
)));

170 
	`dru·l_gÙo
('admin/build/views/tools/export');

172 
	}
}

174 
funùiÚ
 
	$v›ws_expÜt_expÜt_fÜm_subm™
(&
$fÜm
, &
$fÜm_¡©e
) {

175 
$code
 = '';

176 ià(
	`em±y
(
$fÜm_¡©e
['values']['name'])) {

177 
$fÜm_¡©e
['values']['name'] = 'foo';

180 
	`fÜ—ch
 (
$fÜm_¡©e
['v®ues']['moduËs'] 
as
 
$moduË
 => 
$v›ws
) {

181 
$v›ws
 = 
	`¬¿y_f‹r
($views);

182 
	`asÜt
(
$v›ws
);

183 ià(
$v›ws
) {

184 
$code
 .ğ
	`moduË_švoke
(
$moduË
, 'v›ws_expÜbËs', 'expÜt', 
$v›ws
, 
$fÜm_¡©e
['values']['name']) . "\n\n";

188 
$lšes
 = 
	`sub¡r_couÁ
(
$code
, "\n");

190 
$ty³s
 = 
	`sy¡em_–em’ts
();

192 
$šfo
 = "; \$Id" . ": $\n";

193 
$šfo
 .= "\n";

194 
$šfo
 .ğ
	`¡¹r
("Çmğ@moduË ExpÜˆModuË\n", 
	`¬¿y
('@moduË' => 
$fÜm_¡©e
['values']['name']));

195 
$šfo
 .ğ
	`¡¹r
("desütiÚ = ExpÜt somv›w oà@moduË\n", 
	`¬¿y
('@moduË' => 
$fÜm_¡©e
['values']['name']));

196 
$šfo
 .= "dependencies[] = views\n";

197 
$šfo
 .= "core = 6.x\n";

200 
$–em’t_šfo
 = 
	`¬¿y
(

201 '#t™Ë' => 
	`t
('Puˆthi š @moduË.šfØš you¸moduËs/@moduË dœeùÜy', 
	`¬¿y
('@moduË' => 
$fÜm_¡©e
['values']['name'])),

205 '#©Œibu‹s' => 
	`¬¿y
(),

208 '#v®ue' => 
$šfo
,

209 '#·»Ás' => 
	`¬¿y
('dummy'),

210 '#»quœed' => 
FALSE
,

211 è+ 
$ty³s
['textarea'];

213 
$­i
 = "/**\n";

214 
$­i
 .= " * Implementation of hook_views_api().\n";

215 
$­i
 .= " */\n";

216 
$­i
 .= "function @module_views_api() {\n";

217 
$­i
 .= "„eturn‡rray(\n";

218 
$­i
 .= " 'api' => 2,\n";

219 
$­i
 .= " 'path' => drupal_get_path('module', '@module'),\n";

220 
$­i
 .= " //'path' => drupal_get_path('module', '@module') . '/includes',\n";

221 
$­i
 .= " );\n";

222 
$­i
 .= "}";

224 
$­i
 = 
	`¡¹r
($­i, 
	`¬¿y
('@moduË' => 
	`check_¶aš
(
$fÜm_¡©e
['values']['name'])));

226 
$–em’t_­i
 = 
	`¬¿y
(

227 '#t™Ë' => 
	`t
('Puˆthi š @moduË.moduË iÀyou¸moduËs/@moduË dœeùÜy', 
	`¬¿y
('@moduË' => 
$fÜm_¡©e
['values']['name'])),

231 '#©Œibu‹s' => 
	`¬¿y
( 'dir' => 'ltr' ),

234 '#v®ue' => 
$­i
,

235 '#·»Ás' => 
	`¬¿y
('dummy'),

236 '#»quœed' => 
FALSE
,

237 è+ 
$ty³s
['textarea'];

239 
$–em’t_hook
 = 
	`¬¿y
(

240 '#t™Ë' => 
	`t
('Puˆthi š @moduË.v›ws_deçuÉ.šøš you¸moduËs/@moduË dœeùÜy o¸moduËs/@moduË/šşude dœeùÜy', 
	`¬¿y
('@moduË' => 
$fÜm_¡©e
['values']['name'])),

244 '#©Œibu‹s' => 
	`¬¿y
( 'dir' => 'ltr' ),

245 '#rows' => 
	`mš
(
$lšes
, 150),

246 '#v®ue' => 
$code
,

247 '#·»Ás' => 
	`¬¿y
('dummy'),

248 '#»quœed' => 
FALSE
,

249 è+ 
$ty³s
['textarea'];

252 
$fÜm_¡©e
['ouut'] = 
	`theme
('‹x»a', 
$–em’t_šfo
);

253 
$fÜm_¡©e
['ouut'] .ğ
	`theme
('‹x»a', 
$–em’t_­i
);

254 
$fÜm_¡©e
['ouut'] .ğ
	`theme
('‹x»a', 
$–em’t_hook
);

255 
	}
}

	@/srv/http/subs/notes/www/sites/all/modules/contrib/views/views_ui.module

1 <?
php


11 
funùiÚ
 
	$v›ws_ui_m’u
() {

12 
$™ems
 = 
	`¬¿y
();

15 
$ba£
 = 
	`¬¿y
(

17 'acûs ¬gum’ts' => 
	`¬¿y
('administer views'),

21 
$ÿÎback
 = 
$ba£
 + 
	`¬¿y
('ty³' => 
MENU_CALLBACK
);

23 
$cÚv”t
 = 
	`¬¿y
('fe' => 'šşudes/cÚv”t.šc'è+ 
$ba£
;

25 
$™ems
['admš/bud/v›ws'] = 
$ba£
 + 
	`¬¿y
(

29 'ty³' => 
MENU_NORMAL_ITEM


31 
$™ems
['admš/bud/v›ws/li¡'] = 
$ba£
 + 
	`¬¿y
(

34 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

37 
$™ems
['admš/bud/v›ws/add'] = 
$ba£
 + 
	`¬¿y
(

40 'ty³' => 
MENU_LOCAL_TASK


42 
$™ems
['admš/bud/v›ws/impÜt'] = 
	`¬¿y
(

45 '·g¬gum’ts' => 
	`¬¿y
('views_ui_import_page'),

47 'ty³' => 
MENU_LOCAL_TASK


48 è+ 
$ba£
;

49 
$™ems
['admš/bud/v›ws/toŞs'] = 
$ba£
 + 
	`¬¿y
(

52 '·g¬gum’ts' => 
	`¬¿y
('views_ui_admin_tools'),

53 'ty³' => 
MENU_LOCAL_TASK


55 
$™ems
['admš/bud/v›ws/toŞs/basic'] = 
$ba£
 + 
	`¬¿y
(

58 '·g¬gum’ts' => 
	`¬¿y
('views_ui_admin_tools'),

59 'ty³' => 
MENU_DEFAULT_LOCAL_TASK
,

63 
$™ems
['admš/bud/v›ws/toŞs/cÚv”t'] = 
$cÚv”t
 + 
	`¬¿y
(

67 'ty³' => 
MENU_LOCAL_TASK
,

70 
$™ems
['admš/bud/v›ws1/d–‘e'] = 
$cÚv”t
 + 
	`¬¿y
(

73 '·g¬gum’ts' => 
	`¬¿y
('views_ui_delete1_confirm', 4),

74 'ty³' => 
MENU_CALLBACK
,

76 
$™ems
['admš/bud/v›ws1/cÚv”t'] = 
$cÚv”t
 + 
	`¬¿y
(

79 '·g¬gum’ts' => 
	`¬¿y
(4),

80 'ty³' => 
MENU_CALLBACK
,

83 
$™ems
['admš/bud/v›ws/d–‘e/%v›ws_ui_ÿche'] = 
$ÿÎback
 + 
	`¬¿y
(

86 '·g¬gum’ts' => 
	`¬¿y
('views_ui_delete_confirm', 4),

88 
$™ems
['admš/bud/v›ws/b»ak-lock/%v›ws_ui_ÿche'] = 
$ÿÎback
 + 
	`¬¿y
(

91 '·g¬gum’ts' => 
	`¬¿y
('views_ui_break_lock_confirm', 4),

93 
$™ems
['admš/bud/v›ws/expÜt/%v›ws_ui_ÿche'] = 
$ÿÎback
 + 
	`¬¿y
(

95 '·g¬gum’ts' => 
	`¬¿y
('views_ui_export_page', 4),

96 'ty³' => 
MENU_LOCAL_TASK


98 
$™ems
['admš/bud/v›ws/şÚe/%v›ws_ui_ÿche'] = 
$ÿÎback
 + 
	`¬¿y
(

100 '·g¬gum’ts' => 
	`¬¿y
(4),

101 'ty³' => 
MENU_LOCAL_TASK


103 
$™ems
['admš/bud/v›ws/’abË/%v›ws_ui_deçuÉ'] = 
$ÿÎback
 + 
	`¬¿y
(

105 '·g¬gum’ts' => 
	`¬¿y
(4),

107 
$™ems
['admš/bud/v›ws/di§bË/%v›ws_ui_deçuÉ'] = 
$ÿÎback
 + 
	`¬¿y
(

109 '·g¬gum’ts' => 
	`¬¿y
(4),

113 
$™ems
['admš/bud/v›ws/ed™/%v›ws_ui_ÿche'] = 
$ba£
 + 
	`¬¿y
(

116 '·g¬gum’ts' => 
	`¬¿y
(4),

117 'ty³' => 
MENU_LOCAL_TASK


120 
$™ems
['admš/bud/v›ws/%v›ws_ui_js/ª®yze/%v›ws_ui_ÿche'] = 
$ÿÎback
 + 
	`¬¿y
(

122 '·g¬gum’ts' => 
	`¬¿y
(3, 5),

124 
$™ems
['admš/bud/v›ws/%v›ws_ui_js/d‘as/%v›ws_ui_ÿche'] = 
$ÿÎback
 + 
	`¬¿y
(

126 '·g¬gum’ts' => 
	`¬¿y
(3, 5),

128 
$™ems
['admš/bud/v›ws/%v›ws_ui_js/add-di¥Ïy/%v›ws_ui_ÿche'] = 
$ÿÎback
 + 
	`¬¿y
(

130 '·g¬gum’ts' => 
	`¬¿y
(3, 5),

133 
$™ems
['admš/bud/v›ws/%v›ws_ui_js/´ev›w/%v›ws_ui_ÿche'] = 
$ÿÎback
 + 
	`¬¿y
(

135 '·g¬gum’ts' => 
	`¬¿y
(3, 5),

139 
$™ems
['admš/v›ws/ajax/autocom¶‘e/g'] = 
$ÿÎback
 + 
	`¬¿y
(

146 
$™ems
['admš/bud/v›ws/%v›ws_ui_js/%/%v›ws_ui_ÿche'] = 
$ÿÎback
 + 
	`¬¿y
(

148 '·g¬gum’ts' => 
	`¬¿y
(3, 4, 5),

151  
$™ems
;

152 
	}
}

157 
funùiÚ
 
v›ws_ui_h–p
(
$·th
, 
$¬g
 = '') {

158 
$·th
) {

160  '<p>' . 
t
('The converter will make‡ best-effort‡ttempto convert‡ Views 1 viewo Views 2. This conversion is‚ot„eliable; you will very†ikely haveo make‡djustmentso your viewo get ito match. You can import Views 1 viewshroughhe‚ormal Importab.') . '</p>';

167 
funùiÚ
 
	$v›ws_ui_theme
() {

168 
$·th
 = 
	`dru·l_g‘_·th
('module', 'views');

169 
»quœe_Úû
 "./$path/includes/admin.inc";

171  
	`¬¿y
(

173 'v›ws_ui_ed™_v›w' => 
	`¬¿y
(

174 '¬gum’ts' => 
	`¬¿y
('v›w' => 
NULL
),

178 'v›ws_ui_ed™_b' => 
	`¬¿y
(

179 '¬gum’ts' => 
	`¬¿y
('v›w' => 
NULL
, 'display' => NULL),

183 'v›ws_ui_ed™_™em' => 
	`¬¿y
(

184 '¬gum’ts' => 
	`¬¿y
('ty³' => 
NULL
, 'v›w' => NULL, 'di¥Ïy' => NULL, 'no_f›lds' => 
FALSE
),

188 'v›ws_ui_»¬¿nge_fÜm' => 
	`¬¿y
(

189 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

194 'v›ws_ui_li¡_v›ws' => 
	`¬¿y
(

198 'v›ws_ui_li¡_v›ws_fÜm' => 
	`¬¿y
(

200 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

204 'v›ws_b£t' => 
	`¬¿y
(

205 '¬gum’ts' => 
	`¬¿y
('bs' => 
NULL
),

208 'v›ws_b' => 
	`¬¿y
(

209 '¬gum’ts' => 
	`¬¿y
('body' => 
NULL
),

214 'v›ws_ui_¡yË_¶ugš_bË' => 
	`¬¿y
(

215 '¬gum’ts' => 
	`¬¿y
('fÜm' => 
NULL
),

219 
	}
}

225 
funùiÚ
 
	$v›ws_ui_ÿche_lßd
(
$Çme
) {

226 
	`v›ws_šşude
('cache');

227 
	`v›ws_šşude
('view');

228 
$v›w
 = 
	`v›ws_objeù_ÿche_g‘
('v›w', 
$Çme
);

230 ià(
	`em±y
(
$v›w
)) {

231 
$v›w
 = 
	`v›ws_g‘_v›w
(
$Çme
);

233 ià(!
	`em±y
(
$v›w
)) {

235 
glob®
 
$u£r
;

236 
$v›w
->
locked
 = 
	`db_ãtch_objeù
(
	`db_qu”y
("SELECT s.uid, v.upd©ed FROM {v›ws_objeù_ÿche} v INNER JOIN {£ssiÚs} s ON v.sid = s.sid WHERE s.sid !ğ'%s'‡nd v.Çmğ'%s'‡nd v.obj = 'v›w' ORDER BY v.upd©ed ASC", 
	`£ssiÚ_id
(), $v›w->
Çme
));

240 ià(
	`em±y
(
$v›w
)) {

241  
FALSE
;

245  
$v›w
;

247 
	}
}

249 
funùiÚ
 
	$v›ws_ui_check_lock
(
$v›w
) {

251 
	}
}

257 
funùiÚ
 
	$v›ws_ui_ÿche_£t
(&
$v›w
) {

258 ià(!
	`em±y
(
$v›w
->
locked
)) {

259 
	`dru·l_£t_mes§ge
(
	`t
('Changes cannot be madeo‡†ocked view.'), 'error');

262 
	`v›ws_šşude
('cache');

263 
$v›w
->
chªged
 = 
TRUE
;

266 
	`un£t
(
$v›w
->
di¥Ïy_hªdËr
);

267 
	`un£t
(
$v›w
->
cu¼’t_di¥Ïy
);

268 
	`un£t
(
$v›w
->
deçuÉ_di¥Ïy
);

269 
	`fÜ—ch
 (
	`¬¿y_keys
(
$v›w
->
di¥Ïy
è
as
 
$id
) {

270 
	`un£t
(
$v›w
->
di¥Ïy
[
$id
]->
hªdËr
);

271 
	`un£t
(
$v›w
->
di¥Ïy
[
$id
]->
deçuÉ_di¥Ïy
);

273 
	`v›ws_objeù_ÿche_£t
('v›w', 
$v›w
->
Çme
, $view);

274 
	}
}

281 
funùiÚ
 
	$v›ws_ui_deçuÉ_lßd
(
$Çme
) {

282 
$v›w
 = 
	`v›ws_g‘_v›w
(
$Çme
);

283 ià(
$v›w
->
ty³
 =ğ
	`t
('Default')) {

284  
$v›w
;

287  
FALSE
;

288 
	}
}

293 
funùiÚ
 
	$v›ws_ui_js_lßd
(
$js
) {

294 ià(
$js
 == 'ajax') {

295  
TRUE
;

298 
	}
}

	@/srv/http/subs/notes/www/sites/all/themes/drupal-notes/template.php

1 <?
	gphp


	@/srv/http/subs/notes/www/sites/all/themes/drupal-notes/theme-settings.php

1 <?
php


12 
	gšşude_Úû
 './' . 
dru·l_g‘_·th
('theme', 'mothership') . '/theme-settings.php';

15 
funùiÚ
 
	$jznÙes_£‰šgs
(
$§ved_£‰šgs
) {

17 
$deçuÉs
 = 
	`mÙh”sh_theme_g‘_deçuÉ_£‰šgs
('jznotes');

19 
$£‰šgs
 = 
	`¬¿y_m”ge
(
$deçuÉs
, 
$§ved_£‰šgs
);

21 
$fÜm
 = 
	`¬¿y
();

22 
$fÜm
 +ğ
	`mÙh”sh_£‰šgs
(
$§ved_£‰šgs
, 
$deçuÉs
);

25  
$fÜm
;

26 
	}
}

	@/srv/http/subs/notes/www/sites/all/themes/mothership/_copy_to_your_subtheme_theme-settings.php

1 <?
php


13 
	gšşude_Úû
 './' . 
dru·l_g‘_·th
('theme', 'mothership') . '/theme-settings.php';

16 
funùiÚ
 
	$SUBTHEME_£‰šgs
(
$§ved_£‰šgs
) {

18 
$deçuÉs
 = 
	`mÙh”sh_theme_g‘_deçuÉ_£‰šgs
('SUBTHEME');

20 
$£‰šgs
 = 
	`¬¿y_m”ge
(
$deçuÉs
, 
$§ved_£‰šgs
);

22 
$fÜm
 = 
	`¬¿y
();

23 
$fÜm
 +ğ
	`mÙh”sh_£‰šgs
(
$§ved_£‰šgs
, 
$deçuÉs
);

26  
$fÜm
;

27 
	}
}

	@/srv/http/subs/notes/www/sites/all/themes/mothership/block.tpl.php

1 <?
php


12 ià(
	g$şas£s
) {

13 
	g$şas£s
 = ' cÏss="' . 
$şas£s
 . '"';

16 ià(
	g$id_block
) {

17 
	g$id_block
 = ' id="' . 
$id_block
 . '"';

21 <
	gdiv
<?
php
 
´št
 
	g$id_block
 . 
	g$şas£s
; ?>>

22 <?
php
 ià(
	g$block
->
	gsubjeù
): ?>

23 <
h3
><?
php
 
´št
 
$block
->
subjeù
; ?></
	gh3
>

24 <?
php
 
	g’dif
; ?>

25 <?
php
 
´št
 
	g$block
->
	gcÚ‹Á
; ?>

26 <?
php
 
´št
 
	g$ed™_lšks
; ?>

27 </
	gdiv
>

	@/srv/http/subs/notes/www/sites/all/themes/mothership/box.tpl.php

1 <?
	gphp


20 <?
php


21 
´št
 
	g$cÚ‹Á
;

	@/srv/http/subs/notes/www/sites/all/themes/mothership/comment-folded.tpl.php

1 <?
	gphp


19 <
div
 
	gşass
="comment-folded">

20 <?
php
 
´št
 
$t™Ë
 .' '. 
$Ãw
; ?>

21 <?
php
 
´št
 
t
('by'è.' '. 
	g$authÜ
; ?>

22 </
	gdiv
>

	@/srv/http/subs/notes/www/sites/all/themes/mothership/comment-wrapper.tpl.php

1 <?
php


8 ià(
	g$şas£s
) {

9 
	g$şas£s
 = ' cÏss="'. 
$şas£s
 . '"';

12 ià(
	g$id_comm’tw¿p
) {

13 
	g$id_comm’tw¿p
 = ' id="'. 
$id_comm’tw¿p
 . '"';

17 <!--
	gcomm’t
-
	gw¿µ”
.
	gl
-->

18 <?
php
 ià(
	g$cÚ‹Á
) { ?>

19 <
	gdiv
<?
php
 
´št
 
	g$id_comm’tw¿p
 . 
	g$şas£s
; ?>>

20 <?
php
 
´št
 
	g$cÚ‹Á
; ?>

21 </
	gdiv
>

22 <?
	gphp
 } ?>

23 <!--/
	gcomm’t
-
	gw¿µ”
.
	gl
-->

	@/srv/http/subs/notes/www/sites/all/themes/mothership/comment.tpl.php

1 <?
php


17 ià(
	g$şas£s
) {

18 
	g$şas£s
 = ' cÏss="' . 
$şas£s
 . '"';

21 <!--
	gcomm’t
.
	gl
-->

22 <
	gdiv
<?
php
 
´št
 
	g$şas£s
; ?>>

23 <
div
 
	gşass
="comment-inner">

24 <?
php
 ià(
$comm’t
->
Ãw
){ ?>

25 <
h3
 
şass
="Ãw"><?
php
 
´št
 
$t™Ë
 ?></h3>

26 <?
php
 }{ ?>

27 <
	gh3
><?
php
 
´št
 
	g$t™Ë
 ?></h3>

28 <?
	gphp
 } ?>

30 <
div
 
	gşass
="comm’t-cÚ‹Á"><?
php
 
´št
 
$cÚ‹Á
 ?></div>

31 <?
php
 
´št
 
$lšks
 ?>

32 </
div
>

34 <
div
 
şass
="meta">

35 <?
php


36 if(
$comm’t
->
piùu»
){

37 
$image
 = 
theme
('imageÿche', 'u£r-thumbÇ', 
$comm’t
->
piùu»
);

38 
´št
 
l
(
$image
, 'u£r/'.
$comm’t
->
uid
, 
$İtiÚs
ğ
¬¿y
('html'=>
TRUE
));

41 <
¥ª
 
	gşass
="authÜ"><?
php
 
´št
 
$authÜ
 ?></span>

42 <
¥ª
 
şass
="d©e"><?
php
 
´št
 
$d©e
 ?></span>

43 <?
php
 ià(
$sigÇtu»
){ ?>

44 <?
php
 
´št
 
$sigÇtu»
 ?>

45 <?
php
 } ?>

46 </
div
>

47 </
div
>

48 <!--/
comm’t
.
l
-->

	@/srv/http/subs/notes/www/sites/all/themes/mothership/content-field.tpl.php

1 <?
	gphp


29 <?
php
 ià(!
	g$f›ld_em±y
) : ?>

30 <
div
 
şass
="<?php…rint $field_name_css ?>">

32 <?
php
 ià(
$Ïb–_di¥Ïy
 == 'above') : ?>

33 <
¥ª
><?
php
 
´št
 
t
(
$Ïb–
è?>:&
nb¥
;</
	g¥ª
>

34 <?
php
 
	g’dif
;?>

36 <?
php
 
	g$couÁ
 = 1;

37 
fÜ—ch
 (
$™ems
 
as
 
$d–
 => 
$™em
) :

38 ià(!
$™em
['empty']) : ?>

40 <?
php
 ià(
$Ïb–_di¥Ïy
 == 'inline') { ?>

41 <?
php
 
´št
 
t
(
$Ïb–
) ?>

42 <?
php
 } ?>

44 <?
php
 
´št
 
$™em
['view'] ?>

46 <?
php
 
$couÁ
++;

47 
	g’dif
;

48 
	g’dfÜ—ch
;?>

50 </
	gdiv
>

51 <?
php
 
	g’dif
;

	@/srv/http/subs/notes/www/sites/all/themes/mothership/node.tpl.php

1 <?
php


35 ià(
	g$şas£s
) {

36 
	g$şas£s
 = ' cÏss="'. 
$şas£s
 . '"';

39 ià(
	g$id_node
) {

40 
	g$id_node
 = ' id="'. 
$id_node
 . '"';

44 <?
php


45 ià(
	g$·ge
 == 0) { ?>

46 <
div
<?
php
 
´št
 
$id_node
 . 
$şas£s
; ?>>

47 <?
php
 ià(
	g$node
->
	gt™Ë
) { ?>

48 <
	gh2
><
a
 
	gh»f
="<?ph°´šˆ$node_u¾ ?>" 
t™Ë
="<?ph°´šˆ$t™Ë ?>"><?
php
 
´št
 
$t™Ë
 ?></a></
h2
>

49 <?
php
 } ?>

50 <
div
 
	gşass
="meta">

51 <?
php
 ià(
$node
->
piùu»
) { ?>

52 <?
php
 
´št
 
theme
('imageÿche', '´e£t_Çme¥aû', 
$node
->
piùu»
, 
$®t
, 
$t™Ë
, 
$©Œibu‹s
); ?>

53 <?
	gphp
 } ?>

55 <?
php
 
´št
 
theme
('u£ºame', 
$node
); ?>

57 <?
php
 
´št
 
fÜm©_d©e
(
$node
->
ü—‹d
, 'custom', "j F Y") ?>

58 </
	gdiv
>

60 <
div
 
	gşass
="content">

61 <?
php
 
´št
 
$cÚ‹Á
;?>

62 </
	gdiv
>

64 <?
php
 ià(
	g$lšks
) { ?>

65 <?
php
 
´št
 
	g$lšks
; ?>

66 <?
	gphp
 }; ?>

68 </
	gdiv
>

70 <?
	gphp


75 <
	gdiv
<?
php
 
´št
 
	g$id_node
 . 
	g$şas£s
; ?>>

76 <?
php
 ià(
	g$node
->
	gt™Ë
) { ?>

77 <
	gh1
><?
php
 
´št
 
	g$t™Ë
;?></h1>

78 <?
	gphp
 } ?>

80 <
div
 
	gşass
="meta">

81 <?
php
 ià(
$piùu»
) { ?>

82 <?
php
 
´št
 
$piùu»
; ?>

83 <?
	gphp
 } ?>

85 <?
php
 
´št
 
theme
('u£ºame', 
$node
); ?>

87 <?
php
 
´št
 
fÜm©_d©e
(
$node
->
ü—‹d
, 'custom', "j F Y") ?>

89 <?
php
 ià(
couÁ
(
$xÚomy
)) { ?>

90 <?
php
 
´št
 
	g$‹rms
 ?>

91 <?
	gphp
 } ?>

92 </
	gdiv
>

94 <?
php
 
´št
 
	g$cÚ‹Á
 ?>

96 <?
php
 
´št
 
	g$node_»giÚ_two
;?>

98 <?
php
 
´št
 
	g$node_»giÚ_Úe
;?>

100 <?
php
 ià(
	g$lšks
) { ?>

101 <?
php
 
´št
 
	g$lšks
; ?>

102 <?
	gphp
 } ?>

103 </
	gdiv
>

104 <?
	gphp
 }

	@/srv/http/subs/notes/www/sites/all/themes/mothership/page.tpl.php

1 <?
	gphp


18 <?
	gphp


19 <!
DOCTYPE
 
html
 
	gPUBLIC
 "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

20 <
html
 
	gxmÊs
="h‰p://www.w3.Üg/1999/xhtml" 
xml
:
Ïng
="<?ph°´šˆ$Ïnguage->Ïnguage; ?>"†ªg="<?ph°´šˆ$Ïnguage->Ïnguage; ?>" 
dœ
="<?php…rint $language->dir; ?>">

22 
mÙh”sh
 
FTW


23 
h‰p
:

25 <
h—d
>

26 <
t™Ë
><?
php
 
´št
 
$h—d_t™Ë
; ?></
	gt™Ë
>

27 <?
php
 
´št
 
	g$h—d
; ?>

28 <?
php
 
´št
 
	g$¡yËs
; ?>

29 <?
php
 
´št
 
	g$süts
; ?>

30 </
	gh—d
>

32 <
body
 
	gşass
="<?php…rint $body_classes; //can be modified inemplate.php mothership_preprocess_page orhoughheheme settings + http://drupal.org./node/171906 ?>">

34 <?
php
 ià(!
	$em±y
(
$admš
)è
´št
 $admin; ?>

35 <
div
 
şass
="header">

36 <<?
php
 
´št
 
$s™e_Çme_–em’t
;

37 <
a
 
h»f
="<?ph°´šˆ$ba£_·th; ?>" 
t™Ë
="<?ph°´šˆt('Home'); ?>" 
»l
="home"><?
php
 
´št
 
$s™e_Çme
; ?></a>

38 </<?
php
 
´št
 
$s™e_Çme_–em’t
; ?>>

40 <?
php
 
´št
 
$s™e_¦ogª
 ?>

41 <?
php
 
´št
 
$missiÚ
 ?>

43 <?
php
 ià(
$h—d”
) { ?>

44 <?
php
 
´št
 
$h—d”
; ?>

45 <?
php
 
	}
} ?>

47 <?
php
 ià(
	g$´im¬y_lšks
) { ?>

48 <?
php
 
´št
 
theme
('lšks', 
$´im¬y_lšks
); ?>

49 <?
	gphp
 } ?>

51 <?
php
 ià(
	g$b»adüumb
) { ?>

52 <?
php
 
´št
 
	g$b»adüumb
;

53 <?
	gphp
 } ?>

55 </
	gdiv
>

56 <
div
 
	gşass
="body clearfix">

57 <
div
 
şass
="left">

58 <?
php
 ià(
$Ëá
) { ?>

59 <?
php
 
´št
 
$Ëá
; ?>

60 <?
	gphp
 } ?>

62 </
	gdiv
>

63 <
div
 
	gşass
="main">

64 <?
php
 ià(
$h–p
 
OR
 
$mes§ges
) { ?>

65 <?
php
 
´št
 
$h–p
 ?>

66 <?
php
 
´št
 
$mes§ges
 ?>

67 <?
php
 } ?>

69 <?
php
 ià(
$bs
) { ?>

70 <?
php
 
´št
 
$bs
; ?>

71 <?
	gphp
 }; ?>

73 <?
php
 ià(
$t™Ë
 
AND
 (
¬g
(0è!ğ"node")è{ ?><
h1
><?ph°
´št
 $t™Ë; ?></
	gh1
><?
	gphp
 } ?>

75 <?
php
 
´št
 
	g$cÚ‹Á
; ?>

77 </
	gdiv
>

78 <
div
 
	gşass
="right">

79 <?
php
 ià(
$right
) { ?>

80 <?
php
 
´št
 
$right
; ?>

81 <?
	gphp
 } ?>

83 <?
php
 
´št
 
mÙh”sh_u£½rofe
(
$u£r
); ?>

85 </
	gdiv
>

86 </
	gdiv
>

88 <
div
 
	gşass
="footer">

90 <?
php
 ià(
$foÙ”_mes§ge
) { ?>

91 <?
php
 
´št
 
$foÙ”_mes§ge
; ?>

92 <?
	gphp
 } ?>

94 <?
php
 
´št
 
	g$foÙ”
; ?>

96 <?
php
 
´št
 
	g$ãed_icÚs
 ?>

97 </
	gdiv
>

99 <?
php
 
´št
 
	g$şosu»
; ?>

101 </
	gbody
>

102 </
	ghtml
>

	@/srv/http/subs/notes/www/sites/all/themes/mothership/search-block-form.tpl.php

1 <?
	gphp


39 <?
php
 
´št
 
	g$£¬ch_fÜm
;

	@/srv/http/subs/notes/www/sites/all/themes/mothership/search-theme-form.tpl.php

1 <?
	gphp


41 <?
php
 
´št
 
	g$£¬ch_fÜm
;

	@/srv/http/subs/notes/www/sites/all/themes/mothership/template.php

1 <?
php


9 ià(
theme_g‘_£‰šg
('mothership_rebuild_registry')) {

10 
dru·l_»bud_theme_»gi¡ry
();

16 
	gšşude_Úû
 './' . 
dru·l_g‘_·th
('theme', 'mothership') . '/template/template.functions.php';

17 
	gšşude_Úû
 './' . 
dru·l_g‘_·th
('theme', 'mothership') . '/template/template.form.php';

18 
	gšşude_Úû
 './' . 
dru·l_g‘_·th
('theme', 'mothership') . '/template/template.cck.php';

19 
	gšşude_Úû
 './' . 
dru·l_g‘_·th
('theme', 'mothership') . '/template/template.table.php';

20 
	gšşude_Úû
 './' . 
dru·l_g‘_·th
('theme', 'mothership') . '/template/template.alternatives.php';

21 
	gšşude_Úû
 './' . 
dru·l_g‘_·th
('theme', 'mothership') . '/template/template.menu.php';

22 
	gšşude_Úû
 './' . 
dru·l_g‘_·th
('theme', 'mothership') . '/template/template.views.php';

27 
funùiÚ
 
	$mÙh”sh_´•roûss
(&
$v¬s
, 
$hook
) {

28 ià(
$hook
 == "page") {

32 
$v¬s
['site_name_element'] = $vars['is_front'] ? 'h1' : 'div';

39 ià(
	`is£t
(
$v¬s
['node'])){

40 
$v¬s
['‹m¶©e_fes'][] = '·ge-' . $v¬s['node']->
ty³
;

44 
$body_şas£s
 = 
	`¬¿y
(
$v¬s
['body_classes']);

47 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_body_remove')) {

49 
$body_şas£s
 = " ";

50 
$body_şas£s
 = 
	`¬¿y
();

53 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_body_front') ){

54 
$body_şas£s
[] = 
$v¬s
['is_front'] ? 'front' : '';

57 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_body_front_not') ){

58 
$body_şas£s
[] = 
$v¬s
['is_front'] ? '' : 'not-front';

62 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_body_loggedin') ){

63 
$body_şas£s
[] = 
$v¬s
['logged_in'] ? 'logged-in' : '';

66 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_body_loggedin_not') ){

67 
$body_şas£s
[] = 
$v¬s
['logged_in'] ? '' : 'not-logged-in';

72 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_body_nodetype') ){

74 ià(
	`is£t
(
$v¬s
['node']è&& $v¬s['node']->
ty³
) {

75 
$body_şas£s
[] = 'node-ty³-'. 
$v¬s
['node']->
ty³
;

80 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_body_layout') ){

82 ià(
$v¬s
['layout'] == 'both') {

83 
$body_şas£s
[] = 'two-sidebars';

85 
	`–£if
 (
$v¬s
['layout'] == 'none') {

86 
$body_şas£s
[] = 'no-sidebars';

89 
$body_şas£s
[] = 'Úe-sideb¬ sideb¬-'. 
$v¬s
['layout'];

95 
$·th
 = 
	`dru·l_g‘_·th_®Ÿs
(
$_GET
['q']);

96 if(
$·th
){

98 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_body_add_path')) {

99 
$body_şas£s
[] = 
	`mÙh”sh_id_§ã
('·th-' . 
$·th
);

103 
$·th_»qui¡
 = 
	`ex¶ode
('/', 
$_SERVER
['REQUEST_URI']);

105 ià(
	`theme_g‘_£‰šg
('mÙh”sh_ş—nup_body_add_Ï¡'è
AND
 !
$v¬s
['is_front']) {

106 
$body_şas£s
[] = 
	`mÙh”sh_id_§ã
('·thÏ¡-' . 
	`’d
(
$·th_»qui¡
) );

109 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_body_pagearg_one') ){

110 
$body_şas£s
[] = 
	`mÙh”sh_id_§ã
('·ge-' . 
$·th_»qui¡
['1']);

115 if(
	`¬g
(0) == "user"){

116 
$body_şas£s
[] = 
	`mÙh”sh_id_§ã
Ğ
$·th
, 'remove-numbers');

120 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_body_actions')) {

121 ià(
	`¬g
(0) == 'node') {

122 ià(
	`¬g
(1) == 'add') {

123 
$body_şas£s
[] = 'action-node-add';

125 
	`–£if
 (
	`is_num”ic
(
	`¬g
(1)) && (arg(2) == 'edit' ||‡rg(2) == 'delete')) {

126 
$body_şas£s
[] = 'aùiÚ-node-' . 
	`¬g
(2);

133 ià(!
	`em±y
(
$v¬s
['admš']è
AND
 
	`theme_g‘_£‰šg
('mothership_cleanup_body_admin')){

134 
$body_şas£s
[] = "adminmenu";

137 
$v¬s
['body_şas£s'] = 
	`im¶ode
(' ', 
$body_şas£s
);

152 ià(
	`theme_g‘_£‰šg
('mÙh”sh_¡yËsh“t_lßd_Üd”'è
OR
heme_get_setting('mothership_stylesheet_conditional')) {

153 
GLOBAL
 
$theme_šfo
;

155 
$·th
 = 
	`dru·l_g‘_·th
('theme', 
$theme_šfo
->
Çme
);

158 ià(
	`theme_g‘_£‰šg
('mothership_stylesheet_load_order')) {

160 ià(
	`is£t
(
$theme_šfo
->
šfo
['top stylesheets'])) {

161 
$tİ_css
 = 
	`¬¿y
();

163 
	`fÜ—ch
 (
$theme_šfo
->
šfo
['tİ styËsh“ts'] 
as
 
$medŸ
 => 
$¡yËs
) {

164 
	`fÜ—ch
 (
$¡yËs
 
as
 
$¡yË
) {

165 
$tİ_css
[
$medŸ
][
$·th
 . '/' . 
$¡yË
] = 
TRUE
;

168 
	`¬¿y_unshiá
(
$v¬s
['css'][
$medŸ
], 
$tİ_css
[$media]);

171 
$v¬s
['¡yËs'] = 
	`dru·l_g‘_css
($vars['css']);

176 ià(
	`is£t
(
$theme_šfo
->
šfo
['› styËsh“ts']è
AND
 
	`theme_g‘_£‰šg
('mothership_stylesheet_conditional')) {

177 
$›_css
 = 
	`¬¿y
();

180 
	`fÜ—ch
 (
$theme_šfo
->
šfo
['› styËsh“ts'] 
as
 
$cÚd™iÚ
 => 
$medŸ
) {

181 
	`fÜ—ch
 (
$medŸ
 
as
 
$ty³
 => 
$¡yËs
) {

182 
	`fÜ—ch
 (
$¡yËs
 
as
 
$¡yË
) {

183 
$›_css
[
$cÚd™iÚ
][
$ty³
]['theme'][
$·th
 . '/' . 
$¡yË
] = 
TRUE
;

189 
	`fÜ—ch
 (
$›_css
 
as
 
$cÚd™iÚ
 => 
$¡yËs
) {

190 
$v¬s
['¡yËs'] .ğ'<!--[' . 
$cÚd™iÚ
 . ']>' . "\n" . 
	`dru·l_g‘_css
(
$¡yËs
) . '<![endif]-->' . "\n";

197 
	`–£if
 (
$hook
 == "node") {

201 
$şas£s
 =
	`¬¿y
();

203 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_node_sticky')) {

204 ià(
$v¬s
['sticky']) {

205 
$şas£s
[] = 'sticky';

209 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_node_published')) {

210 ià(!
$v¬s
['status']) {

211 
$şas£s
[] = 'node-unpublished';

212 
$v¬s
['uÅublished'] = 
TRUE
;

215 
$v¬s
['uÅublished'] = 
FALSE
;

219 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_node_promoted')) {

220 ià(
$v¬s
['promote']) {

221 
$şas£s
[] = 'promoted';

226 ià(
$v¬s
['teaser']) {

227 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_node_node')) {

228 
$şas£s
[] = 'node-teaser';

231 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_node_content_type')) {

232 
$şas£s
[] = 'node-‹a£r-' . 
$v¬s
['type'];

233 
$şas£s
[] = 'node-' . 
$v¬s
['type'];

237 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_node_node')) {

238 
$şas£s
[] = 'node';

240 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_node_content_type')) {

241 
$şas£s
[] = 'node-' . 
$v¬s
['type'];

245 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_node_clearfix')) {

246 
$şas£s
[] = 'clearfix';

250 ià(
	`moduË_exi¡s
('skinr') ) {

251 
$şas£s
[] = 
$v¬s
['skinr'];

254 
$v¬s
['şas£s'] = 
	`im¶ode
(' ', 
$şas£s
);

257 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_node_id')) {

258 
$id_node
 = 
	`¬¿y
();

259 
$id_node
[] = 'node';

260 
$id_node
[] = 
$v¬s
['nid'];

261 ià(
$v¬s
['nid']) {

262 
$v¬s
['id_node'] = 
	`im¶ode
(' ', 
$id_node
);

263 
$v¬s
['id_node'] = 
	`mÙh”sh_id_§ã
($vars['id_node']);

269 ià(
	`theme_g‘_£‰šg
('mÙh”sh_ş—nup_node_»giÚs'è
AND
 
$v¬s
['·ge'] =ğ
TRUE
) {

270 ià(
$v¬s
['·ge'] =ğ
TRUE
) {

271 
$v¬s
['node_»giÚ_Úe'] = 
	`theme
('blocks', 'node_region_one');

272 
$v¬s
['node_»giÚ_two'] = 
	`theme
('blocks', 'node_region_two');

279 ià(
$v¬s
['node']->
lšks
['comment_comments']) {

280 
$v¬s
['lšk_comm’t'] = 
	`l
($v¬s['node']->
lšks
['comment_comments']['title'], $vars['node']->links['comment_comments']['href'],

281 
	`¬¿y
(

282 '©Œibu‹s' => 
	`¬¿y
('şass' => 'comm’t', 't™Ë' => 
$v¬s
['node']->
lšks
['comment_comments']['attributes']['title']),

283 'äagm’t' => 
$v¬s
['node']->
lšks
['comment_comments']['fragment']

289 ià(
$v¬s
['node']->
lšks
['comment_add']) {

290 
$v¬s
['lšk_comm’t_add'] = 
	`l
($v¬s['node']->
lšks
['comment_add']['title'], $vars['node']->links['comment_add']['href'],

291 
	`¬¿y
(

292 '©Œibu‹s' => 
	`¬¿y
('şass' => 'comm’t-add', 't™Ë' => 
$v¬s
['node']->
lšks
['comment_add']['attributes']['title']),

299 ià(
$v¬s
['node']->
lšks
['upload_attachments']) {

300 
$v¬s
['lšk_©chm’ts'] = 
	`l
($v¬s['node']->
lšks
['u¶ßd_©chm’ts']['t™Ë'], $v¬s['node']->lšks['u¶ßd_©chm’ts']['h»f'], 
	`¬¿y
('attributes' =>‡rray('class' => 'attachments','title' => $vars['node']->links['upload_attachments']['attributes']['title'] )));

304 ià(
$v¬s
['node']->
lšks
['node_read_more']) {

305 
$v¬s
['lšk_»ad_mÜe'] = 
	`l
($v¬s['node']->
lšks
['node_»ad_mÜe']['t™Ë'], $v¬s['node']->lšks['node_»ad_mÜe']['h»f'], 
	`¬¿y
('attributes' =>‡rray('class' => 'read-more','title' => $vars['node']->links['node_read_more']['attributes']['title'] )));

309 ià(
$v¬s
['node']->
lšks
['statistics_counter']) {

310 
$v¬s
['¡©i¡ics_couÁ”'] = $v¬s['node']->
lšks
['statistics_counter']['title'];

315  
$v¬s
['template_files'];

319 
	`–£if
 (
$hook
 == "block") {

322 
$block
 = 
$v¬s
['block'];

323 
$şas£s
 = 
	`¬¿y
();

325 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_block_block')) {

326 
$şas£s
[] = 'block';

329 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_block_module')) {

330 
$şas£s
[] = 'block-' . 
	`mÙh”sh_id_§ã
(
$block
->
moduË
);

333 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_block_region_zebra')) {

334 
$şas£s
[] = '»giÚ-' . 
$v¬s
['block_zebra'];

337 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_block_region_count')) {

338 
$şas£s
[] = '»giÚ-couÁ-' . 
	`mÙh”sh_id_§ã
(
$v¬s
['block_id']);

341 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_block_zebra')) {

342 
$şas£s
[] = 
$v¬s
['zebra'];

345 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_block_count')) {

346 
$şas£s
[] = 'couÁ-' . 
	`mÙh”sh_id_§ã
(
$v¬s
['id']);

349 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_block_front')) {

350 ià(
$v¬s
['is_front']) {

351 
$şas£s
[] = 'block-front';

355 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_block_loggedin')) {

356 ià(
$v¬s
['logged_in']) {

357 
$şas£s
[] = 'block-logged-in';

362 ifĞ
	`moduË_exi¡s
(
skšr
) ) {

363 
$şas£s
[] = 
$v¬s
['skinr'];

367 
$v¬s
['şas£s'] = 
	`im¶ode
(' ', 
$şas£s
);

370 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_block_id')) {

371 
$id_block
 = 
	`¬¿y
();

372 
$id_block
[] = 'block';

373 
$id_block
[] = 
$block
->
moduË
 ;

375 ià(
$block
->
d–
) {

376 
$id_block
[] = 
$block
->
d–
;

379 
$v¬s
['id_block'] = 
	`im¶ode
(' ', 
$id_block
);

380 
$v¬s
['id_block'] = 
	`mÙh”sh_id_§ã
($vars['id_block']);

386 
	`–£if
 (
$hook
 == "comment") {

390 
$v¬s
['uÅublished'] = ($v¬s['comm’t']->
¡©us
 =ğ
COMMENT_NOT_PUBLISHED
);

393 ià(
	`v¬ŸbË_g‘
('comm’t_subjeù_f›ld_' . 
$v¬s
['node']->
ty³
, 1) == 0) {

394 
$v¬s
['title'] = '';

398 
$şas£s
 = 
	`¬¿y
();

400 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_comment_comment')) {

401 
$şas£s
[] = 'comment';

404 ià(
$v¬s
['comm’t']->
Ãw
 
AND
 
	`theme_g‘_£‰šg
('mothership_cleanup_comment_new')) {

405 
$şas£s
[] = 'comment-new';

408 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_comment_status')) {

409 
$şas£s
[] = 
$v¬s
['status'];

412 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_comment_zebra')) {

413 
$şas£s
[] = 
$v¬s
['zebra'];

416 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_comment_first')) {

417 ià(
$v¬s
['id'] == 1) {

418 
$şas£s
[] = 'first';

422 ià((
$v¬s
['id'] =ğ$v¬s['node']->
comm’t_couÁ
è
AND
 
	`theme_g‘_£‰šg
('mothership_cleanup_comment_last')) {

423 
$şas£s
[] = 'last';

426 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_comment_user')) {

427 ià(
$v¬s
['comm’t']->
uid
 == 0) {

429 
$şas£s
[] = 'by-anonymous';

432 ià(
$v¬s
['comm’t']->
uid
 == $vars['node']->uid) {

434 
$şas£s
[] = 'by-author';

436 ià(
$v¬s
['comm’t']->
uid
 =ğ
$GLOBALS
['user']->uid) {

438 
$şas£s
[] = 'by-me';

443 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_comment_front')) {

444 ià(
$v¬s
['is_front']) {

445 
$şas£s
[] = 'front';

449 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_comment_loggedin')) {

450 ià(
$v¬s
['logged_in']) {

451 
$şas£s
[] = 'logged-in';

455 
$v¬s
['şas£s'] = 
	`im¶ode
(' ', 
$şas£s
);

458 
	`–£if
 (
$hook
 == "comment_wrapper"){

461 
$id_comm’tw¿p
 = 
	`¬¿y
();

462 
$id_comm’tw¿p
[] = 'comments';

463 
$v¬s
['id_comm’tw¿p'] = 
	`im¶ode
(' ', 
$id_comm’tw¿p
);

464 
$v¬s
['id_comm’tw¿p'] = 
	`mÙh”sh_id_§ã
($vars['id_commentwrap']);

466 
$şas£s
 = 
	`¬¿y
();

468 ifĞ
	`moduË_exi¡s
(
skšr
) ) {

469 
$şas£s
[] = 
$v¬s
['skinr'];

472 
$v¬s
['şas£s'] = 
	`im¶ode
(' ', 
$şas£s
);

477 
	}
}

	@/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.alternatives.php

1 <?
php


17 
funùiÚ
 
mÙh”sh_™em_li¡
(
$™ems
 = 
¬¿y
(), 
$t™Ë
 = 
NULL
, 
$ty³
 = 'ul', 
$©Œibu‹s
 = NULL) {

19 ià(
$ty³
 == "div-span") {

20 
$ty³
 = "div";

21 
	g$™em_ty³
 = "div-span";

24 
	g$™em_ty³
 = 
$ty³
;

27 
	g$©Œibu‹s
['class'] .= " item-list";

29 ià(
is£t
(
$t™Ë
)) {

30 
	g$ouut
 = '<div class="item-list">';

31 ià(
	g$™em_ty³
 == "span") {

32 
$ouut
 .ğ'<¥ª cÏss="t™Ë">'. 
$t™Ë
 .'</span>';

35 
	g$ouut
 .ğ'<h3>'. 
$t™Ë
 .'</h3>';

41 ià(!
em±y
(
$™ems
)) {

42 
	g$ouut
 .ğ"<$ty³". 
dru·l_©Œibu‹s
(
$©Œibu‹s
) .'>';

43 
	g$num_™ems
 = 
couÁ
(
$™ems
);

44 
fÜ—ch
 (
$™ems
 
as
 
$i
 => 
$™em
) {

45 
$©Œibu‹s
 = 
¬¿y
();

46 
	g$chd»n
 = 
¬¿y
();

47 ià(
is_¬¿y
(
$™em
)) {

48 
fÜ—ch
 (
$™em
 
as
 
$key
 => 
$v®ue
) {

49 ià(
$key
 == 'data') {

50 
$d©a
 = 
$v®ue
;

52 
–£if
 (
$key
 == 'children') {

53 
$chd»n
 = 
$v®ue
;

56 
	g$©Œibu‹s
[
$key
] = 
$v®ue
;

61 
	g$d©a
 = 
$™em
;

64 ià(
couÁ
(
$chd»n
) > 0) {

65 
	g$d©a
 .ğ
theme_™em_li¡
(
$chd»n
, 
NULL
, 
$ty³
, 
$©Œibu‹s
);

70 ià(
theme_g‘_£‰šg
('mothership_item_list_zebra')) {

71 ià(
	g$i
 & 1) {

72 
	g$©Œibu‹s
['şass'] = 
em±y
(
$©Œibu‹s
['class']) ? 'odd' : ($attributes['class'] .' odd');

75 
	g$©Œibu‹s
['şass'] = 
em±y
(
$©Œibu‹s
['class']) ? 'even' : ($attributes['class'] .'ƒven');

79 ià(
theme_g‘_£‰šg
('mothership_item_list_first_last')) {

80 ià(
	g$i
 == 0) {

81 
$©Œibu‹s
['class'] .= ' first';

83 ià(
	g$i
 =ğ
$num_™ems
 - 1) {

84 
$©Œibu‹s
['class'] .= '†ast';

89 ià(
	g$™em_ty³
 =ğ"ul" 
OR
 
$™em_ty³
 == "ol") {

90 
$ouut
 .ğ'<li'. 
dru·l_©Œibu‹s
(
$©Œibu‹s
è.'>'. 
$d©a
 ."</li>\n";

92 
–£if
 (
$™em_ty³
 =ğ"¥ª" 
OR
 $item_type == "div-span" ) {

93 
$ouut
 .ğ'<¥ª'. 
dru·l_©Œibu‹s
(
$©Œibu‹s
è.'>'. 
$d©a
 ."</span>\n";

95 
–£if
 (
$™em_ty³
 == "div") {

96 
$ouut
 .ğ'<div'. 
dru·l_©Œibu‹s
(
$©Œibu‹s
è.'>'. 
$d©a
 ."</div>\n";

99 
	g$ouut
 .ğ'<li'. 
dru·l_©Œibu‹s
(
$©Œibu‹s
è.'>'. 
$d©a
 ."</li>\n";

103 
	g$ouut
 .= "</$type>";

105 ià(
is£t
(
$t™Ë
)) {

106 
	g$ouut
 .= '</div>';

108  
	g$ouut
;

116 
funùiÚ
 
	$mÙh”sh_u£ºame
(
$objeù
) {

118 ià(
$objeù
->
uid
 && $objeù->
Çme
) {

120 ià(
	`dru·l_¡¾’
(
$objeù
->
Çme
) > 20) {

121 
$Çme
 = 
	`dru·l_sub¡r
(
$objeù
->
Çme
, 0, 15) .'...';

124 
$Çme
 = 
$objeù
->
Çme
;

127 ià(
	`u£r_acûss
('access user…rofiles')) {

128 
$ouut
 = 
	`l
(
$Çme
, 'u£r/'. 
$objeù
->
uid
, 
	`¬¿y
('©Œibu‹s' =>‡¼ay('t™Ë' => 
	`t
('View user…rofile.'))));

131 
$ouut
 = 
	`check_¶aš
(
$Çme
);

134 
	`–£if
 (
$objeù
->
Çme
) {

139 ià(!
	`em±y
(
$objeù
->
hom•age
)) {

140 
$ouut
 = 
	`l
(
$objeù
->
Çme
, $objeù->
hom•age
, 
	`¬¿y
('attributes' =>‡rray('rel' => 'nofollow')));

143 
$ouut
 = 
	`check_¶aš
(
$objeù
->
Çme
);

145 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_user_verified')) {

146 
$ouut
 .ğ'<¥ª cÏss="nÙ-v”if›d">('. 
	`t
('not verified') .'</span>)';

150 
$ouut
 = 
	`check_¶aš
(
	`v¬ŸbË_g‘
('ªÚymous', 
	`t
('Anonymous')));

153  
$ouut
;

154 
	}
}

157 
funùiÚ
 
mÙh”sh_box
(
$t™Ë
, 
$cÚ‹Á
, 
$»giÚ
 = 'main') {

158 
$ouut
 = '';

159 if(
	g$t™Ë
){

160 
	g$ouut
 = '<h2>'. 
$t™Ë
 .'</h2>';

163 
	g$ouut
 .ğ'<div cÏss="box">'. 
$cÚ‹Á
 .'</div>';

164  
	g$ouut
;

170 
funùiÚ
 
	$mÙh”sh_admš_icÚ_şas£s
(
$·th
) {

171 
$şas£s
 = 
	`¬¿y
();

172 
$¬gs
 = 
	`ex¶ode
('/', 
$·th
);

173 ià(
$¬gs
[0] === 'admin' || $args[0] === 'node' && $args[1] === 'add') {

174 
	`couÁ
(
$¬gs
)) {

175 
$şas£s
[] = '·th-'. 
	`¡r_»¶aû
('/', '-', 
	`im¶ode
('/', 
$¬gs
));

176 
	`¬¿y_pİ
(
$¬gs
);

178  
	`im¶ode
(' ', 
$şas£s
);

181 
	}
}

183 
funùiÚ
 
	$mÙh”sh_admš_m’u_™em_lšk
(
$lšk
) {

184 
$lšk
['loÿlized_İtiÚs'] = 
	`em±y
($lšk['loÿlized_İtiÚs']è? 
	`¬¿y
() : $link['localized_options'];

185 
$lšk
['loÿlized_İtiÚs']['html'] = 
TRUE
;

186 ià(
	`is£t
(
$lšk
['localized_options']['attributes']['class'])) {

187 
$lšk
['loÿlized_İtiÚs']['©Œibu‹s']['şass'] = 
	`mÙh”sh_admš_icÚ_şas£s
($link['href']);

190 
$lšk
['loÿlized_İtiÚs']['©Œibu‹s']['şass'] .ğ' '. 
	`mÙh”sh_admš_icÚ_şas£s
($link['href']);

192 
$lšk
['desütiÚ'] = 
	`check_¶aš
(
	`Œunÿ‹_utf8
(
	`¡r_gs
($lšk['desütiÚ']), 150, 
TRUE
, TRUE));

193 
$lšk
['description'] = "<span class='icon'></span>" . $link['description'];

194 
$lšk
['t™Ë'] .ğ!
	`em±y
($link['description']) ? "<span class='menu-description'>{$link['description']}</span>" : '';

195  
	`l
(
$lšk
['title'], $link['href'], $link['localized_options']);

196 
	}
}

	@/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.cck.php

1 <?
php


12 
funùiÚ
 
	$mÙh”sh_fef›ld_fe
(
$fe
) {

14 ià(
	`em±y
(
$fe
['fid'])) {

18 
$·th
 = 
$fe
['filepath'];

19 
$u¾
 = 
	`fe_ü—‹_u¾
(
$·th
);

20 
$icÚ
 = 
	`theme
('fef›ld_icÚ', 
$fe
);

26 
$İtiÚs
 = 
	`¬¿y
(

27 '©Œibu‹s' => 
	`¬¿y
(

28 'ty³' => 
$fe
['filemime'],

29 'Ëngth' => 
$fe
['filesize'],

34 ià(
	`em±y
(
$fe
['data']['description'])) {

35 
$lšk_‹xt
 = 
$fe
['filename'];

38 
$lšk_‹xt
 = 
$fe
['data']['description'];

39 
$İtiÚs
['©Œibu‹s']['t™Ë'] = 
$fe
['filename'];

44  
	`l
(
$icÚ
 . '<¥ª>' . 
$lšk_‹xt
 . '</¥ª>', 
$u¾
, 
$İtiÚs
ğ
	`¬¿y
('html' => 
TRUE
));

45 
	}
}

49 
funùiÚ
 
	$mÙh”sh_fef›ld_icÚ
(
$fe
) {

50 ià(
	`is_objeù
(
$fe
)) {

51 
$fe
 = (
¬¿y
) $file;

53 
$mime
 = 
	`check_¶aš
(
$fe
['filemime']);

55 
$dashed_mime
 = 
	`¡¹r
(
$mime
, 
	`¬¿y
('/' => '-'));

57 ià(
$icÚ_u¾
 = 
	`fef›ld_icÚ_u¾
(
$fe
)) {

59 
$icÚ
 = '<img "‡É="'. 
$mime
 .' icÚ" src="'. 
$icÚ_u¾
 .'" />';

62  
$icÚ
;

63 
	}
}

	@/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.form.php

1 <?
php


8 
funùiÚ
 
	$mÙh”sh_fÜm_–em’t
(
$–em’t
, 
$v®ue
) {

10 
$t
 = 
	`g‘_t
();

13 
$ouut
 = "<div cÏss=\"fÜm-™em fÜm-™em-" . 
$–em’t
['#type'] . " \" ";

16 ià(!
	`em±y
(
$–em’t
['#id'])) {

17 
$ouut
 .ğ' id="'. 
$–em’t
['#id'] .'-wrapper"';

19 
$ouut
 .= ">\n";

20 
$»quœed
 = !
	`em±y
(
$–em’t
['#»quœed']è? '<¥ª cÏss="fÜm-»quœed"™Ë="'. 
	`$t
('This field is„equired.') .'">*</span>' : '';

22 ià(!
	`em±y
(
$–em’t
['#title'])) {

23 
$t™Ë
 = 
$–em’t
['#title'];

24 ià(!
	`em±y
(
$–em’t
['#id'])) {

25 
$ouut
 .ğ' <Ïb– fÜ="'. 
$–em’t
['#id'] .'">'. 
	`$t
('!t™Ë: !»quœed', 
	`¬¿y
('!t™Ë' => 
	`f‹r_xss_admš
(
$t™Ë
), '!»quœed' => 
$»quœed
)) ."</label>\n";

28 
$ouut
 .ğ' <Ïb–>'. 
	`$t
('!t™Ë: !»quœed', 
	`¬¿y
('!t™Ë' => 
	`f‹r_xss_admš
(
$t™Ë
), '!»quœed' => 
$»quœed
)) ."</label>\n";

33 
$ouut
 .= "$value\n";

35 ià(!
	`em±y
(
$–em’t
['#description'])) {

36 
$ouut
 .ğ'<div cÏss="fÜm-desütiÚ">'. 
$–em’t
['#description'] ."</div>\n";

39 
$ouut
 .= "</div>\n";

41  
$ouut
;

42 
	}
}

45 
funùiÚ
 
	$mÙh”sh_fe
(
$–em’t
) {

46 
	`_fÜm_£t_şass
(
$–em’t
, 
	`¬¿y
('file'));

47  
	`theme
('fÜm_–em’t', 
$–em’t
, '<špuˆty³="fe"‚ame="'. $–em’t['#Çme'] .'"'. ($–em’t['#©Œibu‹s'] ? ' '. 
	`dru·l_©Œibu‹s
($element['#attributes']) : '') .' id="'. $element['#id'] .'" />');

49 
	}
}

51 
funùiÚ
 
	$mÙh”sh_checkbox
(
$–em’t
) {

52 
	`_fÜm_£t_şass
(
$–em’t
, 
	`¬¿y
('checkbox'));

53 
$checkbox
 = '<input ';

54 
$checkbox
 .= 'type="checkbox" ';

55 
$checkbox
 .ğ'Çme="'. 
$–em’t
['#name'] .'" ';

56 
$checkbox
 .ğ'id="'. 
$–em’t
['#id'] .'" ' ;

57 
$checkbox
 .ğ'v®ue="'. 
$–em’t
['#return_value'] .'" ';

58 
$checkbox
 .ğ
$–em’t
['#value'] ? ' checked="checked" ' : ' ';

59 
$checkbox
 .ğ
	`dru·l_©Œibu‹s
(
$–em’t
['#attributes']) .' />';

61 ià(!
	`is_nuÎ
(
$–em’t
['#title'])) {

62 
$checkbox
 = '<Ïb– cÏss="fÜm-İtiÚ" fÜ="'. 
$–em’t
['#id'] .'">'. $checkbox .' '. $element['#title'] .'</label>';

65 
	`un£t
(
$–em’t
['#title']);

66  
	`theme
('fÜm_–em’t', 
$–em’t
, 
$checkbox
);

67 
	}
}

70 
funùiÚ
 
	$mÙh”sh_f›ld£t
(
$–em’t
) {

72 ià(!
	`em±y
(
$–em’t
['#collapsible'])) {

73 
	`dru·l_add_js
('misc/collapse.js');

75 ià(!
	`is£t
(
$–em’t
['#attributes']['class'])) {

76 
$–em’t
['#attributes']['class'] = '';

79 
$–em’t
['#attributes']['class'] .= ' collapsible';

80 ià(!
	`em±y
(
$–em’t
['#collapsed'])) {

81 
$–em’t
['#attributes']['class'] .= ' collapsed';

85  '<f›ld£t'. 
	`dru·l_©Œibu‹s
(
$–em’t
['#©Œibu‹s']è.'>'. ($–em’t['#t™Ë'] ? '<Ëg’d><¥ª>'. $–em’t['#t™Ë'] .'</¥ª></Ëg’d>' : ''è. (
	`is£t
($–em’t['#desütiÚ']è&& $–em’t['#desütiÚ'] ? '<div cÏss="desütiÚ">'. $–em’t['#desütiÚ'] .'</div>' : ''è. (!
	`em±y
($element['#children']) ? $element['#children'] : '') . (isset($element['#value']) ? $element['#value'] : '') ."</fieldset>\n";

86 
	}
}

89 
funùiÚ
 
	$mÙh”sh_bu‰Ú
(
$–em’t
) {

93 ià(
	`is£t
(
$–em’t
['#attributes']['class'])) {

94 
$–em’t
['#attributes']['class'] = 'form-' . $element['#button_type'] .' '. $element['#attributes']['class'];

97 
$–em’t
['#attributes']['class'] = 'form-' . $element['#button_type'];

101  '<div cÏss="fÜm-bu‰Ú ' . 
$–em’t
['#id'] .'"><¥ª><špuˆty³="subm™" ' . (
	`em±y
($–em’t['#Çme']è? '' : 'Çme="'. $–em’t['#Çme'] .'" 'è. 'id="' . $–em’t['#id'] . '" v®ue="'. 
	`check_¶aš
($–em’t['#v®ue']è.'" ' . 
	`dru·l_©Œibu‹s
($element['#attributes']) ." /></span></div>\n";

102 
	}
}

104 
funùiÚ
 
	$mÙh”sh_image_bu‰Ú
(
$–em’t
) {

106 ià(
	`is£t
(
$–em’t
['#attributes']['class'])) {

107 
$–em’t
['#attributes']['class'] = 'form-'. $element['#button_type'] .' '. $element['#attributes']['class'];

110 
$–em’t
['#attributes']['class'] = 'form-'. $element['#button_type'];

113  '<div cÏss="fÜm-image-bu‰Ú"><špuˆty³="image"‚ame="'. 
$–em’t
['#name'] .'" '.

114 (!
	`em±y
(
$–em’t
['#v®ue']è? ('v®ue="'. 
	`check_¶aš
($element['#value']) .'" ') : '') .

115 'id="'. 
$–em’t
['#id'] .'" '.

116 
	`dru·l_©Œibu‹s
(
$–em’t
['#attributes']) .

117 ' src="'. 
	`ba£_·th
(è. 
$–em’t
['#src'] .'" '.

118 (!
	`em±y
(
$–em’t
['#t™Ë']è? '®t="'. 
	`check_¶aš
($element['#title']) .'"itle="'. check_plain($element['#title']) .'" ' : '' ) .

120 
	}
}

	@/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.functions.php

1 <?
php


8 
funùiÚ
 
mÙh”sh_id_§ã
(
$¡ršg
, 
$v¬s
 = "default") {

10 if(
$v¬s
 == "remove-numbers"){

11 
$¡ršg
 = 
¡¹Şow”
(
´eg_»¶aû
('/[^a-zA-Z_-]+/', '-', $string));

13 
	g$¡ršg
 = 
¡¹Şow”
(
´eg_»¶aû
('/[^a-zA-Z0-9_-]+/', '-', 
$¡ršg
));

16 
	g$¡ršg
 = 
¡¹Şow”
(
¡r_»¶aû
('_', '-', 
$¡ršg
));

19 ià(!
ùy³_low”
(
$¡ršg
{0})) {

20 
	g$¡ršg
 = 'id' . 
$¡ršg
;

22  
	g$¡ršg
;

26 
funùiÚ
 
	$mÙh”sh_u£½rofe
(
$u£r
){

27 ià(
$u£r
->
uid
) {

29 ià(
$u£r
->
piùu»
) {

30 
$u£rimage
 = '<img src="/' . 
$u£r
->
piùu»
 . '">';

31 
´št
 '<div cÏss="´ofe-image">' . 
	`l
(
$u£rimage
, 'u£r/' . 
$u£r
->
uid
, 
$İtiÚs
 = 
	`¬¿y
('html' => 
TRUE
)) . '</div>';

33 
´št
 '<ul class="profile">';

34 
´št
 '<l˜şass="´ofe-Çme">' . 
	`l
(
$u£r
->
Çme
, 'u£r/' . $u£r->
uid
 . '') . '</li>';

35 
´št
 '<l˜şass="´ofe-ed™">' . 
	`l
(
	`t
('ed™'), 'u£r/' . 
$u£r
->
uid
 . '/edit') . '</li>';

36 
´št
 '<l˜şass="´ofe-logout">' . 
	`l
(
	`t
('Sign out'), 'logout') . '</li>';

37 
´št
 '</ul>';

39 
	}
}

	@/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.menu.php

1 <?
php


8 
funùiÚ
 
	$mÙh”sh_m’u_Œ“
(
$Œ“
) {

9 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_menu_baseclass')) {

10  '<!--m’u-->' . "\n" . ' <uÈşass="m’u">' . "\n" . 
$Œ“
 . ' </ul>' . "\n <!--/menu-->\n" ;

13  '<!--m’u--> <ul>' . "\n" . 
$Œ“
 . "\n" . " </ul>\n";

16 
	}
}

18 
funùiÚ
 
mÙh”sh_m’u_™em
(
$lšk
, 
$has_chd»n
, 
$m’u
 = '', 
$š_aùive_Œa
 = 
FALSE
, 
$exŒa_şass
 = 
NULL
) {

20 ià(
theme_g‘_£‰šg
('mothership_cleanup_menu_leafs')) {

21 
$şass
 = (
$m’u
 ? 'ex·nded' : (
$has_chd»n
 ? 'collapsed' : 'leaf'));

24 ià(!
em±y
(
$exŒa_şass
è
AND
 
theme_g‘_£‰šg
('mothership_cleanup_menu_classes_first_last')) {

25 ià(
	g$şass
) {

26 
	g$şass
 .ğ' '. 
$exŒa_şass
;

29 
	g$şass
 .ğ
$exŒa_şass
;

34 ià(
$š_aùive_Œa
 
AND
 
theme_g‘_£‰šg
('mothership_cleanup_menu_classes_active')) {

35 
	g$şass
 .= '‡ctive-trail';

38 ià(
	g$şass
) {

39  ' <l˜şass="'. 
	g$şass
 .'">'. 
	g$lšk
 . 
	g$m’u
 ."</li>\n";

42  ' <li>'. 
	g$lšk
 . 
	g$m’u
 ."</li>\n";

48 
funùiÚ
 
	$mÙh”sh_m’u_loÿl_sk
(
$lšk
, 
$aùive
 = 
FALSE
) {

49 ià(
	`theme_g‘_£‰šg
('mothership_cleanup_menu_classes_active')) {

50  ' <l˜'. (
$aùive
 ? 'şass="aùive" ' : ''è.'>'. 
$lšk
 ."</li>\n";

53  ' <li>'. 
$lšk
 ."</li>\n";

55 
	}
}

59 
funùiÚ
 
mÙh”sh_lšks
(
$lšks
, 
$©Œibu‹s
 = 
¬¿y
('class' => 'links')) {

61 
$ouut
 = '';

63 ià(
couÁ
(
$lšks
) > 0) {

64 ià(
theme_g‘_£‰šg
('mothership_cleanup_links_baseclass')) {

65 
	g$ouut
 = ' <ul'. 
dru·l_©Œibu‹s
(
$©Œibu‹s
) .'>';

68 
	g$ouut
 = ' <ul>';

70 
	g$num_lšks
 = 
couÁ
(
$lšks
);

71 
	g$i
 = 1;

73 
fÜ—ch
 (
$lšks
 
as
 
$key
 => 
$lšk
) {

74 
$şass
 = 
$key
;

75 ià(
theme_g‘_£‰šg
('mothership_cleanup_menu_classes_first_last')) {

77 ià(
	g$i
 == 1) {

78 
$şass
 .= ' first';

80 ià(
	g$i
 =ğ
$num_lšks
) {

81 
$şass
 .= '†ast';

85 ià(
theme_g‘_£‰šg
('mothership_cleanup_menu_classes_active')) {

86 ià(
is£t
(
$lšk
['h»f']è&& (
	g$lšk
['h»f'] =ğ
$_GET
['q'] || ($lšk['h»f'] =ğ'<äÚt>' && 
dru·l_is_äÚt_·ge
()))) {

87 
$şass
 .= '‡ctive';

91 ià(
is£t
(
$lšk
['href'])) {

93 ià(
theme_g‘_£‰šg
('mothership_menu_classes_active')) {

94 ià(
¡½os
(
$lšk
['©Œibu‹s']['şass'], 'aùive-Œa'è!=ğ
FALSE
 && sŒpos(
$şass
, 'active') === FALSE) {

95 
$şass
 .= '‡ctive';

96 
	g$lšk
['attributes']['class'] .= '‡ctive';

100 
	g$lšk
 = 
l
(
$lšk
['title'], $link['href'], $link);

102 
–£if
 (!
em±y
(
$lšk
['title'])) {

104 ià(
em±y
(
$lšk
['html'])) {

105 
	g$lšk
['t™Ë'] = 
check_¶aš
(
$lšk
['title']);

107 
	g$¥ª_©Œibu‹s
 = '';

108 ià(
is£t
(
$lšk
['attributes'])) {

109 
	g$¥ª_©Œibu‹s
 = 
dru·l_©Œibu‹s
(
$lšk
['attributes']);

111 
	g$lšk
 = '<¥ª'. 
$¥ª_©Œibu‹s
 .'>'. 
$lšk
['title'] .'</span>';

114 
	g$i
++;

117 
	g$ouut
 .ğ' <li'. 
dru·l_©Œibu‹s
(
¬¿y
('şass' => 
$şass
)) .'>';

118 
	g$ouut
 .ğ
$lšk
;

119 
	g$ouut
 .= "</li>\n";

122 
	g$ouut
 .= '</ul>' . "\n";

124  
	g$ouut
;

	@/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.table.php

1 <?
php


12 
funùiÚ
 
mÙh”sh_bË
(
$h—d”
, 
$rows
, 
$©Œibu‹s
 = 
¬¿y
(), 
$ÿ±iÚ
 = 
NULL
) {

14 ià(
couÁ
(
$h—d”
)) {

15 
dru·l_add_js
('misc/tableheader.js');

18 
	g$©Œibu‹s
['şass'] = 
em±y
(
$©Œibu‹s
['class']) ? 'sticky-enabled' : ($attributes['class'] .' sticky-enabled');

21 
	g$ouut
 = '<bË'. 
dru·l_©Œibu‹s
(
$©Œibu‹s
) .">\n";

23 ià(
is£t
(
$ÿ±iÚ
)) {

24 
	g$ouut
 .ğ'<ÿ±iÚ>'. 
$ÿ±iÚ
 ."</caption>\n";

28 ià(
couÁ
(
$h—d”
)) {

30 
	g$ts
 = 
bËsÜt_š™
(
$h—d”
);

33 
	g$ouut
 .ğ(
couÁ
(
$rows
) ? ' <thead><tr>' : ' <tr>');

35 
	g$i
 = 0;

36 
fÜ—ch
 (
$h—d”
 
as
 
$ûÎ
) {

38 
	g$zeb¿
 = 
$i
 % 2 ? 'even' : 'odd';

40 
	g$zeb¿
 .ğ" couÁ-" . 
$i
 . ' ' . 
mÙh”sh_id_§ã
(
$ûÎ
);

41 ià(
is_¬¿y
(
$ûÎ
)) {

43 ià(
is£t
(
$ûÎ
['class'])) {

44 
	g$ûÎ
['şass'] .ğ
$zeb¿
;

47 
	g$ûÎ
['şass'] = 
$zeb¿
;

51 
	g$ûÎ
 = 
¬¿y
('d©a' => 
$ûÎ
, 'şass' => 
$zeb¿
);

54 
	g$ûÎ
 = 
bËsÜt_h—d”
(
$ûÎ
, 
$h—d”
, 
$ts
);

55 
	g$ouut
 .ğ
_theme_bË_ûÎ
(
$ûÎ
, 
TRUE
);

57 
	g$i
++;

60 
	g$ouut
 .ğ(
couÁ
(
$rows
) ? " </tr></thead>\n" : "</tr>\n");

63 
	g$ts
 = 
¬¿y
();

69 ià(
couÁ
(
$rows
)) {

70 
	g$ouut
 .= "<tbody>\n";

71 
	g$æ
 = 
¬¿y
('even' => 'odd', 'odd' => 'even');

72 
	g$şass
 = 'even';

73 
fÜ—ch
 (
$rows
 
as
 
$numb”
 => 
$row
) {

74 
$©Œibu‹s
 = 
¬¿y
();

77 ià(
is£t
(
$row
['data'])) {

78 
fÜ—ch
 (
$row
 
as
 
$key
 => 
$v®ue
) {

79 ià(
$key
 == 'data') {

80 
$ûÎs
 = 
$v®ue
;

83 
	g$©Œibu‹s
[
$key
] = 
$v®ue
;

88 
	g$ûÎs
 = 
$row
;

90 ià(
couÁ
(
$ûÎs
)) {

92 
	g$şass
 = 
$æ
[
$şass
];

93 ià(
is£t
(
$©Œibu‹s
['class'])) {

94 
	g$©Œibu‹s
['şass'] .ğ' '. 
$şass
;

97 
	g$©Œibu‹s
['şass'] = 
$şass
;

101 
	g$ouut
 .ğ' <Œ'. 
dru·l_©Œibu‹s
(
$©Œibu‹s
) .'>';

102 
	g$i
 = 0;

103 
fÜ—ch
 (
$ûÎs
 
as
 
$ûÎ
) {

104 
	g$ûÎ
 = 
bËsÜt_ûÎ
(
$ûÎ
, 
$h—d”
, 
$ts
, 
$i
++);

105 
	g$ouut
 .ğ
_theme_bË_ûÎ
(
$ûÎ
);

107 
	g$ouut
 .= " </tr>\n";

110 
	g$ouut
 .= "</tbody>\n";

113 
	g$ouut
 .= "</table>\n";

114  
	g$ouut
;

	@/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.views.php

1 <?
php


7 
funùiÚ
 
	$mÙh”sh_´•roûss_v›ws_v›w_li¡
(&
$v¬s
) {

8 
	`mÙh”sh_´•roûss_v›ws_v›w_unfÜm©‹d
(
$v¬s
);

9 
	}
}

11 
funùiÚ
 
	$mÙh”sh_´•roûss_v›ws_v›w_unfÜm©‹d
(&
$v¬s
) {

13 
$v›w
 = 
$v¬s
['view'];

14 
$rows
 = 
$v¬s
['rows'];

16 
$v¬s
['şas£s'] = 
	`¬¿y
();

18 
	`fÜ—ch
 (
$rows
 
as
 
$id
 => 
$row
) {

20 ià(
	`theme_g‘_£‰šg
(
mÙh”sh_ş—nup_v›ws_row_couÁ
)) {

21 ià(
	`theme_g‘_£‰šg
(
mÙh”sh_ş—nup_v›ws_row_id’tify
)) {

22 
$v¬s
['şas£s'][
$id
] = 'views-row-' . ($id + 1);

25 
$v¬s
['şas£s'][
$id
] = 'row-' . ($id + 1);

29 ià(
	`theme_g‘_£‰šg
(
mÙh”sh_ş—nup_v›ws_zeb¿
)) {

30 ià(
	`theme_g‘_£‰šg
(
mÙh”sh_ş—nup_v›ws_row_id’tify
)) {

31 
$v¬s
['şas£s'][
$id
] .= ' views-row-' . ($id % 2 ? 'even' : 'odd');

34 
$v¬s
['şas£s'][
$id
] .= ($id % 2 ? 'ƒven ' : ' odd ');

38 ià(
$id
 =ğ0 
AND
 
	`theme_g‘_£‰šg
(
mÙh”sh_ş—nup_v›ws_fœ¡_Ï¡
)) {

39 ià(
	`theme_g‘_£‰šg
(
mÙh”sh_ş—nup_v›ws_row_id’tify
)) {

40 
$v¬s
['şas£s'][
$id
] .= ' views-row-first';

43 
$v¬s
['şas£s'][
$id
] .= 'first';

49 ià(
	`theme_g‘_£‰šg
(
mÙh”sh_ş—nup_v›ws_fœ¡_Ï¡
)) {

50 ià(
	`theme_g‘_£‰šg
(
mÙh”sh_ş—nup_v›ws_row_id’tify
)) {

51 
$v¬s
['şas£s'][
$id
] .= ' views-row-last';

54 
$v¬s
['şas£s'][
$id
] .= '†ast';

58 
	}
}

63 
funùiÚ
 
	$mÙh”sh_´•roûss_v›ws_v›w_bË
(&
$v¬s
) {

64 
$v›w
 = 
$v¬s
['view'];

71 
$»suÉ
 = 
$v›w
->
»suÉ
;

72 
$v¬s
['rows'] = 
	`¬¿y
();

74 
$İtiÚs
 = 
$v›w
->
¡yË_¶ugš
->
İtiÚs
;

75 
$hªdËr
 = 
$v›w
->
¡yË_¶ugš
;

77 
$f›lds
 = &
$v›w
->
f›ld
;

78 
$cŞumns
 = 
$hªdËr
->
	`§n™ize_cŞumns
(
$İtiÚs
['cŞumns'], 
$f›lds
);

80 
$aùive
 = !
	`em±y
(
$hªdËr
->
aùive
) ? $handler->active : '';

81 
$Üd”
 = !
	`em±y
(
$hªdËr
->
Üd”
) ? $handler->order : 'asc';

83 
$qu”y
 = 
	`bËsÜt_g‘_qu”y¡ršg
();

84 ià(
$qu”y
) {

85 
$qu”y
 = '&' . $query;

90 
$»nd”s
 = 
	`¬¿y
();

91 
$keys
 = 
	`¬¿y_keys
(
$v›w
->
f›ld
);

92 
	`fÜ—ch
 (
$»suÉ
 
as
 
$couÁ
 => 
$row
) {

93 
	`fÜ—ch
 (
$keys
 
as
 
$id
) {

94 
$»nd”s
[
$couÁ
][
$id
] = 
$v›w
->
f›ld
[$id]->
	`theme
(
$row
);

98 
	`fÜ—ch
 (
$cŞumns
 
as
 
$f›ld
 => 
$cŞumn
) {

100 ià(
$f›ld
 =ğ
$cŞumn
 && 
	`em±y
(
$f›lds
[$f›ld]->
İtiÚs
['exclude'])) {

101 
$Ïb–
 = 
	`check_¶aš
(!
	`em±y
(
$f›lds
[
$f›ld
]è? $f›lds[$f›ld]->
	`Ïb–
() : '');

102 ià(
	`em±y
(
$İtiÚs
['šfo'][
$f›ld
]['sÜbË']è|| !
$f›lds
[$f›ld]->
	`şick_sÜbË
()) {

103 
$v¬s
['h—d”'][
$f›ld
] = 
$Ïb–
;

107 
$š™Ÿl
 = 'asc';

109 ià(
$aùive
 =ğ
$f›ld
 && 
$Üd”
 == 'asc') {

110 
$š™Ÿl
 = 'desc';

113 
$t™Ë
 = 
	`t
('sÜˆby @s', 
	`¬¿y
('@s' => 
$Ïb–
));

114 ià(
$aùive
 =ğ
$f›ld
) {

115 
$Ïb–
 .ğ
	`theme
('bËsÜt_šdiÿtÜ', 
$š™Ÿl
);

117 
$lšk_İtiÚs
 = 
	`¬¿y
(

118 'html' => 
Œue
,

119 '©Œibu‹s' => 
	`¬¿y
('t™Ë' => 
$t™Ë
),

120 'qu”y' => 'Üd”=' . 
	`u¾’code
(
$f›ld
è. '&sÜt=' . 
$š™Ÿl
 . 
$qu”y
,

122 
$v¬s
['h—d”'][
$f›ld
] = 
	`l
(
$Ïb–
, 
$_GET
['q'], 
$lšk_İtiÚs
);

128 
$v¬s
['f›lds'][
$f›ld
] = 
	`v›ws_css_§ã
($field);

129 ià(
$aùive
 =ğ
$f›ld
) {

130 
$v¬s
['f›lds'][
$f›ld
] .= '‡ctive';

134 
	`fÜ—ch
 (
$»suÉ
 
as
 
$num
 => 
$row
) {

135 ià(!
	`em±y
(
$f›lds
[
$f›ld
]è&&ƒm±y($f›lds[$f›ld]->
İtiÚs
['exclude'])) {

136 
$f›ld_ouut
 = 
$»nd”s
[
$num
][
$f›ld
];

139 ià(
	`em±y
(
$f›ld_ouut
è&& !em±y(
$v¬s
['rows'][
$num
][
$cŞumn
])) {

144 ià(!
	`em±y
(
$v¬s
['rows'][
$num
][
$cŞumn
])) {

145 ià(!
	`em±y
(
$İtiÚs
['šfo'][
$cŞumn
]['separator'])) {

146 
$v¬s
['rows'][
$num
][
$cŞumn
] .ğ
	`f‹r_xss_admš
(
$İtiÚs
['info'][$column]['separator']);

150 
$v¬s
['rows'][
$num
][
$cŞumn
] = '';

153 
$v¬s
['rows'][
$num
][
$cŞumn
] .ğ
$f›ld_ouut
;

159 
	`fÜ—ch
 (
$v¬s
['rows'] 
as
 
$num
 => 
$row
) {

160 iàĞ
$num
 =ğ0 
AND
 
	`theme_g‘_£‰šg
(
mÙh”sh_ş—nup_v›ws_bË_fœ¡_Ï¡
) ) {

161 
$v¬s
['row_şas£s'][
$num
]['first'] = "first";

163 ià(
	`theme_g‘_£‰šg
(
mÙh”sh_ş—nup_v›ws_bË_row_couÁ
)) {

164 
$v¬s
['row_şas£s'][
$num
]['count'] = "row-" .$num;

167 ià(
	`theme_g‘_£‰šg
(
mÙh”sh_ş—nup_v›ws_bË_zeb¿
)) {

168 
$v¬s
['row_şas£s'][
$num
]['zebra'] = ($num % 2 == 0) ? 'odd' : 'even';

171 ià(
	`theme_g‘_£‰šg
(
mÙh”sh_ş—nup_v›ws_bË_fœ¡_Ï¡
)) {

172 
$v¬s
['row_şas£s'][
$num
][] = "last";

175 
$v¬s
['class'] = 'views-table';

176 ià(!
	`em±y
(
$İtiÚs
['sticky'])) {

177 
	`dru·l_add_js
('misc/tableheader.js');

178 
$v¬s
['class'] .= " sticky-enabled";

180 
	}
}

184 
funùiÚ
 
	$mÙh”sh_cÚ‹Á_v›w_muÉË_f›ld
(
$™ems
, 
$f›ld
, 
$v®ues
) {

185 
$ouut
 = '';

186 
	`fÜ—ch
 (
$™ems
 
as
 
$™em
) {

187 ià(!
	`em±y
(
$™em
) || $item == '0') {

188 
$ouut
 .ğ'<div>'. 
$™em
 .'</div>';

191  
$ouut
;

192 
	}
}

	@/srv/http/subs/notes/www/sites/all/themes/mothership/theme-settings.php

1 <?
php


15 
funùiÚ
 
	$mÙh”sh_theme_g‘_deçuÉ_£‰šgs
(
$theme
) {

17 
$themes
 = 
	`li¡_themes
();

20 
$deçuÉs
 = !
	`em±y
(
$themes
[
$theme
]->
šfo
['£‰šgs']è? $themes[$theme]->šfo['£‰šgs'] : 
	`¬¿y
();

22 ià(!
	`em±y
(
$deçuÉs
)) {

24 
$£‰šgs
 = 
	`theme_g‘_£‰šgs
(
$theme
);

26 ià(
	`moduË_exi¡s
('node')) {

27 
	`fÜ—ch
 (
	`node_g‘_ty³s
(è
as
 
$ty³
 => 
$Çme
) {

28 
	`un£t
(
$£‰šgs
['toggË_node_šfo_' . 
$ty³
]);

32 
	`v¬ŸbË_£t
(

33 
	`¡r_»¶aû
('/', '_', 'theme_' . 
$theme
 . '_settings'),

34 
	`¬¿y_m”ge
(
$deçuÉs
, 
$£‰šgs
)

37 ià(!
	`em±y
(
$GLOBALS
['theme_key'])) {

38 
	`theme_g‘_£‰šg
('', 
TRUE
);

43  
$deçuÉs
;

44 
	}
}

54 
funùiÚ
 
mÙh”sh_£‰šgs
(
$§ved_£‰šgs
, 
$subtheme_deçuÉs
 = 
	$¬¿y
()) {

57 
$deçuÉs
 = 
	`mÙh”sh_theme_g‘_deçuÉ_£‰šgs
('mothership');

60 
$deçuÉs
 = 
	`¬¿y_m”ge
($deçuÉs, 
$subtheme_deçuÉs
);

63 
$£‰šgs
 = 
	`¬¿y_m”ge
(
$deçuÉs
, 
$§ved_£‰šgs
);

66 
$£‰šgs
 = 
	`¬¿y_m”ge
(
$deçuÉs
, 
$§ved_£‰šgs
);

67 
GLOBAL
 
$v¬s
;

71 
$fÜm
['ş—nup'] = 
	`¬¿y
(

73 '#t™Ë' => 
	`t
('"Tipl Phiphs" CSS Cleanup'),

74 '#cŞÏpsibË' => 
TRUE
,

75 '#cŞÏp£d' => 
FALSE
,

79 
$fÜm
['ş—nup']['body'] = 
	`¬¿y
(

81 '#t™Ë' => 
	`t
('body classes (page.tpl)'),

82 '#cŞÏpsibË' => 
TRUE
,

83 '#cŞÏp£d' => 
FALSE
,

86 
$fÜm
['ş—nup']['body']['mÙh”sh_ş—nup_body_»move'] = 
	`¬¿y
(

88 '#t™Ë' => 
	`t
('Removes drupals standard body classes'),

89 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_body_remove'],

92 
$fÜm
['ş—nup']['body']['add'] = 
	`¬¿y
(

94 '#t™Ë' => 
	`t
('Rebuild drupal standard classes:'),

95 '#cŞÏpsibË' => 
FALSE
,

96 '#cŞÏp£d' => 
FALSE
,

100 
$fÜm
['ş—nup']['body']['add']['mÙh”sh_ş—nup_body_äÚt'] = 
	`¬¿y
(

102 '#t™Ë' => 
	`t
('.front : if itshe frontpage '),

103 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_body_front'],

106 
$fÜm
['ş—nup']['body']['add']['mÙh”sh_ş—nup_body_äÚt_nÙ'] = 
	`¬¿y
(

108 '#t™Ë' => 
	`t
('.not-front :if its‚othe frontpage'),

109 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_body_front_not'],

112 
$fÜm
['ş—nup']['body']['add']['mÙh”sh_ş—nup_body_loggedš'] = 
	`¬¿y
(

114 '#t™Ë' => 
	`t
('.logged-in : if user is†ogged in'),

115 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_body_loggedin'],

118 
$fÜm
['ş—nup']['body']['add']['mÙh”sh_ş—nup_body_loggedš_nÙ'] = 
	`¬¿y
(

120 '#t™Ë' => 
	`t
('.not-logged-in : if user is‚ot†ogged in'),

121 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_body_loggedin_not'],

124 
$fÜm
['ş—nup']['body']['add']['mÙh”sh_ş—nup_body_Ïyout'] = 
	`¬¿y
(

126 '#t™Ë' => 
	`t
('layout class: .two-sidebars | .no-sidebars | .one-sidebar .sidebar-left/right'),

127 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_body_layout'],

131 
$fÜm
['ş—nup']['body']['add']['mÙh”sh_ş—nup_body_nod‘y³'] = 
	`¬¿y
(

133 '#t™Ë' => 
	`t
('.node-type-[NODETYPE]'),

134 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_body_nodetype'],

137 
$fÜm
['ş—nup']['body']['mÙh”sh_ş—nup_body_·g—rg_Úe'] = 
	`¬¿y
(

139 '#t™Ë' => 
	`t
('.page-[1.…art ofhe…ath ] '),

140 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_body_pagearg_one'],

144 
$fÜm
['ş—nup']['body']['mÙh”sh_ş—nup_body_add_·th'] = 
	`¬¿y
(

146 '#t™Ë' => 
	`t
('.path-[URL]'),

147 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_body_add_path'],

150 
$fÜm
['ş—nup']['body']['mÙh”sh_ş—nup_body_add_Ï¡'] = 
	`¬¿y
(

152 '#t™Ë' => 
	`t
('last…ath: .pathlast-[last]'),

153 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_body_add_last'],

156 
$fÜm
['ş—nup']['body']['mÙh”sh_ş—nup_body_aùiÚs'] = 
	`¬¿y
(

158 '#t™Ë' => 
	`t
('node‡ctions: .add, .edit, .delete'),

159 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_body_actions'],

162 
$fÜm
['ş—nup']['body']['mÙh”sh_ş—nup_body_admš'] = 
	`¬¿y
(

164 '#t™Ë' => 
	`t
('admin module‡ctive: .adminmenu'),

165 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_body_admin'],

171 
$fÜm
['ş—nup']['node'] = 
	`¬¿y
(

173 '#t™Ë' => 
	`t
('node.tpl'),

174 '#cŞÏpsibË' => 
TRUE
,

175 '#cŞÏp£d' => 
FALSE
,

178 
$fÜm
['ş—nup']['node']['mÙh”sh_ş—nup_node_node'] = 
	`¬¿y
(

180 '#t™Ë' => 
	`t
('add‚ode '),

181 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_node_node'],

184 
$fÜm
['ş—nup']['node']['mÙh”sh_ş—nup_node_¡icky'] = 
	`¬¿y
(

186 '#t™Ë' => 
	`t
('add sticky'),

187 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_node_sticky'],

190 
$fÜm
['ş—nup']['node']['mÙh”sh_ş—nup_node_published'] = 
	`¬¿y
(

192 '#t™Ë' => 
	`t
('add‚ode-unpublished'),

193 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_node_published'],

196 
$fÜm
['ş—nup']['node']['mÙh”sh_ş—nup_node_´omÙed'] = 
	`¬¿y
(

198 '#t™Ë' => 
	`t
('add…romoted'),

199 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_node_promoted'],

202 
$fÜm
['ş—nup']['node']['mÙh”sh_ş—nup_node_cÚ‹Á_ty³'] = 
	`¬¿y
(

204 '#t™Ë' => 
	`t
('node: contentype '),

205 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_node_content_type'],

208 
$fÜm
['ş—nup']['node']['mÙh”sh_ş—nup_node_‹a£r'] = 
	`¬¿y
(

210 '#t™Ë' => 
	`t
('node:easer '),

211 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_node_teaser'],

214 
$fÜm
['ş—nup']['node']['mÙh”sh_ş—nup_node_id'] = 
	`¬¿y
(

216 '#t™Ë' => 
	`t
('id - generate‡ #node-nid '),

217 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_node_id'],

220 
$fÜm
['ş—nup']['node']['mÙh”sh_ş—nup_node_ş—rfix'] = 
	`¬¿y
(

222 '#t™Ë' => 
	`t
('add .clearfix '),

223 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_node_clearfix'],

229 
$fÜm
['ş—nup']['block'] = 
	`¬¿y
(

231 '#t™Ë' => 
	`t
('block.tpl'),

232 '#cŞÏpsibË' => 
TRUE
,

233 '#cŞÏp£d' => 
FALSE
,

237 
$fÜm
['ş—nup']['block']['mÙh”sh_ş—nup_block_block'] = 
	`¬¿y
(

239 '#t™Ë' => 
	`t
('add block'),

240 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_block_block'],

243 
$fÜm
['ş—nup']['block']['mÙh”sh_ş—nup_block_moduË'] = 
	`¬¿y
(

245 '#t™Ë' => 
	`t
('add module‚ame'),

246 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_block_module'],

249 
$fÜm
['ş—nup']['block']['mÙh”sh_ş—nup_block_»giÚ_zeb¿'] = 
	`¬¿y
(

251 '#t™Ë' => 
	`t
('add odd /ƒven inhe„egion„egion-odd /„egion-even'),

252 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_block_region_zebra'],

255 
$fÜm
['ş—nup']['block']['mÙh”sh_ş—nup_block_»giÚ_couÁ'] = 
	`¬¿y
(

257 '#t™Ë' => 
	`t
('add„egion„egion-count-x'),

258 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_block_region_count'],

261 
$fÜm
['ş—nup']['block']['mÙh”sh_ş—nup_block_loggedš'] = 
	`¬¿y
(

263 '#t™Ë' => 
	`t
('add block-logged-in'),

264 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_block_loggedin'],

267 
$fÜm
['ş—nup']['block']['mÙh”sh_ş—nup_block_äÚt'] = 
	`¬¿y
(

269 '#t™Ë' => 
	`t
('add block-front'),

270 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_block_front'],

273 
$fÜm
['ş—nup']['block']['mÙh”sh_ş—nup_block_zeb¿'] = 
	`¬¿y
(

275 '#t™Ë' => 
	`t
('add odd /ƒven for‡ll blocks'),

276 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_block_zebra'],

279 
$fÜm
['ş—nup']['block']['mÙh”sh_ş—nup_block_couÁ'] = 
	`¬¿y
(

281 '#t™Ë' => 
	`t
('add count for‡ll blocks count-x'),

282 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_block_count'],

285 
$fÜm
['ş—nup']['block']['mÙh”sh_ş—nup_block_id'] = 
	`¬¿y
(

287 '#t™Ë' => 
	`t
('id - generate‡ id forhe block '),

288 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_block_id'],

293 
$fÜm
['ş—nup']['comm’t'] = 
	`¬¿y
(

295 '#t™Ë' => 
	`t
('comments'),

296 '#cŞÏpsibË' => 
TRUE
,

297 '#cŞÏp£d' => 
FALSE
,

300 
$fÜm
['ş—nup']['comm’t']['mÙh”sh_ş—nup_comm’t_comm’t'] = 
	`¬¿y
(

302 '#t™Ë' => 
	`t
('add comment'),

303 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_comment_comment'],

306 
$fÜm
['ş—nup']['comm’t']['mÙh”sh_ş—nup_comm’t_Ãw'] = 
	`¬¿y
(

308 '#t™Ë' => 
	`t
('add‚ew'),

309 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_comment_new'],

312 
$fÜm
['ş—nup']['comm’t']['mÙh”sh_ş—nup_comm’t_¡©us'] = 
	`¬¿y
(

314 '#t™Ë' => 
	`t
('add status'),

315 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_comment_status'],

318 
$fÜm
['ş—nup']['comm’t']['mÙh”sh_ş—nup_comm’t_fœ¡'] = 
	`¬¿y
(

320 '#t™Ë' => 
	`t
('add first'),

321 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_comment_first'],

324 
$fÜm
['ş—nup']['comm’t']['mÙh”sh_ş—nup_comm’t_Ï¡'] = 
	`¬¿y
(

326 '#t™Ë' => 
	`t
('add†ast'),

327 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_comment_last'],

330 
$fÜm
['ş—nup']['comm’t']['mÙh”sh_ş—nup_comm’t_zeb¿'] = 
	`¬¿y
(

332 '#t™Ë' => 
	`t
('add oddƒven'),

333 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_comment_zebra'],

336 
$fÜm
['ş—nup']['comm’t']['mÙh”sh_ş—nup_comm’t_äÚt'] = 
	`¬¿y
(

338 '#t™Ë' => 
	`t
('add front'),

339 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_comment_front'],

342 
$fÜm
['ş—nup']['comm’t']['mÙh”sh_ş—nup_comm’t_comm’t'] = 
	`¬¿y
(

344 '#t™Ë' => 
	`t
('add comment'),

345 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_comment_comment'],

348 
$fÜm
['ş—nup']['comm’t']['mÙh”sh_ş—nup_comm’t_loggedš'] = 
	`¬¿y
(

350 '#t™Ë' => 
	`t
('add†ogged-in'),

351 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_comment_loggedin'],

354 
$fÜm
['ş—nup']['comm’t']['mÙh”sh_ş—nup_comm’t_u£r'] = 
	`¬¿y
(

356 '#t™Ë' => 
	`t
('add user-'),

357 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_comment_user'],

363 
$fÜm
['v›ws'] = 
	`¬¿y
(

365 '#t™Ë' => 
	`t
('Views'),

366 '#cŞÏpsibË' => 
TRUE
,

367 '#cŞÏp£d' => 
FALSE
,

370 
$fÜm
['v›ws']['li¡'] = 
	`¬¿y
(

372 '#t™Ë' => 
	`t
('List'),

373 '#cŞÏpsibË' => 
TRUE
,

374 '#cŞÏp£d' => 
FALSE
,

377 
$fÜm
['v›ws']['li¡']['mÙh”sh_ş—nup_v›ws_row_id’tify'] = 
	`¬¿y
(

379 '#t™Ë' => 
	`t
('views-row…refixohe classes: (.views-row-first/.views-row-last, .views-row-[count], .views-row-odd/.views-row-even '),

380 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_views_row_identify'],

383 
$fÜm
['v›ws']['li¡']['mÙh”sh_ş—nup_v›ws_fœ¡_Ï¡'] = 
	`¬¿y
(

385 '#t™Ë' => 
	`t
('first &†ast classesohe†ist .first .last '),

386 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_views_first_last'],

389 
$fÜm
['v›ws']['li¡']['mÙh”sh_ş—nup_v›ws_zeb¿'] = 
	`¬¿y
(

391 '#t™Ë' => 
	`t
('odd /ƒven class .odd, .even'),

392 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_views_zebra'],

396 
$fÜm
['v›ws']['li¡']['mÙh”sh_ş—nup_v›ws_row_couÁ'] = 
	`¬¿y
(

398 '#t™Ë' => 
	`t
('Row counting .row-[count] '),

399 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_views_row_count'],

404 
$fÜm
['v›ws']['bË'] = 
	`¬¿y
(

406 '#t™Ë' => 
	`t
('Tables'),

407 '#cŞÏpsibË' => 
TRUE
,

408 '#cŞÏp£d' => 
FALSE
,

411 
$fÜm
['v›ws']['bË']['mÙh”sh_ş—nup_v›ws_bË_fœ¡_Ï¡'] = 
	`¬¿y
(

413 '#t™Ë' => 
	`t
('add first &†ast class inable„ows'),

414 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_views_table_first_last'],

417 
$fÜm
['v›ws']['bË']['mÙh”sh_ş—nup_v›ws_bË_zeb¿'] = 
	`¬¿y
(

419 '#t™Ë' => 
	`t
('add odd /ƒven classoheable„ows '),

420 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_views_table_zebra'],

423 
$fÜm
['v›ws']['bË']['mÙh”sh_ş—nup_v›ws_bË_row_couÁ'] = 
	`¬¿y
(

425 '#t™Ë' => 
	`t
('row-xoheable„ows'),

426 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_views_table_row_count'],

430 
$fÜm
['v›ws']['grid'] = 
	`¬¿y
(

432 '#t™Ë' => 
	`t
('Grid'),

433 '#cŞÏpsibË' => 
TRUE
,

434 '#cŞÏp£d' => 
FALSE
,

440 
$fÜm
['m’u'] = 
	`¬¿y
(

442 '#t™Ë' => 
	`t
('Menu'),

443 '#cŞÏpsibË' => 
TRUE
,

444 '#cŞÏp£d' => 
FALSE
,

447 
$fÜm
['m’u']['mÙh”sh_ş—nup_m’u_ba£şass'] = 
	`¬¿y
(

449 '#t™Ë' => 
	`t
('menus ul gets‡ class=menu'),

450 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_menu_baseclass'],

453 
$fÜm
['m’u']['mÙh”sh_ş—nup_m’u_ba£şass'] = 
	`¬¿y
(

455 '#t™Ë' => 
	`t
('add‡ baseclassohe menus '),

456 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_menu_baseclass'],

459 
$fÜm
['m’u']['mÙh”sh_ş—nup_m’u_Ëafs'] = 
	`¬¿y
(

461 '#t™Ë' => 
	`t
('add†eaf &ƒxpanded classohe†i'),

462 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_menu_leafs'],

465 
$fÜm
['m’u']['mÙh”sh_ş—nup_m’u_şas£s_aùive'] = 
	`¬¿y
(

467 '#t™Ë' => 
	`t
('add‡‡ctive class forhe†i in‡ menu'),

468 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_menu_classes_active'],

471 
$fÜm
['m’u']['mÙh”sh_ş—nup_m’u_şas£s_fœ¡_Ï¡'] = 
	`¬¿y
(

473 '#t™Ë' => 
	`t
('adds‡ first &†ast class inhe†i'),

474 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_menu_classes_first_last'],

477 
$fÜm
['m’u']['mÙh”sh_ş—nup_lšks_ba£şass'] = 
	`¬¿y
(

479 '#t™Ë' => 
	`t
('add‡ baseclasseso†inks -primary & secundary '),

480 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_links_baseclass'],

483 
$fÜm
['m’u']['mÙh”sh_ş—nup_lšks_şas£s_aùive'] = 
	`¬¿y
(

485 '#t™Ë' => 
	`t
('add‡‡ctive class forhe†i inhe†inks'),

486 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_links_classes_active'],

489 
$fÜm
['m’u']['mÙh”sh_ş—nup_lšks_şas£s_fœ¡_Ï¡'] = 
	`¬¿y
(

491 '#t™Ë' => 
	`t
('adds‡ first &†ast class inhe†i'),

492 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_links_classes_first_last'],

498 
$fÜm
['¡yËsh“ts'] = 
	`¬¿y
(

500 '#t™Ë' => 
	`t
('stylesheets'),

501 '#cŞÏpsibË' => 
TRUE
,

502 '#cŞÏp£d' => 
FALSE
,

506 
$fÜm
['¡yËsh“ts']['mÙh”sh_¡yËsh“t_lßd_Üd”'] = 
	`¬¿y
(

508 '#t™Ë' => 
	`t
('stylesheet†oading order inhe .info file'),

509 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_stylesheet_load_order'],

510 '#desütiÚ' => 
	`t
('.info file: <strong>top stylesheets[all][] = foo.css</strong>'),

513 
$fÜm
['¡yËsh“ts']['mÙh”sh_¡yËsh“t_cÚd™iÚ®'] = 
	`¬¿y
(

515 '#t™Ë' => 
	`t
('ie specific stylesheet conditions inhe .info file'),

516 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_stylesheet_conditional'],

517 '#desütiÚ' => 
	`t
('.info file: <strong>ie stylesheets[ condition ][all][] = ie.css</strong> conditionƒxampels [if†t IE 7] , [if IE 7] , [if IE 6]'),

523 
$fÜm
['misc'] = 
	`¬¿y
(

525 '#t™Ë' => 
	`t
('misc stuff'),

526 '#cŞÏpsibË' => 
TRUE
,

527 '#cŞÏp£d' => 
FALSE
,

531 
$fÜm
['misc']['mÙh”sh_™em_li¡_fœ¡_Ï¡'] = 
	`¬¿y
(

533 '#t™Ë' => 
	`t
('first &†ast classes from item†ists'),

534 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_item_list_first_last'],

537 
$fÜm
['misc']['mÙh”sh_™em_li¡_zeb¿'] = 
	`¬¿y
(

539 '#t™Ë' => 
	`t
('item†ists zebra'),

540 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_item_list_zebra'],

543 
$fÜm
['misc']['mÙh”sh_ş—nup_u£r_v”if›d'] = 
	`¬¿y
(

545 '#t™Ë' => 
	`t
('show (user verified) if‡ user isnt verified'),

546 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_user_verified'],

554 
$fÜm
['misc']['mÙh”sh_»bud_»gi¡ry'] = 
	`¬¿y
(

556 '#t™Ë' => 
	`t
('Rebuildheme„egistry onƒvery…age.'),

557 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_rebuild_registry'],

558 '#desütiÚ' => 
	`t
('Duršghemdev–İm’t, iˆÿÀbv”y u£fuÈtØcÚtšuou¦y <¨h»f="!lšk">»budhthem»gi¡ry</a>. WARNING:hi i ¨hug³rfÜmªû…’®ty‡nd mu¡ btuºed ofàÚ…roduùiÚ webs™es.', 
	`¬¿y
('!link' => 'http://drupal.org/node/173880#theme-registry')),

565 
$fÜm
['misc']['ã©u»s'] = 
	`¬¿y
(

567 '#t™Ë' => 
	`t
('Sneaky Features'),

568 '#cŞÏpsibË' => 
TRUE
,

569 '#cŞÏp£d' => 
FALSE
,

572 
$fÜm
['misc']['ã©u»s']['mÙh”sh_ş—nup_node_»giÚs'] = 
	`¬¿y
(

574 '#t™Ë' => 
	`t
('add„egionso‚odes '),

575 '#deçuÉ_v®ue' => 
$£‰šgs
['mothership_cleanup_node_regions'],

579  
$fÜm
;

581 
	}
}

	@/srv/http/subs/notes/www/sites/all/themes/mothership/user-picture.tpl.php

1 <?
	gphp


19 <?
php
 
´št
 
	g$piùu»
;

	@/srv/http/subs/notes/www/sites/all/themes/mothership/user-profile-category.tpl.php

1 <?
	gphp


29 <?
php
 ià(
	g$t™Ë
) : ?>

30 <
h3
><?
php
 
´št
 
$t™Ë
; ?></
	gh3
>

31 <?
php
 
	g’dif
; ?>

33 <
	gdl
<?
php
 
´št
 
	g$©Œibu‹s
; ?>>

34 <?
php
 
´št
 
	g$´ofe_™ems
; ?>

35 </
	gdl
>

	@/srv/http/subs/notes/www/sites/all/themes/mothership/user-profile-item.tpl.php

1 <?
	gphp


27 <
	gdt
<?
php
 
´št
 
	g$©Œibu‹s
; ?>><?ph°´šˆ
	g$t™Ë
; ?></dt>

28 <
	gdd
<?
php
 
´št
 
	g$©Œibu‹s
; ?>><?ph°´šˆ
	g$v®ue
; ?></dd>

	@/srv/http/subs/notes/www/sites/all/themes/mothership/user-profile.tpl.php

1 <?
	gphp


47 <
div
 
	gşass
="userprofile">

48 <?
php
 
´št
 
$u£r_´ofe
; ?>

49 </
	gdiv
>

	@/srv/http/subs/notes/www/sites/all/themes/mothership/views-view-fields.tpl.php

1 <?
	gphp


8 <!-- 
	gv›ws
-
	gv›w
-
	gf›lds
.
	gl
.
	gphp
 -->

9 <?
php


10 
fÜ—ch
 (
$f›lds
 
as
 
$id
 => 
$f›ld
) {

11 ià(!
em±y
(
$f›ld
->
£·¿tÜ
)) {

12 
´št
 "\n";

13 
	g´št
 " " . 
	g$f›ld
->
	g£·¿tÜ
;

14 
	g´št
 "\n";

18 
	g´št
 ' <' . 
	g$f›ld
->
	gšlše_html
 . ' cÏss="'. $f›ld->
	gşass
 . '">';

20 ià(
	g$f›ld
->
	gÏb–
) {

21 
	g´št
 "\n";

22 
	g´št
 " <Ïb–>" . 
	g$f›ld
->
	gÏb–
 . "</label>";

25 ià(
	g$f›ld
->
	gÏb–
) {

26 
	g´št
 "\n";

27 
	g´št
 " <" . 
	g$f›ld
->
	g–em’t_ty³
 . ">" . $f›ld->
	gcÚ‹Á
 . "</" . $field->element_type . ">";

30 
	g´št
 "\n";

31 
	g´št
 "\t" . 
	g$f›ld
->
	gcÚ‹Á
;

35 
	g´št
 "\n";

36 
	g´št
 " </" . 
	g$f›ld
->
	gšlše_html
 .">";

37 
	g´št
 "\n";

41 <!--/ 
	gv›ws
-
	gv›w
-
	gf›lds
.
	gl
.
	gphp
 -->

	@/srv/http/subs/notes/www/sites/all/themes/mothership/views-view-grid.tpl.php

1 <?
	gphp


14 <!-- 
	gv›ws
-
	gv›w
-
	ggrid
.
	gl
.
	gphp
 -->

15 <?
php
 ià(!
	$em±y
(
$t™Ë
)) : ?>

16 <
h3
><?
php
 
´št
 
$t™Ë
; ?></h3>

17 <?
php
 
’dif
; ?>

18 <
bË
 
şass
="views-view-grid">

19 <
tbody
>

20 <?
php
 
	`fÜ—ch
 (
$rows
 
as
 
$row_numb”
 => 
$cŞumns
): ?>

21 <?
php


22 
$row_şass
 = 'row-' . (
$row_numb”
 + 1);

23 ià(
$row_numb”
 == 0) {

24 
$row_şass
 .= '„ow-first';

25 
	}
}

26 
–£if
 (
couÁ
(
$rows
è=ğ(
$row_numb”
 + 1)) {

27 
$row_şass
 .= '„ow-last';

30 <
Œ
 
	gşass
="<?php…rint $row_class; ?>">

31 <?
php
 
fÜ—ch
 (
$cŞumns
 
as
 
$cŞumn_numb”
 => 
$™em
): ?>

32 <
td
 
şass
="<?php…rint 'col-'. ($column_number + 1); ?>">

33 <?
php
 
´št
 
$™em
; ?>

34 </
	gtd
>

35 <?
php
 
	g’dfÜ—ch
; ?>

36 </
	gŒ
>

37 <?
php
 
	g’dfÜ—ch
; ?>

38 </
	gtbody
>

39 </
	gbË
>

40 <!-- / 
	gv›ws
-
	gv›w
-
	ggrid
.
	gl
.
	gphp
 -->

	@/srv/http/subs/notes/www/sites/all/themes/mothership/views-view-list.tpl.php

1 <?
	gphp


8 <!-- 
	gv›ws
-
	gv›w
-
	gli¡
.
	gl
.
	gphp
 -->

9 <?
php
 ià(!
	$em±y
(
$t™Ë
)) { ?>

10 <
h3
><?
php
 
´št
 
$t™Ë
; ?></h3>

11 <?
php
 
	}
} ?>

13 <<?
php
 
´št
 
	g$İtiÚs
['type']; ?>>

14 <?
php
 
fÜ—ch
 (
$rows
 
as
 
$id
 => 
$row
) {

15 
´št
 ' <li';

16 ià(
	g$şas£s
[
$id
]) {

17 
	g´št
 ' cÏss="' . 
	g$şas£s
[
$id
] .'"';

19 
	g´št
 '>';

20 
´št
 
	g$row
;

21 
	g´št
 ' </li>';

22 
	g´št
 "\n";

25 </<?
php
 
´št
 
	g$İtiÚs
['type']; ?>>

26 <!-- /
	gv›ws
-
	gv›w
-
	gli¡
.
	gl
.
	gphp
 -->

	@/srv/http/subs/notes/www/sites/all/themes/mothership/views-view-table.tpl.php

1 <?
	gphp


19 <!-- 
	gv›ws
-
	gv›w
-
	gbË
.
	gl
.
	gphp
 -->

20 <
bË
 
	gşass
="<?php…rint $class; ?>">

21 <?
php
 ià(!
	$em±y
(
$t™Ë
)) : ?>

22 <
ÿ±iÚ
><?
php
 
´št
 
$t™Ë
; ?></caption>

23 <?
php
 
’dif
; ?>

24 <
th—d
>

25 <
Œ
>

26 <?
php
 
	`fÜ—ch
 (
$h—d”
 
as
 
$f›ld
 => 
$Ïb–
): ?>

27 <
th
 
şass
="<?php…rint $fields[$field]; ?>">

28 <?
php
 
´št
 
$Ïb–
; ?>

29 </
th
>

30 <?
php
 
’dfÜ—ch
; ?>

31 </
Œ
>

32 </
th—d
>

33 <
tbody
>

34 <?
php
 
	`fÜ—ch
 (
$rows
 
as
 
$couÁ
 => 
$row
): ?>

35 <
Œ
 
şass
="<?php…rint implode(' ', $row_classes[$count]); ?>">

36 <?
php
 
	`fÜ—ch
 (
$row
 
as
 
$f›ld
 => 
$cÚ‹Á
): ?>

37 <
td
 
şass
="<?php…rint $fields[$field]; ?>">

38 <?
php
 
´št
 
$cÚ‹Á
; ?>

39 </
td
>

40 <?
php
 
’dfÜ—ch
; ?>

41 </
Œ
>

42 <?
php
 
’dfÜ—ch
; ?>

43 </
tbody
>

44 </
bË
>

45 <!--/
v›ws
-
v›w
-
bË
.
l
.
php
 -->

	@/srv/http/subs/notes/www/sites/all/themes/mothership/views-view-unformatted.tpl.php

1 <?
	gphp


12 <!-- 
	gv›ws
-
	gv›w
-
	gunfÜm©‹d
.
	gl
.
	gphp
 -->

13 <?
php
 ià(!
	$em±y
(
$t™Ë
)): ?>

14 <
h3
><?
php
 
´št
 
$t™Ë
; ?></h3>

15 <?
php
 
’dif
; ?>

16 <?
php


17 
	`fÜ—ch
 (
$rows
 
as
 
$id
 => 
$row
) {

18 
´št
 " <div";

19 ià(
$şas£s
[
$id
]) {

20 
´št
 ' cÏss="' . 
$şas£s
[
$id
] . '"';

22 
´št
 ">";

24 
´št
 
$row
;

25 
´št
 " </div>\n";

26 
	}
}

28 <!-- / 
	gv›ws
-
	gv›w
-
	gunfÜm©‹d
.
	gl
.
	gphp
 -->

	@/srv/http/subs/notes/www/sites/all/themes/mothership/views-view.tpl.php

1 <?
	gphp


25 <!--
	gv›ws
-
	gv›w
.
	gl
.
	gphp
-->

26 <
div
 
	gşass
="v›w v›w-<?ph°´šˆ$css_Çme; ?> <?ph°´šˆ$skšr; ?>"> <?
php
 ?>

28 <?
php
 ià(
$admš_lšks
): ?>

29 <!--
v›ws
 
admš
 
lšks
-->

30 <
div
 
şass
="views-admin-links views-hide">

31 <?
php
 
´št
 
$admš_lšks
; ?>

32 </
	gdiv
>

33 <!--/
v›ws
 
admš
 
	glšks
-->

34 <?
php
 
	g’dif
; ?>

35 <?
php
 ià(
	g$h—d”
): ?>

36 <!--
v›ws
 
h—d”
-->

37 <
div
 
şass
="view-header">

38 <?
php
 
´št
 
$h—d”
; ?>

39 </
	gdiv
>

40 <!--/
v›ws
 
	gh—d”
-->

41 <?
php
 
	g’dif
; ?>

42 <?
php
 ià(
	g$expo£d
): ?>

43 <!--
v›ws
 
expo£d
 
h—d”
-->

44 <
div
 
şass
="view-filters">

45 <?
php
 
´št
 
$expo£d
; ?>

46 </
	gdiv
>

47 <!--/
v›ws
 
expo£d
 
	gh—d”
-->

48 <?
php
 
	g’dif
; ?>

49 <?
php
 ià(
	g$©chm’t_befÜe
): ?>

50 <
div
 
şass
="attachment-before">

51 <?
php
 
´št
 
$©chm’t_befÜe
; ?>

52 </
	gdiv
>

54 <?
php
 
	g’dif
; ?>

55 <?
php
 ià(
	g$rows
): ?>

56 <?
php
 
´št
 
$rows
; ?>

57 <?
php
 
	$–£if
 (
$em±y
): ?>

58 <
div
 
şass
="view-empty">

59 <?
php
 
´št
 
$em±y
; ?>

60 </
div
>

62 <?
php
 
’dif
; ?>

63 <?
php
 ià(
$·g”
): ?>

64 <?
php
 
´št
 
$·g”
; ?>

65 <?
php
 
’dif
; ?>

66 <?
php
 ià(
$©chm’t_aá”
): ?>

67 <
div
 
şass
="attachment-after">

68 <?
php
 
´št
 
$©chm’t_aá”
; ?>

69 </
div
>

71 <?
php
 
’dif
; ?>

72 <?
php
 ià(
$mÜe
): ?>

73 <?
php
 
´št
 
$mÜe
; ?>

74 <?
php
 
’dif
; ?>

75 <?
php
 ià(
$foÙ”
): ?>

76 <!--
v›ws
 
foÙ”
-->

77 <
div
 
şass
="view-footer">

78 <?
php
 
´št
 
$foÙ”
; ?>

79 </
div
>

80 <!--/
v›ws
 
foÙ”
-->

81 <?
php
 
’dif
; ?>

82 <?
php
 ià(
$ãed_icÚ
): ?>

83 <
div
 
şass
="feed-icon">

84 <?
php
 
´št
 
$ãed_icÚ
; ?>

85 </
div
>

87 <?
php
 
’dif
; ?>

88 </
div
>

89 <?
php


91 <!-- / 
v›ws
-
v›w
.
l
.
php
-->

	@/srv/http/subs/notes/www/sites/all/themes/ninesixty/page.tpl.php

1 <?
	gphp


4 <!
DOCTYPE
 
html
 
	gPUBLIC
 "-//W3C//DTD XHTML 1.0 Strict//EN"

6 <
html
 
	gxmÊs
="h‰p://www.w3.Üg/1999/xhtml" 
xml
:
Ïng
="<?ph°´šˆ$Ïnguage->Ïnguag?>"†ªg="<?ph°´šˆ$Ïnguage->Ïnguag?>" 
dœ
="<?php…rint $language->dir ?>">

8 <
h—d
>

9 <
t™Ë
><?
php
 
´št
 
$h—d_t™Ë
; ?></
	gt™Ë
>

10 <?
php
 
´št
 
	g$h—d
; ?>

11 <?
php
 
´št
 
	g$¡yËs
; ?>

12 <?
php
 
´št
 
	g$süts
; ?>

13 </
	gh—d
>

15 <
body
 
	gşass
="<?php…rint $body_classes; ?> show-grid">

16 <
div
 
id
="·ge" 
şass
="container-16 clear-block">

18 <
div
 
id
="s™e-h—d”" 
şass
="clear-block">

19 <
div
 
id
="b¿ndšg" 
şass
="grid-4 clear-block">

20 <?
php
 ià(
$lšked_logo_img
): ?>

21 <
¥ª
 
id
="logo" 
şass
="grid-1‡Íha"><?
php
 
´št
 
$lšked_logo_img
; ?></
	g¥ª
>

22 <?
php
 
	g’dif
; ?>

23 <?
php
 ià(
	g$lšked_s™e_Çme
): ?>

24 <
h1
 
id
="s™e-Çme" 
şass
="grid-3 omega"><?
php
 
´št
 
$lšked_s™e_Çme
; ?></
	gh1
>

25 <?
php
 
	g’dif
; ?>

26 <?
php
 ià(
	g$s™e_¦ogª
): ?>

27 <
div
 
id
="s™e-¦ogª" 
şass
="grid-3 omega"><?
php
 
´št
 
$s™e_¦ogª
; ?></
	gdiv
>

28 <?
php
 
	g’dif
; ?>

29 </
	gdiv
>

31 <?
php
 ià(
	g$maš_m’u_lšks
 || 
	g$£cÚd¬y_m’u_lšks
): ?>

32 <
div
 
id
="s™e-m’u" 
şass
="grid-12">

33 <?
php
 
´št
 
$maš_m’u_lšks
; ?>

34 <?
php
 
´št
 
	g$£cÚd¬y_m’u_lšks
; ?>

35 </
	gdiv
>

36 <?
php
 
	g’dif
; ?>

38 <?
php
 ià(
	g$£¬ch_box
): ?>

39 <
div
 
id
="£¬ch-box" 
şass
="grid-6…»fix-10"><?
php
 
´št
 
$£¬ch_box
; ?></
	gdiv
>

40 <?
php
 
	g’dif
; ?>

41 </
	gdiv
>

44 <
div
 
	gid
="s™e-subh—d”" 
şass
="prefix-1 suffix-1 clear-block">

45 <?
php
 ià(
$missiÚ
): ?>

46 <
div
 
id
="missiÚ" 
şass
="<?php…rint‚s('grid-14', $header, 7); ?>">

47 <?
php
 
´št
 
$missiÚ
; ?>

48 </
	gdiv
>

49 <?
php
 
	g’dif
; ?>

51 <?
php
 ià(
	g$h—d”
): ?>

52 <
div
 
id
="h—d”-»giÚ" 
şass
="region <?php…rint‚s('grid-14', $mission, 7); ?> clear-block">

53 <?
php
 
´št
 
$h—d”
; ?>

54 </
	gdiv
>

55 <?
php
 
	g’dif
; ?>

56 </
	gdiv
>

59 <
div
 
	gid
="maš" 
şass
="column <?php…rint‚s('grid-16', $left, 4, $right, 3) . ' ' .‚s('push-4', !$left, 4); ?>">

60 <?
php
 
´št
 
$b»adüumb
; ?>

61 <?
php
 ià(
	g$t™Ë
): ?>

62 <
h1
 
şass
="t™Ë" 
id
="·ge-t™Ë"><?
php
 
´št
 
$t™Ë
; ?></
	gh1
>

63 <?
php
 
	g’dif
; ?>

64 <?
php
 ià(
	g$bs
): ?>

65 <
div
 
şass
="bs"><?
php
 
´št
 
$bs
; ?></
	gdiv
>

66 <?
php
 
	g’dif
; ?>

67 <?
php
 
´št
 
	g$mes§ges
; ?>

68 <?
php
 
´št
 
	g$h–p
; ?>

70 <
div
 
	gid
="maš-cÚ‹Á" 
şass
="region clear-block">

71 <?
php
 
´št
 
$cÚ‹Á
; ?>

72 </
	gdiv
>

74 <?
php
 
´št
 
	g$ãed_icÚs
; ?>

75 </
	gdiv
>

77 <?
php
 ià(
	g$Ëá
): ?>

78 <
div
 
id
="sideb¬-Ëá" 
şass
="column sidebar„egion grid-4 <?php…rint‚s('pull-12', $right, 3); ?>">

79 <?
php
 
´št
 
$Ëá
; ?>

80 </
	gdiv
>

81 <?
php
 
	g’dif
; ?>

83 <?
php
 ià(
	g$right
): ?>

84 <
div
 
id
="sideb¬-right" 
şass
="column sidebar„egion grid-3">

85 <?
php
 
´št
 
$right
; ?>

86 </
	gdiv
>

87 <?
php
 
	g’dif
; ?>

90 <
div
 
	gid
="foÙ”" 
şass
="prefix-1 suffix-1">

91 <?
php
 ià(
$foÙ”
): ?>

92 <
div
 
id
="foÙ”-»giÚ" 
şass
="region grid-14 clear-block">

93 <?
php
 
´št
 
$foÙ”
; ?>

94 </
	gdiv
>

95 <?
php
 
	g’dif
; ?>

97 <?
php
 ià(
	g$foÙ”_mes§ge
): ?>

98 <
div
 
id
="foÙ”-mes§ge" 
şass
="grid-14">

99 <?
php
 
´št
 
$foÙ”_mes§ge
; ?>

100 </
	gdiv
>

101 <?
php
 
	g’dif
; ?>

102 </
	gdiv
>

105 </
	gdiv
>

106 <?
php
 
´št
 
	g$şosu»
; ?>

107 </
	gbody
>

108 </
	ghtml
>

	@/srv/http/subs/notes/www/sites/all/themes/ninesixty/template.php

1 <?
php


8 
funùiÚ
 
	$nšesixty_´•roûss_·ge
(&
$v¬s
, 
$hook
) {

10 
$v¬s
['logo_img'] = $v¬s['logo'] ? 
	`theme
('image', 
	`sub¡r
($v¬s['logo'], 
	`¡¾’
(
	`ba£_·th
())), 
	`t
('Home'),('Home')) : '';

11 
$v¬s
['lšked_logo_img'] = $v¬s['logo_img'] ? 
	`l
($v¬s['logo_img'], '<äÚt>', 
	`¬¿y
('©Œibu‹s' =>‡¼ay('»l' => 'home'), 't™Ë' => 
	`t
('Home'), 'html' => 
TRUE
)) : '';

12 
$v¬s
['lšked_s™e_Çme'] = $v¬s['s™e_Çme'] ? 
	`l
($v¬s['s™e_Çme'], '<äÚt>', 
	`¬¿y
('©Œibu‹s' =>‡¼ay('»l' => 'home'), 't™Ë' => 
	`t
('Home'))) : '';

13 
$v¬s
['maš_m’u_lšks'] = 
	`theme
('lšks', $v¬s['´im¬y_lšks'], 
	`¬¿y
('class' => 'links main-menu'));

14 
$v¬s
['£cÚd¬y_m’u_lšks'] = 
	`theme
('lšks', $v¬s['£cÚd¬y_lšks'], 
	`¬¿y
('class' => 'links secondary-menu'));

17 
$v¬s
['css_®t'] = 
	`nšesixty_css_»Üd”
($vars['css']);

18 
$v¬s
['¡yËs'] = 
	`dru·l_g‘_css
($vars['css_alt']);

19 
	}
}

34 
funùiÚ
 
	$ns
() {

35 
$¬gs
 = 
	`func_g‘_¬gs
();

36 
$deçuÉ
 = 
	`¬¿y_shiá
(
$¬gs
);

39 
	`li¡
(
$ty³
, 
$»tuº_un™
èğ
	`ex¶ode
('-', 
$deçuÉ
);

42 
$æ_¡©es
 = 
	`¬¿y
('var' => 'int', 'int' => 'var');

43 
$¡©e
 = 'var';

44 
	`fÜ—ch
 (
$¬gs
 
as
 
$¬g
) {

45 ià(
$¡©e
 == 'var') {

46 
$v¬_¡©e
 = !
	`em±y
(
$¬g
);

48 
	`–£if
 (
$v¬_¡©e
) {

49 
$»tuº_un™
 = $»tuº_un™ - 
$¬g
;

51 
$¡©e
 = 
$æ_¡©es
[$state];

54 
$ouut
 = '';

56 ià(
$»tuº_un™
 > 0) {

57 
$ouut
 = 
$ty³
 . '-' . 
$»tuº_un™
;

59  
$ouut
;

60 
	}
}

70 
funùiÚ
 
	$nšesixty_css_»Üd”
(
$css
) {

71 
glob®
 
$theme_šfo
, 
$ba£_theme_šfo
;

74 
$äamewÜk
 = !
	`em±y
(
$ba£_theme_šfo
è? $ba£_theme_šfo[0]->
šfo
 : 
$theme_šfo
->info;

77 ià(
	`is£t
(
$äamewÜk
['stylesheets'])) {

78 
	`fÜ—ch
 (
$äamewÜk
['¡yËsh“ts'] 
as
 
$medŸ
 => 
$¡yËs_äom_960
) {

80 ià(
	`is£t
(
$css
[
$medŸ
])) {

81 
$css
[
$medŸ
] = 
	`¬¿y_m”ge
(
	`¬¿y
('framework' =>‡rray()), $css[$media]);

84 
$css
[
$medŸ
]['äamewÜk'] = 
	`¬¿y
();

86 
	`fÜ—ch
 (
$¡yËs_äom_960
 
as
 
$¡yË_äom_960
) {

88 ià(
	`¡½os
(
$¡yË_äom_960
, 'äamewÜk'è!=ğ
FALSE
) {

89 
$äamewÜk_shiá
 = 
$¡yË_äom_960
;

90 
$»move_¡yËs
 = 
	`¬¿y
(
$¡yË_äom_960
);

92 
	`fÜ—ch
 (
$css
[
$medŸ
]['theme'] 
as
 
$¡yË_äom_v¬
 => 
$´•roûss
) {

93 ià(
$¡yË_äom_960
 !ğ
$¡yË_äom_v¬
 && 
	`ba£Çme
($style_from_960) == basename($style_from_var)) {

94 
$äamewÜk_shiá
 = 
$¡yË_äom_v¬
;

95 
$»move_¡yËs
[] = 
$¡yË_äom_v¬
;

99 
$css
[
$medŸ
]['äamewÜk'][
$äamewÜk_shiá
] = 
TRUE
;

100 
	`fÜ—ch
 (
$»move_¡yËs
 
as
 
$»move_¡yË
) {

101 
	`un£t
(
$css
[
$medŸ
]['theme'][
$»move_¡yË
]);

108  
$css
;

109 
	}
}

	@
1
.
1
/usr/include
484
40873
/srv/http/subs/notes/www/includes/actions.inc
/srv/http/subs/notes/www/includes/batch.inc
/srv/http/subs/notes/www/includes/bootstrap.inc
/srv/http/subs/notes/www/includes/cache-install.inc
/srv/http/subs/notes/www/includes/cache.inc
/srv/http/subs/notes/www/includes/common.inc
/srv/http/subs/notes/www/includes/database.inc
/srv/http/subs/notes/www/includes/database.mysql-common.inc
/srv/http/subs/notes/www/includes/database.mysql.inc
/srv/http/subs/notes/www/includes/database.mysqli.inc
/srv/http/subs/notes/www/includes/database.pgsql.inc
/srv/http/subs/notes/www/includes/file.inc
/srv/http/subs/notes/www/includes/form.inc
/srv/http/subs/notes/www/includes/image.gd.inc
/srv/http/subs/notes/www/includes/image.inc
/srv/http/subs/notes/www/includes/install.inc
/srv/http/subs/notes/www/includes/install.mysql.inc
/srv/http/subs/notes/www/includes/install.mysqli.inc
/srv/http/subs/notes/www/includes/install.pgsql.inc
/srv/http/subs/notes/www/includes/language.inc
/srv/http/subs/notes/www/includes/locale.inc
/srv/http/subs/notes/www/includes/lock.inc
/srv/http/subs/notes/www/includes/mail.inc
/srv/http/subs/notes/www/includes/menu.inc
/srv/http/subs/notes/www/includes/module.inc
/srv/http/subs/notes/www/includes/pager.inc
/srv/http/subs/notes/www/includes/path.inc
/srv/http/subs/notes/www/includes/session.inc
/srv/http/subs/notes/www/includes/tablesort.inc
/srv/http/subs/notes/www/includes/theme.inc
/srv/http/subs/notes/www/includes/theme.maintenance.inc
/srv/http/subs/notes/www/includes/unicode.inc
/srv/http/subs/notes/www/includes/xmlrpc.inc
/srv/http/subs/notes/www/includes/xmlrpcs.inc
/srv/http/subs/notes/www/modules/aggregator/aggregator-feed-source.tpl.php
/srv/http/subs/notes/www/modules/aggregator/aggregator-item.tpl.php
/srv/http/subs/notes/www/modules/aggregator/aggregator-summary-item.tpl.php
/srv/http/subs/notes/www/modules/aggregator/aggregator-summary-items.tpl.php
/srv/http/subs/notes/www/modules/aggregator/aggregator-wrapper.tpl.php
/srv/http/subs/notes/www/modules/aggregator/aggregator.admin.inc
/srv/http/subs/notes/www/modules/aggregator/aggregator.module
/srv/http/subs/notes/www/modules/aggregator/aggregator.pages.inc
/srv/http/subs/notes/www/modules/block/block-admin-display-form.tpl.php
/srv/http/subs/notes/www/modules/block/block.admin.inc
/srv/http/subs/notes/www/modules/block/block.module
/srv/http/subs/notes/www/modules/blog/blog.module
/srv/http/subs/notes/www/modules/blog/blog.pages.inc
/srv/http/subs/notes/www/modules/blogapi/blogapi.module
/srv/http/subs/notes/www/modules/book/book-all-books-block.tpl.php
/srv/http/subs/notes/www/modules/book/book-export-html.tpl.php
/srv/http/subs/notes/www/modules/book/book-navigation.tpl.php
/srv/http/subs/notes/www/modules/book/book-node-export-html.tpl.php
/srv/http/subs/notes/www/modules/book/book.admin.inc
/srv/http/subs/notes/www/modules/book/book.module
/srv/http/subs/notes/www/modules/book/book.pages.inc
/srv/http/subs/notes/www/modules/color/color.module
/srv/http/subs/notes/www/modules/comment/comment-folded.tpl.php
/srv/http/subs/notes/www/modules/comment/comment-wrapper.tpl.php
/srv/http/subs/notes/www/modules/comment/comment.admin.inc
/srv/http/subs/notes/www/modules/comment/comment.module
/srv/http/subs/notes/www/modules/comment/comment.pages.inc
/srv/http/subs/notes/www/modules/comment/comment.tpl.php
/srv/http/subs/notes/www/modules/contact/contact.admin.inc
/srv/http/subs/notes/www/modules/contact/contact.module
/srv/http/subs/notes/www/modules/contact/contact.pages.inc
/srv/http/subs/notes/www/modules/dblog/dblog.admin.inc
/srv/http/subs/notes/www/modules/dblog/dblog.module
/srv/http/subs/notes/www/modules/filter/filter.admin.inc
/srv/http/subs/notes/www/modules/filter/filter.module
/srv/http/subs/notes/www/modules/filter/filter.pages.inc
/srv/http/subs/notes/www/modules/forum/forum-icon.tpl.php
/srv/http/subs/notes/www/modules/forum/forum-list.tpl.php
/srv/http/subs/notes/www/modules/forum/forum-submitted.tpl.php
/srv/http/subs/notes/www/modules/forum/forum-topic-list.tpl.php
/srv/http/subs/notes/www/modules/forum/forum-topic-navigation.tpl.php
/srv/http/subs/notes/www/modules/forum/forum.admin.inc
/srv/http/subs/notes/www/modules/forum/forum.module
/srv/http/subs/notes/www/modules/forum/forum.pages.inc
/srv/http/subs/notes/www/modules/forum/forums.tpl.php
/srv/http/subs/notes/www/modules/help/help.admin.inc
/srv/http/subs/notes/www/modules/help/help.module
/srv/http/subs/notes/www/modules/locale/locale.module
/srv/http/subs/notes/www/modules/menu/menu.admin.inc
/srv/http/subs/notes/www/modules/menu/menu.module
/srv/http/subs/notes/www/modules/node/content_types.inc
/srv/http/subs/notes/www/modules/node/node.admin.inc
/srv/http/subs/notes/www/modules/node/node.module
/srv/http/subs/notes/www/modules/node/node.pages.inc
/srv/http/subs/notes/www/modules/node/node.tpl.php
/srv/http/subs/notes/www/modules/openid/openid.inc
/srv/http/subs/notes/www/modules/openid/openid.module
/srv/http/subs/notes/www/modules/openid/openid.pages.inc
/srv/http/subs/notes/www/modules/openid/xrds.inc
/srv/http/subs/notes/www/modules/path/path.admin.inc
/srv/http/subs/notes/www/modules/path/path.module
/srv/http/subs/notes/www/modules/php/php.module
/srv/http/subs/notes/www/modules/ping/ping.module
/srv/http/subs/notes/www/modules/poll/poll-bar-block.tpl.php
/srv/http/subs/notes/www/modules/poll/poll-bar.tpl.php
/srv/http/subs/notes/www/modules/poll/poll-results-block.tpl.php
/srv/http/subs/notes/www/modules/poll/poll-results.tpl.php
/srv/http/subs/notes/www/modules/poll/poll-vote.tpl.php
/srv/http/subs/notes/www/modules/poll/poll.module
/srv/http/subs/notes/www/modules/poll/poll.pages.inc
/srv/http/subs/notes/www/modules/profile/profile-block.tpl.php
/srv/http/subs/notes/www/modules/profile/profile-listing.tpl.php
/srv/http/subs/notes/www/modules/profile/profile-wrapper.tpl.php
/srv/http/subs/notes/www/modules/profile/profile.admin.inc
/srv/http/subs/notes/www/modules/profile/profile.module
/srv/http/subs/notes/www/modules/profile/profile.pages.inc
/srv/http/subs/notes/www/modules/search/search-block-form.tpl.php
/srv/http/subs/notes/www/modules/search/search-result.tpl.php
/srv/http/subs/notes/www/modules/search/search-results.tpl.php
/srv/http/subs/notes/www/modules/search/search-theme-form.tpl.php
/srv/http/subs/notes/www/modules/search/search.admin.inc
/srv/http/subs/notes/www/modules/search/search.module
/srv/http/subs/notes/www/modules/search/search.pages.inc
/srv/http/subs/notes/www/modules/statistics/statistics.admin.inc
/srv/http/subs/notes/www/modules/statistics/statistics.module
/srv/http/subs/notes/www/modules/statistics/statistics.pages.inc
/srv/http/subs/notes/www/modules/syslog/syslog.module
/srv/http/subs/notes/www/modules/system/block.tpl.php
/srv/http/subs/notes/www/modules/system/box.tpl.php
/srv/http/subs/notes/www/modules/system/maintenance-page.tpl.php
/srv/http/subs/notes/www/modules/system/page.tpl.php
/srv/http/subs/notes/www/modules/system/system.admin.inc
/srv/http/subs/notes/www/modules/system/system.module
/srv/http/subs/notes/www/modules/taxonomy/taxonomy.admin.inc
/srv/http/subs/notes/www/modules/taxonomy/taxonomy.module
/srv/http/subs/notes/www/modules/taxonomy/taxonomy.pages.inc
/srv/http/subs/notes/www/modules/throttle/throttle.admin.inc
/srv/http/subs/notes/www/modules/throttle/throttle.module
/srv/http/subs/notes/www/modules/tracker/tracker.module
/srv/http/subs/notes/www/modules/tracker/tracker.pages.inc
/srv/http/subs/notes/www/modules/translation/translation.module
/srv/http/subs/notes/www/modules/translation/translation.pages.inc
/srv/http/subs/notes/www/modules/trigger/trigger.admin.inc
/srv/http/subs/notes/www/modules/trigger/trigger.module
/srv/http/subs/notes/www/modules/update/update.compare.inc
/srv/http/subs/notes/www/modules/update/update.fetch.inc
/srv/http/subs/notes/www/modules/update/update.module
/srv/http/subs/notes/www/modules/update/update.report.inc
/srv/http/subs/notes/www/modules/update/update.settings.inc
/srv/http/subs/notes/www/modules/upload/upload.admin.inc
/srv/http/subs/notes/www/modules/upload/upload.module
/srv/http/subs/notes/www/modules/user/user-picture.tpl.php
/srv/http/subs/notes/www/modules/user/user-profile-category.tpl.php
/srv/http/subs/notes/www/modules/user/user-profile-item.tpl.php
/srv/http/subs/notes/www/modules/user/user-profile.tpl.php
/srv/http/subs/notes/www/modules/user/user.admin.inc
/srv/http/subs/notes/www/modules/user/user.module
/srv/http/subs/notes/www/modules/user/user.pages.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/content.module
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.admin.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.crud.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.devel.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.diff.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.node_form.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.rules.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/content.token.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/panels/content_types/content_field.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/content.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/content.views_convert.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_argument.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_argument_many_to_one.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_argument_numeric.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_argument_reference.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_argument_string.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_field.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_field_multiple.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_filter_float.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_filter_many_to_one.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_filter_numeric.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_filter_string.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_relationship.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_handler_sort.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_plugin_display_simple.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/includes/views/handlers/content_plugin_style_php_array_ac.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/content_copy/content_copy.module
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/content_copy/content_copy_export_form.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/content_permissions/content_permissions.module
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/fieldgroup/fieldgroup-simple.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/fieldgroup/fieldgroup.module
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/fieldgroup/panels/content_types/content_fieldgroup.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/nodereference/nodereference.module
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/nodereference/nodereference.rules.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/nodereference/panels/relationships/node_from_noderef.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/number/number.module
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/optionwidgets/optionwidgets.module
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/text/text.module
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/userreference/panels/relationships/user_from_userref.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/userreference/userreference.module
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/modules/userreference/userreference.rules.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/theme/content-admin-display-overview-form.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/theme/content-admin-field-overview-form.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/theme/content-field.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/cck/theme/theme.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/devel/devel.module
/srv/http/subs/notes/www/sites/all/modules/contrib/devel/devel_generate.drush.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/devel/devel_generate.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/devel/devel_generate.module
/srv/http/subs/notes/www/sites/all/modules/contrib/devel/devel_generate_batch.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/devel/devel_node_access.module
/srv/http/subs/notes/www/sites/all/modules/contrib/devel/krumo/class.krumo.php
/srv/http/subs/notes/www/sites/all/modules/contrib/devel/performance/performance.module
/srv/http/subs/notes/www/sites/all/modules/contrib/devel_themer/devel_themer.module
/srv/http/subs/notes/www/sites/all/modules/contrib/views/docs/docs.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument_date.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument_formula.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument_many_to_one.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument_null.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument_numeric.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_argument_string.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_boolean.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_counter.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_custom.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_date.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_markup.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_numeric.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_prerender_list.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_field_url.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_boolean_operator.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_boolean_operator_string.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_date.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_equality.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_float.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_in_operator.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_many_to_one.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_numeric.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_filter_string.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_relationship.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_sort.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_sort_date.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_sort_formula.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_sort_menu_hierarchy.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/handlers/views_handler_sort_random.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/admin.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/ajax.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/analyze.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/base.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/cache.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/convert.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/form.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/handlers.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/plugins.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/query.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/tabs.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/includes/view.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_handler_argument_aggregator_category_cid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_handler_argument_aggregator_fid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_handler_field_aggregator_category.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_handler_field_aggregator_item_description.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_handler_field_aggregator_title_link.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_handler_filter_aggregator_category_cid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/aggregator/views_plugin_row_aggregator_rss.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/book.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/book.views_convert.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment.views_convert.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment.views_default.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_argument_comment_user_uid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_depth.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_link.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_link_delete.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_link_edit.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_link_reply.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_node_link.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_comment_username.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_ncs_last_comment_name.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_ncs_last_updated.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_node_comment.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_field_node_new_comments.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_filter_comment_user_uid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_filter_ncs_last_updated.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_filter_node_comment.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_sort_comment_thread.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_sort_ncs_last_comment_name.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_handler_sort_ncs_last_updated.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_plugin_row_comment_rss.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/comment/views_plugin_row_comment_view.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/contact.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/contact/views_handler_field_contact_link.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/filter.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/filter/views_handler_field_filter_format_name.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_argument_locale_group.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_argument_locale_language.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_field_locale_group.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_field_locale_language.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_field_locale_link_edit.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_filter_locale_group.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_filter_locale_language.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/locale/views_handler_filter_locale_version.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node.views_convert.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node.views_default.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_argument_dates_various.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_argument_node_language.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_argument_node_nid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_argument_node_type.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_argument_node_vid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_history_user_timestamp.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_link.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_link_delete.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_link_edit.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_path.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_revision.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_revision_link_delete.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_revision_link_revert.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_field_node_type.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_filter_history_user_timestamp.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_filter_node_access.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_filter_node_status.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_handler_filter_node_type.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_plugin_argument_default_node.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_plugin_argument_validate_node.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_plugin_row_node_rss.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/node/views_plugin_row_node_view.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/poll.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/profile.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/profile.views_convert.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/profile/views_handler_field_profile_date.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/profile/views_handler_field_profile_list.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/profile/views_handler_filter_profile_selection.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search.views_convert.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search.views_default.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search/views_handler_field_search_score.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search/views_handler_filter_search.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search/views_handler_sort_search_score.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/search/views_plugin_row_search_view.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/statistics.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/statistics.views_convert.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/statistics.views_default.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/statistics/views_handler_field_accesslog_path.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/system.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/system/views_handler_argument_file_fid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/system/views_handler_field_file.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/system/views_handler_field_file_status.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/system/views_handler_filter_file_status.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy.views_convert.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy.views_default.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_argument_taxonomy.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_argument_term_node_tid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_argument_term_node_tid_depth.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_argument_term_node_tid_depth_modifier.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_argument_vocabulary_vid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_field_taxonomy.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_field_term_node_tid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_filter_term_node_tid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_filter_term_node_tid_depth.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_filter_vocabulary_vid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_handler_relationship_node_term_data.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_plugin_argument_default_taxonomy_tid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/taxonomy/views_plugin_argument_validate_taxonomy_term.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_argument_node_language.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_argument_node_tnid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_field_node_language.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_field_node_link_translate.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_field_node_translation_link.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_filter_node_language.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_filter_node_tnid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_filter_node_tnid_child.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/translation/views_handler_relationship_translation.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/upload.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/upload.views_convert.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/upload/views_handler_field_upload_description.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/upload/views_handler_field_upload_fid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/upload/views_handler_filter_upload_fid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user.views_convert.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_argument_user_uid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_argument_users_roles_rid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_language.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_link.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_link_delete.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_link_edit.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_mail.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_name.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_picture.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_field_user_roles.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_filter_user_current.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_filter_user_name.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_handler_filter_user_roles.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_plugin_argument_default_current_user.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_plugin_argument_default_user.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/user/views_plugin_argument_validate_user.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/modules/views.views.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_access.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_access_none.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_access_perm.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_access_role.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_argument_default.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_argument_default_php.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_argument_validate.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_argument_validate_numeric.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_argument_validate_php.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_cache.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_cache_none.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_cache_time.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_display.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_display_attachment.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_display_block.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_display_default.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_display_feed.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_display_page.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_row.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_row_fields.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_default.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_grid.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_jump_menu.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_list.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_rss.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_summary.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_summary_jump_menu.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_summary_unformatted.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/plugins/views_plugin_style_table.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/theme.inc
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-exposed-form.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-more.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-ui-edit-item.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-ui-edit-tab.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-ui-edit-view.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-ui-list-views.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-field.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-fields.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-grid.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-list.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-row-comment.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-row-node.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-row-rss.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-rss.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-summary-unformatted.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-summary.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-table.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view-unformatted.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/theme/views-view.tpl.php
/srv/http/subs/notes/www/sites/all/modules/contrib/views/views.module
/srv/http/subs/notes/www/sites/all/modules/contrib/views/views_export/views_export.module
/srv/http/subs/notes/www/sites/all/modules/contrib/views/views_ui.module
/srv/http/subs/notes/www/sites/all/themes/drupal-notes/template.php
/srv/http/subs/notes/www/sites/all/themes/drupal-notes/theme-settings.php
/srv/http/subs/notes/www/sites/all/themes/mothership/_copy_to_your_subtheme_theme-settings.php
/srv/http/subs/notes/www/sites/all/themes/mothership/block.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/box.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/comment-folded.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/comment-wrapper.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/comment.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/content-field.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/node.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/page.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/search-block-form.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/search-theme-form.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/template.php
/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.alternatives.php
/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.cck.php
/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.form.php
/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.functions.php
/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.menu.php
/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.table.php
/srv/http/subs/notes/www/sites/all/themes/mothership/template/template.views.php
/srv/http/subs/notes/www/sites/all/themes/mothership/theme-settings.php
/srv/http/subs/notes/www/sites/all/themes/mothership/user-picture.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/user-profile-category.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/user-profile-item.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/user-profile.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/views-view-fields.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/views-view-grid.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/views-view-list.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/views-view-table.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/views-view-unformatted.tpl.php
/srv/http/subs/notes/www/sites/all/themes/mothership/views-view.tpl.php
/srv/http/subs/notes/www/sites/all/themes/ninesixty/page.tpl.php
/srv/http/subs/notes/www/sites/all/themes/ninesixty/template.php
