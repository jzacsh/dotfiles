#!/bin/bash

src_this() { [[ -f "$1" ]] && source "$1"; }

src_all() {
    local dir; dir="$HOME/.host"

    # generic distro-specific config
    local prefix; prefix=$dir/distro.
    if [[ -f /etc/arch-release ]]; then
        src_this "${prefix}arch"
    elif [[ -f /etc/lsb-release ]]; then
        deb_dist_file=${prefix}$(awk -F'=' '/^DISTRIB_ID/{print tolower($2)}' /etc/lsb-release)
        src_this "$deb_dist_file"
    fi

    # host-specific configuration
    local hostfile; hostfile="$dir/host.${HOSTNAME/.*/}" #mimic `hostname -s`
    src_this "$hostfile"

    # domain-specific configuration
    src_this "$dir/domain.$(hostname --domain)"
}

src_all
unset src_all src_this
